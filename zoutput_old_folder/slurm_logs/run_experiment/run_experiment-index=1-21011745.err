Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun  1 17:29:36 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745

 Experiment start at: 2024-06-01 17:41:57.332301
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9662267, 'precision': 0.68333983, 'recall': 0.5045073, 'specificity': 0.5045073, 'f1': 0.5006988, 'auroc': 0.9493122, 'binary_precision': 0.4, 'binary_recall': 0.009510869, 'binary_specificity': 0.9995038, 'binary_f1_score': 0.01857996}
confusion matrix:
       0   1
0  42299  21
1   1458  14
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.953763, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292199, 'recall': 0.5018323, 'specificity': 0.5018323, 'f1': 0.49315178, 'auroc': 0.91511977, 'binary_precision': 0.5, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.007604562}
confusion matrix:
      0  1
0  5996  1
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-01 18:11:59.964881,epoch time: 0:30:02.632580,used: 0:30:02.632580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9673913, 'precision': 0.85747814, 'recall': 0.5218339, 'specificity': 0.5218339, 'f1': 0.5334204, 'auroc': 0.96382535, 'binary_precision': 0.74712646, 'binary_recall': 0.044187628, 'binary_specificity': 0.9994802, 'binary_f1_score': 0.08344031}
confusion matrix:
       0   1
0  42299  22
1   1406  65
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.9318339, 'recall': 0.5201351, 'specificity': 0.5201351, 'f1': 0.5302921, 'auroc': 0.96642363, 'binary_precision': 0.8965517, 'binary_recall': 0.04043546, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.077380955}
confusion matrix:
       0   1
0  18146   3
1    617  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.97976, 'recall': 0.51532567, 'specificity': 0.51532567, 'f1': 0.5194107, 'auroc': 0.9441058, 'binary_precision': 1.0, 'binary_recall': 0.03065134, 'binary_specificity': 1.0, 'binary_f1_score': 0.059479553}
confusion matrix:
      0  1
0  5997  0
1   253  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-01 18:40:14.657500,epoch time: 0:28:14.692619,used: 0:58:17.325199,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9667063, 'precision': 0.9521085, 'recall': 0.5050833, 'specificity': 0.5050833, 'f1': 0.5016134, 'auroc': 0.9672103, 'binary_precision': 0.9375, 'binary_recall': 0.010190218, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.020161292}
confusion matrix:
       0   1
0  42319   1
1   1457  15
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.98317444, 'recall': 0.5085537, 'specificity': 0.5085537, 'f1': 0.5082629, 'auroc': 0.97069347, 'binary_precision': 1.0, 'binary_recall': 0.01710731, 'binary_specificity': 1.0, 'binary_f1_score': 0.033639144}
confusion matrix:
       0   1
0  18149   0
1    632  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.94526124, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_3.png
early stop counter: 1
val acc:0.9663686752319336, best validation acc: 0.9670072197914124, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 3,now: 2024-06-01 19:08:35.694894,epoch time: 0:28:21.037394,used: 1:26:38.362593,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9684874, 'precision': 0.94302297, 'recall': 0.53388417, 'specificity': 0.53388417, 'f1': 0.5552683, 'auroc': 0.9698292, 'binary_precision': 0.9174312, 'binary_recall': 0.06798097, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.1265823}
confusion matrix:
       0    1
0  42312    9
1   1371  100
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.9832517, 'recall': 0.5108865, 'specificity': 0.5108865, 'f1': 0.51279217, 'auroc': 0.9689665, 'binary_precision': 1.0, 'binary_recall': 0.02177294, 'binary_specificity': 1.0, 'binary_f1_score': 0.042617958}
confusion matrix:
       0   1
0  18149   0
1    629  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.9494561, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_4.png
early stop counter: 2
val acc:0.9665282964706421, best validation acc: 0.9670072197914124, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 4,now: 2024-06-01 19:36:56.342245,epoch time: 0:28:20.647351,used: 1:54:59.009944,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9683504, 'precision': 0.9783416, 'recall': 0.5288998, 'specificity': 0.5288998, 'f1': 0.54657173, 'auroc': 0.96993726, 'binary_precision': 0.9883721, 'binary_recall': 0.05782313, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.109254494}
confusion matrix:
       0   1
0  42321   1
1   1385  85
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.969903, 'recall': 0.52718866, 'specificity': 0.52718866, 'f1': 0.5432955, 'auroc': 0.966169, 'binary_precision': 0.9722222, 'binary_recall': 0.054432347, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.10309278}
confusion matrix:
       0   1
0  18148   1
1    608  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9445332, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_5.png
better model found
persisted
after epoch: 5,now: 2024-06-01 20:05:08.055134,epoch time: 0:28:11.712889,used: 2:23:10.722833,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97472143, 'precision': 0.8296168, 'recall': 0.7328302, 'specificity': 0.7328302, 'f1': 0.77218306, 'auroc': 0.97468275, 'binary_precision': 0.67735666, 'binary_recall': 0.47350544, 'binary_specificity': 0.992155, 'binary_f1_score': 0.55737704}
confusion matrix:
       0    1
0  41988  332
1    775  697
---- Validation: 
scalar performance:
{'acc': 0.972169, 'precision': 0.8215374, 'recall': 0.68481934, 'specificity': 0.68481934, 'f1': 0.7331685, 'auroc': 0.96803117, 'binary_precision': 0.66483516, 'binary_recall': 0.3763608, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.48063552}
confusion matrix:
       0    1
0  18027  122
1    401  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8694062, 'recall': 0.5964505, 'specificity': 0.5964505, 'f1': 0.64673364, 'auroc': 0.95437855, 'binary_precision': 0.77272725, 'binary_recall': 0.1954023, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.3119266}
confusion matrix:
      0   1
0  5982  15
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-01 20:33:33.196519,epoch time: 0:28:25.141385,used: 2:51:35.864218,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9775301, 'precision': 0.8296875, 'recall': 0.81842375, 'specificity': 0.81842375, 'f1': 0.8239486, 'auroc': 0.9722783, 'binary_precision': 0.67159975, 'binary_recall': 0.6478586, 'binary_specificity': 0.98898894, 'binary_f1_score': 0.6595156}
confusion matrix:
       0    1
0  41855  466
1    518  953
---- Validation: 
scalar performance:
{'acc': 0.9771711, 'precision': 0.85381615, 'recall': 0.7654147, 'specificity': 0.7654147, 'f1': 0.8027703, 'auroc': 0.9707861, 'binary_precision': 0.72384936, 'binary_recall': 0.5381026, 'binary_specificity': 0.99272686, 'binary_f1_score': 0.617306}
confusion matrix:
       0    1
0  18017  132
1    297  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697987, 'precision': 0.86768967, 'recall': 0.69839805, 'specificity': 0.69839805, 'f1': 0.75535893, 'auroc': 0.9542053, 'binary_precision': 0.76086956, 'binary_recall': 0.40229884, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.52631575}
confusion matrix:
      0    1
0  5964   33
1   156  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-01 21:02:03.983018,epoch time: 0:28:30.786499,used: 3:20:06.650717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9770278, 'precision': 0.8435186, 'recall': 0.7704159, 'specificity': 0.7704159, 'f1': 0.80224144, 'auroc': 0.9748195, 'binary_precision': 0.7026087, 'binary_recall': 0.54891306, 'binary_specificity': 0.99191874, 'binary_f1_score': 0.6163234}
confusion matrix:
       0    1
0  41978  342
1    664  808
---- Validation: 
scalar performance:
{'acc': 0.9758408, 'precision': 0.85950416, 'recall': 0.7249731, 'specificity': 0.7249731, 'f1': 0.7755191, 'auroc': 0.97383773, 'binary_precision': 0.73803526, 'binary_recall': 0.45567653, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.56346154}
confusion matrix:
       0    1
0  18045  104
1    350  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7410728, 'recall': 0.54780746, 'specificity': 0.54780746, 'f1': 0.5729909, 'auroc': 0.9475854, 'binary_precision': 0.52, 'binary_recall': 0.099616855, 'binary_specificity': 0.995998, 'binary_f1_score': 0.16720255}
confusion matrix:
      0   1
0  5973  24
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_8.png
early stop counter: 1
val acc:0.9758408069610596, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.9697986841201782 / 0.9697986841201782
after epoch: 8,now: 2024-06-01 21:31:15.457991,epoch time: 0:29:11.474973,used: 3:49:18.125690,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9823712, 'precision': 0.8908737, 'recall': 0.81809723, 'specificity': 0.81809723, 'f1': 0.8504509, 'auroc': 0.9819155, 'binary_precision': 0.7941176, 'binary_recall': 0.6419837, 'binary_specificity': 0.9942108, 'binary_f1_score': 0.70999247}
confusion matrix:
       0    1
0  42075  245
1    527  945
---- Validation: 
scalar performance:
{'acc': 0.9801511, 'precision': 0.8948948, 'recall': 0.77445805, 'specificity': 0.77445805, 'f1': 0.82300085, 'auroc': 0.97758406, 'binary_precision': 0.8054299, 'binary_recall': 0.55365473, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.6562212}
confusion matrix:
       0    1
0  18063   86
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.86864096, 'recall': 0.607778, 'specificity': 0.607778, 'f1': 0.66107774, 'auroc': 0.9592729, 'binary_precision': 0.7702703, 'binary_recall': 0.21839081, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.3402985}
confusion matrix:
      0   1
0  5980  17
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_9.png
better model found
persisted
after epoch: 9,now: 2024-06-01 22:00:55.279419,epoch time: 0:29:39.821428,used: 4:18:57.947118,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9771191, 'precision': 0.924101, 'recall': 0.6868591, 'specificity': 0.6868591, 'f1': 0.7564727, 'auroc': 0.9790714, 'binary_precision': 0.8694969, 'binary_recall': 0.37567934, 'binary_specificity': 0.99803877, 'binary_f1_score': 0.524668}
confusion matrix:
       0    1
0  42237   83
1    919  553
---- Validation: 
scalar performance:
{'acc': 0.97243506, 'precision': 0.9461608, 'recall': 0.6062013, 'specificity': 0.6062013, 'f1': 0.66594017, 'auroc': 0.9713615, 'binary_precision': 0.9194631, 'binary_recall': 0.21306376, 'binary_specificity': 0.9993388, 'binary_f1_score': 0.3459596}
confusion matrix:
       0    1
0  18137   12
1    506  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.95719874, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_10.png
early stop counter: 1
val acc:0.9724350571632385, best validation acc: 0.9801511168479919, corresponding to test acc:                         0.9646852016448975 / 0.9697986841201782
after epoch: 10,now: 2024-06-01 22:29:34.256032,epoch time: 0:28:38.976613,used: 4:47:36.923731,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9815035, 'precision': 0.87534195, 'recall': 0.822894, 'specificity': 0.822894, 'f1': 0.8469839, 'auroc': 0.9805244, 'binary_precision': 0.7626984, 'binary_recall': 0.65285325, 'binary_specificity': 0.99293476, 'binary_f1_score': 0.7035139}
confusion matrix:
       0    1
0  42021  299
1    511  961
---- Validation: 
scalar performance:
{'acc': 0.9813218, 'precision': 0.8838993, 'recall': 0.812567, 'specificity': 0.812567, 'f1': 0.8442786, 'auroc': 0.9787713, 'binary_precision': 0.7807692, 'binary_recall': 0.63141525, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.6981943}
confusion matrix:
       0    1
0  18035  114
1    237  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.7582433, 'recall': 0.5573026, 'specificity': 0.5573026, 'f1': 0.5873401, 'auroc': 0.9565613, 'binary_precision': 0.5535714, 'binary_recall': 0.118773945, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.1955836}
confusion matrix:
      0   1
0  5972  25
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_11.png
better model found
persisted
after epoch: 11,now: 2024-06-01 22:58:05.833247,epoch time: 0:28:31.577215,used: 5:16:08.500946,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9829193, 'precision': 0.91334903, 'recall': 0.80165994, 'specificity': 0.80165994, 'f1': 0.8481262, 'auroc': 0.98250854, 'binary_precision': 0.8402256, 'binary_recall': 0.60733694, 'binary_specificity': 0.995983, 'binary_f1_score': 0.70504737}
confusion matrix:
       0    1
0  42150  170
1    578  894
---- Validation: 
scalar performance:
{'acc': 0.9822797, 'precision': 0.93405485, 'recall': 0.7763101, 'specificity': 0.7763101, 'f1': 0.8364172, 'auroc': 0.98088527, 'binary_precision': 0.88366336, 'binary_recall': 0.55520993, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.6819484}
confusion matrix:
       0    1
0  18102   47
1    286  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.81044894, 'recall': 0.5505569, 'specificity': 0.5505569, 'f1': 0.5792517, 'auroc': 0.9625834, 'binary_precision': 0.6585366, 'binary_recall': 0.10344828, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.17880796}
confusion matrix:
      0   1
0  5983  14
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_12.png
better model found
persisted
after epoch: 12,now: 2024-06-01 23:26:38.522056,epoch time: 0:28:32.688809,used: 5:44:41.189755,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9805672, 'precision': 0.830513, 'recall': 0.9148659, 'specificity': 0.9148659, 'f1': 0.8674397, 'auroc': 0.98267925, 'binary_precision': 0.66648793, 'binary_recall': 0.8444294, 'binary_specificity': 0.98530245, 'binary_f1_score': 0.7449806}
confusion matrix:
       0     1
0  41698   622
1    229  1243
---- Validation: 
scalar performance:
{'acc': 0.9810558, 'precision': 0.84444356, 'recall': 0.8896849, 'specificity': 0.8896849, 'f1': 0.8655355, 'auroc': 0.9792588, 'binary_precision': 0.6963064, 'binary_recall': 0.79160184, 'binary_specificity': 0.98776793, 'binary_f1_score': 0.7409024}
confusion matrix:
       0    1
0  17927  222
1    134  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9699584, 'precision': 0.8704686, 'recall': 0.69848144, 'specificity': 0.69848144, 'f1': 0.75606203, 'auroc': 0.9599378, 'binary_precision': 0.76642334, 'binary_recall': 0.40229884, 'binary_specificity': 0.994664, 'binary_f1_score': 0.5276382}
confusion matrix:
      0    1
0  5965   32
1   156  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_13.png
new oracle model saved
early stop counter: 1
val acc:0.9810557961463928, best validation acc: 0.9822797179222107, corresponding to test acc:                         0.9603707194328308 / 0.9699584245681763
after epoch: 13,now: 2024-06-01 23:55:42.884910,epoch time: 0:29:04.362854,used: 6:13:45.552609,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9770278, 'precision': 0.9338427, 'recall': 0.67970973, 'specificity': 0.67970973, 'f1': 0.7508879, 'auroc': 0.9830544, 'binary_precision': 0.8894472, 'binary_recall': 0.36097893, 'binary_specificity': 0.9984405, 'binary_f1_score': 0.5135397}
confusion matrix:
       0    1
0  42255   66
1    940  531
---- Validation: 
scalar performance:
{'acc': 0.9753619, 'precision': 0.9408018, 'recall': 0.65572006, 'specificity': 0.65572006, 'f1': 0.7260653, 'auroc': 0.97218394, 'binary_precision': 0.9054054, 'binary_recall': 0.31259722, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.46473992}
confusion matrix:
       0    1
0  18128   21
1    442  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9536065, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_14.png
early stop counter: 2
val acc:0.9753618836402893, best validation acc: 0.9822797179222107, corresponding to test acc:                         0.9603707194328308 / 0.9699584245681763
after epoch: 14,now: 2024-06-02 00:23:40.828635,epoch time: 0:27:57.943725,used: 6:41:43.496334,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9844264, 'precision': 0.9138675, 'recall': 0.8296521, 'specificity': 0.8296521, 'f1': 0.8666231, 'auroc': 0.984666, 'binary_precision': 0.83934706, 'binary_recall': 0.6637228, 'binary_specificity': 0.99558127, 'binary_f1_score': 0.74127465}
confusion matrix:
       0    1
0  42133  187
1    495  977
---- Validation: 
scalar performance:
{'acc': 0.9823329, 'precision': 0.9449631, 'recall': 0.7688371, 'specificity': 0.7688371, 'f1': 0.8336659, 'auroc': 0.97666013, 'binary_precision': 0.9060052, 'binary_recall': 0.53965783, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.6764133}
confusion matrix:
       0    1
0  18113   36
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8486882, 'recall': 0.5471424, 'specificity': 0.5471424, 'f1': 0.57472205, 'auroc': 0.94052887, 'binary_precision': 0.7352941, 'binary_recall': 0.09578544, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.16949151}
confusion matrix:
      0   1
0  5988   9
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_15.png
better model found
persisted
after epoch: 15,now: 2024-06-02 00:51:30.797912,epoch time: 0:27:49.969277,used: 7:09:33.465611,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98200583, 'precision': 0.96863437, 'recall': 0.74348414, 'specificity': 0.74348414, 'f1': 0.818226, 'auroc': 0.9871439, 'binary_precision': 0.95478725, 'binary_recall': 0.48777175, 'binary_specificity': 0.9991966, 'binary_f1_score': 0.64568347}
confusion matrix:
       0    1
0  42286   34
1    754  718
---- Validation: 
scalar performance:
{'acc': 0.97557473, 'precision': 0.96561944, 'recall': 0.6498298, 'specificity': 0.6498298, 'f1': 0.7221556, 'auroc': 0.98010814, 'binary_precision': 0.9554455, 'binary_recall': 0.30015552, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.4568047}
confusion matrix:
       0    1
0  18140    9
1    450  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.9054425, 'recall': 0.5323169, 'specificity': 0.5323169, 'f1': 0.55040425, 'auroc': 0.9513413, 'binary_precision': 0.85, 'binary_recall': 0.0651341, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.12099644}
confusion matrix:
      0   1
0  5994   3
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_16.png
early stop counter: 1
val acc:0.9755747318267822, best validation acc: 0.9823328852653503, corresponding to test acc:                         0.9608501195907593 / 0.9699584245681763
after epoch: 16,now: 2024-06-02 01:19:01.249146,epoch time: 0:27:30.451234,used: 7:37:03.916845,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98609334, 'precision': 0.9289065, 'recall': 0.8436289, 'specificity': 0.8436289, 'f1': 0.88120514, 'auroc': 0.987495, 'binary_precision': 0.8684885, 'binary_recall': 0.69089675, 'binary_specificity': 0.9963611, 'binary_f1_score': 0.76957995}
confusion matrix:
       0     1
0  42166   154
1    455  1017
---- Validation: 
scalar performance:
{'acc': 0.9846211, 'precision': 0.94713527, 'recall': 0.80527437, 'specificity': 0.80527437, 'f1': 0.8618729, 'auroc': 0.9842032, 'binary_precision': 0.9078341, 'binary_recall': 0.61275274, 'binary_specificity': 0.997796, 'binary_f1_score': 0.73166203}
confusion matrix:
       0    1
0  18109   40
1    249  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8595127, 'recall': 0.5698807, 'specificity': 0.5698807, 'f1': 0.60968745, 'auroc': 0.9589832, 'binary_precision': 0.75510204, 'binary_recall': 0.14176245, 'binary_specificity': 0.997999, 'binary_f1_score': 0.23870967}
confusion matrix:
      0   1
0  5985  12
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_17.png
better model found
persisted
after epoch: 17,now: 2024-06-02 01:46:53.270232,epoch time: 0:27:52.021086,used: 8:04:55.937931,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98467755, 'precision': 0.91552013, 'recall': 0.83229244, 'specificity': 0.83229244, 'f1': 0.8689189, 'auroc': 0.98671263, 'binary_precision': 0.84246576, 'binary_recall': 0.6689327, 'binary_specificity': 0.99565226, 'binary_f1_score': 0.74573696}
confusion matrix:
       0    1
0  42137  184
1    487  984
---- Validation: 
scalar performance:
{'acc': 0.9831311, 'precision': 0.9331781, 'recall': 0.79175204, 'specificity': 0.79175204, 'f1': 0.8476665, 'auroc': 0.9754623, 'binary_precision': 0.88084114, 'binary_recall': 0.58631414, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.70401496}
confusion matrix:
       0    1
0  18098   51
1    266  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8545854, 'recall': 0.57171303, 'specificity': 0.57171303, 'f1': 0.61212593, 'auroc': 0.95290315, 'binary_precision': 0.74509805, 'binary_recall': 0.14559387, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.24358973}
confusion matrix:
      0   1
0  5984  13
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_18.png
early stop counter: 1
val acc:0.9831311106681824, best validation acc: 0.9846211075782776, corresponding to test acc:                         0.9622882604598999 / 0.9699584245681763
after epoch: 18,now: 2024-06-02 02:14:17.215137,epoch time: 0:27:23.944905,used: 8:32:19.882836,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98394686, 'precision': 0.8578448, 'recall': 0.9205488, 'specificity': 0.9205488, 'f1': 0.88643456, 'auroc': 0.9884336, 'binary_precision': 0.7208501, 'binary_recall': 0.8525815, 'binary_specificity': 0.9885161, 'binary_f1_score': 0.7812014}
confusion matrix:
       0     1
0  41834   486
1    217  1255
---- Validation: 
scalar performance:
{'acc': 0.9832908, 'precision': 0.86829543, 'recall': 0.88484156, 'specificity': 0.88484156, 'f1': 0.8763702, 'auroc': 0.97759473, 'binary_precision': 0.7444279, 'binary_recall': 0.7791602, 'binary_specificity': 0.9905229, 'binary_f1_score': 0.76139814}
confusion matrix:
       0    1
0  17977  172
1    142  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.8405758, 'recall': 0.6392612, 'specificity': 0.6392612, 'f1': 0.6938104, 'auroc': 0.96140134, 'binary_precision': 0.71153843, 'binary_recall': 0.2835249, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.40547946}
confusion matrix:
      0   1
0  5967  30
1   187  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_19.png
early stop counter: 2
val acc:0.9832907915115356, best validation acc: 0.9846211075782776, corresponding to test acc:                         0.9622882604598999 / 0.9699584245681763
after epoch: 19,now: 2024-06-02 02:41:26.860203,epoch time: 0:27:09.645066,used: 8:59:29.527902,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9836728, 'precision': 0.8519515, 'recall': 0.9308985, 'specificity': 0.9308985, 'f1': 0.88706326, 'auroc': 0.98791546, 'binary_precision': 0.7083104, 'binary_recall': 0.8743206, 'binary_specificity': 0.98747635, 'binary_f1_score': 0.7826087}
confusion matrix:
       0     1
0  41790   530
1    185  1287
---- Validation: 
scalar performance:
{'acc': 0.98323756, 'precision': 0.86059654, 'recall': 0.9020653, 'specificity': 0.9020653, 'f1': 0.8800978, 'auroc': 0.9818802, 'binary_precision': 0.7277778, 'binary_recall': 0.81493, 'binary_specificity': 0.98920053, 'binary_f1_score': 0.76889217}
confusion matrix:
       0    1
0  17953  196
1    119  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.78475827, 'recall': 0.71188754, 'specificity': 0.71188754, 'f1': 0.7423296, 'auroc': 0.95102054, 'binary_precision': 0.59375, 'binary_recall': 0.43678162, 'binary_specificity': 0.9869935, 'binary_f1_score': 0.5033113}
confusion matrix:
      0    1
0  5919   78
1   147  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_20.png
early stop counter: 3
val acc:0.9832375645637512, best validation acc: 0.9846211075782776, corresponding to test acc:                         0.9622882604598999 / 0.9699584245681763
after epoch: 20,now: 2024-06-02 03:09:04.636916,epoch time: 0:27:37.776713,used: 9:27:07.304615,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98753196, 'precision': 0.9048563, 'recall': 0.90273213, 'specificity': 0.90273213, 'f1': 0.9037912, 'auroc': 0.99152863, 'binary_precision': 0.8162568, 'binary_recall': 0.8118206, 'binary_specificity': 0.99364364, 'binary_f1_score': 0.8140326}
confusion matrix:
       0     1
0  42051   269
1    277  1195
---- Validation: 
scalar performance:
{'acc': 0.9859515, 'precision': 0.9029527, 'recall': 0.8787185, 'specificity': 0.8787185, 'f1': 0.8904284, 'auroc': 0.9761146, 'binary_precision': 0.81426203, 'binary_recall': 0.7636081, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.788122}
confusion matrix:
       0    1
0  18037  112
1    152  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7673316, 'recall': 0.5833722, 'specificity': 0.5833722, 'f1': 0.6220868, 'auroc': 0.9529778, 'binary_precision': 0.56962025, 'binary_recall': 0.1724138, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.26470587}
confusion matrix:
      0   1
0  5963  34
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_21.png
better model found
persisted
after epoch: 21,now: 2024-06-02 03:37:20.553024,epoch time: 0:28:15.916108,used: 9:55:23.220723,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9844264, 'precision': 0.9579345, 'recall': 0.78932536, 'specificity': 0.78932536, 'f1': 0.8533196, 'auroc': 0.98963, 'binary_precision': 0.93028325, 'binary_recall': 0.58016306, 'binary_specificity': 0.9984877, 'binary_f1_score': 0.71464443}
confusion matrix:
       0    1
0  42256   64
1    618  854
---- Validation: 
scalar performance:
{'acc': 0.98201364, 'precision': 0.9451072, 'recall': 0.7634214, 'specificity': 0.7634214, 'f1': 0.8293664, 'auroc': 0.98002636, 'binary_precision': 0.9066667, 'binary_recall': 0.5287714, 'binary_specificity': 0.9980715, 'binary_f1_score': 0.6679764}
confusion matrix:
       0    1
0  18114   35
1    303  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.81443965, 'recall': 0.54872453, 'specificity': 0.54872453, 'f1': 0.57651603, 'auroc': 0.9497597, 'binary_precision': 0.6666667, 'binary_recall': 0.099616855, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.17333335}
confusion matrix:
      0   1
0  5984  13
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_22.png
early stop counter: 1
val acc:0.9820136427879333, best validation acc: 0.9859514832496643, corresponding to test acc:                         0.9600511193275452 / 0.9699584245681763
after epoch: 22,now: 2024-06-02 04:05:43.151492,epoch time: 0:28:22.598468,used: 10:23:45.819191,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98570514, 'precision': 0.8725152, 'recall': 0.9260018, 'specificity': 0.9260018, 'f1': 0.8973045, 'auroc': 0.99022686, 'binary_precision': 0.7498522, 'binary_recall': 0.8619986, 'binary_specificity': 0.99000496, 'binary_f1_score': 0.80202407}
confusion matrix:
       0     1
0  41898   423
1    203  1268
---- Validation: 
scalar performance:
{'acc': 0.98483396, 'precision': 0.88670254, 'recall': 0.88264024, 'specificity': 0.88264024, 'f1': 0.88465977, 'auroc': 0.98211354, 'binary_precision': 0.7814465, 'binary_recall': 0.7729393, 'binary_specificity': 0.99234116, 'binary_f1_score': 0.77716964}
confusion matrix:
       0    1
0  18010  139
1    146  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.83961624, 'recall': 0.71813685, 'specificity': 0.71813685, 'f1': 0.76427734, 'auroc': 0.9589632, 'binary_precision': 0.7030303, 'binary_recall': 0.44444445, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.54460096}
confusion matrix:
      0    1
0  5948   49
1   145  116
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_23.png
early stop counter: 2
val acc:0.9848339557647705, best validation acc: 0.9859514832496643, corresponding to test acc:                         0.9600511193275452 / 0.9699584245681763
after epoch: 23,now: 2024-06-02 04:34:03.476256,epoch time: 0:28:20.324764,used: 10:52:06.143955,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98182315, 'precision': 0.88886297, 'recall': 0.8091617, 'specificity': 0.8091617, 'f1': 0.8440992, 'auroc': 0.98691344, 'binary_precision': 0.7906977, 'binary_recall': 0.6240653, 'binary_specificity': 0.99425817, 'binary_f1_score': 0.6975684}
confusion matrix:
       0    1
0  42078  243
1    553  918
---- Validation: 
scalar performance:
{'acc': 0.9783418, 'precision': 0.87128717, 'recall': 0.76602083, 'specificity': 0.76602083, 'f1': 0.80925405, 'auroc': 0.97011507, 'binary_precision': 0.75877196, 'binary_recall': 0.5381026, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.62966335}
confusion matrix:
       0    1
0  18039  110
1    297  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.7792337, 'recall': 0.65600044, 'specificity': 0.65600044, 'f1': 0.6981784, 'auroc': 0.9512615, 'binary_precision': 0.5874126, 'binary_recall': 0.3218391, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.4158416}
confusion matrix:
      0   1
0  5938  59
1   177  84
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_24.png
early stop counter: 3
val acc:0.978341817855835, best validation acc: 0.9859514832496643, corresponding to test acc:                         0.9600511193275452 / 0.9699584245681763
after epoch: 24,now: 2024-06-02 05:02:10.836957,epoch time: 0:28:07.360701,used: 11:20:13.504656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98655003, 'precision': 0.91495675, 'recall': 0.8687825, 'specificity': 0.8687825, 'f1': 0.89040136, 'auroc': 0.9905338, 'binary_precision': 0.83883345, 'binary_recall': 0.7425272, 'binary_specificity': 0.9950378, 'binary_f1_score': 0.78774774}
confusion matrix:
       0     1
0  42110   210
1    379  1093
---- Validation: 
scalar performance:
{'acc': 0.9804704, 'precision': 0.8794731, 'recall': 0.8008753, 'specificity': 0.8008753, 'f1': 0.83525956, 'auroc': 0.97717357, 'binary_precision': 0.77272725, 'binary_recall': 0.60808706, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.68059176}
confusion matrix:
       0    1
0  18034  115
1    252  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.7935755, 'recall': 0.69189864, 'specificity': 0.69189864, 'f1': 0.73086846, 'auroc': 0.94788754, 'binary_precision': 0.6130952, 'binary_recall': 0.394636, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.4801865}
confusion matrix:
      0    1
0  5932   65
1   158  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_25.png
early stop counter: 4
val acc:0.9804704189300537, best validation acc: 0.9859514832496643, corresponding to test acc:                         0.9600511193275452 / 0.9699584245681763
after epoch: 25,now: 2024-06-02 05:30:07.121093,epoch time: 0:27:56.284136,used: 11:48:09.788792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9879658, 'precision': 0.9428927, 'recall': 0.8617885, 'specificity': 0.8617885, 'f1': 0.8979486, 'auroc': 0.99250746, 'binary_precision': 0.8952221, 'binary_recall': 0.7265306, 'binary_specificity': 0.9970465, 'binary_f1_score': 0.8021029}
confusion matrix:
       0     1
0  42197   125
1    402  1068
---- Validation: 
scalar performance:
{'acc': 0.98573864, 'precision': 0.9414177, 'recall': 0.82910466, 'specificity': 0.82910466, 'f1': 0.8764685, 'auroc': 0.9753716, 'binary_precision': 0.8947368, 'binary_recall': 0.66096425, 'binary_specificity': 0.997245, 'binary_f1_score': 0.7602863}
confusion matrix:
       0    1
0  18099   50
1    218  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.81338143, 'recall': 0.52248824, 'specificity': 0.52248824, 'f1': 0.5325915, 'auroc': 0.91590333, 'binary_precision': 0.6666667, 'binary_recall': 0.04597701, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.086021505}
confusion matrix:
      0   1
0  5991   6
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_26.png
early stop counter: 5
val acc:0.9857386350631714, best validation acc: 0.9859514832496643, corresponding to test acc:                         0.9600511193275452 / 0.9699584245681763
after epoch: 26,now: 2024-06-02 05:57:54.410206,epoch time: 0:27:47.289113,used: 12:15:57.077905,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98627603, 'precision': 0.9612695, 'recall': 0.8171668, 'specificity': 0.8171668, 'f1': 0.874957, 'auroc': 0.9922301, 'binary_precision': 0.9350649, 'binary_recall': 0.63586956, 'binary_specificity': 0.9984641, 'binary_f1_score': 0.75697535}
confusion matrix:
       0    1
0  42255   65
1    536  936
---- Validation: 
scalar performance:
{'acc': 0.9828118, 'precision': 0.95256954, 'recall': 0.77133524, 'specificity': 0.77133524, 'f1': 0.8377137, 'auroc': 0.9820748, 'binary_precision': 0.92105263, 'binary_recall': 0.5443235, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.684262}
confusion matrix:
       0    1
0  18119   30
1    293  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.8688197, 'recall': 0.6436762, 'specificity': 0.6436762, 'f1': 0.70255566, 'auroc': 0.96399975, 'binary_precision': 0.7676768, 'binary_recall': 0.29118773, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.42222223}
confusion matrix:
      0   1
0  5974  23
1   185  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_27.png
early stop counter: 6
val acc:0.9828118085861206, best validation acc: 0.9859514832496643, corresponding to test acc:                         0.9600511193275452 / 0.9699584245681763
after epoch: 27,now: 2024-06-02 06:25:37.115752,epoch time: 0:27:42.705546,used: 12:43:39.783451,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9853855, 'precision': 0.8748944, 'recall': 0.91309667, 'specificity': 0.91309667, 'f1': 0.89298654, 'auroc': 0.9911747, 'binary_precision': 0.7555283, 'binary_recall': 0.8355978, 'binary_specificity': 0.99059546, 'binary_f1_score': 0.7935484}
confusion matrix:
       0     1
0  41922   398
1    242  1230
---- Validation: 
scalar performance:
{'acc': 0.98275864, 'precision': 0.87213624, 'recall': 0.86431456, 'specificity': 0.86431456, 'f1': 0.86818016, 'auroc': 0.978407, 'binary_precision': 0.7535771, 'binary_recall': 0.7371695, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.74528295}
confusion matrix:
       0    1
0  17994  155
1    169  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7731155, 'recall': 0.57237816, 'specificity': 0.57237816, 'f1': 0.6086465, 'auroc': 0.94027567, 'binary_precision': 0.58208954, 'binary_recall': 0.14942528, 'binary_specificity': 0.995331, 'binary_f1_score': 0.23780489}
confusion matrix:
      0   1
0  5969  28
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_28.png
early stop counter: 7
val acc:0.982758641242981, best validation acc: 0.9859514832496643, corresponding to test acc:                         0.9600511193275452 / 0.9699584245681763
after epoch: 28,now: 2024-06-02 06:52:46.268591,epoch time: 0:27:09.152839,used: 13:10:48.936290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97974515, 'precision': 0.9839605, 'recall': 0.700801, 'specificity': 0.700801, 'f1': 0.780459, 'auroc': 0.9946244, 'binary_precision': 0.9882943, 'binary_recall': 0.4017675, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.57129043}
confusion matrix:
       0    1
0  42314    7
1    880  591
---- Validation: 
scalar performance:
{'acc': 0.9756811, 'precision': 0.963703, 'recall': 0.6521351, 'specificity': 0.6521351, 'f1': 0.72463965, 'auroc': 0.9841631, 'binary_precision': 0.9514563, 'binary_recall': 0.30482116, 'binary_specificity': 0.999449, 'binary_f1_score': 0.4617197}
confusion matrix:
       0    1
0  18139   10
1    447  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.76272094, 'recall': 0.52407044, 'specificity': 0.52407044, 'f1': 0.53522855, 'auroc': 0.9444227, 'binary_precision': 0.5652174, 'binary_recall': 0.049808428, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.09154929}
confusion matrix:
      0   1
0  5987  10
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_29.png
early stop counter: 8
val acc:0.9756811261177063, best validation acc: 0.9859514832496643, corresponding to test acc:                         0.9600511193275452 / 0.9699584245681763
after epoch: 29,now: 2024-06-02 07:19:46.307378,epoch time: 0:27:00.038787,used: 13:37:48.975077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99050057, 'precision': 0.9261974, 'recall': 0.92787397, 'specificity': 0.92787397, 'f1': 0.92703384, 'auroc': 0.9942559, 'binary_precision': 0.8572395, 'binary_recall': 0.8607337, 'binary_specificity': 0.9950142, 'binary_f1_score': 0.858983}
confusion matrix:
       0     1
0  42109   211
1    205  1267
---- Validation: 
scalar performance:
{'acc': 0.9862707, 'precision': 0.91072834, 'recall': 0.8736334, 'specificity': 0.8736334, 'f1': 0.8912317, 'auroc': 0.9816118, 'binary_precision': 0.8301887, 'binary_recall': 0.7527216, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.7895595}
confusion matrix:
       0    1
0  18050   99
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.8027017, 'recall': 0.64942145, 'specificity': 0.64942145, 'f1': 0.69736063, 'auroc': 0.9353021, 'binary_precision': 0.63492066, 'binary_recall': 0.3065134, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.41343668}
confusion matrix:
      0   1
0  5951  46
1   181  80
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_30.png
better model found
persisted
after epoch: 30,now: 2024-06-02 07:46:42.150448,epoch time: 0:26:55.843070,used: 14:04:44.818147,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_17_41_57_seed_0_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 14:04:44.818147 at 2024-06-02 07:46:42.150448
persisted model performance metric: 

scalar performance:
{'acc': 0.96212846, 'precision': 0.78178525, 'recall': 0.64125836, 'specificity': 0.64125836, 'f1': 0.6856012, 'auroc': 0.9506576, 'binary_precision': 0.59375, 'binary_recall': 0.29118773, 'binary_specificity': 0.991329, 'binary_f1_score': 0.3907455}
confusion matrix:
      0   1
0  5945  52
1   185  76
oracle model performance metric: 

scalar performance:
{'acc': 0.9693193, 'precision': 0.8705051, 'recall': 0.68715394, 'specificity': 0.68715394, 'f1': 0.74592924, 'auroc': 0.9653818, 'binary_precision': 0.76744187, 'binary_recall': 0.37931034, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.5076923}
confusion matrix:
      0   1
0  5967  30
1   162  99
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456549 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456549 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB |   1119 TiB |   1119 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1106 TiB |   1106 TiB |
|       from small pool |  40679 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14486 MiB |  14486 MiB |  14486 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446619 KiB |   1251 MiB |    802 TiB |    802 TiB |
|       from large pool | 435058 KiB |   1243 MiB |    789 TiB |    789 TiB |
|       from small pool |  11560 KiB |     17 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  197601 K  |  197598 K  |
|       from large pool |     187    |    1413    |  102521 K  |  102521 K  |
|       from small pool |    3301    |    6290    |   95080 K  |   95076 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  197601 K  |  197598 K  |
|       from large pool |     187    |    1413    |  102521 K  |  102521 K  |
|       from small pool |    3301    |    6290    |   95080 K  |   95076 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |     637    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |    2804    |  125678 K  |  125678 K  |
|       from large pool |      37    |     600    |   76732 K  |   76732 K  |
|       from small pool |      45    |    2766    |   48945 K  |   48945 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1119 TiB |   1119 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1106 TiB |   1106 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14486 MiB |  14486 MiB |  13604 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     72 MiB |     72 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |    802 TiB |    802 TiB |
|       from large pool |  24320 KiB |   1243 MiB |    789 TiB |    789 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95080 K  |   95080 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95080 K  |   95080 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |     637    |     574    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      36    |      36    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2804    |  125679 K  |  125679 K  |
|       from large pool |       4    |     600    |   76732 K  |   76732 K  |
|       from small pool |       0    |    2766    |   48947 K  |   48947 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1119 TiB |   1119 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1106 TiB |   1106 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14486 MiB |  14486 MiB |  13604 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     72 MiB |     72 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |    802 TiB |    802 TiB |
|       from large pool |  24320 KiB |   1243 MiB |    789 TiB |    789 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95080 K  |   95080 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95080 K  |   95080 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |     637    |     574    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      36    |      36    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2804    |  125679 K  |  125679 K  |
|       from large pool |       4    |     600    |   76732 K  |   76732 K  |
|       from small pool |       0    |    2766    |   48947 K  |   48947 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745

 Experiment start at: 2024-06-02 07:58:57.995327
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96714246, 'precision': 0.9835708, 'recall': 0.5003467, 'specificity': 0.5003467, 'f1': 0.49234122, 'auroc': 0.95118845, 'binary_precision': 1.0, 'binary_recall': 0.0006934813, 'binary_specificity': 1.0, 'binary_f1_score': 0.0013860015}
confusion matrix:
       0  1
0  42414  0
1   1441  1
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.9035055, 'recall': 0.51180404, 'specificity': 0.51180404, 'f1': 0.5141511, 'auroc': 0.9503337, 'binary_precision': 0.84210527, 'binary_recall': 0.023774145, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.046242774}
confusion matrix:
       0   1
0  18064   3
1    657  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.9326068, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-02 08:27:12.709432,epoch time: 0:28:14.714105,used: 0:28:14.714105,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.968237, 'precision': 0.7509345, 'recall': 0.8387755, 'specificity': 0.8387755, 'f1': 0.78754556, 'auroc': 0.96036667, 'binary_precision': 0.5121827, 'binary_recall': 0.7002082, 'binary_specificity': 0.9773429, 'binary_f1_score': 0.5916153}
confusion matrix:
       0     1
0  41454   961
1    432  1009
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.7534042, 'recall': 0.8370889, 'specificity': 0.8370889, 'f1': 0.78855467, 'auroc': 0.96241874, 'binary_precision': 0.5181918, 'binary_recall': 0.6983655, 'binary_specificity': 0.97581226, 'binary_f1_score': 0.59493667}
confusion matrix:
       0    1
0  17630  437
1    203  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9761521, 'precision': 0.87750566, 'recall': 0.801817, 'specificity': 0.801817, 'f1': 0.8350072, 'auroc': 0.94061327, 'binary_precision': 0.7718447, 'binary_recall': 0.61153847, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.68240345}
confusion matrix:
      0    1
0  5899   47
1   101  159
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-02 08:53:58.560831,epoch time: 0:26:45.851399,used: 0:55:00.565504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96962786, 'precision': 0.75946677, 'recall': 0.8225158, 'specificity': 0.8225158, 'f1': 0.78719175, 'auroc': 0.96095574, 'binary_precision': 0.53042036, 'binary_recall': 0.66504854, 'binary_specificity': 0.97998303, 'binary_f1_score': 0.5901538}
confusion matrix:
       0    1
0  41565  849
1    483  959
---- Validation: 
scalar performance:
{'acc': 0.96921027, 'precision': 0.77695274, 'recall': 0.7844721, 'specificity': 0.7844721, 'f1': 0.78065634, 'auroc': 0.9611261, 'binary_precision': 0.5693642, 'binary_recall': 0.5854383, 'binary_specificity': 0.98350585, 'binary_f1_score': 0.57728934}
confusion matrix:
       0    1
0  17769  298
1    279  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97534645, 'precision': 0.97037756, 'recall': 0.71312517, 'specificity': 0.71312517, 'f1': 0.7896446, 'auroc': 0.9409686, 'binary_precision': 0.9652174, 'binary_recall': 0.42692307, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.592}
confusion matrix:
      0    1
0  5942    4
1   149  111
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_3.png
better model found
persisted
after epoch: 3,now: 2024-06-02 09:20:43.187170,epoch time: 0:26:44.626339,used: 1:21:45.191843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9747583, 'precision': 0.8780923, 'recall': 0.66070676, 'specificity': 0.66070676, 'f1': 0.722614, 'auroc': 0.96675146, 'binary_precision': 0.77870214, 'binary_recall': 0.32454923, 'binary_specificity': 0.99686426, 'binary_f1_score': 0.4581498}
confusion matrix:
       0    1
0  42281  133
1    974  468
---- Validation: 
scalar performance:
{'acc': 0.97139806, 'precision': 0.9253788, 'recall': 0.61751896, 'specificity': 0.61751896, 'f1': 0.6788655, 'auroc': 0.9678434, 'binary_precision': 0.878453, 'binary_recall': 0.23625557, 'binary_specificity': 0.99878234, 'binary_f1_score': 0.37236536}
confusion matrix:
       0    1
0  18045   22
1    514  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.9170902, 'recall': 0.5133774, 'specificity': 0.5133774, 'f1': 0.51566154, 'auroc': 0.9538266, 'binary_precision': 0.875, 'binary_recall': 0.026923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5945  1
1   253  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_4.png
better model found
persisted
after epoch: 4,now: 2024-06-02 09:47:34.666734,epoch time: 0:26:51.479564,used: 1:48:36.671407,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97539675, 'precision': 0.82289785, 'recall': 0.7524787, 'specificity': 0.7524787, 'f1': 0.7830043, 'auroc': 0.9716557, 'binary_precision': 0.66219836, 'binary_recall': 0.51386964, 'binary_specificity': 0.99108785, 'binary_f1_score': 0.57868016}
confusion matrix:
       0    1
0  42036  378
1    701  741
---- Validation: 
scalar performance:
{'acc': 0.9730523, 'precision': 0.83261275, 'recall': 0.7270975, 'specificity': 0.7270975, 'f1': 0.7690081, 'auroc': 0.9695198, 'binary_precision': 0.68502206, 'binary_recall': 0.46210995, 'binary_specificity': 0.99208504, 'binary_f1_score': 0.5519077}
confusion matrix:
       0    1
0  17924  143
1    362  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.80973107, 'recall': 0.6126937, 'specificity': 0.6126937, 'f1': 0.660836, 'auroc': 0.95410085, 'binary_precision': 0.65217394, 'binary_recall': 0.23076923, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.34090912}
confusion matrix:
      0   1
0  5914  32
1   200  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_5.png
better model found
persisted
after epoch: 5,now: 2024-06-02 10:14:24.001528,epoch time: 0:26:49.334794,used: 2:15:26.006201,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9693543, 'precision': 0.9423772, 'recall': 0.5373301, 'specificity': 0.5373301, 'f1': 0.5614306, 'auroc': 0.9701747, 'binary_precision': 0.91525424, 'binary_recall': 0.07489598, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.13846153}
confusion matrix:
       0    1
0  42404   10
1   1334  108
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.9618018, 'recall': 0.51706, 'specificity': 0.51706, 'f1': 0.52414936, 'auroc': 0.9648969, 'binary_precision': 0.9583333, 'binary_recall': 0.034175333, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.06599712}
confusion matrix:
       0   1
0  18066   1
1    650  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.97912973, 'recall': 0.5019231, 'specificity': 0.5019231, 'f1': 0.49317387, 'auroc': 0.94671965, 'binary_precision': 1.0, 'binary_recall': 0.0038461538, 'binary_specificity': 1.0, 'binary_f1_score': 0.007662835}
confusion matrix:
      0  1
0  5946  0
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_6.png
early stop counter: 1
val acc:0.9652614593505859, best validation acc: 0.9730523228645325, corresponding to test acc:                         0.9626168012619019 / 0.9761521220207214
after epoch: 6,now: 2024-06-02 10:41:24.783368,epoch time: 0:27:00.781840,used: 2:42:26.788041,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9745303, 'precision': 0.84835184, 'recall': 0.68281245, 'specificity': 0.68281245, 'f1': 0.73786354, 'auroc': 0.9716241, 'binary_precision': 0.7177419, 'binary_recall': 0.370576, 'binary_specificity': 0.99504894, 'binary_f1_score': 0.4887872}
confusion matrix:
       0    1
0  42205  210
1    907  534
---- Validation: 
scalar performance:
{'acc': 0.9729456, 'precision': 0.9008628, 'recall': 0.6548001, 'specificity': 0.6548001, 'f1': 0.71960205, 'auroc': 0.9684509, 'binary_precision': 0.8267717, 'binary_recall': 0.31203565, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.45307443}
confusion matrix:
       0    1
0  18023   44
1    463  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.87444377, 'recall': 0.56270474, 'specificity': 0.56270474, 'f1': 0.5995275, 'auroc': 0.95596504, 'binary_precision': 0.78571427, 'binary_recall': 0.12692308, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.21854305}
confusion matrix:
      0   1
0  5937   9
1   227  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_7.png
early stop counter: 2
val acc:0.9729455709457397, best validation acc: 0.9730523228645325, corresponding to test acc:                         0.9626168012619019 / 0.9761521220207214
after epoch: 7,now: 2024-06-02 11:08:11.335378,epoch time: 0:26:46.552010,used: 3:09:13.340051,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9807324, 'precision': 0.8845304, 'recall': 0.78337324, 'specificity': 0.78337324, 'f1': 0.8257034, 'auroc': 0.97932565, 'binary_precision': 0.78347576, 'binary_recall': 0.57212204, 'binary_specificity': 0.99462444, 'binary_f1_score': 0.66132265}
confusion matrix:
       0    1
0  42186  228
1    617  825
---- Validation: 
scalar performance:
{'acc': 0.97636074, 'precision': 0.9066597, 'recall': 0.7116469, 'specificity': 0.7116469, 'f1': 0.77612793, 'auroc': 0.9756537, 'binary_precision': 0.8343023, 'binary_recall': 0.42644873, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.5644051}
confusion matrix:
       0    1
0  18010   57
1    386  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.9399379, 'recall': 0.5632093, 'specificity': 0.5632093, 'f1': 0.6019949, 'auroc': 0.961657, 'binary_precision': 0.9166667, 'binary_recall': 0.12692308, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.22297297}
confusion matrix:
      0   1
0  5943   3
1   227  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_8.png
better model found
persisted
after epoch: 8,now: 2024-06-02 11:35:06.625308,epoch time: 0:26:55.289930,used: 3:36:08.629981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9782698, 'precision': 0.81532204, 'recall': 0.8842604, 'specificity': 0.8842604, 'f1': 0.8460571, 'auroc': 0.98073524, 'binary_precision': 0.6380576, 'binary_recall': 0.7836338, 'binary_specificity': 0.98488706, 'binary_f1_score': 0.70339245}
confusion matrix:
       0     1
0  41773   641
1    312  1130
---- Validation: 
scalar performance:
{'acc': 0.9788154, 'precision': 0.8429382, 'recall': 0.8581192, 'specificity': 0.8581192, 'f1': 0.8503479, 'auroc': 0.97496825, 'binary_precision': 0.69602275, 'binary_recall': 0.7280832, 'binary_specificity': 0.9881552, 'binary_f1_score': 0.7116921}
confusion matrix:
       0    1
0  17853  214
1    183  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.79762185, 'recall': 0.5861911, 'specificity': 0.5861911, 'f1': 0.62816215, 'auroc': 0.9522178, 'binary_precision': 0.63013697, 'binary_recall': 0.17692308, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.27627626}
confusion matrix:
      0   1
0  5919  27
1   214  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_9.png
better model found
persisted
after epoch: 9,now: 2024-06-02 12:01:59.464114,epoch time: 0:26:52.838806,used: 4:03:01.468787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9758072, 'precision': 0.7927424, 'recall': 0.92217666, 'specificity': 0.92217666, 'f1': 0.8444699, 'auroc': 0.98354733, 'binary_precision': 0.5901562, 'binary_recall': 0.8647711, 'binary_specificity': 0.9795822, 'binary_f1_score': 0.70154715}
confusion matrix:
       0     1
0  41548   866
1    195  1247
---- Validation: 
scalar performance:
{'acc': 0.9796158, 'precision': 0.8376851, 'recall': 0.89715874, 'specificity': 0.89715874, 'f1': 0.864764, 'auroc': 0.97764, 'binary_precision': 0.6825596, 'binary_recall': 0.80832094, 'binary_specificity': 0.98599654, 'binary_f1_score': 0.7401361}
confusion matrix:
       0    1
0  17814  253
1    129  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9703513, 'precision': 0.8375423, 'recall': 0.75465405, 'specificity': 0.75465405, 'f1': 0.7896632, 'auroc': 0.95531, 'binary_precision': 0.6958763, 'binary_recall': 0.5192308, 'binary_specificity': 0.9900774, 'binary_f1_score': 0.5947137}
confusion matrix:
      0    1
0  5887   59
1   125  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_10.png
better model found
persisted
after epoch: 10,now: 2024-06-02 12:28:45.625004,epoch time: 0:26:46.160890,used: 4:29:47.629677,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9801167, 'precision': 0.851508, 'recall': 0.824589, 'specificity': 0.824589, 'f1': 0.83746636, 'auroc': 0.9783318, 'binary_precision': 0.71460843, 'binary_recall': 0.6581137, 'binary_specificity': 0.99106425, 'binary_f1_score': 0.68519855}
confusion matrix:
       0    1
0  42035  379
1    493  949
---- Validation: 
scalar performance:
{'acc': 0.976841, 'precision': 0.8462578, 'recall': 0.7984433, 'specificity': 0.7984433, 'f1': 0.8204105, 'auroc': 0.9716753, 'binary_precision': 0.7071057, 'binary_recall': 0.6062407, 'binary_specificity': 0.99064595, 'binary_f1_score': 0.65279996}
confusion matrix:
       0    1
0  17898  169
1    265  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96761197, 'precision': 0.9042599, 'recall': 0.63920736, 'specificity': 0.63920736, 'f1': 0.7020448, 'auroc': 0.95510197, 'binary_precision': 0.83908045, 'binary_recall': 0.28076923, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.42074928}
confusion matrix:
      0   1
0  5932  14
1   187  73
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_11.png
early stop counter: 1
val acc:0.9768409729003906, best validation acc: 0.9796158075332642, corresponding to test acc:                         0.9703512787818909 / 0.9761521220207214
after epoch: 11,now: 2024-06-02 12:55:24.651846,epoch time: 0:26:39.026842,used: 4:56:26.656519,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98130244, 'precision': 0.9101465, 'recall': 0.76658535, 'specificity': 0.76658535, 'f1': 0.822054, 'auroc': 0.9831704, 'binary_precision': 0.83585316, 'binary_recall': 0.5367545, 'binary_specificity': 0.9964163, 'binary_f1_score': 0.6537162}
confusion matrix:
       0    1
0  42262  152
1    668  774
---- Validation: 
scalar performance:
{'acc': 0.9757204, 'precision': 0.89777577, 'recall': 0.7070232, 'specificity': 0.7070232, 'f1': 0.77006364, 'auroc': 0.97400296, 'binary_precision': 0.81686044, 'binary_recall': 0.41753343, 'binary_specificity': 0.996513, 'binary_f1_score': 0.5526057}
confusion matrix:
       0    1
0  18004   63
1    392  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.8698442, 'recall': 0.59113044, 'specificity': 0.59113044, 'f1': 0.63972175, 'auroc': 0.9565759, 'binary_precision': 0.7741935, 'binary_recall': 0.18461539, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.29813665}
confusion matrix:
      0   1
0  5932  14
1   212  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_12.png
early stop counter: 2
val acc:0.9757204055786133, best validation acc: 0.9796158075332642, corresponding to test acc:                         0.9703512787818909 / 0.9761521220207214
after epoch: 12,now: 2024-06-02 13:22:15.212278,epoch time: 0:26:50.560432,used: 5:23:17.216951,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97893107, 'precision': 0.8316386, 'recall': 0.8427333, 'specificity': 0.8427333, 'f1': 0.83708626, 'auroc': 0.98170453, 'binary_precision': 0.6735925, 'binary_recall': 0.6969487, 'binary_specificity': 0.98851794, 'binary_f1_score': 0.6850716}
confusion matrix:
       0     1
0  41927   487
1    437  1005
---- Validation: 
scalar performance:
{'acc': 0.98036283, 'precision': 0.8811762, 'recall': 0.81529045, 'specificity': 0.81529045, 'f1': 0.84484315, 'auroc': 0.9748794, 'binary_precision': 0.7757685, 'binary_recall': 0.63744426, 'binary_specificity': 0.99313664, 'binary_f1_score': 0.69983685}
confusion matrix:
       0    1
0  17943  124
1    244  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.774675, 'recall': 0.5372843, 'specificity': 0.5372843, 'f1': 0.5575469, 'auroc': 0.94740593, 'binary_precision': 0.5882353, 'binary_recall': 0.07692308, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.13605443}
confusion matrix:
      0   1
0  5932  14
1   240  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_13.png
better model found
persisted
after epoch: 13,now: 2024-06-02 13:48:59.007478,epoch time: 0:26:43.795200,used: 5:50:01.012151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98002553, 'precision': 0.8279727, 'recall': 0.8925371, 'specificity': 0.8925371, 'f1': 0.8570827, 'auroc': 0.98351514, 'binary_precision': 0.6628308, 'binary_recall': 0.7988904, 'binary_specificity': 0.9861838, 'binary_f1_score': 0.7245284}
confusion matrix:
       0     1
0  41828   586
1    290  1152
---- Validation: 
scalar performance:
{'acc': 0.9770544, 'precision': 0.8362998, 'recall': 0.8285953, 'specificity': 0.8285953, 'f1': 0.8323984, 'auroc': 0.97491384, 'binary_precision': 0.6849315, 'binary_recall': 0.6686478, 'binary_specificity': 0.9885427, 'binary_f1_score': 0.6766918}
confusion matrix:
       0    1
0  17860  207
1    223  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7398554, 'recall': 0.6418543, 'specificity': 0.6418543, 'f1': 0.6766405, 'auroc': 0.95192504, 'binary_precision': 0.50993377, 'binary_recall': 0.29615384, 'binary_specificity': 0.98755467, 'binary_f1_score': 0.37469587}
confusion matrix:
      0   1
0  5872  74
1   183  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_14.png
early stop counter: 1
val acc:0.9770544171333313, best validation acc: 0.9803628325462341, corresponding to test acc:                         0.9590718746185303 / 0.9761521220207214
after epoch: 14,now: 2024-06-02 14:15:46.694237,epoch time: 0:26:47.686759,used: 6:16:48.698910,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9836739, 'precision': 0.8695681, 'recall': 0.87600094, 'specificity': 0.87600094, 'f1': 0.8727544, 'auroc': 0.98580587, 'binary_precision': 0.74727523, 'binary_recall': 0.760749, 'binary_specificity': 0.9912529, 'binary_f1_score': 0.75395197}
confusion matrix:
       0     1
0  42043   371
1    345  1097
---- Validation: 
scalar performance:
{'acc': 0.97892207, 'precision': 0.8654804, 'recall': 0.8102516, 'specificity': 0.8102516, 'f1': 0.8354042, 'auroc': 0.97800446, 'binary_precision': 0.7447183, 'binary_recall': 0.62852895, 'binary_specificity': 0.9919743, 'binary_f1_score': 0.68170834}
confusion matrix:
       0    1
0  17922  145
1    250  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.76989853, 'recall': 0.57816243, 'specificity': 0.57816243, 'f1': 0.615819, 'auroc': 0.94959444, 'binary_precision': 0.5753425, 'binary_recall': 0.16153847, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.25225225}
confusion matrix:
      0   1
0  5915  31
1   218  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_15.png
early stop counter: 2
val acc:0.9789220690727234, best validation acc: 0.9803628325462341, corresponding to test acc:                         0.9590718746185303 / 0.9761521220207214
after epoch: 15,now: 2024-06-02 14:42:33.779575,epoch time: 0:26:47.085338,used: 6:43:35.784248,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9855664, 'precision': 0.9260894, 'recall': 0.8314259, 'specificity': 0.8314259, 'f1': 0.87240857, 'auroc': 0.9872773, 'binary_precision': 0.86343217, 'binary_recall': 0.6664355, 'binary_specificity': 0.9964163, 'binary_f1_score': 0.75225043}
confusion matrix:
       0    1
0  42262  152
1    481  961
---- Validation: 
scalar performance:
{'acc': 0.98297757, 'precision': 0.9453877, 'recall': 0.7923274, 'specificity': 0.7923274, 'f1': 0.8517914, 'auroc': 0.97919357, 'binary_precision': 0.9059633, 'binary_recall': 0.5869242, 'binary_specificity': 0.9977307, 'binary_f1_score': 0.71235347}
confusion matrix:
       0    1
0  18026   41
1    278  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.85565716, 'recall': 0.539796, 'specificity': 0.539796, 'f1': 0.5627715, 'auroc': 0.9535402, 'binary_precision': 0.75, 'binary_recall': 0.08076923, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.14583333}
confusion matrix:
      0   1
0  5939   7
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_16.png
better model found
persisted
after epoch: 16,now: 2024-06-02 15:09:00.950233,epoch time: 0:26:27.170658,used: 7:10:02.954906,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98143923, 'precision': 0.8434743, 'recall': 0.8828845, 'specificity': 0.8828845, 'f1': 0.8620117, 'auroc': 0.9854079, 'binary_precision': 0.6945477, 'binary_recall': 0.7773925, 'binary_specificity': 0.9883765, 'binary_f1_score': 0.7336387}
confusion matrix:
       0     1
0  41921   493
1    321  1121
---- Validation: 
scalar performance:
{'acc': 0.98009604, 'precision': 0.8647282, 'recall': 0.83804065, 'specificity': 0.83804065, 'f1': 0.85083044, 'auroc': 0.9766138, 'binary_precision': 0.74115753, 'binary_recall': 0.68499255, 'binary_specificity': 0.99108875, 'binary_f1_score': 0.7119691}
confusion matrix:
       0    1
0  17906  161
1    212  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.8890685, 'recall': 0.62181556, 'specificity': 0.62181556, 'f1': 0.68005204, 'auroc': 0.9575411, 'binary_precision': 0.8101266, 'binary_recall': 0.24615385, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.3775811}
confusion matrix:
      0   1
0  5931  15
1   196  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_17.png
early stop counter: 1
val acc:0.9800960421562195, best validation acc: 0.982977569103241, corresponding to test acc:                         0.9603609442710876 / 0.9761521220207214
after epoch: 17,now: 2024-06-02 15:35:47.320280,epoch time: 0:26:46.370047,used: 7:36:49.324953,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98346865, 'precision': 0.9076408, 'recall': 0.8114549, 'specificity': 0.8114549, 'f1': 0.85263336, 'auroc': 0.98622596, 'binary_precision': 0.82783884, 'binary_recall': 0.6273421, 'binary_specificity': 0.9955676, 'binary_f1_score': 0.71377814}
confusion matrix:
       0    1
0  42227  188
1    537  904
---- Validation: 
scalar performance:
{'acc': 0.9810566, 'precision': 0.92840195, 'recall': 0.77488, 'specificity': 0.77488, 'f1': 0.83361065, 'auroc': 0.9738202, 'binary_precision': 0.87323946, 'binary_recall': 0.55274886, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.67697906}
confusion matrix:
       0    1
0  18013   54
1    301  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.8641461, 'recall': 0.54364216, 'specificity': 0.54364216, 'f1': 0.569246, 'auroc': 0.9557698, 'binary_precision': 0.76666665, 'binary_recall': 0.08846154, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.1586207}
confusion matrix:
      0   1
0  5939   7
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_18.png
early stop counter: 2
val acc:0.9810565710067749, best validation acc: 0.982977569103241, corresponding to test acc:                         0.9603609442710876 / 0.9761521220207214
after epoch: 18,now: 2024-06-02 16:02:52.029565,epoch time: 0:27:04.709285,used: 8:03:54.034238,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9859768, 'precision': 0.8762907, 'recall': 0.91671586, 'specificity': 0.91671586, 'f1': 0.89538294, 'auroc': 0.98991907, 'binary_precision': 0.7579538, 'binary_recall': 0.8425797, 'binary_specificity': 0.99085206, 'binary_f1_score': 0.7980296}
confusion matrix:
       0     1
0  42026   388
1    227  1215
---- Validation: 
scalar performance:
{'acc': 0.9820171, 'precision': 0.8699795, 'recall': 0.8705087, 'specificity': 0.8705087, 'f1': 0.8702439, 'auroc': 0.98259264, 'binary_precision': 0.74925816, 'binary_recall': 0.75037146, 'binary_specificity': 0.99064595, 'binary_f1_score': 0.7498144}
confusion matrix:
       0    1
0  17898  169
1    168  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.78916776, 'recall': 0.55985665, 'specificity': 0.55985665, 'f1': 0.59231615, 'auroc': 0.96061134, 'binary_precision': 0.61538464, 'binary_recall': 0.12307692, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.2051282}
confusion matrix:
      0   1
0  5926  20
1   228  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_19.png
early stop counter: 3
val acc:0.9820170998573303, best validation acc: 0.982977569103241, corresponding to test acc:                         0.9603609442710876 / 0.9761521220207214
after epoch: 19,now: 2024-06-02 16:31:56.268322,epoch time: 0:29:04.238757,used: 8:32:58.272995,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9745987, 'precision': 0.78462625, 'recall': 0.9352849, 'specificity': 0.9352849, 'f1': 0.84242225, 'auroc': 0.9866892, 'binary_precision': 0.57295376, 'binary_recall': 0.89320385, 'binary_specificity': 0.977366, 'binary_f1_score': 0.698103}
confusion matrix:
       0     1
0  41454   960
1    154  1288
---- Validation: 
scalar performance:
{'acc': 0.9752935, 'precision': 0.80221283, 'recall': 0.9242431, 'specificity': 0.9242431, 'f1': 0.8517784, 'auroc': 0.97517383, 'binary_precision': 0.609375, 'binary_recall': 0.8692422, 'binary_specificity': 0.97924393, 'binary_f1_score': 0.71647274}
confusion matrix:
       0    1
0  17692  375
1     88  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.7730842, 'recall': 0.691602, 'specificity': 0.691602, 'f1': 0.7243181, 'auroc': 0.9502827, 'binary_precision': 0.57222223, 'binary_recall': 0.39615384, 'binary_specificity': 0.9870501, 'binary_f1_score': 0.46818182}
confusion matrix:
      0    1
0  5869   77
1   157  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_20.png
early stop counter: 4
val acc:0.9752935171127319, best validation acc: 0.982977569103241, corresponding to test acc:                         0.9603609442710876 / 0.9761521220207214
after epoch: 20,now: 2024-06-02 17:00:56.194807,epoch time: 0:28:59.926485,used: 9:01:58.199480,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9833774, 'precision': 0.8789836, 'recall': 0.85072625, 'specificity': 0.85072625, 'f1': 0.8642625, 'auroc': 0.9875176, 'binary_precision': 0.7678437, 'binary_recall': 0.70873785, 'binary_specificity': 0.99271464, 'binary_f1_score': 0.73710775}
confusion matrix:
       0     1
0  42105   309
1    420  1022
---- Validation: 
scalar performance:
{'acc': 0.98116326, 'precision': 0.88742316, 'recall': 0.82214296, 'specificity': 0.82214296, 'f1': 0.8515185, 'auroc': 0.97722137, 'binary_precision': 0.7877698, 'binary_recall': 0.6508172, 'binary_specificity': 0.99346876, 'binary_f1_score': 0.7127746}
confusion matrix:
       0    1
0  17949  118
1    235  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9540767, 'precision': 0.57712305, 'recall': 0.51260966, 'specificity': 0.51260966, 'f1': 0.5148119, 'auroc': 0.933797, 'binary_precision': 0.19512194, 'binary_recall': 0.03076923, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.05315615}
confusion matrix:
      0   1
0  5913  33
1   252   8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_21.png
early stop counter: 5
val acc:0.9811632633209229, best validation acc: 0.982977569103241, corresponding to test acc:                         0.9603609442710876 / 0.9761521220207214
after epoch: 21,now: 2024-06-02 17:29:45.226432,epoch time: 0:28:49.031625,used: 9:30:47.231105,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98511034, 'precision': 0.882144, 'recall': 0.88444746, 'specificity': 0.88444746, 'f1': 0.883292, 'auroc': 0.9897803, 'binary_precision': 0.77188146, 'binary_recall': 0.776699, 'binary_specificity': 0.99219596, 'binary_f1_score': 0.77428275}
confusion matrix:
       0     1
0  42083   331
1    322  1120
---- Validation: 
scalar performance:
{'acc': 0.97924227, 'precision': 0.8698825, 'recall': 0.8097024, 'specificity': 0.8097024, 'f1': 0.8368887, 'auroc': 0.9756216, 'binary_precision': 0.75357145, 'binary_recall': 0.62704307, 'binary_specificity': 0.9923618, 'binary_f1_score': 0.68450934}
confusion matrix:
       0    1
0  17929  138
1    251  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7402033, 'recall': 0.60139656, 'specificity': 0.60139656, 'f1': 0.63919544, 'auroc': 0.9440451, 'binary_precision': 0.5140187, 'binary_recall': 0.21153846, 'binary_specificity': 0.9912546, 'binary_f1_score': 0.2997275}
confusion matrix:
      0   1
0  5894  52
1   205  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_22.png
early stop counter: 6
val acc:0.9792422652244568, best validation acc: 0.982977569103241, corresponding to test acc:                         0.9603609442710876 / 0.9761521220207214
after epoch: 22,now: 2024-06-02 17:58:37.534086,epoch time: 0:28:52.307654,used: 9:59:39.538759,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.985498, 'precision': 0.88108945, 'recall': 0.8953664, 'specificity': 0.8953664, 'f1': 0.8880855, 'auroc': 0.991111, 'binary_precision': 0.7690254, 'binary_recall': 0.7988904, 'binary_specificity': 0.9918423, 'binary_f1_score': 0.78367347}
confusion matrix:
       0     1
0  42068   346
1    290  1152
---- Validation: 
scalar performance:
{'acc': 0.9790288, 'precision': 0.8672087, 'recall': 0.8095917, 'specificity': 0.8095917, 'f1': 0.8357262, 'auroc': 0.97656465, 'binary_precision': 0.74822694, 'binary_recall': 0.62704307, 'binary_specificity': 0.99214035, 'binary_f1_score': 0.68229586}
confusion matrix:
       0    1
0  17925  142
1    251  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.77270067, 'recall': 0.6024056, 'specificity': 0.6024056, 'f1': 0.6447695, 'auroc': 0.9541017, 'binary_precision': 0.57894737, 'binary_recall': 0.21153846, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.30985913}
confusion matrix:
      0   1
0  5906  40
1   205  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_23.png
early stop counter: 7
val acc:0.9790288209915161, best validation acc: 0.982977569103241, corresponding to test acc:                         0.9603609442710876 / 0.9761521220207214
after epoch: 23,now: 2024-06-02 18:26:20.540882,epoch time: 0:27:43.006796,used: 10:27:22.545555,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98716253, 'precision': 0.89604723, 'recall': 0.90426576, 'specificity': 0.90426576, 'f1': 0.9001108, 'auroc': 0.99342525, 'binary_precision': 0.79837066, 'binary_recall': 0.815534, 'binary_specificity': 0.9929976, 'binary_f1_score': 0.80686104}
confusion matrix:
       0     1
0  42117   297
1    266  1176
---- Validation: 
scalar performance:
{'acc': 0.9836713, 'precision': 0.91238546, 'recall': 0.8363185, 'specificity': 0.8363185, 'f1': 0.870165, 'auroc': 0.976964, 'binary_precision': 0.8366972, 'binary_recall': 0.67756313, 'binary_specificity': 0.9950739, 'binary_f1_score': 0.7487685}
confusion matrix:
       0    1
0  17978   89
1    217  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.8093687, 'recall': 0.5432217, 'specificity': 0.5432217, 'f1': 0.5676913, 'auroc': 0.9440559, 'binary_precision': 0.6571429, 'binary_recall': 0.08846154, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.1559322}
confusion matrix:
      0   1
0  5934  12
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_24.png
better model found
persisted
after epoch: 24,now: 2024-06-02 18:53:23.594185,epoch time: 0:27:03.053303,used: 10:54:25.598858,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98620486, 'precision': 0.95666444, 'recall': 0.8146734, 'specificity': 0.8146734, 'f1': 0.8717109, 'auroc': 0.99070036, 'binary_precision': 0.92573756, 'binary_recall': 0.63106793, 'binary_specificity': 0.99827886, 'binary_f1_score': 0.75051546}
confusion matrix:
       0    1
0  42341   73
1    532  910
---- Validation: 
scalar performance:
{'acc': 0.9811099, 'precision': 0.94632125, 'recall': 0.76203287, 'specificity': 0.76203287, 'f1': 0.8284731, 'auroc': 0.9698348, 'binary_precision': 0.9100257, 'binary_recall': 0.52600294, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.6666666}
confusion matrix:
       0    1
0  18032   35
1    319  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.8162813, 'recall': 0.63351125, 'specificity': 0.63351125, 'f1': 0.6841205, 'auroc': 0.93712205, 'binary_precision': 0.6635514, 'binary_recall': 0.27307692, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.38692096}
confusion matrix:
      0   1
0  5910  36
1   189  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_25.png
early stop counter: 1
val acc:0.9811099171638489, best validation acc: 0.9836713075637817, corresponding to test acc:                         0.9598775506019592 / 0.9761521220207214
after epoch: 25,now: 2024-06-02 19:20:13.420075,epoch time: 0:26:49.825890,used: 11:21:15.424748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9879834, 'precision': 0.8944821, 'recall': 0.9247873, 'specificity': 0.9247873, 'f1': 0.90902686, 'auroc': 0.9926543, 'binary_precision': 0.79383427, 'binary_recall': 0.85714287, 'binary_specificity': 0.99243176, 'binary_f1_score': 0.8242748}
confusion matrix:
       0     1
0  42093   321
1    206  1236
---- Validation: 
scalar performance:
{'acc': 0.98457843, 'precision': 0.8959956, 'recall': 0.8761287, 'specificity': 0.8761287, 'f1': 0.8857837, 'auroc': 0.97827494, 'binary_precision': 0.80094045, 'binary_recall': 0.75928676, 'binary_specificity': 0.9929706, 'binary_f1_score': 0.77955765}
confusion matrix:
       0    1
0  17940  127
1    162  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.8206909, 'recall': 0.6054219, 'specificity': 0.6054219, 'f1': 0.65369534, 'auroc': 0.9492112, 'binary_precision': 0.67469877, 'binary_recall': 0.21538462, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.3265306}
confusion matrix:
      0   1
0  5919  27
1   204  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_26.png
better model found
persisted
after epoch: 26,now: 2024-06-02 19:46:47.658729,epoch time: 0:26:34.238654,used: 11:47:49.663402,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9892147, 'precision': 0.9320482, 'recall': 0.89226365, 'specificity': 0.89226365, 'f1': 0.91112256, 'auroc': 0.9936776, 'binary_precision': 0.87126434, 'binary_recall': 0.7884882, 'binary_specificity': 0.99603903, 'binary_f1_score': 0.82781214}
confusion matrix:
       0     1
0  42246   168
1    305  1137
---- Validation: 
scalar performance:
{'acc': 0.98399144, 'precision': 0.9282372, 'recall': 0.824325, 'specificity': 0.824325, 'f1': 0.8685335, 'auroc': 0.97992253, 'binary_precision': 0.8693069, 'binary_recall': 0.6523031, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.74533105}
confusion matrix:
       0    1
0  18001   66
1    234  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.76612616, 'recall': 0.60407645, 'specificity': 0.60407645, 'f1': 0.6457424, 'auroc': 0.9465486, 'binary_precision': 0.56565654, 'binary_recall': 0.21538462, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.3119777}
confusion matrix:
      0   1
0  5903  43
1   204  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_27.png
early stop counter: 1
val acc:0.9839914441108704, best validation acc: 0.9845784306526184, corresponding to test acc:                         0.9627779722213745 / 0.9761521220207214
after epoch: 27,now: 2024-06-02 20:12:57.898677,epoch time: 0:26:10.239948,used: 12:13:59.903350,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9878694, 'precision': 0.94233966, 'recall': 0.8563981, 'specificity': 0.8563981, 'f1': 0.89440954, 'auroc': 0.99402505, 'binary_precision': 0.8942808, 'binary_recall': 0.7156727, 'binary_specificity': 0.9971236, 'binary_f1_score': 0.7950694}
confusion matrix:
       0     1
0  42292   122
1    410  1032
---- Validation: 
scalar performance:
{'acc': 0.98036283, 'precision': 0.9218253, 'recall': 0.7687981, 'specificity': 0.7687981, 'f1': 0.8270596, 'auroc': 0.9770963, 'binary_precision': 0.86052006, 'binary_recall': 0.5408618, 'binary_specificity': 0.9967344, 'binary_f1_score': 0.66423357}
confusion matrix:
       0    1
0  18008   59
1    309  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.8745209, 'recall': 0.6025848, 'specificity': 0.6025848, 'f1': 0.6549887, 'auroc': 0.943321, 'binary_precision': 0.7826087, 'binary_recall': 0.20769231, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.32826748}
confusion matrix:
      0   1
0  5931  15
1   206  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_28.png
early stop counter: 2
val acc:0.9803628325462341, best validation acc: 0.9845784306526184, corresponding to test acc:                         0.9627779722213745 / 0.9761521220207214
after epoch: 28,now: 2024-06-02 20:39:42.805003,epoch time: 0:26:44.906326,used: 12:40:44.809676,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98780096, 'precision': 0.93923706, 'recall': 0.85837245, 'specificity': 0.85837245, 'f1': 0.8944055, 'auroc': 0.9922942, 'binary_precision': 0.8879384, 'binary_recall': 0.71983355, 'binary_specificity': 0.9969114, 'binary_f1_score': 0.7950977}
confusion matrix:
       0     1
0  42283   131
1    404  1038
---- Validation: 
scalar performance:
{'acc': 0.98281753, 'precision': 0.9388195, 'recall': 0.79510546, 'specificity': 0.79510546, 'f1': 0.851822, 'auroc': 0.9749787, 'binary_precision': 0.89261746, 'binary_recall': 0.59286773, 'binary_specificity': 0.99734324, 'binary_f1_score': 0.7125}
confusion matrix:
       0    1
0  18019   48
1    274  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.7919289, 'recall': 0.5093631, 'specificity': 0.5093631, 'f1': 0.50803417, 'auroc': 0.9508543, 'binary_precision': 0.625, 'binary_recall': 0.01923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.03731343}
confusion matrix:
      0  1
0  5943  3
1   255  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_29.png
early stop counter: 3
val acc:0.982817530632019, best validation acc: 0.9845784306526184, corresponding to test acc:                         0.9627779722213745 / 0.9761521220207214
after epoch: 29,now: 2024-06-02 21:05:49.115768,epoch time: 0:26:06.310765,used: 13:06:51.120441,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.988371, 'precision': 0.8956194, 'recall': 0.9310168, 'specificity': 0.9310168, 'f1': 0.9124961, 'auroc': 0.99485445, 'binary_precision': 0.7956853, 'binary_recall': 0.8696255, 'binary_specificity': 0.99240816, 'binary_f1_score': 0.8310139}
confusion matrix:
       0     1
0  42092   322
1    188  1254
---- Validation: 
scalar performance:
{'acc': 0.98388475, 'precision': 0.88440645, 'recall': 0.8822063, 'specificity': 0.8822063, 'f1': 0.8833029, 'auroc': 0.98373663, 'binary_precision': 0.7772795, 'binary_recall': 0.7726597, 'binary_specificity': 0.9917529, 'binary_f1_score': 0.7749628}
confusion matrix:
       0    1
0  17918  149
1    153  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.7560369, 'recall': 0.5741481, 'specificity': 0.5741481, 'f1': 0.6096474, 'auroc': 0.9469936, 'binary_precision': 0.5479452, 'binary_recall': 0.15384616, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.24024026}
confusion matrix:
      0   1
0  5913  33
1   220  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_30.png
early stop counter: 4
val acc:0.9838847517967224, best validation acc: 0.9845784306526184, corresponding to test acc:                         0.9627779722213745 / 0.9761521220207214
after epoch: 30,now: 2024-06-02 21:31:59.976845,epoch time: 0:26:10.861077,used: 13:33:01.981518,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_07_58_57_seed_1_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:33:01.981518 at 2024-06-02 21:31:59.976845
persisted model performance metric: 

scalar performance:
{'acc': 0.96326137, 'precision': 0.82456386, 'recall': 0.6130301, 'specificity': 0.6130301, 'f1': 0.6629642, 'auroc': 0.9504945, 'binary_precision': 0.6818182, 'binary_recall': 0.23076923, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.3448276}
confusion matrix:
      0   1
0  5918  28
1   200  60
oracle model performance metric: 

scalar performance:
{'acc': 0.97631323, 'precision': 0.8733833, 'recall': 0.8110961, 'specificity': 0.8110961, 'f1': 0.83910584, 'auroc': 0.93903786, 'binary_precision': 0.7627907, 'binary_recall': 0.63076925, 'binary_specificity': 0.99142283, 'binary_f1_score': 0.6905263}
confusion matrix:
      0    1
0  5895   51
1    96  164
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456207 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456207 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  13213 MiB |   2244 TiB |   2244 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   2217 TiB |   2217 TiB |
|       from small pool |  40676 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14486 MiB |  28078 MiB |  13604 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  27992 MiB |  13584 MiB |
|       from small pool |     66 MiB |     72 MiB |     86 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446961 KiB |   1251 MiB |   1605 TiB |   1605 TiB |
|       from large pool | 435388 KiB |   1244 MiB |   1578 TiB |   1578 TiB |
|       from small pool |  11572 KiB |     43 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    6487    |  395836 K  |  395832 K  |
|       from large pool |     187    |    1413    |  205461 K  |  205461 K  |
|       from small pool |    3277    |    6298    |  190374 K  |  190371 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    6487    |  395836 K  |  395832 K  |
|       from large pool |     187    |    1413    |  205461 K  |  205461 K  |
|       from small pool |    3277    |    6298    |  190374 K  |  190371 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     637    |    1208    |     574    |
|       from large pool |     601    |     601    |    1165    |     564    |
|       from small pool |      33    |      36    |      43    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      84    |    2809    |  247521 K  |  247521 K  |
|       from large pool |      40    |     604    |  149049 K  |  149049 K  |
|       from small pool |      44    |    2767    |   98472 K  |   98472 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2244 TiB |   2244 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2217 TiB |   2217 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14486 MiB |  28078 MiB |  27196 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     72 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1605 TiB |   1605 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   1578 TiB |   1578 TiB |
|       from small pool |      0 KiB |     43 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395836 K  |  395836 K  |
|       from large pool |       2    |    1413    |  205461 K  |  205461 K  |
|       from small pool |       0    |    6298    |  190374 K  |  190374 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395836 K  |  395836 K  |
|       from large pool |       2    |    1413    |  205461 K  |  205461 K  |
|       from small pool |       0    |    6298    |  190374 K  |  190374 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1208    |    1145    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      36    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2809    |  247523 K  |  247523 K  |
|       from large pool |       4    |     604    |  149049 K  |  149049 K  |
|       from small pool |       0    |    2767    |   98473 K  |   98473 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2244 TiB |   2244 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2217 TiB |   2217 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14486 MiB |  28078 MiB |  27196 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     72 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1605 TiB |   1605 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   1578 TiB |   1578 TiB |
|       from small pool |      0 KiB |     43 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395836 K  |  395836 K  |
|       from large pool |       2    |    1413    |  205461 K  |  205461 K  |
|       from small pool |       0    |    6298    |  190374 K  |  190374 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395836 K  |  395836 K  |
|       from large pool |       2    |    1413    |  205461 K  |  205461 K  |
|       from small pool |       0    |    6298    |  190374 K  |  190374 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1208    |    1145    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      36    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2809    |  247523 K  |  247523 K  |
|       from large pool |       4    |     604    |  149049 K  |  149049 K  |
|       from small pool |       0    |    2767    |   98473 K  |   98473 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745

 Experiment start at: 2024-06-02 21:39:09.455564
before training, model accuracy: 0.7867023348808289
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99515456, 'precision': 0.9967077, 'recall': 0.9755845, 'specificity': 0.9755845, 'f1': 0.98585606, 'auroc': 0.9986478, 'binary_precision': 0.9986124, 'binary_recall': 0.9513109, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.9743879}
confusion matrix:
       0     1
0  42303     6
1    221  4318
---- Validation: 
scalar performance:
{'acc': 0.9712353, 'precision': 0.7844703, 'recall': 0.66392183, 'specificity': 0.66392183, 'f1': 0.7066064, 'auroc': 0.92326313, 'binary_precision': 0.5906433, 'binary_recall': 0.33554816, 'binary_specificity': 0.99229544, 'binary_f1_score': 0.42796612}
confusion matrix:
       0    1
0  18031  140
1    400  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99226534, 'precision': 0.9957018, 'recall': 0.9641873, 'specificity': 0.9641873, 'f1': 0.97927016, 'auroc': 0.99873793, 'binary_precision': 1.0, 'binary_recall': 0.92837465, 'binary_specificity': 1.0, 'binary_f1_score': 0.9628571}
confusion matrix:
      0    1
0  5997    0
1    52  674
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-02 21:59:27.658641,epoch time: 0:20:18.203077,used: 0:20:18.203077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9927638, 'precision': 0.9737757, 'recall': 0.98556983, 'specificity': 0.98556983, 'f1': 0.97958, 'auroc': 0.9989556, 'binary_precision': 0.9500643, 'binary_recall': 0.97664684, 'binary_specificity': 0.9944929, 'binary_f1_score': 0.96317226}
confusion matrix:
       0     1
0  42076   233
1    106  4433
---- Validation: 
scalar performance:
{'acc': 0.9704363, 'precision': 0.76327235, 'recall': 0.7373895, 'specificity': 0.7373895, 'f1': 0.74959487, 'auroc': 0.9284694, 'binary_precision': 0.5434381, 'binary_recall': 0.4883721, 'binary_specificity': 0.9864069, 'binary_f1_score': 0.5144357}
confusion matrix:
       0    1
0  17924  247
1    308  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9950915, 'precision': 0.9935014, 'recall': 0.9809047, 'specificity': 0.9809047, 'f1': 0.9870963, 'auroc': 0.9983406, 'binary_precision': 0.99148935, 'binary_recall': 0.9628099, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.9769392}
confusion matrix:
      0    1
0  5991    6
1    27  699
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_2.png
new oracle model saved
early stop counter: 1
val acc:0.9704362750053406, best validation acc: 0.9712352752685547, corresponding to test acc:                         0.9922653436660767 / 0.9950914978981018
after epoch: 2,now: 2024-06-02 22:19:09.005025,epoch time: 0:19:41.346384,used: 0:39:59.549461,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99654204, 'precision': 0.99556106, 'recall': 0.98460984, 'specificity': 0.98460984, 'f1': 0.9900079, 'auroc': 0.9986234, 'binary_precision': 0.99435157, 'binary_recall': 0.9698105, 'binary_specificity': 0.99940914, 'binary_f1_score': 0.9819277}
confusion matrix:
       0     1
0  42285    25
1    137  4401
---- Validation: 
scalar performance:
{'acc': 0.971182, 'precision': 0.84322417, 'recall': 0.58358943, 'specificity': 0.58358943, 'f1': 0.6295624, 'auroc': 0.89941764, 'binary_precision': 0.7132867, 'binary_recall': 0.16943522, 'binary_specificity': 0.99774367, 'binary_f1_score': 0.27382553}
confusion matrix:
       0    1
0  18130   41
1    500  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9937528, 'precision': 0.99332917, 'recall': 0.97410107, 'specificity': 0.97410107, 'f1': 0.9834651, 'auroc': 0.99832106, 'binary_precision': 0.9927954, 'binary_recall': 0.9490358, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.97042257}
confusion matrix:
      0    1
0  5992    5
1    37  689
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_3.png
early stop counter: 2
val acc:0.9711819887161255, best validation acc: 0.9712352752685547, corresponding to test acc:                         0.9922653436660767 / 0.9950914978981018
after epoch: 3,now: 2024-06-02 22:38:52.597828,epoch time: 0:19:43.592803,used: 0:59:43.142264,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9964993, 'precision': 0.99776196, 'recall': 0.98222154, 'specificity': 0.98222154, 'f1': 0.98983586, 'auroc': 0.9995824, 'binary_precision': 0.9993149, 'binary_recall': 0.964514, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.9816061}
confusion matrix:
       0     1
0  42308     3
1    161  4376
---- Validation: 
scalar performance:
{'acc': 0.9671869, 'precision': 0.48395437, 'recall': 0.49961478, 'specificity': 0.49961478, 'f1': 0.4916599, 'auroc': 0.9082256, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99922955, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18157  14
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9955377, 'precision': 0.9975112, 'recall': 0.9793389, 'specificity': 0.9793389, 'f1': 0.988204, 'auroc': 0.9997896, 'binary_precision': 1.0, 'binary_recall': 0.9586777, 'binary_specificity': 1.0, 'binary_f1_score': 0.97890294}
confusion matrix:
      0    1
0  5997    0
1    30  696
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_4.png
new oracle model saved
early stop counter: 3
val acc:0.9671869277954102, best validation acc: 0.9712352752685547, corresponding to test acc:                         0.9922653436660767 / 0.9955376982688904
after epoch: 4,now: 2024-06-02 22:58:19.681411,epoch time: 0:19:27.083583,used: 1:19:10.225847,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9921235, 'precision': 0.995677, 'recall': 0.9593433, 'specificity': 0.9593433, 'f1': 0.9766393, 'auroc': 0.99853706, 'binary_precision': 1.0, 'binary_recall': 0.9186866, 'binary_specificity': 1.0, 'binary_f1_score': 0.9576203}
confusion matrix:
       0     1
0  42310     0
1    369  4169
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.9217482, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98720807, 'precision': 0.9929311, 'recall': 0.94077134, 'specificity': 0.94077134, 'f1': 0.96496165, 'auroc': 0.99976087, 'binary_precision': 1.0, 'binary_recall': 0.8815427, 'binary_specificity': 1.0, 'binary_f1_score': 0.9370425}
confusion matrix:
      0    1
0  5997    0
1    86  640
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_5.png
early stop counter: 4
val acc:0.9679326415061951, best validation acc: 0.9712352752685547, corresponding to test acc:                         0.9922653436660767 / 0.9955376982688904
after epoch: 5,now: 2024-06-02 23:17:43.577495,epoch time: 0:19:23.896084,used: 1:38:34.121931,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9883666, 'precision': 0.9491982, 'recall': 0.98942906, 'specificity': 0.98942906, 'f1': 0.9681951, 'auroc': 0.99937, 'binary_precision': 0.8994, 'binary_recall': 0.99074686, 'binary_specificity': 0.98811126, 'binary_f1_score': 0.9428661}
confusion matrix:
       0     1
0  41806   503
1     42  4497
---- Validation: 
scalar performance:
{'acc': 0.9637778, 'precision': 0.70891416, 'recall': 0.71226764, 'specificity': 0.71226764, 'f1': 0.71057594, 'auroc': 0.932358, 'binary_precision': 0.4362745, 'binary_recall': 0.4435216, 'binary_specificity': 0.9810137, 'binary_f1_score': 0.4398682}
confusion matrix:
       0    1
0  17826  345
1    335  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99419904, 'precision': 0.9852293, 'recall': 0.9846418, 'specificity': 0.9846418, 'f1': 0.9849353, 'auroc': 0.9989352, 'binary_precision': 0.9737931, 'binary_recall': 0.9724518, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.97312194}
confusion matrix:
      0    1
0  5978   19
1    20  706
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_6.png
early stop counter: 5
val acc:0.9637777805328369, best validation acc: 0.9712352752685547, corresponding to test acc:                         0.9922653436660767 / 0.9955376982688904
after epoch: 6,now: 2024-06-02 23:37:18.579743,epoch time: 0:19:35.002248,used: 1:58:09.124179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9967555, 'precision': 0.9954863, 'recall': 0.98591137, 'specificity': 0.98591137, 'f1': 0.9906396, 'auroc': 0.9992707, 'binary_precision': 0.99392027, 'binary_recall': 0.97246087, 'binary_specificity': 0.9993618, 'binary_f1_score': 0.9830735}
confusion matrix:
       0     1
0  42282    27
1    125  4414
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.75038326, 'recall': 0.6948605, 'specificity': 0.6948605, 'f1': 0.71881324, 'auroc': 0.92737794, 'binary_precision': 0.5204301, 'binary_recall': 0.40199336, 'binary_specificity': 0.9877277, 'binary_f1_score': 0.45360824}
confusion matrix:
       0    1
0  17948  223
1    360  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99434775, 'precision': 0.9955703, 'recall': 0.97503984, 'specificity': 0.97503984, 'f1': 0.9850211, 'auroc': 0.99807805, 'binary_precision': 0.99710983, 'binary_recall': 0.9504132, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.97320163}
confusion matrix:
      0    1
0  5995    2
1    36  690
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_7.png
early stop counter: 6
val acc:0.968944787979126, best validation acc: 0.9712352752685547, corresponding to test acc:                         0.9922653436660767 / 0.9955376982688904
after epoch: 7,now: 2024-06-02 23:57:00.540442,epoch time: 0:19:41.960699,used: 2:17:51.084878,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9978441, 'precision': 0.99820554, 'recall': 0.9894643, 'specificity': 0.9894643, 'f1': 0.99378586, 'auroc': 0.9995252, 'binary_precision': 0.9986517, 'binary_recall': 0.9790703, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.98876405}
confusion matrix:
       0     1
0  42303     6
1     95  4444
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.7277825, 'recall': 0.560091, 'specificity': 0.560091, 'f1': 0.59082556, 'auroc': 0.9200734, 'binary_precision': 0.48387095, 'binary_recall': 0.12458472, 'binary_specificity': 0.99559736, 'binary_f1_score': 0.1981506}
confusion matrix:
       0   1
0  18091  80
1    527  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9955377, 'precision': 0.9975112, 'recall': 0.9793389, 'specificity': 0.9793389, 'f1': 0.988204, 'auroc': 0.9993268, 'binary_precision': 1.0, 'binary_recall': 0.9586777, 'binary_specificity': 1.0, 'binary_f1_score': 0.97890294}
confusion matrix:
      0    1
0  5997    0
1    30  696
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_8.png
early stop counter: 7
val acc:0.9676663279533386, best validation acc: 0.9712352752685547, corresponding to test acc:                         0.9922653436660767 / 0.9955376982688904
after epoch: 8,now: 2024-06-03 00:16:51.003738,epoch time: 0:19:50.463296,used: 2:37:41.548174,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9980789, 'precision': 0.9978378, 'recall': 0.99116766, 'specificity': 0.99116766, 'f1': 0.9944742, 'auroc': 0.9998106, 'binary_precision': 0.9975397, 'binary_recall': 0.98259526, 'binary_specificity': 0.99974, 'binary_f1_score': 0.99001104}
confusion matrix:
       0     1
0  42298    11
1     79  4460
---- Validation: 
scalar performance:
{'acc': 0.9740052, 'precision': 0.85178375, 'recall': 0.65009475, 'specificity': 0.65009475, 'f1': 0.70763576, 'auroc': 0.93612283, 'binary_precision': 0.72619045, 'binary_recall': 0.3039867, 'binary_specificity': 0.99620277, 'binary_f1_score': 0.42857143}
confusion matrix:
       0    1
0  18102   69
1    419  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9958352, 'precision': 0.9976764, 'recall': 0.9807162, 'specificity': 0.9807162, 'f1': 0.989004, 'auroc': 0.9998119, 'binary_precision': 1.0, 'binary_recall': 0.9614325, 'binary_specificity': 1.0, 'binary_f1_score': 0.98033714}
confusion matrix:
      0    1
0  5997    0
1    28  698
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_9.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-06-03 00:36:49.988557,epoch time: 0:19:58.984819,used: 2:57:40.532993,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9968195, 'precision': 0.99048746, 'recall': 0.9913554, 'specificity': 0.9913554, 'f1': 0.9909209, 'auroc': 0.9995235, 'binary_precision': 0.9826297, 'binary_recall': 0.9845781, 'binary_specificity': 0.99813277, 'binary_f1_score': 0.9836029}
confusion matrix:
       0     1
0  42230    79
1     70  4469
---- Validation: 
scalar performance:
{'acc': 0.97246045, 'precision': 0.79275113, 'recall': 0.6990858, 'specificity': 0.6990858, 'f1': 0.73622227, 'auroc': 0.9251071, 'binary_precision': 0.60493827, 'binary_recall': 0.40697673, 'binary_specificity': 0.9911948, 'binary_f1_score': 0.48659384}
confusion matrix:
       0    1
0  18011  160
1    357  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9949427, 'precision': 0.99718124, 'recall': 0.976584, 'specificity': 0.976584, 'f1': 0.9865979, 'auroc': 0.99916464, 'binary_precision': 1.0, 'binary_recall': 0.95316803, 'binary_specificity': 1.0, 'binary_f1_score': 0.97602254}
confusion matrix:
      0    1
0  5997    0
1    34  692
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_10.png
early stop counter: 1
val acc:0.9724604487419128, best validation acc: 0.9740052223205566, corresponding to test acc:                         0.9958351850509644 / 0.9958351850509644
after epoch: 10,now: 2024-06-03 00:56:50.781733,epoch time: 0:20:00.793176,used: 3:17:41.326169,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9976093, 'precision': 0.99326515, 'recall': 0.9930711, 'specificity': 0.9930711, 'f1': 0.9931681, 'auroc': 0.9997263, 'binary_precision': 0.9878774, 'binary_recall': 0.9874422, 'binary_specificity': 0.9987, 'binary_f1_score': 0.98765975}
confusion matrix:
       0     1
0  42254    55
1     57  4482
---- Validation: 
scalar performance:
{'acc': 0.97112876, 'precision': 0.781865, 'recall': 0.667079, 'specificity': 0.667079, 'f1': 0.70852697, 'auroc': 0.94573283, 'binary_precision': 0.58522725, 'binary_recall': 0.34219268, 'binary_specificity': 0.99196523, 'binary_f1_score': 0.4318658}
confusion matrix:
       0    1
0  18025  146
1    396  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9968764, 'precision': 0.99825525, 'recall': 0.9855372, 'specificity': 0.9855372, 'f1': 0.99178857, 'auroc': 0.9993011, 'binary_precision': 1.0, 'binary_recall': 0.9710744, 'binary_specificity': 1.0, 'binary_f1_score': 0.985325}
confusion matrix:
      0    1
0  5997    0
1    21  705
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_11.png
new oracle model saved
early stop counter: 2
val acc:0.9711287617683411, best validation acc: 0.9740052223205566, corresponding to test acc:                         0.9958351850509644 / 0.9968764185905457
after epoch: 11,now: 2024-06-03 01:16:51.950059,epoch time: 0:20:01.168326,used: 3:37:42.494495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9979508, 'precision': 0.9981648, 'recall': 0.9901112, 'specificity': 0.9901112, 'f1': 0.9940964, 'auroc': 0.999313, 'binary_precision': 0.99842906, 'binary_recall': 0.9803878, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.9893262}
confusion matrix:
       0     1
0  42303     7
1     89  4449
---- Validation: 
scalar performance:
{'acc': 0.97240716, 'precision': 0.89349145, 'recall': 0.58984363, 'specificity': 0.58984363, 'f1': 0.64106166, 'auroc': 0.9416691, 'binary_precision': 0.8134328, 'binary_recall': 0.18106312, 'binary_specificity': 0.9986242, 'binary_f1_score': 0.29619563}
confusion matrix:
       0    1
0  18146   25
1    493  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99464524, 'precision': 0.99701643, 'recall': 0.9752066, 'specificity': 0.9752066, 'f1': 0.98579186, 'auroc': 0.9998302, 'binary_precision': 1.0, 'binary_recall': 0.9504132, 'binary_specificity': 1.0, 'binary_f1_score': 0.9745763}
confusion matrix:
      0    1
0  5997    0
1    36  690
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_12.png
early stop counter: 3
val acc:0.9724071621894836, best validation acc: 0.9740052223205566, corresponding to test acc:                         0.9958351850509644 / 0.9968764185905457
after epoch: 12,now: 2024-06-03 01:36:54.578364,epoch time: 0:20:02.628305,used: 3:57:45.122800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.995368, 'precision': 0.9972408, 'recall': 0.9762875, 'specificity': 0.9762875, 'f1': 0.9864791, 'auroc': 0.9991218, 'binary_precision': 0.9995376, 'binary_recall': 0.9526223, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9755162}
confusion matrix:
       0     1
0  42308     2
1    215  4323
---- Validation: 
scalar performance:
{'acc': 0.9670271, 'precision': 0.4839518, 'recall': 0.49953222, 'specificity': 0.49953222, 'f1': 0.4916186, 'auroc': 0.9346509, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99906445, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18154  17
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9934553, 'precision': 0.9963582, 'recall': 0.969697, 'specificity': 0.969697, 'f1': 0.9825474, 'auroc': 0.9987509, 'binary_precision': 1.0, 'binary_recall': 0.93939394, 'binary_specificity': 1.0, 'binary_f1_score': 0.96874994}
confusion matrix:
      0    1
0  5997    0
1    44  682
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_13.png
early stop counter: 4
val acc:0.9670271277427673, best validation acc: 0.9740052223205566, corresponding to test acc:                         0.9958351850509644 / 0.9968764185905457
after epoch: 13,now: 2024-06-03 01:56:55.929436,epoch time: 0:20:01.351072,used: 4:17:46.473872,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9981002, 'precision': 0.9955876, 'recall': 0.9935396, 'specificity': 0.9935396, 'f1': 0.9945609, 'auroc': 0.9994473, 'binary_precision': 0.99247456, 'binary_recall': 0.9878828, 'binary_specificity': 0.9991964, 'binary_f1_score': 0.99017334}
confusion matrix:
       0     1
0  42275    34
1     55  4484
---- Validation: 
scalar performance:
{'acc': 0.96729344, 'precision': 0.7286534, 'recall': 0.62494534, 'specificity': 0.62494534, 'f1': 0.6600831, 'auroc': 0.9381131, 'binary_precision': 0.4814815, 'binary_recall': 0.2591362, 'binary_specificity': 0.9907545, 'binary_f1_score': 0.33693305}
confusion matrix:
       0    1
0  18003  168
1    446  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9976201, 'precision': 0.99805003, 'recall': 0.989586, 'specificity': 0.989586, 'f1': 0.9937705, 'auroc': 0.99914825, 'binary_precision': 0.9985955, 'binary_recall': 0.9793388, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.98887336}
confusion matrix:
      0    1
0  5996    1
1    15  711
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_14.png
new oracle model saved
early stop counter: 5
val acc:0.9672934412956238, best validation acc: 0.9740052223205566, corresponding to test acc:                         0.9958351850509644 / 0.9976201057434082
after epoch: 14,now: 2024-06-03 02:16:48.716286,epoch time: 0:19:52.786850,used: 4:37:39.260722,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99711835, 'precision': 0.9884474, 'recall': 0.995257, 'specificity': 0.995257, 'f1': 0.9918221, 'auroc': 0.99965054, 'binary_precision': 0.97765243, 'binary_recall': 0.9929484, 'binary_specificity': 0.99756557, 'binary_f1_score': 0.98524106}
confusion matrix:
       0     1
0  42207   103
1     32  4506
---- Validation: 
scalar performance:
{'acc': 0.969584, 'precision': 0.75957566, 'recall': 0.666281, 'specificity': 0.666281, 'f1': 0.7017541, 'auroc': 0.94765884, 'binary_precision': 0.54068244, 'binary_recall': 0.34219268, 'binary_specificity': 0.99036926, 'binary_f1_score': 0.41912514}
confusion matrix:
       0    1
0  17996  175
1    396  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979176, 'precision': 0.998218, 'recall': 0.99096346, 'specificity': 0.99096346, 'f1': 0.99455583, 'auroc': 0.99994075, 'binary_precision': 0.9985994, 'binary_recall': 0.9820937, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.99027777}
confusion matrix:
      0    1
0  5996    1
1    13  713
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_15.png
new oracle model saved
early stop counter: 6
val acc:0.9695839881896973, best validation acc: 0.9740052223205566, corresponding to test acc:                         0.9958351850509644 / 0.9979175925254822
after epoch: 15,now: 2024-06-03 02:36:43.526927,epoch time: 0:19:54.810641,used: 4:57:34.071363,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9979935, 'precision': 0.99848944, 'recall': 0.99003863, 'specificity': 0.99003863, 'f1': 0.99421823, 'auroc': 0.99971473, 'binary_precision': 0.99910176, 'binary_recall': 0.98017186, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9895463}
confusion matrix:
       0     1
0  42305     4
1     90  4449
---- Validation: 
scalar performance:
{'acc': 0.9713951, 'precision': 0.77380955, 'recall': 0.72824824, 'specificity': 0.72824824, 'f1': 0.74876356, 'auroc': 0.93713963, 'binary_precision': 0.56513023, 'binary_recall': 0.46843854, 'binary_specificity': 0.9880579, 'binary_f1_score': 0.51226157}
confusion matrix:
       0    1
0  17954  217
1    320  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9958352, 'precision': 0.9970443, 'recall': 0.9813216, 'specificity': 0.9813216, 'f1': 0.9890176, 'auroc': 0.9995098, 'binary_precision': 0.99857146, 'binary_recall': 0.9628099, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9803646}
confusion matrix:
      0    1
0  5996    1
1    27  699
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_16.png
early stop counter: 7
val acc:0.9713950753211975, best validation acc: 0.9740052223205566, corresponding to test acc:                         0.9958351850509644 / 0.9979175925254822
after epoch: 16,now: 2024-06-03 02:56:41.210579,epoch time: 0:19:57.683652,used: 5:17:31.755015,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99824965, 'precision': 0.9978349, 'recall': 0.9921472, 'specificity': 0.9921472, 'f1': 0.9949703, 'auroc': 0.9995748, 'binary_precision': 0.997322, 'binary_recall': 0.9845781, 'binary_specificity': 0.9997164, 'binary_f1_score': 0.9909091}
confusion matrix:
       0     1
0  42297    12
1     70  4469
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.716432, 'recall': 0.5103846, 'specificity': 0.5103846, 'f1': 0.5124542, 'auroc': 0.9331253, 'binary_precision': 0.4642857, 'binary_recall': 0.021594685, 'binary_specificity': 0.99917454, 'binary_f1_score': 0.041269843}
confusion matrix:
       0   1
0  18156  15
1    589  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9958352, 'precision': 0.9909451, 'recall': 0.9873749, 'specificity': 0.9873749, 'f1': 0.9891515, 'auroc': 0.99952155, 'binary_precision': 0.9847222, 'binary_recall': 0.976584, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.98063624}
confusion matrix:
      0    1
0  5986   11
1    17  709
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_17.png
early stop counter: 8
val acc:0.9678261280059814, best validation acc: 0.9740052223205566, corresponding to test acc:                         0.9958351850509644 / 0.9979175925254822
after epoch: 17,now: 2024-06-03 03:16:25.502042,epoch time: 0:19:44.291463,used: 5:37:16.046478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99824965, 'precision': 0.9989324, 'recall': 0.9910655, 'specificity': 0.9910655, 'f1': 0.99495935, 'auroc': 0.99977225, 'binary_precision': 0.9997757, 'binary_recall': 0.98215467, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.99088687}
confusion matrix:
       0     1
0  42308     1
1     81  4458
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.9218259, 'recall': 0.51157284, 'specificity': 0.51157284, 'f1': 0.5146652, 'auroc': 0.9457854, 'binary_precision': 0.875, 'binary_recall': 0.023255814, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.045307443}
confusion matrix:
       0   1
0  18169   2
1    588  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99643016, 'precision': 0.99800694, 'recall': 0.98347104, 'specificity': 0.98347104, 'f1': 0.99059814, 'auroc': 0.9999368, 'binary_precision': 1.0, 'binary_recall': 0.96694213, 'binary_specificity': 1.0, 'binary_f1_score': 0.9831933}
confusion matrix:
      0    1
0  5997    0
1    24  702
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_18.png
early stop counter: 9
val acc:0.9685719013214111, best validation acc: 0.9740052223205566, corresponding to test acc:                         0.9958351850509644 / 0.9979175925254822
after epoch: 18,now: 2024-06-03 03:36:20.632961,epoch time: 0:19:55.130919,used: 5:57:11.177397,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99818563, 'precision': 0.9988971, 'recall': 0.99073505, 'specificity': 0.99073505, 'f1': 0.9947734, 'auroc': 0.99987304, 'binary_precision': 0.9997756, 'binary_recall': 0.9814937, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9905503}
confusion matrix:
       0     1
0  42308     1
1     84  4455
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.72635645, 'recall': 0.52323335, 'specificity': 0.52323335, 'f1': 0.53561884, 'auroc': 0.92207, 'binary_precision': 0.48333332, 'binary_recall': 0.048172757, 'binary_specificity': 0.998294, 'binary_f1_score': 0.08761329}
confusion matrix:
       0   1
0  18140  31
1    573  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9955377, 'precision': 0.9975112, 'recall': 0.9793389, 'specificity': 0.9793389, 'f1': 0.988204, 'auroc': 0.9993865, 'binary_precision': 1.0, 'binary_recall': 0.9586777, 'binary_specificity': 1.0, 'binary_f1_score': 0.97890294}
confusion matrix:
      0    1
0  5997    0
1    30  696
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_19.png
early stop counter: 10
val acc:0.9678261280059814, best validation acc: 0.9740052223205566, corresponding to test acc:                         0.9958351850509644 / 0.9979175925254822
after epoch: 19,now: 2024-06-03 03:56:35.812721,epoch time: 0:20:15.179760,used: 6:17:26.357157,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9985912, 'precision': 0.9978308, 'recall': 0.9941064, 'specificity': 0.9941064, 'f1': 0.99595976, 'auroc': 0.9998373, 'binary_precision': 0.9968896, 'binary_recall': 0.98854375, 'binary_specificity': 0.9996691, 'binary_f1_score': 0.99269915}
confusion matrix:
       0     1
0  42295    14
1     52  4487
---- Validation: 
scalar performance:
{'acc': 0.9732062, 'precision': 0.83485395, 'recall': 0.6456667, 'specificity': 0.6456667, 'f1': 0.70036244, 'auroc': 0.9492593, 'binary_precision': 0.692607, 'binary_recall': 0.29568106, 'binary_specificity': 0.99565244, 'binary_f1_score': 0.4144354}
confusion matrix:
       0    1
0  18092   79
1    424  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971739, 'precision': 0.9977983, 'recall': 0.9875199, 'specificity': 0.9875199, 'f1': 0.9925889, 'auroc': 0.9999244, 'binary_precision': 0.9985896, 'binary_recall': 0.9752066, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.98675966}
confusion matrix:
      0    1
0  5996    1
1    18  708
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_20.png
early stop counter: 11
val acc:0.9732062220573425, best validation acc: 0.9740052223205566, corresponding to test acc:                         0.9958351850509644 / 0.9979175925254822
after epoch: 20,now: 2024-06-03 04:16:48.678336,epoch time: 0:20:12.865615,used: 6:37:39.222772,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9991675, 'precision': 0.99835443, 'recall': 0.99688333, 'specificity': 0.99688333, 'f1': 0.9976175, 'auroc': 0.99974054, 'binary_precision': 0.9973469, 'binary_recall': 0.99405026, 'binary_specificity': 0.9997164, 'binary_f1_score': 0.9956958}
confusion matrix:
       0     1
0  42298    12
1     27  4511
---- Validation: 
scalar performance:
{'acc': 0.9702765, 'precision': 0.8014016, 'recall': 0.58713686, 'specificity': 0.58713686, 'f1': 0.63101417, 'auroc': 0.94260997, 'binary_precision': 0.62941176, 'binary_recall': 0.17774086, 'binary_specificity': 0.9965329, 'binary_f1_score': 0.27720207}
confusion matrix:
       0    1
0  18108   63
1    495  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9974714, 'precision': 0.99796605, 'recall': 0.9888973, 'specificity': 0.9888973, 'f1': 0.9933771, 'auroc': 0.9998245, 'binary_precision': 0.9985935, 'binary_recall': 0.9779614, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9881698}
confusion matrix:
      0    1
0  5996    1
1    16  710
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_21.png
early stop counter: 12
val acc:0.9702764749526978, best validation acc: 0.9740052223205566, corresponding to test acc:                         0.9958351850509644 / 0.9979175925254822
after epoch: 21,now: 2024-06-03 04:36:55.094377,epoch time: 0:20:06.416041,used: 6:57:45.638813,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9980362, 'precision': 0.9987139, 'recall': 0.9900623, 'specificity': 0.9900623, 'f1': 0.9943401, 'auroc': 0.999587, 'binary_precision': 0.99955064, 'binary_recall': 0.98017186, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.98976636}
confusion matrix:
       0     1
0  42307     2
1     90  4449
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.8224397, 'recall': 0.5204339, 'specificity': 0.5204339, 'f1': 0.5311441, 'auroc': 0.93537045, 'binary_precision': 0.6756757, 'binary_recall': 0.04152824, 'binary_specificity': 0.9993396, 'binary_f1_score': 0.078247264}
confusion matrix:
       0   1
0  18159  12
1    577  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9950915, 'precision': 0.99662626, 'recall': 0.97787803, 'specificity': 0.97787803, 'f1': 0.9870163, 'auroc': 0.9990543, 'binary_precision': 0.99856114, 'binary_recall': 0.95592284, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9767769}
confusion matrix:
      0    1
0  5996    1
1    32  694
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_22.png
early stop counter: 13
val acc:0.9686251282691956, best validation acc: 0.9740052223205566, corresponding to test acc:                         0.9958351850509644 / 0.9979175925254822
after epoch: 22,now: 2024-06-03 04:57:00.998857,epoch time: 0:20:05.904480,used: 7:17:51.543293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9955388, 'precision': 0.9854486, 'recall': 0.98916924, 'specificity': 0.98916924, 'f1': 0.9872999, 'auroc': 0.99926776, 'binary_precision': 0.972908, 'binary_recall': 0.9812693, 'binary_specificity': 0.99706924, 'binary_f1_score': 0.97707075}
confusion matrix:
       0     1
0  42186   124
1     85  4453
---- Validation: 
scalar performance:
{'acc': 0.9620732, 'precision': 0.54853815, 'recall': 0.5122311, 'specificity': 0.5122311, 'f1': 0.5156584, 'auroc': 0.9177495, 'binary_precision': 0.12837838, 'binary_recall': 0.03156146, 'binary_specificity': 0.9929008, 'binary_f1_score': 0.050666664}
confusion matrix:
       0    1
0  18042  129
1    583   19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9952402, 'precision': 0.9935901, 'recall': 0.9815934, 'specificity': 0.9815934, 'f1': 0.98749506, 'auroc': 0.99902093, 'binary_precision': 0.9915014, 'binary_recall': 0.9641873, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.9776536}
confusion matrix:
      0    1
0  5991    6
1    26  700
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_23.png
early stop counter: 14
val acc:0.9620732069015503, best validation acc: 0.9740052223205566, corresponding to test acc:                         0.9958351850509644 / 0.9979175925254822
after epoch: 23,now: 2024-06-03 05:16:56.348501,epoch time: 0:19:55.349644,used: 7:37:46.892937,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99792945, 'precision': 0.99120003, 'recall': 0.99708354, 'specificity': 0.99708354, 'f1': 0.9941195, 'auroc': 0.9999324, 'binary_precision': 0.9828261, 'binary_recall': 0.9960344, 'binary_specificity': 0.99813277, 'binary_f1_score': 0.9893862}
confusion matrix:
       0     1
0  42230    79
1     18  4521
---- Validation: 
scalar performance:
{'acc': 0.9713951, 'precision': 0.946838, 'recall': 0.558805, 'specificity': 0.558805, 'f1': 0.5972826, 'auroc': 0.947729, 'binary_precision': 0.9220779, 'binary_recall': 0.1179402, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.20913108}
confusion matrix:
       0   1
0  18165   6
1    531  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9974714, 'precision': 0.99734956, 'recall': 0.98950267, 'specificity': 0.98950267, 'f1': 0.9933852, 'auroc': 0.99914837, 'binary_precision': 0.99719495, 'binary_recall': 0.9793388, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.9881862}
confusion matrix:
      0    1
0  5995    2
1    15  711
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_24.png
early stop counter: 15
val acc:0.9713950753211975, best validation acc: 0.9740052223205566, corresponding to test acc:                         0.9958351850509644 / 0.9979175925254822
after epoch: 24,now: 2024-06-03 05:36:34.369008,epoch time: 0:19:38.020507,used: 7:57:24.913444,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99818563, 'precision': 0.99799746, 'recall': 0.99162006, 'specificity': 0.99162006, 'f1': 0.9947827, 'auroc': 0.9993026, 'binary_precision': 0.9977649, 'binary_recall': 0.9834765, 'binary_specificity': 0.99976367, 'binary_f1_score': 0.9905692}
confusion matrix:
       0     1
0  42299    10
1     75  4464
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.7428094, 'recall': 0.6278498, 'specificity': 0.6278498, 'f1': 0.66582566, 'auroc': 0.93182135, 'binary_precision': 0.50961536, 'binary_recall': 0.2641196, 'binary_specificity': 0.99158, 'binary_f1_score': 0.34792122}
confusion matrix:
       0    1
0  18018  153
1    443  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9973226, 'precision': 0.9978821, 'recall': 0.98820865, 'specificity': 0.98820865, 'f1': 0.9929832, 'auroc': 0.9992368, 'binary_precision': 0.99859154, 'binary_recall': 0.976584, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.98746514}
confusion matrix:
      0    1
0  5996    1
1    17  709
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_25.png
early stop counter: 16
val acc:0.9682523012161255, best validation acc: 0.9740052223205566, corresponding to test acc:                         0.9958351850509644 / 0.9979175925254822
after epoch: 25,now: 2024-06-03 05:56:05.623462,epoch time: 0:19:31.254454,used: 8:16:56.167898,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9991248, 'precision': 0.9986256, 'recall': 0.99636865, 'specificity': 0.99636865, 'f1': 0.99749386, 'auroc': 0.9999337, 'binary_precision': 0.99800706, 'binary_recall': 0.99294996, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.99547213}
confusion matrix:
       0     1
0  42300     9
1     32  4507
---- Validation: 
scalar performance:
{'acc': 0.9743781, 'precision': 0.8522724, 'recall': 0.65912086, 'specificity': 0.65912086, 'f1': 0.71668786, 'auroc': 0.9518094, 'binary_precision': 0.72659177, 'binary_recall': 0.32225913, 'binary_specificity': 0.9959826, 'binary_f1_score': 0.4464902}
confusion matrix:
       0    1
0  18098   73
1    408  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9982151, 'precision': 0.9983861, 'recall': 0.99234086, 'specificity': 0.99234086, 'f1': 0.9953393, 'auroc': 0.9998441, 'binary_precision': 0.99860334, 'binary_recall': 0.9848485, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.99167824}
confusion matrix:
      0    1
0  5996    1
1    11  715
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_26.png
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-06-03 06:15:55.649402,epoch time: 0:19:50.025940,used: 8:36:46.193838,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99850583, 'precision': 0.9979799, 'recall': 0.9934691, 'specificity': 0.9934691, 'f1': 0.99571157, 'auroc': 0.9995382, 'binary_precision': 0.9973292, 'binary_recall': 0.98722184, 'binary_specificity': 0.9997164, 'binary_f1_score': 0.99224985}
confusion matrix:
       0     1
0  42297    12
1     58  4481
---- Validation: 
scalar performance:
{'acc': 0.97064936, 'precision': 0.85514945, 'recall': 0.5648442, 'specificity': 0.5648442, 'f1': 0.6039457, 'auroc': 0.95026445, 'binary_precision': 0.7383177, 'binary_recall': 0.13122924, 'binary_specificity': 0.9984591, 'binary_f1_score': 0.22284909}
confusion matrix:
       0   1
0  18143  28
1    523  79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99628145, 'precision': 0.99792427, 'recall': 0.98278236, 'specificity': 0.98278236, 'f1': 0.99020034, 'auroc': 0.99975395, 'binary_precision': 1.0, 'binary_recall': 0.9655647, 'binary_specificity': 1.0, 'binary_f1_score': 0.9824807}
confusion matrix:
      0    1
0  5997    0
1    25  701
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_27.png
early stop counter: 1
val acc:0.9706493616104126, best validation acc: 0.9743781089782715, corresponding to test acc:                         0.9982150793075562 / 0.9982150793075562
after epoch: 27,now: 2024-06-03 06:35:50.392311,epoch time: 0:19:54.742909,used: 8:56:40.936747,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99889004, 'precision': 0.99760854, 'recall': 0.99604195, 'specificity': 0.99604195, 'f1': 0.99682367, 'auroc': 0.99979126, 'binary_precision': 0.9960203, 'binary_recall': 0.99250937, 'binary_specificity': 0.99957454, 'binary_f1_score': 0.99426174}
confusion matrix:
       0     1
0  42291    18
1     34  4505
---- Validation: 
scalar performance:
{'acc': 0.97325945, 'precision': 0.7994469, 'recall': 0.7139534, 'specificity': 0.7139534, 'f1': 0.74896324, 'auroc': 0.9496527, 'binary_precision': 0.6173709, 'binary_recall': 0.43687707, 'binary_specificity': 0.9910297, 'binary_f1_score': 0.51167315}
confusion matrix:
       0    1
0  18008  163
1    339  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99806637, 'precision': 0.9989185, 'recall': 0.99104685, 'specificity': 0.99104685, 'f1': 0.9949416, 'auroc': 0.99953103, 'binary_precision': 1.0, 'binary_recall': 0.9820937, 'binary_specificity': 1.0, 'binary_f1_score': 0.99096596}
confusion matrix:
      0    1
0  5997    0
1    13  713
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_28.png
early stop counter: 2
val acc:0.973259449005127, best validation acc: 0.9743781089782715, corresponding to test acc:                         0.9982150793075562 / 0.9982150793075562
after epoch: 28,now: 2024-06-03 06:55:37.151349,epoch time: 0:19:46.759038,used: 9:16:27.695785,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9977587, 'precision': 0.9986612, 'recall': 0.9885319, 'specificity': 0.9885319, 'f1': 0.99353075, 'auroc': 0.999547, 'binary_precision': 0.9997746, 'binary_recall': 0.97708744, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.98830086}
confusion matrix:
       0     1
0  42308     1
1    104  4435
---- Validation: 
scalar performance:
{'acc': 0.9674, 'precision': 0.6864058, 'recall': 0.51658887, 'specificity': 0.51658887, 'f1': 0.5238156, 'auroc': 0.93647164, 'binary_precision': 0.40384614, 'binary_recall': 0.034883723, 'binary_specificity': 0.998294, 'binary_f1_score': 0.06422018}
confusion matrix:
       0   1
0  18140  31
1    581  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99628145, 'precision': 0.99792427, 'recall': 0.98278236, 'specificity': 0.98278236, 'f1': 0.99020034, 'auroc': 0.9994862, 'binary_precision': 1.0, 'binary_recall': 0.9655647, 'binary_specificity': 1.0, 'binary_f1_score': 0.9824807}
confusion matrix:
      0    1
0  5997    0
1    25  701
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_29.png
early stop counter: 3
val acc:0.9674000144004822, best validation acc: 0.9743781089782715, corresponding to test acc:                         0.9982150793075562 / 0.9982150793075562
after epoch: 29,now: 2024-06-03 07:15:21.561093,epoch time: 0:19:44.409744,used: 9:36:12.105529,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99856985, 'precision': 0.99920946, 'recall': 0.9926195, 'specificity': 0.9926195, 'f1': 0.99588674, 'auroc': 0.9997345, 'binary_precision': 1.0, 'binary_recall': 0.985239, 'binary_specificity': 1.0, 'binary_f1_score': 0.9925646}
confusion matrix:
       0     1
0  42309     0
1     67  4472
---- Validation: 
scalar performance:
{'acc': 0.9699569, 'precision': 0.81782675, 'recall': 0.56288034, 'specificity': 0.56288034, 'f1': 0.59958506, 'auroc': 0.92966664, 'binary_precision': 0.6637931, 'binary_recall': 0.12790698, 'binary_specificity': 0.9978537, 'binary_f1_score': 0.21448468}
confusion matrix:
       0   1
0  18132  39
1    525  77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9974714, 'precision': 0.99858665, 'recall': 0.988292, 'specificity': 0.988292, 'f1': 0.993369, 'auroc': 0.99942565, 'binary_precision': 1.0, 'binary_recall': 0.976584, 'binary_specificity': 1.0, 'binary_f1_score': 0.98815334}
confusion matrix:
      0    1
0  5997    0
1    17  709
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011745_30.png
early stop counter: 4
val acc:0.9699568748474121, best validation acc: 0.9743781089782715, corresponding to test acc:                         0.9982150793075562 / 0.9982150793075562
after epoch: 30,now: 2024-06-03 07:35:12.001329,epoch time: 0:19:50.440236,used: 9:56:02.545765,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_21_39_09_seed_2_21011745
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:56:02.545765 at 2024-06-03 07:35:12.001329
persisted model performance metric: 

scalar performance:
{'acc': 0.9974714, 'precision': 0.99858665, 'recall': 0.988292, 'specificity': 0.988292, 'f1': 0.993369, 'auroc': 0.99959326, 'binary_precision': 1.0, 'binary_recall': 0.976584, 'binary_specificity': 1.0, 'binary_f1_score': 0.98815334}
confusion matrix:
      0    1
0  5997    0
1    17  709
oracle model performance metric: 

scalar performance:
{'acc': 0.9976201, 'precision': 0.9986695, 'recall': 0.9889807, 'specificity': 0.9889807, 'f1': 0.99376285, 'auroc': 0.9994887, 'binary_precision': 1.0, 'binary_recall': 0.9779614, 'binary_specificity': 1.0, 'binary_f1_score': 0.9888579}
confusion matrix:
      0    1
0  5997    0
1    16  710
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456306 KiB |  13219 MiB |   3451 TiB |   3451 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   3410 TiB |   3410 TiB |
|       from small pool |  41774 KiB |     61 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456306 KiB |  13219 MiB |   3451 TiB |   3451 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   3410 TiB |   3410 TiB |
|       from small pool |  41774 KiB |     61 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447775 KiB |  13213 MiB |   3442 TiB |   3442 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   3401 TiB |   3401 TiB |
|       from small pool |  40700 KiB |     60 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14486 MiB |  41670 MiB |  27196 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  41570 MiB |  27162 MiB |
|       from small pool |     66 MiB |     72 MiB |    100 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 444814 KiB |   1251 MiB |   2460 TiB |   2460 TiB |
|       from large pool | 435388 KiB |   1244 MiB |   2419 TiB |   2419 TiB |
|       from small pool |   9425 KiB |     43 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3662    |    6861    |  606534 K  |  606530 K  |
|       from large pool |     187    |    1413    |  315112 K  |  315111 K  |
|       from small pool |    3475    |    6672    |  291422 K  |  291418 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3662    |    6861    |  606534 K  |  606530 K  |
|       from large pool |     187    |    1413    |  315112 K  |  315111 K  |
|       from small pool |    3475    |    6672    |  291422 K  |  291418 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     637    |    1779    |    1145    |
|       from large pool |     601    |     601    |    1729    |    1128    |
|       from small pool |      33    |      36    |      50    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      81    |    2997    |  377220 K  |  377220 K  |
|       from large pool |      40    |     604    |  226143 K  |  226143 K  |
|       from small pool |      41    |    2955    |  151076 K  |  151076 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   3451 TiB |   3451 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3410 TiB |   3410 TiB |
|       from small pool |      0 KiB |     61 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   3451 TiB |   3451 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3410 TiB |   3410 TiB |
|       from small pool |      0 KiB |     61 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   3442 TiB |   3442 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   3401 TiB |   3401 TiB |
|       from small pool |      0 KiB |     60 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14486 MiB |  41670 MiB |  40790 MiB |
|       from large pool |    830 MiB |  14414 MiB |  41570 MiB |  40740 MiB |
|       from small pool |     50 MiB |     72 MiB |    100 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   2460 TiB |   2460 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   2419 TiB |   2419 TiB |
|       from small pool |      0 KiB |     43 MiB |     40 TiB |     40 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6861    |  606534 K  |  606534 K  |
|       from large pool |       2    |    1413    |  315112 K  |  315112 K  |
|       from small pool |       0    |    6672    |  291422 K  |  291422 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6861    |  606534 K  |  606534 K  |
|       from large pool |       2    |    1413    |  315112 K  |  315112 K  |
|       from small pool |       0    |    6672    |  291422 K  |  291422 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    1779    |    1717    |
|       from large pool |      37    |     601    |    1729    |    1692    |
|       from small pool |      25    |      36    |      50    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2997    |  377222 K  |  377222 K  |
|       from large pool |       4    |     604    |  226144 K  |  226144 K  |
|       from small pool |       0    |    2955    |  151078 K  |  151078 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jun  3 07:36:58 2024]
Finished job 0.
1 of 1 steps (100%) done
