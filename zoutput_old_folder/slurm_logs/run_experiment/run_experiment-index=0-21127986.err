Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jun  5 22:36:39 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986

 Experiment start at: 2024-06-05 22:52:07.420245
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97065675, 'precision': 0.7751572, 'recall': 0.7644967, 'specificity': 0.7644967, 'f1': 0.76971066, 'auroc': 0.9596196, 'binary_precision': 0.5661713, 'binary_recall': 0.54347825, 'binary_specificity': 0.9855151, 'binary_f1_score': 0.5545927}
confusion matrix:
       0    1
0  41707  613
1    672  800
---- Validation: 
scalar performance:
{'acc': 0.96855044, 'precision': 0.76338565, 'recall': 0.7392001, 'specificity': 0.7392001, 'f1': 0.75064826, 'auroc': 0.9574505, 'binary_precision': 0.54467356, 'binary_recall': 0.49300155, 'binary_specificity': 0.98539865, 'binary_f1_score': 0.517551}
confusion matrix:
       0    1
0  17884  265
1    326  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.90510666, 'recall': 0.61210966, 'specificity': 0.61210966, 'f1': 0.6695075, 'auroc': 0.9350355, 'binary_precision': 0.8428571, 'binary_recall': 0.22605364, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.3564955}
confusion matrix:
      0   1
0  5986  11
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-05 23:17:47.723006,epoch time: 0:25:40.302761,used: 0:25:40.302761,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97878605, 'precision': 0.8561642, 'recall': 0.79198074, 'specificity': 0.79198074, 'f1': 0.8206248, 'auroc': 0.96903074, 'binary_precision': 0.7264387, 'binary_recall': 0.59171194, 'binary_specificity': 0.99224955, 'binary_f1_score': 0.65219015}
confusion matrix:
       0    1
0  41992  328
1    601  871
---- Validation: 
scalar performance:
{'acc': 0.9779161, 'precision': 0.854271, 'recall': 0.7830517, 'specificity': 0.7830517, 'f1': 0.8143389, 'auroc': 0.96789974, 'binary_precision': 0.7235294, 'binary_recall': 0.57387245, 'binary_specificity': 0.99223095, 'binary_f1_score': 0.6400693}
confusion matrix:
       0    1
0  18008  141
1    274  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.92692477, 'recall': 0.6047804, 'specificity': 0.6047804, 'f1': 0.66154414, 'auroc': 0.9460522, 'binary_precision': 0.88709676, 'binary_recall': 0.21072797, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.3405573}
confusion matrix:
      0   1
0  5990   7
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_2.png
better model found
persisted
after epoch: 2,now: 2024-06-05 23:42:13.317325,epoch time: 0:24:25.594319,used: 0:50:05.897080,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98049873, 'precision': 0.8767901, 'recall': 0.7981126, 'specificity': 0.7981126, 'f1': 0.8324928, 'auroc': 0.9739779, 'binary_precision': 0.767301, 'binary_recall': 0.6025815, 'binary_specificity': 0.99364364, 'binary_f1_score': 0.675038}
confusion matrix:
       0    1
0  42051  269
1    585  887
---- Validation: 
scalar performance:
{'acc': 0.9782354, 'precision': 0.8655293, 'recall': 0.7719662, 'specificity': 0.7719662, 'f1': 0.81131256, 'auroc': 0.9682636, 'binary_precision': 0.7468355, 'binary_recall': 0.5505443, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.6338407}
confusion matrix:
       0    1
0  18029  120
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8402616, 'recall': 0.54331094, 'specificity': 0.54331094, 'f1': 0.56839436, 'auroc': 0.9451324, 'binary_precision': 0.71875, 'binary_recall': 0.08812261, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.1569966}
confusion matrix:
      0   1
0  5988   9
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_3.png
better model found
persisted
after epoch: 3,now: 2024-06-06 00:06:37.862141,epoch time: 0:24:24.544816,used: 1:14:30.441896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97718763, 'precision': 0.9461028, 'recall': 0.6767309, 'specificity': 0.6767309, 'f1': 0.7496673, 'auroc': 0.9804865, 'binary_precision': 0.91418564, 'binary_recall': 0.35461956, 'binary_specificity': 0.9988422, 'binary_f1_score': 0.5110132}
confusion matrix:
       0    1
0  42271   49
1    950  522
---- Validation: 
scalar performance:
{'acc': 0.97451043, 'precision': 0.940598, 'recall': 0.64177823, 'specificity': 0.64177823, 'f1': 0.7100491, 'auroc': 0.97433746, 'binary_precision': 0.9059406, 'binary_recall': 0.28460342, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.43313608}
confusion matrix:
       0    1
0  18130   19
1    460  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.94904476, 'recall': 0.52865225, 'specificity': 0.52865225, 'f1': 0.54406095, 'auroc': 0.9574663, 'binary_precision': 0.9375, 'binary_recall': 0.057471264, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.10830325}
confusion matrix:
      0   1
0  5996   1
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_4.png
early stop counter: 1
val acc:0.9745104312896729, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9605305194854736 / 0.9659635424613953
after epoch: 4,now: 2024-06-06 00:30:34.150087,epoch time: 0:23:56.287946,used: 1:38:26.729842,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98364997, 'precision': 0.8850638, 'recall': 0.85416764, 'specificity': 0.85416764, 'f1': 0.86891603, 'auroc': 0.9827196, 'binary_precision': 0.78, 'binary_recall': 0.71535325, 'binary_specificity': 0.99298203, 'binary_f1_score': 0.74627924}
confusion matrix:
       0     1
0  42023   297
1    419  1053
---- Validation: 
scalar performance:
{'acc': 0.98174757, 'precision': 0.8733196, 'recall': 0.83903927, 'specificity': 0.83903927, 'f1': 0.85528314, 'auroc': 0.97598183, 'binary_precision': 0.757732, 'binary_recall': 0.6858476, 'binary_specificity': 0.99223095, 'binary_f1_score': 0.72}
confusion matrix:
       0    1
0  18008  141
1    202  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.93054783, 'recall': 0.5667163, 'specificity': 0.5667163, 'f1': 0.6072528, 'auroc': 0.95719653, 'binary_precision': 0.8974359, 'binary_recall': 0.13409962, 'binary_specificity': 0.999333, 'binary_f1_score': 0.23333333}
confusion matrix:
      0   1
0  5993   4
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_5.png
better model found
persisted
after epoch: 5,now: 2024-06-06 00:54:28.535590,epoch time: 0:23:54.385503,used: 2:02:21.115345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98392403, 'precision': 0.9087419, 'recall': 0.8261136, 'specificity': 0.8261136, 'f1': 0.86242175, 'auroc': 0.9857615, 'binary_precision': 0.82933104, 'binary_recall': 0.6569294, 'binary_specificity': 0.99529773, 'binary_f1_score': 0.7331312}
confusion matrix:
       0    1
0  42121  199
1    505  967
---- Validation: 
scalar performance:
{'acc': 0.98249257, 'precision': 0.8894532, 'recall': 0.8289242, 'specificity': 0.8289242, 'f1': 0.85642767, 'auroc': 0.97994125, 'binary_precision': 0.7907407, 'binary_recall': 0.66407466, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.72189355}
confusion matrix:
       0    1
0  18036  113
1    216  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8550545, 'recall': 0.522655, 'specificity': 0.522655, 'f1': 0.5329855, 'auroc': 0.9532517, 'binary_precision': 0.75, 'binary_recall': 0.04597701, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0866426}
confusion matrix:
      0   1
0  5993   4
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_6.png
better model found
persisted
after epoch: 6,now: 2024-06-06 01:18:18.609910,epoch time: 0:23:50.074320,used: 2:26:11.189665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9865272, 'precision': 0.93602014, 'recall': 0.84374833, 'specificity': 0.84374833, 'f1': 0.8840183, 'auroc': 0.98848164, 'binary_precision': 0.8827107, 'binary_recall': 0.6906866, 'binary_specificity': 0.9968101, 'binary_f1_score': 0.7749809}
confusion matrix:
       0     1
0  42186   135
1    455  1016
---- Validation: 
scalar performance:
{'acc': 0.9845679, 'precision': 0.9265677, 'recall': 0.82324815, 'specificity': 0.82324815, 'f1': 0.8672484, 'auroc': 0.9805375, 'binary_precision': 0.86542445, 'binary_recall': 0.65007776, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.74245113}
confusion matrix:
       0    1
0  18084   65
1    225  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.8135321, 'recall': 0.5262363, 'specificity': 0.5262363, 'f1': 0.53926444, 'auroc': 0.9520043, 'binary_precision': 0.6666667, 'binary_recall': 0.053639848, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.09929079}
confusion matrix:
      0   1
0  5990   7
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_7.png
better model found
persisted
after epoch: 7,now: 2024-06-06 01:42:13.192550,epoch time: 0:23:54.582640,used: 2:50:05.772305,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9854996, 'precision': 0.9382098, 'recall': 0.82353127, 'specificity': 0.82353127, 'f1': 0.8716099, 'auroc': 0.9889637, 'binary_precision': 0.88847584, 'binary_recall': 0.64989805, 'binary_specificity': 0.99716455, 'binary_f1_score': 0.7506871}
confusion matrix:
       0    1
0  42201  120
1    515  956
---- Validation: 
scalar performance:
{'acc': 0.9841422, 'precision': 0.930547, 'recall': 0.81177694, 'specificity': 0.81177694, 'f1': 0.8609518, 'auroc': 0.9802511, 'binary_precision': 0.8741866, 'binary_recall': 0.62674963, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.73007244}
confusion matrix:
       0    1
0  18091   58
1    240  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.93889457, 'recall': 0.5801263, 'specificity': 0.5801263, 'f1': 0.6276752, 'auroc': 0.95725775, 'binary_precision': 0.9130435, 'binary_recall': 0.16091955, 'binary_specificity': 0.999333, 'binary_f1_score': 0.27361566}
confusion matrix:
      0   1
0  5993   4
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_8.png
early stop counter: 1
val acc:0.9841421842575073, best validation acc: 0.9845678806304932, corresponding to test acc:                         0.9594119787216187 / 0.9659635424613953
after epoch: 8,now: 2024-06-06 02:06:09.485618,epoch time: 0:23:56.293068,used: 3:14:02.065373,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98894775, 'precision': 0.9176407, 'recall': 0.9105009, 'specificity': 0.9105009, 'f1': 0.9140375, 'auroc': 0.99194646, 'binary_precision': 0.8413028, 'binary_recall': 0.8264125, 'binary_specificity': 0.9945892, 'binary_f1_score': 0.8337912}
confusion matrix:
       0     1
0  42094   229
1    255  1214
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.8973488, 'recall': 0.8854139, 'specificity': 0.8854139, 'f1': 0.89128256, 'auroc': 0.9810548, 'binary_precision': 0.8025682, 'binary_recall': 0.777605, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.78988934}
confusion matrix:
       0    1
0  18026  123
1    143  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8803383, 'recall': 0.60228103, 'specificity': 0.60228103, 'f1': 0.6550667, 'auroc': 0.9572742, 'binary_precision': 0.7941176, 'binary_recall': 0.20689656, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.32826746}
confusion matrix:
      0   1
0  5983  14
1   207  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_9.png
better model found
persisted
after epoch: 9,now: 2024-06-06 02:30:01.428905,epoch time: 0:23:51.943287,used: 3:37:54.008660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9889249, 'precision': 0.9245415, 'recall': 0.90083003, 'specificity': 0.90083003, 'f1': 0.91231793, 'auroc': 0.9930974, 'binary_precision': 0.8558039, 'binary_recall': 0.8063859, 'binary_specificity': 0.9952741, 'binary_f1_score': 0.8303603}
confusion matrix:
       0     1
0  42120   200
1    285  1187
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.9030914, 'recall': 0.86485934, 'specificity': 0.86485934, 'f1': 0.8829449, 'auroc': 0.98078895, 'binary_precision': 0.81551725, 'binary_recall': 0.7356143, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.7735078}
confusion matrix:
       0    1
0  18042  107
1    170  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.91013587, 'recall': 0.6406786, 'specificity': 0.6406786, 'f1': 0.7044254, 'auroc': 0.9626204, 'binary_precision': 0.85057473, 'binary_recall': 0.2835249, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.42528737}
confusion matrix:
      0   1
0  5984  13
1   187  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_10.png
new oracle model saved
early stop counter: 1
val acc:0.9852597117424011, best validation acc: 0.9858450293540955, corresponding to test acc:                         0.9646852016448975 / 0.9680408835411072
after epoch: 10,now: 2024-06-06 02:53:53.511071,epoch time: 0:23:52.082166,used: 4:01:46.090826,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9865272, 'precision': 0.9344811, 'recall': 0.8454927, 'specificity': 0.8454927, 'f1': 0.8845304, 'auroc': 0.9921819, 'binary_precision': 0.8795181, 'binary_recall': 0.6942935, 'binary_specificity': 0.9966919, 'binary_f1_score': 0.7760061}
confusion matrix:
       0     1
0  42180   140
1    450  1022
---- Validation: 
scalar performance:
{'acc': 0.9848872, 'precision': 0.9320127, 'recall': 0.82341343, 'specificity': 0.82341343, 'f1': 0.86932003, 'auroc': 0.9807941, 'binary_precision': 0.8763103, 'binary_recall': 0.65007776, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.7464286}
confusion matrix:
       0    1
0  18090   59
1    225  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8961932, 'recall': 0.50949514, 'specificity': 0.50949514, 'f1': 0.50823593, 'auroc': 0.94540226, 'binary_precision': 0.8333333, 'binary_recall': 0.019157087, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.037453182}
confusion matrix:
      0  1
0  5996  1
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_11.png
early stop counter: 2
val acc:0.9848871827125549, best validation acc: 0.9858450293540955, corresponding to test acc:                         0.9646852016448975 / 0.9680408835411072
after epoch: 11,now: 2024-06-06 03:17:42.560959,epoch time: 0:23:49.049888,used: 4:25:35.140714,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99029505, 'precision': 0.95966756, 'recall': 0.88466287, 'specificity': 0.88466287, 'f1': 0.91858846, 'auroc': 0.9948875, 'binary_precision': 0.92722815, 'binary_recall': 0.7714286, 'binary_specificity': 0.9978971, 'binary_f1_score': 0.8421834}
confusion matrix:
       0     1
0  42233    89
1    336  1134
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.91796815, 'recall': 0.82375026, 'specificity': 0.82375026, 'f1': 0.8644118, 'auroc': 0.97998, 'binary_precision': 0.84817815, 'binary_recall': 0.65163296, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.7370272}
confusion matrix:
       0    1
0  18074   75
1    224  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.87536275, 'recall': 0.5832907, 'specificity': 0.5832907, 'f1': 0.6294153, 'auroc': 0.9556469, 'binary_precision': 0.78571427, 'binary_recall': 0.16858238, 'binary_specificity': 0.997999, 'binary_f1_score': 0.27760252}
confusion matrix:
      0   1
0  5985  12
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_12.png
early stop counter: 3
val acc:0.9840889573097229, best validation acc: 0.9858450293540955, corresponding to test acc:                         0.9646852016448975 / 0.9680408835411072
after epoch: 12,now: 2024-06-06 03:41:29.010156,epoch time: 0:23:46.449197,used: 4:49:21.589911,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99036354, 'precision': 0.95457375, 'recall': 0.8910097, 'specificity': 0.8910097, 'f1': 0.920224, 'auroc': 0.994714, 'binary_precision': 0.91660047, 'binary_recall': 0.78450036, 'binary_specificity': 0.99751896, 'binary_f1_score': 0.84542125}
confusion matrix:
       0     1
0  42216   105
1    317  1154
---- Validation: 
scalar performance:
{'acc': 0.9860047, 'precision': 0.93299663, 'recall': 0.84199333, 'specificity': 0.84199333, 'f1': 0.88174415, 'auroc': 0.98255336, 'binary_precision': 0.8769841, 'binary_recall': 0.6874028, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.7707062}
confusion matrix:
       0    1
0  18087   62
1    201  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.89583, 'recall': 0.5986997, 'specificity': 0.5986997, 'f1': 0.6514715, 'auroc': 0.95800006, 'binary_precision': 0.82539684, 'binary_recall': 0.19923371, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.32098764}
confusion matrix:
      0   1
0  5986  11
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_13.png
better model found
persisted
after epoch: 13,now: 2024-06-06 04:05:15.760725,epoch time: 0:23:46.750569,used: 5:13:08.340480,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98970133, 'precision': 0.96686435, 'recall': 0.86844575, 'specificity': 0.86844575, 'f1': 0.91144097, 'auroc': 0.9956583, 'binary_precision': 0.942758, 'binary_recall': 0.73845106, 'binary_specificity': 0.99844044, 'binary_f1_score': 0.82819045}
confusion matrix:
       0     1
0  42254    66
1    385  1087
---- Validation: 
scalar performance:
{'acc': 0.98483396, 'precision': 0.9551991, 'recall': 0.8023844, 'specificity': 0.8023844, 'f1': 0.86229515, 'auroc': 0.9802757, 'binary_precision': 0.9241706, 'binary_recall': 0.60653186, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.7323944}
confusion matrix:
       0    1
0  18117   32
1    253  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.9054425, 'recall': 0.5323169, 'specificity': 0.5323169, 'f1': 0.55040425, 'auroc': 0.9530896, 'binary_precision': 0.85, 'binary_recall': 0.0651341, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.12099644}
confusion matrix:
      0   1
0  5994   3
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_14.png
early stop counter: 1
val acc:0.9848339557647705, best validation acc: 0.9860047101974487, corresponding to test acc:                         0.9648450016975403 / 0.9680408835411072
after epoch: 14,now: 2024-06-06 04:29:16.294501,epoch time: 0:24:00.533776,used: 5:37:08.874256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.988217, 'precision': 0.95713794, 'recall': 0.85239714, 'specificity': 0.85239714, 'f1': 0.89750403, 'auroc': 0.9954395, 'binary_precision': 0.9243772, 'binary_recall': 0.7068027, 'binary_specificity': 0.99799156, 'binary_f1_score': 0.8010794}
confusion matrix:
       0     1
0  42237    85
1    431  1039
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.93616664, 'recall': 0.82585645, 'specificity': 0.82585645, 'f1': 0.87243056, 'auroc': 0.9804504, 'binary_precision': 0.8844538, 'binary_recall': 0.6547434, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.7524575}
confusion matrix:
       0    1
0  18094   55
1    222  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.91878814, 'recall': 0.55330634, 'specificity': 0.55330634, 'f1': 0.5858683, 'auroc': 0.9436832, 'binary_precision': 0.875, 'binary_recall': 0.107279696, 'binary_specificity': 0.999333, 'binary_f1_score': 0.19112627}
confusion matrix:
      0   1
0  5993   4
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_15.png
early stop counter: 2
val acc:0.9852597117424011, best validation acc: 0.9860047101974487, corresponding to test acc:                         0.9648450016975403 / 0.9680408835411072
after epoch: 15,now: 2024-06-06 04:53:06.291424,epoch time: 0:23:49.996923,used: 6:00:58.871179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99191636, 'precision': 0.9807592, 'recall': 0.89188623, 'specificity': 0.89188623, 'f1': 0.9314742, 'auroc': 0.9972719, 'binary_precision': 0.96895975, 'binary_recall': 0.78464675, 'binary_specificity': 0.9991257, 'binary_f1_score': 0.8671171}
confusion matrix:
       0     1
0  42283    37
1    317  1155
---- Validation: 
scalar performance:
{'acc': 0.98440826, 'precision': 0.9438783, 'recall': 0.80441415, 'specificity': 0.80441415, 'f1': 0.8602129, 'auroc': 0.97719693, 'binary_precision': 0.9013761, 'binary_recall': 0.61119753, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.72845227}
confusion matrix:
       0    1
0  18106   43
1    250  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.9144669, 'recall': 0.54947495, 'specificity': 0.54947495, 'f1': 0.579572, 'auroc': 0.9410588, 'binary_precision': 0.8666667, 'binary_recall': 0.099616855, 'binary_specificity': 0.999333, 'binary_f1_score': 0.17869414}
confusion matrix:
      0   1
0  5993   4
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_16.png
early stop counter: 3
val acc:0.9844082593917847, best validation acc: 0.9860047101974487, corresponding to test acc:                         0.9648450016975403 / 0.9680408835411072
after epoch: 16,now: 2024-06-06 05:16:55.428632,epoch time: 0:23:49.137208,used: 6:24:48.008387,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9923274, 'precision': 0.96069217, 'recall': 0.9176167, 'specificity': 0.9176167, 'f1': 0.93801856, 'auroc': 0.997257, 'binary_precision': 0.9270128, 'binary_recall': 0.8375255, 'binary_specificity': 0.997708, 'binary_f1_score': 0.88000005}
confusion matrix:
       0     1
0  42224    97
1    239  1232
---- Validation: 
scalar performance:
{'acc': 0.98621756, 'precision': 0.9161559, 'recall': 0.86535525, 'specificity': 0.86535525, 'f1': 0.8889713, 'auroc': 0.97859716, 'binary_precision': 0.841637, 'binary_recall': 0.7356143, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.78506225}
confusion matrix:
       0    1
0  18060   89
1    170  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.81673145, 'recall': 0.6049452, 'specificity': 0.6049452, 'f1': 0.6527469, 'auroc': 0.9436412, 'binary_precision': 0.6666667, 'binary_recall': 0.21455939, 'binary_specificity': 0.995331, 'binary_f1_score': 0.32463768}
confusion matrix:
      0   1
0  5969  28
1   205  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_17.png
better model found
persisted
after epoch: 17,now: 2024-06-06 05:40:43.222538,epoch time: 0:23:47.793906,used: 6:48:35.802293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.991962, 'precision': 0.93618643, 'recall': 0.94076085, 'specificity': 0.94076085, 'f1': 0.93846077, 'auroc': 0.9972397, 'binary_precision': 0.8763441, 'binary_recall': 0.88586956, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.88108104}
confusion matrix:
       0     1
0  42136   184
1    168  1304
---- Validation: 
scalar performance:
{'acc': 0.9868029, 'precision': 0.91350937, 'recall': 0.87990934, 'specificity': 0.87990934, 'f1': 0.8959395, 'auroc': 0.97991216, 'binary_precision': 0.8353141, 'binary_recall': 0.7651633, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.7987013}
confusion matrix:
       0    1
0  18052   97
1    151  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.8819083, 'recall': 0.6041967, 'specificity': 0.6041967, 'f1': 0.6576399, 'auroc': 0.9392514, 'binary_precision': 0.79710144, 'binary_recall': 0.21072797, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.3333333}
confusion matrix:
      0   1
0  5983  14
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_18.png
better model found
persisted
after epoch: 18,now: 2024-06-06 06:04:31.019485,epoch time: 0:23:47.796947,used: 7:12:23.599240,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98760045, 'precision': 0.9179984, 'recall': 0.88473535, 'specificity': 0.88473535, 'f1': 0.9006226, 'auroc': 0.99447155, 'binary_precision': 0.8438194, 'binary_recall': 0.7744565, 'binary_specificity': 0.9950142, 'binary_f1_score': 0.8076514}
confusion matrix:
       0     1
0  42109   211
1    332  1140
---- Validation: 
scalar performance:
{'acc': 0.9829715, 'precision': 0.8995131, 'recall': 0.8246718, 'specificity': 0.8246718, 'f1': 0.8579134, 'auroc': 0.9742937, 'binary_precision': 0.81117535, 'binary_recall': 0.6547434, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.72461265}
confusion matrix:
       0    1
0  18051   98
1    222  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.9177147, 'recall': 0.5266532, 'specificity': 0.5266532, 'f1': 0.5403691, 'auroc': 0.9129838, 'binary_precision': 0.875, 'binary_recall': 0.053639848, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.10108303}
confusion matrix:
      0   1
0  5995   2
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_19.png
early stop counter: 1
val acc:0.9829714894294739, best validation acc: 0.986802875995636, corresponding to test acc:                         0.9648450016975403 / 0.9680408835411072
after epoch: 19,now: 2024-06-06 06:28:16.749955,epoch time: 0:23:45.730470,used: 7:36:09.329710,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9937203, 'precision': 0.95809996, 'recall': 0.9439656, 'specificity': 0.9439656, 'f1': 0.9509135, 'auroc': 0.9981835, 'binary_precision': 0.92, 'binary_recall': 0.890625, 'binary_specificity': 0.9973062, 'binary_f1_score': 0.90507424}
confusion matrix:
       0     1
0  42206   114
1    161  1311
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.9188452, 'recall': 0.8639102, 'specificity': 0.8639102, 'f1': 0.8892957, 'auroc': 0.97845054, 'binary_precision': 0.8471223, 'binary_recall': 0.7325039, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.7856547}
confusion matrix:
       0    1
0  18064   85
1    172  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.8047601, 'recall': 0.6457568, 'specificity': 0.6457568, 'f1': 0.6943007, 'auroc': 0.9316429, 'binary_precision': 0.6393443, 'binary_recall': 0.29885057, 'binary_specificity': 0.992663, 'binary_f1_score': 0.4073107}
confusion matrix:
      0   1
0  5953  44
1   183  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_20.png
early stop counter: 2
val acc:0.9863239526748657, best validation acc: 0.986802875995636, corresponding to test acc:                         0.9648450016975403 / 0.9680408835411072
after epoch: 20,now: 2024-06-06 06:52:05.154090,epoch time: 0:23:48.404135,used: 7:59:57.733845,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9932636, 'precision': 0.98702085, 'recall': 0.90766484, 'specificity': 0.90766484, 'f1': 0.94357204, 'auroc': 0.99776244, 'binary_precision': 0.9804082, 'binary_recall': 0.81589675, 'binary_specificity': 0.9994329, 'binary_f1_score': 0.8906192}
confusion matrix:
       0     1
0  42296    24
1    271  1201
---- Validation: 
scalar performance:
{'acc': 0.9846211, 'precision': 0.9351482, 'recall': 0.81577516, 'specificity': 0.81577516, 'f1': 0.8652696, 'auroc': 0.9775677, 'binary_precision': 0.8831169, 'binary_recall': 0.63452566, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.73846155}
confusion matrix:
       0    1
0  18095   54
1    235  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.9640558, 'recall': 0.55355644, 'specificity': 0.55355644, 'f1': 0.58698195, 'auroc': 0.9177608, 'binary_precision': 0.9655172, 'binary_recall': 0.107279696, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.19310345}
confusion matrix:
      0   1
0  5996   1
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_21.png
early stop counter: 3
val acc:0.9846211075782776, best validation acc: 0.986802875995636, corresponding to test acc:                         0.9648450016975403 / 0.9680408835411072
after epoch: 21,now: 2024-06-06 07:16:07.527042,epoch time: 0:24:02.372952,used: 8:24:00.106797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99408567, 'precision': 0.9495833, 'recall': 0.9604964, 'specificity': 0.9604964, 'f1': 0.9549692, 'auroc': 0.99833655, 'binary_precision': 0.90179163, 'binary_recall': 0.9244898, 'binary_specificity': 0.996503, 'binary_f1_score': 0.91299963}
confusion matrix:
       0     1
0  42174   148
1    111  1359
---- Validation: 
scalar performance:
{'acc': 0.9870157, 'precision': 0.92273235, 'recall': 0.87176895, 'specificity': 0.87176895, 'f1': 0.8954855, 'auroc': 0.9782424, 'binary_precision': 0.8543517, 'binary_recall': 0.748056, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.7976783}
confusion matrix:
       0    1
0  18067   82
1    162  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.81083274, 'recall': 0.58237356, 'specificity': 0.58237356, 'f1': 0.6243006, 'auroc': 0.9121732, 'binary_precision': 0.6567164, 'binary_recall': 0.16858238, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.2682927}
confusion matrix:
      0   1
0  5974  23
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_22.png
better model found
persisted
after epoch: 22,now: 2024-06-06 07:39:48.965806,epoch time: 0:23:41.438764,used: 8:47:41.545561,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9945652, 'precision': 0.95954764, 'recall': 0.95653355, 'specificity': 0.95653355, 'f1': 0.9580352, 'auroc': 0.99833447, 'binary_precision': 0.9220246, 'binary_recall': 0.9157609, 'binary_specificity': 0.9973062, 'binary_f1_score': 0.918882}
confusion matrix:
       0     1
0  42206   114
1    124  1348
---- Validation: 
scalar performance:
{'acc': 0.98738825, 'precision': 0.93002295, 'recall': 0.86971164, 'specificity': 0.86971164, 'f1': 0.8974142, 'auroc': 0.97908103, 'binary_precision': 0.8690909, 'binary_recall': 0.7433904, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.8013411}
confusion matrix:
       0    1
0  18077   72
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.84384453, 'recall': 0.55463845, 'specificity': 0.55463845, 'f1': 0.5863987, 'auroc': 0.9364978, 'binary_precision': 0.725, 'binary_recall': 0.11111111, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.19269103}
confusion matrix:
      0   1
0  5986  11
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_23.png
better model found
persisted
after epoch: 23,now: 2024-06-06 08:03:27.453681,epoch time: 0:23:38.487875,used: 9:11:20.033436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99445105, 'precision': 0.94257855, 'recall': 0.9764594, 'specificity': 0.9764594, 'f1': 0.9588437, 'auroc': 0.99890333, 'binary_precision': 0.88664985, 'binary_recall': 0.957172, 'binary_specificity': 0.9957468, 'binary_f1_score': 0.92056227}
confusion matrix:
       0     1
0  42141   180
1     63  1408
---- Validation: 
scalar performance:
{'acc': 0.98770756, 'precision': 0.9091562, 'recall': 0.9036294, 'specificity': 0.9036294, 'f1': 0.9063724, 'auroc': 0.9800199, 'binary_precision': 0.82492113, 'binary_recall': 0.8133748, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.81910735}
confusion matrix:
       0    1
0  18038  111
1    120  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.8246206, 'recall': 0.612608, 'specificity': 0.612608, 'f1': 0.6625091, 'auroc': 0.92428684, 'binary_precision': 0.6818182, 'binary_recall': 0.22988506, 'binary_specificity': 0.995331, 'binary_f1_score': 0.34383956}
confusion matrix:
      0   1
0  5969  28
1   201  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_24.png
better model found
persisted
after epoch: 24,now: 2024-06-06 08:27:09.335001,epoch time: 0:23:41.881320,used: 9:35:01.914756,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9949534, 'precision': 0.97151136, 'recall': 0.9495215, 'specificity': 0.9495215, 'f1': 0.96023405, 'auroc': 0.9990014, 'binary_precision': 0.9464668, 'binary_recall': 0.9008152, 'binary_specificity': 0.9982278, 'binary_f1_score': 0.923077}
confusion matrix:
       0     1
0  42245    75
1    146  1326
---- Validation: 
scalar performance:
{'acc': 0.9864304, 'precision': 0.9203748, 'recall': 0.86396533, 'specificity': 0.86396533, 'f1': 0.8899797, 'auroc': 0.9801639, 'binary_precision': 0.8501805, 'binary_recall': 0.7325039, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.78696746}
confusion matrix:
       0    1
0  18066   83
1    172  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.851447, 'recall': 0.63009953, 'specificity': 0.63009953, 'f1': 0.6854443, 'auroc': 0.9487105, 'binary_precision': 0.7340425, 'binary_recall': 0.26436782, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.3887324}
confusion matrix:
      0   1
0  5972  25
1   192  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_25.png
early stop counter: 1
val acc:0.9864304065704346, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9634068608283997 / 0.9680408835411072
after epoch: 25,now: 2024-06-06 08:50:54.499828,epoch time: 0:23:45.164827,used: 9:58:47.079583,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9955928, 'precision': 0.98116326, 'recall': 0.9498523, 'specificity': 0.9498523, 'f1': 0.96494204, 'auroc': 0.9992002, 'binary_precision': 0.9657684, 'binary_recall': 0.9008152, 'binary_specificity': 0.9988894, 'binary_f1_score': 0.9321617}
confusion matrix:
       0     1
0  42273    47
1    146  1326
---- Validation: 
scalar performance:
{'acc': 0.9868029, 'precision': 0.93377864, 'recall': 0.8551575, 'specificity': 0.8551575, 'f1': 0.89024854, 'auroc': 0.9766951, 'binary_precision': 0.87762904, 'binary_recall': 0.7138414, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.78730696}
confusion matrix:
       0    1
0  18085   64
1    184  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8486882, 'recall': 0.5471424, 'specificity': 0.5471424, 'f1': 0.57472205, 'auroc': 0.9095362, 'binary_precision': 0.7352941, 'binary_recall': 0.09578544, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.16949151}
confusion matrix:
      0   1
0  5988   9
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_26.png
early stop counter: 2
val acc:0.986802875995636, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9634068608283997 / 0.9680408835411072
after epoch: 26,now: 2024-06-06 09:15:26.323649,epoch time: 0:24:31.823821,used: 10:23:18.903404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9951589, 'precision': 0.9690775, 'recall': 0.95552933, 'specificity': 0.95552933, 'f1': 0.9621966, 'auroc': 0.9987688, 'binary_precision': 0.9411765, 'binary_recall': 0.9130435, 'binary_specificity': 0.9980151, 'binary_f1_score': 0.9268966}
confusion matrix:
       0     1
0  42236    84
1    128  1344
---- Validation: 
scalar performance:
{'acc': 0.9874415, 'precision': 0.9354764, 'recall': 0.8644887, 'specificity': 0.8644887, 'f1': 0.896589, 'auroc': 0.9766917, 'binary_precision': 0.88037384, 'binary_recall': 0.7325039, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.79966044}
confusion matrix:
       0    1
0  18085   64
1    172  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.7788737, 'recall': 0.5706292, 'specificity': 0.5706292, 'f1': 0.6067106, 'auroc': 0.9435436, 'binary_precision': 0.59375, 'binary_recall': 0.14559387, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.23384614}
confusion matrix:
      0   1
0  5971  26
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_27.png
early stop counter: 3
val acc:0.9874414801597595, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9634068608283997 / 0.9680408835411072
after epoch: 27,now: 2024-06-06 09:39:58.729217,epoch time: 0:24:32.405568,used: 10:47:51.308972,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.993355, 'precision': 0.934778, 'recall': 0.9680382, 'specificity': 0.9680382, 'f1': 0.9507451, 'auroc': 0.9981447, 'binary_precision': 0.8716174, 'binary_recall': 0.94089675, 'binary_specificity': 0.9951796, 'binary_f1_score': 0.9049331}
confusion matrix:
       0     1
0  42116   204
1     87  1385
---- Validation: 
scalar performance:
{'acc': 0.98541933, 'precision': 0.88844883, 'recall': 0.89194393, 'specificity': 0.89194393, 'f1': 0.8901879, 'auroc': 0.97761524, 'binary_precision': 0.7842835, 'binary_recall': 0.79160184, 'binary_specificity': 0.9922861, 'binary_f1_score': 0.78792566}
confusion matrix:
       0    1
0  18009  140
1    134  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.83061814, 'recall': 0.59020317, 'specificity': 0.59020317, 'f1': 0.63585335, 'auroc': 0.9309305, 'binary_precision': 0.6956522, 'binary_recall': 0.18390805, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.29090908}
confusion matrix:
      0   1
0  5976  21
1   213  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_28.png
early stop counter: 4
val acc:0.9854193329811096, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9634068608283997 / 0.9680408835411072
after epoch: 28,now: 2024-06-06 10:04:32.910319,epoch time: 0:24:34.181102,used: 11:12:25.490074,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9936518, 'precision': 0.92903835, 'recall': 0.9822796, 'specificity': 0.9822796, 'f1': 0.95397353, 'auroc': 0.9989525, 'binary_precision': 0.859121, 'binary_recall': 0.97008836, 'binary_specificity': 0.99447083, 'binary_f1_score': 0.91123885}
confusion matrix:
       0     1
0  42087   234
1     44  1427
---- Validation: 
scalar performance:
{'acc': 0.9859515, 'precision': 0.8867816, 'recall': 0.90647054, 'specificity': 0.90647054, 'f1': 0.89636004, 'auroc': 0.9800465, 'binary_precision': 0.7799114, 'binary_recall': 0.82115084, 'binary_specificity': 0.9917902, 'binary_f1_score': 0.8}
confusion matrix:
       0    1
0  18000  149
1    115  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9546181, 'precision': 0.6952038, 'recall': 0.6135194, 'specificity': 0.6135194, 'f1': 0.6419288, 'auroc': 0.91871893, 'binary_precision': 0.42281878, 'binary_recall': 0.2413793, 'binary_specificity': 0.9856595, 'binary_f1_score': 0.30731708}
confusion matrix:
      0   1
0  5911  86
1   198  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_29.png
early stop counter: 5
val acc:0.9859514832496643, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9634068608283997 / 0.9680408835411072
after epoch: 29,now: 2024-06-06 10:29:03.745696,epoch time: 0:24:30.835377,used: 11:36:56.325451,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9957298, 'precision': 0.97999823, 'recall': 0.9531704, 'specificity': 0.9531704, 'f1': 0.96616983, 'auroc': 0.9994451, 'binary_precision': 0.9632035, 'binary_recall': 0.90754586, 'binary_specificity': 0.9987949, 'binary_f1_score': 0.9345467}
confusion matrix:
       0     1
0  42270    51
1    136  1335
---- Validation: 
scalar performance:
{'acc': 0.98648363, 'precision': 0.93869925, 'recall': 0.8444915, 'specificity': 0.8444915, 'f1': 0.8855008, 'auroc': 0.9781828, 'binary_precision': 0.8882235, 'binary_recall': 0.69206846, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.777972}
confusion matrix:
       0    1
0  18093   56
1    198  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.8923758, 'recall': 0.6024478, 'specificity': 0.6024478, 'f1': 0.6561541, 'auroc': 0.94858384, 'binary_precision': 0.8181818, 'binary_recall': 0.20689656, 'binary_specificity': 0.997999, 'binary_f1_score': 0.3302752}
confusion matrix:
      0   1
0  5985  12
1   207  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_30.png
early stop counter: 6
val acc:0.986483633518219, best validation acc: 0.9877075552940369, corresponding to test acc:                         0.9634068608283997 / 0.9680408835411072
after epoch: 30,now: 2024-06-06 10:53:34.700559,epoch time: 0:24:30.954863,used: 12:01:27.280314,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:01:27.280314 at 2024-06-06 10:53:34.700559
persisted model performance metric: 

scalar performance:
{'acc': 0.9608501, 'precision': 0.77584326, 'recall': 0.60211235, 'specificity': 0.60211235, 'f1': 0.6448564, 'auroc': 0.9322089, 'binary_precision': 0.5851064, 'binary_recall': 0.21072797, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.30985916}
confusion matrix:
      0   1
0  5958  39
1   206  55
oracle model performance metric: 

scalar performance:
{'acc': 0.9682007, 'precision': 0.9072255, 'recall': 0.64442664, 'specificity': 0.64442664, 'f1': 0.70834506, 'auroc': 0.96040183, 'binary_precision': 0.84444445, 'binary_recall': 0.29118773, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.43304846}
confusion matrix:
      0   1
0  5983  14
1   185  76
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455924 KiB |   2003 MiB |    934 TiB |    934 TiB |
|       from large pool | 414237 KiB |   1971 MiB |    922 TiB |    922 TiB |
|       from small pool |  41687 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 455924 KiB |   2003 MiB |    934 TiB |    934 TiB |
|       from large pool | 414237 KiB |   1971 MiB |    922 TiB |    922 TiB |
|       from small pool |  41687 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |   1998 MiB |    934 TiB |    934 TiB |
|       from large pool | 407075 KiB |   1966 MiB |    922 TiB |    922 TiB |
|       from small pool |  40679 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2282 MiB |   2282 MiB |   2282 MiB |      0 B   |
|       from large pool |   2212 MiB |   2212 MiB |   2212 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 332555 KiB | 366275 KiB | 767239 GiB | 767239 GiB |
|       from large pool | 323043 KiB | 360722 KiB | 754248 GiB | 754248 GiB |
|       from small pool |   9512 KiB |  14571 KiB |  12991 GiB |  12991 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6459    |  180480 K  |  180476 K  |
|       from large pool |     187    |     311    |   87939 K  |   87939 K  |
|       from small pool |    3301    |    6271    |   92540 K  |   92537 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6459    |  180480 K  |  180476 K  |
|       from large pool |     187    |     311    |   87939 K  |   87939 K  |
|       from small pool |    3301    |    6271    |   92540 K  |   92537 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     127    |     127    |     127    |       0    |
|       from large pool |      92    |      92    |      92    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      63    |    2787    |   91198 K  |   91198 K  |
|       from large pool |      32    |      88    |   55392 K  |   55392 K  |
|       from small pool |      31    |    2755    |   35805 K  |   35805 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |    934 TiB |    934 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    922 TiB |    922 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |    934 TiB |    934 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    922 TiB |    922 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |    934 TiB |    934 TiB |
|       from large pool |  16640 KiB |   1966 MiB |    922 TiB |    922 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    770 MiB |   2282 MiB |   2282 MiB |   1512 MiB |
|       from large pool |    720 MiB |   2212 MiB |   2212 MiB |   1492 MiB |
|       from small pool |     50 MiB |     70 MiB |     70 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 428787 KiB | 767240 GiB | 767240 GiB |
|       from large pool |  24320 KiB | 408037 KiB | 754248 GiB | 754248 GiB |
|       from small pool |      0 KiB |  21494 KiB |  12991 GiB |  12991 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6459    |  180480 K  |  180480 K  |
|       from large pool |       2    |     311    |   87939 K  |   87939 K  |
|       from small pool |       0    |    6271    |   92540 K  |   92540 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6459    |  180480 K  |  180480 K  |
|       from large pool |       2    |     311    |   87939 K  |   87939 K  |
|       from small pool |       0    |    6271    |   92540 K  |   92540 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     127    |      69    |
|       from large pool |      33    |      92    |      92    |      59    |
|       from small pool |      25    |      35    |      35    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2787    |   91199 K  |   91199 K  |
|       from large pool |       3    |      88    |   55392 K  |   55392 K  |
|       from small pool |       0    |    2755    |   35807 K  |   35807 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |    934 TiB |    934 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    922 TiB |    922 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |    934 TiB |    934 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    922 TiB |    922 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |    934 TiB |    934 TiB |
|       from large pool |  16640 KiB |   1966 MiB |    922 TiB |    922 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    770 MiB |   2282 MiB |   2282 MiB |   1512 MiB |
|       from large pool |    720 MiB |   2212 MiB |   2212 MiB |   1492 MiB |
|       from small pool |     50 MiB |     70 MiB |     70 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 428787 KiB | 767240 GiB | 767240 GiB |
|       from large pool |  24320 KiB | 408037 KiB | 754248 GiB | 754248 GiB |
|       from small pool |      0 KiB |  21494 KiB |  12991 GiB |  12991 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6459    |  180480 K  |  180480 K  |
|       from large pool |       2    |     311    |   87939 K  |   87939 K  |
|       from small pool |       0    |    6271    |   92540 K  |   92540 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6459    |  180480 K  |  180480 K  |
|       from large pool |       2    |     311    |   87939 K  |   87939 K  |
|       from small pool |       0    |    6271    |   92540 K  |   92540 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     127    |      69    |
|       from large pool |      33    |      92    |      92    |      59    |
|       from small pool |      25    |      35    |      35    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2787    |   91199 K  |   91199 K  |
|       from large pool |       3    |      88    |   55392 K  |   55392 K  |
|       from small pool |       0    |    2755    |   35807 K  |   35807 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986

 Experiment start at: 2024-06-06 11:03:15.874693
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96807736, 'precision': 0.75068516, 'recall': 0.8652579, 'specificity': 0.8652579, 'f1': 0.79603994, 'auroc': 0.9618795, 'binary_precision': 0.5098315, 'binary_recall': 0.7552011, 'binary_specificity': 0.97531474, 'binary_f1_score': 0.60872}
confusion matrix:
       0     1
0  41367  1047
1    353  1089
---- Validation: 
scalar performance:
{'acc': 0.96344715, 'precision': 0.7428897, 'recall': 0.87303746, 'specificity': 0.87303746, 'f1': 0.7923285, 'auroc': 0.9626831, 'binary_precision': 0.4943182, 'binary_recall': 0.7756315, 'binary_specificity': 0.97044337, 'binary_f1_score': 0.6038172}
confusion matrix:
       0    1
0  17533  534
1    151  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709958, 'precision': 0.8268465, 'recall': 0.7954481, 'specificity': 0.7954481, 'f1': 0.8102622, 'auroc': 0.9481946, 'binary_precision': 0.67094016, 'binary_recall': 0.60384613, 'binary_specificity': 0.9870501, 'binary_f1_score': 0.63562757}
confusion matrix:
      0    1
0  5869   77
1   103  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-06 11:29:34.852566,epoch time: 0:26:18.977873,used: 0:26:18.977873,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9786118, 'precision': 0.8542542, 'recall': 0.7791118, 'specificity': 0.7791118, 'f1': 0.81185925, 'auroc': 0.97005075, 'binary_precision': 0.72315884, 'binary_recall': 0.5655795, 'binary_specificity': 0.99264413, 'binary_f1_score': 0.6347352}
confusion matrix:
       0    1
0  42103  312
1    626  815
---- Validation: 
scalar performance:
{'acc': 0.9744931, 'precision': 0.8387594, 'recall': 0.7535943, 'specificity': 0.7535943, 'f1': 0.7894925, 'auroc': 0.96571726, 'binary_precision': 0.69539076, 'binary_recall': 0.51560175, 'binary_specificity': 0.99158686, 'binary_f1_score': 0.59215015}
confusion matrix:
       0    1
0  17915  152
1    326  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.79420733, 'recall': 0.5655418, 'specificity': 0.5655418, 'f1': 0.6005908, 'auroc': 0.9536232, 'binary_precision': 0.625, 'binary_recall': 0.13461539, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.221519}
confusion matrix:
      0   1
0  5925  21
1   225  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_2.png
better model found
persisted
after epoch: 2,now: 2024-06-06 11:56:48.107550,epoch time: 0:27:13.254984,used: 0:53:32.232857,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97690165, 'precision': 0.80826926, 'recall': 0.863456, 'specificity': 0.863456, 'f1': 0.83336943, 'auroc': 0.9754018, 'binary_precision': 0.62536526, 'binary_recall': 0.74202496, 'binary_specificity': 0.98488706, 'binary_f1_score': 0.6787187}
confusion matrix:
       0     1
0  41773   641
1    372  1070
---- Validation: 
scalar performance:
{'acc': 0.9757204, 'precision': 0.82701004, 'recall': 0.8171743, 'specificity': 0.8171743, 'f1': 0.8220095, 'auroc': 0.9738264, 'binary_precision': 0.6671779, 'binary_recall': 0.64635956, 'binary_specificity': 0.9879891, 'binary_f1_score': 0.65660375}
confusion matrix:
       0    1
0  17850  217
1    238  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.84027034, 'recall': 0.5623684, 'specificity': 0.5623684, 'f1': 0.5979307, 'auroc': 0.95476145, 'binary_precision': 0.7173913, 'binary_recall': 0.12692308, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.21568628}
confusion matrix:
      0   1
0  5933  13
1   227  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_3.png
better model found
persisted
after epoch: 3,now: 2024-06-06 12:21:20.313913,epoch time: 0:24:32.206363,used: 1:18:04.439220,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97979754, 'precision': 0.9083745, 'recall': 0.73901117, 'specificity': 0.73901117, 'f1': 0.80000407, 'auroc': 0.98108983, 'binary_precision': 0.83413464, 'binary_recall': 0.481276, 'binary_specificity': 0.99674636, 'binary_f1_score': 0.6103782}
confusion matrix:
       0    1
0  42276  138
1    748  694
---- Validation: 
scalar performance:
{'acc': 0.9800427, 'precision': 0.90619165, 'recall': 0.7779305, 'specificity': 0.7779305, 'f1': 0.8290757, 'auroc': 0.9731953, 'binary_precision': 0.82857144, 'binary_recall': 0.5601783, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.6684397}
confusion matrix:
       0    1
0  17989   78
1    296  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.91199803, 'recall': 0.5591949, 'specificity': 0.5591949, 'f1': 0.5950731, 'auroc': 0.9581493, 'binary_precision': 0.8611111, 'binary_recall': 0.11923077, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.20945945}
confusion matrix:
      0   1
0  5941   5
1   229  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_4.png
better model found
persisted
after epoch: 4,now: 2024-06-06 12:45:48.830673,epoch time: 0:24:28.516760,used: 1:42:32.955980,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98385626, 'precision': 0.8841369, 'recall': 0.8526486, 'specificity': 0.8526486, 'f1': 0.8676648, 'auroc': 0.98391813, 'binary_precision': 0.7780303, 'binary_recall': 0.7122053, 'binary_specificity': 0.9930919, 'binary_f1_score': 0.74366397}
confusion matrix:
       0     1
0  42121   293
1    415  1027
---- Validation: 
scalar performance:
{'acc': 0.98057634, 'precision': 0.8541293, 'recall': 0.8733378, 'specificity': 0.8733378, 'f1': 0.863455, 'auroc': 0.97856116, 'binary_precision': 0.7172996, 'binary_recall': 0.7578009, 'binary_specificity': 0.98887473, 'binary_f1_score': 0.7369942}
confusion matrix:
       0    1
0  17866  201
1    163  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.78855824, 'recall': 0.5448925, 'specificity': 0.5448925, 'f1': 0.56990683, 'auroc': 0.9611006, 'binary_precision': 0.61538464, 'binary_recall': 0.092307694, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.16053511}
confusion matrix:
      0   1
0  5931  15
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_5.png
better model found
persisted
after epoch: 5,now: 2024-06-06 13:10:15.701695,epoch time: 0:24:26.871022,used: 2:06:59.827002,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98506474, 'precision': 0.9093585, 'recall': 0.84121513, 'specificity': 0.84121513, 'f1': 0.87195635, 'auroc': 0.9873947, 'binary_precision': 0.8292887, 'binary_recall': 0.68723994, 'binary_specificity': 0.99519026, 'binary_f1_score': 0.75161177}
confusion matrix:
       0    1
0  42210  204
1    451  991
---- Validation: 
scalar performance:
{'acc': 0.9823906, 'precision': 0.9218451, 'recall': 0.8034673, 'specificity': 0.8034673, 'f1': 0.8522289, 'auroc': 0.97833, 'binary_precision': 0.8580376, 'binary_recall': 0.61069834, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.7135416}
confusion matrix:
       0    1
0  17999   68
1    262  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.7922553, 'recall': 0.58234495, 'specificity': 0.58234495, 'f1': 0.6228734, 'auroc': 0.9550394, 'binary_precision': 0.6197183, 'binary_recall': 0.16923077, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.26586103}
confusion matrix:
      0   1
0  5919  27
1   216  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_6.png
better model found
persisted
after epoch: 6,now: 2024-06-06 13:34:43.045255,epoch time: 0:24:27.343560,used: 2:31:27.170562,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9867065, 'precision': 0.9052162, 'recall': 0.87991345, 'specificity': 0.87991345, 'f1': 0.89212453, 'auroc': 0.988258, 'binary_precision': 0.818384, 'binary_recall': 0.7656033, 'binary_specificity': 0.9942236, 'binary_f1_score': 0.7911143}
confusion matrix:
       0     1
0  42169   245
1    338  1104
---- Validation: 
scalar performance:
{'acc': 0.9828709, 'precision': 0.89503944, 'recall': 0.8444866, 'specificity': 0.8444866, 'f1': 0.86788416, 'auroc': 0.9776636, 'binary_precision': 0.80136985, 'binary_recall': 0.69539374, 'binary_specificity': 0.99357945, 'binary_f1_score': 0.74463004}
confusion matrix:
       0    1
0  17951  116
1    205  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.8171383, 'recall': 0.61662394, 'specificity': 0.61662394, 'f1': 0.6661424, 'auroc': 0.9517329, 'binary_precision': 0.6666667, 'binary_recall': 0.23846154, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.3512748}
confusion matrix:
      0   1
0  5915  31
1   198  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_7.png
better model found
persisted
after epoch: 7,now: 2024-06-06 14:01:17.579108,epoch time: 0:26:34.533853,used: 2:58:01.704415,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98732215, 'precision': 0.90934265, 'recall': 0.88626087, 'specificity': 0.88626087, 'f1': 0.8974403, 'auroc': 0.98836905, 'binary_precision': 0.826215, 'binary_recall': 0.778086, 'binary_specificity': 0.9944358, 'binary_f1_score': 0.8014286}
confusion matrix:
       0     1
0  42178   236
1    320  1122
---- Validation: 
scalar performance:
{'acc': 0.98527217, 'precision': 0.9043286, 'recall': 0.87648845, 'specificity': 0.87648845, 'f1': 0.88986856, 'auroc': 0.9797496, 'binary_precision': 0.8176, 'binary_recall': 0.75928676, 'binary_specificity': 0.99369013, 'binary_f1_score': 0.7873652}
confusion matrix:
       0    1
0  17953  114
1    162  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.81411874, 'recall': 0.5958906, 'specificity': 0.5958906, 'f1': 0.6416045, 'auroc': 0.9689829, 'binary_precision': 0.66233766, 'binary_recall': 0.19615385, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.30267063}
confusion matrix:
      0   1
0  5920  26
1   209  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_8.png
better model found
persisted
after epoch: 8,now: 2024-06-06 14:28:53.134836,epoch time: 0:27:35.555728,used: 3:25:37.260143,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9794327, 'precision': 0.8140432, 'recall': 0.9404637, 'specificity': 0.9404637, 'f1': 0.86556643, 'auroc': 0.9893526, 'binary_precision': 0.6315789, 'binary_recall': 0.89875174, 'binary_specificity': 0.9821757, 'binary_f1_score': 0.74184316}
confusion matrix:
       0     1
0  41658   756
1    146  1296
---- Validation: 
scalar performance:
{'acc': 0.97774816, 'precision': 0.8157456, 'recall': 0.9362451, 'specificity': 0.9362451, 'f1': 0.8652438, 'auroc': 0.9819437, 'binary_precision': 0.63559324, 'binary_recall': 0.89153045, 'binary_specificity': 0.9809598, 'binary_f1_score': 0.7421151}
confusion matrix:
       0    1
0  17723  344
1     73  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.84016645, 'recall': 0.65675634, 'specificity': 0.65675634, 'f1': 0.71139306, 'auroc': 0.95384645, 'binary_precision': 0.7094017, 'binary_recall': 0.31923077, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.4403183}
confusion matrix:
      0   1
0  5912  34
1   177  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_9.png
early stop counter: 1
val acc:0.9777481555938721, best validation acc: 0.9852721691131592, corresponding to test acc:                         0.9621334075927734 / 0.9709957838058472
after epoch: 9,now: 2024-06-06 14:55:58.679557,epoch time: 0:27:05.544721,used: 3:52:42.804864,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9888043, 'precision': 0.945924, 'recall': 0.8692747, 'specificity': 0.8692747, 'f1': 0.903733, 'auroc': 0.9926037, 'binary_precision': 0.9005897, 'binary_recall': 0.74133146, 'binary_specificity': 0.9972179, 'binary_f1_score': 0.81323695}
confusion matrix:
       0     1
0  42296   118
1    373  1069
---- Validation: 
scalar performance:
{'acc': 0.98431164, 'precision': 0.9334656, 'recall': 0.824491, 'specificity': 0.824491, 'f1': 0.8705247, 'auroc': 0.98207325, 'binary_precision': 0.8797595, 'binary_recall': 0.6523031, 'binary_specificity': 0.996679, 'binary_f1_score': 0.74914676}
confusion matrix:
       0    1
0  18007   60
1    234  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.855427, 'recall': 0.53411084, 'specificity': 0.53411084, 'f1': 0.553156, 'auroc': 0.9655969, 'binary_precision': 0.75, 'binary_recall': 0.06923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.12676057}
confusion matrix:
      0   1
0  5940   6
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_10.png
early stop counter: 2
val acc:0.9843116402626038, best validation acc: 0.9852721691131592, corresponding to test acc:                         0.9621334075927734 / 0.9709957838058472
after epoch: 10,now: 2024-06-06 15:20:34.744815,epoch time: 0:24:36.065258,used: 4:17:18.870122,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9902408, 'precision': 0.94252086, 'recall': 0.8984883, 'specificity': 0.8984883, 'f1': 0.9192653, 'auroc': 0.99392617, 'binary_precision': 0.89180833, 'binary_recall': 0.8002774, 'binary_specificity': 0.9966992, 'binary_f1_score': 0.84356725}
confusion matrix:
       0     1
0  42274   140
1    288  1154
---- Validation: 
scalar performance:
{'acc': 0.9861793, 'precision': 0.93293166, 'recall': 0.8562162, 'specificity': 0.8562162, 'f1': 0.8905411, 'auroc': 0.984252, 'binary_precision': 0.87636364, 'binary_recall': 0.7161961, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.78822565}
confusion matrix:
       0    1
0  17999   68
1    191  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.80902666, 'recall': 0.58828235, 'specificity': 0.58828235, 'f1': 0.6317153, 'auroc': 0.9604145, 'binary_precision': 0.6527778, 'binary_recall': 0.18076923, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.28313255}
confusion matrix:
      0   1
0  5921  25
1   213  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_11.png
better model found
persisted
after epoch: 11,now: 2024-06-06 15:44:17.366323,epoch time: 0:23:42.621508,used: 4:41:01.491630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98903227, 'precision': 0.95212746, 'recall': 0.8670479, 'specificity': 0.8670479, 'f1': 0.9048517, 'auroc': 0.9939993, 'binary_precision': 0.9131556, 'binary_recall': 0.73647714, 'binary_specificity': 0.99761873, 'binary_f1_score': 0.8153551}
confusion matrix:
       0     1
0  42313   101
1    380  1062
---- Validation: 
scalar performance:
{'acc': 0.9807364, 'precision': 0.9183823, 'recall': 0.7782903, 'specificity': 0.7782903, 'f1': 0.833153, 'auroc': 0.98234606, 'binary_precision': 0.85294116, 'binary_recall': 0.5601783, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.6762332}
confusion matrix:
       0    1
0  18002   65
1    296  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.8377191, 'recall': 0.5377888, 'specificity': 0.5377888, 'f1': 0.5592168, 'auroc': 0.95931214, 'binary_precision': 0.71428573, 'binary_recall': 0.07692308, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.1388889}
confusion matrix:
      0   1
0  5938   8
1   240  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_12.png
early stop counter: 1
val acc:0.9807363748550415, best validation acc: 0.9861792922019958, corresponding to test acc:                         0.961650013923645 / 0.9709957838058472
after epoch: 12,now: 2024-06-06 16:08:12.044958,epoch time: 0:23:54.678635,used: 5:04:56.170265,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9890095, 'precision': 0.90689504, 'recall': 0.92431295, 'specificity': 0.92431295, 'f1': 0.91540647, 'auroc': 0.99395907, 'binary_precision': 0.8187251, 'binary_recall': 0.8550624, 'binary_specificity': 0.9935635, 'binary_f1_score': 0.83649933}
confusion matrix:
       0     1
0  42141   273
1    209  1233
---- Validation: 
scalar performance:
{'acc': 0.9855923, 'precision': 0.9118694, 'recall': 0.8716476, 'specificity': 0.8716476, 'f1': 0.89063704, 'auroc': 0.98273826, 'binary_precision': 0.8330579, 'binary_recall': 0.7488856, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.78873235}
confusion matrix:
       0    1
0  17966  101
1    169  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.78109074, 'recall': 0.55040944, 'specificity': 0.55040944, 'f1': 0.5781587, 'auroc': 0.9546545, 'binary_precision': 0.6, 'binary_recall': 0.103846155, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.17704919}
confusion matrix:
      0   1
0  5928  18
1   233  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_13.png
early stop counter: 2
val acc:0.9855923056602478, best validation acc: 0.9861792922019958, corresponding to test acc:                         0.961650013923645 / 0.9709957838058472
after epoch: 13,now: 2024-06-06 16:32:11.680728,epoch time: 0:23:59.635770,used: 5:28:55.806035,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9891007, 'precision': 0.9479153, 'recall': 0.8724425, 'specificity': 0.8724425, 'f1': 0.90645427, 'auroc': 0.9934516, 'binary_precision': 0.90436244, 'binary_recall': 0.74757284, 'binary_specificity': 0.9973122, 'binary_f1_score': 0.8185269}
confusion matrix:
       0     1
0  42300   114
1    364  1078
---- Validation: 
scalar performance:
{'acc': 0.98441833, 'precision': 0.9454692, 'recall': 0.81524795, 'specificity': 0.81524795, 'f1': 0.86835957, 'auroc': 0.98023725, 'binary_precision': 0.9044586, 'binary_recall': 0.6329866, 'binary_specificity': 0.9975093, 'binary_f1_score': 0.74475527}
confusion matrix:
       0    1
0  18022   45
1    247  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.8025285, 'recall': 0.55066174, 'specificity': 0.55066174, 'f1': 0.5791645, 'auroc': 0.9618902, 'binary_precision': 0.64285713, 'binary_recall': 0.103846155, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.17880796}
confusion matrix:
      0   1
0  5931  15
1   233  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_14.png
early stop counter: 3
val acc:0.9844183325767517, best validation acc: 0.9861792922019958, corresponding to test acc:                         0.961650013923645 / 0.9709957838058472
after epoch: 14,now: 2024-06-06 16:56:52.026590,epoch time: 0:24:40.345862,used: 5:53:36.151897,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9911529, 'precision': 0.9451809, 'recall': 0.911688, 'specificity': 0.911688, 'f1': 0.92773044, 'auroc': 0.99530244, 'binary_precision': 0.8962406, 'binary_recall': 0.8266297, 'binary_specificity': 0.99674636, 'binary_f1_score': 0.86002886}
confusion matrix:
       0     1
0  42276   138
1    250  1192
---- Validation: 
scalar performance:
{'acc': 0.983031, 'precision': 0.91516066, 'recall': 0.8216811, 'specificity': 0.8216811, 'f1': 0.8620051, 'auroc': 0.9821316, 'binary_precision': 0.84332687, 'binary_recall': 0.64784545, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.73277307}
confusion matrix:
       0    1
0  17986   81
1    237  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7710154, 'recall': 0.5614434, 'specificity': 0.5614434, 'f1': 0.5937248, 'auroc': 0.95210016, 'binary_precision': 0.57894737, 'binary_recall': 0.12692308, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.2082019}
confusion matrix:
      0   1
0  5922  24
1   227  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_15.png
early stop counter: 4
val acc:0.9830309748649597, best validation acc: 0.9861792922019958, corresponding to test acc:                         0.961650013923645 / 0.9709957838058472
after epoch: 15,now: 2024-06-06 17:21:18.646857,epoch time: 0:24:26.620267,used: 6:18:02.772164,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9887131, 'precision': 0.9819793, 'recall': 0.83673716, 'specificity': 0.83673716, 'f1': 0.89562154, 'auroc': 0.99630046, 'binary_precision': 0.9749248, 'binary_recall': 0.6740638, 'binary_specificity': 0.99941057, 'binary_f1_score': 0.797048}
confusion matrix:
       0    1
0  42389   25
1    470  972
---- Validation: 
scalar performance:
{'acc': 0.98191035, 'precision': 0.9535075, 'recall': 0.76960063, 'specificity': 0.76960063, 'f1': 0.8364885, 'auroc': 0.9810674, 'binary_precision': 0.92385787, 'binary_recall': 0.5408618, 'binary_specificity': 0.99833953, 'binary_f1_score': 0.68228674}
confusion matrix:
       0    1
0  18037   30
1    309  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.8093687, 'recall': 0.5432217, 'specificity': 0.5432217, 'f1': 0.5676913, 'auroc': 0.9416791, 'binary_precision': 0.6571429, 'binary_recall': 0.08846154, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.1559322}
confusion matrix:
      0   1
0  5934  12
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_16.png
early stop counter: 5
val acc:0.9819103479385376, best validation acc: 0.9861792922019958, corresponding to test acc:                         0.961650013923645 / 0.9709957838058472
after epoch: 16,now: 2024-06-06 17:46:28.268955,epoch time: 0:25:09.622098,used: 6:43:12.394262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99094766, 'precision': 0.91551507, 'recall': 0.94909656, 'specificity': 0.94909656, 'f1': 0.9316, 'auroc': 0.99635935, 'binary_precision': 0.834293, 'binary_recall': 0.90429956, 'binary_specificity': 0.9938935, 'binary_f1_score': 0.8678868}
confusion matrix:
       0     1
0  42155   259
1    138  1304
---- Validation: 
scalar performance:
{'acc': 0.9858591, 'precision': 0.896016, 'recall': 0.90111196, 'specificity': 0.90111196, 'f1': 0.8985462, 'auroc': 0.9827163, 'binary_precision': 0.79912025, 'binary_recall': 0.8098068, 'binary_specificity': 0.9924171, 'binary_f1_score': 0.8044281}
confusion matrix:
       0    1
0  17930  137
1    128  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.84122944, 'recall': 0.60015714, 'specificity': 0.60015714, 'f1': 0.64924395, 'auroc': 0.93427706, 'binary_precision': 0.7162162, 'binary_recall': 0.20384616, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.3173653}
confusion matrix:
      0   1
0  5925  21
1   207  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_17.png
early stop counter: 6
val acc:0.9858590960502625, best validation acc: 0.9861792922019958, corresponding to test acc:                         0.961650013923645 / 0.9709957838058472
after epoch: 17,now: 2024-06-06 18:11:15.008941,epoch time: 0:24:46.739986,used: 7:07:59.134248,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9927946, 'precision': 0.9470543, 'recall': 0.93866307, 'specificity': 0.93866307, 'f1': 0.9428159, 'auroc': 0.99757147, 'binary_precision': 0.89816123, 'binary_recall': 0.8807212, 'binary_specificity': 0.9966049, 'binary_f1_score': 0.88935566}
confusion matrix:
       0     1
0  42270   144
1    172  1270
---- Validation: 
scalar performance:
{'acc': 0.9850587, 'precision': 0.9191476, 'recall': 0.8527739, 'specificity': 0.8527739, 'f1': 0.8828687, 'auroc': 0.9800946, 'binary_precision': 0.8490231, 'binary_recall': 0.7102526, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.7734628}
confusion matrix:
       0    1
0  17982   85
1    195  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.7878182, 'recall': 0.6270693, 'specificity': 0.6270693, 'f1': 0.6729951, 'auroc': 0.93640167, 'binary_precision': 0.60714287, 'binary_recall': 0.26153848, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.3655914}
confusion matrix:
      0   1
0  5902  44
1   192  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_18.png
early stop counter: 7
val acc:0.9850587248802185, best validation acc: 0.9861792922019958, corresponding to test acc:                         0.961650013923645 / 0.9709957838058472
after epoch: 18,now: 2024-06-06 18:36:07.581908,epoch time: 0:24:52.572967,used: 7:32:51.707215,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.992749, 'precision': 0.9634255, 'recall': 0.9191569, 'specificity': 0.9191569, 'f1': 0.94009954, 'auroc': 0.99739283, 'binary_precision': 0.93225557, 'binary_recall': 0.8403886, 'binary_specificity': 0.9979253, 'binary_f1_score': 0.88394153}
confusion matrix:
       0     1
0  42327    88
1    230  1211
---- Validation: 
scalar performance:
{'acc': 0.9864461, 'precision': 0.9425514, 'recall': 0.8506324, 'specificity': 0.8506324, 'f1': 0.890842, 'auroc': 0.98021626, 'binary_precision': 0.89603025, 'binary_recall': 0.70430905, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.78868556}
confusion matrix:
       0    1
0  18012   55
1    199  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.88450956, 'recall': 0.53996414, 'specificity': 0.53996414, 'f1': 0.5633656, 'auroc': 0.9354372, 'binary_precision': 0.8076923, 'binary_recall': 0.08076923, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.14685315}
confusion matrix:
      0   1
0  5941   5
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_19.png
better model found
persisted
after epoch: 19,now: 2024-06-06 19:00:54.154653,epoch time: 0:24:46.572745,used: 7:57:38.279960,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9929086, 'precision': 0.9393136, 'recall': 0.9507803, 'specificity': 0.9507803, 'f1': 0.94496727, 'auroc': 0.99728864, 'binary_precision': 0.8818366, 'binary_recall': 0.90568656, 'binary_specificity': 0.995874, 'binary_f1_score': 0.8936025}
confusion matrix:
       0     1
0  42239   175
1    136  1306
---- Validation: 
scalar performance:
{'acc': 0.9860192, 'precision': 0.91911936, 'recall': 0.8697232, 'specificity': 0.8697232, 'f1': 0.8927436, 'auroc': 0.98293245, 'binary_precision': 0.84771574, 'binary_recall': 0.7444279, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.7927215}
confusion matrix:
       0    1
0  17977   90
1    172  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.83063996, 'recall': 0.6112752, 'specificity': 0.6112752, 'f1': 0.6616087, 'auroc': 0.9565862, 'binary_precision': 0.69411767, 'binary_recall': 0.22692308, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.342029}
confusion matrix:
      0   1
0  5920  26
1   201  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_20.png
early stop counter: 1
val acc:0.9860191941261292, best validation acc: 0.9864460825920105, corresponding to test acc:                         0.9606832265853882 / 0.9709957838058472
after epoch: 20,now: 2024-06-06 19:25:22.569449,epoch time: 0:24:28.414796,used: 8:22:06.694756,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9922702, 'precision': 0.9700767, 'recall': 0.90456176, 'specificity': 0.90456176, 'f1': 0.9346895, 'auroc': 0.9972615, 'binary_precision': 0.9465587, 'binary_recall': 0.8106796, 'binary_specificity': 0.9984439, 'binary_f1_score': 0.8733657}
confusion matrix:
       0     1
0  42348    66
1    273  1169
---- Validation: 
scalar performance:
{'acc': 0.98553896, 'precision': 0.9600288, 'recall': 0.82083595, 'specificity': 0.82083595, 'f1': 0.8770983, 'auroc': 0.9758604, 'binary_precision': 0.93318963, 'binary_recall': 0.6433878, 'binary_specificity': 0.99828416, 'binary_f1_score': 0.7616535}
confusion matrix:
       0    1
0  18036   31
1    240  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.9104014, 'recall': 0.56872624, 'specificity': 0.56872624, 'f1': 0.609709, 'auroc': 0.9366962, 'binary_precision': 0.85714287, 'binary_recall': 0.13846155, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.2384106}
confusion matrix:
      0   1
0  5940   6
1   224  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_21.png
early stop counter: 2
val acc:0.9855389595031738, best validation acc: 0.9864460825920105, corresponding to test acc:                         0.9606832265853882 / 0.9709957838058472
after epoch: 21,now: 2024-06-06 19:50:04.873255,epoch time: 0:24:42.303806,used: 8:46:48.998562,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99498355, 'precision': 0.9694084, 'recall': 0.95051324, 'specificity': 0.95051324, 'f1': 0.9597523, 'auroc': 0.99843514, 'binary_precision': 0.94211286, 'binary_recall': 0.9029126, 'binary_specificity': 0.9981138, 'binary_f1_score': 0.9220963}
confusion matrix:
       0     1
0  42334    80
1    140  1302
---- Validation: 
scalar performance:
{'acc': 0.9864461, 'precision': 0.939012, 'recall': 0.8542087, 'specificity': 0.8542087, 'f1': 0.8917128, 'auroc': 0.9826448, 'binary_precision': 0.8886827, 'binary_recall': 0.71173847, 'binary_specificity': 0.996679, 'binary_f1_score': 0.79042906}
confusion matrix:
       0    1
0  18007   60
1    194  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.8599994, 'recall': 0.6042556, 'specificity': 0.6042556, 'f1': 0.6559343, 'auroc': 0.93755627, 'binary_precision': 0.75342464, 'binary_recall': 0.21153846, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.33033034}
confusion matrix:
      0   1
0  5928  18
1   205  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_22.png
early stop counter: 3
val acc:0.9864460825920105, best validation acc: 0.9864460825920105, corresponding to test acc:                         0.9606832265853882 / 0.9709957838058472
after epoch: 22,now: 2024-06-06 20:14:45.878029,epoch time: 0:24:41.004774,used: 9:11:30.003336,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99425393, 'precision': 0.9596082, 'recall': 0.94913113, 'specificity': 0.94913113, 'f1': 0.9543047, 'auroc': 0.9977864, 'binary_precision': 0.92258525, 'binary_recall': 0.9008322, 'binary_specificity': 0.9974301, 'binary_f1_score': 0.911579}
confusion matrix:
       0     1
0  42305   109
1    143  1299
---- Validation: 
scalar performance:
{'acc': 0.986873, 'precision': 0.9442594, 'recall': 0.8558607, 'specificity': 0.8558607, 'f1': 0.8947878, 'auroc': 0.9815847, 'binary_precision': 0.89906543, 'binary_recall': 0.71471024, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.7963576}
confusion matrix:
       0    1
0  18013   54
1    192  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.82757366, 'recall': 0.6319245, 'specificity': 0.6319245, 'f1': 0.68415856, 'auroc': 0.9387418, 'binary_precision': 0.6862745, 'binary_recall': 0.26923078, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.38674036}
confusion matrix:
      0   1
0  5914  32
1   190  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_23.png
better model found
persisted
after epoch: 23,now: 2024-06-06 20:39:16.895494,epoch time: 0:24:31.017465,used: 9:36:01.020801,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9929542, 'precision': 0.9594207, 'recall': 0.9270222, 'specificity': 0.9270222, 'f1': 0.94258535, 'auroc': 0.99774945, 'binary_precision': 0.9237098, 'binary_recall': 0.85644937, 'binary_specificity': 0.99759513, 'binary_f1_score': 0.8888089}
confusion matrix:
       0     1
0  42312   102
1    207  1235
---- Validation: 
scalar performance:
{'acc': 0.9869264, 'precision': 0.94804156, 'recall': 0.8530273, 'specificity': 0.8530273, 'f1': 0.8944551, 'auroc': 0.9790788, 'binary_precision': 0.9068441, 'binary_recall': 0.7087667, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.795663}
confusion matrix:
       0    1
0  18018   49
1    196  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.80116045, 'recall': 0.51688725, 'specificity': 0.51688725, 'f1': 0.5223013, 'auroc': 0.92279243, 'binary_precision': 0.64285713, 'binary_recall': 0.034615386, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.06569343}
confusion matrix:
      0  1
0  5941  5
1   251  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_24.png
better model found
persisted
after epoch: 24,now: 2024-06-06 21:03:48.022642,epoch time: 0:24:31.127148,used: 10:00:32.147949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9942311, 'precision': 0.97183824, 'recall': 0.9353863, 'specificity': 0.9353863, 'f1': 0.9528264, 'auroc': 0.9979014, 'binary_precision': 0.948003, 'binary_recall': 0.87239945, 'binary_specificity': 0.99837315, 'binary_f1_score': 0.90863127}
confusion matrix:
       0     1
0  42345    69
1    184  1258
---- Validation: 
scalar performance:
{'acc': 0.98404485, 'precision': 0.9197106, 'recall': 0.83436644, 'specificity': 0.83436644, 'f1': 0.8718123, 'auroc': 0.9741057, 'binary_precision': 0.85150373, 'binary_recall': 0.6731055, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.7518672}
confusion matrix:
       0    1
0  17988   79
1    220  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.8148208, 'recall': 0.560193, 'specificity': 0.560193, 'f1': 0.5938168, 'auroc': 0.8881347, 'binary_precision': 0.6666667, 'binary_recall': 0.12307692, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.20779221}
confusion matrix:
      0   1
0  5930  16
1   228  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_25.png
early stop counter: 1
val acc:0.9840448498725891, best validation acc: 0.9869263768196106, corresponding to test acc:                         0.9587495923042297 / 0.9709957838058472
after epoch: 25,now: 2024-06-06 21:28:17.728892,epoch time: 0:24:29.706250,used: 10:25:01.854199,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9946644, 'precision': 0.96376836, 'recall': 0.9513201, 'specificity': 0.9513201, 'f1': 0.95745325, 'auroc': 0.9988293, 'binary_precision': 0.9307637, 'binary_recall': 0.90492713, 'binary_specificity': 0.9977131, 'binary_f1_score': 0.91766363}
confusion matrix:
       0     1
0  42318    97
1    137  1304
---- Validation: 
scalar performance:
{'acc': 0.9854856, 'precision': 0.92652655, 'recall': 0.85156476, 'specificity': 0.85156476, 'f1': 0.8851378, 'auroc': 0.97911215, 'binary_precision': 0.86388385, 'binary_recall': 0.7072808, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.7777778}
confusion matrix:
       0    1
0  17992   75
1    197  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.81512785, 'recall': 0.56771713, 'specificity': 0.56771713, 'f1': 0.60464805, 'auroc': 0.841444, 'binary_precision': 0.6666667, 'binary_recall': 0.13846155, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.22929938}
confusion matrix:
      0   1
0  5928  18
1   224  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_26.png
early stop counter: 2
val acc:0.9854856133460999, best validation acc: 0.9869263768196106, corresponding to test acc:                         0.9587495923042297 / 0.9709957838058472
after epoch: 26,now: 2024-06-06 21:52:17.597664,epoch time: 0:23:59.868772,used: 10:49:01.722971,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9953712, 'precision': 0.97305375, 'recall': 0.9530583, 'specificity': 0.9530583, 'f1': 0.9628242, 'auroc': 0.99888873, 'binary_precision': 0.9492386, 'binary_recall': 0.907767, 'binary_specificity': 0.9983496, 'binary_f1_score': 0.9280397}
confusion matrix:
       0     1
0  42344    70
1    133  1309
---- Validation: 
scalar performance:
{'acc': 0.9877268, 'precision': 0.9468654, 'recall': 0.8670325, 'specificity': 0.8670325, 'f1': 0.9027203, 'auroc': 0.9785523, 'binary_precision': 0.90346086, 'binary_recall': 0.7369985, 'binary_specificity': 0.9970665, 'binary_f1_score': 0.81178397}
confusion matrix:
       0    1
0  18014   53
1    177  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.8821312, 'recall': 0.57608217, 'specificity': 0.57608217, 'f1': 0.61952966, 'auroc': 0.92091334, 'binary_precision': 0.8, 'binary_recall': 0.15384616, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.25806454}
confusion matrix:
      0   1
0  5936  10
1   220  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_27.png
better model found
persisted
after epoch: 27,now: 2024-06-06 22:16:00.850064,epoch time: 0:23:43.252400,used: 11:12:44.975371,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9953712, 'precision': 0.9798644, 'recall': 0.9460243, 'specificity': 0.9460243, 'f1': 0.962281, 'auroc': 0.9991202, 'binary_precision': 0.9633508, 'binary_recall': 0.89320385, 'binary_specificity': 0.99884474, 'binary_f1_score': 0.9269521}
confusion matrix:
       0     1
0  42365    49
1    154  1288
---- Validation: 
scalar performance:
{'acc': 0.9864995, 'precision': 0.9391422, 'recall': 0.8549517, 'specificity': 0.8549517, 'f1': 0.8922251, 'auroc': 0.97955513, 'binary_precision': 0.8888889, 'binary_recall': 0.71322435, 'binary_specificity': 0.996679, 'binary_f1_score': 0.79142624}
confusion matrix:
       0    1
0  18007   60
1    193  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.83093536, 'recall': 0.56980836, 'specificity': 0.56980836, 'f1': 0.608334, 'auroc': 0.94047725, 'binary_precision': 0.6981132, 'binary_recall': 0.1423077, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.23642173}
confusion matrix:
      0   1
0  5930  16
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_28.png
early stop counter: 1
val acc:0.9864994883537292, best validation acc: 0.9877268075942993, corresponding to test acc:                         0.9629390835762024 / 0.9709957838058472
after epoch: 28,now: 2024-06-06 22:39:45.771133,epoch time: 0:23:44.921069,used: 11:36:29.896440,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99352425, 'precision': 0.9375881, 'recall': 0.9644966, 'specificity': 0.9644966, 'f1': 0.95060915, 'auroc': 0.9987748, 'binary_precision': 0.87744457, 'binary_recall': 0.9334258, 'binary_specificity': 0.9955675, 'binary_f1_score': 0.90456986}
confusion matrix:
       0     1
0  42226   188
1     96  1346
---- Validation: 
scalar performance:
{'acc': 0.98537886, 'precision': 0.91442394, 'recall': 0.8643843, 'specificity': 0.8643843, 'f1': 0.88765943, 'auroc': 0.97827286, 'binary_precision': 0.83870965, 'binary_recall': 0.73402673, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.78288424}
confusion matrix:
       0    1
0  17972   95
1    179  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.842723, 'recall': 0.5397119, 'specificity': 0.5397119, 'f1': 0.5624771, 'auroc': 0.9036565, 'binary_precision': 0.7241379, 'binary_recall': 0.08076923, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.14532872}
confusion matrix:
      0   1
0  5938   8
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_29.png
early stop counter: 2
val acc:0.9853788614273071, best validation acc: 0.9877268075942993, corresponding to test acc:                         0.9629390835762024 / 0.9709957838058472
after epoch: 29,now: 2024-06-06 23:03:30.879932,epoch time: 0:23:45.108799,used: 12:00:15.005239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99377507, 'precision': 0.98683745, 'recall': 0.9137136, 'specificity': 0.9137136, 'f1': 0.9470986, 'auroc': 0.9991809, 'binary_precision': 0.9794914, 'binary_recall': 0.82801664, 'binary_specificity': 0.99941057, 'binary_f1_score': 0.89740705}
confusion matrix:
       0     1
0  42389    25
1    248  1194
---- Validation: 
scalar performance:
{'acc': 0.9850053, 'precision': 0.9707524, 'recall': 0.80482334, 'specificity': 0.80482334, 'f1': 0.8687578, 'auroc': 0.97998893, 'binary_precision': 0.95581394, 'binary_recall': 0.61069834, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.7452402}
confusion matrix:
       0    1
0  18048   19
1    262  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.76097536, 'recall': 0.51671904, 'specificity': 0.51671904, 'f1': 0.5219792, 'auroc': 0.90442, 'binary_precision': 0.5625, 'binary_recall': 0.034615386, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.0652174}
confusion matrix:
      0  1
0  5939  7
1   251  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127986_30.png
early stop counter: 3
val acc:0.9850053191184998, best validation acc: 0.9877268075942993, corresponding to test acc:                         0.9629390835762024 / 0.9709957838058472
after epoch: 30,now: 2024-06-06 23:27:46.007270,epoch time: 0:24:15.127338,used: 12:24:30.132577,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_03_15_seed_1_21127986
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:24:30.132577 at 2024-06-06 23:27:46.007270
persisted model performance metric: 

scalar performance:
{'acc': 0.9619723, 'precision': 0.85681224, 'recall': 0.5682217, 'specificity': 0.5682217, 'f1': 0.6071343, 'auroc': 0.9181578, 'binary_precision': 0.75, 'binary_recall': 0.13846155, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.23376626}
confusion matrix:
      0   1
0  5934  12
1   224  36
oracle model performance metric: 

scalar performance:
{'acc': 0.97067356, 'precision': 0.8265768, 'recall': 0.787924, 'specificity': 0.787924, 'f1': 0.80589294, 'auroc': 0.94956225, 'binary_precision': 0.67105263, 'binary_recall': 0.5884615, 'binary_specificity': 0.98738647, 'binary_f1_score': 0.6270492}
confusion matrix:
      0    1
0  5871   75
1   107  153
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454154 KiB |   2003 MiB |   1871 TiB |   1871 TiB |
|       from large pool | 412478 KiB |   1971 MiB |   1847 TiB |   1847 TiB |
|       from small pool |  41675 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 454154 KiB |   2003 MiB |   1871 TiB |   1871 TiB |
|       from large pool | 412478 KiB |   1971 MiB |   1847 TiB |   1847 TiB |
|       from small pool |  41675 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |   1998 MiB |   1869 TiB |   1869 TiB |
|       from large pool | 407075 KiB |   1966 MiB |   1845 TiB |   1845 TiB |
|       from small pool |  40676 KiB |     60 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2278 MiB |   2282 MiB |   3790 MiB |   1512 MiB |
|       from large pool |   2214 MiB |   2214 MiB |   3706 MiB |   1492 MiB |
|       from small pool |     64 MiB |     70 MiB |     84 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 365046 KiB | 428787 KiB |   1460 TiB |   1460 TiB |
|       from large pool | 357569 KiB | 408037 KiB |   1435 TiB |   1435 TiB |
|       from small pool |   7476 KiB |  21494 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    6467    |  360993 K  |  360990 K  |
|       from large pool |     187    |     311    |  175918 K  |  175918 K  |
|       from small pool |    3277    |    6279    |  185075 K  |  185072 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    6467    |  360993 K  |  360990 K  |
|       from large pool |     187    |     311    |  175918 K  |  175918 K  |
|       from small pool |    3277    |    6279    |  185075 K  |  185072 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     127    |     194    |      69    |
|       from large pool |      93    |      93    |     152    |      59    |
|       from small pool |      32    |      35    |      42    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |    2798    |  190544 K  |  190544 K  |
|       from large pool |      40    |      93    |  118942 K  |  118942 K  |
|       from small pool |      30    |    2758    |   71601 K  |   71601 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |   1871 TiB |   1871 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1847 TiB |   1847 TiB |
|       from small pool |      0 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |   1871 TiB |   1871 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1847 TiB |   1847 TiB |
|       from small pool |      0 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |   1869 TiB |   1869 TiB |
|       from large pool |  16640 KiB |   1966 MiB |   1845 TiB |   1845 TiB |
|       from small pool |      0 KiB |     60 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    800 MiB |   2282 MiB |   3790 MiB |   2990 MiB |
|       from large pool |    752 MiB |   2214 MiB |   3706 MiB |   2954 MiB |
|       from small pool |     48 MiB |     70 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 457405 KiB |   1460 TiB |   1460 TiB |
|       from large pool |  24320 KiB | 444488 KiB |   1435 TiB |   1435 TiB |
|       from small pool |      0 KiB |  22399 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6467    |  360993 K  |  360993 K  |
|       from large pool |       2    |     311    |  175918 K  |  175918 K  |
|       from small pool |       0    |    6279    |  185075 K  |  185075 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6467    |  360993 K  |  360993 K  |
|       from large pool |       2    |     311    |  175918 K  |  175918 K  |
|       from small pool |       0    |    6279    |  185075 K  |  185075 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     194    |     136    |
|       from large pool |      34    |      93    |     152    |     118    |
|       from small pool |      24    |      35    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2798    |  190545 K  |  190545 K  |
|       from large pool |       3    |      93    |  118942 K  |  118942 K  |
|       from small pool |       0    |    2758    |   71602 K  |   71602 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |   1871 TiB |   1871 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1847 TiB |   1847 TiB |
|       from small pool |      0 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |   1871 TiB |   1871 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1847 TiB |   1847 TiB |
|       from small pool |      0 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |   1869 TiB |   1869 TiB |
|       from large pool |  16640 KiB |   1966 MiB |   1845 TiB |   1845 TiB |
|       from small pool |      0 KiB |     60 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    800 MiB |   2282 MiB |   3790 MiB |   2990 MiB |
|       from large pool |    752 MiB |   2214 MiB |   3706 MiB |   2954 MiB |
|       from small pool |     48 MiB |     70 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 457405 KiB |   1460 TiB |   1460 TiB |
|       from large pool |  24320 KiB | 444488 KiB |   1435 TiB |   1435 TiB |
|       from small pool |      0 KiB |  22399 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6467    |  360993 K  |  360993 K  |
|       from large pool |       2    |     311    |  175918 K  |  175918 K  |
|       from small pool |       0    |    6279    |  185075 K  |  185075 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6467    |  360993 K  |  360993 K  |
|       from large pool |       2    |     311    |  175918 K  |  175918 K  |
|       from small pool |       0    |    6279    |  185075 K  |  185075 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     194    |     136    |
|       from large pool |      34    |      93    |     152    |     118    |
|       from small pool |      24    |      35    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2798    |  190545 K  |  190545 K  |
|       from large pool |       3    |      93    |  118942 K  |  118942 K  |
|       from small pool |       0    |    2758    |   71602 K  |   71602 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


patient_073_node_1_0:   0%|          | 0/95 [00:00<?, ?it/s][A
patient_073_node_1_0:  15%|█▍        | 14/95 [00:00<00:00, 123.01it/s][A
patient_073_node_1_0:  28%|██▊       | 27/95 [00:00<00:00, 107.24it/s][A
                                                                      [A[Thu Jun  6 23:30:33 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/0.csv

RuleException:
FileNotFoundError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[Errno 2] No such file or directory: '/ictstr01/groups/aih/sina.wendrich/MA_code/output_CAMELYON17/patches/8/128/patient_073_node_1/patient_073_node_1_patch_0_384_13440_/lustre/groups/shared/histology_data/CAMELYON17/slides/center3_0.png'
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 168, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 30, in __init__
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/tasks/zoo_tasks.py", line 36, in __call__
  File "/lustre/groups/aih/sina.wendrich/MA_code/MA_thesis/tasks/task_CAMELYON17.py", line 151, in get_task
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/tasks/patches_processing.py", line 424, in process_slides
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/_base.py", line 451, in result
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/tasks/patches_processing.py", line 463, in process_row_annotations
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/PIL/Image.py", line 2456, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
