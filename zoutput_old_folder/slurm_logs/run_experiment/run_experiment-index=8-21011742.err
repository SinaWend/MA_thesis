Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri May 31 13:26:34 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742

 Experiment start at: 2024-05-31 13:34:32.173129
before training, model accuracy: 0.2401725947856903
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96837324, 'precision': 0.7570951, 'recall': 0.7403651, 'specificity': 0.7403651, 'f1': 0.74841833, 'auroc': 0.9427041, 'binary_precision': 0.53168243, 'binary_recall': 0.4959239, 'binary_specificity': 0.98480624, 'binary_f1_score': 0.513181}
confusion matrix:
       0    1
0  41677  643
1    742  730
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.74306536, 'recall': 0.7236818, 'specificity': 0.7236818, 'f1': 0.7329252, 'auroc': 0.94091356, 'binary_precision': 0.50508475, 'binary_recall': 0.46345258, 'binary_specificity': 0.983911, 'binary_f1_score': 0.4833739}
confusion matrix:
       0    1
0  17857  292
1    345  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9744327, 'precision': 0.9280945, 'recall': 0.72280395, 'specificity': 0.72280395, 'f1': 0.7903547, 'auroc': 0.9125674, 'binary_precision': 0.87969923, 'binary_recall': 0.44827586, 'binary_specificity': 0.997332, 'binary_f1_score': 0.59390867}
confusion matrix:
      0    1
0  5981   16
1   144  117
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-31 13:56:11.985583,epoch time: 0:21:39.812454,used: 0:21:39.812454,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96839607, 'precision': 0.75590193, 'recall': 0.81709594, 'specificity': 0.81709594, 'f1': 0.7828512, 'auroc': 0.95307624, 'binary_precision': 0.523913, 'binary_recall': 0.6548913, 'binary_specificity': 0.97930056, 'binary_f1_score': 0.58212554}
confusion matrix:
       0    1
0  41444  876
1    508  964
---- Validation: 
scalar performance:
{'acc': 0.96823114, 'precision': 0.75867826, 'recall': 0.7930388, 'specificity': 0.7930388, 'f1': 0.7746653, 'auroc': 0.95336163, 'binary_precision': 0.53142077, 'binary_recall': 0.60497665, 'binary_specificity': 0.9811009, 'binary_f1_score': 0.56581825}
confusion matrix:
       0    1
0  17806  343
1    254  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9787472, 'precision': 0.9248679, 'recall': 0.7873544, 'specificity': 0.7873544, 'f1': 0.84162194, 'auroc': 0.93196964, 'binary_precision': 0.8678161, 'binary_recall': 0.5785441, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.69425297}
confusion matrix:
      0    1
0  5974   23
1   110  151
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-31 14:17:05.304305,epoch time: 0:20:53.318722,used: 0:42:33.131176,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9726434, 'precision': 0.7874744, 'recall': 0.80290055, 'specificity': 0.80290055, 'f1': 0.794965, 'auroc': 0.9635408, 'binary_precision': 0.58815956, 'binary_recall': 0.62092394, 'binary_specificity': 0.9848771, 'binary_f1_score': 0.6040978}
confusion matrix:
       0    1
0  41680  640
1    558  914
---- Validation: 
scalar performance:
{'acc': 0.97094506, 'precision': 0.77851963, 'recall': 0.79519385, 'specificity': 0.79519385, 'f1': 0.78658825, 'auroc': 0.95879185, 'binary_precision': 0.57101023, 'binary_recall': 0.60653186, 'binary_specificity': 0.98385584, 'binary_f1_score': 0.58823526}
confusion matrix:
       0    1
0  17856  293
1    253  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97778845, 'precision': 0.94577014, 'recall': 0.75753677, 'specificity': 0.75753677, 'f1': 0.82433283, 'auroc': 0.9299316, 'binary_precision': 0.9121622, 'binary_recall': 0.51724136, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.6601467}
confusion matrix:
      0    1
0  5984   13
1   126  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_3.png
better model found
persisted
after epoch: 3,now: 2024-05-31 14:37:27.968707,epoch time: 0:20:22.664402,used: 1:02:55.795578,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9717528, 'precision': 0.7777522, 'recall': 0.8247235, 'specificity': 0.8247235, 'f1': 0.79920805, 'auroc': 0.9673649, 'binary_precision': 0.5671296, 'binary_recall': 0.6671205, 'binary_specificity': 0.9823264, 'binary_f1_score': 0.6130748}
confusion matrix:
       0    1
0  41575  748
1    489  980
---- Validation: 
scalar performance:
{'acc': 0.969189, 'precision': 0.76386005, 'recall': 0.8355378, 'specificity': 0.8355378, 'f1': 0.79491115, 'auroc': 0.9616283, 'binary_precision': 0.53874093, 'binary_recall': 0.69206846, 'binary_specificity': 0.9790071, 'binary_f1_score': 0.60585433}
confusion matrix:
       0    1
0  17768  381
1    198  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9790668, 'precision': 0.92782366, 'recall': 0.7893535, 'specificity': 0.7893535, 'f1': 0.84400356, 'auroc': 0.9370691, 'binary_precision': 0.87356323, 'binary_recall': 0.58237547, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.6988506}
confusion matrix:
      0    1
0  5975   22
1   109  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_4.png
new oracle model saved
early stop counter: 1
val acc:0.9691889882087708, best validation acc: 0.9709450602531433, corresponding to test acc:                         0.9777884483337402 / 0.979066789150238
after epoch: 4,now: 2024-05-31 14:59:25.435981,epoch time: 0:21:57.467274,used: 1:24:53.262852,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9763884, 'precision': 0.8157133, 'recall': 0.8281162, 'specificity': 0.8281162, 'f1': 0.8217836, 'auroc': 0.9739807, 'binary_precision': 0.6429504, 'binary_recall': 0.6691576, 'binary_specificity': 0.9870747, 'binary_f1_score': 0.6557923}
confusion matrix:
       0    1
0  41773  547
1    487  985
---- Validation: 
scalar performance:
{'acc': 0.977384, 'precision': 0.8287865, 'recall': 0.82927966, 'specificity': 0.82927966, 'f1': 0.8290329, 'auroc': 0.9716056, 'binary_precision': 0.66925466, 'binary_recall': 0.6702955, 'binary_specificity': 0.98826385, 'binary_f1_score': 0.6697747}
confusion matrix:
       0    1
0  17936  213
1    212  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97746885, 'precision': 0.9371326, 'recall': 0.75920236, 'specificity': 0.75920236, 'f1': 0.8234728, 'auroc': 0.9360103, 'binary_precision': 0.8947368, 'binary_recall': 0.5210728, 'binary_specificity': 0.997332, 'binary_f1_score': 0.6585956}
confusion matrix:
      0    1
0  5981   16
1   125  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_5.png
better model found
persisted
after epoch: 5,now: 2024-05-31 15:20:04.707127,epoch time: 0:20:39.271146,used: 1:45:32.533998,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.976023, 'precision': 0.80736154, 'recall': 0.8518608, 'specificity': 0.8518608, 'f1': 0.82795656, 'auroc': 0.976687, 'binary_precision': 0.62455726, 'binary_recall': 0.71875, 'binary_specificity': 0.98497164, 'binary_f1_score': 0.66835123}
confusion matrix:
       0     1
0  41684   636
1    414  1058
---- Validation: 
scalar performance:
{'acc': 0.9780758, 'precision': 0.8386955, 'recall': 0.8213872, 'specificity': 0.8213872, 'f1': 0.82979333, 'auroc': 0.9713217, 'binary_precision': 0.6896552, 'binary_recall': 0.65318817, 'binary_specificity': 0.9895862, 'binary_f1_score': 0.6709266}
confusion matrix:
       0    1
0  17960  189
1    223  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97698945, 'precision': 0.9174254, 'recall': 0.768114, 'specificity': 0.768114, 'f1': 0.8250305, 'auroc': 0.9463496, 'binary_precision': 0.8545455, 'binary_recall': 0.54022986, 'binary_specificity': 0.995998, 'binary_f1_score': 0.66197175}
confusion matrix:
      0    1
0  5973   24
1   120  141
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_6.png
better model found
persisted
after epoch: 6,now: 2024-05-31 15:40:54.750686,epoch time: 0:20:50.043559,used: 2:06:22.577557,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97974515, 'precision': 0.84887767, 'recall': 0.83214796, 'specificity': 0.83214796, 'f1': 0.8402889, 'auroc': 0.9798297, 'binary_precision': 0.7090779, 'binary_recall': 0.67391306, 'binary_specificity': 0.9903828, 'binary_f1_score': 0.6910484}
confusion matrix:
       0    1
0  41913  407
1    480  992
---- Validation: 
scalar performance:
{'acc': 0.97903365, 'precision': 0.8505421, 'recall': 0.8188829, 'specificity': 0.8188829, 'f1': 0.8338965, 'auroc': 0.9751876, 'binary_precision': 0.7135506, 'binary_recall': 0.64696735, 'binary_specificity': 0.9907984, 'binary_f1_score': 0.6786297}
confusion matrix:
       0    1
0  17982  167
1    227  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.8219905, 'recall': 0.56005204, 'specificity': 0.56005204, 'f1': 0.59390265, 'auroc': 0.94828784, 'binary_precision': 0.68085104, 'binary_recall': 0.12260536, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.2077922}
confusion matrix:
      0   1
0  5982  15
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_7.png
better model found
persisted
after epoch: 7,now: 2024-05-31 16:01:25.758342,epoch time: 0:20:31.007656,used: 2:26:53.585213,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9810011, 'precision': 0.86707234, 'recall': 0.825469, 'specificity': 0.825469, 'f1': 0.8449146, 'auroc': 0.98263335, 'binary_precision': 0.74595845, 'binary_recall': 0.6587356, 'binary_specificity': 0.99220246, 'binary_f1_score': 0.69963896}
confusion matrix:
       0    1
0  41991  330
1    502  969
---- Validation: 
scalar performance:
{'acc': 0.9814815, 'precision': 0.8840986, 'recall': 0.8156498, 'specificity': 0.8156498, 'f1': 0.8462493, 'auroc': 0.9738463, 'binary_precision': 0.7809524, 'binary_recall': 0.63763607, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.7020548}
confusion matrix:
       0    1
0  18034  115
1    233  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.77863574, 'recall': 0.54647535, 'specificity': 0.54647535, 'f1': 0.57215047, 'auroc': 0.94390124, 'binary_precision': 0.5952381, 'binary_recall': 0.09578544, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.1650165}
confusion matrix:
      0   1
0  5980  17
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_8.png
better model found
persisted
after epoch: 8,now: 2024-05-31 16:22:38.413794,epoch time: 0:21:12.655452,used: 2:48:06.240665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9804531, 'precision': 0.85022056, 'recall': 0.8479235, 'specificity': 0.8479235, 'f1': 0.84906787, 'auroc': 0.9846276, 'binary_precision': 0.7106703, 'binary_recall': 0.7058424, 'binary_specificity': 0.9900047, 'binary_f1_score': 0.708248}
confusion matrix:
       0     1
0  41897   423
1    433  1039
---- Validation: 
scalar performance:
{'acc': 0.9825458, 'precision': 0.8933536, 'recall': 0.82445145, 'specificity': 0.82445145, 'f1': 0.8553253, 'auroc': 0.97665036, 'binary_precision': 0.7988615, 'binary_recall': 0.6547434, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.71965814}
confusion matrix:
       0    1
0  18043  106
1    222  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.8338796, 'recall': 0.5714629, 'specificity': 0.5714629, 'f1': 0.6108406, 'auroc': 0.9505826, 'binary_precision': 0.7037037, 'binary_recall': 0.14559387, 'binary_specificity': 0.997332, 'binary_f1_score': 0.24126984}
confusion matrix:
      0   1
0  5981  16
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_9.png
better model found
persisted
after epoch: 9,now: 2024-05-31 16:43:07.827124,epoch time: 0:20:29.413330,used: 3:08:35.653995,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9822342, 'precision': 0.8704163, 'recall': 0.8479886, 'specificity': 0.8479886, 'f1': 0.8588222, 'auroc': 0.98434305, 'binary_precision': 0.75108856, 'binary_recall': 0.70408165, 'binary_specificity': 0.9918955, 'binary_f1_score': 0.7268259}
confusion matrix:
       0     1
0  41979   343
1    435  1035
---- Validation: 
scalar performance:
{'acc': 0.9815347, 'precision': 0.889628, 'recall': 0.8089268, 'specificity': 0.8089268, 'f1': 0.8442372, 'auroc': 0.979125, 'binary_precision': 0.7924901, 'binary_recall': 0.62363917, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.6979982}
confusion matrix:
       0    1
0  18044  105
1    242  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.7965201, 'recall': 0.5634666, 'specificity': 0.5634666, 'f1': 0.5978144, 'auroc': 0.9443229, 'binary_precision': 0.6296296, 'binary_recall': 0.1302682, 'binary_specificity': 0.996665, 'binary_f1_score': 0.215873}
confusion matrix:
      0   1
0  5977  20
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_10.png
early stop counter: 1
val acc:0.9815347194671631, best validation acc: 0.982545793056488, corresponding to test acc:                         0.9618088603019714 / 0.979066789150238
after epoch: 10,now: 2024-05-31 17:03:52.615816,epoch time: 0:20:44.788692,used: 3:29:20.442687,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9790373, 'precision': 0.8288366, 'recall': 0.87046903, 'specificity': 0.87046903, 'f1': 0.84829307, 'auroc': 0.9824366, 'binary_precision': 0.6662665, 'binary_recall': 0.75407606, 'binary_specificity': 0.986862, 'binary_f1_score': 0.70745695}
confusion matrix:
       0     1
0  41764   556
1    362  1110
---- Validation: 
scalar performance:
{'acc': 0.9789804, 'precision': 0.83458525, 'recall': 0.8601084, 'specificity': 0.8601084, 'f1': 0.84683245, 'auroc': 0.9773656, 'binary_precision': 0.67867434, 'binary_recall': 0.7325039, 'binary_specificity': 0.9877128, 'binary_f1_score': 0.7045624}
confusion matrix:
       0    1
0  17926  223
1    172  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.76374435, 'recall': 0.5314832, 'specificity': 0.5314832, 'f1': 0.547908, 'auroc': 0.9304504, 'binary_precision': 0.56666666, 'binary_recall': 0.0651341, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.116838485}
confusion matrix:
      0   1
0  5984  13
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_11.png
early stop counter: 2
val acc:0.9789804220199585, best validation acc: 0.982545793056488, corresponding to test acc:                         0.9618088603019714 / 0.979066789150238
after epoch: 11,now: 2024-05-31 17:24:25.076489,epoch time: 0:20:32.460673,used: 3:49:52.903360,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98296493, 'precision': 0.8578632, 'recall': 0.8947956, 'specificity': 0.8947956, 'f1': 0.87533987, 'auroc': 0.9883315, 'binary_precision': 0.7226994, 'binary_recall': 0.80027175, 'binary_specificity': 0.98931944, 'binary_f1_score': 0.75951}
confusion matrix:
       0     1
0  41868   452
1    294  1178
---- Validation: 
scalar performance:
{'acc': 0.98185396, 'precision': 0.85365266, 'recall': 0.88484776, 'specificity': 0.88484776, 'f1': 0.8685293, 'auroc': 0.980341, 'binary_precision': 0.7150997, 'binary_recall': 0.7807154, 'binary_specificity': 0.9889801, 'binary_f1_score': 0.7464684}
confusion matrix:
       0    1
0  17949  200
1    141  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8541469, 'recall': 0.56604934, 'specificity': 0.56604934, 'f1': 0.6038887, 'auroc': 0.9417683, 'binary_precision': 0.7446808, 'binary_recall': 0.13409962, 'binary_specificity': 0.997999, 'binary_f1_score': 0.22727273}
confusion matrix:
      0   1
0  5985  12
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_12.png
early stop counter: 3
val acc:0.9818539619445801, best validation acc: 0.982545793056488, corresponding to test acc:                         0.9618088603019714 / 0.979066789150238
after epoch: 12,now: 2024-05-31 17:45:18.215877,epoch time: 0:20:53.139388,used: 4:10:46.042748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98221135, 'precision': 0.8475188, 'recall': 0.9039136, 'specificity': 0.9039136, 'f1': 0.873399, 'auroc': 0.9872123, 'binary_precision': 0.70133644, 'binary_recall': 0.8199728, 'binary_specificity': 0.9878544, 'binary_f1_score': 0.75602883}
confusion matrix:
       0     1
0  41806   514
1    265  1207
---- Validation: 
scalar performance:
{'acc': 0.98323756, 'precision': 0.87642145, 'recall': 0.8668127, 'specificity': 0.8668127, 'f1': 0.8715495, 'auroc': 0.981327, 'binary_precision': 0.76198083, 'binary_recall': 0.7418352, 'binary_specificity': 0.9917902, 'binary_f1_score': 0.75177306}
confusion matrix:
       0    1
0  18000  149
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7780882, 'recall': 0.540895, 'specificity': 0.540895, 'f1': 0.563431, 'auroc': 0.93804276, 'binary_precision': 0.5945946, 'binary_recall': 0.08429119, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.147651}
confusion matrix:
      0   1
0  5982  15
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_13.png
better model found
persisted
after epoch: 13,now: 2024-05-31 18:06:02.811214,epoch time: 0:20:44.595337,used: 4:31:30.638085,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9845634, 'precision': 0.8790895, 'recall': 0.88505596, 'specificity': 0.88505596, 'f1': 0.8820474, 'auroc': 0.9899608, 'binary_precision': 0.7658863, 'binary_recall': 0.77838206, 'binary_specificity': 0.99172986, 'binary_f1_score': 0.77208364}
confusion matrix:
       0     1
0  41971   350
1    326  1145
---- Validation: 
scalar performance:
{'acc': 0.98323756, 'precision': 0.8875876, 'recall': 0.84731126, 'specificity': 0.84731126, 'f1': 0.86625254, 'auroc': 0.9784799, 'binary_precision': 0.78571427, 'binary_recall': 0.7013997, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.7411668}
confusion matrix:
       0    1
0  18026  123
1    192  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.83818096, 'recall': 0.54705894, 'specificity': 0.54705894, 'f1': 0.574394, 'auroc': 0.9126916, 'binary_precision': 0.71428573, 'binary_recall': 0.09578544, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.16891892}
confusion matrix:
      0   1
0  5987  10
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_14.png
early stop counter: 1
val acc:0.9832375645637512, best validation acc: 0.9832375645637512, corresponding to test acc:                         0.9594119787216187 / 0.979066789150238
after epoch: 14,now: 2024-05-31 18:26:46.427558,epoch time: 0:20:43.616344,used: 4:52:14.254429,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9856595, 'precision': 0.9025415, 'recall': 0.8686496, 'specificity': 0.8686496, 'f1': 0.88479006, 'auroc': 0.9901339, 'binary_precision': 0.8139881, 'binary_recall': 0.7432065, 'binary_specificity': 0.99409264, 'binary_f1_score': 0.77698857}
confusion matrix:
       0     1
0  42070   250
1    378  1094
---- Validation: 
scalar performance:
{'acc': 0.9852065, 'precision': 0.9222951, 'recall': 0.8393299, 'specificity': 0.8393299, 'f1': 0.875942, 'auroc': 0.9781163, 'binary_precision': 0.8557505, 'binary_recall': 0.6827372, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.7595155}
confusion matrix:
       0    1
0  18075   74
1    204  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8403441, 'recall': 0.5621345, 'specificity': 0.5621345, 'f1': 0.5976221, 'auroc': 0.9398601, 'binary_precision': 0.7173913, 'binary_recall': 0.12643678, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.21498372}
confusion matrix:
      0   1
0  5984  13
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_15.png
better model found
persisted
after epoch: 15,now: 2024-05-31 18:47:41.353101,epoch time: 0:20:54.925543,used: 5:13:09.179972,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9871894, 'precision': 0.9094996, 'recall': 0.8887849, 'specificity': 0.8887849, 'f1': 0.8988515, 'auroc': 0.99288213, 'binary_precision': 0.8265233, 'binary_recall': 0.78328806, 'binary_specificity': 0.99428165, 'binary_f1_score': 0.80432516}
confusion matrix:
       0     1
0  42078   242
1    319  1153
---- Validation: 
scalar performance:
{'acc': 0.9860047, 'precision': 0.92217195, 'recall': 0.85399425, 'specificity': 0.85399425, 'f1': 0.88485265, 'auroc': 0.98145187, 'binary_precision': 0.8544776, 'binary_recall': 0.7122862, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.7769296}
confusion matrix:
       0    1
0  18071   78
1    185  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8653782, 'recall': 0.56238467, 'specificity': 0.56238467, 'f1': 0.5988081, 'auroc': 0.9337827, 'binary_precision': 0.76744187, 'binary_recall': 0.12643678, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.21710527}
confusion matrix:
      0   1
0  5987  10
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_16.png
better model found
persisted
after epoch: 16,now: 2024-05-31 19:08:17.504912,epoch time: 0:20:36.151811,used: 5:33:45.331783,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9831248, 'precision': 0.8540472, 'recall': 0.90924656, 'specificity': 0.90924656, 'f1': 0.8794638, 'auroc': 0.9899764, 'binary_precision': 0.7140351, 'binary_recall': 0.8300476, 'binary_specificity': 0.98844546, 'binary_f1_score': 0.7676832}
confusion matrix:
       0     1
0  41832   489
1    250  1221
---- Validation: 
scalar performance:
{'acc': 0.98169434, 'precision': 0.84821177, 'recall': 0.8960159, 'specificity': 0.8960159, 'f1': 0.8704308, 'auroc': 0.9802373, 'binary_precision': 0.7034014, 'binary_recall': 0.80404353, 'binary_specificity': 0.9879883, 'binary_f1_score': 0.7503629}
confusion matrix:
       0    1
0  17931  218
1    126  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.7807068, 'recall': 0.61152416, 'specificity': 0.61152416, 'f1': 0.6557903, 'auroc': 0.8965139, 'binary_precision': 0.5940594, 'binary_recall': 0.22988506, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.33149174}
confusion matrix:
      0   1
0  5956  41
1   201  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_17.png
early stop counter: 1
val acc:0.9816943407058716, best validation acc: 0.9860047101974487, corresponding to test acc:                         0.9619686603546143 / 0.979066789150238
after epoch: 17,now: 2024-05-31 19:28:51.954207,epoch time: 0:20:34.449295,used: 5:54:19.781078,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9872123, 'precision': 0.8924874, 'recall': 0.91764826, 'specificity': 0.91764826, 'f1': 0.9046433, 'auroc': 0.9934213, 'binary_precision': 0.79044586, 'binary_recall': 0.8430706, 'binary_specificity': 0.9922259, 'binary_f1_score': 0.8159105}
confusion matrix:
       0     1
0  41991   329
1    231  1241
---- Validation: 
scalar performance:
{'acc': 0.98483396, 'precision': 0.87819445, 'recall': 0.89914143, 'specificity': 0.89914143, 'f1': 0.8883604, 'auroc': 0.98061633, 'binary_precision': 0.7632353, 'binary_recall': 0.80715394, 'binary_specificity': 0.991129, 'binary_f1_score': 0.7845804}
confusion matrix:
       0    1
0  17988  161
1    124  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8868393, 'recall': 0.5568876, 'specificity': 0.5568876, 'f1': 0.5909314, 'auroc': 0.9284555, 'binary_precision': 0.8108108, 'binary_recall': 0.11494253, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.20134228}
confusion matrix:
      0   1
0  5990   7
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_18.png
early stop counter: 2
val acc:0.9848339557647705, best validation acc: 0.9860047101974487, corresponding to test acc:                         0.9619686603546143 / 0.979066789150238
after epoch: 18,now: 2024-05-31 19:49:52.522652,epoch time: 0:21:00.568445,used: 6:15:20.349523,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9863217, 'precision': 0.8836239, 'recall': 0.91549385, 'specificity': 0.91549385, 'f1': 0.8988674, 'auroc': 0.9930565, 'binary_precision': 0.77284104, 'binary_recall': 0.8395649, 'binary_specificity': 0.9914227, 'binary_f1_score': 0.8048223}
confusion matrix:
       0     1
0  41958   363
1    236  1235
---- Validation: 
scalar performance:
{'acc': 0.9841954, 'precision': 0.87292767, 'recall': 0.89581066, 'specificity': 0.89581066, 'f1': 0.8839977, 'auroc': 0.9831858, 'binary_precision': 0.75292397, 'binary_recall': 0.8009331, 'binary_specificity': 0.9906882, 'binary_f1_score': 0.7761869}
confusion matrix:
       0    1
0  17980  169
1    128  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8559669, 'recall': 0.54531, 'specificity': 0.54531, 'f1': 0.57188916, 'auroc': 0.9242395, 'binary_precision': 0.75, 'binary_recall': 0.09195402, 'binary_specificity': 0.998666, 'binary_f1_score': 0.16382253}
confusion matrix:
      0   1
0  5989   8
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_19.png
early stop counter: 3
val acc:0.9841954112052917, best validation acc: 0.9860047101974487, corresponding to test acc:                         0.9619686603546143 / 0.979066789150238
after epoch: 19,now: 2024-05-31 20:10:29.939393,epoch time: 0:20:37.416741,used: 6:35:57.766264,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98732644, 'precision': 0.8943242, 'recall': 0.9162875, 'specificity': 0.9162875, 'f1': 0.90498275, 'auroc': 0.99336785, 'binary_precision': 0.7942122, 'binary_recall': 0.84013605, 'binary_specificity': 0.9924389, 'binary_f1_score': 0.816529}
confusion matrix:
       0     1
0  42002   320
1    235  1235
---- Validation: 
scalar performance:
{'acc': 0.98664325, 'precision': 0.9023899, 'recall': 0.8933277, 'specificity': 0.8933277, 'f1': 0.8978028, 'auroc': 0.982514, 'binary_precision': 0.8121019, 'binary_recall': 0.7931571, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.8025177}
confusion matrix:
       0    1
0  18031  118
1    133  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8669131, 'recall': 0.55105716, 'specificity': 0.55105716, 'f1': 0.58131444, 'auroc': 0.9207643, 'binary_precision': 0.7714286, 'binary_recall': 0.10344828, 'binary_specificity': 0.998666, 'binary_f1_score': 0.18243244}
confusion matrix:
      0   1
0  5989   8
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_20.png
better model found
persisted
after epoch: 20,now: 2024-05-31 20:30:54.605490,epoch time: 0:20:24.666097,used: 6:56:22.432361,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9886052, 'precision': 0.90039885, 'recall': 0.9320955, 'specificity': 0.9320955, 'f1': 0.91559196, 'auroc': 0.99514794, 'binary_precision': 0.8052764, 'binary_recall': 0.871516, 'binary_specificity': 0.992675, 'binary_f1_score': 0.8370878}
confusion matrix:
       0     1
0  42011   310
1    189  1282
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.890641, 'recall': 0.908191, 'specificity': 0.908191, 'f1': 0.8992063, 'auroc': 0.98474324, 'binary_precision': 0.78751856, 'binary_recall': 0.82426125, 'binary_specificity': 0.9921208, 'binary_f1_score': 0.8054711}
confusion matrix:
       0    1
0  18006  143
1    113  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.83665085, 'recall': 0.5733786, 'specificity': 0.5733786, 'f1': 0.6136636, 'auroc': 0.93501616, 'binary_precision': 0.7090909, 'binary_recall': 0.14942528, 'binary_specificity': 0.997332, 'binary_f1_score': 0.24683544}
confusion matrix:
      0   1
0  5981  16
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_21.png
early stop counter: 1
val acc:0.9863771796226501, best validation acc: 0.9866432547569275, corresponding to test acc:                         0.9613295197486877 / 0.979066789150238
after epoch: 21,now: 2024-05-31 20:51:31.012155,epoch time: 0:20:36.406665,used: 7:16:58.839026,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98636734, 'precision': 0.87811434, 'recall': 0.9286862, 'specificity': 0.9286862, 'f1': 0.9016728, 'auroc': 0.9934984, 'binary_precision': 0.76088256, 'binary_recall': 0.8668478, 'binary_specificity': 0.9905246, 'binary_f1_score': 0.81041604}
confusion matrix:
       0     1
0  41919   401
1    196  1276
---- Validation: 
scalar performance:
{'acc': 0.98286504, 'precision': 0.85764754, 'recall': 0.90037227, 'specificity': 0.90037227, 'f1': 0.87769234, 'auroc': 0.9819791, 'binary_precision': 0.7219917, 'binary_recall': 0.8118196, 'binary_specificity': 0.988925, 'binary_f1_score': 0.76427525}
confusion matrix:
       0    1
0  17948  201
1    121  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.8245563, 'recall': 0.54131186, 'specificity': 0.54131186, 'f1': 0.5648996, 'auroc': 0.9237211, 'binary_precision': 0.6875, 'binary_recall': 0.08429119, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.15017064}
confusion matrix:
      0   1
0  5987  10
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_22.png
early stop counter: 2
val acc:0.982865035533905, best validation acc: 0.9866432547569275, corresponding to test acc:                         0.9613295197486877 / 0.979066789150238
after epoch: 22,now: 2024-05-31 21:11:55.580565,epoch time: 0:20:24.568410,used: 7:37:23.407436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9896785, 'precision': 0.92493224, 'recall': 0.9143343, 'specificity': 0.9143343, 'f1': 0.919561, 'auroc': 0.9953543, 'binary_precision': 0.8556485, 'binary_recall': 0.8335598, 'binary_specificity': 0.9951087, 'binary_f1_score': 0.84445983}
confusion matrix:
       0     1
0  42113   207
1    245  1227
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.9068545, 'recall': 0.87502325, 'specificity': 0.87502325, 'f1': 0.89023733, 'auroc': 0.98205185, 'binary_precision': 0.822335, 'binary_recall': 0.755832, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.7876823}
confusion matrix:
       0    1
0  18044  105
1    157  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8043295, 'recall': 0.5411451, 'specificity': 0.5411451, 'f1': 0.56430703, 'auroc': 0.91202134, 'binary_precision': 0.64705884, 'binary_recall': 0.08429119, 'binary_specificity': 0.997999, 'binary_f1_score': 0.14915255}
confusion matrix:
      0   1
0  5985  12
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_23.png
early stop counter: 3
val acc:0.9860578775405884, best validation acc: 0.9866432547569275, corresponding to test acc:                         0.9613295197486877 / 0.979066789150238
after epoch: 23,now: 2024-05-31 21:32:29.445770,epoch time: 0:20:33.865205,used: 7:57:57.272641,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.989747, 'precision': 0.91448015, 'recall': 0.9310458, 'specificity': 0.9310458, 'f1': 0.92258716, 'auroc': 0.9949173, 'binary_precision': 0.83355093, 'binary_recall': 0.8681169, 'binary_specificity': 0.9939746, 'binary_f1_score': 0.8504829}
confusion matrix:
       0     1
0  42066   255
1    194  1277
---- Validation: 
scalar performance:
{'acc': 0.9852065, 'precision': 0.87923443, 'recall': 0.9053348, 'specificity': 0.9053348, 'f1': 0.8918114, 'auroc': 0.9810336, 'binary_precision': 0.7648766, 'binary_recall': 0.81959563, 'binary_specificity': 0.9910739, 'binary_f1_score': 0.7912913}
confusion matrix:
       0    1
0  17987  162
1    116  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8785794, 'recall': 0.57954264, 'specificity': 0.57954264, 'f1': 0.62433326, 'auroc': 0.9176657, 'binary_precision': 0.7924528, 'binary_recall': 0.16091955, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.26751593}
confusion matrix:
      0   1
0  5986  11
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_24.png
early stop counter: 4
val acc:0.9852064847946167, best validation acc: 0.9866432547569275, corresponding to test acc:                         0.9613295197486877 / 0.979066789150238
after epoch: 24,now: 2024-05-31 21:53:00.453639,epoch time: 0:20:31.007869,used: 8:18:28.280510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9888336, 'precision': 0.89615506, 'recall': 0.94461143, 'specificity': 0.94461143, 'f1': 0.9188651, 'auroc': 0.9960543, 'binary_precision': 0.7958937, 'binary_recall': 0.897209, 'binary_specificity': 0.9920138, 'binary_f1_score': 0.84352005}
confusion matrix:
       0     1
0  41985   338
1    151  1318
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.8648739, 'recall': 0.9122568, 'specificity': 0.9122568, 'f1': 0.8869858, 'auroc': 0.98300767, 'binary_precision': 0.73561645, 'binary_recall': 0.83514774, 'binary_specificity': 0.9893658, 'binary_f1_score': 0.7822287}
confusion matrix:
       0    1
0  17956  193
1    106  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7834339, 'recall': 0.5595518, 'specificity': 0.5595518, 'f1': 0.5916666, 'auroc': 0.9097929, 'binary_precision': 0.6037736, 'binary_recall': 0.12260536, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.20382164}
confusion matrix:
      0   1
0  5976  21
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_25.png
early stop counter: 5
val acc:0.9840889573097229, best validation acc: 0.9866432547569275, corresponding to test acc:                         0.9613295197486877 / 0.979066789150238
after epoch: 25,now: 2024-05-31 22:13:45.046225,epoch time: 0:20:44.592586,used: 8:39:12.873096,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9899297, 'precision': 0.9122398, 'recall': 0.9383979, 'specificity': 0.9383979, 'f1': 0.92488277, 'auroc': 0.9964775, 'binary_precision': 0.8285532, 'binary_recall': 0.8831522, 'binary_specificity': 0.99364364, 'binary_f1_score': 0.8549819}
confusion matrix:
       0     1
0  42051   269
1    172  1300
---- Validation: 
scalar performance:
{'acc': 0.98499364, 'precision': 0.8802539, 'recall': 0.8984741, 'specificity': 0.8984741, 'f1': 0.8891318, 'auroc': 0.9804636, 'binary_precision': 0.7674074, 'binary_recall': 0.80559874, 'binary_specificity': 0.9913494, 'binary_f1_score': 0.7860394}
confusion matrix:
       0    1
0  17992  157
1    125  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8474791, 'recall': 0.5414786, 'specificity': 0.5414786, 'f1': 0.5654991, 'auroc': 0.9387466, 'binary_precision': 0.73333335, 'binary_recall': 0.08429119, 'binary_specificity': 0.998666, 'binary_f1_score': 0.15120275}
confusion matrix:
      0   1
0  5989   8
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_26.png
early stop counter: 6
val acc:0.9849936366081238, best validation acc: 0.9866432547569275, corresponding to test acc:                         0.9613295197486877 / 0.979066789150238
after epoch: 26,now: 2024-05-31 22:34:19.863400,epoch time: 0:20:34.817175,used: 8:59:47.690271,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9866414, 'precision': 0.8690448, 'recall': 0.95800745, 'specificity': 0.95800745, 'f1': 0.90829366, 'auroc': 0.99676335, 'binary_precision': 0.7406403, 'binary_recall': 0.9273098, 'binary_specificity': 0.9887051, 'binary_f1_score': 0.82352936}
confusion matrix:
       0     1
0  41842   478
1    107  1365
---- Validation: 
scalar performance:
{'acc': 0.9812154, 'precision': 0.83503896, 'recall': 0.92802036, 'specificity': 0.92802036, 'f1': 0.8752887, 'auroc': 0.9792773, 'binary_precision': 0.67469877, 'binary_recall': 0.87091756, 'binary_specificity': 0.98512316, 'binary_f1_score': 0.76035297}
confusion matrix:
       0    1
0  17879  270
1     83  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.74022496, 'recall': 0.55330443, 'specificity': 0.55330443, 'f1': 0.58086705, 'auroc': 0.91663074, 'binary_precision': 0.51785713, 'binary_recall': 0.11111111, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.18296531}
confusion matrix:
      0   1
0  5970  27
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_27.png
early stop counter: 7
val acc:0.9812154173851013, best validation acc: 0.9866432547569275, corresponding to test acc:                         0.9613295197486877 / 0.979066789150238
after epoch: 27,now: 2024-05-31 22:54:48.210748,epoch time: 0:20:28.347348,used: 9:20:16.037619,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9898612, 'precision': 0.90336055, 'recall': 0.952401, 'specificity': 0.952401, 'f1': 0.92635417, 'auroc': 0.99686885, 'binary_precision': 0.8097826, 'binary_recall': 0.9122449, 'binary_specificity': 0.99255705, 'binary_f1_score': 0.85796547}
confusion matrix:
       0     1
0  42007   315
1    129  1341
---- Validation: 
scalar performance:
{'acc': 0.98483396, 'precision': 0.8707961, 'recall': 0.9156427, 'specificity': 0.9156427, 'f1': 0.89182246, 'auroc': 0.98186934, 'binary_precision': 0.74723756, 'binary_recall': 0.84136856, 'binary_specificity': 0.9899168, 'binary_f1_score': 0.7915142}
confusion matrix:
       0    1
0  17966  183
1    102  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.82424384, 'recall': 0.6388443, 'specificity': 0.6388443, 'f1': 0.6908612, 'auroc': 0.9390081, 'binary_precision': 0.6788991, 'binary_recall': 0.2835249, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.39999998}
confusion matrix:
      0   1
0  5962  35
1   187  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_28.png
early stop counter: 8
val acc:0.9848339557647705, best validation acc: 0.9866432547569275, corresponding to test acc:                         0.9613295197486877 / 0.979066789150238
after epoch: 28,now: 2024-05-31 23:15:19.064325,epoch time: 0:20:30.853577,used: 9:40:46.891196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9892903, 'precision': 0.89800274, 'recall': 0.9507923, 'specificity': 0.9507923, 'f1': 0.92261267, 'auroc': 0.99657136, 'binary_precision': 0.79916316, 'binary_recall': 0.9095238, 'binary_specificity': 0.99206084, 'binary_f1_score': 0.8507795}
confusion matrix:
       0     1
0  41986   336
1    133  1337
---- Validation: 
scalar performance:
{'acc': 0.9837697, 'precision': 0.86302674, 'recall': 0.90909123, 'specificity': 0.90909123, 'f1': 0.8845562, 'auroc': 0.98037624, 'binary_precision': 0.73214287, 'binary_recall': 0.8289269, 'binary_specificity': 0.9892556, 'binary_f1_score': 0.7775347}
confusion matrix:
       0    1
0  17954  195
1    110  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.83551997, 'recall': 0.682322, 'specificity': 0.682322, 'f1': 0.73399884, 'auroc': 0.94086623, 'binary_precision': 0.6978417, 'binary_recall': 0.3716475, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.48499998}
confusion matrix:
      0   1
0  5955  42
1   164  97
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_29.png
early stop counter: 9
val acc:0.9837697148323059, best validation acc: 0.9866432547569275, corresponding to test acc:                         0.9613295197486877 / 0.979066789150238
after epoch: 29,now: 2024-05-31 23:35:50.585770,epoch time: 0:20:31.521445,used: 10:01:18.412641,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9915053, 'precision': 0.9166659, 'recall': 0.9618354, 'specificity': 0.9618354, 'f1': 0.937991, 'auroc': 0.9976748, 'binary_precision': 0.8357753, 'binary_recall': 0.9300272, 'binary_specificity': 0.99364364, 'binary_f1_score': 0.8803858}
confusion matrix:
       0     1
0  42051   269
1    103  1369
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.87445855, 'recall': 0.9219737, 'specificity': 0.9219737, 'f1': 0.89666826, 'auroc': 0.98162, 'binary_precision': 0.7541209, 'binary_recall': 0.85381025, 'binary_specificity': 0.9901372, 'binary_f1_score': 0.80087525}
confusion matrix:
       0    1
0  17970  179
1     94  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.8279377, 'recall': 0.5920355, 'specificity': 0.5920355, 'f1': 0.6379876, 'auroc': 0.8854555, 'binary_precision': 0.69014084, 'binary_recall': 0.18773946, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.2951807}
confusion matrix:
      0   1
0  5975  22
1   212  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_30.png
early stop counter: 10
val acc:0.985472559928894, best validation acc: 0.9866432547569275, corresponding to test acc:                         0.9613295197486877 / 0.979066789150238
after epoch: 30,now: 2024-05-31 23:56:31.456569,epoch time: 0:20:40.870799,used: 10:21:59.283440,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_13_34_32_seed_0_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:21:59.283440 at 2024-05-31 23:56:31.456569
persisted model performance metric: 

scalar performance:
{'acc': 0.9602109, 'precision': 0.814288, 'recall': 0.54497653, 'specificity': 0.54497653, 'f1': 0.57061905, 'auroc': 0.92359793, 'binary_precision': 0.6666667, 'binary_recall': 0.09195402, 'binary_specificity': 0.997999, 'binary_f1_score': 0.16161616}
confusion matrix:
      0   1
0  5985  12
1   237  24
oracle model performance metric: 

scalar performance:
{'acc': 0.97810805, 'precision': 0.92299026, 'recall': 0.7796916, 'specificity': 0.7796916, 'f1': 0.83539915, 'auroc': 0.94729435, 'binary_precision': 0.86470586, 'binary_recall': 0.5632184, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.68213457}
confusion matrix:
      0    1
0  5974   23
1   114  147
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 488219 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool | 398400 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |  89819 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 488219 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool | 398400 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |  89819 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |   1821 MiB |   1401 TiB |   1401 TiB |
|       from large pool | 387840 KiB |   1750 MiB |   1398 TiB |   1398 TiB |
|       from small pool |  88733 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2108 MiB |   2108 MiB |   2108 MiB |      0 B   |
|       from large pool |   1982 MiB |   1982 MiB |   1982 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    849 MiB |    866 MiB | 687711 GiB | 687711 GiB |
|       from large pool |    842 MiB |    863 MiB | 684083 GiB | 684082 GiB |
|       from small pool |      6 MiB |     18 MiB |   3628 GiB |   3628 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6700    |  129125 K  |  129121 K  |
|       from large pool |      87    |     178    |   55522 K  |   55522 K  |
|       from small pool |    3642    |    6612    |   73602 K  |   73598 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6700    |  129125 K  |  129121 K  |
|       from large pool |      87    |     178    |   55522 K  |   55522 K  |
|       from small pool |    3642    |    6612    |   73602 K  |   73598 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      96    |      96    |      96    |       0    |
|       from large pool |      33    |      33    |      33    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      53    |    2764    |   53434 K  |   53434 K  |
|       from large pool |      18    |      22    |   19254 K  |   19254 K  |
|       from small pool |      35    |    2746    |   34179 K  |   34179 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |      0 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |      0 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   1401 TiB |   1401 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   1398 TiB |   1398 TiB |
|       from small pool |      0 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1326 MiB |   2108 MiB |   2108 MiB |    782 MiB |
|       from large pool |   1232 MiB |   1982 MiB |   1982 MiB |    750 MiB |
|       from small pool |     94 MiB |    126 MiB |    126 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |    954 MiB | 687712 GiB | 687712 GiB |
|       from large pool | 134912 KiB |    938 MiB | 684083 GiB | 684083 GiB |
|       from small pool |      0 KiB |     28 MiB |   3628 GiB |   3628 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6700    |  129125 K  |  129125 K  |
|       from large pool |       2    |     178    |   55522 K  |   55522 K  |
|       from small pool |       0    |    6612    |   73602 K  |   73602 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6700    |  129125 K  |  129125 K  |
|       from large pool |       2    |     178    |   55522 K  |   55522 K  |
|       from small pool |       0    |    6612    |   73602 K  |   73602 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      70    |      96    |      96    |      26    |
|       from large pool |      23    |      33    |      33    |      10    |
|       from small pool |      47    |      63    |      63    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2764    |   53435 K  |   53435 K  |
|       from large pool |       4    |      25    |   19254 K  |   19254 K  |
|       from small pool |       0    |    2746    |   34180 K  |   34180 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |      0 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |      0 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   1401 TiB |   1401 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   1398 TiB |   1398 TiB |
|       from small pool |      0 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1326 MiB |   2108 MiB |   2108 MiB |    782 MiB |
|       from large pool |   1232 MiB |   1982 MiB |   1982 MiB |    750 MiB |
|       from small pool |     94 MiB |    126 MiB |    126 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |    954 MiB | 687712 GiB | 687712 GiB |
|       from large pool | 134912 KiB |    938 MiB | 684083 GiB | 684083 GiB |
|       from small pool |      0 KiB |     28 MiB |   3628 GiB |   3628 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6700    |  129125 K  |  129125 K  |
|       from large pool |       2    |     178    |   55522 K  |   55522 K  |
|       from small pool |       0    |    6612    |   73602 K  |   73602 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6700    |  129125 K  |  129125 K  |
|       from large pool |       2    |     178    |   55522 K  |   55522 K  |
|       from small pool |       0    |    6612    |   73602 K  |   73602 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      70    |      96    |      96    |      26    |
|       from large pool |      23    |      33    |      33    |      10    |
|       from small pool |      47    |      63    |      63    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2764    |   53435 K  |   53435 K  |
|       from large pool |       4    |      25    |   19254 K  |   19254 K  |
|       from small pool |       0    |    2746    |   34180 K  |   34180 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742

 Experiment start at: 2024-06-01 00:05:10.107764
before training, model accuracy: 0.09458588808774948
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96807736, 'precision': 0.7496079, 'recall': 0.6803644, 'specificity': 0.6803644, 'f1': 0.7088451, 'auroc': 0.9418987, 'binary_precision': 0.52034885, 'binary_recall': 0.37239945, 'binary_specificity': 0.98832935, 'binary_f1_score': 0.43411478}
confusion matrix:
       0    1
0  41919  495
1    905  537
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.75282174, 'recall': 0.7891383, 'specificity': 0.7891383, 'f1': 0.7696126, 'auroc': 0.94585484, 'binary_precision': 0.52067184, 'binary_recall': 0.59881127, 'binary_specificity': 0.9794653, 'binary_f1_score': 0.5570145}
confusion matrix:
       0    1
0  17696  371
1    270  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97196263, 'precision': 0.95132494, 'recall': 0.6782575, 'specificity': 0.6782575, 'f1': 0.7511146, 'auroc': 0.9209391, 'binary_precision': 0.93, 'binary_recall': 0.3576923, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.51666665}
confusion matrix:
      0   1
0  5939   7
1   167  93
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-01 00:26:32.860149,epoch time: 0:21:22.752385,used: 0:21:22.752385,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9699015, 'precision': 0.7640718, 'recall': 0.7513125, 'specificity': 0.7513125, 'f1': 0.7575178, 'auroc': 0.95826495, 'binary_precision': 0.54452556, 'binary_recall': 0.517337, 'binary_specificity': 0.9852879, 'binary_f1_score': 0.5305832}
confusion matrix:
       0    1
0  41790  624
1    696  746
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.7594217, 'recall': 0.8032819, 'specificity': 0.8032819, 'f1': 0.77943313, 'auroc': 0.95420027, 'binary_precision': 0.5328283, 'binary_recall': 0.62704307, 'binary_specificity': 0.9795207, 'binary_f1_score': 0.5761092}
confusion matrix:
       0    1
0  17697  370
1    251  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9732517, 'precision': 0.9716525, 'recall': 0.6862862, 'specificity': 0.6862862, 'f1': 0.7625576, 'auroc': 0.93963623, 'binary_precision': 0.97, 'binary_recall': 0.37307692, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.5388889}
confusion matrix:
      0   1
0  5943   3
1   163  97
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-01 00:47:06.016551,epoch time: 0:20:33.156402,used: 0:41:55.908787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.971566, 'precision': 0.7716658, 'recall': 0.8364743, 'specificity': 0.8364743, 'f1': 0.80023986, 'auroc': 0.96517324, 'binary_precision': 0.5538889, 'binary_recall': 0.69188064, 'binary_specificity': 0.981068, 'binary_f1_score': 0.61524224}
confusion matrix:
       0    1
0  41612  803
1    444  997
---- Validation: 
scalar performance:
{'acc': 0.9692636, 'precision': 0.7740799, 'recall': 0.8231242, 'specificity': 0.8231242, 'f1': 0.79634964, 'auroc': 0.95811033, 'binary_precision': 0.5607009, 'binary_recall': 0.66567606, 'binary_specificity': 0.98057234, 'binary_f1_score': 0.6086956}
confusion matrix:
       0    1
0  17716  351
1    225  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97550756, 'precision': 0.9667406, 'recall': 0.71688724, 'specificity': 0.71688724, 'f1': 0.7926264, 'auroc': 0.943069, 'binary_precision': 0.9576271, 'binary_recall': 0.43461537, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.59788364}
confusion matrix:
      0    1
0  5941    5
1   147  113
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-01 01:07:39.152887,epoch time: 0:20:33.136336,used: 1:02:29.045123,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97633165, 'precision': 0.8135432, 'recall': 0.8148042, 'specificity': 0.8148042, 'f1': 0.81417227, 'auroc': 0.9706672, 'binary_precision': 0.6392536, 'binary_recall': 0.6419153, 'binary_specificity': 0.987693, 'binary_f1_score': 0.6405817}
confusion matrix:
       0    1
0  41893  522
1    516  925
---- Validation: 
scalar performance:
{'acc': 0.9734792, 'precision': 0.8055936, 'recall': 0.8217342, 'specificity': 0.8217342, 'f1': 0.81343395, 'auroc': 0.9630194, 'binary_precision': 0.6239437, 'binary_recall': 0.65824664, 'binary_specificity': 0.9852217, 'binary_f1_score': 0.6406363}
confusion matrix:
       0    1
0  17800  267
1    230  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96793425, 'precision': 0.9616484, 'recall': 0.62282467, 'specificity': 0.62282467, 'f1': 0.6874853, 'auroc': 0.9454355, 'binary_precision': 0.95522386, 'binary_recall': 0.24615385, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.3914373}
confusion matrix:
      0   1
0  5943   3
1   196  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_4.png
better model found
persisted
after epoch: 4,now: 2024-06-01 01:28:01.068173,epoch time: 0:20:21.915286,used: 1:22:50.960409,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97665083, 'precision': 0.83832455, 'recall': 0.75647664, 'specificity': 0.75647664, 'f1': 0.7912976, 'auroc': 0.9731123, 'binary_precision': 0.69280446, 'binary_recall': 0.52080446, 'binary_specificity': 0.9921488, 'binary_f1_score': 0.594616}
confusion matrix:
       0    1
0  42081  333
1    691  751
---- Validation: 
scalar performance:
{'acc': 0.9758271, 'precision': 0.8667226, 'recall': 0.74069613, 'specificity': 0.74069613, 'f1': 0.78953445, 'auroc': 0.96661556, 'binary_precision': 0.7522936, 'binary_recall': 0.48736998, 'binary_specificity': 0.99402225, 'binary_f1_score': 0.5915239}
confusion matrix:
       0    1
0  17959  108
1    345  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.9809123, 'recall': 0.54615384, 'specificity': 0.54615384, 'f1': 0.5747775, 'auroc': 0.9566683, 'binary_precision': 1.0, 'binary_recall': 0.092307694, 'binary_specificity': 1.0, 'binary_f1_score': 0.1690141}
confusion matrix:
      0   1
0  5946   0
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_5.png
better model found
persisted
after epoch: 5,now: 2024-06-01 01:48:35.081752,epoch time: 0:20:34.013579,used: 1:43:24.973988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9778138, 'precision': 0.8175545, 'recall': 0.8558887, 'specificity': 0.8558887, 'f1': 0.83552504, 'auroc': 0.9790189, 'binary_precision': 0.64448553, 'binary_recall': 0.72538143, 'binary_specificity': 0.986396, 'binary_f1_score': 0.6825448}
confusion matrix:
       0     1
0  41837   577
1    396  1046
---- Validation: 
scalar performance:
{'acc': 0.97774816, 'precision': 0.84049374, 'recall': 0.8361077, 'specificity': 0.8361077, 'f1': 0.8382851, 'auroc': 0.96993256, 'binary_precision': 0.6927711, 'binary_recall': 0.68350667, 'binary_specificity': 0.9887087, 'binary_f1_score': 0.6881077}
confusion matrix:
       0    1
0  17863  204
1    213  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9695456, 'precision': 0.911492, 'recall': 0.6641233, 'specificity': 0.6641233, 'f1': 0.7303855, 'auroc': 0.95061225, 'binary_precision': 0.85148513, 'binary_recall': 0.33076924, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.47645432}
confusion matrix:
      0   1
0  5931  15
1   174  86
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_6.png
better model found
persisted
after epoch: 6,now: 2024-06-01 02:08:38.256920,epoch time: 0:20:03.175168,used: 2:03:28.149156,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97744894, 'precision': 0.8150697, 'recall': 0.8526856, 'specificity': 0.8526856, 'f1': 0.8327152, 'auroc': 0.9805145, 'binary_precision': 0.63972855, 'binary_recall': 0.7191401, 'binary_specificity': 0.98623097, 'binary_f1_score': 0.67711395}
confusion matrix:
       0     1
0  41830   584
1    405  1037
---- Validation: 
scalar performance:
{'acc': 0.9757204, 'precision': 0.82436574, 'recall': 0.82575756, 'specificity': 0.82575756, 'f1': 0.82506, 'auroc': 0.9711581, 'binary_precision': 0.6612426, 'binary_recall': 0.6641902, 'binary_specificity': 0.98732495, 'binary_f1_score': 0.6627131}
confusion matrix:
       0    1
0  17838  229
1    226  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.83093536, 'recall': 0.56980836, 'specificity': 0.56980836, 'f1': 0.608334, 'auroc': 0.9462515, 'binary_precision': 0.6981132, 'binary_recall': 0.1423077, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.23642173}
confusion matrix:
      0   1
0  5930  16
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_7.png
early stop counter: 1
val acc:0.9757204055786133, best validation acc: 0.9777481555938721, corresponding to test acc:                         0.9695456027984619 / 0.9755075573921204
after epoch: 7,now: 2024-06-01 02:29:11.462857,epoch time: 0:20:33.205937,used: 2:24:01.355093,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98009396, 'precision': 0.84089404, 'recall': 0.8507035, 'specificity': 0.8507035, 'f1': 0.8457228, 'auroc': 0.9846442, 'binary_precision': 0.6915825, 'binary_recall': 0.7122053, 'binary_specificity': 0.98920166, 'binary_f1_score': 0.70174235}
confusion matrix:
       0     1
0  41956   458
1    415  1027
---- Validation: 
scalar performance:
{'acc': 0.9794557, 'precision': 0.8708649, 'recall': 0.81267416, 'specificity': 0.81267416, 'f1': 0.8390702, 'auroc': 0.973353, 'binary_precision': 0.7553192, 'binary_recall': 0.6329866, 'binary_specificity': 0.9923618, 'binary_f1_score': 0.68876314}
confusion matrix:
       0    1
0  17929  138
1    247  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.8662863, 'recall': 0.5815991, 'specificity': 0.5815991, 'f1': 0.6265687, 'auroc': 0.94402945, 'binary_precision': 0.76785713, 'binary_recall': 0.16538462, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.27215192}
confusion matrix:
      0   1
0  5933  13
1   217  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_8.png
better model found
persisted
after epoch: 8,now: 2024-06-01 02:49:43.692453,epoch time: 0:20:32.229596,used: 2:44:33.584689,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9815761, 'precision': 0.855864, 'recall': 0.85347944, 'specificity': 0.85347944, 'f1': 0.85466737, 'auroc': 0.98447096, 'binary_precision': 0.72136873, 'binary_recall': 0.7163662, 'binary_specificity': 0.9905927, 'binary_f1_score': 0.7188588}
confusion matrix:
       0     1
0  42015   399
1    409  1033
---- Validation: 
scalar performance:
{'acc': 0.97993594, 'precision': 0.88631856, 'recall': 0.7993332, 'specificity': 0.7993332, 'f1': 0.83683634, 'auroc': 0.9715854, 'binary_precision': 0.78723407, 'binary_recall': 0.6047548, 'binary_specificity': 0.99391156, 'binary_f1_score': 0.6840336}
confusion matrix:
       0    1
0  17957  110
1    266  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.81935745, 'recall': 0.5395437, 'specificity': 0.5395437, 'f1': 0.56189346, 'auroc': 0.95975876, 'binary_precision': 0.67741936, 'binary_recall': 0.08076923, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.1443299}
confusion matrix:
      0   1
0  5936  10
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_9.png
better model found
persisted
after epoch: 9,now: 2024-06-01 03:10:15.013176,epoch time: 0:20:31.320723,used: 3:05:04.905412,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9800711, 'precision': 0.8276206, 'recall': 0.8955753, 'specificity': 0.8955753, 'f1': 0.85809594, 'auroc': 0.9865855, 'binary_precision': 0.6619156, 'binary_recall': 0.80513173, 'binary_specificity': 0.9860188, 'binary_f1_score': 0.7265331}
confusion matrix:
       0     1
0  41821   593
1    281  1161
---- Validation: 
scalar performance:
{'acc': 0.97828174, 'precision': 0.8340808, 'recall': 0.8707173, 'specificity': 0.8707173, 'f1': 0.8513484, 'auroc': 0.97436076, 'binary_precision': 0.67733335, 'binary_recall': 0.7548291, 'binary_specificity': 0.9866054, 'binary_f1_score': 0.71398455}
confusion matrix:
       0    1
0  17825  242
1    165  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.8633964, 'recall': 0.54932725, 'specificity': 0.54932725, 'f1': 0.5784502, 'auroc': 0.94639623, 'binary_precision': 0.7647059, 'binary_recall': 0.1, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.17687075}
confusion matrix:
      0   1
0  5938   8
1   234  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_10.png
early stop counter: 1
val acc:0.9782817363739014, best validation acc: 0.9799359440803528, corresponding to test acc:                         0.9598775506019592 / 0.9755075573921204
after epoch: 10,now: 2024-06-01 03:30:27.300385,epoch time: 0:20:12.287209,used: 3:25:17.192621,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98086923, 'precision': 0.8319235, 'recall': 0.90536654, 'specificity': 0.90536654, 'f1': 0.8646342, 'auroc': 0.9863721, 'binary_precision': 0.6698592, 'binary_recall': 0.82454926, 'binary_specificity': 0.9861838, 'binary_f1_score': 0.739198}
confusion matrix:
       0     1
0  41828   586
1    253  1189
---- Validation: 
scalar performance:
{'acc': 0.9808965, 'precision': 0.8580603, 'recall': 0.87135804, 'specificity': 0.87135804, 'f1': 0.8645762, 'auroc': 0.97523594, 'binary_precision': 0.7253219, 'binary_recall': 0.7533432, 'binary_specificity': 0.9893729, 'binary_f1_score': 0.7390671}
confusion matrix:
       0    1
0  17875  192
1    166  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.8482443, 'recall': 0.56245244, 'specificity': 0.56245244, 'f1': 0.5983264, 'auroc': 0.9473114, 'binary_precision': 0.73333335, 'binary_recall': 0.12692308, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.21639346}
confusion matrix:
      0   1
0  5934  12
1   227  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_11.png
better model found
persisted
after epoch: 11,now: 2024-06-01 03:50:54.361146,epoch time: 0:20:27.060761,used: 3:45:44.253382,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9840159, 'precision': 0.874002, 'recall': 0.8747541, 'specificity': 0.8747541, 'f1': 0.8743776, 'auroc': 0.98935044, 'binary_precision': 0.7562327, 'binary_recall': 0.7578071, 'binary_specificity': 0.99170107, 'binary_f1_score': 0.75701904}
confusion matrix:
       0     1
0  42063   352
1    349  1092
---- Validation: 
scalar performance:
{'acc': 0.9802028, 'precision': 0.8709047, 'recall': 0.8287975, 'specificity': 0.8287975, 'f1': 0.84846866, 'auroc': 0.9762888, 'binary_precision': 0.75420874, 'binary_recall': 0.66567606, 'binary_specificity': 0.991919, 'binary_f1_score': 0.7071823}
confusion matrix:
       0    1
0  17921  146
1    225  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7834195, 'recall': 0.5429694, 'specificity': 0.5429694, 'f1': 0.56678003, 'auroc': 0.94924206, 'binary_precision': 0.6052632, 'binary_recall': 0.08846154, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.15436243}
confusion matrix:
      0   1
0  5931  15
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_12.png
early stop counter: 1
val acc:0.9802027940750122, best validation acc: 0.9808964729309082, corresponding to test acc:                         0.9614889025688171 / 0.9755075573921204
after epoch: 12,now: 2024-06-01 04:11:19.947164,epoch time: 0:20:25.586018,used: 4:06:09.839400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98360544, 'precision': 0.8560968, 'recall': 0.90711606, 'specificity': 0.90711606, 'f1': 0.8797461, 'auroc': 0.98996425, 'binary_precision': 0.71816534, 'binary_recall': 0.8252427, 'binary_specificity': 0.9889895, 'binary_f1_score': 0.7679897}
confusion matrix:
       0     1
0  41947   467
1    252  1190
---- Validation: 
scalar performance:
{'acc': 0.9801494, 'precision': 0.8461139, 'recall': 0.8845607, 'specificity': 0.8845607, 'f1': 0.86422336, 'auroc': 0.9750614, 'binary_precision': 0.70039946, 'binary_recall': 0.781575, 'binary_specificity': 0.9875464, 'binary_f1_score': 0.73876405}
confusion matrix:
       0    1
0  17842  225
1    147  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8370521, 'recall': 0.5604453, 'specificity': 0.5604453, 'f1': 0.5949651, 'auroc': 0.9447615, 'binary_precision': 0.7111111, 'binary_recall': 0.12307692, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.20983607}
confusion matrix:
      0   1
0  5933  13
1   228  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_13.png
early stop counter: 2
val acc:0.9801493883132935, best validation acc: 0.9808964729309082, corresponding to test acc:                         0.9614889025688171 / 0.9755075573921204
after epoch: 13,now: 2024-06-01 04:31:46.059558,epoch time: 0:20:26.112394,used: 4:26:35.951794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.985612, 'precision': 0.8941635, 'recall': 0.87432337, 'specificity': 0.87432337, 'f1': 0.88396645, 'auroc': 0.991211, 'binary_precision': 0.796635, 'binary_recall': 0.7552011, 'binary_specificity': 0.9934456, 'binary_f1_score': 0.77536494}
confusion matrix:
       0     1
0  42136   278
1    353  1089
---- Validation: 
scalar performance:
{'acc': 0.9816969, 'precision': 0.897326, 'recall': 0.81884336, 'specificity': 0.81884336, 'f1': 0.85341895, 'auroc': 0.9742906, 'binary_precision': 0.8078358, 'binary_recall': 0.6433878, 'binary_specificity': 0.994299, 'binary_f1_score': 0.71629447}
confusion matrix:
       0    1
0  17964  103
1    240  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.8002386, 'recall': 0.5431376, 'specificity': 0.5431376, 'f1': 0.5673858, 'auroc': 0.9409238, 'binary_precision': 0.6388889, 'binary_recall': 0.08846154, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.1554054}
confusion matrix:
      0   1
0  5933  13
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_14.png
better model found
persisted
after epoch: 14,now: 2024-06-01 04:52:15.391219,epoch time: 0:20:29.331661,used: 4:47:05.283455,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98467714, 'precision': 0.86825174, 'recall': 0.90365076, 'specificity': 0.90365076, 'f1': 0.885068, 'auroc': 0.991925, 'binary_precision': 0.74274904, 'binary_recall': 0.81692094, 'binary_specificity': 0.9903805, 'binary_f1_score': 0.77807134}
confusion matrix:
       0     1
0  42006   408
1    264  1178
---- Validation: 
scalar performance:
{'acc': 0.9809498, 'precision': 0.8565452, 'recall': 0.8763926, 'specificity': 0.8763926, 'f1': 0.86617386, 'auroc': 0.9748481, 'binary_precision': 0.7219101, 'binary_recall': 0.7637444, 'binary_specificity': 0.9890408, 'binary_f1_score': 0.7422382}
confusion matrix:
       0    1
0  17869  198
1    159  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.8338226, 'recall': 0.54531294, 'specificity': 0.54531294, 'f1': 0.5714825, 'auroc': 0.9483198, 'binary_precision': 0.7058824, 'binary_recall': 0.092307694, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.16326532}
confusion matrix:
      0   1
0  5936  10
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_15.png
early stop counter: 1
val acc:0.9809498190879822, best validation acc: 0.9816969037055969, corresponding to test acc:                         0.9597163796424866 / 0.9755075573921204
after epoch: 15,now: 2024-06-01 05:12:38.067433,epoch time: 0:20:22.676214,used: 5:07:27.959669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9865013, 'precision': 0.91134083, 'recall': 0.86707914, 'specificity': 0.86707914, 'f1': 0.8878534, 'auroc': 0.9925909, 'binary_precision': 0.8315133, 'binary_recall': 0.739251, 'binary_specificity': 0.9949073, 'binary_f1_score': 0.7826725}
confusion matrix:
       0     1
0  42198   216
1    376  1066
---- Validation: 
scalar performance:
{'acc': 0.98180366, 'precision': 0.8919712, 'recall': 0.82819724, 'specificity': 0.82819724, 'f1': 0.85701555, 'auroc': 0.97176754, 'binary_precision': 0.79642856, 'binary_recall': 0.6627043, 'binary_specificity': 0.99369013, 'binary_f1_score': 0.72343874}
confusion matrix:
       0    1
0  17953  114
1    227  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.8265003, 'recall': 0.55467606, 'specificity': 0.55467606, 'f1': 0.58595216, 'auroc': 0.94776475, 'binary_precision': 0.6904762, 'binary_recall': 0.11153846, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.19205299}
confusion matrix:
      0   1
0  5933  13
1   231  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_16.png
better model found
persisted
after epoch: 16,now: 2024-06-01 05:33:14.038473,epoch time: 0:20:35.971040,used: 5:28:03.930709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9865241, 'precision': 0.8870241, 'recall': 0.90695024, 'specificity': 0.90695024, 'f1': 0.89671594, 'auroc': 0.9924277, 'binary_precision': 0.7801185, 'binary_recall': 0.8217753, 'binary_specificity': 0.9921252, 'binary_f1_score': 0.80040526}
confusion matrix:
       0     1
0  42080   334
1    257  1185
---- Validation: 
scalar performance:
{'acc': 0.9830843, 'precision': 0.89249265, 'recall': 0.8524653, 'specificity': 0.8524653, 'f1': 0.87130845, 'auroc': 0.97805, 'binary_precision': 0.79568106, 'binary_recall': 0.71173847, 'binary_specificity': 0.993192, 'binary_f1_score': 0.7513725}
confusion matrix:
       0    1
0  17944  123
1    194  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.84452087, 'recall': 0.54539704, 'specificity': 0.54539704, 'f1': 0.57180315, 'auroc': 0.92597497, 'binary_precision': 0.72727275, 'binary_recall': 0.092307694, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.16382252}
confusion matrix:
      0   1
0  5937   9
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_17.png
better model found
persisted
after epoch: 17,now: 2024-06-01 05:53:23.691035,epoch time: 0:20:09.652562,used: 5:48:13.583271,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9872993, 'precision': 0.89710104, 'recall': 0.9053414, 'specificity': 0.9053414, 'f1': 0.9011754, 'auroc': 0.99279857, 'binary_precision': 0.80040735, 'binary_recall': 0.81761444, 'binary_specificity': 0.99306834, 'binary_f1_score': 0.8089194}
confusion matrix:
       0     1
0  42120   294
1    263  1179
---- Validation: 
scalar performance:
{'acc': 0.97950906, 'precision': 0.85632336, 'recall': 0.8420278, 'specificity': 0.8420278, 'f1': 0.8490153, 'auroc': 0.9775132, 'binary_precision': 0.72403103, 'binary_recall': 0.69390786, 'binary_specificity': 0.99014777, 'binary_f1_score': 0.70864946}
confusion matrix:
       0    1
0  17889  178
1    206  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.7662685, 'recall': 0.5372002, 'specificity': 0.5372002, 'f1': 0.5572742, 'auroc': 0.92482764, 'binary_precision': 0.5714286, 'binary_recall': 0.07692308, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.13559324}
confusion matrix:
      0   1
0  5931  15
1   240  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_18.png
early stop counter: 1
val acc:0.9795090556144714, best validation acc: 0.9830843210220337, corresponding to test acc:                         0.9605220556259155 / 0.9755075573921204
after epoch: 18,now: 2024-06-01 06:14:00.535611,epoch time: 0:20:36.844576,used: 6:08:50.427847,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98565763, 'precision': 0.8679421, 'recall': 0.9289441, 'specificity': 0.9289441, 'f1': 0.8958986, 'auroc': 0.9931201, 'binary_precision': 0.7403903, 'binary_recall': 0.86823857, 'binary_specificity': 0.98964965, 'binary_f1_score': 0.799234}
confusion matrix:
       0     1
0  41975   439
1    190  1252
---- Validation: 
scalar performance:
{'acc': 0.9806297, 'precision': 0.85576975, 'recall': 0.8705044, 'specificity': 0.8705044, 'f1': 0.862973, 'auroc': 0.9764536, 'binary_precision': 0.7207977, 'binary_recall': 0.75185734, 'binary_specificity': 0.9891515, 'binary_f1_score': 0.736}
confusion matrix:
       0    1
0  17871  196
1    167  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.7139371, 'recall': 0.53836644, 'specificity': 0.53836644, 'f1': 0.557991, 'auroc': 0.90719473, 'binary_precision': 0.46666667, 'binary_recall': 0.08076923, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.13770492}
confusion matrix:
      0   1
0  5922  24
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_19.png
early stop counter: 2
val acc:0.9806296825408936, best validation acc: 0.9830843210220337, corresponding to test acc:                         0.9605220556259155 / 0.9755075573921204
after epoch: 19,now: 2024-06-01 06:34:03.840052,epoch time: 0:20:03.304441,used: 6:28:53.732288,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98741335, 'precision': 0.88357437, 'recall': 0.93420625, 'specificity': 0.93420625, 'f1': 0.9071865, 'auroc': 0.9949597, 'binary_precision': 0.77134144, 'binary_recall': 0.87725383, 'binary_specificity': 0.9911586, 'binary_f1_score': 0.82089543}
confusion matrix:
       0     1
0  42039   375
1    177  1265
---- Validation: 
scalar performance:
{'acc': 0.97908217, 'precision': 0.83830154, 'recall': 0.87971556, 'specificity': 0.87971556, 'f1': 0.8576913, 'auroc': 0.9767651, 'binary_precision': 0.685112, 'binary_recall': 0.7726597, 'binary_specificity': 0.98677146, 'binary_f1_score': 0.72625697}
confusion matrix:
       0    1
0  17828  239
1    153  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.7557006, 'recall': 0.5407941, 'specificity': 0.5407941, 'f1': 0.5627653, 'auroc': 0.9092785, 'binary_precision': 0.55, 'binary_recall': 0.08461539, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.14666666}
confusion matrix:
      0   1
0  5928  18
1   238  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_20.png
early stop counter: 3
val acc:0.9790821671485901, best validation acc: 0.9830843210220337, corresponding to test acc:                         0.9605220556259155 / 0.9755075573921204
after epoch: 20,now: 2024-06-01 06:55:05.393448,epoch time: 0:21:01.553396,used: 6:49:55.285684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9872993, 'precision': 0.89483285, 'recall': 0.90936077, 'specificity': 0.90936077, 'f1': 0.90195465, 'auroc': 0.99420464, 'binary_precision': 0.7955912, 'binary_recall': 0.8259362, 'binary_specificity': 0.9927854, 'binary_f1_score': 0.8104797}
confusion matrix:
       0     1
0  42108   306
1    251  1191
---- Validation: 
scalar performance:
{'acc': 0.98052293, 'precision': 0.8617674, 'recall': 0.85399795, 'specificity': 0.85399795, 'f1': 0.8578365, 'auroc': 0.97672, 'binary_precision': 0.7340425, 'binary_recall': 0.717682, 'binary_specificity': 0.9903138, 'binary_f1_score': 0.72577006}
confusion matrix:
       0    1
0  17892  175
1    190  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.710631, 'recall': 0.55107117, 'specificity': 0.55107117, 'f1': 0.5762688, 'auroc': 0.93026614, 'binary_precision': 0.45901638, 'binary_recall': 0.10769231, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.17445484}
confusion matrix:
      0   1
0  5913  33
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_21.png
early stop counter: 4
val acc:0.9805229306221008, best validation acc: 0.9830843210220337, corresponding to test acc:                         0.9605220556259155 / 0.9755075573921204
after epoch: 21,now: 2024-06-01 07:15:29.901452,epoch time: 0:20:24.508004,used: 7:10:19.793688,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.988371, 'precision': 0.9240902, 'recall': 0.8864682, 'specificity': 0.8864682, 'f1': 0.9043387, 'auroc': 0.99415886, 'binary_precision': 0.85572517, 'binary_recall': 0.7773925, 'binary_specificity': 0.9955439, 'binary_f1_score': 0.8146802}
confusion matrix:
       0     1
0  42225   189
1    321  1121
---- Validation: 
scalar performance:
{'acc': 0.98159015, 'precision': 0.8835336, 'recall': 0.83666974, 'specificity': 0.83666974, 'f1': 0.8584412, 'auroc': 0.9747658, 'binary_precision': 0.7789116, 'binary_recall': 0.6805349, 'binary_specificity': 0.9928046, 'binary_f1_score': 0.72640765}
confusion matrix:
       0    1
0  17937  130
1    215  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.7869375, 'recall': 0.5355294, 'specificity': 0.5355294, 'f1': 0.55485564, 'auroc': 0.901926, 'binary_precision': 0.61290324, 'binary_recall': 0.073076926, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.1305842}
confusion matrix:
      0   1
0  5934  12
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_22.png
early stop counter: 5
val acc:0.9815901517868042, best validation acc: 0.9830843210220337, corresponding to test acc:                         0.9605220556259155 / 0.9755075573921204
after epoch: 22,now: 2024-06-01 07:36:33.679678,epoch time: 0:21:03.778226,used: 7:31:23.571914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9879378, 'precision': 0.8855127, 'recall': 0.94180906, 'specificity': 0.94180906, 'f1': 0.9115789, 'auroc': 0.9957249, 'binary_precision': 0.7746988, 'binary_recall': 0.8924358, 'binary_specificity': 0.9911824, 'binary_f1_score': 0.8294099}
confusion matrix:
       0     1
0  42041   374
1    155  1286
---- Validation: 
scalar performance:
{'acc': 0.98313767, 'precision': 0.8743441, 'recall': 0.8861105, 'specificity': 0.8861105, 'f1': 0.88012767, 'auroc': 0.9761152, 'binary_precision': 0.7568345, 'binary_recall': 0.781575, 'binary_specificity': 0.99064595, 'binary_f1_score': 0.76900584}
confusion matrix:
       0    1
0  17898  169
1    147  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.8135896, 'recall': 0.6165399, 'specificity': 0.6165399, 'f1': 0.665604, 'auroc': 0.9174341, 'binary_precision': 0.65957445, 'binary_recall': 0.23846154, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.3502825}
confusion matrix:
      0   1
0  5914  32
1   198  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_23.png
better model found
persisted
after epoch: 23,now: 2024-06-01 07:57:19.594718,epoch time: 0:20:45.915040,used: 7:52:09.486954,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99001276, 'precision': 0.91680104, 'recall': 0.9285161, 'specificity': 0.9285161, 'f1': 0.9225708, 'auroc': 0.99584794, 'binary_precision': 0.83827496, 'binary_recall': 0.8626907, 'binary_specificity': 0.9943415, 'binary_f1_score': 0.8503076}
confusion matrix:
       0     1
0  42174   240
1    198  1244
---- Validation: 
scalar performance:
{'acc': 0.9835112, 'precision': 0.876092, 'recall': 0.8905958, 'specificity': 0.8905958, 'f1': 0.8831937, 'auroc': 0.97553355, 'binary_precision': 0.76, 'binary_recall': 0.7904903, 'binary_specificity': 0.99070126, 'binary_f1_score': 0.7749453}
confusion matrix:
       0    1
0  17899  168
1    141  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.79318136, 'recall': 0.6066722, 'specificity': 0.6066722, 'f1': 0.65206444, 'auroc': 0.9297277, 'binary_precision': 0.6195652, 'binary_recall': 0.21923077, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.32386363}
confusion matrix:
      0   1
0  5911  35
1   203  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_24.png
better model found
persisted
after epoch: 24,now: 2024-06-01 08:18:08.517831,epoch time: 0:20:48.923113,used: 8:12:58.410067,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9889411, 'precision': 0.89295065, 'recall': 0.94872904, 'specificity': 0.94872904, 'f1': 0.91883254, 'auroc': 0.9965433, 'binary_precision': 0.7891239, 'binary_recall': 0.90568656, 'binary_specificity': 0.9917716, 'binary_f1_score': 0.8433969}
confusion matrix:
       0     1
0  42065   349
1    136  1306
---- Validation: 
scalar performance:
{'acc': 0.9807898, 'precision': 0.8507786, 'recall': 0.88775384, 'specificity': 0.88775384, 'f1': 0.86824775, 'auroc': 0.9734289, 'binary_precision': 0.70950466, 'binary_recall': 0.78751856, 'binary_specificity': 0.9879891, 'binary_f1_score': 0.7464788}
confusion matrix:
       0    1
0  17850  217
1    143  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7710154, 'recall': 0.5614434, 'specificity': 0.5614434, 'f1': 0.5937248, 'auroc': 0.9295991, 'binary_precision': 0.57894737, 'binary_recall': 0.12692308, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.2082019}
confusion matrix:
      0   1
0  5922  24
1   227  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_25.png
early stop counter: 1
val acc:0.9807897806167603, best validation acc: 0.983511209487915, corresponding to test acc:                         0.961650013923645 / 0.9755075573921204
after epoch: 25,now: 2024-06-01 08:38:35.542817,epoch time: 0:20:27.024986,used: 8:33:25.435053,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98716253, 'precision': 0.8749205, 'recall': 0.9484794, 'specificity': 0.9484794, 'f1': 0.9081201, 'auroc': 0.9961554, 'binary_precision': 0.75302243, 'binary_recall': 0.9070735, 'binary_specificity': 0.9898854, 'binary_f1_score': 0.8229003}
confusion matrix:
       0     1
0  41985   429
1    134  1308
---- Validation: 
scalar performance:
{'acc': 0.98121667, 'precision': 0.8554276, 'recall': 0.88582945, 'specificity': 0.88582945, 'f1': 0.8699433, 'auroc': 0.97488075, 'binary_precision': 0.71896315, 'binary_recall': 0.7830609, 'binary_specificity': 0.988598, 'binary_f1_score': 0.74964434}
confusion matrix:
       0    1
0  17861  206
1    146  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7637602, 'recall': 0.57431626, 'specificity': 0.57431626, 'f1': 0.6104577, 'auroc': 0.8993572, 'binary_precision': 0.5633803, 'binary_recall': 0.15384616, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.24169184}
confusion matrix:
      0   1
0  5915  31
1   220  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_26.png
early stop counter: 2
val acc:0.9812166690826416, best validation acc: 0.983511209487915, corresponding to test acc:                         0.961650013923645 / 0.9755075573921204
after epoch: 26,now: 2024-06-01 08:59:14.008098,epoch time: 0:20:38.465281,used: 8:54:03.900334,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99117565, 'precision': 0.93094206, 'recall': 0.9300753, 'specificity': 0.9300753, 'f1': 0.93050826, 'auroc': 0.9974973, 'binary_precision': 0.86648124, 'binary_recall': 0.8646773, 'binary_specificity': 0.9954733, 'binary_f1_score': 0.8655784}
confusion matrix:
       0     1
0  42223   192
1    195  1246
---- Validation: 
scalar performance:
{'acc': 0.9838314, 'precision': 0.89428186, 'recall': 0.864297, 'specificity': 0.864297, 'f1': 0.878644, 'auroc': 0.97440016, 'binary_precision': 0.7983871, 'binary_recall': 0.7355126, 'binary_specificity': 0.99308133, 'binary_f1_score': 0.7656612}
confusion matrix:
       0    1
0  17942  125
1    178  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.8594415, 'recall': 0.5701448, 'specificity': 0.5701448, 'f1': 0.61003274, 'auroc': 0.9023975, 'binary_precision': 0.75510204, 'binary_recall': 0.1423077, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.23948221}
confusion matrix:
      0   1
0  5934  12
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_27.png
better model found
persisted
after epoch: 27,now: 2024-06-01 09:19:43.654634,epoch time: 0:20:29.646536,used: 9:14:33.546870,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9911073, 'precision': 0.91015375, 'recall': 0.9615723, 'specificity': 0.9615723, 'f1': 0.93421954, 'auroc': 0.99769986, 'binary_precision': 0.82269937, 'binary_recall': 0.9299584, 'binary_specificity': 0.99318624, 'binary_f1_score': 0.8730469}
confusion matrix:
       0     1
0  42125   289
1    101  1341
---- Validation: 
scalar performance:
{'acc': 0.98265743, 'precision': 0.86283636, 'recall': 0.90159726, 'specificity': 0.90159726, 'f1': 0.88113743, 'auroc': 0.975826, 'binary_precision': 0.7326203, 'binary_recall': 0.8142645, 'binary_specificity': 0.9889301, 'binary_f1_score': 0.77128786}
confusion matrix:
       0    1
0  17867  200
1    125  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.79860616, 'recall': 0.57122695, 'specificity': 0.57122695, 'f1': 0.6086607, 'auroc': 0.9291597, 'binary_precision': 0.6333333, 'binary_recall': 0.14615385, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.23750001}
confusion matrix:
      0   1
0  5924  22
1   222  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_28.png
early stop counter: 1
val acc:0.9826574325561523, best validation acc: 0.9838314056396484, corresponding to test acc:                         0.9621334075927734 / 0.9755075573921204
after epoch: 28,now: 2024-06-01 09:40:11.218475,epoch time: 0:20:27.563841,used: 9:35:01.110711,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.992179, 'precision': 0.9376327, 'recall': 0.93968457, 'specificity': 0.93968457, 'f1': 0.93865603, 'auroc': 0.99760604, 'binary_precision': 0.87922704, 'binary_recall': 0.88349515, 'binary_specificity': 0.995874, 'binary_f1_score': 0.8813559}
confusion matrix:
       0     1
0  42239   175
1    168  1274
---- Validation: 
scalar performance:
{'acc': 0.9842583, 'precision': 0.9014393, 'recall': 0.86165726, 'specificity': 0.86165726, 'f1': 0.8804207, 'auroc': 0.9733933, 'binary_precision': 0.8129139, 'binary_recall': 0.7295691, 'binary_specificity': 0.9937455, 'binary_f1_score': 0.7689898}
confusion matrix:
       0    1
0  17954  113
1    182  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.7761965, 'recall': 0.57456857, 'specificity': 0.57456857, 'f1': 0.61168975, 'auroc': 0.92214805, 'binary_precision': 0.5882353, 'binary_recall': 0.15384616, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.24390246}
confusion matrix:
      0   1
0  5918  28
1   220  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_29.png
better model found
persisted
after epoch: 29,now: 2024-06-01 10:00:42.168413,epoch time: 0:20:30.949938,used: 9:55:32.060649,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9916773, 'precision': 0.91815674, 'recall': 0.9591874, 'specificity': 0.9591874, 'f1': 0.9376337, 'auroc': 0.9977642, 'binary_precision': 0.8388924, 'binary_recall': 0.9244105, 'binary_specificity': 0.99396425, 'binary_f1_score': 0.8795777}
confusion matrix:
       0     1
0  42158   256
1    109  1333
---- Validation: 
scalar performance:
{'acc': 0.9845251, 'precision': 0.8870851, 'recall': 0.89040637, 'specificity': 0.89040637, 'f1': 0.888738, 'auroc': 0.9784656, 'binary_precision': 0.78203243, 'binary_recall': 0.78900445, 'binary_specificity': 0.9918083, 'binary_f1_score': 0.785503}
confusion matrix:
       0    1
0  17919  148
1    142  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.7643288, 'recall': 0.55575824, 'specificity': 0.55575824, 'f1': 0.5853912, 'auroc': 0.92752904, 'binary_precision': 0.5660377, 'binary_recall': 0.115384616, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.19169328}
confusion matrix:
      0   1
0  5923  23
1   230  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_30.png
better model found
persisted
after epoch: 30,now: 2024-06-01 10:21:39.894767,epoch time: 0:20:57.726354,used: 10:16:29.787003,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_00_05_10_seed_1_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:16:29.787003 at 2024-06-01 10:21:39.894767
persisted model performance metric: 

scalar performance:
{'acc': 0.95987755, 'precision': 0.7833593, 'recall': 0.55977255, 'specificity': 0.55977255, 'f1': 0.59194636, 'auroc': 0.9257214, 'binary_precision': 0.6037736, 'binary_recall': 0.12307692, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.20447284}
confusion matrix:
      0   1
0  5925  21
1   228  32
oracle model performance metric: 

scalar performance:
{'acc': 0.9751853, 'precision': 0.9701449, 'recall': 0.71120214, 'specificity': 0.71120214, 'f1': 0.7877212, 'auroc': 0.9437849, 'binary_precision': 0.9649123, 'binary_recall': 0.42307693, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.58823526}
confusion matrix:
      0    1
0  5942    4
1   150  110
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 486863 KiB |   1837 MiB |   2814 TiB |   2814 TiB |
|       from large pool | 397056 KiB |   1766 MiB |   2807 TiB |   2807 TiB |
|       from small pool |  89807 KiB |    124 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 486863 KiB |   1837 MiB |   2814 TiB |   2814 TiB |
|       from large pool | 397056 KiB |   1766 MiB |   2807 TiB |   2807 TiB |
|       from small pool |  89807 KiB |    124 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476570 KiB |   1821 MiB |   2803 TiB |   2803 TiB |
|       from large pool | 387840 KiB |   1750 MiB |   2796 TiB |   2796 TiB |
|       from small pool |  88730 KiB |    123 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2028 MiB |   2108 MiB |   2810 MiB |    782 MiB |
|       from large pool |   1904 MiB |   1982 MiB |   2654 MiB |    750 MiB |
|       from small pool |    124 MiB |    126 MiB |    156 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1122 MiB |   1127 MiB |   1457 TiB |   1457 TiB |
|       from large pool |   1116 MiB |   1118 MiB |   1450 TiB |   1450 TiB |
|       from small pool |      6 MiB |     28 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3705    |    6708    |  258291 K  |  258288 K  |
|       from large pool |      87    |     178    |  111064 K  |  111064 K  |
|       from small pool |    3618    |    6620    |  147226 K  |  147223 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3705    |    6708    |  258291 K  |  258288 K  |
|       from large pool |      87    |     178    |  111064 K  |  111064 K  |
|       from small pool |    3618    |    6620    |  147226 K  |  147223 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      90    |      96    |     116    |      26    |
|       from large pool |      28    |      33    |      38    |      10    |
|       from small pool |      62    |      63    |      78    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      54    |    2771    |  108356 K  |  108356 K  |
|       from large pool |      21    |      25    |   40086 K  |   40086 K  |
|       from small pool |      33    |    2750    |   68269 K  |   68269 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   2814 TiB |   2814 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   2807 TiB |   2807 TiB |
|       from small pool |      0 KiB |    124 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   2814 TiB |   2814 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   2807 TiB |   2807 TiB |
|       from small pool |      0 KiB |    124 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   2803 TiB |   2803 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   2796 TiB |   2796 TiB |
|       from small pool |      0 KiB |    123 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1598 MiB |   2108 MiB |   2810 MiB |   1212 MiB |
|       from large pool |   1504 MiB |   1982 MiB |   2654 MiB |   1150 MiB |
|       from small pool |     94 MiB |    126 MiB |    156 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1198 MiB |   1457 TiB |   1457 TiB |
|       from large pool | 134912 KiB |   1178 MiB |   1450 TiB |   1450 TiB |
|       from small pool |      0 KiB |     28 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6708    |  258291 K  |  258291 K  |
|       from large pool |       2    |     178    |  111064 K  |  111064 K  |
|       from small pool |       0    |    6620    |  147226 K  |  147226 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6708    |  258291 K  |  258291 K  |
|       from large pool |       2    |     178    |  111064 K  |  111064 K  |
|       from small pool |       0    |    6620    |  147226 K  |  147226 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      72    |      96    |     116    |      44    |
|       from large pool |      25    |      33    |      38    |      13    |
|       from small pool |      47    |      63    |      78    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2771    |  108357 K  |  108357 K  |
|       from large pool |       4    |      27    |   40086 K  |   40086 K  |
|       from small pool |       0    |    2750    |   68271 K  |   68271 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   2814 TiB |   2814 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   2807 TiB |   2807 TiB |
|       from small pool |      0 KiB |    124 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   2814 TiB |   2814 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   2807 TiB |   2807 TiB |
|       from small pool |      0 KiB |    124 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   2803 TiB |   2803 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   2796 TiB |   2796 TiB |
|       from small pool |      0 KiB |    123 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1598 MiB |   2108 MiB |   2810 MiB |   1212 MiB |
|       from large pool |   1504 MiB |   1982 MiB |   2654 MiB |   1150 MiB |
|       from small pool |     94 MiB |    126 MiB |    156 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1198 MiB |   1457 TiB |   1457 TiB |
|       from large pool | 134912 KiB |   1178 MiB |   1450 TiB |   1450 TiB |
|       from small pool |      0 KiB |     28 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6708    |  258291 K  |  258291 K  |
|       from large pool |       2    |     178    |  111064 K  |  111064 K  |
|       from small pool |       0    |    6620    |  147226 K  |  147226 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6708    |  258291 K  |  258291 K  |
|       from large pool |       2    |     178    |  111064 K  |  111064 K  |
|       from small pool |       0    |    6620    |  147226 K  |  147226 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      72    |      96    |     116    |      44    |
|       from large pool |      25    |      33    |      38    |      13    |
|       from small pool |      47    |      63    |      78    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2771    |  108357 K  |  108357 K  |
|       from large pool |       4    |      27    |   40086 K  |   40086 K  |
|       from small pool |       0    |    2750    |   68271 K  |   68271 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742

 Experiment start at: 2024-06-01 10:31:02.247652
before training, model accuracy: 0.04888604208827019
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96513325, 'precision': 0.7405963, 'recall': 0.7856536, 'specificity': 0.7856536, 'f1': 0.76095796, 'auroc': 0.9474175, 'binary_precision': 0.49585405, 'binary_recall': 0.5928619, 'binary_specificity': 0.97844535, 'binary_f1_score': 0.54003614}
confusion matrix:
       0    1
0  41399  912
1    616  897
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.96601504, 'precision': 0.7330133, 'recall': 0.8113952, 'specificity': 0.8113952, 'f1': 0.7658883, 'auroc': 0.93822956, 'binary_precision': 0.47788697, 'binary_recall': 0.6461794, 'binary_specificity': 0.9766111, 'binary_f1_score': 0.549435}
confusion matrix:
       0    1
0  17746  425
1    213  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9770797, 'precision': 0.9405099, 'recall': 0.72833836, 'specificity': 0.72833836, 'f1': 0.79820687, 'auroc': 0.9209205, 'binary_precision': 0.902439, 'binary_recall': 0.45867768, 'binary_specificity': 0.997999, 'binary_f1_score': 0.6082192}
confusion matrix:
      0    1
0  5985   12
1   131  111
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-01 10:53:52.510086,epoch time: 0:22:50.262434,used: 0:22:50.262434,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9685789, 'precision': 0.7630856, 'recall': 0.79030585, 'specificity': 0.79030585, 'f1': 0.7759497, 'auroc': 0.9596398, 'binary_precision': 0.5405728, 'binary_recall': 0.5988103, 'binary_specificity': 0.98180145, 'binary_f1_score': 0.5682032}
confusion matrix:
       0    1
0  41541  770
1    607  906
---- Validation: 
scalar performance:
{'acc': 0.9698503, 'precision': 0.75651693, 'recall': 0.78687584, 'specificity': 0.78687584, 'f1': 0.77075726, 'auroc': 0.9543246, 'binary_precision': 0.52662724, 'binary_recall': 0.5913621, 'binary_specificity': 0.9823895, 'binary_f1_score': 0.55712056}
confusion matrix:
       0    1
0  17851  320
1    246  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9775605, 'precision': 0.9749384, 'recall': 0.71669203, 'specificity': 0.71669203, 'f1': 0.7942282, 'auroc': 0.9237504, 'binary_precision': 0.9722222, 'binary_recall': 0.4338843, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.59999996}
confusion matrix:
      0    1
0  5994    3
1   137  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-01 11:15:38.886831,epoch time: 0:21:46.376745,used: 0:44:36.639179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9738956, 'precision': 0.8017336, 'recall': 0.8163209, 'specificity': 0.8163209, 'f1': 0.8088373, 'auroc': 0.9663898, 'binary_precision': 0.61611074, 'binary_recall': 0.64705884, 'binary_specificity': 0.98558295, 'binary_f1_score': 0.63120574}
confusion matrix:
       0    1
0  41701  610
1    534  979
---- Validation: 
scalar performance:
{'acc': 0.9745379, 'precision': 0.79140526, 'recall': 0.8166009, 'specificity': 0.8166009, 'f1': 0.8034297, 'auroc': 0.9593249, 'binary_precision': 0.5945122, 'binary_recall': 0.64784056, 'binary_specificity': 0.9853613, 'binary_f1_score': 0.62003183}
confusion matrix:
       0    1
0  17905  266
1    212  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9765988, 'precision': 0.9493426, 'recall': 0.71619177, 'specificity': 0.71619177, 'f1': 0.7889217, 'auroc': 0.9284396, 'binary_precision': 0.92105263, 'binary_recall': 0.4338843, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.5898876}
confusion matrix:
      0    1
0  5988    9
1   137  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_3.png
better model found
persisted
after epoch: 3,now: 2024-06-01 11:37:18.787833,epoch time: 0:21:39.901002,used: 1:06:16.540181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97063255, 'precision': 0.7732739, 'recall': 0.8611542, 'specificity': 0.8611542, 'f1': 0.8104155, 'auroc': 0.97093815, 'binary_precision': 0.55583006, 'binary_recall': 0.74355584, 'binary_specificity': 0.97875255, 'binary_f1_score': 0.6361323}
confusion matrix:
       0     1
0  41412   899
1    388  1125
---- Validation: 
scalar performance:
{'acc': 0.9696373, 'precision': 0.7549538, 'recall': 0.85984313, 'specificity': 0.85984313, 'f1': 0.7974292, 'auroc': 0.9617288, 'binary_precision': 0.5185615, 'binary_recall': 0.7425249, 'binary_specificity': 0.9771614, 'binary_f1_score': 0.61065567}
confusion matrix:
       0    1
0  17756  415
1    155  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9783619, 'precision': 0.9113391, 'recall': 0.7706429, 'specificity': 0.7706429, 'f1': 0.8252389, 'auroc': 0.9422427, 'binary_precision': 0.84076434, 'binary_recall': 0.54545456, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.6616541}
confusion matrix:
      0    1
0  5972   25
1   110  132
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_4.png
new oracle model saved
early stop counter: 1
val acc:0.9696372747421265, best validation acc: 0.9745379090309143, corresponding to test acc:                         0.9765987992286682 / 0.9783619046211243
after epoch: 4,now: 2024-06-01 11:59:02.286357,epoch time: 0:21:43.498524,used: 1:28:00.038705,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9737587, 'precision': 0.79099894, 'recall': 0.88476014, 'specificity': 0.88476014, 'f1': 0.83064246, 'auroc': 0.9755146, 'binary_precision': 0.58962965, 'binary_recall': 0.7891606, 'binary_specificity': 0.98035973, 'binary_f1_score': 0.6749576}
confusion matrix:
       0     1
0  41480   831
1    319  1194
---- Validation: 
scalar performance:
{'acc': 0.97613597, 'precision': 0.7977294, 'recall': 0.8632002, 'specificity': 0.8632002, 'f1': 0.82689774, 'auroc': 0.96443856, 'binary_precision': 0.60405403, 'binary_recall': 0.7425249, 'binary_specificity': 0.9838754, 'binary_f1_score': 0.6661699}
confusion matrix:
       0    1
0  17878  293
1    155  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97868246, 'precision': 0.89254653, 'recall': 0.79658526, 'specificity': 0.79658526, 'f1': 0.83727324, 'auroc': 0.94642675, 'binary_precision': 0.80110496, 'binary_recall': 0.59917355, 'binary_specificity': 0.993997, 'binary_f1_score': 0.6855792}
confusion matrix:
      0    1
0  5961   36
1    97  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-01 12:20:48.555893,epoch time: 0:21:46.269536,used: 1:49:46.308241,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97841364, 'precision': 0.84615636, 'recall': 0.8173861, 'specificity': 0.8173861, 'f1': 0.8310903, 'auroc': 0.97813237, 'binary_precision': 0.70498914, 'binary_recall': 0.6444151, 'binary_specificity': 0.9903571, 'binary_f1_score': 0.6733425}
confusion matrix:
       0    1
0  41903  408
1    538  975
---- Validation: 
scalar performance:
{'acc': 0.9767219, 'precision': 0.82045686, 'recall': 0.7848041, 'specificity': 0.7848041, 'f1': 0.80148804, 'auroc': 0.9664665, 'binary_precision': 0.65478426, 'binary_recall': 0.5797342, 'binary_specificity': 0.98987395, 'binary_f1_score': 0.61497796}
confusion matrix:
       0    1
0  17987  184
1    253  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705081, 'precision': 0.92177635, 'recall': 0.63966215, 'specificity': 0.63966215, 'f1': 0.7049329, 'auroc': 0.9429803, 'binary_precision': 0.8717949, 'binary_recall': 0.28099173, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.42499998}
confusion matrix:
      0   1
0  5987  10
1   174  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_6.png
better model found
persisted
after epoch: 6,now: 2024-06-01 12:42:51.304645,epoch time: 0:22:02.748752,used: 2:11:49.056993,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97695327, 'precision': 0.81405735, 'recall': 0.88036025, 'specificity': 0.88036025, 'f1': 0.843711, 'auroc': 0.98125696, 'binary_precision': 0.63616675, 'binary_recall': 0.7766028, 'binary_specificity': 0.9841176, 'binary_f1_score': 0.6994048}
confusion matrix:
       0     1
0  41639   672
1    338  1175
---- Validation: 
scalar performance:
{'acc': 0.97847974, 'precision': 0.82145095, 'recall': 0.8451377, 'specificity': 0.8451377, 'f1': 0.8328347, 'auroc': 0.9627867, 'binary_precision': 0.6527778, 'binary_recall': 0.7026578, 'binary_specificity': 0.9876176, 'binary_f1_score': 0.6768}
confusion matrix:
       0    1
0  17946  225
1    179  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.969867, 'precision': 0.9179961, 'recall': 0.63139766, 'specificity': 0.63139766, 'f1': 0.69480264, 'auroc': 0.949723, 'binary_precision': 0.8648649, 'binary_recall': 0.2644628, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.40506327}
confusion matrix:
      0   1
0  5987  10
1   178  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_7.png
better model found
persisted
after epoch: 7,now: 2024-06-01 13:04:29.539249,epoch time: 0:21:38.234604,used: 2:33:27.291597,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98062706, 'precision': 0.8666661, 'recall': 0.82936656, 'specificity': 0.82936656, 'f1': 0.8469288, 'auroc': 0.9837825, 'binary_precision': 0.7451994, 'binary_recall': 0.666887, 'binary_specificity': 0.9918461, 'binary_f1_score': 0.7038716}
confusion matrix:
       0     1
0  41966   345
1    504  1009
---- Validation: 
scalar performance:
{'acc': 0.97949183, 'precision': 0.84663844, 'recall': 0.804705, 'specificity': 0.804705, 'f1': 0.82420915, 'auroc': 0.9670748, 'binary_precision': 0.7058824, 'binary_recall': 0.6179402, 'binary_specificity': 0.9914699, 'binary_f1_score': 0.65899026}
confusion matrix:
       0    1
0  18016  155
1    230  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.8951059, 'recall': 0.5389227, 'specificity': 0.5389227, 'f1': 0.56240475, 'auroc': 0.9411359, 'binary_precision': 0.82608694, 'binary_recall': 0.0785124, 'binary_specificity': 0.999333, 'binary_f1_score': 0.14339624}
confusion matrix:
      0   1
0  5993   4
1   223  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_8.png
better model found
persisted
after epoch: 8,now: 2024-06-01 13:26:29.671191,epoch time: 0:22:00.131942,used: 2:55:27.423539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9813116, 'precision': 0.85678256, 'recall': 0.8670033, 'specificity': 0.8670033, 'f1': 0.8618141, 'auroc': 0.98410225, 'binary_precision': 0.72272146, 'binary_recall': 0.7442168, 'binary_specificity': 0.9897899, 'binary_f1_score': 0.73331165}
confusion matrix:
       0     1
0  41879   432
1    387  1126
---- Validation: 
scalar performance:
{'acc': 0.97981143, 'precision': 0.85728097, 'recall': 0.7920214, 'specificity': 0.7920214, 'f1': 0.8211079, 'auroc': 0.96756804, 'binary_precision': 0.7280164, 'binary_recall': 0.5913621, 'binary_specificity': 0.99268067, 'binary_f1_score': 0.65261227}
confusion matrix:
       0    1
0  18038  133
1    246  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.88606083, 'recall': 0.54297155, 'specificity': 0.54297155, 'f1': 0.56910354, 'auroc': 0.943864, 'binary_precision': 0.8076923, 'binary_recall': 0.08677686, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.1567164}
confusion matrix:
      0   1
0  5992   5
1   221  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_9.png
better model found
persisted
after epoch: 9,now: 2024-06-01 13:48:09.848500,epoch time: 0:21:40.177309,used: 3:17:07.600848,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98222435, 'precision': 0.88656807, 'recall': 0.83083105, 'specificity': 0.83083105, 'f1': 0.85635185, 'auroc': 0.9853643, 'binary_precision': 0.78493786, 'binary_recall': 0.66820884, 'binary_specificity': 0.99345326, 'binary_f1_score': 0.72188497}
confusion matrix:
       0     1
0  42034   277
1    502  1011
---- Validation: 
scalar performance:
{'acc': 0.97826666, 'precision': 0.8590338, 'recall': 0.74946487, 'specificity': 0.74946487, 'f1': 0.79362816, 'auroc': 0.9662097, 'binary_precision': 0.73429954, 'binary_recall': 0.50498337, 'binary_specificity': 0.9939464, 'binary_f1_score': 0.5984252}
confusion matrix:
       0    1
0  18061  110
1    298  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.9045257, 'recall': 0.52256054, 'specificity': 0.52256054, 'f1': 0.5336061, 'auroc': 0.9379029, 'binary_precision': 0.84615386, 'binary_recall': 0.045454547, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.08627451}
confusion matrix:
      0   1
0  5995   2
1   231  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_10.png
early stop counter: 1
val acc:0.9782666563987732, best validation acc: 0.979811429977417, corresponding to test acc:                         0.9637762308120728 / 0.9786824584007263
after epoch: 10,now: 2024-06-01 14:09:42.352341,epoch time: 0:21:32.503841,used: 3:38:40.104689,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9838673, 'precision': 0.87557137, 'recall': 0.8858527, 'specificity': 0.8858527, 'f1': 0.88063645, 'auroc': 0.9887285, 'binary_precision': 0.75899744, 'binary_recall': 0.7805684, 'binary_specificity': 0.991137, 'binary_f1_score': 0.76963186}
confusion matrix:
       0     1
0  41936   375
1    332  1181
---- Validation: 
scalar performance:
{'acc': 0.9803974, 'precision': 0.8509631, 'recall': 0.82043076, 'specificity': 0.82043076, 'f1': 0.8349445, 'auroc': 0.97204983, 'binary_precision': 0.71350366, 'binary_recall': 0.6495017, 'binary_specificity': 0.99135983, 'binary_f1_score': 0.68}
confusion matrix:
       0    1
0  18014  157
1    211  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.78899807, 'recall': 0.56039935, 'specificity': 0.56039935, 'f1': 0.5936155, 'auroc': 0.9517047, 'binary_precision': 0.6122449, 'binary_recall': 0.12396694, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5978  19
1   212  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_11.png
better model found
persisted
after epoch: 11,now: 2024-06-01 14:31:36.511627,epoch time: 0:21:54.159286,used: 4:00:34.263975,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9839357, 'precision': 0.87209857, 'recall': 0.89481044, 'specificity': 0.89481044, 'f1': 0.88308734, 'auroc': 0.98841625, 'binary_precision': 0.7513984, 'binary_recall': 0.7990747, 'binary_specificity': 0.99054617, 'binary_f1_score': 0.7745035}
confusion matrix:
       0     1
0  41911   400
1    304  1209
---- Validation: 
scalar performance:
{'acc': 0.9816225, 'precision': 0.8518175, 'recall': 0.85238254, 'specificity': 0.85238254, 'f1': 0.8520998, 'auroc': 0.97346044, 'binary_precision': 0.71310115, 'binary_recall': 0.71428573, 'binary_specificity': 0.99047935, 'binary_f1_score': 0.71369296}
confusion matrix:
       0    1
0  17998  173
1    172  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.811924, 'recall': 0.5546179, 'specificity': 0.5546179, 'f1': 0.5860173, 'auroc': 0.9448097, 'binary_precision': 0.6585366, 'binary_recall': 0.11157025, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.19081274}
confusion matrix:
      0   1
0  5983  14
1   215  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_12.png
better model found
persisted
after epoch: 12,now: 2024-06-01 14:53:03.636333,epoch time: 0:21:27.124706,used: 4:22:01.388681,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98434645, 'precision': 0.8661576, 'recall': 0.9186034, 'specificity': 0.9186034, 'f1': 0.8904623, 'auroc': 0.9909135, 'binary_precision': 0.73778033, 'binary_recall': 0.84798414, 'binary_specificity': 0.98922265, 'binary_f1_score': 0.7890529}
confusion matrix:
       0     1
0  41855   456
1    230  1283
---- Validation: 
scalar performance:
{'acc': 0.9827412, 'precision': 0.86170906, 'recall': 0.8593848, 'specificity': 0.8593848, 'f1': 0.8605429, 'auroc': 0.97375095, 'binary_precision': 0.7324415, 'binary_recall': 0.72757477, 'binary_specificity': 0.9911948, 'binary_f1_score': 0.73}
confusion matrix:
       0    1
0  18011  160
1    164  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.82058823, 'recall': 0.5466035, 'specificity': 0.5466035, 'f1': 0.5739086, 'auroc': 0.9373977, 'binary_precision': 0.6764706, 'binary_recall': 0.09504132, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.16666666}
confusion matrix:
      0   1
0  5986  11
1   219  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_13.png
better model found
persisted
after epoch: 13,now: 2024-06-01 15:14:47.610946,epoch time: 0:21:43.974613,used: 4:43:45.363294,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9865142, 'precision': 0.91049427, 'recall': 0.8808505, 'specificity': 0.8808505, 'f1': 0.8950708, 'auroc': 0.9918382, 'binary_precision': 0.82928574, 'binary_recall': 0.76734966, 'binary_specificity': 0.9943513, 'binary_f1_score': 0.7971164}
confusion matrix:
       0     1
0  42072   239
1    352  1161
---- Validation: 
scalar performance:
{'acc': 0.98412615, 'precision': 0.9085221, 'recall': 0.8159325, 'specificity': 0.8159325, 'f1': 0.85587823, 'auroc': 0.97368234, 'binary_precision': 0.82900435, 'binary_recall': 0.63621265, 'binary_specificity': 0.99565244, 'binary_f1_score': 0.7199248}
confusion matrix:
       0    1
0  18092   79
1    219  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.7537806, 'recall': 0.5119798, 'specificity': 0.5119798, 'f1': 0.51385856, 'auroc': 0.94486237, 'binary_precision': 0.54545456, 'binary_recall': 0.024793388, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.047430832}
confusion matrix:
      0  1
0  5992  5
1   236  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_14.png
better model found
persisted
after epoch: 14,now: 2024-06-01 15:36:10.271593,epoch time: 0:21:22.660647,used: 5:05:08.023941,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98649144, 'precision': 0.90461826, 'recall': 0.8891236, 'specificity': 0.8891236, 'f1': 0.8967069, 'auroc': 0.9918846, 'binary_precision': 0.8169305, 'binary_recall': 0.78453404, 'binary_specificity': 0.9937132, 'binary_f1_score': 0.8004046}
confusion matrix:
       0     1
0  42045   266
1    326  1187
---- Validation: 
scalar performance:
{'acc': 0.9833271, 'precision': 0.8784206, 'recall': 0.84121734, 'specificity': 0.84121734, 'f1': 0.8587805, 'auroc': 0.97640955, 'binary_precision': 0.76709795, 'binary_recall': 0.6893688, 'binary_specificity': 0.9930659, 'binary_f1_score': 0.7261592}
confusion matrix:
       0    1
0  18045  126
1    187  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7311988, 'recall': 0.5158619, 'specificity': 0.5158619, 'f1': 0.52110595, 'auroc': 0.93705046, 'binary_precision': 0.5, 'binary_recall': 0.03305785, 'binary_specificity': 0.998666, 'binary_f1_score': 0.0620155}
confusion matrix:
      0  1
0  5989  8
1   234  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_15.png
early stop counter: 1
val acc:0.9833270907402039, best validation acc: 0.9841261506080627, corresponding to test acc:                         0.9613720178604126 / 0.9786824584007263
after epoch: 15,now: 2024-06-01 15:58:40.418188,epoch time: 0:22:30.146595,used: 5:27:38.170536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98628604, 'precision': 0.9084289, 'recall': 0.8794577, 'specificity': 0.8794577, 'f1': 0.8933661, 'auroc': 0.9910635, 'binary_precision': 0.8252497, 'binary_recall': 0.7647059, 'binary_specificity': 0.9942095, 'binary_f1_score': 0.7938251}
confusion matrix:
       0     1
0  42066   245
1    356  1157
---- Validation: 
scalar performance:
{'acc': 0.9821552, 'precision': 0.85005295, 'recall': 0.87193084, 'specificity': 0.87193084, 'f1': 0.86063147, 'auroc': 0.9733671, 'binary_precision': 0.70826834, 'binary_recall': 0.75415283, 'binary_specificity': 0.9897089, 'binary_f1_score': 0.73049074}
confusion matrix:
       0    1
0  17984  187
1    148  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.8296472, 'recall': 0.5324742, 'specificity': 0.5324742, 'f1': 0.55083835, 'auroc': 0.9230459, 'binary_precision': 0.6956522, 'binary_recall': 0.0661157, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.12075471}
confusion matrix:
      0   1
0  5990   7
1   226  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_16.png
early stop counter: 2
val acc:0.9821552038192749, best validation acc: 0.9841261506080627, corresponding to test acc:                         0.9613720178604126 / 0.9786824584007263
after epoch: 16,now: 2024-06-01 16:20:18.401956,epoch time: 0:21:37.983768,used: 5:49:16.154304,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9856015, 'precision': 0.88738513, 'recall': 0.90045285, 'specificity': 0.90045285, 'f1': 0.893801, 'auroc': 0.9916988, 'binary_precision': 0.7816092, 'binary_recall': 0.80898875, 'binary_specificity': 0.991917, 'binary_f1_score': 0.7950633}
confusion matrix:
       0     1
0  41969   342
1    289  1224
---- Validation: 
scalar performance:
{'acc': 0.982102, 'precision': 0.85900426, 'recall': 0.84861493, 'specificity': 0.84861493, 'f1': 0.85372686, 'auroc': 0.9777707, 'binary_precision': 0.72773975, 'binary_recall': 0.70598006, 'binary_specificity': 0.9912498, 'binary_f1_score': 0.7166947}
confusion matrix:
       0    1
0  18012  159
1    177  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.7814226, 'recall': 0.5683303, 'specificity': 0.5683303, 'f1': 0.6042288, 'auroc': 0.93425345, 'binary_precision': 0.5964912, 'binary_recall': 0.14049587, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.22742473}
confusion matrix:
      0   1
0  5974  23
1   208  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_17.png
early stop counter: 3
val acc:0.9821019768714905, best validation acc: 0.9841261506080627, corresponding to test acc:                         0.9613720178604126 / 0.9786824584007263
after epoch: 17,now: 2024-06-01 16:42:04.557622,epoch time: 0:21:46.155666,used: 6:11:02.309970,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9865827, 'precision': 0.8831328, 'recall': 0.930277, 'specificity': 0.930277, 'f1': 0.90521336, 'auroc': 0.99325585, 'binary_precision': 0.77094316, 'binary_recall': 0.8697951, 'binary_specificity': 0.9907589, 'binary_f1_score': 0.8173913}
confusion matrix:
       0     1
0  41920   391
1    197  1316
---- Validation: 
scalar performance:
{'acc': 0.9822085, 'precision': 0.84171826, 'recall': 0.89845896, 'specificity': 0.89845896, 'f1': 0.8677157, 'auroc': 0.9777194, 'binary_precision': 0.6898017, 'binary_recall': 0.8089701, 'binary_specificity': 0.9879478, 'binary_f1_score': 0.7446483}
confusion matrix:
       0    1
0  17952  219
1    115  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.81980985, 'recall': 0.5708967, 'specificity': 0.5708967, 'f1': 0.60985523, 'auroc': 0.9247769, 'binary_precision': 0.6730769, 'binary_recall': 0.1446281, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.23809522}
confusion matrix:
      0   1
0  5980  17
1   207  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_18.png
early stop counter: 4
val acc:0.9822084903717041, best validation acc: 0.9841261506080627, corresponding to test acc:                         0.9613720178604126 / 0.9786824584007263
after epoch: 18,now: 2024-06-01 17:03:46.286240,epoch time: 0:21:41.728618,used: 6:32:44.038588,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9871075, 'precision': 0.89274436, 'recall': 0.9219452, 'specificity': 0.9219452, 'f1': 0.9067747, 'auroc': 0.992577, 'binary_precision': 0.79079753, 'binary_recall': 0.85194975, 'binary_specificity': 0.9919406, 'binary_f1_score': 0.82023543}
confusion matrix:
       0     1
0  41970   341
1    224  1289
---- Validation: 
scalar performance:
{'acc': 0.9833271, 'precision': 0.86229545, 'recall': 0.8733393, 'specificity': 0.8733393, 'f1': 0.8677274, 'auroc': 0.9730849, 'binary_precision': 0.7326892, 'binary_recall': 0.75581396, 'binary_specificity': 0.9908646, 'binary_f1_score': 0.74407196}
confusion matrix:
       0    1
0  18005  166
1    147  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.7749875, 'recall': 0.5341235, 'specificity': 0.5341235, 'f1': 0.55302304, 'auroc': 0.9070064, 'binary_precision': 0.5862069, 'binary_recall': 0.07024793, 'binary_specificity': 0.997999, 'binary_f1_score': 0.12546125}
confusion matrix:
      0   1
0  5985  12
1   225  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_19.png
early stop counter: 5
val acc:0.9833270907402039, best validation acc: 0.9841261506080627, corresponding to test acc:                         0.9613720178604126 / 0.9786824584007263
after epoch: 19,now: 2024-06-01 17:24:45.732571,epoch time: 0:20:59.446331,used: 6:53:43.484919,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9877008, 'precision': 0.89969003, 'recall': 0.9212965, 'specificity': 0.9212965, 'f1': 0.9101839, 'auroc': 0.99490273, 'binary_precision': 0.8047559, 'binary_recall': 0.84996694, 'binary_specificity': 0.992626, 'binary_f1_score': 0.8267438}
confusion matrix:
       0     1
0  41999   312
1    227  1286
---- Validation: 
scalar performance:
{'acc': 0.98375326, 'precision': 0.87209165, 'recall': 0.8631197, 'specificity': 0.8631197, 'f1': 0.86754644, 'auroc': 0.97248304, 'binary_precision': 0.75298125, 'binary_recall': 0.73421925, 'binary_specificity': 0.99202025, 'binary_f1_score': 0.74348193}
confusion matrix:
       0    1
0  18026  145
1    160  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.792096, 'recall': 0.552385, 'specificity': 0.552385, 'f1': 0.5820364, 'auroc': 0.9351997, 'binary_precision': 0.61904764, 'binary_recall': 0.10743801, 'binary_specificity': 0.997332, 'binary_f1_score': 0.18309858}
confusion matrix:
      0   1
0  5981  16
1   216  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_20.png
early stop counter: 6
val acc:0.9837532639503479, best validation acc: 0.9841261506080627, corresponding to test acc:                         0.9613720178604126 / 0.9786824584007263
after epoch: 20,now: 2024-06-01 17:46:13.706327,epoch time: 0:21:27.973756,used: 7:15:11.458675,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98936653, 'precision': 0.9136008, 'recall': 0.9304441, 'specificity': 0.9304441, 'f1': 0.92184, 'auroc': 0.99498487, 'binary_precision': 0.8319594, 'binary_recall': 0.8671514, 'binary_specificity': 0.99373686, 'binary_f1_score': 0.849191}
confusion matrix:
       0     1
0  42046   265
1    201  1312
---- Validation: 
scalar performance:
{'acc': 0.9841794, 'precision': 0.86932665, 'recall': 0.87940085, 'specificity': 0.87940085, 'f1': 0.8742902, 'auroc': 0.9758489, 'binary_precision': 0.74636513, 'binary_recall': 0.76744187, 'binary_specificity': 0.99135983, 'binary_f1_score': 0.7567568}
confusion matrix:
       0    1
0  18014  157
1    140  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.75193644, 'recall': 0.55585027, 'specificity': 0.55585027, 'f1': 0.58547115, 'auroc': 0.91796654, 'binary_precision': 0.53846157, 'binary_recall': 0.11570248, 'binary_specificity': 0.995998, 'binary_f1_score': 0.19047618}
confusion matrix:
      0   1
0  5973  24
1   214  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_21.png
better model found
persisted
after epoch: 21,now: 2024-06-01 18:07:39.173048,epoch time: 0:21:25.466721,used: 7:36:36.925396,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98849946, 'precision': 0.8949729, 'recall': 0.9465649, 'specificity': 0.9465649, 'f1': 0.9190445, 'auroc': 0.9953849, 'binary_precision': 0.79348457, 'binary_recall': 0.90152013, 'binary_specificity': 0.99160975, 'binary_f1_score': 0.8440594}
confusion matrix:
       0     1
0  41956   355
1    149  1364
---- Validation: 
scalar performance:
{'acc': 0.982901, 'precision': 0.84714293, 'recall': 0.9020289, 'specificity': 0.9020289, 'f1': 0.8723943, 'auroc': 0.97791743, 'binary_precision': 0.70042795, 'binary_recall': 0.81561464, 'binary_specificity': 0.98844314, 'binary_f1_score': 0.7536454}
confusion matrix:
       0    1
0  17961  210
1    111  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.73850703, 'recall': 0.5397382, 'specificity': 0.5397382, 'f1': 0.5612949, 'auroc': 0.90528095, 'binary_precision': 0.51282054, 'binary_recall': 0.08264463, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.14234874}
confusion matrix:
      0   1
0  5978  19
1   222  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_22.png
early stop counter: 1
val acc:0.9829009771347046, best validation acc: 0.9841793775558472, corresponding to test acc:                         0.9618528485298157 / 0.9786824584007263
after epoch: 22,now: 2024-06-01 18:29:10.185452,epoch time: 0:21:31.012404,used: 7:58:07.937800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98772365, 'precision': 0.88846296, 'recall': 0.94361395, 'specificity': 0.94361395, 'f1': 0.9140435, 'auroc': 0.99493134, 'binary_precision': 0.7806563, 'binary_recall': 0.89623266, 'binary_specificity': 0.9909952, 'binary_f1_score': 0.8344615}
confusion matrix:
       0     1
0  41930   381
1    157  1356
---- Validation: 
scalar performance:
{'acc': 0.97800034, 'precision': 0.80686903, 'recall': 0.89708817, 'specificity': 0.89708817, 'f1': 0.84562075, 'auroc': 0.9742571, 'binary_precision': 0.62007624, 'binary_recall': 0.8106312, 'binary_specificity': 0.9835452, 'binary_f1_score': 0.70266384}
confusion matrix:
       0    1
0  17872  299
1    114  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.7943255, 'recall': 0.58262634, 'specificity': 0.58262634, 'f1': 0.62383175, 'auroc': 0.9291648, 'binary_precision': 0.6212121, 'binary_recall': 0.1694215, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.26623377}
confusion matrix:
      0   1
0  5972  25
1   201  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_23.png
early stop counter: 2
val acc:0.9780003428459167, best validation acc: 0.9841793775558472, corresponding to test acc:                         0.9618528485298157 / 0.9786824584007263
after epoch: 23,now: 2024-06-01 18:50:32.238395,epoch time: 0:21:22.052943,used: 8:19:29.990743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9887961, 'precision': 0.8949576, 'recall': 0.952773, 'specificity': 0.952773, 'f1': 0.92171484, 'auroc': 0.9963673, 'binary_precision': 0.7930046, 'binary_recall': 0.914078, 'binary_specificity': 0.99146795, 'binary_f1_score': 0.8492478}
confusion matrix:
       0     1
0  41950   361
1    130  1383
---- Validation: 
scalar performance:
{'acc': 0.9819422, 'precision': 0.8397604, 'recall': 0.8967153, 'specificity': 0.8967153, 'f1': 0.86583424, 'auroc': 0.9775938, 'binary_precision': 0.6859972, 'binary_recall': 0.80564785, 'binary_specificity': 0.9877827, 'binary_f1_score': 0.74102366}
confusion matrix:
       0    1
0  17949  222
1    117  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.8003765, 'recall': 0.54238796, 'specificity': 0.54238796, 'f1': 0.5668168, 'auroc': 0.88752794, 'binary_precision': 0.6363636, 'binary_recall': 0.08677686, 'binary_specificity': 0.997999, 'binary_f1_score': 0.15272728}
confusion matrix:
      0   1
0  5985  12
1   221  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_24.png
early stop counter: 3
val acc:0.9819421768188477, best validation acc: 0.9841793775558472, corresponding to test acc:                         0.9618528485298157 / 0.9786824584007263
after epoch: 24,now: 2024-06-01 19:12:04.833131,epoch time: 0:21:32.594736,used: 8:41:02.585479,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98913836, 'precision': 0.8980756, 'recall': 0.95358753, 'specificity': 0.95358753, 'f1': 0.9238591, 'auroc': 0.9968911, 'binary_precision': 0.79919213, 'binary_recall': 0.91539985, 'binary_specificity': 0.9917752, 'binary_f1_score': 0.853358}
confusion matrix:
       0     1
0  41963   348
1    128  1385
---- Validation: 
scalar performance:
{'acc': 0.98327386, 'precision': 0.84960353, 'recall': 0.90543365, 'specificity': 0.90543365, 'f1': 0.87526923, 'auroc': 0.9770714, 'binary_precision': 0.7051282, 'binary_recall': 0.8222591, 'binary_specificity': 0.98860824, 'binary_f1_score': 0.7592024}
confusion matrix:
       0    1
0  17964  207
1    107  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.83019984, 'recall': 0.5913077, 'specificity': 0.5913077, 'f1': 0.63766515, 'auroc': 0.91624737, 'binary_precision': 0.6923077, 'binary_recall': 0.18595041, 'binary_specificity': 0.996665, 'binary_f1_score': 0.2931596}
confusion matrix:
      0   1
0  5977  20
1   197  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_25.png
early stop counter: 4
val acc:0.9832738637924194, best validation acc: 0.9841793775558472, corresponding to test acc:                         0.9618528485298157 / 0.9786824584007263
after epoch: 25,now: 2024-06-01 19:33:40.563831,epoch time: 0:21:35.730700,used: 9:02:38.316179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99094105, 'precision': 0.9205044, 'recall': 0.949104, 'specificity': 0.949104, 'f1': 0.9342935, 'auroc': 0.99705267, 'binary_precision': 0.84444445, 'binary_recall': 0.9041639, 'binary_specificity': 0.9940441, 'binary_f1_score': 0.8732844}
confusion matrix:
       0     1
0  42059   252
1    145  1368
---- Validation: 
scalar performance:
{'acc': 0.9833271, 'precision': 0.85459995, 'recall': 0.89261246, 'specificity': 0.89261246, 'f1': 0.8725543, 'auroc': 0.97817373, 'binary_precision': 0.715994, 'binary_recall': 0.79568106, 'binary_specificity': 0.9895438, 'binary_f1_score': 0.75373715}
confusion matrix:
       0    1
0  17981  190
1    123  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.79072124, 'recall': 0.5644482, 'specificity': 0.5644482, 'f1': 0.59940493, 'auroc': 0.9161265, 'binary_precision': 0.61538464, 'binary_recall': 0.1322314, 'binary_specificity': 0.996665, 'binary_f1_score': 0.21768706}
confusion matrix:
      0   1
0  5977  20
1   210  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_26.png
early stop counter: 5
val acc:0.9833270907402039, best validation acc: 0.9841793775558472, corresponding to test acc:                         0.9618528485298157 / 0.9786824584007263
after epoch: 26,now: 2024-06-01 19:54:39.720229,epoch time: 0:20:59.156398,used: 9:23:37.472577,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9898686, 'precision': 0.9064642, 'recall': 0.95237243, 'specificity': 0.95237243, 'f1': 0.92808264, 'auroc': 0.9959897, 'binary_precision': 0.81608516, 'binary_recall': 0.9120952, 'binary_specificity': 0.9926497, 'binary_f1_score': 0.8614232}
confusion matrix:
       0     1
0  42000   311
1    133  1380
---- Validation: 
scalar performance:
{'acc': 0.9830075, 'precision': 0.85588366, 'recall': 0.8804016, 'specificity': 0.8804016, 'f1': 0.8676989, 'auroc': 0.9771755, 'binary_precision': 0.71937984, 'binary_recall': 0.7707641, 'binary_specificity': 0.99003905, 'binary_f1_score': 0.744186}
confusion matrix:
       0    1
0  17990  181
1    138  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.83019984, 'recall': 0.5913077, 'specificity': 0.5913077, 'f1': 0.63766515, 'auroc': 0.94029075, 'binary_precision': 0.6923077, 'binary_recall': 0.18595041, 'binary_specificity': 0.996665, 'binary_f1_score': 0.2931596}
confusion matrix:
      0   1
0  5977  20
1   197  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_27.png
early stop counter: 6
val acc:0.9830074906349182, best validation acc: 0.9841793775558472, corresponding to test acc:                         0.9618528485298157 / 0.9786824584007263
after epoch: 27,now: 2024-06-01 20:16:12.391355,epoch time: 0:21:32.671126,used: 9:45:10.143703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9907585, 'precision': 0.91273487, 'recall': 0.95856905, 'specificity': 0.95856905, 'f1': 0.9343406, 'auroc': 0.9972093, 'binary_precision': 0.828199, 'binary_recall': 0.9239921, 'binary_specificity': 0.993146, 'binary_f1_score': 0.8734771}
confusion matrix:
       0     1
0  42021   290
1    115  1398
---- Validation: 
scalar performance:
{'acc': 0.98423266, 'precision': 0.8714458, 'recall': 0.8762162, 'specificity': 0.8762162, 'f1': 0.87381446, 'auroc': 0.9753965, 'binary_precision': 0.7508197, 'binary_recall': 0.7607973, 'binary_specificity': 0.991635, 'binary_f1_score': 0.7557756}
confusion matrix:
       0    1
0  18019  152
1    144  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.81683385, 'recall': 0.57692826, 'specificity': 0.57692826, 'f1': 0.6179352, 'auroc': 0.93679863, 'binary_precision': 0.6666667, 'binary_recall': 0.1570248, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.2541806}
confusion matrix:
      0   1
0  5978  19
1   204  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_28.png
better model found
persisted
after epoch: 28,now: 2024-06-01 20:37:25.872281,epoch time: 0:21:13.480926,used: 10:06:23.624629,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9912833, 'precision': 0.9202058, 'recall': 0.9559729, 'specificity': 0.9559729, 'f1': 0.9372963, 'auroc': 0.99763435, 'binary_precision': 0.84335154, 'binary_recall': 0.9180436, 'binary_specificity': 0.99390227, 'binary_f1_score': 0.8791139}
confusion matrix:
       0     1
0  42053   258
1    124  1389
---- Validation: 
scalar performance:
{'acc': 0.9835402, 'precision': 0.8573662, 'recall': 0.8911164, 'specificity': 0.8911164, 'f1': 0.87341404, 'auroc': 0.9750798, 'binary_precision': 0.7216339, 'binary_recall': 0.7923588, 'binary_specificity': 0.98987395, 'binary_f1_score': 0.75534445}
confusion matrix:
       0    1
0  17987  184
1    125  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.8180686, 'recall': 0.60931915, 'specificity': 0.60931915, 'f1': 0.65833855, 'auroc': 0.921803, 'binary_precision': 0.6666667, 'binary_recall': 0.2231405, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.33436534}
confusion matrix:
      0   1
0  5970  27
1   188  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_29.png
early stop counter: 1
val acc:0.9835401773452759, best validation acc: 0.9842326641082764, corresponding to test acc:                         0.9642571210861206 / 0.9786824584007263
after epoch: 29,now: 2024-06-01 20:58:58.908517,epoch time: 0:21:33.036236,used: 10:27:56.660865,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9914202, 'precision': 0.9491848, 'recall': 0.9187616, 'specificity': 0.9187616, 'f1': 0.93339753, 'auroc': 0.9968696, 'binary_precision': 0.9040512, 'binary_recall': 0.8407138, 'binary_specificity': 0.99680936, 'binary_f1_score': 0.87123287}
confusion matrix:
       0     1
0  42176   135
1    241  1272
---- Validation: 
scalar performance:
{'acc': 0.9833271, 'precision': 0.8788893, 'recall': 0.8404143, 'specificity': 0.8404143, 'f1': 0.8585408, 'auroc': 0.96927166, 'binary_precision': 0.76808906, 'binary_recall': 0.68770766, 'binary_specificity': 0.9931209, 'binary_f1_score': 0.7256792}
confusion matrix:
       0    1
0  18046  125
1    188  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.82896036, 'recall': 0.57709503, 'specificity': 0.57709503, 'f1': 0.61887467, 'auroc': 0.870658, 'binary_precision': 0.6909091, 'binary_recall': 0.1570248, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.25589228}
confusion matrix:
      0   1
0  5980  17
1   204  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21011742_30.png
early stop counter: 2
val acc:0.9833270907402039, best validation acc: 0.9842326641082764, corresponding to test acc:                         0.9642571210861206 / 0.9786824584007263
after epoch: 30,now: 2024-06-01 21:20:39.013924,epoch time: 0:21:40.105407,used: 10:49:36.766272,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_01_10_31_02_seed_2_21011742
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:49:36.766272 at 2024-06-01 21:20:39.013924
persisted model performance metric: 

scalar performance:
{'acc': 0.96473795, 'precision': 0.83536035, 'recall': 0.57717836, 'specificity': 0.57717836, 'f1': 0.61934865, 'auroc': 0.9275429, 'binary_precision': 0.7037037, 'binary_recall': 0.1570248, 'binary_specificity': 0.997332, 'binary_f1_score': 0.25675678}
confusion matrix:
      0   1
0  5981  16
1   204  38
oracle model performance metric: 

scalar performance:
{'acc': 0.9764385, 'precision': 0.87689173, 'recall': 0.77559066, 'specificity': 0.77559066, 'f1': 0.817647, 'auroc': 0.9322378, 'binary_precision': 0.7714286, 'binary_recall': 0.55785125, 'binary_specificity': 0.99333, 'binary_f1_score': 0.647482}
confusion matrix:
      0    1
0  5957   40
1   107  135
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 486101 KiB |   1837 MiB |   4218 TiB |   4218 TiB |
|       from large pool | 396288 KiB |   1766 MiB |   4208 TiB |   4208 TiB |
|       from small pool |  89813 KiB |    124 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 486101 KiB |   1837 MiB |   4218 TiB |   4218 TiB |
|       from large pool | 396288 KiB |   1766 MiB |   4208 TiB |   4208 TiB |
|       from small pool |  89813 KiB |    124 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476572 KiB |   1821 MiB |   4204 TiB |   4204 TiB |
|       from large pool | 387840 KiB |   1750 MiB |   4194 TiB |   4194 TiB |
|       from small pool |  88732 KiB |    123 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2044 MiB |   2108 MiB |   3256 MiB |   1212 MiB |
|       from large pool |   1920 MiB |   1982 MiB |   3070 MiB |   1150 MiB |
|       from small pool |    124 MiB |    126 MiB |    186 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1011 MiB |   1198 MiB |   2214 TiB |   2214 TiB |
|       from large pool |   1005 MiB |   1178 MiB |   2203 TiB |   2203 TiB |
|       from small pool |      6 MiB |     28 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3717    |    6708    |  387443 K  |  387440 K  |
|       from large pool |      87    |     178    |  166600 K  |  166600 K  |
|       from small pool |    3630    |    6620    |  220843 K  |  220840 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3717    |    6708    |  387443 K  |  387440 K  |
|       from large pool |      87    |     178    |  166600 K  |  166600 K  |
|       from small pool |    3630    |    6620    |  220843 K  |  220840 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      90    |      96    |     134    |      44    |
|       from large pool |      28    |      33    |      41    |      13    |
|       from small pool |      62    |      63    |      93    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      49    |    2771    |  162714 K  |  162714 K  |
|       from large pool |      18    |      27    |   60482 K  |   60482 K  |
|       from small pool |      31    |    2750    |  102232 K  |  102232 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   4218 TiB |   4218 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   4208 TiB |   4208 TiB |
|       from small pool |      0 KiB |    124 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   4218 TiB |   4218 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   4208 TiB |   4208 TiB |
|       from small pool |      0 KiB |    124 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   4204 TiB |   4204 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   4194 TiB |   4194 TiB |
|       from small pool |      0 KiB |    123 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1486 MiB |   2108 MiB |   3256 MiB |   1770 MiB |
|       from large pool |   1392 MiB |   1982 MiB |   3070 MiB |   1678 MiB |
|       from small pool |     94 MiB |    126 MiB |    186 MiB |     92 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1198 MiB |   2214 TiB |   2214 TiB |
|       from large pool | 134912 KiB |   1178 MiB |   2203 TiB |   2203 TiB |
|       from small pool |      0 KiB |     28 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6708    |  387443 K  |  387443 K  |
|       from large pool |       2    |     178    |  166600 K  |  166600 K  |
|       from small pool |       0    |    6620    |  220843 K  |  220843 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6708    |  387443 K  |  387443 K  |
|       from large pool |       2    |     178    |  166600 K  |  166600 K  |
|       from small pool |       0    |    6620    |  220843 K  |  220843 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |      96    |     134    |      63    |
|       from large pool |      24    |      33    |      41    |      17    |
|       from small pool |      47    |      63    |      93    |      46    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2771    |  162716 K  |  162716 K  |
|       from large pool |       4    |      27    |   60482 K  |   60482 K  |
|       from small pool |       0    |    2750    |  102234 K  |  102234 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jun  1 21:22:44 2024]
Finished job 0.
1 of 1 steps (100%) done
