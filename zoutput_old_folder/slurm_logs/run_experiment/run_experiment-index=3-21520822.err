Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jun 21 11:06:51 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822

 Experiment start at: 2024-06-21 11:23:15.173762
before training, model accuracy: 0.3103227913379669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9433005, 'precision': 0.9665062, 'recall': 0.70145386, 'specificity': 0.70145386, 'f1': 0.7714968, 'auroc': 0.9453093, 'binary_precision': 0.9916434, 'binary_recall': 0.40326235, 'binary_specificity': 0.9996454, 'binary_f1_score': 0.5733612}
confusion matrix:
       0     1
0  42291    15
1   2634  1780
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.5462393, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.58455396, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 11:39:43.252606,epoch time: 0:16:28.078844,used: 0:16:28.078844,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9708904, 'precision': 0.9815577, 'recall': 0.8478036, 'specificity': 0.8478036, 'f1': 0.9014448, 'auroc': 0.9741001, 'binary_precision': 0.9938511, 'binary_recall': 0.6960562, 'binary_specificity': 0.99955094, 'binary_f1_score': 0.818715}
confusion matrix:
       0     1
0  42289    19
1   1341  3071
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.7724329, 'recall': 0.51969427, 'specificity': 0.51969427, 'f1': 0.5291719, 'auroc': 0.6499573, 'binary_precision': 0.5777778, 'binary_recall': 0.04043546, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.0755814}
confusion matrix:
       0   1
0  18130  19
1    617  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.71908236, 'recall': 0.5200723, 'specificity': 0.5200723, 'f1': 0.52802277, 'auroc': 0.6872997, 'binary_precision': 0.47826087, 'binary_recall': 0.042145595, 'binary_specificity': 0.997999, 'binary_f1_score': 0.07746479}
confusion matrix:
      0   1
0  5985  12
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_2.png
better model found
persisted
after epoch: 2,now: 2024-06-21 11:54:11.325944,epoch time: 0:14:28.073338,used: 0:30:56.152182,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97776115, 'precision': 0.98279655, 'recall': 0.88626313, 'specificity': 0.88626313, 'f1': 0.9278938, 'auroc': 0.9823687, 'binary_precision': 0.98870546, 'binary_recall': 0.7734481, 'binary_specificity': 0.99907815, 'binary_f1_score': 0.86792934}
confusion matrix:
       0     1
0  42267    39
1   1000  3414
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.7666029, 'recall': 0.5499169, 'specificity': 0.5499169, 'f1': 0.5783151, 'auroc': 0.70017564, 'binary_precision': 0.5641026, 'binary_recall': 0.102643855, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.17368421}
confusion matrix:
       0   1
0  18098  51
1    577  66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.80155605, 'recall': 0.55980194, 'specificity': 0.55980194, 'f1': 0.59277505, 'auroc': 0.7353275, 'binary_precision': 0.64, 'binary_recall': 0.12260536, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.20578776}
confusion matrix:
      0   1
0  5979  18
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-21 12:09:23.430416,epoch time: 0:15:12.104472,used: 0:46:08.256654,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.980458, 'precision': 0.9839225, 'recall': 0.900964, 'specificity': 0.900964, 'f1': 0.93761575, 'auroc': 0.98732495, 'binary_precision': 0.9880156, 'binary_recall': 0.8029445, 'binary_specificity': 0.99898356, 'binary_f1_score': 0.8859178}
confusion matrix:
       0     1
0  42262    43
1    870  3545
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7761329, 'recall': 0.56441593, 'specificity': 0.56441593, 'f1': 0.5993198, 'auroc': 0.72746617, 'binary_precision': 0.58219177, 'binary_recall': 0.13219285, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.21546263}
confusion matrix:
       0   1
0  18088  61
1    558  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.823919, 'recall': 0.57695997, 'specificity': 0.57695997, 'f1': 0.6179268, 'auroc': 0.74817485, 'binary_precision': 0.68333334, 'binary_recall': 0.15708812, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.2554517}
confusion matrix:
      0   1
0  5978  19
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-21 12:22:59.345590,epoch time: 0:13:35.915174,used: 0:59:44.171828,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9837971, 'precision': 0.9822034, 'recall': 0.9218594, 'specificity': 0.9218594, 'f1': 0.94951785, 'auroc': 0.9898422, 'binary_precision': 0.9802995, 'binary_recall': 0.8454916, 'binary_specificity': 0.9982272, 'binary_f1_score': 0.9079187}
confusion matrix:
       0     1
0  42231    75
1    682  3732
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.7552706, 'recall': 0.5829469, 'specificity': 0.5829469, 'f1': 0.6213365, 'auroc': 0.762316, 'binary_precision': 0.5392157, 'binary_recall': 0.1710731, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.25974026}
confusion matrix:
       0    1
0  18055   94
1    533  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.8279377, 'recall': 0.5920355, 'specificity': 0.5920355, 'f1': 0.6379876, 'auroc': 0.7846503, 'binary_precision': 0.69014084, 'binary_recall': 0.18773946, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.2951807}
confusion matrix:
      0   1
0  5975  22
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_5.png
new oracle model saved
early stop counter: 1
val acc:0.9666347503662109, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9618088603019714 / 0.9626078605651855
after epoch: 5,now: 2024-06-21 12:36:39.561648,epoch time: 0:13:40.216058,used: 1:13:24.387886,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9853596, 'precision': 0.9828925, 'recall': 0.9304484, 'specificity': 0.9304484, 'f1': 0.9547881, 'auroc': 0.9913268, 'binary_precision': 0.9799331, 'binary_recall': 0.86274064, 'binary_specificity': 0.99815625, 'binary_f1_score': 0.91761017}
confusion matrix:
       0     1
0  42227    78
1    606  3809
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.75920796, 'recall': 0.5883075, 'specificity': 0.5883075, 'f1': 0.62804127, 'auroc': 0.77426004, 'binary_precision': 0.54672897, 'binary_recall': 0.18195957, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.2730455}
confusion matrix:
       0    1
0  18052   97
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.85312897, 'recall': 0.60186416, 'specificity': 0.60186416, 'f1': 0.6524007, 'auroc': 0.7817113, 'binary_precision': 0.739726, 'binary_recall': 0.20689656, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.32335332}
confusion matrix:
      0   1
0  5978  19
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_6.png
new oracle model saved
early stop counter: 2
val acc:0.9668475985527039, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9618088603019714 / 0.9638862013816833
after epoch: 6,now: 2024-06-21 12:51:43.680422,epoch time: 0:15:04.118774,used: 1:28:28.506660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98668665, 'precision': 0.9814712, 'recall': 0.9395733, 'specificity': 0.9395733, 'f1': 0.9593278, 'auroc': 0.99214053, 'binary_precision': 0.97518176, 'binary_recall': 0.88148654, 'binary_specificity': 0.99766, 'binary_f1_score': 0.9259701}
confusion matrix:
       0     1
0  42208    99
1    523  3890
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.75390923, 'recall': 0.58969736, 'specificity': 0.58969736, 'f1': 0.62903446, 'auroc': 0.7785785, 'binary_precision': 0.536036, 'binary_recall': 0.18506998, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.27514452}
confusion matrix:
       0    1
0  18046  103
1    524  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8085401, 'recall': 0.6010304, 'specificity': 0.6010304, 'f1': 0.64728236, 'auroc': 0.7901958, 'binary_precision': 0.6506024, 'binary_recall': 0.20689656, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.31395352}
confusion matrix:
      0   1
0  5968  29
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_7.png
early stop counter: 3
val acc:0.9666347503662109, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9618088603019714 / 0.9638862013816833
after epoch: 7,now: 2024-06-21 13:08:14.207009,epoch time: 0:16:30.526587,used: 1:44:59.033247,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9862158, 'precision': 0.9842305, 'recall': 0.93423903, 'specificity': 0.93423903, 'f1': 0.9575336, 'auroc': 0.99139416, 'binary_precision': 0.9818461, 'binary_recall': 0.87015635, 'binary_specificity': 0.9983218, 'binary_f1_score': 0.9226334}
confusion matrix:
       0     1
0  42236    71
1    573  3840
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.76737607, 'recall': 0.5877227, 'specificity': 0.5877227, 'f1': 0.6282333, 'auroc': 0.78002, 'binary_precision': 0.5631068, 'binary_recall': 0.18040435, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.27326265}
confusion matrix:
       0    1
0  18059   90
1    527  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.81154805, 'recall': 0.5898696, 'specificity': 0.5898696, 'f1': 0.6339441, 'auroc': 0.7807237, 'binary_precision': 0.65753424, 'binary_recall': 0.18390805, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.28742516}
confusion matrix:
      0   1
0  5972  25
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_8.png
better model found
persisted
after epoch: 8,now: 2024-06-21 13:26:25.305834,epoch time: 0:18:11.098825,used: 2:03:10.132072,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9880565, 'precision': 0.9830507, 'recall': 0.9462395, 'specificity': 0.9462395, 'f1': 0.96373045, 'auroc': 0.9944091, 'binary_precision': 0.97699726, 'binary_recall': 0.8946772, 'binary_specificity': 0.99780166, 'binary_f1_score': 0.9340269}
confusion matrix:
       0     1
0  42212    93
1    465  3950
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7603591, 'recall': 0.59361297, 'specificity': 0.59361297, 'f1': 0.63423574, 'auroc': 0.79098535, 'binary_precision': 0.54867256, 'binary_recall': 0.19284603, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.2853855}
confusion matrix:
       0    1
0  18047  102
1    519  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.81394005, 'recall': 0.5917854, 'specificity': 0.5917854, 'f1': 0.63654035, 'auroc': 0.79585373, 'binary_precision': 0.6621622, 'binary_recall': 0.18773946, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.2925373}
confusion matrix:
      0   1
0  5972  25
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_9.png
early stop counter: 1
val acc:0.9669540524482727, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9619686603546143 / 0.9638862013816833
after epoch: 9,now: 2024-06-21 13:44:26.660093,epoch time: 0:18:01.354259,used: 2:21:11.486331,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98848456, 'precision': 0.9825946, 'recall': 0.94919205, 'specificity': 0.94919205, 'f1': 0.9651417, 'auroc': 0.99381125, 'binary_precision': 0.9754601, 'binary_recall': 0.9007478, 'binary_specificity': 0.9976363, 'binary_f1_score': 0.9366164}
confusion matrix:
       0     1
0  42207   100
1    438  3975
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.753929, 'recall': 0.6032535, 'specificity': 0.6032535, 'f1': 0.6438731, 'auroc': 0.7968856, 'binary_precision': 0.53515625, 'binary_recall': 0.21306376, 'binary_specificity': 0.9934432, 'binary_f1_score': 0.30478308}
confusion matrix:
       0    1
0  18030  119
1    506  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.78276145, 'recall': 0.589286, 'specificity': 0.589286, 'f1': 0.6307009, 'auroc': 0.79412585, 'binary_precision': 0.6, 'binary_recall': 0.18390805, 'binary_specificity': 0.994664, 'binary_f1_score': 0.28152493}
confusion matrix:
      0   1
0  5965  32
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_10.png
early stop counter: 2
val acc:0.966741144657135, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9619686603546143 / 0.9638862013816833
after epoch: 10,now: 2024-06-21 14:02:27.231687,epoch time: 0:18:00.571594,used: 2:39:12.057925,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98876286, 'precision': 0.9820535, 'recall': 0.95137537, 'specificity': 0.95137537, 'f1': 0.9660811, 'auroc': 0.9949307, 'binary_precision': 0.97391516, 'binary_recall': 0.9052799, 'binary_specificity': 0.99747086, 'binary_f1_score': 0.9383441}
confusion matrix:
       0     1
0  42200   107
1    418  3995
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.7567167, 'recall': 0.5995583, 'specificity': 0.5995583, 'f1': 0.6403278, 'auroc': 0.7993014, 'binary_precision': 0.5409836, 'binary_recall': 0.20528771, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.2976325}
confusion matrix:
       0    1
0  18037  112
1    511  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.78276145, 'recall': 0.589286, 'specificity': 0.589286, 'f1': 0.6307009, 'auroc': 0.7844188, 'binary_precision': 0.6, 'binary_recall': 0.18390805, 'binary_specificity': 0.994664, 'binary_f1_score': 0.28152493}
confusion matrix:
      0   1
0  5965  32
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_11.png
early stop counter: 3
val acc:0.9668475985527039, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9619686603546143 / 0.9638862013816833
after epoch: 11,now: 2024-06-21 14:20:59.379520,epoch time: 0:18:32.147833,used: 2:57:44.205758,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98989725, 'precision': 0.9860666, 'recall': 0.9542141, 'specificity': 0.9542141, 'f1': 0.96946335, 'auroc': 0.9953282, 'binary_precision': 0.98142266, 'binary_recall': 0.91022444, 'binary_specificity': 0.9982037, 'binary_f1_score': 0.9444837}
confusion matrix:
       0     1
0  42233    76
1    396  4015
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.763609, 'recall': 0.5951957, 'specificity': 0.5951957, 'f1': 0.6364112, 'auroc': 0.8040682, 'binary_precision': 0.5550661, 'binary_recall': 0.19595645, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.28965515}
confusion matrix:
       0    1
0  18048  101
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.75194323, 'recall': 0.57562596, 'specificity': 0.57562596, 'f1': 0.6111929, 'auroc': 0.79203767, 'binary_precision': 0.5394737, 'binary_recall': 0.15708812, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.24332345}
confusion matrix:
      0   1
0  5962  35
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_12.png
early stop counter: 4
val acc:0.9671136736869812, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9619686603546143 / 0.9638862013816833
after epoch: 12,now: 2024-06-21 14:39:12.431020,epoch time: 0:18:13.051500,used: 3:15:57.257258,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98987585, 'precision': 0.98605704, 'recall': 0.9541211, 'specificity': 0.9541211, 'f1': 0.9694084, 'auroc': 0.99544084, 'binary_precision': 0.9814272, 'binary_recall': 0.91003853, 'binary_specificity': 0.99820364, 'binary_f1_score': 0.9443857}
confusion matrix:
       0     1
0  42231    76
1    397  4016
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.75846756, 'recall': 0.5913077, 'specificity': 0.5913077, 'f1': 0.63140106, 'auroc': 0.79632276, 'binary_precision': 0.545045, 'binary_recall': 0.1881804, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.2797688}
confusion matrix:
       0    1
0  18048  101
1    522  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.790263, 'recall': 0.5689636, 'specificity': 0.5689636, 'f1': 0.6051377, 'auroc': 0.78425646, 'binary_precision': 0.6166667, 'binary_recall': 0.14176245, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.2305296}
confusion matrix:
      0   1
0  5974  23
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_13.png
early stop counter: 5
val acc:0.9668475985527039, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9619686603546143 / 0.9638862013816833
after epoch: 13,now: 2024-06-21 14:58:08.707380,epoch time: 0:18:56.276360,used: 3:34:53.533618,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.990732, 'precision': 0.98557013, 'recall': 0.95967686, 'specificity': 0.95967686, 'f1': 0.97217774, 'auroc': 0.995996, 'binary_precision': 0.9792921, 'binary_recall': 0.9213865, 'binary_specificity': 0.9979672, 'binary_f1_score': 0.94945717}
confusion matrix:
       0     1
0  42220    86
1    347  4067
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.75942147, 'recall': 0.60264117, 'specificity': 0.60264117, 'f1': 0.6440177, 'auroc': 0.8124239, 'binary_precision': 0.5461847, 'binary_recall': 0.21150856, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.30493274}
confusion matrix:
       0    1
0  18036  113
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7387264, 'recall': 0.5697954, 'specificity': 0.5697954, 'f1': 0.6028015, 'auroc': 0.80094576, 'binary_precision': 0.5135135, 'binary_recall': 0.14559387, 'binary_specificity': 0.993997, 'binary_f1_score': 0.22686566}
confusion matrix:
      0   1
0  5961  36
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_14.png
early stop counter: 6
val acc:0.9670072197914124, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9619686603546143 / 0.9638862013816833
after epoch: 14,now: 2024-06-21 15:13:45.161621,epoch time: 0:15:36.454241,used: 3:50:29.987859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9903895, 'precision': 0.9839891, 'recall': 0.9591565, 'specificity': 0.9591565, 'f1': 0.9711618, 'auroc': 0.9951752, 'binary_precision': 0.97620195, 'binary_recall': 0.9206529, 'binary_specificity': 0.9976601, 'binary_f1_score': 0.9476141}
confusion matrix:
       0     1
0  42210    99
1    350  4061
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7492465, 'recall': 0.5986154, 'specificity': 0.5986154, 'f1': 0.638276, 'auroc': 0.811767, 'binary_precision': 0.5261044, 'binary_recall': 0.2037325, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.29372197}
confusion matrix:
       0    1
0  18031  118
1    512  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.76303697, 'recall': 0.57587606, 'specificity': 0.57587606, 'f1': 0.6124114, 'auroc': 0.7943325, 'binary_precision': 0.56164384, 'binary_recall': 0.15708812, 'binary_specificity': 0.994664, 'binary_f1_score': 0.24550897}
confusion matrix:
      0   1
0  5965  32
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_15.png
early stop counter: 7
val acc:0.9664750695228577, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9619686603546143 / 0.9638862013816833
after epoch: 15,now: 2024-06-21 15:26:32.304449,epoch time: 0:12:47.142828,used: 4:03:17.130687,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9903467, 'precision': 0.9868895, 'recall': 0.95609653, 'specificity': 0.95609653, 'f1': 0.97086203, 'auroc': 0.9959781, 'binary_precision': 0.9826956, 'binary_recall': 0.9138713, 'binary_specificity': 0.99832183, 'binary_f1_score': 0.94703466}
confusion matrix:
       0     1
0  42237    71
1    380  4032
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.7606659, 'recall': 0.5830571, 'specificity': 0.5830571, 'f1': 0.6220081, 'auroc': 0.8032241, 'binary_precision': 0.55, 'binary_recall': 0.1710731, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.2609727}
confusion matrix:
       0    1
0  18059   90
1    533  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7527157, 'recall': 0.5590516, 'specificity': 0.5590516, 'f1': 0.5895047, 'auroc': 0.7919868, 'binary_precision': 0.5423729, 'binary_recall': 0.12260536, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5970  27
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_16.png
early stop counter: 8
val acc:0.9668475985527039, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9619686603546143 / 0.9638862013816833
after epoch: 16,now: 2024-06-21 15:37:49.522451,epoch time: 0:11:17.218002,used: 4:14:34.348689,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99088186, 'precision': 0.98861444, 'recall': 0.95761955, 'specificity': 0.95761955, 'f1': 0.9724802, 'auroc': 0.99590015, 'binary_precision': 0.985864, 'binary_recall': 0.91661, 'binary_specificity': 0.9986291, 'binary_f1_score': 0.9499765}
confusion matrix:
       0     1
0  42249    58
1    368  4045
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.76932687, 'recall': 0.5794445, 'specificity': 0.5794445, 'f1': 0.6184048, 'auroc': 0.81976056, 'binary_precision': 0.5675676, 'binary_recall': 0.16329704, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.2536232}
confusion matrix:
       0    1
0  18069   80
1    538  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.76015455, 'recall': 0.5536379, 'specificity': 0.5536379, 'f1': 0.5822035, 'auroc': 0.8128743, 'binary_precision': 0.5576923, 'binary_recall': 0.11111111, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.18530352}
confusion matrix:
      0   1
0  5974  23
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_17.png
early stop counter: 9
val acc:0.9671136736869812, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9619686603546143 / 0.9638862013816833
after epoch: 17,now: 2024-06-21 15:53:14.125877,epoch time: 0:15:24.603426,used: 4:29:58.952115,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9914812, 'precision': 0.9863694, 'recall': 0.963321, 'specificity': 0.963321, 'f1': 0.9744935, 'auroc': 0.9966558, 'binary_precision': 0.98014355, 'binary_recall': 0.9286038, 'binary_specificity': 0.9980382, 'binary_f1_score': 0.95367783}
confusion matrix:
       0     1
0  42225    83
1    315  4097
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.7523422, 'recall': 0.59192, 'specificity': 0.59192, 'f1': 0.6313552, 'auroc': 0.82047963, 'binary_precision': 0.5327511, 'binary_recall': 0.18973562, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.2798165}
confusion matrix:
       0    1
0  18042  107
1    521  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.72109175, 'recall': 0.5620492, 'specificity': 0.5620492, 'f1': 0.5915758, 'auroc': 0.8027796, 'binary_precision': 0.47887325, 'binary_recall': 0.1302682, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.20481928}
confusion matrix:
      0   1
0  5960  37
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_18.png
early stop counter: 10
val acc:0.9665815234184265, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9619686603546143 / 0.9638862013816833
after epoch: 18,now: 2024-06-21 16:06:49.945881,epoch time: 0:13:35.820004,used: 4:43:34.772119,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9911815, 'precision': 0.9860738, 'recall': 0.9618527, 'specificity': 0.9618527, 'f1': 0.9735742, 'auroc': 0.9967145, 'binary_precision': 0.97985613, 'binary_recall': 0.925691, 'binary_specificity': 0.99801445, 'binary_f1_score': 0.9520037}
confusion matrix:
       0     1
0  42222    84
1    328  4086
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7591176, 'recall': 0.59886336, 'specificity': 0.59886336, 'f1': 0.63989764, 'auroc': 0.8231531, 'binary_precision': 0.54583335, 'binary_recall': 0.2037325, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.29671577}
confusion matrix:
       0    1
0  18040  109
1    512  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.7133835, 'recall': 0.5582178, 'specificity': 0.5582178, 'f1': 0.5860555, 'auroc': 0.7950413, 'binary_precision': 0.46376812, 'binary_recall': 0.12260536, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.19393939}
confusion matrix:
      0   1
0  5960  37
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_19.png
early stop counter: 11
val acc:0.9669540524482727, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9619686603546143 / 0.9638862013816833
after epoch: 19,now: 2024-06-21 16:16:26.770476,epoch time: 0:09:36.824595,used: 4:53:11.596714,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99092466, 'precision': 0.98610586, 'recall': 0.9602642, 'specificity': 0.9602642, 'f1': 0.9727417, 'auroc': 0.9967842, 'binary_precision': 0.9802457, 'binary_recall': 0.9224666, 'binary_specificity': 0.9980619, 'binary_f1_score': 0.9504788}
confusion matrix:
       0     1
0  42227    82
1    342  4069
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.76115054, 'recall': 0.5906127, 'specificity': 0.5906127, 'f1': 0.63091767, 'auroc': 0.8181592, 'binary_precision': 0.5504587, 'binary_recall': 0.1866252, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.27874565}
confusion matrix:
       0    1
0  18051   98
1    523  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7655721, 'recall': 0.5703791, 'specificity': 0.5703791, 'f1': 0.6055156, 'auroc': 0.795636, 'binary_precision': 0.5671642, 'binary_recall': 0.14559387, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.2317073}
confusion matrix:
      0   1
0  5968  29
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_20.png
early stop counter: 12
val acc:0.9669540524482727, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9619686603546143 / 0.9638862013816833
after epoch: 20,now: 2024-06-21 16:28:42.931802,epoch time: 0:12:16.161326,used: 5:05:27.758040,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9916738, 'precision': 0.98680097, 'recall': 0.9640206, 'specificity': 0.9640206, 'f1': 0.97506773, 'auroc': 0.9961303, 'binary_precision': 0.98086584, 'binary_recall': 0.929932, 'binary_specificity': 0.9981092, 'binary_f1_score': 0.9547201}
confusion matrix:
       0     1
0  42230    80
1    309  4101
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7555851, 'recall': 0.59350276, 'specificity': 0.59350276, 'f1': 0.6335265, 'auroc': 0.81972766, 'binary_precision': 0.53913045, 'binary_recall': 0.19284603, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.28407788}
confusion matrix:
       0    1
0  18043  106
1    519  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7354856, 'recall': 0.558718, 'specificity': 0.558718, 'f1': 0.5881027, 'auroc': 0.7940065, 'binary_precision': 0.50793654, 'binary_recall': 0.12260536, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.19753085}
confusion matrix:
      0   1
0  5966  31
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_21.png
early stop counter: 13
val acc:0.966741144657135, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9619686603546143 / 0.9638862013816833
after epoch: 21,now: 2024-06-21 16:39:43.455053,epoch time: 0:11:00.523251,used: 5:16:28.281291,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99199486, 'precision': 0.9876385, 'recall': 0.9651426, 'specificity': 0.9651426, 'f1': 0.9760567, 'auroc': 0.99677813, 'binary_precision': 0.98233044, 'binary_recall': 0.93203443, 'binary_specificity': 0.99825084, 'binary_f1_score': 0.95652175}
confusion matrix:
       0     1
0  42232    74
1    300  4114
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.75928473, 'recall': 0.5981133, 'specificity': 0.5981133, 'f1': 0.6390998, 'auroc': 0.8212381, 'binary_precision': 0.5462185, 'binary_recall': 0.2021773, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.2951192}
confusion matrix:
       0    1
0  18041  108
1    513  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.75340986, 'recall': 0.5701289, 'specificity': 0.5701289, 'f1': 0.60433996, 'auroc': 0.79085135, 'binary_precision': 0.54285717, 'binary_recall': 0.14559387, 'binary_specificity': 0.994664, 'binary_f1_score': 0.22960725}
confusion matrix:
      0   1
0  5965  32
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_22.png
early stop counter: 14
val acc:0.9669540524482727, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9619686603546143 / 0.9638862013816833
after epoch: 22,now: 2024-06-21 16:50:45.199908,epoch time: 0:11:01.744855,used: 5:27:30.026146,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9926798, 'precision': 0.9886957, 'recall': 0.9681517, 'specificity': 0.9681517, 'f1': 0.9781464, 'auroc': 0.99724376, 'binary_precision': 0.9838365, 'binary_recall': 0.93791074, 'binary_specificity': 0.9983927, 'binary_f1_score': 0.9603248}
confusion matrix:
       0     1
0  42239    68
1    274  4139
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.7564372, 'recall': 0.6010584, 'specificity': 0.6010584, 'f1': 0.64190346, 'auroc': 0.8295361, 'binary_precision': 0.5403226, 'binary_recall': 0.20839813, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.30078563}
confusion matrix:
       0    1
0  18035  114
1    509  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.72785485, 'recall': 0.5603837, 'specificity': 0.5603837, 'f1': 0.5898615, 'auroc': 0.8071104, 'binary_precision': 0.49253732, 'binary_recall': 0.12643678, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.20121953}
confusion matrix:
      0   1
0  5963  34
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_23.png
early stop counter: 15
val acc:0.9668475985527039, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9619686603546143 / 0.9638862013816833
after epoch: 23,now: 2024-06-21 17:01:13.386353,epoch time: 0:10:28.186445,used: 5:37:58.212591,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99253, 'precision': 0.98922396, 'recall': 0.96674967, 'specificity': 0.96674967, 'f1': 0.9776548, 'auroc': 0.9976927, 'binary_precision': 0.9851958, 'binary_recall': 0.9349649, 'binary_specificity': 0.9985345, 'binary_f1_score': 0.9594233}
confusion matrix:
       0     1
0  42245    62
1    287  4126
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.75351065, 'recall': 0.5851695, 'specificity': 0.5851695, 'f1': 0.62376964, 'auroc': 0.82993454, 'binary_precision': 0.53554505, 'binary_recall': 0.17573872, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.264637}
confusion matrix:
       0    1
0  18051   98
1    530  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.72705, 'recall': 0.55305433, 'specificity': 0.55305433, 'f1': 0.57988375, 'auroc': 0.8048598, 'binary_precision': 0.4915254, 'binary_recall': 0.11111111, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.18125}
confusion matrix:
      0   1
0  5967  30
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_24.png
early stop counter: 16
val acc:0.9665815234184265, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9619686603546143 / 0.9638862013816833
after epoch: 24,now: 2024-06-21 17:11:19.949198,epoch time: 0:10:06.562845,used: 5:48:04.775436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99253, 'precision': 0.98839915, 'recall': 0.96758294, 'specificity': 0.96758294, 'f1': 0.977706, 'auroc': 0.99722445, 'binary_precision': 0.98336107, 'binary_recall': 0.9368206, 'binary_specificity': 0.9983453, 'binary_f1_score': 0.95952684}
confusion matrix:
       0     1
0  42234    70
1    279  4137
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.75574344, 'recall': 0.5867247, 'specificity': 0.5867247, 'f1': 0.62582374, 'auroc': 0.8266745, 'binary_precision': 0.5399061, 'binary_recall': 0.17884915, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.2686916}
confusion matrix:
       0    1
0  18051   98
1    528  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.73158914, 'recall': 0.560467, 'specificity': 0.560467, 'f1': 0.5902111, 'auroc': 0.8041452, 'binary_precision': 0.5, 'binary_recall': 0.12643678, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.20183487}
confusion matrix:
      0   1
0  5964  33
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_25.png
early stop counter: 17
val acc:0.9666879773139954, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9619686603546143 / 0.9638862013816833
after epoch: 25,now: 2024-06-21 17:20:29.443291,epoch time: 0:09:09.494093,used: 5:57:14.269529,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99188787, 'precision': 0.9875716, 'recall': 0.96458405, 'specificity': 0.96458405, 'f1': 0.975729, 'auroc': 0.9972582, 'binary_precision': 0.9823136, 'binary_recall': 0.9309173, 'binary_specificity': 0.9982508, 'binary_f1_score': 0.9559251}
confusion matrix:
       0     1
0  42231    74
1    305  4110
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.7588301, 'recall': 0.58980757, 'specificity': 0.58980757, 'f1': 0.629729, 'auroc': 0.8246653, 'binary_precision': 0.54587156, 'binary_recall': 0.18506998, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.27642274}
confusion matrix:
       0    1
0  18050   99
1    524  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.71898615, 'recall': 0.55288756, 'specificity': 0.55288756, 'f1': 0.5792371, 'auroc': 0.8044419, 'binary_precision': 0.47540984, 'binary_recall': 0.11111111, 'binary_specificity': 0.994664, 'binary_f1_score': 0.18012422}
confusion matrix:
      0   1
0  5965  32
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_26.png
early stop counter: 18
val acc:0.9668475985527039, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9619686603546143 / 0.9638862013816833
after epoch: 26,now: 2024-06-21 17:30:07.679074,epoch time: 0:09:38.235783,used: 6:06:52.505312,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99195206, 'precision': 0.98823285, 'recall': 0.96429944, 'specificity': 0.96429944, 'f1': 0.9758883, 'auroc': 0.9966785, 'binary_precision': 0.98370475, 'binary_recall': 0.9302062, 'binary_specificity': 0.9983927, 'binary_f1_score': 0.9562078}
confusion matrix:
       0     1
0  42239    68
1    308  4105
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.77087, 'recall': 0.57947206, 'specificity': 0.57947206, 'f1': 0.61857194, 'auroc': 0.82246566, 'binary_precision': 0.5706522, 'binary_recall': 0.16329704, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.25392985}
confusion matrix:
       0    1
0  18070   79
1    538  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.7174212, 'recall': 0.5473906, 'specificity': 0.5473906, 'f1': 0.5714588, 'auroc': 0.7953265, 'binary_precision': 0.47272727, 'binary_recall': 0.099616855, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.16455695}
confusion matrix:
      0   1
0  5968  29
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_27.png
early stop counter: 19
val acc:0.9671669006347656, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9619686603546143 / 0.9638862013816833
after epoch: 27,now: 2024-06-21 17:40:01.943717,epoch time: 0:09:54.264643,used: 6:16:46.769955,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99304366, 'precision': 0.9856882, 'recall': 0.97332525, 'specificity': 0.97332525, 'f1': 0.97940636, 'auroc': 0.9974545, 'binary_precision': 0.9766791, 'binary_recall': 0.94901425, 'binary_specificity': 0.9976363, 'binary_f1_score': 0.962648}
confusion matrix:
       0     1
0  42207   100
1    225  4188
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.7495824, 'recall': 0.6053934, 'specificity': 0.6053934, 'f1': 0.6454401, 'auroc': 0.8350844, 'binary_precision': 0.5263158, 'binary_recall': 0.21772939, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.3080308}
confusion matrix:
       0    1
0  18023  126
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95669544, 'precision': 0.69562054, 'recall': 0.5541363, 'specificity': 0.5541363, 'f1': 0.5795142, 'auroc': 0.80911577, 'binary_precision': 0.42857143, 'binary_recall': 0.11494253, 'binary_specificity': 0.99333, 'binary_f1_score': 0.18126889}
confusion matrix:
      0   1
0  5957  40
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_28.png
early stop counter: 20
val acc:0.9665282964706421, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9619686603546143 / 0.9638862013816833
after epoch: 28,now: 2024-06-21 17:49:35.835594,epoch time: 0:09:33.891877,used: 6:26:20.661832,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 28 with time: 6:26:20.661832 at 2024-06-21 17:49:35.835594
persisted model performance metric: 

scalar performance:
{'acc': 0.96196866, 'precision': 0.81154805, 'recall': 0.5898696, 'specificity': 0.5898696, 'f1': 0.6339441, 'auroc': 0.7807237, 'binary_precision': 0.65753424, 'binary_recall': 0.18390805, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.28742516}
confusion matrix:
      0   1
0  5972  25
1   213  48
oracle model performance metric: 

scalar performance:
{'acc': 0.9638862, 'precision': 0.85312897, 'recall': 0.60186416, 'specificity': 0.60186416, 'f1': 0.6524007, 'auroc': 0.7817113, 'binary_precision': 0.739726, 'binary_recall': 0.20689656, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.32335332}
confusion matrix:
      0   1
0  5978  19
1   207  54
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1730 MiB | 385915 GiB | 385914 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 385852 GiB | 385852 GiB |
|       from small pool |  36161 KiB |     72 MiB |     62 GiB |     62 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1730 MiB | 385915 GiB | 385914 GiB |
|       from large pool | 167936 KiB |   1660 MiB | 385852 GiB | 385852 GiB |
|       from small pool |  36161 KiB |     72 MiB |     62 GiB |     62 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1723 MiB | 385899 GiB | 385899 GiB |
|       from large pool | 165120 KiB |   1653 MiB | 385838 GiB | 385838 GiB |
|       from small pool |  35968 KiB |     71 MiB |     61 GiB |     61 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2270 MiB |   2270 MiB |   2270 MiB |      0 B   |
|       from large pool |   2196 MiB |   2196 MiB |   2196 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404158 KiB | 758032 KiB | 284425 GiB | 284425 GiB |
|       from large pool | 397312 KiB | 756864 KiB | 284362 GiB | 284361 GiB |
|       from small pool |   6846 KiB |  12716 KiB |     63 GiB |     63 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   10213 K  |   10212 K  |
|       from large pool |      36    |      76    |    4062 K  |    4062 K  |
|       from small pool |    1158    |    1780    |    6151 K  |    6149 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   10213 K  |   10212 K  |
|       from large pool |      36    |      76    |    4062 K  |    4062 K  |
|       from small pool |    1158    |    1780    |    6151 K  |    6149 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      27    |     378    |    5068 K  |    5068 K  |
|       from large pool |       5    |      10    |    1291 K  |    1291 K  |
|       from small pool |      22    |     373    |    3777 K  |    3777 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 385915 GiB | 385915 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 385852 GiB | 385852 GiB |
|       from small pool |      0 KiB |     72 MiB |     62 GiB |     62 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 385915 GiB | 385915 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 385852 GiB | 385852 GiB |
|       from small pool |      0 KiB |     72 MiB |     62 GiB |     62 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 385899 GiB | 385899 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 385838 GiB | 385838 GiB |
|       from small pool |      0 KiB |     71 MiB |     61 GiB |     61 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   2270 MiB |   2270 MiB |   1676 MiB |
|       from large pool | 565248 KiB |   2196 MiB |   2196 MiB |   1644 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 284425 GiB | 284425 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 284362 GiB | 284361 GiB |
|       from small pool |      0 KiB |  14441 KiB |     63 GiB |     63 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   10213 K  |   10213 K  |
|       from large pool |       2    |      76    |    4062 K  |    4062 K  |
|       from small pool |       0    |    1780    |    6151 K  |    6151 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   10213 K  |   10213 K  |
|       from large pool |       2    |      76    |    4062 K  |    4062 K  |
|       from small pool |       0    |    1780    |    6151 K  |    6151 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      51    |      21    |
|       from large pool |       9    |      14    |      14    |       5    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     378    |    5068 K  |    5068 K  |
|       from large pool |       1    |      11    |    1291 K  |    1291 K  |
|       from small pool |       0    |     373    |    3777 K  |    3777 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB | 385915 GiB | 385915 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 385852 GiB | 385852 GiB |
|       from small pool |      0 KiB |     72 MiB |     62 GiB |     62 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB | 385915 GiB | 385915 GiB |
|       from large pool |  16640 KiB |   1660 MiB | 385852 GiB | 385852 GiB |
|       from small pool |      0 KiB |     72 MiB |     62 GiB |     62 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB | 385899 GiB | 385899 GiB |
|       from large pool |  16640 KiB |   1653 MiB | 385838 GiB | 385838 GiB |
|       from small pool |      0 KiB |     71 MiB |     61 GiB |     61 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   2270 MiB |   2270 MiB |   1676 MiB |
|       from large pool | 565248 KiB |   2196 MiB |   2196 MiB |   1644 MiB |
|       from small pool |  43008 KiB |     74 MiB |     74 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB | 758032 KiB | 284425 GiB | 284425 GiB |
|       from large pool | 384768 KiB | 756864 KiB | 284362 GiB | 284361 GiB |
|       from small pool |      0 KiB |  14441 KiB |     63 GiB |     63 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   10213 K  |   10213 K  |
|       from large pool |       2    |      76    |    4062 K  |    4062 K  |
|       from small pool |       0    |    1780    |    6151 K  |    6151 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   10213 K  |   10213 K  |
|       from large pool |       2    |      76    |    4062 K  |    4062 K  |
|       from small pool |       0    |    1780    |    6151 K  |    6151 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      51    |      21    |
|       from large pool |       9    |      14    |      14    |       5    |
|       from small pool |      21    |      37    |      37    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     378    |    5068 K  |    5068 K  |
|       from large pool |       1    |      11    |    1291 K  |    1291 K  |
|       from small pool |       0    |     373    |    3777 K  |    3777 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822

 Experiment start at: 2024-06-21 17:54:10.195710
before training, model accuracy: 0.14631003141403198
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9379495, 'precision': 0.92259, 'recall': 0.6819116, 'specificity': 0.6819116, 'f1': 0.7449641, 'auroc': 0.9385883, 'binary_precision': 0.9059829, 'binary_recall': 0.3677151, 'binary_specificity': 0.9961081, 'binary_f1_score': 0.52311236}
confusion matrix:
       0     1
0  42231   165
1   2734  1590
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.52751446, 'recall': 0.50046617, 'specificity': 0.50046617, 'f1': 0.49219465, 'auroc': 0.5296205, 'binary_precision': 0.09090909, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.0029239766}
confusion matrix:
       0   1
0  18057  10
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.54193234, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 18:03:14.122631,epoch time: 0:09:03.926921,used: 0:09:03.926921,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9693279, 'precision': 0.97536886, 'recall': 0.83968973, 'specificity': 0.83968973, 'f1': 0.8937313, 'auroc': 0.96994376, 'binary_precision': 0.98229796, 'binary_recall': 0.6806295, 'binary_specificity': 0.99875, 'binary_f1_score': 0.80410117}
confusion matrix:
       0     1
0  42346    53
1   1380  2941
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.80982655, 'recall': 0.52476186, 'specificity': 0.52476186, 'f1': 0.53795904, 'auroc': 0.64431816, 'binary_precision': 0.65384614, 'binary_recall': 0.05052006, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.0937931}
confusion matrix:
       0   1
0  18049  18
1    639  34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.69355655, 'recall': 0.5054329, 'specificity': 0.5054329, 'f1': 0.5004908, 'auroc': 0.6900531, 'binary_precision': 0.42857143, 'binary_recall': 0.011538462, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.02247191}
confusion matrix:
      0  1
0  5942  4
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_2.png
better model found
persisted
after epoch: 2,now: 2024-06-21 18:13:06.794657,epoch time: 0:09:52.672026,used: 0:18:56.598947,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97564214, 'precision': 0.9808278, 'recall': 0.872874, 'specificity': 0.872874, 'f1': 0.91846395, 'auroc': 0.98011386, 'binary_precision': 0.9868582, 'binary_recall': 0.7467623, 'binary_specificity': 0.99898577, 'binary_f1_score': 0.8501844}
confusion matrix:
       0     1
0  42353    43
1   1095  3229
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.8060045, 'recall': 0.55530125, 'specificity': 0.55530125, 'f1': 0.5873726, 'auroc': 0.6878232, 'binary_precision': 0.6440678, 'binary_recall': 0.11292719, 'binary_specificity': 0.9976753, 'binary_f1_score': 0.19216181}
confusion matrix:
       0   1
0  18025  42
1    597  76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.8254007, 'recall': 0.53770477, 'specificity': 0.53770477, 'f1': 0.55893445, 'auroc': 0.7218932, 'binary_precision': 0.6896552, 'binary_recall': 0.07692308, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.13840832}
confusion matrix:
      0   1
0  5937   9
1   240  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-21 18:22:42.818775,epoch time: 0:09:36.024118,used: 0:28:32.623065,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9812286, 'precision': 0.9840005, 'recall': 0.9031953, 'specificity': 0.9031953, 'f1': 0.9390521, 'auroc': 0.9853414, 'binary_precision': 0.98726654, 'binary_recall': 0.80745196, 'binary_specificity': 0.9989387, 'binary_f1_score': 0.8883513}
confusion matrix:
       0     1
0  42354    45
1    832  3489
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.7978461, 'recall': 0.5719184, 'specificity': 0.5719184, 'f1': 0.6104976, 'auroc': 0.73540914, 'binary_precision': 0.62658226, 'binary_recall': 0.14710252, 'binary_specificity': 0.9967344, 'binary_f1_score': 0.23826714}
confusion matrix:
       0   1
0  18008  59
1    574  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.84631443, 'recall': 0.5662145, 'specificity': 0.5662145, 'f1': 0.6038049, 'auroc': 0.7718277, 'binary_precision': 0.7291667, 'binary_recall': 0.13461539, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.22727273}
confusion matrix:
      0   1
0  5933  13
1   225  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-21 18:32:32.558024,epoch time: 0:09:49.739249,used: 0:38:22.362314,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98450345, 'precision': 0.98256505, 'recall': 0.9239654, 'specificity': 0.9239654, 'f1': 0.9509132, 'auroc': 0.9895888, 'binary_precision': 0.98025614, 'binary_recall': 0.84967625, 'binary_specificity': 0.99825454, 'binary_f1_score': 0.9103072}
confusion matrix:
       0     1
0  42322    74
1    650  3674
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.79349875, 'recall': 0.5841887, 'specificity': 0.5841887, 'f1': 0.6261386, 'auroc': 0.7574048, 'binary_precision': 0.61702126, 'binary_recall': 0.17236255, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.26945412}
confusion matrix:
       0    1
0  17995   72
1    557  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.85304165, 'recall': 0.581431, 'specificity': 0.581431, 'f1': 0.6256286, 'auroc': 0.78366196, 'binary_precision': 0.7413793, 'binary_recall': 0.16538462, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.27044028}
confusion matrix:
      0   1
0  5931  15
1   217  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-21 18:42:34.999178,epoch time: 0:10:02.441154,used: 0:48:24.803468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9843964, 'precision': 0.98226583, 'recall': 0.92362976, 'specificity': 0.92362976, 'f1': 0.9505907, 'auroc': 0.9897948, 'binary_precision': 0.9797279, 'binary_recall': 0.84905225, 'binary_specificity': 0.9982073, 'binary_f1_score': 0.9097214}
confusion matrix:
       0     1
0  42318    76
1    653  3673
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.78962106, 'recall': 0.58919555, 'specificity': 0.58919555, 'f1': 0.6319797, 'auroc': 0.76267546, 'binary_precision': 0.6089109, 'binary_recall': 0.18276374, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.28114283}
confusion matrix:
       0    1
0  17988   79
1    550  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.8560306, 'recall': 0.5947243, 'specificity': 0.5947243, 'f1': 0.6435134, 'auroc': 0.78172123, 'binary_precision': 0.74626863, 'binary_recall': 0.1923077, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.3058104}
confusion matrix:
      0   1
0  5929  17
1   210  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_6.png
new oracle model saved
early stop counter: 1
val acc:0.966435432434082, best validation acc: 0.966435432434082, corresponding to test acc:                         0.9626168012619019 / 0.9634224772453308
after epoch: 6,now: 2024-06-21 18:53:02.698328,epoch time: 0:10:27.699150,used: 0:58:52.502618,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98595893, 'precision': 0.9808024, 'recall': 0.9342909, 'specificity': 0.9342909, 'f1': 0.9560746, 'auroc': 0.9907231, 'binary_precision': 0.9746246, 'binary_recall': 0.8708931, 'binary_specificity': 0.9976886, 'binary_f1_score': 0.9198437}
confusion matrix:
       0     1
0  42300    98
1    558  3764
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.77813137, 'recall': 0.5940364, 'specificity': 0.5940364, 'f1': 0.63657296, 'auroc': 0.761255, 'binary_precision': 0.5855856, 'binary_recall': 0.19316493, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.2905028}
confusion matrix:
       0    1
0  17975   92
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.82934576, 'recall': 0.601828, 'specificity': 0.601828, 'f1': 0.6502387, 'auroc': 0.76944196, 'binary_precision': 0.6923077, 'binary_recall': 0.20769231, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.3195266}
confusion matrix:
      0   1
0  5922  24
1   206  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_7.png
early stop counter: 2
val acc:0.9661152362823486, best validation acc: 0.966435432434082, corresponding to test acc:                         0.9626168012619019 / 0.9634224772453308
after epoch: 7,now: 2024-06-21 19:02:18.782355,epoch time: 0:09:16.084027,used: 1:08:08.586645,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98491013, 'precision': 0.98423916, 'recall': 0.92493355, 'specificity': 0.92493355, 'f1': 0.9521853, 'auroc': 0.9918933, 'binary_precision': 0.98344016, 'binary_recall': 0.8513295, 'binary_specificity': 0.99853754, 'binary_f1_score': 0.9126286}
confusion matrix:
       0     1
0  42333    62
1    643  3682
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.80673087, 'recall': 0.5814937, 'specificity': 0.5814937, 'f1': 0.62372816, 'auroc': 0.7747342, 'binary_precision': 0.6436782, 'binary_recall': 0.16641901, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.2644628}
confusion matrix:
       0    1
0  18005   62
1    561  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.8457531, 'recall': 0.5756617, 'specificity': 0.5756617, 'f1': 0.617271, 'auroc': 0.7872623, 'binary_precision': 0.72727275, 'binary_recall': 0.15384616, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.25396827}
confusion matrix:
      0   1
0  5931  15
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_8.png
better model found
persisted
after epoch: 8,now: 2024-06-21 19:13:27.375500,epoch time: 0:11:08.593145,used: 1:19:17.179790,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98743576, 'precision': 0.9834842, 'recall': 0.94075525, 'specificity': 0.94075525, 'f1': 0.9608891, 'auroc': 0.9925085, 'binary_precision': 0.97873974, 'binary_recall': 0.8834682, 'binary_specificity': 0.9980422, 'binary_f1_score': 0.9286669}
confusion matrix:
       0     1
0  42312    83
1    504  3821
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.8009001, 'recall': 0.58358413, 'specificity': 0.58358413, 'f1': 0.6259705, 'auroc': 0.78423667, 'binary_precision': 0.6318681, 'binary_recall': 0.17087667, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.26900584}
confusion matrix:
       0    1
0  18000   67
1    558  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.8372606, 'recall': 0.58310175, 'specificity': 0.58310175, 'f1': 0.62696856, 'auroc': 0.79804003, 'binary_precision': 0.7096774, 'binary_recall': 0.16923077, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.27329195}
confusion matrix:
      0   1
0  5928  18
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_9.png
early stop counter: 1
val acc:0.9666488766670227, best validation acc: 0.9667556285858154, corresponding to test acc:                         0.9621334075927734 / 0.9634224772453308
after epoch: 9,now: 2024-06-21 19:23:21.881692,epoch time: 0:09:54.506192,used: 1:29:11.685982,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9885702, 'precision': 0.9830407, 'recall': 0.94802433, 'specificity': 0.94802433, 'f1': 0.9647107, 'auroc': 0.9927372, 'binary_precision': 0.976376, 'binary_recall': 0.8982659, 'binary_specificity': 0.99778277, 'binary_f1_score': 0.9356937}
confusion matrix:
       0     1
0  42301    94
1    440  3885
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.78605604, 'recall': 0.5855085, 'specificity': 0.5855085, 'f1': 0.6271433, 'auroc': 0.78784966, 'binary_precision': 0.6020408, 'binary_recall': 0.17533432, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.27157652}
confusion matrix:
       0    1
0  17989   78
1    555  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.81148356, 'recall': 0.59020543, 'specificity': 0.59020543, 'f1': 0.6343337, 'auroc': 0.7993569, 'binary_precision': 0.65753424, 'binary_recall': 0.18461539, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.2882883}
confusion matrix:
      0   1
0  5921  25
1   212  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_10.png
early stop counter: 2
val acc:0.9662219882011414, best validation acc: 0.9667556285858154, corresponding to test acc:                         0.9621334075927734 / 0.9634224772453308
after epoch: 10,now: 2024-06-21 19:36:06.889067,epoch time: 0:12:45.007375,used: 1:41:56.693357,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9883776, 'precision': 0.98344576, 'recall': 0.9464284, 'specificity': 0.9464284, 'f1': 0.9640181, 'auroc': 0.99426734, 'binary_precision': 0.9775082, 'binary_recall': 0.89495605, 'binary_specificity': 0.99790084, 'binary_f1_score': 0.93441236}
confusion matrix:
       0     1
0  42309    89
1    454  3868
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.7998424, 'recall': 0.57194614, 'specificity': 0.57194614, 'f1': 0.610655, 'auroc': 0.7882664, 'binary_precision': 0.6305733, 'binary_recall': 0.14710252, 'binary_specificity': 0.99678975, 'binary_f1_score': 0.23855421}
confusion matrix:
       0   1
0  18009  58
1    574  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8244684, 'recall': 0.5697243, 'specificity': 0.5697243, 'f1': 0.6079154, 'auroc': 0.7964422, 'binary_precision': 0.6851852, 'binary_recall': 0.1423077, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.2356688}
confusion matrix:
      0   1
0  5929  17
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_11.png
early stop counter: 3
val acc:0.9662753343582153, best validation acc: 0.9667556285858154, corresponding to test acc:                         0.9621334075927734 / 0.9634224772453308
after epoch: 11,now: 2024-06-21 19:48:51.279854,epoch time: 0:12:44.390787,used: 1:54:41.084144,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98878425, 'precision': 0.9861419, 'recall': 0.9463531, 'specificity': 0.9463531, 'f1': 0.9651898, 'auroc': 0.99356794, 'binary_precision': 0.98296463, 'binary_recall': 0.8942864, 'binary_specificity': 0.9984197, 'binary_f1_score': 0.936531}
confusion matrix:
       0     1
0  42330    67
1    457  3866
---- Validation: 
scalar performance:
{'acc': 0.96707577, 'precision': 0.8172748, 'recall': 0.582375, 'specificity': 0.582375, 'f1': 0.6256246, 'auroc': 0.7928504, 'binary_precision': 0.6647059, 'binary_recall': 0.1679049, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.26809016}
confusion matrix:
       0    1
0  18010   57
1    560  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8182365, 'recall': 0.5696402, 'specificity': 0.5696402, 'f1': 0.6074992, 'auroc': 0.785177, 'binary_precision': 0.6727273, 'binary_recall': 0.1423077, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.23492064}
confusion matrix:
      0   1
0  5928  18
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_12.png
better model found
persisted
after epoch: 12,now: 2024-06-21 20:01:25.180840,epoch time: 0:12:33.900986,used: 2:07:14.985130,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98882705, 'precision': 0.9837563, 'recall': 0.9488926, 'specificity': 0.9488926, 'f1': 0.9655112, 'auroc': 0.9936893, 'binary_precision': 0.9776438, 'binary_recall': 0.8998844, 'binary_specificity': 0.9979007, 'binary_f1_score': 0.9371539}
confusion matrix:
       0     1
0  42306    89
1    433  3892
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.79408616, 'recall': 0.5994307, 'specificity': 0.5994307, 'f1': 0.64458555, 'auroc': 0.8050524, 'binary_precision': 0.6171171, 'binary_recall': 0.20356612, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.30614525}
confusion matrix:
       0    1
0  17982   85
1    536  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.79391456, 'recall': 0.58050597, 'specificity': 0.58050597, 'f1': 0.6206436, 'auroc': 0.7941098, 'binary_precision': 0.6231884, 'binary_recall': 0.16538462, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.26139817}
confusion matrix:
      0   1
0  5920  26
1   217  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_13.png
early stop counter: 1
val acc:0.9668623208999634, best validation acc: 0.967075765132904, corresponding to test acc:                         0.9611666202545166 / 0.9634224772453308
after epoch: 13,now: 2024-06-21 20:12:41.038905,epoch time: 0:11:15.858065,used: 2:18:30.843195,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.990625, 'precision': 0.9861337, 'recall': 0.95745194, 'specificity': 0.95745194, 'f1': 0.9712484, 'auroc': 0.9957253, 'binary_precision': 0.98070264, 'binary_recall': 0.91674376, 'binary_specificity': 0.9981602, 'binary_f1_score': 0.94764525}
confusion matrix:
       0     1
0  42318    78
1    360  3964
---- Validation: 
scalar performance:
{'acc': 0.96723586, 'precision': 0.8080407, 'recall': 0.5953328, 'specificity': 0.5953328, 'f1': 0.6411563, 'auroc': 0.81537753, 'binary_precision': 0.6453202, 'binary_recall': 0.19465081, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.29908675}
confusion matrix:
       0    1
0  17995   72
1    542  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.8182462, 'recall': 0.57716435, 'specificity': 0.57716435, 'f1': 0.6178425, 'auroc': 0.8079971, 'binary_precision': 0.6721311, 'binary_recall': 0.15769231, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.2554517}
confusion matrix:
      0   1
0  5926  20
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_14.png
better model found
persisted
after epoch: 14,now: 2024-06-21 20:24:15.536726,epoch time: 0:11:34.497821,used: 2:30:05.341016,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99019694, 'precision': 0.9852077, 'recall': 0.9557624, 'specificity': 0.9557624, 'f1': 0.96990955, 'auroc': 0.9944304, 'binary_precision': 0.979177, 'binary_recall': 0.91350603, 'binary_specificity': 0.9980187, 'binary_f1_score': 0.94520223}
confusion matrix:
       0     1
0  42312    84
1    374  3950
---- Validation: 
scalar performance:
{'acc': 0.96750265, 'precision': 0.8090332, 'recall': 0.6026239, 'specificity': 0.6026239, 'f1': 0.649927, 'auroc': 0.82099974, 'binary_precision': 0.646789, 'binary_recall': 0.20950966, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.3164983}
confusion matrix:
       0    1
0  17990   77
1    532  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.8008295, 'recall': 0.5693879, 'specificity': 0.5693879, 'f1': 0.6062646, 'auroc': 0.810643, 'binary_precision': 0.63793105, 'binary_recall': 0.1423077, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.23270442}
confusion matrix:
      0   1
0  5925  21
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_15.png
better model found
persisted
after epoch: 15,now: 2024-06-21 20:33:30.089698,epoch time: 0:09:14.552972,used: 2:39:19.893988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9903467, 'precision': 0.98402214, 'recall': 0.9577894, 'specificity': 0.9577894, 'f1': 0.9704492, 'auroc': 0.99632794, 'binary_precision': 0.97636634, 'binary_recall': 0.9178431, 'binary_specificity': 0.9977358, 'binary_f1_score': 0.9462007}
confusion matrix:
       0     1
0  42303    96
1    355  3966
---- Validation: 
scalar performance:
{'acc': 0.9669691, 'precision': 0.7903213, 'recall': 0.6094998, 'specificity': 0.6094998, 'f1': 0.65548646, 'auroc': 0.82782435, 'binary_precision': 0.608871, 'binary_recall': 0.2243685, 'binary_specificity': 0.9946311, 'binary_f1_score': 0.32790443}
confusion matrix:
       0    1
0  17970   97
1    522  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.79153585, 'recall': 0.57298183, 'specificity': 0.57298183, 'f1': 0.6106099, 'auroc': 0.8165314, 'binary_precision': 0.61904764, 'binary_recall': 0.15, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.24148609}
confusion matrix:
      0   1
0  5922  24
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_16.png
early stop counter: 1
val acc:0.9669690728187561, best validation acc: 0.9675026535987854, corresponding to test acc:                         0.9606832265853882 / 0.9634224772453308
after epoch: 16,now: 2024-06-21 20:47:05.070596,epoch time: 0:13:34.980898,used: 2:52:54.874886,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.990518, 'precision': 0.98649263, 'recall': 0.9564486, 'specificity': 0.9564486, 'f1': 0.97087306, 'auroc': 0.99599874, 'binary_precision': 0.9816286, 'binary_recall': 0.91464263, 'binary_specificity': 0.9982546, 'binary_f1_score': 0.94695246}
confusion matrix:
       0     1
0  42323    74
1    369  3954
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.8032516, 'recall': 0.5865282, 'specificity': 0.5865282, 'f1': 0.6298795, 'auroc': 0.82661355, 'binary_precision': 0.6363636, 'binary_recall': 0.1768202, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.2767442}
confusion matrix:
       0    1
0  17999   68
1    554  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.8293196, 'recall': 0.5603612, 'specificity': 0.5603612, 'f1': 0.5945801, 'auroc': 0.8232205, 'binary_precision': 0.6956522, 'binary_recall': 0.12307692, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.20915034}
confusion matrix:
      0   1
0  5932  14
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_17.png
early stop counter: 2
val acc:0.9668089747428894, best validation acc: 0.9675026535987854, corresponding to test acc:                         0.9606832265853882 / 0.9634224772453308
after epoch: 17,now: 2024-06-21 20:57:15.698250,epoch time: 0:10:10.627654,used: 3:03:05.502540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9910959, 'precision': 0.98740536, 'recall': 0.9590521, 'specificity': 0.9590521, 'f1': 0.97269845, 'auroc': 0.99550164, 'binary_precision': 0.9829419, 'binary_recall': 0.9197317, 'binary_specificity': 0.99837255, 'binary_f1_score': 0.95028687}
confusion matrix:
       0     1
0  42328    69
1    347  3976
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.79353005, 'recall': 0.57621, 'specificity': 0.57621, 'f1': 0.6159163, 'auroc': 0.8168812, 'binary_precision': 0.61764705, 'binary_recall': 0.15601783, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.2491103}
confusion matrix:
       0    1
0  18002   65
1    568  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.7897576, 'recall': 0.5542556, 'specificity': 0.5542556, 'f1': 0.5841775, 'auroc': 0.79556876, 'binary_precision': 0.61702126, 'binary_recall': 0.11153846, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.18892507}
confusion matrix:
      0   1
0  5928  18
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_18.png
early stop counter: 3
val acc:0.9662219882011414, best validation acc: 0.9675026535987854, corresponding to test acc:                         0.9606832265853882 / 0.9634224772453308
after epoch: 18,now: 2024-06-21 21:07:23.892255,epoch time: 0:10:08.194005,used: 3:13:13.696545,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9915882, 'precision': 0.9875109, 'recall': 0.9619372, 'specificity': 0.9619372, 'f1': 0.9742937, 'auroc': 0.9967145, 'binary_precision': 0.98257244, 'binary_recall': 0.92554915, 'binary_specificity': 0.9983253, 'binary_f1_score': 0.9532087}
confusion matrix:
       0     1
0  42324    71
1    322  4003
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.79697376, 'recall': 0.5878757, 'specificity': 0.5878757, 'f1': 0.6310265, 'auroc': 0.82581156, 'binary_precision': 0.62371135, 'binary_recall': 0.17979197, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.2791234}
confusion matrix:
       0    1
0  17994   73
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.78531885, 'recall': 0.55793357, 'specificity': 0.55793357, 'f1': 0.58939004, 'auroc': 0.81160927, 'binary_precision': 0.60784316, 'binary_recall': 0.11923077, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.19935693}
confusion matrix:
      0   1
0  5926  20
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_19.png
early stop counter: 4
val acc:0.9666488766670227, best validation acc: 0.9675026535987854, corresponding to test acc:                         0.9606832265853882 / 0.9634224772453308
after epoch: 19,now: 2024-06-21 21:16:45.159530,epoch time: 0:09:21.267275,used: 3:22:34.963820,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99088186, 'precision': 0.98556006, 'recall': 0.95958465, 'specificity': 0.95958465, 'f1': 0.9721262, 'auroc': 0.9967351, 'binary_precision': 0.9791155, 'binary_recall': 0.9211743, 'binary_specificity': 0.997995, 'binary_f1_score': 0.94926155}
confusion matrix:
       0     1
0  42309    85
1    341  3985
---- Validation: 
scalar performance:
{'acc': 0.9671825, 'precision': 0.80713654, 'recall': 0.5945899, 'specificity': 0.5945899, 'f1': 0.64017093, 'auroc': 0.82898325, 'binary_precision': 0.64356434, 'binary_recall': 0.19316493, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.29714286}
confusion matrix:
       0    1
0  17995   72
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.8014815, 'recall': 0.56002486, 'specificity': 0.56002486, 'f1': 0.5930622, 'auroc': 0.8076352, 'binary_precision': 0.64, 'binary_recall': 0.12307692, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.20645161}
confusion matrix:
      0   1
0  5928  18
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_20.png
early stop counter: 5
val acc:0.9671825170516968, best validation acc: 0.9675026535987854, corresponding to test acc:                         0.9606832265853882 / 0.9634224772453308
after epoch: 20,now: 2024-06-21 21:25:45.493286,epoch time: 0:09:00.333756,used: 3:31:35.297576,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9910959, 'precision': 0.9864416, 'recall': 0.95999587, 'specificity': 0.95999587, 'f1': 0.9727571, 'auroc': 0.99676526, 'binary_precision': 0.98080707, 'binary_recall': 0.9218316, 'binary_specificity': 0.9981602, 'binary_f1_score': 0.95040536}
confusion matrix:
       0     1
0  42318    78
1    338  3986
---- Validation: 
scalar performance:
{'acc': 0.96707577, 'precision': 0.7975794, 'recall': 0.60240245, 'specificity': 0.60240245, 'f1': 0.6484076, 'auroc': 0.8339654, 'binary_precision': 0.6238938, 'binary_recall': 0.20950966, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.31368187}
confusion matrix:
       0    1
0  17982   85
1    532  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.7720934, 'recall': 0.56704444, 'specificity': 0.56704444, 'f1': 0.6014621, 'auroc': 0.82279634, 'binary_precision': 0.58064514, 'binary_recall': 0.13846155, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.2236025}
confusion matrix:
      0   1
0  5920  26
1   224  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_21.png
early stop counter: 6
val acc:0.967075765132904, best validation acc: 0.9675026535987854, corresponding to test acc:                         0.9606832265853882 / 0.9634224772453308
after epoch: 21,now: 2024-06-21 21:35:07.705647,epoch time: 0:09:22.212361,used: 3:40:57.509937,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9915882, 'precision': 0.987723, 'recall': 0.96172094, 'specificity': 0.96172094, 'f1': 0.97427714, 'auroc': 0.99625325, 'binary_precision': 0.98304254, 'binary_recall': 0.9250694, 'binary_specificity': 0.9983725, 'binary_f1_score': 0.9531753}
confusion matrix:
       0     1
0  42327    69
1    324  4000
---- Validation: 
scalar performance:
{'acc': 0.9669691, 'precision': 0.8069314, 'recall': 0.5880418, 'specificity': 0.5880418, 'f1': 0.63208234, 'auroc': 0.83224916, 'binary_precision': 0.64361703, 'binary_recall': 0.17979197, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.2810685}
confusion matrix:
       0    1
0  18000   67
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.84016454, 'recall': 0.5529212, 'specificity': 0.5529212, 'f1': 0.58361495, 'auroc': 0.81466675, 'binary_precision': 0.71794873, 'binary_recall': 0.10769231, 'binary_specificity': 0.99815, 'binary_f1_score': 0.18729098}
confusion matrix:
      0   1
0  5935  11
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_22.png
early stop counter: 7
val acc:0.9669690728187561, best validation acc: 0.9675026535987854, corresponding to test acc:                         0.9606832265853882 / 0.9634224772453308
after epoch: 22,now: 2024-06-21 21:44:09.850078,epoch time: 0:09:02.144431,used: 3:49:59.654368,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9921233, 'precision': 0.9873235, 'recall': 0.9653387, 'specificity': 0.9653387, 'f1': 0.97601384, 'auroc': 0.9972327, 'binary_precision': 0.9814995, 'binary_recall': 0.93246996, 'binary_specificity': 0.9982074, 'binary_f1_score': 0.9563567}
confusion matrix:
       0     1
0  42320    76
1    292  4032
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.80088377, 'recall': 0.5872158, 'specificity': 0.5872158, 'f1': 0.6305428, 'auroc': 0.83717245, 'binary_precision': 0.6315789, 'binary_recall': 0.17830609, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.27809963}
confusion matrix:
       0    1
0  17997   70
1    553  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7697745, 'recall': 0.55584234, 'specificity': 0.55584234, 'f1': 0.5857406, 'auroc': 0.81921655, 'binary_precision': 0.5769231, 'binary_recall': 0.115384616, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.19230768}
confusion matrix:
      0   1
0  5924  22
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_23.png
early stop counter: 8
val acc:0.9667556285858154, best validation acc: 0.9675026535987854, corresponding to test acc:                         0.9606832265853882 / 0.9634224772453308
after epoch: 23,now: 2024-06-21 21:53:19.574547,epoch time: 0:09:09.724469,used: 3:59:09.378837,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9927654, 'precision': 0.98444426, 'recall': 0.97213054, 'specificity': 0.97213054, 'f1': 0.97818804, 'auroc': 0.9974711, 'binary_precision': 0.97429794, 'binary_recall': 0.9468085, 'binary_specificity': 0.9974526, 'binary_f1_score': 0.9603566}
confusion matrix:
       0     1
0  42288   108
1    230  4094
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7819409, 'recall': 0.61436826, 'specificity': 0.61436826, 'f1': 0.6595465, 'auroc': 0.8454851, 'binary_precision': 0.5917603, 'binary_recall': 0.23476969, 'binary_specificity': 0.9939669, 'binary_f1_score': 0.3361702}
confusion matrix:
       0    1
0  17958  109
1    515  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.7261613, 'recall': 0.57523024, 'specificity': 0.57523024, 'f1': 0.60833085, 'auroc': 0.82717615, 'binary_precision': 0.48809522, 'binary_recall': 0.15769231, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.23837209}
confusion matrix:
      0   1
0  5903  43
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_24.png
early stop counter: 9
val acc:0.9667022228240967, best validation acc: 0.9675026535987854, corresponding to test acc:                         0.9606832265853882 / 0.9634224772453308
after epoch: 24,now: 2024-06-21 22:02:29.918469,epoch time: 0:09:10.343922,used: 4:08:19.722759,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99203765, 'precision': 0.9861115, 'recall': 0.9660184, 'specificity': 0.9660184, 'f1': 0.9757997, 'auroc': 0.9967946, 'binary_precision': 0.9789142, 'binary_recall': 0.9340888, 'binary_specificity': 0.99794793, 'binary_f1_score': 0.95597637}
confusion matrix:
       0     1
0  42309    87
1    285  4039
---- Validation: 
scalar performance:
{'acc': 0.9671291, 'precision': 0.7984341, 'recall': 0.6031454, 'specificity': 0.6031454, 'f1': 0.64935786, 'auroc': 0.8443839, 'binary_precision': 0.6255507, 'binary_recall': 0.21099554, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.31555554}
confusion matrix:
       0    1
0  17982   85
1    531  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7710154, 'recall': 0.5614434, 'specificity': 0.5614434, 'f1': 0.5937248, 'auroc': 0.81695276, 'binary_precision': 0.57894737, 'binary_recall': 0.12692308, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.2082019}
confusion matrix:
      0   1
0  5922  24
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_25.png
early stop counter: 10
val acc:0.967129111289978, best validation acc: 0.9675026535987854, corresponding to test acc:                         0.9606832265853882 / 0.9634224772453308
after epoch: 25,now: 2024-06-21 22:11:32.645615,epoch time: 0:09:02.727146,used: 4:17:22.449905,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9921661, 'precision': 0.98884255, 'recall': 0.96412426, 'specificity': 0.96412426, 'f1': 0.9760829, 'auroc': 0.99743354, 'binary_precision': 0.98481506, 'binary_recall': 0.929711, 'binary_specificity': 0.99853754, 'binary_f1_score': 0.9564701}
confusion matrix:
       0     1
0  42333    62
1    304  4021
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.7988718, 'recall': 0.5857299, 'specificity': 0.5857299, 'f1': 0.6285161, 'auroc': 0.83386993, 'binary_precision': 0.62765956, 'binary_recall': 0.17533432, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.27409986}
confusion matrix:
       0    1
0  17997   70
1    555  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.7425991, 'recall': 0.5406259, 'specificity': 0.5406259, 'f1': 0.5621953, 'auroc': 0.80994916, 'binary_precision': 0.52380955, 'binary_recall': 0.08461539, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.14569537}
confusion matrix:
      0   1
0  5926  20
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_26.png
early stop counter: 11
val acc:0.9666488766670227, best validation acc: 0.9675026535987854, corresponding to test acc:                         0.9606832265853882 / 0.9634224772453308
after epoch: 26,now: 2024-06-21 22:20:35.520979,epoch time: 0:09:02.875364,used: 4:26:25.325269,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9914383, 'precision': 0.9871984, 'recall': 0.96132684, 'specificity': 0.96132684, 'f1': 0.97382176, 'auroc': 0.99641854, 'binary_precision': 0.9820639, 'binary_recall': 0.9243756, 'binary_specificity': 0.99827814, 'binary_f1_score': 0.9523469}
confusion matrix:
       0     1
0  42323    73
1    327  3997
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.79763323, 'recall': 0.5965973, 'specificity': 0.5965973, 'f1': 0.6416415, 'auroc': 0.8414706, 'binary_precision': 0.62441313, 'binary_recall': 0.19762258, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.3002257}
confusion matrix:
       0    1
0  17987   80
1    540  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7660215, 'recall': 0.5613593, 'specificity': 0.5613593, 'f1': 0.5933552, 'auroc': 0.8227603, 'binary_precision': 0.5689655, 'binary_recall': 0.12692308, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.20754719}
confusion matrix:
      0   1
0  5921  25
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_27.png
early stop counter: 12
val acc:0.9669156670570374, best validation acc: 0.9675026535987854, corresponding to test acc:                         0.9606832265853882 / 0.9634224772453308
after epoch: 27,now: 2024-06-21 22:29:30.713528,epoch time: 0:08:55.192549,used: 4:35:20.517818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.991524, 'precision': 0.9871491, 'recall': 0.96190184, 'specificity': 0.96190184, 'f1': 0.97410583, 'auroc': 0.9971198, 'binary_precision': 0.9818494, 'binary_recall': 0.92554915, 'binary_specificity': 0.99825454, 'binary_f1_score': 0.9528684}
confusion matrix:
       0     1
0  42321    74
1    322  4003
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.79051006, 'recall': 0.5942854, 'specificity': 0.5942854, 'f1': 0.6381736, 'auroc': 0.83954644, 'binary_precision': 0.6103286, 'binary_recall': 0.19316493, 'binary_specificity': 0.995406, 'binary_f1_score': 0.29345372}
confusion matrix:
       0    1
0  17984   83
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.74342847, 'recall': 0.56093884, 'specificity': 0.56093884, 'f1': 0.5915377, 'auroc': 0.8199638, 'binary_precision': 0.52380955, 'binary_recall': 0.12692308, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.2043344}
confusion matrix:
      0   1
0  5916  30
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_28.png
early stop counter: 13
val acc:0.9665955305099487, best validation acc: 0.9675026535987854, corresponding to test acc:                         0.9606832265853882 / 0.9634224772453308
after epoch: 28,now: 2024-06-21 22:38:27.411944,epoch time: 0:08:56.698416,used: 4:44:17.216234,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9933433, 'precision': 0.9904347, 'recall': 0.969659, 'specificity': 0.969659, 'f1': 0.97976583, 'auroc': 0.9967091, 'binary_precision': 0.9869027, 'binary_recall': 0.94059175, 'binary_specificity': 0.99872625, 'binary_f1_score': 0.96319085}
confusion matrix:
       0     1
0  42340    54
1    257  4069
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.8030719, 'recall': 0.5814383, 'specificity': 0.5814383, 'f1': 0.6233889, 'auroc': 0.8347834, 'binary_precision': 0.6363636, 'binary_recall': 0.16641901, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.2638398}
confusion matrix:
       0    1
0  18003   64
1    561  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7378932, 'recall': 0.53134686, 'specificity': 0.53134686, 'f1': 0.54733473, 'auroc': 0.8025075, 'binary_precision': 0.5151515, 'binary_recall': 0.06538462, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.11604095}
confusion matrix:
      0   1
0  5930  16
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_29.png
early stop counter: 14
val acc:0.9666488766670227, best validation acc: 0.9675026535987854, corresponding to test acc:                         0.9606832265853882 / 0.9634224772453308
after epoch: 29,now: 2024-06-21 22:47:26.573333,epoch time: 0:08:59.161389,used: 4:53:16.377623,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9922731, 'precision': 0.98795354, 'recall': 0.96564436, 'specificity': 0.96564436, 'f1': 0.9764726, 'auroc': 0.99736774, 'binary_precision': 0.98271245, 'binary_recall': 0.9329635, 'binary_specificity': 0.9983252, 'binary_f1_score': 0.957192}
confusion matrix:
       0     1
0  42323    71
1    290  4036
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.8002238, 'recall': 0.5879311, 'specificity': 0.5879311, 'f1': 0.631377, 'auroc': 0.84218615, 'binary_precision': 0.6302083, 'binary_recall': 0.17979197, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.27976876}
confusion matrix:
       0    1
0  17996   71
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.7251294, 'recall': 0.5403736, 'specificity': 0.5403736, 'f1': 0.56135225, 'auroc': 0.8119269, 'binary_precision': 0.4888889, 'binary_recall': 0.08461539, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.1442623}
confusion matrix:
      0   1
0  5923  23
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_30.png
early stop counter: 15
val acc:0.9667556285858154, best validation acc: 0.9675026535987854, corresponding to test acc:                         0.9606832265853882 / 0.9634224772453308
after epoch: 30,now: 2024-06-21 22:56:23.945179,epoch time: 0:08:57.371846,used: 5:02:13.749469,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_17_54_10_seed_1_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:02:13.749469 at 2024-06-21 22:56:23.945179
persisted model performance metric: 

scalar performance:
{'acc': 0.9606832, 'precision': 0.8008295, 'recall': 0.5693879, 'specificity': 0.5693879, 'f1': 0.6062646, 'auroc': 0.810643, 'binary_precision': 0.63793105, 'binary_recall': 0.1423077, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.23270442}
confusion matrix:
      0   1
0  5925  21
1   223  37
oracle model performance metric: 

scalar performance:
{'acc': 0.9634225, 'precision': 0.8560306, 'recall': 0.5947243, 'specificity': 0.5947243, 'f1': 0.6435134, 'auroc': 0.78172123, 'binary_precision': 0.74626863, 'binary_recall': 0.1923077, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.3058104}
confusion matrix:
      0   1
0  5929  17
1   210  50
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204094 KiB |   1730 MiB |    780 TiB |    780 TiB |
|       from large pool | 167936 KiB |   1660 MiB |    779 TiB |    779 TiB |
|       from small pool |  36158 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204094 KiB |   1730 MiB |    780 TiB |    780 TiB |
|       from large pool | 167936 KiB |   1660 MiB |    779 TiB |    779 TiB |
|       from small pool |  36158 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1723 MiB |    780 TiB |    780 TiB |
|       from large pool | 165120 KiB |   1653 MiB |    779 TiB |    779 TiB |
|       from small pool |  35966 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2196 MiB |   2270 MiB |   3872 MiB |   1676 MiB |
|       from large pool |   2122 MiB |   2196 MiB |   3766 MiB |   1644 MiB |
|       from small pool |     74 MiB |     74 MiB |    106 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404161 KiB |    900 MiB | 611444 GiB | 611444 GiB |
|       from large pool | 397312 KiB |    899 MiB | 611313 GiB | 611312 GiB |
|       from small pool |   6849 KiB |     14 MiB |    131 GiB |    131 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   21154 K  |   21153 K  |
|       from large pool |      36    |      76    |    8413 K  |    8413 K  |
|       from small pool |    1158    |    1780    |   12741 K  |   12739 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   21154 K  |   21153 K  |
|       from large pool |      36    |      76    |    8413 K  |    8413 K  |
|       from small pool |    1158    |    1780    |   12741 K  |   12739 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      51    |      71    |      21    |
|       from large pool |      13    |      14    |      18    |       5    |
|       from small pool |      37    |      37    |      53    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |     380    |   10803 K  |   10803 K  |
|       from large pool |       5    |      11    |    2819 K  |    2819 K  |
|       from small pool |      29    |     375    |    7983 K  |    7983 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |    780 TiB |    780 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    779 TiB |    779 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |    780 TiB |    780 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    779 TiB |    779 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |    780 TiB |    780 TiB |
|       from large pool |  16640 KiB |   1653 MiB |    779 TiB |    779 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   2270 MiB |   3872 MiB |   3278 MiB |
|       from large pool | 565248 KiB |   2196 MiB |   3766 MiB |   3214 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 611444 GiB | 611444 GiB |
|       from large pool | 384768 KiB |    899 MiB | 611313 GiB | 611313 GiB |
|       from small pool |      0 KiB |     14 MiB |    131 GiB |    131 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   21154 K  |   21154 K  |
|       from large pool |       2    |      76    |    8413 K  |    8413 K  |
|       from small pool |       0    |    1780    |   12741 K  |   12741 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   21154 K  |   21154 K  |
|       from large pool |       2    |      76    |    8413 K  |    8413 K  |
|       from small pool |       0    |    1780    |   12741 K  |   12741 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      71    |      41    |
|       from large pool |       9    |      14    |      18    |       9    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   10803 K  |   10803 K  |
|       from large pool |       1    |      11    |    2819 K  |    2819 K  |
|       from small pool |       0    |     375    |    7983 K  |    7983 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |    780 TiB |    780 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    779 TiB |    779 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |    780 TiB |    780 TiB |
|       from large pool |  16640 KiB |   1660 MiB |    779 TiB |    779 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |    780 TiB |    780 TiB |
|       from large pool |  16640 KiB |   1653 MiB |    779 TiB |    779 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   2270 MiB |   3872 MiB |   3278 MiB |
|       from large pool | 565248 KiB |   2196 MiB |   3766 MiB |   3214 MiB |
|       from small pool |  43008 KiB |     74 MiB |    106 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB | 611444 GiB | 611444 GiB |
|       from large pool | 384768 KiB |    899 MiB | 611313 GiB | 611313 GiB |
|       from small pool |      0 KiB |     14 MiB |    131 GiB |    131 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   21154 K  |   21154 K  |
|       from large pool |       2    |      76    |    8413 K  |    8413 K  |
|       from small pool |       0    |    1780    |   12741 K  |   12741 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   21154 K  |   21154 K  |
|       from large pool |       2    |      76    |    8413 K  |    8413 K  |
|       from small pool |       0    |    1780    |   12741 K  |   12741 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      71    |      41    |
|       from large pool |       9    |      14    |      18    |       9    |
|       from small pool |      21    |      37    |      53    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   10803 K  |   10803 K  |
|       from large pool |       1    |      11    |    2819 K  |    2819 K  |
|       from small pool |       0    |     375    |    7983 K  |    7983 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822

 Experiment start at: 2024-06-21 23:01:32.957411
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94458675, 'precision': 0.9660119, 'recall': 0.716099, 'specificity': 0.716099, 'f1': 0.7861522, 'auroc': 0.94367397, 'binary_precision': 0.98942065, 'binary_recall': 0.43269444, 'binary_specificity': 0.9995037, 'binary_f1_score': 0.6020846}
confusion matrix:
       0     1
0  42288    21
1   2575  1964
---- Validation: 
scalar performance:
{'acc': 0.9673467, 'precision': 0.48395693, 'recall': 0.49969733, 'specificity': 0.49969733, 'f1': 0.4917012, 'auroc': 0.53268063, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18160  11
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.5635332, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 23:11:23.682171,epoch time: 0:09:50.724760,used: 0:09:50.724760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96708506, 'precision': 0.97843, 'recall': 0.8326956, 'specificity': 0.8326956, 'f1': 0.88943833, 'auroc': 0.9738545, 'binary_precision': 0.9914726, 'binary_recall': 0.66600573, 'binary_specificity': 0.9993855, 'binary_f1_score': 0.7967844}
confusion matrix:
       0     1
0  42283    26
1   1516  3023
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.77178514, 'recall': 0.52511466, 'specificity': 0.52511466, 'f1': 0.53920513, 'auroc': 0.64635944, 'binary_precision': 0.5740741, 'binary_recall': 0.051495016, 'binary_specificity': 0.99873424, 'binary_f1_score': 0.094512194}
confusion matrix:
       0   1
0  18148  23
1    571  31
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.71811223, 'recall': 0.5177613, 'specificity': 0.5177613, 'f1': 0.5245376, 'auroc': 0.67199695, 'binary_precision': 0.47368422, 'binary_recall': 0.037190083, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.06896552}
confusion matrix:
      0   1
0  5987  10
1   233   9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_2.png
better model found
persisted
after epoch: 2,now: 2024-06-21 23:20:23.801802,epoch time: 0:09:00.119631,used: 0:18:50.844391,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9769894, 'precision': 0.9797344, 'recall': 0.88725007, 'specificity': 0.88725007, 'f1': 0.9273385, 'auroc': 0.9829147, 'binary_precision': 0.9829752, 'binary_recall': 0.77594185, 'binary_specificity': 0.9985582, 'binary_f1_score': 0.8672741}
confusion matrix:
       0     1
0  42248    61
1   1017  3522
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.7776731, 'recall': 0.553524, 'specificity': 0.553524, 'f1': 0.58439314, 'auroc': 0.7043818, 'binary_precision': 0.5840708, 'binary_recall': 0.10963455, 'binary_specificity': 0.99741346, 'binary_f1_score': 0.18461537}
confusion matrix:
       0   1
0  18124  47
1    536  66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.82896036, 'recall': 0.57709503, 'specificity': 0.57709503, 'f1': 0.61887467, 'auroc': 0.7175034, 'binary_precision': 0.6909091, 'binary_recall': 0.1570248, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.25589228}
confusion matrix:
      0   1
0  5980  17
1   204  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-21 23:29:17.617379,epoch time: 0:08:53.815577,used: 0:27:44.659968,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98179215, 'precision': 0.9831363, 'recall': 0.91172093, 'specificity': 0.91172093, 'f1': 0.94385815, 'auroc': 0.9860662, 'binary_precision': 0.98474085, 'binary_recall': 0.8248127, 'binary_specificity': 0.99862915, 'binary_f1_score': 0.89770955}
confusion matrix:
       0     1
0  42252    58
1    795  3743
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.7532213, 'recall': 0.5766198, 'specificity': 0.5766198, 'f1': 0.6137712, 'auroc': 0.750402, 'binary_precision': 0.53370786, 'binary_recall': 0.1578073, 'binary_specificity': 0.99543226, 'binary_f1_score': 0.24358976}
confusion matrix:
       0   1
0  18088  83
1    507  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.87047684, 'recall': 0.6102362, 'specificity': 0.6102362, 'f1': 0.6646929, 'auroc': 0.761145, 'binary_precision': 0.7714286, 'binary_recall': 0.2231405, 'binary_specificity': 0.997332, 'binary_f1_score': 0.34615383}
confusion matrix:
      0   1
0  5981  16
1   188  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_4.png
new oracle model saved
early stop counter: 1
val acc:0.9685719013214111, best validation acc: 0.968944787979126, corresponding to test acc:                         0.9645776748657227 / 0.9673024415969849
after epoch: 4,now: 2024-06-21 23:38:19.045625,epoch time: 0:09:01.428246,used: 0:36:46.088214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9840548, 'precision': 0.9830978, 'recall': 0.9246788, 'specificity': 0.9246788, 'f1': 0.95152587, 'auroc': 0.9908842, 'binary_precision': 0.9819476, 'binary_recall': 0.8510357, 'binary_specificity': 0.9983219, 'binary_f1_score': 0.91181684}
confusion matrix:
       0     1
0  42239    71
1    676  3862
---- Validation: 
scalar performance:
{'acc': 0.9692111, 'precision': 0.7721158, 'recall': 0.57775307, 'specificity': 0.57775307, 'f1': 0.61681694, 'auroc': 0.7598597, 'binary_precision': 0.5714286, 'binary_recall': 0.15946844, 'binary_specificity': 0.99603766, 'binary_f1_score': 0.24935064}
confusion matrix:
       0   1
0  18099  72
1    506  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.8632529, 'recall': 0.60808676, 'specificity': 0.60808676, 'f1': 0.66140556, 'auroc': 0.7621033, 'binary_precision': 0.75714284, 'binary_recall': 0.21900827, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.33974358}
confusion matrix:
      0   1
0  5980  17
1   189  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_5.png
better model found
persisted
after epoch: 5,now: 2024-06-21 23:47:28.416416,epoch time: 0:09:09.370791,used: 0:45:55.459005,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.984311, 'precision': 0.9840441, 'recall': 0.92532873, 'specificity': 0.92532873, 'f1': 0.9523046, 'auroc': 0.99158317, 'binary_precision': 0.9837233, 'binary_recall': 0.8521701, 'binary_specificity': 0.9984873, 'binary_f1_score': 0.9132334}
confusion matrix:
       0     1
0  42245    64
1    671  3868
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.7648585, 'recall': 0.5792491, 'specificity': 0.5792491, 'f1': 0.6180495, 'auroc': 0.77011085, 'binary_precision': 0.5568182, 'binary_recall': 0.1627907, 'binary_specificity': 0.99570745, 'binary_f1_score': 0.251928}
confusion matrix:
       0   1
0  18093  78
1    504  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.86504173, 'recall': 0.6101529, 'specificity': 0.6101529, 'f1': 0.6640982, 'auroc': 0.77392006, 'binary_precision': 0.7605634, 'binary_recall': 0.2231405, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.34504792}
confusion matrix:
      0   1
0  5980  17
1   188  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_6.png
early stop counter: 1
val acc:0.9689980149269104, best validation acc: 0.9692111015319824, corresponding to test acc:                         0.9669818878173828 / 0.9673024415969849
after epoch: 6,now: 2024-06-21 23:56:22.709385,epoch time: 0:08:54.292969,used: 0:54:49.751974,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9859119, 'precision': 0.9832148, 'recall': 0.9352622, 'specificity': 0.9352622, 'f1': 0.9576614, 'auroc': 0.99191797, 'binary_precision': 0.97995543, 'binary_recall': 0.87243885, 'binary_specificity': 0.9980855, 'binary_f1_score': 0.92307687}
confusion matrix:
       0     1
0  42228    81
1    579  3960
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.75716424, 'recall': 0.5912123, 'specificity': 0.5912123, 'f1': 0.63137174, 'auroc': 0.7820765, 'binary_precision': 0.54066986, 'binary_recall': 0.18770765, 'binary_specificity': 0.9947169, 'binary_f1_score': 0.2786683}
confusion matrix:
       0    1
0  18075   96
1    489  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.8544253, 'recall': 0.6262649, 'specificity': 0.6262649, 'f1': 0.68187267, 'auroc': 0.77568555, 'binary_precision': 0.7380952, 'binary_recall': 0.25619835, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.38036808}
confusion matrix:
      0   1
0  5975  22
1   180  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_7.png
new oracle model saved
early stop counter: 2
val acc:0.9688382148742676, best validation acc: 0.9692111015319824, corresponding to test acc:                         0.9669818878173828 / 0.9676229953765869
after epoch: 7,now: 2024-06-22 00:05:43.540951,epoch time: 0:09:20.831566,used: 1:04:10.583540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98702186, 'precision': 0.9812238, 'recall': 0.943535, 'specificity': 0.943535, 'f1': 0.9614091, 'auroc': 0.9930321, 'binary_precision': 0.97417957, 'binary_recall': 0.88959897, 'binary_specificity': 0.99747103, 'binary_f1_score': 0.92997}
confusion matrix:
       0     1
0  42203   107
1    501  4037
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.75725627, 'recall': 0.603313, 'specificity': 0.603313, 'f1': 0.6446213, 'auroc': 0.7939037, 'binary_precision': 0.54008436, 'binary_recall': 0.21262458, 'binary_specificity': 0.99400145, 'binary_f1_score': 0.30512515}
confusion matrix:
       0    1
0  18062  109
1    474  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692258, 'precision': 0.86914635, 'recall': 0.6469261, 'specificity': 0.6469261, 'f1': 0.7063793, 'auroc': 0.7832375, 'binary_precision': 0.7659575, 'binary_recall': 0.29752067, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.42857146}
confusion matrix:
      0   1
0  5975  22
1   170  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_8.png
new oracle model saved
early stop counter: 3
val acc:0.968944787979126, best validation acc: 0.9692111015319824, corresponding to test acc:                         0.9669818878173828 / 0.9692258238792419
after epoch: 8,now: 2024-06-22 00:14:38.495691,epoch time: 0:08:54.954740,used: 1:13:05.538280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98785436, 'precision': 0.98438156, 'recall': 0.94538474, 'specificity': 0.94538474, 'f1': 0.96385086, 'auroc': 0.9914776, 'binary_precision': 0.98016447, 'binary_recall': 0.89270765, 'binary_specificity': 0.9980619, 'binary_f1_score': 0.93439406}
confusion matrix:
       0     1
0  42227    82
1    487  4052
---- Validation: 
scalar performance:
{'acc': 0.9687849, 'precision': 0.75619507, 'recall': 0.5895786, 'specificity': 0.5895786, 'f1': 0.62940085, 'auroc': 0.8023006, 'binary_precision': 0.5388349, 'binary_recall': 0.18438539, 'binary_specificity': 0.9947719, 'binary_f1_score': 0.27475247}
confusion matrix:
       0    1
0  18076   95
1    491  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.844895, 'recall': 0.6199832, 'specificity': 0.6199832, 'f1': 0.67362416, 'auroc': 0.7896774, 'binary_precision': 0.7195122, 'binary_recall': 0.24380165, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.36419755}
confusion matrix:
      0   1
0  5974  23
1   183  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_9.png
early stop counter: 4
val acc:0.9687849283218384, best validation acc: 0.9692111015319824, corresponding to test acc:                         0.9669818878173828 / 0.9692258238792419
after epoch: 9,now: 2024-06-22 00:23:26.784741,epoch time: 0:08:48.289050,used: 1:21:53.827330,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9865736, 'precision': 0.9837551, 'recall': 0.9385787, 'specificity': 0.9385787, 'f1': 0.9597722, 'auroc': 0.99206185, 'binary_precision': 0.980344, 'binary_recall': 0.8790482, 'binary_specificity': 0.99810916, 'binary_f1_score': 0.926937}
confusion matrix:
       0     1
0  42229    80
1    549  3990
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.7588167, 'recall': 0.5678413, 'specificity': 0.5678413, 'f1': 0.6031198, 'auroc': 0.7875358, 'binary_precision': 0.54545456, 'binary_recall': 0.13953489, 'binary_specificity': 0.9961477, 'binary_f1_score': 0.22222224}
confusion matrix:
       0   1
0  18101  70
1    518  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.84695697, 'recall': 0.59155786, 'specificity': 0.59155786, 'f1': 0.6392371, 'auroc': 0.77076435, 'binary_precision': 0.7258065, 'binary_recall': 0.18595041, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.29605266}
confusion matrix:
      0   1
0  5980  17
1   197  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_10.png
early stop counter: 5
val acc:0.9686784148216248, best validation acc: 0.9692111015319824, corresponding to test acc:                         0.9669818878173828 / 0.9692258238792419
after epoch: 10,now: 2024-06-22 00:32:12.059244,epoch time: 0:08:45.274503,used: 1:30:39.101833,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.989071, 'precision': 0.986214, 'recall': 0.95068026, 'specificity': 0.95068026, 'f1': 0.9675962, 'auroc': 0.9951097, 'binary_precision': 0.98273796, 'binary_recall': 0.90306234, 'binary_specificity': 0.9982982, 'binary_f1_score': 0.94121695}
confusion matrix:
       0     1
0  42237    72
1    440  4099
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.77075875, 'recall': 0.584205, 'specificity': 0.584205, 'f1': 0.62463605, 'auroc': 0.80406016, 'binary_precision': 0.568306, 'binary_recall': 0.17275748, 'binary_specificity': 0.99565244, 'binary_f1_score': 0.26496816}
confusion matrix:
       0    1
0  18092   79
1    498  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.840266, 'recall': 0.59552336, 'specificity': 0.59552336, 'f1': 0.64380527, 'auroc': 0.7812643, 'binary_precision': 0.7121212, 'binary_recall': 0.19421488, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.3051948}
confusion matrix:
      0   1
0  5978  19
1   195  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_11.png
better model found
persisted
after epoch: 11,now: 2024-06-22 00:40:57.589536,epoch time: 0:08:45.530292,used: 1:39:24.632125,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9892632, 'precision': 0.98326325, 'recall': 0.95461214, 'specificity': 0.95461214, 'f1': 0.968384, 'auroc': 0.9936151, 'binary_precision': 0.9759377, 'binary_recall': 0.9116351, 'binary_specificity': 0.99758923, 'binary_f1_score': 0.9426912}
confusion matrix:
       0     1
0  42208   102
1    401  4137
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.76658344, 'recall': 0.5954476, 'specificity': 0.5954476, 'f1': 0.6372875, 'auroc': 0.80994827, 'binary_precision': 0.5592417, 'binary_recall': 0.19601329, 'binary_specificity': 0.9948819, 'binary_f1_score': 0.2902829}
confusion matrix:
       0    1
0  18078   93
1    484  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.78937197, 'recall': 0.59460616, 'specificity': 0.59460616, 'f1': 0.638083, 'auroc': 0.7883957, 'binary_precision': 0.6103896, 'binary_recall': 0.19421488, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.29467085}
confusion matrix:
      0   1
0  5967  30
1   195  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_12.png
early stop counter: 1
val acc:0.9692643880844116, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9656996130943298 / 0.9692258238792419
after epoch: 12,now: 2024-06-22 00:49:56.459789,epoch time: 0:08:58.870253,used: 1:48:23.502378,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9895193, 'precision': 0.98639524, 'recall': 0.9530818, 'specificity': 0.9530818, 'f1': 0.96899235, 'auroc': 0.99439085, 'binary_precision': 0.98259, 'binary_recall': 0.90788895, 'binary_specificity': 0.9982746, 'binary_f1_score': 0.9437636}
confusion matrix:
       0     1
0  42237    73
1    418  4120
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.76963854, 'recall': 0.5906569, 'specificity': 0.5906569, 'f1': 0.63216245, 'auroc': 0.8185239, 'binary_precision': 0.56565654, 'binary_recall': 0.18604651, 'binary_specificity': 0.9952672, 'binary_f1_score': 0.28}
confusion matrix:
       0    1
0  18085   86
1    490  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.79133344, 'recall': 0.58056027, 'specificity': 0.58056027, 'f1': 0.62096775, 'auroc': 0.79107285, 'binary_precision': 0.61538464, 'binary_recall': 0.16528925, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.26058632}
confusion matrix:
      0   1
0  5972  25
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_13.png
better model found
persisted
after epoch: 13,now: 2024-06-22 00:58:38.886573,epoch time: 0:08:42.426784,used: 1:57:05.929162,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99033046, 'precision': 0.9865055, 'recall': 0.9576621, 'specificity': 0.9576621, 'f1': 0.9715267, 'auroc': 0.99625576, 'binary_precision': 0.98183537, 'binary_recall': 0.9171441, 'binary_specificity': 0.9981801, 'binary_f1_score': 0.94838786}
confusion matrix:
       0     1
0  42233    77
1    376  4162
---- Validation: 
scalar performance:
{'acc': 0.9691046, 'precision': 0.7640351, 'recall': 0.5905468, 'specificity': 0.5905468, 'f1': 0.6314106, 'auroc': 0.815849, 'binary_precision': 0.55445546, 'binary_recall': 0.18604651, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.27860695}
confusion matrix:
       0    1
0  18081   90
1    490  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.7949146, 'recall': 0.5927068, 'specificity': 0.5927068, 'f1': 0.6363606, 'auroc': 0.79153967, 'binary_precision': 0.6216216, 'binary_recall': 0.19008264, 'binary_specificity': 0.995331, 'binary_f1_score': 0.29113922}
confusion matrix:
      0   1
0  5969  28
1   196  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_14.png
early stop counter: 1
val acc:0.9691045880317688, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9636159539222717 / 0.9692258238792419
after epoch: 14,now: 2024-06-22 01:07:23.813692,epoch time: 0:08:44.927119,used: 2:05:50.856281,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9897968, 'precision': 0.98554826, 'recall': 0.95550734, 'specificity': 0.95550734, 'f1': 0.96992147, 'auroc': 0.99525607, 'binary_precision': 0.9803643, 'binary_recall': 0.91297644, 'binary_specificity': 0.99803823, 'binary_f1_score': 0.9454711}
confusion matrix:
       0     1
0  42226    83
1    395  4144
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.7622142, 'recall': 0.58727956, 'specificity': 0.58727956, 'f1': 0.6274196, 'auroc': 0.82861865, 'binary_precision': 0.5510204, 'binary_recall': 0.179402, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.27067667}
confusion matrix:
       0    1
0  18083   88
1    494  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.79133344, 'recall': 0.58056027, 'specificity': 0.58056027, 'f1': 0.62096775, 'auroc': 0.80351055, 'binary_precision': 0.61538464, 'binary_recall': 0.16528925, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.26058632}
confusion matrix:
      0   1
0  5972  25
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_15.png
early stop counter: 2
val acc:0.9689980149269104, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9636159539222717 / 0.9692258238792419
after epoch: 15,now: 2024-06-22 01:16:04.657071,epoch time: 0:08:40.843379,used: 2:14:31.699660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99133366, 'precision': 0.98715436, 'recall': 0.96284854, 'specificity': 0.96284854, 'f1': 0.9746079, 'auroc': 0.996323, 'binary_precision': 0.98203874, 'binary_recall': 0.92751706, 'binary_specificity': 0.99818003, 'binary_f1_score': 0.9539995}
confusion matrix:
       0     1
0  42232    77
1    329  4210
---- Validation: 
scalar performance:
{'acc': 0.9692111, 'precision': 0.7685708, 'recall': 0.58578354, 'specificity': 0.58578354, 'f1': 0.6263146, 'auroc': 0.81991875, 'binary_precision': 0.5638298, 'binary_recall': 0.17607974, 'binary_specificity': 0.99548733, 'binary_f1_score': 0.26835445}
confusion matrix:
       0    1
0  18089   82
1    496  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.78675115, 'recall': 0.5684137, 'specificity': 0.5684137, 'f1': 0.6046523, 'auroc': 0.7811263, 'binary_precision': 0.60714287, 'binary_recall': 0.14049587, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.22818793}
confusion matrix:
      0   1
0  5975  22
1   208  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_16.png
early stop counter: 3
val acc:0.9692111015319824, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9636159539222717 / 0.9692258238792419
after epoch: 16,now: 2024-06-22 01:24:48.510468,epoch time: 0:08:43.853397,used: 2:23:15.553057,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9909068, 'precision': 0.9850712, 'recall': 0.9624156, 'specificity': 0.9624156, 'f1': 0.97340024, 'auroc': 0.99602354, 'binary_precision': 0.9779224, 'binary_recall': 0.92707646, 'binary_specificity': 0.99775463, 'binary_f1_score': 0.9518209}
confusion matrix:
       0     1
0  42214    95
1    331  4208
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.7380598, 'recall': 0.59719634, 'specificity': 0.59719634, 'f1': 0.63534766, 'auroc': 0.8350326, 'binary_precision': 0.5020747, 'binary_recall': 0.20099668, 'binary_specificity': 0.99339604, 'binary_f1_score': 0.28706998}
confusion matrix:
       0    1
0  18051  120
1    481  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.7550837, 'recall': 0.589807, 'specificity': 0.589807, 'f1': 0.6287931, 'auroc': 0.7990018, 'binary_precision': 0.5421687, 'binary_recall': 0.18595041, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.2769231}
confusion matrix:
      0   1
0  5959  38
1   197  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_17.png
early stop counter: 4
val acc:0.9679859280586243, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9636159539222717 / 0.9692258238792419
after epoch: 17,now: 2024-06-22 01:33:28.296619,epoch time: 0:08:39.786151,used: 2:31:55.339208,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9909281, 'precision': 0.9869944, 'recall': 0.96065724, 'specificity': 0.96065724, 'f1': 0.97336274, 'auroc': 0.9959093, 'binary_precision': 0.9821847, 'binary_recall': 0.92311084, 'binary_specificity': 0.9982037, 'binary_f1_score': 0.9517319}
confusion matrix:
       0     1
0  42233    76
1    349  4190
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.7720134, 'recall': 0.5745133, 'specificity': 0.5745133, 'f1': 0.6127062, 'auroc': 0.8193028, 'binary_precision': 0.5714286, 'binary_recall': 0.15282393, 'binary_specificity': 0.99620277, 'binary_f1_score': 0.24115336}
confusion matrix:
       0   1
0  18102  69
1    510  92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.791311, 'recall': 0.5584166, 'specificity': 0.5584166, 'f1': 0.59087026, 'auroc': 0.7784142, 'binary_precision': 0.61702126, 'binary_recall': 0.11983471, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.20069204}
confusion matrix:
      0   1
0  5979  18
1   213  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_18.png
early stop counter: 5
val acc:0.9691578149795532, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9636159539222717 / 0.9692258238792419
after epoch: 18,now: 2024-06-22 01:42:08.529969,epoch time: 0:08:40.233350,used: 2:40:35.572558,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9906079, 'precision': 0.989056, 'recall': 0.95684147, 'specificity': 0.95684147, 'f1': 0.9722559, 'auroc': 0.99622893, 'binary_precision': 0.98716426, 'binary_recall': 0.91495925, 'binary_specificity': 0.9987237, 'binary_f1_score': 0.9496913}
confusion matrix:
       0     1
0  42255    54
1    386  4153
---- Validation: 
scalar performance:
{'acc': 0.9687849, 'precision': 0.76955897, 'recall': 0.5542445, 'specificity': 0.5542445, 'f1': 0.5850992, 'auroc': 0.81362164, 'binary_precision': 0.5677966, 'binary_recall': 0.11129568, 'binary_specificity': 0.99719334, 'binary_f1_score': 0.1861111}
confusion matrix:
       0   1
0  18120  51
1    535  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.79101527, 'recall': 0.5423046, 'specificity': 0.5423046, 'f1': 0.56649834, 'auroc': 0.77398825, 'binary_precision': 0.61764705, 'binary_recall': 0.08677686, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.15217392}
confusion matrix:
      0   1
0  5984  13
1   221  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_19.png
early stop counter: 6
val acc:0.9687849283218384, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9636159539222717 / 0.9692258238792419
after epoch: 19,now: 2024-06-22 01:50:47.897837,epoch time: 0:08:39.367868,used: 2:49:14.940426,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99152577, 'precision': 0.98993087, 'recall': 0.96128315, 'specificity': 0.96128315, 'f1': 0.9750618, 'auroc': 0.99597985, 'binary_precision': 0.98798305, 'binary_recall': 0.92377174, 'binary_specificity': 0.99879456, 'binary_f1_score': 0.954799}
confusion matrix:
       0     1
0  42258    51
1    346  4193
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.76888096, 'recall': 0.57365525, 'specificity': 0.57365525, 'f1': 0.61136836, 'auroc': 0.8264982, 'binary_precision': 0.5652174, 'binary_recall': 0.15116279, 'binary_specificity': 0.9961477, 'binary_f1_score': 0.2385321}
confusion matrix:
       0   1
0  18101  70
1    511  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.75513244, 'recall': 0.5479193, 'specificity': 0.5479193, 'f1': 0.57415557, 'auroc': 0.78865325, 'binary_precision': 0.54545456, 'binary_recall': 0.09917355, 'binary_specificity': 0.996665, 'binary_f1_score': 0.16783218}
confusion matrix:
      0   1
0  5977  20
1   218  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_20.png
early stop counter: 7
val acc:0.9690513014793396, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9636159539222717 / 0.9692258238792419
after epoch: 20,now: 2024-06-22 01:59:30.033280,epoch time: 0:08:42.135443,used: 2:57:57.075869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99146175, 'precision': 0.98653436, 'recall': 0.9641979, 'specificity': 0.9641979, 'f1': 0.9750338, 'auroc': 0.99624944, 'binary_precision': 0.9804969, 'binary_recall': 0.9303811, 'binary_specificity': 0.9980146, 'binary_f1_score': 0.95478183}
confusion matrix:
       0     1
0  42225    84
1    316  4223
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.7485658, 'recall': 0.5894135, 'specificity': 0.5894135, 'f1': 0.62830526, 'auroc': 0.83182305, 'binary_precision': 0.5235849, 'binary_recall': 0.18438539, 'binary_specificity': 0.9944417, 'binary_f1_score': 0.27272728}
confusion matrix:
       0    1
0  18070  101
1    491  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7332226, 'recall': 0.5693959, 'specificity': 0.5693959, 'f1': 0.6022337, 'auroc': 0.7848022, 'binary_precision': 0.5, 'binary_recall': 0.1446281, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.22435896}
confusion matrix:
      0   1
0  5962  35
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_21.png
early stop counter: 8
val acc:0.9684653282165527, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9636159539222717 / 0.9692258238792419
after epoch: 21,now: 2024-06-22 02:08:05.583764,epoch time: 0:08:35.550484,used: 3:06:32.626353,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99252903, 'precision': 0.989427, 'recall': 0.9675423, 'specificity': 0.9675423, 'f1': 0.9781679, 'auroc': 0.99664366, 'binary_precision': 0.98562485, 'binary_recall': 0.9365499, 'binary_specificity': 0.9985346, 'binary_f1_score': 0.96046096}
confusion matrix:
       0     1
0  42247    62
1    288  4251
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.76644284, 'recall': 0.5752338, 'specificity': 0.5752338, 'f1': 0.6131814, 'auroc': 0.8325702, 'binary_precision': 0.560241, 'binary_recall': 0.15448505, 'binary_specificity': 0.9959826, 'binary_f1_score': 0.2421875}
confusion matrix:
       0   1
0  18098  73
1    509  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.7526305, 'recall': 0.5538675, 'specificity': 0.5538675, 'f1': 0.58270043, 'auroc': 0.78913957, 'binary_precision': 0.54, 'binary_recall': 0.11157025, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.1849315}
confusion matrix:
      0   1
0  5974  23
1   215  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_22.png
early stop counter: 9
val acc:0.9689980149269104, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9636159539222717 / 0.9692258238792419
after epoch: 22,now: 2024-06-22 02:16:48.305468,epoch time: 0:08:42.721704,used: 3:15:15.348057,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9922515, 'precision': 0.98904943, 'recall': 0.96629965, 'specificity': 0.96629965, 'f1': 0.97733176, 'auroc': 0.99603164, 'binary_precision': 0.9851267, 'binary_recall': 0.93411195, 'binary_specificity': 0.99848735, 'binary_f1_score': 0.95894134}
confusion matrix:
       0     1
0  42246    64
1    299  4239
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.7478137, 'recall': 0.5845677, 'specificity': 0.5845677, 'f1': 0.6226901, 'auroc': 0.83559096, 'binary_precision': 0.52238804, 'binary_recall': 0.1744186, 'binary_specificity': 0.9947169, 'binary_f1_score': 0.26151928}
confusion matrix:
       0    1
0  18075   96
1    497  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96025, 'precision': 0.7076024, 'recall': 0.55303377, 'specificity': 0.55303377, 'f1': 0.57922, 'auroc': 0.7901425, 'binary_precision': 0.45, 'binary_recall': 0.11157025, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.17880794}
confusion matrix:
      0   1
0  5964  33
1   215  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_23.png
early stop counter: 10
val acc:0.9684121012687683, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9636159539222717 / 0.9692258238792419
after epoch: 23,now: 2024-06-22 02:25:35.266336,epoch time: 0:08:46.960868,used: 3:24:02.308925,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9919527, 'precision': 0.9883573, 'recall': 0.9652564, 'specificity': 0.9652564, 'f1': 0.9764526, 'auroc': 0.99699223, 'binary_precision': 0.9839535, 'binary_recall': 0.9321436, 'binary_specificity': 0.99836916, 'binary_f1_score': 0.95734805}
confusion matrix:
       0     1
0  42240    69
1    308  4231
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.76110333, 'recall': 0.59129477, 'specificity': 0.59129477, 'f1': 0.6319305, 'auroc': 0.836741, 'binary_precision': 0.5485437, 'binary_recall': 0.18770765, 'binary_specificity': 0.9948819, 'binary_f1_score': 0.27970296}
confusion matrix:
       0    1
0  18078   93
1    489  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.71700406, 'recall': 0.5453529, 'specificity': 0.5453529, 'f1': 0.56898606, 'auroc': 0.78596205, 'binary_precision': 0.46938777, 'binary_recall': 0.09504132, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.1580756}
confusion matrix:
      0   1
0  5971  26
1   219  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_24.png
early stop counter: 11
val acc:0.9689980149269104, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9636159539222717 / 0.9692258238792419
after epoch: 24,now: 2024-06-22 02:34:24.735977,epoch time: 0:08:49.469641,used: 3:32:51.778566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9918033, 'precision': 0.9855697, 'recall': 0.96714044, 'specificity': 0.96714044, 'f1': 0.97612906, 'auroc': 0.9965912, 'binary_precision': 0.9779158, 'binary_recall': 0.9365499, 'binary_specificity': 0.997731, 'binary_f1_score': 0.956786}
confusion matrix:
       0     1
0  42213    96
1    288  4251
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.7461177, 'recall': 0.5893585, 'specificity': 0.5893585, 'f1': 0.6279434, 'auroc': 0.83778626, 'binary_precision': 0.5186916, 'binary_recall': 0.18438539, 'binary_specificity': 0.9943316, 'binary_f1_score': 0.27205884}
confusion matrix:
       0    1
0  18068  103
1    491  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.71827906, 'recall': 0.56311417, 'specificity': 0.56311417, 'f1': 0.5931173, 'auroc': 0.78337276, 'binary_precision': 0.47058824, 'binary_recall': 0.1322314, 'binary_specificity': 0.993997, 'binary_f1_score': 0.20645161}
confusion matrix:
      0   1
0  5961  36
1   210  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_25.png
early stop counter: 12
val acc:0.9683588147163391, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9636159539222717 / 0.9692258238792419
after epoch: 25,now: 2024-06-22 02:43:04.878544,epoch time: 0:08:40.142567,used: 3:41:31.921133,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99227285, 'precision': 0.9859755, 'recall': 0.9694526, 'specificity': 0.9694526, 'f1': 0.97753286, 'auroc': 0.9971622, 'binary_precision': 0.97823596, 'binary_recall': 0.94115055, 'binary_specificity': 0.9977547, 'binary_f1_score': 0.95933497}
confusion matrix:
       0     1
0  42216    95
1    267  4270
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.743569, 'recall': 0.5925157, 'specificity': 0.5925157, 'f1': 0.6311097, 'auroc': 0.8418311, 'binary_precision': 0.51339287, 'binary_recall': 0.1910299, 'binary_specificity': 0.99400145, 'binary_f1_score': 0.27845037}
confusion matrix:
       0    1
0  18062  109
1    487  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.72219366, 'recall': 0.5651803, 'specificity': 0.5651803, 'f1': 0.5960411, 'auroc': 0.7940309, 'binary_precision': 0.47826087, 'binary_recall': 0.13636364, 'binary_specificity': 0.993997, 'binary_f1_score': 0.21221864}
confusion matrix:
      0   1
0  5961  36
1   209  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_26.png
early stop counter: 13
val acc:0.9682523012161255, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9636159539222717 / 0.9692258238792419
after epoch: 26,now: 2024-06-22 02:51:45.570139,epoch time: 0:08:40.691595,used: 3:50:12.612728,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99248636, 'precision': 0.98839504, 'recall': 0.96830535, 'specificity': 0.96830535, 'f1': 0.978083, 'auroc': 0.99705744, 'binary_precision': 0.98337567, 'binary_recall': 0.9383124, 'binary_specificity': 0.9982982, 'binary_f1_score': 0.96031564}
confusion matrix:
       0     1
0  42237    72
1    280  4259
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.7505195, 'recall': 0.5749587, 'specificity': 0.5749587, 'f1': 0.6114868, 'auroc': 0.8396106, 'binary_precision': 0.52840906, 'binary_recall': 0.15448505, 'binary_specificity': 0.99543226, 'binary_f1_score': 0.23907453}
confusion matrix:
       0   1
0  18088  83
1    509  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.73850703, 'recall': 0.5397382, 'specificity': 0.5397382, 'f1': 0.5612949, 'auroc': 0.78795564, 'binary_precision': 0.51282054, 'binary_recall': 0.08264463, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.14234874}
confusion matrix:
      0   1
0  5978  19
1   222  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_27.png
early stop counter: 14
val acc:0.9684653282165527, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9636159539222717 / 0.9692258238792419
after epoch: 27,now: 2024-06-22 03:00:28.011484,epoch time: 0:08:42.441345,used: 3:58:55.054073,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9923796, 'precision': 0.9900445, 'recall': 0.9660828, 'specificity': 0.9660828, 'f1': 0.9776838, 'auroc': 0.99713445, 'binary_precision': 0.9871855, 'binary_recall': 0.93346554, 'binary_specificity': 0.9987, 'binary_f1_score': 0.9595742}
confusion matrix:
       0     1
0  42254    55
1    302  4237
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.7733198, 'recall': 0.57210416, 'specificity': 0.57210416, 'f1': 0.60970014, 'auroc': 0.8419999, 'binary_precision': 0.57419354, 'binary_recall': 0.14784053, 'binary_specificity': 0.9963678, 'binary_f1_score': 0.2351387}
confusion matrix:
       0   1
0  18105  66
1    513  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7317201, 'recall': 0.5297411, 'specificity': 0.5297411, 'f1': 0.5452339, 'auroc': 0.78981245, 'binary_precision': 0.5, 'binary_recall': 0.06198347, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.11029412}
confusion matrix:
      0   1
0  5982  15
1   227  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_28.png
early stop counter: 15
val acc:0.9691578149795532, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9636159539222717 / 0.9692258238792419
after epoch: 28,now: 2024-06-22 03:09:07.440485,epoch time: 0:08:39.429001,used: 4:07:34.483074,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9919954, 'precision': 0.9871789, 'recall': 0.96664965, 'specificity': 0.96664965, 'f1': 0.9766344, 'auroc': 0.99665654, 'binary_precision': 0.9812717, 'binary_recall': 0.93521374, 'binary_specificity': 0.99808556, 'binary_f1_score': 0.9576892}
confusion matrix:
       0     1
0  42229    81
1    294  4244
---- Validation: 
scalar performance:
{'acc': 0.9685186, 'precision': 0.75079334, 'recall': 0.58221364, 'specificity': 0.58221364, 'f1': 0.6202613, 'auroc': 0.84535265, 'binary_precision': 0.5284974, 'binary_recall': 0.16943522, 'binary_specificity': 0.994992, 'binary_f1_score': 0.25660378}
confusion matrix:
       0    1
0  18080   91
1    500  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.72518456, 'recall': 0.53560597, 'specificity': 0.53560597, 'f1': 0.5545563, 'auroc': 0.78382856, 'binary_precision': 0.4864865, 'binary_recall': 0.07438017, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.12903227}
confusion matrix:
      0   1
0  5978  19
1   224  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_29.png
early stop counter: 16
val acc:0.9685186147689819, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9636159539222717 / 0.9692258238792419
after epoch: 29,now: 2024-06-22 03:17:45.840028,epoch time: 0:08:38.399543,used: 4:16:12.882617,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99267846, 'precision': 0.989418, 'recall': 0.9684049, 'specificity': 0.9684049, 'f1': 0.97861964, 'auroc': 0.9962928, 'binary_precision': 0.98542005, 'binary_recall': 0.9382988, 'binary_specificity': 0.998511, 'binary_f1_score': 0.9612823}
confusion matrix:
       0     1
0  42247    63
1    280  4258
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.756963, 'recall': 0.5799145, 'specificity': 0.5799145, 'f1': 0.6181307, 'auroc': 0.84319866, 'binary_precision': 0.5409836, 'binary_recall': 0.16445182, 'binary_specificity': 0.99537724, 'binary_f1_score': 0.2522293}
confusion matrix:
       0   1
0  18087  84
1    503  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9596089, 'precision': 0.67756724, 'recall': 0.5348556, 'specificity': 0.5348556, 'f1': 0.55216366, 'auroc': 0.78967154, 'binary_precision': 0.39130434, 'binary_recall': 0.07438017, 'binary_specificity': 0.995331, 'binary_f1_score': 0.125}
confusion matrix:
      0   1
0  5969  28
1   224  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520822_30.png
early stop counter: 17
val acc:0.968731701374054, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9636159539222717 / 0.9692258238792419
after epoch: 30,now: 2024-06-22 03:26:23.543083,epoch time: 0:08:37.703055,used: 4:24:50.585672,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_01_32_seed_2_21520822
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:24:50.585672 at 2024-06-22 03:26:23.543083
persisted model performance metric: 

scalar performance:
{'acc': 0.96361595, 'precision': 0.79133344, 'recall': 0.58056027, 'specificity': 0.58056027, 'f1': 0.62096775, 'auroc': 0.79107285, 'binary_precision': 0.61538464, 'binary_recall': 0.16528925, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.26058632}
confusion matrix:
      0   1
0  5972  25
1   202  40
oracle model performance metric: 

scalar performance:
{'acc': 0.9692258, 'precision': 0.86914635, 'recall': 0.6469261, 'specificity': 0.6469261, 'f1': 0.7063793, 'auroc': 0.7832375, 'binary_precision': 0.7659575, 'binary_recall': 0.29752067, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.42857146}
confusion matrix:
      0   1
0  5975  22
1   170  72
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204097 KiB |   1730 MiB |   1184 TiB |   1184 TiB |
|       from large pool | 167936 KiB |   1660 MiB |   1184 TiB |   1184 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204097 KiB |   1730 MiB |   1184 TiB |   1184 TiB |
|       from large pool | 167936 KiB |   1660 MiB |   1184 TiB |   1184 TiB |
|       from small pool |  36161 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB |   1723 MiB |   1184 TiB |   1184 TiB |
|       from large pool | 165120 KiB |   1653 MiB |   1184 TiB |   1184 TiB |
|       from small pool |  35967 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2196 MiB |   2270 MiB |   5474 MiB |   3278 MiB |
|       from large pool |   2122 MiB |   2196 MiB |   5336 MiB |   3214 MiB |
|       from small pool |     74 MiB |     74 MiB |    138 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 404158 KiB |    900 MiB |    917 TiB |    917 TiB |
|       from large pool | 397312 KiB |    899 MiB |    917 TiB |    917 TiB |
|       from small pool |   6846 KiB |     14 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1194    |    1851    |   32116 K  |   32115 K  |
|       from large pool |      36    |      76    |   12774 K  |   12774 K  |
|       from small pool |    1158    |    1780    |   19342 K  |   19341 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1194    |    1851    |   32116 K  |   32115 K  |
|       from large pool |      36    |      76    |   12774 K  |   12774 K  |
|       from small pool |    1158    |    1780    |   19342 K  |   19341 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      51    |      91    |      41    |
|       from large pool |      13    |      14    |      22    |       9    |
|       from small pool |      37    |      37    |      69    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |     380    |   16530 K  |   16530 K  |
|       from large pool |       5    |      11    |    4352 K  |    4352 K  |
|       from small pool |      26    |     375    |   12178 K  |   12178 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1730 MiB |   1184 TiB |   1184 TiB |
|       from large pool |  16640 KiB |   1660 MiB |   1184 TiB |   1184 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1730 MiB |   1184 TiB |   1184 TiB |
|       from large pool |  16640 KiB |   1660 MiB |   1184 TiB |   1184 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1723 MiB |   1184 TiB |   1184 TiB |
|       from large pool |  16640 KiB |   1653 MiB |   1184 TiB |   1184 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 608256 KiB |   2270 MiB |   5474 MiB |   4880 MiB |
|       from large pool | 565248 KiB |   2196 MiB |   5336 MiB |   4784 MiB |
|       from small pool |  43008 KiB |     74 MiB |    138 MiB |     96 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 384768 KiB |    900 MiB |    917 TiB |    917 TiB |
|       from large pool | 384768 KiB |    899 MiB |    917 TiB |    917 TiB |
|       from small pool |      0 KiB |     14 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1851    |   32116 K  |   32116 K  |
|       from large pool |       2    |      76    |   12774 K  |   12774 K  |
|       from small pool |       0    |    1780    |   19342 K  |   19342 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1851    |   32116 K  |   32116 K  |
|       from large pool |       2    |      76    |   12774 K  |   12774 K  |
|       from small pool |       0    |    1780    |   19342 K  |   19342 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      91    |      61    |
|       from large pool |       9    |      14    |      22    |      13    |
|       from small pool |      21    |      37    |      69    |      48    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     380    |   16530 K  |   16530 K  |
|       from large pool |       1    |      11    |    4352 K  |    4352 K  |
|       from small pool |       0    |     375    |   12178 K  |   12178 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jun 22 03:27:04 2024]
Finished job 0.
1 of 1 steps (100%) done
