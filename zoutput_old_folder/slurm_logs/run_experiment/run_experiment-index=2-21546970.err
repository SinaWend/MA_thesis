Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun 22 10:05:18 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970

 Experiment start at: 2024-06-22 10:16:11.714429
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90547943, 'precision': 0.5777678, 'recall': 0.5000778, 'specificity': 0.5000778, 'f1': 0.47542349, 'auroc': 0.45580387, 'binary_precision': 0.25, 'binary_recall': 0.00022655189, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.00045269352}
confusion matrix:
       0  1
0  42303  3
1   4413  1
---- Validation: 
scalar performance:
{'acc': 0.96514475, 'precision': 0.4828807, 'recall': 0.4996694, 'specificity': 0.4996694, 'f1': 0.4911316, 'auroc': 0.31324884, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993388, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18137  12
1    643   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.4791367, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.48922622, 'auroc': 0.32627618, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 10:29:44.460488,epoch time: 0:13:32.746059,used: 0:13:32.746059,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9055223, 'precision': 0.45276114, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520947, 'auroc': 0.54315495, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42306  0
1   4414  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.3330694, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.3406211, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-22 10:42:58.463027,epoch time: 0:13:14.002539,used: 0:26:46.748598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9055223, 'precision': 0.45276114, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520947, 'auroc': 0.5925876, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42306  0
1   4414  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.34545732, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.3787379, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_3.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-22 10:56:01.687892,epoch time: 0:13:03.224865,used: 0:39:49.973463,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9055223, 'precision': 0.45276114, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520947, 'auroc': 0.66756654, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42306  0
1   4414  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.32876098, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.30950087, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_4.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-22 11:08:59.223349,epoch time: 0:12:57.535457,used: 0:52:47.508920,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9055223, 'precision': 0.45276114, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520947, 'auroc': 0.7289115, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42306  0
1   4414  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.33831558, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.34398395, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_5.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 5,now: 2024-06-22 11:21:46.291320,epoch time: 0:12:47.067971,used: 1:05:34.576891,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.90438783, 'precision': 0.47774327, 'recall': 0.49966624, 'specificity': 0.49966624, 'f1': 0.47556585, 'auroc': 0.7982382, 'binary_precision': 0.05, 'binary_recall': 0.00067980966, 'binary_specificity': 0.9986527, 'binary_f1_score': 0.0013413817}
confusion matrix:
       0   1
0  42250  57
1   4410   3
---- Validation: 
scalar performance:
{'acc': 0.9653044, 'precision': 0.48288345, 'recall': 0.49975204, 'specificity': 0.49975204, 'f1': 0.49117297, 'auroc': 0.3647287, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18140  9
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.39513022, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_6.png
early stop counter: 4
val acc:0.9653043746948242, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 6,now: 2024-06-22 11:34:58.699281,epoch time: 0:13:12.407961,used: 1:18:46.984852,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.90614295, 'precision': 0.92181075, 'recall': 0.5033754, 'specificity': 0.5033754, 'f1': 0.4821129, 'auroc': 0.83085644, 'binary_precision': 0.9375, 'binary_recall': 0.0067980965, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.013498313}
confusion matrix:
       0   1
0  42305   2
1   4383  30
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.39386827, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.51174307, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_7.png
early stop counter: 5
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 7,now: 2024-06-22 11:47:38.542185,epoch time: 0:12:39.842904,used: 1:31:26.827756,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.91061646, 'precision': 0.9321978, 'recall': 0.5280703, 'specificity': 0.5280703, 'f1': 0.5297509, 'auroc': 0.8988414, 'binary_precision': 0.954023, 'binary_recall': 0.0564242, 'binary_specificity': 0.99971634, 'binary_f1_score': 0.10654685}
confusion matrix:
       0    1
0  42295   12
1   4164  249
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.46958345, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.6466714, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_8.png
early stop counter: 6
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 8,now: 2024-06-22 12:00:30.956341,epoch time: 0:12:52.414156,used: 1:44:19.241912,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9145548, 'precision': 0.93162405, 'recall': 0.5503392, 'specificity': 0.5503392, 'f1': 0.56894594, 'auroc': 0.8915238, 'binary_precision': 0.9490446, 'binary_recall': 0.10124575, 'binary_specificity': 0.9994327, 'binary_f1_score': 0.18297176}
confusion matrix:
       0    1
0  42281   24
1   3968  447
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.44684553, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.62534076, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_9.png
early stop counter: 7
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 9,now: 2024-06-22 12:13:21.694549,epoch time: 0:12:50.738208,used: 1:57:09.980120,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.91628855, 'precision': 0.9402996, 'recall': 0.5589055, 'specificity': 0.5589055, 'f1': 0.5832483, 'auroc': 0.88265777, 'binary_precision': 0.9648799, 'binary_recall': 0.11826008, 'binary_specificity': 0.9995509, 'binary_f1_score': 0.21069627}
confusion matrix:
       0    1
0  42287   19
1   3892  522
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.48289075, 'recall': 0.49997246, 'specificity': 0.49997246, 'f1': 0.4912832, 'auroc': 0.4463441, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18148  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.6229533, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_10.png
early stop counter: 8
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 10,now: 2024-06-22 12:26:07.118368,epoch time: 0:12:45.423819,used: 2:09:55.403939,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9258562, 'precision': 0.9371406, 'recall': 0.6130908, 'specificity': 0.6130908, 'f1': 0.6637906, 'auroc': 0.9154136, 'binary_precision': 0.9489603, 'binary_recall': 0.22745809, 'binary_specificity': 0.99872357, 'binary_f1_score': 0.36695907}
confusion matrix:
       0     1
0  42252    54
1   3410  1004
---- Validation: 
scalar performance:
{'acc': 0.9653044, 'precision': 0.48288345, 'recall': 0.49975204, 'specificity': 0.49975204, 'f1': 0.49117297, 'auroc': 0.4867833, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18140  9
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.66653645, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_11.png
new oracle model saved
early stop counter: 9
val acc:0.9653043746948242, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9584531784057617
after epoch: 11,now: 2024-06-22 12:39:53.877110,epoch time: 0:13:46.758742,used: 2:23:42.162681,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.92940927, 'precision': 0.9338912, 'recall': 0.63424695, 'specificity': 0.63424695, 'f1': 0.69109666, 'auroc': 0.9165264, 'binary_precision': 0.938631, 'binary_recall': 0.27033764, 'binary_specificity': 0.9981563, 'binary_f1_score': 0.4197748}
confusion matrix:
       0     1
0  42229    78
1   3220  1193
---- Validation: 
scalar performance:
{'acc': 0.965198, 'precision': 0.48288164, 'recall': 0.49969694, 'specificity': 0.49969694, 'f1': 0.4911454, 'auroc': 0.48062858, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18138  11
1    643   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.72944, 'recall': 0.50732934, 'specificity': 0.50732934, 'f1': 0.5042142, 'auroc': 0.68699163, 'binary_precision': 0.5, 'binary_recall': 0.01532567, 'binary_specificity': 0.999333, 'binary_f1_score': 0.029739777}
confusion matrix:
      0  1
0  5993  4
1   257  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_12.png
early stop counter: 10
val acc:0.9651979804039001, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9584531784057617
after epoch: 12,now: 2024-06-22 12:52:54.372018,epoch time: 0:13:00.494908,used: 2:36:42.657589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9400471, 'precision': 0.9501741, 'recall': 0.68961316, 'specificity': 0.68961316, 'f1': 0.7567102, 'auroc': 0.92201364, 'binary_precision': 0.96112067, 'binary_recall': 0.38083372, 'binary_specificity': 0.99839264, 'binary_f1_score': 0.5455136}
confusion matrix:
       0     1
0  42238    68
1   2733  1681
---- Validation: 
scalar performance:
{'acc': 0.964453, 'precision': 0.5014122, 'recall': 0.50006133, 'specificity': 0.50006133, 'f1': 0.49244446, 'auroc': 0.4793913, 'binary_precision': 0.037037037, 'binary_recall': 0.00155521, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.0029850744}
confusion matrix:
       0   1
0  18123  26
1    642   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.78026634, 'recall': 0.5279019, 'specificity': 0.5279019, 'f1': 0.54198146, 'auroc': 0.6571723, 'binary_precision': 0.6, 'binary_recall': 0.057471264, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.1048951}
confusion matrix:
      0   1
0  5987  10
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_13.png
new oracle model saved
early stop counter: 11
val acc:0.9644529819488525, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.959092378616333
after epoch: 13,now: 2024-06-22 13:05:51.045625,epoch time: 0:12:56.673607,used: 2:49:39.331196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.93655825, 'precision': 0.93261284, 'recall': 0.67630756, 'specificity': 0.67630756, 'f1': 0.740081, 'auroc': 0.9248489, 'binary_precision': 0.92836, 'binary_recall': 0.35547495, 'binary_specificity': 0.9971401, 'binary_f1_score': 0.51409835}
confusion matrix:
       0     1
0  42188   121
1   2843  1568
---- Validation: 
scalar performance:
{'acc': 0.9647722, 'precision': 0.48287433, 'recall': 0.49947655, 'specificity': 0.49947655, 'f1': 0.49103516, 'auroc': 0.5316304, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18130  19
1    643   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.78026634, 'recall': 0.5279019, 'specificity': 0.5279019, 'f1': 0.54198146, 'auroc': 0.7291423, 'binary_precision': 0.6, 'binary_recall': 0.057471264, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.1048951}
confusion matrix:
      0   1
0  5987  10
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_14.png
early stop counter: 12
val acc:0.9647722244262695, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.959092378616333
after epoch: 14,now: 2024-06-22 13:18:53.498711,epoch time: 0:13:02.453086,used: 3:02:41.784282,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9432363, 'precision': 0.95001507, 'recall': 0.70784575, 'specificity': 0.70784575, 'f1': 0.7755622, 'auroc': 0.9265406, 'binary_precision': 0.9574026, 'binary_recall': 0.41762972, 'binary_specificity': 0.9980618, 'binary_f1_score': 0.58157146}
confusion matrix:
       0     1
0  42225    82
1   2570  1843
---- Validation: 
scalar performance:
{'acc': 0.9641337, 'precision': 0.5114845, 'recall': 0.50064605, 'specificity': 0.50064605, 'f1': 0.49381855, 'auroc': 0.55583566, 'binary_precision': 0.057142857, 'binary_recall': 0.00311042, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.005899705}
confusion matrix:
       0   1
0  18116  33
1    641   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.81127167, 'recall': 0.55805296, 'specificity': 0.55805296, 'f1': 0.590574, 'auroc': 0.73407775, 'binary_precision': 0.65957445, 'binary_recall': 0.118773945, 'binary_specificity': 0.997332, 'binary_f1_score': 0.20129871}
confusion matrix:
      0   1
0  5981  16
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_15.png
new oracle model saved
early stop counter: 13
val acc:0.9641336798667908, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9606903195381165
after epoch: 15,now: 2024-06-22 13:32:14.339850,epoch time: 0:13:20.841139,used: 3:16:02.625421,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9516053, 'precision': 0.9575851, 'recall': 0.75235987, 'specificity': 0.75235987, 'f1': 0.81910706, 'auroc': 0.94360423, 'binary_precision': 0.96422416, 'binary_recall': 0.50668174, 'binary_specificity': 0.99803805, 'binary_f1_score': 0.664291}
confusion matrix:
       0     1
0  42222    83
1   2178  2237
---- Validation: 
scalar performance:
{'acc': 0.9641869, 'precision': 0.51232576, 'recall': 0.50067365, 'specificity': 0.50067365, 'f1': 0.4938367, 'auroc': 0.5892695, 'binary_precision': 0.05882353, 'binary_recall': 0.00311042, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.00590842}
confusion matrix:
       0   1
0  18117  32
1    641   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8122984, 'recall': 0.56929713, 'specificity': 0.56929713, 'f1': 0.6067594, 'auroc': 0.74794483, 'binary_precision': 0.66071427, 'binary_recall': 0.14176245, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.23343849}
confusion matrix:
      0   1
0  5978  19
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_16.png
new oracle model saved
early stop counter: 14
val acc:0.9641869068145752, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9611697196960449
after epoch: 16,now: 2024-06-22 13:44:39.414383,epoch time: 0:12:25.074533,used: 3:28:27.699954,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9520762, 'precision': 0.9411838, 'recall': 0.76458466, 'specificity': 0.76458466, 'f1': 0.82590806, 'auroc': 0.9447748, 'binary_precision': 0.92896605, 'binary_recall': 0.53342396, 'binary_specificity': 0.99574536, 'binary_f1_score': 0.6777026}
confusion matrix:
       0     1
0  42127   180
1   2059  2354
---- Validation: 
scalar performance:
{'acc': 0.9630694, 'precision': 0.50107664, 'recall': 0.50009507, 'specificity': 0.50009507, 'f1': 0.49345797, 'auroc': 0.56935334, 'binary_precision': 0.036363635, 'binary_recall': 0.00311042, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.0057306592}
confusion matrix:
       0   1
0  18096  53
1    641   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8392687, 'recall': 0.59786594, 'specificity': 0.59786594, 'f1': 0.64624846, 'auroc': 0.74979633, 'binary_precision': 0.7123288, 'binary_recall': 0.19923371, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.31137726}
confusion matrix:
      0   1
0  5976  21
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_17.png
new oracle model saved
early stop counter: 15
val acc:0.9630693793296814, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9632470607757568
after epoch: 17,now: 2024-06-22 13:56:58.665284,epoch time: 0:12:19.250901,used: 3:40:46.950855,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.95406675, 'precision': 0.9339316, 'recall': 0.7816694, 'specificity': 0.7816694, 'f1': 0.8378695, 'auroc': 0.943882, 'binary_precision': 0.91110307, 'binary_recall': 0.56912965, 'binary_specificity': 0.9942091, 'binary_f1_score': 0.70061386}
confusion matrix:
       0     1
0  42063   245
1   1901  2511
---- Validation: 
scalar performance:
{'acc': 0.96136653, 'precision': 0.52759445, 'recall': 0.50446385, 'specificity': 0.50446385, 'f1': 0.5022434, 'auroc': 0.5955868, 'binary_precision': 0.089108914, 'binary_recall': 0.01399689, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.02419355}
confusion matrix:
       0   1
0  18057  92
1    634   9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.80682266, 'recall': 0.6290157, 'specificity': 0.6290157, 'f1': 0.6780334, 'auroc': 0.77634215, 'binary_precision': 0.6448598, 'binary_recall': 0.26436782, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.375}
confusion matrix:
      0   1
0  5959  38
1   192  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_18.png
early stop counter: 16
val acc:0.9613665342330933, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9632470607757568
after epoch: 18,now: 2024-06-22 14:09:16.818785,epoch time: 0:12:18.153501,used: 3:53:05.104356,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9549658, 'precision': 0.93200886, 'recall': 0.788905, 'specificity': 0.788905, 'f1': 0.84292907, 'auroc': 0.93749124, 'binary_precision': 0.90586585, 'binary_recall': 0.58414495, 'binary_specificity': 0.99366504, 'binary_f1_score': 0.7102727}
confusion matrix:
       0     1
0  42037   268
1   1836  2579
---- Validation: 
scalar performance:
{'acc': 0.96024907, 'precision': 0.512632, 'recall': 0.5023852, 'specificity': 0.5023852, 'f1': 0.4990553, 'auroc': 0.5445073, 'binary_precision': 0.059322033, 'binary_recall': 0.01088647, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.018396847}
confusion matrix:
       0    1
0  18038  111
1    636    7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7485795, 'recall': 0.6160206, 'specificity': 0.6160206, 'f1': 0.65532476, 'auroc': 0.73317504, 'binary_precision': 0.5294118, 'binary_recall': 0.2413793, 'binary_specificity': 0.990662, 'binary_f1_score': 0.33157894}
confusion matrix:
      0   1
0  5941  56
1   198  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_19.png
early stop counter: 17
val acc:0.9602490663528442, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9632470607757568
after epoch: 19,now: 2024-06-22 14:21:50.636271,epoch time: 0:12:33.817486,used: 4:05:38.921842,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.95610017, 'precision': 0.92245233, 'recall': 0.8035872, 'specificity': 0.8035872, 'f1': 0.8509165, 'auroc': 0.95481265, 'binary_precision': 0.88371336, 'binary_recall': 0.61561155, 'binary_specificity': 0.9915629, 'binary_f1_score': 0.72569215}
confusion matrix:
       0     1
0  41956   357
1   1694  2713
---- Validation: 
scalar performance:
{'acc': 0.959983, 'precision': 0.55040544, 'recall': 0.5119982, 'specificity': 0.5119982, 'f1': 0.51503295, 'auroc': 0.62902236, 'binary_precision': 0.13422818, 'binary_recall': 0.0311042, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.050505057}
confusion matrix:
       0    1
0  18020  129
1    623   20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.79436743, 'recall': 0.656584, 'specificity': 0.656584, 'f1': 0.70213896, 'auroc': 0.7820654, 'binary_precision': 0.61764705, 'binary_recall': 0.3218391, 'binary_specificity': 0.991329, 'binary_f1_score': 0.42317382}
confusion matrix:
      0   1
0  5945  52
1   177  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_20.png
new oracle model saved
early stop counter: 18
val acc:0.9599829912185669, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9634068608283997
after epoch: 20,now: 2024-06-22 14:34:18.481111,epoch time: 0:12:27.844840,used: 4:18:06.766682,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.95547944, 'precision': 0.9205489, 'recall': 0.801577, 'specificity': 0.801577, 'f1': 0.84886396, 'auroc': 0.94686395, 'binary_precision': 0.8803391, 'binary_recall': 0.6118287, 'binary_specificity': 0.9913253, 'binary_f1_score': 0.7219252}
confusion matrix:
       0     1
0  41940   367
1   1713  2700
---- Validation: 
scalar performance:
{'acc': 0.95918477, 'precision': 0.5612562, 'recall': 0.5175854, 'specificity': 0.5175854, 'f1': 0.5235896, 'auroc': 0.60929084, 'binary_precision': 0.15555556, 'binary_recall': 0.04354588, 'binary_specificity': 0.9916249, 'binary_f1_score': 0.068043746}
confusion matrix:
       0    1
0  17997  152
1    615   28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.7549817, 'recall': 0.6714909, 'specificity': 0.6714909, 'f1': 0.7040225, 'auroc': 0.7823054, 'binary_precision': 0.53757226, 'binary_recall': 0.35632184, 'binary_specificity': 0.98666, 'binary_f1_score': 0.42857143}
confusion matrix:
      0   1
0  5917  80
1   168  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_21.png
early stop counter: 19
val acc:0.9591847658157349, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9634068608283997
after epoch: 21,now: 2024-06-22 14:46:44.329108,epoch time: 0:12:25.847997,used: 4:30:32.614679,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9559503, 'precision': 0.9132275, 'recall': 0.8117636, 'specificity': 0.8117636, 'f1': 0.8536004, 'auroc': 0.9581933, 'binary_precision': 0.86362237, 'binary_recall': 0.6339751, 'binary_specificity': 0.9895521, 'binary_f1_score': 0.7311913}
confusion matrix:
       0     1
0  41863   442
1   1616  2799
---- Validation: 
scalar performance:
{'acc': 0.959238, 'precision': 0.5636149, 'recall': 0.518363, 'specificity': 0.518363, 'f1': 0.52477527, 'auroc': 0.65074056, 'binary_precision': 0.160221, 'binary_recall': 0.045101088, 'binary_specificity': 0.9916249, 'binary_f1_score': 0.07038835}
confusion matrix:
       0    1
0  17997  152
1    614   29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.78513336, 'recall': 0.67665637, 'specificity': 0.67665637, 'f1': 0.7166832, 'auroc': 0.78275836, 'binary_precision': 0.5974843, 'binary_recall': 0.36398467, 'binary_specificity': 0.989328, 'binary_f1_score': 0.45238099}
confusion matrix:
      0   1
0  5933  64
1   166  95
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_22.png
early stop counter: 20
val acc:0.9592379927635193, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9634068608283997
after epoch: 22,now: 2024-06-22 14:59:10.295856,epoch time: 0:12:25.966748,used: 4:42:58.581427,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9616438, 'precision': 0.92153716, 'recall': 0.8416507, 'specificity': 0.8416507, 'f1': 0.8763349, 'auroc': 0.9557371, 'binary_precision': 0.8743575, 'binary_recall': 0.69370186, 'binary_specificity': 0.9895996, 'binary_f1_score': 0.773623}
confusion matrix:
       0     1
0  41866   440
1   1352  3062
---- Validation: 
scalar performance:
{'acc': 0.9564176, 'precision': 0.55325526, 'recall': 0.5206531, 'specificity': 0.5206531, 'f1': 0.5271725, 'auroc': 0.61620116, 'binary_precision': 0.13934426, 'binary_recall': 0.05287714, 'binary_specificity': 0.9884291, 'binary_f1_score': 0.076662906}
confusion matrix:
       0    1
0  17939  210
1    609   34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.7556862, 'recall': 0.6825683, 'specificity': 0.6825683, 'f1': 0.71224076, 'auroc': 0.78412116, 'binary_precision': 0.5380435, 'binary_recall': 0.37931034, 'binary_specificity': 0.98582625, 'binary_f1_score': 0.44494382}
confusion matrix:
      0   1
0  5912  85
1   162  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_23.png
early stop counter: 21
val acc:0.9564176201820374, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9634068608283997
after epoch: 23,now: 2024-06-22 15:12:04.437142,epoch time: 0:12:54.141286,used: 4:55:52.722713,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96012414, 'precision': 0.93317294, 'recall': 0.82052016, 'specificity': 0.82052016, 'f1': 0.86637425, 'auroc': 0.95639324, 'binary_precision': 0.9019855, 'binary_recall': 0.6483915, 'binary_specificity': 0.9926488, 'binary_f1_score': 0.7544484}
confusion matrix:
       0     1
0  41995   311
1   1552  2862
---- Validation: 
scalar performance:
{'acc': 0.96067476, 'precision': 0.5816797, 'recall': 0.52060694, 'specificity': 0.52060694, 'f1': 0.52865624, 'auroc': 0.6382518, 'binary_precision': 0.19620253, 'binary_recall': 0.048211507, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.07740325}
confusion matrix:
       0    1
0  18022  127
1    612   31
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8093904, 'recall': 0.68698525, 'specificity': 0.68698525, 'f1': 0.731459, 'auroc': 0.8038074, 'binary_precision': 0.6451613, 'binary_recall': 0.38314176, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.48076922}
confusion matrix:
      0    1
0  5942   55
1   161  100
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_24.png
new oracle model saved
early stop counter: 22
val acc:0.9606747627258301, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9654842019081116
after epoch: 24,now: 2024-06-22 15:25:06.433089,epoch time: 0:13:01.995947,used: 5:08:54.718660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9587329, 'precision': 0.93642807, 'recall': 0.80903995, 'specificity': 0.80903995, 'f1': 0.8592553, 'auroc': 0.9500115, 'binary_precision': 0.9108028, 'binary_recall': 0.62446207, 'binary_specificity': 0.9936178, 'binary_f1_score': 0.74092984}
confusion matrix:
       0     1
0  42035   270
1   1658  2757
---- Validation: 
scalar performance:
{'acc': 0.95992976, 'precision': 0.56578285, 'recall': 0.51722103, 'specificity': 0.51722103, 'f1': 0.5232199, 'auroc': 0.62236917, 'binary_precision': 0.16463415, 'binary_recall': 0.041990668, 'binary_specificity': 0.99245137, 'binary_f1_score': 0.0669145}
confusion matrix:
       0    1
0  18012  137
1    616   27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.7636627, 'recall': 0.6793205, 'specificity': 0.6793205, 'f1': 0.7124605, 'auroc': 0.8077104, 'binary_precision': 0.5542857, 'binary_recall': 0.3716475, 'binary_specificity': 0.9869935, 'binary_f1_score': 0.4449541}
confusion matrix:
      0   1
0  5919  78
1   164  97
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_25.png
early stop counter: 23
val acc:0.9599297642707825, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9654842019081116
after epoch: 25,now: 2024-06-22 15:37:59.617646,epoch time: 0:12:53.184557,used: 5:21:47.903217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9604452, 'precision': 0.9273231, 'recall': 0.827863, 'specificity': 0.827863, 'f1': 0.8694085, 'auroc': 0.95540035, 'binary_precision': 0.8887542, 'binary_recall': 0.66440064, 'binary_specificity': 0.9913253, 'binary_f1_score': 0.7603735}
confusion matrix:
       0     1
0  41940   367
1   1481  2932
---- Validation: 
scalar performance:
{'acc': 0.9593444, 'precision': 0.58914626, 'recall': 0.5296689, 'specificity': 0.5296689, 'f1': 0.54124355, 'auroc': 0.64437866, 'binary_precision': 0.21052632, 'binary_recall': 0.06842924, 'binary_specificity': 0.99090856, 'binary_f1_score': 0.10328639}
confusion matrix:
       0    1
0  17984  165
1    599   44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.7588132, 'recall': 0.6809027, 'specificity': 0.6809027, 'f1': 0.71207726, 'auroc': 0.8165667, 'binary_precision': 0.54444444, 'binary_recall': 0.37547892, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.44444442}
confusion matrix:
      0   1
0  5915  82
1   163  98
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_26.png
early stop counter: 24
val acc:0.9593443870544434, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9654842019081116
after epoch: 26,now: 2024-06-22 15:50:37.890931,epoch time: 0:12:38.273285,used: 5:34:26.176502,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9644478, 'precision': 0.9379276, 'recall': 0.84384215, 'specificity': 0.84384215, 'f1': 0.8838146, 'auroc': 0.96266556, 'binary_precision': 0.9069149, 'binary_recall': 0.6951302, 'binary_specificity': 0.99255407, 'binary_f1_score': 0.787024}
confusion matrix:
       0     1
0  41990   315
1   1346  3069
---- Validation: 
scalar performance:
{'acc': 0.9608344, 'precision': 0.58924633, 'recall': 0.52293974, 'specificity': 0.52293974, 'f1': 0.5322831, 'auroc': 0.6436807, 'binary_precision': 0.21118012, 'binary_recall': 0.05287714, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.08457712}
confusion matrix:
       0    1
0  18022  127
1    609   34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.8201539, 'recall': 0.6874021, 'specificity': 0.6874021, 'f1': 0.7345936, 'auroc': 0.79917526, 'binary_precision': 0.6666667, 'binary_recall': 0.38314176, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.48661795}
confusion matrix:
      0    1
0  5947   50
1   161  100
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_27.png
new oracle model saved
early stop counter: 25
val acc:0.9608343839645386, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9662831425666809
after epoch: 27,now: 2024-06-22 16:02:59.532823,epoch time: 0:12:21.641892,used: 5:46:47.818394,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.960595, 'precision': 0.91701615, 'recall': 0.8392768, 'specificity': 0.8392768, 'f1': 0.8731135, 'auroc': 0.96232927, 'binary_precision': 0.86571836, 'binary_recall': 0.6897099, 'binary_specificity': 0.98884374, 'binary_f1_score': 0.7677558}
confusion matrix:
       0     1
0  41836   472
1   1369  3043
---- Validation: 
scalar performance:
{'acc': 0.9571626, 'precision': 0.58061504, 'recall': 0.53378975, 'specificity': 0.53378975, 'f1': 0.5452551, 'auroc': 0.6563245, 'binary_precision': 0.19318181, 'binary_recall': 0.07931571, 'binary_specificity': 0.98826385, 'binary_f1_score': 0.11245865}
confusion matrix:
       0    1
0  17936  213
1    592   51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.7553618, 'recall': 0.711969, 'specificity': 0.711969, 'f1': 0.7313807, 'auroc': 0.81846607, 'binary_precision': 0.53488374, 'binary_recall': 0.44061303, 'binary_specificity': 0.983325, 'binary_f1_score': 0.4831933}
confusion matrix:
      0    1
0  5897  100
1   146  115
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_28.png
early stop counter: 26
val acc:0.957162618637085, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9662831425666809
after epoch: 28,now: 2024-06-22 16:15:19.522703,epoch time: 0:12:19.989880,used: 5:59:07.808274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96211475, 'precision': 0.9233148, 'recall': 0.842891, 'specificity': 0.842891, 'f1': 0.8777971, 'auroc': 0.9607905, 'binary_precision': 0.87767935, 'binary_recall': 0.6958985, 'binary_specificity': 0.9898835, 'binary_f1_score': 0.77628917}
confusion matrix:
       0     1
0  41879   428
1   1342  3071
---- Validation: 
scalar performance:
{'acc': 0.9604087, 'precision': 0.60842955, 'recall': 0.53472024, 'specificity': 0.53472024, 'f1': 0.5491165, 'auroc': 0.67826045, 'binary_precision': 0.24875621, 'binary_recall': 0.077760495, 'binary_specificity': 0.99167997, 'binary_f1_score': 0.1184834}
confusion matrix:
       0    1
0  17998  151
1    593   50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.7871774, 'recall': 0.69531316, 'specificity': 0.69531316, 'f1': 0.73147136, 'auroc': 0.822953, 'binary_precision': 0.6, 'binary_recall': 0.40229884, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.48165137}
confusion matrix:
      0    1
0  5927   70
1   156  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_29.png
early stop counter: 27
val acc:0.9604086875915527, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9662831425666809
after epoch: 29,now: 2024-06-22 16:27:58.806949,epoch time: 0:12:39.284246,used: 6:11:47.092520,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9645334, 'precision': 0.9202007, 'recall': 0.86288667, 'specificity': 0.86288667, 'f1': 0.88888854, 'auroc': 0.9686084, 'binary_precision': 0.8673768, 'binary_recall': 0.7375453, 'binary_specificity': 0.9882281, 'binary_f1_score': 0.7972097}
confusion matrix:
       0     1
0  41806   498
1   1159  3257
---- Validation: 
scalar performance:
{'acc': 0.9589187, 'precision': 0.6199161, 'recall': 0.5534503, 'specificity': 0.5534503, 'f1': 0.5717219, 'auroc': 0.70600146, 'binary_precision': 0.27046263, 'binary_recall': 0.11819596, 'binary_specificity': 0.9887046, 'binary_f1_score': 0.16450217}
confusion matrix:
       0    1
0  17944  205
1    567   76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.7883625, 'recall': 0.72321504, 'specificity': 0.72321504, 'f1': 0.7511374, 'auroc': 0.83163106, 'binary_precision': 0.6, 'binary_recall': 0.4597701, 'binary_specificity': 0.98666, 'binary_f1_score': 0.52060735}
confusion matrix:
      0    1
0  5917   80
1   141  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_30.png
early stop counter: 28
val acc:0.9589186906814575, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9662831425666809
after epoch: 30,now: 2024-06-22 16:40:30.481491,epoch time: 0:12:31.674542,used: 6:24:18.767062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_11_seed_0_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 6:24:18.767062 at 2024-06-22 16:40:30.481491
persisted model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.3406211, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
oracle model performance metric: 

scalar performance:
{'acc': 0.96628314, 'precision': 0.8201539, 'recall': 0.6874021, 'specificity': 0.6874021, 'f1': 0.7345936, 'auroc': 0.79917526, 'binary_precision': 0.6666667, 'binary_recall': 0.38314176, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.48661795}
confusion matrix:
      0    1
0  5947   50
1   161  100
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204391 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool | 167936 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204391 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool | 167936 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 730152 KiB | 452727 GiB | 452727 GiB |
|       from large pool | 165120 KiB | 658560 KiB | 452374 GiB | 452374 GiB |
|       from small pool |  35968 KiB |  72872 KiB |    352 GiB |    352 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    900 MiB |    900 MiB |    900 MiB |      0 B   |
|       from large pool |    828 MiB |    828 MiB |    828 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 104856 KiB | 260793 KiB | 331858 GiB | 331858 GiB |
|       from large pool |  96256 KiB | 259208 KiB | 331491 GiB | 331491 GiB |
|       from small pool |   8600 KiB |  12473 KiB |    366 GiB |    366 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2076    |    3689    |   49207 K  |   49204 K  |
|       from large pool |      36    |      76    |   16647 K  |   16647 K  |
|       from small pool |    2040    |    3651    |   32559 K  |   32557 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2076    |    3689    |   49207 K  |   49204 K  |
|       from large pool |      36    |      76    |   16647 K  |   16647 K  |
|       from small pool |    2040    |    3651    |   32559 K  |   32557 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      15    |      15    |      15    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      51    |    1476    |   22384 K  |   22384 K  |
|       from large pool |       5    |      10    |    6195 K  |    6195 K  |
|       from small pool |      46    |    1470    |   16188 K  |   16188 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |      0 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |      0 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 730152 KiB | 452727 GiB | 452727 GiB |
|       from large pool |  16640 KiB | 658560 KiB | 452374 GiB | 452374 GiB |
|       from small pool |      0 KiB |  72872 KiB |    352 GiB |    352 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    900 MiB |    900 MiB | 612352 KiB |
|       from large pool | 264192 KiB |    828 MiB |    828 MiB | 583680 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 260793 KiB | 331858 GiB | 331858 GiB |
|       from large pool |  83712 KiB | 259208 KiB | 331491 GiB | 331491 GiB |
|       from small pool |      0 KiB |  16195 KiB |    366 GiB |    366 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3689    |   49207 K  |   49207 K  |
|       from large pool |       2    |      76    |   16647 K  |   16647 K  |
|       from small pool |       0    |    3651    |   32559 K  |   32559 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3689    |   49207 K  |   49207 K  |
|       from large pool |       2    |      76    |   16647 K  |   16647 K  |
|       from small pool |       0    |    3651    |   32559 K  |   32559 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   22385 K  |   22385 K  |
|       from large pool |       1    |      11    |    6195 K  |    6195 K  |
|       from small pool |       0    |    1470    |   16189 K  |   16189 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |      0 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 737101 KiB | 452857 GiB | 452857 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 452495 GiB | 452495 GiB |
|       from small pool |      0 KiB |  73422 KiB |    361 GiB |    361 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 730152 KiB | 452727 GiB | 452727 GiB |
|       from large pool |  16640 KiB | 658560 KiB | 452374 GiB | 452374 GiB |
|       from small pool |      0 KiB |  72872 KiB |    352 GiB |    352 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    900 MiB |    900 MiB | 612352 KiB |
|       from large pool | 264192 KiB |    828 MiB |    828 MiB | 583680 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 260793 KiB | 331858 GiB | 331858 GiB |
|       from large pool |  83712 KiB | 259208 KiB | 331491 GiB | 331491 GiB |
|       from small pool |      0 KiB |  16195 KiB |    366 GiB |    366 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3689    |   49207 K  |   49207 K  |
|       from large pool |       2    |      76    |   16647 K  |   16647 K  |
|       from small pool |       0    |    3651    |   32559 K  |   32559 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3689    |   49207 K  |   49207 K  |
|       from large pool |       2    |      76    |   16647 K  |   16647 K  |
|       from small pool |       0    |    3651    |   32559 K  |   32559 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   22385 K  |   22385 K  |
|       from large pool |       1    |      11    |    6195 K  |    6195 K  |
|       from small pool |       0    |    1470    |   16189 K  |   16189 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970

 Experiment start at: 2024-06-22 16:45:41.092026
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.899893, 'precision': 0.4668646, 'recall': 0.49687526, 'specificity': 0.49687526, 'f1': 0.47577766, 'auroc': 0.4588265, 'binary_precision': 0.026809651, 'binary_recall': 0.0023126735, 'binary_specificity': 0.99143785, 'binary_f1_score': 0.004258037}
confusion matrix:
       0    1
0  42033  363
1   4314   10
---- Validation: 
scalar performance:
{'acc': 0.8840448, 'precision': 0.48368677, 'recall': 0.46492526, 'specificity': 0.46492526, 'f1': 0.47331908, 'auroc': 0.31876582, 'binary_precision': 0.0059288535, 'binary_recall': 0.013372957, 'binary_specificity': 0.91647756, 'binary_f1_score': 0.0082154265}
confusion matrix:
       0     1
0  16558  1509
1    664     9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89558494, 'precision': 0.48169768, 'recall': 0.47289, 'specificity': 0.47289, 'f1': 0.47703144, 'auroc': 0.20989838, 'binary_precision': 0.007614213, 'binary_recall': 0.011538462, 'binary_specificity': 0.93424153, 'binary_f1_score': 0.009174312}
confusion matrix:
      0    1
0  5555  391
1   257    3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 16:58:39.551470,epoch time: 0:12:58.459444,used: 0:12:58.459444,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90601456, 'precision': 0.45365787, 'recall': 0.49920982, 'specificity': 0.49920982, 'f1': 0.47534502, 'auroc': 0.49566728, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99841964, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42329  67
1   4324   0
---- Validation: 
scalar performance:
{'acc': 0.9620064, 'precision': 0.4820063, 'recall': 0.49892068, 'specificity': 0.49892068, 'f1': 0.49031764, 'auroc': 0.3236369, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99784136, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18028  39
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.47904578, 'recall': 0.49983183, 'specificity': 0.49983183, 'f1': 0.4892181, 'auroc': 0.24448742, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5944  2
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-22 17:11:06.599054,epoch time: 0:12:27.047584,used: 0:25:25.507028,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90742725, 'precision': 0.45373303, 'recall': 0.49997643, 'specificity': 0.49997643, 'f1': 0.47573358, 'auroc': 0.5643245, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42395  2
1   4323  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.32382858, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.24895987, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-22 17:23:28.896211,epoch time: 0:12:22.297157,used: 0:37:47.804185,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.90719175, 'precision': 0.453693, 'recall': 0.49988207, 'specificity': 0.49988207, 'f1': 0.47566888, 'auroc': 0.624731, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99976414, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42384  10
1   4326   0
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.48204088, 'recall': 0.49991697, 'specificity': 0.49991697, 'f1': 0.4908162, 'auroc': 0.34147793, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18064  3
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.2290208, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_4.png
early stop counter: 1
val acc:0.9639274477958679, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 4,now: 2024-06-22 17:35:48.881257,epoch time: 0:12:19.985046,used: 0:50:07.789231,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.90708476, 'precision': 0.45370746, 'recall': 0.49979952, 'specificity': 0.49979952, 'f1': 0.47563946, 'auroc': 0.6740763, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99959904, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42379  17
1   4324   0
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.48204184, 'recall': 0.49994466, 'specificity': 0.49994466, 'f1': 0.49083003, 'auroc': 0.34765697, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18065  2
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.33995724, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_5.png
early stop counter: 2
val acc:0.9639807939529419, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-22 17:48:06.244467,epoch time: 0:12:17.363210,used: 1:02:25.152441,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9069777, 'precision': 0.4536928, 'recall': 0.49975234, 'specificity': 0.49975234, 'f1': 0.47561005, 'auroc': 0.77702177, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995047, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42374  21
1   4325   0
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.48203704, 'recall': 0.49980628, 'specificity': 0.49980628, 'f1': 0.49076086, 'auroc': 0.39021355, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18060  7
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.3909797, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_6.png
early stop counter: 3
val acc:0.9637140035629272, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 6,now: 2024-06-22 18:01:02.324274,epoch time: 0:12:56.079807,used: 1:15:21.232248,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.90714896, 'precision': 0.54897374, 'recall': 0.5002619, 'specificity': 0.5002619, 'f1': 0.47657534, 'auroc': 0.8011985, 'binary_precision': 0.1904762, 'binary_recall': 0.00092485547, 'binary_specificity': 0.999599, 'binary_f1_score': 0.0018407732}
confusion matrix:
       0   1
0  42378  17
1   4321   4
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.48204184, 'recall': 0.49994466, 'specificity': 0.49994466, 'f1': 0.49083003, 'auroc': 0.38441136, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18065  2
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.35710692, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_7.png
early stop counter: 4
val acc:0.9639807939529419, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 7,now: 2024-06-22 18:13:48.990087,epoch time: 0:12:46.665813,used: 1:28:07.898061,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.90612155, 'precision': 0.598848, 'recall': 0.5036407, 'specificity': 0.5036407, 'f1': 0.48474723, 'auroc': 0.83188415, 'binary_precision': 0.28965518, 'binary_recall': 0.009710982, 'binary_specificity': 0.99757046, 'binary_f1_score': 0.018791946}
confusion matrix:
       0    1
0  42292  103
1   4283   42
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.48203704, 'recall': 0.49980628, 'specificity': 0.49980628, 'f1': 0.49076086, 'auroc': 0.39765972, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18060  7
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.4010584, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_8.png
early stop counter: 5
val acc:0.9637140035629272, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 8,now: 2024-06-22 18:26:42.888234,epoch time: 0:12:53.898147,used: 1:41:01.796208,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9114726, 'precision': 0.79914665, 'recall': 0.5384574, 'specificity': 0.5384574, 'f1': 0.5488577, 'auroc': 0.8763212, 'binary_precision': 0.6843137, 'binary_recall': 0.0807123, 'binary_specificity': 0.99620247, 'binary_f1_score': 0.14439388}
confusion matrix:
       0    1
0  42235  161
1   3975  349
---- Validation: 
scalar performance:
{'acc': 0.9627001, 'precision': 0.4820188, 'recall': 0.49928045, 'specificity': 0.49928045, 'f1': 0.49049777, 'auroc': 0.40419367, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9985609, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18041  26
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.43978757, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_9.png
early stop counter: 6
val acc:0.9627001285552979, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 9,now: 2024-06-22 18:39:26.857812,epoch time: 0:12:43.969578,used: 1:53:45.765786,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9143836, 'precision': 0.8512748, 'recall': 0.55013365, 'specificity': 0.55013365, 'f1': 0.56858265, 'auroc': 0.89292324, 'binary_precision': 0.7865961, 'binary_recall': 0.103121385, 'binary_specificity': 0.9971459, 'binary_f1_score': 0.1823385}
confusion matrix:
       0    1
0  42274  121
1   3879  446
---- Validation: 
scalar performance:
{'acc': 0.96350056, 'precision': 0.48203322, 'recall': 0.49969557, 'specificity': 0.49969557, 'f1': 0.49070552, 'auroc': 0.44589245, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99939114, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18056  11
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.58617496, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_10.png
early stop counter: 7
val acc:0.9635005593299866, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 10,now: 2024-06-22 18:52:07.282398,epoch time: 0:12:40.424586,used: 2:06:26.190372,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.91849315, 'precision': 0.8347552, 'recall': 0.5867874, 'specificity': 0.5867874, 'f1': 0.62329143, 'auroc': 0.8925885, 'binary_precision': 0.7471154, 'binary_recall': 0.17977788, 'binary_specificity': 0.9937969, 'binary_f1_score': 0.28981724}
confusion matrix:
       0    1
0  42135  263
1   3545  777
---- Validation: 
scalar performance:
{'acc': 0.96179295, 'precision': 0.48200247, 'recall': 0.49881, 'specificity': 0.49881, 'f1': 0.49026224, 'auroc': 0.46169436, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99762, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18024  43
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5696926, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_11.png
early stop counter: 8
val acc:0.9617929458618164, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 11,now: 2024-06-22 19:04:43.907421,epoch time: 0:12:36.625023,used: 2:19:02.815395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.92782533, 'precision': 0.87461424, 'recall': 0.6384316, 'specificity': 0.6384316, 'f1': 0.69116616, 'auroc': 0.9027617, 'binary_precision': 0.817757, 'binary_recall': 0.2833025, 'binary_specificity': 0.99356073, 'binary_f1_score': 0.4208176}
confusion matrix:
       0     1
0  42123   273
1   3099  1225
---- Validation: 
scalar performance:
{'acc': 0.96125937, 'precision': 0.48199284, 'recall': 0.49853325, 'specificity': 0.49853325, 'f1': 0.4901235, 'auroc': 0.47087175, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9970665, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18014  53
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5948187, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_12.png
early stop counter: 9
val acc:0.9612593650817871, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 12,now: 2024-06-22 19:17:39.981271,epoch time: 0:12:56.073850,used: 2:31:58.889245,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.934589, 'precision': 0.89789474, 'recall': 0.67268735, 'specificity': 0.67268735, 'f1': 0.7317679, 'auroc': 0.9285635, 'binary_precision': 0.8581921, 'binary_recall': 0.35129508, 'binary_specificity': 0.99407965, 'binary_f1_score': 0.4985231}
confusion matrix:
       0     1
0  42145   251
1   2805  1519
---- Validation: 
scalar performance:
{'acc': 0.9621665, 'precision': 0.4820092, 'recall': 0.4990037, 'specificity': 0.4990037, 'f1': 0.49035925, 'auroc': 0.5115341, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9980074, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18031  36
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.97912973, 'recall': 0.5019231, 'specificity': 0.5019231, 'f1': 0.49317387, 'auroc': 0.69091713, 'binary_precision': 1.0, 'binary_recall': 0.0038461538, 'binary_specificity': 1.0, 'binary_f1_score': 0.007662835}
confusion matrix:
      0  1
0  5946  0
1   259  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_13.png
new oracle model saved
early stop counter: 10
val acc:0.9621664881706238, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9582661986351013
after epoch: 13,now: 2024-06-22 19:30:36.697773,epoch time: 0:12:56.716502,used: 2:44:55.605747,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9395976, 'precision': 0.90901256, 'recall': 0.69960666, 'specificity': 0.69960666, 'f1': 0.76075506, 'auroc': 0.92443466, 'binary_precision': 0.8755622, 'binary_recall': 0.4050867, 'binary_specificity': 0.9941267, 'binary_f1_score': 0.5539045}
confusion matrix:
       0     1
0  42146   249
1   2573  1752
---- Validation: 
scalar performance:
{'acc': 0.96205974, 'precision': 0.48200727, 'recall': 0.49894837, 'specificity': 0.49894837, 'f1': 0.49033156, 'auroc': 0.51043844, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99789673, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18029  38
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.9792842, 'recall': 0.50576925, 'specificity': 0.50576925, 'f1': 0.5008299, 'auroc': 0.67204773, 'binary_precision': 1.0, 'binary_recall': 0.011538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.022813687}
confusion matrix:
      0  1
0  5946  0
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_14.png
new oracle model saved
early stop counter: 11
val acc:0.962059736251831, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9585884809494019
after epoch: 14,now: 2024-06-22 19:43:32.340639,epoch time: 0:12:55.642866,used: 2:57:51.248613,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9385916, 'precision': 0.90330875, 'recall': 0.6963532, 'specificity': 0.6963532, 'f1': 0.75659204, 'auroc': 0.9114751, 'binary_precision': 0.86472946, 'binary_recall': 0.39907515, 'binary_specificity': 0.9936313, 'binary_f1_score': 0.54611605}
confusion matrix:
       0     1
0  42125   270
1   2599  1726
---- Validation: 
scalar performance:
{'acc': 0.9615795, 'precision': 0.48199862, 'recall': 0.49869928, 'specificity': 0.49869928, 'f1': 0.49020675, 'auroc': 0.52369046, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99739856, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18020  47
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.85450953, 'recall': 0.5113703, 'specificity': 0.5113703, 'f1': 0.51184785, 'auroc': 0.7018907, 'binary_precision': 0.75, 'binary_recall': 0.023076924, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.04477612}
confusion matrix:
      0  1
0  5944  2
1   254  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_15.png
new oracle model saved
early stop counter: 12
val acc:0.9615795016288757, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9587495923042297
after epoch: 15,now: 2024-06-22 19:56:16.455536,epoch time: 0:12:44.114897,used: 3:10:35.363510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9379709, 'precision': 0.9060571, 'recall': 0.6904713, 'specificity': 0.6904713, 'f1': 0.7512455, 'auroc': 0.9181187, 'binary_precision': 0.8712871, 'binary_recall': 0.38676846, 'binary_specificity': 0.9941741, 'binary_f1_score': 0.5357257}
confusion matrix:
       0     1
0  42150   247
1   2651  1672
---- Validation: 
scalar performance:
{'acc': 0.96205974, 'precision': 0.49453208, 'recall': 0.49966362, 'specificity': 0.49966362, 'f1': 0.49173352, 'auroc': 0.49853802, 'binary_precision': 0.025, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99784136, 'binary_f1_score': 0.002805049}
confusion matrix:
       0   1
0  18028  39
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.7712437, 'recall': 0.5130411, 'specificity': 0.5130411, 'f1': 0.51510924, 'auroc': 0.6538086, 'binary_precision': 0.5833333, 'binary_recall': 0.026923077, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.05147059}
confusion matrix:
      0  1
0  5941  5
1   253  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_16.png
early stop counter: 13
val acc:0.962059736251831, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9587495923042297
after epoch: 16,now: 2024-06-22 20:08:56.644084,epoch time: 0:12:40.188548,used: 3:23:15.552058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.94520545, 'precision': 0.903924, 'recall': 0.7401447, 'specificity': 0.7401447, 'f1': 0.79649436, 'auroc': 0.9305975, 'binary_precision': 0.8577814, 'binary_recall': 0.48854432, 'binary_specificity': 0.9917451, 'binary_f1_score': 0.6225302}
confusion matrix:
       0     1
0  42049   350
1   2210  2111
---- Validation: 
scalar performance:
{'acc': 0.9606724, 'precision': 0.4895828, 'recall': 0.49894407, 'specificity': 0.49894407, 'f1': 0.4913235, 'auroc': 0.5581468, 'binary_precision': 0.015151516, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.0027063598}
confusion matrix:
       0   1
0  18002  65
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.79882336, 'recall': 0.53937554, 'specificity': 0.53937554, 'f1': 0.5613167, 'auroc': 0.7222955, 'binary_precision': 0.6363636, 'binary_recall': 0.08076923, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.14334472}
confusion matrix:
      0   1
0  5934  12
1   239  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_17.png
new oracle model saved
early stop counter: 14
val acc:0.9606723785400391, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9595552682876587
after epoch: 17,now: 2024-06-22 20:21:37.245080,epoch time: 0:12:40.600996,used: 3:35:56.153054,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9485659, 'precision': 0.9023802, 'recall': 0.7647042, 'specificity': 0.7647042, 'f1': 0.81597817, 'auroc': 0.93005097, 'binary_precision': 0.85005474, 'binary_recall': 0.53910226, 'binary_specificity': 0.99030614, 'binary_f1_score': 0.6597763}
confusion matrix:
       0     1
0  41987   411
1   1992  2330
---- Validation: 
scalar performance:
{'acc': 0.9593383, 'precision': 0.4978222, 'recall': 0.49968275, 'specificity': 0.49968275, 'f1': 0.4935282, 'auroc': 0.5846186, 'binary_precision': 0.031578947, 'binary_recall': 0.004457652, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.007812499}
confusion matrix:
       0   1
0  17975  92
1    670   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.823401, 'recall': 0.5847726, 'specificity': 0.5847726, 'f1': 0.6282735, 'auroc': 0.75327754, 'binary_precision': 0.6818182, 'binary_recall': 0.17307693, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.27607363}
confusion matrix:
      0   1
0  5925  21
1   215  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_18.png
new oracle model saved
early stop counter: 15
val acc:0.9593383073806763, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9619722962379456
after epoch: 18,now: 2024-06-22 20:34:10.252448,epoch time: 0:12:33.007368,used: 3:48:29.160422,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9530822, 'precision': 0.9128152, 'recall': 0.7867171, 'specificity': 0.7867171, 'f1': 0.8356962, 'auroc': 0.9349693, 'binary_precision': 0.86682725, 'binary_recall': 0.58256245, 'binary_specificity': 0.9908718, 'binary_f1_score': 0.69681877}
confusion matrix:
       0     1
0  42009   387
1   1805  2519
---- Validation: 
scalar performance:
{'acc': 0.9572572, 'precision': 0.51595354, 'recall': 0.5036103, 'specificity': 0.5036103, 'f1': 0.5012553, 'auroc': 0.5894096, 'binary_precision': 0.067567565, 'binary_recall': 0.014858841, 'binary_specificity': 0.9923618, 'binary_f1_score': 0.024360538}
confusion matrix:
       0    1
0  17929  138
1    663   10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.77347326, 'recall': 0.6005666, 'specificity': 0.6005666, 'f1': 0.6428161, 'auroc': 0.7667999, 'binary_precision': 0.58064514, 'binary_recall': 0.20769231, 'binary_specificity': 0.993441, 'binary_f1_score': 0.305949}
confusion matrix:
      0   1
0  5907  39
1   206  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_19.png
early stop counter: 16
val acc:0.9572572112083435, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9619722962379456
after epoch: 19,now: 2024-06-22 20:46:36.438675,epoch time: 0:12:26.186227,used: 4:00:55.346649,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.94798803, 'precision': 0.92085636, 'recall': 0.7464121, 'specificity': 0.7464121, 'f1': 0.80582535, 'auroc': 0.9334805, 'binary_precision': 0.8905863, 'binary_recall': 0.4990745, 'binary_specificity': 0.9937497, 'binary_f1_score': 0.63967973}
confusion matrix:
       0     1
0  42133   265
1   2165  2157
---- Validation: 
scalar performance:
{'acc': 0.9608858, 'precision': 0.5294574, 'recall': 0.5033464, 'specificity': 0.5033464, 'f1': 0.4993934, 'auroc': 0.5952102, 'binary_precision': 0.0945946, 'binary_recall': 0.010401188, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.018741632}
confusion matrix:
       0   1
0  18000  67
1    666   7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.83162534, 'recall': 0.5830177, 'specificity': 0.5830177, 'f1': 0.62650335, 'auroc': 0.76215816, 'binary_precision': 0.6984127, 'binary_recall': 0.16923077, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.27244583}
confusion matrix:
      0   1
0  5927  19
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_20.png
new oracle model saved
early stop counter: 17
val acc:0.9608858227729797, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9621334075927734
after epoch: 20,now: 2024-06-22 20:59:02.155160,epoch time: 0:12:25.716485,used: 4:13:21.063134,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9547945, 'precision': 0.92140734, 'recall': 0.79087055, 'specificity': 0.79087055, 'f1': 0.84137106, 'auroc': 0.9437541, 'binary_precision': 0.88331026, 'binary_recall': 0.58969027, 'binary_specificity': 0.99205077, 'binary_f1_score': 0.70723593}
confusion matrix:
       0     1
0  42057   337
1   1775  2551
---- Validation: 
scalar performance:
{'acc': 0.9601921, 'precision': 0.5223775, 'recall': 0.5029866, 'specificity': 0.5029866, 'f1': 0.49905255, 'auroc': 0.5785346, 'binary_precision': 0.08045977, 'binary_recall': 0.010401188, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.018421052}
confusion matrix:
       0   1
0  17987  80
1    666   7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.7892144, 'recall': 0.5860229, 'specificity': 0.5860229, 'f1': 0.627253, 'auroc': 0.7558992, 'binary_precision': 0.61333334, 'binary_recall': 0.17692308, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.27462688}
confusion matrix:
      0   1
0  5917  29
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_21.png
early stop counter: 18
val acc:0.960192084312439, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9621334075927734
after epoch: 21,now: 2024-06-22 21:11:36.639840,epoch time: 0:12:34.484680,used: 4:25:55.547814,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.95652825, 'precision': 0.9204881, 'recall': 0.8028717, 'specificity': 0.8028717, 'f1': 0.8498354, 'auroc': 0.94862986, 'binary_precision': 0.879099, 'binary_recall': 0.61435187, 'binary_specificity': 0.9913915, 'binary_f1_score': 0.7232593}
confusion matrix:
       0     1
0  42035   365
1   1666  2654
---- Validation: 
scalar performance:
{'acc': 0.95939165, 'precision': 0.5358293, 'recall': 0.5061478, 'specificity': 0.5061478, 'f1': 0.5049174, 'auroc': 0.62013644, 'binary_precision': 0.10714286, 'binary_recall': 0.017830608, 'binary_specificity': 0.99446505, 'binary_f1_score': 0.030573247}
confusion matrix:
       0    1
0  17967  100
1    661   12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.81729406, 'recall': 0.62038606, 'specificity': 0.62038606, 'f1': 0.6703194, 'auroc': 0.78325766, 'binary_precision': 0.6666667, 'binary_recall': 0.24615385, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.35955057}
confusion matrix:
      0   1
0  5914  32
1   196  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_22.png
new oracle model saved
early stop counter: 19
val acc:0.9593916535377502, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9632613658905029
after epoch: 22,now: 2024-06-22 21:24:43.975419,epoch time: 0:13:07.335579,used: 4:39:02.883393,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9546447, 'precision': 0.90768015, 'recall': 0.8024272, 'specificity': 0.8024272, 'f1': 0.8453313, 'auroc': 0.94846225, 'binary_precision': 0.85347867, 'binary_recall': 0.61563367, 'binary_specificity': 0.9892207, 'binary_f1_score': 0.71530294}
confusion matrix:
       0     1
0  41939   457
1   1662  2662
---- Validation: 
scalar performance:
{'acc': 0.9584312, 'precision': 0.53452945, 'recall': 0.5070802, 'specificity': 0.5070802, 'f1': 0.50672734, 'auroc': 0.60882837, 'binary_precision': 0.104477614, 'binary_recall': 0.020802377, 'binary_specificity': 0.9933581, 'binary_f1_score': 0.034696408}
confusion matrix:
       0    1
0  17947  120
1    659   14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.79828334, 'recall': 0.63860774, 'specificity': 0.63860774, 'f1': 0.68621093, 'auroc': 0.7827945, 'binary_precision': 0.62711865, 'binary_recall': 0.2846154, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.39153442}
confusion matrix:
      0   1
0  5902  44
1   186  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_23.png
early stop counter: 20
val acc:0.9584311842918396, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9632613658905029
after epoch: 23,now: 2024-06-22 21:37:55.344326,epoch time: 0:13:11.368907,used: 4:52:14.252300,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.957042, 'precision': 0.9240951, 'recall': 0.8033327, 'specificity': 0.8033327, 'f1': 0.8513133, 'auroc': 0.9464929, 'binary_precision': 0.88629544, 'binary_recall': 0.6147086, 'binary_specificity': 0.9919568, 'binary_f1_score': 0.72593206}
confusion matrix:
       0     1
0  42055   341
1   1666  2658
---- Validation: 
scalar performance:
{'acc': 0.9569904, 'precision': 0.53794557, 'recall': 0.50990933, 'specificity': 0.50990933, 'f1': 0.51151174, 'auroc': 0.6296208, 'binary_precision': 0.11111111, 'binary_recall': 0.028231798, 'binary_specificity': 0.99158686, 'binary_f1_score': 0.0450237}
confusion matrix:
       0    1
0  17915  152
1    654   19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.793704, 'recall': 0.64780265, 'specificity': 0.64780265, 'f1': 0.694044, 'auroc': 0.8057569, 'binary_precision': 0.6171875, 'binary_recall': 0.30384615, 'binary_specificity': 0.9917592, 'binary_f1_score': 0.4072165}
confusion matrix:
      0   1
0  5897  49
1   181  79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_24.png
early stop counter: 21
val acc:0.9569904208183289, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9632613658905029
after epoch: 24,now: 2024-06-22 21:50:59.285992,epoch time: 0:13:03.941666,used: 5:05:18.193966,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9563356, 'precision': 0.9149473, 'recall': 0.80699325, 'specificity': 0.80699325, 'f1': 0.85093296, 'auroc': 0.9539453, 'binary_precision': 0.8672026, 'binary_recall': 0.62372804, 'binary_specificity': 0.9902585, 'binary_f1_score': 0.72558516}
confusion matrix:
       0     1
0  41983   413
1   1627  2697
---- Validation: 
scalar performance:
{'acc': 0.96003205, 'precision': 0.5496269, 'recall': 0.50791043, 'specificity': 0.50791043, 'f1': 0.50781447, 'auroc': 0.651402, 'binary_precision': 0.13461539, 'binary_recall': 0.020802377, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.036036033}
confusion matrix:
       0   1
0  17977  90
1    659  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.8364211, 'recall': 0.647225, 'specificity': 0.647225, 'f1': 0.70131475, 'auroc': 0.78637874, 'binary_precision': 0.7027027, 'binary_recall': 0.3, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.4204852}
confusion matrix:
      0   1
0  5913  33
1   182  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_25.png
new oracle model saved
early stop counter: 22
val acc:0.960032045841217, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9653561115264893
after epoch: 25,now: 2024-06-22 22:04:01.026136,epoch time: 0:13:01.740144,used: 5:18:19.934110,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.95956767, 'precision': 0.91575253, 'recall': 0.8285037, 'specificity': 0.8285037, 'f1': 0.8657343, 'auroc': 0.94943476, 'binary_precision': 0.8646301, 'binary_recall': 0.6676688, 'binary_specificity': 0.98933864, 'binary_f1_score': 0.75349075}
confusion matrix:
       0     1
0  41944   452
1   1437  2887
---- Validation: 
scalar performance:
{'acc': 0.9555496, 'precision': 0.5541192, 'recall': 0.5184606, 'specificity': 0.5184606, 'f1': 0.5242894, 'auroc': 0.6337192, 'binary_precision': 0.14285715, 'binary_recall': 0.04754829, 'binary_specificity': 0.9893729, 'binary_f1_score': 0.07134894}
confusion matrix:
       0    1
0  17875  192
1    641   32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.7430782, 'recall': 0.6806412, 'specificity': 0.6806412, 'f1': 0.70663524, 'auroc': 0.7982975, 'binary_precision': 0.513089, 'binary_recall': 0.37692308, 'binary_specificity': 0.9843592, 'binary_f1_score': 0.4345898}
confusion matrix:
      0   1
0  5853  93
1   162  98
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_26.png
early stop counter: 23
val acc:0.9555495977401733, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9653561115264893
after epoch: 26,now: 2024-06-22 22:17:04.749756,epoch time: 0:13:03.723620,used: 5:31:23.657730,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.959161, 'precision': 0.90855145, 'recall': 0.8333237, 'specificity': 0.8333237, 'f1': 0.86614704, 'auroc': 0.95318544, 'binary_precision': 0.8491604, 'binary_recall': 0.67893517, 'binary_specificity': 0.98771226, 'binary_f1_score': 0.75456655}
confusion matrix:
       0     1
0  41879   521
1   1387  2933
---- Validation: 
scalar performance:
{'acc': 0.9557631, 'precision': 0.57448494, 'recall': 0.52786976, 'specificity': 0.52786976, 'f1': 0.53762907, 'auroc': 0.66275835, 'binary_precision': 0.18292683, 'binary_recall': 0.06686478, 'binary_specificity': 0.98887473, 'binary_f1_score': 0.09793253}
confusion matrix:
       0    1
0  17866  201
1    628   45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.78738797, 'recall': 0.7016378, 'specificity': 0.7016378, 'f1': 0.73609936, 'auroc': 0.8114523, 'binary_precision': 0.6, 'binary_recall': 0.41538462, 'binary_specificity': 0.987891, 'binary_f1_score': 0.4909091}
confusion matrix:
      0    1
0  5874   72
1   152  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_27.png
early stop counter: 24
val acc:0.9557631015777588, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9653561115264893
after epoch: 27,now: 2024-06-22 22:30:01.513234,epoch time: 0:12:56.763478,used: 5:44:20.421208,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9574486, 'precision': 0.92071986, 'recall': 0.8089742, 'specificity': 0.8089742, 'f1': 0.85423094, 'auroc': 0.9486883, 'binary_precision': 0.8784047, 'binary_recall': 0.62679315, 'binary_specificity': 0.99115527, 'binary_f1_score': 0.73156905}
confusion matrix:
       0     1
0  42023   375
1   1613  2709
---- Validation: 
scalar performance:
{'acc': 0.9576841, 'precision': 0.55815893, 'recall': 0.51527596, 'specificity': 0.51527596, 'f1': 0.5199462, 'auroc': 0.6304811, 'binary_precision': 0.15116279, 'binary_recall': 0.038632985, 'binary_specificity': 0.991919, 'binary_f1_score': 0.061538458}
confusion matrix:
       0    1
0  17921  146
1    647   26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.79068565, 'recall': 0.66636074, 'specificity': 0.66636074, 'f1': 0.70971656, 'auroc': 0.8018681, 'binary_precision': 0.60958904, 'binary_recall': 0.3423077, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.43842363}
confusion matrix:
      0   1
0  5889  57
1   171  89
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_28.png
early stop counter: 25
val acc:0.9576840996742249, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9653561115264893
after epoch: 28,now: 2024-06-22 22:42:56.051124,epoch time: 0:12:54.537890,used: 5:57:14.959098,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96110874, 'precision': 0.921116, 'recall': 0.83343196, 'specificity': 0.83343196, 'f1': 0.87091327, 'auroc': 0.95672417, 'binary_precision': 0.8744395, 'binary_recall': 0.67677003, 'binary_specificity': 0.9900939, 'binary_f1_score': 0.7630103}
confusion matrix:
       0     1
0  41978   420
1   1397  2925
---- Validation: 
scalar performance:
{'acc': 0.95624334, 'precision': 0.5738633, 'recall': 0.525973, 'specificity': 0.525973, 'f1': 0.5352506, 'auroc': 0.66844, 'binary_precision': 0.18181819, 'binary_recall': 0.062407132, 'binary_specificity': 0.98953897, 'binary_f1_score': 0.092920355}
confusion matrix:
       0    1
0  17878  189
1    631   42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.8004608, 'recall': 0.71535164, 'specificity': 0.71535164, 'f1': 0.7500685, 'auroc': 0.8231287, 'binary_precision': 0.625, 'binary_recall': 0.44230768, 'binary_specificity': 0.9883956, 'binary_f1_score': 0.51801795}
confusion matrix:
      0    1
0  5877   69
1   145  115
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_29.png
new oracle model saved
early stop counter: 26
val acc:0.9562433362007141, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9655172228813171
after epoch: 29,now: 2024-06-22 22:55:45.982006,epoch time: 0:12:49.930882,used: 6:10:04.889980,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96181506, 'precision': 0.9147308, 'recall': 0.84549034, 'specificity': 0.84549034, 'f1': 0.8761482, 'auroc': 0.95928144, 'binary_precision': 0.8592425, 'binary_recall': 0.7027277, 'binary_specificity': 0.98825306, 'binary_f1_score': 0.77314335}
confusion matrix:
       0     1
0  41896   498
1   1286  3040
---- Validation: 
scalar performance:
{'acc': 0.9532017, 'precision': 0.55950797, 'recall': 0.52654135, 'specificity': 0.52654135, 'f1': 0.5345263, 'auroc': 0.6746584, 'binary_precision': 0.15306123, 'binary_recall': 0.06686478, 'binary_specificity': 0.986218, 'binary_f1_score': 0.09307136}
confusion matrix:
       0    1
0  17818  249
1    628   45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.78048134, 'recall': 0.73473954, 'specificity': 0.73473954, 'f1': 0.75532246, 'auroc': 0.8340312, 'binary_precision': 0.5833333, 'binary_recall': 0.4846154, 'binary_specificity': 0.98486376, 'binary_f1_score': 0.5294118}
confusion matrix:
      0    1
0  5856   90
1   134  126
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_30.png
early stop counter: 27
val acc:0.9532017111778259, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9655172228813171
after epoch: 30,now: 2024-06-22 23:08:41.164279,epoch time: 0:12:55.182273,used: 6:23:00.072253,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_45_41_seed_1_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 6:23:00.072253 at 2024-06-22 23:08:41.164279
persisted model performance metric: 

scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.24895987, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9655172, 'precision': 0.8004608, 'recall': 0.71535164, 'specificity': 0.71535164, 'f1': 0.7500685, 'auroc': 0.8231287, 'binary_precision': 0.625, 'binary_recall': 0.44230768, 'binary_specificity': 0.9883956, 'binary_f1_score': 0.51801795}
confusion matrix:
      0    1
0  5877   69
1   145  115
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204385 KiB | 737735 KiB |    884 TiB |    884 TiB |
|       from large pool | 167936 KiB | 665600 KiB |    884 TiB |    884 TiB |
|       from small pool |  36449 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204385 KiB | 737735 KiB |    884 TiB |    884 TiB |
|       from large pool | 167936 KiB | 665600 KiB |    884 TiB |    884 TiB |
|       from small pool |  36449 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 730152 KiB |    884 TiB |    884 TiB |
|       from large pool | 165120 KiB | 658560 KiB |    883 TiB |    883 TiB |
|       from small pool |  35966 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |    900 MiB |   1478 MiB | 612352 KiB |
|       from large pool |    808 MiB |    828 MiB |   1378 MiB | 583680 KiB |
|       from small pool |     72 MiB |     72 MiB |    100 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 104862 KiB | 260793 KiB | 668181 GiB | 668181 GiB |
|       from large pool |  96256 KiB | 259208 KiB | 667444 GiB | 667443 GiB |
|       from small pool |   8606 KiB |  16195 KiB |    737 GiB |    737 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2064    |    3689    |   98423 K  |   98421 K  |
|       from large pool |      36    |      76    |   33301 K  |   33301 K  |
|       from small pool |    2028    |    3651    |   65121 K  |   65119 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2064    |    3689    |   98423 K  |   98421 K  |
|       from large pool |      36    |      76    |   33301 K  |   33301 K  |
|       from small pool |    2028    |    3651    |   65121 K  |   65119 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      51    |      70    |      20    |
|       from large pool |      14    |      15    |      20    |       6    |
|       from small pool |      36    |      36    |      50    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    1476    |   46257 K  |   46257 K  |
|       from large pool |       5    |      11    |   13954 K  |   13954 K  |
|       from small pool |      47    |    1470    |   32302 K  |   32302 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 737735 KiB |    884 TiB |    884 TiB |
|       from large pool |  16640 KiB | 665600 KiB |    884 TiB |    884 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 737735 KiB |    884 TiB |    884 TiB |
|       from large pool |  16640 KiB | 665600 KiB |    884 TiB |    884 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 730152 KiB |    884 TiB |    884 TiB |
|       from large pool |  16640 KiB | 658560 KiB |    883 TiB |    883 TiB |
|       from small pool |      0 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    900 MiB |   1478 MiB |   1176 MiB |
|       from large pool | 264192 KiB |    828 MiB |   1378 MiB |   1120 MiB |
|       from small pool |  45056 KiB |     72 MiB |    100 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 260793 KiB | 668181 GiB | 668181 GiB |
|       from large pool |  83712 KiB | 259208 KiB | 667444 GiB | 667444 GiB |
|       from small pool |      0 KiB |  16201 KiB |    737 GiB |    737 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3689    |   98423 K  |   98423 K  |
|       from large pool |       2    |      76    |   33301 K  |   33301 K  |
|       from small pool |       0    |    3651    |   65121 K  |   65121 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3689    |   98423 K  |   98423 K  |
|       from large pool |       2    |      76    |   33301 K  |   33301 K  |
|       from small pool |       0    |    3651    |   65121 K  |   65121 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      70    |      39    |
|       from large pool |       9    |      15    |      20    |      11    |
|       from small pool |      22    |      36    |      50    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   46258 K  |   46258 K  |
|       from large pool |       1    |      11    |   13954 K  |   13954 K  |
|       from small pool |       0    |    1470    |   32303 K  |   32303 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 737735 KiB |    884 TiB |    884 TiB |
|       from large pool |  16640 KiB | 665600 KiB |    884 TiB |    884 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 737735 KiB |    884 TiB |    884 TiB |
|       from large pool |  16640 KiB | 665600 KiB |    884 TiB |    884 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 730152 KiB |    884 TiB |    884 TiB |
|       from large pool |  16640 KiB | 658560 KiB |    883 TiB |    883 TiB |
|       from small pool |      0 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    900 MiB |   1478 MiB |   1176 MiB |
|       from large pool | 264192 KiB |    828 MiB |   1378 MiB |   1120 MiB |
|       from small pool |  45056 KiB |     72 MiB |    100 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 260793 KiB | 668181 GiB | 668181 GiB |
|       from large pool |  83712 KiB | 259208 KiB | 667444 GiB | 667444 GiB |
|       from small pool |      0 KiB |  16201 KiB |    737 GiB |    737 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3689    |   98423 K  |   98423 K  |
|       from large pool |       2    |      76    |   33301 K  |   33301 K  |
|       from small pool |       0    |    3651    |   65121 K  |   65121 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3689    |   98423 K  |   98423 K  |
|       from large pool |       2    |      76    |   33301 K  |   33301 K  |
|       from small pool |       0    |    3651    |   65121 K  |   65121 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      70    |      39    |
|       from large pool |       9    |      15    |      20    |      11    |
|       from small pool |      22    |      36    |      50    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   46258 K  |   46258 K  |
|       from large pool |       1    |      11    |   13954 K  |   13954 K  |
|       from small pool |       0    |    1470    |   32303 K  |   32303 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_23_14_01_seed_2_21546970

 Experiment start at: 2024-06-22 23:14:01.206558
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9024932, 'precision': 0.45152608, 'recall': 0.49965727, 'specificity': 0.49965727, 'f1': 0.47437394, 'auroc': 0.41787255, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99931455, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42280  29
1   4539   0
---- Validation: 
scalar performance:
{'acc': 0.9671869, 'precision': 0.53955984, 'recall': 0.5012209, 'specificity': 0.5012209, 'f1': 0.4948848, 'auroc': 0.32199293, 'binary_precision': 0.11111111, 'binary_recall': 0.003322259, 'binary_specificity': 0.99911946, 'binary_f1_score': 0.006451613}
confusion matrix:
       0   1
0  18155  16
1    600   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9596089, 'precision': 0.48057473, 'recall': 0.49916625, 'specificity': 0.49916625, 'f1': 0.4896941, 'auroc': 0.28571862, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5987  10
1   242   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 23:26:57.340355,epoch time: 0:12:56.133797,used: 0:12:56.133797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_23_14_01_seed_2_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9031335, 'precision': 0.45156676, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47455078, 'auroc': 0.43506736, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42310  0
1   4538  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.32211578, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.2976218, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546970_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-22 23:39:41.748220,epoch time: 0:12:44.407865,used: 0:25:40.541662,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_23_14_01_seed_2_21546970
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.5480589, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.34356767, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.2973284, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
--- Logging error ---
Traceback (most recent call last):
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1084, in flush
    self.stream.flush()
OSError: [Errno 122] Disk quota exceeded
Call stack:
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 973, in _bootstrap
    self._bootstrap_inner()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 83, in _worker
    work_item.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
      0  1
0  5997  0
1   242  0
--- Logging error ---
Traceback (most recent call last):
