Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed May 29 13:26:13 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/9.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=9
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748

 Experiment start at: 2024-05-29 13:38:03.312405
before training, model accuracy: 0.2401725947856903
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96261877, 'precision': 0.5357571, 'recall': 0.5052568, 'specificity': 0.5052568, 'f1': 0.5035593, 'auroc': 0.59898096, 'binary_precision': 0.104761906, 'binary_recall': 0.014955812, 'binary_specificity': 0.9955578, 'binary_f1_score': 0.026174895}
confusion matrix:
       0    1
0  42133  188
1   1449   22
---- Validation: 
scalar performance:
{'acc': 0.96179223, 'precision': 0.4955311, 'recall': 0.49943388, 'specificity': 0.49943388, 'f1': 0.49303108, 'auroc': 0.50298214, 'binary_precision': 0.025316456, 'binary_recall': 0.00311042, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.005540166}
confusion matrix:
       0   1
0  18072  77
1    641   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9539789, 'precision': 0.49637127, 'recall': 0.49958122, 'specificity': 0.49958122, 'f1': 0.4916701, 'auroc': 0.4939481, 'binary_precision': 0.03448276, 'binary_recall': 0.0038314175, 'binary_specificity': 0.995331, 'binary_f1_score': 0.0068965517}
confusion matrix:
      0   1
0  5969  28
1   260   1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-29 14:04:41.612910,epoch time: 0:26:38.300505,used: 0:26:38.300505,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9659527, 'precision': 0.6407857, 'recall': 0.50534123, 'specificity': 0.50534123, 'f1': 0.50248486, 'auroc': 0.7039348, 'binary_precision': 0.3148148, 'binary_recall': 0.011556764, 'binary_specificity': 0.9991257, 'binary_f1_score': 0.022295082}
confusion matrix:
       0   1
0  42284  37
1   1454  17
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.55795336, 'recall': 0.5018645, 'specificity': 0.5018645, 'f1': 0.49562752, 'auroc': 0.6307814, 'binary_precision': 0.15, 'binary_recall': 0.00466563, 'binary_specificity': 0.9990633, 'binary_f1_score': 0.009049774}
confusion matrix:
       0   1
0  18132  17
1    640   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.47913003, 'recall': 0.49958313, 'specificity': 0.49958313, 'f1': 0.48914286, 'auroc': 0.65780973, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5992  5
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-29 14:27:47.016693,epoch time: 0:23:05.403783,used: 0:49:43.704288,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96645504, 'precision': 0.7575692, 'recall': 0.50560904, 'specificity': 0.50560904, 'f1': 0.50277805, 'auroc': 0.7977509, 'binary_precision': 0.5483871, 'binary_recall': 0.011548913, 'binary_specificity': 0.9996692, 'binary_f1_score': 0.022621423}
confusion matrix:
       0   1
0  42306  14
1   1455  17
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.62579566, 'recall': 0.50141746, 'specificity': 0.50141746, 'f1': 0.4943316, 'auroc': 0.7661963, 'binary_precision': 0.2857143, 'binary_recall': 0.00311042, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.0061538466}
confusion matrix:
       0  1
0  18144  5
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.81262994, 'recall': 0.50374806, 'specificity': 0.50374806, 'f1': 0.49696523, 'auroc': 0.7252873, 'binary_precision': 0.6666667, 'binary_recall': 0.007662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5996  1
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-29 14:50:56.901330,epoch time: 0:23:09.884637,used: 1:12:53.588925,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.7333638, 'recall': 0.50524575, 'specificity': 0.50524575, 'f1': 0.5020881, 'auroc': 0.8363882, 'binary_precision': 0.5, 'binary_recall': 0.010869565, 'binary_specificity': 0.9996219, 'binary_f1_score': 0.021276597}
confusion matrix:
       0   1
0  42304  16
1   1456  16
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.6496539, 'recall': 0.50289005, 'specificity': 0.50289005, 'f1': 0.49734685, 'auroc': 0.8212892, 'binary_precision': 0.33333334, 'binary_recall': 0.00622084, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.0122137405}
confusion matrix:
       0  1
0  18141  8
1    639  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.8366661, 'recall': 0.5094118, 'specificity': 0.5094118, 'f1': 0.50812435, 'auroc': 0.818238, 'binary_precision': 0.71428573, 'binary_recall': 0.019157087, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.037313428}
confusion matrix:
      0  1
0  5995  2
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 1
val acc:0.9655704498291016, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9584531784057617 / 0.9587727785110474
after epoch: 4,now: 2024-05-29 15:14:06.339562,epoch time: 0:23:09.438232,used: 1:36:03.027157,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.724095, 'recall': 0.50425637, 'specificity': 0.50425637, 'f1': 0.50014037, 'auroc': 0.8638325, 'binary_precision': 0.4814815, 'binary_recall': 0.008843537, 'binary_specificity': 0.9996692, 'binary_f1_score': 0.01736807}
confusion matrix:
       0   1
0  42308  14
1   1457  13
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.73299086, 'recall': 0.5030002, 'specificity': 0.5030002, 'f1': 0.49743947, 'auroc': 0.84228873, 'binary_precision': 0.5, 'binary_recall': 0.00622084, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.012288787}
confusion matrix:
       0  1
0  18145  4
1    639  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8961932, 'recall': 0.50949514, 'specificity': 0.50949514, 'f1': 0.50823593, 'auroc': 0.8437207, 'binary_precision': 0.8333333, 'binary_recall': 0.019157087, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.037453182}
confusion matrix:
      0  1
0  5996  1
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-05-29 15:37:38.633463,epoch time: 0:23:32.293901,used: 1:59:35.321058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9663637, 'precision': 0.7055114, 'recall': 0.5026011, 'specificity': 0.5026011, 'f1': 0.4968182, 'auroc': 0.8767235, 'binary_precision': 0.44444445, 'binary_recall': 0.0054384773, 'binary_specificity': 0.9997637, 'binary_f1_score': 0.010745467}
confusion matrix:
       0   1
0  42311  10
1   1463   8
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.69725084, 'recall': 0.5022226, 'specificity': 0.5022226, 'f1': 0.4958971, 'auroc': 0.8525531, 'binary_precision': 0.42857143, 'binary_recall': 0.00466563, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.009230768}
confusion matrix:
       0  1
0  18145  4
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.9796833, 'recall': 0.51341, 'specificity': 0.51341, 'f1': 0.51575035, 'auroc': 0.8572664, 'binary_precision': 1.0, 'binary_recall': 0.026819924, 'binary_specificity': 1.0, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5997  0
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 1
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9594119787216187
after epoch: 6,now: 2024-05-29 16:01:12.283757,epoch time: 0:23:33.650294,used: 2:23:08.971352,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9665464, 'precision': 0.8679179, 'recall': 0.5033613, 'specificity': 0.5033613, 'f1': 0.49822637, 'auroc': 0.8806977, 'binary_precision': 0.7692308, 'binary_recall': 0.006793478, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.013468013}
confusion matrix:
       0   1
0  42317   3
1   1462  10
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.73296607, 'recall': 0.5022502, 'specificity': 0.5022502, 'f1': 0.495918, 'auroc': 0.8645853, 'binary_precision': 0.5, 'binary_recall': 0.00466563, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.009244992}
confusion matrix:
       0  1
0  18146  3
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.87944984, 'recall': 0.50757945, 'specificity': 0.50757945, 'f1': 0.50450695, 'auroc': 0.8723519, 'binary_precision': 0.8, 'binary_recall': 0.01532567, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.030075189}
confusion matrix:
      0  1
0  5996  1
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9594119787216187
after epoch: 7,now: 2024-05-29 16:27:26.824962,epoch time: 0:26:14.541205,used: 2:49:23.512557,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9663409, 'precision': 0.7297349, 'recall': 0.5196479, 'specificity': 0.5196479, 'f1': 0.5290704, 'auroc': 0.89273214, 'binary_precision': 0.4918033, 'binary_recall': 0.04076087, 'binary_specificity': 0.998535, 'binary_f1_score': 0.07528231}
confusion matrix:
       0   1
0  42258  62
1   1412  60
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.72695243, 'recall': 0.5142235, 'specificity': 0.5142235, 'f1': 0.5191334, 'auroc': 0.8805489, 'binary_precision': 0.4871795, 'binary_recall': 0.02954899, 'binary_specificity': 0.998898, 'binary_f1_score': 0.055718478}
confusion matrix:
       0   1
0  18129  20
1    624  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.9454254, 'recall': 0.54964167, 'specificity': 0.54964167, 'f1': 0.58027375, 'auroc': 0.87400883, 'binary_precision': 0.9285714, 'binary_recall': 0.099616855, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.1799308}
confusion matrix:
      0   1
0  5995   2
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 3
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9589325785636902 / 0.9621284604072571
after epoch: 8,now: 2024-05-29 16:51:00.470194,epoch time: 0:23:33.645232,used: 3:12:57.157789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9667291, 'precision': 0.75991595, 'recall': 0.526406, 'specificity': 0.526406, 'f1': 0.5410002, 'auroc': 0.8922502, 'binary_precision': 0.55172414, 'binary_recall': 0.054347824, 'binary_specificity': 0.9984641, 'binary_f1_score': 0.09894867}
confusion matrix:
       0   1
0  42255  65
1   1392  80
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.7411171, 'recall': 0.52630705, 'specificity': 0.52630705, 'f1': 0.5405345, 'auroc': 0.8877424, 'binary_precision': 0.5147059, 'binary_recall': 0.054432347, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.09845289}
confusion matrix:
       0   1
0  18116  33
1    608  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.8690648, 'recall': 0.57754356, 'specificity': 0.57754356, 'f1': 0.6210666, 'auroc': 0.8871748, 'binary_precision': 0.7735849, 'binary_recall': 0.15708812, 'binary_specificity': 0.997999, 'binary_f1_score': 0.2611465}
confusion matrix:
      0   1
0  5985  12
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-05-29 17:14:18.992527,epoch time: 0:23:18.522333,used: 3:36:15.680122,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9662267, 'precision': 0.7268139, 'recall': 0.53663754, 'specificity': 0.53663754, 'f1': 0.55715555, 'auroc': 0.90694916, 'binary_precision': 0.4848485, 'binary_recall': 0.07608695, 'binary_specificity': 0.9971881, 'binary_f1_score': 0.13153258}
confusion matrix:
       0    1
0  42201  119
1   1360  112
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.7155603, 'recall': 0.5328096, 'specificity': 0.5328096, 'f1': 0.5508001, 'auroc': 0.8932344, 'binary_precision': 0.4631579, 'binary_recall': 0.06842924, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.11924119}
confusion matrix:
       0   1
0  18098  51
1    599  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.8892355, 'recall': 0.6061958, 'specificity': 0.6061958, 'f1': 0.6607523, 'auroc': 0.8826636, 'binary_precision': 0.8115942, 'binary_recall': 0.21455939, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.33939394}
confusion matrix:
      0   1
0  5984  13
1   205  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 1
val acc:0.9654108285903931, best validation acc: 0.9658897519111633, corresponding to test acc:                         0.9629274606704712 / 0.9651646018028259
after epoch: 10,now: 2024-05-29 17:38:06.938074,epoch time: 0:23:47.945547,used: 4:00:03.625669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9662267, 'precision': 0.72814757, 'recall': 0.5431947, 'specificity': 0.5431947, 'f1': 0.56711674, 'auroc': 0.9000064, 'binary_precision': 0.48708487, 'binary_recall': 0.089673914, 'binary_specificity': 0.9967155, 'binary_f1_score': 0.15146299}
confusion matrix:
       0    1
0  42181  139
1   1340  132
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.7343633, 'recall': 0.54425323, 'specificity': 0.54425323, 'f1': 0.5687986, 'auroc': 0.8906768, 'binary_precision': 0.5, 'binary_recall': 0.09175739, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.15505913}
confusion matrix:
       0   1
0  18090  59
1    584  59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.9185441, 'recall': 0.6141922, 'specificity': 0.6141922, 'f1': 0.6732018, 'auroc': 0.8888947, 'binary_precision': 0.8695652, 'binary_recall': 0.22988506, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.36363637}
confusion matrix:
      0   1
0  5988   9
1   201  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9658897519111633, corresponding to test acc:                         0.9629274606704712 / 0.9664429426193237
after epoch: 11,now: 2024-05-29 18:02:10.810231,epoch time: 0:24:03.872157,used: 4:24:07.497826,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96645504, 'precision': 0.73747116, 'recall': 0.54364073, 'specificity': 0.54364073, 'f1': 0.56810135, 'auroc': 0.90801495, 'binary_precision': 0.50570345, 'binary_recall': 0.09035326, 'binary_specificity': 0.99692816, 'binary_f1_score': 0.15331413}
confusion matrix:
       0    1
0  42190  130
1   1339  133
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.72848356, 'recall': 0.55764407, 'specificity': 0.55764407, 'f1': 0.587335, 'auroc': 0.8968962, 'binary_precision': 0.48734176, 'binary_recall': 0.11975116, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.19225967}
confusion matrix:
       0   1
0  18068  81
1    566  77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.9164411, 'recall': 0.61036074, 'specificity': 0.61036074, 'f1': 0.66813225, 'auroc': 0.8895335, 'binary_precision': 0.86567163, 'binary_recall': 0.22222222, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.35365853}
confusion matrix:
      0   1
0  5988   9
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 3
val acc:0.9655704498291016, best validation acc: 0.9658897519111633, corresponding to test acc:                         0.9629274606704712 / 0.9664429426193237
after epoch: 12,now: 2024-05-29 18:25:05.811906,epoch time: 0:22:55.001675,used: 4:47:02.499501,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9667291, 'precision': 0.74705595, 'recall': 0.549379, 'specificity': 0.549379, 'f1': 0.5768848, 'auroc': 0.904883, 'binary_precision': 0.5244755, 'binary_recall': 0.10197145, 'binary_specificity': 0.9967865, 'binary_f1_score': 0.17074558}
confusion matrix:
       0    1
0  42185  136
1   1321  150
---- Validation: 
scalar performance:
{'acc': 0.9649851, 'precision': 0.70974255, 'recall': 0.5505905, 'specificity': 0.5505905, 'f1': 0.5766997, 'auroc': 0.900731, 'binary_precision': 0.45033112, 'binary_recall': 0.10575428, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.17128463}
confusion matrix:
       0   1
0  18066  83
1    575  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.92677367, 'recall': 0.63143355, 'specificity': 0.63143355, 'f1': 0.6952865, 'auroc': 0.8882251, 'binary_precision': 0.88461536, 'binary_recall': 0.26436782, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.4070796}
confusion matrix:
      0   1
0  5988   9
1   192  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 4
val acc:0.9649850726127625, best validation acc: 0.9658897519111633, corresponding to test acc:                         0.9629274606704712 / 0.9678810834884644
after epoch: 13,now: 2024-05-29 18:48:02.677152,epoch time: 0:22:56.865246,used: 5:09:59.364747,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96695745, 'precision': 0.74826634, 'recall': 0.5842747, 'specificity': 0.5842747, 'f1': 0.6222292, 'auroc': 0.9100735, 'binary_precision': 0.52459013, 'binary_recall': 0.17403127, 'binary_specificity': 0.9945181, 'binary_f1_score': 0.26135784}
confusion matrix:
       0    1
0  42089  232
1   1215  256
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.7370715, 'recall': 0.5952846, 'specificity': 0.5952846, 'f1': 0.6329916, 'auroc': 0.9060005, 'binary_precision': 0.5019763, 'binary_recall': 0.19751166, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.28348213}
confusion matrix:
       0    1
0  18023  126
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97267497, 'precision': 0.91075647, 'recall': 0.7090605, 'specificity': 0.7090605, 'f1': 0.7742784, 'auroc': 0.89690626, 'binary_precision': 0.84615386, 'binary_recall': 0.42145595, 'binary_specificity': 0.996665, 'binary_f1_score': 0.56265986}
confusion matrix:
      0    1
0  5977   20
1   151  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 5
val acc:0.9658365249633789, best validation acc: 0.9658897519111633, corresponding to test acc:                         0.9629274606704712 / 0.9726749658584595
after epoch: 14,now: 2024-05-29 19:10:58.366028,epoch time: 0:22:55.688876,used: 5:32:55.053623,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96656924, 'precision': 0.74076855, 'recall': 0.55976486, 'specificity': 0.55976486, 'f1': 0.59102654, 'auroc': 0.9160354, 'binary_precision': 0.51123595, 'binary_recall': 0.123641305, 'binary_specificity': 0.9958885, 'binary_f1_score': 0.19912474}
confusion matrix:
       0    1
0  42146  174
1   1290  182
---- Validation: 
scalar performance:
{'acc': 0.9650915, 'precision': 0.72012854, 'recall': 0.57464737, 'specificity': 0.57464737, 'f1': 0.6078919, 'auroc': 0.90020293, 'binary_precision': 0.46948355, 'binary_recall': 0.15552099, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.23364487}
confusion matrix:
       0    1
0  18036  113
1    543  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9686801, 'precision': 0.896436, 'recall': 0.65750307, 'specificity': 0.65750307, 'f1': 0.7212186, 'auroc': 0.91743124, 'binary_precision': 0.8217822, 'binary_recall': 0.31800765, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.45856354}
confusion matrix:
      0   1
0  5979  18
1   178  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 6
val acc:0.9650915265083313, best validation acc: 0.9658897519111633, corresponding to test acc:                         0.9629274606704712 / 0.9726749658584595
after epoch: 15,now: 2024-05-29 19:33:50.960180,epoch time: 0:22:52.594152,used: 5:55:47.647775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9658385, 'precision': 0.7264793, 'recall': 0.59845984, 'specificity': 0.59845984, 'f1': 0.63472, 'auroc': 0.9128986, 'binary_precision': 0.4800638, 'binary_recall': 0.2046227, 'binary_specificity': 0.992297, 'binary_f1_score': 0.28693995}
confusion matrix:
       0    1
0  41995  326
1   1170  301
---- Validation: 
scalar performance:
{'acc': 0.9643465, 'precision': 0.71506816, 'recall': 0.6072641, 'specificity': 0.6072641, 'f1': 0.6411666, 'auroc': 0.9061316, 'binary_precision': 0.45714286, 'binary_recall': 0.22395024, 'binary_specificity': 0.990578, 'binary_f1_score': 0.3006263}
confusion matrix:
       0    1
0  17978  171
1    499  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97315437, 'precision': 0.9077819, 'recall': 0.71847224, 'specificity': 0.71847224, 'f1': 0.78201294, 'auroc': 0.89354706, 'binary_precision': 0.8394161, 'binary_recall': 0.44061303, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.5778895}
confusion matrix:
      0    1
0  5975   22
1   146  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 7
val acc:0.9643465280532837, best validation acc: 0.9658897519111633, corresponding to test acc:                         0.9629274606704712 / 0.9731543660163879
after epoch: 16,now: 2024-05-29 19:56:37.033304,epoch time: 0:22:46.073124,used: 6:18:33.720899,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9665236, 'precision': 0.7391212, 'recall': 0.6131823, 'specificity': 0.6131823, 'f1': 0.6514382, 'auroc': 0.92082554, 'binary_precision': 0.50438595, 'binary_recall': 0.234375, 'binary_specificity': 0.9919896, 'binary_f1_score': 0.3200371}
confusion matrix:
       0    1
0  41981  339
1   1127  345
---- Validation: 
scalar performance:
{'acc': 0.96525115, 'precision': 0.72882813, 'recall': 0.61448294, 'specificity': 0.61448294, 'f1': 0.65062654, 'auroc': 0.90566635, 'binary_precision': 0.4841772, 'binary_recall': 0.23794712, 'binary_specificity': 0.9910188, 'binary_f1_score': 0.31908238}
confusion matrix:
       0    1
0  17986  163
1    490  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9742729, 'precision': 0.9146109, 'recall': 0.73004985, 'specificity': 0.73004985, 'f1': 0.79360235, 'auroc': 0.8991169, 'binary_precision': 0.85211265, 'binary_recall': 0.46360153, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.6004963}
confusion matrix:
      0    1
0  5976   21
1   140  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 8
val acc:0.9652511477470398, best validation acc: 0.9658897519111633, corresponding to test acc:                         0.9629274606704712 / 0.9742729067802429
after epoch: 17,now: 2024-05-29 20:19:30.094916,epoch time: 0:22:53.061612,used: 6:41:26.782511,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9665464, 'precision': 0.73944366, 'recall': 0.60827625, 'specificity': 0.60827625, 'f1': 0.6467228, 'auroc': 0.9225596, 'binary_precision': 0.5053599, 'binary_recall': 0.22418478, 'binary_specificity': 0.9923677, 'binary_f1_score': 0.31058824}
confusion matrix:
       0    1
0  41997  323
1   1142  330
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.7379425, 'recall': 0.62828696, 'specificity': 0.62828696, 'f1': 0.66501, 'auroc': 0.90872324, 'binary_precision': 0.5014663, 'binary_recall': 0.2659409, 'binary_specificity': 0.9906331, 'binary_f1_score': 0.347561}
confusion matrix:
       0    1
0  17979  170
1    472  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9753915, 'precision': 0.928518, 'recall': 0.73613054, 'specificity': 0.73613054, 'f1': 0.8021014, 'auroc': 0.9046458, 'binary_precision': 0.8794326, 'binary_recall': 0.47509578, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.6169154}
confusion matrix:
      0    1
0  5980   17
1   137  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 9
val acc:0.9658365249633789, best validation acc: 0.9658897519111633, corresponding to test acc:                         0.9629274606704712 / 0.9753915071487427
after epoch: 18,now: 2024-05-29 20:42:26.627195,epoch time: 0:22:56.532279,used: 7:04:23.314790,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9661354, 'precision': 0.72805536, 'recall': 0.5611797, 'specificity': 0.5611797, 'f1': 0.5920505, 'auroc': 0.9184717, 'binary_precision': 0.4857143, 'binary_recall': 0.12703805, 'binary_specificity': 0.99532133, 'binary_f1_score': 0.20140012}
confusion matrix:
       0    1
0  42122  198
1   1285  187
---- Validation: 
scalar performance:
{'acc': 0.96525115, 'precision': 0.72261095, 'recall': 0.5702297, 'specificity': 0.5702297, 'f1': 0.60288566, 'auroc': 0.9087899, 'binary_precision': 0.47474748, 'binary_recall': 0.14618973, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.22354339}
confusion matrix:
       0    1
0  18045  104
1    549   94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97203577, 'precision': 0.9106711, 'recall': 0.6995653, 'specificity': 0.6995653, 'f1': 0.7655144, 'auroc': 0.90305185, 'binary_precision': 0.8467742, 'binary_recall': 0.40229884, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.54545456}
confusion matrix:
      0    1
0  5978   19
1   156  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 10
val acc:0.9652511477470398, best validation acc: 0.9658897519111633, corresponding to test acc:                         0.9629274606704712 / 0.9753915071487427
after epoch: 19,now: 2024-05-29 21:05:16.630850,epoch time: 0:22:50.003655,used: 7:27:13.318445,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9666834, 'precision': 0.7418102, 'recall': 0.67140496, 'specificity': 0.67140496, 'f1': 0.69997555, 'auroc': 0.92382354, 'binary_precision': 0.50581396, 'binary_recall': 0.35486063, 'binary_specificity': 0.98794925, 'binary_f1_score': 0.41709945}
confusion matrix:
       0    1
0  41811  510
1    949  522
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.73006654, 'recall': 0.6750446, 'specificity': 0.6750446, 'f1': 0.69839483, 'auroc': 0.91819346, 'binary_precision': 0.48247424, 'binary_recall': 0.36391914, 'binary_specificity': 0.98617005, 'binary_f1_score': 0.41489363}
confusion matrix:
       0    1
0  17898  251
1    409  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97730905, 'precision': 0.90183663, 'recall': 0.78843635, 'specificity': 0.78843635, 'f1': 0.8349248, 'auroc': 0.91510636, 'binary_precision': 0.8216216, 'binary_recall': 0.58237547, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.68161434}
confusion matrix:
      0    1
0  5964   33
1   109  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 11
val acc:0.9648786783218384, best validation acc: 0.9658897519111633, corresponding to test acc:                         0.9629274606704712 / 0.9773090481758118
after epoch: 20,now: 2024-05-29 21:27:57.259023,epoch time: 0:22:40.628173,used: 7:49:53.946618,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9666834, 'precision': 0.7419995, 'recall': 0.66834533, 'specificity': 0.66834533, 'f1': 0.6978663, 'auroc': 0.920817, 'binary_precision': 0.50641656, 'binary_recall': 0.34850544, 'binary_specificity': 0.9881852, 'binary_f1_score': 0.41287726}
confusion matrix:
       0    1
0  41820  500
1    959  513
---- Validation: 
scalar performance:
{'acc': 0.9650915, 'precision': 0.7306409, 'recall': 0.6564034, 'specificity': 0.6564034, 'f1': 0.6856158, 'auroc': 0.91631615, 'binary_precision': 0.4849188, 'binary_recall': 0.32503888, 'binary_specificity': 0.98776793, 'binary_f1_score': 0.38919926}
confusion matrix:
       0    1
0  17927  222
1    434  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97619045, 'precision': 0.88542485, 'recall': 0.7896851, 'specificity': 0.7896851, 'f1': 0.8300868, 'auroc': 0.9096426, 'binary_precision': 0.7886598, 'binary_recall': 0.5862069, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.6725275}
confusion matrix:
      0    1
0  5956   41
1   108  153
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 12
val acc:0.9650915265083313, best validation acc: 0.9658897519111633, corresponding to test acc:                         0.9629274606704712 / 0.9773090481758118
after epoch: 21,now: 2024-05-29 21:50:49.723449,epoch time: 0:22:52.464426,used: 8:12:46.411044,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96684325, 'precision': 0.74321806, 'recall': 0.6548523, 'specificity': 0.6548523, 'f1': 0.6882198, 'auroc': 0.9210491, 'binary_precision': 0.50974023, 'binary_recall': 0.32040817, 'binary_specificity': 0.9892964, 'binary_f1_score': 0.3934837}
confusion matrix:
       0    1
0  41869  453
1    999  471
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.735433, 'recall': 0.6708473, 'specificity': 0.6708473, 'f1': 0.6974393, 'auroc': 0.9158554, 'binary_precision': 0.4935065, 'binary_recall': 0.35458788, 'binary_specificity': 0.98710674, 'binary_f1_score': 0.41266972}
confusion matrix:
       0    1
0  17915  234
1    415  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97635025, 'precision': 0.9018116, 'recall': 0.7732774, 'specificity': 0.7732774, 'f1': 0.82414937, 'auroc': 0.91399723, 'binary_precision': 0.82285714, 'binary_recall': 0.55172414, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.6605504}
confusion matrix:
      0    1
0  5966   31
1   117  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 13
val acc:0.9654640555381775, best validation acc: 0.9658897519111633, corresponding to test acc:                         0.9629274606704712 / 0.9773090481758118
after epoch: 22,now: 2024-05-29 22:13:43.291200,epoch time: 0:22:53.567751,used: 8:35:39.978795,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9665464, 'precision': 0.7400279, 'recall': 0.6466358, 'specificity': 0.6466358, 'f1': 0.68089217, 'auroc': 0.9239572, 'binary_precision': 0.5039459, 'binary_recall': 0.30366847, 'binary_specificity': 0.98960304, 'binary_f1_score': 0.37897417}
confusion matrix:
       0    1
0  41880  440
1   1025  447
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.7356305, 'recall': 0.65290105, 'specificity': 0.65290105, 'f1': 0.6845089, 'auroc': 0.91806746, 'binary_precision': 0.49514562, 'binary_recall': 0.31726283, 'binary_specificity': 0.98853934, 'binary_f1_score': 0.38672987}
confusion matrix:
       0    1
0  17941  208
1    439  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97714925, 'precision': 0.90467536, 'recall': 0.782856, 'specificity': 0.782856, 'f1': 0.8319472, 'auroc': 0.9174639, 'binary_precision': 0.8277778, 'binary_recall': 0.57088125, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.675737}
confusion matrix:
      0    1
0  5966   31
1   112  149
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 14
val acc:0.9655704498291016, best validation acc: 0.9658897519111633, corresponding to test acc:                         0.9629274606704712 / 0.9773090481758118
after epoch: 23,now: 2024-05-29 22:36:33.552823,epoch time: 0:22:50.261623,used: 8:58:30.240418,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9672771, 'precision': 0.7484072, 'recall': 0.68045545, 'specificity': 0.68045545, 'f1': 0.70848614, 'auroc': 0.9287704, 'binary_precision': 0.5184136, 'binary_recall': 0.37296197, 'binary_specificity': 0.98794895, 'binary_f1_score': 0.43382064}
confusion matrix:
       0    1
0  41810  510
1    923  549
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.74225646, 'recall': 0.685429, 'specificity': 0.685429, 'f1': 0.7096535, 'auroc': 0.9185984, 'binary_precision': 0.50614756, 'binary_recall': 0.38413686, 'binary_specificity': 0.98672104, 'binary_f1_score': 0.43678162}
confusion matrix:
       0    1
0  17908  241
1    396  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.9109213, 'recall': 0.78876984, 'specificity': 0.78876984, 'f1': 0.83817667, 'auroc': 0.9127674, 'binary_precision': 0.839779, 'binary_recall': 0.58237547, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.6877828}
confusion matrix:
      0    1
0  5968   29
1   109  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-05-29 22:59:19.717002,epoch time: 0:22:46.164179,used: 9:21:16.404597,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9669346, 'precision': 0.74453765, 'recall': 0.67120683, 'specificity': 0.67120683, 'f1': 0.7007287, 'auroc': 0.9230962, 'binary_precision': 0.5112856, 'binary_recall': 0.35418084, 'binary_specificity': 0.9882328, 'binary_f1_score': 0.4184739}
confusion matrix:
       0    1
0  41823  498
1    950  521
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.739856, 'recall': 0.69054157, 'specificity': 0.69054157, 'f1': 0.71205914, 'auroc': 0.9144398, 'binary_precision': 0.5009862, 'binary_recall': 0.39502332, 'binary_specificity': 0.98605984, 'binary_f1_score': 0.4417391}
confusion matrix:
       0    1
0  17896  253
1    389  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97714925, 'precision': 0.9012711, 'recall': 0.78652066, 'specificity': 0.78652066, 'f1': 0.8334025, 'auroc': 0.91305745, 'binary_precision': 0.8206522, 'binary_recall': 0.5785441, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.6786517}
confusion matrix:
      0    1
0  5964   33
1   110  151
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 1
val acc:0.9658365249633789, best validation acc: 0.9661026000976562, corresponding to test acc:                         0.9779482483863831 / 0.9779482483863831
after epoch: 25,now: 2024-05-29 23:22:13.108718,epoch time: 0:22:53.391716,used: 9:44:09.796313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96723145, 'precision': 0.7476617, 'recall': 0.7204307, 'specificity': 0.7204307, 'f1': 0.7331673, 'auroc': 0.9216826, 'binary_precision': 0.51417625, 'binary_recall': 0.4558424, 'binary_specificity': 0.9850189, 'binary_f1_score': 0.48325536}
confusion matrix:
       0    1
0  41686  634
1    801  671
---- Validation: 
scalar performance:
{'acc': 0.96525115, 'precision': 0.7367859, 'recall': 0.7307415, 'specificity': 0.7307415, 'f1': 0.73372, 'auroc': 0.91924405, 'binary_precision': 0.49201277, 'binary_recall': 0.47900465, 'binary_specificity': 0.9824784, 'binary_f1_score': 0.4854216}
confusion matrix:
       0    1
0  17831  318
1    335  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97730905, 'precision': 0.88562196, 'recall': 0.8085921, 'specificity': 0.8085921, 'f1': 0.8423976, 'auroc': 0.9224632, 'binary_precision': 0.7874396, 'binary_recall': 0.6245211, 'binary_specificity': 0.992663, 'binary_f1_score': 0.69658124}
confusion matrix:
      0    1
0  5953   44
1    98  163
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 2
val acc:0.9652511477470398, best validation acc: 0.9661026000976562, corresponding to test acc:                         0.9779482483863831 / 0.9779482483863831
after epoch: 26,now: 2024-05-29 23:45:02.898963,epoch time: 0:22:49.790245,used: 10:06:59.586558,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96695745, 'precision': 0.74523526, 'recall': 0.7134038, 'specificity': 0.7134038, 'f1': 0.7280937, 'auroc': 0.92896473, 'binary_precision': 0.50980395, 'binary_recall': 0.4415761, 'binary_specificity': 0.9852316, 'binary_f1_score': 0.47324356}
confusion matrix:
       0    1
0  41695  625
1    822  650
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.7388191, 'recall': 0.7226562, 'specificity': 0.7226562, 'f1': 0.73042184, 'auroc': 0.9195012, 'binary_precision': 0.49665552, 'binary_recall': 0.46189734, 'binary_specificity': 0.98341507, 'binary_f1_score': 0.47864628}
confusion matrix:
       0    1
0  17848  301
1    346  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97810805, 'precision': 0.89394957, 'recall': 0.8108412, 'specificity': 0.8108412, 'f1': 0.84700394, 'auroc': 0.924598, 'binary_precision': 0.8039216, 'binary_recall': 0.62835246, 'binary_specificity': 0.99333, 'binary_f1_score': 0.70537627}
confusion matrix:
      0    1
0  5957   40
1    97  164
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 3
val acc:0.9655704498291016, best validation acc: 0.9661026000976562, corresponding to test acc:                         0.9779482483863831 / 0.9781080484390259
after epoch: 27,now: 2024-05-30 00:07:53.232738,epoch time: 0:22:50.333775,used: 10:29:49.920333,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9672543, 'precision': 0.7481135, 'recall': 0.6833944, 'specificity': 0.6833944, 'f1': 0.71039164, 'auroc': 0.9291125, 'binary_precision': 0.5176252, 'binary_recall': 0.3790761, 'binary_specificity': 0.9877127, 'binary_f1_score': 0.43764704}
confusion matrix:
       0    1
0  41800  520
1    914  558
---- Validation: 
scalar performance:
{'acc': 0.9650915, 'precision': 0.73370624, 'recall': 0.6991565, 'specificity': 0.6991565, 'f1': 0.71489376, 'auroc': 0.9177079, 'binary_precision': 0.4880734, 'binary_recall': 0.41368586, 'binary_specificity': 0.98462725, 'binary_f1_score': 0.44781145}
confusion matrix:
       0    1
0  17870  279
1    377  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97778845, 'precision': 0.91222, 'recall': 0.7850218, 'specificity': 0.7850218, 'f1': 0.83593094, 'auroc': 0.91311556, 'binary_precision': 0.8426966, 'binary_recall': 0.57471263, 'binary_specificity': 0.995331, 'binary_f1_score': 0.6833713}
confusion matrix:
      0    1
0  5969   28
1   111  150
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 4
val acc:0.9650915265083313, best validation acc: 0.9661026000976562, corresponding to test acc:                         0.9779482483863831 / 0.9781080484390259
after epoch: 28,now: 2024-05-30 00:30:39.798009,epoch time: 0:22:46.565271,used: 10:52:36.485604,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96702594, 'precision': 0.74580765, 'recall': 0.7283418, 'specificity': 0.7283418, 'f1': 0.7367172, 'auroc': 0.9290079, 'binary_precision': 0.5099046, 'binary_recall': 0.47246772, 'binary_specificity': 0.98421586, 'binary_f1_score': 0.49047285}
confusion matrix:
       0    1
0  41653  668
1    776  695
---- Validation: 
scalar performance:
{'acc': 0.9650915, 'precision': 0.7360776, 'recall': 0.7389095, 'specificity': 0.7389095, 'f1': 0.7374841, 'auroc': 0.92317826, 'binary_precision': 0.49001536, 'binary_recall': 0.496112, 'binary_specificity': 0.981707, 'binary_f1_score': 0.4930448}
confusion matrix:
       0    1
0  17817  332
1    324  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97810805, 'precision': 0.8885354, 'recall': 0.8181706, 'specificity': 0.8181706, 'f1': 0.8494917, 'auroc': 0.90997094, 'binary_precision': 0.7924528, 'binary_recall': 0.6436782, 'binary_specificity': 0.992663, 'binary_f1_score': 0.7103594}
confusion matrix:
      0    1
0  5953   44
1    93  168
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 5
val acc:0.9650915265083313, best validation acc: 0.9661026000976562, corresponding to test acc:                         0.9779482483863831 / 0.9781080484390259
after epoch: 29,now: 2024-05-30 00:53:42.950773,epoch time: 0:23:03.152764,used: 11:15:39.638368,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9674598, 'precision': 0.7496191, 'recall': 0.7055999, 'specificity': 0.7055999, 'f1': 0.7252535, 'auroc': 0.93018985, 'binary_precision': 0.519103, 'binary_recall': 0.42488104, 'binary_specificity': 0.9863188, 'binary_f1_score': 0.46728972}
confusion matrix:
       0    1
0  41742  579
1    846  625
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.7414362, 'recall': 0.7115982, 'specificity': 0.7115982, 'f1': 0.7254232, 'auroc': 0.9202758, 'binary_precision': 0.5026738, 'binary_recall': 0.43856922, 'binary_specificity': 0.98462725, 'binary_f1_score': 0.46843854}
confusion matrix:
       0    1
0  17870  279
1    361  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97778845, 'precision': 0.89719915, 'recall': 0.80151284, 'specificity': 0.80151284, 'f1': 0.84215784, 'auroc': 0.91851544, 'binary_precision': 0.81122446, 'binary_recall': 0.6091954, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.6958424}
confusion matrix:
      0    1
0  5960   37
1   102  159
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 6
val acc:0.9659429788589478, best validation acc: 0.9661026000976562, corresponding to test acc:                         0.9779482483863831 / 0.9781080484390259
after epoch: 30,now: 2024-05-30 01:17:06.706811,epoch time: 0:23:23.756038,used: 11:39:03.394406,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:39:03.394406 at 2024-05-30 01:17:06.706811
persisted model performance metric: 

scalar performance:
{'acc': 0.97746885, 'precision': 0.8991604, 'recall': 0.7940167, 'specificity': 0.7940167, 'f1': 0.83783734, 'auroc': 0.9235842, 'binary_precision': 0.81578946, 'binary_recall': 0.59386975, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.6873615}
confusion matrix:
      0    1
0  5962   35
1   106  155
oracle model performance metric: 

scalar performance:
{'acc': 0.979706, 'precision': 0.90974164, 'recall': 0.817172, 'specificity': 0.817172, 'f1': 0.85698843, 'auroc': 0.9165778, 'binary_precision': 0.835, 'binary_recall': 0.63984674, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.7245119}
confusion matrix:
      0    1
0  5964   33
1    94  167
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/9.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493147 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool | 403328 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |  89819 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 493147 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool | 403328 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |  89819 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  10880 MiB |    898 TiB |    898 TiB |
|       from large pool | 387840 KiB |  10808 MiB |    895 TiB |    895 TiB |
|       from small pool |  88733 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11482 MiB |  11482 MiB |  11482 MiB |      0 B   |
|       from large pool |  11356 MiB |  11356 MiB |  11356 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 752036 KiB |   1325 MiB | 384643 GiB | 384642 GiB |
|       from large pool | 741504 KiB |   1322 MiB | 381643 GiB | 381642 GiB |
|       from small pool |  10532 KiB |     11 MiB |   3000 GiB |   2999 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6720    |  139686 K  |  139682 K  |
|       from large pool |      87    |     908    |   56778 K  |   56778 K  |
|       from small pool |    3642    |    6631    |   82908 K  |   82904 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6720    |  139686 K  |  139682 K  |
|       from large pool |      87    |     908    |   56778 K  |   56778 K  |
|       from small pool |    3642    |    6631    |   82908 K  |   82904 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     404    |     404    |     404    |       0    |
|       from large pool |     341    |     341    |     341    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    2767    |   74813 K  |   74813 K  |
|       from large pool |      19    |     187    |   34810 K  |   34810 K  |
|       from small pool |      55    |    2747    |   40002 K  |   40002 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |    898 TiB |    898 TiB |
|       from large pool |  16640 KiB |  10808 MiB |    895 TiB |    895 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11482 MiB |  11482 MiB |  10266 MiB |
|       from large pool |   1118 MiB |  11356 MiB |  11356 MiB |  10238 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB | 384643 GiB | 384643 GiB |
|       from large pool |  50944 KiB |   1322 MiB | 381643 GiB | 381643 GiB |
|       from small pool |      0 KiB |     24 MiB |   3000 GiB |   3000 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  139686 K  |  139686 K  |
|       from large pool |       2    |     908    |   56778 K  |   56778 K  |
|       from small pool |       0    |    6631    |   82908 K  |   82908 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  139686 K  |  139686 K  |
|       from large pool |       2    |     908    |   56778 K  |   56778 K  |
|       from small pool |       0    |    6631    |   82908 K  |   82908 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     404    |     404    |     325    |
|       from large pool |      30    |     341    |     341    |     311    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2767    |   74815 K  |   74815 K  |
|       from large pool |       4    |     187    |   34810 K  |   34810 K  |
|       from small pool |       0    |    2747    |   40004 K  |   40004 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |    898 TiB |    898 TiB |
|       from large pool |  16640 KiB |  10808 MiB |    895 TiB |    895 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11482 MiB |  11482 MiB |  10266 MiB |
|       from large pool |   1118 MiB |  11356 MiB |  11356 MiB |  10238 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB | 384643 GiB | 384643 GiB |
|       from large pool |  50944 KiB |   1322 MiB | 381643 GiB | 381643 GiB |
|       from small pool |      0 KiB |     24 MiB |   3000 GiB |   3000 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  139686 K  |  139686 K  |
|       from large pool |       2    |     908    |   56778 K  |   56778 K  |
|       from small pool |       0    |    6631    |   82908 K  |   82908 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  139686 K  |  139686 K  |
|       from large pool |       2    |     908    |   56778 K  |   56778 K  |
|       from small pool |       0    |    6631    |   82908 K  |   82908 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     404    |     404    |     325    |
|       from large pool |      30    |     341    |     341    |     311    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2767    |   74815 K  |   74815 K  |
|       from large pool |       4    |     187    |   34810 K  |   34810 K  |
|       from small pool |       0    |    2747    |   40004 K  |   40004 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748

 Experiment start at: 2024-05-30 01:27:48.536383
before training, model accuracy: 0.09474702179431915
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90532655, 'precision': 0.50350976, 'recall': 0.50690746, 'specificity': 0.50690746, 'f1': 0.50154626, 'auroc': 0.4848619, 'binary_precision': 0.03942896, 'binary_recall': 0.08044383, 'binary_specificity': 0.93337107, 'binary_f1_score': 0.052919704}
confusion matrix:
       0     1
0  39588  2826
1   1326   116
---- Validation: 
scalar performance:
{'acc': 0.8032551, 'precision': 0.50767726, 'recall': 0.5324615, 'specificity': 0.5324615, 'f1': 0.4853081, 'auroc': 0.47789338, 'binary_precision': 0.048532054, 'binary_recall': 0.24071322, 'binary_specificity': 0.82420987, 'binary_f1_score': 0.08077786}
confusion matrix:
       0     1
0  14891  3176
1    511   162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9055753, 'precision': 0.48872915, 'recall': 0.4854595, 'specificity': 0.4854595, 'f1': 0.48686138, 'auroc': 0.401403, 'binary_precision': 0.020588236, 'binary_recall': 0.026923077, 'binary_specificity': 0.94399595, 'binary_f1_score': 0.023333335}
confusion matrix:
      0    1
0  5613  333
1   253    7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-30 01:52:27.740948,epoch time: 0:24:39.204565,used: 0:24:39.204565,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9592074, 'precision': 0.5514859, 'recall': 0.51734626, 'specificity': 0.51734626, 'f1': 0.5229595, 'auroc': 0.63265204, 'binary_precision': 0.13473684, 'binary_recall': 0.044382803, 'binary_specificity': 0.9903098, 'binary_f1_score': 0.06677099}
confusion matrix:
       0    1
0  42003  411
1   1378   64
---- Validation: 
scalar performance:
{'acc': 0.94151545, 'precision': 0.5509763, 'recall': 0.5440844, 'specificity': 0.5440844, 'f1': 0.54717386, 'auroc': 0.5871765, 'binary_precision': 0.13471502, 'binary_recall': 0.11589896, 'binary_specificity': 0.9722699, 'binary_f1_score': 0.124600634}
confusion matrix:
       0    1
0  17566  501
1    595   78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95198196, 'precision': 0.49149773, 'recall': 0.49864358, 'specificity': 0.49864358, 'f1': 0.49103147, 'auroc': 0.53927076, 'binary_precision': 0.025, 'binary_recall': 0.0038461538, 'binary_specificity': 0.993441, 'binary_f1_score': 0.006666667}
confusion matrix:
      0   1
0  5907  39
1   259   1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-30 02:16:02.483826,epoch time: 0:23:34.742878,used: 0:48:13.947443,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9668688, 'precision': 0.6855554, 'recall': 0.5075742, 'specificity': 0.5075742, 'f1': 0.50691676, 'auroc': 0.7532029, 'binary_precision': 0.40350878, 'binary_recall': 0.015950069, 'binary_specificity': 0.9991984, 'binary_f1_score': 0.030687122}
confusion matrix:
       0   1
0  42380  34
1   1419  23
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.72835237, 'recall': 0.5199998, 'specificity': 0.5199998, 'f1': 0.5291861, 'auroc': 0.72435063, 'binary_precision': 0.49122807, 'binary_recall': 0.041604754, 'binary_specificity': 0.99839485, 'binary_f1_score': 0.07671233}
confusion matrix:
       0   1
0  18038  29
1    645  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.47904578, 'recall': 0.49983183, 'specificity': 0.49983183, 'f1': 0.4892181, 'auroc': 0.733088, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5944  2
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-30 02:39:34.580801,epoch time: 0:23:32.096975,used: 1:11:46.044418,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.7337624, 'recall': 0.5063641, 'specificity': 0.5063641, 'f1': 0.50447667, 'auroc': 0.8190608, 'binary_precision': 0.5, 'binary_recall': 0.013176144, 'binary_specificity': 0.999552, 'binary_f1_score': 0.025675675}
confusion matrix:
       0   1
0  42395  19
1   1423  19
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.7324655, 'recall': 0.5121595, 'specificity': 0.5121595, 'f1': 0.51489455, 'auroc': 0.7944298, 'binary_precision': 0.5, 'binary_recall': 0.02526003, 'binary_specificity': 0.9990591, 'binary_f1_score': 0.04809052}
confusion matrix:
       0   1
0  18050  17
1    656  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.8542809, 'recall': 0.50568515, 'specificity': 0.50568515, 'f1': 0.5007446, 'auroc': 0.80828416, 'binary_precision': 0.75, 'binary_recall': 0.011538462, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.022727273}
confusion matrix:
      0  1
0  5945  1
1   257  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-05-30 03:03:09.949105,epoch time: 0:23:35.368304,used: 1:35:21.412722,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.7336557, 'recall': 0.50301456, 'specificity': 0.50301456, 'f1': 0.49780515, 'auroc': 0.8374394, 'binary_precision': 0.5, 'binary_recall': 0.0062413313, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.012328767}
confusion matrix:
       0  1
0  42405  9
1   1433  9
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.78234506, 'recall': 0.5086939, 'specificity': 0.5086939, 'f1': 0.5082231, 'auroc': 0.82115245, 'binary_precision': 0.6, 'binary_recall': 0.017830608, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.03463203}
confusion matrix:
       0   1
0  18059   8
1    661  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.72912633, 'recall': 0.501839, 'specificity': 0.501839, 'f1': 0.49311718, 'auroc': 0.8209734, 'binary_precision': 0.5, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0076335873}
confusion matrix:
      0  1
0  5945  1
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
better model found
persisted
after epoch: 5,now: 2024-05-30 03:26:50.091539,epoch time: 0:23:40.142434,used: 1:59:01.555156,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96723366, 'precision': 0.7800285, 'recall': 0.5054182, 'specificity': 0.5054182, 'f1': 0.5025607, 'auroc': 0.8595295, 'binary_precision': 0.5925926, 'binary_recall': 0.011095701, 'binary_specificity': 0.99974066, 'binary_f1_score': 0.021783527}
confusion matrix:
       0   1
0  42403  11
1   1426  16
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.64880574, 'recall': 0.50275034, 'specificity': 0.50275034, 'f1': 0.4966398, 'auroc': 0.8600547, 'binary_precision': 0.33333334, 'binary_recall': 0.0059435363, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.011678832}
confusion matrix:
       0  1
0  18059  8
1    669  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.84044087, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 1
val acc:0.9638740420341492, best validation acc: 0.9643009901046753, corresponding to test acc:                         0.9581050872802734 / 0.9584273099899292
after epoch: 6,now: 2024-05-30 03:50:24.687608,epoch time: 0:23:34.596069,used: 2:22:36.151225,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9673705, 'precision': 0.75989485, 'recall': 0.51989186, 'specificity': 0.51989186, 'f1': 0.52978504, 'auroc': 0.8759122, 'binary_precision': 0.55140185, 'binary_recall': 0.040915396, 'binary_specificity': 0.9988683, 'binary_f1_score': 0.076178186}
confusion matrix:
       0   1
0  42366  48
1   1383  59
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.7876564, 'recall': 0.54278195, 'specificity': 0.54278195, 'f1': 0.56774294, 'auroc': 0.869612, 'binary_precision': 0.6082474, 'binary_recall': 0.08766716, 'binary_specificity': 0.99789673, 'binary_f1_score': 0.15324675}
confusion matrix:
       0   1
0  18029  38
1    614  59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.91762924, 'recall': 0.5267549, 'specificity': 0.5267549, 'f1': 0.54050714, 'auroc': 0.87192297, 'binary_precision': 0.875, 'binary_recall': 0.053846154, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.10144927}
confusion matrix:
      0   1
0  5944   2
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-05-30 04:13:59.735967,epoch time: 0:23:35.048359,used: 2:46:11.199584,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9673705, 'precision': 0.77760947, 'recall': 0.5125229, 'specificity': 0.5125229, 'f1': 0.51628494, 'auroc': 0.88109887, 'binary_precision': 0.5873016, 'binary_recall': 0.025658807, 'binary_specificity': 0.99938697, 'binary_f1_score': 0.049169436}
confusion matrix:
       0   1
0  42388  26
1   1405  37
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.79255104, 'recall': 0.52831054, 'specificity': 0.52831054, 'f1': 0.5440353, 'auroc': 0.8797209, 'binary_precision': 0.61904764, 'binary_recall': 0.05794948, 'binary_specificity': 0.9986716, 'binary_f1_score': 0.10597826}
confusion matrix:
       0   1
0  18043  24
1    634  39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.94679916, 'recall': 0.52683896, 'specificity': 0.52683896, 'f1': 0.5407336, 'auroc': 0.8620669, 'binary_precision': 0.93333334, 'binary_recall': 0.053846154, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.10181818}
confusion matrix:
      0   1
0  5945   1
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 1
val acc:0.9648879170417786, best validation acc: 0.965208113193512, corresponding to test acc:                         0.9600386619567871 / 0.9601998329162598
after epoch: 8,now: 2024-05-30 04:37:52.529690,epoch time: 0:23:52.793723,used: 3:10:03.993307,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96782655, 'precision': 0.789455, 'recall': 0.5291713, 'specificity': 0.5291713, 'f1': 0.546136, 'auroc': 0.8956971, 'binary_precision': 0.6099291, 'binary_recall': 0.05963939, 'binary_specificity': 0.99870324, 'binary_f1_score': 0.108654454}
confusion matrix:
       0   1
0  42359  55
1   1356  86
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.75902057, 'recall': 0.55114377, 'specificity': 0.55114377, 'f1': 0.5795315, 'auroc': 0.8873671, 'binary_precision': 0.5503876, 'binary_recall': 0.10549777, 'binary_specificity': 0.99678975, 'binary_f1_score': 0.17705736}
confusion matrix:
       0   1
0  18009  58
1    602  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.90066653, 'recall': 0.54004824, 'specificity': 0.54004824, 'f1': 0.5636652, 'auroc': 0.8853934, 'binary_precision': 0.84, 'binary_recall': 0.08076923, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.14736843}
confusion matrix:
      0   1
0  5942   4
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 2
val acc:0.9647812247276306, best validation acc: 0.965208113193512, corresponding to test acc:                         0.9600386619567871 / 0.9608443379402161
after epoch: 9,now: 2024-05-30 05:01:16.301432,epoch time: 0:23:23.771742,used: 3:33:27.765049,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9674389, 'precision': 0.7559757, 'recall': 0.5276391, 'specificity': 0.5276391, 'f1': 0.5432168, 'auroc': 0.8980435, 'binary_precision': 0.54304636, 'binary_recall': 0.056904927, 'binary_specificity': 0.9983732, 'binary_f1_score': 0.10301508}
confusion matrix:
       0   1
0  42346  69
1   1359  82
---- Validation: 
scalar performance:
{'acc': 0.9653682, 'precision': 0.77697, 'recall': 0.5593161, 'specificity': 0.5593161, 'f1': 0.5920111, 'auroc': 0.89443564, 'binary_precision': 0.5857143, 'binary_recall': 0.121842496, 'binary_specificity': 0.99678975, 'binary_f1_score': 0.20172201}
confusion matrix:
       0   1
0  18009  58
1    591  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.88511765, 'recall': 0.53235596, 'specificity': 0.53235596, 'f1': 0.5503177, 'auroc': 0.90046054, 'binary_precision': 0.8095238, 'binary_recall': 0.06538462, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.120996445}
confusion matrix:
      0   1
0  5942   4
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
better model found
persisted
after epoch: 10,now: 2024-05-30 05:24:44.317898,epoch time: 0:23:28.016466,used: 3:56:55.781515,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9674161, 'precision': 0.7544442, 'recall': 0.52962905, 'specificity': 0.52962905, 'f1': 0.54653084, 'auroc': 0.9000734, 'binary_precision': 0.5398773, 'binary_recall': 0.061026353, 'binary_specificity': 0.9982317, 'binary_f1_score': 0.109657325}
confusion matrix:
       0   1
0  42339  75
1   1354  88
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.7495949, 'recall': 0.5481443, 'specificity': 0.5481443, 'f1': 0.5747902, 'auroc': 0.89166987, 'binary_precision': 0.53174603, 'binary_recall': 0.09955423, 'binary_specificity': 0.9967344, 'binary_f1_score': 0.16770963}
confusion matrix:
       0   1
0  18008  59
1    606  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.9521177, 'recall': 0.5613703, 'specificity': 0.5613703, 'f1': 0.59935355, 'auroc': 0.89439297, 'binary_precision': 0.9411765, 'binary_recall': 0.12307692, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.21768707}
confusion matrix:
      0   1
0  5944   2
1   228  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 1
val acc:0.964514434337616, best validation acc: 0.9653682112693787, corresponding to test acc:                         0.9601998329162598 / 0.9629390835762024
after epoch: 11,now: 2024-05-30 05:48:57.364577,epoch time: 0:24:13.046679,used: 4:21:08.828194,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96693724, 'precision': 0.7285652, 'recall': 0.5494786, 'specificity': 0.5494786, 'f1': 0.5763316, 'auroc': 0.9081723, 'binary_precision': 0.4868421, 'binary_recall': 0.10263523, 'binary_specificity': 0.996322, 'binary_f1_score': 0.16953035}
confusion matrix:
       0    1
0  42258  156
1   1294  148
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.7495667, 'recall': 0.6019831, 'specificity': 0.6019831, 'f1': 0.6417388, 'auroc': 0.90121466, 'binary_precision': 0.527881, 'binary_recall': 0.21099554, 'binary_specificity': 0.9929706, 'binary_f1_score': 0.3014862}
confusion matrix:
       0    1
0  17940  127
1    531  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.93359613, 'recall': 0.58804107, 'specificity': 0.58804107, 'f1': 0.6388612, 'auroc': 0.89205086, 'binary_precision': 0.9019608, 'binary_recall': 0.17692308, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.29581994}
confusion matrix:
      0   1
0  5941   5
1   214  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 2
val acc:0.9648879170417786, best validation acc: 0.9653682112693787, corresponding to test acc:                         0.9601998329162598 / 0.9647115468978882
after epoch: 12,now: 2024-05-30 06:13:14.851419,epoch time: 0:24:17.486842,used: 4:45:26.315036,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9673021, 'precision': 0.7432242, 'recall': 0.54162836, 'specificity': 0.54162836, 'f1': 0.5653875, 'auroc': 0.90420955, 'binary_precision': 0.51666665, 'binary_recall': 0.08599168, 'binary_specificity': 0.99726504, 'binary_f1_score': 0.14744352}
confusion matrix:
       0    1
0  42298  116
1   1318  124
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.7503717, 'recall': 0.5725741, 'specificity': 0.5725741, 'f1': 0.6080077, 'auroc': 0.8970091, 'binary_precision': 0.53157896, 'binary_recall': 0.15007429, 'binary_specificity': 0.9950739, 'binary_f1_score': 0.23406719}
confusion matrix:
       0    1
0  17978   89
1    572  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.94635904, 'recall': 0.57474774, 'specificity': 0.57474774, 'f1': 0.6198905, 'auroc': 0.90824485, 'binary_precision': 0.9285714, 'binary_recall': 0.15, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.25827813}
confusion matrix:
      0   1
0  5943   3
1   221  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 3
val acc:0.9647278785705566, best validation acc: 0.9653682112693787, corresponding to test acc:                         0.9601998329162598 / 0.9647115468978882
after epoch: 13,now: 2024-05-30 06:37:20.209445,epoch time: 0:24:05.358026,used: 5:09:31.673062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9672565, 'precision': 0.73929167, 'recall': 0.5838088, 'specificity': 0.5838088, 'f1': 0.6207616, 'auroc': 0.907049, 'binary_precision': 0.5060729, 'binary_recall': 0.17337032, 'binary_specificity': 0.9942472, 'binary_f1_score': 0.25826445}
confusion matrix:
       0    1
0  42170  244
1   1192  250
---- Validation: 
scalar performance:
{'acc': 0.9653682, 'precision': 0.7537869, 'recall': 0.6358497, 'specificity': 0.6358497, 'f1': 0.6751293, 'auroc': 0.9042176, 'binary_precision': 0.5338983, 'binary_recall': 0.28083208, 'binary_specificity': 0.9908673, 'binary_f1_score': 0.3680623}
confusion matrix:
       0    1
0  17902  165
1    484  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.91471136, 'recall': 0.62984425, 'specificity': 0.62984425, 'f1': 0.6921828, 'auroc': 0.8919685, 'binary_precision': 0.8607595, 'binary_recall': 0.26153848, 'binary_specificity': 0.99815, 'binary_f1_score': 0.40117994}
confusion matrix:
      0   1
0  5935  11
1   192  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 4
val acc:0.9653682112693787, best validation acc: 0.9653682112693787, corresponding to test acc:                         0.9601998329162598 / 0.9672897458076477
after epoch: 14,now: 2024-05-30 07:01:29.271348,epoch time: 0:24:09.061903,used: 5:33:40.734965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.966732, 'precision': 0.72776675, 'recall': 0.5815279, 'specificity': 0.5815279, 'f1': 0.6168152, 'auroc': 0.9118149, 'binary_precision': 0.4831683, 'binary_recall': 0.16920944, 'binary_specificity': 0.99384636, 'binary_f1_score': 0.25064203}
confusion matrix:
       0    1
0  42153  261
1   1198  244
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.7384016, 'recall': 0.64453936, 'specificity': 0.64453936, 'f1': 0.6786912, 'auroc': 0.9048146, 'binary_precision': 0.50248754, 'binary_recall': 0.30014858, 'binary_specificity': 0.9889301, 'binary_f1_score': 0.37581393}
confusion matrix:
       0    1
0  17867  200
1    471  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890104, 'precision': 0.9275753, 'recall': 0.647236, 'specificity': 0.647236, 'f1': 0.71390367, 'auroc': 0.89024496, 'binary_precision': 0.88505745, 'binary_recall': 0.29615384, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.44380403}
confusion matrix:
      0   1
0  5936  10
1   183  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 5
val acc:0.9641942381858826, best validation acc: 0.9653682112693787, corresponding to test acc:                         0.9601998329162598 / 0.9689010381698608
after epoch: 15,now: 2024-05-30 07:25:35.200242,epoch time: 0:24:05.928894,used: 5:57:46.663859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96732485, 'precision': 0.7414305, 'recall': 0.5677664, 'specificity': 0.5677664, 'f1': 0.60161835, 'auroc': 0.9156693, 'binary_precision': 0.5113924, 'binary_recall': 0.14008322, 'binary_specificity': 0.9954496, 'binary_f1_score': 0.21992378}
confusion matrix:
       0    1
0  42221  193
1   1240  202
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.7516384, 'recall': 0.61711437, 'specificity': 0.61711437, 'f1': 0.65736765, 'auroc': 0.9091873, 'binary_precision': 0.53094465, 'binary_recall': 0.24219911, 'binary_specificity': 0.99202967, 'binary_f1_score': 0.33265308}
confusion matrix:
       0    1
0  17923  144
1    510  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668063, 'precision': 0.91172624, 'recall': 0.624075, 'specificity': 0.624075, 'f1': 0.68492305, 'auroc': 0.9020091, 'binary_precision': 0.8552632, 'binary_recall': 0.25, 'binary_specificity': 0.99815, 'binary_f1_score': 0.38690475}
confusion matrix:
      0   1
0  5935  11
1   195  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 6
val acc:0.9651013612747192, best validation acc: 0.9653682112693787, corresponding to test acc:                         0.9601998329162598 / 0.9689010381698608
after epoch: 16,now: 2024-05-30 07:49:43.968704,epoch time: 0:24:08.768462,used: 6:21:55.432321,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9673933, 'precision': 0.74171436, 'recall': 0.6351272, 'specificity': 0.6351272, 'f1': 0.6718676, 'auroc': 0.91242313, 'binary_precision': 0.5075567, 'binary_recall': 0.27947295, 'binary_specificity': 0.99078137, 'binary_f1_score': 0.3604651}
confusion matrix:
       0    1
0  42023  391
1   1039  403
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.74796534, 'recall': 0.7029465, 'specificity': 0.7029465, 'f1': 0.722949, 'auroc': 0.91468674, 'binary_precision': 0.5173675, 'binary_recall': 0.4205052, 'binary_specificity': 0.98538774, 'binary_f1_score': 0.46393445}
confusion matrix:
       0    1
0  17803  264
1    390  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709958, 'precision': 0.9035218, 'recall': 0.6906259, 'specificity': 0.6906259, 'f1': 0.7556779, 'auroc': 0.9069782, 'binary_precision': 0.8333333, 'binary_recall': 0.3846154, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.5263158}
confusion matrix:
      0    1
0  5926   20
1   160  100
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 7
val acc:0.9651013612747192, best validation acc: 0.9653682112693787, corresponding to test acc:                         0.9601998329162598 / 0.9709957838058472
after epoch: 17,now: 2024-05-30 08:14:00.998963,epoch time: 0:24:17.030259,used: 6:46:12.462580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9674389, 'precision': 0.7423729, 'recall': 0.62778175, 'specificity': 0.62778175, 'f1': 0.66562384, 'auroc': 0.9187327, 'binary_precision': 0.5093583, 'binary_recall': 0.26421636, 'binary_specificity': 0.9913472, 'binary_f1_score': 0.34794518}
confusion matrix:
       0    1
0  42047  367
1   1061  381
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.74723583, 'recall': 0.67785674, 'specificity': 0.67785674, 'f1': 0.70624894, 'auroc': 0.9106486, 'binary_precision': 0.5177453, 'binary_recall': 0.36849925, 'binary_specificity': 0.98721427, 'binary_f1_score': 0.43055558}
confusion matrix:
       0    1
0  17836  231
1    425  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9732517, 'precision': 0.9301312, 'recall': 0.7065151, 'specificity': 0.7065151, 'f1': 0.7758231, 'auroc': 0.90991485, 'binary_precision': 0.8852459, 'binary_recall': 0.41538462, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.565445}
confusion matrix:
      0    1
0  5932   14
1   152  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 8
val acc:0.9649946689605713, best validation acc: 0.9653682112693787, corresponding to test acc:                         0.9601998329162598 / 0.9732517004013062
after epoch: 18,now: 2024-05-30 08:38:10.788359,epoch time: 0:24:09.789396,used: 7:10:22.251976,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9663672, 'precision': 0.7175039, 'recall': 0.56961596, 'specificity': 0.56961596, 'f1': 0.6018131, 'auroc': 0.91850865, 'binary_precision': 0.46341464, 'binary_recall': 0.14493759, 'binary_specificity': 0.99429435, 'binary_f1_score': 0.22081353}
confusion matrix:
       0    1
0  42172  242
1   1233  209
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.75011384, 'recall': 0.63499606, 'specificity': 0.63499606, 'f1': 0.67355305, 'auroc': 0.9101844, 'binary_precision': 0.5266107, 'binary_recall': 0.2793462, 'binary_specificity': 0.99064595, 'binary_f1_score': 0.36504856}
confusion matrix:
       0    1
0  17898  169
1    485  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9690622, 'precision': 0.9200623, 'recall': 0.6528371, 'specificity': 0.6528371, 'f1': 0.71931255, 'auroc': 0.90137196, 'binary_precision': 0.8695652, 'binary_recall': 0.30769232, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.45454544}
confusion matrix:
      0   1
0  5934  12
1   180  80
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 9
val acc:0.9651013612747192, best validation acc: 0.9653682112693787, corresponding to test acc:                         0.9601998329162598 / 0.9732517004013062
after epoch: 19,now: 2024-05-30 09:02:25.322891,epoch time: 0:24:14.534532,used: 7:34:36.786508,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9676213, 'precision': 0.74551964, 'recall': 0.61615276, 'specificity': 0.61615276, 'f1': 0.6555314, 'auroc': 0.9188386, 'binary_precision': 0.5164179, 'binary_recall': 0.23994452, 'binary_specificity': 0.992361, 'binary_f1_score': 0.3276515}
confusion matrix:
       0    1
0  42090  324
1   1096  346
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.7462177, 'recall': 0.67207927, 'specificity': 0.67207927, 'f1': 0.7018434, 'auroc': 0.9120871, 'binary_precision': 0.516129, 'binary_recall': 0.35661218, 'binary_specificity': 0.9875464, 'binary_f1_score': 0.4217926}
confusion matrix:
       0    1
0  17842  225
1    433  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9730905, 'precision': 0.9295769, 'recall': 0.704592, 'specificity': 0.704592, 'f1': 0.77389944, 'auroc': 0.9066242, 'binary_precision': 0.88429755, 'binary_recall': 0.41153845, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.5616798}
confusion matrix:
      0    1
0  5932   14
1   153  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 10
val acc:0.9648879170417786, best validation acc: 0.9653682112693787, corresponding to test acc:                         0.9601998329162598 / 0.9732517004013062
after epoch: 20,now: 2024-05-30 09:26:41.172666,epoch time: 0:24:15.849775,used: 7:58:52.636283,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9676669, 'precision': 0.7452488, 'recall': 0.65603566, 'specificity': 0.65603566, 'f1': 0.6897353, 'auroc': 0.9171202, 'binary_precision': 0.51324505, 'binary_recall': 0.3224688, 'binary_specificity': 0.9896025, 'binary_f1_score': 0.39608178}
confusion matrix:
       0    1
0  41973  441
1    977  465
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.74223006, 'recall': 0.6940312, 'specificity': 0.6940312, 'f1': 0.71515703, 'auroc': 0.9162648, 'binary_precision': 0.506542, 'binary_recall': 0.4026746, 'binary_specificity': 0.98538774, 'binary_f1_score': 0.44867545}
confusion matrix:
       0    1
0  17803  264
1    402  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97437966, 'precision': 0.9253421, 'recall': 0.72549355, 'specificity': 0.72549355, 'f1': 0.79211855, 'auroc': 0.9038086, 'binary_precision': 0.8740741, 'binary_recall': 0.45384616, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.5974684}
confusion matrix:
      0    1
0  5929   17
1   142  118
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 11
val acc:0.9644610285758972, best validation acc: 0.9653682112693787, corresponding to test acc:                         0.9601998329162598 / 0.9743796586990356
after epoch: 21,now: 2024-05-30 09:50:41.639924,epoch time: 0:24:00.467258,used: 8:22:53.103541,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9675073, 'precision': 0.74408066, 'recall': 0.601021, 'specificity': 0.601021, 'f1': 0.64018, 'auroc': 0.9209333, 'binary_precision': 0.51452994, 'binary_recall': 0.20873787, 'binary_specificity': 0.9933041, 'binary_f1_score': 0.29699063}
confusion matrix:
       0    1
0  42130  284
1   1141  301
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.74520683, 'recall': 0.6605796, 'specificity': 0.6605796, 'f1': 0.6930932, 'auroc': 0.9131781, 'binary_precision': 0.5149425, 'binary_recall': 0.33283803, 'binary_specificity': 0.98832124, 'binary_f1_score': 0.4043321}
confusion matrix:
       0    1
0  17856  211
1    449  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9708347, 'precision': 0.90007603, 'recall': 0.6905418, 'specificity': 0.6905418, 'f1': 0.7549449, 'auroc': 0.9163296, 'binary_precision': 0.8264463, 'binary_recall': 0.3846154, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.5249344}
confusion matrix:
      0    1
0  5925   21
1   160  100
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 12
val acc:0.9647812247276306, best validation acc: 0.9653682112693787, corresponding to test acc:                         0.9601998329162598 / 0.9743796586990356
after epoch: 22,now: 2024-05-30 10:14:51.408400,epoch time: 0:24:09.768476,used: 8:47:02.872017,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9666864, 'precision': 0.73531926, 'recall': 0.68399966, 'specificity': 0.68399966, 'f1': 0.706181, 'auroc': 0.921197, 'binary_precision': 0.49151027, 'binary_recall': 0.3814147, 'binary_specificity': 0.9865846, 'binary_f1_score': 0.4295197}
confusion matrix:
       0    1
0  41845  569
1    892  550
---- Validation: 
scalar performance:
{'acc': 0.96344715, 'precision': 0.7357221, 'recall': 0.729984, 'specificity': 0.729984, 'f1': 0.7328133, 'auroc': 0.9181894, 'binary_precision': 0.49085367, 'binary_recall': 0.47845468, 'binary_specificity': 0.98151326, 'binary_f1_score': 0.48457488}
confusion matrix:
       0    1
0  17733  334
1    351  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97502416, 'precision': 0.8934011, 'recall': 0.7626096, 'specificity': 0.7626096, 'f1': 0.813717, 'auroc': 0.91134053, 'binary_precision': 0.80701756, 'binary_recall': 0.5307692, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.6403712}
confusion matrix:
      0    1
0  5913   33
1   122  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 13
val acc:0.9634471535682678, best validation acc: 0.9653682112693787, corresponding to test acc:                         0.9601998329162598 / 0.9750241637229919
after epoch: 23,now: 2024-05-30 10:39:04.360293,epoch time: 0:24:12.951893,used: 9:11:15.823910,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96684605, 'precision': 0.73557425, 'recall': 0.65829086, 'specificity': 0.65829086, 'f1': 0.6885617, 'auroc': 0.92549145, 'binary_precision': 0.49373695, 'binary_recall': 0.32801664, 'binary_specificity': 0.9885651, 'binary_f1_score': 0.39416665}
confusion matrix:
       0    1
0  41929  485
1    969  473
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.7485455, 'recall': 0.69439095, 'specificity': 0.69439095, 'f1': 0.71778, 'auroc': 0.91976166, 'binary_precision': 0.5191571, 'binary_recall': 0.4026746, 'binary_specificity': 0.9861073, 'binary_f1_score': 0.45355648}
confusion matrix:
       0    1
0  17816  251
1    402  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9751853, 'precision': 0.9113377, 'recall': 0.74798185, 'specificity': 0.74798185, 'f1': 0.8075919, 'auroc': 0.91388035, 'binary_precision': 0.84415585, 'binary_recall': 0.5, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.62801933}
confusion matrix:
      0    1
0  5922   24
1   130  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 14
val acc:0.965154767036438, best validation acc: 0.9653682112693787, corresponding to test acc:                         0.9601998329162598 / 0.9751852750778198
after epoch: 24,now: 2024-05-30 11:03:18.278664,epoch time: 0:24:13.918371,used: 9:35:29.742281,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96650404, 'precision': 0.73186564, 'recall': 0.65945387, 'specificity': 0.65945387, 'f1': 0.6882515, 'auroc': 0.9271951, 'binary_precision': 0.48623854, 'binary_recall': 0.33079058, 'binary_specificity': 0.98811716, 'binary_f1_score': 0.3937268}
confusion matrix:
       0    1
0  41910  504
1    965  477
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.7409768, 'recall': 0.7146632, 'specificity': 0.7146632, 'f1': 0.7269689, 'auroc': 0.91891444, 'binary_precision': 0.5025126, 'binary_recall': 0.44576523, 'binary_specificity': 0.9835612, 'binary_f1_score': 0.47244093}
confusion matrix:
       0    1
0  17770  297
1    373  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97437966, 'precision': 0.9176188, 'recall': 0.7310105, 'specificity': 0.7310105, 'f1': 0.7951267, 'auroc': 0.90855134, 'binary_precision': 0.858156, 'binary_recall': 0.4653846, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.60349125}
confusion matrix:
      0    1
0  5926   20
1   139  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 15
val acc:0.9642475843429565, best validation acc: 0.9653682112693787, corresponding to test acc:                         0.9601998329162598 / 0.9751852750778198
after epoch: 25,now: 2024-05-30 11:27:26.351297,epoch time: 0:24:08.072633,used: 9:59:37.814914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9674389, 'precision': 0.7423563, 'recall': 0.63414586, 'specificity': 0.63414586, 'f1': 0.6711807, 'auroc': 0.92537737, 'binary_precision': 0.5089058, 'binary_recall': 0.2773925, 'binary_specificity': 0.9908992, 'binary_f1_score': 0.3590664}
confusion matrix:
       0    1
0  42028  386
1   1042  400
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.7450916, 'recall': 0.6899056, 'specificity': 0.6899056, 'f1': 0.7135956, 'auroc': 0.9200562, 'binary_precision': 0.5125725, 'binary_recall': 0.39375928, 'binary_specificity': 0.9860519, 'binary_f1_score': 0.44537815}
confusion matrix:
       0    1
0  17815  252
1    408  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9729294, 'precision': 0.90471876, 'recall': 0.71921974, 'specificity': 0.71921974, 'f1': 0.78195286, 'auroc': 0.907006, 'binary_precision': 0.8333333, 'binary_recall': 0.44230768, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.57788944}
confusion matrix:
      0    1
0  5923   23
1   145  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 16
val acc:0.9647812247276306, best validation acc: 0.9653682112693787, corresponding to test acc:                         0.9601998329162598 / 0.9751852750778198
after epoch: 26,now: 2024-05-30 11:51:32.037397,epoch time: 0:24:05.686100,used: 10:23:43.501014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96611637, 'precision': 0.73005426, 'recall': 0.68504477, 'specificity': 0.68504477, 'f1': 0.7048407, 'auroc': 0.92827034, 'binary_precision': 0.4809028, 'binary_recall': 0.38418862, 'binary_specificity': 0.9859009, 'binary_f1_score': 0.42713955}
confusion matrix:
       0    1
0  41816  598
1    888  554
---- Validation: 
scalar performance:
{'acc': 0.9635539, 'precision': 0.7374114, 'recall': 0.747921, 'specificity': 0.747921, 'f1': 0.742538, 'auroc': 0.92223084, 'binary_precision': 0.49289772, 'binary_recall': 0.51560175, 'binary_specificity': 0.9802402, 'binary_f1_score': 0.5039941}
confusion matrix:
       0    1
0  17710  357
1    326  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9761521, 'precision': 0.91474533, 'recall': 0.7595203, 'specificity': 0.7595203, 'f1': 0.81763875, 'auroc': 0.90478426, 'binary_precision': 0.85, 'binary_recall': 0.52307695, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.6476191}
confusion matrix:
      0    1
0  5922   24
1   124  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 17
val acc:0.9635539054870605, best validation acc: 0.9653682112693787, corresponding to test acc:                         0.9601998329162598 / 0.9761521220207214
after epoch: 27,now: 2024-05-30 12:15:44.994490,epoch time: 0:24:12.957093,used: 10:47:56.458107,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96570593, 'precision': 0.72712064, 'recall': 0.69467485, 'specificity': 0.69467485, 'f1': 0.7095094, 'auroc': 0.9283465, 'binary_precision': 0.4743694, 'binary_recall': 0.40458015, 'binary_specificity': 0.9847695, 'binary_f1_score': 0.43670413}
confusion matrix:
       0    1
0  41769  646
1    858  583
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.7384676, 'recall': 0.748004, 'specificity': 0.748004, 'f1': 0.74313056, 'auroc': 0.9248011, 'binary_precision': 0.49500713, 'binary_recall': 0.51560175, 'binary_specificity': 0.9804063, 'binary_f1_score': 0.5050946}
confusion matrix:
       0    1
0  17713  354
1    326  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97582984, 'precision': 0.9055633, 'recall': 0.76303005, 'specificity': 0.76303005, 'f1': 0.8176864, 'auroc': 0.91388583, 'binary_precision': 0.8313253, 'binary_recall': 0.5307692, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.64788735}
confusion matrix:
      0    1
0  5918   28
1   122  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 18
val acc:0.9637140035629272, best validation acc: 0.9653682112693787, corresponding to test acc:                         0.9601998329162598 / 0.9761521220207214
after epoch: 28,now: 2024-05-30 12:39:54.932167,epoch time: 0:24:09.937677,used: 11:12:06.395784,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96670926, 'precision': 0.73518485, 'recall': 0.67764735, 'specificity': 0.67764735, 'f1': 0.7019781, 'auroc': 0.92691064, 'binary_precision': 0.49166667, 'binary_recall': 0.36823857, 'binary_specificity': 0.98705614, 'binary_f1_score': 0.42109436}
confusion matrix:
       0    1
0  41865  549
1    911  531
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.74410534, 'recall': 0.7420094, 'specificity': 0.7420094, 'f1': 0.74305236, 'auroc': 0.9227065, 'binary_precision': 0.50674665, 'binary_recall': 0.5022288, 'binary_specificity': 0.98179, 'binary_f1_score': 0.5044776}
confusion matrix:
       0    1
0  17738  329
1    335  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9738962, 'precision': 0.8853166, 'recall': 0.7528261, 'specificity': 0.7528261, 'f1': 0.80398864, 'auroc': 0.91487634, 'binary_precision': 0.7916667, 'binary_recall': 0.51153845, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.6214953}
confusion matrix:
      0    1
0  5911   35
1   127  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 19
val acc:0.9645677804946899, best validation acc: 0.9653682112693787, corresponding to test acc:                         0.9601998329162598 / 0.9761521220207214
after epoch: 29,now: 2024-05-30 13:04:07.996057,epoch time: 0:24:13.063890,used: 11:36:19.459674,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9662532, 'precision': 0.7333207, 'recall': 0.7132515, 'specificity': 0.7132515, 'f1': 0.7227845, 'auroc': 0.93082213, 'binary_precision': 0.48554033, 'binary_recall': 0.44244105, 'binary_specificity': 0.98406184, 'binary_f1_score': 0.46298984}
confusion matrix:
       0    1
0  41738  676
1    804  638
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.7428685, 'recall': 0.7725998, 'specificity': 0.7725998, 'f1': 0.75676835, 'auroc': 0.9258775, 'binary_precision': 0.5019763, 'binary_recall': 0.5661218, 'binary_specificity': 0.9790779, 'binary_f1_score': 0.53212297}
confusion matrix:
       0    1
0  17689  378
1    292  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97534645, 'precision': 0.88662815, 'recall': 0.77565074, 'specificity': 0.77565074, 'f1': 0.82092226, 'auroc': 0.9201467, 'binary_precision': 0.79234976, 'binary_recall': 0.5576923, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.6546275}
confusion matrix:
      0    1
0  5908   38
1   115  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 20
val acc:0.9642475843429565, best validation acc: 0.9653682112693787, corresponding to test acc:                         0.9601998329162598 / 0.9761521220207214
after epoch: 30,now: 2024-05-30 13:28:14.362239,epoch time: 0:24:06.366182,used: 12:00:25.825856,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_48_seed_1_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 30 with time: 12:00:25.825856 at 2024-05-30 13:28:14.362239
persisted model performance metric: 

scalar performance:
{'acc': 0.9626168, 'precision': 0.9646319, 'recall': 0.5556851, 'specificity': 0.5556851, 'f1': 0.5904306, 'auroc': 0.8854284, 'binary_precision': 0.96666664, 'binary_recall': 0.11153846, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.2}
confusion matrix:
      0   1
0  5945   1
1   231  29
oracle model performance metric: 

scalar performance:
{'acc': 0.9751853, 'precision': 0.90124106, 'recall': 0.75717676, 'specificity': 0.75717676, 'f1': 0.81197315, 'auroc': 0.9164344, 'binary_precision': 0.8231707, 'binary_recall': 0.5192308, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.6367925}
confusion matrix:
      0    1
0  5917   29
1   125  135
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493647 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool | 403840 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |  89807 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 493647 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool | 403840 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |  89807 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476570 KiB |  10880 MiB |   1799 TiB |   1799 TiB |
|       from large pool | 387840 KiB |  10808 MiB |   1794 TiB |   1794 TiB |
|       from small pool |  88730 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11460 MiB |  11482 MiB |  21726 MiB |  10266 MiB |
|       from large pool |  11336 MiB |  11356 MiB |  21574 MiB |  10238 MiB |
|       from small pool |    124 MiB |    126 MiB |    152 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 518064 KiB |   1325 MiB |    861 TiB |    861 TiB |
|       from large pool | 511616 KiB |   1322 MiB |    856 TiB |    856 TiB |
|       from small pool |   6448 KiB |     24 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3705    |    6728    |  279834 K  |  279830 K  |
|       from large pool |      87    |     908    |  113788 K  |  113788 K  |
|       from small pool |    3618    |    6639    |  166046 K  |  166042 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3705    |    6728    |  279834 K  |  279830 K  |
|       from large pool |      87    |     908    |  113788 K  |  113788 K  |
|       from small pool |    3618    |    6639    |  166046 K  |  166042 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     399    |     404    |     724    |     325    |
|       from large pool |     337    |     341    |     648    |     311    |
|       from small pool |      62    |      63    |      76    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    2772    |  150114 K  |  150114 K  |
|       from large pool |      20    |     187    |   69937 K  |   69937 K  |
|       from small pool |      51    |    2751    |   80177 K  |   80176 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |   1799 TiB |   1799 TiB |
|       from large pool |  16640 KiB |  10808 MiB |   1794 TiB |   1794 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    988 MiB |  11482 MiB |  21726 MiB |  20738 MiB |
|       from large pool |    894 MiB |  11356 MiB |  21574 MiB |  20680 MiB |
|       from small pool |     94 MiB |    126 MiB |    152 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB |    861 TiB |    861 TiB |
|       from large pool |  50944 KiB |   1322 MiB |    856 TiB |    856 TiB |
|       from small pool |      0 KiB |     24 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  279834 K  |  279834 K  |
|       from large pool |       2    |     908    |  113788 K  |  113788 K  |
|       from small pool |       0    |    6639    |  166046 K  |  166046 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  279834 K  |  279834 K  |
|       from large pool |       2    |     908    |  113788 K  |  113788 K  |
|       from small pool |       0    |    6639    |  166046 K  |  166046 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      80    |     404    |     724    |     644    |
|       from large pool |      33    |     341    |     648    |     615    |
|       from small pool |      47    |      63    |      76    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2772    |  150116 K  |  150116 K  |
|       from large pool |       4    |     187    |   69937 K  |   69937 K  |
|       from small pool |       0    |    2751    |   80178 K  |   80178 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |   1799 TiB |   1799 TiB |
|       from large pool |  16640 KiB |  10808 MiB |   1794 TiB |   1794 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    988 MiB |  11482 MiB |  21726 MiB |  20738 MiB |
|       from large pool |    894 MiB |  11356 MiB |  21574 MiB |  20680 MiB |
|       from small pool |     94 MiB |    126 MiB |    152 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB |    861 TiB |    861 TiB |
|       from large pool |  50944 KiB |   1322 MiB |    856 TiB |    856 TiB |
|       from small pool |      0 KiB |     24 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  279834 K  |  279834 K  |
|       from large pool |       2    |     908    |  113788 K  |  113788 K  |
|       from small pool |       0    |    6639    |  166046 K  |  166046 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  279834 K  |  279834 K  |
|       from large pool |       2    |     908    |  113788 K  |  113788 K  |
|       from small pool |       0    |    6639    |  166046 K  |  166046 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      80    |     404    |     724    |     644    |
|       from large pool |      33    |     341    |     648    |     615    |
|       from small pool |      47    |      63    |      76    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2772    |  150116 K  |  150116 K  |
|       from large pool |       4    |     187    |   69937 K  |   69937 K  |
|       from small pool |       0    |    2751    |   80178 K  |   80178 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748

 Experiment start at: 2024-05-30 13:39:32.813984
before training, model accuracy: 0.04888604208827019
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95249176, 'precision': 0.49914628, 'recall': 0.49964902, 'specificity': 0.49964902, 'f1': 0.49725333, 'auroc': 0.50513506, 'binary_precision': 0.03284072, 'binary_recall': 0.013218771, 'binary_specificity': 0.9860793, 'binary_f1_score': 0.01885014}
confusion matrix:
       0    1
0  41722  589
1   1493   20
---- Validation: 
scalar performance:
{'acc': 0.93064505, 'precision': 0.4884282, 'recall': 0.4863599, 'specificity': 0.4863599, 'f1': 0.4873506, 'auroc': 0.3979484, 'binary_precision': 0.009803922, 'binary_recall': 0.011627907, 'binary_specificity': 0.9610919, 'binary_f1_score': 0.010638298}
confusion matrix:
       0    1
0  17464  707
1    595    7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9463055, 'precision': 0.4856505, 'recall': 0.49422884, 'specificity': 0.49422884, 'f1': 0.48917112, 'auroc': 0.39831468, 'binary_precision': 0.010526316, 'binary_recall': 0.004132231, 'binary_specificity': 0.98432547, 'binary_f1_score': 0.005934718}
confusion matrix:
      0   1
0  5903  94
1   241   1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-30 14:04:42.090300,epoch time: 0:25:09.276316,used: 0:25:09.276316,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9648594, 'precision': 0.5758354, 'recall': 0.50223017, 'specificity': 0.50223017, 'f1': 0.49619746, 'auroc': 0.67986715, 'binary_precision': 0.18604651, 'binary_recall': 0.0052875085, 'binary_specificity': 0.9991728, 'binary_f1_score': 0.010282776}
confusion matrix:
       0   1
0  42276  35
1   1505   8
---- Validation: 
scalar performance:
{'acc': 0.96692055, 'precision': 0.5274783, 'recall': 0.5010833, 'specificity': 0.5010833, 'f1': 0.49479014, 'auroc': 0.63831055, 'binary_precision': 0.08695652, 'binary_recall': 0.003322259, 'binary_specificity': 0.9988443, 'binary_f1_score': 0.0064}
confusion matrix:
       0   1
0  18150  21
1    600   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9591281, 'precision': 0.48056537, 'recall': 0.49891612, 'specificity': 0.49891612, 'f1': 0.48956886, 'auroc': 0.61254144, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5984  13
1   242   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-30 14:28:48.929436,epoch time: 0:24:06.839136,used: 0:49:16.115452,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96538424, 'precision': 0.56608015, 'recall': 0.5002714, 'specificity': 0.5002714, 'f1': 0.49185175, 'auroc': 0.7805455, 'binary_precision': 0.16666667, 'binary_recall': 0.00066093856, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.0013166557}
confusion matrix:
       0  1
0  42306  5
1   1512  1
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.48396462, 'recall': 0.49994496, 'specificity': 0.49994496, 'f1': 0.49182498, 'auroc': 0.76096106, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18169  2
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7306798, 'recall': 0.50198275, 'specificity': 0.50198275, 'f1': 0.4942079, 'auroc': 0.7337787, 'binary_precision': 0.5, 'binary_recall': 0.004132231, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.008196721}
confusion matrix:
      0  1
0  5996  1
1   241  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-30 14:52:56.976903,epoch time: 0:24:08.047467,used: 1:13:24.162919,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96545273, 'precision': 0.64941466, 'recall': 0.50030684, 'specificity': 0.50030684, 'f1': 0.4918708, 'auroc': 0.8339597, 'binary_precision': 0.33333334, 'binary_recall': 0.00066093856, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.0013192613}
confusion matrix:
       0  1
0  42309  2
1   1512  1
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.4839655, 'recall': 0.4999725, 'specificity': 0.4999725, 'f1': 0.4918388, 'auroc': 0.8318777, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18170  1
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.9806829, 'recall': 0.50206614, 'specificity': 0.50206614, 'f1': 0.49426642, 'auroc': 0.82711256, 'binary_precision': 1.0, 'binary_recall': 0.004132231, 'binary_specificity': 1.0, 'binary_f1_score': 0.008230452}
confusion matrix:
      0  1
0  5997  0
1   241  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-05-30 15:17:04.212152,epoch time: 0:24:07.235249,used: 1:37:31.398168,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9654983, 'precision': 0.98274875, 'recall': 0.50033045, 'specificity': 0.50033045, 'f1': 0.4918835, 'auroc': 0.85082686, 'binary_precision': 1.0, 'binary_recall': 0.00066093856, 'binary_specificity': 1.0, 'binary_f1_score': 0.0013210041}
confusion matrix:
       0  1
0  42311  0
1   1512  1
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.85033655, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.98076, 'recall': 0.5041322, 'specificity': 0.5041322, 'f1': 0.498388, 'auroc': 0.8502295, 'binary_precision': 1.0, 'binary_recall': 0.008264462, 'binary_specificity': 1.0, 'binary_f1_score': 0.016393442}
confusion matrix:
      0  1
0  5997  0
1   240  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-05-30 15:41:07.882468,epoch time: 0:24:03.670316,used: 2:01:35.068484,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.48273778, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912173, 'auroc': 0.87047374, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42311  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.870998, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.98091424, 'recall': 0.5082645, 'specificity': 0.5082645, 'f1': 0.5065316, 'auroc': 0.851742, 'binary_precision': 1.0, 'binary_recall': 0.016528925, 'binary_specificity': 1.0, 'binary_f1_score': 0.032520324}
confusion matrix:
      0  1
0  5997  0
1   238  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9615322947502136 / 0.9618528485298157
after epoch: 6,now: 2024-05-30 16:05:27.321279,epoch time: 0:24:19.438811,used: 2:25:54.507295,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9653158, 'precision': 0.5736654, 'recall': 0.50055456, 'specificity': 0.50055456, 'f1': 0.49248785, 'auroc': 0.8843047, 'binary_precision': 0.18181819, 'binary_recall': 0.0013218771, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.002624672}
confusion matrix:
       0  1
0  42302  9
1   1511  2
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.8173504, 'recall': 0.50163364, 'specificity': 0.50163364, 'f1': 0.49517122, 'auroc': 0.88549536, 'binary_precision': 0.6666667, 'binary_recall': 0.003322259, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0066115703}
confusion matrix:
       0  1
0  18170  1
1    600  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.9808371, 'recall': 0.50619835, 'specificity': 0.50619835, 'f1': 0.5024762, 'auroc': 0.8846345, 'binary_precision': 1.0, 'binary_recall': 0.012396694, 'binary_specificity': 1.0, 'binary_f1_score': 0.024489796}
confusion matrix:
      0  1
0  5997  0
1   239  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
better model found
persisted
after epoch: 7,now: 2024-05-30 16:29:43.325573,epoch time: 0:24:16.004294,used: 2:50:10.511589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9654983, 'precision': 0.7520433, 'recall': 0.5022424, 'specificity': 0.5022424, 'f1': 0.49580893, 'auroc': 0.88788927, 'binary_precision': 0.53846157, 'binary_recall': 0.00462657, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.0091743115}
confusion matrix:
       0  1
0  42305  6
1   1506  7
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.65065706, 'recall': 0.5007755, 'specificity': 0.5007755, 'f1': 0.49349123, 'auroc': 0.8846636, 'binary_precision': 0.33333334, 'binary_recall': 0.0016611295, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.0033057851}
confusion matrix:
       0  1
0  18169  2
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.98114574, 'recall': 0.5144628, 'specificity': 0.5144628, 'f1': 0.51850414, 'auroc': 0.8742312, 'binary_precision': 1.0, 'binary_recall': 0.02892562, 'binary_specificity': 1.0, 'binary_f1_score': 0.056224898}
confusion matrix:
      0  1
0  5997  0
1   235  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 1
val acc:0.9678794145584106, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9616925716400146 / 0.9623336791992188
after epoch: 8,now: 2024-05-30 16:54:00.170973,epoch time: 0:24:16.845400,used: 3:14:27.356989,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9651789, 'precision': 0.6536132, 'recall': 0.5043075, 'specificity': 0.5043075, 'f1': 0.5001466, 'auroc': 0.90016913, 'binary_precision': 0.34146342, 'binary_recall': 0.00925314, 'binary_specificity': 0.9993619, 'binary_f1_score': 0.018018018}
confusion matrix:
       0   1
0  42284  27
1   1499  14
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.7569948, 'recall': 0.5096916, 'specificity': 0.5096916, 'f1': 0.51110554, 'auroc': 0.89711094, 'binary_precision': 0.54545456, 'binary_recall': 0.019933555, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.038461536}
confusion matrix:
       0   1
0  18161  10
1    590  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.98184156, 'recall': 0.53305787, 'specificity': 0.53305787, 'f1': 0.55276835, 'auroc': 0.87798464, 'binary_precision': 1.0, 'binary_recall': 0.0661157, 'binary_specificity': 1.0, 'binary_f1_score': 0.124031}
confusion matrix:
      0   1
0  5997   0
1   226  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-05-30 17:18:05.065750,epoch time: 0:24:04.894777,used: 3:38:32.251766,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.965544, 'precision': 0.7403339, 'recall': 0.5175613, 'specificity': 0.5175613, 'f1': 0.5251744, 'auroc': 0.8999479, 'binary_precision': 0.5140187, 'binary_recall': 0.03635162, 'binary_specificity': 0.998771, 'binary_f1_score': 0.06790124}
confusion matrix:
       0   1
0  42259  52
1   1458  55
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73454106, 'recall': 0.5184701, 'specificity': 0.5184701, 'f1': 0.5273362, 'auroc': 0.89631337, 'binary_precision': 0.5, 'binary_recall': 0.03820598, 'binary_specificity': 0.99873424, 'binary_f1_score': 0.07098766}
confusion matrix:
       0   1
0  18148  23
1    579  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.9482064, 'recall': 0.5556184, 'specificity': 0.5556184, 'f1': 0.59074265, 'auroc': 0.87756276, 'binary_precision': 0.9310345, 'binary_recall': 0.11157025, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.19926198}
confusion matrix:
      0   1
0  5995   2
1   215  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9680392146110535, corresponding to test acc:                         0.9637762308120728 / 0.9652187824249268
after epoch: 10,now: 2024-05-30 17:41:39.317093,epoch time: 0:23:34.251343,used: 4:02:06.503109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96545273, 'precision': 0.7322899, 'recall': 0.5283482, 'specificity': 0.5283482, 'f1': 0.5437936, 'auroc': 0.9042338, 'binary_precision': 0.49720672, 'binary_recall': 0.05882353, 'binary_specificity': 0.9978729, 'binary_f1_score': 0.10520094}
confusion matrix:
       0   1
0  42221  90
1   1424  89
---- Validation: 
scalar performance:
{'acc': 0.9674, 'precision': 0.7078109, 'recall': 0.5326498, 'specificity': 0.5326498, 'f1': 0.55077434, 'auroc': 0.90064126, 'binary_precision': 0.4456522, 'binary_recall': 0.06810631, 'binary_specificity': 0.99719334, 'binary_f1_score': 0.11815561}
confusion matrix:
       0   1
0  18120  51
1    561  41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.932986, 'recall': 0.59049225, 'specificity': 0.59049225, 'f1': 0.6428742, 'auroc': 0.88974166, 'binary_precision': 0.8979592, 'binary_recall': 0.18181819, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.3024055}
confusion matrix:
      0   1
0  5992   5
1   198  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 2
val acc:0.9674000144004822, best validation acc: 0.9680392146110535, corresponding to test acc:                         0.9637762308120728 / 0.9674627184867859
after epoch: 11,now: 2024-05-30 18:05:14.216424,epoch time: 0:23:34.899331,used: 4:25:41.402440,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9654299, 'precision': 0.7293545, 'recall': 0.5194141, 'specificity': 0.5194141, 'f1': 0.5284563, 'auroc': 0.90970206, 'binary_precision': 0.4919355, 'binary_recall': 0.040317252, 'binary_specificity': 0.998511, 'binary_f1_score': 0.07452658}
confusion matrix:
       0   1
0  42248  63
1   1452  61
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.7228093, 'recall': 0.52400887, 'specificity': 0.52400887, 'f1': 0.5369107, 'auroc': 0.9037684, 'binary_precision': 0.47619048, 'binary_recall': 0.049833886, 'binary_specificity': 0.9981839, 'binary_f1_score': 0.09022556}
confusion matrix:
       0   1
0  18138  33
1    572  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685847, 'precision': 0.964327, 'recall': 0.59900683, 'specificity': 0.59900683, 'f1': 0.65634155, 'auroc': 0.9011508, 'binary_precision': 0.96, 'binary_recall': 0.1983471, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.32876712}
confusion matrix:
      0   1
0  5995   2
1   194  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 3
val acc:0.9677728414535522, best validation acc: 0.9680392146110535, corresponding to test acc:                         0.9637762308120728 / 0.9685847163200378
after epoch: 12,now: 2024-05-30 18:29:11.216488,epoch time: 0:23:57.000064,used: 4:49:38.402504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9654071, 'precision': 0.7324858, 'recall': 0.5557287, 'specificity': 0.5557287, 'f1': 0.5849471, 'auroc': 0.91398513, 'binary_precision': 0.4957507, 'binary_recall': 0.11566424, 'binary_specificity': 0.99579304, 'binary_f1_score': 0.187567}
confusion matrix:
       0    1
0  42133  178
1   1338  175
---- Validation: 
scalar performance:
{'acc': 0.9672402, 'precision': 0.7187658, 'recall': 0.5695075, 'specificity': 0.5695075, 'f1': 0.6019004, 'auroc': 0.9103869, 'binary_precision': 0.46524063, 'binary_recall': 0.14451827, 'binary_specificity': 0.9944967, 'binary_f1_score': 0.2205323}
confusion matrix:
       0    1
0  18071  100
1    515   87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96906555, 'precision': 0.9077816, 'recall': 0.6230498, 'specificity': 0.6230498, 'f1': 0.68376064, 'auroc': 0.89263225, 'binary_precision': 0.8450704, 'binary_recall': 0.24793388, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.38338655}
confusion matrix:
      0   1
0  5986  11
1   182  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 4
val acc:0.9672402143478394, best validation acc: 0.9680392146110535, corresponding to test acc:                         0.9637762308120728 / 0.9690655469894409
after epoch: 13,now: 2024-05-30 18:53:15.013312,epoch time: 0:24:03.796824,used: 5:13:42.199328,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9649735, 'precision': 0.71677506, 'recall': 0.5462632, 'specificity': 0.5462632, 'f1': 0.5709694, 'auroc': 0.90955627, 'binary_precision': 0.46496814, 'binary_recall': 0.09649703, 'binary_specificity': 0.9960294, 'binary_f1_score': 0.15982486}
confusion matrix:
       0    1
0  42143  168
1   1367  146
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.73761916, 'recall': 0.5714988, 'specificity': 0.5714988, 'f1': 0.60607594, 'auroc': 0.90948653, 'binary_precision': 0.50282484, 'binary_recall': 0.14784053, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.22849806}
confusion matrix:
       0   1
0  18083  88
1    513  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97146976, 'precision': 0.93619907, 'recall': 0.64809334, 'specificity': 0.64809334, 'f1': 0.716281, 'auroc': 0.90171325, 'binary_precision': 0.9, 'binary_recall': 0.29752067, 'binary_specificity': 0.998666, 'binary_f1_score': 0.44720498}
confusion matrix:
      0   1
0  5989   8
1   170  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 5
val acc:0.9679859280586243, best validation acc: 0.9680392146110535, corresponding to test acc:                         0.9637762308120728 / 0.9714697599411011
after epoch: 14,now: 2024-05-30 19:17:26.480349,epoch time: 0:24:11.467037,used: 5:37:53.666365,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9660688, 'precision': 0.7480012, 'recall': 0.5888925, 'specificity': 0.5888925, 'f1': 0.6273892, 'auroc': 0.91541266, 'binary_precision': 0.5245283, 'binary_recall': 0.18374091, 'binary_specificity': 0.9940441, 'binary_f1_score': 0.27214882}
confusion matrix:
       0    1
0  42059  252
1   1235  278
---- Validation: 
scalar performance:
{'acc': 0.9674, 'precision': 0.7266665, 'recall': 0.5936815, 'specificity': 0.5936815, 'f1': 0.62996, 'auroc': 0.9138762, 'binary_precision': 0.4795082, 'binary_recall': 0.19435216, 'binary_specificity': 0.9930108, 'binary_f1_score': 0.27659574}
confusion matrix:
       0    1
0  18044  127
1    485  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97387403, 'precision': 0.9191209, 'recall': 0.69296426, 'specificity': 0.69296426, 'f1': 0.76108575, 'auroc': 0.90960515, 'binary_precision': 0.86238533, 'binary_recall': 0.38842976, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.5356125}
confusion matrix:
      0   1
0  5982  15
1   148  94
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 6
val acc:0.9674000144004822, best validation acc: 0.9680392146110535, corresponding to test acc:                         0.9637762308120728 / 0.973874032497406
after epoch: 15,now: 2024-05-30 19:41:37.142778,epoch time: 0:24:10.662429,used: 6:02:04.328794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96572655, 'precision': 0.74055856, 'recall': 0.62822807, 'specificity': 0.62822807, 'f1': 0.66552794, 'auroc': 0.9165391, 'binary_precision': 0.5069357, 'binary_recall': 0.2656973, 'binary_specificity': 0.9907589, 'binary_f1_score': 0.34865567}
confusion matrix:
       0    1
0  41920  391
1   1111  402
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.7377172, 'recall': 0.67257285, 'specificity': 0.67257285, 'f1': 0.6994443, 'auroc': 0.9129945, 'binary_precision': 0.4965358, 'binary_recall': 0.35714287, 'binary_specificity': 0.98800284, 'binary_f1_score': 0.41545892}
confusion matrix:
       0    1
0  17953  218
1    387  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97547686, 'precision': 0.9090419, 'recall': 0.72552186, 'specificity': 0.72552186, 'f1': 0.7885865, 'auroc': 0.91027474, 'binary_precision': 0.8396947, 'binary_recall': 0.45454547, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.5898124}
confusion matrix:
      0    1
0  5976   21
1   132  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 7
val acc:0.9677728414535522, best validation acc: 0.9680392146110535, corresponding to test acc:                         0.9637762308120728 / 0.975476861000061
after epoch: 16,now: 2024-05-30 20:05:51.797642,epoch time: 0:24:14.654864,used: 6:26:18.983658,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9643118, 'precision': 0.7183477, 'recall': 0.60455245, 'specificity': 0.60455245, 'f1': 0.6392269, 'auroc': 0.9173038, 'binary_precision': 0.46413502, 'binary_recall': 0.21810971, 'binary_specificity': 0.9909952, 'binary_f1_score': 0.2967626}
confusion matrix:
       0    1
0  41930  381
1   1183  330
---- Validation: 
scalar performance:
{'acc': 0.9675598, 'precision': 0.7344694, 'recall': 0.65559876, 'specificity': 0.65559876, 'f1': 0.6862525, 'auroc': 0.9171994, 'binary_precision': 0.49113923, 'binary_recall': 0.32225913, 'binary_specificity': 0.9889384, 'binary_f1_score': 0.3891675}
confusion matrix:
       0    1
0  17970  201
1    408  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9767591, 'precision': 0.927428, 'recall': 0.7321371, 'specificity': 0.7321371, 'f1': 0.798594, 'auroc': 0.90239954, 'binary_precision': 0.875969, 'binary_recall': 0.46694216, 'binary_specificity': 0.997332, 'binary_f1_score': 0.6091645}
confusion matrix:
      0    1
0  5981   16
1   129  113
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 8
val acc:0.967559814453125, best validation acc: 0.9680392146110535, corresponding to test acc:                         0.9637762308120728 / 0.9767590761184692
after epoch: 17,now: 2024-05-30 20:29:57.990377,epoch time: 0:24:06.192735,used: 6:50:25.176393,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96527016, 'precision': 0.73049927, 'recall': 0.5741396, 'specificity': 0.5741396, 'f1': 0.6083192, 'auroc': 0.91783196, 'binary_precision': 0.49052632, 'binary_recall': 0.15399867, 'binary_specificity': 0.99428046, 'binary_f1_score': 0.23440643}
confusion matrix:
       0    1
0  42069  242
1   1280  233
---- Validation: 
scalar performance:
{'acc': 0.9670271, 'precision': 0.72044724, 'recall': 0.59589803, 'specificity': 0.59589803, 'f1': 0.63126105, 'auroc': 0.91848046, 'binary_precision': 0.46692607, 'binary_recall': 0.19933555, 'binary_specificity': 0.9924605, 'binary_f1_score': 0.27939466}
confusion matrix:
       0    1
0  18034  137
1    482  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9711492, 'precision': 0.8981912, 'recall': 0.66180575, 'specificity': 0.66180575, 'f1': 0.7263143, 'auroc': 0.89848983, 'binary_precision': 0.8229167, 'binary_recall': 0.3264463, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.46745563}
confusion matrix:
      0   1
0  5980  17
1   163  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 9
val acc:0.9670271277427673, best validation acc: 0.9680392146110535, corresponding to test acc:                         0.9637762308120728 / 0.9767590761184692
after epoch: 18,now: 2024-05-30 20:54:10.482170,epoch time: 0:24:12.491793,used: 7:14:37.668186,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9648366, 'precision': 0.72700304, 'recall': 0.6121533, 'specificity': 0.6121533, 'f1': 0.6480762, 'auroc': 0.9225477, 'binary_precision': 0.48092642, 'binary_recall': 0.2333113, 'binary_specificity': 0.9909952, 'binary_f1_score': 0.3141967}
confusion matrix:
       0    1
0  41930  381
1   1160  353
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.73645604, 'recall': 0.6701087, 'specificity': 0.6701087, 'f1': 0.69731396, 'auroc': 0.9179926, 'binary_precision': 0.49417248, 'binary_recall': 0.35215947, 'binary_specificity': 0.9880579, 'binary_f1_score': 0.41125122}
confusion matrix:
       0    1
0  17954  217
1    390  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9759577, 'precision': 0.92166126, 'recall': 0.7237892, 'specificity': 0.7237892, 'f1': 0.79000247, 'auroc': 0.9159291, 'binary_precision': 0.86507934, 'binary_recall': 0.45041323, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.5923913}
confusion matrix:
      0    1
0  5980   17
1   133  109
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 10
val acc:0.9676663279533386, best validation acc: 0.9680392146110535, corresponding to test acc:                         0.9637762308120728 / 0.9767590761184692
after epoch: 19,now: 2024-05-30 21:18:28.481621,epoch time: 0:24:17.999451,used: 7:38:55.667637,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96538424, 'precision': 0.7341958, 'recall': 0.59331775, 'specificity': 0.59331775, 'f1': 0.6304581, 'auroc': 0.9192908, 'binary_precision': 0.49661016, 'binary_recall': 0.19365498, 'binary_specificity': 0.99298054, 'binary_f1_score': 0.27864954}
confusion matrix:
       0    1
0  42014  297
1   1220  293
---- Validation: 
scalar performance:
{'acc': 0.96708035, 'precision': 0.72648865, 'recall': 0.6312597, 'specificity': 0.6312597, 'f1': 0.6649189, 'auroc': 0.9154695, 'binary_precision': 0.47674417, 'binary_recall': 0.27242523, 'binary_specificity': 0.9900941, 'binary_f1_score': 0.34672305}
confusion matrix:
       0    1
0  17991  180
1    438  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.974996, 'precision': 0.9207673, 'recall': 0.7094098, 'specificity': 0.7094098, 'f1': 0.7768966, 'auroc': 0.9101038, 'binary_precision': 0.86440676, 'binary_recall': 0.4214876, 'binary_specificity': 0.997332, 'binary_f1_score': 0.56666666}
confusion matrix:
      0    1
0  5981   16
1   140  102
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 11
val acc:0.9670803546905518, best validation acc: 0.9680392146110535, corresponding to test acc:                         0.9637762308120728 / 0.9767590761184692
after epoch: 20,now: 2024-05-30 21:42:50.234510,epoch time: 0:24:21.752889,used: 8:03:17.420526,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9654071, 'precision': 0.73621035, 'recall': 0.62933725, 'specificity': 0.62933725, 'f1': 0.6655144, 'auroc': 0.9236121, 'binary_precision': 0.4981595, 'binary_recall': 0.26834103, 'binary_specificity': 0.9903335, 'binary_f1_score': 0.34879723}
confusion matrix:
       0    1
0  41902  409
1   1107  406
---- Validation: 
scalar performance:
{'acc': 0.9674, 'precision': 0.7335008, 'recall': 0.668365, 'specificity': 0.668365, 'f1': 0.69510806, 'auroc': 0.9193859, 'binary_precision': 0.4883721, 'binary_recall': 0.3488372, 'binary_specificity': 0.9878928, 'binary_f1_score': 0.40697673}
confusion matrix:
       0    1
0  17951  220
1    392  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97868246, 'precision': 0.936371, 'recall': 0.7549477, 'specificity': 0.7549477, 'f1': 0.8199621, 'auroc': 0.9134071, 'binary_precision': 0.8920863, 'binary_recall': 0.5123967, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.6509186}
confusion matrix:
      0    1
0  5982   15
1   118  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
early stop counter: 12
val acc:0.9674000144004822, best validation acc: 0.9680392146110535, corresponding to test acc:                         0.9637762308120728 / 0.9786824584007263
after epoch: 21,now: 2024-05-30 22:07:10.975894,epoch time: 0:24:20.741384,used: 8:27:38.161910,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.7375734, 'recall': 0.6421188, 'specificity': 0.6421188, 'f1': 0.6765723, 'auroc': 0.9256097, 'binary_precision': 0.5, 'binary_recall': 0.2947786, 'binary_specificity': 0.989459, 'binary_f1_score': 0.37089399}
confusion matrix:
       0    1
0  41865  446
1   1067  446
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.74124044, 'recall': 0.69599885, 'specificity': 0.69599885, 'f1': 0.7160361, 'auroc': 0.91905516, 'binary_precision': 0.5020576, 'binary_recall': 0.4053156, 'binary_specificity': 0.98668206, 'binary_f1_score': 0.44852942}
confusion matrix:
       0    1
0  17929  242
1    358  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97691935, 'precision': 0.91021276, 'recall': 0.7480824, 'specificity': 0.7480824, 'f1': 0.8075172, 'auroc': 0.91622746, 'binary_precision': 0.8402778, 'binary_recall': 0.5, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.626943}
confusion matrix:
      0    1
0  5974   23
1   121  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 13
val acc:0.9680392146110535, best validation acc: 0.9680392146110535, corresponding to test acc:                         0.9637762308120728 / 0.9786824584007263
after epoch: 22,now: 2024-05-30 22:31:31.689425,epoch time: 0:24:20.713531,used: 8:51:58.875441,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96565807, 'precision': 0.7403725, 'recall': 0.66738683, 'specificity': 0.66738683, 'f1': 0.6966362, 'auroc': 0.9326438, 'binary_precision': 0.5038388, 'binary_recall': 0.34699273, 'binary_specificity': 0.9877809, 'binary_f1_score': 0.41095892}
confusion matrix:
       0    1
0  41794  517
1    988  525
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.7419808, 'recall': 0.70485985, 'specificity': 0.70485985, 'f1': 0.7217172, 'auroc': 0.92408586, 'binary_precision': 0.5029586, 'binary_recall': 0.42358804, 'binary_specificity': 0.9861317, 'binary_f1_score': 0.45987377}
confusion matrix:
       0    1
0  17919  252
1    347  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9790031, 'precision': 0.92007434, 'recall': 0.7729591, 'specificity': 0.7729591, 'f1': 0.82959086, 'auroc': 0.9163976, 'binary_precision': 0.85806453, 'binary_recall': 0.5495868, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.67002517}
confusion matrix:
      0    1
0  5975   22
1   109  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-05-30 22:55:51.873397,epoch time: 0:24:20.183972,used: 9:16:19.059413,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9657494, 'precision': 0.7408598, 'recall': 0.61804307, 'specificity': 0.61804307, 'f1': 0.6563176, 'auroc': 0.9281317, 'binary_precision': 0.5082418, 'binary_recall': 0.24454726, 'binary_specificity': 0.9915388, 'binary_f1_score': 0.33020973}
confusion matrix:
       0    1
0  41953  358
1   1143  370
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.7359378, 'recall': 0.6332235, 'specificity': 0.6332235, 'f1': 0.66889817, 'auroc': 0.92072487, 'binary_precision': 0.49552238, 'binary_recall': 0.2757475, 'binary_specificity': 0.99069947, 'binary_f1_score': 0.35432228}
confusion matrix:
       0    1
0  18002  169
1    436  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97740024, 'precision': 0.91915673, 'recall': 0.7483325, 'specificity': 0.7483325, 'f1': 0.81009805, 'auroc': 0.9071359, 'binary_precision': 0.858156, 'binary_recall': 0.5, 'binary_specificity': 0.996665, 'binary_f1_score': 0.6318538}
confusion matrix:
      0    1
0  5977   20
1   121  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 1
val acc:0.9677728414535522, best validation acc: 0.9680925011634827, corresponding to test acc:                         0.9790030717849731 / 0.9790030717849731
after epoch: 24,now: 2024-05-30 23:19:49.012012,epoch time: 0:23:57.138615,used: 9:40:16.198028,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96584064, 'precision': 0.7426183, 'recall': 0.6881938, 'specificity': 0.6881938, 'f1': 0.7115871, 'auroc': 0.9294189, 'binary_precision': 0.50687283, 'binary_recall': 0.38995373, 'binary_specificity': 0.9864338, 'binary_f1_score': 0.44079193}
confusion matrix:
       0    1
0  41737  574
1    923  590
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.7426606, 'recall': 0.73055744, 'specificity': 0.73055744, 'f1': 0.7364377, 'auroc': 0.923516, 'binary_precision': 0.50262696, 'binary_recall': 0.47674417, 'binary_specificity': 0.9843707, 'binary_f1_score': 0.48934355}
confusion matrix:
       0    1
0  17887  284
1    315  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9782016, 'precision': 0.8973142, 'recall': 0.782456, 'specificity': 0.782456, 'f1': 0.8293158, 'auroc': 0.91874933, 'binary_precision': 0.8117647, 'binary_recall': 0.57024795, 'binary_specificity': 0.994664, 'binary_f1_score': 0.669903}
confusion matrix:
      0    1
0  5965   32
1   104  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 2
val acc:0.9680925011634827, best validation acc: 0.9680925011634827, corresponding to test acc:                         0.9790030717849731 / 0.9790030717849731
after epoch: 25,now: 2024-05-30 23:45:28.251792,epoch time: 0:25:39.239780,used: 10:05:55.437808,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9657494, 'precision': 0.74145424, 'recall': 0.6734885, 'specificity': 0.6734885, 'f1': 0.70129645, 'auroc': 0.9314904, 'binary_precision': 0.5055762, 'binary_recall': 0.35955057, 'binary_specificity': 0.98742646, 'binary_f1_score': 0.42023948}
confusion matrix:
       0    1
0  41779  532
1    969  544
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.74076355, 'recall': 0.71280783, 'specificity': 0.71280783, 'f1': 0.7258329, 'auroc': 0.9242839, 'binary_precision': 0.5, 'binary_recall': 0.44019935, 'binary_specificity': 0.9854163, 'binary_f1_score': 0.46819788}
confusion matrix:
       0    1
0  17906  265
1    337  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9765988, 'precision': 0.8854395, 'recall': 0.767743, 'specificity': 0.767743, 'f1': 0.81503034, 'auroc': 0.92012537, 'binary_precision': 0.7891566, 'binary_recall': 0.5413223, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.64215684}
confusion matrix:
      0    1
0  5962   35
1   111  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 3
val acc:0.9679326415061951, best validation acc: 0.9680925011634827, corresponding to test acc:                         0.9790030717849731 / 0.9790030717849731
after epoch: 26,now: 2024-05-31 00:11:22.374424,epoch time: 0:25:54.122632,used: 10:31:49.560440,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96474534, 'precision': 0.7354083, 'recall': 0.73255646, 'specificity': 0.73255646, 'f1': 0.73397267, 'auroc': 0.9334401, 'binary_precision': 0.4892905, 'binary_recall': 0.48314607, 'binary_specificity': 0.98196685, 'binary_f1_score': 0.4861989}
confusion matrix:
       0    1
0  41548  763
1    782  731
---- Validation: 
scalar performance:
{'acc': 0.96638787, 'precision': 0.73224175, 'recall': 0.7682232, 'specificity': 0.7682232, 'f1': 0.7487896, 'auroc': 0.928149, 'binary_precision': 0.4792561, 'binary_recall': 0.5564784, 'binary_specificity': 0.9799681, 'binary_f1_score': 0.5149885}
confusion matrix:
       0    1
0  17807  364
1    267  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97515625, 'precision': 0.85881305, 'recall': 0.7769064, 'specificity': 0.7769064, 'f1': 0.81207013, 'auroc': 0.9124583, 'binary_precision': 0.73513514, 'binary_recall': 0.56198347, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.63700235}
confusion matrix:
      0    1
0  5948   49
1   106  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 4
val acc:0.9663878679275513, best validation acc: 0.9680925011634827, corresponding to test acc:                         0.9790030717849731 / 0.9790030717849731
after epoch: 27,now: 2024-05-31 00:36:59.969963,epoch time: 0:25:37.595539,used: 10:57:27.155979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.966548, 'precision': 0.7491826, 'recall': 0.71341497, 'specificity': 0.71341497, 'f1': 0.72976196, 'auroc': 0.9312845, 'binary_precision': 0.5182312, 'binary_recall': 0.44150695, 'binary_specificity': 0.98532295, 'binary_f1_score': 0.47680232}
confusion matrix:
       0    1
0  41690  621
1    845  668
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.743225, 'recall': 0.73540324, 'specificity': 0.73540324, 'f1': 0.7392433, 'auroc': 0.92629814, 'binary_precision': 0.50343645, 'binary_recall': 0.48671097, 'binary_specificity': 0.9840955, 'binary_f1_score': 0.49493244}
confusion matrix:
       0    1
0  17882  289
1    309  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97691935, 'precision': 0.8805455, 'recall': 0.77980626, 'specificity': 0.77980626, 'f1': 0.82178104, 'auroc': 0.90742946, 'binary_precision': 0.77840906, 'binary_recall': 0.5661157, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.6555024}
confusion matrix:
      0    1
0  5958   39
1   105  137
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
better model found
persisted
after epoch: 28,now: 2024-05-31 01:02:06.752646,epoch time: 0:25:06.782683,used: 11:22:33.938662,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9658863, 'precision': 0.74322283, 'recall': 0.69905156, 'specificity': 0.69905156, 'f1': 0.7186842, 'auroc': 0.9349773, 'binary_precision': 0.50731707, 'binary_recall': 0.41242564, 'binary_specificity': 0.9856775, 'binary_f1_score': 0.4549763}
confusion matrix:
       0    1
0  41705  606
1    889  624
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.7406831, 'recall': 0.7360412, 'specificity': 0.7360412, 'f1': 0.7383371, 'auroc': 0.92802787, 'binary_precision': 0.49830508, 'binary_recall': 0.4883721, 'binary_specificity': 0.9837103, 'binary_f1_score': 0.4932886}
confusion matrix:
       0    1
0  17875  296
1    308  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9777208, 'precision': 0.8886501, 'recall': 0.78418857, 'specificity': 0.78418857, 'f1': 0.827571, 'auroc': 0.92264104, 'binary_precision': 0.7942857, 'binary_recall': 0.57438016, 'binary_specificity': 0.993997, 'binary_f1_score': 0.6666666}
confusion matrix:
      0    1
0  5961   36
1   103  139
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 1
val acc:0.9678261280059814, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9769193530082703 / 0.9790030717849731
after epoch: 29,now: 2024-05-31 01:28:10.653187,epoch time: 0:26:03.900541,used: 11:48:37.839203,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.966046, 'precision': 0.74460113, 'recall': 0.6892561, 'specificity': 0.6892561, 'f1': 0.71300954, 'auroc': 0.93478495, 'binary_precision': 0.51076657, 'binary_recall': 0.39193654, 'binary_specificity': 0.9865756, 'binary_f1_score': 0.4435303}
confusion matrix:
       0    1
0  41743  568
1    920  593
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.73985267, 'recall': 0.7135559, 'specificity': 0.7135559, 'f1': 0.7258605, 'auroc': 0.92603064, 'binary_precision': 0.49812734, 'binary_recall': 0.44186047, 'binary_specificity': 0.98525125, 'binary_f1_score': 0.46830988}
confusion matrix:
       0    1
0  17903  268
1    336  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9790031, 'precision': 0.90579915, 'recall': 0.7868383, 'specificity': 0.7868383, 'f1': 0.83520454, 'auroc': 0.92317784, 'binary_precision': 0.82840234, 'binary_recall': 0.5785124, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.6812652}
confusion matrix:
      0    1
0  5968   29
1   102  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993748.png
early stop counter: 2
val acc:0.9678261280059814, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9769193530082703 / 0.9790030717849731
after epoch: 30,now: 2024-05-31 01:54:08.346988,epoch time: 0:25:57.693801,used: 12:14:35.533004,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_32_seed_2_20993748
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:14:35.533004 at 2024-05-31 01:54:08.346988
persisted model performance metric: 

scalar performance:
{'acc': 0.97740024, 'precision': 0.8905945, 'recall': 0.77609086, 'specificity': 0.77609086, 'f1': 0.8226248, 'auroc': 0.9246395, 'binary_precision': 0.79881656, 'binary_recall': 0.55785125, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.6569344}
confusion matrix:
      0    1
0  5963   34
1   107  135
oracle model performance metric: 

scalar performance:
{'acc': 0.9778811, 'precision': 0.897817, 'recall': 0.77634096, 'specificity': 0.77634096, 'f1': 0.8251657, 'auroc': 0.91814107, 'binary_precision': 0.813253, 'binary_recall': 0.55785125, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.6617647}
confusion matrix:
      0    1
0  5966   31
1   107  135
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 491221 KiB |  10997 MiB |   2723 TiB |   2723 TiB |
|       from large pool | 401408 KiB |  10925 MiB |   2714 TiB |   2714 TiB |
|       from small pool |  89813 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 491221 KiB |  10997 MiB |   2723 TiB |   2723 TiB |
|       from large pool | 401408 KiB |  10925 MiB |   2714 TiB |   2714 TiB |
|       from small pool |  89813 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476572 KiB |  10880 MiB |   2696 TiB |   2696 TiB |
|       from large pool | 387840 KiB |  10808 MiB |   2688 TiB |   2688 TiB |
|       from small pool |  88732 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11504 MiB |  11504 MiB |  32242 MiB |  20738 MiB |
|       from large pool |  11380 MiB |  11380 MiB |  32060 MiB |  20680 MiB |
|       from small pool |    124 MiB |    126 MiB |    182 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 637226 KiB |   1325 MiB |   1285 TiB |   1285 TiB |
|       from large pool | 626688 KiB |   1322 MiB |   1276 TiB |   1276 TiB |
|       from small pool |  10538 KiB |     24 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3717    |    6728    |  419323 K  |  419319 K  |
|       from large pool |      87    |     908    |  170471 K  |  170471 K  |
|       from small pool |    3630    |    6639    |  248851 K  |  248848 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3717    |    6728    |  419323 K  |  419319 K  |
|       from large pool |      87    |     908    |  170471 K  |  170471 K  |
|       from small pool |    3630    |    6639    |  248851 K  |  248848 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     410    |     410    |    1054    |     644    |
|       from large pool |     348    |     348    |     963    |     615    |
|       from small pool |      62    |      63    |      91    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    2775    |  223063 K  |  223063 K  |
|       from large pool |      24    |     203    |  102914 K  |  102914 K  |
|       from small pool |      50    |    2751    |  120148 K  |  120148 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |   2723 TiB |   2723 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   2714 TiB |   2714 TiB |
|       from small pool |      0 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |   2723 TiB |   2723 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   2714 TiB |   2714 TiB |
|       from small pool |      0 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |   2696 TiB |   2696 TiB |
|       from large pool |  16640 KiB |  10808 MiB |   2688 TiB |   2688 TiB |
|       from small pool |      0 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1102 MiB |  11504 MiB |  32242 MiB |  31140 MiB |
|       from large pool |   1004 MiB |  11380 MiB |  32060 MiB |  31056 MiB |
|       from small pool |     98 MiB |    126 MiB |    182 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB |   1285 TiB |   1285 TiB |
|       from large pool |  50944 KiB |   1322 MiB |   1276 TiB |   1276 TiB |
|       from small pool |      0 KiB |     26 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  419323 K  |  419323 K  |
|       from large pool |       2    |     908    |  170471 K  |  170471 K  |
|       from small pool |       0    |    6639    |  248851 K  |  248851 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  419323 K  |  419323 K  |
|       from large pool |       2    |     908    |  170471 K  |  170471 K  |
|       from small pool |       0    |    6639    |  248851 K  |  248851 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      83    |     410    |    1054    |     971    |
|       from large pool |      34    |     348    |     963    |     929    |
|       from small pool |      49    |      63    |      91    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2775    |  223064 K  |  223064 K  |
|       from large pool |       4    |     203    |  102914 K  |  102914 K  |
|       from small pool |       0    |    2751    |  120149 K  |  120149 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri May 31 01:56:46 2024]
Finished job 0.
1 of 1 steps (100%) done
