Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jun  2 09:05:39 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736

 Experiment start at: 2024-06-02 09:16:39.459307
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9700174, 'precision': 0.8110297, 'recall': 0.61597353, 'specificity': 0.61597353, 'f1': 0.6655489, 'auroc': 0.95726025, 'binary_precision': 0.6480447, 'binary_recall': 0.23641305, 'binary_specificity': 0.995534, 'binary_f1_score': 0.34644103}
confusion matrix:
       0    1
0  42131  189
1   1124  348
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9683376, 'precision': 0.8303447, 'recall': 0.5665772, 'specificity': 0.5665772, 'f1': 0.605053, 'auroc': 0.9567076, 'binary_precision': 0.6904762, 'binary_recall': 0.13530326, 'binary_specificity': 0.99785113, 'binary_f1_score': 0.22626787}
confusion matrix:
       0   1
0  18110  39
1    556  87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.9804518, 'recall': 0.532567, 'specificity': 0.532567, 'f1': 0.55118215, 'auroc': 0.9428544, 'binary_precision': 1.0, 'binary_recall': 0.0651341, 'binary_specificity': 1.0, 'binary_f1_score': 0.12230217}
confusion matrix:
      0   1
0  5997   0
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-02 09:44:03.064397,epoch time: 0:27:23.605090,used: 0:27:23.605090,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9712733, 'precision': 0.7808473, 'recall': 0.75975025, 'specificity': 0.75975025, 'f1': 0.76984537, 'auroc': 0.9651851, 'binary_precision': 0.57785976, 'binary_recall': 0.53301567, 'binary_specificity': 0.9864849, 'binary_f1_score': 0.55453265}
confusion matrix:
       0    1
0  41751  572
1    686  783
---- Validation: 
scalar performance:
{'acc': 0.96812475, 'precision': 0.75859517, 'recall': 0.76673174, 'specificity': 0.76673174, 'f1': 0.7625934, 'auroc': 0.9634726, 'binary_precision': 0.53313255, 'binary_recall': 0.5505443, 'binary_specificity': 0.98291916, 'binary_f1_score': 0.5416986}
confusion matrix:
       0    1
0  17839  310
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9741131, 'precision': 0.9490812, 'recall': 0.7061462, 'specificity': 0.7061462, 'f1': 0.77904105, 'auroc': 0.95146716, 'binary_precision': 0.9230769, 'binary_recall': 0.41379312, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.57142854}
confusion matrix:
      0    1
0  5988    9
1   153  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_2.png
new oracle model saved
early stop counter: 1
val acc:0.9681247472763062, best validation acc: 0.9683375954627991, corresponding to test acc:                         0.9610099196434021 / 0.9741131067276001
after epoch: 2,now: 2024-06-02 10:09:46.056170,epoch time: 0:25:42.991773,used: 0:53:06.596863,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9670031, 'precision': 0.93806887, 'recall': 0.5101548, 'specificity': 0.5101548, 'f1': 0.5115401, 'auroc': 0.96595, 'binary_precision': 0.90909094, 'binary_recall': 0.020380436, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.03986711}
confusion matrix:
       0   1
0  42317   3
1   1442  30
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.9275409, 'recall': 0.5061933, 'specificity': 0.5061933, 'f1': 0.5036595, 'auroc': 0.9662322, 'binary_precision': 0.8888889, 'binary_recall': 0.01244168, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.024539877}
confusion matrix:
       0  1
0  18148  1
1    635  8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.9509167, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_3.png
early stop counter: 2
val acc:0.9661558270454407, best validation acc: 0.9683375954627991, corresponding to test acc:                         0.9610099196434021 / 0.9741131067276001
after epoch: 3,now: 2024-06-02 10:35:49.157752,epoch time: 0:26:03.101582,used: 1:19:09.698445,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.971867, 'precision': 0.9335715, 'recall': 0.59201324, 'specificity': 0.59201324, 'f1': 0.64597434, 'auroc': 0.9714414, 'binary_precision': 0.8947368, 'binary_recall': 0.18478261, 'binary_specificity': 0.99924386, 'binary_f1_score': 0.30630633}
confusion matrix:
       0    1
0  42288   32
1   1200  272
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.92452574, 'recall': 0.55648965, 'specificity': 0.55648965, 'f1': 0.59268296, 'auroc': 0.9717699, 'binary_precision': 0.8795181, 'binary_recall': 0.11353032, 'binary_specificity': 0.999449, 'binary_f1_score': 0.20110191}
confusion matrix:
       0   1
0  18139  10
1    570  73
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.97976, 'recall': 0.51532567, 'specificity': 0.51532567, 'f1': 0.5194107, 'auroc': 0.94214904, 'binary_precision': 1.0, 'binary_recall': 0.03065134, 'binary_specificity': 1.0, 'binary_f1_score': 0.059479553}
confusion matrix:
      0  1
0  5997  0
1   253  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_4.png
better model found
persisted
after epoch: 4,now: 2024-06-02 11:01:47.006197,epoch time: 0:25:57.848445,used: 1:45:07.546890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9750411, 'precision': 0.84265816, 'recall': 0.7185698, 'specificity': 0.7185698, 'f1': 0.7657813, 'auroc': 0.9666007, 'binary_precision': 0.7044229, 'binary_recall': 0.44361413, 'binary_specificity': 0.9935255, 'binary_f1_score': 0.54439354}
confusion matrix:
       0    1
0  42046  274
1    819  653
---- Validation: 
scalar performance:
{'acc': 0.9740315, 'precision': 0.8425489, 'recall': 0.70378494, 'specificity': 0.70378494, 'f1': 0.75411105, 'auroc': 0.9692459, 'binary_precision': 0.7055703, 'binary_recall': 0.41368586, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.52156866}
confusion matrix:
       0    1
0  18038  111
1    377  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.8685657, 'recall': 0.5132432, 'specificity': 0.5132432, 'f1': 0.51547354, 'auroc': 0.9439324, 'binary_precision': 0.7777778, 'binary_recall': 0.026819924, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.051851854}
confusion matrix:
      0  1
0  5995  2
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_5.png
better model found
persisted
after epoch: 5,now: 2024-06-02 11:27:39.624937,epoch time: 0:25:52.618740,used: 2:11:00.165630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9733285, 'precision': 0.7823652, 'recall': 0.9065306, 'specificity': 0.9065306, 'f1': 0.8319851, 'auroc': 0.9744561, 'binary_precision': 0.5705664, 'binary_recall': 0.8349185, 'binary_specificity': 0.97814274, 'binary_f1_score': 0.67788196}
confusion matrix:
       0     1
0  41395   925
1    243  1229
---- Validation: 
scalar performance:
{'acc': 0.97690505, 'precision': 0.81086016, 'recall': 0.887536, 'specificity': 0.887536, 'f1': 0.8445452, 'auroc': 0.9744487, 'binary_precision': 0.6291718, 'binary_recall': 0.79160184, 'binary_specificity': 0.98347014, 'binary_f1_score': 0.7011019}
confusion matrix:
       0    1
0  17849  300
1    134  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970278, 'precision': 0.85338175, 'recall': 0.72430086, 'specificity': 0.72430086, 'f1': 0.77296937, 'auroc': 0.9554886, 'binary_precision': 0.73006135, 'binary_recall': 0.4559387, 'binary_specificity': 0.992663, 'binary_f1_score': 0.5613207}
confusion matrix:
      0    1
0  5953   44
1   142  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_6.png
better model found
persisted
after epoch: 6,now: 2024-06-02 11:53:49.167095,epoch time: 0:26:09.542158,used: 2:37:09.707788,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9758175, 'precision': 0.79994565, 'recall': 0.88702226, 'specificity': 0.88702226, 'f1': 0.83737814, 'auroc': 0.9749459, 'binary_precision': 0.6071988, 'binary_recall': 0.79183674, 'binary_specificity': 0.98220783, 'binary_f1_score': 0.687334}
confusion matrix:
       0     1
0  41569   753
1    306  1164
---- Validation: 
scalar performance:
{'acc': 0.9783418, 'precision': 0.8254366, 'recall': 0.8725287, 'specificity': 0.8725287, 'f1': 0.8472347, 'auroc': 0.9759551, 'binary_precision': 0.6594595, 'binary_recall': 0.7589425, 'binary_specificity': 0.9861149, 'binary_f1_score': 0.7057122}
confusion matrix:
       0    1
0  17897  252
1    155  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.8841732, 'recall': 0.8217519, 'specificity': 0.8217519, 'f1': 0.8499167, 'auroc': 0.960579, 'binary_precision': 0.78341013, 'binary_recall': 0.651341, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.71129704}
confusion matrix:
      0    1
0  5950   47
1    91  170
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-02 12:19:55.888728,epoch time: 0:26:06.721633,used: 3:03:16.429421,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98031604, 'precision': 0.85356474, 'recall': 0.8363776, 'specificity': 0.8363776, 'f1': 0.844738, 'auroc': 0.9786242, 'binary_precision': 0.7181688, 'binary_recall': 0.6820652, 'binary_specificity': 0.99069, 'binary_f1_score': 0.69965154}
confusion matrix:
       0     1
0  41926   394
1    468  1004
---- Validation: 
scalar performance:
{'acc': 0.9788208, 'precision': 0.8613037, 'recall': 0.79252076, 'specificity': 0.79252076, 'f1': 0.8229848, 'auroc': 0.97590345, 'binary_precision': 0.7369439, 'binary_recall': 0.592535, 'binary_specificity': 0.99250644, 'binary_f1_score': 0.65689653}
confusion matrix:
       0    1
0  18013  136
1    262  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9701182, 'precision': 0.8462206, 'recall': 0.7315468, 'specificity': 0.7315468, 'f1': 0.7763265, 'auroc': 0.95731086, 'binary_precision': 0.71511626, 'binary_recall': 0.47126436, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.5681293}
confusion matrix:
      0    1
0  5948   49
1   138  123
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_8.png
better model found
persisted
after epoch: 8,now: 2024-06-02 12:45:54.722736,epoch time: 0:25:58.834008,used: 3:29:15.263429,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.979905, 'precision': 0.8355325, 'recall': 0.8745245, 'specificity': 0.8745245, 'f1': 0.85385525, 'auroc': 0.98065907, 'binary_precision': 0.67939395, 'binary_recall': 0.76154894, 'binary_specificity': 0.9875, 'binary_f1_score': 0.7181294}
confusion matrix:
       0     1
0  41791   529
1    351  1121
---- Validation: 
scalar performance:
{'acc': 0.97945935, 'precision': 0.84604895, 'recall': 0.8408549, 'specificity': 0.8408549, 'f1': 0.84343046, 'auroc': 0.97586864, 'binary_precision': 0.70300156, 'binary_recall': 0.69206846, 'binary_specificity': 0.9896413, 'binary_f1_score': 0.6974921}
confusion matrix:
       0    1
0  17961  188
1    198  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.85115063, 'recall': 0.63951135, 'specificity': 0.63951135, 'f1': 0.6956162, 'auroc': 0.96268326, 'binary_precision': 0.7326733, 'binary_recall': 0.2835249, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.4088398}
confusion matrix:
      0   1
0  5970  27
1   187  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_9.png
better model found
persisted
after epoch: 9,now: 2024-06-02 13:11:46.615670,epoch time: 0:25:51.892934,used: 3:55:07.156363,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98390114, 'precision': 0.87651515, 'recall': 0.8752806, 'specificity': 0.8752806, 'f1': 0.8758968, 'auroc': 0.98180515, 'binary_precision': 0.76141787, 'binary_recall': 0.7588315, 'binary_specificity': 0.9917297, 'binary_f1_score': 0.7601225}
confusion matrix:
       0     1
0  41970   350
1    355  1117
---- Validation: 
scalar performance:
{'acc': 0.9832908, 'precision': 0.89850986, 'recall': 0.8323377, 'specificity': 0.8323377, 'f1': 0.8621843, 'auroc': 0.97965527, 'binary_precision': 0.8086304, 'binary_recall': 0.6702955, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.7329931}
confusion matrix:
       0    1
0  18047  102
1    212  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8022227, 'recall': 0.60835975, 'specificity': 0.60835975, 'f1': 0.655072, 'auroc': 0.96099246, 'binary_precision': 0.63736266, 'binary_recall': 0.22222222, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.32954547}
confusion matrix:
      0   1
0  5964  33
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_10.png
better model found
persisted
after epoch: 10,now: 2024-06-02 13:37:48.835631,epoch time: 0:26:02.219961,used: 4:21:09.376324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97661674, 'precision': 0.8012732, 'recall': 0.9203627, 'specificity': 0.9203627, 'f1': 0.8499248, 'auroc': 0.98107564, 'binary_precision': 0.6074856, 'binary_recall': 0.8600544, 'binary_specificity': 0.98067105, 'binary_f1_score': 0.712036}
confusion matrix:
       0     1
0  41502   818
1    206  1266
---- Validation: 
scalar performance:
{'acc': 0.97993827, 'precision': 0.8279768, 'recall': 0.91610837, 'specificity': 0.91610837, 'f1': 0.86628735, 'auroc': 0.97785413, 'binary_precision': 0.66140777, 'binary_recall': 0.84758943, 'binary_specificity': 0.98462725, 'binary_f1_score': 0.74301296}
confusion matrix:
       0    1
0  17870  279
1     98  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.84440374, 'recall': 0.671328, 'specificity': 0.671328, 'f1': 0.72604334, 'auroc': 0.9559443, 'binary_precision': 0.71653545, 'binary_recall': 0.348659, 'binary_specificity': 0.993997, 'binary_f1_score': 0.46907216}
confusion matrix:
      0   1
0  5961  36
1   170  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_11.png
early stop counter: 1
val acc:0.979938268661499, best validation acc: 0.9832907915115356, corresponding to test acc:                         0.9622882604598999 / 0.9779482483863831
after epoch: 11,now: 2024-06-02 14:03:42.186889,epoch time: 0:25:53.351258,used: 4:47:02.727582,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9818003, 'precision': 0.8593379, 'recall': 0.86098814, 'specificity': 0.86098814, 'f1': 0.860161, 'auroc': 0.9824864, 'binary_precision': 0.72801083, 'binary_recall': 0.7314752, 'binary_specificity': 0.99050117, 'binary_f1_score': 0.7297389}
confusion matrix:
       0     1
0  41919   402
1    395  1076
---- Validation: 
scalar performance:
{'acc': 0.98126864, 'precision': 0.864887, 'recall': 0.8440417, 'specificity': 0.8440417, 'f1': 0.8541307, 'auroc': 0.9764684, 'binary_precision': 0.74049586, 'binary_recall': 0.6967341, 'binary_specificity': 0.9913494, 'binary_f1_score': 0.71794873}
confusion matrix:
       0    1
0  17992  157
1    195  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8085401, 'recall': 0.6010304, 'specificity': 0.6010304, 'f1': 0.64728236, 'auroc': 0.9589993, 'binary_precision': 0.6506024, 'binary_recall': 0.20689656, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.31395352}
confusion matrix:
      0   1
0  5968  29
1   207  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_12.png
early stop counter: 2
val acc:0.9812686443328857, best validation acc: 0.9832907915115356, corresponding to test acc:                         0.9622882604598999 / 0.9779482483863831
after epoch: 12,now: 2024-06-02 14:28:45.929460,epoch time: 0:25:03.742571,used: 5:12:06.470153,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9820744, 'precision': 0.90666187, 'recall': 0.7926985, 'specificity': 0.7926985, 'f1': 0.8396936, 'auroc': 0.98170185, 'binary_precision': 0.82745475, 'binary_recall': 0.58967394, 'binary_specificity': 0.99572307, 'binary_f1_score': 0.6886157}
confusion matrix:
       0    1
0  42139  181
1    604  868
---- Validation: 
scalar performance:
{'acc': 0.98063004, 'precision': 0.90846694, 'recall': 0.7694557, 'specificity': 0.7694557, 'f1': 0.82364196, 'auroc': 0.9781443, 'binary_precision': 0.8329356, 'binary_recall': 0.5427683, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.6572505}
confusion matrix:
       0    1
0  18079   70
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.9014181, 'recall': 0.53040123, 'specificity': 0.53040123, 'f1': 0.5470089, 'auroc': 0.9535291, 'binary_precision': 0.84210527, 'binary_recall': 0.06130268, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.114285715}
confusion matrix:
      0   1
0  5994   3
1   245  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_13.png
early stop counter: 3
val acc:0.9806300401687622, best validation acc: 0.9832907915115356, corresponding to test acc:                         0.9622882604598999 / 0.9779482483863831
after epoch: 13,now: 2024-06-02 14:53:42.515815,epoch time: 0:24:56.586355,used: 5:37:03.056508,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98422086, 'precision': 0.8706322, 'recall': 0.8951175, 'specificity': 0.8951175, 'f1': 0.88244843, 'auroc': 0.9848955, 'binary_precision': 0.74825174, 'binary_recall': 0.7995924, 'binary_specificity': 0.9906427, 'binary_f1_score': 0.7730706}
confusion matrix:
       0     1
0  41924   396
1    295  1177
---- Validation: 
scalar performance:
{'acc': 0.98318434, 'precision': 0.8716914, 'recall': 0.87503576, 'specificity': 0.87503576, 'f1': 0.87335545, 'auroc': 0.980867, 'binary_precision': 0.75192606, 'binary_recall': 0.7589425, 'binary_specificity': 0.991129, 'binary_f1_score': 0.755418}
confusion matrix:
       0    1
0  17988  161
1    155  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.78693664, 'recall': 0.5670479, 'specificity': 0.5670479, 'f1': 0.6023327, 'auroc': 0.948763, 'binary_precision': 0.6101695, 'binary_recall': 0.13793103, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.225}
confusion matrix:
      0   1
0  5974  23
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_14.png
early stop counter: 4
val acc:0.9831843376159668, best validation acc: 0.9832907915115356, corresponding to test acc:                         0.9622882604598999 / 0.9779482483863831
after epoch: 14,now: 2024-06-02 15:18:36.823347,epoch time: 0:24:54.307532,used: 6:01:57.364040,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9833988, 'precision': 0.86829334, 'recall': 0.88059425, 'specificity': 0.88059425, 'f1': 0.87433386, 'auroc': 0.9860734, 'binary_precision': 0.7445831, 'binary_recall': 0.77038044, 'binary_specificity': 0.9908081, 'binary_f1_score': 0.7572621}
confusion matrix:
       0     1
0  41931   389
1    338  1134
---- Validation: 
scalar performance:
{'acc': 0.9848872, 'precision': 0.90496325, 'recall': 0.85491574, 'specificity': 0.85491574, 'f1': 0.87815654, 'auroc': 0.97930443, 'binary_precision': 0.81996435, 'binary_recall': 0.7153966, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.7641196}
confusion matrix:
       0    1
0  18048  101
1    183  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.81441605, 'recall': 0.59928143, 'specificity': 0.59928143, 'f1': 0.6457743, 'auroc': 0.94785947, 'binary_precision': 0.6625, 'binary_recall': 0.20306513, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.3108504}
confusion matrix:
      0   1
0  5970  27
1   208  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_15.png
better model found
persisted
after epoch: 15,now: 2024-06-02 15:43:22.778640,epoch time: 0:24:45.955293,used: 6:26:43.319333,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9805672, 'precision': 0.9151414, 'recall': 0.7558542, 'specificity': 0.7558542, 'f1': 0.8152434, 'auroc': 0.98530453, 'binary_precision': 0.84692734, 'binary_recall': 0.5149456, 'binary_specificity': 0.99676275, 'binary_f1_score': 0.6404732}
confusion matrix:
       0    1
0  42183  137
1    714  758
---- Validation: 
scalar performance:
{'acc': 0.9769583, 'precision': 0.883056, 'recall': 0.7225514, 'specificity': 0.7225514, 'f1': 0.7799359, 'auroc': 0.9791293, 'binary_precision': 0.78532606, 'binary_recall': 0.44945568, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.5717112}
confusion matrix:
       0    1
0  18070   79
1    354  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.7762617, 'recall': 0.56130075, 'specificity': 0.56130075, 'f1': 0.59381324, 'auroc': 0.9559363, 'binary_precision': 0.58928573, 'binary_recall': 0.12643678, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.2082019}
confusion matrix:
      0   1
0  5974  23
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_16.png
early stop counter: 1
val acc:0.9769582748413086, best validation acc: 0.9848871827125549, corresponding to test acc:                         0.9624480605125427 / 0.9779482483863831
after epoch: 16,now: 2024-06-02 16:08:55.992700,epoch time: 0:25:33.214060,used: 6:52:16.533393,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98390114, 'precision': 0.9011078, 'recall': 0.8351717, 'specificity': 0.8351717, 'f1': 0.8649527, 'auroc': 0.98703825, 'binary_precision': 0.8134206, 'binary_recall': 0.6757308, 'binary_specificity': 0.9946126, 'binary_f1_score': 0.73821014}
confusion matrix:
       0    1
0  42093  228
1    477  994
---- Validation: 
scalar performance:
{'acc': 0.9837165, 'precision': 0.9153321, 'recall': 0.8198072, 'specificity': 0.8198072, 'f1': 0.8608818, 'auroc': 0.97831297, 'binary_precision': 0.8431772, 'binary_recall': 0.64385694, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.73015875}
confusion matrix:
       0    1
0  18072   77
1    229  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.75276256, 'recall': 0.52215475, 'specificity': 0.52215475, 'f1': 0.53181666, 'auroc': 0.9582553, 'binary_precision': 0.54545456, 'binary_recall': 0.04597701, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.08480566}
confusion matrix:
      0   1
0  5987  10
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_17.png
early stop counter: 2
val acc:0.9837164878845215, best validation acc: 0.9848871827125549, corresponding to test acc:                         0.9624480605125427 / 0.9779482483863831
after epoch: 17,now: 2024-06-02 16:34:26.687612,epoch time: 0:25:30.694912,used: 7:17:47.228305,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98298776, 'precision': 0.9410424, 'recall': 0.7777617, 'specificity': 0.7777617, 'f1': 0.8395741, 'auroc': 0.9841126, 'binary_precision': 0.89726776, 'binary_recall': 0.55774456, 'binary_specificity': 0.99777883, 'binary_f1_score': 0.68789274}
confusion matrix:
       0    1
0  42226   94
1    651  821
---- Validation: 
scalar performance:
{'acc': 0.97961897, 'precision': 0.93990964, 'recall': 0.7269291, 'specificity': 0.7269291, 'f1': 0.79714346, 'auroc': 0.97342235, 'binary_precision': 0.898773, 'binary_recall': 0.45567653, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.6047472}
confusion matrix:
       0    1
0  18116   33
1    350  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7708108, 'recall': 0.53339887, 'specificity': 0.53339887, 'f1': 0.5511726, 'auroc': 0.96066236, 'binary_precision': 0.58064514, 'binary_recall': 0.06896552, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.12328768}
confusion matrix:
      0   1
0  5984  13
1   243  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_18.png
early stop counter: 3
val acc:0.9796189665794373, best validation acc: 0.9848871827125549, corresponding to test acc:                         0.9624480605125427 / 0.9779482483863831
after epoch: 18,now: 2024-06-02 16:59:52.239309,epoch time: 0:25:25.551697,used: 7:43:12.780002,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98581934, 'precision': 0.91884816, 'recall': 0.8500443, 'specificity': 0.8500443, 'f1': 0.8811289, 'auroc': 0.9882443, 'binary_precision': 0.84791493, 'binary_recall': 0.7044837, 'binary_specificity': 0.99560493, 'binary_f1_score': 0.7695733}
confusion matrix:
       0     1
0  42134   186
1    435  1037
---- Validation: 
scalar performance:
{'acc': 0.98424864, 'precision': 0.9332528, 'recall': 0.811082, 'specificity': 0.811082, 'f1': 0.861398, 'auroc': 0.9811788, 'binary_precision': 0.8796499, 'binary_recall': 0.62519443, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.7309091}
confusion matrix:
       0    1
0  18094   55
1    241  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7853941, 'recall': 0.55771947, 'specificity': 0.55771947, 'f1': 0.58911645, 'auroc': 0.9519613, 'binary_precision': 0.60784316, 'binary_recall': 0.118773945, 'binary_specificity': 0.996665, 'binary_f1_score': 0.19871795}
confusion matrix:
      0   1
0  5977  20
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_19.png
early stop counter: 4
val acc:0.9842486381530762, best validation acc: 0.9848871827125549, corresponding to test acc:                         0.9624480605125427 / 0.9779482483863831
after epoch: 19,now: 2024-06-02 17:24:59.658745,epoch time: 0:25:07.419436,used: 8:08:20.199438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9870296, 'precision': 0.89653516, 'recall': 0.9064065, 'specificity': 0.9064065, 'f1': 0.901405, 'auroc': 0.9905423, 'binary_precision': 0.79933774, 'binary_recall': 0.8199728, 'binary_specificity': 0.9928403, 'binary_f1_score': 0.80952376}
confusion matrix:
       0     1
0  42017   303
1    265  1207
---- Validation: 
scalar performance:
{'acc': 0.98510003, 'precision': 0.89899313, 'recall': 0.86777693, 'specificity': 0.86777693, 'f1': 0.8826964, 'auroc': 0.98244095, 'binary_precision': 0.8071066, 'binary_recall': 0.7418352, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.77309567}
confusion matrix:
       0    1
0  18035  114
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8144188, 'recall': 0.6273501, 'specificity': 0.6273501, 'f1': 0.67743194, 'auroc': 0.9516468, 'binary_precision': 0.66019416, 'binary_recall': 0.2605364, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.37362635}
confusion matrix:
      0   1
0  5962  35
1   193  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_20.png
better model found
persisted
after epoch: 20,now: 2024-06-02 17:49:49.694899,epoch time: 0:24:50.036154,used: 8:33:10.235592,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9872351, 'precision': 0.9182983, 'recall': 0.87725174, 'specificity': 0.87725174, 'f1': 0.8966321, 'auroc': 0.9885998, 'binary_precision': 0.8449319, 'binary_recall': 0.7593474, 'binary_specificity': 0.99515605, 'binary_f1_score': 0.7998568}
confusion matrix:
       0     1
0  42116   205
1    354  1117
---- Validation: 
scalar performance:
{'acc': 0.9837697, 'precision': 0.90664405, 'recall': 0.8310855, 'specificity': 0.8310855, 'f1': 0.8646865, 'auroc': 0.9828622, 'binary_precision': 0.825, 'binary_recall': 0.66718507, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.7377472}
confusion matrix:
       0    1
0  18058   91
1    214  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.7785826, 'recall': 0.5836223, 'specificity': 0.5836223, 'f1': 0.62339073, 'auroc': 0.94807893, 'binary_precision': 0.59210527, 'binary_recall': 0.1724138, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.2670623}
confusion matrix:
      0   1
0  5966  31
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_21.png
early stop counter: 1
val acc:0.9837697148323059, best validation acc: 0.9851000308990479, corresponding to test acc:                         0.9635666608810425 / 0.9779482483863831
after epoch: 21,now: 2024-06-02 18:14:54.198032,epoch time: 0:25:04.503133,used: 8:58:14.738725,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98705244, 'precision': 0.916798, 'recall': 0.87592745, 'specificity': 0.87592745, 'f1': 0.8952253, 'auroc': 0.9900264, 'binary_precision': 0.8420257, 'binary_recall': 0.7567935, 'binary_specificity': 0.99506146, 'binary_f1_score': 0.79713774}
confusion matrix:
       0     1
0  42111   209
1    358  1114
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.8978137, 'recall': 0.8492521, 'specificity': 0.8492521, 'f1': 0.8718241, 'auroc': 0.9813172, 'binary_precision': 0.8060498, 'binary_recall': 0.7045101, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.75186723}
confusion matrix:
       0    1
0  18040  109
1    190  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7567282, 'recall': 0.5960317, 'specificity': 0.5960317, 'f1': 0.6357056, 'auroc': 0.9494174, 'binary_precision': 0.5473684, 'binary_recall': 0.19923371, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.29213482}
confusion matrix:
      0   1
0  5954  43
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_22.png
early stop counter: 2
val acc:0.9840889573097229, best validation acc: 0.9851000308990479, corresponding to test acc:                         0.9635666608810425 / 0.9779482483863831
after epoch: 22,now: 2024-06-02 18:40:01.421125,epoch time: 0:25:07.223093,used: 9:23:21.961818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9874863, 'precision': 0.9102316, 'recall': 0.89352846, 'specificity': 0.89352846, 'f1': 0.9016923, 'auroc': 0.9900434, 'binary_precision': 0.82765955, 'binary_recall': 0.79279894, 'binary_specificity': 0.99425805, 'binary_f1_score': 0.80985427}
confusion matrix:
       0     1
0  42077   243
1    305  1167
---- Validation: 
scalar performance:
{'acc': 0.98424864, 'precision': 0.90212333, 'recall': 0.8463346, 'specificity': 0.8463346, 'f1': 0.87197983, 'auroc': 0.98010504, 'binary_precision': 0.81488204, 'binary_recall': 0.6982893, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.7520938}
confusion matrix:
       0    1
0  18047  102
1    194  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.84731734, 'recall': 0.596117, 'specificity': 0.596117, 'f1': 0.64468175, 'auroc': 0.9456975, 'binary_precision': 0.7285714, 'binary_recall': 0.1954023, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.30815712}
confusion matrix:
      0   1
0  5978  19
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_23.png
early stop counter: 3
val acc:0.9842486381530762, best validation acc: 0.9851000308990479, corresponding to test acc:                         0.9635666608810425 / 0.9779482483863831
after epoch: 23,now: 2024-06-02 19:05:07.541687,epoch time: 0:25:06.120562,used: 9:48:28.082380,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9874178, 'precision': 0.9181162, 'recall': 0.8809552, 'specificity': 0.8809552, 'f1': 0.89860284, 'auroc': 0.98927236, 'binary_precision': 0.84431136, 'binary_recall': 0.7668253, 'binary_specificity': 0.9950852, 'binary_f1_score': 0.803705}
confusion matrix:
       0     1
0  42113   208
1    343  1128
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.9244847, 'recall': 0.83785737, 'specificity': 0.83785737, 'f1': 0.8758683, 'auroc': 0.97356963, 'binary_precision': 0.8602362, 'binary_recall': 0.67962676, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.7593397}
confusion matrix:
       0    1
0  18078   71
1    206  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.81163657, 'recall': 0.561801, 'specificity': 0.561801, 'f1': 0.59607244, 'auroc': 0.92194116, 'binary_precision': 0.66, 'binary_recall': 0.12643678, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.21221867}
confusion matrix:
      0   1
0  5980  17
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_24.png
better model found
persisted
after epoch: 24,now: 2024-06-02 19:30:30.105235,epoch time: 0:25:22.563548,used: 10:13:50.645928,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98666424, 'precision': 0.9262019, 'recall': 0.8570386, 'specificity': 0.8570386, 'f1': 0.8883317, 'auroc': 0.98959243, 'binary_precision': 0.86215335, 'binary_recall': 0.7180706, 'binary_specificity': 0.9960066, 'binary_f1_score': 0.7835433}
confusion matrix:
       0     1
0  42151   169
1    415  1057
---- Validation: 
scalar performance:
{'acc': 0.98323756, 'precision': 0.9343736, 'recall': 0.7925572, 'specificity': 0.7925572, 'f1': 0.8486277, 'auroc': 0.9838797, 'binary_precision': 0.8831776, 'binary_recall': 0.58786935, 'binary_specificity': 0.997245, 'binary_f1_score': 0.7058824}
confusion matrix:
       0    1
0  18099   50
1    265  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.79229236, 'recall': 0.6025292, 'specificity': 0.6025292, 'f1': 0.6472793, 'auroc': 0.9501082, 'binary_precision': 0.6179775, 'binary_recall': 0.21072797, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.31428573}
confusion matrix:
      0   1
0  5963  34
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_25.png
early stop counter: 1
val acc:0.9832375645637512, best validation acc: 0.9852597117424011, corresponding to test acc:                         0.9608501195907593 / 0.9779482483863831
after epoch: 25,now: 2024-06-02 19:55:40.948568,epoch time: 0:25:10.843333,used: 10:39:01.489261,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9884454, 'precision': 0.94098526, 'recall': 0.8723004, 'specificity': 0.8723004, 'f1': 0.9035233, 'auroc': 0.9909504, 'binary_precision': 0.89068824, 'binary_recall': 0.74779063, 'binary_specificity': 0.9968101, 'binary_f1_score': 0.8130082}
confusion matrix:
       0     1
0  42186   135
1    371  1100
---- Validation: 
scalar performance:
{'acc': 0.9850468, 'precision': 0.94124395, 'recall': 0.81749564, 'specificity': 0.81749564, 'f1': 0.8685376, 'auroc': 0.97565114, 'binary_precision': 0.8951965, 'binary_recall': 0.63763607, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.7447774}
confusion matrix:
       0    1
0  18101   48
1    233  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8639338, 'recall': 0.5850397, 'specificity': 0.5850397, 'f1': 0.63119566, 'auroc': 0.9508797, 'binary_precision': 0.7627119, 'binary_recall': 0.1724138, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.28125}
confusion matrix:
      0   1
0  5983  14
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_26.png
early stop counter: 2
val acc:0.9850468039512634, best validation acc: 0.9852597117424011, corresponding to test acc:                         0.9608501195907593 / 0.9779482483863831
after epoch: 26,now: 2024-06-02 20:21:03.677041,epoch time: 0:25:22.728473,used: 11:04:24.217734,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.987943, 'precision': 0.90274847, 'recall': 0.9143641, 'specificity': 0.9143641, 'f1': 0.90846676, 'auroc': 0.99217546, 'binary_precision': 0.8112211, 'binary_recall': 0.83548605, 'binary_specificity': 0.99324214, 'binary_f1_score': 0.82317483}
confusion matrix:
       0     1
0  42035   286
1    242  1229
---- Validation: 
scalar performance:
{'acc': 0.9838761, 'precision': 0.89700997, 'recall': 0.8461417, 'specificity': 0.8461417, 'f1': 0.86969113, 'auroc': 0.9752027, 'binary_precision': 0.8046595, 'binary_recall': 0.6982893, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.7477103}
confusion matrix:
       0    1
0  18040  109
1    194  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.84546036, 'recall': 0.6864036, 'specificity': 0.6864036, 'f1': 0.7398262, 'auroc': 0.95414865, 'binary_precision': 0.7173913, 'binary_recall': 0.37931034, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.49624062}
confusion matrix:
      0   1
0  5958  39
1   162  99
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_27.png
early stop counter: 3
val acc:0.98387610912323, best validation acc: 0.9852597117424011, corresponding to test acc:                         0.9608501195907593 / 0.9779482483863831
after epoch: 27,now: 2024-06-02 20:46:31.462814,epoch time: 0:25:27.785773,used: 11:29:52.003507,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.988354, 'precision': 0.90292156, 'recall': 0.9224509, 'specificity': 0.9224509, 'f1': 0.9124356, 'auroc': 0.993057, 'binary_precision': 0.8110032, 'binary_recall': 0.8518015, 'binary_specificity': 0.99310035, 'binary_f1_score': 0.83090186}
confusion matrix:
       0     1
0  42029   292
1    218  1253
---- Validation: 
scalar performance:
{'acc': 0.9856322, 'precision': 0.9023539, 'recall': 0.8733028, 'specificity': 0.8733028, 'f1': 0.88723886, 'auroc': 0.9797715, 'binary_precision': 0.8134454, 'binary_recall': 0.7527216, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.78190625}
confusion matrix:
       0    1
0  18038  111
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.81509936, 'recall': 0.65916675, 'specificity': 0.65916675, 'f1': 0.7088773, 'auroc': 0.9548365, 'binary_precision': 0.65891474, 'binary_recall': 0.3256705, 'binary_specificity': 0.992663, 'binary_f1_score': 0.43589744}
confusion matrix:
      0   1
0  5953  44
1   176  85
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_28.png
better model found
persisted
after epoch: 28,now: 2024-06-02 21:12:15.065753,epoch time: 0:25:43.602939,used: 11:55:35.606446,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9887194, 'precision': 0.91965735, 'recall': 0.90367436, 'specificity': 0.90367436, 'f1': 0.9114982, 'auroc': 0.9913393, 'binary_precision': 0.84582746, 'binary_recall': 0.8125, 'binary_specificity': 0.9948488, 'binary_f1_score': 0.8288289}
confusion matrix:
       0     1
0  42102   218
1    276  1196
---- Validation: 
scalar performance:
{'acc': 0.98664325, 'precision': 0.92728055, 'recall': 0.85957515, 'specificity': 0.85957515, 'f1': 0.89028656, 'auroc': 0.9793711, 'binary_precision': 0.8643123, 'binary_recall': 0.7231726, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.78746825}
confusion matrix:
       0    1
0  18076   73
1    178  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8053687, 'recall': 0.6401764, 'specificity': 0.6401764, 'f1': 0.68902075, 'auroc': 0.9558192, 'binary_precision': 0.64102566, 'binary_recall': 0.28735632, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.3968254}
confusion matrix:
      0   1
0  5955  42
1   186  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_29.png
better model found
persisted
after epoch: 29,now: 2024-06-02 21:38:58.264849,epoch time: 0:26:43.199096,used: 12:22:18.805542,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.989473, 'precision': 0.9672513, 'recall': 0.86439335, 'specificity': 0.86439335, 'f1': 0.9090071, 'auroc': 0.99508405, 'binary_precision': 0.94381034, 'binary_recall': 0.73029894, 'binary_specificity': 0.9984877, 'binary_f1_score': 0.82343936}
confusion matrix:
       0     1
0  42256    64
1    397  1075
---- Validation: 
scalar performance:
{'acc': 0.98515326, 'precision': 0.9502522, 'recall': 0.8115503, 'specificity': 0.8115503, 'f1': 0.8673693, 'auroc': 0.9796837, 'binary_precision': 0.9136364, 'binary_recall': 0.62519443, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.7423823}
confusion matrix:
       0    1
0  18111   38
1    241  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.7785177, 'recall': 0.5966153, 'specificity': 0.5966153, 'f1': 0.6389289, 'auroc': 0.9492863, 'binary_precision': 0.59090906, 'binary_recall': 0.19923371, 'binary_specificity': 0.993997, 'binary_f1_score': 0.29799426}
confusion matrix:
      0   1
0  5961  36
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_30.png
early stop counter: 1
val acc:0.9851532578468323, best validation acc: 0.9866432547569275, corresponding to test acc:                         0.9635666608810425 / 0.9779482483863831
after epoch: 30,now: 2024-06-02 22:05:47.569776,epoch time: 0:26:49.304927,used: 12:49:08.110469,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_09_16_39_seed_0_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:49:08.110469 at 2024-06-02 22:05:47.569776
persisted model performance metric: 

scalar performance:
{'acc': 0.9651646, 'precision': 0.82156986, 'recall': 0.65750116, 'specificity': 0.65750116, 'f1': 0.70863056, 'auroc': 0.9533319, 'binary_precision': 0.672, 'binary_recall': 0.3218391, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.43523318}
confusion matrix:
      0   1
0  5956  41
1   177  84
oracle model performance metric: 

scalar performance:
{'acc': 0.97714925, 'precision': 0.87879515, 'recall': 0.815838, 'specificity': 0.815838, 'f1': 0.8441658, 'auroc': 0.9595543, 'binary_precision': 0.7731481, 'binary_recall': 0.63984674, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.7002097}
confusion matrix:
      0    1
0  5948   49
1    94  167
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456549 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456549 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB |   1119 TiB |   1119 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1106 TiB |   1106 TiB |
|       from small pool |  40679 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14486 MiB |  14486 MiB |  14486 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446619 KiB |   1251 MiB |    802 TiB |    802 TiB |
|       from large pool | 435058 KiB |   1243 MiB |    789 TiB |    789 TiB |
|       from small pool |  11560 KiB |     17 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  197601 K  |  197597 K  |
|       from large pool |     187    |    1413    |  102521 K  |  102521 K  |
|       from small pool |    3301    |    6290    |   95079 K  |   95076 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  197601 K  |  197597 K  |
|       from large pool |     187    |    1413    |  102521 K  |  102521 K  |
|       from small pool |    3301    |    6290    |   95079 K  |   95076 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |     637    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    2802    |  125644 K  |  125644 K  |
|       from large pool |      37    |     600    |   76732 K  |   76732 K  |
|       from small pool |      43    |    2764    |   48912 K  |   48911 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1119 TiB |   1119 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1106 TiB |   1106 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14486 MiB |  14486 MiB |  13604 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     72 MiB |     72 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |    802 TiB |    802 TiB |
|       from large pool |  24320 KiB |   1243 MiB |    789 TiB |    789 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95079 K  |   95079 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95079 K  |   95079 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |     637    |     574    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      36    |      36    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2802    |  125646 K  |  125646 K  |
|       from large pool |       4    |     600    |   76732 K  |   76732 K  |
|       from small pool |       0    |    2764    |   48913 K  |   48913 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1119 TiB |   1119 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1106 TiB |   1106 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14486 MiB |  14486 MiB |  13604 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     72 MiB |     72 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |    802 TiB |    802 TiB |
|       from large pool |  24320 KiB |   1243 MiB |    789 TiB |    789 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95079 K  |   95079 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95079 K  |   95079 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |     637    |     574    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      36    |      36    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2802    |  125646 K  |  125646 K  |
|       from large pool |       4    |     600    |   76732 K  |   76732 K  |
|       from small pool |       0    |    2764    |   48913 K  |   48913 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736

 Experiment start at: 2024-06-02 22:13:43.116938
before training, model accuracy: 0.18198037147521973
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9940089, 'precision': 0.9967206, 'recall': 0.96763, 'specificity': 0.96763, 'f1': 0.98162854, 'auroc': 0.99750394, 'binary_precision': 1.0, 'binary_recall': 0.9352601, 'binary_specificity': 1.0, 'binary_f1_score': 0.96654725}
confusion matrix:
       0     1
0  42411     0
1    280  4045
---- Validation: 
scalar performance:
{'acc': 0.96739596, 'precision': 0.81364036, 'recall': 0.5947006, 'specificity': 0.5947006, 'f1': 0.6409088, 'auroc': 0.9140457, 'binary_precision': 0.65656567, 'binary_recall': 0.19316493, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.29850748}
confusion matrix:
       0    1
0  17999   68
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98989, 'precision': 0.9937275, 'recall': 0.9569672, 'specificity': 0.9569672, 'f1': 0.974399, 'auroc': 0.99893457, 'binary_precision': 0.9985994, 'binary_recall': 0.91410255, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.9544846}
confusion matrix:
      0    1
0  5945    1
1    67  713
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-02 22:35:34.042869,epoch time: 0:21:50.925931,used: 0:21:50.925931,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9962556, 'precision': 0.9951554, 'recall': 0.98247206, 'specificity': 0.98247206, 'f1': 0.98871076, 'auroc': 0.998971, 'binary_precision': 0.99381393, 'binary_recall': 0.9655571, 'binary_specificity': 0.99938697, 'binary_f1_score': 0.97948176}
confusion matrix:
       0     1
0  42384    26
1    149  4177
---- Validation: 
scalar performance:
{'acc': 0.96237993, 'precision': 0.7235112, 'recall': 0.67936176, 'specificity': 0.67936176, 'f1': 0.6987182, 'auroc': 0.89821297, 'binary_precision': 0.47014925, 'binary_recall': 0.3744428, 'binary_specificity': 0.9842807, 'binary_f1_score': 0.41687343}
confusion matrix:
       0    1
0  17783  284
1    421  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9934582, 'precision': 0.9911015, 'recall': 0.9768073, 'specificity': 0.9768073, 'f1': 0.98381245, 'auroc': 0.99868673, 'binary_precision': 0.98806363, 'binary_recall': 0.9551282, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.9713168}
confusion matrix:
      0    1
0  5937    9
1    35  745
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_2.png
new oracle model saved
early stop counter: 1
val acc:0.9623799324035645, best validation acc: 0.9673959612846375, corresponding to test acc:                         0.9898899793624878 / 0.9934582114219666
after epoch: 2,now: 2024-06-02 22:56:19.735479,epoch time: 0:20:45.692610,used: 0:42:36.618541,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99649096, 'precision': 0.9979655, 'recall': 0.9811486, 'specificity': 0.9811486, 'f1': 0.98937666, 'auroc': 0.99932754, 'binary_precision': 0.99975985, 'binary_recall': 0.96232086, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9806832}
confusion matrix:
       0     1
0  42409     1
1    163  4163
---- Validation: 
scalar performance:
{'acc': 0.9681964, 'precision': 0.83423966, 'recall': 0.5994073, 'specificity': 0.5994073, 'f1': 0.64854264, 'auroc': 0.92120767, 'binary_precision': 0.6974359, 'binary_recall': 0.20208023, 'binary_specificity': 0.9967344, 'binary_f1_score': 0.31336406}
confusion matrix:
       0    1
0  18008   59
1    537  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.995391, 'precision': 0.9968238, 'recall': 0.9806851, 'specificity': 0.9806851, 'f1': 0.9885757, 'auroc': 0.99965054, 'binary_precision': 0.99866843, 'binary_recall': 0.96153843, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.97975177}
confusion matrix:
      0    1
0  5945    1
1    30  750
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-02 23:17:29.010700,epoch time: 0:21:09.275221,used: 1:03:45.893762,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99477917, 'precision': 0.9915327, 'recall': 0.9771955, 'specificity': 0.9771955, 'f1': 0.98423135, 'auroc': 0.9983369, 'binary_precision': 0.9875776, 'binary_recall': 0.9556172, 'binary_specificity': 0.9987739, 'binary_f1_score': 0.9713345}
confusion matrix:
       0     1
0  42358    52
1    192  4134
---- Validation: 
scalar performance:
{'acc': 0.9670224, 'precision': 0.80000764, 'recall': 0.59736794, 'specificity': 0.59736794, 'f1': 0.6427975, 'auroc': 0.9334297, 'binary_precision': 0.62910795, 'binary_recall': 0.19910847, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.30248308}
confusion matrix:
       0    1
0  17988   79
1    539  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98899794, 'precision': 0.9938538, 'recall': 0.9525641, 'specificity': 0.9525641, 'f1': 0.9720088, 'auroc': 0.99802244, 'binary_precision': 1.0, 'binary_recall': 0.9051282, 'binary_specificity': 1.0, 'binary_f1_score': 0.95020187}
confusion matrix:
      0    1
0  5946    0
1    74  706
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_4.png
early stop counter: 1
val acc:0.9670224189758301, best validation acc: 0.9681963920593262, corresponding to test acc:                         0.9953910112380981 / 0.9953910112380981
after epoch: 4,now: 2024-06-02 23:38:48.251740,epoch time: 0:21:19.241040,used: 1:25:05.134802,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99565643, 'precision': 0.9975085, 'recall': 0.976641, 'specificity': 0.976641, 'f1': 0.9867958, 'auroc': 0.99945873, 'binary_precision': 0.9997576, 'binary_recall': 0.9533056, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.97597915}
confusion matrix:
       0     1
0  42409     1
1    202  4124
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.48204184, 'recall': 0.49994466, 'specificity': 0.49994466, 'f1': 0.49083003, 'auroc': 0.93821985, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18065  2
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9937556, 'precision': 0.996493, 'recall': 0.97307694, 'specificity': 0.97307694, 'f1': 0.98440635, 'auroc': 0.9994808, 'binary_precision': 1.0, 'binary_recall': 0.9461538, 'binary_specificity': 1.0, 'binary_f1_score': 0.972332}
confusion matrix:
      0    1
0  5946    0
1    42  738
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_5.png
early stop counter: 2
val acc:0.9639807939529419, best validation acc: 0.9681963920593262, corresponding to test acc:                         0.9953910112380981 / 0.9953910112380981
after epoch: 5,now: 2024-06-03 00:00:38.862020,epoch time: 0:21:50.610280,used: 1:46:55.745082,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9981599, 'precision': 0.99772173, 'recall': 0.9913056, 'specificity': 0.9913056, 'f1': 0.99448764, 'auroc': 0.99939054, 'binary_precision': 0.99718577, 'binary_recall': 0.9828941, 'binary_specificity': 0.99971706, 'binary_f1_score': 0.9899884}
confusion matrix:
       0     1
0  42398    12
1     74  4252
---- Validation: 
scalar performance:
{'acc': 0.9686766, 'precision': 0.78746647, 'recall': 0.69121057, 'specificity': 0.69121057, 'f1': 0.72870034, 'auroc': 0.9477432, 'binary_precision': 0.5972851, 'binary_recall': 0.3922734, 'binary_specificity': 0.99014777, 'binary_f1_score': 0.4735426}
confusion matrix:
       0    1
0  17889  178
1    409  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9955397, 'precision': 0.9974899, 'recall': 0.9807692, 'specificity': 0.9807692, 'f1': 0.9889379, 'auroc': 0.9983949, 'binary_precision': 1.0, 'binary_recall': 0.96153843, 'binary_specificity': 1.0, 'binary_f1_score': 0.98039216}
confusion matrix:
      0    1
0  5946    0
1    30  750
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-03 00:23:02.218970,epoch time: 0:22:23.356950,used: 2:09:19.102032,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.997518, 'precision': 0.9986361, 'recall': 0.98658955, 'specificity': 0.98658955, 'f1': 0.9925208, 'auroc': 0.99916816, 'binary_precision': 1.0, 'binary_recall': 0.97317916, 'binary_specificity': 1.0, 'binary_f1_score': 0.98640734}
confusion matrix:
       0     1
0  42411     0
1    116  4209
---- Validation: 
scalar performance:
{'acc': 0.9653682, 'precision': 0.89947784, 'recall': 0.5221222, 'specificity': 0.5221222, 'f1': 0.5334882, 'auroc': 0.9438492, 'binary_precision': 0.8333333, 'binary_recall': 0.044576522, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.084626235}
confusion matrix:
       0   1
0  18061   6
1    643  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99449897, 'precision': 0.99690795, 'recall': 0.97628206, 'specificity': 0.97628206, 'f1': 0.9863021, 'auroc': 0.99913424, 'binary_precision': 1.0, 'binary_recall': 0.9525641, 'binary_specificity': 1.0, 'binary_f1_score': 0.97570586}
confusion matrix:
      0    1
0  5946    0
1    37  743
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_7.png
early stop counter: 1
val acc:0.9653682112693787, best validation acc: 0.9686766266822815, corresponding to test acc:                         0.9955397248268127 / 0.9955397248268127
after epoch: 7,now: 2024-06-03 00:43:01.416290,epoch time: 0:19:59.197320,used: 2:29:18.299352,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99649096, 'precision': 0.9926894, 'recall': 0.98633814, 'specificity': 0.98633814, 'f1': 0.989488, 'auroc': 0.9990542, 'binary_precision': 0.9880394, 'binary_recall': 0.97387886, 'binary_specificity': 0.9987975, 'binary_f1_score': 0.98090804}
confusion matrix:
       0     1
0  42359    51
1    113  4213
---- Validation: 
scalar performance:
{'acc': 0.9689434, 'precision': 0.81264687, 'recall': 0.6427108, 'specificity': 0.6427108, 'f1': 0.6932607, 'auroc': 0.9244792, 'binary_precision': 0.6511628, 'binary_recall': 0.29123327, 'binary_specificity': 0.9941883, 'binary_f1_score': 0.40246406}
confusion matrix:
       0    1
0  17962  105
1    477  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99241745, 'precision': 0.99574786, 'recall': 0.9673077, 'specificity': 0.9673077, 'f1': 0.9809662, 'auroc': 0.99814475, 'binary_precision': 1.0, 'binary_recall': 0.9346154, 'binary_specificity': 1.0, 'binary_f1_score': 0.9662028}
confusion matrix:
      0    1
0  5946    0
1    51  729
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_8.png
better model found
persisted
after epoch: 8,now: 2024-06-03 01:02:37.303475,epoch time: 0:19:35.887185,used: 2:48:54.186537,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9982027, 'precision': 0.9976408, 'recall': 0.99163866, 'specificity': 0.99163866, 'f1': 0.994617, 'auroc': 0.99962294, 'binary_precision': 0.99695337, 'binary_recall': 0.9835838, 'binary_specificity': 0.99969345, 'binary_f1_score': 0.99022347}
confusion matrix:
       0     1
0  42398    13
1     71  4254
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.82632375, 'recall': 0.5679036, 'specificity': 0.5679036, 'f1': 0.6064623, 'auroc': 0.951646, 'binary_precision': 0.6838235, 'binary_recall': 0.13818721, 'binary_specificity': 0.99762, 'binary_f1_score': 0.22991346}
confusion matrix:
       0   1
0  18024  43
1    580  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99509364, 'precision': 0.9972403, 'recall': 0.9788462, 'specificity': 0.9788462, 'f1': 0.98781085, 'auroc': 0.99904335, 'binary_precision': 1.0, 'binary_recall': 0.9576923, 'binary_specificity': 1.0, 'binary_f1_score': 0.97838897}
confusion matrix:
      0    1
0  5946    0
1    33  747
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_9.png
early stop counter: 1
val acc:0.9667556285858154, best validation acc: 0.9689434170722961, corresponding to test acc:                         0.9924174547195435 / 0.9955397248268127
after epoch: 9,now: 2024-06-03 01:22:17.434706,epoch time: 0:19:40.131231,used: 3:08:34.317768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9946508, 'precision': 0.99706984, 'recall': 0.971105, 'specificity': 0.971105, 'f1': 0.98365325, 'auroc': 0.99872553, 'binary_precision': 1.0, 'binary_recall': 0.9422099, 'binary_specificity': 1.0, 'binary_f1_score': 0.9702452}
confusion matrix:
       0     1
0  42410     0
1    250  4076
---- Validation: 
scalar performance:
{'acc': 0.9678762, 'precision': 0.86242986, 'recall': 0.577068, 'specificity': 0.577068, 'f1': 0.6211015, 'auroc': 0.9308177, 'binary_precision': 0.7553957, 'binary_recall': 0.15601783, 'binary_specificity': 0.9981181, 'binary_f1_score': 0.25862068}
confusion matrix:
       0    1
0  18033   34
1    568  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98736244, 'precision': 0.99295306, 'recall': 0.94551283, 'specificity': 0.94551283, 'f1': 0.967638, 'auroc': 0.997679, 'binary_precision': 1.0, 'binary_recall': 0.89102566, 'binary_specificity': 1.0, 'binary_f1_score': 0.9423729}
confusion matrix:
      0    1
0  5946    0
1    85  695
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_10.png
early stop counter: 2
val acc:0.9678761959075928, best validation acc: 0.9689434170722961, corresponding to test acc:                         0.9924174547195435 / 0.9955397248268127
after epoch: 10,now: 2024-06-03 01:41:50.550636,epoch time: 0:19:33.115930,used: 3:28:07.433698,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9979245, 'precision': 0.997169, 'recall': 0.99044937, 'specificity': 0.99044937, 'f1': 0.9937806, 'auroc': 0.999645, 'binary_precision': 0.996245, 'binary_recall': 0.98127604, 'binary_specificity': 0.9996227, 'binary_f1_score': 0.9887039}
confusion matrix:
       0     1
0  42394    16
1     81  4245
---- Validation: 
scalar performance:
{'acc': 0.96974385, 'precision': 0.8097817, 'recall': 0.6731671, 'specificity': 0.6731671, 'f1': 0.72040737, 'auroc': 0.93627274, 'binary_precision': 0.64324325, 'binary_recall': 0.3536404, 'binary_specificity': 0.99269384, 'binary_f1_score': 0.45637584}
confusion matrix:
       0    1
0  17935  132
1    435  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99583703, 'precision': 0.9976565, 'recall': 0.98205125, 'specificity': 0.98205125, 'f1': 0.98968714, 'auroc': 0.99967104, 'binary_precision': 1.0, 'binary_recall': 0.96410257, 'binary_specificity': 1.0, 'binary_f1_score': 0.98172325}
confusion matrix:
      0    1
0  5946    0
1    28  752
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_11.png
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-06-03 02:02:18.680031,epoch time: 0:20:28.129395,used: 3:48:35.563093,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99501455, 'precision': 0.9798044, 'recall': 0.99102557, 'specificity': 0.99102557, 'f1': 0.98533314, 'auroc': 0.99921435, 'binary_precision': 0.96102726, 'binary_recall': 0.98613036, 'binary_specificity': 0.9959208, 'binary_f1_score': 0.973417}
confusion matrix:
       0     1
0  42237   173
1     60  4266
---- Validation: 
scalar performance:
{'acc': 0.9710246, 'precision': 0.8321061, 'recall': 0.67383134, 'specificity': 0.67383134, 'f1': 0.72611606, 'auroc': 0.9477928, 'binary_precision': 0.68786126, 'binary_recall': 0.3536404, 'binary_specificity': 0.99402225, 'binary_f1_score': 0.46712464}
confusion matrix:
       0    1
0  17959  108
1    435  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9956884, 'precision': 0.9969921, 'recall': 0.9819672, 'specificity': 0.9819672, 'f1': 0.9893249, 'auroc': 0.9988089, 'binary_precision': 0.998672, 'binary_recall': 0.96410257, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.9810829}
confusion matrix:
      0    1
0  5945    1
1    28  752
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_12.png
better model found
persisted
after epoch: 12,now: 2024-06-03 02:23:06.649467,epoch time: 0:20:47.969436,used: 4:09:23.532529,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99711144, 'precision': 0.989468, 'recall': 0.99342644, 'specificity': 0.99342644, 'f1': 0.9914372, 'auroc': 0.99961084, 'binary_precision': 0.98006874, 'binary_recall': 0.9889043, 'binary_specificity': 0.9979486, 'binary_f1_score': 0.9844667}
confusion matrix:
       0     1
0  42323    87
1     48  4278
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.7419133, 'recall': 0.7546905, 'specificity': 0.7546905, 'f1': 0.748117, 'auroc': 0.94274783, 'binary_precision': 0.50140846, 'binary_recall': 0.5289747, 'binary_specificity': 0.9804063, 'binary_f1_score': 0.51482284}
confusion matrix:
       0    1
0  17713  354
1    317  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99836457, 'precision': 0.9985119, 'recall': 0.9935056, 'specificity': 0.9935056, 'f1': 0.99599177, 'auroc': 0.9997771, 'binary_precision': 0.998703, 'binary_recall': 0.98717946, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.99290776}
confusion matrix:
      0    1
0  5945    1
1    10  770
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_13.png
new oracle model saved
early stop counter: 1
val acc:0.9641942381858826, best validation acc: 0.9710245728492737, corresponding to test acc:                         0.9956883788108826 / 0.9983645677566528
after epoch: 13,now: 2024-06-03 02:43:54.090909,epoch time: 0:20:47.441442,used: 4:30:10.973971,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99687606, 'precision': 0.9980689, 'recall': 0.9833329, 'specificity': 0.9833329, 'f1': 0.9905627, 'auroc': 0.9994304, 'binary_precision': 0.999522, 'binary_recall': 0.9667129, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9828437}
confusion matrix:
       0     1
0  42408     2
1    144  4182
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.8529084, 'recall': 0.5373919, 'specificity': 0.5373919, 'f1': 0.56002283, 'auroc': 0.94497705, 'binary_precision': 0.73913044, 'binary_recall': 0.075780086, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.1374663}
confusion matrix:
       0   1
0  18049  18
1    622  51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9942016, 'precision': 0.9967419, 'recall': 0.975, 'specificity': 0.975, 'f1': 0.98554504, 'auroc': 0.9987165, 'binary_precision': 1.0, 'binary_recall': 0.95, 'binary_specificity': 1.0, 'binary_f1_score': 0.9743589}
confusion matrix:
      0    1
0  5946    0
1    39  741
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_14.png
early stop counter: 2
val acc:0.965848445892334, best validation acc: 0.9710245728492737, corresponding to test acc:                         0.9956883788108826 / 0.9983645677566528
after epoch: 14,now: 2024-06-03 03:04:58.584117,epoch time: 0:21:04.493208,used: 4:51:15.467179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99764633, 'precision': 0.99859965, 'recall': 0.9873899, 'specificity': 0.9873899, 'f1': 0.9929151, 'auroc': 0.9997184, 'binary_precision': 0.9997629, 'binary_recall': 0.9748035, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9871254}
confusion matrix:
       0     1
0  42409     1
1    109  4217
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.88048315, 'recall': 0.5397314, 'specificity': 0.5397314, 'f1': 0.56425965, 'auroc': 0.94411045, 'binary_precision': 0.7941176, 'binary_recall': 0.08023774, 'binary_specificity': 0.9992251, 'binary_f1_score': 0.14574897}
confusion matrix:
       0   1
0  18053  14
1    619  54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.994945, 'precision': 0.9971572, 'recall': 0.9782051, 'specificity': 0.9782051, 'f1': 0.98743427, 'auroc': 0.99992996, 'binary_precision': 1.0, 'binary_recall': 0.9564102, 'binary_specificity': 1.0, 'binary_f1_score': 0.97771955}
confusion matrix:
      0    1
0  5946    0
1    34  746
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_15.png
early stop counter: 3
val acc:0.9662219882011414, best validation acc: 0.9710245728492737, corresponding to test acc:                         0.9956883788108826 / 0.9983645677566528
after epoch: 15,now: 2024-06-03 03:26:14.254319,epoch time: 0:21:15.670202,used: 5:12:31.137381,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9978603, 'precision': 0.9959861, 'recall': 0.9912443, 'specificity': 0.9912443, 'f1': 0.9936009, 'auroc': 0.99934936, 'binary_precision': 0.99369156, 'binary_recall': 0.98312527, 'binary_specificity': 0.99936336, 'binary_f1_score': 0.98838013}
confusion matrix:
       0     1
0  42383    27
1     73  4253
---- Validation: 
scalar performance:
{'acc': 0.9552828, 'precision': 0.64317703, 'recall': 0.59628636, 'specificity': 0.59628636, 'f1': 0.6143692, 'auroc': 0.89303035, 'binary_precision': 0.31543624, 'binary_recall': 0.20950966, 'binary_specificity': 0.98306304, 'binary_f1_score': 0.25178573}
confusion matrix:
       0    1
0  17761  306
1    532  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99583703, 'precision': 0.9976565, 'recall': 0.98205125, 'specificity': 0.98205125, 'f1': 0.98968714, 'auroc': 0.9996041, 'binary_precision': 1.0, 'binary_recall': 0.96410257, 'binary_specificity': 1.0, 'binary_f1_score': 0.98172325}
confusion matrix:
      0    1
0  5946    0
1    28  752
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_16.png
early stop counter: 4
val acc:0.9552828073501587, best validation acc: 0.9710245728492737, corresponding to test acc:                         0.9956883788108826 / 0.9983645677566528
after epoch: 16,now: 2024-06-03 03:47:20.825212,epoch time: 0:21:06.570893,used: 5:33:37.708274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99717563, 'precision': 0.9983411, 'recall': 0.9848472, 'specificity': 0.9848472, 'f1': 0.9914784, 'auroc': 0.99943745, 'binary_precision': 0.9997617, 'binary_recall': 0.969718, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.98451066}
confusion matrix:
       0     1
0  42409     1
1    131  4195
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.8955727, 'recall': 0.5140052, 'specificity': 0.5140052, 'f1': 0.5183548, 'auroc': 0.9376471, 'binary_precision': 0.82608694, 'binary_recall': 0.028231798, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.054597702}
confusion matrix:
       0   1
0  18063   4
1    654  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9934582, 'precision': 0.9963272, 'recall': 0.97179484, 'specificity': 0.97179484, 'f1': 0.98364496, 'auroc': 0.9993402, 'binary_precision': 1.0, 'binary_recall': 0.94358975, 'binary_specificity': 1.0, 'binary_f1_score': 0.9709763}
confusion matrix:
      0    1
0  5946    0
1    44  736
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_17.png
early stop counter: 5
val acc:0.9648879170417786, best validation acc: 0.9710245728492737, corresponding to test acc:                         0.9956883788108826 / 0.9983645677566528
after epoch: 17,now: 2024-06-03 04:08:27.767356,epoch time: 0:21:06.942144,used: 5:54:44.650418,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9986948, 'precision': 0.9978157, 'recall': 0.99440265, 'specificity': 0.99440265, 'f1': 0.9961018, 'auroc': 0.9997997, 'binary_precision': 0.99673885, 'binary_recall': 0.98913544, 'binary_specificity': 0.9996699, 'binary_f1_score': 0.99292254}
confusion matrix:
       0     1
0  42396    14
1     47  4279
---- Validation: 
scalar performance:
{'acc': 0.97182494, 'precision': 0.80883896, 'recall': 0.74648845, 'specificity': 0.74648845, 'f1': 0.7738166, 'auroc': 0.95097244, 'binary_precision': 0.6360225, 'binary_recall': 0.5037147, 'binary_specificity': 0.98926216, 'binary_f1_score': 0.56218904}
confusion matrix:
       0    1
0  17873  194
1    334  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99717516, 'precision': 0.9972669, 'recall': 0.9889344, 'specificity': 0.9889344, 'f1': 0.9930533, 'auroc': 0.9995307, 'binary_precision': 0.9973856, 'binary_recall': 0.97820514, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.9877023}
confusion matrix:
      0    1
0  5944    2
1    17  763
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_18.png
better model found
persisted
after epoch: 18,now: 2024-06-03 04:29:43.072360,epoch time: 0:21:15.305004,used: 6:15:59.955422,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9980315, 'precision': 0.9989177, 'recall': 0.98936665, 'specificity': 0.98936665, 'f1': 0.9940844, 'auroc': 0.99963737, 'binary_precision': 1.0, 'binary_recall': 0.97873324, 'binary_specificity': 1.0, 'binary_f1_score': 0.9892523}
confusion matrix:
       0     1
0  42410     0
1     92  4234
---- Validation: 
scalar performance:
{'acc': 0.963127, 'precision': 0.5070513, 'recall': 0.5002171, 'specificity': 0.5002171, 'f1': 0.4920511, 'auroc': 0.9443362, 'binary_precision': 0.05, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.0028860029}
confusion matrix:
       0   1
0  18048  19
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99524236, 'precision': 0.9973235, 'recall': 0.9794872, 'specificity': 0.9794872, 'f1': 0.98818696, 'auroc': 0.9999312, 'binary_precision': 1.0, 'binary_recall': 0.95897436, 'binary_specificity': 1.0, 'binary_f1_score': 0.9790576}
confusion matrix:
      0    1
0  5946    0
1    32  748
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_19.png
early stop counter: 1
val acc:0.9631270170211792, best validation acc: 0.9718249440193176, corresponding to test acc:                         0.9971751570701599 / 0.9983645677566528
after epoch: 19,now: 2024-06-03 04:50:43.863289,epoch time: 0:21:00.790929,used: 6:37:00.746351,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9980101, 'precision': 0.99869335, 'recall': 0.9894562, 'specificity': 0.9894562, 'f1': 0.9940208, 'auroc': 0.9998367, 'binary_precision': 0.9995279, 'binary_recall': 0.97895956, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9891368}
confusion matrix:
       0     1
0  42409     2
1     91  4234
---- Validation: 
scalar performance:
{'acc': 0.96152616, 'precision': 0.51781124, 'recall': 0.5015327, 'specificity': 0.5015327, 'f1': 0.4956777, 'auroc': 0.9349187, 'binary_precision': 0.071428575, 'binary_recall': 0.0059435363, 'binary_specificity': 0.9971218, 'binary_f1_score': 0.010973937}
confusion matrix:
       0   1
0  18015  52
1    669   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99524236, 'precision': 0.9973235, 'recall': 0.9794872, 'specificity': 0.9794872, 'f1': 0.98818696, 'auroc': 0.9995423, 'binary_precision': 1.0, 'binary_recall': 0.95897436, 'binary_specificity': 1.0, 'binary_f1_score': 0.9790576}
confusion matrix:
      0    1
0  5946    0
1    32  748
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_20.png
early stop counter: 2
val acc:0.9615261554718018, best validation acc: 0.9718249440193176, corresponding to test acc:                         0.9971751570701599 / 0.9983645677566528
after epoch: 20,now: 2024-06-03 05:11:52.313318,epoch time: 0:21:08.450029,used: 6:58:09.196380,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9979245, 'precision': 0.99885905, 'recall': 0.98878354, 'specificity': 0.98878354, 'f1': 0.993757, 'auroc': 0.9995507, 'binary_precision': 1.0, 'binary_recall': 0.9775671, 'binary_specificity': 1.0, 'binary_f1_score': 0.9886563}
confusion matrix:
       0     1
0  42412     0
1     97  4227
---- Validation: 
scalar performance:
{'acc': 0.9660619, 'precision': 0.7964816, 'recall': 0.5675438, 'specificity': 0.5675438, 'f1': 0.6044639, 'auroc': 0.9458829, 'binary_precision': 0.62416106, 'binary_recall': 0.13818721, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.22627737}
confusion matrix:
       0   1
0  18011  56
1    580  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99643177, 'precision': 0.99798995, 'recall': 0.9846154, 'specificity': 0.9846154, 'f1': 0.9911804, 'auroc': 0.99936175, 'binary_precision': 1.0, 'binary_recall': 0.9692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.984375}
confusion matrix:
      0    1
0  5946    0
1    24  756
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_21.png
early stop counter: 3
val acc:0.9660618901252747, best validation acc: 0.9718249440193176, corresponding to test acc:                         0.9971751570701599 / 0.9983645677566528
after epoch: 21,now: 2024-06-03 05:32:49.795753,epoch time: 0:20:57.482435,used: 7:19:06.678815,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9974538, 'precision': 0.9957473, 'recall': 0.98904335, 'specificity': 0.98904335, 'f1': 0.9923668, 'auroc': 0.99901485, 'binary_precision': 0.9936605, 'binary_recall': 0.9787234, 'binary_specificity': 0.99936336, 'binary_f1_score': 0.98613536}
confusion matrix:
       0     1
0  42385    27
1     92  4232
---- Validation: 
scalar performance:
{'acc': 0.9632337, 'precision': 0.6771689, 'recall': 0.51958466, 'specificity': 0.51958466, 'f1': 0.52820593, 'auroc': 0.8987805, 'binary_precision': 0.3888889, 'binary_recall': 0.041604754, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.07516778}
confusion matrix:
       0   1
0  18023  44
1    645  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99479634, 'precision': 0.99707407, 'recall': 0.9775641, 'specificity': 0.9775641, 'f1': 0.9870573, 'auroc': 0.99907535, 'binary_precision': 1.0, 'binary_recall': 0.9551282, 'binary_specificity': 1.0, 'binary_f1_score': 0.9770492}
confusion matrix:
      0    1
0  5946    0
1    35  745
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_22.png
early stop counter: 4
val acc:0.9632337093353271, best validation acc: 0.9718249440193176, corresponding to test acc:                         0.9971751570701599 / 0.9983645677566528
after epoch: 22,now: 2024-06-03 05:53:26.449479,epoch time: 0:20:36.653726,used: 7:39:43.332541,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99848086, 'precision': 0.99863684, 'recall': 0.9923128, 'specificity': 0.9923128, 'f1': 0.99544954, 'auroc': 0.9997262, 'binary_precision': 0.9988277, 'binary_recall': 0.9847434, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.9917356}
confusion matrix:
       0     1
0  42405     5
1     66  4260
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.82354236, 'recall': 0.5737088, 'specificity': 0.5737088, 'f1': 0.6144145, 'auroc': 0.9485396, 'binary_precision': 0.67785233, 'binary_recall': 0.15007429, 'binary_specificity': 0.99734324, 'binary_f1_score': 0.24574208}
confusion matrix:
       0    1
0  18019   48
1    572  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99717516, 'precision': 0.9978354, 'recall': 0.98837745, 'specificity': 0.98837745, 'f1': 0.99304545, 'auroc': 0.9995252, 'binary_precision': 0.9986894, 'binary_recall': 0.97692305, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.98768634}
confusion matrix:
      0    1
0  5945    1
1    18  762
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_23.png
early stop counter: 5
val acc:0.9669156670570374, best validation acc: 0.9718249440193176, corresponding to test acc:                         0.9971751570701599 / 0.9983645677566528
after epoch: 23,now: 2024-06-03 06:14:19.989374,epoch time: 0:20:53.539895,used: 8:00:36.872436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99711144, 'precision': 0.99841344, 'recall': 0.9843967, 'specificity': 0.9843967, 'f1': 0.99128014, 'auroc': 0.9998349, 'binary_precision': 1.0, 'binary_recall': 0.96879333, 'binary_specificity': 1.0, 'binary_f1_score': 0.98414934}
confusion matrix:
       0     1
0  42410     0
1    135  4191
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.9331995, 'recall': 0.533294, 'specificity': 0.533294, 'f1': 0.55363005, 'auroc': 0.95248973, 'binary_precision': 0.9, 'binary_recall': 0.06686478, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.12448132}
confusion matrix:
       0   1
0  18062   5
1    628  45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9942016, 'precision': 0.9967419, 'recall': 0.975, 'specificity': 0.975, 'f1': 0.98554504, 'auroc': 0.9993684, 'binary_precision': 1.0, 'binary_recall': 0.95, 'binary_specificity': 1.0, 'binary_f1_score': 0.9743589}
confusion matrix:
      0    1
0  5946    0
1    39  741
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_24.png
early stop counter: 6
val acc:0.9662219882011414, best validation acc: 0.9718249440193176, corresponding to test acc:                         0.9971751570701599 / 0.9983645677566528
after epoch: 24,now: 2024-06-03 06:35:14.032688,epoch time: 0:20:54.043314,used: 8:21:30.915750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9992725, 'precision': 0.99824715, 'recall': 0.99741954, 'specificity': 0.99741954, 'f1': 0.9978329, 'auroc': 0.9999572, 'binary_precision': 0.99698937, 'binary_recall': 0.9951456, 'binary_specificity': 0.99969345, 'binary_f1_score': 0.9960666}
confusion matrix:
       0     1
0  42397    13
1     21  4305
---- Validation: 
scalar performance:
{'acc': 0.9740128, 'precision': 0.8453938, 'recall': 0.72974145, 'specificity': 0.72974145, 'f1': 0.7749183, 'auroc': 0.95914054, 'binary_precision': 0.71040726, 'binary_recall': 0.4665676, 'binary_specificity': 0.9929153, 'binary_f1_score': 0.5632287}
confusion matrix:
       0    1
0  17939  128
1    359  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9968778, 'precision': 0.99824035, 'recall': 0.98653847, 'specificity': 0.98653847, 'f1': 0.992296, 'auroc': 0.9998441, 'binary_precision': 1.0, 'binary_recall': 0.97307694, 'binary_specificity': 1.0, 'binary_f1_score': 0.98635477}
confusion matrix:
      0    1
0  5946    0
1    21  759
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_25.png
better model found
persisted
after epoch: 25,now: 2024-06-03 06:55:59.929610,epoch time: 0:20:45.896922,used: 8:42:16.812672,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9986306, 'precision': 0.99809194, 'recall': 0.99374455, 'specificity': 0.99374455, 'f1': 0.99590623, 'auroc': 0.99969137, 'binary_precision': 0.9974323, 'binary_recall': 0.9877485, 'binary_specificity': 0.9997406, 'binary_f1_score': 0.99256676}
confusion matrix:
       0     1
0  42399    11
1     53  4273
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.771793, 'recall': 0.50795096, 'specificity': 0.50795096, 'f1': 0.50678974, 'auroc': 0.94198567, 'binary_precision': 0.57894737, 'binary_recall': 0.016344724, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.031791903}
confusion matrix:
       0   1
0  18059   8
1    662  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9965804, 'precision': 0.99807334, 'recall': 0.98525643, 'specificity': 0.98525643, 'f1': 0.9915527, 'auroc': 0.99959445, 'binary_precision': 1.0, 'binary_recall': 0.9705128, 'binary_specificity': 1.0, 'binary_f1_score': 0.9850358}
confusion matrix:
      0    1
0  5946    0
1    23  757
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_26.png
early stop counter: 1
val acc:0.9642475843429565, best validation acc: 0.9740127921104431, corresponding to test acc:                         0.9968777894973755 / 0.9983645677566528
after epoch: 26,now: 2024-06-03 07:16:51.981362,epoch time: 0:20:52.051752,used: 9:03:08.864424,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9954639, 'precision': 0.9971838, 'recall': 0.9758084, 'specificity': 0.9758084, 'f1': 0.986203, 'auroc': 0.99887735, 'binary_precision': 0.99927187, 'binary_recall': 0.95168746, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.97489935}
confusion matrix:
       0     1
0  42407     3
1    209  4117
---- Validation: 
scalar performance:
{'acc': 0.97182494, 'precision': 0.9052983, 'recall': 0.63276094, 'specificity': 0.63276094, 'f1': 0.695488, 'auroc': 0.9611082, 'binary_precision': 0.8372093, 'binary_recall': 0.26745912, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.4054054}
confusion matrix:
       0    1
0  18032   35
1    493  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9891466, 'precision': 0.9939359, 'recall': 0.9532051, 'specificity': 0.9532051, 'f1': 0.9724034, 'auroc': 0.9983568, 'binary_precision': 1.0, 'binary_recall': 0.9064103, 'binary_specificity': 1.0, 'binary_f1_score': 0.9509079}
confusion matrix:
      0    1
0  5946    0
1    73  707
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_27.png
early stop counter: 2
val acc:0.9718249440193176, best validation acc: 0.9740127921104431, corresponding to test acc:                         0.9968777894973755 / 0.9983645677566528
after epoch: 27,now: 2024-06-03 07:37:41.988856,epoch time: 0:20:50.007494,used: 9:23:58.871918,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9983097, 'precision': 0.992805, 'recall': 0.9971999, 'specificity': 0.9971999, 'f1': 0.99499017, 'auroc': 0.9999198, 'binary_precision': 0.9860348, 'binary_recall': 0.99583817, 'binary_specificity': 0.9985617, 'binary_f1_score': 0.9909122}
confusion matrix:
       0     1
0  42350    61
1     18  4307
---- Validation: 
scalar performance:
{'acc': 0.94967985, 'precision': 0.6928946, 'recall': 0.85659885, 'specificity': 0.85659885, 'f1': 0.74628687, 'auroc': 0.94806033, 'binary_precision': 0.39518633, 'binary_recall': 0.756315, 'binary_specificity': 0.9568827, 'binary_f1_score': 0.5191229}
confusion matrix:
       0    1
0  17288  779
1    164  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99821585, 'precision': 0.9989929, 'recall': 0.99230766, 'specificity': 0.99230766, 'f1': 0.99562, 'auroc': 0.99990815, 'binary_precision': 1.0, 'binary_recall': 0.9846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.9922481}
confusion matrix:
      0    1
0  5946    0
1    12  768
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_28.png
early stop counter: 3
val acc:0.9496798515319824, best validation acc: 0.9740127921104431, corresponding to test acc:                         0.9968777894973755 / 0.9983645677566528
after epoch: 28,now: 2024-06-03 07:58:19.393116,epoch time: 0:20:37.404260,used: 9:44:36.276178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9986734, 'precision': 0.9992701, 'recall': 0.99283403, 'specificity': 0.99283403, 'f1': 0.9960259, 'auroc': 0.99983585, 'binary_precision': 1.0, 'binary_recall': 0.98566806, 'binary_specificity': 1.0, 'binary_f1_score': 0.9927823}
confusion matrix:
       0     1
0  42410     0
1     62  4264
---- Validation: 
scalar performance:
{'acc': 0.96616864, 'precision': 0.9171859, 'recall': 0.5339816, 'specificity': 0.5339816, 'f1': 0.55473596, 'auroc': 0.9549822, 'binary_precision': 0.8679245, 'binary_recall': 0.068350665, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.12672175}
confusion matrix:
       0   1
0  18060   7
1    627  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99598575, 'precision': 0.9977398, 'recall': 0.9826923, 'specificity': 0.9826923, 'f1': 0.9900611, 'auroc': 0.9998275, 'binary_precision': 1.0, 'binary_recall': 0.9653846, 'binary_specificity': 1.0, 'binary_f1_score': 0.9823875}
confusion matrix:
      0    1
0  5946    0
1    27  753
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_29.png
early stop counter: 4
val acc:0.9661686420440674, best validation acc: 0.9740127921104431, corresponding to test acc:                         0.9968777894973755 / 0.9983645677566528
after epoch: 29,now: 2024-06-03 08:19:13.880003,epoch time: 0:20:54.486887,used: 10:05:30.763065,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99912274, 'precision': 0.9994122, 'recall': 0.99536395, 'specificity': 0.99536395, 'f1': 0.99737775, 'auroc': 0.9999467, 'binary_precision': 0.9997667, 'binary_recall': 0.99075145, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99523866}
confusion matrix:
       0     1
0  42410     1
1     40  4285
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.9069557, 'recall': 0.528781, 'specificity': 0.528781, 'f1': 0.5455235, 'auroc': 0.9605166, 'binary_precision': 0.84782606, 'binary_recall': 0.05794948, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.10848401}
confusion matrix:
       0   1
0  18060   7
1    634  39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99776983, 'precision': 0.99874187, 'recall': 0.9903846, 'specificity': 0.9903846, 'f1': 0.9945158, 'auroc': 0.99998045, 'binary_precision': 1.0, 'binary_recall': 0.9807692, 'binary_specificity': 1.0, 'binary_f1_score': 0.9902913}
confusion matrix:
      0    1
0  5946    0
1    15  765
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_30.png
early stop counter: 5
val acc:0.96579509973526, best validation acc: 0.9740127921104431, corresponding to test acc:                         0.9968777894973755 / 0.9983645677566528
after epoch: 30,now: 2024-06-03 08:40:04.160901,epoch time: 0:20:50.280898,used: 10:26:21.043963,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_22_13_43_seed_1_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:26:21.043963 at 2024-06-03 08:40:04.160901
persisted model performance metric: 

scalar performance:
{'acc': 0.9973238, 'precision': 0.99735224, 'recall': 0.9895754, 'specificity': 0.9895754, 'f1': 0.9934226, 'auroc': 0.9998958, 'binary_precision': 0.997389, 'binary_recall': 0.9794872, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.98835707}
confusion matrix:
      0    1
0  5944    2
1    16  764
oracle model performance metric: 

scalar performance:
{'acc': 0.99821585, 'precision': 0.997306, 'recall': 0.9939785, 'specificity': 0.9939785, 'f1': 0.99563473, 'auroc': 0.99949443, 'binary_precision': 0.996124, 'binary_recall': 0.98846155, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.99227804}
confusion matrix:
      0    1
0  5943    3
1     9  771
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456306 KiB |  13219 MiB |   2328 TiB |   2328 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2301 TiB |   2301 TiB |
|       from small pool |  41774 KiB |     61 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456306 KiB |  13219 MiB |   2328 TiB |   2328 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2301 TiB |   2301 TiB |
|       from small pool |  41774 KiB |     61 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447776 KiB |  13213 MiB |   2320 TiB |   2320 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   2293 TiB |   2293 TiB |
|       from small pool |  40701 KiB |     60 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14486 MiB |  28078 MiB |  13604 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  27992 MiB |  13584 MiB |
|       from small pool |     66 MiB |     72 MiB |     86 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446862 KiB |   1251 MiB |   1658 TiB |   1658 TiB |
|       from large pool | 435388 KiB |   1244 MiB |   1631 TiB |   1631 TiB |
|       from small pool |  11473 KiB |     43 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3662    |    6847    |  408621 K  |  408618 K  |
|       from large pool |     187    |    1413    |  212415 K  |  212415 K  |
|       from small pool |    3475    |    6658    |  196206 K  |  196202 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3662    |    6847    |  408621 K  |  408618 K  |
|       from large pool |     187    |    1413    |  212415 K  |  212415 K  |
|       from small pool |    3475    |    6658    |  196206 K  |  196202 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     637    |    1208    |     574    |
|       from large pool |     601    |     601    |    1165    |     564    |
|       from small pool |      33    |      36    |      43    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      83    |    2990    |  255557 K  |  255557 K  |
|       from large pool |      40    |     604    |  154019 K  |  154019 K  |
|       from small pool |      43    |    2948    |  101537 K  |  101537 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2328 TiB |   2328 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2301 TiB |   2301 TiB |
|       from small pool |      0 KiB |     61 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2328 TiB |   2328 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2301 TiB |   2301 TiB |
|       from small pool |      0 KiB |     61 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2320 TiB |   2320 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2293 TiB |   2293 TiB |
|       from small pool |      0 KiB |     60 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14486 MiB |  28078 MiB |  27196 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     72 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1658 TiB |   1658 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   1631 TiB |   1631 TiB |
|       from small pool |      0 KiB |     43 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6847    |  408621 K  |  408621 K  |
|       from large pool |       2    |    1413    |  212415 K  |  212415 K  |
|       from small pool |       0    |    6658    |  196206 K  |  196206 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6847    |  408621 K  |  408621 K  |
|       from large pool |       2    |    1413    |  212415 K  |  212415 K  |
|       from small pool |       0    |    6658    |  196206 K  |  196206 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1208    |    1145    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      36    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2990    |  255558 K  |  255558 K  |
|       from large pool |       4    |     604    |  154019 K  |  154019 K  |
|       from small pool |       0    |    2948    |  101539 K  |  101539 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2328 TiB |   2328 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2301 TiB |   2301 TiB |
|       from small pool |      0 KiB |     61 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2328 TiB |   2328 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2301 TiB |   2301 TiB |
|       from small pool |      0 KiB |     61 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2320 TiB |   2320 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2293 TiB |   2293 TiB |
|       from small pool |      0 KiB |     60 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14486 MiB |  28078 MiB |  27196 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     72 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1658 TiB |   1658 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   1631 TiB |   1631 TiB |
|       from small pool |      0 KiB |     43 MiB |     27 TiB |     27 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6847    |  408621 K  |  408621 K  |
|       from large pool |       2    |    1413    |  212415 K  |  212415 K  |
|       from small pool |       0    |    6658    |  196206 K  |  196206 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6847    |  408621 K  |  408621 K  |
|       from large pool |       2    |    1413    |  212415 K  |  212415 K  |
|       from small pool |       0    |    6658    |  196206 K  |  196206 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1208    |    1145    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      36    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2990    |  255558 K  |  255558 K  |
|       from large pool |       4    |     604    |  154019 K  |  154019 K  |
|       from small pool |       0    |    2948    |  101539 K  |  101539 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_08_47_26_seed_2_21054736

 Experiment start at: 2024-06-03 08:47:26.265335
before training, model accuracy: 0.7911646366119385
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98834527, 'precision': 0.972066, 'recall': 0.96070236, 'specificity': 0.96070236, 'f1': 0.966296, 'auroc': 0.99460465, 'binary_precision': 0.9520036, 'binary_recall': 0.9264155, 'binary_specificity': 0.9949892, 'binary_f1_score': 0.93903524}
confusion matrix:
       0     1
0  42097   212
1    334  4205
---- Validation: 
scalar performance:
{'acc': 0.96542907, 'precision': 0.7133122, 'recall': 0.66252863, 'specificity': 0.66252863, 'f1': 0.68410593, 'auroc': 0.87372285, 'binary_precision': 0.44835165, 'binary_recall': 0.33887044, 'binary_specificity': 0.9861868, 'binary_f1_score': 0.3859981}
confusion matrix:
       0    1
0  17920  251
1    398  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.988398, 'precision': 0.9928912, 'recall': 0.9468863, 'specificity': 0.9468863, 'f1': 0.9684258, 'auroc': 0.99650735, 'binary_precision': 0.99846154, 'binary_recall': 0.8939394, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.94331396}
confusion matrix:
      0    1
0  5996    1
1    77  649
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-03 09:09:18.915931,epoch time: 0:21:52.650596,used: 0:21:52.650596,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_08_47_26_seed_2_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.995368, 'precision': 0.9877465, 'recall': 0.9857304, 'specificity': 0.9857304, 'f1': 0.9867358, 'auroc': 0.9988935, 'binary_precision': 0.9783042, 'binary_recall': 0.973777, 'binary_specificity': 0.99768376, 'binary_f1_score': 0.97603536}
confusion matrix:
       0     1
0  42212    98
1    119  4419
---- Validation: 
scalar performance:
{'acc': 0.9635114, 'precision': 0.7171502, 'recall': 0.7844044, 'specificity': 0.7844044, 'f1': 0.74570715, 'auroc': 0.9292712, 'binary_precision': 0.44792974, 'binary_recall': 0.59302324, 'binary_specificity': 0.9757856, 'binary_f1_score': 0.5103646}
confusion matrix:
       0    1
0  17731  440
1    245  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9955377, 'precision': 0.9975112, 'recall': 0.9793389, 'specificity': 0.9793389, 'f1': 0.988204, 'auroc': 0.99894416, 'binary_precision': 1.0, 'binary_recall': 0.9586777, 'binary_specificity': 1.0, 'binary_f1_score': 0.97890294}
confusion matrix:
      0    1
0  5997    0
1    30  696
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_2.png
new oracle model saved
early stop counter: 1
val acc:0.9635114073753357, best validation acc: 0.9654290676116943, corresponding to test acc:                         0.988398015499115 / 0.9955376982688904
after epoch: 2,now: 2024-06-03 09:30:21.224220,epoch time: 0:21:02.308289,used: 0:42:54.958885,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_08_47_26_seed_2_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9956882, 'precision': 0.9962859, 'recall': 0.9790268, 'specificity': 0.9790268, 'f1': 0.9874631, 'auroc': 0.99895954, 'binary_precision': 0.9970204, 'binary_recall': 0.95836085, 'binary_specificity': 0.99969274, 'binary_f1_score': 0.97730845}
confusion matrix:
       0     1
0  42296    13
1    189  4350
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.721706, 'recall': 0.52879965, 'specificity': 0.52879965, 'f1': 0.54487884, 'auroc': 0.9189291, 'binary_precision': 0.47368422, 'binary_recall': 0.059800666, 'binary_specificity': 0.9977987, 'binary_f1_score': 0.1061947}
confusion matrix:
       0   1
0  18131  40
1    566  36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99256283, 'precision': 0.9958657, 'recall': 0.9655647, 'specificity': 0.9655647, 'f1': 0.98009264, 'auroc': 0.99823374, 'binary_precision': 1.0, 'binary_recall': 0.93112946, 'binary_specificity': 1.0, 'binary_f1_score': 0.96433663}
confusion matrix:
      0    1
0  5997    0
1    50  676
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_3.png
better model found
persisted
after epoch: 3,now: 2024-06-03 09:51:23.485970,epoch time: 0:21:02.261750,used: 1:03:57.220635,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_08_47_26_seed_2_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99754524, 'precision': 0.99663913, 'recall': 0.9892988, 'specificity': 0.9892988, 'f1': 0.9929343, 'auroc': 0.9991834, 'binary_precision': 0.9955197, 'binary_recall': 0.9790703, 'binary_specificity': 0.9995273, 'binary_f1_score': 0.9872264}
confusion matrix:
       0     1
0  42289    20
1     95  4444
---- Validation: 
scalar performance:
{'acc': 0.9700634, 'precision': 0.76285434, 'recall': 0.6938323, 'specificity': 0.6938323, 'f1': 0.7226285, 'auroc': 0.9306996, 'binary_precision': 0.54545456, 'binary_recall': 0.3986711, 'binary_specificity': 0.98899347, 'binary_f1_score': 0.4606526}
confusion matrix:
       0    1
0  17971  200
1    362  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99598396, 'precision': 0.997759, 'recall': 0.98140496, 'specificity': 0.98140496, 'f1': 0.98940325, 'auroc': 0.9989049, 'binary_precision': 1.0, 'binary_recall': 0.9628099, 'binary_specificity': 1.0, 'binary_f1_score': 0.98105264}
confusion matrix:
      0    1
0  5997    0
1    27  699
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-03 10:12:22.674373,epoch time: 0:20:59.188403,used: 1:24:56.409038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_08_47_26_seed_2_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9972464, 'precision': 0.998277, 'recall': 0.9859865, 'specificity': 0.9859865, 'f1': 0.99203455, 'auroc': 0.99950325, 'binary_precision': 0.9995469, 'binary_recall': 0.97202027, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9855914}
confusion matrix:
       0     1
0  42307     2
1    127  4412
---- Validation: 
scalar performance:
{'acc': 0.97160816, 'precision': 0.8089531, 'recall': 0.62717414, 'specificity': 0.62717414, 'f1': 0.677354, 'auroc': 0.92318255, 'binary_precision': 0.6419753, 'binary_recall': 0.2591362, 'binary_specificity': 0.99521214, 'binary_f1_score': 0.36923075}
confusion matrix:
       0    1
0  18084   87
1    446  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9930091, 'precision': 0.99611187, 'recall': 0.96763086, 'specificity': 0.96763086, 'f1': 0.9813223, 'auroc': 0.998486, 'binary_precision': 1.0, 'binary_recall': 0.9352617, 'binary_specificity': 1.0, 'binary_f1_score': 0.966548}
confusion matrix:
      0    1
0  5997    0
1    47  679
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_5.png
better model found
persisted
after epoch: 5,now: 2024-06-03 10:33:08.262468,epoch time: 0:20:45.588095,used: 1:45:41.997133,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_08_47_26_seed_2_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9900956, 'precision': 0.9943538, 'recall': 0.9490841, 'specificity': 0.9490841, 'f1': 0.97035277, 'auroc': 0.9977368, 'binary_precision': 0.9995097, 'binary_recall': 0.8982155, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.94615924}
confusion matrix:
       0     1
0  42307     2
1    462  4077
---- Validation: 
scalar performance:
{'acc': 0.9672402, 'precision': 0.6753893, 'recall': 0.5165063, 'specificity': 0.5165063, 'f1': 0.52362764, 'auroc': 0.9005494, 'binary_precision': 0.38181818, 'binary_recall': 0.034883723, 'binary_specificity': 0.9981289, 'binary_f1_score': 0.06392694}
confusion matrix:
       0   1
0  18137  34
1    581  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9830433, 'precision': 0.9906726, 'recall': 0.92148757, 'specificity': 0.92148757, 'f1': 0.9526915, 'auroc': 0.9982523, 'binary_precision': 1.0, 'binary_recall': 0.8429752, 'binary_specificity': 1.0, 'binary_f1_score': 0.91479826}
confusion matrix:
      0    1
0  5997    0
1   114  612
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_6.png
early stop counter: 1
val acc:0.9672402143478394, best validation acc: 0.9716081619262695, corresponding to test acc:                         0.993009090423584 / 0.9959839582443237
after epoch: 6,now: 2024-06-03 10:54:00.347836,epoch time: 0:20:52.085368,used: 2:06:34.082501,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_08_47_26_seed_2_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9938738, 'precision': 0.9966312, 'recall': 0.9683781, 'specificity': 0.9683781, 'f1': 0.9819827, 'auroc': 0.9994084, 'binary_precision': 1.0, 'binary_recall': 0.93675625, 'binary_specificity': 1.0, 'binary_f1_score': 0.96734554}
confusion matrix:
       0     1
0  42310     0
1    287  4251
---- Validation: 
scalar performance:
{'acc': 0.9670271, 'precision': 0.57666916, 'recall': 0.50354743, 'specificity': 0.50354743, 'f1': 0.49956542, 'auroc': 0.9332965, 'binary_precision': 0.18518518, 'binary_recall': 0.008305647, 'binary_specificity': 0.99878925, 'binary_f1_score': 0.01589825}
confusion matrix:
       0   1
0  18149  22
1    597   5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9892905, 'precision': 0.9940682, 'recall': 0.9504132, 'specificity': 0.9504132, 'f1': 0.97092944, 'auroc': 0.999423, 'binary_precision': 1.0, 'binary_recall': 0.90082645, 'binary_specificity': 1.0, 'binary_f1_score': 0.9478261}
confusion matrix:
      0    1
0  5997    0
1    72  654
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_7.png
early stop counter: 2
val acc:0.9670271277427673, best validation acc: 0.9716081619262695, corresponding to test acc:                         0.993009090423584 / 0.9959839582443237
after epoch: 7,now: 2024-06-03 11:15:03.816931,epoch time: 0:21:03.469095,used: 2:27:37.551596,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_08_47_26_seed_2_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9979508, 'precision': 0.9983653, 'recall': 0.9899144, 'specificity': 0.9899144, 'f1': 0.994094, 'auroc': 0.99930704, 'binary_precision': 0.9988769, 'binary_recall': 0.9799471, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.9893215}
confusion matrix:
       0     1
0  42305     5
1     91  4447
---- Validation: 
scalar performance:
{'acc': 0.97230065, 'precision': 0.8920258, 'recall': 0.5881825, 'specificity': 0.5881825, 'f1': 0.63871366, 'auroc': 0.9209491, 'binary_precision': 0.81060606, 'binary_recall': 0.17774086, 'binary_specificity': 0.9986242, 'binary_f1_score': 0.29155314}
confusion matrix:
       0    1
0  18146   25
1    495  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9982151, 'precision': 0.9990015, 'recall': 0.9917356, 'specificity': 0.9917356, 'f1': 0.99533355, 'auroc': 0.9998369, 'binary_precision': 1.0, 'binary_recall': 0.9834711, 'binary_specificity': 1.0, 'binary_f1_score': 0.9916667}
confusion matrix:
      0    1
0  5997    0
1    12  714
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-06-03 11:36:38.865704,epoch time: 0:21:35.048773,used: 2:49:12.600369,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_08_47_26_seed_2_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99716103, 'precision': 0.9952282, 'recall': 0.98849356, 'specificity': 0.98849356, 'f1': 0.99183166, 'auroc': 0.9996389, 'binary_precision': 0.9928396, 'binary_recall': 0.9777435, 'binary_specificity': 0.9992437, 'binary_f1_score': 0.9852337}
confusion matrix:
       0     1
0  42278    32
1    101  4437
---- Validation: 
scalar performance:
{'acc': 0.97080916, 'precision': 0.8633766, 'recall': 0.56572974, 'specificity': 0.56572974, 'f1': 0.60555637, 'auroc': 0.94149166, 'binary_precision': 0.754717, 'binary_recall': 0.13289036, 'binary_specificity': 0.99856913, 'binary_f1_score': 0.2259887}
confusion matrix:
       0   1
0  18145  26
1    522  80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.994794, 'precision': 0.9970988, 'recall': 0.9758953, 'specificity': 0.9758953, 'f1': 0.98619515, 'auroc': 0.99928635, 'binary_precision': 1.0, 'binary_recall': 0.95179063, 'binary_specificity': 1.0, 'binary_f1_score': 0.97529995}
confusion matrix:
      0    1
0  5997    0
1    35  691
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_9.png
early stop counter: 1
val acc:0.9708091616630554, best validation acc: 0.97230064868927, corresponding to test acc:                         0.9982150793075562 / 0.9982150793075562
after epoch: 9,now: 2024-06-03 11:59:40.445100,epoch time: 0:23:01.579396,used: 3:12:14.179765,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_08_47_26_seed_2_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9965634, 'precision': 0.9980021, 'recall': 0.9823593, 'specificity': 0.9823593, 'f1': 0.9900228, 'auroc': 0.9996414, 'binary_precision': 0.99977165, 'binary_recall': 0.9647422, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9819446}
confusion matrix:
       0     1
0  42309     1
1    160  4378
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.80705404, 'recall': 0.5163086, 'specificity': 0.5163086, 'f1': 0.5235632, 'auroc': 0.90394443, 'binary_precision': 0.6451613, 'binary_recall': 0.03322259, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.06319115}
confusion matrix:
       0   1
0  18160  11
1    582  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9958352, 'precision': 0.9976764, 'recall': 0.9807162, 'specificity': 0.9807162, 'f1': 0.989004, 'auroc': 0.99949586, 'binary_precision': 1.0, 'binary_recall': 0.9614325, 'binary_specificity': 1.0, 'binary_f1_score': 0.98033714}
confusion matrix:
      0    1
0  5997    0
1    28  698
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_10.png
early stop counter: 2
val acc:0.9684121012687683, best validation acc: 0.97230064868927, corresponding to test acc:                         0.9982150793075562 / 0.9982150793075562
after epoch: 10,now: 2024-06-03 12:21:25.319576,epoch time: 0:21:44.874476,used: 3:33:59.054241,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_08_47_26_seed_2_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99585897, 'precision': 0.9869559, 'recall': 0.9894449, 'specificity': 0.9894449, 'f1': 0.9881964, 'auroc': 0.99898267, 'binary_precision': 0.9758983, 'binary_recall': 0.98148966, 'binary_specificity': 0.99740016, 'binary_f1_score': 0.97868603}
confusion matrix:
       0     1
0  42200   110
1     84  4454
---- Validation: 
scalar performance:
{'acc': 0.97166145, 'precision': 0.7869185, 'recall': 0.6785968, 'specificity': 0.6785968, 'f1': 0.7190646, 'auroc': 0.92494625, 'binary_precision': 0.5945946, 'binary_recall': 0.3654485, 'binary_specificity': 0.9917451, 'binary_f1_score': 0.45267493}
confusion matrix:
       0    1
0  18021  150
1    382  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9955377, 'precision': 0.9975112, 'recall': 0.9793389, 'specificity': 0.9793389, 'f1': 0.988204, 'auroc': 0.9993895, 'binary_precision': 1.0, 'binary_recall': 0.9586777, 'binary_specificity': 1.0, 'binary_f1_score': 0.97890294}
confusion matrix:
      0    1
0  5997    0
1    30  696
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_11.png
early stop counter: 3
val acc:0.9716614484786987, best validation acc: 0.97230064868927, corresponding to test acc:                         0.9982150793075562 / 0.9982150793075562
after epoch: 11,now: 2024-06-03 12:43:01.931091,epoch time: 0:21:36.611515,used: 3:55:35.665756,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_08_47_26_seed_2_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99684083, 'precision': 0.99825704, 'recall': 0.9836968, 'specificity': 0.9836968, 'f1': 0.9908404, 'auroc': 0.99951905, 'binary_precision': 1.0, 'binary_recall': 0.9673937, 'binary_specificity': 1.0, 'binary_f1_score': 0.9834267}
confusion matrix:
       0     1
0  42309     0
1    148  4391
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.77188104, 'recall': 0.5218749, 'specificity': 0.5218749, 'f1': 0.5335395, 'auroc': 0.8643736, 'binary_precision': 0.5744681, 'binary_recall': 0.0448505, 'binary_specificity': 0.99889934, 'binary_f1_score': 0.083204925}
confusion matrix:
       0   1
0  18151  20
1    575  27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9937528, 'precision': 0.9965226, 'recall': 0.97107434, 'specificity': 0.97107434, 'f1': 0.9833616, 'auroc': 0.9992106, 'binary_precision': 1.0, 'binary_recall': 0.94214875, 'binary_specificity': 1.0, 'binary_f1_score': 0.9702128}
confusion matrix:
      0    1
0  5997    0
1    42  684
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_12.png
early stop counter: 4
val acc:0.9683055281639099, best validation acc: 0.97230064868927, corresponding to test acc:                         0.9982150793075562 / 0.9982150793075562
after epoch: 12,now: 2024-06-03 13:04:29.140158,epoch time: 0:21:27.209067,used: 4:17:02.874823,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_08_47_26_seed_2_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99684083, 'precision': 0.9896561, 'recall': 0.99235064, 'specificity': 0.99235064, 'f1': 0.9909987, 'auroc': 0.9996906, 'binary_precision': 0.9807313, 'binary_recall': 0.98678124, 'binary_specificity': 0.99792004, 'binary_f1_score': 0.98374695}
confusion matrix:
       0     1
0  42221    88
1     60  4479
---- Validation: 
scalar performance:
{'acc': 0.96510947, 'precision': 0.706785, 'recall': 0.6446964, 'specificity': 0.6446964, 'f1': 0.66964054, 'auroc': 0.91238683, 'binary_precision': 0.43645084, 'binary_recall': 0.30232558, 'binary_specificity': 0.9870673, 'binary_f1_score': 0.35721293}
confusion matrix:
       0    1
0  17936  235
1    420  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99390155, 'precision': 0.98388934, 'recall': 0.984475, 'specificity': 0.984475, 'f1': 0.984182, 'auroc': 0.99876523, 'binary_precision': 0.97111416, 'binary_recall': 0.9724518, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.97178257}
confusion matrix:
      0    1
0  5976   21
1    20  706
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_13.png
early stop counter: 5
val acc:0.9651094675064087, best validation acc: 0.97230064868927, corresponding to test acc:                         0.9982150793075562 / 0.9982150793075562
after epoch: 13,now: 2024-06-03 13:26:32.135093,epoch time: 0:22:02.994935,used: 4:39:05.869758,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_08_47_26_seed_2_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9976093, 'precision': 0.9986799, 'recall': 0.9876625, 'specificity': 0.9876625, 'f1': 0.99309325, 'auroc': 0.999606, 'binary_precision': 1.0, 'binary_recall': 0.975325, 'binary_specificity': 1.0, 'binary_f1_score': 0.98750836}
confusion matrix:
       0     1
0  42309     0
1    112  4427
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.7908983, 'recall': 0.51545054, 'specificity': 0.51545054, 'f1': 0.5219563, 'auroc': 0.94131994, 'binary_precision': 0.61290324, 'binary_recall': 0.03156146, 'binary_specificity': 0.9993396, 'binary_f1_score': 0.060031597}
confusion matrix:
       0   1
0  18159  12
1    583  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99643016, 'precision': 0.99800694, 'recall': 0.98347104, 'specificity': 0.98347104, 'f1': 0.99059814, 'auroc': 0.99993503, 'binary_precision': 1.0, 'binary_recall': 0.96694213, 'binary_specificity': 1.0, 'binary_f1_score': 0.9831933}
confusion matrix:
      0    1
0  5997    0
1    24  702
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_14.png
early stop counter: 6
val acc:0.9683055281639099, best validation acc: 0.97230064868927, corresponding to test acc:                         0.9982150793075562 / 0.9982150793075562
after epoch: 14,now: 2024-06-03 13:48:18.905283,epoch time: 0:21:46.770190,used: 5:00:52.639948,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_08_47_26_seed_2_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9982283, 'precision': 0.9975255, 'recall': 0.9923321, 'specificity': 0.9923321, 'f1': 0.99491155, 'auroc': 0.9998609, 'binary_precision': 0.99665624, 'binary_recall': 0.98501873, 'binary_specificity': 0.9996455, 'binary_f1_score': 0.9908033}
confusion matrix:
       0     1
0  42294    15
1     68  4471
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.7984637, 'recall': 0.5301255, 'specificity': 0.5301255, 'f1': 0.54801863, 'auroc': 0.93094635, 'binary_precision': 0.62711865, 'binary_recall': 0.061461795, 'binary_specificity': 0.99878925, 'binary_f1_score': 0.11195159}
confusion matrix:
       0   1
0  18149  22
1    565  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99851257, 'precision': 0.9991677, 'recall': 0.9931129, 'specificity': 0.9931129, 'f1': 0.99611604, 'auroc': 0.99997246, 'binary_precision': 1.0, 'binary_recall': 0.9862259, 'binary_specificity': 1.0, 'binary_f1_score': 0.99306524}
confusion matrix:
      0    1
0  5997    0
1    10  716
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_15.png
new oracle model saved
early stop counter: 7
val acc:0.968731701374054, best validation acc: 0.97230064868927, corresponding to test acc:                         0.9982150793075562 / 0.9985125660896301
after epoch: 15,now: 2024-06-03 14:10:52.501826,epoch time: 0:22:33.596543,used: 5:23:26.236491,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_08_47_26_seed_2_21054736
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9972678, 'precision': 0.9984919, 'recall': 0.9859, 'specificity': 0.9859, 'f1': 0.992094, 'auroc': 0.9994298, 'binary_precision': 1.0, 'binary_recall': 0.97179997, 'binary_specificity': 1.0, 'binary_f1_score': 0.98569834}
confusion matrix:
       0     1
0  42309     0
1    128  4411
---- Validation: 
scalar performance:
{'acc': 0.9697438, 'precision': 0.8985318, 'recall': 0.5354666, 'specificity': 0.5354666, 'f1': 0.5580511, 'auroc': 0.9149716, 'binary_precision': 0.8269231, 'binary_recall': 0.071428575, 'binary_specificity': 0.9995047, 'binary_f1_score': 0.13149847}
confusion matrix:
       0   1
0  18162   9
1    559  43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9958352, 'precision': 0.9976764, 'recall': 0.9807162, 'specificity': 0.9807162, 'f1': 0.989004, 'auroc': 0.99991095, 'binary_precision': 1.0, 'binary_recall': 0.9614325, 'binary_specificity': 1.0, 'binary_f1_score': 0.98033714}
confusion matrix:
      0    1
0  5997    0
1    28  698
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054736_16.png
[Mon Jun  3 14:33:52 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/rule_results/2.csv

RuleException:
RuntimeError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[enforce fail at inline_container.cc:595] . unexpected pos 61668864 vs 61668688
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_irm.py", line 51, in tr_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_irm.py", line 66, in after_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 60, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/a_model_sel.py", line 63, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/c_msel_oracle.py", line 37, in base_update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model.py", line 159, in save
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_utils.py", line 88, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 627, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 475, in __exit__
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
