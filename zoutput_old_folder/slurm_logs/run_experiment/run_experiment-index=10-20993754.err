Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed May 29 13:26:15 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/10.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=10
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754

 Experiment start at: 2024-05-29 13:38:03.327289
before training, model accuracy: 0.2401725947856903
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9619793, 'precision': 0.53785455, 'recall': 0.5065664, 'specificity': 0.5065664, 'f1': 0.50601137, 'auroc': 0.5889118, 'binary_precision': 0.10887097, 'binary_recall': 0.018354861, 'binary_specificity': 0.994778, 'binary_f1_score': 0.031413615}
confusion matrix:
       0    1
0  42100  221
1   1444   27
---- Validation: 
scalar performance:
{'acc': 0.96035546, 'precision': 0.48763087, 'recall': 0.49793997, 'specificity': 0.49793997, 'f1': 0.49122655, 'auroc': 0.49623075, 'binary_precision': 0.009615385, 'binary_recall': 0.00155521, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.0026773761}
confusion matrix:
       0    1
0  18046  103
1    642    1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95254076, 'precision': 0.47902605, 'recall': 0.4969985, 'specificity': 0.4969985, 'f1': 0.48784682, 'auroc': 0.4818223, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.993997, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5961  36
1   261   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-29 14:04:21.482909,epoch time: 0:26:18.155620,used: 0:26:18.155620,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96561015, 'precision': 0.6226665, 'recall': 0.50680447, 'specificity': 0.50680447, 'f1': 0.5054412, 'auroc': 0.6921773, 'binary_precision': 0.278481, 'binary_recall': 0.014955812, 'binary_specificity': 0.9986532, 'binary_f1_score': 0.028387094}
confusion matrix:
       0   1
0  42264  57
1   1449  22
---- Validation: 
scalar performance:
{'acc': 0.96471906, 'precision': 0.5544013, 'recall': 0.5024492, 'specificity': 0.5024492, 'f1': 0.4969807, 'auroc': 0.6367807, 'binary_precision': 0.14285715, 'binary_recall': 0.00622084, 'binary_specificity': 0.9986776, 'binary_f1_score': 0.011922505}
confusion matrix:
       0   1
0  18125  24
1    639   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95653564, 'precision': 0.5176449, 'recall': 0.5009152, 'specificity': 0.5009152, 'f1': 0.49254033, 'auroc': 0.6330215, 'binary_precision': 0.07692308, 'binary_recall': 0.0038314175, 'binary_specificity': 0.997999, 'binary_f1_score': 0.0072992705}
confusion matrix:
      0   1
0  5985  12
1   260   1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-29 14:24:29.777322,epoch time: 0:20:08.294413,used: 0:46:26.450033,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9663637, 'precision': 0.72139466, 'recall': 0.50326675, 'specificity': 0.50326675, 'f1': 0.49814305, 'auroc': 0.79885113, 'binary_precision': 0.47619048, 'binary_recall': 0.006793478, 'binary_specificity': 0.99974006, 'binary_f1_score': 0.013395847}
confusion matrix:
       0   1
0  42309  11
1   1462  10
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.5829137, 'recall': 0.5006674, 'specificity': 0.5006674, 'f1': 0.49279836, 'auroc': 0.77191794, 'binary_precision': 0.2, 'binary_recall': 0.00155521, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.00308642}
confusion matrix:
       0  1
0  18145  4
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292199, 'recall': 0.5018323, 'specificity': 0.5018323, 'f1': 0.49315178, 'auroc': 0.73355937, 'binary_precision': 0.5, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.007604562}
confusion matrix:
      0  1
0  5996  1
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-29 14:44:11.061423,epoch time: 0:19:41.284101,used: 1:06:07.734134,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.73334324, 'recall': 0.5042652, 'specificity': 0.5042652, 'f1': 0.50014037, 'auroc': 0.83306444, 'binary_precision': 0.5, 'binary_recall': 0.008837526, 'binary_specificity': 0.9996928, 'binary_f1_score': 0.01736807}
confusion matrix:
       0   1
0  42308  13
1   1458  13
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.6704642, 'recall': 0.50219506, 'specificity': 0.50219506, 'f1': 0.49587625, 'auroc': 0.8207643, 'binary_precision': 0.375, 'binary_recall': 0.00466563, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.00921659}
confusion matrix:
       0  1
0  18144  5
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8961932, 'recall': 0.50949514, 'specificity': 0.50949514, 'f1': 0.50823593, 'auroc': 0.8065866, 'binary_precision': 0.8333333, 'binary_recall': 0.019157087, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.037453182}
confusion matrix:
      0  1
0  5996  1
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-05-29 15:05:59.318557,epoch time: 0:21:48.257134,used: 1:27:55.991268,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9664779, 'precision': 0.7611435, 'recall': 0.5049568, 'specificity': 0.5049568, 'f1': 0.501487, 'auroc': 0.866799, 'binary_precision': 0.5555556, 'binary_recall': 0.010197145, 'binary_specificity': 0.99971646, 'binary_f1_score': 0.0200267}
confusion matrix:
       0   1
0  42309  12
1   1456  15
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.64963, 'recall': 0.5021675, 'specificity': 0.5021675, 'f1': 0.49585545, 'auroc': 0.8472743, 'binary_precision': 0.33333334, 'binary_recall': 0.00466563, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.009202453}
confusion matrix:
       0  1
0  18143  6
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.8366661, 'recall': 0.5094118, 'specificity': 0.5094118, 'f1': 0.50812435, 'auroc': 0.8479533, 'binary_precision': 0.71428573, 'binary_recall': 0.019157087, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.037313428}
confusion matrix:
      0  1
0  5995  2
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 1
val acc:0.965623676776886, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9589325785636902 / 0.9589325785636902
after epoch: 5,now: 2024-05-29 15:26:57.812802,epoch time: 0:20:58.494245,used: 1:48:54.485513,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96656924, 'precision': 0.86792934, 'recall': 0.5033636, 'specificity': 0.5033636, 'f1': 0.4982368, 'auroc': 0.8719799, 'binary_precision': 0.7692308, 'binary_recall': 0.0067980965, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.013477089}
confusion matrix:
       0   1
0  42318   3
1   1461  10
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.6079146, 'recall': 0.500695, 'specificity': 0.500695, 'f1': 0.49281454, 'auroc': 0.8531723, 'binary_precision': 0.25, 'binary_recall': 0.00155521, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.0030911902}
confusion matrix:
       0  1
0  18146  3
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.9793765, 'recall': 0.50574714, 'specificity': 0.50574714, 'f1': 0.50083476, 'auroc': 0.8568543, 'binary_precision': 1.0, 'binary_recall': 0.011494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.022727272}
confusion matrix:
      0  1
0  5997  0
1   258  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 2
val acc:0.9656769037246704, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9589325785636902 / 0.9589325785636902
after epoch: 6,now: 2024-05-29 15:47:07.192924,epoch time: 0:20:09.380122,used: 2:09:03.865635,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.74799544, 'recall': 0.5029626, 'specificity': 0.5029626, 'f1': 0.49750143, 'auroc': 0.8790252, 'binary_precision': 0.5294118, 'binary_recall': 0.0061141304, 'binary_specificity': 0.999811, 'binary_f1_score': 0.01208865}
confusion matrix:
       0  1
0  42312  8
1   1463  9
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.782967, 'recall': 0.50227773, 'specificity': 0.50227773, 'f1': 0.49593896, 'auroc': 0.85873604, 'binary_precision': 0.6, 'binary_recall': 0.00466563, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.009259259}
confusion matrix:
       0  1
0  18147  2
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.8543732, 'recall': 0.50566375, 'specificity': 0.50566375, 'f1': 0.5007502, 'auroc': 0.8660863, 'binary_precision': 0.75, 'binary_recall': 0.011494253, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.022641508}
confusion matrix:
      0  1
0  5996  1
1   258  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
better model found
persisted
after epoch: 7,now: 2024-05-29 16:09:44.788284,epoch time: 0:22:37.595360,used: 2:31:41.460995,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9664322, 'precision': 0.7388298, 'recall': 0.5164166, 'specificity': 0.5164166, 'f1': 0.523302, 'auroc': 0.8933363, 'binary_precision': 0.5102041, 'binary_recall': 0.03396739, 'binary_specificity': 0.9988658, 'binary_f1_score': 0.06369427}
confusion matrix:
       0   1
0  42272  48
1   1422  50
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.76459223, 'recall': 0.5136112, 'specificity': 0.5136112, 'f1': 0.51801026, 'auroc': 0.8774423, 'binary_precision': 0.5625, 'binary_recall': 0.02799378, 'binary_specificity': 0.9992286, 'binary_f1_score': 0.05333333}
confusion matrix:
       0   1
0  18135  14
1    625  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.98091424, 'recall': 0.5440613, 'specificity': 0.5440613, 'f1': 0.57125735, 'auroc': 0.8736181, 'binary_precision': 1.0, 'binary_recall': 0.08812261, 'binary_specificity': 1.0, 'binary_f1_score': 0.16197184}
confusion matrix:
      0   1
0  5997   0
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-05-29 16:36:24.181075,epoch time: 0:26:39.392791,used: 2:58:20.853786,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9666149, 'precision': 0.75051016, 'recall': 0.52667475, 'specificity': 0.52667475, 'f1': 0.5413729, 'auroc': 0.8941481, 'binary_precision': 0.53289473, 'binary_recall': 0.055027176, 'binary_specificity': 0.9983223, 'binary_f1_score': 0.09975369}
confusion matrix:
       0   1
0  42249  71
1   1391  81
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.7194233, 'recall': 0.52464163, 'specificity': 0.52464163, 'f1': 0.5375095, 'auroc': 0.88878286, 'binary_precision': 0.47142857, 'binary_recall': 0.051321927, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.09256662}
confusion matrix:
       0   1
0  18112  37
1    610  33
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.8753531, 'recall': 0.5965339, 'specificity': 0.5965339, 'f1': 0.6472539, 'auroc': 0.8839549, 'binary_precision': 0.7846154, 'binary_recall': 0.1954023, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.31288344}
confusion matrix:
      0   1
0  5983  14
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 1
val acc:0.9655704498291016, best validation acc: 0.9659961462020874, corresponding to test acc:                         0.9619686603546143 / 0.964205801486969
after epoch: 9,now: 2024-05-29 16:56:19.965720,epoch time: 0:19:55.784645,used: 3:18:16.638431,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96677476, 'precision': 0.75144434, 'recall': 0.54446185, 'specificity': 0.54446185, 'f1': 0.5697877, 'auroc': 0.9069805, 'binary_precision': 0.5335968, 'binary_recall': 0.09171195, 'binary_specificity': 0.9972117, 'binary_f1_score': 0.15652174}
confusion matrix:
       0    1
0  42202  118
1   1337  135
---- Validation: 
scalar performance:
{'acc': 0.96525115, 'precision': 0.7122494, 'recall': 0.53872734, 'specificity': 0.53872734, 'f1': 0.5598264, 'auroc': 0.89318466, 'binary_precision': 0.45614034, 'binary_recall': 0.08087092, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.13738441}
confusion matrix:
       0   1
0  18087  62
1    591  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.90744555, 'recall': 0.6159411, 'specificity': 0.6159411, 'f1': 0.6745236, 'auroc': 0.88276005, 'binary_precision': 0.8472222, 'binary_recall': 0.23371647, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.36636636}
confusion matrix:
      0   1
0  5986  11
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 2
val acc:0.9652511477470398, best validation acc: 0.9659961462020874, corresponding to test acc:                         0.9619686603546143 / 0.9662831425666809
after epoch: 10,now: 2024-05-29 17:16:15.067205,epoch time: 0:19:55.101485,used: 3:38:11.739916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96666056, 'precision': 0.74391055, 'recall': 0.557845, 'specificity': 0.557845, 'f1': 0.5886193, 'auroc': 0.90262985, 'binary_precision': 0.5176471, 'binary_recall': 0.11956522, 'binary_specificity': 0.99612474, 'binary_f1_score': 0.1942605}
confusion matrix:
       0    1
0  42156  164
1   1296  176
---- Validation: 
scalar performance:
{'acc': 0.9660494, 'precision': 0.7433903, 'recall': 0.5563919, 'specificity': 0.5563919, 'f1': 0.5865083, 'auroc': 0.892016, 'binary_precision': 0.51724136, 'binary_recall': 0.11664075, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.19035533}
confusion matrix:
       0   1
0  18079  70
1    568  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.902829, 'recall': 0.6177735, 'specificity': 0.6177735, 'f1': 0.6764136, 'auroc': 0.88681537, 'binary_precision': 0.8378378, 'binary_recall': 0.23754789, 'binary_specificity': 0.997999, 'binary_f1_score': 0.37014925}
confusion matrix:
      0   1
0  5985  12
1   199  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
better model found
persisted
after epoch: 11,now: 2024-05-29 17:37:22.824682,epoch time: 0:21:07.757477,used: 3:59:19.497393,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9661354, 'precision': 0.7281975, 'recall': 0.5621633, 'specificity': 0.5621633, 'f1': 0.59333587, 'auroc': 0.904222, 'binary_precision': 0.4859335, 'binary_recall': 0.1290761, 'binary_specificity': 0.99525046, 'binary_f1_score': 0.2039721}
confusion matrix:
       0    1
0  42119  201
1   1282  190
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.7182943, 'recall': 0.57161963, 'specificity': 0.57161963, 'f1': 0.60413176, 'auroc': 0.8972031, 'binary_precision': 0.46601942, 'binary_recall': 0.14930016, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.2261484}
confusion matrix:
       0    1
0  18039  110
1    547   96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.92687345, 'recall': 0.64476013, 'specificity': 0.64476013, 'f1': 0.711008, 'auroc': 0.889133, 'binary_precision': 0.88372093, 'binary_recall': 0.29118773, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.43804035}
confusion matrix:
      0   1
0  5987  10
1   185  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 1
val acc:0.9650382995605469, best validation acc: 0.9660493731498718, corresponding to test acc:                         0.9662831425666809 / 0.9688398838043213
after epoch: 12,now: 2024-05-29 18:01:47.167204,epoch time: 0:24:24.342522,used: 4:23:43.839915,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9666834, 'precision': 0.7449386, 'recall': 0.55099577, 'specificity': 0.55099577, 'f1': 0.57911927, 'auroc': 0.90251315, 'binary_precision': 0.5201342, 'binary_recall': 0.1053705, 'binary_specificity': 0.9966211, 'binary_f1_score': 0.17524025}
confusion matrix:
       0    1
0  42178  143
1   1316  155
---- Validation: 
scalar performance:
{'acc': 0.9653044, 'precision': 0.718058, 'recall': 0.5477556, 'specificity': 0.5477556, 'f1': 0.57319355, 'auroc': 0.8993391, 'binary_precision': 0.46715328, 'binary_recall': 0.09953344, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.16410255}
confusion matrix:
       0   1
0  18076  73
1    579  64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.9103844, 'recall': 0.6311834, 'specificity': 0.6311834, 'f1': 0.6933758, 'auroc': 0.8855456, 'binary_precision': 0.8518519, 'binary_recall': 0.26436782, 'binary_specificity': 0.997999, 'binary_f1_score': 0.40350875}
confusion matrix:
      0   1
0  5985  12
1   192  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 2
val acc:0.9653043746948242, best validation acc: 0.9660493731498718, corresponding to test acc:                         0.9662831425666809 / 0.9688398838043213
after epoch: 13,now: 2024-05-29 18:21:57.831496,epoch time: 0:20:10.664292,used: 4:43:54.504207,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9663409, 'precision': 0.7340056, 'recall': 0.5744411, 'specificity': 0.5744411, 'f1': 0.60913444, 'auroc': 0.91194797, 'binary_precision': 0.49671772, 'binary_recall': 0.1543168, 'binary_specificity': 0.99456537, 'binary_f1_score': 0.23547718}
confusion matrix:
       0    1
0  42091  230
1   1244  227
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.7312527, 'recall': 0.59511924, 'specificity': 0.59511924, 'f1': 0.6319655, 'auroc': 0.905219, 'binary_precision': 0.4903475, 'binary_recall': 0.19751166, 'binary_specificity': 0.99272686, 'binary_f1_score': 0.28159645}
confusion matrix:
       0    1
0  18017  132
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9712368, 'precision': 0.91585934, 'recall': 0.6844897, 'specificity': 0.6844897, 'f1': 0.751946, 'auroc': 0.8939936, 'binary_precision': 0.8584071, 'binary_recall': 0.3716475, 'binary_specificity': 0.997332, 'binary_f1_score': 0.5187166}
confusion matrix:
      0   1
0  5981  16
1   164  97
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 3
val acc:0.9655172228813171, best validation acc: 0.9660493731498718, corresponding to test acc:                         0.9662831425666809 / 0.9712368249893188
after epoch: 14,now: 2024-05-29 18:47:05.436009,epoch time: 0:25:07.604513,used: 5:09:02.108720,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96716297, 'precision': 0.75133634, 'recall': 0.599743, 'specificity': 0.599743, 'f1': 0.63983333, 'auroc': 0.91778374, 'binary_precision': 0.5297203, 'binary_recall': 0.20584239, 'binary_specificity': 0.99364364, 'binary_f1_score': 0.29647753}
confusion matrix:
       0    1
0  42051  269
1   1169  303
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.7320807, 'recall': 0.60562, 'specificity': 0.60562, 'f1': 0.6427735, 'auroc': 0.9018537, 'binary_precision': 0.4912892, 'binary_recall': 0.21928461, 'binary_specificity': 0.99195546, 'binary_f1_score': 0.30322582}
confusion matrix:
       0    1
0  18003  146
1    502  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97235537, 'precision': 0.9120461, 'recall': 0.70339674, 'specificity': 0.70339674, 'f1': 0.7693541, 'auroc': 0.91635597, 'binary_precision': 0.8492063, 'binary_recall': 0.4099617, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.55297154}
confusion matrix:
      0    1
0  5978   19
1   154  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 4
val acc:0.9655172228813171, best validation acc: 0.9660493731498718, corresponding to test acc:                         0.9662831425666809 / 0.9723553657531738
after epoch: 15,now: 2024-05-29 19:06:38.392697,epoch time: 0:19:32.956688,used: 5:28:35.065408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96611255, 'precision': 0.7305801, 'recall': 0.5920398, 'specificity': 0.5920398, 'f1': 0.62866664, 'auroc': 0.9134983, 'binary_precision': 0.48869565, 'binary_recall': 0.19102651, 'binary_specificity': 0.9930531, 'binary_f1_score': 0.27468228}
confusion matrix:
       0    1
0  42027  294
1   1190  281
---- Validation: 
scalar performance:
{'acc': 0.96482545, 'precision': 0.7215515, 'recall': 0.606012, 'specificity': 0.606012, 'f1': 0.6412441, 'auroc': 0.90222836, 'binary_precision': 0.47019866, 'binary_recall': 0.22083981, 'binary_specificity': 0.9911841, 'binary_f1_score': 0.3005291}
confusion matrix:
       0    1
0  17989  160
1    501  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97283477, 'precision': 0.9088894, 'recall': 0.7128085, 'specificity': 0.7128085, 'f1': 0.7772519, 'auroc': 0.892015, 'binary_precision': 0.84210527, 'binary_recall': 0.42911878, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.56852794}
confusion matrix:
      0    1
0  5976   21
1   149  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 5
val acc:0.964825451374054, best validation acc: 0.9660493731498718, corresponding to test acc:                         0.9662831425666809 / 0.9728347659111023
after epoch: 16,now: 2024-05-29 19:26:04.861675,epoch time: 0:19:26.468978,used: 5:48:01.534386,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9662267, 'precision': 0.7346468, 'recall': 0.61729085, 'specificity': 0.61729085, 'f1': 0.6544376, 'auroc': 0.91795844, 'binary_precision': 0.49515906, 'binary_recall': 0.24320652, 'binary_specificity': 0.9913752, 'binary_f1_score': 0.3261959}
confusion matrix:
       0    1
0  41955  365
1   1114  358
---- Validation: 
scalar performance:
{'acc': 0.96450615, 'precision': 0.71813405, 'recall': 0.6118471, 'specificity': 0.6118471, 'f1': 0.6460111, 'auroc': 0.9027986, 'binary_precision': 0.46296296, 'binary_recall': 0.2332815, 'binary_specificity': 0.9904127, 'binary_f1_score': 0.31023782}
confusion matrix:
       0    1
0  17975  174
1    493  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9752317, 'precision': 0.91808844, 'recall': 0.7415441, 'specificity': 0.7415441, 'f1': 0.8041122, 'auroc': 0.8971574, 'binary_precision': 0.8581081, 'binary_recall': 0.48659003, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.6210269}
confusion matrix:
      0    1
0  5976   21
1   134  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 6
val acc:0.9645061492919922, best validation acc: 0.9660493731498718, corresponding to test acc:                         0.9662831425666809 / 0.9752317070960999
after epoch: 17,now: 2024-05-29 19:45:40.152302,epoch time: 0:19:35.290627,used: 6:07:36.825013,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96677476, 'precision': 0.74292576, 'recall': 0.637246, 'specificity': 0.637246, 'f1': 0.6739237, 'auroc': 0.9218123, 'binary_precision': 0.51037854, 'binary_recall': 0.2839674, 'binary_specificity': 0.9905246, 'binary_f1_score': 0.36490616}
confusion matrix:
       0    1
0  41919  401
1   1054  418
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.7369828, 'recall': 0.6409828, 'specificity': 0.6409828, 'f1': 0.67550725, 'auroc': 0.9090949, 'binary_precision': 0.49867374, 'binary_recall': 0.29237947, 'binary_specificity': 0.9895862, 'binary_f1_score': 0.36862746}
confusion matrix:
       0    1
0  17960  189
1    455  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97714925, 'precision': 0.9243717, 'recall': 0.7645326, 'specificity': 0.7645326, 'f1': 0.8242547, 'auroc': 0.9046247, 'binary_precision': 0.86875, 'binary_recall': 0.532567, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.6603325}
confusion matrix:
      0    1
0  5976   21
1   122  139
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 7
val acc:0.9657300710678101, best validation acc: 0.9660493731498718, corresponding to test acc:                         0.9662831425666809 / 0.977149248123169
after epoch: 18,now: 2024-05-29 20:05:01.462933,epoch time: 0:19:21.310631,used: 6:26:58.135644,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9661582, 'precision': 0.7307978, 'recall': 0.5798795, 'specificity': 0.5798795, 'f1': 0.6152028, 'auroc': 0.9184491, 'binary_precision': 0.48995984, 'binary_recall': 0.16576087, 'binary_specificity': 0.9939981, 'binary_f1_score': 0.24771574}
confusion matrix:
       0    1
0  42066  254
1   1228  244
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.7472755, 'recall': 0.5970602, 'specificity': 0.5970602, 'f1': 0.63633204, 'auroc': 0.91017437, 'binary_precision': 0.5222672, 'binary_recall': 0.20062208, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.28988764}
confusion matrix:
       0    1
0  18031  118
1    514  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97315437, 'precision': 0.9077819, 'recall': 0.71847224, 'specificity': 0.71847224, 'f1': 0.78201294, 'auroc': 0.89857316, 'binary_precision': 0.8394161, 'binary_recall': 0.44061303, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.5778895}
confusion matrix:
      0    1
0  5975   22
1   146  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
better model found
persisted
after epoch: 19,now: 2024-05-29 20:24:25.683962,epoch time: 0:19:24.221029,used: 6:46:22.356673,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9663409, 'precision': 0.7367956, 'recall': 0.635794, 'specificity': 0.635794, 'f1': 0.67120165, 'auroc': 0.9220357, 'binary_precision': 0.49819493, 'binary_recall': 0.28144118, 'binary_specificity': 0.99014676, 'binary_f1_score': 0.35968718}
confusion matrix:
       0    1
0  41904  417
1   1057  414
---- Validation: 
scalar performance:
{'acc': 0.9649851, 'precision': 0.72898, 'recall': 0.6503478, 'specificity': 0.6503478, 'f1': 0.6806149, 'auroc': 0.9133374, 'binary_precision': 0.4820144, 'binary_recall': 0.31259722, 'binary_specificity': 0.9880985, 'binary_f1_score': 0.3792453}
confusion matrix:
       0    1
0  17933  216
1    442  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97651005, 'precision': 0.90787375, 'recall': 0.7696961, 'specificity': 0.7696961, 'f1': 0.8233844, 'auroc': 0.9159543, 'binary_precision': 0.8352941, 'binary_recall': 0.5440613, 'binary_specificity': 0.995331, 'binary_f1_score': 0.6589327}
confusion matrix:
      0    1
0  5969   28
1   119  142
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 1
val acc:0.9649850726127625, best validation acc: 0.9663686752319336, corresponding to test acc:                         0.9731543660163879 / 0.977149248123169
after epoch: 20,now: 2024-05-29 20:43:26.770866,epoch time: 0:19:01.086904,used: 7:05:23.443577,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96666056, 'precision': 0.74236226, 'recall': 0.7001359, 'specificity': 0.7001359, 'f1': 0.71901405, 'auroc': 0.9230737, 'binary_precision': 0.5049669, 'binary_recall': 0.4144022, 'binary_specificity': 0.9858696, 'binary_f1_score': 0.4552239}
confusion matrix:
       0    1
0  41722  598
1    862  610
---- Validation: 
scalar performance:
{'acc': 0.9646126, 'precision': 0.7294861, 'recall': 0.69590837, 'specificity': 0.69590837, 'f1': 0.71121734, 'auroc': 0.9166217, 'binary_precision': 0.47985348, 'binary_recall': 0.407465, 'binary_specificity': 0.98435175, 'binary_f1_score': 0.44070646}
confusion matrix:
       0    1
0  17865  284
1    381  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97619045, 'precision': 0.8800273, 'recall': 0.7970144, 'specificity': 0.7970144, 'f1': 0.83291185, 'auroc': 0.90892196, 'binary_precision': 0.7772277, 'binary_recall': 0.6015326, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.6781857}
confusion matrix:
      0    1
0  5952   45
1   104  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 2
val acc:0.964612603187561, best validation acc: 0.9663686752319336, corresponding to test acc:                         0.9731543660163879 / 0.977149248123169
after epoch: 21,now: 2024-05-29 21:02:44.686630,epoch time: 0:19:17.915764,used: 7:24:41.359341,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96645504, 'precision': 0.73857665, 'recall': 0.64503956, 'specificity': 0.64503956, 'f1': 0.6792276, 'auroc': 0.92271554, 'binary_precision': 0.5011338, 'binary_recall': 0.30047587, 'binary_specificity': 0.9896033, 'binary_f1_score': 0.37569064}
confusion matrix:
       0    1
0  41881  440
1   1029  442
---- Validation: 
scalar performance:
{'acc': 0.965198, 'precision': 0.73247653, 'recall': 0.6662092, 'specificity': 0.6662092, 'f1': 0.6932234, 'auroc': 0.91609025, 'binary_precision': 0.4879121, 'binary_recall': 0.3452566, 'binary_specificity': 0.9871618, 'binary_f1_score': 0.4043716}
confusion matrix:
       0    1
0  17916  233
1    421  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97651005, 'precision': 0.9041777, 'recall': 0.77336085, 'specificity': 0.77336085, 'f1': 0.8249506, 'auroc': 0.9146751, 'binary_precision': 0.82758623, 'binary_recall': 0.55172414, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.66206896}
confusion matrix:
      0    1
0  5967   30
1   117  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 3
val acc:0.9651979804039001, best validation acc: 0.9663686752319336, corresponding to test acc:                         0.9731543660163879 / 0.977149248123169
after epoch: 22,now: 2024-05-29 21:22:22.084154,epoch time: 0:19:37.397524,used: 7:44:18.756865,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9670944, 'precision': 0.746547, 'recall': 0.6715087, 'specificity': 0.6715087, 'f1': 0.70159376, 'auroc': 0.9259138, 'binary_precision': 0.5153011, 'binary_recall': 0.35461956, 'binary_specificity': 0.9883979, 'binary_f1_score': 0.42012075}
confusion matrix:
       0    1
0  41829  491
1    950  522
---- Validation: 
scalar performance:
{'acc': 0.9653044, 'precision': 0.733979, 'recall': 0.6730148, 'specificity': 0.6730148, 'f1': 0.69842196, 'auroc': 0.9155493, 'binary_precision': 0.49044585, 'binary_recall': 0.3592535, 'binary_specificity': 0.9867761, 'binary_f1_score': 0.4147217}
confusion matrix:
       0    1
0  17909  240
1    412  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.90740675, 'recall': 0.7924345, 'specificity': 0.7924345, 'f1': 0.8395748, 'auroc': 0.9191652, 'binary_precision': 0.83243245, 'binary_recall': 0.5900383, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.69058293}
confusion matrix:
      0    1
0  5966   31
1   107  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 4
val acc:0.9653043746948242, best validation acc: 0.9663686752319336, corresponding to test acc:                         0.9731543660163879 / 0.9779482483863831
after epoch: 23,now: 2024-05-29 21:42:35.000722,epoch time: 0:20:12.916568,used: 8:04:31.673433,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9673685, 'precision': 0.74908465, 'recall': 0.6959121, 'specificity': 0.6959121, 'f1': 0.7189846, 'auroc': 0.9290574, 'binary_precision': 0.5187119, 'binary_recall': 0.4048913, 'binary_specificity': 0.9869329, 'binary_f1_score': 0.45478827}
confusion matrix:
       0    1
0  41767  553
1    876  596
---- Validation: 
scalar performance:
{'acc': 0.9649319, 'precision': 0.7325265, 'recall': 0.7013241, 'specificity': 0.7013241, 'f1': 0.7156731, 'auroc': 0.9197917, 'binary_precision': 0.48555955, 'binary_recall': 0.41835147, 'binary_specificity': 0.9842967, 'binary_f1_score': 0.449457}
confusion matrix:
       0    1
0  17864  285
1    374  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97762865, 'precision': 0.898162, 'recall': 0.7977648, 'specificity': 0.7977648, 'f1': 0.84001166, 'auroc': 0.9100457, 'binary_precision': 0.8134715, 'binary_recall': 0.6015326, 'binary_specificity': 0.993997, 'binary_f1_score': 0.69163}
confusion matrix:
      0    1
0  5961   36
1   104  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 5
val acc:0.9649319052696228, best validation acc: 0.9663686752319336, corresponding to test acc:                         0.9731543660163879 / 0.9779482483863831
after epoch: 24,now: 2024-05-29 22:02:01.668058,epoch time: 0:19:26.667336,used: 8:23:58.340769,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96663773, 'precision': 0.7419915, 'recall': 0.69291115, 'specificity': 0.69291115, 'f1': 0.7143812, 'auroc': 0.9254148, 'binary_precision': 0.50472105, 'binary_recall': 0.39945653, 'binary_specificity': 0.9863658, 'binary_f1_score': 0.44596133}
confusion matrix:
       0    1
0  41743  577
1    884  588
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.73749834, 'recall': 0.7121003, 'specificity': 0.7121003, 'f1': 0.7239994, 'auroc': 0.9179451, 'binary_precision': 0.49475524, 'binary_recall': 0.44012442, 'binary_specificity': 0.98407626, 'binary_f1_score': 0.46584362}
confusion matrix:
       0    1
0  17860  289
1    360  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97762865, 'precision': 0.898162, 'recall': 0.7977648, 'specificity': 0.7977648, 'f1': 0.84001166, 'auroc': 0.9144746, 'binary_precision': 0.8134715, 'binary_recall': 0.6015326, 'binary_specificity': 0.993997, 'binary_f1_score': 0.69163}
confusion matrix:
      0    1
0  5961   36
1   104  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 6
val acc:0.9654640555381775, best validation acc: 0.9663686752319336, corresponding to test acc:                         0.9731543660163879 / 0.9779482483863831
after epoch: 25,now: 2024-05-29 22:20:57.283262,epoch time: 0:18:55.615204,used: 8:42:53.955973,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9674598, 'precision': 0.74991596, 'recall': 0.69989365, 'specificity': 0.69989365, 'f1': 0.72182786, 'auroc': 0.92300016, 'binary_precision': 0.5201027, 'binary_recall': 0.41304347, 'binary_specificity': 0.98674387, 'binary_f1_score': 0.4604317}
confusion matrix:
       0    1
0  41759  561
1    864  608
---- Validation: 
scalar performance:
{'acc': 0.9650915, 'precision': 0.7348659, 'recall': 0.7179079, 'specificity': 0.7179079, 'f1': 0.72603214, 'auroc': 0.9170995, 'binary_precision': 0.48907563, 'binary_recall': 0.4525661, 'binary_specificity': 0.9832498, 'binary_f1_score': 0.4701131}
confusion matrix:
       0    1
0  17845  304
1    352  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97778845, 'precision': 0.8957071, 'recall': 0.80334514, 'specificity': 0.80334514, 'f1': 0.8428196, 'auroc': 0.9258882, 'binary_precision': 0.8080808, 'binary_recall': 0.6130268, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.69716775}
confusion matrix:
      0    1
0  5959   38
1   101  160
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 7
val acc:0.9650915265083313, best validation acc: 0.9663686752319336, corresponding to test acc:                         0.9731543660163879 / 0.9779482483863831
after epoch: 26,now: 2024-05-29 22:40:31.013167,epoch time: 0:19:33.729905,used: 9:02:27.685878,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96675193, 'precision': 0.743479, 'recall': 0.7149368, 'specificity': 0.7149368, 'f1': 0.728221, 'auroc': 0.9264208, 'binary_precision': 0.5061824, 'binary_recall': 0.4449728, 'binary_specificity': 0.9849008, 'binary_f1_score': 0.4736081}
confusion matrix:
       0    1
0  41681  639
1    817  655
---- Validation: 
scalar performance:
{'acc': 0.9653044, 'precision': 0.73751956, 'recall': 0.73751956, 'specificity': 0.73751956, 'f1': 0.73751956, 'auroc': 0.91850513, 'binary_precision': 0.49300155, 'binary_recall': 0.49300155, 'binary_specificity': 0.9820376, 'binary_f1_score': 0.49300155}
confusion matrix:
       0    1
0  17823  326
1    326  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97698945, 'precision': 0.8806051, 'recall': 0.8102576, 'specificity': 0.8102576, 'f1': 0.84147954, 'auroc': 0.92306244, 'binary_precision': 0.7772512, 'binary_recall': 0.62835246, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.69491524}
confusion matrix:
      0    1
0  5950   47
1    97  164
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 8
val acc:0.9653043746948242, best validation acc: 0.9663686752319336, corresponding to test acc:                         0.9731543660163879 / 0.9779482483863831
after epoch: 27,now: 2024-05-29 22:59:50.339377,epoch time: 0:19:19.326210,used: 9:21:47.012088,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9664779, 'precision': 0.7408787, 'recall': 0.7059428, 'specificity': 0.7059428, 'f1': 0.7218938, 'auroc': 0.93012094, 'binary_precision': 0.50159746, 'binary_recall': 0.42663044, 'binary_specificity': 0.9852552, 'binary_f1_score': 0.46108663}
confusion matrix:
       0    1
0  41696  624
1    844  628
---- Validation: 
scalar performance:
{'acc': 0.9649851, 'precision': 0.73418736, 'recall': 0.720103, 'specificity': 0.720103, 'f1': 0.7269012, 'auroc': 0.91956645, 'binary_precision': 0.48756218, 'binary_recall': 0.45723173, 'binary_specificity': 0.9829743, 'binary_f1_score': 0.4719101}
confusion matrix:
       0    1
0  17840  309
1    349  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9787472, 'precision': 0.9067031, 'recall': 0.8056778, 'specificity': 0.8056778, 'f1': 0.8483325, 'auroc': 0.91404563, 'binary_precision': 0.8298969, 'binary_recall': 0.61685824, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.70769227}
confusion matrix:
      0    1
0  5964   33
1   100  161
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 9
val acc:0.9649850726127625, best validation acc: 0.9663686752319336, corresponding to test acc:                         0.9731543660163879 / 0.9787471890449524
after epoch: 28,now: 2024-05-29 23:19:05.903470,epoch time: 0:19:15.564093,used: 9:41:02.576181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9668661, 'precision': 0.7440635, 'recall': 0.7006995, 'specificity': 0.7006995, 'f1': 0.72003794, 'auroc': 0.9294585, 'binary_precision': 0.5083195, 'binary_recall': 0.4153637, 'binary_specificity': 0.9860353, 'binary_f1_score': 0.4571643}
confusion matrix:
       0    1
0  41730  591
1    860  611
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.7382701, 'recall': 0.71962845, 'specificity': 0.71962845, 'f1': 0.7285259, 'auroc': 0.9213502, 'binary_precision': 0.4957699, 'binary_recall': 0.45567653, 'binary_specificity': 0.98358035, 'binary_f1_score': 0.47487843}
confusion matrix:
       0    1
0  17851  298
1    350  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.978907, 'precision': 0.90405566, 'recall': 0.8112581, 'specificity': 0.8112581, 'f1': 0.8510473, 'auroc': 0.9128006, 'binary_precision': 0.8241206, 'binary_recall': 0.62835246, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.71304345}
confusion matrix:
      0    1
0  5962   35
1    97  164
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 10
val acc:0.9655172228813171, best validation acc: 0.9663686752319336, corresponding to test acc:                         0.9731543660163879 / 0.9789069890975952
after epoch: 29,now: 2024-05-29 23:38:29.719937,epoch time: 0:19:23.816467,used: 10:00:26.392648,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96684325, 'precision': 0.74402976, 'recall': 0.71217084, 'specificity': 0.71217084, 'f1': 0.7268654, 'auroc': 0.9310428, 'binary_precision': 0.5074627, 'binary_recall': 0.43915704, 'binary_specificity': 0.98518467, 'binary_f1_score': 0.47084546}
confusion matrix:
       0    1
0  41694  627
1    825  646
---- Validation: 
scalar performance:
{'acc': 0.965198, 'precision': 0.7360663, 'recall': 0.72471356, 'specificity': 0.72471356, 'f1': 0.7302336, 'auroc': 0.9234771, 'binary_precision': 0.49099836, 'binary_recall': 0.466563, 'binary_specificity': 0.9828641, 'binary_f1_score': 0.4784689}
confusion matrix:
       0    1
0  17838  311
1    343  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97714925, 'precision': 0.88634884, 'recall': 0.804844, 'specificity': 0.804844, 'f1': 0.8403034, 'auroc': 0.9180951, 'binary_precision': 0.7892157, 'binary_recall': 0.61685824, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.6924731}
confusion matrix:
      0    1
0  5954   43
1   100  161
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 11
val acc:0.9651979804039001, best validation acc: 0.9663686752319336, corresponding to test acc:                         0.9731543660163879 / 0.9789069890975952
after epoch: 30,now: 2024-05-29 23:57:41.963876,epoch time: 0:19:12.243939,used: 10:19:38.636587,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:19:38.636587 at 2024-05-29 23:57:41.963876
persisted model performance metric: 

scalar performance:
{'acc': 0.9741131, 'precision': 0.90707624, 'recall': 0.7336312, 'specificity': 0.7336312, 'f1': 0.79478073, 'auroc': 0.9203216, 'binary_precision': 0.8367347, 'binary_recall': 0.47126436, 'binary_specificity': 0.995998, 'binary_f1_score': 0.60294116}
confusion matrix:
      0    1
0  5973   24
1   138  123
oracle model performance metric: 

scalar performance:
{'acc': 0.97762865, 'precision': 0.8936753, 'recall': 0.80326176, 'specificity': 0.80326176, 'f1': 0.84201986, 'auroc': 0.92241186, 'binary_precision': 0.8040201, 'binary_recall': 0.6130268, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.6956521}
confusion matrix:
      0    1
0  5958   39
1   101  160
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/10.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494363 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool | 404544 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |  89819 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 494363 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool | 404544 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |  89819 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  10961 MiB |   1653 TiB |   1653 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   1651 TiB |   1651 TiB |
|       from small pool |  88733 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11226 MiB |  11226 MiB |  11226 MiB |      0 B   |
|       from large pool |  11100 MiB |  11100 MiB |  11100 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1339 MiB |   1726 MiB | 593349 GiB | 593348 GiB |
|       from large pool |   1332 MiB |   1724 MiB | 590410 GiB | 590408 GiB |
|       from small pool |      6 MiB |      8 MiB |   2939 GiB |   2939 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6720    |  137771 K  |  137767 K  |
|       from large pool |      87    |     909    |   64894 K  |   64894 K  |
|       from small pool |    3642    |    6631    |   72876 K  |   72873 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6720    |  137771 K  |  137767 K  |
|       from large pool |      87    |     909    |   64894 K  |   64894 K  |
|       from small pool |    3642    |    6631    |   72876 K  |   72873 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     232    |     232    |     232    |       0    |
|       from large pool |     169    |     169    |     169    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |    2768    |   70614 K  |   70614 K  |
|       from large pool |      20    |      59    |   32177 K  |   32177 K  |
|       from small pool |      50    |    2747    |   38437 K  |   38437 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1653 TiB |   1653 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1651 TiB |   1651 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1822 MiB |  11226 MiB |  11226 MiB |   9404 MiB |
|       from large pool |   1728 MiB |  11100 MiB |  11100 MiB |   9372 MiB |
|       from small pool |     94 MiB |    126 MiB |    126 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1726 MiB | 593350 GiB | 593350 GiB |
|       from large pool | 134912 KiB |   1724 MiB | 590410 GiB | 590410 GiB |
|       from small pool |      0 KiB |     20 MiB |   2939 GiB |   2939 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  137771 K  |  137771 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72876 K  |   72876 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  137771 K  |  137771 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72876 K  |   72876 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      77    |     232    |     232    |     155    |
|       from large pool |      30    |     169    |     169    |     139    |
|       from small pool |      47    |      63    |      63    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |   70616 K  |   70616 K  |
|       from large pool |       4    |      59    |   32177 K  |   32177 K  |
|       from small pool |       0    |    2747    |   38438 K  |   38438 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1653 TiB |   1653 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1651 TiB |   1651 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1822 MiB |  11226 MiB |  11226 MiB |   9404 MiB |
|       from large pool |   1728 MiB |  11100 MiB |  11100 MiB |   9372 MiB |
|       from small pool |     94 MiB |    126 MiB |    126 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1726 MiB | 593350 GiB | 593350 GiB |
|       from large pool | 134912 KiB |   1724 MiB | 590410 GiB | 590410 GiB |
|       from small pool |      0 KiB |     20 MiB |   2939 GiB |   2939 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  137771 K  |  137771 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72876 K  |   72876 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  137771 K  |  137771 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72876 K  |   72876 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      77    |     232    |     232    |     155    |
|       from large pool |      30    |     169    |     169    |     139    |
|       from small pool |      47    |      63    |      63    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |   70616 K  |   70616 K  |
|       from large pool |       4    |      59    |   32177 K  |   32177 K  |
|       from small pool |       0    |    2747    |   38438 K  |   38438 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754

 Experiment start at: 2024-05-30 00:07:46.233165
before training, model accuracy: 0.09458588808774948
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.89755106, 'precision': 0.50132585, 'recall': 0.50288755, 'specificity': 0.50288755, 'f1': 0.49747977, 'auroc': 0.4753975, 'binary_precision': 0.035333537, 'binary_recall': 0.08044383, 'binary_specificity': 0.92533123, 'binary_f1_score': 0.04910053}
confusion matrix:
       0     1
0  39247  3167
1   1326   116
---- Validation: 
scalar performance:
{'acc': 0.7860192, 'precision': 0.50657445, 'recall': 0.52996, 'specificity': 0.52996, 'f1': 0.47876945, 'auroc': 0.48267728, 'binary_precision': 0.046480022, 'binary_recall': 0.25408617, 'binary_specificity': 0.8058338, 'binary_f1_score': 0.07858456}
confusion matrix:
       0     1
0  14559  3508
1    502   171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90686435, 'precision': 0.48747757, 'recall': 0.48429328, 'specificity': 0.48429328, 'f1': 0.48572356, 'auroc': 0.39582765, 'binary_precision': 0.018181818, 'binary_recall': 0.023076924, 'binary_specificity': 0.9455096, 'binary_f1_score': 0.020338982}
confusion matrix:
      0    1
0  5622  324
1   254    6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-30 00:27:54.983162,epoch time: 0:20:08.749997,used: 0:20:08.749997,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9618752, 'precision': 0.57622546, 'recall': 0.5197304, 'specificity': 0.5197304, 'f1': 0.527367, 'auroc': 0.644017, 'binary_precision': 0.18406594, 'binary_recall': 0.046463244, 'binary_specificity': 0.9929976, 'binary_f1_score': 0.07419712}
confusion matrix:
       0    1
0  42117  297
1   1375   67
---- Validation: 
scalar performance:
{'acc': 0.9485059, 'precision': 0.5653545, 'recall': 0.5427029, 'specificity': 0.5427029, 'f1': 0.55087197, 'auroc': 0.6101786, 'binary_precision': 0.16359447, 'binary_recall': 0.10549777, 'binary_specificity': 0.9799081, 'binary_f1_score': 0.12827462}
confusion matrix:
       0    1
0  17704  363
1    602   71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9531099, 'precision': 0.49417305, 'recall': 0.4992322, 'specificity': 0.4992322, 'f1': 0.49140704, 'auroc': 0.54145175, 'binary_precision': 0.030303031, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.006825939}
confusion matrix:
      0   1
0  5914  32
1   259   1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-30 00:47:14.456800,epoch time: 0:19:19.473638,used: 0:39:28.223635,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9671653, 'precision': 0.74250126, 'recall': 0.5100721, 'specificity': 0.5100721, 'f1': 0.5116485, 'auroc': 0.7530508, 'binary_precision': 0.51724136, 'binary_recall': 0.020804439, 'binary_specificity': 0.9993398, 'binary_f1_score': 0.04}
confusion matrix:
       0   1
0  42386  28
1   1412  30
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.6952995, 'recall': 0.51411164, 'specificity': 0.51411164, 'f1': 0.5185286, 'auroc': 0.7299436, 'binary_precision': 0.42553192, 'binary_recall': 0.029717682, 'binary_specificity': 0.9985056, 'binary_f1_score': 0.055555552}
confusion matrix:
       0   1
0  18040  27
1    653  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.81253695, 'recall': 0.50376207, 'specificity': 0.50376207, 'f1': 0.49694523, 'auroc': 0.7314355, 'binary_precision': 0.6666667, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5945  1
1   258  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-30 01:06:20.898294,epoch time: 0:19:06.441494,used: 0:58:34.665129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96702844, 'precision': 0.7059511, 'recall': 0.5053121, 'specificity': 0.5053121, 'f1': 0.5024413, 'auroc': 0.8188344, 'binary_precision': 0.44444445, 'binary_recall': 0.011095701, 'binary_specificity': 0.99952847, 'binary_f1_score': 0.021650879}
confusion matrix:
       0   1
0  42394  20
1   1426  16
---- Validation: 
scalar performance:
{'acc': 0.9638207, 'precision': 0.6822869, 'recall': 0.5070143, 'specificity': 0.5070143, 'f1': 0.50511014, 'auroc': 0.7935503, 'binary_precision': 0.4, 'binary_recall': 0.014858841, 'binary_specificity': 0.99916977, 'binary_f1_score': 0.028653294}
confusion matrix:
       0   1
0  18052  15
1    663  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.97912973, 'recall': 0.5019231, 'specificity': 0.5019231, 'f1': 0.49317387, 'auroc': 0.8057416, 'binary_precision': 1.0, 'binary_recall': 0.0038461538, 'binary_specificity': 1.0, 'binary_f1_score': 0.007662835}
confusion matrix:
      0  1
0  5946  0
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
better model found
persisted
after epoch: 4,now: 2024-05-30 01:25:42.581143,epoch time: 0:19:21.682849,used: 1:17:56.347978,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96723366, 'precision': 0.82981145, 'recall': 0.5030735, 'specificity': 0.5030735, 'f1': 0.4978558, 'auroc': 0.8383454, 'binary_precision': 0.6923077, 'binary_recall': 0.0062413313, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.012371134}
confusion matrix:
       0  1
0  42410  4
1   1433  9
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.73221725, 'recall': 0.50500685, 'specificity': 0.50500685, 'f1': 0.50104344, 'auroc': 0.82564855, 'binary_precision': 0.5, 'binary_recall': 0.010401188, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.020378456}
confusion matrix:
       0  1
0  18060  7
1    666  7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.9792069, 'recall': 0.50384617, 'specificity': 0.50384617, 'f1': 0.4970163, 'auroc': 0.81912017, 'binary_precision': 1.0, 'binary_recall': 0.0076923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.015267175}
confusion matrix:
      0  1
0  5946  0
1   258  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-05-30 01:45:03.793223,epoch time: 0:19:21.212080,used: 1:37:17.560058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9672109, 'precision': 0.7721827, 'recall': 0.50507146, 'specificity': 0.50507146, 'f1': 0.5018812, 'auroc': 0.85718834, 'binary_precision': 0.5769231, 'binary_recall': 0.010402219, 'binary_specificity': 0.99974066, 'binary_f1_score': 0.020435968}
confusion matrix:
       0   1
0  42403  11
1   1427  15
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.6487819, 'recall': 0.50206274, 'specificity': 0.50206274, 'f1': 0.49521354, 'auroc': 0.85908633, 'binary_precision': 0.33333334, 'binary_recall': 0.004457652, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.008797654}
confusion matrix:
       0  1
0  18061  6
1    670  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8382597, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 1
val acc:0.9639274477958679, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9584273099899292 / 0.9584273099899292
after epoch: 6,now: 2024-05-30 02:04:15.339127,epoch time: 0:19:11.545904,used: 1:56:29.105962,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9673705, 'precision': 0.7603737, 'recall': 0.5195569, 'specificity': 0.5195569, 'f1': 0.5291881, 'auroc': 0.87620974, 'binary_precision': 0.552381, 'binary_recall': 0.040221915, 'binary_specificity': 0.9988919, 'binary_f1_score': 0.07498384}
confusion matrix:
       0   1
0  42367  47
1   1384  58
---- Validation: 
scalar performance:
{'acc': 0.96542156, 'precision': 0.7881599, 'recall': 0.55076057, 'specificity': 0.55076057, 'f1': 0.58000225, 'auroc': 0.8768781, 'binary_precision': 0.6086956, 'binary_recall': 0.104011886, 'binary_specificity': 0.9975093, 'binary_f1_score': 0.17766497}
confusion matrix:
       0   1
0  18022  45
1    603  70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.9085456, 'recall': 0.52290875, 'specificity': 0.52290875, 'f1': 0.5334974, 'auroc': 0.8705187, 'binary_precision': 0.85714287, 'binary_recall': 0.046153847, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.087591246}
confusion matrix:
      0   1
0  5944   2
1   248  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-05-30 02:23:31.463457,epoch time: 0:19:16.124330,used: 2:15:45.230292,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9675529, 'precision': 0.8235735, 'recall': 0.51228225, 'specificity': 0.51228225, 'f1': 0.51582783, 'auroc': 0.87956107, 'binary_precision': 0.6792453, 'binary_recall': 0.024965325, 'binary_specificity': 0.9995992, 'binary_f1_score': 0.04816053}
confusion matrix:
       0   1
0  42397  17
1   1406  36
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.7775159, 'recall': 0.52388054, 'specificity': 0.52388054, 'f1': 0.5362474, 'auroc': 0.8732915, 'binary_precision': 0.58928573, 'binary_recall': 0.049034175, 'binary_specificity': 0.99872696, 'binary_f1_score': 0.09053498}
confusion matrix:
       0   1
0  18044  23
1    640  33
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.9795935, 'recall': 0.51346153, 'specificity': 0.51346153, 'f1': 0.5158014, 'auroc': 0.8619305, 'binary_precision': 1.0, 'binary_recall': 0.026923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.05243446}
confusion matrix:
      0  1
0  5946  0
1   253  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 1
val acc:0.9646211266517639, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9597163796424866 / 0.9597163796424866
after epoch: 8,now: 2024-05-30 02:42:46.234472,epoch time: 0:19:14.771015,used: 2:35:00.001307,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9677353, 'precision': 0.7674308, 'recall': 0.5395077, 'specificity': 0.5395077, 'f1': 0.5627314, 'auroc': 0.89199525, 'binary_precision': 0.5652174, 'binary_recall': 0.08113731, 'binary_specificity': 0.9978781, 'binary_f1_score': 0.14190419}
confusion matrix:
       0    1
0  42324   90
1   1325  117
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.76088095, 'recall': 0.5677333, 'specificity': 0.5677333, 'f1': 0.60256743, 'auroc': 0.8906826, 'binary_precision': 0.5529412, 'binary_recall': 0.1396731, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.22301304}
confusion matrix:
       0   1
0  17991  76
1    579  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8841975, 'recall': 0.5475724, 'specificity': 0.5475724, 'f1': 0.5759692, 'auroc': 0.8823296, 'binary_precision': 0.8064516, 'binary_recall': 0.09615385, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.1718213}
confusion matrix:
      0   1
0  5940   6
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 2
val acc:0.9650480151176453, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9597163796424866 / 0.9611666202545166
after epoch: 9,now: 2024-05-30 03:02:07.158566,epoch time: 0:19:20.924094,used: 2:54:20.925401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9672109, 'precision': 0.7395972, 'recall': 0.5245045, 'specificity': 0.5245045, 'f1': 0.53773785, 'auroc': 0.8965555, 'binary_precision': 0.5104895, 'binary_recall': 0.050659265, 'binary_specificity': 0.99834967, 'binary_f1_score': 0.09217173}
confusion matrix:
       0   1
0  42345  70
1   1368  73
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.7603822, 'recall': 0.5648445, 'specificity': 0.5648445, 'f1': 0.59870446, 'auroc': 0.8975543, 'binary_precision': 0.5521472, 'binary_recall': 0.13372956, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.21531099}
confusion matrix:
       0   1
0  17994  73
1    583  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.88450956, 'recall': 0.53996414, 'specificity': 0.53996414, 'f1': 0.5633656, 'auroc': 0.900641, 'binary_precision': 0.8076923, 'binary_recall': 0.08076923, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.14685315}
confusion matrix:
      0   1
0  5941   5
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 3
val acc:0.9649946689605713, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9597163796424866 / 0.9611666202545166
after epoch: 10,now: 2024-05-30 03:21:15.714639,epoch time: 0:19:08.556073,used: 3:13:29.481474,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96684605, 'precision': 0.7207582, 'recall': 0.53402364, 'specificity': 0.53402364, 'f1': 0.55307174, 'auroc': 0.89655566, 'binary_precision': 0.4722222, 'binary_recall': 0.07073509, 'binary_specificity': 0.9973122, 'binary_f1_score': 0.123039804}
confusion matrix:
       0    1
0  42300  114
1   1340  102
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.75979614, 'recall': 0.5749136, 'specificity': 0.5749136, 'f1': 0.6117196, 'auroc': 0.897197, 'binary_precision': 0.55026454, 'binary_recall': 0.15453194, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.24129929}
confusion matrix:
       0    1
0  17982   85
1    569  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.95768595, 'recall': 0.57483184, 'specificity': 0.57483184, 'f1': 0.62036157, 'auroc': 0.8914881, 'binary_precision': 0.9512195, 'binary_recall': 0.15, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.2591362}
confusion matrix:
      0   1
0  5944   2
1   221  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 4
val acc:0.9651013612747192, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9597163796424866 / 0.9640670418739319
after epoch: 11,now: 2024-05-30 03:40:39.829701,epoch time: 0:19:24.115062,used: 3:32:53.596536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96639, 'precision': 0.7142424, 'recall': 0.5575695, 'specificity': 0.5575695, 'f1': 0.58647436, 'auroc': 0.90658236, 'binary_precision': 0.45767197, 'binary_recall': 0.11997226, 'binary_specificity': 0.9951667, 'binary_f1_score': 0.1901099}
confusion matrix:
       0    1
0  42209  205
1   1269  173
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.74716014, 'recall': 0.62055236, 'specificity': 0.62055236, 'f1': 0.6598131, 'auroc': 0.9040008, 'binary_precision': 0.5217391, 'binary_recall': 0.24962853, 'binary_specificity': 0.9914762, 'binary_f1_score': 0.33768845}
confusion matrix:
       0    1
0  17913  154
1    505  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.92686546, 'recall': 0.6051806, 'specificity': 0.6051806, 'f1': 0.6620399, 'auroc': 0.8924552, 'binary_precision': 0.88709676, 'binary_recall': 0.21153846, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.34161493}
confusion matrix:
      0   1
0  5939   7
1   205  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 5
val acc:0.9648345708847046, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9597163796424866 / 0.9658395051956177
after epoch: 12,now: 2024-05-30 04:00:01.816461,epoch time: 0:19:21.986760,used: 3:52:15.583296,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96702844, 'precision': 0.73233527, 'recall': 0.55521995, 'specificity': 0.55521995, 'f1': 0.58449215, 'auroc': 0.9054667, 'binary_precision': 0.49401197, 'binary_recall': 0.11442441, 'binary_specificity': 0.9960155, 'binary_f1_score': 0.18581082}
confusion matrix:
       0    1
0  42245  169
1   1277  165
---- Validation: 
scalar performance:
{'acc': 0.9654749, 'precision': 0.7620957, 'recall': 0.5972806, 'specificity': 0.5972806, 'f1': 0.63837147, 'auroc': 0.9044739, 'binary_precision': 0.5532787, 'binary_recall': 0.20059435, 'binary_specificity': 0.9939669, 'binary_f1_score': 0.2944384}
confusion matrix:
       0    1
0  17958  109
1    538  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.9365548, 'recall': 0.5938103, 'specificity': 0.5938103, 'f1': 0.6471239, 'auroc': 0.90935826, 'binary_precision': 0.9074074, 'binary_recall': 0.18846154, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.31210193}
confusion matrix:
      0   1
0  5941   5
1   211  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
better model found
persisted
after epoch: 13,now: 2024-05-30 04:19:32.717894,epoch time: 0:19:30.901433,used: 4:11:46.484729,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9672109, 'precision': 0.73827934, 'recall': 0.58479005, 'specificity': 0.58479005, 'f1': 0.62176096, 'auroc': 0.9070401, 'binary_precision': 0.50398403, 'binary_recall': 0.17545076, 'binary_specificity': 0.9941293, 'binary_f1_score': 0.26028806}
confusion matrix:
       0    1
0  42165  249
1   1189  253
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.74890035, 'recall': 0.6306491, 'specificity': 0.6306491, 'f1': 0.6694352, 'auroc': 0.9069115, 'binary_precision': 0.52449566, 'binary_recall': 0.2704309, 'binary_specificity': 0.9908673, 'binary_f1_score': 0.35686275}
confusion matrix:
       0    1
0  17902  165
1    491  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96745086, 'precision': 0.90718293, 'recall': 0.6354453, 'specificity': 0.6354453, 'f1': 0.69802606, 'auroc': 0.8933828, 'binary_precision': 0.8452381, 'binary_recall': 0.27307692, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.4127907}
confusion matrix:
      0   1
0  5933  13
1   189  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 1
val acc:0.9649946689605713, best validation acc: 0.9654749035835266, corresponding to test acc:                         0.9651950001716614 / 0.9674508571624756
after epoch: 14,now: 2024-05-30 04:38:58.094585,epoch time: 0:19:25.376691,used: 4:31:11.861420,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9662988, 'precision': 0.71505564, 'recall': 0.566566, 'specificity': 0.566566, 'f1': 0.59788656, 'auroc': 0.9097209, 'binary_precision': 0.4587156, 'binary_recall': 0.13869625, 'binary_specificity': 0.9944358, 'binary_f1_score': 0.21299253}
confusion matrix:
       0    1
0  42178  236
1   1242  200
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.74451625, 'recall': 0.627622, 'specificity': 0.627622, 'f1': 0.6657747, 'auroc': 0.908118, 'binary_precision': 0.51594204, 'binary_recall': 0.26448736, 'binary_specificity': 0.99075663, 'binary_f1_score': 0.3497053}
confusion matrix:
       0    1
0  17900  167
1    495  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96825653, 'precision': 0.9390454, 'recall': 0.63402677, 'specificity': 0.63402677, 'f1': 0.6995578, 'auroc': 0.8907876, 'binary_precision': 0.90909094, 'binary_recall': 0.26923078, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.41543028}
confusion matrix:
      0   1
0  5939   7
1   190  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 2
val acc:0.9646744728088379, best validation acc: 0.9654749035835266, corresponding to test acc:                         0.9651950001716614 / 0.9682565331459045
after epoch: 15,now: 2024-05-30 04:58:13.665572,epoch time: 0:19:15.570987,used: 4:50:27.432407,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9671653, 'precision': 0.7369286, 'recall': 0.5639994, 'specificity': 0.5639994, 'f1': 0.596447, 'auroc': 0.9111465, 'binary_precision': 0.5026316, 'binary_recall': 0.13245492, 'binary_specificity': 0.9955439, 'binary_f1_score': 0.2096597}
confusion matrix:
       0    1
0  42225  189
1   1251  191
---- Validation: 
scalar performance:
{'acc': 0.96558166, 'precision': 0.7604948, 'recall': 0.61307186, 'specificity': 0.61307186, 'f1': 0.65488166, 'auroc': 0.90804553, 'binary_precision': 0.548951, 'binary_recall': 0.2332838, 'binary_specificity': 0.9928599, 'binary_f1_score': 0.32742438}
confusion matrix:
       0    1
0  17938  129
1    516  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9666452, 'precision': 0.9106823, 'recall': 0.6221519, 'specificity': 0.6221519, 'f1': 0.68247473, 'auroc': 0.9034755, 'binary_precision': 0.85333335, 'binary_recall': 0.24615385, 'binary_specificity': 0.99815, 'binary_f1_score': 0.38208956}
confusion matrix:
      0   1
0  5935  11
1   196  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
better model found
persisted
after epoch: 16,now: 2024-05-30 05:17:40.152152,epoch time: 0:19:26.486580,used: 5:09:53.918987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9664584, 'precision': 0.727989, 'recall': 0.62225056, 'specificity': 0.62225056, 'f1': 0.6575357, 'auroc': 0.91632354, 'binary_precision': 0.48094612, 'binary_recall': 0.25381416, 'binary_specificity': 0.990687, 'binary_f1_score': 0.3322742}
confusion matrix:
       0    1
0  42019  395
1   1076  366
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.74297017, 'recall': 0.7083642, 'specificity': 0.7083642, 'f1': 0.7241833, 'auroc': 0.9173943, 'binary_precision': 0.5069686, 'binary_recall': 0.43239227, 'binary_specificity': 0.9843361, 'binary_f1_score': 0.46672013}
confusion matrix:
       0    1
0  17784  283
1    382  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97147924, 'precision': 0.898182, 'recall': 0.70191205, 'specificity': 0.70191205, 'f1': 0.76513267, 'auroc': 0.90846854, 'binary_precision': 0.8217054, 'binary_recall': 0.4076923, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.54498714}
confusion matrix:
      0    1
0  5923   23
1   154  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 1
val acc:0.964514434337616, best validation acc: 0.9655816555023193, corresponding to test acc:                         0.9666451811790466 / 0.9714792370796204
after epoch: 17,now: 2024-05-30 05:37:06.468016,epoch time: 0:19:26.315864,used: 5:29:20.234851,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96698284, 'precision': 0.7351191, 'recall': 0.6151528, 'specificity': 0.6151528, 'f1': 0.65258837, 'auroc': 0.9195092, 'binary_precision': 0.49567723, 'binary_recall': 0.23855756, 'binary_specificity': 0.99174803, 'binary_f1_score': 0.3220974}
confusion matrix:
       0    1
0  42064  350
1   1098  344
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.74902606, 'recall': 0.67221767, 'specificity': 0.67221767, 'f1': 0.70284414, 'auroc': 0.9139307, 'binary_precision': 0.5217391, 'binary_recall': 0.35661218, 'binary_specificity': 0.9878231, 'binary_f1_score': 0.423654}
confusion matrix:
       0    1
0  17847  220
1    433  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9730905, 'precision': 0.9295769, 'recall': 0.704592, 'specificity': 0.704592, 'f1': 0.77389944, 'auroc': 0.9089394, 'binary_precision': 0.88429755, 'binary_recall': 0.41153845, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.5616798}
confusion matrix:
      0    1
0  5932   14
1   153  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 2
val acc:0.965154767036438, best validation acc: 0.9655816555023193, corresponding to test acc:                         0.9666451811790466 / 0.9730905294418335
after epoch: 18,now: 2024-05-30 05:56:25.185661,epoch time: 0:19:18.717645,used: 5:48:38.952496,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96654963, 'precision': 0.725301, 'recall': 0.5894724, 'specificity': 0.5894724, 'f1': 0.6252413, 'auroc': 0.91670406, 'binary_precision': 0.47771835, 'binary_recall': 0.18585297, 'binary_specificity': 0.9930919, 'binary_f1_score': 0.2675986}
confusion matrix:
       0    1
0  42121  293
1   1174  268
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.7474769, 'recall': 0.6449268, 'specificity': 0.6449268, 'f1': 0.6813664, 'auroc': 0.91423804, 'binary_precision': 0.52061856, 'binary_recall': 0.30014858, 'binary_specificity': 0.98970497, 'binary_f1_score': 0.38077283}
confusion matrix:
       0    1
0  17881  186
1    471  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97147924, 'precision': 0.9235653, 'recall': 0.6853612, 'specificity': 0.6853612, 'f1': 0.7541056, 'auroc': 0.9016876, 'binary_precision': 0.8738739, 'binary_recall': 0.37307692, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.522911}
confusion matrix:
      0   1
0  5932  14
1   163  97
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 3
val acc:0.9649413228034973, best validation acc: 0.9655816555023193, corresponding to test acc:                         0.9666451811790466 / 0.9730905294418335
after epoch: 19,now: 2024-05-30 06:15:44.519750,epoch time: 0:19:19.334089,used: 6:07:58.286585,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9673477, 'precision': 0.7409913, 'recall': 0.6230453, 'specificity': 0.6230453, 'f1': 0.661067, 'auroc': 0.91679627, 'binary_precision': 0.5069061, 'binary_recall': 0.25450763, 'binary_specificity': 0.991583, 'binary_f1_score': 0.3388735}
confusion matrix:
       0    1
0  42057  357
1   1075  367
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.74618566, 'recall': 0.67494035, 'specificity': 0.67494035, 'f1': 0.7038596, 'auroc': 0.91544163, 'binary_precision': 0.51585627, 'binary_recall': 0.3625557, 'binary_specificity': 0.98732495, 'binary_f1_score': 0.42582896}
confusion matrix:
       0    1
0  17838  229
1    429  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9727683, 'precision': 0.9195021, 'recall': 0.70626277, 'specificity': 0.70626277, 'f1': 0.77349365, 'auroc': 0.90750813, 'binary_precision': 0.864, 'binary_recall': 0.41538462, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.561039}
confusion matrix:
      0    1
0  5929   17
1   152  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 4
val acc:0.9648879170417786, best validation acc: 0.9655816555023193, corresponding to test acc:                         0.9666451811790466 / 0.9730905294418335
after epoch: 20,now: 2024-05-30 06:35:02.104646,epoch time: 0:19:17.584896,used: 6:27:15.871481,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9677125, 'precision': 0.74604774, 'recall': 0.643666, 'specificity': 0.643666, 'f1': 0.68009377, 'auroc': 0.9202075, 'binary_precision': 0.51566267, 'binary_recall': 0.29680997, 'binary_specificity': 0.990522, 'binary_f1_score': 0.37676054}
confusion matrix:
       0    1
0  42012  402
1   1014  428
---- Validation: 
scalar performance:
{'acc': 0.9653148, 'precision': 0.7503346, 'recall': 0.68374497, 'specificity': 0.68374497, 'f1': 0.7113611, 'auroc': 0.91723895, 'binary_precision': 0.5235174, 'binary_recall': 0.38038632, 'binary_specificity': 0.9871036, 'binary_f1_score': 0.44061962}
confusion matrix:
       0    1
0  17834  233
1    417  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97454077, 'precision': 0.92860544, 'recall': 0.7255776, 'specificity': 0.7255776, 'f1': 0.7929189, 'auroc': 0.9027918, 'binary_precision': 0.880597, 'binary_recall': 0.45384616, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.5989848}
confusion matrix:
      0    1
0  5930   16
1   142  118
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 5
val acc:0.9653148055076599, best validation acc: 0.9655816555023193, corresponding to test acc:                         0.9666451811790466 / 0.9745407700538635
after epoch: 21,now: 2024-05-30 06:54:11.463546,epoch time: 0:19:09.358900,used: 6:46:25.230381,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9667776, 'precision': 0.7315409, 'recall': 0.6100224, 'specificity': 0.6100224, 'f1': 0.6470448, 'auroc': 0.92146814, 'binary_precision': 0.48885587, 'binary_recall': 0.22815534, 'binary_specificity': 0.9918895, 'binary_f1_score': 0.31111112}
confusion matrix:
       0    1
0  42070  344
1   1113  329
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.7478194, 'recall': 0.67573863, 'specificity': 0.67573863, 'f1': 0.70496047, 'auroc': 0.91814196, 'binary_precision': 0.5190678, 'binary_recall': 0.3640416, 'binary_specificity': 0.98743564, 'binary_f1_score': 0.42794758}
confusion matrix:
       0    1
0  17840  227
1    428  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97067356, 'precision': 0.8894283, 'recall': 0.69597465, 'specificity': 0.69597465, 'f1': 0.7578957, 'auroc': 0.91799074, 'binary_precision': 0.8046875, 'binary_recall': 0.39615384, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.53092784}
confusion matrix:
      0    1
0  5921   25
1   157  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 6
val acc:0.9650480151176453, best validation acc: 0.9655816555023193, corresponding to test acc:                         0.9666451811790466 / 0.9745407700538635
after epoch: 22,now: 2024-05-30 07:13:23.220184,epoch time: 0:19:11.756638,used: 7:05:36.987019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9665268, 'precision': 0.73303807, 'recall': 0.67252874, 'specificity': 0.67252874, 'f1': 0.6977862, 'auroc': 0.92073995, 'binary_precision': 0.48771265, 'binary_recall': 0.35783634, 'binary_specificity': 0.9872212, 'binary_f1_score': 0.4128}
confusion matrix:
       0    1
0  41872  542
1    926  516
---- Validation: 
scalar performance:
{'acc': 0.9635539, 'precision': 0.73616546, 'recall': 0.7243172, 'specificity': 0.7243172, 'f1': 0.73007005, 'auroc': 0.92023563, 'binary_precision': 0.492163, 'binary_recall': 0.4665676, 'binary_specificity': 0.98206675, 'binary_f1_score': 0.47902367}
confusion matrix:
       0    1
0  17743  324
1    359  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.973574, 'precision': 0.87909406, 'recall': 0.7544969, 'specificity': 0.7544969, 'f1': 0.80334044, 'auroc': 0.91015935, 'binary_precision': 0.7790698, 'binary_recall': 0.5153846, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.6203704}
confusion matrix:
      0    1
0  5908   38
1   126  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 7
val acc:0.9635539054870605, best validation acc: 0.9655816555023193, corresponding to test acc:                         0.9666451811790466 / 0.9745407700538635
after epoch: 23,now: 2024-05-30 07:32:44.511402,epoch time: 0:19:21.291218,used: 7:24:58.278237,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96693724, 'precision': 0.7364071, 'recall': 0.65398365, 'specificity': 0.65398365, 'f1': 0.6855976, 'auroc': 0.9248627, 'binary_precision': 0.49568966, 'binary_recall': 0.31900138, 'binary_specificity': 0.9889659, 'binary_f1_score': 0.38818562}
confusion matrix:
       0    1
0  41946  468
1    982  460
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.7475294, 'recall': 0.69719666, 'specificity': 0.69719666, 'f1': 0.7191875, 'auroc': 0.9227017, 'binary_precision': 0.5169173, 'binary_recall': 0.40861812, 'binary_specificity': 0.9857752, 'binary_f1_score': 0.4564315}
confusion matrix:
       0    1
0  17810  257
1    398  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9756687, 'precision': 0.91306925, 'recall': 0.75375104, 'specificity': 0.75375104, 'f1': 0.81265056, 'auroc': 0.9163185, 'binary_precision': 0.84713376, 'binary_recall': 0.51153845, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.6378897}
confusion matrix:
      0    1
0  5922   24
1   127  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 8
val acc:0.9650480151176453, best validation acc: 0.9655816555023193, corresponding to test acc:                         0.9666451811790466 / 0.975668728351593
after epoch: 24,now: 2024-05-30 07:52:01.497397,epoch time: 0:19:16.985995,used: 7:44:15.264232,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.966732, 'precision': 0.7335345, 'recall': 0.64617366, 'specificity': 0.64617366, 'f1': 0.6787682, 'auroc': 0.92403275, 'binary_precision': 0.49046016, 'binary_recall': 0.30305132, 'binary_specificity': 0.98929596, 'binary_f1_score': 0.37462494}
confusion matrix:
       0    1
0  41960  454
1   1005  437
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.7474891, 'recall': 0.703634, 'specificity': 0.703634, 'f1': 0.7231831, 'auroc': 0.92214733, 'binary_precision': 0.5163636, 'binary_recall': 0.42199108, 'binary_specificity': 0.985277, 'binary_f1_score': 0.4644317}
confusion matrix:
       0    1
0  17801  266
1    389  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9740574, 'precision': 0.9189582, 'recall': 0.72532535, 'specificity': 0.72532535, 'f1': 0.79052925, 'auroc': 0.9096664, 'binary_precision': 0.8613139, 'binary_recall': 0.45384616, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.5944584}
confusion matrix:
      0    1
0  5927   19
1   142  118
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 9
val acc:0.9650480151176453, best validation acc: 0.9655816555023193, corresponding to test acc:                         0.9666451811790466 / 0.975668728351593
after epoch: 25,now: 2024-05-30 08:11:28.092807,epoch time: 0:19:26.595410,used: 8:03:41.859642,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96670926, 'precision': 0.7329406, 'recall': 0.6414726, 'specificity': 0.6414726, 'f1': 0.6748871, 'auroc': 0.9250008, 'binary_precision': 0.48958334, 'binary_recall': 0.2933426, 'binary_specificity': 0.9896025, 'binary_f1_score': 0.36686903}
confusion matrix:
       0    1
0  41973  441
1   1019  423
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.7419693, 'recall': 0.70330197, 'specificity': 0.70330197, 'f1': 0.7207582, 'auroc': 0.92308915, 'binary_precision': 0.5053381, 'binary_recall': 0.42199108, 'binary_specificity': 0.9846128, 'binary_f1_score': 0.459919}
confusion matrix:
       0    1
0  17789  278
1    389  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9729294, 'precision': 0.90709126, 'recall': 0.71738076, 'specificity': 0.71738076, 'f1': 0.7808881, 'auroc': 0.9062878, 'binary_precision': 0.8382353, 'binary_recall': 0.43846154, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.57575756}
confusion matrix:
      0    1
0  5924   22
1   146  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 10
val acc:0.9644076824188232, best validation acc: 0.9655816555023193, corresponding to test acc:                         0.9666451811790466 / 0.975668728351593
after epoch: 26,now: 2024-05-30 08:30:18.738115,epoch time: 0:18:50.645308,used: 8:22:32.504950,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9655919, 'precision': 0.7255884, 'recall': 0.6871183, 'specificity': 0.6871183, 'f1': 0.7043589, 'auroc': 0.92722195, 'binary_precision': 0.47182506, 'binary_recall': 0.389043, 'binary_specificity': 0.98519355, 'binary_f1_score': 0.4264538}
confusion matrix:
       0    1
0  41786  628
1    881  561
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.7381538, 'recall': 0.7558166, 'specificity': 0.7558166, 'f1': 0.7466294, 'auroc': 0.9249195, 'binary_precision': 0.4937931, 'binary_recall': 0.5319465, 'binary_specificity': 0.97968674, 'binary_f1_score': 0.51216024}
confusion matrix:
       0    1
0  17700  367
1    315  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9761521, 'precision': 0.90484834, 'recall': 0.76871526, 'specificity': 0.76871526, 'f1': 0.82173103, 'auroc': 0.9082475, 'binary_precision': 0.82941175, 'binary_recall': 0.5423077, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.65581393}
confusion matrix:
      0    1
0  5917   29
1   119  141
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 11
val acc:0.9636072516441345, best validation acc: 0.9655816555023193, corresponding to test acc:                         0.9666451811790466 / 0.9761521220207214
after epoch: 27,now: 2024-05-30 08:49:45.732104,epoch time: 0:19:26.993989,used: 8:41:59.498939,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96552354, 'precision': 0.7254464, 'recall': 0.69323975, 'specificity': 0.69323975, 'f1': 0.7079642, 'auroc': 0.92905885, 'binary_precision': 0.47111472, 'binary_recall': 0.4018043, 'binary_specificity': 0.9846752, 'binary_f1_score': 0.43370786}
confusion matrix:
       0    1
0  41765  650
1    862  579
---- Validation: 
scalar performance:
{'acc': 0.9636606, 'precision': 0.73835737, 'recall': 0.7529832, 'specificity': 0.7529832, 'f1': 0.7454251, 'auroc': 0.9268158, 'binary_precision': 0.4944134, 'binary_recall': 0.52600294, 'binary_specificity': 0.9799635, 'binary_f1_score': 0.5097192}
confusion matrix:
       0    1
0  17705  362
1    319  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97582984, 'precision': 0.90182436, 'recall': 0.7667081, 'specificity': 0.7667081, 'f1': 0.81932205, 'auroc': 0.9104925, 'binary_precision': 0.8235294, 'binary_recall': 0.53846157, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.65116286}
confusion matrix:
      0    1
0  5916   30
1   120  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 12
val acc:0.9636605978012085, best validation acc: 0.9655816555023193, corresponding to test acc:                         0.9666451811790466 / 0.9761521220207214
after epoch: 28,now: 2024-05-30 09:09:08.065914,epoch time: 0:19:22.333810,used: 9:01:21.832749,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96707404, 'precision': 0.7382177, 'recall': 0.6594136, 'specificity': 0.6594136, 'f1': 0.69020176, 'auroc': 0.92587304, 'binary_precision': 0.4989518, 'binary_recall': 0.33009708, 'binary_specificity': 0.98873013, 'binary_f1_score': 0.39732888}
confusion matrix:
       0    1
0  41936  478
1    966  476
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.7453719, 'recall': 0.72423846, 'specificity': 0.72423846, 'f1': 0.73427284, 'auroc': 0.9223285, 'binary_precision': 0.5106036, 'binary_recall': 0.46508172, 'binary_specificity': 0.98339516, 'binary_f1_score': 0.4867807}
confusion matrix:
       0    1
0  17767  300
1    360  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9742185, 'precision': 0.90134954, 'recall': 0.74196035, 'specificity': 0.74196035, 'f1': 0.80009556, 'auroc': 0.91582894, 'binary_precision': 0.8246753, 'binary_recall': 0.48846152, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.6135266}
confusion matrix:
      0    1
0  5919   27
1   133  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 13
val acc:0.9647812247276306, best validation acc: 0.9655816555023193, corresponding to test acc:                         0.9666451811790466 / 0.9761521220207214
after epoch: 29,now: 2024-05-30 09:28:21.480532,epoch time: 0:19:13.414618,used: 9:20:35.247367,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9662988, 'precision': 0.733582, 'recall': 0.71160024, 'specificity': 0.71160024, 'f1': 0.7219877, 'auroc': 0.9331065, 'binary_precision': 0.48617512, 'binary_recall': 0.43897364, 'binary_specificity': 0.9842269, 'binary_f1_score': 0.4613703}
confusion matrix:
       0    1
0  41745  669
1    809  633
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.74384415, 'recall': 0.7719676, 'specificity': 0.7719676, 'f1': 0.75704265, 'auroc': 0.9274579, 'binary_precision': 0.5039788, 'binary_recall': 0.56463593, 'binary_specificity': 0.97929925, 'binary_f1_score': 0.5325858}
confusion matrix:
       0    1
0  17693  374
1    293  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9756687, 'precision': 0.88791347, 'recall': 0.7794969, 'specificity': 0.7794969, 'f1': 0.8240281, 'auroc': 0.91937304, 'binary_precision': 0.7945946, 'binary_recall': 0.5653846, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.6606742}
confusion matrix:
      0    1
0  5908   38
1   113  147
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 14
val acc:0.9644076824188232, best validation acc: 0.9655816555023193, corresponding to test acc:                         0.9666451811790466 / 0.9761521220207214
after epoch: 30,now: 2024-05-30 09:47:41.394263,epoch time: 0:19:19.913731,used: 9:39:55.161098,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_00_07_46_seed_1_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:39:55.161098 at 2024-05-30 09:47:41.394263
persisted model performance metric: 

scalar performance:
{'acc': 0.96696746, 'precision': 0.93901604, 'recall': 0.61680317, 'specificity': 0.61680317, 'f1': 0.6780628, 'auroc': 0.9042516, 'binary_precision': 0.9104478, 'binary_recall': 0.23461539, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.3730887}
confusion matrix:
      0   1
0  5940   6
1   199  61
oracle model performance metric: 

scalar performance:
{'acc': 0.9756687, 'precision': 0.89765203, 'recall': 0.76846296, 'specificity': 0.76846296, 'f1': 0.8193324, 'auroc': 0.91795987, 'binary_precision': 0.8150289, 'binary_recall': 0.5423077, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.6512702}
confusion matrix:
      0    1
0  5914   32
1   119  141
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 496847 KiB |  11071 MiB |   3328 TiB |   3328 TiB |
|       from large pool | 407040 KiB |  10998 MiB |   3323 TiB |   3323 TiB |
|       from small pool |  89807 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 496847 KiB |  11071 MiB |   3328 TiB |   3328 TiB |
|       from large pool | 407040 KiB |  10998 MiB |   3323 TiB |   3323 TiB |
|       from small pool |  89807 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476570 KiB |  10961 MiB |   3313 TiB |   3313 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   3308 TiB |   3308 TiB |
|       from small pool |  88730 KiB |    123 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11390 MiB |  11390 MiB |  20794 MiB |   9404 MiB |
|       from large pool |  11266 MiB |  11266 MiB |  20638 MiB |   9372 MiB |
|       from small pool |    124 MiB |    126 MiB |    156 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1480 MiB |   2595 MiB |   1137 TiB |   1137 TiB |
|       from large pool |   1472 MiB |   2593 MiB |   1132 TiB |   1132 TiB |
|       from small pool |      8 MiB |     20 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3705    |    6728    |  275992 K  |  275989 K  |
|       from large pool |      87    |     909    |  130046 K  |  130046 K  |
|       from small pool |    3618    |    6639    |  145946 K  |  145943 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3705    |    6728    |  275992 K  |  275989 K  |
|       from large pool |      87    |     909    |  130046 K  |  130046 K  |
|       from small pool |    3618    |    6639    |  145946 K  |  145943 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     234    |     234    |     389    |     155    |
|       from large pool |     172    |     172    |     311    |     139    |
|       from small pool |      62    |      63    |      78    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |    2775    |  144488 K  |  144488 K  |
|       from large pool |      24    |      65    |   67365 K  |   67365 K  |
|       from small pool |      53    |    2751    |   77122 K  |   77122 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   3328 TiB |   3328 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   3323 TiB |   3323 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   3328 TiB |   3328 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   3323 TiB |   3323 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   3313 TiB |   3313 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   3308 TiB |   3308 TiB |
|       from small pool |      0 KiB |    123 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1966 MiB |  11390 MiB |  20794 MiB |  18828 MiB |
|       from large pool |   1870 MiB |  11266 MiB |  20638 MiB |  18768 MiB |
|       from small pool |     96 MiB |    126 MiB |    156 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1137 TiB |   1137 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1132 TiB |   1132 TiB |
|       from small pool |      0 KiB |     24 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  275992 K  |  275992 K  |
|       from large pool |       2    |     909    |  130046 K  |  130046 K  |
|       from small pool |       0    |    6639    |  145946 K  |  145946 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  275992 K  |  275992 K  |
|       from large pool |       2    |     909    |  130046 K  |  130046 K  |
|       from small pool |       0    |    6639    |  145946 K  |  145946 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      83    |     234    |     389    |     306    |
|       from large pool |      35    |     172    |     311    |     276    |
|       from small pool |      48    |      63    |      78    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2775    |  144489 K  |  144489 K  |
|       from large pool |       4    |      65    |   67365 K  |   67365 K  |
|       from small pool |       0    |    2751    |   77123 K  |   77123 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   3328 TiB |   3328 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   3323 TiB |   3323 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   3328 TiB |   3328 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   3323 TiB |   3323 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   3313 TiB |   3313 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   3308 TiB |   3308 TiB |
|       from small pool |      0 KiB |    123 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1966 MiB |  11390 MiB |  20794 MiB |  18828 MiB |
|       from large pool |   1870 MiB |  11266 MiB |  20638 MiB |  18768 MiB |
|       from small pool |     96 MiB |    126 MiB |    156 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1137 TiB |   1137 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1132 TiB |   1132 TiB |
|       from small pool |      0 KiB |     24 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  275992 K  |  275992 K  |
|       from large pool |       2    |     909    |  130046 K  |  130046 K  |
|       from small pool |       0    |    6639    |  145946 K  |  145946 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  275992 K  |  275992 K  |
|       from large pool |       2    |     909    |  130046 K  |  130046 K  |
|       from small pool |       0    |    6639    |  145946 K  |  145946 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      83    |     234    |     389    |     306    |
|       from large pool |      35    |     172    |     311    |     276    |
|       from small pool |      48    |      63    |      78    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2775    |  144489 K  |  144489 K  |
|       from large pool |       4    |      65    |   67365 K  |   67365 K  |
|       from small pool |       0    |    2751    |   77123 K  |   77123 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754

 Experiment start at: 2024-05-30 09:57:05.738842
before training, model accuracy: 0.04888604208827019
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9508945, 'precision': 0.49671957, 'recall': 0.49850315, 'specificity': 0.49850315, 'f1': 0.4960848, 'auroc': 0.51395464, 'binary_precision': 0.028064992, 'binary_recall': 0.0125578325, 'binary_specificity': 0.9844485, 'binary_f1_score': 0.0173516}
confusion matrix:
       0    1
0  41653  658
1   1494   19
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.93464017, 'precision': 0.49064434, 'recall': 0.4900297, 'specificity': 0.4900297, 'f1': 0.49032855, 'auroc': 0.41553205, 'binary_precision': 0.01399689, 'binary_recall': 0.014950166, 'binary_specificity': 0.9651092, 'binary_f1_score': 0.014457832}
confusion matrix:
       0    1
0  17537  634
1    593    9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94742745, 'precision': 0.4860915, 'recall': 0.4948125, 'specificity': 0.4948125, 'f1': 0.48953012, 'auroc': 0.40942526, 'binary_precision': 0.011363637, 'binary_recall': 0.004132231, 'binary_specificity': 0.98549277, 'binary_f1_score': 0.006060606}
confusion matrix:
      0   1
0  5910  87
1   241   1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-30 10:17:52.850842,epoch time: 0:20:47.112000,used: 0:20:47.112000,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96463126, 'precision': 0.5359678, 'recall': 0.50115603, 'specificity': 0.50115603, 'f1': 0.4942027, 'auroc': 0.6553537, 'binary_precision': 0.10638298, 'binary_recall': 0.0033046927, 'binary_specificity': 0.99900734, 'binary_f1_score': 0.006410257}
confusion matrix:
       0   1
0  42269  42
1   1508   5
---- Validation: 
scalar performance:
{'acc': 0.96644115, 'precision': 0.4839424, 'recall': 0.49922955, 'specificity': 0.49922955, 'f1': 0.49146712, 'auroc': 0.61970603, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9984591, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18143  28
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9596089, 'precision': 0.48057473, 'recall': 0.49916625, 'specificity': 0.49916625, 'f1': 0.4896941, 'auroc': 0.5847683, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5987  10
1   242   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-30 10:36:58.997752,epoch time: 0:19:06.146910,used: 0:39:53.258910,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96538424, 'precision': 0.4827362, 'recall': 0.49995273, 'specificity': 0.49995273, 'f1': 0.49119368, 'auroc': 0.77533853, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42307  4
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.4839655, 'recall': 0.4999725, 'specificity': 0.4999725, 'f1': 0.4918388, 'auroc': 0.74958193, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18170  1
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.7319293, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-30 10:56:08.113236,epoch time: 0:19:09.115484,used: 0:59:02.374394,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.7327484, 'recall': 0.50031865, 'specificity': 0.50031865, 'f1': 0.4918771, 'auroc': 0.83268046, 'binary_precision': 0.5, 'binary_recall': 0.00066093856, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.001320132}
confusion matrix:
       0  1
0  42310  1
1   1512  1
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.8366506, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.9806829, 'recall': 0.50206614, 'specificity': 0.50206614, 'f1': 0.49426642, 'auroc': 0.8220219, 'binary_precision': 1.0, 'binary_recall': 0.004132231, 'binary_specificity': 1.0, 'binary_f1_score': 0.008230452}
confusion matrix:
      0  1
0  5997  0
1   241  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-05-30 11:15:17.638021,epoch time: 0:19:09.524785,used: 1:18:11.899179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96545273, 'precision': 0.48273736, 'recall': 0.49998817, 'specificity': 0.49998817, 'f1': 0.49121138, 'auroc': 0.85728586, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42310  1
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.8423203, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.9806829, 'recall': 0.50206614, 'specificity': 0.50206614, 'f1': 0.49426642, 'auroc': 0.84032494, 'binary_precision': 1.0, 'binary_recall': 0.004132231, 'binary_specificity': 1.0, 'binary_f1_score': 0.008230452}
confusion matrix:
      0  1
0  5997  0
1   241  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.9613720178604126
after epoch: 5,now: 2024-05-30 11:34:31.733096,epoch time: 0:19:14.095075,used: 1:37:25.994254,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.7327484, 'recall': 0.50031865, 'specificity': 0.50031865, 'f1': 0.4918771, 'auroc': 0.87109256, 'binary_precision': 0.5, 'binary_recall': 0.00066093856, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.001320132}
confusion matrix:
       0  1
0  42310  1
1   1512  1
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.86777604, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.98076, 'recall': 0.5041322, 'specificity': 0.5041322, 'f1': 0.498388, 'auroc': 0.8521099, 'binary_precision': 1.0, 'binary_recall': 0.008264462, 'binary_specificity': 1.0, 'binary_f1_score': 0.016393442}
confusion matrix:
      0  1
0  5997  0
1   240  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.9615322947502136
after epoch: 6,now: 2024-05-30 11:53:37.539562,epoch time: 0:19:05.806466,used: 1:56:31.800720,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9653614, 'precision': 0.554175, 'recall': 0.5002596, 'specificity': 0.5002596, 'f1': 0.4918454, 'auroc': 0.8829003, 'binary_precision': 0.14285715, 'binary_recall': 0.00066093856, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.0013157895}
confusion matrix:
       0  1
0  42305  6
1   1512  1
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73399127, 'recall': 0.50080305, 'specificity': 0.50080305, 'f1': 0.49350777, 'auroc': 0.8857149, 'binary_precision': 0.5, 'binary_recall': 0.0016611295, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0033112583}
confusion matrix:
       0  1
0  18170  1
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.98076, 'recall': 0.5041322, 'specificity': 0.5041322, 'f1': 0.498388, 'auroc': 0.88055325, 'binary_precision': 1.0, 'binary_recall': 0.008264462, 'binary_specificity': 1.0, 'binary_f1_score': 0.016393442}
confusion matrix:
      0  1
0  5997  0
1   240  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 3
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.9615322947502136
after epoch: 7,now: 2024-05-30 12:12:51.124058,epoch time: 0:19:13.584496,used: 2:15:45.385216,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.732759, 'recall': 0.5006373, 'specificity': 0.5006373, 'f1': 0.49253526, 'auroc': 0.8870902, 'binary_precision': 0.5, 'binary_recall': 0.0013218771, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.0026367833}
confusion matrix:
       0  1
0  42309  2
1   1511  2
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73399127, 'recall': 0.50080305, 'specificity': 0.50080305, 'f1': 0.49350777, 'auroc': 0.88357824, 'binary_precision': 0.5, 'binary_recall': 0.0016611295, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0033112583}
confusion matrix:
       0  1
0  18170  1
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.98099136, 'recall': 0.51033056, 'specificity': 0.51033056, 'f1': 0.5105544, 'auroc': 0.8703987, 'binary_precision': 1.0, 'binary_recall': 0.020661157, 'binary_specificity': 1.0, 'binary_f1_score': 0.04048583}
confusion matrix:
      0  1
0  5997  0
1   237  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 4
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9613720178604126 / 0.9620131254196167
after epoch: 8,now: 2024-05-30 12:32:04.747805,epoch time: 0:19:13.623747,used: 2:34:59.008963,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96524733, 'precision': 0.66709316, 'recall': 0.5043429, 'specificity': 0.5043429, 'f1': 0.50018173, 'auroc': 0.8981851, 'binary_precision': 0.36842105, 'binary_recall': 0.00925314, 'binary_specificity': 0.99943274, 'binary_f1_score': 0.018052869}
confusion matrix:
       0   1
0  42287  24
1   1499  14
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.7967192, 'recall': 0.50814056, 'specificity': 0.50814056, 'f1': 0.5080844, 'auroc': 0.892596, 'binary_precision': 0.625, 'binary_recall': 0.016611295, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.032362457}
confusion matrix:
       0   1
0  18165   6
1    592  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.9505112, 'recall': 0.53090835, 'specificity': 0.53090835, 'f1': 0.5488106, 'auroc': 0.88025415, 'binary_precision': 0.9375, 'binary_recall': 0.06198347, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.116279066}
confusion matrix:
      0   1
0  5996   1
1   227  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-05-30 12:51:20.835080,epoch time: 0:19:16.087275,used: 2:54:15.096238,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96545273, 'precision': 0.73024315, 'recall': 0.5133716, 'specificity': 0.5133716, 'f1': 0.5174856, 'auroc': 0.90283096, 'binary_precision': 0.49411765, 'binary_recall': 0.027759418, 'binary_specificity': 0.99898374, 'binary_f1_score': 0.05256571}
confusion matrix:
       0   1
0  42268  43
1   1471  42
---- Validation: 
scalar performance:
{'acc': 0.96761304, 'precision': 0.6765185, 'recall': 0.50786537, 'specificity': 0.50786537, 'f1': 0.5076891, 'auroc': 0.8950771, 'binary_precision': 0.3846154, 'binary_recall': 0.016611295, 'binary_specificity': 0.99911946, 'binary_f1_score': 0.03184713}
confusion matrix:
       0   1
0  18155  16
1    592  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.93444914, 'recall': 0.53908944, 'specificity': 0.53908944, 'f1': 0.5630334, 'auroc': 0.8840343, 'binary_precision': 0.9047619, 'binary_recall': 0.0785124, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.1444867}
confusion matrix:
      0   1
0  5995   2
1   223  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 1
val acc:0.9676130414009094, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9634556770324707 / 0.9639365077018738
after epoch: 10,now: 2024-05-30 13:10:37.189314,epoch time: 0:19:16.354234,used: 3:13:31.450472,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96533865, 'precision': 0.72522557, 'recall': 0.52733314, 'specificity': 0.52733314, 'f1': 0.54202163, 'auroc': 0.9022682, 'binary_precision': 0.48314607, 'binary_recall': 0.056840714, 'binary_specificity': 0.9978256, 'binary_f1_score': 0.10171496}
confusion matrix:
       0   1
0  42219  92
1   1427  86
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.7352445, 'recall': 0.5409555, 'specificity': 0.5409555, 'f1': 0.5642731, 'auroc': 0.8991648, 'binary_precision': 0.5, 'binary_recall': 0.08471761, 'binary_specificity': 0.99719334, 'binary_f1_score': 0.14488636}
confusion matrix:
       0   1
0  18120  51
1    551  51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.91912323, 'recall': 0.5698311, 'specificity': 0.5698311, 'f1': 0.61226475, 'auroc': 0.8922974, 'binary_precision': 0.8717949, 'binary_recall': 0.14049587, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.24199288}
confusion matrix:
      0   1
0  5992   5
1   208  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9634556770324707 / 0.9658598899841309
after epoch: 11,now: 2024-05-30 13:29:58.822782,epoch time: 0:19:21.633468,used: 3:32:53.083940,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9651561, 'precision': 0.70876634, 'recall': 0.52022827, 'specificity': 0.52022827, 'f1': 0.5297921, 'auroc': 0.9101243, 'binary_precision': 0.45070422, 'binary_recall': 0.042300068, 'binary_specificity': 0.9981565, 'binary_f1_score': 0.07734139}
confusion matrix:
       0   1
0  42233  78
1   1449  64
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.726044, 'recall': 0.5224303, 'specificity': 0.5224303, 'f1': 0.53423685, 'auroc': 0.9057956, 'binary_precision': 0.4827586, 'binary_recall': 0.046511628, 'binary_specificity': 0.998349, 'binary_f1_score': 0.084848486}
confusion matrix:
       0   1
0  18141  30
1    574  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.960524, 'recall': 0.584544, 'specificity': 0.584544, 'f1': 0.63553524, 'auroc': 0.9010414, 'binary_precision': 0.95348835, 'binary_recall': 0.1694215, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.2877193}
confusion matrix:
      0   1
0  5995   2
1   201  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 3
val acc:0.9678261280059814, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9634556770324707 / 0.9674627184867859
after epoch: 12,now: 2024-05-30 13:49:43.305497,epoch time: 0:19:44.482715,used: 3:52:37.566655,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9654071, 'precision': 0.7326424, 'recall': 0.5579592, 'specificity': 0.5579592, 'f1': 0.58797073, 'auroc': 0.91338813, 'binary_precision': 0.49591282, 'binary_recall': 0.120290816, 'binary_specificity': 0.99562764, 'binary_f1_score': 0.19361702}
confusion matrix:
       0    1
0  42126  185
1   1331  182
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.74147046, 'recall': 0.58443016, 'specificity': 0.58443016, 'f1': 0.6218118, 'auroc': 0.91049016, 'binary_precision': 0.50970876, 'binary_recall': 0.1744186, 'binary_specificity': 0.9944417, 'binary_f1_score': 0.25990102}
confusion matrix:
       0    1
0  18070  101
1    497  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9706684, 'precision': 0.9274397, 'recall': 0.6397455, 'specificity': 0.6397455, 'f1': 0.70564085, 'auroc': 0.8907635, 'binary_precision': 0.8831169, 'binary_recall': 0.28099173, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.4263323}
confusion matrix:
      0   1
0  5988   9
1   174  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 4
val acc:0.9681457281112671, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9634556770324707 / 0.970668375492096
after epoch: 13,now: 2024-05-30 14:08:58.701457,epoch time: 0:19:15.395960,used: 4:11:52.962615,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9656125, 'precision': 0.73895967, 'recall': 0.55615366, 'specificity': 0.55615366, 'f1': 0.58589137, 'auroc': 0.90408134, 'binary_precision': 0.5086705, 'binary_recall': 0.116325185, 'binary_specificity': 0.9959821, 'binary_f1_score': 0.18934911}
confusion matrix:
       0    1
0  42141  170
1   1337  176
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.72874, 'recall': 0.56651545, 'specificity': 0.56651545, 'f1': 0.59912056, 'auroc': 0.9057336, 'binary_precision': 0.4853801, 'binary_recall': 0.13787375, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.21474774}
confusion matrix:
       0   1
0  18083  88
1    519  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709889, 'precision': 0.9290769, 'recall': 0.64387774, 'specificity': 0.64387774, 'f1': 0.7106242, 'auroc': 0.89950144, 'binary_precision': 0.886076, 'binary_recall': 0.2892562, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.43613705}
confusion matrix:
      0   1
0  5988   9
1   172  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 5
val acc:0.9676663279533386, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9634556770324707 / 0.970988929271698
after epoch: 14,now: 2024-05-30 14:28:19.745780,epoch time: 0:19:21.044323,used: 4:31:14.006938,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9662514, 'precision': 0.7498855, 'recall': 0.60555696, 'specificity': 0.60555696, 'f1': 0.6456295, 'auroc': 0.9157758, 'binary_precision': 0.52715653, 'binary_recall': 0.21810971, 'binary_specificity': 0.9930042, 'binary_f1_score': 0.30855536}
confusion matrix:
       0    1
0  42015  296
1   1183  330
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.7363627, 'recall': 0.6260236, 'specificity': 0.6260236, 'f1': 0.66277885, 'auroc': 0.91434765, 'binary_precision': 0.49683544, 'binary_recall': 0.26079735, 'binary_specificity': 0.9912498, 'binary_f1_score': 0.34204793}
confusion matrix:
       0    1
0  18012  159
1    445  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9741946, 'precision': 0.91432995, 'recall': 0.70106196, 'specificity': 0.70106196, 'f1': 0.76786846, 'auroc': 0.91502345, 'binary_precision': 0.8521739, 'binary_recall': 0.40495867, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.54901963}
confusion matrix:
      0   1
0  5980  17
1   144  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 6
val acc:0.9678261280059814, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9634556770324707 / 0.9741945862770081
after epoch: 15,now: 2024-05-30 14:48:09.406408,epoch time: 0:19:49.660628,used: 4:51:03.667566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9659319, 'precision': 0.74348164, 'recall': 0.62769717, 'specificity': 0.62769717, 'f1': 0.6656982, 'auroc': 0.9171895, 'binary_precision': 0.51282054, 'binary_recall': 0.26437542, 'binary_specificity': 0.9910189, 'binary_f1_score': 0.34888795}
confusion matrix:
       0    1
0  41931  380
1   1113  400
---- Validation: 
scalar performance:
{'acc': 0.96745324, 'precision': 0.73355347, 'recall': 0.660362, 'specificity': 0.660362, 'f1': 0.68946207, 'auroc': 0.91219735, 'binary_precision': 0.48899755, 'binary_recall': 0.33222592, 'binary_specificity': 0.98849815, 'binary_f1_score': 0.39564785}
confusion matrix:
       0    1
0  17962  209
1    402  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97563714, 'precision': 0.90487266, 'recall': 0.73155344, 'specificity': 0.73155344, 'f1': 0.79266083, 'auroc': 0.91217923, 'binary_precision': 0.8308824, 'binary_recall': 0.46694216, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.59788364}
confusion matrix:
      0    1
0  5974   23
1   129  113
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 7
val acc:0.9674532413482666, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9634556770324707 / 0.9756371378898621
after epoch: 16,now: 2024-05-30 15:07:24.083378,epoch time: 0:19:14.676970,used: 5:10:18.344536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9656125, 'precision': 0.73899436, 'recall': 0.6294436, 'specificity': 0.6294436, 'f1': 0.6662449, 'auroc': 0.9174525, 'binary_precision': 0.5037221, 'binary_recall': 0.26834103, 'binary_specificity': 0.99054617, 'binary_f1_score': 0.35015088}
confusion matrix:
       0    1
0  41911  400
1   1107  406
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.7381219, 'recall': 0.68220943, 'specificity': 0.68220943, 'f1': 0.70606256, 'auroc': 0.9158913, 'binary_precision': 0.49671772, 'binary_recall': 0.37707642, 'binary_specificity': 0.9873425, 'binary_f1_score': 0.42870632}
confusion matrix:
       0    1
0  17941  230
1    375  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97723997, 'precision': 0.9263296, 'recall': 0.7403182, 'specificity': 0.7403182, 'f1': 0.8053034, 'auroc': 0.9032946, 'binary_precision': 0.8731343, 'binary_recall': 0.48347107, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.6223404}
confusion matrix:
      0    1
0  5980   17
1   125  117
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 8
val acc:0.9677728414535522, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9634556770324707 / 0.9772399663925171
after epoch: 17,now: 2024-05-30 15:26:38.490925,epoch time: 0:19:14.407547,used: 5:29:32.752083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9658178, 'precision': 0.7425269, 'recall': 0.59194905, 'specificity': 0.59194905, 'f1': 0.6301094, 'auroc': 0.9189167, 'binary_precision': 0.51336896, 'binary_recall': 0.1903503, 'binary_specificity': 0.9935478, 'binary_f1_score': 0.27772418}
confusion matrix:
       0    1
0  42038  273
1   1225  288
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.733342, 'recall': 0.6155014, 'specificity': 0.6155014, 'f1': 0.65261304, 'auroc': 0.91687906, 'binary_precision': 0.49146757, 'binary_recall': 0.23920266, 'binary_specificity': 0.9918001, 'binary_f1_score': 0.32178771}
confusion matrix:
       0    1
0  18022  149
1    458  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9724315, 'precision': 0.90885884, 'recall': 0.6763519, 'specificity': 0.6763519, 'f1': 0.7429124, 'auroc': 0.8979855, 'binary_precision': 0.84313726, 'binary_recall': 0.3553719, 'binary_specificity': 0.997332, 'binary_f1_score': 0.49999994}
confusion matrix:
      0   1
0  5981  16
1   156  86
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 9
val acc:0.9676663279533386, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9634556770324707 / 0.9772399663925171
after epoch: 18,now: 2024-05-30 15:45:43.403843,epoch time: 0:19:04.912918,used: 5:48:37.665001,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96524733, 'precision': 0.73301226, 'recall': 0.61172867, 'specificity': 0.61172867, 'f1': 0.64883834, 'auroc': 0.92177844, 'binary_precision': 0.49297753, 'binary_recall': 0.23198943, 'binary_specificity': 0.99146795, 'binary_f1_score': 0.31550562}
confusion matrix:
       0    1
0  41950  361
1   1162  351
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.7373725, 'recall': 0.6645424, 'specificity': 0.6645424, 'f1': 0.6936898, 'auroc': 0.9150477, 'binary_precision': 0.49636805, 'binary_recall': 0.34053156, 'binary_specificity': 0.98855317, 'binary_f1_score': 0.40394086}
confusion matrix:
       0    1
0  17963  208
1    397  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9765988, 'precision': 0.92686343, 'recall': 0.73007095, 'specificity': 0.73007095, 'f1': 0.7966736, 'auroc': 0.91095066, 'binary_precision': 0.875, 'binary_recall': 0.46280992, 'binary_specificity': 0.997332, 'binary_f1_score': 0.6054054}
confusion matrix:
      0    1
0  5981   16
1   130  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 10
val acc:0.9677728414535522, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9634556770324707 / 0.9772399663925171
after epoch: 19,now: 2024-05-30 16:04:58.005527,epoch time: 0:19:14.601684,used: 6:07:52.266685,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96495074, 'precision': 0.72592455, 'recall': 0.5892694, 'specificity': 0.5892694, 'f1': 0.62495995, 'auroc': 0.9166417, 'binary_precision': 0.48034188, 'binary_recall': 0.18572372, 'binary_specificity': 0.99281514, 'binary_f1_score': 0.26787418}
confusion matrix:
       0    1
0  42007  304
1   1232  281
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.7381785, 'recall': 0.633306, 'specificity': 0.633306, 'f1': 0.6695089, 'auroc': 0.91653013, 'binary_precision': 0.5, 'binary_recall': 0.2757475, 'binary_specificity': 0.9908646, 'binary_f1_score': 0.35546038}
confusion matrix:
       0    1
0  18005  166
1    436  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97563714, 'precision': 0.9233097, 'recall': 0.71767426, 'specificity': 0.71767426, 'f1': 0.784935, 'auroc': 0.9111016, 'binary_precision': 0.86885244, 'binary_recall': 0.43801653, 'binary_specificity': 0.997332, 'binary_f1_score': 0.58241755}
confusion matrix:
      0    1
0  5981   16
1   136  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 11
val acc:0.9679326415061951, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9634556770324707 / 0.9772399663925171
after epoch: 20,now: 2024-05-30 16:24:13.805850,epoch time: 0:19:15.800323,used: 6:27:08.067008,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9654983, 'precision': 0.7376463, 'recall': 0.63575757, 'specificity': 0.63575757, 'f1': 0.6713385, 'auroc': 0.92324126, 'binary_precision': 0.5005875, 'binary_recall': 0.28155982, 'binary_specificity': 0.9899553, 'binary_f1_score': 0.36040607}
confusion matrix:
       0    1
0  41886  425
1   1087  426
---- Validation: 
scalar performance:
{'acc': 0.96729344, 'precision': 0.73213375, 'recall': 0.6650978, 'specificity': 0.6650978, 'f1': 0.69237334, 'auroc': 0.9181992, 'binary_precision': 0.48584905, 'binary_recall': 0.34219268, 'binary_specificity': 0.98800284, 'binary_f1_score': 0.40155944}
confusion matrix:
       0    1
0  17953  218
1    396  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97868246, 'precision': 0.93104506, 'recall': 0.7589132, 'specificity': 0.7589132, 'f1': 0.82177365, 'auroc': 0.9107355, 'binary_precision': 0.8811189, 'binary_recall': 0.5206612, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.6545454}
confusion matrix:
      0    1
0  5980   17
1   116  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
early stop counter: 12
val acc:0.9672934412956238, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9634556770324707 / 0.9786824584007263
after epoch: 21,now: 2024-05-30 16:43:37.277844,epoch time: 0:19:23.471994,used: 6:46:31.539002,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.965544, 'precision': 0.7379129, 'recall': 0.6239911, 'specificity': 0.6239911, 'f1': 0.6611726, 'auroc': 0.92552084, 'binary_precision': 0.5019355, 'binary_recall': 0.25710508, 'binary_specificity': 0.9908771, 'binary_f1_score': 0.34003496}
confusion matrix:
       0    1
0  41925  386
1   1124  389
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.7377172, 'recall': 0.67257285, 'specificity': 0.67257285, 'f1': 0.6994443, 'auroc': 0.9175453, 'binary_precision': 0.4965358, 'binary_recall': 0.35714287, 'binary_specificity': 0.98800284, 'binary_f1_score': 0.41545892}
confusion matrix:
       0    1
0  17953  218
1    387  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97611797, 'precision': 0.91424865, 'recall': 0.7318036, 'specificity': 0.7318036, 'f1': 0.7951778, 'auroc': 0.91437614, 'binary_precision': 0.84962404, 'binary_recall': 0.46694216, 'binary_specificity': 0.996665, 'binary_f1_score': 0.6026667}
confusion matrix:
      0    1
0  5977   20
1   129  113
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 13
val acc:0.9677728414535522, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9634556770324707 / 0.9786824584007263
after epoch: 22,now: 2024-05-30 17:02:56.600348,epoch time: 0:19:19.322504,used: 7:05:50.861506,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9658178, 'precision': 0.7422804, 'recall': 0.6811716, 'specificity': 0.6811716, 'f1': 0.7068313, 'auroc': 0.93106246, 'binary_precision': 0.50669044, 'binary_recall': 0.3754131, 'binary_specificity': 0.98693013, 'binary_f1_score': 0.4312832}
confusion matrix:
       0    1
0  41758  553
1    945  568
---- Validation: 
scalar performance:
{'acc': 0.968199, 'precision': 0.74319935, 'recall': 0.71535456, 'specificity': 0.71535456, 'f1': 0.72834253, 'auroc': 0.9226533, 'binary_precision': 0.5047081, 'binary_recall': 0.4451827, 'binary_specificity': 0.9855264, 'binary_f1_score': 0.4730803}
confusion matrix:
       0    1
0  17908  263
1    334  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9790031, 'precision': 0.92007434, 'recall': 0.7729591, 'specificity': 0.7729591, 'f1': 0.82959086, 'auroc': 0.9177948, 'binary_precision': 0.85806453, 'binary_recall': 0.5495868, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.67002517}
confusion matrix:
      0    1
0  5975   22
1   109  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-05-30 17:22:07.203151,epoch time: 0:19:10.602803,used: 7:25:01.464309,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96545273, 'precision': 0.73668206, 'recall': 0.62553704, 'specificity': 0.62553704, 'f1': 0.6622857, 'auroc': 0.92932403, 'binary_precision': 0.49936628, 'binary_recall': 0.26040977, 'binary_specificity': 0.99066436, 'binary_f1_score': 0.34231102}
confusion matrix:
       0    1
0  41916  395
1   1119  394
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.73623294, 'recall': 0.65327215, 'specificity': 0.65327215, 'f1': 0.68503165, 'auroc': 0.92106146, 'binary_precision': 0.49481866, 'binary_recall': 0.31727573, 'binary_specificity': 0.9892686, 'binary_f1_score': 0.38663968}
confusion matrix:
       0    1
0  17976  195
1    411  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97740024, 'precision': 0.91208386, 'recall': 0.7542807, 'specificity': 0.7542807, 'f1': 0.8129343, 'auroc': 0.9079554, 'binary_precision': 0.8435374, 'binary_recall': 0.5123967, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.6375321}
confusion matrix:
      0    1
0  5974   23
1   118  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 1
val acc:0.9677196145057678, best validation acc: 0.9681990146636963, corresponding to test acc:                         0.9790030717849731 / 0.9790030717849731
after epoch: 24,now: 2024-05-30 17:41:27.165482,epoch time: 0:19:19.962331,used: 7:44:21.426640,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9660688, 'precision': 0.7448466, 'recall': 0.69372904, 'specificity': 0.69372904, 'f1': 0.71597904, 'auroc': 0.92940176, 'binary_precision': 0.51094276, 'binary_recall': 0.40118968, 'binary_specificity': 0.98626834, 'binary_f1_score': 0.44946316}
confusion matrix:
       0    1
0  41730  581
1    906  607
---- Validation: 
scalar performance:
{'acc': 0.9671869, 'precision': 0.735151, 'recall': 0.7260744, 'specificity': 0.7260744, 'f1': 0.7305136, 'auroc': 0.9221966, 'binary_precision': 0.48788926, 'binary_recall': 0.46843854, 'binary_specificity': 0.9837103, 'binary_f1_score': 0.4779661}
confusion matrix:
       0    1
0  17875  296
1    320  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97740024, 'precision': 0.89405763, 'recall': 0.77212536, 'specificity': 0.77212536, 'f1': 0.8209409, 'auroc': 0.9172925, 'binary_precision': 0.8060606, 'binary_recall': 0.5495868, 'binary_specificity': 0.994664, 'binary_f1_score': 0.65356266}
confusion matrix:
      0    1
0  5965   32
1   109  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 2
val acc:0.9671869277954102, best validation acc: 0.9681990146636963, corresponding to test acc:                         0.9790030717849731 / 0.9790030717849731
after epoch: 25,now: 2024-05-30 18:00:39.989310,epoch time: 0:19:12.823828,used: 8:03:34.250468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96558964, 'precision': 0.74065363, 'recall': 0.70176584, 'specificity': 0.70176584, 'f1': 0.7193066, 'auroc': 0.9312229, 'binary_precision': 0.50198257, 'binary_recall': 0.4183741, 'binary_specificity': 0.98515755, 'binary_f1_score': 0.4563807}
confusion matrix:
       0    1
0  41683  628
1    880  633
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.7448971, 'recall': 0.73149806, 'specificity': 0.73149806, 'f1': 0.7379891, 'auroc': 0.92363775, 'binary_precision': 0.5070422, 'binary_recall': 0.47840533, 'binary_specificity': 0.9845908, 'binary_f1_score': 0.4923077}
confusion matrix:
       0    1
0  17891  280
1    314  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97627825, 'precision': 0.8718908, 'recall': 0.7794727, 'specificity': 0.7794727, 'f1': 0.81850654, 'auroc': 0.9187574, 'binary_precision': 0.76111114, 'binary_recall': 0.5661157, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.6492891}
confusion matrix:
      0    1
0  5954   43
1   105  137
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
better model found
persisted
after epoch: 26,now: 2024-05-30 18:19:55.343028,epoch time: 0:19:15.353718,used: 8:22:49.604186,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.965042, 'precision': 0.73634726, 'recall': 0.70881116, 'specificity': 0.70881116, 'f1': 0.7216284, 'auroc': 0.93306756, 'binary_precision': 0.49286252, 'binary_recall': 0.4335757, 'binary_specificity': 0.9840467, 'binary_f1_score': 0.46132207}
confusion matrix:
       0    1
0  41636  675
1    857  656
---- Validation: 
scalar performance:
{'acc': 0.96692055, 'precision': 0.7344152, 'recall': 0.7468161, 'specificity': 0.7468161, 'f1': 0.7404379, 'auroc': 0.92597663, 'binary_precision': 0.48503938, 'binary_recall': 0.5116279, 'binary_specificity': 0.9820043, 'binary_f1_score': 0.49797902}
confusion matrix:
       0    1
0  17844  327
1    294  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9748357, 'precision': 0.86219376, 'recall': 0.76484317, 'specificity': 0.76484317, 'f1': 0.80524206, 'auroc': 0.911178, 'binary_precision': 0.74285716, 'binary_recall': 0.5371901, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.62350124}
confusion matrix:
      0    1
0  5952   45
1   112  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 1
val acc:0.9669205546379089, best validation acc: 0.9683588147163391, corresponding to test acc:                         0.9762782454490662 / 0.9790030717849731
after epoch: 27,now: 2024-05-30 18:39:14.225719,epoch time: 0:19:18.882691,used: 8:42:08.486877,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96661645, 'precision': 0.75033975, 'recall': 0.68540907, 'specificity': 0.68540907, 'f1': 0.7125175, 'auroc': 0.93271387, 'binary_precision': 0.5225225, 'binary_recall': 0.38334435, 'binary_specificity': 0.9874737, 'binary_f1_score': 0.44224173}
confusion matrix:
       0    1
0  41781  530
1    933  580
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.7401231, 'recall': 0.70796204, 'specificity': 0.70796204, 'f1': 0.72276646, 'auroc': 0.92470384, 'binary_precision': 0.4990366, 'binary_recall': 0.43023255, 'binary_specificity': 0.9856915, 'binary_f1_score': 0.46208742}
confusion matrix:
       0    1
0  17911  260
1    343  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9767591, 'precision': 0.88451254, 'recall': 0.7717919, 'specificity': 0.7717919, 'f1': 0.81759286, 'auroc': 0.9068923, 'binary_precision': 0.78698224, 'binary_recall': 0.5495868, 'binary_specificity': 0.993997, 'binary_f1_score': 0.6472019}
confusion matrix:
      0    1
0  5961   36
1   109  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 2
val acc:0.9678794145584106, best validation acc: 0.9683588147163391, corresponding to test acc:                         0.9762782454490662 / 0.9790030717849731
after epoch: 28,now: 2024-05-30 18:58:26.237408,epoch time: 0:19:12.011689,used: 9:01:20.498566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9657037, 'precision': 0.741302, 'recall': 0.6874856, 'specificity': 0.6874856, 'f1': 0.71064043, 'auroc': 0.9320096, 'binary_precision': 0.50428814, 'binary_recall': 0.38863185, 'binary_specificity': 0.9863393, 'binary_f1_score': 0.43896973}
confusion matrix:
       0    1
0  41733  578
1    925  588
---- Validation: 
scalar performance:
{'acc': 0.96745324, 'precision': 0.7377192, 'recall': 0.73504555, 'specificity': 0.73504555, 'f1': 0.736374, 'auroc': 0.9280755, 'binary_precision': 0.49243698, 'binary_recall': 0.48671097, 'binary_specificity': 0.98338014, 'binary_f1_score': 0.48955724}
confusion matrix:
       0    1
0  17869  302
1    309  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97740024, 'precision': 0.88729894, 'recall': 0.78005636, 'specificity': 0.78005636, 'f1': 0.8242761, 'auroc': 0.92150486, 'binary_precision': 0.7919075, 'binary_recall': 0.5661157, 'binary_specificity': 0.993997, 'binary_f1_score': 0.66024095}
confusion matrix:
      0    1
0  5961   36
1   105  137
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 3
val acc:0.9674532413482666, best validation acc: 0.9683588147163391, corresponding to test acc:                         0.9762782454490662 / 0.9790030717849731
after epoch: 29,now: 2024-05-30 19:17:49.327693,epoch time: 0:19:23.090285,used: 9:20:43.588851,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96647954, 'precision': 0.74854225, 'recall': 0.7226204, 'specificity': 0.7226204, 'f1': 0.7347878, 'auroc': 0.9374167, 'binary_precision': 0.51629627, 'binary_recall': 0.46067417, 'binary_specificity': 0.9845667, 'binary_f1_score': 0.48690182}
confusion matrix:
       0    1
0  41658  653
1    816  697
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.7414253, 'recall': 0.73288405, 'specificity': 0.73288405, 'f1': 0.7370694, 'auroc': 0.92649287, 'binary_precision': 0.5, 'binary_recall': 0.48172757, 'binary_specificity': 0.9840405, 'binary_f1_score': 0.49069372}
confusion matrix:
       0    1
0  17881  290
1    312  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9783619, 'precision': 0.8928819, 'recall': 0.7904703, 'specificity': 0.7904703, 'f1': 0.8333047, 'auroc': 0.92444634, 'binary_precision': 0.80225986, 'binary_recall': 0.58677685, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.67780435}
confusion matrix:
      0    1
0  5962   35
1   100  142
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993754.png
early stop counter: 4
val acc:0.9679326415061951, best validation acc: 0.9683588147163391, corresponding to test acc:                         0.9762782454490662 / 0.9790030717849731
after epoch: 30,now: 2024-05-30 19:37:02.695012,epoch time: 0:19:13.367319,used: 9:39:56.956170,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_09_57_05_seed_2_20993754
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:39:56.956170 at 2024-05-30 19:37:02.695012
persisted model performance metric: 

scalar performance:
{'acc': 0.97740024, 'precision': 0.8905945, 'recall': 0.77609086, 'specificity': 0.77609086, 'f1': 0.8226248, 'auroc': 0.9259454, 'binary_precision': 0.79881656, 'binary_recall': 0.55785125, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.6569344}
confusion matrix:
      0    1
0  5963   34
1   107  135
oracle model performance metric: 

scalar performance:
{'acc': 0.9777208, 'precision': 0.8990058, 'recall': 0.77229214, 'specificity': 0.77229214, 'f1': 0.8226384, 'auroc': 0.91787785, 'binary_precision': 0.81595093, 'binary_recall': 0.5495868, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.65679014}
confusion matrix:
      0    1
0  5967   30
1   109  133
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 495893 KiB |  11071 MiB |   4986 TiB |   4986 TiB |
|       from large pool | 406080 KiB |  10998 MiB |   4978 TiB |   4978 TiB |
|       from small pool |  89813 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 495893 KiB |  11071 MiB |   4986 TiB |   4986 TiB |
|       from large pool | 406080 KiB |  10998 MiB |   4978 TiB |   4978 TiB |
|       from small pool |  89813 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476572 KiB |  10961 MiB |   4965 TiB |   4965 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   4956 TiB |   4956 TiB |
|       from small pool |  88732 KiB |    123 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11236 MiB |  11390 MiB |  30064 MiB |  18828 MiB |
|       from large pool |  11112 MiB |  11266 MiB |  29880 MiB |  18768 MiB |
|       from small pool |    124 MiB |    126 MiB |    184 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1347 MiB |   2595 MiB |   1676 TiB |   1676 TiB |
|       from large pool |   1339 MiB |   2593 MiB |   1668 TiB |   1668 TiB |
|       from small pool |      8 MiB |     24 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3717    |    6728    |  413567 K  |  413563 K  |
|       from large pool |      87    |     909    |  194832 K  |  194832 K  |
|       from small pool |    3630    |    6639    |  218734 K  |  218731 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3717    |    6728    |  413567 K  |  413563 K  |
|       from large pool |      87    |     909    |  194832 K  |  194832 K  |
|       from small pool |    3630    |    6639    |  218734 K  |  218731 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     234    |     234    |     540    |     306    |
|       from large pool |     172    |     172    |     448    |     276    |
|       from small pool |      62    |      63    |      92    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    2775    |  217376 K  |  217376 K  |
|       from large pool |      24    |      65    |  101690 K  |  101690 K  |
|       from small pool |      50    |    2751    |  115685 K  |  115685 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   4986 TiB |   4986 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   4978 TiB |   4978 TiB |
|       from small pool |      0 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   4986 TiB |   4986 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   4978 TiB |   4978 TiB |
|       from small pool |      0 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   4965 TiB |   4965 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   4956 TiB |   4956 TiB |
|       from small pool |      0 KiB |    123 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1832 MiB |  11390 MiB |  30064 MiB |  28232 MiB |
|       from large pool |   1736 MiB |  11266 MiB |  29880 MiB |  28144 MiB |
|       from small pool |     96 MiB |    126 MiB |    184 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1676 TiB |   1676 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1668 TiB |   1668 TiB |
|       from small pool |      0 KiB |     24 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  413567 K  |  413567 K  |
|       from large pool |       2    |     909    |  194832 K  |  194832 K  |
|       from small pool |       0    |    6639    |  218734 K  |  218734 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  413567 K  |  413567 K  |
|       from large pool |       2    |     909    |  194832 K  |  194832 K  |
|       from small pool |       0    |    6639    |  218734 K  |  218734 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     234    |     540    |     458    |
|       from large pool |      34    |     172    |     448    |     414    |
|       from small pool |      48    |      63    |      92    |      44    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2775    |  217377 K  |  217377 K  |
|       from large pool |       4    |      65    |  101690 K  |  101690 K  |
|       from small pool |       0    |    2751    |  115687 K  |  115687 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu May 30 19:39:06 2024]
Finished job 0.
1 of 1 steps (100%) done
