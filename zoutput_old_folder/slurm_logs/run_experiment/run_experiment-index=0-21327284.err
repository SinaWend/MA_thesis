Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun 15 22:12:52 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284

 Experiment start at: 2024-06-15 22:21:01.252689
before training, model accuracy: 0.3103227913379669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.48320776, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49146047, 'auroc': 0.48685032, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42329  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.41199854, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.4196685, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-15 22:38:30.395052,epoch time: 0:17:29.142363,used: 0:17:29.142363,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.48320776, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49146047, 'auroc': 0.47243702, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42329  0
1   1471  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.40573543, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.41865695, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-15 22:55:17.785451,epoch time: 0:16:47.390399,used: 0:34:16.532762,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.52217317, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.43723696, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.4358961, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-15 23:12:23.686142,epoch time: 0:17:05.900691,used: 0:51:22.433453,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.5434607, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.48466834, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.47761685, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_4.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-15 23:29:23.291370,epoch time: 0:16:59.605228,used: 1:08:22.038681,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.58555555, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.52621794, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.53655326, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_5.png
early stop counter: 4
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 5,now: 2024-06-15 23:46:19.480841,epoch time: 0:16:56.189471,used: 1:25:18.228152,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.6336775, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.57682806, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.5831177, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_6.png
early stop counter: 5
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 6,now: 2024-06-16 00:03:22.117103,epoch time: 0:17:02.636262,used: 1:42:20.864414,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.67008805, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.60766757, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.65056044, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_7.png
early stop counter: 6
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 7,now: 2024-06-16 00:20:26.469281,epoch time: 0:17:04.352178,used: 1:59:25.216592,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.7169534, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.6692605, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.69509065, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_8.png
early stop counter: 7
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 8,now: 2024-06-16 00:37:29.537396,epoch time: 0:17:03.068115,used: 2:16:28.284707,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.7566034, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.7125008, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.7293627, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_9.png
early stop counter: 8
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 9,now: 2024-06-16 00:54:32.253104,epoch time: 0:17:02.715708,used: 2:33:31.000415,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.77755666, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.7467701, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.76683694, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_10.png
early stop counter: 9
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 10,now: 2024-06-16 01:11:37.788681,epoch time: 0:17:05.535577,used: 2:50:36.535992,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.81016564, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.7827761, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.7956318, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_11.png
early stop counter: 10
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 11,now: 2024-06-16 01:28:50.063858,epoch time: 0:17:12.275177,used: 3:07:48.811169,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.826121, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8151541, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8158597, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_12.png
early stop counter: 11
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 12,now: 2024-06-16 01:45:41.938371,epoch time: 0:16:51.874513,used: 3:24:40.685682,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9664155, 'precision': 0.98320735, 'recall': 0.5003397, 'specificity': 0.5003397, 'f1': 0.4921392, 'auroc': 0.8391453, 'binary_precision': 1.0, 'binary_recall': 0.00067934784, 'binary_specificity': 1.0, 'binary_f1_score': 0.0013577732}
confusion matrix:
       0  1
0  42328  0
1   1471  1
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.822892, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.82572067, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_13.png
early stop counter: 12
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 13,now: 2024-06-16 02:02:33.312325,epoch time: 0:16:51.373954,used: 3:41:32.059636,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96643835, 'precision': 0.816573, 'recall': 0.5013351, 'specificity': 0.5013351, 'f1': 0.49417198, 'auroc': 0.85019577, 'binary_precision': 0.6666667, 'binary_recall': 0.0027173914, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.00541272}
confusion matrix:
       0  1
0  42326  2
1   1468  4
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.83510226, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.83481586, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_14.png
early stop counter: 13
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 14,now: 2024-06-16 02:19:25.718879,epoch time: 0:16:52.406554,used: 3:58:24.466190,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9663242, 'precision': 0.6755561, 'recall': 0.50160384, 'specificity': 0.50160384, 'f1': 0.49480286, 'auroc': 0.859746, 'binary_precision': 0.3846154, 'binary_recall': 0.003396739, 'binary_specificity': 0.999811, 'binary_f1_score': 0.0067340066}
confusion matrix:
       0  1
0  42320  8
1   1467  5
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8518653, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.84553516, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_15.png
early stop counter: 14
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 15,now: 2024-06-16 02:36:22.688820,epoch time: 0:16:56.969941,used: 4:15:21.436131,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9663242, 'precision': 0.7033124, 'recall': 0.50357103, 'specificity': 0.50357103, 'f1': 0.4987827, 'auroc': 0.8686023, 'binary_precision': 0.44, 'binary_recall': 0.007472826, 'binary_specificity': 0.99966925, 'binary_f1_score': 0.014696059}
confusion matrix:
       0   1
0  42314  14
1   1461  11
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.85883206, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8527886, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_16.png
early stop counter: 15
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 16,now: 2024-06-16 02:53:19.827522,epoch time: 0:16:57.138702,used: 4:32:18.574833,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.966621, 'precision': 0.8028897, 'recall': 0.50765896, 'specificity': 0.50765896, 'f1': 0.5067611, 'auroc': 0.87504, 'binary_precision': 0.6388889, 'binary_recall': 0.015625, 'binary_specificity': 0.99969286, 'binary_f1_score': 0.030503979}
confusion matrix:
       0   1
0  42315  13
1   1449  23
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.48289075, 'recall': 0.49997246, 'specificity': 0.49997246, 'f1': 0.4912832, 'auroc': 0.8585012, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18148  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8493154, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_17.png
early stop counter: 16
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 17,now: 2024-06-16 03:10:34.848152,epoch time: 0:17:15.020630,used: 4:49:33.595463,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96593606, 'precision': 0.66769785, 'recall': 0.50894386, 'specificity': 0.50894386, 'f1': 0.50941867, 'auroc': 0.8809027, 'binary_precision': 0.36842105, 'binary_recall': 0.019021738, 'binary_specificity': 0.998866, 'binary_f1_score': 0.03617571}
confusion matrix:
       0   1
0  42280  48
1   1444  28
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.6079146, 'recall': 0.500695, 'specificity': 0.500695, 'f1': 0.49281454, 'auroc': 0.8677785, 'binary_precision': 0.25, 'binary_recall': 0.00155521, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.0030911902}
confusion matrix:
       0  1
0  18146  3
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.86162, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_18.png
new oracle model saved
early stop counter: 17
val acc:0.9656769037246704, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9586129784584045
after epoch: 18,now: 2024-06-16 03:27:28.691248,epoch time: 0:16:53.843096,used: 5:06:27.438559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96621007, 'precision': 0.70891654, 'recall': 0.5133455, 'specificity': 0.5133455, 'f1': 0.51764756, 'auroc': 0.88340974, 'binary_precision': 0.45054945, 'binary_recall': 0.027872195, 'binary_specificity': 0.99881876, 'binary_f1_score': 0.0524968}
confusion matrix:
       0   1
0  42279  50
1   1430  41
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.545411, 'recall': 0.5005848, 'specificity': 0.5005848, 'f1': 0.49274993, 'auroc': 0.8753543, 'binary_precision': 0.125, 'binary_recall': 0.00155521, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.0030721969}
confusion matrix:
       0  1
0  18142  7
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.97952986, 'recall': 0.5095785, 'specificity': 0.5095785, 'f1': 0.508348, 'auroc': 0.8633942, 'binary_precision': 1.0, 'binary_recall': 0.019157087, 'binary_specificity': 1.0, 'binary_f1_score': 0.037593983}
confusion matrix:
      0  1
0  5997  0
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_19.png
new oracle model saved
early stop counter: 18
val acc:0.9654640555381775, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.959092378616333
after epoch: 19,now: 2024-06-16 03:44:41.203914,epoch time: 0:17:12.512666,used: 5:23:39.951225,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96618724, 'precision': 0.71184987, 'recall': 0.5153032, 'specificity': 0.5153032, 'f1': 0.52123326, 'auroc': 0.8866277, 'binary_precision': 0.4563107, 'binary_recall': 0.031929348, 'binary_specificity': 0.998677, 'binary_f1_score': 0.05968254}
confusion matrix:
       0   1
0  42272  56
1   1425  47
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.59404784, 'recall': 0.5013624, 'specificity': 0.5013624, 'f1': 0.4942946, 'auroc': 0.8775359, 'binary_precision': 0.22222222, 'binary_recall': 0.00311042, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.006134969}
confusion matrix:
       0  1
0  18142  7
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.9796065, 'recall': 0.5114943, 'specificity': 0.5114943, 'f1': 0.5120629, 'auroc': 0.8648738, 'binary_precision': 1.0, 'binary_recall': 0.022988506, 'binary_specificity': 1.0, 'binary_f1_score': 0.044943817}
confusion matrix:
      0  1
0  5997  0
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_20.png
new oracle model saved
early stop counter: 19
val acc:0.9655172228813171, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9592521786689758
after epoch: 20,now: 2024-06-16 04:01:42.909103,epoch time: 0:17:01.705189,used: 5:40:41.656414,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.7322867, 'recall': 0.52393895, 'specificity': 0.52393895, 'f1': 0.5365575, 'auroc': 0.89020157, 'binary_precision': 0.49659863, 'binary_recall': 0.049626105, 'binary_specificity': 0.9982518, 'binary_f1_score': 0.09023486}
confusion matrix:
       0   1
0  42255  74
1   1398  73
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.7053105, 'recall': 0.5059453, 'specificity': 0.5059453, 'f1': 0.5033685, 'auroc': 0.8841698, 'binary_precision': 0.44444445, 'binary_recall': 0.01244168, 'binary_specificity': 0.999449, 'binary_f1_score': 0.02420575}
confusion matrix:
       0   1
0  18139  10
1    635   8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.97983676, 'recall': 0.51724136, 'specificity': 0.51724136, 'f1': 0.5230443, 'auroc': 0.8687281, 'binary_precision': 1.0, 'binary_recall': 0.03448276, 'binary_specificity': 1.0, 'binary_f1_score': 0.06666667}
confusion matrix:
      0  1
0  5997  0
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_21.png
new oracle model saved
early stop counter: 20
val acc:0.9656769037246704, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9597315192222595
after epoch: 21,now: 2024-06-16 04:19:13.436410,epoch time: 0:17:30.527307,used: 5:58:12.183721,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_15_22_21_01_seed_0_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 21 with time: 5:58:12.183721 at 2024-06-16 04:19:13.436410
persisted model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.4196685, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9597315, 'precision': 0.97983676, 'recall': 0.51724136, 'specificity': 0.51724136, 'f1': 0.5230443, 'auroc': 0.8687281, 'binary_precision': 1.0, 'binary_recall': 0.03448276, 'binary_specificity': 1.0, 'binary_f1_score': 0.06666667}
confusion matrix:
      0  1
0  5997  0
1   252  9
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |  36242 KiB |     72 MiB |     52 GiB |     51 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |  36242 KiB |     72 MiB |     52 GiB |     51 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1428 MiB | 284091 GiB | 284091 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 284041 GiB | 284041 GiB |
|       from small pool |  35968 KiB |     71 MiB |     50 GiB |     50 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 212041 GiB | 212040 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 211983 GiB | 211983 GiB |
|       from small pool |   8813 KiB |  12610 KiB |     57 GiB |     57 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |    9364 K  |    9362 K  |
|       from large pool |      36    |      76    |    3727 K  |    3726 K  |
|       from small pool |    1242    |    1864    |    5637 K  |    5635 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |    9364 K  |    9362 K  |
|       from large pool |      36    |      76    |    3727 K  |    3726 K  |
|       from small pool |    1242    |    1864    |    5637 K  |    5635 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     452    |    4944 K  |    4943 K  |
|       from large pool |       5    |      10    |    1384 K  |    1384 K  |
|       from small pool |      30    |     447    |    3559 K  |    3559 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 284091 GiB | 284091 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 284041 GiB | 284041 GiB |
|       from small pool |      0 KiB |     71 MiB |     50 GiB |     50 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 212041 GiB | 212041 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 211983 GiB | 211983 GiB |
|       from small pool |      0 KiB |  16408 KiB |     57 GiB |     57 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |    9364 K  |    9364 K  |
|       from large pool |       2    |      76    |    3727 K  |    3727 K  |
|       from small pool |       0    |    1864    |    5637 K  |    5637 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |    9364 K  |    9364 K  |
|       from large pool |       2    |      76    |    3727 K  |    3727 K  |
|       from small pool |       0    |    1864    |    5637 K  |    5637 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    4944 K  |    4944 K  |
|       from large pool |       1    |      11    |    1384 K  |    1384 K  |
|       from small pool |       0    |     447    |    3559 K  |    3559 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 284107 GiB | 284107 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 284055 GiB | 284055 GiB |
|       from small pool |      0 KiB |     72 MiB |     52 GiB |     52 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 284091 GiB | 284091 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 284041 GiB | 284041 GiB |
|       from small pool |      0 KiB |     71 MiB |     50 GiB |     50 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 212041 GiB | 212041 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 211983 GiB | 211983 GiB |
|       from small pool |      0 KiB |  16408 KiB |     57 GiB |     57 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |    9364 K  |    9364 K  |
|       from large pool |       2    |      76    |    3727 K  |    3727 K  |
|       from small pool |       0    |    1864    |    5637 K  |    5637 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |    9364 K  |    9364 K  |
|       from large pool |       2    |      76    |    3727 K  |    3727 K  |
|       from small pool |       0    |    1864    |    5637 K  |    5637 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    4944 K  |    4944 K  |
|       from large pool |       1    |      11    |    1384 K  |    1384 K  |
|       from small pool |       0    |     447    |    3559 K  |    3559 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284

 Experiment start at: 2024-06-16 04:26:41.763507
before training, model accuracy: 0.14631003141403198
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9668265, 'precision': 0.48353466, 'recall': 0.49987015, 'specificity': 0.49987015, 'f1': 0.49156672, 'auroc': 0.4284652, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997403, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42347  11
1   1442   0
---- Validation: 
scalar performance:
{'acc': 0.9629136, 'precision': 0.48202264, 'recall': 0.49939117, 'specificity': 0.49939117, 'f1': 0.49055323, 'auroc': 0.36186796, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99878234, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18045  22
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.3198401, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-16 04:44:03.454066,epoch time: 0:17:21.690559,used: 0:17:21.690559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.48355022, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163756, 'auroc': 0.46338063, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42359  0
1   1441  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.39259952, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.34977245, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_2.png
better model found
persisted
after epoch: 2,now: 2024-06-16 05:01:08.100709,epoch time: 0:17:04.646643,used: 0:34:26.337202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96719176, 'precision': 0.48359588, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49166116, 'auroc': 0.48602176, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42363  0
1   1437  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.41528073, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.3810267, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_3.png
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 3,now: 2024-06-16 05:18:21.893160,epoch time: 0:17:13.792451,used: 0:51:40.129653,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.48356164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164346, 'auroc': 0.48619604, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42360  0
1   1440  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.40104198, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.4066981, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_4.png
early stop counter: 2
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 4,now: 2024-06-16 05:35:28.404503,epoch time: 0:17:06.511343,used: 1:08:46.640996,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.48356164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164346, 'auroc': 0.53526, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42360  0
1   1440  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.46266735, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.45509198, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_5.png
early stop counter: 3
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-16 05:52:45.033554,epoch time: 0:17:16.629051,used: 1:26:03.270047,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9672146, 'precision': 0.4836073, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49166703, 'auroc': 0.5674769, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42364  0
1   1436  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.5069845, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5013244, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_6.png
early stop counter: 4
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 6,now: 2024-06-16 06:11:05.292433,epoch time: 0:18:20.258879,used: 1:44:23.528926,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.48355022, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163756, 'auroc': 0.6345204, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42359  0
1   1441  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.56114805, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5526521, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_7.png
early stop counter: 5
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 7,now: 2024-06-16 06:28:05.265436,epoch time: 0:16:59.973003,used: 2:01:23.501929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.48355022, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163756, 'auroc': 0.6667377, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42359  0
1   1441  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.59488285, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.6054914, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_8.png
early stop counter: 6
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 8,now: 2024-06-16 06:44:52.935941,epoch time: 0:16:47.670505,used: 2:18:11.172434,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.48357305, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164933, 'auroc': 0.7121471, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42361  0
1   1439  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.65094656, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.66988015, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_9.png
early stop counter: 7
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 9,now: 2024-06-16 07:01:51.663010,epoch time: 0:16:58.727069,used: 2:35:09.899503,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.48357305, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164933, 'auroc': 0.7507355, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42361  0
1   1439  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.6981214, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.7224897, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_10.png
early stop counter: 8
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 10,now: 2024-06-16 07:18:50.095426,epoch time: 0:16:58.432416,used: 2:52:08.331919,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.48356164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164346, 'auroc': 0.7876824, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42360  0
1   1440  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.7306445, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.74317896, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_11.png
early stop counter: 9
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 11,now: 2024-06-16 07:35:47.894440,epoch time: 0:16:57.799014,used: 3:09:06.130933,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.48356164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164346, 'auroc': 0.8074193, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42360  0
1   1440  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.7738439, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.78134465, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_12.png
early stop counter: 10
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 12,now: 2024-06-16 07:52:44.477839,epoch time: 0:16:56.583399,used: 3:26:02.714332,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.48356128, 'recall': 0.4999882, 'specificity': 0.4999882, 'f1': 0.49163756, 'auroc': 0.8199831, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42359  1
1   1440  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.78703666, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.79232955, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_13.png
early stop counter: 11
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 13,now: 2024-06-16 08:09:23.336708,epoch time: 0:16:38.858869,used: 3:42:41.573201,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.8168939, 'recall': 0.5006817, 'specificity': 0.5006817, 'f1': 0.49302125, 'auroc': 0.8321328, 'binary_precision': 0.6666667, 'binary_recall': 0.0013869626, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.0027681661}
confusion matrix:
       0  1
0  42357  1
1   1440  2
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.80734324, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.80498195, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_14.png
early stop counter: 12
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 14,now: 2024-06-16 08:26:08.153746,epoch time: 0:16:44.817038,used: 3:59:26.390239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96696347, 'precision': 0.483548, 'recall': 0.4999292, 'specificity': 0.4999292, 'f1': 0.49160215, 'auroc': 0.84593374, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998584, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42353  6
1   1441  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.83059424, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.82160616, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_15.png
early stop counter: 13
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 15,now: 2024-06-16 08:42:54.388695,epoch time: 0:16:46.234949,used: 4:16:12.625188,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9672146, 'precision': 0.829802, 'recall': 0.5030756, 'specificity': 0.5030756, 'f1': 0.49785516, 'auroc': 0.85763705, 'binary_precision': 0.6923077, 'binary_recall': 0.006245663, 'binary_specificity': 0.9999056, 'binary_f1_score': 0.012379643}
confusion matrix:
       0  1
0  42355  4
1   1432  9
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.8415503, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.83023345, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_16.png
early stop counter: 14
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 16,now: 2024-06-16 08:59:42.167796,epoch time: 0:16:47.779101,used: 4:33:00.404289,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9672375, 'precision': 0.7753906, 'recall': 0.50474644, 'specificity': 0.50474644, 'f1': 0.50123966, 'auroc': 0.8670429, 'binary_precision': 0.5833333, 'binary_recall': 0.009728978, 'binary_specificity': 0.9997639, 'binary_f1_score': 0.019138755}
confusion matrix:
       0   1
0  42351  10
1   1425  14
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.4820428, 'recall': 0.4999723, 'specificity': 0.4999723, 'f1': 0.49084386, 'auroc': 0.85270876, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18066  1
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8342813, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_17.png
early stop counter: 15
val acc:0.9640341401100159, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 17,now: 2024-06-16 09:16:24.088055,epoch time: 0:16:41.920259,used: 4:49:42.324548,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96687216, 'precision': 0.6642408, 'recall': 0.50423926, 'specificity': 0.50423926, 'f1': 0.50037766, 'auroc': 0.8665739, 'binary_precision': 0.3611111, 'binary_recall': 0.009021513, 'binary_specificity': 0.999457, 'binary_f1_score': 0.01760325}
confusion matrix:
       0   1
0  42336  23
1   1428  13
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.48204184, 'recall': 0.49994466, 'specificity': 0.49994466, 'f1': 0.49083003, 'auroc': 0.85217476, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18065  2
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.83868957, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_18.png
early stop counter: 16
val acc:0.9639807939529419, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 18,now: 2024-06-16 09:33:31.242846,epoch time: 0:17:07.154791,used: 5:06:49.479339,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9670776, 'precision': 0.7304026, 'recall': 0.5117194, 'specificity': 0.5117194, 'f1': 0.51477295, 'auroc': 0.88043547, 'binary_precision': 0.49295774, 'binary_recall': 0.024288688, 'binary_specificity': 0.9991501, 'binary_f1_score': 0.046296295}
confusion matrix:
       0   1
0  42323  36
1   1406  35
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.64880574, 'recall': 0.50275034, 'specificity': 0.50275034, 'f1': 0.4966398, 'auroc': 0.8688774, 'binary_precision': 0.33333334, 'binary_recall': 0.0059435363, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.011678832}
confusion matrix:
       0  1
0  18059  8
1    669  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.9792069, 'recall': 0.50384617, 'specificity': 0.50384617, 'f1': 0.4970163, 'auroc': 0.84953946, 'binary_precision': 1.0, 'binary_recall': 0.0076923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.015267175}
confusion matrix:
      0  1
0  5946  0
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_19.png
new oracle model saved
early stop counter: 17
val acc:0.9638740420341492, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9584273099899292
after epoch: 19,now: 2024-06-16 09:50:51.579321,epoch time: 0:17:20.336475,used: 5:24:09.815814,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.7397022, 'recall': 0.5150957, 'specificity': 0.5150957, 'f1': 0.52104646, 'auroc': 0.88150954, 'binary_precision': 0.5113636, 'binary_recall': 0.031206658, 'binary_specificity': 0.9989848, 'binary_f1_score': 0.05882353}
confusion matrix:
       0   1
0  42315  43
1   1397  45
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.7679582, 'recall': 0.5057775, 'specificity': 0.5057775, 'f1': 0.5025262, 'auroc': 0.86642694, 'binary_precision': 0.5714286, 'binary_recall': 0.011887073, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.023289666}
confusion matrix:
       0  1
0  18061  6
1    665  8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.9792069, 'recall': 0.50384617, 'specificity': 0.50384617, 'f1': 0.4970163, 'auroc': 0.84703743, 'binary_precision': 1.0, 'binary_recall': 0.0076923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.015267175}
confusion matrix:
      0  1
0  5946  0
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_20.png
better model found
persisted
after epoch: 20,now: 2024-06-16 10:07:58.976888,epoch time: 0:17:07.397567,used: 5:41:17.213381,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96730596, 'precision': 0.7519975, 'recall': 0.5228983, 'specificity': 0.5228983, 'f1': 0.53504485, 'auroc': 0.8906879, 'binary_precision': 0.53543305, 'binary_recall': 0.04718945, 'binary_specificity': 0.99860716, 'binary_f1_score': 0.08673469}
confusion matrix:
       0   1
0  42300  59
1   1373  68
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.73236614, 'recall': 0.50929844, 'specificity': 0.50929844, 'f1': 0.50944924, 'auroc': 0.87572783, 'binary_precision': 0.5, 'binary_recall': 0.019316493, 'binary_specificity': 0.99928045, 'binary_f1_score': 0.03719599}
confusion matrix:
       0   1
0  18054  13
1    660  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.97951615, 'recall': 0.51153845, 'specificity': 0.51153845, 'f1': 0.5121002, 'auroc': 0.8566488, 'binary_precision': 1.0, 'binary_recall': 0.023076924, 'binary_specificity': 1.0, 'binary_f1_score': 0.045112785}
confusion matrix:
      0  1
0  5946  0
1   254  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_21.png
new oracle model saved
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9641942381858826, corresponding to test acc:                         0.9584273099899292 / 0.9590718746185303
after epoch: 21,now: 2024-06-16 10:24:43.441513,epoch time: 0:16:44.464625,used: 5:58:01.678006,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9672146, 'precision': 0.7410538, 'recall': 0.52587444, 'specificity': 0.52587444, 'f1': 0.5400798, 'auroc': 0.8892827, 'binary_precision': 0.5133333, 'binary_recall': 0.05347222, 'binary_specificity': 0.99827665, 'binary_f1_score': 0.09685534}
confusion matrix:
       0   1
0  42287  73
1   1363  77
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.77039874, 'recall': 0.51372844, 'specificity': 0.51372844, 'f1': 0.5178297, 'auroc': 0.8753059, 'binary_precision': 0.57575756, 'binary_recall': 0.028231798, 'binary_specificity': 0.9992251, 'binary_f1_score': 0.05382436}
confusion matrix:
       0   1
0  18053  14
1    654  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.97990316, 'recall': 0.52115387, 'specificity': 0.52115387, 'f1': 0.5303359, 'auroc': 0.850346, 'binary_precision': 1.0, 'binary_recall': 0.042307694, 'binary_specificity': 1.0, 'binary_f1_score': 0.08118081}
confusion matrix:
      0   1
0  5946   0
1   249  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_22.png
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-06-16 10:41:30.620489,epoch time: 0:16:47.178976,used: 6:14:48.856982,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9673973, 'precision': 0.75072205, 'recall': 0.53635263, 'specificity': 0.53635263, 'f1': 0.5573868, 'auroc': 0.88875306, 'binary_precision': 0.5320197, 'binary_recall': 0.07494795, 'binary_specificity': 0.99775726, 'binary_f1_score': 0.13138686}
confusion matrix:
       0    1
0  42264   95
1   1333  108
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.74862474, 'recall': 0.5179647, 'specificity': 0.5179647, 'f1': 0.5256091, 'auroc': 0.8867928, 'binary_precision': 0.5319149, 'binary_recall': 0.0371471, 'binary_specificity': 0.99878234, 'binary_f1_score': 0.06944444}
confusion matrix:
       0   1
0  18045  22
1    648  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.98005813, 'recall': 0.525, 'specificity': 0.525, 'f1': 0.53744525, 'auroc': 0.86139905, 'binary_precision': 1.0, 'binary_recall': 0.05, 'binary_specificity': 1.0, 'binary_f1_score': 0.095238104}
confusion matrix:
      0   1
0  5946   0
1   247  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_23.png
new oracle model saved
early stop counter: 1
val acc:0.9642475843429565, best validation acc: 0.9643543362617493, corresponding to test acc:                         0.9598775506019592 / 0.9601998329162598
after epoch: 23,now: 2024-06-16 10:58:18.674990,epoch time: 0:16:48.054501,used: 6:31:36.911483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9674201, 'precision': 0.74700594, 'recall': 0.5481183, 'specificity': 0.5481183, 'f1': 0.5751718, 'auroc': 0.89658475, 'binary_precision': 0.52380955, 'binary_recall': 0.099305555, 'binary_specificity': 0.9969311, 'binary_f1_score': 0.16695854}
confusion matrix:
       0    1
0  42230  130
1   1297  143
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.78502333, 'recall': 0.51884604, 'specificity': 0.51884604, 'f1': 0.52728224, 'auroc': 0.8833697, 'binary_precision': 0.60465115, 'binary_recall': 0.038632985, 'binary_specificity': 0.9990591, 'binary_f1_score': 0.0726257}
confusion matrix:
       0   1
0  18050  17
1    647  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.98005813, 'recall': 0.525, 'specificity': 0.525, 'f1': 0.53744525, 'auroc': 0.85842, 'binary_precision': 1.0, 'binary_recall': 0.05, 'binary_specificity': 1.0, 'binary_f1_score': 0.095238104}
confusion matrix:
      0   1
0  5946   0
1   247  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_24.png
better model found
persisted
after epoch: 24,now: 2024-06-16 11:17:17.700459,epoch time: 0:18:59.025469,used: 6:50:35.936952,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9673288, 'precision': 0.744202, 'recall': 0.5477132, 'specificity': 0.5477132, 'f1': 0.5744679, 'auroc': 0.8955842, 'binary_precision': 0.5182482, 'binary_recall': 0.098542675, 'binary_specificity': 0.99688375, 'binary_f1_score': 0.16559766}
confusion matrix:
       0    1
0  42227  132
1   1299  142
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.75822914, 'recall': 0.5194506, 'specificity': 0.5194506, 'f1': 0.52830964, 'auroc': 0.8836024, 'binary_precision': 0.5510204, 'binary_recall': 0.04011887, 'binary_specificity': 0.99878234, 'binary_f1_score': 0.074792236}
confusion matrix:
       0   1
0  18045  22
1    646  27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.9802132, 'recall': 0.52884614, 'specificity': 0.52884614, 'f1': 0.54445237, 'auroc': 0.8576145, 'binary_precision': 1.0, 'binary_recall': 0.057692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.10909091}
confusion matrix:
      0   1
0  5946   0
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_25.png
new oracle model saved
early stop counter: 1
val acc:0.9643543362617493, best validation acc: 0.9645677804946899, corresponding to test acc:                         0.9601998329162598 / 0.9605220556259155
after epoch: 25,now: 2024-06-16 11:35:12.334268,epoch time: 0:17:54.633809,used: 7:08:30.570761,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96678084, 'precision': 0.72334844, 'recall': 0.5504712, 'specificity': 0.5504712, 'f1': 0.5774672, 'auroc': 0.8983573, 'binary_precision': 0.47634068, 'binary_recall': 0.10486111, 'binary_specificity': 0.99608123, 'binary_f1_score': 0.1718839}
confusion matrix:
       0    1
0  42194  166
1   1289  151
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.75273466, 'recall': 0.52445745, 'specificity': 0.52445745, 'f1': 0.53710574, 'auroc': 0.8927598, 'binary_precision': 0.53968257, 'binary_recall': 0.05052006, 'binary_specificity': 0.99839485, 'binary_f1_score': 0.0923913}
confusion matrix:
       0   1
0  18038  29
1    639  34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.9802132, 'recall': 0.52884614, 'specificity': 0.52884614, 'f1': 0.54445237, 'auroc': 0.86425686, 'binary_precision': 1.0, 'binary_recall': 0.057692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.10909091}
confusion matrix:
      0   1
0  5946   0
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_26.png
early stop counter: 2
val acc:0.9643543362617493, best validation acc: 0.9645677804946899, corresponding to test acc:                         0.9601998329162598 / 0.9605220556259155
after epoch: 26,now: 2024-06-16 11:53:04.044973,epoch time: 0:17:51.710705,used: 7:26:22.281466,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.7359422, 'recall': 0.5472379, 'specificity': 0.5472379, 'f1': 0.5734441, 'auroc': 0.9022063, 'binary_precision': 0.5017794, 'binary_recall': 0.09778086, 'binary_specificity': 0.99669486, 'binary_f1_score': 0.16366802}
confusion matrix:
       0    1
0  42218  140
1   1301  141
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.75786936, 'recall': 0.52376986, 'specificity': 0.52376986, 'f1': 0.53594494, 'auroc': 0.88960046, 'binary_precision': 0.55, 'binary_recall': 0.049034175, 'binary_specificity': 0.9985056, 'binary_f1_score': 0.09004092}
confusion matrix:
       0   1
0  18040  27
1    640  33
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.9802132, 'recall': 0.52884614, 'specificity': 0.52884614, 'f1': 0.54445237, 'auroc': 0.8627012, 'binary_precision': 1.0, 'binary_recall': 0.057692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.10909091}
confusion matrix:
      0   1
0  5946   0
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_27.png
early stop counter: 3
val acc:0.9644076824188232, best validation acc: 0.9645677804946899, corresponding to test acc:                         0.9601998329162598 / 0.9605220556259155
after epoch: 27,now: 2024-06-16 12:12:04.764701,epoch time: 0:19:00.719728,used: 7:45:23.001194,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96671236, 'precision': 0.7197512, 'recall': 0.5484465, 'specificity': 0.5484465, 'f1': 0.5744606, 'auroc': 0.90445054, 'binary_precision': 0.46925566, 'binary_recall': 0.100764416, 'binary_specificity': 0.9961285, 'binary_f1_score': 0.16590388}
confusion matrix:
       0    1
0  42197  164
1   1294  145
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.7528058, 'recall': 0.529492, 'specificity': 0.529492, 'f1': 0.54566014, 'auroc': 0.89584094, 'binary_precision': 0.5394737, 'binary_recall': 0.060921248, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.10947931}
confusion matrix:
       0   1
0  18032  35
1    632  41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.8673942, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_28.png
new oracle model saved
early stop counter: 4
val acc:0.9644076824188232, best validation acc: 0.9645677804946899, corresponding to test acc:                         0.9601998329162598 / 0.9606832265853882
after epoch: 28,now: 2024-06-16 12:30:51.497314,epoch time: 0:18:46.732613,used: 8:04:09.733807,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96694064, 'precision': 0.72955054, 'recall': 0.5562559, 'specificity': 0.5562559, 'f1': 0.5857337, 'auroc': 0.90025485, 'binary_precision': 0.4883721, 'binary_recall': 0.11666667, 'binary_specificity': 0.99584514, 'binary_f1_score': 0.1883408}
confusion matrix:
       0    1
0  42184  176
1   1272  168
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.7510261, 'recall': 0.53235304, 'specificity': 0.53235304, 'f1': 0.55036366, 'auroc': 0.8966975, 'binary_precision': 0.53571427, 'binary_recall': 0.06686478, 'binary_specificity': 0.99784136, 'binary_f1_score': 0.118890345}
confusion matrix:
       0   1
0  18028  39
1    628  45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.9803684, 'recall': 0.5326923, 'specificity': 0.5326923, 'f1': 0.55135953, 'auroc': 0.86700886, 'binary_precision': 1.0, 'binary_recall': 0.06538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.12274369}
confusion matrix:
      0   1
0  5946   0
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_29.png
new oracle model saved
early stop counter: 5
val acc:0.9644076824188232, best validation acc: 0.9645677804946899, corresponding to test acc:                         0.9601998329162598 / 0.9608443379402161
after epoch: 29,now: 2024-06-16 12:47:52.798777,epoch time: 0:17:01.301463,used: 8:21:11.035270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9674886, 'precision': 0.7471305, 'recall': 0.5605642, 'specificity': 0.5605642, 'f1': 0.59260005, 'auroc': 0.9020773, 'binary_precision': 0.5232558, 'binary_recall': 0.125, 'binary_specificity': 0.99612844, 'binary_f1_score': 0.20179372}
confusion matrix:
       0    1
0  42196  164
1   1260  180
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.7689637, 'recall': 0.5346649, 'specificity': 0.5346649, 'f1': 0.5544084, 'auroc': 0.89656615, 'binary_precision': 0.5714286, 'binary_recall': 0.07132243, 'binary_specificity': 0.9980074, 'binary_f1_score': 0.12681638}
confusion matrix:
       0   1
0  18031  36
1    625  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.980446, 'recall': 0.5346154, 'specificity': 0.5346154, 'f1': 0.55477625, 'auroc': 0.86851597, 'binary_precision': 1.0, 'binary_recall': 0.06923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.12949641}
confusion matrix:
      0   1
0  5946   0
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_30.png
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-06-16 13:04:49.450171,epoch time: 0:16:56.651394,used: 8:38:07.686664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_04_26_41_seed_1_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:38:07.686664 at 2024-06-16 13:04:49.450171
persisted model performance metric: 

scalar performance:
{'acc': 0.96100545, 'precision': 0.980446, 'recall': 0.5346154, 'specificity': 0.5346154, 'f1': 0.55477625, 'auroc': 0.86851597, 'binary_precision': 1.0, 'binary_recall': 0.06923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.12949641}
confusion matrix:
      0   1
0  5946   0
1   242  18
oracle model performance metric: 

scalar performance:
{'acc': 0.96100545, 'precision': 0.980446, 'recall': 0.5346154, 'specificity': 0.5346154, 'f1': 0.55477625, 'auroc': 0.86851597, 'binary_precision': 1.0, 'binary_recall': 0.06923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.12949641}
confusion matrix:
      0   1
0  5946   0
1   242  18
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 688519 GiB | 688518 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |  36242 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 688519 GiB | 688518 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |  36242 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1428 MiB | 688498 GiB | 688498 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 688375 GiB | 688375 GiB |
|       from small pool |  35966 KiB |     71 MiB |    122 GiB |    122 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   2478 MiB |   1012 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   2374 MiB |    982 MiB |
|       from small pool |     74 MiB |     74 MiB |    104 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 527770 GiB | 527769 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 527632 GiB | 527632 GiB |
|       from small pool |   8813 KiB |  16408 KiB |    137 GiB |    137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   22715 K  |   22714 K  |
|       from large pool |      36    |      76    |    9038 K  |    9038 K  |
|       from small pool |    1242    |    1864    |   13677 K  |   13675 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   22715 K  |   22714 K  |
|       from large pool |      36    |      76    |    9038 K  |    9038 K  |
|       from small pool |    1242    |    1864    |   13677 K  |   13675 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      68    |      19    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      52    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     453    |   12958 K  |   12958 K  |
|       from large pool |       5    |      11    |    3538 K  |    3538 K  |
|       from small pool |      30    |     448    |    9419 K  |    9419 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 688498 GiB | 688498 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 688375 GiB | 688375 GiB |
|       from small pool |      0 KiB |     71 MiB |    122 GiB |    122 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 527770 GiB | 527770 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 527632 GiB | 527632 GiB |
|       from small pool |      0 KiB |  16408 KiB |    137 GiB |    137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   22715 K  |   22715 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13677 K  |   13677 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   22715 K  |   22715 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13677 K  |   13677 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   12958 K  |   12958 K  |
|       from large pool |       1    |      11    |    3538 K  |    3538 K  |
|       from small pool |       0    |     448    |    9419 K  |    9419 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 688519 GiB | 688519 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 688392 GiB | 688392 GiB |
|       from small pool |      0 KiB |     72 MiB |    126 GiB |    126 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 688498 GiB | 688498 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 688375 GiB | 688375 GiB |
|       from small pool |      0 KiB |     71 MiB |    122 GiB |    122 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 527770 GiB | 527770 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 527632 GiB | 527632 GiB |
|       from small pool |      0 KiB |  16408 KiB |    137 GiB |    137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   22715 K  |   22715 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13677 K  |   13677 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   22715 K  |   22715 K  |
|       from large pool |       2    |      76    |    9038 K  |    9038 K  |
|       from small pool |       0    |    1864    |   13677 K  |   13677 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   12958 K  |   12958 K  |
|       from large pool |       1    |      11    |    3538 K  |    3538 K  |
|       from small pool |       0    |     448    |    9419 K  |    9419 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284

 Experiment start at: 2024-06-16 13:12:03.242970
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.43688026, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.34698617, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.37299985, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-16 13:28:59.749694,epoch time: 0:16:56.506724,used: 0:16:56.506724,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96550226, 'precision': 0.48275113, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912242, 'auroc': 0.46302825, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42289  0
1   1511  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.39625797, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.3583446, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_2.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-16 13:45:31.184378,epoch time: 0:16:31.434684,used: 0:33:27.941408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.4787492, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.4092744, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.41444775, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_3.png
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 3,now: 2024-06-16 14:02:20.930333,epoch time: 0:16:49.745955,used: 0:50:17.687363,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.51811326, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.44574296, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.43217665, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_4.png
early stop counter: 3
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 4,now: 2024-06-16 14:18:58.120099,epoch time: 0:16:37.189766,used: 1:06:54.877129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.5621333, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.49834815, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.46620142, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_5.png
early stop counter: 4
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 5,now: 2024-06-16 14:35:57.670979,epoch time: 0:16:59.550880,used: 1:23:54.428009,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.60835683, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.5517876, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.5419197, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_6.png
early stop counter: 5
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 6,now: 2024-06-16 14:52:50.918136,epoch time: 0:16:53.247157,used: 1:40:47.675166,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9655251, 'precision': 0.48276255, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912301, 'auroc': 0.65671515, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42290  0
1   1510  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.59139645, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.6101806, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_7.png
early stop counter: 6
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 7,now: 2024-06-16 15:09:55.055721,epoch time: 0:17:04.137585,used: 1:57:51.812751,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.48273972, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912183, 'auroc': 0.6925849, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42288  0
1   1512  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.6564801, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.6468997, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_8.png
early stop counter: 7
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 8,now: 2024-06-16 15:26:52.948356,epoch time: 0:16:57.892635,used: 2:14:49.705386,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9655251, 'precision': 0.48276255, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4912301, 'auroc': 0.7443276, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42290  0
1   1510  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.70406306, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.7046281, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_9.png
early stop counter: 8
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 9,now: 2024-06-16 15:43:31.649006,epoch time: 0:16:38.700650,used: 2:31:28.406036,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.77749383, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.74436724, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.7434518, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_10.png
early stop counter: 9
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 10,now: 2024-06-16 16:00:09.667861,epoch time: 0:16:38.018855,used: 2:48:06.424891,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.7970725, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.77424777, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.7601043, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_11.png
early stop counter: 10
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 11,now: 2024-06-16 16:17:03.737603,epoch time: 0:16:54.069742,used: 3:05:00.494633,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.8156339, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.79851234, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.78147805, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_12.png
early stop counter: 11
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 12,now: 2024-06-16 16:33:51.042317,epoch time: 0:16:47.304714,used: 3:21:47.799347,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.8160833, 'recall': 0.5006491, 'specificity': 0.5006491, 'f1': 0.49253714, 'auroc': 0.8424276, 'binary_precision': 0.6666667, 'binary_recall': 0.0013218771, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.0026385225}
confusion matrix:
       0  1
0  42286  1
1   1511  2
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.83064365, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.811651, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_13.png
early stop counter: 12
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 13,now: 2024-06-16 16:50:39.031568,epoch time: 0:16:47.989251,used: 3:38:35.788598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96550226, 'precision': 0.81609476, 'recall': 0.5006496, 'specificity': 0.5006496, 'f1': 0.4925439, 'auroc': 0.8395729, 'binary_precision': 0.6666667, 'binary_recall': 0.0013227513, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.0026402639}
confusion matrix:
       0  1
0  42287  1
1   1510  2
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.83511245, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.80877566, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_14.png
early stop counter: 13
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 14,now: 2024-06-16 17:07:25.239494,epoch time: 0:16:46.207926,used: 3:55:21.996524,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.73281413, 'recall': 0.5022321, 'specificity': 0.5022321, 'f1': 0.495804, 'auroc': 0.8529374, 'binary_precision': 0.5, 'binary_recall': 0.0046296297, 'binary_specificity': 0.9998345, 'binary_f1_score': 0.009174312}
confusion matrix:
       0  1
0  42281  7
1   1505  7
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.84790075, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.8249998, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_15.png
early stop counter: 14
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 15,now: 2024-06-16 17:24:13.367430,epoch time: 0:16:48.127936,used: 4:12:10.124460,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96550226, 'precision': 0.7409748, 'recall': 0.50511366, 'specificity': 0.50511366, 'f1': 0.5015904, 'auroc': 0.8671895, 'binary_precision': 0.516129, 'binary_recall': 0.01058201, 'binary_specificity': 0.9996453, 'binary_f1_score': 0.02073882}
confusion matrix:
       0   1
0  42273  15
1   1496  16
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.8600111, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.8352351, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_16.png
early stop counter: 15
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 16,now: 2024-06-16 17:40:50.648973,epoch time: 0:16:37.281543,used: 4:28:47.406003,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9657306, 'precision': 0.7886397, 'recall': 0.5106572, 'specificity': 0.5106572, 'f1': 0.51233596, 'auroc': 0.8665769, 'binary_precision': 0.6111111, 'binary_recall': 0.021810971, 'binary_specificity': 0.9995034, 'binary_f1_score': 0.0421187}
confusion matrix:
       0   1
0  42266  21
1   1480  33
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.4839655, 'recall': 0.4999725, 'specificity': 0.4999725, 'f1': 0.4918388, 'auroc': 0.8610865, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18170  1
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.83293647, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_17.png
early stop counter: 16
val acc:0.9678794145584106, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 17,now: 2024-06-16 17:57:52.543047,epoch time: 0:17:01.894074,used: 4:45:49.300077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96584475, 'precision': 0.77875435, 'recall': 0.5167701, 'specificity': 0.5167701, 'f1': 0.5238023, 'auroc': 0.8791504, 'binary_precision': 0.59090906, 'binary_recall': 0.034391534, 'binary_specificity': 0.99914867, 'binary_f1_score': 0.065}
confusion matrix:
       0   1
0  42252  36
1   1460  52
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73399127, 'recall': 0.50080305, 'specificity': 0.50080305, 'f1': 0.49350777, 'auroc': 0.87225366, 'binary_precision': 0.5, 'binary_recall': 0.0016611295, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0033112583}
confusion matrix:
       0  1
0  18170  1
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.9808371, 'recall': 0.50619835, 'specificity': 0.50619835, 'f1': 0.5024762, 'auroc': 0.84490836, 'binary_precision': 1.0, 'binary_recall': 0.012396694, 'binary_specificity': 1.0, 'binary_f1_score': 0.024489796}
confusion matrix:
      0  1
0  5997  0
1   239  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_18.png
new oracle model saved
early stop counter: 17
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9616925716400146
after epoch: 18,now: 2024-06-16 18:15:39.275918,epoch time: 0:17:46.732871,used: 5:03:36.032948,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96568495, 'precision': 0.765252, 'recall': 0.51413864, 'specificity': 0.51413864, 'f1': 0.5189181, 'auroc': 0.88304865, 'binary_precision': 0.5641026, 'binary_recall': 0.029081296, 'binary_specificity': 0.999196, 'binary_f1_score': 0.055311125}
confusion matrix:
       0   1
0  42253  34
1   1469  44
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.698326, 'recall': 0.5023816, 'specificity': 0.5023816, 'f1': 0.4967636, 'auroc': 0.8754822, 'binary_precision': 0.42857143, 'binary_recall': 0.004983389, 'binary_specificity': 0.9997799, 'binary_f1_score': 0.009852217}
confusion matrix:
       0  1
0  18167  4
1    599  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.98076, 'recall': 0.5041322, 'specificity': 0.5041322, 'f1': 0.498388, 'auroc': 0.85080296, 'binary_precision': 1.0, 'binary_recall': 0.008264462, 'binary_specificity': 1.0, 'binary_f1_score': 0.016393442}
confusion matrix:
      0  1
0  5997  0
1   240  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_19.png
early stop counter: 18
val acc:0.9678794145584106, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9616925716400146
after epoch: 19,now: 2024-06-16 18:32:21.396885,epoch time: 0:16:42.120967,used: 5:20:18.153915,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96568495, 'precision': 0.7447572, 'recall': 0.5304075, 'specificity': 0.5304075, 'f1': 0.54736555, 'auroc': 0.8864788, 'binary_precision': 0.521978, 'binary_recall': 0.06287227, 'binary_specificity': 0.99794275, 'binary_f1_score': 0.11222681}
confusion matrix:
       0   1
0  42202  87
1   1416  95
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.77598584, 'recall': 0.5113527, 'specificity': 0.5113527, 'f1': 0.51426566, 'auroc': 0.88200736, 'binary_precision': 0.5833333, 'binary_recall': 0.023255814, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.044728436}
confusion matrix:
       0   1
0  18161  10
1    588  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.98145473, 'recall': 0.52272725, 'specificity': 0.52272725, 'f1': 0.53403044, 'auroc': 0.8547883, 'binary_precision': 1.0, 'binary_recall': 0.045454547, 'binary_specificity': 1.0, 'binary_f1_score': 0.08695653}
confusion matrix:
      0   1
0  5997   0
1   231  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_20.png
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-06-16 18:49:01.655275,epoch time: 0:16:40.258390,used: 5:36:58.412305,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96591324, 'precision': 0.7621825, 'recall': 0.529879, 'specificity': 0.529879, 'f1': 0.5467019, 'auroc': 0.8921257, 'binary_precision': 0.55688626, 'binary_recall': 0.061507937, 'binary_specificity': 0.99825007, 'binary_f1_score': 0.110780224}
confusion matrix:
       0   1
0  42214  74
1   1419  93
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.74357593, 'recall': 0.51127017, 'specificity': 0.51127017, 'f1': 0.51411766, 'auroc': 0.880322, 'binary_precision': 0.5185185, 'binary_recall': 0.023255814, 'binary_specificity': 0.99928457, 'binary_f1_score': 0.044515103}
confusion matrix:
       0   1
0  18158  13
1    588  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.9813002, 'recall': 0.51859504, 'specificity': 0.51859504, 'f1': 0.52632844, 'auroc': 0.8555509, 'binary_precision': 1.0, 'binary_recall': 0.037190083, 'binary_specificity': 1.0, 'binary_f1_score': 0.07171315}
confusion matrix:
      0  1
0  5997  0
1   233  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_21.png
early stop counter: 1
val acc:0.9679859280586243, best validation acc: 0.9681457281112671, corresponding to test acc:                         0.9629748463630676 / 0.9629748463630676
after epoch: 21,now: 2024-06-16 19:06:08.037812,epoch time: 0:17:06.382537,used: 5:54:04.794842,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96534246, 'precision': 0.72693, 'recall': 0.52861893, 'specificity': 0.52861893, 'f1': 0.54416794, 'auroc': 0.8960149, 'binary_precision': 0.4864865, 'binary_recall': 0.059484467, 'binary_specificity': 0.99775344, 'binary_f1_score': 0.10600706}
confusion matrix:
       0   1
0  42192  95
1   1423  90
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.78796726, 'recall': 0.51381695, 'specificity': 0.51381695, 'f1': 0.5189117, 'auroc': 0.8836717, 'binary_precision': 0.60714287, 'binary_recall': 0.028239202, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.05396825}
confusion matrix:
       0   1
0  18160  11
1    585  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.9812229, 'recall': 0.5165289, 'specificity': 0.5165289, 'f1': 0.5224318, 'auroc': 0.8553388, 'binary_precision': 1.0, 'binary_recall': 0.03305785, 'binary_specificity': 1.0, 'binary_f1_score': 0.064}
confusion matrix:
      0  1
0  5997  0
1   234  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_22.png
better model found
persisted
after epoch: 22,now: 2024-06-16 19:22:41.264088,epoch time: 0:16:33.226276,used: 6:10:38.021118,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96593606, 'precision': 0.7539846, 'recall': 0.53916776, 'specificity': 0.53916776, 'f1': 0.5615883, 'auroc': 0.8968216, 'binary_precision': 0.539823, 'binary_recall': 0.0807947, 'binary_specificity': 0.9975408, 'binary_f1_score': 0.140553}
confusion matrix:
       0    1
0  42186  104
1   1388  122
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.7344409, 'recall': 0.5152579, 'specificity': 0.5152579, 'f1': 0.52153164, 'auroc': 0.8874501, 'binary_precision': 0.5, 'binary_recall': 0.03156146, 'binary_specificity': 0.99895436, 'binary_f1_score': 0.059375}
confusion matrix:
       0   1
0  18152  19
1    583  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.98176414, 'recall': 0.53099173, 'specificity': 0.53099173, 'f1': 0.54907846, 'auroc': 0.8576809, 'binary_precision': 1.0, 'binary_recall': 0.06198347, 'binary_specificity': 1.0, 'binary_f1_score': 0.11673152}
confusion matrix:
      0   1
0  5997   0
1   227  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_23.png
new oracle model saved
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9682523012161255, corresponding to test acc:                         0.9624940156936646 / 0.9636159539222717
after epoch: 23,now: 2024-06-16 19:39:28.813510,epoch time: 0:16:47.549422,used: 6:27:25.570540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96550226, 'precision': 0.73510927, 'recall': 0.5427396, 'specificity': 0.5427396, 'f1': 0.56652, 'auroc': 0.9005147, 'binary_precision': 0.50187266, 'binary_recall': 0.088624336, 'binary_specificity': 0.9968549, 'binary_f1_score': 0.15064642}
confusion matrix:
       0    1
0  42155  133
1   1378  134
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.7519854, 'recall': 0.51855266, 'specificity': 0.51855266, 'f1': 0.5275426, 'auroc': 0.8895204, 'binary_precision': 0.53488374, 'binary_recall': 0.03820598, 'binary_specificity': 0.99889934, 'binary_f1_score': 0.07131783}
confusion matrix:
       0   1
0  18151  20
1    579  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.98176414, 'recall': 0.53099173, 'specificity': 0.53099173, 'f1': 0.54907846, 'auroc': 0.8608617, 'binary_precision': 1.0, 'binary_recall': 0.06198347, 'binary_specificity': 1.0, 'binary_f1_score': 0.11673152}
confusion matrix:
      0   1
0  5997   0
1   227  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_24.png
early stop counter: 2
val acc:0.9680925011634827, best validation acc: 0.9682523012161255, corresponding to test acc:                         0.9624940156936646 / 0.9636159539222717
after epoch: 24,now: 2024-06-16 19:56:04.448298,epoch time: 0:16:35.634788,used: 6:44:01.205328,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96575344, 'precision': 0.74411523, 'recall': 0.5568726, 'specificity': 0.5568726, 'f1': 0.5871582, 'auroc': 0.9041003, 'binary_precision': 0.51895046, 'binary_recall': 0.11764706, 'binary_specificity': 0.9960981, 'binary_f1_score': 0.19181035}
confusion matrix:
       0    1
0  42122  165
1   1335  178
---- Validation: 
scalar performance:
{'acc': 0.968199, 'precision': 0.75918025, 'recall': 0.52262294, 'specificity': 0.52262294, 'f1': 0.5347881, 'auroc': 0.8909569, 'binary_precision': 0.54901963, 'binary_recall': 0.046511628, 'binary_specificity': 0.99873424, 'binary_f1_score': 0.08575804}
confusion matrix:
       0   1
0  18148  23
1    574  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.9825394, 'recall': 0.5516529, 'specificity': 0.5516529, 'f1': 0.5847475, 'auroc': 0.8638954, 'binary_precision': 1.0, 'binary_recall': 0.10330579, 'binary_specificity': 1.0, 'binary_f1_score': 0.18726592}
confusion matrix:
      0   1
0  5997   0
1   217  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_25.png
new oracle model saved
early stop counter: 3
val acc:0.9681990146636963, best validation acc: 0.9682523012161255, corresponding to test acc:                         0.9624940156936646 / 0.9652187824249268
after epoch: 25,now: 2024-06-16 20:12:48.892620,epoch time: 0:16:44.444322,used: 7:00:45.649650,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96584475, 'precision': 0.7467567, 'recall': 0.5591504, 'specificity': 0.5591504, 'f1': 0.59041786, 'auroc': 0.89692545, 'binary_precision': 0.5240793, 'binary_recall': 0.12227363, 'binary_specificity': 0.9960272, 'binary_f1_score': 0.1982851}
confusion matrix:
       0    1
0  42119  168
1   1328  185
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.76262546, 'recall': 0.52829933, 'specificity': 0.52829933, 'f1': 0.5445651, 'auroc': 0.89265597, 'binary_precision': 0.5555556, 'binary_recall': 0.058139537, 'binary_specificity': 0.9984591, 'binary_f1_score': 0.10526316}
confusion matrix:
       0   1
0  18143  28
1    567  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.98269475, 'recall': 0.5557851, 'specificity': 0.5557851, 'f1': 0.5915668, 'auroc': 0.86447096, 'binary_precision': 1.0, 'binary_recall': 0.11157025, 'binary_specificity': 1.0, 'binary_f1_score': 0.2007435}
confusion matrix:
      0   1
0  5997   0
1   215  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_26.png
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-06-16 20:29:34.377555,epoch time: 0:16:45.484935,used: 7:17:31.134585,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96534246, 'precision': 0.730125, 'recall': 0.55926675, 'specificity': 0.55926675, 'f1': 0.58955723, 'auroc': 0.9025322, 'binary_precision': 0.49076518, 'binary_recall': 0.123097286, 'binary_specificity': 0.9954362, 'binary_f1_score': 0.1968254}
confusion matrix:
       0    1
0  42096  193
1   1325  186
---- Validation: 
scalar performance:
{'acc': 0.968199, 'precision': 0.75407684, 'recall': 0.52824426, 'specificity': 0.52824426, 'f1': 0.5443797, 'auroc': 0.89219666, 'binary_precision': 0.53846157, 'binary_recall': 0.058139537, 'binary_specificity': 0.998349, 'binary_f1_score': 0.10494752}
confusion matrix:
       0   1
0  18141  30
1    567  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.98285025, 'recall': 0.55991733, 'specificity': 0.55991733, 'f1': 0.59828657, 'auroc': 0.86525285, 'binary_precision': 1.0, 'binary_recall': 0.11983471, 'binary_specificity': 1.0, 'binary_f1_score': 0.21402216}
confusion matrix:
      0   1
0  5997   0
1   213  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_27.png
new oracle model saved
early stop counter: 1
val acc:0.9681990146636963, best validation acc: 0.9683055281639099, corresponding to test acc:                         0.9655393362045288 / 0.9658598899841309
after epoch: 27,now: 2024-06-16 20:46:16.146030,epoch time: 0:16:41.768475,used: 7:34:12.903060,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9656621, 'precision': 0.74041283, 'recall': 0.5679779, 'specificity': 0.5679779, 'f1': 0.60158485, 'auroc': 0.90420234, 'binary_precision': 0.51079136, 'binary_recall': 0.14077991, 'binary_specificity': 0.99517584, 'binary_f1_score': 0.22072539}
confusion matrix:
       0    1
0  42083  204
1   1300  213
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.7438942, 'recall': 0.53541666, 'specificity': 0.53541666, 'f1': 0.555921, 'auroc': 0.8975358, 'binary_precision': 0.5176471, 'binary_recall': 0.073089704, 'binary_specificity': 0.99774367, 'binary_f1_score': 0.12809317}
confusion matrix:
       0   1
0  18130  41
1    558  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.98292804, 'recall': 0.56198347, 'specificity': 0.56198347, 'f1': 0.6016098, 'auroc': 0.87070465, 'binary_precision': 1.0, 'binary_recall': 0.12396694, 'binary_specificity': 1.0, 'binary_f1_score': 0.22058824}
confusion matrix:
      0   1
0  5997   0
1   212  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_28.png
new oracle model saved
early stop counter: 2
val acc:0.9680925011634827, best validation acc: 0.9683055281639099, corresponding to test acc:                         0.9655393362045288 / 0.9660201668739319
after epoch: 28,now: 2024-06-16 21:02:56.539879,epoch time: 0:16:40.393849,used: 7:50:53.296909,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9656393, 'precision': 0.7385928, 'recall': 0.5689929, 'specificity': 0.5689929, 'f1': 0.6027282, 'auroc': 0.9048383, 'binary_precision': 0.5070422, 'binary_recall': 0.14295168, 'binary_specificity': 0.99503416, 'binary_f1_score': 0.22302529}
confusion matrix:
       0    1
0  42079  210
1   1295  216
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.7442796, 'recall': 0.53381056, 'specificity': 0.53381056, 'f1': 0.55336875, 'auroc': 0.899645, 'binary_precision': 0.5185185, 'binary_recall': 0.069767445, 'binary_specificity': 0.9978537, 'binary_f1_score': 0.12298684}
confusion matrix:
       0   1
0  18132  39
1    560  42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.98277247, 'recall': 0.55785125, 'specificity': 0.55785125, 'f1': 0.59493893, 'auroc': 0.8722929, 'binary_precision': 1.0, 'binary_recall': 0.11570248, 'binary_specificity': 1.0, 'binary_f1_score': 0.2074074}
confusion matrix:
      0   1
0  5997   0
1   214  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_29.png
early stop counter: 3
val acc:0.9680925011634827, best validation acc: 0.9683055281639099, corresponding to test acc:                         0.9655393362045288 / 0.9660201668739319
after epoch: 29,now: 2024-06-16 21:20:35.927764,epoch time: 0:17:39.387885,used: 8:08:32.684794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9659817, 'precision': 0.7495357, 'recall': 0.5668688, 'specificity': 0.5668688, 'f1': 0.60084486, 'auroc': 0.9083631, 'binary_precision': 0.52911395, 'binary_recall': 0.13813615, 'binary_specificity': 0.9956015, 'binary_f1_score': 0.21907757}
confusion matrix:
       0    1
0  42101  186
1   1304  209
---- Validation: 
scalar performance:
{'acc': 0.968199, 'precision': 0.7508447, 'recall': 0.53386563, 'specificity': 0.53386563, 'f1': 0.5535769, 'auroc': 0.8969146, 'binary_precision': 0.5316456, 'binary_recall': 0.069767445, 'binary_specificity': 0.9979638, 'binary_f1_score': 0.12334802}
confusion matrix:
       0   1
0  18134  37
1    560  42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.98300576, 'recall': 0.5640496, 'specificity': 0.5640496, 'f1': 0.6049091, 'auroc': 0.86620224, 'binary_precision': 1.0, 'binary_recall': 0.12809917, 'binary_specificity': 1.0, 'binary_f1_score': 0.22710621}
confusion matrix:
      0   1
0  5997   0
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21327284_30.png
new oracle model saved
early stop counter: 4
val acc:0.9681990146636963, best validation acc: 0.9683055281639099, corresponding to test acc:                         0.9655393362045288 / 0.9661805033683777
after epoch: 30,now: 2024-06-16 21:37:17.916234,epoch time: 0:16:41.988470,used: 8:25:14.673264,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_12_03_seed_2_21327284
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:25:14.673264 at 2024-06-16 21:37:17.916234
persisted model performance metric: 

scalar performance:
{'acc': 0.96553934, 'precision': 0.98269475, 'recall': 0.5557851, 'specificity': 0.5557851, 'f1': 0.5915668, 'auroc': 0.86447096, 'binary_precision': 1.0, 'binary_recall': 0.11157025, 'binary_specificity': 1.0, 'binary_f1_score': 0.2007435}
confusion matrix:
      0   1
0  5997   0
1   215  27
oracle model performance metric: 

scalar performance:
{'acc': 0.9661805, 'precision': 0.98300576, 'recall': 0.5640496, 'specificity': 0.5640496, 'f1': 0.6049091, 'auroc': 0.86620224, 'binary_precision': 1.0, 'binary_recall': 0.12809917, 'binary_specificity': 1.0, 'binary_f1_score': 0.22710621}
confusion matrix:
      0   1
0  5997   0
1   211  31
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_bs16_different_batchsizes/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool | 167936 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool | 167936 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB |   1428 MiB |   1067 TiB |   1067 TiB |
|       from large pool | 165120 KiB |   1358 MiB |   1067 TiB |   1067 TiB |
|       from small pool |  35967 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   3432 MiB |   1966 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   3298 MiB |   1906 MiB |
|       from small pool |     74 MiB |     74 MiB |    134 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB |    824 TiB |    824 TiB |
|       from large pool | 311296 KiB | 748328 KiB |    823 TiB |    823 TiB |
|       from small pool |   8813 KiB |  16408 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   36065 K  |   36064 K  |
|       from large pool |      36    |      76    |   14350 K  |   14350 K  |
|       from small pool |    1242    |    1864    |   21715 K  |   21713 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   36065 K  |   36064 K  |
|       from large pool |      36    |      76    |   14350 K  |   14350 K  |
|       from small pool |    1242    |    1864    |   21715 K  |   21713 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      86    |      37    |
|       from large pool |      12    |      13    |      19    |       7    |
|       from small pool |      37    |      37    |      67    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     453    |   20280 K  |   20280 K  |
|       from large pool |       5    |      11    |    5692 K  |    5692 K  |
|       from small pool |      30    |     448    |   14587 K  |   14587 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool |  16640 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |   1067 TiB |   1067 TiB |
|       from large pool |  16640 KiB |   1366 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |   1067 TiB |   1067 TiB |
|       from large pool |  16640 KiB |   1358 MiB |   1067 TiB |   1067 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   3432 MiB |   2920 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   3298 MiB |   2830 MiB |
|       from small pool |  45056 KiB |     74 MiB |    134 MiB |     90 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB |    824 TiB |    824 TiB |
|       from large pool | 298752 KiB | 748328 KiB |    823 TiB |    823 TiB |
|       from small pool |      0 KiB |  16408 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   36065 K  |   36065 K  |
|       from large pool |       2    |      76    |   14350 K  |   14350 K  |
|       from small pool |       0    |    1864    |   21715 K  |   21715 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   36065 K  |   36065 K  |
|       from large pool |       2    |      76    |   14350 K  |   14350 K  |
|       from small pool |       0    |    1864    |   21715 K  |   21715 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      86    |      55    |
|       from large pool |       9    |      13    |      19    |      10    |
|       from small pool |      22    |      37    |      67    |      45    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   20280 K  |   20280 K  |
|       from large pool |       1    |      11    |    5692 K  |    5692 K  |
|       from small pool |       0    |     448    |   14588 K  |   14588 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jun 16 21:38:05 2024]
Finished job 0.
1 of 1 steps (100%) done
