Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun 22 10:05:21 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974

 Experiment start at: 2024-06-22 10:15:48.336715
before training, model accuracy: 0.3101629912853241
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9055223, 'precision': 0.45277083, 'recall': 0.49998817, 'specificity': 0.49998817, 'f1': 0.47520944, 'auroc': 0.4816609, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42306  1
1   4413  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.33764142, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.35847265, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 10:26:13.646213,epoch time: 0:10:25.309498,used: 0:10:25.309498,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9055008, 'precision': 0.4527504, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520357, 'auroc': 0.5536071, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42305  0
1   4415  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.33407462, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.28059113, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-22 10:35:05.808147,epoch time: 0:08:52.161934,used: 0:19:17.471432,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9055008, 'precision': 0.4527504, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520357, 'auroc': 0.6305754, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42305  0
1   4415  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.36109895, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.3219151, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-22 10:43:59.520204,epoch time: 0:08:53.712057,used: 0:28:11.183489,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.90547943, 'precision': 0.45275912, 'recall': 0.49997637, 'specificity': 0.49997637, 'f1': 0.4751977, 'auroc': 0.6984818, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42304  2
1   4414  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.35535127, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.4196453, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_4.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-22 10:52:56.432201,epoch time: 0:08:56.911997,used: 0:37:08.095486,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9055223, 'precision': 0.45276114, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520947, 'auroc': 0.7619978, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42306  0
1   4414  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.37145174, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.4150514, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_5.png
early stop counter: 4
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 5,now: 2024-06-22 11:01:46.260960,epoch time: 0:08:49.828759,used: 0:45:57.924245,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9056293, 'precision': 0.9528106, 'recall': 0.50045323, 'specificity': 0.50045323, 'f1': 0.47614232, 'auroc': 0.813617, 'binary_precision': 1.0, 'binary_recall': 0.0009064129, 'binary_specificity': 1.0, 'binary_f1_score': 0.001811184}
confusion matrix:
       0  1
0  42307  0
1   4409  4
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.42000955, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.54976463, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_6.png
early stop counter: 5
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 6,now: 2024-06-22 11:10:31.413223,epoch time: 0:08:45.152263,used: 0:54:43.076508,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.90702057, 'precision': 0.93319845, 'recall': 0.50801075, 'specificity': 0.50801075, 'f1': 0.49140993, 'auroc': 0.8681946, 'binary_precision': 0.9594595, 'binary_recall': 0.016092476, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.031654038}
confusion matrix:
       0   1
0  42305   3
1   4341  71
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.43668222, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.5219337, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_7.png
early stop counter: 6
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 7,now: 2024-06-22 11:19:13.031584,epoch time: 0:08:41.618361,used: 1:03:24.694869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9069349, 'precision': 0.93230206, 'recall': 0.50766903, 'specificity': 0.50766903, 'f1': 0.490726, 'auroc': 0.84560156, 'binary_precision': 0.9577465, 'binary_recall': 0.015409019, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.030330064}
confusion matrix:
       0   1
0  42304   3
1   4345  68
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.41459116, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.5209009, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_8.png
early stop counter: 7
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 8,now: 2024-06-22 11:28:07.562622,epoch time: 0:08:54.531038,used: 1:12:19.225907,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.914619, 'precision': 0.93457425, 'recall': 0.550171, 'specificity': 0.550171, 'f1': 0.568686, 'auroc': 0.90242887, 'binary_precision': 0.9549356, 'binary_recall': 0.10083843, 'binary_specificity': 0.9995036, 'binary_f1_score': 0.18241443}
confusion matrix:
       0    1
0  42286   21
1   3968  445
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.48288983, 'recall': 0.4999449, 'specificity': 0.4999449, 'f1': 0.49126938, 'auroc': 0.4871518, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18147  2
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.68319345, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_9.png
early stop counter: 8
val acc:0.9656769037246704, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 9,now: 2024-06-22 11:36:56.094164,epoch time: 0:08:48.531542,used: 1:21:07.757449,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9235659, 'precision': 0.9467951, 'recall': 0.5981295, 'specificity': 0.5981295, 'f1': 0.64342475, 'auroc': 0.9123082, 'binary_precision': 0.9709497, 'binary_recall': 0.19687359, 'binary_specificity': 0.9993854, 'binary_f1_score': 0.32736865}
confusion matrix:
       0    1
0  42280   26
1   3545  869
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.48288983, 'recall': 0.4999449, 'specificity': 0.4999449, 'f1': 0.49126938, 'auroc': 0.49731725, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18147  2
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.6637399, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_10.png
new oracle model saved
early stop counter: 9
val acc:0.9656769037246704, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9584531784057617
after epoch: 10,now: 2024-06-22 11:45:44.730079,epoch time: 0:08:48.635915,used: 1:29:56.393364,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.92699057, 'precision': 0.9428865, 'recall': 0.6178205, 'specificity': 0.6178205, 'f1': 0.67045903, 'auroc': 0.9085928, 'binary_precision': 0.95955884, 'binary_recall': 0.23668103, 'binary_specificity': 0.99896, 'binary_f1_score': 0.37970543}
confusion matrix:
       0     1
0  42265    44
1   3367  1044
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.545411, 'recall': 0.5005848, 'specificity': 0.5005848, 'f1': 0.49274993, 'auroc': 0.52354586, 'binary_precision': 0.125, 'binary_recall': 0.00155521, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.0030721969}
confusion matrix:
       0  1
0  18142  7
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.8366661, 'recall': 0.5094118, 'specificity': 0.5094118, 'f1': 0.50812435, 'auroc': 0.70716536, 'binary_precision': 0.71428573, 'binary_recall': 0.019157087, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.037313428}
confusion matrix:
      0  1
0  5995  2
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_11.png
new oracle model saved
early stop counter: 10
val acc:0.9654640555381775, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9587727785110474
after epoch: 11,now: 2024-06-22 11:54:27.905092,epoch time: 0:08:43.175013,used: 1:38:39.568377,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9308005, 'precision': 0.9419595, 'recall': 0.6396219, 'specificity': 0.6396219, 'f1': 0.69842494, 'auroc': 0.90632176, 'binary_precision': 0.95377505, 'binary_recall': 0.28066197, 'binary_specificity': 0.9985819, 'binary_f1_score': 0.4337012}
confusion matrix:
       0     1
0  42249    60
1   3173  1238
---- Validation: 
scalar performance:
{'acc': 0.96482545, 'precision': 0.50790006, 'recall': 0.50025415, 'specificity': 0.50025415, 'f1': 0.49255678, 'auroc': 0.5140321, 'binary_precision': 0.05, 'binary_recall': 0.00155521, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.0030165915}
confusion matrix:
       0   1
0  18130  19
1    642   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.75766563, 'recall': 0.5184901, 'specificity': 0.5184901, 'f1': 0.5252596, 'auroc': 0.7122961, 'binary_precision': 0.5555556, 'binary_recall': 0.038314175, 'binary_specificity': 0.998666, 'binary_f1_score': 0.071684584}
confusion matrix:
      0   1
0  5989   8
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_12.png
early stop counter: 11
val acc:0.964825451374054, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9587727785110474
after epoch: 12,now: 2024-06-22 12:03:24.717814,epoch time: 0:08:56.812722,used: 1:47:36.381099,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9368151, 'precision': 0.9387789, 'recall': 0.67555225, 'specificity': 0.67555225, 'f1': 0.7400229, 'auroc': 0.9129349, 'binary_precision': 0.94089264, 'binary_recall': 0.35342094, 'binary_specificity': 0.9976835, 'binary_f1_score': 0.513834}
confusion matrix:
       0     1
0  42208    98
1   2854  1560
---- Validation: 
scalar performance:
{'acc': 0.9647722, 'precision': 0.52640224, 'recall': 0.5009767, 'specificity': 0.5009767, 'f1': 0.49403718, 'auroc': 0.52355134, 'binary_precision': 0.08695652, 'binary_recall': 0.00311042, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.006006006}
confusion matrix:
       0   1
0  18128  21
1    641   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7958343, 'recall': 0.5224049, 'specificity': 0.5224049, 'f1': 0.53239626, 'auroc': 0.6815016, 'binary_precision': 0.6315789, 'binary_recall': 0.04597701, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.08571429}
confusion matrix:
      0   1
0  5990   7
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_13.png
new oracle model saved
early stop counter: 12
val acc:0.9647722244262695, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.959092378616333
after epoch: 13,now: 2024-06-22 12:12:14.438477,epoch time: 0:08:49.720663,used: 1:56:26.101762,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9463827, 'precision': 0.92693543, 'recall': 0.7388687, 'specificity': 0.7388687, 'f1': 0.8005141, 'auroc': 0.9413438, 'binary_precision': 0.9053078, 'binary_recall': 0.48300862, 'binary_specificity': 0.99472886, 'binary_f1_score': 0.62993056}
confusion matrix:
       0     1
0  42083   223
1   2282  2132
---- Validation: 
scalar performance:
{'acc': 0.9628033, 'precision': 0.5271074, 'recall': 0.5029575, 'specificity': 0.5029575, 'f1': 0.49896038, 'auroc': 0.59541017, 'binary_precision': 0.0882353, 'binary_recall': 0.00933126, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.016877636}
confusion matrix:
       0   1
0  18087  62
1    637   6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8047465, 'recall': 0.5747941, 'specificity': 0.5747941, 'f1': 0.61387426, 'auroc': 0.7528553, 'binary_precision': 0.6451613, 'binary_recall': 0.1532567, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.247678}
confusion matrix:
      0   1
0  5975  22
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_14.png
new oracle model saved
early stop counter: 13
val acc:0.962803304195404, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9611697196960449
after epoch: 14,now: 2024-06-22 12:20:59.255573,epoch time: 0:08:44.817096,used: 2:05:10.918858,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9452269, 'precision': 0.9310249, 'recall': 0.7292415, 'specificity': 0.7292415, 'f1': 0.79270756, 'auroc': 0.9345182, 'binary_precision': 0.9153226, 'binary_recall': 0.46295038, 'binary_specificity': 0.99553263, 'binary_f1_score': 0.6148984}
confusion matrix:
       0     1
0  42118   189
1   2370  2043
---- Validation: 
scalar performance:
{'acc': 0.9632822, 'precision': 0.51931185, 'recall': 0.5017054, 'specificity': 0.5017054, 'f1': 0.49637753, 'auroc': 0.5652163, 'binary_precision': 0.07272727, 'binary_recall': 0.00622084, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.0114613185}
confusion matrix:
       0   1
0  18098  51
1    639   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.82130766, 'recall': 0.57129616, 'specificity': 0.57129616, 'f1': 0.60999596, 'auroc': 0.74842465, 'binary_precision': 0.6785714, 'binary_recall': 0.14559387, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.23974761}
confusion matrix:
      0   1
0  5979  18
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_15.png
new oracle model saved
early stop counter: 14
val acc:0.9632822275161743, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9614893198013306
after epoch: 15,now: 2024-06-22 12:30:00.075838,epoch time: 0:09:00.820265,used: 2:14:11.739123,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9500214, 'precision': 0.9234817, 'recall': 0.7639575, 'specificity': 0.7639575, 'f1': 0.8209529, 'auroc': 0.9364283, 'binary_precision': 0.8935606, 'binary_recall': 0.534557, 'binary_specificity': 0.9933581, 'binary_f1_score': 0.66893524}
confusion matrix:
       0     1
0  42026   281
1   2054  2359
---- Validation: 
scalar performance:
{'acc': 0.96243083, 'precision': 0.56744313, 'recall': 0.51026523, 'specificity': 0.51026523, 'f1': 0.5120998, 'auroc': 0.57681715, 'binary_precision': 0.16842106, 'binary_recall': 0.02488336, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.043360434}
confusion matrix:
       0   1
0  18070  79
1    627  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.7966472, 'recall': 0.6063607, 'specificity': 0.6063607, 'f1': 0.65214884, 'auroc': 0.7626138, 'binary_precision': 0.62637365, 'binary_recall': 0.21839081, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.32386366}
confusion matrix:
      0   1
0  5963  34
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_16.png
new oracle model saved
early stop counter: 15
val acc:0.9624308347702026, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9619686603546143
after epoch: 16,now: 2024-06-22 12:39:29.209283,epoch time: 0:09:29.133445,used: 2:23:40.872568,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.95154107, 'precision': 0.9315816, 'recall': 0.7678435, 'specificity': 0.7678435, 'f1': 0.8261934, 'auroc': 0.94017935, 'binary_precision': 0.90909094, 'binary_recall': 0.54133636, 'binary_specificity': 0.99435055, 'binary_f1_score': 0.6785917}
confusion matrix:
       0     1
0  42066   239
1   2025  2390
---- Validation: 
scalar performance:
{'acc': 0.96136653, 'precision': 0.52759445, 'recall': 0.50446385, 'specificity': 0.50446385, 'f1': 0.5022434, 'auroc': 0.6056621, 'binary_precision': 0.089108914, 'binary_recall': 0.01399689, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.02419355}
confusion matrix:
       0   1
0  18057  92
1    634   9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.77353424, 'recall': 0.60019666, 'specificity': 0.60019666, 'f1': 0.6424289, 'auroc': 0.7649878, 'binary_precision': 0.58064514, 'binary_recall': 0.20689656, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.30508476}
confusion matrix:
      0   1
0  5958  39
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_17.png
early stop counter: 16
val acc:0.9613665342330933, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9619686603546143
after epoch: 17,now: 2024-06-22 12:48:25.604366,epoch time: 0:08:56.395083,used: 2:32:37.267651,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.95537245, 'precision': 0.93796134, 'recall': 0.787047, 'specificity': 0.787047, 'f1': 0.8431798, 'auroc': 0.94866675, 'binary_precision': 0.9181916, 'binary_recall': 0.5794837, 'binary_specificity': 0.9946104, 'binary_f1_score': 0.7105373}
confusion matrix:
       0     1
0  42076   228
1   1857  2559
---- Validation: 
scalar performance:
{'acc': 0.96184546, 'precision': 0.5319612, 'recall': 0.5047118, 'specificity': 0.5047118, 'f1': 0.50251603, 'auroc': 0.62951607, 'binary_precision': 0.097826086, 'binary_recall': 0.01399689, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.024489796}
confusion matrix:
       0   1
0  18066  83
1    634   9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.80506873, 'recall': 0.62709993, 'specificity': 0.62709993, 'f1': 0.67577916, 'auroc': 0.7722546, 'binary_precision': 0.6415094, 'binary_recall': 0.2605364, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.37057218}
confusion matrix:
      0   1
0  5959  38
1   193  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_18.png
new oracle model saved
early stop counter: 17
val acc:0.9618454575538635, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.963087260723114
after epoch: 18,now: 2024-06-22 12:57:14.286173,epoch time: 0:08:48.681807,used: 2:41:25.949458,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9505779, 'precision': 0.90087485, 'recall': 0.78709066, 'specificity': 0.78709066, 'f1': 0.832204, 'auroc': 0.94915384, 'binary_precision': 0.8436684, 'binary_recall': 0.58550394, 'binary_specificity': 0.98867744, 'binary_f1_score': 0.6912689}
confusion matrix:
       0     1
0  41826   479
1   1830  2585
---- Validation: 
scalar performance:
{'acc': 0.9597169, 'precision': 0.57527936, 'recall': 0.52161115, 'specificity': 0.52161115, 'f1': 0.529801, 'auroc': 0.6529416, 'binary_precision': 0.18333334, 'binary_recall': 0.051321927, 'binary_specificity': 0.9919004, 'binary_f1_score': 0.08019441}
confusion matrix:
       0    1
0  18002  147
1    610   33
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.78152925, 'recall': 0.66907686, 'specificity': 0.66907686, 'f1': 0.7096498, 'auroc': 0.7999089, 'binary_precision': 0.59090906, 'binary_recall': 0.348659, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.43855423}
confusion matrix:
      0   1
0  5934  63
1   170  91
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_19.png
early stop counter: 18
val acc:0.9597169160842896, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.963087260723114
after epoch: 19,now: 2024-06-22 13:06:10.537356,epoch time: 0:08:56.251183,used: 2:50:22.200641,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.95721316, 'precision': 0.91688824, 'recall': 0.81653893, 'specificity': 0.81653893, 'f1': 0.85811806, 'auroc': 0.9571649, 'binary_precision': 0.8700184, 'binary_recall': 0.6430999, 'binary_specificity': 0.989978, 'binary_f1_score': 0.739544}
confusion matrix:
       0     1
0  41883   424
1   1575  2838
---- Validation: 
scalar performance:
{'acc': 0.95806724, 'precision': 0.56661016, 'recall': 0.5230073, 'specificity': 0.5230073, 'f1': 0.5311318, 'auroc': 0.6509638, 'binary_precision': 0.16589862, 'binary_recall': 0.05598756, 'binary_specificity': 0.990027, 'binary_f1_score': 0.08372093}
confusion matrix:
       0    1
0  17968  181
1    607   36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.7740402, 'recall': 0.6687434, 'specificity': 0.6687434, 'f1': 0.707388, 'auroc': 0.79983604, 'binary_precision': 0.5759494, 'binary_recall': 0.348659, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.43436757}
confusion matrix:
      0   1
0  5930  67
1   170  91
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_20.png
early stop counter: 19
val acc:0.9580672383308411, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.963087260723114
after epoch: 20,now: 2024-06-22 13:14:58.024756,epoch time: 0:08:47.487400,used: 2:59:09.688041,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9591395, 'precision': 0.917529, 'recall': 0.82882977, 'specificity': 0.82882977, 'f1': 0.86656046, 'auroc': 0.95140254, 'binary_precision': 0.8688476, 'binary_recall': 0.6681777, 'binary_specificity': 0.98948187, 'binary_f1_score': 0.7554132}
confusion matrix:
       0     1
0  41863   445
1   1464  2948
---- Validation: 
scalar performance:
{'acc': 0.9579076, 'precision': 0.55026364, 'recall': 0.51617414, 'specificity': 0.51617414, 'f1': 0.52118754, 'auroc': 0.63108635, 'binary_precision': 0.13366337, 'binary_recall': 0.041990668, 'binary_specificity': 0.9903576, 'binary_f1_score': 0.06390532}
confusion matrix:
       0    1
0  17974  175
1    616   27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.77545345, 'recall': 0.67065907, 'specificity': 0.67065907, 'f1': 0.70929235, 'auroc': 0.78673506, 'binary_precision': 0.5786164, 'binary_recall': 0.35249043, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.43809527}
confusion matrix:
      0   1
0  5930  67
1   169  92
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_21.png
early stop counter: 20
val acc:0.9579076170921326, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.963087260723114
after epoch: 21,now: 2024-06-22 13:23:54.633778,epoch time: 0:08:56.609022,used: 3:08:06.297063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9526969, 'precision': 0.91148025, 'recall': 0.79131305, 'specificity': 0.79131305, 'f1': 0.83859, 'auroc': 0.9467443, 'binary_precision': 0.8641322, 'binary_recall': 0.5923408, 'binary_specificity': 0.9902853, 'binary_f1_score': 0.7028771}
confusion matrix:
       0     1
0  41896   411
1   1799  2614
---- Validation: 
scalar performance:
{'acc': 0.9598233, 'precision': 0.58795696, 'recall': 0.5269166, 'specificity': 0.5269166, 'f1': 0.53763175, 'auroc': 0.65790284, 'binary_precision': 0.20833333, 'binary_recall': 0.0622084, 'binary_specificity': 0.9916249, 'binary_f1_score': 0.09580839}
confusion matrix:
       0    1
0  17997  152
1    603   40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.7935122, 'recall': 0.67515755, 'specificity': 0.67515755, 'f1': 0.71771586, 'auroc': 0.81200886, 'binary_precision': 0.6143791, 'binary_recall': 0.36015326, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.45410627}
confusion matrix:
      0   1
0  5938  59
1   167  94
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_22.png
new oracle model saved
early stop counter: 21
val acc:0.9598233103752136, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9638862013816833
after epoch: 22,now: 2024-06-22 13:32:38.500856,epoch time: 0:08:43.867078,used: 3:16:50.164141,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9548801, 'precision': 0.92964566, 'recall': 0.79008293, 'specificity': 0.79008293, 'f1': 0.84314454, 'auroc': 0.94984365, 'binary_precision': 0.90086955, 'binary_recall': 0.5869023, 'binary_specificity': 0.99326354, 'binary_f1_score': 0.7107574}
confusion matrix:
       0     1
0  42022   285
1   1823  2590
---- Validation: 
scalar performance:
{'acc': 0.96094084, 'precision': 0.5743667, 'recall': 0.5169944, 'specificity': 0.5169944, 'f1': 0.5231055, 'auroc': 0.6594341, 'binary_precision': 0.18181819, 'binary_recall': 0.04043546, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.06615776}
confusion matrix:
       0    1
0  18032  117
1    617   26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.8358532, 'recall': 0.65417, 'specificity': 0.65417, 'f1': 0.70811594, 'auroc': 0.80557585, 'binary_precision': 0.7008547, 'binary_recall': 0.31417623, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.43386242}
confusion matrix:
      0   1
0  5962  35
1   179  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_23.png
new oracle model saved
early stop counter: 22
val acc:0.9609408378601074, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9658037424087524
after epoch: 23,now: 2024-06-22 13:41:32.477473,epoch time: 0:08:53.976617,used: 3:25:44.140758,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9599529, 'precision': 0.9233539, 'recall': 0.82828987, 'specificity': 0.82828987, 'f1': 0.8682958, 'auroc': 0.9583863, 'binary_precision': 0.8806597, 'binary_recall': 0.6659864, 'binary_specificity': 0.99059325, 'binary_f1_score': 0.7584248}
confusion matrix:
       0     1
0  41912   398
1   1473  2937
---- Validation: 
scalar performance:
{'acc': 0.95753515, 'precision': 0.57438856, 'recall': 0.52873224, 'specificity': 0.52873224, 'f1': 0.5387889, 'auroc': 0.67979157, 'binary_precision': 0.18106996, 'binary_recall': 0.06842924, 'binary_specificity': 0.9890352, 'binary_f1_score': 0.099322796}
confusion matrix:
       0    1
0  17950  199
1    599   44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.74838716, 'recall': 0.6894807, 'specificity': 0.6894807, 'f1': 0.7144413, 'auroc': 0.81402326, 'binary_precision': 0.52284265, 'binary_recall': 0.394636, 'binary_specificity': 0.98432547, 'binary_f1_score': 0.44978166}
confusion matrix:
      0    1
0  5903   94
1   158  103
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_24.png
early stop counter: 23
val acc:0.9575351476669312, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9658037424087524
after epoch: 24,now: 2024-06-22 13:50:14.816014,epoch time: 0:08:42.338541,used: 3:34:26.479299,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.95999575, 'precision': 0.91510475, 'recall': 0.837428, 'specificity': 0.837428, 'f1': 0.8712131, 'auroc': 0.9565997, 'binary_precision': 0.8622652, 'binary_recall': 0.6862967, 'binary_specificity': 0.98855925, 'binary_f1_score': 0.76428294}
confusion matrix:
       0     1
0  41821   484
1   1385  3030
---- Validation: 
scalar performance:
{'acc': 0.9589719, 'precision': 0.5828833, 'recall': 0.5279759, 'specificity': 0.5279759, 'f1': 0.53862697, 'auroc': 0.662609, 'binary_precision': 0.1981132, 'binary_recall': 0.065318815, 'binary_specificity': 0.9906331, 'binary_f1_score': 0.098245606}
confusion matrix:
       0    1
0  17979  170
1    601   42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.78377986, 'recall': 0.6747407, 'specificity': 0.6747407, 'f1': 0.7147958, 'auroc': 0.7975797, 'binary_precision': 0.5949367, 'binary_recall': 0.36015326, 'binary_specificity': 0.989328, 'binary_f1_score': 0.44868734}
confusion matrix:
      0   1
0  5933  64
1   167  94
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_25.png
early stop counter: 24
val acc:0.9589719176292419, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9658037424087524
after epoch: 25,now: 2024-06-22 13:59:10.127321,epoch time: 0:08:55.311307,used: 3:43:21.790606,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.962607, 'precision': 0.91782105, 'recall': 0.8523922, 'specificity': 0.8523922, 'f1': 0.88159406, 'auroc': 0.96134233, 'binary_precision': 0.8647171, 'binary_recall': 0.7164855, 'binary_specificity': 0.98829895, 'binary_f1_score': 0.7836532}
confusion matrix:
       0     1
0  41809   495
1   1252  3164
---- Validation: 
scalar performance:
{'acc': 0.95615155, 'precision': 0.581828, 'recall': 0.5385167, 'specificity': 0.5385167, 'f1': 0.5504588, 'auroc': 0.6785049, 'binary_precision': 0.1952862, 'binary_recall': 0.090202175, 'binary_specificity': 0.98683125, 'binary_f1_score': 0.12340426}
confusion matrix:
       0    1
0  17910  239
1    585   58
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.7446387, 'recall': 0.7148833, 'specificity': 0.7148833, 'f1': 0.72866267, 'auroc': 0.8233082, 'binary_precision': 0.5131579, 'binary_recall': 0.44827586, 'binary_specificity': 0.98149073, 'binary_f1_score': 0.4785276}
confusion matrix:
      0    1
0  5886  111
1   144  117
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_26.png
early stop counter: 25
val acc:0.95615154504776, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9658037424087524
after epoch: 26,now: 2024-06-22 14:08:03.803945,epoch time: 0:08:53.676624,used: 3:52:15.467230,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.95854026, 'precision': 0.89976346, 'recall': 0.84534943, 'specificity': 0.84534943, 'f1': 0.8700266, 'auroc': 0.95719767, 'binary_precision': 0.82973623, 'binary_recall': 0.7058024, 'binary_specificity': 0.9848965, 'binary_f1_score': 0.7627679}
confusion matrix:
       0     1
0  41669   639
1   1298  3114
---- Validation: 
scalar performance:
{'acc': 0.9552469, 'precision': 0.5843733, 'recall': 0.5440488, 'specificity': 0.5440488, 'f1': 0.5563458, 'auroc': 0.67694396, 'binary_precision': 0.2, 'binary_recall': 0.102643855, 'binary_specificity': 0.9854537, 'binary_f1_score': 0.1356629}
confusion matrix:
       0    1
0  17885  264
1    577   66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.7491255, 'recall': 0.72804314, 'specificity': 0.72804314, 'f1': 0.73805344, 'auroc': 0.82472944, 'binary_precision': 0.52100843, 'binary_recall': 0.47509578, 'binary_specificity': 0.98099047, 'binary_f1_score': 0.496994}
confusion matrix:
      0    1
0  5883  114
1   137  124
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_27.png
early stop counter: 26
val acc:0.9552469253540039, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9658037424087524
after epoch: 27,now: 2024-06-22 14:16:49.249058,epoch time: 0:08:45.445113,used: 4:01:00.912343,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9599529, 'precision': 0.8967748, 'recall': 0.8601968, 'specificity': 0.8601968, 'f1': 0.8773538, 'auroc': 0.9656794, 'binary_precision': 0.820681, 'binary_recall': 0.73719984, 'binary_specificity': 0.9831939, 'binary_f1_score': 0.7767036}
confusion matrix:
       0     1
0  41595   711
1   1160  3254
---- Validation: 
scalar performance:
{'acc': 0.9541294, 'precision': 0.58866096, 'recall': 0.5524709, 'specificity': 0.5524709, 'f1': 0.56483394, 'auroc': 0.7130573, 'binary_precision': 0.208, 'binary_recall': 0.121306375, 'binary_specificity': 0.9836355, 'binary_f1_score': 0.15324166}
confusion matrix:
       0    1
0  17852  297
1    565   78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.7581121, 'recall': 0.7305425, 'specificity': 0.7305425, 'f1': 0.7434441, 'auroc': 0.8304126, 'binary_precision': 0.5387931, 'binary_recall': 0.4789272, 'binary_specificity': 0.98215777, 'binary_f1_score': 0.5070994}
confusion matrix:
      0    1
0  5890  107
1   136  125
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_28.png
early stop counter: 27
val acc:0.9541293978691101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9658037424087524
after epoch: 28,now: 2024-06-22 14:25:32.085995,epoch time: 0:08:42.836937,used: 4:09:43.749280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96292806, 'precision': 0.91516113, 'recall': 0.857517, 'specificity': 0.857517, 'f1': 0.8836146, 'auroc': 0.9635875, 'binary_precision': 0.85828876, 'binary_recall': 0.7275612, 'binary_specificity': 0.98747283, 'binary_f1_score': 0.7875368}
confusion matrix:
       0     1
0  41778   530
1   1202  3210
---- Validation: 
scalar performance:
{'acc': 0.9569498, 'precision': 0.5931932, 'recall': 0.54343027, 'specificity': 0.54343027, 'f1': 0.55726534, 'auroc': 0.6834012, 'binary_precision': 0.21768707, 'binary_recall': 0.09953344, 'binary_specificity': 0.9873271, 'binary_f1_score': 0.1366062}
confusion matrix:
       0    1
0  17919  230
1    579   64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.76930285, 'recall': 0.7405379, 'specificity': 0.7405379, 'f1': 0.75400186, 'auroc': 0.8270955, 'binary_precision': 0.5603448, 'binary_recall': 0.49808428, 'binary_specificity': 0.9829915, 'binary_f1_score': 0.5273833}
confusion matrix:
      0    1
0  5895  102
1   131  130
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_29.png
early stop counter: 28
val acc:0.956949770450592, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9658037424087524
after epoch: 29,now: 2024-06-22 14:34:11.911253,epoch time: 0:08:39.825258,used: 4:18:23.574538,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9640625, 'precision': 0.91618425, 'recall': 0.86426306, 'specificity': 0.86426306, 'f1': 0.8880323, 'auroc': 0.96947443, 'binary_precision': 0.8589811, 'binary_recall': 0.7412191, 'binary_specificity': 0.9873071, 'binary_f1_score': 0.7957669}
confusion matrix:
       0     1
0  41770   537
1   1142  3271
---- Validation: 
scalar performance:
{'acc': 0.9567369, 'precision': 0.6000809, 'recall': 0.5500706, 'specificity': 0.5500706, 'f1': 0.565022, 'auroc': 0.7280626, 'binary_precision': 0.23101266, 'binary_recall': 0.11353032, 'binary_specificity': 0.98661083, 'binary_f1_score': 0.15224192}
confusion matrix:
       0    1
0  17906  243
1    570   73
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.7609254, 'recall': 0.72337985, 'specificity': 0.72337985, 'f1': 0.7405035, 'auroc': 0.81653786, 'binary_precision': 0.545045, 'binary_recall': 0.46360153, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.5010352}
confusion matrix:
      0    1
0  5896  101
1   140  121
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_30.png
early stop counter: 29
val acc:0.9567369222640991, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9658037424087524
after epoch: 30,now: 2024-06-22 14:42:54.433379,epoch time: 0:08:42.522126,used: 4:27:06.096664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_15_48_seed_0_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:27:06.096664 at 2024-06-22 14:42:54.433379
persisted model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.35847265, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
oracle model performance metric: 

scalar performance:
{'acc': 0.96580374, 'precision': 0.8358532, 'recall': 0.65417, 'specificity': 0.65417, 'f1': 0.70811594, 'auroc': 0.80557585, 'binary_precision': 0.7008547, 'binary_recall': 0.31417623, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.43386242}
confusion matrix:
      0   1
0  5962  35
1   179  82
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204391 KiB | 755277 KiB |    781 TiB |    781 TiB |
|       from large pool | 167936 KiB | 683136 KiB |    781 TiB |    781 TiB |
|       from small pool |  36455 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204391 KiB | 755277 KiB |    781 TiB |    781 TiB |
|       from large pool | 167936 KiB | 683136 KiB |    781 TiB |    781 TiB |
|       from small pool |  36455 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 748328 KiB |    781 TiB |    781 TiB |
|       from large pool | 165120 KiB | 676736 KiB |    781 TiB |    781 TiB |
|       from small pool |  35968 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    930 MiB |    930 MiB |    930 MiB |      0 B   |
|       from large pool |    858 MiB |    858 MiB |    858 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 104856 KiB | 245592 KiB | 340154 GiB | 340154 GiB |
|       from large pool |  96256 KiB | 244616 KiB | 339957 GiB | 339957 GiB |
|       from small pool |   8600 KiB |  12448 KiB |    197 GiB |    197 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2076    |    3689    |   49470 K  |   49468 K  |
|       from large pool |      36    |      76    |   20484 K  |   20484 K  |
|       from small pool |    2040    |    3651    |   28986 K  |   28984 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2076    |    3689    |   49470 K  |   49468 K  |
|       from large pool |      36    |      76    |   20484 K  |   20484 K  |
|       from small pool |    2040    |    3651    |   28986 K  |   28984 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      15    |      15    |      15    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      49    |    1476    |   21964 K  |   21964 K  |
|       from large pool |       5    |      10    |    6677 K  |    6677 K  |
|       from small pool |      44    |    1470    |   15287 K  |   15287 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755277 KiB |    781 TiB |    781 TiB |
|       from large pool |  16640 KiB | 683136 KiB |    781 TiB |    781 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755277 KiB |    781 TiB |    781 TiB |
|       from large pool |  16640 KiB | 683136 KiB |    781 TiB |    781 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB |    781 TiB |    781 TiB |
|       from large pool |  16640 KiB | 676736 KiB |    781 TiB |    781 TiB |
|       from small pool |      0 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    930 MiB |    930 MiB | 643072 KiB |
|       from large pool | 264192 KiB |    858 MiB |    858 MiB | 614400 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 245592 KiB | 340154 GiB | 340154 GiB |
|       from large pool |  83712 KiB | 244616 KiB | 339957 GiB | 339957 GiB |
|       from small pool |      0 KiB |  16195 KiB |    197 GiB |    197 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3689    |   49470 K  |   49470 K  |
|       from large pool |       2    |      76    |   20484 K  |   20484 K  |
|       from small pool |       0    |    3651    |   28986 K  |   28986 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3689    |   49470 K  |   49470 K  |
|       from large pool |       2    |      76    |   20484 K  |   20484 K  |
|       from small pool |       0    |    3651    |   28986 K  |   28986 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   21965 K  |   21965 K  |
|       from large pool |       1    |      11    |    6677 K  |    6677 K  |
|       from small pool |       0    |    1470    |   15288 K  |   15288 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755277 KiB |    781 TiB |    781 TiB |
|       from large pool |  16640 KiB | 683136 KiB |    781 TiB |    781 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755277 KiB |    781 TiB |    781 TiB |
|       from large pool |  16640 KiB | 683136 KiB |    781 TiB |    781 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB |    781 TiB |    781 TiB |
|       from large pool |  16640 KiB | 676736 KiB |    781 TiB |    781 TiB |
|       from small pool |      0 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    930 MiB |    930 MiB | 643072 KiB |
|       from large pool | 264192 KiB |    858 MiB |    858 MiB | 614400 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 245592 KiB | 340154 GiB | 340154 GiB |
|       from large pool |  83712 KiB | 244616 KiB | 339957 GiB | 339957 GiB |
|       from small pool |      0 KiB |  16195 KiB |    197 GiB |    197 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3689    |   49470 K  |   49470 K  |
|       from large pool |       2    |      76    |   20484 K  |   20484 K  |
|       from small pool |       0    |    3651    |   28986 K  |   28986 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3689    |   49470 K  |   49470 K  |
|       from large pool |       2    |      76    |   20484 K  |   20484 K  |
|       from small pool |       0    |    3651    |   28986 K  |   28986 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   21965 K  |   21965 K  |
|       from large pool |       1    |      11    |    6677 K  |    6677 K  |
|       from small pool |       0    |    1470    |   15288 K  |   15288 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974

 Experiment start at: 2024-06-22 14:47:39.310530
before training, model accuracy: 0.14647115767002106
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90391695, 'precision': 0.46498814, 'recall': 0.4984345, 'specificity': 0.4984345, 'f1': 0.47565424, 'auroc': 0.45652455, 'binary_precision': 0.022727273, 'binary_recall': 0.00092571165, 'binary_specificity': 0.9959433, 'binary_f1_score': 0.0017789638}
confusion matrix:
       0    1
0  42227  172
1   4317    4
---- Validation: 
scalar performance:
{'acc': 0.93585914, 'precision': 0.4872201, 'recall': 0.48965165, 'specificity': 0.48965165, 'f1': 0.48837033, 'auroc': 0.3245474, 'binary_precision': 0.011090573, 'binary_recall': 0.008915304, 'binary_specificity': 0.970388, 'binary_f1_score': 0.009884678}
confusion matrix:
       0    1
0  17532  535
1    667    6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94553655, 'precision': 0.4787859, 'recall': 0.49344096, 'specificity': 0.49344096, 'f1': 0.48600298, 'auroc': 0.20419076, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9868819, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5868  78
1   260   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 14:56:46.165902,epoch time: 0:09:06.855372,used: 0:09:06.855372,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9066995, 'precision': 0.46796462, 'recall': 0.49971458, 'specificity': 0.49971458, 'f1': 0.47576225, 'auroc': 0.51414883, 'binary_precision': 0.028571429, 'binary_recall': 0.00023116042, 'binary_specificity': 0.999198, 'binary_f1_score': 0.00045861042}
confusion matrix:
       0   1
0  42360  34
1   4325   1
---- Validation: 
scalar performance:
{'acc': 0.9632871, 'precision': 0.5114659, 'recall': 0.5003001, 'specificity': 0.5003001, 'f1': 0.4920989, 'auroc': 0.31607595, 'binary_precision': 0.05882353, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9991144, 'binary_f1_score': 0.0028985506}
confusion matrix:
       0   1
0  18051  16
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.18688986, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-22 15:05:44.827140,epoch time: 0:08:58.661238,used: 0:18:05.516610,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90744865, 'precision': 0.45372432, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47573948, 'auroc': 0.5709419, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42396  0
1   4324  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.34581816, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.23741801, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_3.png
better model found
persisted
after epoch: 3,now: 2024-06-22 15:14:39.444126,epoch time: 0:08:54.616986,used: 0:27:00.133596,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9074058, 'precision': 0.45372233, 'recall': 0.49997643, 'specificity': 0.49997643, 'f1': 0.4757277, 'auroc': 0.61598563, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42394  2
1   4324  0
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.4820428, 'recall': 0.4999723, 'specificity': 0.4999723, 'f1': 0.49084386, 'auroc': 0.34211567, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18066  1
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.267929, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_4.png
early stop counter: 1
val acc:0.9640341401100159, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 4,now: 2024-06-22 15:23:43.442967,epoch time: 0:09:03.998841,used: 0:36:04.132437,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.90744865, 'precision': 0.45374373, 'recall': 0.49997643, 'specificity': 0.49997643, 'f1': 0.47573948, 'auroc': 0.67574716, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42396  2
1   4322  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.33292478, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.2422967, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_5.png
early stop counter: 2
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-22 15:32:34.688449,epoch time: 0:08:51.245482,used: 0:44:55.377919,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9067637, 'precision': 0.46760964, 'recall': 0.49970293, 'specificity': 0.49970293, 'f1': 0.4757801, 'auroc': 0.74479973, 'binary_precision': 0.027777778, 'binary_recall': 0.00023137436, 'binary_specificity': 0.9991745, 'binary_f1_score': 0.0004589261}
confusion matrix:
       0   1
0  42363  35
1   4321   1
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.48204088, 'recall': 0.49991697, 'specificity': 0.49991697, 'f1': 0.4908162, 'auroc': 0.362809, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18064  3
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.29879624, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_6.png
early stop counter: 3
val acc:0.9639274477958679, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 6,now: 2024-06-22 15:41:22.852567,epoch time: 0:08:48.164118,used: 0:53:43.542037,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9055437, 'precision': 0.46960992, 'recall': 0.49927357, 'specificity': 0.49927357, 'f1': 0.4758926, 'auroc': 0.81189626, 'binary_precision': 0.031914894, 'binary_recall': 0.0006936416, 'binary_specificity': 0.9978535, 'binary_f1_score': 0.0013577732}
confusion matrix:
       0   1
0  42304  91
1   4322   3
---- Validation: 
scalar performance:
{'acc': 0.96318036, 'precision': 0.48202744, 'recall': 0.49952954, 'specificity': 0.49952954, 'f1': 0.49062243, 'auroc': 0.3996438, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9990591, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18050  17
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.38310823, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_7.png
early stop counter: 4
val acc:0.9631803631782532, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 7,now: 2024-06-22 15:50:11.428516,epoch time: 0:08:48.575949,used: 1:02:32.117986,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9065711, 'precision': 0.59674853, 'recall': 0.50223845, 'specificity': 0.50223845, 'f1': 0.4813702, 'auroc': 0.83644783, 'binary_precision': 0.2857143, 'binary_recall': 0.006010171, 'binary_specificity': 0.9984668, 'binary_f1_score': 0.011772696}
confusion matrix:
       0   1
0  42329  65
1   4300  26
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.48203993, 'recall': 0.4998893, 'specificity': 0.4998893, 'f1': 0.49080238, 'auroc': 0.42617562, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18063  4
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5160707, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_8.png
early stop counter: 5
val acc:0.9638740420341492, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 8,now: 2024-06-22 15:59:07.303162,epoch time: 0:08:55.874646,used: 1:11:27.992632,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9083262, 'precision': 0.7471911, 'recall': 0.51522887, 'specificity': 0.51522887, 'f1': 0.50699645, 'auroc': 0.84743524, 'binary_precision': 0.58436215, 'binary_recall': 0.03283996, 'binary_specificity': 0.9976177, 'binary_f1_score': 0.06218524}
confusion matrix:
       0    1
0  42295  101
1   4182  142
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.48203993, 'recall': 0.4998893, 'specificity': 0.4998893, 'f1': 0.49080238, 'auroc': 0.40181488, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18063  4
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.4308431, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_9.png
early stop counter: 6
val acc:0.9638740420341492, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 9,now: 2024-06-22 16:07:49.817376,epoch time: 0:08:42.514214,used: 1:20:10.506846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9171661, 'precision': 0.84811586, 'recall': 0.57140183, 'specificity': 0.57140183, 'f1': 0.60177284, 'auroc': 0.8968956, 'binary_precision': 0.7765568, 'binary_recall': 0.14712006, 'binary_specificity': 0.99568367, 'binary_f1_score': 0.24737458}
confusion matrix:
       0    1
0  42214  183
1   3687  636
---- Validation: 
scalar performance:
{'acc': 0.96254003, 'precision': 0.48201594, 'recall': 0.49919742, 'specificity': 0.49919742, 'f1': 0.49045628, 'auroc': 0.4485131, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99839485, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18038  29
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.4850682, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_10.png
early stop counter: 7
val acc:0.9625400304794312, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 10,now: 2024-06-22 16:16:29.080166,epoch time: 0:08:39.262790,used: 1:28:49.769636,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9215539, 'precision': 0.8651122, 'recall': 0.59790516, 'specificity': 0.59790516, 'f1': 0.6398963, 'auroc': 0.89609814, 'binary_precision': 0.8059424, 'binary_recall': 0.20074005, 'binary_specificity': 0.9950703, 'binary_f1_score': 0.32142192}
confusion matrix:
       0    1
0  42187  209
1   3456  868
---- Validation: 
scalar performance:
{'acc': 0.9626467, 'precision': 0.48201784, 'recall': 0.4992528, 'specificity': 0.4992528, 'f1': 0.49048397, 'auroc': 0.4487627, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9985056, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18040  27
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.56777084, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_11.png
early stop counter: 8
val acc:0.9626467227935791, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 11,now: 2024-06-22 16:25:10.312578,epoch time: 0:08:41.232412,used: 1:37:31.002048,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9215111, 'precision': 0.8689555, 'recall': 0.59631294, 'specificity': 0.59631294, 'f1': 0.63793737, 'auroc': 0.91613406, 'binary_precision': 0.8139313, 'binary_recall': 0.19722544, 'binary_specificity': 0.9954004, 'binary_f1_score': 0.31751353}
confusion matrix:
       0    1
0  42200  195
1   3472  853
---- Validation: 
scalar performance:
{'acc': 0.9628068, 'precision': 0.48202074, 'recall': 0.4993358, 'specificity': 0.4993358, 'f1': 0.4905255, 'auroc': 0.51946205, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9986716, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18043  24
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.68972677, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_12.png
early stop counter: 9
val acc:0.9628068208694458, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 12,now: 2024-06-22 16:33:48.208726,epoch time: 0:08:37.896148,used: 1:46:08.898196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9292594, 'precision': 0.8779698, 'recall': 0.64672124, 'specificity': 0.64672124, 'f1': 0.70099086, 'auroc': 0.8978574, 'binary_precision': 0.82296956, 'binary_recall': 0.30002314, 'binary_specificity': 0.99341935, 'binary_f1_score': 0.43973556}
confusion matrix:
       0     1
0  42118   279
1   3026  1297
---- Validation: 
scalar performance:
{'acc': 0.9617396, 'precision': 0.48200148, 'recall': 0.4987823, 'specificity': 0.4987823, 'f1': 0.49024832, 'auroc': 0.5006288, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18023  44
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.63527405, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_13.png
early stop counter: 10
val acc:0.9617395997047424, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 13,now: 2024-06-22 16:42:25.796908,epoch time: 0:08:37.588182,used: 1:54:46.486378,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.93660104, 'precision': 0.8956696, 'recall': 0.68750286, 'specificity': 0.68750286, 'f1': 0.74658096, 'auroc': 0.91510576, 'binary_precision': 0.85103095, 'binary_recall': 0.38182238, 'binary_specificity': 0.9931833, 'binary_f1_score': 0.5271392}
confusion matrix:
       0     1
0  42107   289
1   2673  1651
---- Validation: 
scalar performance:
{'acc': 0.96163285, 'precision': 0.48199958, 'recall': 0.49872696, 'specificity': 0.49872696, 'f1': 0.49022064, 'auroc': 0.5501327, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9974539, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18021  46
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7650658, 'recall': 0.50744003, 'specificity': 0.50744003, 'f1': 0.5043185, 'auroc': 0.7200326, 'binary_precision': 0.5714286, 'binary_recall': 0.015384615, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.029962547}
confusion matrix:
      0  1
0  5943  3
1   256  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_14.png
new oracle model saved
early stop counter: 11
val acc:0.9616328477859497, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9582661986351013
after epoch: 14,now: 2024-06-22 16:51:03.267233,epoch time: 0:08:37.470325,used: 2:03:23.956703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9416952, 'precision': 0.9047499, 'recall': 0.71606207, 'specificity': 0.71606207, 'f1': 0.7754984, 'auroc': 0.93196815, 'binary_precision': 0.86396724, 'binary_recall': 0.43917668, 'binary_specificity': 0.99294746, 'binary_f1_score': 0.58233666}
confusion matrix:
       0     1
0  42097   299
1   2425  1899
---- Validation: 
scalar performance:
{'acc': 0.9617396, 'precision': 0.48200148, 'recall': 0.4987823, 'specificity': 0.4987823, 'f1': 0.49024832, 'auroc': 0.559265, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18023  44
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.6793415, 'recall': 0.5071878, 'specificity': 0.5071878, 'f1': 0.5040258, 'auroc': 0.7454151, 'binary_precision': 0.4, 'binary_recall': 0.015384615, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.02962963}
confusion matrix:
      0  1
0  5940  6
1   256  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_15.png
early stop counter: 12
val acc:0.9617395997047424, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9582661986351013
after epoch: 15,now: 2024-06-22 16:59:45.018089,epoch time: 0:08:41.750856,used: 2:12:05.707559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9426798, 'precision': 0.8904069, 'recall': 0.7336947, 'specificity': 0.7336947, 'f1': 0.787806, 'auroc': 0.9328036, 'binary_precision': 0.8319226, 'binary_recall': 0.47722542, 'binary_specificity': 0.9901639, 'binary_f1_score': 0.60652363}
confusion matrix:
       0     1
0  41978   417
1   2261  2064
---- Validation: 
scalar performance:
{'acc': 0.9608324, 'precision': 0.48994645, 'recall': 0.4990271, 'specificity': 0.4990271, 'f1': 0.49137068, 'auroc': 0.576278, 'binary_precision': 0.015873017, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.0027173911}
confusion matrix:
       0   1
0  18005  62
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.82588905, 'recall': 0.51697135, 'specificity': 0.51697135, 'f1': 0.5224637, 'auroc': 0.73458827, 'binary_precision': 0.6923077, 'binary_recall': 0.034615386, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.06593407}
confusion matrix:
      0  1
0  5942  4
1   251  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_16.png
new oracle model saved
early stop counter: 13
val acc:0.960832417011261, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9589107036590576
after epoch: 16,now: 2024-06-22 17:08:29.889740,epoch time: 0:08:44.871651,used: 2:20:50.579210,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9468322, 'precision': 0.90282774, 'recall': 0.7524329, 'specificity': 0.7524329, 'f1': 0.8063711, 'auroc': 0.93652785, 'binary_precision': 0.8533026, 'binary_recall': 0.513876, 'binary_specificity': 0.99098974, 'binary_f1_score': 0.6414549}
confusion matrix:
       0     1
0  42014   382
1   2102  2222
---- Validation: 
scalar performance:
{'acc': 0.9604055, 'precision': 0.50805086, 'recall': 0.50095147, 'specificity': 0.50095147, 'f1': 0.4952326, 'auroc': 0.5881679, 'binary_precision': 0.051948052, 'binary_recall': 0.0059435363, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.010666667}
confusion matrix:
       0   1
0  17994  73
1    669   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.81080157, 'recall': 0.55450785, 'specificity': 0.55450785, 'f1': 0.5852362, 'auroc': 0.7857718, 'binary_precision': 0.65909094, 'binary_recall': 0.11153846, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.19078948}
confusion matrix:
      0   1
0  5931  15
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_17.png
new oracle model saved
early stop counter: 14
val acc:0.9604055285453796, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9603609442710876
after epoch: 17,now: 2024-06-22 17:17:24.105811,epoch time: 0:08:54.216071,used: 2:29:44.795281,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9479452, 'precision': 0.896247, 'recall': 0.76623535, 'specificity': 0.76623535, 'f1': 0.81541175, 'auroc': 0.9355837, 'binary_precision': 0.8374911, 'binary_recall': 0.543227, 'binary_specificity': 0.98924375, 'binary_f1_score': 0.6590017}
confusion matrix:
       0     1
0  41938   456
1   1976  2350
---- Validation: 
scalar performance:
{'acc': 0.95928496, 'precision': 0.50246483, 'recall': 0.5003703, 'specificity': 0.5003703, 'f1': 0.49479556, 'auroc': 0.5789946, 'binary_precision': 0.040816326, 'binary_recall': 0.0059435363, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.010376135}
confusion matrix:
       0   1
0  17973  94
1    669   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.7251294, 'recall': 0.5403736, 'specificity': 0.5403736, 'f1': 0.56135225, 'auroc': 0.721877, 'binary_precision': 0.4888889, 'binary_recall': 0.08461539, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.1442623}
confusion matrix:
      0   1
0  5923  23
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_18.png
early stop counter: 15
val acc:0.9592849612236023, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9603609442710876
after epoch: 18,now: 2024-06-22 17:26:55.345236,epoch time: 0:09:31.239425,used: 2:39:16.034706,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9562286, 'precision': 0.9039786, 'recall': 0.81758916, 'specificity': 0.81758916, 'f1': 0.8542998, 'auroc': 0.9543637, 'binary_precision': 0.8430723, 'binary_recall': 0.647467, 'binary_specificity': 0.98771137, 'binary_f1_score': 0.73243487}
confusion matrix:
       0     1
0  41876   521
1   1524  2799
---- Validation: 
scalar performance:
{'acc': 0.95720387, 'precision': 0.51275605, 'recall': 0.50286734, 'specificity': 0.50286734, 'f1': 0.50003725, 'auroc': 0.64188063, 'binary_precision': 0.06122449, 'binary_recall': 0.013372957, 'binary_specificity': 0.9923618, 'binary_f1_score': 0.021951219}
confusion matrix:
       0    1
0  17929  138
1    664    9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.80847937, 'recall': 0.6014075, 'specificity': 0.6014075, 'f1': 0.6476987, 'auroc': 0.77658474, 'binary_precision': 0.6506024, 'binary_recall': 0.20769231, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.3148688}
confusion matrix:
      0   1
0  5917  29
1   206  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_19.png
new oracle model saved
early stop counter: 16
val acc:0.9572038650512695, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9621334075927734
after epoch: 19,now: 2024-06-22 17:36:08.447828,epoch time: 0:09:13.102592,used: 2:48:29.137298,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9499572, 'precision': 0.9144451, 'recall': 0.7641737, 'specificity': 0.7641737, 'f1': 0.81885767, 'auroc': 0.9383408, 'binary_precision': 0.874387, 'binary_recall': 0.5362017, 'binary_specificity': 0.99214566, 'binary_f1_score': 0.6647548}
confusion matrix:
       0     1
0  42064   333
1   2005  2318
---- Validation: 
scalar performance:
{'acc': 0.9605656, 'precision': 0.50910676, 'recall': 0.5010345, 'specificity': 0.5010345, 'f1': 0.4952957, 'auroc': 0.5959831, 'binary_precision': 0.054054055, 'binary_recall': 0.0059435363, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.010709505}
confusion matrix:
       0   1
0  17997  70
1    669   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.8050891, 'recall': 0.56194794, 'specificity': 0.56194794, 'f1': 0.5959862, 'auroc': 0.75530285, 'binary_precision': 0.64705884, 'binary_recall': 0.12692308, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.21221867}
confusion matrix:
      0   1
0  5928  18
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_20.png
early stop counter: 17
val acc:0.9605656266212463, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9621334075927734
after epoch: 20,now: 2024-06-22 17:45:34.950591,epoch time: 0:09:26.502763,used: 2:57:55.640061,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.95327485, 'precision': 0.89871794, 'recall': 0.80213195, 'specificity': 0.80213195, 'f1': 0.8420926, 'auroc': 0.9458276, 'binary_precision': 0.8355263, 'binary_recall': 0.6166474, 'binary_specificity': 0.9876165, 'binary_f1_score': 0.70959157}
confusion matrix:
       0     1
0  41870   525
1   1658  2667
---- Validation: 
scalar performance:
{'acc': 0.9538954, 'precision': 0.5326696, 'recall': 0.5118805, 'specificity': 0.5118805, 'f1': 0.5145022, 'auroc': 0.6508616, 'binary_precision': 0.10041841, 'binary_recall': 0.035661217, 'binary_specificity': 0.9880999, 'binary_f1_score': 0.052631576}
confusion matrix:
       0    1
0  17852  215
1    649   24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.73155165, 'recall': 0.6395948, 'specificity': 0.6395948, 'f1': 0.6726564, 'auroc': 0.79373527, 'binary_precision': 0.4935065, 'binary_recall': 0.2923077, 'binary_specificity': 0.9868819, 'binary_f1_score': 0.36714977}
confusion matrix:
      0   1
0  5868  78
1   184  76
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_21.png
early stop counter: 18
val acc:0.9538953900337219, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9621334075927734
after epoch: 21,now: 2024-06-22 17:54:48.155362,epoch time: 0:09:13.204771,used: 3:07:08.844832,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9538742, 'precision': 0.9073658, 'recall': 0.7973298, 'specificity': 0.7973298, 'f1': 0.84165347, 'auroc': 0.9545584, 'binary_precision': 0.8538336, 'binary_recall': 0.60522664, 'binary_specificity': 0.989433, 'binary_f1_score': 0.7083503}
confusion matrix:
       0     1
0  41948   448
1   1707  2617
---- Validation: 
scalar performance:
{'acc': 0.95789754, 'precision': 0.53902274, 'recall': 0.5089493, 'specificity': 0.5089493, 'f1': 0.5098942, 'auroc': 0.67764926, 'binary_precision': 0.11333334, 'binary_recall': 0.02526003, 'binary_specificity': 0.9926385, 'binary_f1_score': 0.041312274}
confusion matrix:
       0    1
0  17934  133
1    656   17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.7699405, 'recall': 0.6097616, 'specificity': 0.6097616, 'f1': 0.6523676, 'auroc': 0.8087622, 'binary_precision': 0.57281554, 'binary_recall': 0.22692308, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.32506886}
confusion matrix:
      0   1
0  5902  44
1   201  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_22.png
early stop counter: 19
val acc:0.9578975439071655, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9621334075927734
after epoch: 22,now: 2024-06-22 18:03:59.388203,epoch time: 0:09:11.232841,used: 3:16:20.077673,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.95642126, 'precision': 0.8952862, 'recall': 0.82939476, 'specificity': 0.82939476, 'f1': 0.85855556, 'auroc': 0.95231307, 'binary_precision': 0.8232466, 'binary_recall': 0.67353076, 'binary_specificity': 0.98525876, 'binary_f1_score': 0.74090105}
confusion matrix:
       0     1
0  41773   625
1   1411  2911
---- Validation: 
scalar performance:
{'acc': 0.9565635, 'precision': 0.56075716, 'recall': 0.5189864, 'specificity': 0.5189864, 'f1': 0.52532685, 'auroc': 0.6521767, 'binary_precision': 0.15609756, 'binary_recall': 0.04754829, 'binary_specificity': 0.9904245, 'binary_f1_score': 0.072892934}
confusion matrix:
       0    1
0  17894  173
1    641   32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.7872095, 'recall': 0.6829957, 'specificity': 0.6829957, 'f1': 0.7222115, 'auroc': 0.8132144, 'binary_precision': 0.601227, 'binary_recall': 0.37692308, 'binary_specificity': 0.98906827, 'binary_f1_score': 0.46335697}
confusion matrix:
      0   1
0  5881  65
1   162  98
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_23.png
new oracle model saved
early stop counter: 20
val acc:0.9565634727478027, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9634224772453308
after epoch: 23,now: 2024-06-22 18:13:18.788178,epoch time: 0:09:19.399975,used: 3:25:39.477648,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9587971, 'precision': 0.9085289, 'recall': 0.8309867, 'specificity': 0.8309867, 'f1': 0.8646536, 'auroc': 0.95380044, 'binary_precision': 0.8496065, 'binary_recall': 0.6741443, 'binary_specificity': 0.987829, 'binary_f1_score': 0.7517731}
confusion matrix:
       0     1
0  41880   516
1   1409  2915
---- Validation: 
scalar performance:
{'acc': 0.9574173, 'precision': 0.5518869, 'recall': 0.51370704, 'specificity': 0.51370704, 'f1': 0.5174773, 'auroc': 0.648908, 'binary_precision': 0.13872832, 'binary_recall': 0.035661217, 'binary_specificity': 0.9917529, 'binary_f1_score': 0.056737587}
confusion matrix:
       0    1
0  17918  149
1    649   24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.78887093, 'recall': 0.64203346, 'specificity': 0.64203346, 'f1': 0.68771607, 'auroc': 0.785814, 'binary_precision': 0.608, 'binary_recall': 0.2923077, 'binary_specificity': 0.9917592, 'binary_f1_score': 0.39480522}
confusion matrix:
      0   1
0  5897  49
1   184  76
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_24.png
early stop counter: 21
val acc:0.9574173092842102, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9634224772453308
after epoch: 24,now: 2024-06-22 18:22:22.889937,epoch time: 0:09:04.101759,used: 3:34:43.579407,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9625, 'precision': 0.91577315, 'recall': 0.84901834, 'specificity': 0.84901834, 'f1': 0.87873375, 'auroc': 0.96047795, 'binary_precision': 0.8606281, 'binary_recall': 0.7097595, 'binary_specificity': 0.9882772, 'binary_f1_score': 0.7779467}
confusion matrix:
       0     1
0  41899   497
1   1255  3069
---- Validation: 
scalar performance:
{'acc': 0.95848453, 'precision': 0.6012089, 'recall': 0.5307117, 'specificity': 0.5307117, 'f1': 0.54327303, 'auroc': 0.68757856, 'binary_precision': 0.2361809, 'binary_recall': 0.06983655, 'binary_specificity': 0.99158686, 'binary_f1_score': 0.10779817}
confusion matrix:
       0    1
0  17915  152
1    626   47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.80120707, 'recall': 0.67238224, 'specificity': 0.67238224, 'f1': 0.7173556, 'auroc': 0.8037957, 'binary_precision': 0.63013697, 'binary_recall': 0.35384616, 'binary_specificity': 0.9909183, 'binary_f1_score': 0.45320195}
confusion matrix:
      0   1
0  5892  54
1   168  92
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_25.png
new oracle model saved
early stop counter: 22
val acc:0.9584845304489136, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9642281532287598
after epoch: 25,now: 2024-06-22 18:31:25.480420,epoch time: 0:09:02.590483,used: 3:43:46.169890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9592894, 'precision': 0.9114772, 'recall': 0.8311165, 'specificity': 0.8311165, 'f1': 0.8658457, 'auroc': 0.9596101, 'binary_precision': 0.8555066, 'binary_recall': 0.6738376, 'binary_specificity': 0.9883954, 'binary_f1_score': 0.753882}
confusion matrix:
       0     1
0  41905   492
1   1410  2913
---- Validation: 
scalar performance:
{'acc': 0.95581645, 'precision': 0.54716307, 'recall': 0.51502264, 'specificity': 0.51502264, 'f1': 0.51930016, 'auroc': 0.68134445, 'binary_precision': 0.1291866, 'binary_recall': 0.04011887, 'binary_specificity': 0.9899264, 'binary_f1_score': 0.061224487}
confusion matrix:
       0    1
0  17885  182
1    646   27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.7996646, 'recall': 0.69662535, 'specificity': 0.69662535, 'f1': 0.7362316, 'auroc': 0.8240461, 'binary_precision': 0.625, 'binary_recall': 0.40384614, 'binary_specificity': 0.9894046, 'binary_f1_score': 0.49065423}
confusion matrix:
      0    1
0  5883   63
1   155  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_26.png
new oracle model saved
early stop counter: 23
val acc:0.9558164477348328, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9648727178573608
after epoch: 26,now: 2024-06-22 18:40:16.539669,epoch time: 0:08:51.059249,used: 3:52:37.229139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9570634, 'precision': 0.887782, 'recall': 0.8448132, 'specificity': 0.8448132, 'f1': 0.864692, 'auroc': 0.95877755, 'binary_precision': 0.80505794, 'binary_recall': 0.70708007, 'binary_specificity': 0.9825463, 'binary_f1_score': 0.7528948}
confusion matrix:
       0     1
0  41658   740
1   1266  3056
---- Validation: 
scalar performance:
{'acc': 0.9544824, 'precision': 0.5724114, 'recall': 0.53078187, 'specificity': 0.53078187, 'f1': 0.5407896, 'auroc': 0.6795731, 'binary_precision': 0.17857143, 'binary_recall': 0.0742942, 'binary_specificity': 0.9872696, 'binary_f1_score': 0.104931794}
confusion matrix:
       0    1
0  17837  230
1    623   50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7404938, 'recall': 0.68415093, 'specificity': 0.68415093, 'f1': 0.7080698, 'auroc': 0.8094466, 'binary_precision': 0.5076142, 'binary_recall': 0.3846154, 'binary_specificity': 0.9836865, 'binary_f1_score': 0.4376368}
confusion matrix:
      0    1
0  5849   97
1   160  100
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_27.png
early stop counter: 24
val acc:0.95448237657547, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9648727178573608
after epoch: 27,now: 2024-06-22 18:49:02.861309,epoch time: 0:08:46.321640,used: 4:01:23.550779,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9604452, 'precision': 0.9141409, 'recall': 0.8363235, 'specificity': 0.8363235, 'f1': 0.87017393, 'auroc': 0.9590033, 'binary_precision': 0.85984296, 'binary_recall': 0.68401575, 'binary_specificity': 0.98863125, 'binary_f1_score': 0.76191705}
confusion matrix:
       0     1
0  41915   482
1   1366  2957
---- Validation: 
scalar performance:
{'acc': 0.9580043, 'precision': 0.5875513, 'recall': 0.526171, 'specificity': 0.526171, 'f1': 0.5364325, 'auroc': 0.70253, 'binary_precision': 0.20918368, 'binary_recall': 0.060921248, 'binary_specificity': 0.9914208, 'binary_f1_score': 0.09436134}
confusion matrix:
       0    1
0  17912  155
1    632   41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.81578803, 'recall': 0.6503985, 'specificity': 0.6503985, 'f1': 0.70078915, 'auroc': 0.81119823, 'binary_precision': 0.661157, 'binary_recall': 0.30769232, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.41994753}
confusion matrix:
      0   1
0  5905  41
1   180  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_28.png
early stop counter: 25
val acc:0.9580042958259583, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9648727178573608
after epoch: 28,now: 2024-06-22 18:57:39.667571,epoch time: 0:08:36.806262,used: 4:10:00.357041,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9614298, 'precision': 0.90264547, 'recall': 0.8577324, 'specificity': 0.8577324, 'f1': 0.87850624, 'auroc': 0.9627261, 'binary_precision': 0.8324552, 'binary_recall': 0.73046696, 'binary_specificity': 0.98499787, 'binary_f1_score': 0.77813345}
confusion matrix:
       0     1
0  41758   636
1   1166  3160
---- Validation: 
scalar performance:
{'acc': 0.9532017, 'precision': 0.57494646, 'recall': 0.5365551, 'specificity': 0.5365551, 'f1': 0.54727787, 'auroc': 0.68603283, 'binary_precision': 0.18322982, 'binary_recall': 0.08766716, 'binary_specificity': 0.98544306, 'binary_f1_score': 0.11859296}
confusion matrix:
       0    1
0  17804  263
1    614   59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.7648096, 'recall': 0.7226125, 'specificity': 0.7226125, 'f1': 0.74164355, 'auroc': 0.80944264, 'binary_precision': 0.5529954, 'binary_recall': 0.46153846, 'binary_specificity': 0.9836865, 'binary_f1_score': 0.5031446}
confusion matrix:
      0    1
0  5849   97
1   140  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_29.png
early stop counter: 26
val acc:0.9532017111778259, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9648727178573608
after epoch: 29,now: 2024-06-22 19:06:16.609144,epoch time: 0:08:36.941573,used: 4:18:37.298614,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9615368, 'precision': 0.8973966, 'recall': 0.8659905, 'specificity': 0.8659905, 'f1': 0.88086987, 'auroc': 0.96696824, 'binary_precision': 0.82020766, 'binary_recall': 0.74872863, 'binary_specificity': 0.98325235, 'binary_f1_score': 0.7828399}
confusion matrix:
       0     1
0  41684   710
1   1087  3239
---- Validation: 
scalar performance:
{'acc': 0.9530416, 'precision': 0.6052434, 'recall': 0.5636522, 'specificity': 0.5636522, 'f1': 0.5782306, 'auroc': 0.7320296, 'binary_precision': 0.24189526, 'binary_recall': 0.14413075, 'binary_specificity': 0.9831737, 'binary_f1_score': 0.18063313}
confusion matrix:
       0    1
0  17763  304
1    576   97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.7772754, 'recall': 0.75680745, 'specificity': 0.75680745, 'f1': 0.7665977, 'auroc': 0.8520486, 'binary_precision': 0.575, 'binary_recall': 0.5307692, 'binary_specificity': 0.9828456, 'binary_f1_score': 0.552}
confusion matrix:
      0    1
0  5844  102
1   122  138
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_30.png
early stop counter: 27
val acc:0.9530416131019592, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9648727178573608
after epoch: 30,now: 2024-06-22 19:14:52.759872,epoch time: 0:08:36.150728,used: 4:27:13.449342,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_47_39_seed_1_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:27:13.449342 at 2024-06-22 19:14:52.759872
persisted model performance metric: 

scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.23741801, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9648727, 'precision': 0.7996646, 'recall': 0.69662535, 'specificity': 0.69662535, 'f1': 0.7362316, 'auroc': 0.8240461, 'binary_precision': 0.625, 'binary_recall': 0.40384614, 'binary_specificity': 0.9894046, 'binary_f1_score': 0.49065423}
confusion matrix:
      0    1
0  5883   63
1   155  105
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204385 KiB | 755911 KiB |   1563 TiB |   1563 TiB |
|       from large pool | 167936 KiB | 683776 KiB |   1563 TiB |   1563 TiB |
|       from small pool |  36449 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204385 KiB | 755911 KiB |   1563 TiB |   1563 TiB |
|       from large pool | 167936 KiB | 683776 KiB |   1563 TiB |   1563 TiB |
|       from small pool |  36449 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 748328 KiB |   1563 TiB |   1563 TiB |
|       from large pool | 165120 KiB | 676736 KiB |   1563 TiB |   1563 TiB |
|       from small pool |  35966 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    782 MiB |    930 MiB |   1410 MiB | 643072 KiB |
|       from large pool |    710 MiB |    858 MiB |   1310 MiB | 614400 KiB |
|       from small pool |     72 MiB |     72 MiB |    100 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 104862 KiB | 258874 KiB | 693846 GiB | 693846 GiB |
|       from large pool |  96256 KiB | 256336 KiB | 693451 GiB | 693451 GiB |
|       from small pool |   8606 KiB |  16195 KiB |    395 GiB |    395 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2064    |    3689    |   98948 K  |   98946 K  |
|       from large pool |      36    |      76    |   40977 K  |   40977 K  |
|       from small pool |    2028    |    3651    |   57971 K  |   57969 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2064    |    3689    |   98948 K  |   98946 K  |
|       from large pool |      36    |      76    |   40977 K  |   40977 K  |
|       from small pool |    2028    |    3651    |   57971 K  |   57969 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      51    |      69    |      20    |
|       from large pool |      13    |      15    |      19    |       6    |
|       from small pool |      36    |      36    |      50    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    1476    |   44472 K  |   44472 K  |
|       from large pool |       5    |      11    |   13930 K  |   13930 K  |
|       from small pool |      47    |    1470    |   30541 K  |   30541 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755911 KiB |   1563 TiB |   1563 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1563 TiB |   1563 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755911 KiB |   1563 TiB |   1563 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1563 TiB |   1563 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB |   1563 TiB |   1563 TiB |
|       from large pool |  16640 KiB | 676736 KiB |   1563 TiB |   1563 TiB |
|       from small pool |      0 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    930 MiB |   1410 MiB |   1108 MiB |
|       from large pool | 264192 KiB |    858 MiB |   1310 MiB |   1052 MiB |
|       from small pool |  45056 KiB |     72 MiB |    100 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 258874 KiB | 693847 GiB | 693847 GiB |
|       from large pool |  83712 KiB | 256336 KiB | 693451 GiB | 693451 GiB |
|       from small pool |      0 KiB |  16201 KiB |    395 GiB |    395 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3689    |   98948 K  |   98948 K  |
|       from large pool |       2    |      76    |   40977 K  |   40977 K  |
|       from small pool |       0    |    3651    |   57971 K  |   57971 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3689    |   98948 K  |   98948 K  |
|       from large pool |       2    |      76    |   40977 K  |   40977 K  |
|       from small pool |       0    |    3651    |   57971 K  |   57971 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      69    |      38    |
|       from large pool |       9    |      15    |      19    |      10    |
|       from small pool |      22    |      36    |      50    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   44472 K  |   44472 K  |
|       from large pool |       1    |      11    |   13930 K  |   13930 K  |
|       from small pool |       0    |    1470    |   30542 K  |   30542 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755911 KiB |   1563 TiB |   1563 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1563 TiB |   1563 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755911 KiB |   1563 TiB |   1563 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1563 TiB |   1563 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB |   1563 TiB |   1563 TiB |
|       from large pool |  16640 KiB | 676736 KiB |   1563 TiB |   1563 TiB |
|       from small pool |      0 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    930 MiB |   1410 MiB |   1108 MiB |
|       from large pool | 264192 KiB |    858 MiB |   1310 MiB |   1052 MiB |
|       from small pool |  45056 KiB |     72 MiB |    100 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 258874 KiB | 693847 GiB | 693847 GiB |
|       from large pool |  83712 KiB | 256336 KiB | 693451 GiB | 693451 GiB |
|       from small pool |      0 KiB |  16201 KiB |    395 GiB |    395 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3689    |   98948 K  |   98948 K  |
|       from large pool |       2    |      76    |   40977 K  |   40977 K  |
|       from small pool |       0    |    3651    |   57971 K  |   57971 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3689    |   98948 K  |   98948 K  |
|       from large pool |       2    |      76    |   40977 K  |   40977 K  |
|       from small pool |       0    |    3651    |   57971 K  |   57971 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      69    |      38    |
|       from large pool |       9    |      15    |      19    |      10    |
|       from small pool |      22    |      36    |      50    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   44472 K  |   44472 K  |
|       from large pool |       1    |      11    |   13930 K  |   13930 K  |
|       from small pool |       0    |    1470    |   30542 K  |   30542 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974

 Experiment start at: 2024-06-22 19:18:56.416910
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9026853, 'precision': 0.45154506, 'recall': 0.49975184, 'specificity': 0.49975184, 'f1': 0.474427, 'auroc': 0.4144259, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995037, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42289  21
1   4538   0
---- Validation: 
scalar performance:
{'acc': 0.9674, 'precision': 0.5256494, 'recall': 0.5005279, 'specificity': 0.5005279, 'f1': 0.49334317, 'auroc': 0.3088667, 'binary_precision': 0.083333336, 'binary_recall': 0.0016611295, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.0032573289}
confusion matrix:
       0   1
0  18160  11
1    601   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.26365113, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 19:27:37.098189,epoch time: 0:08:40.681279,used: 0:08:40.681279,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.49255514, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.33716306, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.30231783, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-22 19:36:15.723924,epoch time: 0:08:38.625735,used: 0:17:19.307014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9031335, 'precision': 0.45156676, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47455078, 'auroc': 0.5560188, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42310  0
1   4538  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.33950508, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.28193092, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_3.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 3,now: 2024-06-22 19:44:53.958941,epoch time: 0:08:38.235017,used: 0:25:57.542031,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.6642164, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.36157534, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.3924073, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_4.png
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 4,now: 2024-06-22 19:53:32.299849,epoch time: 0:08:38.340908,used: 0:34:35.882939,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9031335, 'precision': 0.95156574, 'recall': 0.50011015, 'specificity': 0.50011015, 'f1': 0.4747705, 'auroc': 0.705968, 'binary_precision': 1.0, 'binary_recall': 0.00022031284, 'binary_specificity': 1.0, 'binary_f1_score': 0.00044052862}
confusion matrix:
       0  1
0  42309  0
1   4538  1
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.36348313, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.4056236, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_5.png
early stop counter: 3
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 5,now: 2024-06-22 20:02:17.379369,epoch time: 0:08:45.079520,used: 0:43:20.962459,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9031549, 'precision': 0.9515764, 'recall': 0.5001102, 'specificity': 0.5001102, 'f1': 0.47477642, 'auroc': 0.769984, 'binary_precision': 1.0, 'binary_recall': 0.0002203614, 'binary_specificity': 1.0, 'binary_f1_score': 0.00044062568}
confusion matrix:
       0  1
0  42310  0
1   4537  1
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.40290424, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.4948514, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_6.png
early stop counter: 4
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 6,now: 2024-06-22 20:11:00.979659,epoch time: 0:08:43.600290,used: 0:52:04.562749,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9033043, 'precision': 0.90619695, 'recall': 0.50108975, 'specificity': 0.50108975, 'f1': 0.47679004, 'auroc': 0.7985113, 'binary_precision': 0.90909094, 'binary_recall': 0.0022031285, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.0043956046}
confusion matrix:
       0   1
0  42308   1
1   4529  10
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.4039392, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.49543095, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_7.png
early stop counter: 5
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 7,now: 2024-06-22 20:19:40.612999,epoch time: 0:08:39.633340,used: 1:00:44.196089,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9048412, 'precision': 0.92013204, 'recall': 0.5095127, 'specificity': 0.5095127, 'f1': 0.49375543, 'auroc': 0.84305763, 'binary_precision': 0.9354839, 'binary_recall': 0.019167218, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.037564766}
confusion matrix:
       0   1
0  42303   6
1   4452  87
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.48396462, 'recall': 0.49994496, 'specificity': 0.49994496, 'f1': 0.49182498, 'auroc': 0.43809855, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18169  2
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.5809888, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_8.png
early stop counter: 6
val acc:0.9678261280059814, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 8,now: 2024-06-22 20:28:22.191556,epoch time: 0:08:41.578557,used: 1:09:25.774646,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.91060454, 'precision': 0.9261284, 'recall': 0.5408256, 'specificity': 0.5408256, 'f1': 0.5520067, 'auroc': 0.8769487, 'binary_precision': 0.9419192, 'binary_recall': 0.0821948, 'binary_specificity': 0.9994564, 'binary_f1_score': 0.15119578}
confusion matrix:
       0    1
0  42287   23
1   4165  373
---- Validation: 
scalar performance:
{'acc': 0.96745324, 'precision': 0.48395863, 'recall': 0.49975234, 'specificity': 0.49975234, 'f1': 0.4917287, 'auroc': 0.5067753, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995047, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18162  9
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.6887039, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_9.png
early stop counter: 7
val acc:0.9674532413482666, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 9,now: 2024-06-22 20:37:02.672213,epoch time: 0:08:40.480657,used: 1:18:06.255303,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9143186, 'precision': 0.93994045, 'recall': 0.5596036, 'specificity': 0.5596036, 'f1': 0.5838172, 'auroc': 0.8878516, 'binary_precision': 0.9661922, 'binary_recall': 0.119656235, 'binary_specificity': 0.99955094, 'binary_f1_score': 0.21294117}
confusion matrix:
       0    1
0  42291   19
1   3995  543
---- Validation: 
scalar performance:
{'acc': 0.96761304, 'precision': 0.4839612, 'recall': 0.4998349, 'specificity': 0.4998349, 'f1': 0.49176997, 'auroc': 0.5004358, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18165  6
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.66402006, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_10.png
early stop counter: 8
val acc:0.9676130414009094, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 10,now: 2024-06-22 20:45:49.526798,epoch time: 0:08:46.854585,used: 1:26:53.109888,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9250128, 'precision': 0.9419221, 'recall': 0.6174457, 'specificity': 0.6174457, 'f1': 0.66943896, 'auroc': 0.9015962, 'binary_precision': 0.9596774, 'binary_recall': 0.23595506, 'binary_specificity': 0.9989364, 'binary_f1_score': 0.37877986}
confusion matrix:
       0     1
0  42264    45
1   3468  1071
---- Validation: 
scalar performance:
{'acc': 0.96681404, 'precision': 0.48394838, 'recall': 0.49942216, 'specificity': 0.49942216, 'f1': 0.49156353, 'auroc': 0.5180226, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9988443, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18150  21
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.81409025, 'recall': 0.5040488, 'specificity': 0.5040488, 'f1': 0.49831286, 'auroc': 0.69612217, 'binary_precision': 0.6666667, 'binary_recall': 0.008264462, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.01632653}
confusion matrix:
      0  1
0  5996  1
1   240  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_11.png
new oracle model saved
early stop counter: 9
val acc:0.9668140411376953, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9613720178604126
after epoch: 11,now: 2024-06-22 20:54:50.511997,epoch time: 0:09:00.985199,used: 1:35:54.095087,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9268912, 'precision': 0.93951845, 'recall': 0.6284179, 'specificity': 0.6284179, 'f1': 0.6836784, 'auroc': 0.90541613, 'binary_precision': 0.9528455, 'binary_recall': 0.25820667, 'binary_specificity': 0.99862915, 'binary_f1_score': 0.4063096}
confusion matrix:
       0     1
0  42251    58
1   3367  1172
---- Validation: 
scalar performance:
{'acc': 0.9668673, 'precision': 0.48394924, 'recall': 0.49944967, 'specificity': 0.49944967, 'f1': 0.4915773, 'auroc': 0.54337084, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99889934, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18151  20
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.780831, 'recall': 0.50603163, 'specificity': 0.50603163, 'f1': 0.50229377, 'auroc': 0.7255759, 'binary_precision': 0.6, 'binary_recall': 0.012396694, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.024291497}
confusion matrix:
      0  1
0  5995  2
1   239  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_12.png
early stop counter: 10
val acc:0.9668673276901245, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9613720178604126
after epoch: 12,now: 2024-06-22 21:03:43.807643,epoch time: 0:08:53.295646,used: 1:44:47.390733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9351947, 'precision': 0.93468857, 'recall': 0.6767757, 'specificity': 0.6767757, 'f1': 0.74053144, 'auroc': 0.9118056, 'binary_precision': 0.9341421, 'binary_recall': 0.35624588, 'binary_specificity': 0.9973055, 'binary_f1_score': 0.51578945}
confusion matrix:
       0     1
0  42195   114
1   2922  1617
---- Validation: 
scalar performance:
{'acc': 0.96585524, 'precision': 0.49615306, 'recall': 0.4997299, 'specificity': 0.4997299, 'f1': 0.49287027, 'auroc': 0.5662687, 'binary_precision': 0.024390243, 'binary_recall': 0.0016611295, 'binary_specificity': 0.9977987, 'binary_f1_score': 0.0031104197}
confusion matrix:
       0   1
0  18131  40
1    601   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.8569791, 'recall': 0.5366898, 'specificity': 0.5366898, 'f1': 0.5582522, 'auroc': 0.7425007, 'binary_precision': 0.75, 'binary_recall': 0.07438017, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.13533835}
confusion matrix:
      0   1
0  5991   6
1   224  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_13.png
new oracle model saved
early stop counter: 11
val acc:0.9658552408218384, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9631351232528687
after epoch: 13,now: 2024-06-22 21:12:28.887372,epoch time: 0:08:45.079729,used: 1:53:32.470462,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9390369, 'precision': 0.94099605, 'recall': 0.6960138, 'specificity': 0.6960138, 'f1': 0.7618267, 'auroc': 0.9179568, 'binary_precision': 0.943128, 'binary_recall': 0.3945803, 'binary_specificity': 0.9974474, 'binary_f1_score': 0.55638397}
confusion matrix:
       0     1
0  42201   108
1   2748  1791
---- Validation: 
scalar performance:
{'acc': 0.96580195, 'precision': 0.4839321, 'recall': 0.49889934, 'specificity': 0.49889934, 'f1': 0.49130175, 'auroc': 0.5563371, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9977987, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18131  40
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.8327391, 'recall': 0.55685073, 'specificity': 0.55685073, 'f1': 0.5900254, 'auroc': 0.721154, 'binary_precision': 0.7, 'binary_recall': 0.11570248, 'binary_specificity': 0.997999, 'binary_f1_score': 0.19858158}
confusion matrix:
      0   1
0  5985  12
1   214  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_14.png
new oracle model saved
early stop counter: 12
val acc:0.9658019542694092, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9637762308120728
after epoch: 14,now: 2024-06-22 21:21:10.823219,epoch time: 0:08:41.935847,used: 2:02:14.406309,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.94394636, 'precision': 0.9300189, 'recall': 0.73004305, 'specificity': 0.73004305, 'f1': 0.79303545, 'auroc': 0.9248551, 'binary_precision': 0.9145707, 'binary_recall': 0.46474218, 'binary_specificity': 0.99534386, 'binary_f1_score': 0.61630625}
confusion matrix:
       0     1
0  42113   197
1   2429  2109
---- Validation: 
scalar performance:
{'acc': 0.9647366, 'precision': 0.5134267, 'recall': 0.5015612, 'specificity': 0.5015612, 'f1': 0.4969941, 'auroc': 0.5755991, 'binary_precision': 0.05882353, 'binary_recall': 0.006644518, 'binary_specificity': 0.9964779, 'binary_f1_score': 0.011940298}
confusion matrix:
       0   1
0  18107  64
1    598   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.7991282, 'recall': 0.5726293, 'specificity': 0.5726293, 'f1': 0.611082, 'auroc': 0.74271643, 'binary_precision': 0.6315789, 'binary_recall': 0.14876033, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.24080269}
confusion matrix:
      0   1
0  5976  21
1   206  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_15.png
early stop counter: 13
val acc:0.9647365808486938, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9637762308120728
after epoch: 15,now: 2024-06-22 21:29:51.628103,epoch time: 0:08:40.804884,used: 2:10:55.211193,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.94458675, 'precision': 0.94249725, 'recall': 0.72701466, 'specificity': 0.72701466, 'f1': 0.79266155, 'auroc': 0.9328908, 'binary_precision': 0.9401903, 'binary_recall': 0.45714915, 'binary_specificity': 0.9968801, 'binary_f1_score': 0.61517936}
confusion matrix:
       0     1
0  42177   132
1   2464  2075
---- Validation: 
scalar performance:
{'acc': 0.96532255, 'precision': 0.5028423, 'recall': 0.5002578, 'specificity': 0.5002578, 'f1': 0.49423015, 'auroc': 0.6087206, 'binary_precision': 0.03773585, 'binary_recall': 0.003322259, 'binary_specificity': 0.99719334, 'binary_f1_score': 0.0061068702}
confusion matrix:
       0   1
0  18120  51
1    600   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.8556253, 'recall': 0.57131356, 'specificity': 0.57131356, 'f1': 0.6121237, 'auroc': 0.7641872, 'binary_precision': 0.7446808, 'binary_recall': 0.1446281, 'binary_specificity': 0.997999, 'binary_f1_score': 0.24221452}
confusion matrix:
      0   1
0  5985  12
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_16.png
new oracle model saved
early stop counter: 14
val acc:0.9653225541114807, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9648982286453247
after epoch: 16,now: 2024-06-22 21:38:35.810547,epoch time: 0:08:44.182444,used: 2:19:39.393637,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9472763, 'precision': 0.92525446, 'recall': 0.75318664, 'specificity': 0.75318664, 'f1': 0.81232834, 'auroc': 0.9284754, 'binary_precision': 0.9005033, 'binary_recall': 0.51244766, 'binary_specificity': 0.99392563, 'binary_f1_score': 0.6531873}
confusion matrix:
       0     1
0  42052   257
1   2213  2326
---- Validation: 
scalar performance:
{'acc': 0.9628189, 'precision': 0.5075941, 'recall': 0.50137365, 'specificity': 0.50137365, 'f1': 0.49758822, 'auroc': 0.6040652, 'binary_precision': 0.047169812, 'binary_recall': 0.008305647, 'binary_specificity': 0.9944417, 'binary_f1_score': 0.014124294}
confusion matrix:
       0    1
0  18070  101
1    597    5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.748438, 'recall': 0.59162295, 'specificity': 0.59162295, 'f1': 0.6300637, 'auroc': 0.7597697, 'binary_precision': 0.52873564, 'binary_recall': 0.19008264, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.27963525}
confusion matrix:
      0   1
0  5956  41
1   196  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_17.png
early stop counter: 15
val acc:0.9628189206123352, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9648982286453247
after epoch: 17,now: 2024-06-22 21:47:18.448933,epoch time: 0:08:42.638386,used: 2:28:22.032023,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9495816, 'precision': 0.9158108, 'recall': 0.77462244, 'specificity': 0.77462244, 'f1': 0.8272321, 'auroc': 0.93153, 'binary_precision': 0.8772964, 'binary_recall': 0.5576118, 'binary_specificity': 0.991633, 'binary_f1_score': 0.68184274}
confusion matrix:
       0     1
0  41955   354
1   2008  2531
---- Validation: 
scalar performance:
{'acc': 0.9612209, 'precision': 0.5269477, 'recall': 0.50697255, 'specificity': 0.50697255, 'f1': 0.5073479, 'auroc': 0.6076756, 'binary_precision': 0.08552632, 'binary_recall': 0.021594685, 'binary_specificity': 0.99235046, 'binary_f1_score': 0.03448276}
confusion matrix:
       0    1
0  18032  139
1    589   13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.78028023, 'recall': 0.63252836, 'specificity': 0.63252836, 'f1': 0.6772853, 'auroc': 0.77791035, 'binary_precision': 0.58928573, 'binary_recall': 0.27272728, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.37288138}
confusion matrix:
      0   1
0  5951  46
1   176  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_18.png
early stop counter: 16
val acc:0.961220920085907, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9648982286453247
after epoch: 18,now: 2024-06-22 21:56:01.847825,epoch time: 0:08:43.398892,used: 2:37:05.430915,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.95568645, 'precision': 0.92456365, 'recall': 0.8059871, 'specificity': 0.8059871, 'f1': 0.85322857, 'auroc': 0.9418634, 'binary_precision': 0.8885732, 'binary_recall': 0.62031734, 'binary_specificity': 0.99165684, 'binary_f1_score': 0.7305996}
confusion matrix:
       0     1
0  41957   353
1   1723  2815
---- Validation: 
scalar performance:
{'acc': 0.96058166, 'precision': 0.5313087, 'recall': 0.5090515, 'specificity': 0.5090515, 'f1': 0.5106639, 'auroc': 0.60622334, 'binary_precision': 0.09411765, 'binary_recall': 0.026578072, 'binary_specificity': 0.99152493, 'binary_f1_score': 0.041450772}
confusion matrix:
       0    1
0  18017  154
1    586   16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.7324999, 'recall': 0.64060783, 'specificity': 0.64060783, 'f1': 0.6738485, 'auroc': 0.75691843, 'binary_precision': 0.49305555, 'binary_recall': 0.29338843, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.36787567}
confusion matrix:
      0   1
0  5924  73
1   171  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_19.png
early stop counter: 17
val acc:0.9605816602706909, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9648982286453247
after epoch: 19,now: 2024-06-22 22:04:44.384144,epoch time: 0:08:42.536319,used: 2:45:47.967234,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9542563, 'precision': 0.9213978, 'recall': 0.79973006, 'specificity': 0.79973006, 'f1': 0.84771776, 'auroc': 0.94220996, 'binary_precision': 0.8834827, 'binary_recall': 0.60806346, 'binary_specificity': 0.9913966, 'binary_f1_score': 0.72034454}
confusion matrix:
       0     1
0  41945   364
1   1779  2760
---- Validation: 
scalar performance:
{'acc': 0.96063495, 'precision': 0.5291357, 'recall': 0.508276, 'specificity': 0.508276, 'f1': 0.5094588, 'auroc': 0.62336946, 'binary_precision': 0.08982036, 'binary_recall': 0.024916943, 'binary_specificity': 0.991635, 'binary_f1_score': 0.039011706}
confusion matrix:
       0    1
0  18019  152
1    587   15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.75952065, 'recall': 0.65375495, 'specificity': 0.65375495, 'f1': 0.6915777, 'auroc': 0.7706257, 'binary_precision': 0.5460993, 'binary_recall': 0.3181818, 'binary_specificity': 0.989328, 'binary_f1_score': 0.40208876}
confusion matrix:
      0   1
0  5933  64
1   165  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_20.png
early stop counter: 18
val acc:0.9606349468231201, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9648982286453247
after epoch: 20,now: 2024-06-22 22:13:28.382810,epoch time: 0:08:43.998666,used: 2:54:31.965900,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9534452, 'precision': 0.9145823, 'recall': 0.8006577, 'specificity': 0.8006577, 'f1': 0.8462229, 'auroc': 0.9440944, 'binary_precision': 0.8695925, 'binary_recall': 0.6111478, 'binary_specificity': 0.99016756, 'binary_f1_score': 0.717816}
confusion matrix:
       0     1
0  41893   416
1   1765  2774
---- Validation: 
scalar performance:
{'acc': 0.96020883, 'precision': 0.54857343, 'recall': 0.51608634, 'specificity': 0.51608634, 'f1': 0.5212041, 'auroc': 0.64946824, 'binary_precision': 0.12820514, 'binary_recall': 0.04152824, 'binary_specificity': 0.99064445, 'binary_f1_score': 0.06273526}
confusion matrix:
       0    1
0  18001  170
1    577   25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.79016364, 'recall': 0.67904854, 'specificity': 0.67904854, 'f1': 0.7200649, 'auroc': 0.8021869, 'binary_precision': 0.60544217, 'binary_recall': 0.3677686, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.45758355}
confusion matrix:
      0   1
0  5939  58
1   153  89
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_21.png
new oracle model saved
early stop counter: 19
val acc:0.9602088332176208, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9661805033683777
after epoch: 21,now: 2024-06-22 22:22:29.594686,epoch time: 0:09:01.211876,used: 3:03:33.177776,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.95393616, 'precision': 0.91927993, 'recall': 0.7995528, 'specificity': 0.7995528, 'f1': 0.8469248, 'auroc': 0.94762015, 'binary_precision': 0.8792609, 'binary_recall': 0.60806346, 'binary_specificity': 0.9910421, 'binary_f1_score': 0.7189373}
confusion matrix:
       0     1
0  41930   379
1   1779  2760
---- Validation: 
scalar performance:
{'acc': 0.96026206, 'precision': 0.54290664, 'recall': 0.5137047, 'specificity': 0.5137047, 'f1': 0.5177001, 'auroc': 0.6576247, 'binary_precision': 0.11702128, 'binary_recall': 0.036544852, 'binary_specificity': 0.9908646, 'binary_f1_score': 0.055696208}
confusion matrix:
       0    1
0  18005  166
1    580   22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.79434323, 'recall': 0.6792153, 'specificity': 0.6792153, 'f1': 0.72133136, 'auroc': 0.79665244, 'binary_precision': 0.6137931, 'binary_recall': 0.3677686, 'binary_specificity': 0.990662, 'binary_f1_score': 0.45994833}
confusion matrix:
      0   1
0  5941  56
1   153  89
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_22.png
new oracle model saved
early stop counter: 20
val acc:0.9602620601654053, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9665010571479797
after epoch: 22,now: 2024-06-22 22:31:41.182275,epoch time: 0:09:11.587589,used: 3:12:44.765365,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.95244193, 'precision': 0.91722876, 'recall': 0.7916987, 'specificity': 0.7916987, 'f1': 0.8405585, 'auroc': 0.94394827, 'binary_precision': 0.8767123, 'binary_recall': 0.5923314, 'binary_specificity': 0.9910659, 'binary_f1_score': 0.70699626}
confusion matrix:
       0     1
0  41932   378
1   1850  2688
---- Validation: 
scalar performance:
{'acc': 0.9613807, 'precision': 0.56277716, 'recall': 0.51910084, 'specificity': 0.51910084, 'f1': 0.52599156, 'auroc': 0.66759527, 'binary_precision': 0.15642458, 'binary_recall': 0.046511628, 'binary_specificity': 0.99169004, 'binary_f1_score': 0.07170295}
confusion matrix:
       0    1
0  18020  151
1    574   28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.78989124, 'recall': 0.6669854, 'specificity': 0.6669854, 'f1': 0.71019495, 'auroc': 0.78932166, 'binary_precision': 0.60583943, 'binary_recall': 0.3429752, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.43799472}
confusion matrix:
      0   1
0  5943  54
1   159  83
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_23.png
early stop counter: 21
val acc:0.9613807201385498, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9665010571479797
after epoch: 23,now: 2024-06-22 22:40:28.696209,epoch time: 0:08:47.513934,used: 3:21:32.279299,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9551742, 'precision': 0.9020164, 'recall': 0.8255112, 'specificity': 0.8255112, 'f1': 0.8586404, 'auroc': 0.9430499, 'binary_precision': 0.8392211, 'binary_recall': 0.6646839, 'binary_specificity': 0.9863386, 'binary_f1_score': 0.7418244}
confusion matrix:
       0     1
0  41731   578
1   1522  3017
---- Validation: 
scalar performance:
{'acc': 0.9577052, 'precision': 0.558341, 'recall': 0.5268388, 'specificity': 0.5268388, 'f1': 0.5349409, 'auroc': 0.64633936, 'binary_precision': 0.14705883, 'binary_recall': 0.06644518, 'binary_specificity': 0.9872324, 'binary_f1_score': 0.09153317}
confusion matrix:
       0    1
0  17939  232
1    562   40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.7500866, 'recall': 0.6970417, 'specificity': 0.6970417, 'f1': 0.7200279, 'auroc': 0.78575313, 'binary_precision': 0.52380955, 'binary_recall': 0.4090909, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.45939678}
confusion matrix:
      0   1
0  5907  90
1   143  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_24.png
early stop counter: 22
val acc:0.9577051997184753, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9665010571479797
after epoch: 24,now: 2024-06-22 22:49:18.722106,epoch time: 0:08:50.025897,used: 3:30:22.305196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9555584, 'precision': 0.9100082, 'recall': 0.8192336, 'specificity': 0.8192336, 'f1': 0.8574689, 'auroc': 0.95202124, 'binary_precision': 0.8566038, 'binary_recall': 0.6501432, 'binary_specificity': 0.988324, 'binary_f1_score': 0.7392285}
confusion matrix:
       0     1
0  41815   494
1   1588  2951
---- Validation: 
scalar performance:
{'acc': 0.96031535, 'precision': 0.57002926, 'recall': 0.52577794, 'specificity': 0.52577794, 'f1': 0.53503466, 'auroc': 0.6559347, 'binary_precision': 0.17050691, 'binary_recall': 0.061461795, 'binary_specificity': 0.9900941, 'binary_f1_score': 0.09035409}
confusion matrix:
       0    1
0  17991  180
1    565   37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.77899504, 'recall': 0.7006086, 'specificity': 0.7006086, 'f1': 0.73267657, 'auroc': 0.8014331, 'binary_precision': 0.5813953, 'binary_recall': 0.41322315, 'binary_specificity': 0.987994, 'binary_f1_score': 0.4830918}
confusion matrix:
      0    1
0  5925   72
1   142  100
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_25.png
early stop counter: 23
val acc:0.9603153467178345, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9665010571479797
after epoch: 25,now: 2024-06-22 22:58:05.320322,epoch time: 0:08:46.598216,used: 3:39:08.903412,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9607454, 'precision': 0.91543984, 'recall': 0.8482634, 'specificity': 0.8482634, 'f1': 0.8780912, 'auroc': 0.9597344, 'binary_precision': 0.8615426, 'binary_recall': 0.70874643, 'binary_specificity': 0.9877804, 'binary_f1_score': 0.7777107}
confusion matrix:
       0     1
0  41792   517
1   1322  3217
---- Validation: 
scalar performance:
{'acc': 0.9582379, 'precision': 0.5760338, 'recall': 0.53675056, 'specificity': 0.53675056, 'f1': 0.54786515, 'auroc': 0.6902611, 'binary_precision': 0.18181819, 'binary_recall': 0.08637874, 'binary_specificity': 0.98712236, 'binary_f1_score': 0.117117114}
confusion matrix:
       0    1
0  17937  234
1    550   52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.73997223, 'recall': 0.71223664, 'specificity': 0.71223664, 'f1': 0.72514236, 'auroc': 0.8069682, 'binary_precision': 0.5023474, 'binary_recall': 0.44214877, 'binary_specificity': 0.9823245, 'binary_f1_score': 0.4703297}
confusion matrix:
      0    1
0  5891  106
1   135  107
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_26.png
early stop counter: 24
val acc:0.958237886428833, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9665010571479797
after epoch: 26,now: 2024-06-22 23:06:52.531899,epoch time: 0:08:47.211577,used: 3:47:56.114989,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96033984, 'precision': 0.9153049, 'recall': 0.8456787, 'specificity': 0.8456787, 'f1': 0.87644035, 'auroc': 0.95971215, 'binary_precision': 0.86180836, 'binary_recall': 0.7034589, 'binary_specificity': 0.9878985, 'binary_f1_score': 0.77462393}
confusion matrix:
       0     1
0  41797   512
1   1346  3193
---- Validation: 
scalar performance:
{'acc': 0.9577585, 'precision': 0.5721227, 'recall': 0.53569984, 'specificity': 0.53569984, 'f1': 0.546165, 'auroc': 0.69430614, 'binary_precision': 0.17406143, 'binary_recall': 0.08471761, 'binary_specificity': 0.98668206, 'binary_f1_score': 0.11396647}
confusion matrix:
       0    1
0  17929  242
1    551   51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.77064544, 'recall': 0.7241514, 'specificity': 0.7241514, 'f1': 0.74495435, 'auroc': 0.81808203, 'binary_precision': 0.56281406, 'binary_recall': 0.46280992, 'binary_specificity': 0.98549277, 'binary_f1_score': 0.5079365}
confusion matrix:
      0    1
0  5910   87
1   130  112
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_27.png
early stop counter: 25
val acc:0.9577584862709045, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9665010571479797
after epoch: 27,now: 2024-06-22 23:15:33.255509,epoch time: 0:08:40.723610,used: 3:56:36.838599,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.95568645, 'precision': 0.8954315, 'recall': 0.83739877, 'specificity': 0.83739877, 'f1': 0.86346734, 'auroc': 0.95064783, 'binary_precision': 0.82348305, 'binary_recall': 0.69068074, 'binary_specificity': 0.98411685, 'binary_f1_score': 0.75125813}
confusion matrix:
       0     1
0  41637   672
1   1404  3135
---- Validation: 
scalar performance:
{'acc': 0.9560539, 'precision': 0.57468396, 'recall': 0.5436529, 'specificity': 0.5436529, 'f1': 0.5540605, 'auroc': 0.6769572, 'binary_precision': 0.17867436, 'binary_recall': 0.10299003, 'binary_specificity': 0.9843157, 'binary_f1_score': 0.13066386}
confusion matrix:
       0    1
0  17886  285
1    540   62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.753263, 'recall': 0.72703296, 'specificity': 0.72703296, 'f1': 0.7393409, 'auroc': 0.80733895, 'binary_precision': 0.5277778, 'binary_recall': 0.47107437, 'binary_specificity': 0.9829915, 'binary_f1_score': 0.49781662}
confusion matrix:
      0    1
0  5895  102
1   128  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_28.png
early stop counter: 26
val acc:0.9560539126396179, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9665010571479797
after epoch: 28,now: 2024-06-22 23:24:12.217036,epoch time: 0:08:38.961527,used: 4:05:15.800126,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9579491, 'precision': 0.9105588, 'recall': 0.8347814, 'specificity': 0.8347814, 'f1': 0.86777353, 'auroc': 0.9536468, 'binary_precision': 0.8545003, 'binary_recall': 0.6820185, 'binary_specificity': 0.9875443, 'binary_f1_score': 0.7585784}
confusion matrix:
       0     1
0  41783   527
1   1443  3095
---- Validation: 
scalar performance:
{'acc': 0.9569595, 'precision': 0.5783226, 'recall': 0.54331756, 'specificity': 0.54331756, 'f1': 0.55455804, 'auroc': 0.682444, 'binary_precision': 0.18597561, 'binary_recall': 0.1013289, 'binary_specificity': 0.98530626, 'binary_f1_score': 0.13118279}
confusion matrix:
       0    1
0  17904  267
1    541   61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.735152, 'recall': 0.72768164, 'specificity': 0.72768164, 'f1': 0.73134834, 'auroc': 0.8093165, 'binary_precision': 0.491453, 'binary_recall': 0.4752066, 'binary_specificity': 0.9801567, 'binary_f1_score': 0.48319328}
confusion matrix:
      0    1
0  5878  119
1   127  115
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_29.png
early stop counter: 27
val acc:0.9569594860076904, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9665010571479797
after epoch: 29,now: 2024-06-22 23:32:52.344847,epoch time: 0:08:40.127811,used: 4:13:55.927937,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9609802, 'precision': 0.91016823, 'recall': 0.85616213, 'specificity': 0.85616213, 'f1': 0.88073075, 'auroc': 0.96154404, 'binary_precision': 0.84926564, 'binary_recall': 0.7261511, 'binary_specificity': 0.98617315, 'binary_f1_score': 0.7828978}
confusion matrix:
       0     1
0  41724   585
1   1243  3296
---- Validation: 
scalar performance:
{'acc': 0.9564268, 'precision': 0.5820966, 'recall': 0.54866374, 'specificity': 0.54866374, 'f1': 0.5601015, 'auroc': 0.7044208, 'binary_precision': 0.19318181, 'binary_recall': 0.11295681, 'binary_specificity': 0.9843707, 'binary_f1_score': 0.14255764}
confusion matrix:
       0    1
0  17887  284
1    534   68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.7530853, 'recall': 0.7349639, 'specificity': 0.7349639, 'f1': 0.74364513, 'auroc': 0.82418287, 'binary_precision': 0.52678573, 'binary_recall': 0.4876033, 'binary_specificity': 0.9823245, 'binary_f1_score': 0.5064378}
confusion matrix:
      0    1
0  5891  106
1   124  118
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546974_30.png
early stop counter: 28
val acc:0.9564267992973328, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9665010571479797
after epoch: 30,now: 2024-06-22 23:41:34.610511,epoch time: 0:08:42.265664,used: 4:22:38.193601,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_19_18_56_seed_2_21546974
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:22:38.193601 at 2024-06-22 23:41:34.610511
persisted model performance metric: 

scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.30231783, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
oracle model performance metric: 

scalar performance:
{'acc': 0.96650106, 'precision': 0.79434323, 'recall': 0.6792153, 'specificity': 0.6792153, 'f1': 0.72133136, 'auroc': 0.79665244, 'binary_precision': 0.6137931, 'binary_recall': 0.3677686, 'binary_specificity': 0.990662, 'binary_f1_score': 0.45994833}
confusion matrix:
      0   1
0  5941  56
1   153  89
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_resnet_lre5_bs32_classbalancing3/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204388 KiB | 755914 KiB |   2345 TiB |   2345 TiB |
|       from large pool | 167936 KiB | 683776 KiB |   2345 TiB |   2345 TiB |
|       from small pool |  36452 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204388 KiB | 755914 KiB |   2345 TiB |   2345 TiB |
|       from large pool | 167936 KiB | 683776 KiB |   2345 TiB |   2345 TiB |
|       from small pool |  36452 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB | 748328 KiB |   2345 TiB |   2345 TiB |
|       from large pool | 165120 KiB | 676736 KiB |   2344 TiB |   2344 TiB |
|       from small pool |  35967 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    782 MiB |    930 MiB |   1890 MiB |   1108 MiB |
|       from large pool |    710 MiB |    858 MiB |   1762 MiB |   1052 MiB |
|       from small pool |     72 MiB |     72 MiB |    128 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 102811 KiB | 258874 KiB |   1022 TiB |   1022 TiB |
|       from large pool |  96256 KiB | 256336 KiB |   1022 TiB |   1022 TiB |
|       from small pool |   6555 KiB |  16201 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2070    |    3697    |  148439 K  |  148437 K  |
|       from large pool |      36    |      76    |   61465 K  |   61465 K  |
|       from small pool |    2034    |    3659    |   86973 K  |   86971 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2070    |    3697    |  148439 K  |  148437 K  |
|       from large pool |      36    |      76    |   61465 K  |   61465 K  |
|       from small pool |    2034    |    3659    |   86973 K  |   86971 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      51    |      87    |      38    |
|       from large pool |      13    |      15    |      23    |      10    |
|       from small pool |      36    |      36    |      64    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      49    |    1478    |   66976 K  |   66976 K  |
|       from large pool |       5    |      11    |   21183 K  |   21183 K  |
|       from small pool |      44    |    1473    |   45792 K  |   45792 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755914 KiB |   2345 TiB |   2345 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   2345 TiB |   2345 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755914 KiB |   2345 TiB |   2345 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   2345 TiB |   2345 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB |   2345 TiB |   2345 TiB |
|       from large pool |  16640 KiB | 676736 KiB |   2344 TiB |   2344 TiB |
|       from small pool |      0 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 307200 KiB |    930 MiB |   1890 MiB |   1590 MiB |
|       from large pool | 264192 KiB |    858 MiB |   1762 MiB |   1504 MiB |
|       from small pool |  43008 KiB |     72 MiB |    128 MiB |     86 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 258874 KiB |   1022 TiB |   1022 TiB |
|       from large pool |  83712 KiB | 256336 KiB |   1022 TiB |   1022 TiB |
|       from small pool |      0 KiB |  16201 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3697    |  148439 K  |  148439 K  |
|       from large pool |       2    |      76    |   61465 K  |   61465 K  |
|       from small pool |       0    |    3659    |   86973 K  |   86973 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3697    |  148439 K  |  148439 K  |
|       from large pool |       2    |      76    |   61465 K  |   61465 K  |
|       from small pool |       0    |    3659    |   86973 K  |   86973 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      87    |      57    |
|       from large pool |       9    |      15    |      23    |      14    |
|       from small pool |      21    |      36    |      64    |      43    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1478    |   66976 K  |   66976 K  |
|       from large pool |       1    |      11    |   21183 K  |   21183 K  |
|       from small pool |       0    |    1473    |   45793 K  |   45793 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jun 22 23:42:17 2024]
Finished job 0.
1 of 1 steps (100%) done
