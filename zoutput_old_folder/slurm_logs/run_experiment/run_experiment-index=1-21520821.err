Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jun 21 11:06:51 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821

 Experiment start at: 2024-06-21 11:23:15.174146
before training, model accuracy: 0.3101629912853241
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97782534, 'precision': 0.98153794, 'recall': 0.8875922, 'specificity': 0.8875922, 'f1': 0.9282758, 'auroc': 0.98393345, 'binary_precision': 0.98589927, 'binary_recall': 0.77634263, 'binary_specificity': 0.9988418, 'binary_f1_score': 0.8686613}
confusion matrix:
       0     1
0  42258    49
1    987  3426
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.7726859, 'recall': 0.5575552, 'specificity': 0.5575552, 'f1': 0.58960193, 'auroc': 0.71440244, 'binary_precision': 0.57575756, 'binary_recall': 0.11819596, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.19612904}
confusion matrix:
       0   1
0  18093  56
1    567  76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7656251, 'recall': 0.5537213, 'specificity': 0.5537213, 'f1': 0.5825423, 'auroc': 0.7680092, 'binary_precision': 0.5686275, 'binary_recall': 0.11111111, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.18589745}
confusion matrix:
      0   1
0  5975  22
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 11:39:43.250482,epoch time: 0:16:28.076336,used: 0:16:28.076336,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.983262, 'precision': 0.9673777, 'recall': 0.93270963, 'specificity': 0.93270963, 'f1': 0.949203, 'auroc': 0.9895068, 'binary_precision': 0.94816095, 'binary_recall': 0.87038296, 'binary_specificity': 0.9950363, 'binary_f1_score': 0.9076087}
confusion matrix:
       0     1
0  42097   210
1    572  3841
---- Validation: 
scalar performance:
{'acc': 0.9642933, 'precision': 0.7226682, 'recall': 0.65749025, 'specificity': 0.65749025, 'f1': 0.6838526, 'auroc': 0.78816843, 'binary_precision': 0.46888888, 'binary_recall': 0.3281493, 'binary_specificity': 0.98683125, 'binary_f1_score': 0.3860933}
confusion matrix:
       0    1
0  17910  239
1    432  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.779145, 'recall': 0.6782385, 'specificity': 0.6782385, 'f1': 0.7162471, 'auroc': 0.81258, 'binary_precision': 0.58536583, 'binary_recall': 0.3678161, 'binary_specificity': 0.988661, 'binary_f1_score': 0.4517647}
confusion matrix:
      0   1
0  5929  68
1   165  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_2.png
new oracle model saved
early stop counter: 1
val acc:0.9642933011054993, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9594119787216187 / 0.9627676606178284
after epoch: 2,now: 2024-06-21 11:54:09.548924,epoch time: 0:14:26.298442,used: 0:30:54.374778,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98679364, 'precision': 0.9722166, 'recall': 0.94934195, 'specificity': 0.94934195, 'f1': 0.9604213, 'auroc': 0.9916886, 'binary_precision': 0.9544692, 'binary_recall': 0.9031746, 'binary_specificity': 0.9955093, 'binary_f1_score': 0.9281137}
confusion matrix:
       0     1
0  42120   190
1    427  3983
---- Validation: 
scalar performance:
{'acc': 0.96525115, 'precision': 0.7316844, 'recall': 0.6474854, 'specificity': 0.6474854, 'f1': 0.67922044, 'auroc': 0.80053097, 'binary_precision': 0.48762375, 'binary_recall': 0.30637637, 'binary_specificity': 0.9885944, 'binary_f1_score': 0.37631324}
confusion matrix:
       0    1
0  17942  207
1    446  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.79712504, 'recall': 0.66599584, 'specificity': 0.66599584, 'f1': 0.7109674, 'auroc': 0.8230847, 'binary_precision': 0.62237763, 'binary_recall': 0.34099618, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.44059408}
confusion matrix:
      0   1
0  5943  54
1   172  89
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_3.png
new oracle model saved
early stop counter: 2
val acc:0.9652511477470398, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9594119787216187 / 0.9638862013816833
after epoch: 3,now: 2024-06-21 12:09:22.793402,epoch time: 0:15:13.244478,used: 0:46:07.619256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9879495, 'precision': 0.9785814, 'recall': 0.9498786, 'specificity': 0.9498786, 'f1': 0.96367204, 'auroc': 0.99343765, 'binary_precision': 0.96720916, 'binary_recall': 0.90294784, 'binary_specificity': 0.99680924, 'binary_f1_score': 0.93397444}
confusion matrix:
       0     1
0  42175   135
1    428  3982
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.74595714, 'recall': 0.63909084, 'specificity': 0.63909084, 'f1': 0.6761909, 'auroc': 0.79520947, 'binary_precision': 0.51675975, 'binary_recall': 0.28771386, 'binary_specificity': 0.9904678, 'binary_f1_score': 0.36963037}
confusion matrix:
       0    1
0  17976  173
1    458  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.78343904, 'recall': 0.64317405, 'specificity': 0.64317405, 'f1': 0.68770474, 'auroc': 0.81107736, 'binary_precision': 0.5968992, 'binary_recall': 0.29501915, 'binary_specificity': 0.991329, 'binary_f1_score': 0.39487177}
confusion matrix:
      0   1
0  5945  52
1   184  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_4.png
early stop counter: 3
val acc:0.966421902179718, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9594119787216187 / 0.9638862013816833
after epoch: 4,now: 2024-06-21 12:22:58.497565,epoch time: 0:13:35.704163,used: 0:59:43.323419,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.988613, 'precision': 0.97886616, 'recall': 0.95360655, 'specificity': 0.95360655, 'f1': 0.96580577, 'auroc': 0.994488, 'binary_precision': 0.9670118, 'binary_recall': 0.9104512, 'binary_specificity': 0.9967619, 'binary_f1_score': 0.9378795}
confusion matrix:
       0     1
0  42172   137
1    395  4016
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.73715824, 'recall': 0.64548314, 'specificity': 0.64548314, 'f1': 0.67917514, 'auroc': 0.8237731, 'binary_precision': 0.49871466, 'binary_recall': 0.30171072, 'binary_specificity': 0.9892556, 'binary_f1_score': 0.37596896}
confusion matrix:
       0    1
0  17954  195
1    449  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8185891, 'recall': 0.6499217, 'specificity': 0.6499217, 'f1': 0.7008679, 'auroc': 0.8255654, 'binary_precision': 0.6666667, 'binary_recall': 0.3065134, 'binary_specificity': 0.99333, 'binary_f1_score': 0.41994753}
confusion matrix:
      0   1
0  5957  40
1   181  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_5.png
new oracle model saved
early stop counter: 4
val acc:0.9657300710678101, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9594119787216187 / 0.9646852016448975
after epoch: 5,now: 2024-06-21 12:36:39.195668,epoch time: 0:13:40.698103,used: 1:13:24.021522,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98985445, 'precision': 0.9803786, 'recall': 0.9595981, 'specificity': 0.9595981, 'f1': 0.969699, 'auroc': 0.99474216, 'binary_precision': 0.9688244, 'binary_recall': 0.9222927, 'binary_specificity': 0.99690354, 'binary_f1_score': 0.9449861}
confusion matrix:
       0     1
0  42175   131
1    343  4071
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.74389094, 'recall': 0.6330077, 'specificity': 0.6330077, 'f1': 0.67048764, 'auroc': 0.81159747, 'binary_precision': 0.51304346, 'binary_recall': 0.27527216, 'binary_specificity': 0.9907433, 'binary_f1_score': 0.35829958}
confusion matrix:
       0    1
0  17981  168
1    466  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8129693, 'recall': 0.6291824, 'specificity': 0.6291824, 'f1': 0.6791419, 'auroc': 0.82263875, 'binary_precision': 0.6571429, 'binary_recall': 0.26436782, 'binary_specificity': 0.993997, 'binary_f1_score': 0.37704918}
confusion matrix:
      0   1
0  5961  36
1   192  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_6.png
early stop counter: 5
val acc:0.9662622213363647, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9594119787216187 / 0.9646852016448975
after epoch: 6,now: 2024-06-21 12:51:43.158679,epoch time: 0:15:03.963011,used: 1:28:27.984533,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9911173, 'precision': 0.98216784, 'recall': 0.9653533, 'specificity': 0.9653533, 'f1': 0.9735726, 'auroc': 0.99567205, 'binary_precision': 0.9712332, 'binary_recall': 0.93359023, 'binary_specificity': 0.9971164, 'binary_f1_score': 0.9520398}
confusion matrix:
       0     1
0  42186   122
1    293  4119
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.7431568, 'recall': 0.6322301, 'specificity': 0.6322301, 'f1': 0.66964257, 'auroc': 0.81374204, 'binary_precision': 0.5116279, 'binary_recall': 0.27371696, 'binary_specificity': 0.9907433, 'binary_f1_score': 0.3566363}
confusion matrix:
       0    1
0  17981  168
1    467  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.741247, 'recall': 0.5808728, 'specificity': 0.5808728, 'f1': 0.6165678, 'auroc': 0.8112858, 'binary_precision': 0.5176471, 'binary_recall': 0.16858238, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.25433525}
confusion matrix:
      0   1
0  5956  41
1   217  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_7.png
early stop counter: 6
val acc:0.9662090539932251, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9594119787216187 / 0.9646852016448975
after epoch: 7,now: 2024-06-21 13:08:14.206964,epoch time: 0:16:31.048285,used: 1:44:59.032818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99026114, 'precision': 0.985568, 'recall': 0.9568614, 'specificity': 0.9568614, 'f1': 0.9706656, 'auroc': 0.9962981, 'binary_precision': 0.979869, 'binary_recall': 0.9156845, 'binary_specificity': 0.9980382, 'binary_f1_score': 0.9466901}
confusion matrix:
       0     1
0  42225    83
1    372  4040
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.7668308, 'recall': 0.59677845, 'specificity': 0.59677845, 'f1': 0.63858175, 'auroc': 0.8081311, 'binary_precision': 0.5614035, 'binary_recall': 0.19906688, 'binary_specificity': 0.99449, 'binary_f1_score': 0.29391506}
confusion matrix:
       0    1
0  18049  100
1    515  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.7750808, 'recall': 0.5761262, 'specificity': 0.5761262, 'f1': 0.6136496, 'auroc': 0.80986774, 'binary_precision': 0.5857143, 'binary_recall': 0.15708812, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.24773414}
confusion matrix:
      0   1
0  5968  29
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_8.png
better model found
persisted
after epoch: 8,now: 2024-06-21 13:26:24.483395,epoch time: 0:18:10.276431,used: 2:03:09.309249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99090326, 'precision': 0.9829284, 'recall': 0.9633304, 'specificity': 0.9633304, 'f1': 0.9728738, 'auroc': 0.99631697, 'binary_precision': 0.97319734, 'binary_recall': 0.92933184, 'binary_specificity': 0.99732894, 'binary_f1_score': 0.9507589}
confusion matrix:
       0     1
0  42192   113
1    312  4103
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.74800336, 'recall': 0.6128664, 'specificity': 0.6128664, 'f1': 0.65269643, 'auroc': 0.8237747, 'binary_precision': 0.5226481, 'binary_recall': 0.2332815, 'binary_specificity': 0.99245137, 'binary_f1_score': 0.32258064}
confusion matrix:
       0    1
0  18012  137
1    493  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.716964, 'recall': 0.57104415, 'specificity': 0.57104415, 'f1': 0.60244536, 'auroc': 0.81652194, 'binary_precision': 0.4698795, 'binary_recall': 0.14942528, 'binary_specificity': 0.992663, 'binary_f1_score': 0.22674419}
confusion matrix:
      0   1
0  5953  44
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_9.png
early stop counter: 1
val acc:0.9664750695228577, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.960210919380188 / 0.9646852016448975
after epoch: 9,now: 2024-06-21 13:44:26.659749,epoch time: 0:18:02.176354,used: 2:21:11.485603,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9911173, 'precision': 0.9870771, 'recall': 0.9605158, 'specificity': 0.9605158, 'f1': 0.97332877, 'auroc': 0.99542356, 'binary_precision': 0.9821644, 'binary_recall': 0.9227808, 'binary_specificity': 0.9982508, 'binary_f1_score': 0.951547}
confusion matrix:
       0     1
0  42230    74
1    341  4075
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.76017106, 'recall': 0.594363, 'specificity': 0.594363, 'f1': 0.63505566, 'auroc': 0.81586015, 'binary_precision': 0.5482456, 'binary_recall': 0.19440125, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.2870264}
confusion matrix:
       0    1
0  18046  103
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.7465314, 'recall': 0.56629753, 'specificity': 0.56629753, 'f1': 0.59887844, 'auroc': 0.81585157, 'binary_precision': 0.5294118, 'binary_recall': 0.13793103, 'binary_specificity': 0.994664, 'binary_f1_score': 0.21884498}
confusion matrix:
      0   1
0  5965  32
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_10.png
early stop counter: 2
val acc:0.9669540524482727, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.960210919380188 / 0.9646852016448975
after epoch: 10,now: 2024-06-21 14:02:27.113579,epoch time: 0:18:00.453830,used: 2:39:11.939433,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99240154, 'precision': 0.9848517, 'recall': 0.97032577, 'specificity': 0.97032577, 'f1': 0.97744954, 'auroc': 0.9970091, 'binary_precision': 0.9756155, 'binary_recall': 0.9431097, 'binary_specificity': 0.99754184, 'binary_f1_score': 0.9590872}
confusion matrix:
       0     1
0  42204   104
1    251  4161
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.7445334, 'recall': 0.63828564, 'specificity': 0.63828564, 'f1': 0.67516464, 'auroc': 0.8345813, 'binary_precision': 0.5139665, 'binary_recall': 0.28615862, 'binary_specificity': 0.9904127, 'binary_f1_score': 0.3676324}
confusion matrix:
       0    1
0  17975  174
1    459  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.735351, 'recall': 0.5880354, 'specificity': 0.5880354, 'f1': 0.6241406, 'auroc': 0.82865703, 'binary_precision': 0.50526315, 'binary_recall': 0.18390805, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.26966292}
confusion matrix:
      0   1
0  5950  47
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_11.png
early stop counter: 3
val acc:0.9663154482841492, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.960210919380188 / 0.9646852016448975
after epoch: 11,now: 2024-06-21 14:20:59.379845,epoch time: 0:18:32.266266,used: 2:57:44.205699,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99188787, 'precision': 0.98511475, 'recall': 0.96701837, 'specificity': 0.96701837, 'f1': 0.97585005, 'auroc': 0.9960586, 'binary_precision': 0.9768431, 'binary_recall': 0.9363533, 'binary_specificity': 0.99768347, 'binary_f1_score': 0.9561698}
confusion matrix:
       0     1
0  42207    98
1    281  4134
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.7493687, 'recall': 0.6076436, 'specificity': 0.6076436, 'f1': 0.6477074, 'auroc': 0.8211777, 'binary_precision': 0.5257353, 'binary_recall': 0.22239502, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.3125683}
confusion matrix:
       0    1
0  18020  129
1    500  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.75288963, 'recall': 0.5719613, 'specificity': 0.5719613, 'f1': 0.6066517, 'auroc': 0.8195121, 'binary_precision': 0.5416667, 'binary_recall': 0.14942528, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.23423423}
confusion matrix:
      0   1
0  5964  33
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_12.png
early stop counter: 4
val acc:0.9665282964706421, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.960210919380188 / 0.9646852016448975
after epoch: 12,now: 2024-06-21 14:39:12.431051,epoch time: 0:18:13.051206,used: 3:15:57.256905,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99238014, 'precision': 0.98463464, 'recall': 0.97040904, 'specificity': 0.97040904, 'f1': 0.9773884, 'auroc': 0.9965831, 'binary_precision': 0.9751582, 'binary_recall': 0.9433235, 'binary_specificity': 0.99749464, 'binary_f1_score': 0.9589767}
confusion matrix:
       0     1
0  42203   106
1    250  4161
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7473957, 'recall': 0.6226171, 'specificity': 0.6226171, 'f1': 0.6619021, 'auroc': 0.82532054, 'binary_precision': 0.5207668, 'binary_recall': 0.2534992, 'binary_specificity': 0.9917351, 'binary_f1_score': 0.3410042}
confusion matrix:
       0    1
0  17999  150
1    480  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95621604, 'precision': 0.69712996, 'recall': 0.5722095, 'specificity': 0.5722095, 'f1': 0.60172975, 'auroc': 0.8065829, 'binary_precision': 0.43010753, 'binary_recall': 0.1532567, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.22598869}
confusion matrix:
      0   1
0  5944  53
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_13.png
early stop counter: 5
val acc:0.9664750695228577, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.960210919380188 / 0.9646852016448975
after epoch: 13,now: 2024-06-21 14:58:08.707547,epoch time: 0:18:56.276496,used: 3:34:53.533401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9869416, 'recall': 0.96698105, 'specificity': 0.96698105, 'f1': 0.9766985, 'auroc': 0.9964497, 'binary_precision': 0.98054105, 'binary_recall': 0.93590033, 'binary_specificity': 0.9980617, 'binary_f1_score': 0.9577007}
confusion matrix:
       0     1
0  42223    82
1    283  4132
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7528002, 'recall': 0.6197822, 'specificity': 0.6197822, 'f1': 0.660275, 'auroc': 0.82424283, 'binary_precision': 0.53177255, 'binary_recall': 0.24727838, 'binary_specificity': 0.9922861, 'binary_f1_score': 0.33757958}
confusion matrix:
       0    1
0  18009  140
1    484  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95557684, 'precision': 0.6803337, 'recall': 0.55904967, 'specificity': 0.55904967, 'f1': 0.5845106, 'auroc': 0.8076952, 'binary_precision': 0.39759037, 'binary_recall': 0.12643678, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.19186047}
confusion matrix:
      0   1
0  5947  50
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_14.png
early stop counter: 6
val acc:0.9667943716049194, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.960210919380188 / 0.9646852016448975
after epoch: 14,now: 2024-06-21 15:13:45.341202,epoch time: 0:15:36.633655,used: 3:50:30.167056,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99208045, 'precision': 0.9864576, 'recall': 0.96680593, 'specificity': 0.96680593, 'f1': 0.9763769, 'auroc': 0.9964926, 'binary_precision': 0.9795967, 'binary_recall': 0.9356447, 'binary_specificity': 0.99796724, 'binary_f1_score': 0.95711637}
confusion matrix:
       0     1
0  42221    86
1    284  4129
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.7298248, 'recall': 0.6085376, 'specificity': 0.6085376, 'f1': 0.6452084, 'auroc': 0.83001775, 'binary_precision': 0.48657718, 'binary_recall': 0.22550544, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.30818278}
confusion matrix:
       0    1
0  17996  153
1    498  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95541704, 'precision': 0.6851114, 'recall': 0.5699603, 'specificity': 0.5699603, 'f1': 0.59777075, 'auroc': 0.81762815, 'binary_precision': 0.40625, 'binary_recall': 0.14942528, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.2184874}
confusion matrix:
      0   1
0  5940  57
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_15.png
early stop counter: 7
val acc:0.9653576016426086, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.960210919380188 / 0.9646852016448975
after epoch: 15,now: 2024-06-21 15:26:33.175377,epoch time: 0:12:47.834175,used: 4:03:18.001231,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9877625, 'recall': 0.9661621, 'specificity': 0.9661621, 'f1': 0.9766548, 'auroc': 0.9970106, 'binary_precision': 0.98236835, 'binary_recall': 0.9340734, 'binary_specificity': 0.99825084, 'binary_f1_score': 0.9576124}
confusion matrix:
       0     1
0  42232    74
1    291  4123
---- Validation: 
scalar performance:
{'acc': 0.9660494, 'precision': 0.74089766, 'recall': 0.6193965, 'specificity': 0.6193965, 'f1': 0.6576088, 'auroc': 0.8441802, 'binary_precision': 0.5079872, 'binary_recall': 0.24727838, 'binary_specificity': 0.9915147, 'binary_f1_score': 0.33263597}
confusion matrix:
       0    1
0  17995  154
1    484  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95669544, 'precision': 0.70209754, 'recall': 0.5669626, 'specificity': 0.5669626, 'f1': 0.5961134, 'auroc': 0.8233144, 'binary_precision': 0.44047618, 'binary_recall': 0.14176245, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.21449275}
confusion matrix:
      0   1
0  5950  47
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_16.png
early stop counter: 8
val acc:0.9660493731498718, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.960210919380188 / 0.9646852016448975
after epoch: 16,now: 2024-06-21 15:37:50.167742,epoch time: 0:11:16.992365,used: 4:14:34.993596,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99233735, 'precision': 0.98713744, 'recall': 0.96765816, 'specificity': 0.96765816, 'f1': 0.9771478, 'auroc': 0.9959382, 'binary_precision': 0.98079205, 'binary_recall': 0.9372309, 'binary_specificity': 0.99808544, 'binary_f1_score': 0.95851684}
confusion matrix:
       0     1
0  42226    81
1    277  4136
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.7417029, 'recall': 0.62092423, 'specificity': 0.62092423, 'f1': 0.65918696, 'auroc': 0.8501375, 'binary_precision': 0.50949365, 'binary_recall': 0.2503888, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.33576643}
confusion matrix:
       0    1
0  17994  155
1    482  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.71365356, 'recall': 0.56912845, 'specificity': 0.56912845, 'f1': 0.59982026, 'auroc': 0.82734203, 'binary_precision': 0.46341464, 'binary_recall': 0.14559387, 'binary_specificity': 0.992663, 'binary_f1_score': 0.22157434}
confusion matrix:
      0   1
0  5953  44
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_17.png
early stop counter: 9
val acc:0.9661026000976562, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.960210919380188 / 0.9646852016448975
after epoch: 17,now: 2024-06-21 15:53:14.929174,epoch time: 0:15:24.761432,used: 4:29:59.755028,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9932363, 'precision': 0.9831753, 'recall': 0.97708505, 'specificity': 0.97708505, 'f1': 0.98010576, 'auroc': 0.9976226, 'binary_precision': 0.9708113, 'binary_recall': 0.957172, 'binary_specificity': 0.99699813, 'binary_f1_score': 0.96394336}
confusion matrix:
       0     1
0  42180   127
1    189  4224
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7535513, 'recall': 0.6657009, 'specificity': 0.6657009, 'f1': 0.69947976, 'auroc': 0.84230816, 'binary_precision': 0.5301205, 'binary_recall': 0.3421462, 'binary_specificity': 0.9892556, 'binary_f1_score': 0.41587904}
confusion matrix:
       0    1
0  17954  195
1    423  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95254076, 'precision': 0.64837396, 'recall': 0.56296253, 'specificity': 0.56296253, 'f1': 0.58533573, 'auroc': 0.80848056, 'binary_precision': 0.33333334, 'binary_recall': 0.13793103, 'binary_specificity': 0.987994, 'binary_f1_score': 0.19512196}
confusion matrix:
      0   1
0  5925  72
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_18.png
early stop counter: 10
val acc:0.9671136736869812, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.960210919380188 / 0.9646852016448975
after epoch: 18,now: 2024-06-21 16:06:50.156745,epoch time: 0:13:35.227571,used: 4:43:34.982599,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9926798, 'precision': 0.9861449, 'recall': 0.9706888, 'specificity': 0.9706888, 'f1': 0.97825956, 'auroc': 0.9971564, 'binary_precision': 0.97815365, 'binary_recall': 0.9435758, 'binary_specificity': 0.9978018, 'binary_f1_score': 0.96055365}
confusion matrix:
       0     1
0  42214    93
1    249  4164
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.7428085, 'recall': 0.60595065, 'specificity': 0.60595065, 'f1': 0.6449219, 'auroc': 0.8302634, 'binary_precision': 0.51272726, 'binary_recall': 0.21928461, 'binary_specificity': 0.99261665, 'binary_f1_score': 0.30718955}
confusion matrix:
       0    1
0  18015  134
1    502  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9552573, 'precision': 0.6711811, 'recall': 0.5533859, 'specificity': 0.5533859, 'f1': 0.5767373, 'auroc': 0.8046477, 'binary_precision': 0.37974682, 'binary_recall': 0.11494253, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.17647058}
confusion matrix:
      0   1
0  5948  49
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_19.png
early stop counter: 11
val acc:0.9661558270454407, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.960210919380188 / 0.9646852016448975
after epoch: 19,now: 2024-06-21 16:16:56.540881,epoch time: 0:10:06.384136,used: 4:53:41.366735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9928082, 'precision': 0.9872411, 'recall': 0.9703538, 'specificity': 0.9703538, 'f1': 0.97861, 'auroc': 0.99681664, 'binary_precision': 0.98043835, 'binary_recall': 0.9426694, 'binary_specificity': 0.9980382, 'binary_f1_score': 0.96118295}
confusion matrix:
       0     1
0  42224    83
1    253  4160
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.76118207, 'recall': 0.6094743, 'specificity': 0.6094743, 'f1': 0.6514565, 'auroc': 0.8409853, 'binary_precision': 0.54924244, 'binary_recall': 0.22550544, 'binary_specificity': 0.9934432, 'binary_f1_score': 0.3197354}
confusion matrix:
       0    1
0  18030  119
1    498  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95637584, 'precision': 0.684155, 'recall': 0.54664016, 'specificity': 0.54664016, 'f1': 0.5688032, 'auroc': 0.8158829, 'binary_precision': 0.40625, 'binary_recall': 0.099616855, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.16}
confusion matrix:
      0   1
0  5959  38
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_20.png
early stop counter: 12
val acc:0.9671669006347656, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.960210919380188 / 0.9646852016448975
after epoch: 20,now: 2024-06-21 16:28:42.931690,epoch time: 0:11:46.390809,used: 5:05:27.757544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99345034, 'precision': 0.98696035, 'recall': 0.9744687, 'specificity': 0.9744687, 'f1': 0.9806123, 'auroc': 0.9976357, 'binary_precision': 0.9790112, 'binary_recall': 0.95106477, 'binary_specificity': 0.99787265, 'binary_f1_score': 0.9648357}
confusion matrix:
       0     1
0  42216    90
1    216  4198
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7508782, 'recall': 0.5858644, 'specificity': 0.5858644, 'f1': 0.6242901, 'auroc': 0.8238057, 'binary_precision': 0.53023255, 'binary_recall': 0.17729394, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.26573426}
confusion matrix:
       0    1
0  18048  101
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95557684, 'precision': 0.6560063, 'recall': 0.5352293, 'specificity': 0.5352293, 'f1': 0.55149776, 'auroc': 0.8003879, 'binary_precision': 0.3508772, 'binary_recall': 0.07662835, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.12578616}
confusion matrix:
      0   1
0  5960  37
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_21.png
early stop counter: 13
val acc:0.9664750695228577, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.960210919380188 / 0.9646852016448975
after epoch: 21,now: 2024-06-21 16:40:00.891012,epoch time: 0:11:17.959322,used: 5:16:45.716866,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9931721, 'precision': 0.9888032, 'recall': 0.9709606, 'specificity': 0.9709606, 'f1': 0.97967327, 'auroc': 0.9970293, 'binary_precision': 0.98346716, 'binary_recall': 0.9435758, 'binary_specificity': 0.99834543, 'binary_f1_score': 0.9631086}
confusion matrix:
       0     1
0  42237    70
1    249  4164
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.76812565, 'recall': 0.5786669, 'specificity': 0.5786669, 'f1': 0.61733556, 'auroc': 0.8350527, 'binary_precision': 0.5652174, 'binary_recall': 0.16174184, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.25151148}
confusion matrix:
       0    1
0  18069   80
1    539  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.6826461, 'recall': 0.53406394, 'specificity': 0.53406394, 'f1': 0.55063, 'auroc': 0.8055463, 'binary_precision': 0.40425533, 'binary_recall': 0.07279693, 'binary_specificity': 0.995331, 'binary_f1_score': 0.12337662}
confusion matrix:
      0   1
0  5969  28
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_22.png
early stop counter: 14
val acc:0.9670604467391968, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.960210919380188 / 0.9646852016448975
after epoch: 22,now: 2024-06-21 16:51:06.166512,epoch time: 0:11:05.275500,used: 5:27:50.992366,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99338615, 'precision': 0.9873215, 'recall': 0.9737288, 'specificity': 0.9737288, 'f1': 0.98040396, 'auroc': 0.99765503, 'binary_precision': 0.97989714, 'binary_recall': 0.94949037, 'binary_specificity': 0.9979671, 'binary_f1_score': 0.9644541}
confusion matrix:
       0     1
0  42219    86
1    223  4192
---- Validation: 
scalar performance:
{'acc': 0.96796507, 'precision': 0.7771366, 'recall': 0.61138767, 'specificity': 0.61138767, 'f1': 0.65585816, 'auroc': 0.8453428, 'binary_precision': 0.5810277, 'binary_recall': 0.22861587, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.32812503}
confusion matrix:
       0    1
0  18043  106
1    496  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9547779, 'precision': 0.6284028, 'recall': 0.5274831, 'specificity': 0.5274831, 'f1': 0.53919625, 'auroc': 0.7972861, 'binary_precision': 0.2962963, 'binary_recall': 0.06130268, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.101587296}
confusion matrix:
      0   1
0  5959  38
1   245  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_23.png
better model found
persisted
after epoch: 23,now: 2024-06-21 17:01:40.196931,epoch time: 0:10:34.030419,used: 5:38:25.022785,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9927012, 'precision': 0.9873769, 'recall': 0.9695909, 'specificity': 0.9695909, 'f1': 0.9782759, 'auroc': 0.99666893, 'binary_precision': 0.98087364, 'binary_recall': 0.9410965, 'binary_specificity': 0.9980854, 'binary_f1_score': 0.96057343}
confusion matrix:
       0     1
0  42225    81
1    260  4154
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.76601475, 'recall': 0.6073343, 'specificity': 0.6073343, 'f1': 0.649951, 'auroc': 0.8448267, 'binary_precision': 0.5590551, 'binary_recall': 0.22083981, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.31661093}
confusion matrix:
       0    1
0  18037  112
1    501  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95589644, 'precision': 0.6750507, 'recall': 0.54639006, 'specificity': 0.54639006, 'f1': 0.56794566, 'auroc': 0.81027853, 'binary_precision': 0.3880597, 'binary_recall': 0.099616855, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.15853658}
confusion matrix:
      0   1
0  5956  41
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_24.png
early stop counter: 1
val acc:0.9673797488212585, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9547778964042664 / 0.9646852016448975
after epoch: 24,now: 2024-06-21 17:11:58.467680,epoch time: 0:10:18.270749,used: 5:48:43.293534,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99342895, 'precision': 0.990412, 'recall': 0.97091234, 'specificity': 0.97091234, 'f1': 0.98041344, 'auroc': 0.9977129, 'binary_precision': 0.98672986, 'binary_recall': 0.9431484, 'binary_specificity': 0.9986763, 'binary_f1_score': 0.964447}
confusion matrix:
       0     1
0  42249    56
1    251  4164
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.7611836, 'recall': 0.5951406, 'specificity': 0.5951406, 'f1': 0.6360513, 'auroc': 0.83208597, 'binary_precision': 0.55021834, 'binary_recall': 0.19595645, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.28899083}
confusion matrix:
       0    1
0  18046  103
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95573664, 'precision': 0.66627795, 'recall': 0.5408097, 'specificity': 0.5408097, 'f1': 0.5598484, 'auroc': 0.7897697, 'binary_precision': 0.37096775, 'binary_recall': 0.08812261, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.14241487}
confusion matrix:
      0   1
0  5958  39
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_25.png
early stop counter: 2
val acc:0.9670072197914124, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9547778964042664 / 0.9646852016448975
after epoch: 25,now: 2024-06-21 17:21:51.018416,epoch time: 0:09:52.550736,used: 5:58:35.844270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99381423, 'precision': 0.9906448, 'recall': 0.972927, 'specificity': 0.972927, 'f1': 0.98158103, 'auroc': 0.99678445, 'binary_precision': 0.9867737, 'binary_recall': 0.9471775, 'binary_specificity': 0.9986764, 'binary_f1_score': 0.96657026}
confusion matrix:
       0     1
0  42253    56
1    233  4178
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.76599014, 'recall': 0.5801395, 'specificity': 0.5801395, 'f1': 0.61896896, 'auroc': 0.8266207, 'binary_precision': 0.56084657, 'binary_recall': 0.16485226, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.2548077}
confusion matrix:
       0    1
0  18066   83
1    537  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.6897528, 'recall': 0.5323984, 'specificity': 0.5323984, 'f1': 0.54823774, 'auroc': 0.79824555, 'binary_precision': 0.41860464, 'binary_recall': 0.06896552, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.118421055}
confusion matrix:
      0   1
0  5972  25
1   243  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_26.png
early stop counter: 3
val acc:0.9670072197914124, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9547778964042664 / 0.9646852016448975
after epoch: 26,now: 2024-06-21 17:31:49.409687,epoch time: 0:09:58.391271,used: 6:08:34.235541,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9940069, 'precision': 0.9887322, 'recall': 0.9759987, 'specificity': 0.9759987, 'f1': 0.9822596, 'auroc': 0.9975147, 'binary_precision': 0.98227197, 'binary_recall': 0.9537939, 'binary_specificity': 0.9982035, 'binary_f1_score': 0.96782345}
confusion matrix:
       0     1
0  42229    76
1    204  4211
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.76056015, 'recall': 0.61247456, 'specificity': 0.61247456, 'f1': 0.6544284, 'auroc': 0.8458538, 'binary_precision': 0.5477941, 'binary_recall': 0.23172629, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.3256831}
confusion matrix:
       0    1
0  18026  123
1    494  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9552573, 'precision': 0.66209334, 'recall': 0.54422426, 'specificity': 0.54422426, 'f1': 0.564269, 'auroc': 0.8150801, 'binary_precision': 0.36231884, 'binary_recall': 0.09578544, 'binary_specificity': 0.992663, 'binary_f1_score': 0.15151514}
confusion matrix:
      0   1
0  5953  44
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_27.png
early stop counter: 4
val acc:0.9671669006347656, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9547778964042664 / 0.9646852016448975
after epoch: 27,now: 2024-06-21 17:42:06.349850,epoch time: 0:10:16.940163,used: 6:18:51.175704,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9936858, 'precision': 0.9899512, 'recall': 0.9728739, 'specificity': 0.9728739, 'f1': 0.98122203, 'auroc': 0.99765265, 'binary_precision': 0.9853877, 'binary_recall': 0.9472134, 'binary_specificity': 0.9985345, 'binary_f1_score': 0.96592355}
confusion matrix:
       0     1
0  42244    62
1    233  4181
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.76983917, 'recall': 0.60591686, 'specificity': 0.60591686, 'f1': 0.64899135, 'auroc': 0.8359295, 'binary_precision': 0.5668016, 'binary_recall': 0.21772939, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.31460673}
confusion matrix:
       0    1
0  18042  107
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9541387, 'precision': 0.6476537, 'recall': 0.5454729, 'specificity': 0.5454729, 'f1': 0.56491166, 'auroc': 0.8067993, 'binary_precision': 0.33333334, 'binary_recall': 0.099616855, 'binary_specificity': 0.991329, 'binary_f1_score': 0.15339233}
confusion matrix:
      0   1
0  5945  52
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_28.png
early stop counter: 5
val acc:0.967539370059967, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9547778964042664 / 0.9646852016448975
after epoch: 28,now: 2024-06-21 17:53:02.248464,epoch time: 0:10:55.898614,used: 6:29:47.074318,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9937072, 'precision': 0.98985857, 'recall': 0.9730768, 'specificity': 0.9730768, 'f1': 0.9812837, 'auroc': 0.99719155, 'binary_precision': 0.9851555, 'binary_recall': 0.9476428, 'binary_specificity': 0.9985109, 'binary_f1_score': 0.9660351}
confusion matrix:
       0     1
0  42245    63
1    231  4181
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7696669, 'recall': 0.58550006, 'specificity': 0.58550006, 'f1': 0.6258215, 'auroc': 0.8309088, 'binary_precision': 0.5678392, 'binary_recall': 0.17573872, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.26840854}
confusion matrix:
       0    1
0  18063   86
1    530  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95589644, 'precision': 0.65689594, 'recall': 0.53173137, 'specificity': 0.53173137, 'f1': 0.5463845, 'auroc': 0.8012795, 'binary_precision': 0.3529412, 'binary_recall': 0.06896552, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.115384616}
confusion matrix:
      0   1
0  5964  33
1   243  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_29.png
early stop counter: 6
val acc:0.9672200679779053, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9547778964042664 / 0.9646852016448975
after epoch: 29,now: 2024-06-21 18:04:30.580477,epoch time: 0:11:28.332013,used: 6:41:15.406331,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99353594, 'precision': 0.98582256, 'recall': 0.9761342, 'specificity': 0.9761342, 'f1': 0.98091686, 'auroc': 0.99745506, 'binary_precision': 0.9763615, 'binary_recall': 0.95467937, 'binary_specificity': 0.99758905, 'binary_f1_score': 0.9653987}
confusion matrix:
       0     1
0  42205   102
1    200  4213
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7540835, 'recall': 0.6092815, 'specificity': 0.6092815, 'f1': 0.65013504, 'auroc': 0.83600104, 'binary_precision': 0.53505534, 'binary_recall': 0.22550544, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.31728667}
confusion matrix:
       0    1
0  18023  126
1    498  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9534995, 'precision': 0.6201582, 'recall': 0.5323131, 'specificity': 0.5323131, 'f1': 0.5458118, 'auroc': 0.7916461, 'binary_precision': 0.27941176, 'binary_recall': 0.07279693, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.115501516}
confusion matrix:
      0   1
0  5948  49
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_30.png
early stop counter: 7
val acc:0.9667943716049194, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9547778964042664 / 0.9646852016448975
after epoch: 30,now: 2024-06-21 18:15:35.331128,epoch time: 0:11:04.750651,used: 6:52:20.156982,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 6:52:20.156982 at 2024-06-21 18:15:35.331128
persisted model performance metric: 

scalar performance:
{'acc': 0.9547779, 'precision': 0.6284028, 'recall': 0.5274831, 'specificity': 0.5274831, 'f1': 0.53919625, 'auroc': 0.7972861, 'binary_precision': 0.2962963, 'binary_recall': 0.06130268, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.101587296}
confusion matrix:
      0   1
0  5959  38
1   245  16
oracle model performance metric: 

scalar performance:
{'acc': 0.9646852, 'precision': 0.8185891, 'recall': 0.6499217, 'specificity': 0.6499217, 'f1': 0.7008679, 'auroc': 0.8255654, 'binary_precision': 0.6666667, 'binary_recall': 0.3065134, 'binary_specificity': 0.99333, 'binary_f1_score': 0.41994753}
confusion matrix:
      0   1
0  5957  40
1   181  80
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204391 KiB | 755277 KiB | 711703 GiB | 711703 GiB |
|       from large pool | 167936 KiB | 683136 KiB | 711530 GiB | 711530 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    173 GiB |    173 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204391 KiB | 755277 KiB | 711703 GiB | 711703 GiB |
|       from large pool | 167936 KiB | 683136 KiB | 711530 GiB | 711530 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    173 GiB |    173 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 748328 KiB | 711586 GiB | 711586 GiB |
|       from large pool | 165120 KiB | 676736 KiB | 711420 GiB | 711420 GiB |
|       from small pool |  35968 KiB |  72872 KiB |    165 GiB |    165 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    930 MiB |    930 MiB |    930 MiB |      0 B   |
|       from large pool |    858 MiB |    858 MiB |    858 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 104856 KiB | 245592 KiB | 285290 GiB | 285290 GiB |
|       from large pool |  96256 KiB | 244616 KiB | 285116 GiB | 285116 GiB |
|       from small pool |   8600 KiB |  12473 KiB |    174 GiB |    174 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2076    |    3669    |   44382 K  |   44380 K  |
|       from large pool |      36    |      76    |   18225 K  |   18225 K  |
|       from small pool |    2040    |    3632    |   26156 K  |   26154 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2076    |    3669    |   44382 K  |   44380 K  |
|       from large pool |      36    |      76    |   18225 K  |   18225 K  |
|       from small pool |    2040    |    3632    |   26156 K  |   26154 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      15    |      15    |      15    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    1476    |   19219 K  |   19219 K  |
|       from large pool |       5    |      10    |    5763 K  |    5763 K  |
|       from small pool |      29    |    1471    |   13456 K  |   13456 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755277 KiB | 711703 GiB | 711703 GiB |
|       from large pool |  16640 KiB | 683136 KiB | 711530 GiB | 711530 GiB |
|       from small pool |      0 KiB |  73422 KiB |    173 GiB |    173 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755277 KiB | 711703 GiB | 711703 GiB |
|       from large pool |  16640 KiB | 683136 KiB | 711530 GiB | 711530 GiB |
|       from small pool |      0 KiB |  73422 KiB |    173 GiB |    173 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB | 711586 GiB | 711586 GiB |
|       from large pool |  16640 KiB | 676736 KiB | 711420 GiB | 711420 GiB |
|       from small pool |      0 KiB |  72872 KiB |    165 GiB |    165 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    930 MiB |    930 MiB | 643072 KiB |
|       from large pool | 264192 KiB |    858 MiB |    858 MiB | 614400 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 245592 KiB | 285291 GiB | 285290 GiB |
|       from large pool |  83712 KiB | 244616 KiB | 285116 GiB | 285116 GiB |
|       from small pool |      0 KiB |  16195 KiB |    174 GiB |    174 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   44382 K  |   44382 K  |
|       from large pool |       2    |      76    |   18225 K  |   18225 K  |
|       from small pool |       0    |    3632    |   26156 K  |   26156 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   44382 K  |   44382 K  |
|       from large pool |       2    |      76    |   18225 K  |   18225 K  |
|       from small pool |       0    |    3632    |   26156 K  |   26156 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   19220 K  |   19220 K  |
|       from large pool |       1    |      11    |    5763 K  |    5763 K  |
|       from small pool |       0    |    1471    |   13457 K  |   13457 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755277 KiB | 711703 GiB | 711703 GiB |
|       from large pool |  16640 KiB | 683136 KiB | 711530 GiB | 711530 GiB |
|       from small pool |      0 KiB |  73422 KiB |    173 GiB |    173 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755277 KiB | 711703 GiB | 711703 GiB |
|       from large pool |  16640 KiB | 683136 KiB | 711530 GiB | 711530 GiB |
|       from small pool |      0 KiB |  73422 KiB |    173 GiB |    173 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB | 711586 GiB | 711586 GiB |
|       from large pool |  16640 KiB | 676736 KiB | 711420 GiB | 711420 GiB |
|       from small pool |      0 KiB |  72872 KiB |    165 GiB |    165 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    930 MiB |    930 MiB | 643072 KiB |
|       from large pool | 264192 KiB |    858 MiB |    858 MiB | 614400 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 245592 KiB | 285291 GiB | 285290 GiB |
|       from large pool |  83712 KiB | 244616 KiB | 285116 GiB | 285116 GiB |
|       from small pool |      0 KiB |  16195 KiB |    174 GiB |    174 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   44382 K  |   44382 K  |
|       from large pool |       2    |      76    |   18225 K  |   18225 K  |
|       from small pool |       0    |    3632    |   26156 K  |   26156 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   44382 K  |   44382 K  |
|       from large pool |       2    |      76    |   18225 K  |   18225 K  |
|       from small pool |       0    |    3632    |   26156 K  |   26156 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   19220 K  |   19220 K  |
|       from large pool |       1    |      11    |    5763 K  |    5763 K  |
|       from small pool |       0    |    1471    |   13457 K  |   13457 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821

 Experiment start at: 2024-06-21 18:20:15.179217
before training, model accuracy: 0.14647115767002106
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9791952, 'precision': 0.97037935, 'recall': 0.90276474, 'specificity': 0.90276474, 'f1': 0.9333199, 'auroc': 0.9813495, 'binary_precision': 0.9599341, 'binary_recall': 0.8089732, 'binary_specificity': 0.9965563, 'binary_f1_score': 0.87801206}
confusion matrix:
       0     1
0  42250   146
1    826  3498
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.743737, 'recall': 0.6032476, 'specificity': 0.6032476, 'f1': 0.64217156, 'auroc': 0.7312492, 'binary_precision': 0.516129, 'binary_recall': 0.21396731, 'binary_specificity': 0.99252784, 'binary_f1_score': 0.302521}
confusion matrix:
       0    1
0  17932  135
1    529  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.7727357, 'recall': 0.58752555, 'specificity': 0.58752555, 'f1': 0.62759876, 'auroc': 0.7707303, 'binary_precision': 0.5802469, 'binary_recall': 0.18076923, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.27565983}
confusion matrix:
      0   1
0  5912  34
1   213  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 18:30:31.945331,epoch time: 0:10:16.766114,used: 0:10:16.766114,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98313355, 'precision': 0.9767884, 'recall': 0.9209441, 'specificity': 0.9209441, 'f1': 0.94670546, 'auroc': 0.98751974, 'binary_precision': 0.9692226, 'binary_recall': 0.8446243, 'binary_specificity': 0.99726385, 'binary_f1_score': 0.902644}
confusion matrix:
       0     1
0  42279   116
1    672  3653
---- Validation: 
scalar performance:
{'acc': 0.96558166, 'precision': 0.7597959, 'recall': 0.6166482, 'specificity': 0.6166482, 'f1': 0.65834975, 'auroc': 0.78413934, 'binary_precision': 0.5472973, 'binary_recall': 0.24071322, 'binary_specificity': 0.99258316, 'binary_f1_score': 0.33436534}
confusion matrix:
       0    1
0  17933  134
1    511  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.85350007, 'recall': 0.6533306, 'specificity': 0.6533306, 'f1': 0.7102825, 'auroc': 0.8305758, 'binary_precision': 0.73636365, 'binary_recall': 0.31153846, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.43783784}
confusion matrix:
      0   1
0  5917  29
1   179  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-21 18:41:27.979401,epoch time: 0:10:56.034070,used: 0:21:12.800184,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9858947, 'precision': 0.9781194, 'recall': 0.93645155, 'specificity': 0.93645155, 'f1': 0.9561014, 'auroc': 0.99180424, 'binary_precision': 0.968782, 'binary_recall': 0.8757807, 'binary_specificity': 0.99712247, 'binary_f1_score': 0.9199368}
confusion matrix:
       0     1
0  42275   122
1    537  3786
---- Validation: 
scalar performance:
{'acc': 0.9654749, 'precision': 0.757838, 'recall': 0.6173081, 'specificity': 0.6173081, 'f1': 0.65866184, 'auroc': 0.7924748, 'binary_precision': 0.54333335, 'binary_recall': 0.24219911, 'binary_specificity': 0.9924171, 'binary_f1_score': 0.33504623}
confusion matrix:
       0    1
0  17930  137
1    510  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.86008686, 'recall': 0.6478137, 'specificity': 0.6478137, 'f1': 0.70565355, 'auroc': 0.8255776, 'binary_precision': 0.75, 'binary_recall': 0.3, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.42857146}
confusion matrix:
      0   1
0  5920  26
1   182  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_3.png
early stop counter: 1
val acc:0.9654749035835266, best validation acc: 0.9655816555023193, corresponding to test acc:                         0.9664840698242188 / 0.9664840698242188
after epoch: 3,now: 2024-06-21 18:52:46.301703,epoch time: 0:11:18.322302,used: 0:32:31.122486,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.986387, 'precision': 0.9698275, 'recall': 0.94783664, 'specificity': 0.94783664, 'f1': 0.95850134, 'auroc': 0.99317294, 'binary_precision': 0.94974387, 'binary_recall': 0.90053207, 'binary_specificity': 0.99514115, 'binary_f1_score': 0.9244835}
confusion matrix:
       0     1
0  42191   206
1    430  3893
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.7478195, 'recall': 0.6535377, 'specificity': 0.6535377, 'f1': 0.688405, 'auroc': 0.81854063, 'binary_precision': 0.52068126, 'binary_recall': 0.3179792, 'binary_specificity': 0.98909616, 'binary_f1_score': 0.39483392}
confusion matrix:
       0    1
0  17870  197
1    459  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.80951315, 'recall': 0.67831963, 'specificity': 0.67831963, 'f1': 0.72437733, 'auroc': 0.8361614, 'binary_precision': 0.64625853, 'binary_recall': 0.3653846, 'binary_specificity': 0.9912546, 'binary_f1_score': 0.46683046}
confusion matrix:
      0   1
0  5894  52
1   165  95
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_4.png
early stop counter: 2
val acc:0.9649946689605713, best validation acc: 0.9655816555023193, corresponding to test acc:                         0.9664840698242188 / 0.9664840698242188
after epoch: 4,now: 2024-06-21 19:02:57.593056,epoch time: 0:10:11.291353,used: 0:42:42.413839,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.988506, 'precision': 0.9783406, 'recall': 0.9522346, 'specificity': 0.9522346, 'f1': 0.9648293, 'auroc': 0.99366397, 'binary_precision': 0.96603495, 'binary_recall': 0.9077243, 'binary_specificity': 0.996745, 'binary_f1_score': 0.93597233}
confusion matrix:
       0     1
0  42258   138
1    399  3925
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.7647777, 'recall': 0.6196753, 'specificity': 0.6196753, 'f1': 0.66220653, 'auroc': 0.8171455, 'binary_precision': 0.557047, 'binary_recall': 0.24665676, 'binary_specificity': 0.99269384, 'binary_f1_score': 0.34191555}
confusion matrix:
       0    1
0  17935  132
1    507  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.8338107, 'recall': 0.63961685, 'specificity': 0.63961685, 'f1': 0.69313717, 'auroc': 0.8327704, 'binary_precision': 0.6981132, 'binary_recall': 0.2846154, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.4043716}
confusion matrix:
      0   1
0  5914  32
1   186  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_5.png
better model found
persisted
after epoch: 5,now: 2024-06-21 19:13:29.098553,epoch time: 0:10:31.505497,used: 0:53:13.919336,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9893622, 'precision': 0.9766468, 'recall': 0.95923936, 'specificity': 0.95923936, 'f1': 0.96774006, 'auroc': 0.9949456, 'binary_precision': 0.9611861, 'binary_recall': 0.9222762, 'binary_specificity': 0.9962026, 'binary_f1_score': 0.94132924}
confusion matrix:
       0     1
0  42236   161
1    336  3987
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.7712376, 'recall': 0.63068104, 'specificity': 0.63068104, 'f1': 0.6740248, 'auroc': 0.8330295, 'binary_precision': 0.5691824, 'binary_recall': 0.268945, 'binary_specificity': 0.9924171, 'binary_f1_score': 0.3652876}
confusion matrix:
       0    1
0  17930  137
1    492  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.8264305, 'recall': 0.61495316, 'specificity': 0.61495316, 'f1': 0.6653762, 'auroc': 0.8419505, 'binary_precision': 0.6853933, 'binary_recall': 0.23461539, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.3495702}
confusion matrix:
      0   1
0  5918  28
1   199  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_6.png
better model found
persisted
after epoch: 6,now: 2024-06-21 19:23:49.455625,epoch time: 0:10:20.357072,used: 1:03:34.276408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9904324, 'precision': 0.98087156, 'recall': 0.96149945, 'specificity': 0.96149945, 'f1': 0.97093606, 'auroc': 0.99544275, 'binary_precision': 0.9692568, 'binary_recall': 0.92599446, 'binary_specificity': 0.99700445, 'binary_f1_score': 0.9471319}
confusion matrix:
       0     1
0  42269   127
1    320  4004
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.78070843, 'recall': 0.61722934, 'specificity': 0.61722934, 'f1': 0.66234565, 'auroc': 0.8240957, 'binary_precision': 0.5890909, 'binary_recall': 0.24071322, 'binary_specificity': 0.9937455, 'binary_f1_score': 0.34177214}
confusion matrix:
       0    1
0  17954  113
1    511  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.7824361, 'recall': 0.60825896, 'specificity': 0.60825896, 'f1': 0.65246916, 'auroc': 0.8233441, 'binary_precision': 0.5979381, 'binary_recall': 0.22307692, 'binary_specificity': 0.993441, 'binary_f1_score': 0.32492995}
confusion matrix:
      0   1
0  5907  39
1   202  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_7.png
better model found
persisted
after epoch: 7,now: 2024-06-21 19:36:07.823548,epoch time: 0:12:18.367923,used: 1:15:52.644331,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99086046, 'precision': 0.9848026, 'recall': 0.9601866, 'specificity': 0.9601866, 'f1': 0.9720937, 'auroc': 0.9948852, 'binary_precision': 0.97746205, 'binary_recall': 0.92254335, 'binary_specificity': 0.9978299, 'binary_f1_score': 0.94920903}
confusion matrix:
       0     1
0  42303    92
1    335  3990
---- Validation: 
scalar performance:
{'acc': 0.96766275, 'precision': 0.80135155, 'recall': 0.6177275, 'specificity': 0.6177275, 'f1': 0.6659035, 'auroc': 0.8266857, 'binary_precision': 0.6303502, 'binary_recall': 0.24071322, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.3483871}
confusion matrix:
       0    1
0  17972   95
1    511  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.793512, 'recall': 0.6010712, 'specificity': 0.6010712, 'f1': 0.6457149, 'auroc': 0.83356345, 'binary_precision': 0.62068963, 'binary_recall': 0.20769231, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.31123918}
confusion matrix:
      0   1
0  5913  33
1   206  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_8.png
better model found
persisted
after epoch: 8,now: 2024-06-21 19:48:52.178344,epoch time: 0:12:44.354796,used: 1:28:36.999127,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99135274, 'precision': 0.98336554, 'recall': 0.9646026, 'specificity': 0.9646026, 'f1': 0.97375154, 'auroc': 0.9959475, 'binary_precision': 0.9736588, 'binary_recall': 0.9317761, 'binary_specificity': 0.997429, 'binary_f1_score': 0.95225716}
confusion matrix:
       0     1
0  42287   109
1    295  4029
---- Validation: 
scalar performance:
{'acc': 0.96616864, 'precision': 0.7705822, 'recall': 0.61623734, 'specificity': 0.61623734, 'f1': 0.6597308, 'auroc': 0.83799005, 'binary_precision': 0.5689046, 'binary_recall': 0.23922734, 'binary_specificity': 0.99324733, 'binary_f1_score': 0.3368201}
confusion matrix:
       0    1
0  17945  122
1    512  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.7779506, 'recall': 0.5913717, 'specificity': 0.5913717, 'f1': 0.6327071, 'auroc': 0.8464581, 'binary_precision': 0.5903614, 'binary_recall': 0.18846154, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.28571427}
confusion matrix:
      0   1
0  5912  34
1   211  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_9.png
early stop counter: 1
val acc:0.9661686420440674, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9614889025688171 / 0.9664840698242188
after epoch: 9,now: 2024-06-21 20:01:26.139982,epoch time: 0:12:33.961638,used: 1:41:10.960765,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9916952, 'precision': 0.9812717, 'recall': 0.9688342, 'specificity': 0.9688342, 'f1': 0.9749508, 'auroc': 0.9959687, 'binary_precision': 0.9685639, 'binary_recall': 0.9407819, 'binary_specificity': 0.99688655, 'binary_f1_score': 0.95447075}
confusion matrix:
       0     1
0  42265   132
1    256  4067
---- Validation: 
scalar performance:
{'acc': 0.96558166, 'precision': 0.7610969, 'recall': 0.6102108, 'specificity': 0.6102108, 'f1': 0.65205467, 'auroc': 0.83456004, 'binary_precision': 0.5503597, 'binary_recall': 0.22734027, 'binary_specificity': 0.99308133, 'binary_f1_score': 0.32176656}
confusion matrix:
       0    1
0  17942  125
1    520  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95617145, 'precision': 0.70231247, 'recall': 0.57990634, 'specificity': 0.57990634, 'f1': 0.61093783, 'auroc': 0.8371305, 'binary_precision': 0.44, 'binary_recall': 0.16923077, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.24444446}
confusion matrix:
      0   1
0  5890  56
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_10.png
early stop counter: 2
val acc:0.9655816555023193, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9614889025688171 / 0.9664840698242188
after epoch: 10,now: 2024-06-21 20:12:43.495110,epoch time: 0:11:17.355128,used: 1:52:28.315893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9916952, 'precision': 0.98198116, 'recall': 0.9681212, 'specificity': 0.9681212, 'f1': 0.9749244, 'auroc': 0.9966682, 'binary_precision': 0.9701457, 'binary_recall': 0.93919075, 'binary_specificity': 0.99705154, 'binary_f1_score': 0.95441735}
confusion matrix:
       0     1
0  42270   125
1    263  4062
---- Validation: 
scalar performance:
{'acc': 0.96707577, 'precision': 0.78160393, 'recall': 0.633159, 'specificity': 0.633159, 'f1': 0.6783488, 'auroc': 0.83922136, 'binary_precision': 0.5897436, 'binary_recall': 0.27340266, 'binary_specificity': 0.9929153, 'binary_f1_score': 0.37360406}
confusion matrix:
       0    1
0  17939  128
1    489  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.71925086, 'recall': 0.5823339, 'specificity': 0.5823339, 'f1': 0.6157711, 'auroc': 0.8310261, 'binary_precision': 0.47368422, 'binary_recall': 0.17307693, 'binary_specificity': 0.991591, 'binary_f1_score': 0.2535211}
confusion matrix:
      0   1
0  5896  50
1   215  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_11.png
early stop counter: 3
val acc:0.967075765132904, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9614889025688171 / 0.9664840698242188
after epoch: 11,now: 2024-06-21 20:24:17.622063,epoch time: 0:11:34.126953,used: 2:04:02.442846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.992744, 'precision': 0.9874148, 'recall': 0.9690105, 'specificity': 0.9690105, 'f1': 0.977991, 'auroc': 0.9967319, 'binary_precision': 0.9809363, 'binary_recall': 0.93988436, 'binary_specificity': 0.9981366, 'binary_f1_score': 0.9599716}
confusion matrix:
       0     1
0  42316    79
1    260  4065
---- Validation: 
scalar performance:
{'acc': 0.9674493, 'precision': 0.795239, 'recall': 0.6197626, 'specificity': 0.6197626, 'f1': 0.6671849, 'auroc': 0.8443192, 'binary_precision': 0.6179775, 'binary_recall': 0.24517088, 'binary_specificity': 0.99435437, 'binary_f1_score': 0.35106382}
confusion matrix:
       0    1
0  17965  102
1    508  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.78363085, 'recall': 0.57657576, 'specificity': 0.57657576, 'f1': 0.61482126, 'auroc': 0.8445708, 'binary_precision': 0.60294116, 'binary_recall': 0.15769231, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.25}
confusion matrix:
      0   1
0  5919  27
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_12.png
early stop counter: 4
val acc:0.9674493074417114, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9614889025688171 / 0.9664840698242188
after epoch: 12,now: 2024-06-21 20:34:14.194518,epoch time: 0:09:56.572455,used: 2:13:59.015301,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99242294, 'precision': 0.984008, 'recall': 0.97049457, 'specificity': 0.97049457, 'f1': 0.97713137, 'auroc': 0.9964376, 'binary_precision': 0.9737533, 'binary_recall': 0.9435838, 'binary_specificity': 0.99740535, 'binary_f1_score': 0.9584312}
confusion matrix:
       0     1
0  42285   110
1    244  4081
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.779472, 'recall': 0.62297916, 'specificity': 0.62297916, 'f1': 0.6680014, 'auroc': 0.8442371, 'binary_precision': 0.5862069, 'binary_recall': 0.25260028, 'binary_specificity': 0.9933581, 'binary_f1_score': 0.35306332}
confusion matrix:
       0    1
0  17947  120
1    503  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95633256, 'precision': 0.6873031, 'recall': 0.54688865, 'specificity': 0.54688865, 'f1': 0.5692868, 'auroc': 0.8336068, 'binary_precision': 0.41269842, 'binary_recall': 0.1, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.16099072}
confusion matrix:
      0   1
0  5909  37
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_13.png
early stop counter: 5
val acc:0.9667556285858154, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9614889025688171 / 0.9664840698242188
after epoch: 13,now: 2024-06-21 20:47:04.614930,epoch time: 0:12:50.420412,used: 2:26:49.435713,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.991845, 'precision': 0.9797926, 'recall': 0.9712995, 'specificity': 0.9712995, 'f1': 0.97549844, 'auroc': 0.9960084, 'binary_precision': 0.96506965, 'binary_recall': 0.94608974, 'binary_specificity': 0.99650925, 'binary_f1_score': 0.95548546}
confusion matrix:
       0     1
0  42250   148
1    233  4089
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.74289846, 'recall': 0.63829565, 'specificity': 0.63829565, 'f1': 0.67469615, 'auroc': 0.8487912, 'binary_precision': 0.51193637, 'binary_recall': 0.28677562, 'binary_specificity': 0.9898157, 'binary_f1_score': 0.36761904}
confusion matrix:
       0    1
0  17883  184
1    480  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9547212, 'precision': 0.6930512, 'recall': 0.5993784, 'specificity': 0.5993784, 'f1': 0.62897706, 'auroc': 0.8406849, 'binary_precision': 0.41984734, 'binary_recall': 0.21153846, 'binary_specificity': 0.9872183, 'binary_f1_score': 0.28132993}
confusion matrix:
      0   1
0  5870  76
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_14.png
early stop counter: 6
val acc:0.9645677804946899, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9614889025688171 / 0.9664840698242188
after epoch: 14,now: 2024-06-21 20:57:39.310248,epoch time: 0:10:34.695318,used: 2:37:24.131031,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9925086, 'precision': 0.98518276, 'recall': 0.96980166, 'specificity': 0.96980166, 'f1': 0.97733706, 'auroc': 0.9961225, 'binary_precision': 0.97626466, 'binary_recall': 0.94193846, 'binary_specificity': 0.9976649, 'binary_f1_score': 0.9587944}
confusion matrix:
       0     1
0  42298    99
1    251  4072
---- Validation: 
scalar performance:
{'acc': 0.96600854, 'precision': 0.77090067, 'recall': 0.6054253, 'specificity': 0.6054253, 'f1': 0.64844435, 'auroc': 0.8493384, 'binary_precision': 0.5703125, 'binary_recall': 0.21693908, 'binary_specificity': 0.99391156, 'binary_f1_score': 0.31431645}
confusion matrix:
       0    1
0  17957  110
1    527  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9558492, 'precision': 0.6877224, 'recall': 0.5595093, 'specificity': 0.5595093, 'f1': 0.5857102, 'auroc': 0.8382072, 'binary_precision': 0.4125, 'binary_recall': 0.12692308, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.19411764}
confusion matrix:
      0   1
0  5899  47
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_15.png
early stop counter: 7
val acc:0.9660085439682007, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9614889025688171 / 0.9664840698242188
after epoch: 15,now: 2024-06-21 21:07:52.882868,epoch time: 0:10:13.572620,used: 2:47:37.703651,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9926156, 'precision': 0.98495144, 'recall': 0.9706981, 'specificity': 0.9706981, 'f1': 0.9776916, 'auroc': 0.997038, 'binary_precision': 0.97561556, 'binary_recall': 0.94380206, 'binary_specificity': 0.9975941, 'binary_f1_score': 0.9594452}
confusion matrix:
       0     1
0  42294   102
1    243  4081
---- Validation: 
scalar performance:
{'acc': 0.96616864, 'precision': 0.77908677, 'recall': 0.5947793, 'specificity': 0.5947793, 'f1': 0.6375404, 'auroc': 0.8424343, 'binary_precision': 0.58744395, 'binary_recall': 0.19465081, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.2924107}
confusion matrix:
       0    1
0  17975   92
1    542  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.7036373, 'recall': 0.55817485, 'specificity': 0.55817485, 'f1': 0.5852928, 'auroc': 0.8399889, 'binary_precision': 0.44444445, 'binary_recall': 0.12307692, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.19277108}
confusion matrix:
      0   1
0  5906  40
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_16.png
early stop counter: 8
val acc:0.9661686420440674, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9614889025688171 / 0.9664840698242188
after epoch: 16,now: 2024-06-21 21:17:45.420780,epoch time: 0:09:52.537912,used: 2:57:30.241563,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99310786, 'precision': 0.9883809, 'recall': 0.97024244, 'specificity': 0.97024244, 'f1': 0.9790969, 'auroc': 0.99773276, 'binary_precision': 0.9826339, 'binary_recall': 0.94218314, 'binary_specificity': 0.99830174, 'binary_f1_score': 0.96198344}
confusion matrix:
       0     1
0  42324    72
1    250  4074
---- Validation: 
scalar performance:
{'acc': 0.96600854, 'precision': 0.7776374, 'recall': 0.58968943, 'specificity': 0.58968943, 'f1': 0.6314096, 'auroc': 0.84728456, 'binary_precision': 0.5849057, 'binary_recall': 0.18424962, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.280226}
confusion matrix:
       0    1
0  17979   88
1    549  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.698998, 'recall': 0.54354703, 'specificity': 0.54354703, 'f1': 0.5651547, 'auroc': 0.8360706, 'binary_precision': 0.43636364, 'binary_recall': 0.092307694, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.15238096}
confusion matrix:
      0   1
0  5915  31
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_17.png
early stop counter: 9
val acc:0.9660085439682007, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9614889025688171 / 0.9664840698242188
after epoch: 17,now: 2024-06-21 21:27:32.290325,epoch time: 0:09:46.869545,used: 3:07:17.111108,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.992637, 'precision': 0.98817927, 'recall': 0.9675801, 'specificity': 0.9675801, 'f1': 0.9776021, 'auroc': 0.99709606, 'binary_precision': 0.982767, 'binary_recall': 0.9368348, 'binary_specificity': 0.9983254, 'binary_f1_score': 0.95925134}
confusion matrix:
       0     1
0  42327    71
1    273  4049
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.8045192, 'recall': 0.5887294, 'specificity': 0.5887294, 'f1': 0.63273746, 'auroc': 0.84240645, 'binary_precision': 0.63874346, 'binary_recall': 0.18127786, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.2824074}
confusion matrix:
       0    1
0  17998   69
1    551  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95649374, 'precision': 0.68608886, 'recall': 0.5414558, 'specificity': 0.5414558, 'f1': 0.56162405, 'auroc': 0.82847744, 'binary_precision': 0.4107143, 'binary_recall': 0.08846154, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.14556962}
confusion matrix:
      0   1
0  5913  33
1   237  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_18.png
early stop counter: 10
val acc:0.9669156670570374, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9614889025688171 / 0.9664840698242188
after epoch: 18,now: 2024-06-21 21:37:25.574248,epoch time: 0:09:53.283923,used: 3:17:10.395031,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9925514, 'precision': 0.9841982, 'recall': 0.9710844, 'specificity': 0.9710844, 'f1': 0.97752845, 'auroc': 0.9967425, 'binary_precision': 0.97401667, 'binary_recall': 0.9447399, 'binary_specificity': 0.99742895, 'binary_f1_score': 0.9591549}
confusion matrix:
       0     1
0  42286   109
1    239  4086
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.7775859, 'recall': 0.60052913, 'specificity': 0.60052913, 'f1': 0.6439247, 'auroc': 0.84860826, 'binary_precision': 0.5840336, 'binary_recall': 0.20653789, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.30515915}
confusion matrix:
       0    1
0  17968   99
1    534  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9545601, 'precision': 0.6446063, 'recall': 0.53676873, 'specificity': 0.53676873, 'f1': 0.55315036, 'auroc': 0.83479637, 'binary_precision': 0.328125, 'binary_recall': 0.08076923, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.12962963}
confusion matrix:
      0   1
0  5903  43
1   239  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_19.png
early stop counter: 11
val acc:0.9662219882011414, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9614889025688171 / 0.9664840698242188
after epoch: 19,now: 2024-06-21 21:47:16.425509,epoch time: 0:09:50.851261,used: 3:27:01.246292,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9931507, 'precision': 0.98450834, 'recall': 0.9744196, 'specificity': 0.9744196, 'f1': 0.9793974, 'auroc': 0.99731576, 'binary_precision': 0.9739583, 'binary_recall': 0.95143384, 'binary_specificity': 0.9974054, 'binary_f1_score': 0.96256435}
confusion matrix:
       0     1
0  42286   110
1    210  4114
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.7797138, 'recall': 0.60129976, 'specificity': 0.60129976, 'f1': 0.64504975, 'auroc': 0.84240395, 'binary_precision': 0.5882353, 'binary_recall': 0.20802377, 'binary_specificity': 0.99457574, 'binary_f1_score': 0.30735454}
confusion matrix:
       0    1
0  17969   98
1    533  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9547212, 'precision': 0.6725381, 'recall': 0.56075966, 'specificity': 0.56075966, 'f1': 0.58577406, 'auroc': 0.83645, 'binary_precision': 0.38202247, 'binary_recall': 0.13076924, 'binary_specificity': 0.9907501, 'binary_f1_score': 0.19484243}
confusion matrix:
      0   1
0  5891  55
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_20.png
early stop counter: 12
val acc:0.9663286805152893, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9614889025688171 / 0.9664840698242188
after epoch: 20,now: 2024-06-21 21:57:15.116638,epoch time: 0:09:58.691129,used: 3:36:59.937421,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99345034, 'precision': 0.98664093, 'recall': 0.97407126, 'specificity': 0.97407126, 'f1': 0.9802531, 'auroc': 0.99763525, 'binary_precision': 0.9783385, 'binary_recall': 0.950289, 'binary_specificity': 0.9978535, 'binary_f1_score': 0.9641098}
confusion matrix:
       0     1
0  42304    91
1    215  4110
---- Validation: 
scalar performance:
{'acc': 0.96750265, 'precision': 0.80776167, 'recall': 0.6040544, 'specificity': 0.6040544, 'f1': 0.65145344, 'auroc': 0.83913714, 'binary_precision': 0.6441441, 'binary_recall': 0.21248142, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.31955305}
confusion matrix:
       0    1
0  17988   79
1    530  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95649374, 'precision': 0.6825048, 'recall': 0.5377778, 'specificity': 0.5377778, 'f1': 0.5561507, 'auroc': 0.8071687, 'binary_precision': 0.40384614, 'binary_recall': 0.08076923, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.13461539}
confusion matrix:
      0   1
0  5915  31
1   239  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_21.png
early stop counter: 13
val acc:0.9675026535987854, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9614889025688171 / 0.9664840698242188
after epoch: 21,now: 2024-06-21 22:06:57.550697,epoch time: 0:09:42.434059,used: 3:46:42.371480,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9932577, 'precision': 0.9896331, 'recall': 0.9699029, 'specificity': 0.9699029, 'f1': 0.97951436, 'auroc': 0.996981, 'binary_precision': 0.98523, 'binary_recall': 0.9412445, 'binary_specificity': 0.9985612, 'binary_f1_score': 0.9627351}
confusion matrix:
       0     1
0  42336    61
1    254  4069
---- Validation: 
scalar performance:
{'acc': 0.9669691, 'precision': 0.80478656, 'recall': 0.59018755, 'specificity': 0.59018755, 'f1': 0.63456863, 'auroc': 0.8295926, 'binary_precision': 0.63917524, 'binary_recall': 0.18424962, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.28604382}
confusion matrix:
       0    1
0  17997   70
1    549  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95520467, 'precision': 0.6603941, 'recall': 0.5407831, 'specificity': 0.5407831, 'f1': 0.55948865, 'auroc': 0.80657387, 'binary_precision': 0.359375, 'binary_recall': 0.08846154, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.14197531}
confusion matrix:
      0   1
0  5905  41
1   237  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_22.png
early stop counter: 14
val acc:0.9669690728187561, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9614889025688171 / 0.9664840698242188
after epoch: 22,now: 2024-06-21 22:16:38.090950,epoch time: 0:09:40.540253,used: 3:56:22.911733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9931507, 'precision': 0.9888302, 'recall': 0.97006506, 'specificity': 0.97006506, 'f1': 0.9792179, 'auroc': 0.9973574, 'binary_precision': 0.98357886, 'binary_recall': 0.9417341, 'binary_specificity': 0.99839604, 'binary_f1_score': 0.9622017}
confusion matrix:
       0     1
0  42327    68
1    252  4073
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.78781307, 'recall': 0.6050975, 'specificity': 0.6050975, 'f1': 0.6502985, 'auroc': 0.8531271, 'binary_precision': 0.6041667, 'binary_recall': 0.2154532, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.31763417}
confusion matrix:
       0    1
0  17972   95
1    528  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95617145, 'precision': 0.6728082, 'recall': 0.53577065, 'specificity': 0.53577065, 'f1': 0.5528629, 'auroc': 0.82957256, 'binary_precision': 0.3846154, 'binary_recall': 0.07692308, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.12820514}
confusion matrix:
      0   1
0  5914  32
1   240  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_23.png
early stop counter: 15
val acc:0.9667556285858154, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9614889025688171 / 0.9664840698242188
after epoch: 23,now: 2024-06-21 22:26:20.943139,epoch time: 0:09:42.852189,used: 4:06:05.763922,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9917594, 'precision': 0.9759769, 'recall': 0.9748887, 'specificity': 0.9748887, 'f1': 0.975432, 'auroc': 0.99741673, 'binary_precision': 0.9566226, 'binary_recall': 0.95418787, 'binary_specificity': 0.99558944, 'binary_f1_score': 0.9554037}
confusion matrix:
       0     1
0  42211   187
1    198  4124
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.74467015, 'recall': 0.6548298, 'specificity': 0.6548298, 'f1': 0.6885383, 'auroc': 0.8665894, 'binary_precision': 0.51428574, 'binary_recall': 0.32095096, 'binary_specificity': 0.9887087, 'binary_f1_score': 0.39524248}
confusion matrix:
       0    1
0  17863  204
1    457  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9503706, 'precision': 0.63658756, 'recall': 0.5676842, 'specificity': 0.5676842, 'f1': 0.58823067, 'auroc': 0.841693, 'binary_precision': 0.30952382, 'binary_recall': 0.15, 'binary_specificity': 0.9853683, 'binary_f1_score': 0.20207255}
confusion matrix:
      0   1
0  5859  87
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_24.png
early stop counter: 16
val acc:0.9647278785705566, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9614889025688171 / 0.9664840698242188
after epoch: 24,now: 2024-06-21 22:36:01.762941,epoch time: 0:09:40.819802,used: 4:15:46.583724,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99336475, 'precision': 0.98886, 'recall': 0.97131854, 'specificity': 0.97131854, 'f1': 0.9798888, 'auroc': 0.9972711, 'binary_precision': 0.9833815, 'binary_recall': 0.9442646, 'binary_specificity': 0.9983725, 'binary_f1_score': 0.9634262}
confusion matrix:
       0     1
0  42327    69
1    241  4083
---- Validation: 
scalar performance:
{'acc': 0.96600854, 'precision': 0.7727561, 'recall': 0.60041845, 'specificity': 0.60041845, 'f1': 0.64320207, 'auroc': 0.8526349, 'binary_precision': 0.57438016, 'binary_recall': 0.20653789, 'binary_specificity': 0.994299, 'binary_f1_score': 0.30382514}
confusion matrix:
       0    1
0  17964  103
1    534  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95649374, 'precision': 0.6932287, 'recall': 0.5506507, 'specificity': 0.5506507, 'f1': 0.5747196, 'auroc': 0.8266478, 'binary_precision': 0.42424244, 'binary_recall': 0.10769231, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.17177914}
confusion matrix:
      0   1
0  5908  38
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_25.png
early stop counter: 17
val acc:0.9660085439682007, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9614889025688171 / 0.9664840698242188
after epoch: 25,now: 2024-06-21 22:45:40.768960,epoch time: 0:09:39.006019,used: 4:25:25.589743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99340755, 'precision': 0.9903619, 'recall': 0.9700825, 'specificity': 0.9700825, 'f1': 0.9799546, 'auroc': 0.9977789, 'binary_precision': 0.98666346, 'binary_recall': 0.9414623, 'binary_specificity': 0.99870276, 'binary_f1_score': 0.96353304}
confusion matrix:
       0     1
0  42343    55
1    253  4069
---- Validation: 
scalar performance:
{'acc': 0.9664888, 'precision': 0.79113656, 'recall': 0.5892232, 'specificity': 0.5892232, 'f1': 0.6321544, 'auroc': 0.8533384, 'binary_precision': 0.6119403, 'binary_recall': 0.18276374, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.28146452}
confusion matrix:
       0    1
0  17989   78
1    550  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9555269, 'precision': 0.66159725, 'recall': 0.5372733, 'specificity': 0.5372733, 'f1': 0.5546271, 'auroc': 0.8250601, 'binary_precision': 0.36206895, 'binary_recall': 0.08076923, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.13207547}
confusion matrix:
      0   1
0  5909  37
1   239  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_26.png
early stop counter: 18
val acc:0.966488778591156, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9614889025688171 / 0.9664840698242188
after epoch: 26,now: 2024-06-21 22:55:20.196096,epoch time: 0:09:39.427136,used: 4:35:05.016879,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99297947, 'precision': 0.98170817, 'recall': 0.9762982, 'specificity': 0.9762982, 'f1': 0.978984, 'auroc': 0.9981823, 'binary_precision': 0.9679157, 'binary_recall': 0.95582795, 'binary_specificity': 0.99676853, 'binary_f1_score': 0.96183383}
confusion matrix:
       0     1
0  42259   137
1    191  4133
---- Validation: 
scalar performance:
{'acc': 0.96600854, 'precision': 0.7635549, 'recall': 0.634036, 'specificity': 0.634036, 'f1': 0.6756079, 'auroc': 0.8660069, 'binary_precision': 0.5535714, 'binary_recall': 0.27637443, 'binary_specificity': 0.99169755, 'binary_f1_score': 0.36868185}
confusion matrix:
       0    1
0  17917  150
1    487  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95649374, 'precision': 0.702793, 'recall': 0.5690406, 'specificity': 0.5690406, 'f1': 0.5986381, 'auroc': 0.84909487, 'binary_precision': 0.44186047, 'binary_recall': 0.14615385, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.21965317}
confusion matrix:
      0   1
0  5898  48
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_27.png
early stop counter: 19
val acc:0.9660085439682007, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9614889025688171 / 0.9664840698242188
after epoch: 27,now: 2024-06-21 23:04:55.817415,epoch time: 0:09:35.621319,used: 4:44:40.638198,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9929152, 'precision': 0.98546696, 'recall': 0.97201777, 'specificity': 0.97201777, 'f1': 0.978624, 'auroc': 0.9971933, 'binary_precision': 0.9763892, 'binary_recall': 0.9463708, 'binary_specificity': 0.99766475, 'binary_f1_score': 0.9611457}
confusion matrix:
       0     1
0  42295    99
1    232  4094
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.7751727, 'recall': 0.6149175, 'specificity': 0.6149175, 'f1': 0.6590989, 'auroc': 0.85378027, 'binary_precision': 0.5781818, 'binary_recall': 0.23625557, 'binary_specificity': 0.99357945, 'binary_f1_score': 0.33544305}
confusion matrix:
       0    1
0  17951  116
1    514  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.7189843, 'recall': 0.56770617, 'specificity': 0.56770617, 'f1': 0.5985349, 'auroc': 0.827585, 'binary_precision': 0.47435898, 'binary_recall': 0.1423077, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.21893492}
confusion matrix:
      0   1
0  5905  41
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_28.png
early stop counter: 20
val acc:0.9663820862770081, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9614889025688171 / 0.9664840698242188
after epoch: 28,now: 2024-06-21 23:14:27.491570,epoch time: 0:09:31.674155,used: 4:54:12.312353,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_20_15_seed_1_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 28 with time: 4:54:12.312353 at 2024-06-21 23:14:27.491570
persisted model performance metric: 

scalar performance:
{'acc': 0.9614889, 'precision': 0.793512, 'recall': 0.6010712, 'specificity': 0.6010712, 'f1': 0.6457149, 'auroc': 0.83356345, 'binary_precision': 0.62068963, 'binary_recall': 0.20769231, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.31123918}
confusion matrix:
      0   1
0  5913  33
1   206  54
oracle model performance metric: 

scalar performance:
{'acc': 0.96648407, 'precision': 0.85350007, 'recall': 0.6533306, 'specificity': 0.6533306, 'f1': 0.7102825, 'auroc': 0.8305758, 'binary_precision': 0.73636365, 'binary_recall': 0.31153846, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.43783784}
confusion matrix:
      0   1
0  5917  29
1   179  81
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204385 KiB | 755911 KiB |   1342 TiB |   1342 TiB |
|       from large pool | 167936 KiB | 683776 KiB |   1342 TiB |   1342 TiB |
|       from small pool |  36449 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204385 KiB | 755911 KiB |   1342 TiB |   1342 TiB |
|       from large pool | 167936 KiB | 683776 KiB |   1342 TiB |   1342 TiB |
|       from small pool |  36449 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 748328 KiB |   1342 TiB |   1342 TiB |
|       from large pool | 165120 KiB | 676736 KiB |   1342 TiB |   1342 TiB |
|       from small pool |  35966 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    782 MiB |    930 MiB |   1410 MiB | 643072 KiB |
|       from large pool |    710 MiB |    858 MiB |   1310 MiB | 614400 KiB |
|       from small pool |     72 MiB |     72 MiB |    100 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 104862 KiB | 245592 KiB | 579966 GiB | 579966 GiB |
|       from large pool |  96256 KiB | 244616 KiB | 579629 GiB | 579629 GiB |
|       from small pool |   8606 KiB |  16195 KiB |    337 GiB |    337 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2064    |    3669    |   85758 K  |   85756 K  |
|       from large pool |      36    |      76    |   35215 K  |   35215 K  |
|       from small pool |    2028    |    3632    |   50542 K  |   50540 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2064    |    3669    |   85758 K  |   85756 K  |
|       from large pool |      36    |      76    |   35215 K  |   35215 K  |
|       from small pool |    2028    |    3632    |   50542 K  |   50540 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      51    |      69    |      20    |
|       from large pool |      13    |      15    |      19    |       6    |
|       from small pool |      36    |      36    |      50    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    1476    |   37462 K  |   37462 K  |
|       from large pool |       5    |      11    |   11466 K  |   11466 K  |
|       from small pool |      28    |    1471    |   25996 K  |   25996 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755911 KiB |   1342 TiB |   1342 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1342 TiB |   1342 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755911 KiB |   1342 TiB |   1342 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1342 TiB |   1342 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB |   1342 TiB |   1342 TiB |
|       from large pool |  16640 KiB | 676736 KiB |   1342 TiB |   1342 TiB |
|       from small pool |      0 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    930 MiB |   1410 MiB |   1108 MiB |
|       from large pool | 264192 KiB |    858 MiB |   1310 MiB |   1052 MiB |
|       from small pool |  45056 KiB |     72 MiB |    100 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 245592 KiB | 579967 GiB | 579966 GiB |
|       from large pool |  83712 KiB | 244616 KiB | 579629 GiB | 579629 GiB |
|       from small pool |      0 KiB |  16201 KiB |    337 GiB |    337 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   85758 K  |   85758 K  |
|       from large pool |       2    |      76    |   35215 K  |   35215 K  |
|       from small pool |       0    |    3632    |   50542 K  |   50542 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   85758 K  |   85758 K  |
|       from large pool |       2    |      76    |   35215 K  |   35215 K  |
|       from small pool |       0    |    3632    |   50542 K  |   50542 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      69    |      38    |
|       from large pool |       9    |      15    |      19    |      10    |
|       from small pool |      22    |      36    |      50    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   37463 K  |   37463 K  |
|       from large pool |       1    |      11    |   11466 K  |   11466 K  |
|       from small pool |       0    |    1471    |   25997 K  |   25997 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755911 KiB |   1342 TiB |   1342 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1342 TiB |   1342 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755911 KiB |   1342 TiB |   1342 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1342 TiB |   1342 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB |   1342 TiB |   1342 TiB |
|       from large pool |  16640 KiB | 676736 KiB |   1342 TiB |   1342 TiB |
|       from small pool |      0 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    930 MiB |   1410 MiB |   1108 MiB |
|       from large pool | 264192 KiB |    858 MiB |   1310 MiB |   1052 MiB |
|       from small pool |  45056 KiB |     72 MiB |    100 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 245592 KiB | 579967 GiB | 579966 GiB |
|       from large pool |  83712 KiB | 244616 KiB | 579629 GiB | 579629 GiB |
|       from small pool |      0 KiB |  16201 KiB |    337 GiB |    337 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   85758 K  |   85758 K  |
|       from large pool |       2    |      76    |   35215 K  |   35215 K  |
|       from small pool |       0    |    3632    |   50542 K  |   50542 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   85758 K  |   85758 K  |
|       from large pool |       2    |      76    |   35215 K  |   35215 K  |
|       from small pool |       0    |    3632    |   50542 K  |   50542 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      69    |      38    |
|       from large pool |       9    |      15    |      19    |      10    |
|       from small pool |      22    |      36    |      50    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   37463 K  |   37463 K  |
|       from large pool |       1    |      11    |   11466 K  |   11466 K  |
|       from small pool |       0    |    1471    |   25997 K  |   25997 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821

 Experiment start at: 2024-06-21 23:18:59.564666
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9767546, 'precision': 0.9753256, 'recall': 0.8894561, 'specificity': 0.8894561, 'f1': 0.92706, 'auroc': 0.9822691, 'binary_precision': 0.9736336, 'binary_recall': 0.78118116, 'binary_specificity': 0.99773103, 'binary_f1_score': 0.8668542}
confusion matrix:
       0     1
0  42214    96
1    993  3545
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.74952626, 'recall': 0.57171893, 'specificity': 0.57171893, 'f1': 0.607372, 'auroc': 0.7164614, 'binary_precision': 0.52662724, 'binary_recall': 0.14784053, 'binary_specificity': 0.99559736, 'binary_f1_score': 0.230869}
confusion matrix:
       0   1
0  18091  80
1    513  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.7661581, 'recall': 0.57807726, 'specificity': 0.57807726, 'f1': 0.61582685, 'auroc': 0.720309, 'binary_precision': 0.5652174, 'binary_recall': 0.16115703, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.25080386}
confusion matrix:
      0   1
0  5967  30
1   203  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 23:28:50.001445,epoch time: 0:09:50.436779,used: 0:09:50.436779,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98288083, 'precision': 0.973807, 'recall': 0.9264053, 'specificity': 0.9264053, 'f1': 0.9485306, 'auroc': 0.9885955, 'binary_precision': 0.9628437, 'binary_recall': 0.856356, 'binary_specificity': 0.99645466, 'binary_f1_score': 0.90648323}
confusion matrix:
       0     1
0  42159   150
1    652  3887
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.7336643, 'recall': 0.62031966, 'specificity': 0.62031966, 'f1': 0.65709686, 'auroc': 0.7784478, 'binary_precision': 0.4918033, 'binary_recall': 0.24916944, 'binary_specificity': 0.9914699, 'binary_f1_score': 0.33076075}
confusion matrix:
       0    1
0  18016  155
1    452  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.80111086, 'recall': 0.63112926, 'specificity': 0.63112926, 'f1': 0.6795457, 'auroc': 0.7585156, 'binary_precision': 0.63106793, 'binary_recall': 0.26859504, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.3768116}
confusion matrix:
      0   1
0  5959  38
1   177  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_2.png
new oracle model saved
early stop counter: 1
val acc:0.9676663279533386, best validation acc: 0.9684121012687683, corresponding to test acc:                         0.9626542925834656 / 0.9655393362045288
after epoch: 2,now: 2024-06-21 23:38:38.244922,epoch time: 0:09:48.243477,used: 0:19:38.680256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98644555, 'precision': 0.9708072, 'recall': 0.9505931, 'specificity': 0.9505931, 'f1': 0.9604183, 'auroc': 0.9914071, 'binary_precision': 0.95163155, 'binary_recall': 0.906126, 'binary_specificity': 0.99506027, 'binary_f1_score': 0.9283215}
confusion matrix:
       0     1
0  42101   209
1    426  4112
---- Validation: 
scalar performance:
{'acc': 0.96569544, 'precision': 0.7143198, 'recall': 0.6538327, 'specificity': 0.6538327, 'f1': 0.67856055, 'auroc': 0.8130741, 'binary_precision': 0.4509346, 'binary_recall': 0.320598, 'binary_specificity': 0.9870673, 'binary_f1_score': 0.37475726}
confusion matrix:
       0    1
0  17936  235
1    409  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.79364705, 'recall': 0.68119806, 'specificity': 0.68119806, 'f1': 0.72271824, 'auroc': 0.8200579, 'binary_precision': 0.6122449, 'binary_recall': 0.37190083, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.46272492}
confusion matrix:
      0   1
0  5940  57
1   152  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_3.png
new oracle model saved
early stop counter: 2
val acc:0.9656954407691956, best validation acc: 0.9684121012687683, corresponding to test acc:                         0.9626542925834656 / 0.9665010571479797
after epoch: 3,now: 2024-06-21 23:48:21.312552,epoch time: 0:09:43.067630,used: 0:29:21.747886,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98623204, 'precision': 0.9799577, 'recall': 0.9401597, 'specificity': 0.9401597, 'f1': 0.95897156, 'auroc': 0.9934863, 'binary_precision': 0.9723435, 'binary_recall': 0.8830139, 'binary_specificity': 0.9973055, 'binary_f1_score': 0.9255282}
confusion matrix:
       0     1
0  42195   114
1    531  4008
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.7602353, 'recall': 0.62275124, 'specificity': 0.62275124, 'f1': 0.66466266, 'auroc': 0.80938035, 'binary_precision': 0.54480284, 'binary_recall': 0.25249168, 'binary_specificity': 0.9930108, 'binary_f1_score': 0.34506243}
confusion matrix:
       0    1
0  18044  127
1    450  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663408, 'precision': 0.8127421, 'recall': 0.6374943, 'specificity': 0.6374943, 'f1': 0.687877, 'auroc': 0.80680096, 'binary_precision': 0.65384614, 'binary_recall': 0.28099173, 'binary_specificity': 0.993997, 'binary_f1_score': 0.39306358}
confusion matrix:
      0   1
0  5961  36
1   174  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_4.png
better model found
persisted
after epoch: 4,now: 2024-06-21 23:58:03.207695,epoch time: 0:09:41.895143,used: 0:39:03.643029,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.989007, 'precision': 0.9805994, 'recall': 0.95575845, 'specificity': 0.95575845, 'f1': 0.9677613, 'auroc': 0.9939643, 'binary_precision': 0.97031325, 'binary_recall': 0.9145186, 'binary_specificity': 0.99699825, 'binary_f1_score': 0.9415901}
confusion matrix:
       0     1
0  42182   127
1    388  4151
---- Validation: 
scalar performance:
{'acc': 0.9673467, 'precision': 0.730154, 'recall': 0.63300335, 'specificity': 0.63300335, 'f1': 0.6672873, 'auroc': 0.82692695, 'binary_precision': 0.483965, 'binary_recall': 0.2757475, 'binary_specificity': 0.99025923, 'binary_f1_score': 0.35132274}
confusion matrix:
       0    1
0  17994  177
1    436  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.78937197, 'recall': 0.63682735, 'specificity': 0.63682735, 'f1': 0.6831, 'auroc': 0.81832653, 'binary_precision': 0.60714287, 'binary_recall': 0.28099173, 'binary_specificity': 0.992663, 'binary_f1_score': 0.38418078}
confusion matrix:
      0   1
0  5953  44
1   174  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_5.png
early stop counter: 1
val acc:0.967346727848053, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9663407802581787 / 0.9665010571479797
after epoch: 5,now: 2024-06-22 00:07:54.301496,epoch time: 0:09:51.093801,used: 0:48:54.736830,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.98100364, 'recall': 0.95872396, 'specificity': 0.95872396, 'f1': 0.9695289, 'auroc': 0.99503326, 'binary_precision': 0.97049254, 'binary_recall': 0.92044955, 'binary_specificity': 0.99699837, 'binary_f1_score': 0.9448089}
confusion matrix:
       0     1
0  42183   127
1    361  4177
---- Validation: 
scalar performance:
{'acc': 0.96729344, 'precision': 0.7292175, 'recall': 0.6305667, 'specificity': 0.6305667, 'f1': 0.6650176, 'auroc': 0.8307857, 'binary_precision': 0.4822485, 'binary_recall': 0.2707641, 'binary_specificity': 0.99036926, 'binary_f1_score': 0.3468085}
confusion matrix:
       0    1
0  17996  175
1    439  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.7706387, 'recall': 0.6302122, 'specificity': 0.6302122, 'f1': 0.67326236, 'auroc': 0.82456243, 'binary_precision': 0.5701754, 'binary_recall': 0.26859504, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.3651685}
confusion matrix:
      0   1
0  5948  49
1   177  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_6.png
early stop counter: 2
val acc:0.9672934412956238, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9663407802581787 / 0.9665010571479797
after epoch: 6,now: 2024-06-22 00:17:36.159044,epoch time: 0:09:41.857548,used: 0:58:36.594378,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9897541, 'precision': 0.97910154, 'recall': 0.96167904, 'specificity': 0.96167904, 'f1': 0.9701854, 'auroc': 0.9953798, 'binary_precision': 0.96601605, 'binary_recall': 0.92685616, 'binary_specificity': 0.9965019, 'binary_f1_score': 0.94603103}
confusion matrix:
       0     1
0  42161   148
1    332  4207
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.74044824, 'recall': 0.6325855, 'specificity': 0.6325855, 'f1': 0.66943115, 'auroc': 0.8315972, 'binary_precision': 0.5045872, 'binary_recall': 0.2740864, 'binary_specificity': 0.9910847, 'binary_f1_score': 0.3552207}
confusion matrix:
       0    1
0  18009  162
1    437  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.74773955, 'recall': 0.5975712, 'specificity': 0.5975712, 'f1': 0.6365099, 'auroc': 0.8037588, 'binary_precision': 0.5268817, 'binary_recall': 0.20247933, 'binary_specificity': 0.992663, 'binary_f1_score': 0.29253727}
confusion matrix:
      0   1
0  5953  44
1   193  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_7.png
early stop counter: 3
val acc:0.9680925011634827, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9663407802581787 / 0.9665010571479797
after epoch: 7,now: 2024-06-22 00:27:19.006087,epoch time: 0:09:42.847043,used: 1:08:19.441421,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9911202, 'precision': 0.98631144, 'recall': 0.96243536, 'specificity': 0.96243536, 'f1': 0.97399306, 'auroc': 0.99661624, 'binary_precision': 0.98042417, 'binary_recall': 0.92685616, 'binary_specificity': 0.9980146, 'binary_f1_score': 0.9528879}
confusion matrix:
       0     1
0  42225    84
1    332  4207
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.7457226, 'recall': 0.5949798, 'specificity': 0.5949798, 'f1': 0.6340796, 'auroc': 0.82805616, 'binary_precision': 0.51754385, 'binary_recall': 0.19601329, 'binary_specificity': 0.9939464, 'binary_f1_score': 0.28433737}
confusion matrix:
       0    1
0  18061  110
1    484  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.7405809, 'recall': 0.5695627, 'specificity': 0.5695627, 'f1': 0.6030413, 'auroc': 0.8102989, 'binary_precision': 0.5147059, 'binary_recall': 0.1446281, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.22580644}
confusion matrix:
      0   1
0  5964  33
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_8.png
early stop counter: 4
val acc:0.9683588147163391, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9663407802581787 / 0.9665010571479797
after epoch: 8,now: 2024-06-22 00:36:56.919107,epoch time: 0:09:37.913020,used: 1:17:57.354441,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9913123, 'precision': 0.9828979, 'recall': 0.966967, 'specificity': 0.966967, 'f1': 0.9747629, 'auroc': 0.9963492, 'binary_precision': 0.9725526, 'binary_recall': 0.9367702, 'binary_specificity': 0.9971637, 'binary_f1_score': 0.95432615}
confusion matrix:
       0     1
0  42189   120
1    287  4252
---- Validation: 
scalar performance:
{'acc': 0.9695307, 'precision': 0.76538503, 'recall': 0.6220858, 'specificity': 0.6220858, 'f1': 0.66497004, 'auroc': 0.8369626, 'binary_precision': 0.55514705, 'binary_recall': 0.25083056, 'binary_specificity': 0.993341, 'binary_f1_score': 0.34553778}
confusion matrix:
       0    1
0  18050  121
1    451  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.749589, 'recall': 0.583692, 'specificity': 0.583692, 'f1': 0.62109363, 'auroc': 0.8032768, 'binary_precision': 0.5316456, 'binary_recall': 0.17355372, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.26168224}
confusion matrix:
      0   1
0  5960  37
1   200  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_9.png
better model found
persisted
after epoch: 9,now: 2024-06-22 00:46:33.899512,epoch time: 0:09:36.980405,used: 1:27:34.334846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9908, 'precision': 0.9830283, 'recall': 0.96383154, 'specificity': 0.96383154, 'f1': 0.97318304, 'auroc': 0.9956646, 'binary_precision': 0.97349006, 'binary_recall': 0.9303811, 'binary_specificity': 0.9972819, 'binary_f1_score': 0.95144755}
confusion matrix:
       0     1
0  42194   115
1    316  4223
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.73442626, 'recall': 0.61954415, 'specificity': 0.61954415, 'f1': 0.6565538, 'auroc': 0.8402965, 'binary_precision': 0.49337748, 'binary_recall': 0.2475083, 'binary_specificity': 0.99158, 'binary_f1_score': 0.32964602}
confusion matrix:
       0    1
0  18018  153
1    453  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597692, 'precision': 0.70695484, 'recall': 0.5745938, 'specificity': 0.5745938, 'f1': 0.6058796, 'auroc': 0.81073874, 'binary_precision': 0.44705883, 'binary_recall': 0.1570248, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.23241591}
confusion matrix:
      0   1
0  5950  47
1   204  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_10.png
early stop counter: 1
val acc:0.9677196145057678, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 10,now: 2024-06-22 00:56:10.850061,epoch time: 0:09:36.950549,used: 1:37:11.285395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9916325, 'precision': 0.9820657, 'recall': 0.96969473, 'specificity': 0.96969473, 'f1': 0.97577804, 'auroc': 0.9966129, 'binary_precision': 0.9702813, 'binary_recall': 0.9424857, 'binary_specificity': 0.9969038, 'binary_f1_score': 0.9561815}
confusion matrix:
       0     1
0  42179   131
1    261  4277
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.73852277, 'recall': 0.6172726, 'specificity': 0.6172726, 'f1': 0.6552954, 'auroc': 0.84727204, 'binary_precision': 0.5017182, 'binary_recall': 0.24252492, 'binary_specificity': 0.99202025, 'binary_f1_score': 0.32698768}
confusion matrix:
       0    1
0  18026  145
1    456  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95928836, 'precision': 0.6945769, 'recall': 0.56442994, 'specificity': 0.56442994, 'f1': 0.59267926, 'auroc': 0.81921756, 'binary_precision': 0.42307693, 'binary_recall': 0.13636364, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.20625001}
confusion matrix:
      0   1
0  5952  45
1   209  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_11.png
early stop counter: 2
val acc:0.9679859280586243, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 11,now: 2024-06-22 01:05:47.974626,epoch time: 0:09:37.124565,used: 1:46:48.409960,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99188864, 'precision': 0.9860157, 'recall': 0.9671738, 'specificity': 0.9671738, 'f1': 0.9763587, 'auroc': 0.99647915, 'binary_precision': 0.97880673, 'binary_recall': 0.93652195, 'binary_specificity': 0.9978256, 'binary_f1_score': 0.9571976}
confusion matrix:
       0     1
0  42219    92
1    288  4249
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.74748725, 'recall': 0.60145926, 'specificity': 0.60145926, 'f1': 0.64122415, 'auroc': 0.8453164, 'binary_precision': 0.5206612, 'binary_recall': 0.20930232, 'binary_specificity': 0.9936162, 'binary_f1_score': 0.2985782}
confusion matrix:
       0    1
0  18055  116
1    476  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.71877474, 'recall': 0.565097, 'specificity': 0.565097, 'f1': 0.5956591, 'auroc': 0.8119663, 'binary_precision': 0.47142857, 'binary_recall': 0.13636364, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.21153848}
confusion matrix:
      0   1
0  5960  37
1   209  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_12.png
early stop counter: 3
val acc:0.9684653282165527, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 12,now: 2024-06-22 01:15:27.999430,epoch time: 0:09:40.024804,used: 1:56:28.434764,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9918246, 'precision': 0.9891905, 'recall': 0.9637104, 'specificity': 0.9637104, 'f1': 0.9760196, 'auroc': 0.9959881, 'binary_precision': 0.9859682, 'binary_recall': 0.92883897, 'binary_specificity': 0.9985819, 'binary_f1_score': 0.9565513}
confusion matrix:
       0     1
0  42249    60
1    323  4216
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.7489262, 'recall': 0.5862013, 'specificity': 0.5862013, 'f1': 0.6246977, 'auroc': 0.8469745, 'binary_precision': 0.5245098, 'binary_recall': 0.17774086, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.26550868}
confusion matrix:
       0    1
0  18074   97
1    495  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.75636864, 'recall': 0.55791634, 'specificity': 0.55791634, 'f1': 0.5885784, 'auroc': 0.8048206, 'binary_precision': 0.5471698, 'binary_recall': 0.11983471, 'binary_specificity': 0.995998, 'binary_f1_score': 0.19661017}
confusion matrix:
      0   1
0  5973  24
1   213  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_13.png
early stop counter: 4
val acc:0.9684653282165527, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 13,now: 2024-06-22 01:25:01.142458,epoch time: 0:09:33.143028,used: 2:06:01.577792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9919314, 'precision': 0.98516285, 'recall': 0.9682864, 'specificity': 0.9682864, 'f1': 0.9765352, 'auroc': 0.9968157, 'binary_precision': 0.9768455, 'binary_recall': 0.9389599, 'binary_specificity': 0.99761283, 'binary_f1_score': 0.9575281}
confusion matrix:
       0     1
0  42209   101
1    277  4261
---- Validation: 
scalar performance:
{'acc': 0.96729344, 'precision': 0.7288991, 'recall': 0.6273545, 'specificity': 0.6273545, 'f1': 0.66221607, 'auroc': 0.8544866, 'binary_precision': 0.48181817, 'binary_recall': 0.2641196, 'binary_specificity': 0.9905894, 'binary_f1_score': 0.3412017}
confusion matrix:
       0    1
0  18000  171
1    443  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589678, 'precision': 0.6971816, 'recall': 0.5801251, 'specificity': 0.5801251, 'f1': 0.6107581, 'auroc': 0.82311165, 'binary_precision': 0.42708334, 'binary_recall': 0.1694215, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.24260357}
confusion matrix:
      0   1
0  5942  55
1   201  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_14.png
early stop counter: 5
val acc:0.9672934412956238, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 14,now: 2024-06-22 01:34:36.536241,epoch time: 0:09:35.393783,used: 2:15:36.971575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9918033, 'precision': 0.9864589, 'recall': 0.9662554, 'specificity': 0.9662554, 'f1': 0.9760857, 'auroc': 0.99688756, 'binary_precision': 0.979903, 'binary_recall': 0.9345671, 'binary_specificity': 0.9979437, 'binary_f1_score': 0.95669824}
confusion matrix:
       0     1
0  42222    87
1    297  4242
---- Validation: 
scalar performance:
{'acc': 0.96761304, 'precision': 0.7300992, 'recall': 0.58817023, 'specificity': 0.58817023, 'f1': 0.62457097, 'auroc': 0.8505268, 'binary_precision': 0.48672566, 'binary_recall': 0.18272425, 'binary_specificity': 0.9936162, 'binary_f1_score': 0.2657005}
confusion matrix:
       0    1
0  18055  116
1    492  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.71360046, 'recall': 0.55906534, 'specificity': 0.55906534, 'f1': 0.5875728, 'auroc': 0.8012517, 'binary_precision': 0.46153846, 'binary_recall': 0.12396694, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.19543973}
confusion matrix:
      0   1
0  5962  35
1   212  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_15.png
early stop counter: 6
val acc:0.9676130414009094, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 15,now: 2024-06-22 01:44:11.185415,epoch time: 0:09:34.649174,used: 2:25:11.620749,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9918246, 'precision': 0.9834426, 'recall': 0.9694077, 'specificity': 0.9694077, 'f1': 0.9762939, 'auroc': 0.99719983, 'binary_precision': 0.9731268, 'binary_recall': 0.94160426, 'binary_specificity': 0.99721104, 'binary_f1_score': 0.95710605}
confusion matrix:
       0     1
0  42192   118
1    265  4273
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.7462957, 'recall': 0.6231416, 'specificity': 0.6231416, 'f1': 0.6623018, 'auroc': 0.85422826, 'binary_precision': 0.5168919, 'binary_recall': 0.25415283, 'binary_specificity': 0.99213034, 'binary_f1_score': 0.34075725}
confusion matrix:
       0    1
0  18028  143
1    449  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96008974, 'precision': 0.7097945, 'recall': 0.56682956, 'specificity': 0.56682956, 'f1': 0.5970179, 'auroc': 0.8162339, 'binary_precision': 0.45333335, 'binary_recall': 0.14049587, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.21451104}
confusion matrix:
      0   1
0  5956  41
1   208  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_16.png
early stop counter: 7
val acc:0.9684653282165527, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 16,now: 2024-06-22 01:53:48.562952,epoch time: 0:09:37.377537,used: 2:34:48.998286,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99272114, 'precision': 0.9865708, 'recall': 0.9714838, 'specificity': 0.9714838, 'f1': 0.9788766, 'auroc': 0.9974104, 'binary_precision': 0.97900504, 'binary_recall': 0.9451421, 'binary_specificity': 0.9978255, 'binary_f1_score': 0.9617756}
confusion matrix:
       0     1
0  42217    92
1    249  4290
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.74943846, 'recall': 0.61599666, 'specificity': 0.61599666, 'f1': 0.6561648, 'auroc': 0.8515771, 'binary_precision': 0.52363634, 'binary_recall': 0.23920266, 'binary_specificity': 0.9927907, 'binary_f1_score': 0.32839227}
confusion matrix:
       0    1
0  18040  131
1    458  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597692, 'precision': 0.6968796, 'recall': 0.5527836, 'specificity': 0.5527836, 'f1': 0.5782149, 'auroc': 0.8059274, 'binary_precision': 0.42857143, 'binary_recall': 0.11157025, 'binary_specificity': 0.993997, 'binary_f1_score': 0.17704917}
confusion matrix:
      0   1
0  5961  36
1   215  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_17.png
early stop counter: 8
val acc:0.9686251282691956, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 17,now: 2024-06-22 02:03:22.611970,epoch time: 0:09:34.049018,used: 2:44:23.047304,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9922515, 'precision': 0.9872477, 'recall': 0.968077, 'specificity': 0.968077, 'f1': 0.97741866, 'auroc': 0.9971991, 'binary_precision': 0.981106, 'binary_recall': 0.9380921, 'binary_specificity': 0.9980619, 'binary_f1_score': 0.95911705}
confusion matrix:
       0     1
0  42227    82
1    281  4258
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.7354642, 'recall': 0.5850956, 'specificity': 0.5850956, 'f1': 0.621853, 'auroc': 0.84506387, 'binary_precision': 0.4976526, 'binary_recall': 0.17607974, 'binary_specificity': 0.9941115, 'binary_f1_score': 0.26012272}
confusion matrix:
       0    1
0  18064  107
1    496  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.71060014, 'recall': 0.55113435, 'specificity': 0.55113435, 'f1': 0.5768161, 'auroc': 0.79166067, 'binary_precision': 0.45614034, 'binary_recall': 0.10743801, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.17391303}
confusion matrix:
      0   1
0  5966  31
1   216  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_18.png
early stop counter: 9
val acc:0.9678794145584106, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 18,now: 2024-06-22 02:12:57.458852,epoch time: 0:09:34.846882,used: 2:53:57.894186,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99366033, 'precision': 0.9877699, 'recall': 0.97573555, 'specificity': 0.97573555, 'f1': 0.9816574, 'auroc': 0.9974778, 'binary_precision': 0.98051214, 'binary_recall': 0.9535037, 'binary_specificity': 0.99796736, 'binary_f1_score': 0.96681935}
confusion matrix:
       0     1
0  42224    86
1    211  4327
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.7513225, 'recall': 0.5967235, 'specificity': 0.5967235, 'f1': 0.6367319, 'auroc': 0.84901285, 'binary_precision': 0.52863437, 'binary_recall': 0.19933555, 'binary_specificity': 0.9941115, 'binary_f1_score': 0.28950542}
confusion matrix:
       0    1
0  18064  107
1    482  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9588075, 'precision': 0.67282724, 'recall': 0.54633516, 'specificity': 0.54633516, 'f1': 0.5681324, 'auroc': 0.79774874, 'binary_precision': 0.3809524, 'binary_recall': 0.09917355, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.15737705}
confusion matrix:
      0   1
0  5958  39
1   218  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_19.png
early stop counter: 10
val acc:0.9686251282691956, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 19,now: 2024-06-22 02:22:33.540870,epoch time: 0:09:36.082018,used: 3:03:33.976204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9923369, 'precision': 0.98730314, 'recall': 0.96851766, 'specificity': 0.96851766, 'f1': 0.97767645, 'auroc': 0.9972488, 'binary_precision': 0.9811234, 'binary_recall': 0.93897337, 'binary_specificity': 0.9980619, 'binary_f1_score': 0.9595857}
confusion matrix:
       0     1
0  42227    82
1    277  4262
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.7549679, 'recall': 0.5822962, 'specificity': 0.5822962, 'f1': 0.62078875, 'auroc': 0.8520625, 'binary_precision': 0.5368421, 'binary_recall': 0.16943522, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.25757575}
confusion matrix:
       0    1
0  18083   88
1    500  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95992947, 'precision': 0.684227, 'recall': 0.53303957, 'specificity': 0.53303957, 'f1': 0.5496082, 'auroc': 0.8018744, 'binary_precision': 0.4047619, 'binary_recall': 0.07024793, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.119718306}
confusion matrix:
      0   1
0  5972  25
1   225  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_20.png
early stop counter: 11
val acc:0.9686784148216248, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 20,now: 2024-06-22 02:32:10.494259,epoch time: 0:09:36.953389,used: 3:13:10.929593,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99284923, 'precision': 0.9898285, 'recall': 0.96899796, 'specificity': 0.96899796, 'f1': 0.9791267, 'auroc': 0.9974451, 'binary_precision': 0.986124, 'binary_recall': 0.93941396, 'binary_specificity': 0.9985819, 'binary_f1_score': 0.96220237}
confusion matrix:
       0     1
0  42249    60
1    275  4264
---- Validation: 
scalar performance:
{'acc': 0.96761304, 'precision': 0.72948235, 'recall': 0.5825489, 'specificity': 0.5825489, 'f1': 0.6182595, 'auroc': 0.84929276, 'binary_precision': 0.48584905, 'binary_recall': 0.17109634, 'binary_specificity': 0.99400145, 'binary_f1_score': 0.25307122}
confusion matrix:
       0    1
0  18062  109
1    499  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.70879465, 'recall': 0.5471689, 'specificity': 0.5471689, 'f1': 0.57121885, 'auroc': 0.80842483, 'binary_precision': 0.4528302, 'binary_recall': 0.09917355, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.16271187}
confusion matrix:
      0   1
0  5968  29
1   218  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_21.png
early stop counter: 12
val acc:0.9676130414009094, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 21,now: 2024-06-22 02:41:47.914065,epoch time: 0:09:37.419806,used: 3:22:48.349399,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99272114, 'precision': 0.98924524, 'recall': 0.9688287, 'specificity': 0.9688287, 'f1': 0.97876143, 'auroc': 0.99714434, 'binary_precision': 0.98498154, 'binary_recall': 0.93919367, 'binary_specificity': 0.9984637, 'binary_f1_score': 0.9615428}
confusion matrix:
       0     1
0  42244    65
1    276  4263
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.75768876, 'recall': 0.5888031, 'specificity': 0.5888031, 'f1': 0.6286849, 'auroc': 0.8521409, 'binary_precision': 0.5418719, 'binary_recall': 0.18272425, 'binary_specificity': 0.9948819, 'binary_f1_score': 0.27329195}
confusion matrix:
       0    1
0  18078   93
1    492  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96008974, 'precision': 0.7005557, 'recall': 0.54700214, 'specificity': 0.54700214, 'f1': 0.5705872, 'auroc': 0.8083674, 'binary_precision': 0.43636364, 'binary_recall': 0.09917355, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.16161616}
confusion matrix:
      0   1
0  5966  31
1   218  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_22.png
early stop counter: 13
val acc:0.9688382148742676, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 22,now: 2024-06-22 02:51:26.050999,epoch time: 0:09:38.136934,used: 3:32:26.486333,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99287057, 'precision': 0.9848349, 'recall': 0.97412336, 'specificity': 0.97412336, 'f1': 0.97940314, 'auroc': 0.99703026, 'binary_precision': 0.9749266, 'binary_recall': 0.9508702, 'binary_specificity': 0.99737644, 'binary_f1_score': 0.96274817}
confusion matrix:
       0     1
0  42198   111
1    223  4316
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.7401829, 'recall': 0.606888, 'specificity': 0.606888, 'f1': 0.6455922, 'auroc': 0.8576169, 'binary_precision': 0.50570345, 'binary_recall': 0.22093023, 'binary_specificity': 0.9928457, 'binary_f1_score': 0.30751446}
confusion matrix:
       0    1
0  18041  130
1    469  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9591281, 'precision': 0.6808447, 'recall': 0.5484846, 'specificity': 0.5484846, 'f1': 0.5714932, 'auroc': 0.80321825, 'binary_precision': 0.3968254, 'binary_recall': 0.10330579, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.16393442}
confusion matrix:
      0   1
0  5959  38
1   217  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_23.png
early stop counter: 14
val acc:0.9680925011634827, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 23,now: 2024-06-22 03:01:02.340349,epoch time: 0:09:36.289350,used: 3:42:02.775683,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99361765, 'precision': 0.98754776, 'recall': 0.97571194, 'specificity': 0.97571194, 'f1': 0.9815376, 'auroc': 0.997802, 'binary_precision': 0.98006797, 'binary_recall': 0.9535037, 'binary_specificity': 0.9979201, 'binary_f1_score': 0.9666034}
confusion matrix:
       0     1
0  42222    88
1    211  4327
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.74558944, 'recall': 0.6182958, 'specificity': 0.6182958, 'f1': 0.6576391, 'auroc': 0.8574462, 'binary_precision': 0.51578945, 'binary_recall': 0.24418604, 'binary_specificity': 0.9924055, 'binary_f1_score': 0.3314543}
confusion matrix:
       0    1
0  18033  138
1    455  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9591281, 'precision': 0.67518884, 'recall': 0.54253644, 'specificity': 0.54253644, 'f1': 0.56310976, 'auroc': 0.8053726, 'binary_precision': 0.3859649, 'binary_recall': 0.09090909, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.14715719}
confusion matrix:
      0   1
0  5962  35
1   220  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_24.png
early stop counter: 15
val acc:0.9684121012687683, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 24,now: 2024-06-22 03:10:38.885526,epoch time: 0:09:36.545177,used: 3:51:39.320860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99297726, 'precision': 0.9899067, 'recall': 0.9696523, 'specificity': 0.9696523, 'f1': 0.9795089, 'auroc': 0.9973686, 'binary_precision': 0.98614, 'binary_recall': 0.94072276, 'binary_specificity': 0.9985819, 'binary_f1_score': 0.96289617}
confusion matrix:
       0     1
0  42250    60
1    269  4269
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.7612637, 'recall': 0.5856459, 'specificity': 0.5856459, 'f1': 0.6254015, 'auroc': 0.8596021, 'binary_precision': 0.5492228, 'binary_recall': 0.17607974, 'binary_specificity': 0.99521214, 'binary_f1_score': 0.26666665}
confusion matrix:
       0    1
0  18084   87
1    496  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95928836, 'precision': 0.6719842, 'recall': 0.5366716, 'specificity': 0.5366716, 'f1': 0.5546467, 'auroc': 0.80779755, 'binary_precision': 0.38, 'binary_recall': 0.0785124, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.130137}
confusion matrix:
      0   1
0  5966  31
1   223  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_25.png
early stop counter: 16
val acc:0.968944787979126, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 25,now: 2024-06-22 03:20:12.981270,epoch time: 0:09:34.095744,used: 4:01:13.416604,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9929346, 'precision': 0.9852615, 'recall': 0.9740604, 'specificity': 0.9740604, 'f1': 0.9795779, 'auroc': 0.9974647, 'binary_precision': 0.9758028, 'binary_recall': 0.9506499, 'binary_specificity': 0.997471, 'binary_f1_score': 0.96306217}
confusion matrix:
       0     1
0  42202   107
1    224  4315
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.7512109, 'recall': 0.6176578, 'specificity': 0.6176578, 'f1': 0.65809333, 'auroc': 0.8670313, 'binary_precision': 0.5270758, 'binary_recall': 0.24252492, 'binary_specificity': 0.9927907, 'binary_f1_score': 0.3321957}
confusion matrix:
       0    1
0  18040  131
1    456  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95832664, 'precision': 0.6485583, 'recall': 0.53418857, 'specificity': 0.53418857, 'f1': 0.5501393, 'auroc': 0.8031583, 'binary_precision': 0.33333334, 'binary_recall': 0.07438017, 'binary_specificity': 0.993997, 'binary_f1_score': 0.12162163}
confusion matrix:
      0   1
0  5961  36
1   224  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_26.png
early stop counter: 17
val acc:0.968731701374054, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 26,now: 2024-06-22 03:29:52.641805,epoch time: 0:09:39.660535,used: 4:10:53.077139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9928279, 'precision': 0.9874249, 'recall': 0.9712479, 'specificity': 0.9712479, 'f1': 0.9791633, 'auroc': 0.99659956, 'binary_precision': 0.98078245, 'binary_recall': 0.94448113, 'binary_specificity': 0.9980146, 'binary_f1_score': 0.9622895}
confusion matrix:
       0     1
0  42225    84
1    252  4287
---- Validation: 
scalar performance:
{'acc': 0.9691046, 'precision': 0.761078, 'recall': 0.6017895, 'specificity': 0.6017895, 'f1': 0.6435434, 'auroc': 0.8510384, 'binary_precision': 0.5478261, 'binary_recall': 0.20930232, 'binary_specificity': 0.9942766, 'binary_f1_score': 0.3028846}
confusion matrix:
       0    1
0  18067  104
1    476  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95928836, 'precision': 0.67657864, 'recall': 0.5406371, 'specificity': 0.5406371, 'f1': 0.5605207, 'auroc': 0.787783, 'binary_precision': 0.3888889, 'binary_recall': 0.08677686, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.14189188}
confusion matrix:
      0   1
0  5964  33
1   221  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_27.png
early stop counter: 18
val acc:0.9691045880317688, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 27,now: 2024-06-22 03:39:31.257654,epoch time: 0:09:38.615849,used: 4:20:31.692988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99370307, 'precision': 0.98721886, 'recall': 0.976551, 'specificity': 0.976551, 'f1': 0.98181, 'auroc': 0.9983412, 'binary_precision': 0.97922313, 'binary_recall': 0.9552765, 'binary_specificity': 0.9978255, 'binary_f1_score': 0.96710163}
confusion matrix:
       0     1
0  42217    92
1    203  4336
---- Validation: 
scalar performance:
{'acc': 0.9670271, 'precision': 0.7228154, 'recall': 0.6095498, 'specificity': 0.6095498, 'f1': 0.6449714, 'auroc': 0.86176574, 'binary_precision': 0.4707904, 'binary_recall': 0.22757475, 'binary_specificity': 0.99152493, 'binary_f1_score': 0.3068309}
confusion matrix:
       0    1
0  18017  154
1    465  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9567238, 'precision': 0.65322155, 'recall': 0.55714774, 'specificity': 0.55714774, 'f1': 0.57979614, 'auroc': 0.80339825, 'binary_precision': 0.3409091, 'binary_recall': 0.12396694, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.18181817}
confusion matrix:
      0   1
0  5939  58
1   212  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_28.png
early stop counter: 19
val acc:0.9670271277427673, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 28,now: 2024-06-22 03:49:08.239005,epoch time: 0:09:36.981351,used: 4:30:08.674339,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99329746, 'precision': 0.98822093, 'recall': 0.9731796, 'specificity': 0.9731796, 'f1': 0.980551, 'auroc': 0.9976047, 'binary_precision': 0.9819758, 'binary_recall': 0.94822645, 'binary_specificity': 0.99813277, 'binary_f1_score': 0.9648061}
confusion matrix:
       0     1
0  42230    79
1    235  4304
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.75356185, 'recall': 0.58226866, 'specificity': 0.58226866, 'f1': 0.6206125, 'auroc': 0.8614657, 'binary_precision': 0.5340314, 'binary_recall': 0.16943522, 'binary_specificity': 0.9951021, 'binary_f1_score': 0.25725096}
confusion matrix:
       0    1
0  18082   89
1    500  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9591281, 'precision': 0.6436198, 'recall': 0.522709, 'specificity': 0.522709, 'f1': 0.5325591, 'auroc': 0.8026367, 'binary_precision': 0.3243243, 'binary_recall': 0.049586777, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.086021505}
confusion matrix:
      0   1
0  5972  25
1   230  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520821_29.png
early stop counter: 20
val acc:0.9686251282691956, best validation acc: 0.9695307016372681, corresponding to test acc:                         0.9620131254196167 / 0.9665010571479797
after epoch: 29,now: 2024-06-22 03:58:42.550113,epoch time: 0:09:34.311108,used: 4:39:42.985447,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_23_18_59_seed_2_21520821
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 29 with time: 4:39:42.985447 at 2024-06-22 03:58:42.550113
persisted model performance metric: 

scalar performance:
{'acc': 0.9620131, 'precision': 0.749589, 'recall': 0.583692, 'specificity': 0.583692, 'f1': 0.62109363, 'auroc': 0.8032768, 'binary_precision': 0.5316456, 'binary_recall': 0.17355372, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.26168224}
confusion matrix:
      0   1
0  5960  37
1   200  42
oracle model performance metric: 

scalar performance:
{'acc': 0.96650106, 'precision': 0.79364705, 'recall': 0.68119806, 'specificity': 0.68119806, 'f1': 0.72271824, 'auroc': 0.8200579, 'binary_precision': 0.6122449, 'binary_recall': 0.37190083, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.46272492}
confusion matrix:
      0   1
0  5940  57
1   152  90
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204388 KiB | 755914 KiB |   2015 TiB |   2015 TiB |
|       from large pool | 167936 KiB | 683776 KiB |   2015 TiB |   2015 TiB |
|       from small pool |  36452 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204388 KiB | 755914 KiB |   2015 TiB |   2015 TiB |
|       from large pool | 167936 KiB | 683776 KiB |   2015 TiB |   2015 TiB |
|       from small pool |  36452 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB | 748328 KiB |   2015 TiB |   2015 TiB |
|       from large pool | 165120 KiB | 676736 KiB |   2014 TiB |   2014 TiB |
|       from small pool |  35967 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    782 MiB |    930 MiB |   1890 MiB |   1108 MiB |
|       from large pool |    710 MiB |    858 MiB |   1762 MiB |   1052 MiB |
|       from small pool |     72 MiB |     72 MiB |    128 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 102811 KiB | 245592 KiB |    865 TiB |    865 TiB |
|       from large pool |  96256 KiB | 244616 KiB |    864 TiB |    864 TiB |
|       from small pool |   6555 KiB |  16201 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2070    |    3677    |  128721 K  |  128719 K  |
|       from large pool |      36    |      76    |   52858 K  |   52858 K  |
|       from small pool |    2034    |    3640    |   75862 K  |   75860 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2070    |    3677    |  128721 K  |  128719 K  |
|       from large pool |      36    |      76    |   52858 K  |   52858 K  |
|       from small pool |    2034    |    3640    |   75862 K  |   75860 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      51    |      87    |      38    |
|       from large pool |      13    |      15    |      23    |      10    |
|       from small pool |      36    |      36    |      64    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    1476    |   56161 K  |   56161 K  |
|       from large pool |       5    |      11    |   17388 K  |   17388 K  |
|       from small pool |      28    |    1471    |   38772 K  |   38772 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755914 KiB |   2015 TiB |   2015 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   2015 TiB |   2015 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755914 KiB |   2015 TiB |   2015 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   2015 TiB |   2015 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB |   2015 TiB |   2015 TiB |
|       from large pool |  16640 KiB | 676736 KiB |   2014 TiB |   2014 TiB |
|       from small pool |      0 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 307200 KiB |    930 MiB |   1890 MiB |   1590 MiB |
|       from large pool | 264192 KiB |    858 MiB |   1762 MiB |   1504 MiB |
|       from small pool |  43008 KiB |     72 MiB |    128 MiB |     86 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 245592 KiB |    865 TiB |    865 TiB |
|       from large pool |  83712 KiB | 244616 KiB |    864 TiB |    864 TiB |
|       from small pool |      0 KiB |  16201 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3677    |  128721 K  |  128721 K  |
|       from large pool |       2    |      76    |   52858 K  |   52858 K  |
|       from small pool |       0    |    3640    |   75862 K  |   75862 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3677    |  128721 K  |  128721 K  |
|       from large pool |       2    |      76    |   52858 K  |   52858 K  |
|       from small pool |       0    |    3640    |   75862 K  |   75862 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      87    |      57    |
|       from large pool |       9    |      15    |      23    |      14    |
|       from small pool |      21    |      36    |      64    |      43    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   56161 K  |   56161 K  |
|       from large pool |       1    |      11    |   17388 K  |   17388 K  |
|       from small pool |       0    |    1471    |   38773 K  |   38773 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jun 22 03:59:26 2024]
Finished job 0.
1 of 1 steps (100%) done
