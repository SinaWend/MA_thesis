Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun  8 12:13:29 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_21_08_seed_0_21256733

 Experiment start at: 2024-06-08 12:21:08.176414
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97047406, 'precision': 0.7977419, 'recall': 0.6548972, 'specificity': 0.6548972, 'f1': 0.7018643, 'auroc': 0.9493158, 'binary_precision': 0.6188579, 'binary_recall': 0.3165761, 'binary_specificity': 0.99321836, 'binary_f1_score': 0.41887644}
confusion matrix:
       0    1
0  42033  287
1   1006  466
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.77540195, 'recall': 0.60680467, 'specificity': 0.60680467, 'f1': 0.6507196, 'auroc': 0.9483416, 'binary_precision': 0.5778689, 'binary_recall': 0.21928461, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.3179256}
confusion matrix:
       0    1
0  18046  103
1    502  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.91986716, 'recall': 0.5799595, 'specificity': 0.5799595, 'f1': 0.6267063, 'auroc': 0.9346442, 'binary_precision': 0.875, 'binary_recall': 0.16091955, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.27184466}
confusion matrix:
      0   1
0  5991   6
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256733_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-08 12:49:34.255026,epoch time: 0:28:26.078612,used: 0:28:26.078612,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_21_08_seed_0_21256733
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97131896, 'precision': 0.8815961, 'recall': 0.5989426, 'specificity': 0.5989426, 'f1': 0.65211153, 'auroc': 0.95837253, 'binary_precision': 0.7903226, 'binary_recall': 0.19972827, 'binary_specificity': 0.9981569, 'binary_f1_score': 0.31887203}
confusion matrix:
       0    1
0  42242   78
1   1178  294
---- Validation: 
scalar performance:
{'acc': 0.969189, 'precision': 0.8755206, 'recall': 0.5685181, 'specificity': 0.5685181, 'f1': 0.60970825, 'auroc': 0.95195514, 'binary_precision': 0.78070176, 'binary_recall': 0.13841368, 'binary_specificity': 0.99862254, 'binary_f1_score': 0.23513871}
confusion matrix:
       0   1
0  18124  25
1    554  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.9832393, 'recall': 0.6015326, 'specificity': 0.6015326, 'f1': 0.66026664, 'auroc': 0.9337063, 'binary_precision': 1.0, 'binary_recall': 0.20306513, 'binary_specificity': 1.0, 'binary_f1_score': 0.3375796}
confusion matrix:
      0   1
0  5997   0
1   208  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256733_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-08 13:16:47.066163,epoch time: 0:27:12.811137,used: 0:55:38.889749,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_21_08_seed_0_21256733
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.976023, 'precision': 0.8270489, 'recall': 0.7787482, 'specificity': 0.7787482, 'f1': 0.8007989, 'auroc': 0.966555, 'binary_precision': 0.66907054, 'binary_recall': 0.56725544, 'binary_specificity': 0.990241, 'binary_f1_score': 0.61397064}
confusion matrix:
       0    1
0  41907  413
1    637  835
---- Validation: 
scalar performance:
{'acc': 0.9738719, 'precision': 0.8085174, 'recall': 0.7764576, 'specificity': 0.7764576, 'f1': 0.7915238, 'auroc': 0.9597812, 'binary_precision': 0.6324042, 'binary_recall': 0.5645412, 'binary_specificity': 0.988374, 'binary_f1_score': 0.5965489}
confusion matrix:
       0    1
0  17938  211
1    280  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97698945, 'precision': 0.9466572, 'recall': 0.74612594, 'specificity': 0.74612594, 'f1': 0.81495196, 'auroc': 0.9484052, 'binary_precision': 0.9148936, 'binary_recall': 0.49425286, 'binary_specificity': 0.997999, 'binary_f1_score': 0.641791}
confusion matrix:
      0    1
0  5985   12
1   132  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256733_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-08 13:43:59.449471,epoch time: 0:27:12.383308,used: 1:22:51.273057,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_21_08_seed_0_21256733
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97234654, 'precision': 0.7808089, 'recall': 0.8430736, 'specificity': 0.8430736, 'f1': 0.80849457, 'auroc': 0.9685527, 'binary_precision': 0.5719801, 'binary_recall': 0.7044837, 'binary_specificity': 0.9816635, 'binary_f1_score': 0.6313547}
confusion matrix:
       0     1
0  41544   776
1    435  1037
---- Validation: 
scalar performance:
{'acc': 0.97200936, 'precision': 0.78563285, 'recall': 0.8069957, 'specificity': 0.8069957, 'f1': 0.7958882, 'auroc': 0.96103823, 'binary_precision': 0.58441556, 'binary_recall': 0.62986004, 'binary_specificity': 0.98413134, 'binary_f1_score': 0.6062874}
confusion matrix:
       0    1
0  17861  288
1    238  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9753915, 'precision': 0.9037741, 'recall': 0.75628614, 'specificity': 0.75628614, 'f1': 0.8120284, 'auroc': 0.9370642, 'binary_precision': 0.82822084, 'binary_recall': 0.51724136, 'binary_specificity': 0.995331, 'binary_f1_score': 0.6367924}
confusion matrix:
      0    1
0  5969   28
1   126  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256733_4.png
early stop counter: 1
val acc:0.9720093607902527, best validation acc: 0.9738718867301941, corresponding to test acc:                         0.9769894480705261 / 0.9769894480705261
after epoch: 4,now: 2024-06-08 14:11:31.647447,epoch time: 0:27:32.197976,used: 1:50:23.471033,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_21_08_seed_0_21256733
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97917426, 'precision': 0.88522136, 'recall': 0.7584121, 'specificity': 0.7584121, 'f1': 0.8083694, 'auroc': 0.9730572, 'binary_precision': 0.78688526, 'binary_recall': 0.5217391, 'binary_specificity': 0.99508506, 'binary_f1_score': 0.627451}
confusion matrix:
       0    1
0  42112  208
1    704  768
---- Validation: 
scalar performance:
{'acc': 0.9795658, 'precision': 0.8735391, 'recall': 0.7899062, 'specificity': 0.7899062, 'f1': 0.8260149, 'auroc': 0.96727896, 'binary_precision': 0.7616162, 'binary_recall': 0.58631414, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.66256595}
confusion matrix:
       0    1
0  18031  118
1    266  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.84426093, 'recall': 0.5885376, 'specificity': 0.5885376, 'f1': 0.6346558, 'auroc': 0.94653505, 'binary_precision': 0.72307694, 'binary_recall': 0.18007663, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.28834355}
confusion matrix:
      0   1
0  5979  18
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256733_5.png
better model found
persisted
after epoch: 5,now: 2024-06-08 14:38:46.318447,epoch time: 0:27:14.671000,used: 2:17:38.142033,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_21_08_seed_0_21256733
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98097825, 'precision': 0.8492974, 'recall': 0.86417186, 'specificity': 0.86417186, 'f1': 0.85656536, 'auroc': 0.9783726, 'binary_precision': 0.7076823, 'binary_recall': 0.7389531, 'binary_specificity': 0.9893906, 'binary_f1_score': 0.72297966}
confusion matrix:
       0     1
0  41872   449
1    384  1087
---- Validation: 
scalar performance:
{'acc': 0.9803108, 'precision': 0.8519652, 'recall': 0.8487962, 'specificity': 0.8487962, 'f1': 0.85037285, 'auroc': 0.9754742, 'binary_precision': 0.71428573, 'binary_recall': 0.7076205, 'binary_specificity': 0.9899719, 'binary_f1_score': 0.7109375}
confusion matrix:
       0    1
0  17967  182
1    188  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.8553797, 'recall': 0.6998969, 'specificity': 0.6998969, 'f1': 0.75376046, 'auroc': 0.9479831, 'binary_precision': 0.7361111, 'binary_recall': 0.40613025, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.52345675}
confusion matrix:
      0    1
0  5959   38
1   155  106
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256733_6.png
better model found
persisted
after epoch: 6,now: 2024-06-08 15:06:36.592593,epoch time: 0:27:50.274146,used: 2:45:28.416179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_21_08_seed_0_21256733
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9810011, 'precision': 0.848521, 'recall': 0.8672229, 'specificity': 0.8672229, 'f1': 0.8576051, 'auroc': 0.9797453, 'binary_precision': 0.7059202, 'binary_recall': 0.74524456, 'binary_specificity': 0.9892013, 'binary_f1_score': 0.7250496}
confusion matrix:
       0     1
0  41863   457
1    375  1097
---- Validation: 
scalar performance:
{'acc': 0.98217326, 'precision': 0.873541, 'recall': 0.84826034, 'specificity': 0.84826034, 'f1': 0.86041933, 'auroc': 0.97492534, 'binary_precision': 0.7575251, 'binary_recall': 0.7045101, 'binary_specificity': 0.9920106, 'binary_f1_score': 0.7300564}
confusion matrix:
       0    1
0  18004  145
1    190  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.8310502, 'recall': 0.6634151, 'specificity': 0.6634151, 'f1': 0.7160256, 'auroc': 0.95426977, 'binary_precision': 0.6904762, 'binary_recall': 0.33333334, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.44961238}
confusion matrix:
      0   1
0  5958  39
1   174  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256733_7.png
better model found
persisted
after epoch: 7,now: 2024-06-08 15:36:00.948292,epoch time: 0:29:24.355699,used: 3:14:52.771878,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_21_08_seed_0_21256733
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9819145, 'precision': 0.85957026, 'recall': 0.86334383, 'specificity': 0.86334383, 'f1': 0.8614464, 'auroc': 0.97979033, 'binary_precision': 0.728312, 'binary_recall': 0.73623383, 'binary_specificity': 0.9904539, 'binary_f1_score': 0.7322515}
confusion matrix:
       0     1
0  41917   404
1    388  1083
---- Validation: 
scalar performance:
{'acc': 0.98137504, 'precision': 0.8624852, 'recall': 0.85159737, 'specificity': 0.85159737, 'f1': 0.85695076, 'auroc': 0.9727673, 'binary_precision': 0.7351525, 'binary_recall': 0.7122862, 'binary_specificity': 0.99090856, 'binary_f1_score': 0.7235387}
confusion matrix:
       0    1
0  17984  165
1    185  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970278, 'precision': 0.8868743, 'recall': 0.6894865, 'specificity': 0.6894865, 'f1': 0.7514004, 'auroc': 0.96046877, 'binary_precision': 0.8, 'binary_recall': 0.38314176, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.5181347}
confusion matrix:
      0    1
0  5972   25
1   161  100
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256733_8.png
early stop counter: 1
val acc:0.9813750386238098, best validation acc: 0.9821732640266418, corresponding to test acc:                         0.9659635424613953 / 0.9769894480705261
after epoch: 8,now: 2024-06-08 16:04:10.394248,epoch time: 0:28:09.445956,used: 3:43:02.217834,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_21_08_seed_0_21256733
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9839697, 'precision': 0.8760505, 'recall': 0.8775308, 'specificity': 0.8775308, 'f1': 0.8767891, 'auroc': 0.9820876, 'binary_precision': 0.76032495, 'binary_recall': 0.76342624, 'binary_specificity': 0.9916354, 'binary_f1_score': 0.7618724}
confusion matrix:
       0     1
0  41967   354
1    348  1123
---- Validation: 
scalar performance:
{'acc': 0.9841954, 'precision': 0.891803, 'recall': 0.86055803, 'specificity': 0.86055803, 'f1': 0.87547684, 'auroc': 0.97653675, 'binary_precision': 0.79322034, 'binary_recall': 0.7278383, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.75912416}
confusion matrix:
       0    1
0  18027  122
1    175  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.80243504, 'recall': 0.5990313, 'specificity': 0.5990313, 'f1': 0.6442932, 'auroc': 0.9531985, 'binary_precision': 0.6385542, 'binary_recall': 0.20306513, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.3081395}
confusion matrix:
      0   1
0  5967  30
1   208  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256733_9.png
better model found
persisted
after epoch: 9,now: 2024-06-08 16:32:23.639843,epoch time: 0:28:13.245595,used: 4:11:15.463429,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_21_08_seed_0_21256733
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98355865, 'precision': 0.8930555, 'recall': 0.8396946, 'specificity': 0.8396946, 'f1': 0.86427414, 'auroc': 0.9831263, 'binary_precision': 0.79699844, 'binary_recall': 0.68546194, 'binary_specificity': 0.99392724, 'binary_f1_score': 0.7370343}
confusion matrix:
       0     1
0  42063   257
1    463  1009
---- Validation: 
scalar performance:
{'acc': 0.9834504, 'precision': 0.9025123, 'recall': 0.83017015, 'specificity': 0.83017015, 'f1': 0.86248237, 'auroc': 0.9768415, 'binary_precision': 0.8167939, 'binary_recall': 0.66562986, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.7335047}
confusion matrix:
       0    1
0  18053   96
1    215  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.8258394, 'recall': 0.637012, 'specificity': 0.637012, 'f1': 0.68923223, 'auroc': 0.9600276, 'binary_precision': 0.682243, 'binary_recall': 0.27969348, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.39673913}
confusion matrix:
      0   1
0  5963  34
1   188  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256733_10.png
early stop counter: 1
val acc:0.9834504127502441, best validation acc: 0.9841954112052917, corresponding to test acc:                         0.9619686603546143 / 0.9769894480705261
after epoch: 10,now: 2024-06-08 17:01:04.935771,epoch time: 0:28:41.295928,used: 4:39:56.759357,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_21_08_seed_0_21256733
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9815263, 'precision': 0.838994, 'recall': 0.91241133, 'specificity': 0.91241133, 'f1': 0.871766, 'auroc': 0.98390657, 'binary_precision': 0.6836565, 'binary_recall': 0.8383152, 'binary_specificity': 0.98650753, 'binary_f1_score': 0.7531279}
confusion matrix:
       0     1
0  41749   571
1    238  1234
---- Validation: 
scalar performance:
{'acc': 0.9819072, 'precision': 0.8530525, 'recall': 0.88787556, 'specificity': 0.88787556, 'f1': 0.86956835, 'auroc': 0.9760643, 'binary_precision': 0.7136812, 'binary_recall': 0.7869362, 'binary_specificity': 0.98881483, 'binary_f1_score': 0.7485207}
confusion matrix:
       0    1
0  17946  203
1    137  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8074534, 'recall': 0.6682451, 'specificity': 0.6682451, 'f1': 0.71531796, 'auroc': 0.95463383, 'binary_precision': 0.64285713, 'binary_recall': 0.3448276, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.4488778}
confusion matrix:
      0   1
0  5947  50
1   171  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256733_11.png
early stop counter: 2
val acc:0.9819071888923645, best validation acc: 0.9841954112052917, corresponding to test acc:                         0.9619686603546143 / 0.9769894480705261
after epoch: 11,now: 2024-06-08 17:28:57.711663,epoch time: 0:27:52.775892,used: 5:07:49.535249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_21_08_seed_0_21256733
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9861162, 'precision': 0.90147185, 'recall': 0.87929755, 'specificity': 0.87929755, 'f1': 0.89004385, 'auroc': 0.98652625, 'binary_precision': 0.8111031, 'binary_recall': 0.7647859, 'binary_specificity': 0.9938092, 'binary_f1_score': 0.7872638}
confusion matrix:
       0     1
0  42059   262
1    346  1125
---- Validation: 
scalar performance:
{'acc': 0.98435503, 'precision': 0.9175267, 'recall': 0.8291384, 'specificity': 0.8291384, 'f1': 0.86769354, 'auroc': 0.9780503, 'binary_precision': 0.84691846, 'binary_recall': 0.66251945, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.74345547}
confusion matrix:
       0    1
0  18072   77
1    217  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8382492, 'recall': 0.64484155, 'specificity': 0.64484155, 'f1': 0.69921625, 'auroc': 0.95577466, 'binary_precision': 0.70642203, 'binary_recall': 0.29501915, 'binary_specificity': 0.994664, 'binary_f1_score': 0.4162162}
confusion matrix:
      0   1
0  5965  32
1   184  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256733_12.png
better model found
persisted
after epoch: 12,now: 2024-06-08 17:58:07.709251,epoch time: 0:29:09.997588,used: 5:36:59.532837,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_21_08_seed_0_21256733
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98447204, 'precision': 0.9455988, 'recall': 0.7995126, 'specificity': 0.7995126, 'f1': 0.8572308, 'auroc': 0.9867207, 'binary_precision': 0.904908, 'binary_recall': 0.6012228, 'binary_specificity': 0.99780244, 'binary_f1_score': 0.722449}
confusion matrix:
       0    1
0  42227   93
1    587  885
---- Validation: 
scalar performance:
{'acc': 0.9799915, 'precision': 0.9064665, 'recall': 0.7593743, 'specificity': 0.7593743, 'f1': 0.8154651, 'auroc': 0.9753566, 'binary_precision': 0.8296296, 'binary_recall': 0.5225505, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.64122134}
confusion matrix:
       0    1
0  18080   69
1    307  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.83906543, 'recall': 0.6110258, 'specificity': 0.6110258, 'f1': 0.662228, 'auroc': 0.9591445, 'binary_precision': 0.7108434, 'binary_recall': 0.22605364, 'binary_specificity': 0.995998, 'binary_f1_score': 0.34302324}
confusion matrix:
      0   1
0  5973  24
1   202  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256733_13.png
early stop counter: 1
val acc:0.9799914956092834, best validation acc: 0.9843550324440002, corresponding to test acc:                         0.9654842019081116 / 0.9769894480705261
after epoch: 13,now: 2024-06-08 18:27:24.917776,epoch time: 0:29:17.208525,used: 6:06:16.741362,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_21_08_seed_0_21256733
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98515713, 'precision': 0.8779342, 'recall': 0.90117556, 'specificity': 0.90117556, 'f1': 0.8891777, 'auroc': 0.9886051, 'binary_precision': 0.7624521, 'binary_recall': 0.8111413, 'binary_specificity': 0.9912098, 'binary_f1_score': 0.7860435}
confusion matrix:
       0     1
0  41948   372
1    278  1194
---- Validation: 
scalar performance:
{'acc': 0.9856322, 'precision': 0.9038694, 'recall': 0.8710526, 'specificity': 0.8710526, 'f1': 0.8867084, 'auroc': 0.9801828, 'binary_precision': 0.81663835, 'binary_recall': 0.748056, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.78084415}
confusion matrix:
       0    1
0  18041  108
1    162  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.802268, 'recall': 0.6550018, 'specificity': 0.6550018, 'f1': 0.70241433, 'auroc': 0.94855845, 'binary_precision': 0.6335878, 'binary_recall': 0.31800765, 'binary_specificity': 0.991996, 'binary_f1_score': 0.42346936}
confusion matrix:
      0   1
0  5949  48
1   178  83
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256733_14.png
better model found
persisted
after epoch: 14,now: 2024-06-08 18:56:51.032526,epoch time: 0:29:26.114750,used: 6:35:42.856112,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_21_08_seed_0_21256733
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9874635, 'precision': 0.92391443, 'recall': 0.8745009, 'specificity': 0.8745009, 'f1': 0.8975587, 'auroc': 0.98790693, 'binary_precision': 0.8563706, 'binary_recall': 0.75339675, 'binary_specificity': 0.99560493, 'binary_f1_score': 0.80159014}
confusion matrix:
       0     1
0  42134   186
1    363  1109
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.9226728, 'recall': 0.8601875, 'specificity': 0.8601875, 'f1': 0.888739, 'auroc': 0.9801775, 'binary_precision': 0.85504586, 'binary_recall': 0.7247278, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.78451174}
confusion matrix:
       0    1
0  18070   79
1    177  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.8762569, 'recall': 0.59087014, 'specificity': 0.59087014, 'f1': 0.6398015, 'auroc': 0.95098585, 'binary_precision': 0.78688526, 'binary_recall': 0.18390805, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.29813665}
confusion matrix:
      0   1
0  5984  13
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256733_15.png
better model found
persisted
after epoch: 15,now: 2024-06-08 19:26:20.226934,epoch time: 0:29:29.194408,used: 7:05:12.050520,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_21_08_seed_0_21256733
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9855453, 'precision': 0.87521064, 'recall': 0.91613007, 'specificity': 0.91613007, 'f1': 0.8945175, 'auroc': 0.9890015, 'binary_precision': 0.7559487, 'binary_recall': 0.84171194, 'binary_specificity': 0.9905482, 'binary_f1_score': 0.79652846}
confusion matrix:
       0     1
0  41920   400
1    233  1239
---- Validation: 
scalar performance:
{'acc': 0.9845679, 'precision': 0.8786399, 'recall': 0.8922533, 'specificity': 0.8922533, 'f1': 0.88531566, 'auroc': 0.97889817, 'binary_precision': 0.7646177, 'binary_recall': 0.7931571, 'binary_specificity': 0.9913494, 'binary_f1_score': 0.77862597}
confusion matrix:
       0    1
0  17992  157
1    133  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.7888522, 'recall': 0.63592815, 'specificity': 0.63592815, 'f1': 0.68191826, 'auroc': 0.9498809, 'binary_precision': 0.60833335, 'binary_recall': 0.27969348, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.38320208}
confusion matrix:
      0   1
0  5950  47
1   188  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256733_16.png
early stop counter: 1
val acc:0.9845678806304932, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.9638862013816833 / 0.9769894480705261
after epoch: 16,now: 2024-06-08 19:55:54.353597,epoch time: 0:29:34.126663,used: 7:34:46.177183,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_21_08_seed_0_21256733
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9849059, 'precision': 0.9130102, 'recall': 0.8396286, 'specificity': 0.8396286, 'f1': 0.8724638, 'auroc': 0.9885049, 'binary_precision': 0.83693844, 'binary_recall': 0.6838885, 'binary_specificity': 0.9953687, 'binary_f1_score': 0.7527123}
confusion matrix:
       0     1
0  42125   196
1    465  1006
---- Validation: 
scalar performance:
{'acc': 0.9819072, 'precision': 0.9058372, 'recall': 0.7963688, 'specificity': 0.7963688, 'f1': 0.8419098, 'auroc': 0.97896767, 'binary_precision': 0.82580644, 'binary_recall': 0.59720063, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.69314086}
confusion matrix:
       0    1
0  18068   81
1    259  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.9378507, 'recall': 0.5782106, 'specificity': 0.5782106, 'f1': 0.6248141, 'auroc': 0.9457542, 'binary_precision': 0.9111111, 'binary_recall': 0.15708812, 'binary_specificity': 0.999333, 'binary_f1_score': 0.26797384}
confusion matrix:
      0   1
0  5993   4
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256733_17.png
early stop counter: 2
val acc:0.9819071888923645, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.9638862013816833 / 0.9769894480705261
after epoch: 17,now: 2024-06-08 20:25:27.902066,epoch time: 0:29:33.548469,used: 8:04:19.725652,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_21_08_seed_0_21256733
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98810285, 'precision': 0.9305795, 'recall': 0.87811023, 'specificity': 0.87811023, 'f1': 0.9025107, 'auroc': 0.9911654, 'binary_precision': 0.86946386, 'binary_recall': 0.7601902, 'binary_specificity': 0.9960303, 'binary_f1_score': 0.8111634}
confusion matrix:
       0     1
0  42152   168
1    353  1119
---- Validation: 
scalar performance:
{'acc': 0.98467433, 'precision': 0.91287637, 'recall': 0.8405545, 'specificity': 0.8405545, 'f1': 0.87296855, 'auroc': 0.9781814, 'binary_precision': 0.83681214, 'binary_recall': 0.6858476, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.7538461}
confusion matrix:
       0    1
0  18063   86
1    202  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.8296166, 'recall': 0.6258513, 'specificity': 0.6258513, 'f1': 0.6779388, 'auroc': 0.9587396, 'binary_precision': 0.69072163, 'binary_recall': 0.256705, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.37430167}
confusion matrix:
      0   1
0  5967  30
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256733_18.png
early stop counter: 3
val acc:0.984674334526062, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.9638862013816833 / 0.9769894480705261
after epoch: 18,now: 2024-06-08 20:54:59.453284,epoch time: 0:29:31.551218,used: 8:33:51.276870,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_21_08_seed_0_21256733
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9886052, 'precision': 0.9172523, 'recall': 0.9049268, 'specificity': 0.9049268, 'f1': 0.91098964, 'auroc': 0.99018264, 'binary_precision': 0.84092504, 'binary_recall': 0.8152174, 'binary_specificity': 0.9946361, 'binary_f1_score': 0.8278716}
confusion matrix:
       0     1
0  42093   227
1    272  1200
---- Validation: 
scalar performance:
{'acc': 0.9859515, 'precision': 0.90914196, 'recall': 0.86971784, 'specificity': 0.86971784, 'f1': 0.8883502, 'auroc': 0.98068607, 'binary_precision': 0.82728845, 'binary_recall': 0.7449456, 'binary_specificity': 0.99449, 'binary_f1_score': 0.78396076}
confusion matrix:
       0    1
0  18049  100
1    164  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.82130766, 'recall': 0.57129616, 'specificity': 0.57129616, 'f1': 0.60999596, 'auroc': 0.9478302, 'binary_precision': 0.6785714, 'binary_recall': 0.14559387, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.23974761}
confusion matrix:
      0   1
0  5979  18
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256733_19.png
early stop counter: 4
val acc:0.9859514832496643, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.9638862013816833 / 0.9769894480705261
after epoch: 19,now: 2024-06-08 21:24:21.543638,epoch time: 0:29:22.090354,used: 9:03:13.367224,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_21_08_seed_0_21256733
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9885367, 'precision': 0.93504053, 'recall': 0.8805499, 'specificity': 0.8805499, 'f1': 0.9058348, 'auroc': 0.9914659, 'binary_precision': 0.87822014, 'binary_recall': 0.7647859, 'binary_specificity': 0.99631387, 'binary_f1_score': 0.8175872}
confusion matrix:
       0     1
0  42165   156
1    346  1125
---- Validation: 
scalar performance:
{'acc': 0.98467433, 'precision': 0.9092878, 'recall': 0.84505486, 'specificity': 0.84505486, 'f1': 0.8742168, 'auroc': 0.97631156, 'binary_precision': 0.8293135, 'binary_recall': 0.69517887, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.75634515}
confusion matrix:
       0    1
0  18057   92
1    196  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.821037, 'recall': 0.5787923, 'specificity': 0.5787923, 'f1': 0.62023026, 'auroc': 0.94763744, 'binary_precision': 0.67741936, 'binary_recall': 0.16091955, 'binary_specificity': 0.996665, 'binary_f1_score': 0.26006192}
confusion matrix:
      0   1
0  5977  20
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256733_20.png
early stop counter: 5
val acc:0.984674334526062, best validation acc: 0.9863771796226501, corresponding to test acc:                         0.9638862013816833 / 0.9769894480705261
after epoch: 20,now: 2024-06-08 21:53:41.097319,epoch time: 0:29:19.553681,used: 9:32:32.920905,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_21_08_seed_0_21256733
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9897698, 'precision': 0.94097394, 'recall': 0.89569354, 'specificity': 0.89569354, 'f1': 0.917014, 'auroc': 0.99297297, 'binary_precision': 0.88905776, 'binary_recall': 0.79483694, 'binary_specificity': 0.9965501, 'binary_f1_score': 0.8393113}
confusion matrix:
       0     1
0  42174   146
1    302  1170
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.92417777, 'recall': 0.8324417, 'specificity': 0.8324417, 'f1': 0.87231994, 'auroc': 0.97586656, 'binary_precision': 0.86, 'binary_recall': 0.6687403, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.75240594}
confusion matrix:
       0    1
0  18079   70
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.82075024, 'recall': 0.60502857, 'specificity': 0.60502857, 'f1': 0.65326065, 'auroc': 0.95388275, 'binary_precision': 0.67469877, 'binary_recall': 0.21455939, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.3255814}
confusion matrix:
      0   1
0  5970  27
1   205  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256733_21.png
[Sat Jun  8 22:23:06 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/rule_results/1.csv

RuleException:
RuntimeError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[enforce fail at inline_container.cc:595] . unexpected pos 78249216 vs 78249040
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_irm.py", line 51, in tr_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_irm.py", line 66, in after_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 60, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/a_model_sel.py", line 63, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/c_msel_oracle.py", line 37, in base_update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model.py", line 159, in save
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_utils.py", line 88, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 627, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 475, in __exit__
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
