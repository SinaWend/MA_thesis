Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun  8 12:13:26 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730

 Experiment start at: 2024-06-08 12:19:43.354842
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9746986, 'precision': 0.8472284, 'recall': 0.7029832, 'specificity': 0.7029832, 'f1': 0.7547094, 'auroc': 0.9676511, 'binary_precision': 0.7146226, 'binary_recall': 0.41168478, 'binary_specificity': 0.99428165, 'binary_f1_score': 0.5224138}
confusion matrix:
       0    1
0  42078  242
1    866  606
---- Validation: 
scalar performance:
{'acc': 0.9728076, 'precision': 0.846375, 'recall': 0.66789865, 'specificity': 0.66789865, 'f1': 0.72379506, 'auroc': 0.96001273, 'binary_precision': 0.71568626, 'binary_recall': 0.34059098, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.46153846}
confusion matrix:
       0    1
0  18062   87
1    424  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.9813002, 'recall': 0.5536398, 'specificity': 0.5536398, 'f1': 0.5873577, 'auroc': 0.9444248, 'binary_precision': 1.0, 'binary_recall': 0.107279696, 'binary_specificity': 1.0, 'binary_f1_score': 0.19377163}
confusion matrix:
      0   1
0  5997   0
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-08 12:37:39.210446,epoch time: 0:17:55.855604,used: 0:17:55.855604,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98097825, 'precision': 0.8969221, 'recall': 0.78196776, 'specificity': 0.78196776, 'f1': 0.8289696, 'auroc': 0.9808817, 'binary_precision': 0.8086957, 'binary_recall': 0.5686141, 'binary_specificity': 0.99532133, 'binary_f1_score': 0.6677304}
confusion matrix:
       0    1
0  42122  198
1    635  837
---- Validation: 
scalar performance:
{'acc': 0.9780226, 'precision': 0.9208306, 'recall': 0.7118516, 'specificity': 0.7118516, 'f1': 0.7794811, 'auroc': 0.9753549, 'binary_precision': 0.8616352, 'binary_recall': 0.42612752, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.5702393}
confusion matrix:
       0    1
0  18105   44
1    369  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.79785204, 'recall': 0.5130765, 'specificity': 0.5130765, 'f1': 0.51519954, 'auroc': 0.95146763, 'binary_precision': 0.6363636, 'binary_recall': 0.026819924, 'binary_specificity': 0.999333, 'binary_f1_score': 0.051470585}
confusion matrix:
      0  1
0  5993  4
1   254  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_2.png
better model found
persisted
after epoch: 2,now: 2024-06-08 12:54:47.355344,epoch time: 0:17:08.144898,used: 0:35:04.000502,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9827366, 'precision': 0.9211353, 'recall': 0.79041827, 'specificity': 0.79041827, 'f1': 0.842893, 'auroc': 0.986073, 'binary_precision': 0.8565737, 'binary_recall': 0.5842391, 'binary_specificity': 0.99659735, 'binary_f1_score': 0.6946688}
confusion matrix:
       0    1
0  42176  144
1    612  860
---- Validation: 
scalar performance:
{'acc': 0.9795658, 'precision': 0.9339105, 'recall': 0.7299018, 'specificity': 0.7299018, 'f1': 0.7984359, 'auroc': 0.9790617, 'binary_precision': 0.8865672, 'binary_recall': 0.46189734, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.607362}
confusion matrix:
       0    1
0  18111   38
1    346  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.8366661, 'recall': 0.5094118, 'specificity': 0.5094118, 'f1': 0.50812435, 'auroc': 0.9434837, 'binary_precision': 0.71428573, 'binary_recall': 0.019157087, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.037313428}
confusion matrix:
      0  1
0  5995  2
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_3.png
better model found
persisted
after epoch: 3,now: 2024-06-08 13:11:59.387543,epoch time: 0:17:12.032199,used: 0:52:16.032701,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98186886, 'precision': 0.848091, 'recall': 0.89219224, 'specificity': 0.89219224, 'f1': 0.86870456, 'auroc': 0.98708177, 'binary_precision': 0.7033033, 'binary_recall': 0.7960571, 'binary_specificity': 0.9883273, 'binary_f1_score': 0.7468113}
confusion matrix:
       0     1
0  41827   494
1    300  1171
---- Validation: 
scalar performance:
{'acc': 0.9813218, 'precision': 0.86086255, 'recall': 0.85381997, 'specificity': 0.85381997, 'f1': 0.85730344, 'auroc': 0.9796808, 'binary_precision': 0.731746, 'binary_recall': 0.7169518, 'binary_specificity': 0.9906882, 'binary_f1_score': 0.7242734}
confusion matrix:
       0    1
0  17980  169
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.8759304, 'recall': 0.6551705, 'specificity': 0.6551705, 'f1': 0.71573097, 'auroc': 0.95974517, 'binary_precision': 0.7809524, 'binary_recall': 0.31417623, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.4480874}
confusion matrix:
      0   1
0  5974  23
1   179  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-08 13:29:13.316987,epoch time: 0:17:13.929444,used: 1:09:29.962145,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9853855, 'precision': 0.9064052, 'recall': 0.8576884, 'specificity': 0.8576884, 'f1': 0.8803693, 'auroc': 0.98936963, 'binary_precision': 0.8224806, 'binary_recall': 0.72078806, 'binary_specificity': 0.99458885, 'binary_f1_score': 0.7682839}
confusion matrix:
       0     1
0  42091   229
1    411  1061
---- Validation: 
scalar performance:
{'acc': 0.9837165, 'precision': 0.9349663, 'recall': 0.8003057, 'specificity': 0.8003057, 'f1': 0.8544036, 'auroc': 0.978919, 'binary_precision': 0.88382685, 'binary_recall': 0.60342145, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.7171904}
confusion matrix:
       0    1
0  18098   51
1    255  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7657528, 'recall': 0.52223814, 'specificity': 0.52223814, 'f1': 0.5320088, 'auroc': 0.9285078, 'binary_precision': 0.5714286, 'binary_recall': 0.04597701, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.08510638}
confusion matrix:
      0   1
0  5988   9
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_5.png
better model found
persisted
after epoch: 5,now: 2024-06-08 13:46:33.517114,epoch time: 0:17:20.200127,used: 1:26:50.162272,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9866186, 'precision': 0.94754386, 'recall': 0.83439267, 'specificity': 0.83439267, 'f1': 0.88219005, 'auroc': 0.9920366, 'binary_precision': 0.906422, 'binary_recall': 0.6711956, 'binary_specificity': 0.99758977, 'binary_f1_score': 0.7712725}
confusion matrix:
       0    1
0  42218  102
1    484  988
---- Validation: 
scalar performance:
{'acc': 0.9830247, 'precision': 0.939121, 'recall': 0.78494644, 'specificity': 0.78494644, 'f1': 0.84444875, 'auroc': 0.9822675, 'binary_precision': 0.89320385, 'binary_recall': 0.57231724, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.6976303}
confusion matrix:
       0    1
0  18105   44
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.9793765, 'recall': 0.50574714, 'specificity': 0.50574714, 'f1': 0.50083476, 'auroc': 0.94361115, 'binary_precision': 1.0, 'binary_recall': 0.011494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.022727272}
confusion matrix:
      0  1
0  5997  0
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_6.png
early stop counter: 1
val acc:0.9830247163772583, best validation acc: 0.9837164878845215, corresponding to test acc:                         0.9587727785110474 / 0.9677213430404663
after epoch: 6,now: 2024-06-08 14:03:55.002183,epoch time: 0:17:21.485069,used: 1:44:11.647341,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9841524, 'precision': 0.854413, 'recall': 0.9360254, 'specificity': 0.9360254, 'f1': 0.890604, 'auroc': 0.9932387, 'binary_precision': 0.71287674, 'binary_recall': 0.8844324, 'binary_specificity': 0.98761845, 'binary_f1_score': 0.78944176}
confusion matrix:
       0     1
0  41797   524
1    170  1301
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.87855476, 'recall': 0.9175836, 'specificity': 0.9175836, 'f1': 0.8970256, 'auroc': 0.9824667, 'binary_precision': 0.7626405, 'binary_recall': 0.844479, 'binary_specificity': 0.9906882, 'binary_f1_score': 0.80147606}
confusion matrix:
       0    1
0  17980  169
1    100  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.85688406, 'recall': 0.56796503, 'specificity': 0.56796503, 'f1': 0.6067973, 'auroc': 0.9453678, 'binary_precision': 0.75, 'binary_recall': 0.13793103, 'binary_specificity': 0.997999, 'binary_f1_score': 0.2330097}
confusion matrix:
      0   1
0  5985  12
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_7.png
better model found
persisted
after epoch: 7,now: 2024-06-08 14:21:26.462655,epoch time: 0:17:31.460472,used: 2:01:43.107813,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9899525, 'precision': 0.93408036, 'recall': 0.9072631, 'specificity': 0.9072631, 'f1': 0.92021066, 'auroc': 0.9955379, 'binary_precision': 0.87445575, 'binary_recall': 0.8186141, 'binary_specificity': 0.9959121, 'binary_f1_score': 0.845614}
confusion matrix:
       0     1
0  42147   173
1    267  1205
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.9360402, 'recall': 0.8490468, 'specificity': 0.8490468, 'f1': 0.8873559, 'auroc': 0.98379016, 'binary_precision': 0.88258314, 'binary_recall': 0.7013997, 'binary_specificity': 0.996694, 'binary_f1_score': 0.7816291}
confusion matrix:
       0    1
0  18089   60
1    192  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.86909723, 'recall': 0.52648646, 'specificity': 0.52648646, 'f1': 0.5399234, 'auroc': 0.93911815, 'binary_precision': 0.7777778, 'binary_recall': 0.053639848, 'binary_specificity': 0.999333, 'binary_f1_score': 0.100358434}
confusion matrix:
      0   1
0  5993   4
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_8.png
better model found
persisted
after epoch: 8,now: 2024-06-08 14:38:54.854308,epoch time: 0:17:28.391653,used: 2:19:11.499466,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98922175, 'precision': 0.91341317, 'recall': 0.92262226, 'specificity': 0.92262226, 'f1': 0.9179628, 'auroc': 0.99578416, 'binary_precision': 0.8320053, 'binary_recall': 0.8512228, 'binary_specificity': 0.9940217, 'binary_f1_score': 0.8415044}
confusion matrix:
       0     1
0  42067   253
1    219  1253
---- Validation: 
scalar performance:
{'acc': 0.98706895, 'precision': 0.91380084, 'recall': 0.88454735, 'specificity': 0.88454735, 'f1': 0.8985941, 'auroc': 0.981893, 'binary_precision': 0.83557045, 'binary_recall': 0.7744945, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.8038741}
confusion matrix:
       0    1
0  18051   98
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.7923943, 'recall': 0.51865685, 'specificity': 0.51865685, 'f1': 0.52560186, 'auroc': 0.94104326, 'binary_precision': 0.625, 'binary_recall': 0.038314175, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.07220217}
confusion matrix:
      0   1
0  5991   6
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_9.png
better model found
persisted
after epoch: 9,now: 2024-06-08 14:56:21.427015,epoch time: 0:17:26.572707,used: 2:36:38.072173,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99024934, 'precision': 0.94699204, 'recall': 0.8972531, 'specificity': 0.8972531, 'f1': 0.9205457, 'auroc': 0.9959465, 'binary_precision': 0.9009977, 'binary_recall': 0.7975544, 'binary_specificity': 0.9969518, 'binary_f1_score': 0.84612614}
confusion matrix:
       0     1
0  42191   129
1    298  1174
---- Validation: 
scalar performance:
{'acc': 0.9868029, 'precision': 0.9488803, 'recall': 0.84015644, 'specificity': 0.84015644, 'f1': 0.8864745, 'auroc': 0.9791944, 'binary_precision': 0.9089027, 'binary_recall': 0.6827372, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.7797513}
confusion matrix:
       0    1
0  18105   44
1    204  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.84338665, 'recall': 0.51507556, 'specificity': 0.51507556, 'f1': 0.5189576, 'auroc': 0.9315948, 'binary_precision': 0.72727275, 'binary_recall': 0.03065134, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.058823526}
confusion matrix:
      0  1
0  5994  3
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_10.png
early stop counter: 1
val acc:0.986802875995636, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9589325785636902 / 0.9677213430404663
after epoch: 10,now: 2024-06-08 15:20:42.020031,epoch time: 0:24:20.593016,used: 3:00:58.665189,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99168795, 'precision': 0.94367445, 'recall': 0.9261933, 'specificity': 0.9261933, 'f1': 0.9347444, 'auroc': 0.9969437, 'binary_precision': 0.89235127, 'binary_recall': 0.85597825, 'binary_specificity': 0.99640834, 'binary_f1_score': 0.8737864}
confusion matrix:
       0     1
0  42168   152
1    212  1260
---- Validation: 
scalar performance:
{'acc': 0.98541933, 'precision': 0.90364766, 'recall': 0.86719215, 'specificity': 0.86719215, 'f1': 0.8844864, 'auroc': 0.9820324, 'binary_precision': 0.81646657, 'binary_recall': 0.7402799, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.776509}
confusion matrix:
       0    1
0  18042  107
1    167  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7874361, 'recall': 0.5149088, 'specificity': 0.5149088, 'f1': 0.5186596, 'auroc': 0.9360651, 'binary_precision': 0.61538464, 'binary_recall': 0.03065134, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.058394164}
confusion matrix:
      0  1
0  5992  5
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_11.png
early stop counter: 2
val acc:0.9854193329811096, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9589325785636902 / 0.9677213430404663
after epoch: 11,now: 2024-06-08 15:38:03.614745,epoch time: 0:17:21.594714,used: 3:18:20.259903,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99246436, 'precision': 0.9501363, 'recall': 0.93179554, 'specificity': 0.93179554, 'f1': 0.9407604, 'auroc': 0.9976276, 'binary_precision': 0.9048971, 'binary_recall': 0.86675733, 'binary_specificity': 0.99683374, 'binary_f1_score': 0.8854167}
confusion matrix:
       0     1
0  42187   134
1    196  1275
---- Validation: 
scalar performance:
{'acc': 0.9856322, 'precision': 0.9102711, 'recall': 0.86205196, 'specificity': 0.86205196, 'f1': 0.88453376, 'auroc': 0.9828601, 'binary_precision': 0.8300885, 'binary_recall': 0.7293935, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.77649003}
confusion matrix:
       0    1
0  18053   96
1    174  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.808851, 'recall': 0.5393127, 'specificity': 0.5393127, 'f1': 0.5614048, 'auroc': 0.9066679, 'binary_precision': 0.65625, 'binary_recall': 0.08045977, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.14334472}
confusion matrix:
      0   1
0  5986  11
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_12.png
early stop counter: 3
val acc:0.9856321811676025, best validation acc: 0.9870689511299133, corresponding to test acc:                         0.9589325785636902 / 0.9677213430404663
after epoch: 12,now: 2024-06-08 15:55:29.529265,epoch time: 0:17:25.914520,used: 3:35:46.174423,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99152815, 'precision': 0.9511303, 'recall': 0.91463554, 'specificity': 0.91463554, 'f1': 0.93205476, 'auroc': 0.997934, 'binary_precision': 0.90808004, 'binary_recall': 0.83220106, 'binary_specificity': 0.99706995, 'binary_f1_score': 0.86848634}
confusion matrix:
       0     1
0  42196   124
1    247  1225
---- Validation: 
scalar performance:
{'acc': 0.9875479, 'precision': 0.93923223, 'recall': 0.8622937, 'specificity': 0.8622937, 'f1': 0.8967869, 'auroc': 0.9843903, 'binary_precision': 0.88804555, 'binary_recall': 0.7278383, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.8}
confusion matrix:
       0    1
0  18090   59
1    175  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.92481303, 'recall': 0.5304846, 'specificity': 0.5304846, 'f1': 0.54725534, 'auroc': 0.9285305, 'binary_precision': 0.8888889, 'binary_recall': 0.06130268, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.11469534}
confusion matrix:
      0   1
0  5995   2
1   245  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_13.png
better model found
persisted
after epoch: 13,now: 2024-06-08 16:12:39.724845,epoch time: 0:17:10.195580,used: 3:52:56.370003,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9928069, 'precision': 0.9731659, 'recall': 0.91300213, 'specificity': 0.91300213, 'f1': 0.9408915, 'auroc': 0.9981777, 'binary_precision': 0.9523065, 'binary_recall': 0.8274456, 'binary_specificity': 0.9985586, 'binary_f1_score': 0.8854962}
confusion matrix:
       0     1
0  42259    61
1    254  1218
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.95381635, 'recall': 0.83487844, 'specificity': 0.83487844, 'f1': 0.8847265, 'auroc': 0.9842037, 'binary_precision': 0.9191489, 'binary_recall': 0.6718507, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.7762803}
confusion matrix:
       0    1
0  18111   38
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.75729454, 'recall': 0.50924504, 'specificity': 0.50924504, 'f1': 0.5079028, 'auroc': 0.9037913, 'binary_precision': 0.5555556, 'binary_recall': 0.019157087, 'binary_specificity': 0.999333, 'binary_f1_score': 0.037037034}
confusion matrix:
      0  1
0  5993  4
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_14.png
early stop counter: 1
val acc:0.9867497086524963, best validation acc: 0.9875478744506836, corresponding to test acc:                         0.9605305194854736 / 0.9677213430404663
after epoch: 14,now: 2024-06-08 16:29:47.016936,epoch time: 0:17:07.292091,used: 4:10:03.662094,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.993903, 'precision': 0.9498054, 'recall': 0.95717454, 'specificity': 0.95717454, 'f1': 0.9534576, 'auroc': 0.9986074, 'binary_precision': 0.9024716, 'binary_recall': 0.91779894, 'binary_specificity': 0.9965501, 'binary_f1_score': 0.9100707}
confusion matrix:
       0     1
0  42174   146
1    121  1351
---- Validation: 
scalar performance:
{'acc': 0.98808, 'precision': 0.92636645, 'recall': 0.88657093, 'specificity': 0.88657093, 'f1': 0.9054164, 'auroc': 0.98296887, 'binary_precision': 0.8605852, 'binary_recall': 0.777605, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.8169934}
confusion matrix:
       0    1
0  18068   81
1    143  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7388743, 'recall': 0.5275684, 'specificity': 0.5275684, 'f1': 0.5410911, 'auroc': 0.913186, 'binary_precision': 0.51724136, 'binary_recall': 0.057471264, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.10344827}
confusion matrix:
      0   1
0  5983  14
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_15.png
better model found
persisted
after epoch: 15,now: 2024-06-08 16:47:00.491156,epoch time: 0:17:13.474220,used: 4:27:17.136314,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9912541, 'precision': 0.94708943, 'recall': 0.91443676, 'specificity': 0.91443676, 'f1': 0.9300966, 'auroc': 0.9979116, 'binary_precision': 0.9, 'binary_recall': 0.83208704, 'binary_specificity': 0.9967865, 'binary_f1_score': 0.8647121}
confusion matrix:
       0     1
0  42185   136
1    247  1224
---- Validation: 
scalar performance:
{'acc': 0.98483396, 'precision': 0.9171709, 'recall': 0.838387, 'specificity': 0.838387, 'f1': 0.87334865, 'auroc': 0.98303235, 'binary_precision': 0.84555984, 'binary_recall': 0.68118197, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.754522}
confusion matrix:
       0    1
0  18069   80
1    205  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.808851, 'recall': 0.5393127, 'specificity': 0.5393127, 'f1': 0.5614048, 'auroc': 0.9361721, 'binary_precision': 0.65625, 'binary_recall': 0.08045977, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.14334472}
confusion matrix:
      0   1
0  5986  11
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_16.png
early stop counter: 1
val acc:0.9848339557647705, best validation acc: 0.9880800247192383, corresponding to test acc:                         0.9584531784057617 / 0.9677213430404663
after epoch: 16,now: 2024-06-08 17:04:17.368702,epoch time: 0:17:16.877546,used: 4:44:34.013860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99550146, 'precision': 0.9643947, 'recall': 0.96652585, 'specificity': 0.96652585, 'f1': 0.9654576, 'auroc': 0.99916255, 'binary_precision': 0.9310345, 'binary_recall': 0.93546194, 'binary_specificity': 0.99758977, 'binary_f1_score': 0.933243}
confusion matrix:
       0     1
0  42218   102
1     95  1377
---- Validation: 
scalar performance:
{'acc': 0.9882397, 'precision': 0.92164826, 'recall': 0.8956543, 'specificity': 0.8956543, 'f1': 0.9082042, 'auroc': 0.9839997, 'binary_precision': 0.8504983, 'binary_recall': 0.7962675, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.8224899}
confusion matrix:
       0    1
0  18059   90
1    131  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7740087, 'recall': 0.51857346, 'specificity': 0.51857346, 'f1': 0.5254303, 'auroc': 0.93220043, 'binary_precision': 0.5882353, 'binary_recall': 0.038314175, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.07194245}
confusion matrix:
      0   1
0  5990   7
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_17.png
better model found
persisted
after epoch: 17,now: 2024-06-08 17:21:42.097542,epoch time: 0:17:24.728840,used: 5:01:58.742700,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99550146, 'precision': 0.97942275, 'recall': 0.95009947, 'specificity': 0.95009947, 'f1': 0.96426404, 'auroc': 0.99892634, 'binary_precision': 0.9622642, 'binary_recall': 0.9014276, 'binary_specificity': 0.9987713, 'binary_f1_score': 0.93085295}
confusion matrix:
       0     1
0  42269    52
1    145  1326
---- Validation: 
scalar performance:
{'acc': 0.9883993, 'precision': 0.9372467, 'recall': 0.87923574, 'specificity': 0.87923574, 'f1': 0.90601933, 'auroc': 0.9832052, 'binary_precision': 0.8828829, 'binary_recall': 0.7620529, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.81803006}
confusion matrix:
       0    1
0  18084   65
1    153  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7296605, 'recall': 0.5128263, 'specificity': 0.5128263, 'f1': 0.51479363, 'auroc': 0.91256756, 'binary_precision': 0.5, 'binary_recall': 0.026819924, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.05090909}
confusion matrix:
      0  1
0  5990  7
1   254  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_18.png
better model found
persisted
after epoch: 18,now: 2024-06-08 17:39:11.370704,epoch time: 0:17:29.273162,used: 5:19:28.015862,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.992236, 'precision': 0.93125415, 'recall': 0.95270556, 'specificity': 0.95270556, 'f1': 0.9416983, 'auroc': 0.9981524, 'binary_precision': 0.8656331, 'binary_recall': 0.91032606, 'binary_specificity': 0.99508506, 'binary_f1_score': 0.8874172}
confusion matrix:
       0     1
0  42112   208
1    132  1340
---- Validation: 
scalar performance:
{'acc': 0.98621756, 'precision': 0.91732657, 'recall': 0.8638551, 'specificity': 0.8638551, 'f1': 0.8886138, 'auroc': 0.9777948, 'binary_precision': 0.84408605, 'binary_recall': 0.7325039, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.7843464}
confusion matrix:
       0    1
0  18062   87
1    172  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.77936995, 'recall': 0.50558037, 'specificity': 0.50558037, 'f1': 0.50066596, 'auroc': 0.8196368, 'binary_precision': 0.6, 'binary_recall': 0.011494253, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.02255639}
confusion matrix:
      0  1
0  5995  2
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_19.png
early stop counter: 1
val acc:0.9862175583839417, best validation acc: 0.9883993268013, corresponding to test acc:                         0.9582933783531189 / 0.9677213430404663
after epoch: 19,now: 2024-06-08 17:56:38.432975,epoch time: 0:17:27.062271,used: 5:36:55.078133,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99575263, 'precision': 0.9719585, 'recall': 0.96204066, 'specificity': 0.96204066, 'f1': 0.9669429, 'auroc': 0.99949944, 'binary_precision': 0.94649065, 'binary_recall': 0.92590076, 'binary_specificity': 0.99818057, 'binary_f1_score': 0.9360825}
confusion matrix:
       0     1
0  42244    77
1    109  1362
---- Validation: 
scalar performance:
{'acc': 0.9874415, 'precision': 0.9334477, 'recall': 0.8667389, 'specificity': 0.8667389, 'f1': 0.89709604, 'auroc': 0.98206615, 'binary_precision': 0.87615526, 'binary_recall': 0.7371695, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.80067563}
confusion matrix:
       0    1
0  18082   67
1    169  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.81338143, 'recall': 0.52248824, 'specificity': 0.52248824, 'f1': 0.5325915, 'auroc': 0.91153353, 'binary_precision': 0.6666667, 'binary_recall': 0.04597701, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.086021505}
confusion matrix:
      0   1
0  5991   6
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_20.png
early stop counter: 2
val acc:0.9874414801597595, best validation acc: 0.9883993268013, corresponding to test acc:                         0.9582933783531189 / 0.9677213430404663
after epoch: 20,now: 2024-06-08 18:14:08.860246,epoch time: 0:17:30.427271,used: 5:54:25.505404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99634635, 'precision': 0.96592486, 'recall': 0.9787524, 'specificity': 0.9787524, 'f1': 0.97224474, 'auroc': 0.99951166, 'binary_precision': 0.9332452, 'binary_recall': 0.95989126, 'binary_specificity': 0.9976135, 'binary_f1_score': 0.9463807}
confusion matrix:
       0     1
0  42220   101
1     59  1412
---- Validation: 
scalar performance:
{'acc': 0.987335, 'precision': 0.9075012, 'recall': 0.89893615, 'specificity': 0.89893615, 'f1': 0.9031694, 'auroc': 0.9847951, 'binary_precision': 0.8219396, 'binary_recall': 0.80404353, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.8128931}
confusion matrix:
       0    1
0  18037  112
1    126  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.8015387, 'recall': 0.5467255, 'specificity': 0.5467255, 'f1': 0.57310086, 'auroc': 0.9360473, 'binary_precision': 0.64102566, 'binary_recall': 0.09578544, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.16666666}
confusion matrix:
      0   1
0  5983  14
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_21.png
early stop counter: 3
val acc:0.9873350262641907, best validation acc: 0.9883993268013, corresponding to test acc:                         0.9582933783531189 / 0.9677213430404663
after epoch: 21,now: 2024-06-08 18:31:39.212938,epoch time: 0:17:30.352692,used: 6:11:55.858096,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9969401, 'precision': 0.9752691, 'recall': 0.9777617, 'specificity': 0.9777617, 'f1': 0.9765119, 'auroc': 0.9996047, 'binary_precision': 0.952027, 'binary_recall': 0.95720106, 'binary_specificity': 0.9983223, 'binary_f1_score': 0.95460707}
confusion matrix:
       0     1
0  42249    71
1     63  1409
---- Validation: 
scalar performance:
{'acc': 0.9881865, 'precision': 0.91664815, 'recall': 0.9016272, 'specificity': 0.9016272, 'f1': 0.90898836, 'auroc': 0.9839863, 'binary_precision': 0.84006464, 'binary_recall': 0.8087092, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.82408875}
confusion matrix:
       0    1
0  18050   99
1    123  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.756196, 'recall': 0.5295675, 'specificity': 0.5295675, 'f1': 0.5446211, 'auroc': 0.9268284, 'binary_precision': 0.55172414, 'binary_recall': 0.06130268, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.11034483}
confusion matrix:
      0   1
0  5984  13
1   245  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_22.png
early stop counter: 4
val acc:0.9881864786148071, best validation acc: 0.9883993268013, corresponding to test acc:                         0.9582933783531189 / 0.9677213430404663
after epoch: 22,now: 2024-06-08 18:49:10.322063,epoch time: 0:17:31.109125,used: 6:29:26.967221,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9932636, 'precision': 0.981453, 'recall': 0.9125827, 'specificity': 0.9125827, 'f1': 0.94417304, 'auroc': 0.9988634, 'binary_precision': 0.9689243, 'binary_recall': 0.82608694, 'binary_specificity': 0.99907845, 'binary_f1_score': 0.89182246}
confusion matrix:
       0     1
0  42281    39
1    256  1216
---- Validation: 
scalar performance:
{'acc': 0.9855257, 'precision': 0.95860714, 'recall': 0.8109931, 'specificity': 0.8109931, 'f1': 0.8696456, 'auroc': 0.9803643, 'binary_precision': 0.9303944, 'binary_recall': 0.62363917, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.7467412}
confusion matrix:
       0    1
0  18119   30
1    242  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.91718, 'recall': 0.5133266, 'specificity': 0.5133266, 'f1': 0.5156116, 'auroc': 0.88601553, 'binary_precision': 0.875, 'binary_recall': 0.026819924, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.052044608}
confusion matrix:
      0  1
0  5996  1
1   254  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_23.png
early stop counter: 5
val acc:0.9855257272720337, best validation acc: 0.9883993268013, corresponding to test acc:                         0.9582933783531189 / 0.9677213430404663
after epoch: 23,now: 2024-06-08 19:06:41.792606,epoch time: 0:17:31.470543,used: 6:46:58.437764,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9969629, 'precision': 0.9838501, 'recall': 0.9689213, 'specificity': 0.9689213, 'f1': 0.97625995, 'auroc': 0.9993131, 'binary_precision': 0.96982455, 'binary_recall': 0.9388587, 'binary_specificity': 0.9989839, 'binary_f1_score': 0.95409036}
confusion matrix:
       0     1
0  42277    43
1     90  1382
---- Validation: 
scalar performance:
{'acc': 0.9878672, 'precision': 0.9386289, 'recall': 0.86845946, 'specificity': 0.86845946, 'f1': 0.9002583, 'auroc': 0.9826866, 'binary_precision': 0.88640594, 'binary_recall': 0.7402799, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.8067796}
confusion matrix:
       0    1
0  18088   61
1    167  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8345965, 'recall': 0.53198344, 'specificity': 0.53198344, 'f1': 0.5493883, 'auroc': 0.91889036, 'binary_precision': 0.7083333, 'binary_recall': 0.0651341, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.11929825}
confusion matrix:
      0   1
0  5990   7
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_24.png
early stop counter: 6
val acc:0.9878671765327454, best validation acc: 0.9883993268013, corresponding to test acc:                         0.9582933783531189 / 0.9677213430404663
after epoch: 24,now: 2024-06-08 19:23:54.193671,epoch time: 0:17:12.401065,used: 7:04:10.838829,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9970543, 'precision': 0.97080934, 'recall': 0.98469615, 'specificity': 0.98469615, 'f1': 0.97764397, 'auroc': 0.9996701, 'binary_precision': 0.9426121, 'binary_recall': 0.971448, 'binary_specificity': 0.9979443, 'binary_f1_score': 0.95681286}
confusion matrix:
       0     1
0  42234    87
1     42  1429
---- Validation: 
scalar performance:
{'acc': 0.9870157, 'precision': 0.91257, 'recall': 0.8852699, 'specificity': 0.8852699, 'f1': 0.8984144, 'auroc': 0.9809165, 'binary_precision': 0.8330551, 'binary_recall': 0.7760498, 'binary_specificity': 0.99449, 'binary_f1_score': 0.80354273}
confusion matrix:
       0    1
0  18049  100
1    144  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.78049135, 'recall': 0.53348225, 'specificity': 0.53348225, 'f1': 0.55142623, 'auroc': 0.90833306, 'binary_precision': 0.6, 'binary_recall': 0.06896552, 'binary_specificity': 0.997999, 'binary_f1_score': 0.12371134}
confusion matrix:
      0   1
0  5985  12
1   243  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_25.png
early stop counter: 7
val acc:0.9870157241821289, best validation acc: 0.9883993268013, corresponding to test acc:                         0.9582933783531189 / 0.9677213430404663
after epoch: 25,now: 2024-06-08 19:41:05.197253,epoch time: 0:17:11.003582,used: 7:21:21.842411,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99588966, 'precision': 0.98509693, 'recall': 0.9506284, 'specificity': 0.9506284, 'f1': 0.96718085, 'auroc': 0.9994935, 'binary_precision': 0.9735877, 'binary_recall': 0.9021074, 'binary_specificity': 0.9991494, 'binary_f1_score': 0.9364856}
confusion matrix:
       0     1
0  42285    36
1    144  1327
---- Validation: 
scalar performance:
{'acc': 0.9853129, 'precision': 0.9332485, 'recall': 0.8296343, 'specificity': 0.8296343, 'f1': 0.8738742, 'auroc': 0.980178, 'binary_precision': 0.8783505, 'binary_recall': 0.66251945, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.7553192}
confusion matrix:
       0    1
0  18090   59
1    217  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.8428042, 'recall': 0.5395629, 'specificity': 0.5395629, 'f1': 0.5622715, 'auroc': 0.9191021, 'binary_precision': 0.7241379, 'binary_recall': 0.08045977, 'binary_specificity': 0.998666, 'binary_f1_score': 0.14482759}
confusion matrix:
      0   1
0  5989   8
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_26.png
early stop counter: 8
val acc:0.9853128790855408, best validation acc: 0.9883993268013, corresponding to test acc:                         0.9582933783531189 / 0.9677213430404663
after epoch: 26,now: 2024-06-08 19:58:14.841616,epoch time: 0:17:09.644363,used: 7:38:31.486774,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9962322, 'precision': 0.95409274, 'recall': 0.9918169, 'specificity': 0.9918169, 'f1': 0.9721421, 'auroc': 0.99973345, 'binary_precision': 0.9086358, 'binary_recall': 0.9870836, 'binary_specificity': 0.9965502, 'binary_f1_score': 0.94623655}
confusion matrix:
       0     1
0  42175   146
1     19  1452
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.89465547, 'recall': 0.905301, 'specificity': 0.905301, 'f1': 0.8999013, 'auroc': 0.98429096, 'binary_precision': 0.79576397, 'binary_recall': 0.81804043, 'binary_specificity': 0.9925616, 'binary_f1_score': 0.8067485}
confusion matrix:
       0    1
0  18014  135
1    117  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.78527087, 'recall': 0.56329983, 'specificity': 0.56329983, 'f1': 0.5970498, 'auroc': 0.9181128, 'binary_precision': 0.60714287, 'binary_recall': 0.1302682, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.21451104}
confusion matrix:
      0   1
0  5975  22
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_27.png
early stop counter: 9
val acc:0.9865900278091431, best validation acc: 0.9883993268013, corresponding to test acc:                         0.9582933783531189 / 0.9677213430404663
after epoch: 27,now: 2024-06-08 20:15:29.737786,epoch time: 0:17:14.896170,used: 7:55:46.382944,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99805903, 'precision': 0.98398805, 'recall': 0.9862093, 'specificity': 0.9862093, 'f1': 0.9850959, 'auroc': 0.99978614, 'binary_precision': 0.9688979, 'binary_recall': 0.97350544, 'binary_specificity': 0.99891305, 'binary_f1_score': 0.9711962}
confusion matrix:
       0     1
0  42274    46
1     39  1433
---- Validation: 
scalar performance:
{'acc': 0.9886122, 'precision': 0.93646526, 'recall': 0.8838462, 'specificity': 0.8838462, 'f1': 0.90833557, 'auroc': 0.9841987, 'binary_precision': 0.8809947, 'binary_recall': 0.7713841, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.8225539}
confusion matrix:
       0    1
0  18082   67
1    147  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.814288, 'recall': 0.54497653, 'specificity': 0.54497653, 'f1': 0.57061905, 'auroc': 0.9455467, 'binary_precision': 0.6666667, 'binary_recall': 0.09195402, 'binary_specificity': 0.997999, 'binary_f1_score': 0.16161616}
confusion matrix:
      0   1
0  5985  12
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_28.png
better model found
persisted
after epoch: 28,now: 2024-06-08 20:32:46.496159,epoch time: 0:17:16.758373,used: 8:13:03.141317,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99803615, 'precision': 0.99025136, 'recall': 0.9793124, 'specificity': 0.9793124, 'f1': 0.9847156, 'auroc': 0.9998802, 'binary_precision': 0.98191935, 'binary_recall': 0.9592391, 'binary_specificity': 0.99938565, 'binary_f1_score': 0.97044677}
confusion matrix:
       0     1
0  42294    26
1     60  1412
---- Validation: 
scalar performance:
{'acc': 0.9882397, 'precision': 0.9452114, 'recall': 0.8679022, 'specificity': 0.8679022, 'f1': 0.9026016, 'auroc': 0.98354906, 'binary_precision': 0.8996212, 'binary_recall': 0.7387247, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.8112724}
confusion matrix:
       0    1
0  18096   53
1    168  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.9177147, 'recall': 0.5266532, 'specificity': 0.5266532, 'f1': 0.5403691, 'auroc': 0.9336808, 'binary_precision': 0.875, 'binary_recall': 0.053639848, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.10108303}
confusion matrix:
      0   1
0  5995   2
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_29.png
early stop counter: 1
val acc:0.9882397055625916, best validation acc: 0.988612174987793, corresponding to test acc:                         0.960210919380188 / 0.9677213430404663
after epoch: 29,now: 2024-06-08 20:50:17.812261,epoch time: 0:17:31.316102,used: 8:30:34.457419,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99723697, 'precision': 0.9680536, 'recall': 0.9910296, 'specificity': 0.9910296, 'f1': 0.9792448, 'auroc': 0.99978983, 'binary_precision': 0.9366516, 'binary_recall': 0.984375, 'binary_specificity': 0.9976843, 'binary_f1_score': 0.95992047}
confusion matrix:
       0     1
0  42222    98
1     23  1449
---- Validation: 
scalar performance:
{'acc': 0.9875479, 'precision': 0.905331, 'recall': 0.90654695, 'specificity': 0.90654695, 'f1': 0.905938, 'auroc': 0.9812323, 'binary_precision': 0.8170543, 'binary_recall': 0.81959563, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.818323}
confusion matrix:
       0    1
0  18031  118
1    116  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.85129416, 'recall': 0.5641336, 'specificity': 0.5641336, 'f1': 0.6009613, 'auroc': 0.93079305, 'binary_precision': 0.73913044, 'binary_recall': 0.1302682, 'binary_specificity': 0.997999, 'binary_f1_score': 0.22149837}
confusion matrix:
      0   1
0  5985  12
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_30.png
early stop counter: 2
val acc:0.9875478744506836, best validation acc: 0.988612174987793, corresponding to test acc:                         0.960210919380188 / 0.9677213430404663
after epoch: 30,now: 2024-06-08 21:07:44.363821,epoch time: 0:17:26.551560,used: 8:48:01.008979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_43_seed_0_21256730
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:48:01.008979 at 2024-06-08 21:07:44.363821
persisted model performance metric: 

scalar performance:
{'acc': 0.9603707, 'precision': 0.8035517, 'recall': 0.5542216, 'specificity': 0.5542216, 'f1': 0.5846156, 'auroc': 0.94814336, 'binary_precision': 0.64444447, 'binary_recall': 0.11111111, 'binary_specificity': 0.997332, 'binary_f1_score': 0.1895425}
confusion matrix:
      0   1
0  5981  16
1   232  29
oracle model performance metric: 

scalar performance:
{'acc': 0.96676254, 'precision': 0.8688197, 'recall': 0.6436762, 'specificity': 0.6436762, 'f1': 0.70255566, 'auroc': 0.95906174, 'binary_precision': 0.7676768, 'binary_recall': 0.29118773, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.42222223}
confusion matrix:
      0   1
0  5974  23
1   185  76
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1716 MiB |   3247 MiB |    877 TiB |    877 TiB |
|       from large pool |   1710 MiB |   3240 MiB |    865 TiB |    865 TiB |
|       from small pool |      6 MiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1716 MiB |   3247 MiB |    877 TiB |    877 TiB |
|       from large pool |   1710 MiB |   3240 MiB |    865 TiB |    865 TiB |
|       from small pool |      6 MiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1700 MiB |   3232 MiB |    874 TiB |    874 TiB |
|       from large pool |   1695 MiB |   3225 MiB |    863 TiB |    863 TiB |
|       from small pool |      5 MiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3538 MiB |   3538 MiB |   3538 MiB |      0 B   |
|       from large pool |   3526 MiB |   3526 MiB |   3526 MiB |      0 B   |
|       from small pool |     12 MiB |     12 MiB |     12 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 251358 KiB | 316407 KiB | 444216 GiB | 444215 GiB |
|       from large pool | 247808 KiB | 313088 KiB | 432720 GiB | 432720 GiB |
|       from small pool |   3550 KiB |   3881 KiB |  11495 GiB |  11495 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6337    |  140613 K  |  140610 K  |
|       from large pool |     247    |     352    |   54298 K  |   54298 K  |
|       from small pool |    3119    |    6089    |   86314 K  |   86311 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6337    |  140613 K  |  140610 K  |
|       from large pool |     247    |     352    |   54298 K  |   54298 K  |
|       from small pool |    3119    |    6089    |   86314 K  |   86311 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     138    |     138    |     138    |       0    |
|       from large pool |     132    |     132    |     132    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      95    |    2823    |   67287 K  |   67287 K  |
|       from large pool |      77    |     116    |   28630 K  |   28630 K  |
|       from small pool |      18    |    2746    |   38656 K  |   38656 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   3247 MiB |    877 TiB |    877 TiB |
|       from large pool |  65536 KiB |   3240 MiB |    865 TiB |    865 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   3247 MiB |    877 TiB |    877 TiB |
|       from large pool |  65536 KiB |   3240 MiB |    865 TiB |    865 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   3232 MiB |    874 TiB |    874 TiB |
|       from large pool |  65536 KiB |   3225 MiB |    863 TiB |    863 TiB |
|       from small pool |      0 KiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1962 MiB |   3538 MiB |   3538 MiB |   1576 MiB |
|       from large pool |   1952 MiB |   3526 MiB |   3526 MiB |   1574 MiB |
|       from small pool |     10 MiB |     12 MiB |     12 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 316407 KiB | 444217 GiB | 444217 GiB |
|       from large pool |      0 B   | 313088 KiB | 432721 GiB | 432721 GiB |
|       from small pool |      0 B   |   9339 KiB |  11495 GiB |  11495 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6337    |  140613 K  |  140613 K  |
|       from large pool |       2    |     352    |   54298 K  |   54298 K  |
|       from small pool |       0    |    6089    |   86314 K  |   86314 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6337    |  140613 K  |  140613 K  |
|       from large pool |       2    |     352    |   54298 K  |   54298 K  |
|       from small pool |       0    |    6089    |   86314 K  |   86314 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     138    |     138    |      45    |
|       from large pool |      88    |     132    |     132    |      44    |
|       from small pool |       5    |       6    |       6    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2823    |   67288 K  |   67288 K  |
|       from large pool |       0    |     116    |   28630 K  |   28630 K  |
|       from small pool |       0    |    2746    |   38658 K  |   38658 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   3247 MiB |    877 TiB |    877 TiB |
|       from large pool |  65536 KiB |   3240 MiB |    865 TiB |    865 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   3247 MiB |    877 TiB |    877 TiB |
|       from large pool |  65536 KiB |   3240 MiB |    865 TiB |    865 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   3232 MiB |    874 TiB |    874 TiB |
|       from large pool |  65536 KiB |   3225 MiB |    863 TiB |    863 TiB |
|       from small pool |      0 KiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1962 MiB |   3538 MiB |   3538 MiB |   1576 MiB |
|       from large pool |   1952 MiB |   3526 MiB |   3526 MiB |   1574 MiB |
|       from small pool |     10 MiB |     12 MiB |     12 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 316407 KiB | 444217 GiB | 444217 GiB |
|       from large pool |      0 B   | 313088 KiB | 432721 GiB | 432721 GiB |
|       from small pool |      0 B   |   9339 KiB |  11495 GiB |  11495 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6337    |  140613 K  |  140613 K  |
|       from large pool |       2    |     352    |   54298 K  |   54298 K  |
|       from small pool |       0    |    6089    |   86314 K  |   86314 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6337    |  140613 K  |  140613 K  |
|       from large pool |       2    |     352    |   54298 K  |   54298 K  |
|       from small pool |       0    |    6089    |   86314 K  |   86314 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     138    |     138    |      45    |
|       from large pool |      88    |     132    |     132    |      44    |
|       from small pool |       5    |       6    |       6    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2823    |   67288 K  |   67288 K  |
|       from large pool |       0    |     116    |   28630 K  |   28630 K  |
|       from small pool |       0    |    2746    |   38658 K  |   38658 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_21_15_01_seed_1_21256730

 Experiment start at: 2024-06-08 21:15:01.505459
before training, model accuracy: 0.06461489200592041
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9758072, 'precision': 0.8535986, 'recall': 0.70914716, 'specificity': 0.70914716, 'f1': 0.7614205, 'auroc': 0.9668213, 'binary_precision': 0.72651607, 'binary_recall': 0.42371705, 'binary_specificity': 0.9945773, 'binary_f1_score': 0.5352606}
confusion matrix:
       0    1
0  42184  230
1    831  611
---- Validation: 
scalar performance:
{'acc': 0.9738527, 'precision': 0.8417086, 'recall': 0.7318042, 'specificity': 0.7318042, 'f1': 0.77528954, 'auroc': 0.9670271, 'binary_precision': 0.70288247, 'binary_recall': 0.47102526, 'binary_specificity': 0.99258316, 'binary_f1_score': 0.56405693}
confusion matrix:
       0    1
0  17933  134
1    356  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.8549677, 'recall': 0.5227406, 'specificity': 0.5227406, 'f1': 0.53309596, 'auroc': 0.9506229, 'binary_precision': 0.75, 'binary_recall': 0.046153847, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.08695652}
confusion matrix:
      0   1
0  5942   4
1   248  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256730_1.png
[Sat Jun  8 21:33:05 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/rule_results/4.csv

RuleException:
RuntimeError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[enforce fail at inline_container.cc:595] . unexpected pos 111700224 vs 111700048
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 49, in tr_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 70, in after_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 60, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/a_model_sel.py", line 63, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/c_msel_oracle.py", line 37, in base_update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model.py", line 159, in save
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_utils.py", line 88, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 627, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 475, in __exit__
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
