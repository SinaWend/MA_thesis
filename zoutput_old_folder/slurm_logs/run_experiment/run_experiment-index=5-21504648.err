Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jun 18 19:43:11 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648

 Experiment start at: 2024-06-18 20:01:53.736003
before training, model accuracy: 0.31563422083854675
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95229125, 'precision': 0.97302306, 'recall': 0.74847734, 'specificity': 0.74847734, 'f1': 0.8187839, 'auroc': 0.95772135, 'binary_precision': 0.99591464, 'binary_recall': 0.49716747, 'binary_specificity': 0.99978715, 'binary_f1_score': 0.6632407}
confusion matrix:
       0     1
0  42278     9
1   2219  2194
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.85796785, 'recall': 0.50230527, 'specificity': 0.50230527, 'f1': 0.49595985, 'auroc': 0.5771456, 'binary_precision': 0.75, 'binary_recall': 0.00466563, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.009273571}
confusion matrix:
       0  1
0  18148  1
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8842183, 'precision': 0.4422396, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.46927592, 'auroc': 0.63908535, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   783  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-18 20:20:16.998054,epoch time: 0:18:23.262051,used: 0:18:23.262051,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9743255, 'precision': 0.98085535, 'recall': 0.8680671, 'specificity': 0.8680671, 'f1': 0.91521764, 'auroc': 0.9799769, 'binary_precision': 0.98845685, 'binary_recall': 0.73703283, 'binary_specificity': 0.99910134, 'binary_f1_score': 0.84442717}
confusion matrix:
       0     1
0  42247    38
1   1161  3254
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.76504433, 'recall': 0.5272224, 'specificity': 0.5272224, 'f1': 0.54230964, 'auroc': 0.6720056, 'binary_precision': 0.5625, 'binary_recall': 0.05598756, 'binary_specificity': 0.9984572, 'binary_f1_score': 0.10183875}
confusion matrix:
       0   1
0  18121  28
1    607  36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88923305, 'precision': 0.8487778, 'recall': 0.5259862, 'specificity': 0.5259862, 'f1': 0.5207906, 'auroc': 0.711866, 'binary_precision': 0.8076923, 'binary_recall': 0.053639848, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.10059881}
confusion matrix:
      0   1
0  5987  10
1   741  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-18 20:42:44.945927,epoch time: 0:22:27.947873,used: 0:40:51.209924,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98154175, 'precision': 0.98119104, 'recall': 0.9095389, 'specificity': 0.9095389, 'f1': 0.9417764, 'auroc': 0.9875342, 'binary_precision': 0.98077446, 'binary_recall': 0.82075685, 'binary_specificity': 0.998321, 'binary_f1_score': 0.893659}
confusion matrix:
       0     1
0  42216    71
1    791  3622
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.7592784, 'recall': 0.56869584, 'specificity': 0.56869584, 'f1': 0.60395974, 'auroc': 0.7239386, 'binary_precision': 0.5481928, 'binary_recall': 0.1415241, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.22496909}
confusion matrix:
       0   1
0  18074  75
1    552  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8963127, 'precision': 0.86013347, 'recall': 0.56329983, 'specificity': 0.56329983, 'f1': 0.5846787, 'auroc': 0.7513751, 'binary_precision': 0.82258064, 'binary_recall': 0.1302682, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.22491731}
confusion matrix:
      0    1
0  5975   22
1   681  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-18 21:06:01.712396,epoch time: 0:23:16.766469,used: 1:04:07.976393,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98280513, 'precision': 0.97799486, 'recall': 0.91972184, 'specificity': 0.91972184, 'f1': 0.94649506, 'auroc': 0.98863256, 'binary_precision': 0.972244, 'binary_recall': 0.8419501, 'binary_specificity': 0.9974935, 'binary_f1_score': 0.90241826}
confusion matrix:
       0     1
0  42184   106
1    697  3713
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.76709807, 'recall': 0.5884727, 'specificity': 0.5884727, 'f1': 0.62908685, 'auroc': 0.7415768, 'binary_precision': 0.5625, 'binary_recall': 0.18195957, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.27497065}
confusion matrix:
       0    1
0  18058   91
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89882004, 'precision': 0.8568667, 'recall': 0.5780419, 'specificity': 0.5780419, 'f1': 0.60715365, 'auroc': 0.7455684, 'binary_precision': 0.8129032, 'binary_recall': 0.16091955, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.26865673}
confusion matrix:
      0    1
0  5968   29
1   657  126
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-18 21:23:48.132425,epoch time: 0:17:46.420029,used: 1:21:54.396422,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9851392, 'precision': 0.98183686, 'recall': 0.9300333, 'specificity': 0.9300333, 'f1': 0.95409524, 'auroc': 0.99009573, 'binary_precision': 0.977875, 'binary_recall': 0.86210024, 'binary_specificity': 0.99796647, 'binary_f1_score': 0.91634524}
confusion matrix:
       0     1
0  42205    86
1    608  3801
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.76780033, 'recall': 0.579417, 'specificity': 0.579417, 'f1': 0.618238, 'auroc': 0.75615084, 'binary_precision': 0.5645161, 'binary_recall': 0.16329704, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.25331724}
confusion matrix:
       0    1
0  18068   81
1    538  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9026549, 'precision': 0.8757961, 'recall': 0.59353435, 'specificity': 0.59353435, 'f1': 0.63005954, 'auroc': 0.7645619, 'binary_precision': 0.84745765, 'binary_recall': 0.19157088, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.3125}
confusion matrix:
      0    1
0  5970   27
1   633  150
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_5.png
new oracle model saved
early stop counter: 1
val acc:0.9670604467391968, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.8988200426101685 / 0.9026548862457275
after epoch: 5,now: 2024-06-18 21:46:02.324235,epoch time: 0:22:14.191810,used: 1:44:08.588232,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9863812, 'precision': 0.9791246, 'recall': 0.94001603, 'specificity': 0.94001603, 'f1': 0.95852625, 'auroc': 0.9909599, 'binary_precision': 0.9703612, 'binary_recall': 0.8828461, 'binary_specificity': 0.9971859, 'binary_f1_score': 0.92453724}
confusion matrix:
       0     1
0  42168   119
1    517  3896
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7569202, 'recall': 0.59278023, 'specificity': 0.59278023, 'f1': 0.63288116, 'auroc': 0.7819034, 'binary_precision': 0.5418502, 'binary_recall': 0.19129083, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.2827586}
confusion matrix:
       0    1
0  18045  104
1    520  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90176994, 'precision': 0.8618597, 'recall': 0.593034, 'specificity': 0.593034, 'f1': 0.6288383, 'auroc': 0.78547895, 'binary_precision': 0.8196721, 'binary_recall': 0.19157088, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.310559}
confusion matrix:
      0    1
0  5964   33
1   633  150
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_6.png
early stop counter: 2
val acc:0.9667943716049194, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.8988200426101685 / 0.9026548862457275
after epoch: 6,now: 2024-06-18 22:07:58.850942,epoch time: 0:21:56.526707,used: 2:06:05.114939,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98747325, 'precision': 0.9812577, 'recall': 0.94443834, 'specificity': 0.94443834, 'f1': 0.96192926, 'auroc': 0.9927577, 'binary_precision': 0.9737429, 'binary_recall': 0.89138323, 'binary_specificity': 0.9974935, 'binary_f1_score': 0.93074465}
confusion matrix:
       0     1
0  42184   106
1    479  3931
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.76607746, 'recall': 0.5952508, 'specificity': 0.5952508, 'f1': 0.6367726, 'auroc': 0.7967473, 'binary_precision': 0.56, 'binary_recall': 0.19595645, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.29032257}
confusion matrix:
       0    1
0  18050   99
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90294987, 'precision': 0.8806532, 'recall': 0.59370106, 'specificity': 0.59370106, 'f1': 0.63046926, 'auroc': 0.79928756, 'binary_precision': 0.85714287, 'binary_recall': 0.19157088, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.31315243}
confusion matrix:
      0    1
0  5972   25
1   633  150
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-18 22:28:09.334468,epoch time: 0:20:10.483526,used: 2:26:15.598465,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9879229, 'precision': 0.98306024, 'recall': 0.9454217, 'specificity': 0.9454217, 'f1': 0.96328413, 'auroc': 0.9934249, 'binary_precision': 0.97718257, 'binary_recall': 0.893019, 'binary_specificity': 0.99782443, 'binary_f1_score': 0.93320704}
confusion matrix:
       0     1
0  42196    92
1    472  3940
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.76875025, 'recall': 0.58775026, 'specificity': 0.58775026, 'f1': 0.6284083, 'auroc': 0.7811793, 'binary_precision': 0.56585366, 'binary_recall': 0.18040435, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.2735849}
confusion matrix:
       0    1
0  18060   89
1    527  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89719766, 'precision': 0.85101676, 'recall': 0.5704624, 'specificity': 0.5704624, 'f1': 0.59566116, 'auroc': 0.77155554, 'binary_precision': 0.8028169, 'binary_recall': 0.14559387, 'binary_specificity': 0.995331, 'binary_f1_score': 0.24648649}
confusion matrix:
      0    1
0  5969   28
1   669  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_8.png
early stop counter: 1
val acc:0.9672200679779053, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.902949869632721 / 0.902949869632721
after epoch: 8,now: 2024-06-18 22:51:42.962884,epoch time: 0:23:33.628416,used: 2:49:49.226881,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98832977, 'precision': 0.97637415, 'recall': 0.95449686, 'specificity': 0.95449686, 'f1': 0.9651115, 'auroc': 0.9948933, 'binary_precision': 0.96180475, 'binary_recall': 0.91277754, 'binary_specificity': 0.99621624, 'binary_f1_score': 0.93665004}
confusion matrix:
       0     1
0  42126   160
1    385  4029
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.7465309, 'recall': 0.62333965, 'specificity': 0.62333965, 'f1': 0.66239715, 'auroc': 0.80689406, 'binary_precision': 0.51898736, 'binary_recall': 0.25505444, 'binary_specificity': 0.9916249, 'binary_f1_score': 0.34202296}
confusion matrix:
       0    1
0  17997  152
1    479  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.909882, 'precision': 0.8756199, 'recall': 0.63259697, 'specificity': 0.63259697, 'f1': 0.68100506, 'auroc': 0.8052492, 'binary_precision': 0.8385827, 'binary_recall': 0.27203065, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.41080037}
confusion matrix:
      0    1
0  5956   41
1   570  213
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_9.png
new oracle model saved
early stop counter: 2
val acc:0.966421902179718, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.902949869632721 / 0.9098820090293884
after epoch: 9,now: 2024-06-18 23:14:38.822371,epoch time: 0:22:55.859487,used: 3:12:45.086368,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9886938, 'precision': 0.9849694, 'recall': 0.948205, 'specificity': 0.948205, 'f1': 0.96567893, 'auroc': 0.994753, 'binary_precision': 0.9804649, 'binary_recall': 0.8982782, 'binary_specificity': 0.99813175, 'binary_f1_score': 0.9375739}
confusion matrix:
       0     1
0  42207    79
1    449  3965
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.77127063, 'recall': 0.5983888, 'specificity': 0.5983888, 'f1': 0.6409324, 'auroc': 0.8027934, 'binary_precision': 0.5701754, 'binary_recall': 0.2021773, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.29850745}
confusion matrix:
       0    1
0  18051   98
1    513  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8979351, 'precision': 0.8526921, 'recall': 0.57421046, 'specificity': 0.57421046, 'f1': 0.6013559, 'auroc': 0.80214155, 'binary_precision': 0.80536914, 'binary_recall': 0.1532567, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.25751072}
confusion matrix:
      0    1
0  5968   29
1   663  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_10.png
better model found
persisted
after epoch: 10,now: 2024-06-18 23:33:34.638552,epoch time: 0:18:55.816181,used: 3:31:40.902549,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9901499, 'precision': 0.9845526, 'recall': 0.9571984, 'specificity': 0.9571984, 'f1': 0.9703763, 'auroc': 0.99509436, 'binary_precision': 0.9777509, 'binary_recall': 0.9165722, 'binary_specificity': 0.9978245, 'binary_f1_score': 0.94617367}
confusion matrix:
       0     1
0  42197    92
1    368  4043
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.755746, 'recall': 0.5987807, 'specificity': 0.5987807, 'f1': 0.6393537, 'auroc': 0.8050541, 'binary_precision': 0.5390946, 'binary_recall': 0.2037325, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.29571107}
confusion matrix:
       0    1
0  18037  112
1    512  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9001475, 'precision': 0.8570926, 'recall': 0.5854546, 'specificity': 0.5854546, 'f1': 0.61795574, 'auroc': 0.7910514, 'binary_precision': 0.8117647, 'binary_recall': 0.17624521, 'binary_specificity': 0.994664, 'binary_f1_score': 0.28961176}
confusion matrix:
      0    1
0  5965   32
1   645  138
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_11.png
early stop counter: 1
val acc:0.9667943716049194, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.8979350924491882 / 0.9098820090293884
after epoch: 11,now: 2024-06-18 23:56:58.876980,epoch time: 0:23:24.238428,used: 3:55:05.140977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98944324, 'precision': 0.9853464, 'recall': 0.9522394, 'specificity': 0.9522394, 'f1': 0.9680594, 'auroc': 0.99437904, 'binary_precision': 0.98038256, 'binary_recall': 0.90637046, 'binary_specificity': 0.99810827, 'binary_f1_score': 0.94192487}
confusion matrix:
       0     1
0  42209    80
1    413  3998
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.76368546, 'recall': 0.6035014, 'specificity': 0.6035014, 'f1': 0.64553887, 'auroc': 0.8123389, 'binary_precision': 0.55465585, 'binary_recall': 0.21306376, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.30786517}
confusion matrix:
       0    1
0  18039  110
1    506  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8960177, 'precision': 0.83478373, 'recall': 0.56812984, 'specificity': 0.56812984, 'f1': 0.591838, 'auroc': 0.797982, 'binary_precision': 0.7708333, 'binary_recall': 0.14176245, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.23948221}
confusion matrix:
      0    1
0  5964   33
1   672  111
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_12.png
early stop counter: 2
val acc:0.9672200679779053, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.8979350924491882 / 0.9098820090293884
after epoch: 12,now: 2024-06-19 00:17:27.953677,epoch time: 0:20:29.076697,used: 4:15:34.217674,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99139184, 'precision': 0.98580074, 'recall': 0.9633908, 'specificity': 0.9633908, 'f1': 0.974263, 'auroc': 0.9953555, 'binary_precision': 0.9789876, 'binary_recall': 0.9288627, 'binary_specificity': 0.9979189, 'binary_f1_score': 0.9532667}
confusion matrix:
       0     1
0  42198    88
1    314  4100
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.75366145, 'recall': 0.59797555, 'specificity': 0.59797555, 'f1': 0.6381978, 'auroc': 0.81184685, 'binary_precision': 0.5349794, 'binary_recall': 0.2021773, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.29345372}
confusion matrix:
       0    1
0  18036  113
1    513  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89483774, 'precision': 0.82394576, 'recall': 0.5641317, 'specificity': 0.5641317, 'f1': 0.5855487, 'auroc': 0.7940242, 'binary_precision': 0.75, 'binary_recall': 0.13409962, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.22751898}
confusion matrix:
      0    1
0  5962   35
1   678  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_13.png
early stop counter: 3
val acc:0.9666879773139954, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.8979350924491882 / 0.9098820090293884
after epoch: 13,now: 2024-06-19 00:36:34.255214,epoch time: 0:19:06.301537,used: 4:34:40.519211,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9922484, 'precision': 0.9879991, 'recall': 0.9662615, 'specificity': 0.9662615, 'f1': 0.97681904, 'auroc': 0.9962564, 'binary_precision': 0.98282033, 'binary_recall': 0.93422544, 'binary_specificity': 0.9982975, 'binary_f1_score': 0.95790696}
confusion matrix:
       0     1
0  42219    72
1    290  4119
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.7486458, 'recall': 0.5940875, 'specificity': 0.5940875, 'f1': 0.6332882, 'auroc': 0.81528986, 'binary_precision': 0.5252101, 'binary_recall': 0.19440125, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.28376845}
confusion matrix:
       0    1
0  18036  113
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8951327, 'precision': 0.824141, 'recall': 0.565964, 'specificity': 0.565964, 'f1': 0.58836424, 'auroc': 0.78883106, 'binary_precision': 0.75, 'binary_recall': 0.13793103, 'binary_specificity': 0.993997, 'binary_f1_score': 0.2330097}
confusion matrix:
      0    1
0  5961   36
1   675  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_14.png
early stop counter: 4
val acc:0.966421902179718, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.8979350924491882 / 0.9098820090293884
after epoch: 14,now: 2024-06-19 01:00:07.260795,epoch time: 0:23:33.005581,used: 4:58:13.524792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.990621, 'precision': 0.9873818, 'recall': 0.9572554, 'specificity': 0.9572554, 'f1': 0.9717156, 'auroc': 0.99654496, 'binary_precision': 0.98345095, 'binary_recall': 0.9161188, 'binary_specificity': 0.99839205, 'binary_f1_score': 0.94859153}
confusion matrix:
       0     1
0  42221    68
1    370  4041
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.76657146, 'recall': 0.58241725, 'specificity': 0.58241725, 'f1': 0.6218046, 'auroc': 0.81579983, 'binary_precision': 0.5618557, 'binary_recall': 0.16951789, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.260454}
confusion matrix:
       0    1
0  18064   85
1    534  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8943953, 'precision': 0.86351335, 'recall': 0.5522225, 'specificity': 0.5522225, 'f1': 0.56678027, 'auroc': 0.7909219, 'binary_precision': 0.83168316, 'binary_recall': 0.107279696, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.19004524}
confusion matrix:
      0   1
0  5980  17
1   699  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_15.png
early stop counter: 5
val acc:0.9670604467391968, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.8979350924491882 / 0.9098820090293884
after epoch: 15,now: 2024-06-19 01:22:26.784228,epoch time: 0:22:19.523433,used: 5:20:33.048225,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9907923, 'precision': 0.98477364, 'recall': 0.9607934, 'specificity': 0.9607934, 'f1': 0.97240114, 'auroc': 0.99621993, 'binary_precision': 0.9774472, 'binary_recall': 0.9238095, 'binary_specificity': 0.9977772, 'binary_f1_score': 0.9498717}
confusion matrix:
       0     1
0  42196    94
1    336  4074
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.7481935, 'recall': 0.5985879, 'specificity': 0.5985879, 'f1': 0.63809776, 'auroc': 0.82457465, 'binary_precision': 0.524, 'binary_recall': 0.2037325, 'binary_specificity': 0.9934432, 'binary_f1_score': 0.29339308}
confusion matrix:
       0    1
0  18030  119
1    512  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8951327, 'precision': 0.824141, 'recall': 0.565964, 'specificity': 0.565964, 'f1': 0.58836424, 'auroc': 0.8023968, 'binary_precision': 0.75, 'binary_recall': 0.13793103, 'binary_specificity': 0.993997, 'binary_f1_score': 0.2330097}
confusion matrix:
      0    1
0  5961   36
1   675  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_16.png
early stop counter: 6
val acc:0.966421902179718, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.8979350924491882 / 0.9098820090293884
after epoch: 16,now: 2024-06-19 01:47:12.753053,epoch time: 0:24:45.968825,used: 5:45:19.017050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9917773, 'precision': 0.9888534, 'recall': 0.9626658, 'specificity': 0.9626658, 'f1': 0.975307, 'auroc': 0.9970224, 'binary_precision': 0.9852977, 'binary_recall': 0.92677397, 'binary_specificity': 0.99855757, 'binary_f1_score': 0.9551402}
confusion matrix:
       0     1
0  42228    61
1    323  4088
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7609131, 'recall': 0.5868349, 'specificity': 0.5868349, 'f1': 0.6265098, 'auroc': 0.82700855, 'binary_precision': 0.5502392, 'binary_recall': 0.17884915, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.26995304}
confusion matrix:
       0    1
0  18055   94
1    528  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8918879, 'precision': 0.822006, 'recall': 0.5458083, 'specificity': 0.5458083, 'f1': 0.5560271, 'auroc': 0.807447, 'binary_precision': 0.75, 'binary_recall': 0.09578544, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.16987543}
confusion matrix:
      0   1
0  5972  25
1   708  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_17.png
early stop counter: 7
val acc:0.9669008255004883, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.8979350924491882 / 0.9098820090293884
after epoch: 17,now: 2024-06-19 02:07:23.105594,epoch time: 0:20:10.352541,used: 6:05:29.369591,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99149895, 'precision': 0.98952264, 'recall': 0.96034455, 'specificity': 0.96034455, 'f1': 0.97437143, 'auroc': 0.9960363, 'binary_precision': 0.9871234, 'binary_recall': 0.92194235, 'binary_specificity': 0.9987468, 'binary_f1_score': 0.95342016}
confusion matrix:
       0     1
0  42240    53
1    344  4063
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7695067, 'recall': 0.5756667, 'specificity': 0.5756667, 'f1': 0.6136818, 'auroc': 0.8217542, 'binary_precision': 0.5681818, 'binary_recall': 0.15552099, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.24420024}
confusion matrix:
       0    1
0  18073   76
1    543  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8918879, 'precision': 0.83869815, 'recall': 0.5424772, 'specificity': 0.5424772, 'f1': 0.550336, 'auroc': 0.79227924, 'binary_precision': 0.78409094, 'binary_recall': 0.08812261, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.1584386}
confusion matrix:
      0   1
0  5978  19
1   714  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_18.png
early stop counter: 8
val acc:0.9670604467391968, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.8979350924491882 / 0.9098820090293884
after epoch: 18,now: 2024-06-19 02:31:39.371213,epoch time: 0:24:16.265619,used: 6:29:45.635210,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9912848, 'precision': 0.9866474, 'recall': 0.96186095, 'specificity': 0.96186095, 'f1': 0.97384727, 'auroc': 0.9950862, 'binary_precision': 0.9810051, 'binary_recall': 0.92558986, 'binary_specificity': 0.99813205, 'binary_f1_score': 0.9524921}
confusion matrix:
       0     1
0  42213    79
1    328  4080
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.7537738, 'recall': 0.5904474, 'specificity': 0.5904474, 'f1': 0.62987006, 'auroc': 0.81916213, 'binary_precision': 0.53571427, 'binary_recall': 0.1866252, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.27681664}
confusion matrix:
       0    1
0  18045  104
1    523  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8923304, 'precision': 0.8127793, 'recall': 0.5510552, 'specificity': 0.5510552, 'f1': 0.5647147, 'auroc': 0.787428, 'binary_precision': 0.7304348, 'binary_recall': 0.107279696, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.1870824}
confusion matrix:
      0   1
0  5966  31
1   699  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_19.png
early stop counter: 9
val acc:0.9666347503662109, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.8979350924491882 / 0.9098820090293884
after epoch: 19,now: 2024-06-19 02:51:08.775397,epoch time: 0:19:29.404184,used: 6:49:15.039394,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9922912, 'precision': 0.98865354, 'recall': 0.96589386, 'specificity': 0.96589386, 'f1': 0.97693264, 'auroc': 0.9970329, 'binary_precision': 0.9842219, 'binary_recall': 0.9333484, 'binary_specificity': 0.9984393, 'binary_f1_score': 0.95811033}
confusion matrix:
       0     1
0  42223    66
1    294  4117
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.7581882, 'recall': 0.576974, 'specificity': 0.576974, 'f1': 0.6143755, 'auroc': 0.82154405, 'binary_precision': 0.54545456, 'binary_recall': 0.15863141, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.24578315}
confusion matrix:
       0    1
0  18064   85
1    541  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89056045, 'precision': 0.802251, 'recall': 0.5417268, 'specificity': 0.5417268, 'f1': 0.5491504, 'auroc': 0.78616476, 'binary_precision': 0.7113402, 'binary_recall': 0.08812261, 'binary_specificity': 0.995331, 'binary_f1_score': 0.1568182}
confusion matrix:
      0   1
0  5969  28
1   714  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_20.png
early stop counter: 10
val acc:0.9666879773139954, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.8979350924491882 / 0.9098820090293884
after epoch: 20,now: 2024-06-19 03:05:08.660526,epoch time: 0:13:59.885129,used: 7:03:14.924523,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99218416, 'precision': 0.98714507, 'recall': 0.9667777, 'specificity': 0.9667777, 'f1': 0.9766878, 'auroc': 0.99663067, 'binary_precision': 0.9809976, 'binary_recall': 0.93544734, 'binary_specificity': 0.9981081, 'binary_f1_score': 0.9576811}
confusion matrix:
       0     1
0  42205    80
1    285  4130
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7615713, 'recall': 0.58911264, 'specificity': 0.58911264, 'f1': 0.6292354, 'auroc': 0.8231124, 'binary_precision': 0.55140185, 'binary_recall': 0.18351477, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.27537924}
confusion matrix:
       0    1
0  18053   96
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89070797, 'precision': 0.8059639, 'recall': 0.54181015, 'specificity': 0.54181015, 'f1': 0.54928136, 'auroc': 0.7912053, 'binary_precision': 0.71875, 'binary_recall': 0.08812261, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.1569966}
confusion matrix:
      0   1
0  5970  27
1   714  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_21.png
early stop counter: 11
val acc:0.9669540524482727, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.8979350924491882 / 0.9098820090293884
after epoch: 21,now: 2024-06-19 03:20:19.485932,epoch time: 0:15:10.825406,used: 7:18:25.749929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99252677, 'precision': 0.99037313, 'recall': 0.96561784, 'specificity': 0.96561784, 'f1': 0.977593, 'auroc': 0.996457, 'binary_precision': 0.98775214, 'binary_recall': 0.93244165, 'binary_specificity': 0.998794, 'binary_f1_score': 0.9593003}
confusion matrix:
       0     1
0  42238    51
1    298  4113
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.7775117, 'recall': 0.57352674, 'specificity': 0.57352674, 'f1': 0.6115394, 'auroc': 0.81688166, 'binary_precision': 0.58433735, 'binary_recall': 0.15085536, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.23980223}
confusion matrix:
       0   1
0  18080  69
1    546  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8899705, 'precision': 0.81597507, 'recall': 0.534731, 'specificity': 0.534731, 'f1': 0.536909, 'auroc': 0.780826, 'binary_precision': 0.74025977, 'binary_recall': 0.07279693, 'binary_specificity': 0.996665, 'binary_f1_score': 0.13255814}
confusion matrix:
      0   1
0  5977  20
1   726  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_22.png
early stop counter: 12
val acc:0.9672732949256897, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.8979350924491882 / 0.9098820090293884
after epoch: 22,now: 2024-06-19 03:30:22.483009,epoch time: 0:10:02.997077,used: 7:28:28.747006,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9930621, 'precision': 0.9880091, 'recall': 0.97107875, 'specificity': 0.97107875, 'f1': 0.97935593, 'auroc': 0.99668777, 'binary_precision': 0.98183537, 'binary_recall': 0.94397825, 'binary_specificity': 0.99817926, 'binary_f1_score': 0.9625347}
confusion matrix:
       0     1
0  42214    77
1    247  4162
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.76554585, 'recall': 0.5929731, 'specificity': 0.5929731, 'f1': 0.6341249, 'auroc': 0.83668053, 'binary_precision': 0.5590909, 'binary_recall': 0.19129083, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.28505215}
confusion matrix:
       0    1
0  18052   97
1    520  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89056045, 'precision': 0.802251, 'recall': 0.5417268, 'specificity': 0.5417268, 'f1': 0.5491504, 'auroc': 0.79490495, 'binary_precision': 0.7113402, 'binary_recall': 0.08812261, 'binary_specificity': 0.995331, 'binary_f1_score': 0.1568182}
confusion matrix:
      0   1
0  5969  28
1   714  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_23.png
early stop counter: 13
val acc:0.9671669006347656, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.8979350924491882 / 0.9098820090293884
after epoch: 23,now: 2024-06-19 03:40:55.577153,epoch time: 0:10:33.094144,used: 7:39:01.841150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99233407, 'precision': 0.9918529, 'recall': 0.9630581, 'specificity': 0.9630581, 'f1': 0.976911, 'auroc': 0.99690735, 'binary_precision': 0.9912685, 'binary_recall': 0.92696756, 'binary_specificity': 0.9991487, 'binary_f1_score': 0.95804036}
confusion matrix:
       0     1
0  42255    36
1    322  4087
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.78332055, 'recall': 0.5705816, 'specificity': 0.5705816, 'f1': 0.6080633, 'auroc': 0.8232514, 'binary_precision': 0.59615386, 'binary_recall': 0.14463453, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.23279098}
confusion matrix:
       0   1
0  18086  63
1    550  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88908553, 'precision': 0.8046013, 'recall': 0.5308995, 'specificity': 0.5308995, 'f1': 0.5301267, 'auroc': 0.78886443, 'binary_precision': 0.7183099, 'binary_recall': 0.0651341, 'binary_specificity': 0.996665, 'binary_f1_score': 0.11943794}
confusion matrix:
      0   1
0  5977  20
1   732  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_24.png
early stop counter: 14
val acc:0.9673797488212585, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.8979350924491882 / 0.9098820090293884
after epoch: 24,now: 2024-06-19 03:50:49.380809,epoch time: 0:09:53.803656,used: 7:48:55.644806,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9919272, 'precision': 0.9896866, 'recall': 0.9627485, 'specificity': 0.9627485, 'f1': 0.97573936, 'auroc': 0.9964634, 'binary_precision': 0.9869628, 'binary_recall': 0.92677397, 'binary_specificity': 0.9987231, 'binary_f1_score': 0.9559219}
confusion matrix:
       0     1
0  42235    54
1    323  4088
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7662812, 'recall': 0.58316725, 'specificity': 0.58316725, 'f1': 0.62268555, 'auroc': 0.82554543, 'binary_precision': 0.56122446, 'binary_recall': 0.1710731, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.26221693}
confusion matrix:
       0    1
0  18063   86
1    533  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8896755, 'precision': 0.78656256, 'recall': 0.539561, 'specificity': 0.539561, 'f1': 0.54550475, 'auroc': 0.7902706, 'binary_precision': 0.68041235, 'binary_recall': 0.08429119, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.15}
confusion matrix:
      0   1
0  5966  31
1   717  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_25.png
early stop counter: 15
val acc:0.9670604467391968, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.8979350924491882 / 0.9098820090293884
after epoch: 25,now: 2024-06-19 04:00:21.955789,epoch time: 0:09:32.574980,used: 7:58:28.219786,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99197, 'precision': 0.9881387, 'recall': 0.96450603, 'specificity': 0.96450603, 'f1': 0.97595394, 'auroc': 0.9965941, 'binary_precision': 0.98347306, 'binary_recall': 0.9306437, 'binary_specificity': 0.9983683, 'binary_f1_score': 0.95632935}
confusion matrix:
       0     1
0  42219    69
1    306  4106
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.76241964, 'recall': 0.5906403, 'specificity': 0.5906403, 'f1': 0.63109356, 'auroc': 0.8270118, 'binary_precision': 0.5529954, 'binary_recall': 0.1866252, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.27906978}
confusion matrix:
       0    1
0  18052   97
1    523  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89100295, 'precision': 0.8067814, 'recall': 0.5436425, 'specificity': 0.5436425, 'f1': 0.55239296, 'auroc': 0.79427004, 'binary_precision': 0.72, 'binary_recall': 0.09195402, 'binary_specificity': 0.995331, 'binary_f1_score': 0.16308042}
confusion matrix:
      0   1
0  5969  28
1   711  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_26.png
early stop counter: 16
val acc:0.9670072197914124, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.8979350924491882 / 0.9098820090293884
after epoch: 26,now: 2024-06-19 04:11:31.554552,epoch time: 0:11:09.598763,used: 8:09:37.818549,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9919486, 'precision': 0.98822737, 'recall': 0.96428335, 'specificity': 0.96428335, 'f1': 0.97587717, 'auroc': 0.99608135, 'binary_precision': 0.98369694, 'binary_recall': 0.9301746, 'binary_specificity': 0.99839205, 'binary_f1_score': 0.95618737}
confusion matrix:
       0     1
0  42221    68
1    308  4103
---- Validation: 
scalar performance:
{'acc': 0.967699, 'precision': 0.7836012, 'recall': 0.58499795, 'specificity': 0.58499795, 'f1': 0.62651956, 'auroc': 0.8272319, 'binary_precision': 0.59574467, 'binary_recall': 0.17418352, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.26955473}
confusion matrix:
       0    1
0  18073   76
1    531  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8883481, 'precision': 0.78093207, 'recall': 0.53048265, 'specificity': 0.53048265, 'f1': 0.5295706, 'auroc': 0.79196686, 'binary_precision': 0.67105263, 'binary_recall': 0.0651341, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.11874273}
confusion matrix:
      0   1
0  5972  25
1   732  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_27.png
better model found
persisted
after epoch: 27,now: 2024-06-19 04:21:23.219454,epoch time: 0:09:51.664902,used: 8:19:29.483451,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9928908, 'precision': 0.9895532, 'recall': 0.9685671, 'specificity': 0.9685671, 'f1': 0.9787712, 'auroc': 0.9971514, 'binary_precision': 0.9854831, 'binary_recall': 0.93857664, 'binary_specificity': 0.9985575, 'binary_f1_score': 0.96145815}
confusion matrix:
       0     1
0  42227    61
1    271  4141
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.76181525, 'recall': 0.6019462, 'specificity': 0.6019462, 'f1': 0.6436065, 'auroc': 0.8354591, 'binary_precision': 0.5510204, 'binary_recall': 0.20995334, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.30405405}
confusion matrix:
       0    1
0  18039  110
1    508  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89277285, 'precision': 0.81084496, 'recall': 0.55463654, 'specificity': 0.55463654, 'f1': 0.57049984, 'auroc': 0.80443287, 'binary_precision': 0.7258065, 'binary_recall': 0.11494253, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.19845644}
confusion matrix:
      0   1
0  5963  34
1   693  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_28.png
early stop counter: 1
val acc:0.9671136736869812, best validation acc: 0.9676989912986755, corresponding to test acc:                         0.8883481025695801 / 0.9098820090293884
after epoch: 28,now: 2024-06-19 04:32:39.916650,epoch time: 0:11:16.697196,used: 8:30:46.180647,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99329764, 'precision': 0.99126655, 'recall': 0.9692992, 'specificity': 0.9692992, 'f1': 0.97996736, 'auroc': 0.9973776, 'binary_precision': 0.98879087, 'binary_recall': 0.9397099, 'binary_specificity': 0.99888855, 'binary_f1_score': 0.96362585}
confusion matrix:
       0     1
0  42241    47
1    266  4146
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.77143705, 'recall': 0.5847776, 'specificity': 0.5847776, 'f1': 0.62512374, 'auroc': 0.8166094, 'binary_precision': 0.5714286, 'binary_recall': 0.17418352, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.26698452}
confusion matrix:
       0    1
0  18065   84
1    531  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8886431, 'precision': 0.783097, 'recall': 0.532315, 'specificity': 0.532315, 'f1': 0.53284097, 'auroc': 0.77994215, 'binary_precision': 0.675, 'binary_recall': 0.06896552, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.12514484}
confusion matrix:
      0   1
0  5971  26
1   729  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_29.png
early stop counter: 2
val acc:0.9672732949256897, best validation acc: 0.9676989912986755, corresponding to test acc:                         0.8883481025695801 / 0.9098820090293884
after epoch: 29,now: 2024-06-19 04:44:11.926599,epoch time: 0:11:32.009949,used: 8:42:18.190596,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9938544, 'precision': 0.99223477, 'recall': 0.9716493, 'specificity': 0.9716493, 'f1': 0.9816658, 'auroc': 0.9982794, 'binary_precision': 0.990259, 'binary_recall': 0.9442682, 'binary_specificity': 0.9990304, 'binary_f1_score': 0.96671695}
confusion matrix:
       0     1
0  42245    41
1    246  4168
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.7771124, 'recall': 0.5939711, 'specificity': 0.5939711, 'f1': 0.63658273, 'auroc': 0.8358214, 'binary_precision': 0.58215964, 'binary_recall': 0.19284603, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.2897196}
confusion matrix:
       0    1
0  18060   89
1    519  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88893807, 'precision': 0.7917671, 'recall': 0.5324818, 'specificity': 0.5324818, 'f1': 0.5330698, 'auroc': 0.79432565, 'binary_precision': 0.6923077, 'binary_recall': 0.06896552, 'binary_specificity': 0.995998, 'binary_f1_score': 0.12543555}
confusion matrix:
      0   1
0  5973  24
1   729  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_30.png
early stop counter: 3
val acc:0.9676458239555359, best validation acc: 0.9676989912986755, corresponding to test acc:                         0.8883481025695801 / 0.9098820090293884
after epoch: 30,now: 2024-06-19 04:54:06.075170,epoch time: 0:09:54.148571,used: 8:52:12.339167,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:52:12.339167 at 2024-06-19 04:54:06.075170
persisted model performance metric: 

scalar performance:
{'acc': 0.8883481, 'precision': 0.78093207, 'recall': 0.53048265, 'specificity': 0.53048265, 'f1': 0.5295706, 'auroc': 0.79196686, 'binary_precision': 0.67105263, 'binary_recall': 0.0651341, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.11874273}
confusion matrix:
      0   1
0  5972  25
1   732  51
oracle model performance metric: 

scalar performance:
{'acc': 0.909882, 'precision': 0.8756199, 'recall': 0.63259697, 'specificity': 0.63259697, 'f1': 0.68100506, 'auroc': 0.8052492, 'binary_precision': 0.8385827, 'binary_recall': 0.27203065, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.41080037}
confusion matrix:
      0    1
0  5956   41
1   570  213
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204211 KiB |   1436 MiB | 428252 GiB | 428252 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 428173 GiB | 428173 GiB |
|       from small pool |  36275 KiB |     72 MiB |     78 GiB |     78 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204211 KiB |   1436 MiB | 428252 GiB | 428252 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 428173 GiB | 428173 GiB |
|       from small pool |  36275 KiB |     72 MiB |     78 GiB |     78 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201112 KiB |   1428 MiB | 428227 GiB | 428227 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 428151 GiB | 428151 GiB |
|       from small pool |  35992 KiB |     71 MiB |     75 GiB |     75 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320076 KiB | 628877 KiB | 319528 GiB | 319528 GiB |
|       from large pool | 311296 KiB | 627520 KiB | 319443 GiB | 319443 GiB |
|       from small pool |   8780 KiB |  12547 KiB |     85 GiB |     85 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1308    |    1965    |   14080 K  |   14078 K  |
|       from large pool |      36    |      76    |    5616 K  |    5616 K  |
|       from small pool |    1272    |    1894    |    8463 K  |    8462 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1308    |    1965    |   14080 K  |   14078 K  |
|       from large pool |      36    |      76    |    5616 K  |    5616 K  |
|       from small pool |    1272    |    1894    |    8463 K  |    8462 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |     479    |    7460 K  |    7460 K  |
|       from large pool |       5    |      10    |    2087 K  |    2087 K  |
|       from small pool |      26    |     474    |    5373 K  |    5373 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 428252 GiB | 428252 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 428173 GiB | 428173 GiB |
|       from small pool |      0 KiB |     72 MiB |     78 GiB |     78 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 428252 GiB | 428252 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 428173 GiB | 428173 GiB |
|       from small pool |      0 KiB |     72 MiB |     78 GiB |     78 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 428227 GiB | 428227 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 428151 GiB | 428151 GiB |
|       from small pool |      0 KiB |     71 MiB |     75 GiB |     75 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 628877 KiB | 319528 GiB | 319528 GiB |
|       from large pool | 298752 KiB | 627520 KiB | 319443 GiB | 319443 GiB |
|       from small pool |      0 KiB |  16375 KiB |     85 GiB |     85 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1965    |   14080 K  |   14080 K  |
|       from large pool |       2    |      76    |    5616 K  |    5616 K  |
|       from small pool |       0    |    1894    |    8463 K  |    8463 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1965    |   14080 K  |   14080 K  |
|       from large pool |       2    |      76    |    5616 K  |    5616 K  |
|       from small pool |       0    |    1894    |    8463 K  |    8463 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     479    |    7461 K  |    7461 K  |
|       from large pool |       1    |      11    |    2087 K  |    2087 K  |
|       from small pool |       0    |     474    |    5373 K  |    5373 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 428252 GiB | 428252 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 428173 GiB | 428173 GiB |
|       from small pool |      0 KiB |     72 MiB |     78 GiB |     78 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 428252 GiB | 428252 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 428173 GiB | 428173 GiB |
|       from small pool |      0 KiB |     72 MiB |     78 GiB |     78 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 428227 GiB | 428227 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 428151 GiB | 428151 GiB |
|       from small pool |      0 KiB |     71 MiB |     75 GiB |     75 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 628877 KiB | 319528 GiB | 319528 GiB |
|       from large pool | 298752 KiB | 627520 KiB | 319443 GiB | 319443 GiB |
|       from small pool |      0 KiB |  16375 KiB |     85 GiB |     85 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1965    |   14080 K  |   14080 K  |
|       from large pool |       2    |      76    |    5616 K  |    5616 K  |
|       from small pool |       0    |    1894    |    8463 K  |    8463 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1965    |   14080 K  |   14080 K  |
|       from large pool |       2    |      76    |    5616 K  |    5616 K  |
|       from small pool |       0    |    1894    |    8463 K  |    8463 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     479    |    7461 K  |    7461 K  |
|       from large pool |       1    |      11    |    2087 K  |    2087 K  |
|       from small pool |       0    |     474    |    5373 K  |    5373 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648

 Experiment start at: 2024-06-19 04:59:19.657871
before training, model accuracy: 0.2048765867948532
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9468094, 'precision': 0.9323075, 'recall': 0.7319753, 'specificity': 0.7319753, 'f1': 0.7956195, 'auroc': 0.9468291, 'binary_precision': 0.91628957, 'binary_recall': 0.46831638, 'binary_specificity': 0.9956343, 'binary_f1_score': 0.6198347}
confusion matrix:
       0     1
0  42191   185
1   2299  2025
---- Validation: 
scalar performance:
{'acc': 0.9636606, 'precision': 0.56541896, 'recall': 0.50120914, 'specificity': 0.50120914, 'f1': 0.49366572, 'auroc': 0.53875744, 'binary_precision': 0.16666667, 'binary_recall': 0.0029717681, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.005839416}
confusion matrix:
       0   1
0  18057  10
1    671   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88403213, 'precision': 0.44201607, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4692235, 'auroc': 0.54407036, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   780  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 05:09:11.378019,epoch time: 0:09:51.720148,used: 0:09:51.720148,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9717773, 'precision': 0.97930825, 'recall': 0.85140246, 'specificity': 0.85140246, 'f1': 0.903307, 'auroc': 0.9790201, 'binary_precision': 0.9879831, 'binary_recall': 0.703678, 'binary_specificity': 0.9991269, 'binary_f1_score': 0.82194}
confusion matrix:
       0     1
0  42340    37
1   1281  3042
---- Validation: 
scalar performance:
{'acc': 0.96542156, 'precision': 0.8189025, 'recall': 0.53573996, 'specificity': 0.53573996, 'f1': 0.5568635, 'auroc': 0.6711824, 'binary_precision': 0.6712329, 'binary_recall': 0.07280832, 'binary_specificity': 0.9986716, 'binary_f1_score': 0.1313673}
confusion matrix:
       0   1
0  18043  24
1    624  49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8846268, 'precision': 0.7639941, 'recall': 0.5053488, 'specificity': 0.5053488, 'f1': 0.4806825, 'auroc': 0.7115035, 'binary_precision': 0.64285713, 'binary_recall': 0.011538462, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.022670027}
confusion matrix:
      0  1
0  5941  5
1   771  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-19 05:19:00.048780,epoch time: 0:09:48.670761,used: 0:19:40.390909,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9782441, 'precision': 0.97890794, 'recall': 0.889734, 'specificity': 0.889734, 'f1': 0.9286711, 'auroc': 0.9838164, 'binary_precision': 0.9796866, 'binary_recall': 0.7811198, 'binary_specificity': 0.9983482, 'binary_f1_score': 0.869207}
confusion matrix:
       0     1
0  42308    70
1    946  3376
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.78776497, 'recall': 0.5616279, 'specificity': 0.5616279, 'f1': 0.59578294, 'auroc': 0.71443146, 'binary_precision': 0.60714287, 'binary_recall': 0.12630014, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.20910208}
confusion matrix:
       0   1
0  18012  55
1    588  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8975617, 'precision': 0.8900943, 'recall': 0.56613046, 'specificity': 0.56613046, 'f1': 0.58935285, 'auroc': 0.7415942, 'binary_precision': 0.88235295, 'binary_recall': 0.13461539, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.23359288}
confusion matrix:
      0    1
0  5932   14
1   675  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-19 05:28:26.878367,epoch time: 0:09:26.829587,used: 0:29:07.220496,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98314774, 'precision': 0.981426, 'recall': 0.9168307, 'specificity': 0.9168307, 'f1': 0.94624734, 'auroc': 0.9888849, 'binary_precision': 0.97938144, 'binary_recall': 0.83545476, 'binary_specificity': 0.9982067, 'binary_f1_score': 0.901711}
confusion matrix:
       0     1
0  42303    76
1    711  3610
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.7761395, 'recall': 0.5817108, 'specificity': 0.5817108, 'f1': 0.6215808, 'auroc': 0.7497125, 'binary_precision': 0.58247423, 'binary_recall': 0.1679049, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.26066896}
confusion matrix:
       0    1
0  17986   81
1    560  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90172464, 'precision': 0.89797044, 'recall': 0.58519304, 'specificity': 0.58519304, 'f1': 0.6186097, 'auroc': 0.78795147, 'binary_precision': 0.89403975, 'binary_recall': 0.17307693, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.29001072}
confusion matrix:
      0    1
0  5930   16
1   645  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-19 05:37:49.018493,epoch time: 0:09:22.140126,used: 0:38:29.360622,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98520344, 'precision': 0.9846562, 'recall': 0.9262935, 'specificity': 0.9262935, 'f1': 0.9531539, 'auroc': 0.9891399, 'binary_precision': 0.98400426, 'binary_recall': 0.8540028, 'binary_specificity': 0.99858415, 'binary_f1_score': 0.91440606}
confusion matrix:
       0     1
0  42318    60
1    631  3691
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.795998, 'recall': 0.5813276, 'specificity': 0.5813276, 'f1': 0.62271476, 'auroc': 0.7620063, 'binary_precision': 0.62222224, 'binary_recall': 0.16641901, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.26260257}
confusion matrix:
       0    1
0  17999   68
1    561  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90306276, 'precision': 0.90156865, 'recall': 0.59096223, 'specificity': 0.59096223, 'f1': 0.6271365, 'auroc': 0.7812873, 'binary_precision': 0.9, 'binary_recall': 0.18461539, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.30638298}
confusion matrix:
      0    1
0  5930   16
1   636  144
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-19 05:47:34.158428,epoch time: 0:09:45.139935,used: 0:48:14.500557,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98558885, 'precision': 0.9807688, 'recall': 0.9321004, 'specificity': 0.9321004, 'f1': 0.95481956, 'auroc': 0.99024904, 'binary_precision': 0.975, 'binary_recall': 0.8664661, 'binary_specificity': 0.9977347, 'binary_f1_score': 0.9175346}
confusion matrix:
       0     1
0  42283    96
1    577  3744
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.78435355, 'recall': 0.6021257, 'specificity': 0.6021257, 'f1': 0.64654315, 'auroc': 0.780933, 'binary_precision': 0.59745765, 'binary_recall': 0.20950966, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.31023103}
confusion matrix:
       0    1
0  17972   95
1    532  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9124294, 'precision': 0.8956331, 'recall': 0.6397009, 'specificity': 0.6397009, 'f1': 0.69119436, 'auroc': 0.79542804, 'binary_precision': 0.8774704, 'binary_recall': 0.2846154, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.4298161}
confusion matrix:
      0    1
0  5915   31
1   558  222
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-19 06:00:41.730734,epoch time: 0:13:07.572306,used: 1:01:22.072863,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9865525, 'precision': 0.9801165, 'recall': 0.9385823, 'specificity': 0.9385823, 'f1': 0.9581785, 'auroc': 0.99216926, 'binary_precision': 0.9723856, 'binary_recall': 0.8797132, 'binary_specificity': 0.9974514, 'binary_f1_score': 0.9237309}
confusion matrix:
       0     1
0  42269   108
1    520  3803
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.785566, 'recall': 0.5862238, 'specificity': 0.5862238, 'f1': 0.62797916, 'auroc': 0.7896857, 'binary_precision': 0.6010101, 'binary_recall': 0.1768202, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.27324912}
confusion matrix:
       0    1
0  17988   79
1    554  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9051442, 'precision': 0.9043, 'recall': 0.60049355, 'specificity': 0.60049355, 'f1': 0.6407898, 'auroc': 0.8068126, 'binary_precision': 0.90340906, 'binary_recall': 0.20384616, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.33263597}
confusion matrix:
      0    1
0  5929   17
1   621  159
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_7.png
early stop counter: 1
val acc:0.9662219882011414, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9124293923377991 / 0.9124293923377991
after epoch: 7,now: 2024-06-19 06:12:44.713433,epoch time: 0:12:02.982699,used: 1:13:25.055562,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9886081, 'precision': 0.98262966, 'recall': 0.9486471, 'specificity': 0.9486471, 'f1': 0.96486425, 'auroc': 0.99318576, 'binary_precision': 0.9754201, 'binary_recall': 0.89960676, 'binary_specificity': 0.9976874, 'binary_f1_score': 0.9359807}
confusion matrix:
       0     1
0  42279    98
1    434  3889
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.7856255, 'recall': 0.6021534, 'specificity': 0.6021534, 'f1': 0.64672786, 'auroc': 0.8023253, 'binary_precision': 0.6, 'binary_recall': 0.20950966, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.31057268}
confusion matrix:
       0    1
0  17973   94
1    532  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90499556, 'precision': 0.889468, 'recall': 0.60375106, 'specificity': 0.60375106, 'f1': 0.64468384, 'auroc': 0.8145741, 'binary_precision': 0.8730159, 'binary_recall': 0.21153846, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.34055728}
confusion matrix:
      0    1
0  5922   24
1   615  165
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_8.png
better model found
persisted
after epoch: 8,now: 2024-06-19 06:23:30.783888,epoch time: 0:10:46.070455,used: 1:24:11.126017,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9880514, 'precision': 0.98411334, 'recall': 0.943887, 'specificity': 0.943887, 'f1': 0.9629134, 'auroc': 0.99405634, 'binary_precision': 0.9793788, 'binary_recall': 0.88968545, 'binary_specificity': 0.99808854, 'binary_f1_score': 0.93237996}
confusion matrix:
       0     1
0  42295    81
1    477  3847
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.78649926, 'recall': 0.60289633, 'specificity': 0.60289633, 'f1': 0.6476706, 'auroc': 0.8083595, 'binary_precision': 0.60169494, 'binary_recall': 0.21099554, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.31243122}
confusion matrix:
       0    1
0  17973   94
1    531  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90677965, 'precision': 0.8940916, 'recall': 0.6114434, 'specificity': 0.6114434, 'f1': 0.65528977, 'auroc': 0.8221063, 'binary_precision': 0.880597, 'binary_recall': 0.22692308, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.36085624}
confusion matrix:
      0    1
0  5922   24
1   603  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_9.png
better model found
persisted
after epoch: 9,now: 2024-06-19 06:34:37.194719,epoch time: 0:11:06.410831,used: 1:35:17.536848,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9894861, 'precision': 0.98270184, 'recall': 0.9539188, 'specificity': 0.9539188, 'f1': 0.9677576, 'auroc': 0.9952835, 'binary_precision': 0.9744986, 'binary_recall': 0.91026825, 'binary_specificity': 0.9975694, 'binary_f1_score': 0.941289}
confusion matrix:
       0     1
0  42273   103
1    388  3936
---- Validation: 
scalar performance:
{'acc': 0.9670224, 'precision': 0.7937759, 'recall': 0.60595113, 'specificity': 0.60595113, 'f1': 0.65199, 'auroc': 0.8069767, 'binary_precision': 0.61603373, 'binary_recall': 0.21693908, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.32087913}
confusion matrix:
       0    1
0  17976   91
1    527  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9027654, 'precision': 0.87710816, 'recall': 0.5958065, 'specificity': 0.5958065, 'f1': 0.63319826, 'auroc': 0.8108143, 'binary_precision': 0.85, 'binary_recall': 0.19615385, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.31875}
confusion matrix:
      0    1
0  5919   27
1   627  153
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_10.png
better model found
persisted
after epoch: 10,now: 2024-06-19 06:45:24.736655,epoch time: 0:10:47.541936,used: 1:46:05.078784,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9894861, 'precision': 0.98483753, 'recall': 0.95180947, 'specificity': 0.95180947, 'f1': 0.96759677, 'auroc': 0.9943154, 'binary_precision': 0.9792292, 'binary_recall': 0.9055774, 'binary_specificity': 0.9980415, 'binary_f1_score': 0.9409643}
confusion matrix:
       0     1
0  42296    83
1    408  3913
---- Validation: 
scalar performance:
{'acc': 0.96707577, 'precision': 0.7975794, 'recall': 0.60240245, 'specificity': 0.60240245, 'f1': 0.6484076, 'auroc': 0.8131845, 'binary_precision': 0.6238938, 'binary_recall': 0.20950966, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.31368187}
confusion matrix:
       0    1
0  17982   85
1    532  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89994055, 'precision': 0.87764657, 'recall': 0.5808423, 'specificity': 0.5808423, 'f1': 0.6116859, 'auroc': 0.8131234, 'binary_precision': 0.8543046, 'binary_recall': 0.16538462, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.2771214}
confusion matrix:
      0    1
0  5924   22
1   651  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_11.png
better model found
persisted
after epoch: 11,now: 2024-06-19 06:55:57.891931,epoch time: 0:10:33.155276,used: 1:56:38.234060,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9893148, 'precision': 0.9853898, 'recall': 0.95031655, 'specificity': 0.95031655, 'f1': 0.967033, 'auroc': 0.9952028, 'binary_precision': 0.9806581, 'binary_recall': 0.9024503, 'binary_specificity': 0.99818283, 'binary_f1_score': 0.9399302}
confusion matrix:
       0     1
0  42297    77
1    422  3904
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.8019321, 'recall': 0.58432704, 'specificity': 0.58432704, 'f1': 0.62699497, 'auroc': 0.8163279, 'binary_precision': 0.6338798, 'binary_recall': 0.17236255, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.27102804}
confusion matrix:
       0    1
0  18000   67
1    557  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8977104, 'precision': 0.8845902, 'recall': 0.56788534, 'specificity': 0.56788534, 'f1': 0.5920543, 'auroc': 0.8149601, 'binary_precision': 0.87096775, 'binary_recall': 0.13846155, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.23893805}
confusion matrix:
      0    1
0  5930   16
1   672  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_12.png
early stop counter: 1
val acc:0.9667022228240967, best validation acc: 0.967075765132904, corresponding to test acc:                         0.899940550327301 / 0.9124293923377991
after epoch: 12,now: 2024-06-19 07:05:40.663285,epoch time: 0:09:42.771354,used: 2:06:21.005414,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98995715, 'precision': 0.9858078, 'recall': 0.9537735, 'specificity': 0.9537735, 'f1': 0.96910894, 'auroc': 0.99534774, 'binary_precision': 0.980798, 'binary_recall': 0.90936416, 'binary_specificity': 0.9981829, 'binary_f1_score': 0.94373125}
confusion matrix:
       0     1
0  42298    77
1    392  3933
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7967528, 'recall': 0.5900492, 'specificity': 0.5900492, 'f1': 0.6336791, 'auroc': 0.81773555, 'binary_precision': 0.6231156, 'binary_recall': 0.18424962, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.28440365}
confusion matrix:
       0    1
0  17992   75
1    549  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89681834, 'precision': 0.8644446, 'recall': 0.5673808, 'specificity': 0.5673808, 'f1': 0.59101427, 'auroc': 0.8199564, 'binary_precision': 0.83076924, 'binary_recall': 0.13846155, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.23736265}
confusion matrix:
      0    1
0  5924   22
1   672  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_13.png
early stop counter: 2
val acc:0.9667022228240967, best validation acc: 0.967075765132904, corresponding to test acc:                         0.899940550327301 / 0.9124293923377991
after epoch: 13,now: 2024-06-19 07:15:23.027089,epoch time: 0:09:42.363804,used: 2:16:03.369218,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99025697, 'precision': 0.9827096, 'recall': 0.95860076, 'specificity': 0.95860076, 'f1': 0.97026896, 'auroc': 0.9949621, 'binary_precision': 0.9735618, 'binary_recall': 0.9197502, 'binary_specificity': 0.99745136, 'binary_f1_score': 0.9458914}
confusion matrix:
       0     1
0  42268   108
1    347  3977
---- Validation: 
scalar performance:
{'acc': 0.96707577, 'precision': 0.79110754, 'recall': 0.6124162, 'specificity': 0.6124162, 'f1': 0.6587662, 'auroc': 0.82829416, 'binary_precision': 0.6102362, 'binary_recall': 0.23031203, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.33441207}
confusion matrix:
       0    1
0  17968   99
1    518  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89919716, 'precision': 0.8639182, 'recall': 0.58042186, 'specificity': 0.58042186, 'f1': 0.6107352, 'auroc': 0.8210059, 'binary_precision': 0.8269231, 'binary_recall': 0.16538462, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.27564102}
confusion matrix:
      0    1
0  5919   27
1   651  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_14.png
early stop counter: 3
val acc:0.967075765132904, best validation acc: 0.967075765132904, corresponding to test acc:                         0.899940550327301 / 0.9124293923377991
after epoch: 14,now: 2024-06-19 07:24:59.124134,epoch time: 0:09:36.097045,used: 2:25:39.466263,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99169165, 'precision': 0.9892949, 'recall': 0.96081835, 'specificity': 0.96081835, 'f1': 0.97452396, 'auroc': 0.99622095, 'binary_precision': 0.98639625, 'binary_recall': 0.92293453, 'binary_specificity': 0.99870217, 'binary_f1_score': 0.9536107}
confusion matrix:
       0     1
0  42324    55
1    333  3988
---- Validation: 
scalar performance:
{'acc': 0.96616864, 'precision': 0.78021944, 'recall': 0.59263355, 'specificity': 0.59263355, 'f1': 0.63515663, 'auroc': 0.82578397, 'binary_precision': 0.58986175, 'binary_recall': 0.19019316, 'binary_specificity': 0.9950739, 'binary_f1_score': 0.28764042}
confusion matrix:
       0    1
0  17978   89
1    545  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8962236, 'precision': 0.8520142, 'recall': 0.56704444, 'specificity': 0.56704444, 'f1': 0.59032655, 'auroc': 0.82559514, 'binary_precision': 0.80597013, 'binary_recall': 0.13846155, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.23632386}
confusion matrix:
      0    1
0  5920   26
1   672  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_15.png
early stop counter: 4
val acc:0.9661686420440674, best validation acc: 0.967075765132904, corresponding to test acc:                         0.899940550327301 / 0.9124293923377991
after epoch: 15,now: 2024-06-19 07:37:31.304221,epoch time: 0:12:32.180087,used: 2:38:11.646350,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9915846, 'precision': 0.9860167, 'recall': 0.96336544, 'specificity': 0.96336544, 'f1': 0.97435313, 'auroc': 0.9962218, 'binary_precision': 0.97926325, 'binary_recall': 0.9287367, 'binary_specificity': 0.99799424, 'binary_f1_score': 0.95333093}
confusion matrix:
       0     1
0  42293    85
1    308  4014
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7873658, 'recall': 0.6036393, 'specificity': 0.6036393, 'f1': 0.64861125, 'auroc': 0.8346154, 'binary_precision': 0.60337555, 'binary_recall': 0.21248142, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.31428573}
confusion matrix:
       0    1
0  17973   94
1    530  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89681834, 'precision': 0.8573295, 'recall': 0.5690516, 'specificity': 0.5690516, 'f1': 0.59349877, 'auroc': 0.8311032, 'binary_precision': 0.8161765, 'binary_recall': 0.1423077, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.24235809}
confusion matrix:
      0    1
0  5921   25
1   669  111
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_16.png
early stop counter: 5
val acc:0.9667022228240967, best validation acc: 0.967075765132904, corresponding to test acc:                         0.899940550327301 / 0.9124293923377991
after epoch: 16,now: 2024-06-19 07:51:36.181117,epoch time: 0:14:04.876896,used: 2:52:16.523246,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99139184, 'precision': 0.9871626, 'recall': 0.9610688, 'specificity': 0.9610688, 'f1': 0.97366714, 'auroc': 0.99639213, 'binary_precision': 0.98204184, 'binary_recall': 0.9238602, 'binary_specificity': 0.9982774, 'binary_f1_score': 0.95206296}
confusion matrix:
       0     1
0  42306    73
1    329  3992
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.7963537, 'recall': 0.5943962, 'specificity': 0.5943962, 'f1': 0.63889456, 'auroc': 0.83157486, 'binary_precision': 0.6220096, 'binary_recall': 0.19316493, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.29478458}
confusion matrix:
       0    1
0  17988   79
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8956289, 'precision': 0.85339826, 'recall': 0.5633665, 'specificity': 0.5633665, 'f1': 0.58460575, 'auroc': 0.82401305, 'binary_precision': 0.8095238, 'binary_recall': 0.13076924, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.22516558}
confusion matrix:
      0    1
0  5922   24
1   678  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_17.png
early stop counter: 6
val acc:0.9668089747428894, best validation acc: 0.967075765132904, corresponding to test acc:                         0.899940550327301 / 0.9124293923377991
after epoch: 17,now: 2024-06-19 08:04:23.876902,epoch time: 0:12:47.695785,used: 3:05:04.219031,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9917559, 'precision': 0.98634064, 'recall': 0.9640832, 'specificity': 0.9640832, 'f1': 0.97488594, 'auroc': 0.99607193, 'binary_precision': 0.9797709, 'binary_recall': 0.93012494, 'binary_specificity': 0.99804145, 'binary_f1_score': 0.95430267}
confusion matrix:
       0     1
0  42295    83
1    302  4020
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7886319, 'recall': 0.6014935, 'specificity': 0.6014935, 'f1': 0.64633703, 'auroc': 0.8364712, 'binary_precision': 0.6060606, 'binary_recall': 0.20802377, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.3097345}
confusion matrix:
       0    1
0  17976   91
1    533  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89414215, 'precision': 0.82355845, 'recall': 0.5625256, 'specificity': 0.5625256, 'f1': 0.58295554, 'auroc': 0.82558846, 'binary_precision': 0.75, 'binary_recall': 0.13076924, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.22270742}
confusion matrix:
      0    1
0  5912   34
1   678  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_18.png
early stop counter: 7
val acc:0.9667022228240967, best validation acc: 0.967075765132904, corresponding to test acc:                         0.899940550327301 / 0.9124293923377991
after epoch: 18,now: 2024-06-19 08:15:42.246991,epoch time: 0:11:18.370089,used: 3:16:22.589120,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99201286, 'precision': 0.9877826, 'recall': 0.9642409, 'specificity': 0.9642409, 'f1': 0.97564787, 'auroc': 0.9969205, 'binary_precision': 0.9826533, 'binary_recall': 0.93015724, 'binary_specificity': 0.9983245, 'binary_f1_score': 0.9556849}
confusion matrix:
       0     1
0  42305    71
1    302  4022
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.78778017, 'recall': 0.602924, 'specificity': 0.602924, 'f1': 0.64785653, 'auroc': 0.8471401, 'binary_precision': 0.6042553, 'binary_recall': 0.21099554, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.31277534}
confusion matrix:
       0    1
0  17974   93
1    531  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.897413, 'precision': 0.8558854, 'recall': 0.5727296, 'specificity': 0.5727296, 'f1': 0.59908503, 'auroc': 0.84112865, 'binary_precision': 0.8125, 'binary_recall': 0.15, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.25324675}
confusion matrix:
      0    1
0  5919   27
1   663  117
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_19.png
early stop counter: 8
val acc:0.9667022228240967, best validation acc: 0.967075765132904, corresponding to test acc:                         0.899940550327301 / 0.9124293923377991
after epoch: 19,now: 2024-06-19 08:29:05.678928,epoch time: 0:13:23.431937,used: 3:29:46.021057,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9920771, 'precision': 0.9885633, 'recall': 0.96382827, 'specificity': 0.96382827, 'f1': 0.97579455, 'auroc': 0.9970968, 'binary_precision': 0.98430604, 'binary_recall': 0.9291667, 'binary_specificity': 0.99848986, 'binary_f1_score': 0.9559419}
confusion matrix:
       0     1
0  42316    64
1    306  4014
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.80119467, 'recall': 0.5923057, 'specificity': 0.5923057, 'f1': 0.63684034, 'auroc': 0.8366089, 'binary_precision': 0.6318408, 'binary_recall': 0.18870728, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.29061782}
confusion matrix:
       0    1
0  17993   74
1    546  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8954802, 'precision': 0.8502034, 'recall': 0.5632824, 'specificity': 0.5632824, 'f1': 0.5844395, 'auroc': 0.824347, 'binary_precision': 0.8031496, 'binary_recall': 0.13076924, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.22491732}
confusion matrix:
      0    1
0  5921   25
1   678  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_20.png
early stop counter: 9
val acc:0.9669156670570374, best validation acc: 0.967075765132904, corresponding to test acc:                         0.899940550327301 / 0.9124293923377991
after epoch: 20,now: 2024-06-19 08:42:19.355066,epoch time: 0:13:13.676138,used: 3:42:59.697195,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99167025, 'precision': 0.98798263, 'recall': 0.961941, 'specificity': 0.961941, 'f1': 0.9745159, 'auroc': 0.99585795, 'binary_precision': 0.9835178, 'binary_recall': 0.92546296, 'binary_specificity': 0.99841905, 'binary_f1_score': 0.95360756}
confusion matrix:
       0     1
0  42313    67
1    322  3998
---- Validation: 
scalar performance:
{'acc': 0.9664888, 'precision': 0.7900952, 'recall': 0.5906538, 'specificity': 0.5906538, 'f1': 0.63379025, 'auroc': 0.83653694, 'binary_precision': 0.6097561, 'binary_recall': 0.18573551, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.28473803}
confusion matrix:
       0    1
0  17987   80
1    548  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89399344, 'precision': 0.85419273, 'recall': 0.5540874, 'specificity': 0.5540874, 'f1': 0.56971097, 'auroc': 0.81821656, 'binary_precision': 0.8130841, 'binary_recall': 0.11153846, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.19616684}
confusion matrix:
      0   1
0  5926  20
1   693  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_21.png
early stop counter: 10
val acc:0.966488778591156, best validation acc: 0.967075765132904, corresponding to test acc:                         0.899940550327301 / 0.9124293923377991
after epoch: 21,now: 2024-06-19 08:55:07.617645,epoch time: 0:12:48.262579,used: 3:55:47.959774,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9926338, 'precision': 0.9881778, 'recall': 0.9675797, 'specificity': 0.9675797, 'f1': 0.9776012, 'auroc': 0.99697584, 'binary_precision': 0.982767, 'binary_recall': 0.9368348, 'binary_specificity': 0.9983246, 'binary_f1_score': 0.95925134}
confusion matrix:
       0     1
0  42307    71
1    273  4049
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.78479385, 'recall': 0.59200126, 'specificity': 0.59200126, 'f1': 0.63488144, 'auroc': 0.84238887, 'binary_precision': 0.5990566, 'binary_recall': 0.18870728, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.28700563}
confusion matrix:
       0    1
0  17982   85
1    546  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89146596, 'precision': 0.8087647, 'recall': 0.5493163, 'specificity': 0.5493163, 'f1': 0.56174666, 'auroc': 0.8265885, 'binary_precision': 0.72321427, 'binary_recall': 0.103846155, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.18161435}
confusion matrix:
      0   1
0  5915  31
1   699  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_22.png
early stop counter: 11
val acc:0.9663286805152893, best validation acc: 0.967075765132904, corresponding to test acc:                         0.899940550327301 / 0.9124293923377991
after epoch: 22,now: 2024-06-19 09:10:12.249215,epoch time: 0:15:04.631570,used: 4:10:52.591344,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9926552, 'precision': 0.9897879, 'recall': 0.96613705, 'specificity': 0.96613705, 'f1': 0.9775969, 'auroc': 0.9970212, 'binary_precision': 0.98631144, 'binary_recall': 0.93359554, 'binary_specificity': 0.99867857, 'binary_f1_score': 0.95922977}
confusion matrix:
       0     1
0  42322    56
1    287  4035
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.7983271, 'recall': 0.59007686, 'specificity': 0.59007686, 'f1': 0.6338563, 'auroc': 0.8371942, 'binary_precision': 0.6262626, 'binary_recall': 0.18424962, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.28473017}
confusion matrix:
       0    1
0  17993   74
1    549  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.892358, 'precision': 0.82928085, 'recall': 0.54982084, 'specificity': 0.54982084, 'f1': 0.5626142, 'auroc': 0.81767917, 'binary_precision': 0.7641509, 'binary_recall': 0.103846155, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.18284425}
confusion matrix:
      0   1
0  5921  25
1   699  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_23.png
early stop counter: 12
val acc:0.9667556285858154, best validation acc: 0.967075765132904, corresponding to test acc:                         0.899940550327301 / 0.9124293923377991
after epoch: 23,now: 2024-06-19 09:23:15.201190,epoch time: 0:13:02.951975,used: 4:23:55.543319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99222696, 'precision': 0.98823905, 'recall': 0.96508574, 'specificity': 0.96508574, 'f1': 0.9763109, 'auroc': 0.99704623, 'binary_precision': 0.9834025, 'binary_recall': 0.9317761, 'binary_specificity': 0.9983953, 'binary_f1_score': 0.9568935}
confusion matrix:
       0     1
0  42308    68
1    295  4029
---- Validation: 
scalar performance:
{'acc': 0.9664888, 'precision': 0.7939402, 'recall': 0.58564687, 'specificity': 0.58564687, 'f1': 0.6279986, 'auroc': 0.8406889, 'binary_precision': 0.6178011, 'binary_recall': 0.17533432, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.27314815}
confusion matrix:
       0    1
0  17994   73
1    555  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89101994, 'precision': 0.8448001, 'recall': 0.53903913, 'specificity': 0.53903913, 'f1': 0.5442376, 'auroc': 0.81885415, 'binary_precision': 0.79746836, 'binary_recall': 0.08076923, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.1466822}
confusion matrix:
      0   1
0  5930  16
1   717  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_24.png
early stop counter: 13
val acc:0.966488778591156, best validation acc: 0.967075765132904, corresponding to test acc:                         0.899940550327301 / 0.9124293923377991
after epoch: 24,now: 2024-06-19 09:43:20.839070,epoch time: 0:20:05.637880,used: 4:44:01.181199,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99203426, 'precision': 0.98747796, 'recall': 0.96466804, 'specificity': 0.96466804, 'f1': 0.9757314, 'auroc': 0.99655044, 'binary_precision': 0.98195124, 'binary_recall': 0.9310823, 'binary_specificity': 0.9982537, 'binary_f1_score': 0.95584047}
confusion matrix:
       0     1
0  42302    74
1    298  4026
---- Validation: 
scalar performance:
{'acc': 0.9669691, 'precision': 0.79484147, 'recall': 0.60234714, 'specificity': 0.60234714, 'f1': 0.64803165, 'auroc': 0.849141, 'binary_precision': 0.6184211, 'binary_recall': 0.20950966, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.31298557}
confusion matrix:
       0    1
0  17980   87
1    532  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.892804, 'precision': 0.8196677, 'recall': 0.5550855, 'specificity': 0.5550855, 'f1': 0.57116616, 'auroc': 0.82959634, 'binary_precision': 0.74380165, 'binary_recall': 0.115384616, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.19977802}
confusion matrix:
      0   1
0  5915  31
1   690  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_25.png
early stop counter: 14
val acc:0.9669690728187561, best validation acc: 0.967075765132904, corresponding to test acc:                         0.899940550327301 / 0.9124293923377991
after epoch: 25,now: 2024-06-19 10:02:24.883071,epoch time: 0:19:04.044001,used: 5:03:05.225200,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9930621, 'precision': 0.9900427, 'recall': 0.9683423, 'specificity': 0.9683423, 'f1': 0.97888535, 'auroc': 0.9969268, 'binary_precision': 0.986378, 'binary_recall': 0.93800604, 'binary_specificity': 0.9986785, 'binary_f1_score': 0.96158403}
confusion matrix:
       0     1
0  42321    56
1    268  4055
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.81065905, 'recall': 0.5830072, 'specificity': 0.5830072, 'f1': 0.62597144, 'auroc': 0.8379439, 'binary_precision': 0.6514286, 'binary_recall': 0.16939078, 'binary_specificity': 0.9966237, 'binary_f1_score': 0.2688679}
confusion matrix:
       0    1
0  18006   61
1    559  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8899792, 'precision': 0.8122881, 'recall': 0.53845054, 'specificity': 0.53845054, 'f1': 0.5433505, 'auroc': 0.81691456, 'binary_precision': 0.73255813, 'binary_recall': 0.08076923, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.14549655}
confusion matrix:
      0   1
0  5923  23
1   717  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_26.png
early stop counter: 15
val acc:0.9669156670570374, best validation acc: 0.967075765132904, corresponding to test acc:                         0.899940550327301 / 0.9124293923377991
after epoch: 26,now: 2024-06-19 10:21:25.596823,epoch time: 0:19:00.713752,used: 5:22:05.938952,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9920985, 'precision': 0.987198, 'recall': 0.9653108, 'specificity': 0.9653108, 'f1': 0.9759399, 'auroc': 0.99723077, 'binary_precision': 0.98125154, 'binary_recall': 0.9324387, 'binary_specificity': 0.998183, 'binary_f1_score': 0.95622253}
confusion matrix:
       0     1
0  42301    77
1    292  4030
---- Validation: 
scalar performance:
{'acc': 0.9669691, 'precision': 0.80620086, 'recall': 0.58875704, 'specificity': 0.58875704, 'f1': 0.63291496, 'auroc': 0.84067297, 'binary_precision': 0.6421053, 'binary_recall': 0.18127786, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.28273463}
confusion matrix:
       0    1
0  17999   68
1    551  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8889384, 'precision': 0.80542177, 'recall': 0.5328495, 'specificity': 0.5328495, 'f1': 0.533508, 'auroc': 0.81042504, 'binary_precision': 0.72, 'binary_recall': 0.06923077, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.12631579}
confusion matrix:
      0   1
0  5925  21
1   726  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_27.png
early stop counter: 16
val acc:0.9669690728187561, best validation acc: 0.967075765132904, corresponding to test acc:                         0.899940550327301 / 0.9124293923377991
after epoch: 27,now: 2024-06-19 10:39:50.673218,epoch time: 0:18:25.076395,used: 5:40:31.015347,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9930621, 'precision': 0.9901432, 'recall': 0.9682096, 'specificity': 0.9682096, 'f1': 0.9788628, 'auroc': 0.99730396, 'binary_precision': 0.9866017, 'binary_recall': 0.9377171, 'binary_specificity': 0.9987022, 'binary_f1_score': 0.96153843}
confusion matrix:
       0     1
0  42326    55
1    269  4050
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.79138744, 'recall': 0.5827028, 'specificity': 0.5827028, 'f1': 0.6240971, 'auroc': 0.8454782, 'binary_precision': 0.61290324, 'binary_recall': 0.16939078, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.2654249}
confusion matrix:
       0    1
0  17995   72
1    559  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89146596, 'precision': 0.8149034, 'recall': 0.54764545, 'specificity': 0.54764545, 'f1': 0.55898947, 'auroc': 0.8273215, 'binary_precision': 0.7358491, 'binary_recall': 0.1, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.17607222}
confusion matrix:
      0   1
0  5918  28
1   702  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_28.png
early stop counter: 17
val acc:0.9663286805152893, best validation acc: 0.967075765132904, corresponding to test acc:                         0.899940550327301 / 0.9124293923377991
after epoch: 28,now: 2024-06-19 10:56:08.233094,epoch time: 0:16:17.559876,used: 5:56:48.575223,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.992955, 'precision': 0.98713267, 'recall': 0.97056824, 'specificity': 0.97056824, 'f1': 0.9786711, 'auroc': 0.9974825, 'binary_precision': 0.98004806, 'binary_recall': 0.9430951, 'binary_specificity': 0.9980414, 'binary_f1_score': 0.9612165}
confusion matrix:
       0     1
0  42294    83
1    246  4077
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.7874971, 'recall': 0.6101597, 'specificity': 0.6101597, 'f1': 0.65583026, 'auroc': 0.84532297, 'binary_precision': 0.6031746, 'binary_recall': 0.22585438, 'binary_specificity': 0.99446505, 'binary_f1_score': 0.32864866}
confusion matrix:
       0    1
0  17967  100
1    521  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89131725, 'precision': 0.7872837, 'recall': 0.5559154, 'specificity': 0.5559154, 'f1': 0.5722593, 'auroc': 0.8131837, 'binary_precision': 0.6788321, 'binary_recall': 0.11923077, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.20283534}
confusion matrix:
      0   1
0  5902  44
1   687  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_29.png
early stop counter: 18
val acc:0.9668623208999634, best validation acc: 0.967075765132904, corresponding to test acc:                         0.899940550327301 / 0.9124293923377991
after epoch: 29,now: 2024-06-19 11:16:26.376566,epoch time: 0:20:18.143472,used: 6:17:06.718695,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9936831, 'precision': 0.98874927, 'recall': 0.9733582, 'specificity': 0.9733582, 'f1': 0.9808996, 'auroc': 0.9974911, 'binary_precision': 0.9827421, 'binary_recall': 0.94841546, 'binary_specificity': 0.99830097, 'binary_f1_score': 0.9652737}
confusion matrix:
       0     1
0  42305    72
1    223  4100
---- Validation: 
scalar performance:
{'acc': 0.9671825, 'precision': 0.7967367, 'recall': 0.6074647, 'specificity': 0.6074647, 'f1': 0.65405005, 'auroc': 0.8436391, 'binary_precision': 0.62184876, 'binary_recall': 0.21991085, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.32491767}
confusion matrix:
       0    1
0  17977   90
1    525  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8899792, 'precision': 0.7831055, 'recall': 0.54680455, 'specificity': 0.54680455, 'f1': 0.5575856, 'auroc': 0.8097106, 'binary_precision': 0.67241377, 'binary_recall': 0.1, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.17410713}
confusion matrix:
      0   1
0  5908  38
1   702  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_30.png
better model found
persisted
after epoch: 30,now: 2024-06-19 11:38:30.880150,epoch time: 0:22:04.503584,used: 6:39:11.222279,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_04_59_19_seed_1_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 6:39:11.222279 at 2024-06-19 11:38:30.880150
persisted model performance metric: 

scalar performance:
{'acc': 0.8899792, 'precision': 0.7831055, 'recall': 0.54680455, 'specificity': 0.54680455, 'f1': 0.5575856, 'auroc': 0.8097106, 'binary_precision': 0.67241377, 'binary_recall': 0.1, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.17410713}
confusion matrix:
      0   1
0  5908  38
1   702  78
oracle model performance metric: 

scalar performance:
{'acc': 0.9124294, 'precision': 0.8956331, 'recall': 0.6397009, 'specificity': 0.6397009, 'f1': 0.69119436, 'auroc': 0.79542804, 'binary_precision': 0.8774704, 'binary_recall': 0.2846154, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.4298161}
confusion matrix:
      0    1
0  5915   31
1   558  222
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204208 KiB |   1436 MiB |    835 TiB |    835 TiB |
|       from large pool | 167936 KiB |   1366 MiB |    835 TiB |    835 TiB |
|       from small pool |  36272 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204208 KiB |   1436 MiB |    835 TiB |    835 TiB |
|       from large pool | 167936 KiB |   1366 MiB |    835 TiB |    835 TiB |
|       from small pool |  36272 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201110 KiB |   1428 MiB |    835 TiB |    835 TiB |
|       from large pool | 165120 KiB |   1358 MiB |    835 TiB |    835 TiB |
|       from small pool |  35990 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   2478 MiB |   1012 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   2374 MiB |    982 MiB |
|       from small pool |     74 MiB |     74 MiB |    104 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320079 KiB | 628877 KiB | 653569 GiB | 653569 GiB |
|       from large pool | 311296 KiB | 627520 KiB | 653399 GiB | 653399 GiB |
|       from small pool |   8783 KiB |  16375 KiB |    170 GiB |    170 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1308    |    1965    |   28161 K  |   28160 K  |
|       from large pool |      36    |      76    |   11233 K  |   11232 K  |
|       from small pool |    1272    |    1894    |   16928 K  |   16927 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1308    |    1965    |   28161 K  |   28160 K  |
|       from large pool |      36    |      76    |   11233 K  |   11232 K  |
|       from small pool |    1272    |    1894    |   16928 K  |   16927 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      68    |      19    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      52    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     482    |   15371 K  |   15371 K  |
|       from large pool |       5    |      11    |    4363 K  |    4363 K  |
|       from small pool |      30    |     477    |   11007 K  |   11007 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   1358 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 628877 KiB | 653569 GiB | 653569 GiB |
|       from large pool | 298752 KiB | 627520 KiB | 653399 GiB | 653399 GiB |
|       from small pool |      0 KiB |  16378 KiB |    170 GiB |    170 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1965    |   28161 K  |   28161 K  |
|       from large pool |       2    |      76    |   11233 K  |   11233 K  |
|       from small pool |       0    |    1894    |   16928 K  |   16928 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1965    |   28161 K  |   28161 K  |
|       from large pool |       2    |      76    |   11233 K  |   11233 K  |
|       from small pool |       0    |    1894    |   16928 K  |   16928 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     482    |   15372 K  |   15372 K  |
|       from large pool |       1    |      11    |    4363 K  |    4363 K  |
|       from small pool |       0    |     477    |   11008 K  |   11008 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   1358 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 628877 KiB | 653569 GiB | 653569 GiB |
|       from large pool | 298752 KiB | 627520 KiB | 653399 GiB | 653399 GiB |
|       from small pool |      0 KiB |  16378 KiB |    170 GiB |    170 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1965    |   28161 K  |   28161 K  |
|       from large pool |       2    |      76    |   11233 K  |   11233 K  |
|       from small pool |       0    |    1894    |   16928 K  |   16928 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1965    |   28161 K  |   28161 K  |
|       from large pool |       2    |      76    |   11233 K  |   11233 K  |
|       from small pool |       0    |    1894    |   16928 K  |   16928 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     482    |   15372 K  |   15372 K  |
|       from large pool |       1    |      11    |    4363 K  |    4363 K  |
|       from small pool |       0    |     477    |   11008 K  |   11008 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648

 Experiment start at: 2024-06-19 11:56:02.625772
before training, model accuracy: 0.12167187035083771
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9523718, 'precision': 0.9700953, 'recall': 0.7565533, 'specificity': 0.7565533, 'f1': 0.8253206, 'auroc': 0.9531534, 'binary_precision': 0.9898003, 'binary_recall': 0.51367444, 'binary_specificity': 0.99943215, 'binary_f1_score': 0.67634666}
confusion matrix:
       0     1
0  42242    24
1   2205  2329
---- Validation: 
scalar performance:
{'acc': 0.9675065, 'precision': 0.6090593, 'recall': 0.50299203, 'specificity': 0.50299203, 'f1': 0.49821317, 'auroc': 0.57322, 'binary_precision': 0.25, 'binary_recall': 0.006644518, 'binary_specificity': 0.9993396, 'binary_f1_score': 0.012944983}
confusion matrix:
       0   1
0  18159  12
1    598   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.891715, 'precision': 0.44599018, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.47137913, 'auroc': 0.5917201, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   726  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 12:15:24.138976,epoch time: 0:19:21.513204,used: 0:19:21.513204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97517097, 'precision': 0.98062015, 'recall': 0.87639576, 'specificity': 0.87639576, 'f1': 0.92062354, 'auroc': 0.97949874, 'binary_precision': 0.98701674, 'binary_recall': 0.7538563, 'binary_specificity': 0.9989352, 'binary_f1_score': 0.8548226}
confusion matrix:
       0     1
0  42217    45
1   1117  3421
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.7745513, 'recall': 0.55105984, 'specificity': 0.55105984, 'f1': 0.5806668, 'auroc': 0.7157271, 'binary_precision': 0.57798165, 'binary_recall': 0.10465116, 'binary_specificity': 0.9974685, 'binary_f1_score': 0.17721519}
confusion matrix:
       0   1
0  18125  46
1    539  63
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9037632, 'precision': 0.88674086, 'recall': 0.56288236, 'specificity': 0.56288236, 'f1': 0.5859965, 'auroc': 0.7409846, 'binary_precision': 0.86915886, 'binary_recall': 0.12809917, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.22328931}
confusion matrix:
      0   1
0  5983  14
1   633  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-19 12:36:21.984049,epoch time: 0:20:57.845073,used: 0:40:19.358277,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9796154, 'precision': 0.97904474, 'recall': 0.9028116, 'specificity': 0.9028116, 'f1': 0.9368006, 'auroc': 0.9859781, 'binary_precision': 0.97836536, 'binary_recall': 0.8075397, 'binary_specificity': 0.9980835, 'binary_f1_score': 0.88478255}
confusion matrix:
       0     1
0  42183    81
1    873  3663
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.74624467, 'recall': 0.5877524, 'specificity': 0.5877524, 'f1': 0.6261513, 'auroc': 0.73943883, 'binary_precision': 0.5190476, 'binary_recall': 0.18106312, 'binary_specificity': 0.9944417, 'binary_f1_score': 0.2684729}
confusion matrix:
       0    1
0  18070  101
1    493  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9150677, 'precision': 0.90851074, 'recall': 0.6182506, 'specificity': 0.6182506, 'f1': 0.66654545, 'auroc': 0.75329727, 'binary_precision': 0.9015544, 'binary_recall': 0.23966943, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.3786725}
confusion matrix:
      0    1
0  5978   19
1   552  174
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_3.png
new oracle model saved
early stop counter: 1
val acc:0.9683588147163391, best validation acc: 0.9688382148742676, corresponding to test acc:                         0.9037631750106812 / 0.9150676727294922
after epoch: 3,now: 2024-06-19 12:59:05.180721,epoch time: 0:22:43.196672,used: 1:03:02.554949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98264956, 'precision': 0.98128283, 'recall': 0.91824955, 'specificity': 0.91824955, 'f1': 0.9469924, 'auroc': 0.9891293, 'binary_precision': 0.9796444, 'binary_recall': 0.83836824, 'binary_specificity': 0.99813086, 'binary_f1_score': 0.90351707}
confusion matrix:
       0     1
0  42186    79
1    733  3802
---- Validation: 
scalar performance:
--- Logging error ---
Traceback (most recent call last):
confusion matrix:
       0    1
0  18089   82
1    496  106
---- Test Domain (oracle): 
scalar performance:
--- Logging error ---
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98717946, 'precision': 0.9842497, 'recall': 0.94162333, 'specificity': 0.94162333, 'f1': 0.961699, 'auroc': 0.99317896, 'binary_precision': 0.98069876, 'binary_recall': 0.88511574, 'binary_specificity': 0.99813086, 'binary_f1_score': 0.930459}
confusion matrix:
       0     1
0  42186    79
1    521  4014
---- Validation: 
scalar performance:
{'acc': 0.9688915, 'precision': 0.7594298, 'recall': 0.5872245, 'specificity': 0.5872245, 'f1': 0.62705356, 'auroc': 0.779865, 'binary_precision': 0.54545456, 'binary_recall': 0.179402, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.27}
confusion matrix:
       0    1
0  18081   90
1    494  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91551393, 'precision': 0.9094745, 'recall': 0.62031674, 'specificity': 0.62031674, 'f1': 0.6692975, 'auroc': 0.7708243, 'binary_precision': 0.9030612, 'binary_recall': 0.24380165, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.38394794}
confusion matrix:
      0    1
0  5978   19
1   549  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_6.png
new oracle model saved
early stop counter: 1
val acc:0.9688915014266968, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9141752123832703 / 0.9155139327049255
after epoch: 6,now: 2024-06-19 14:13:46.942323,epoch time: 0:40:52.491054,used: 2:17:44.316551,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9870299, 'precision': 0.9789901, 'recall': 0.9457959, 'specificity': 0.9457959, 'f1': 0.96163905, 'auroc': 0.9932739, 'binary_precision': 0.9691977, 'binary_recall': 0.894644, 'binary_specificity': 0.9969477, 'binary_f1_score': 0.93042976}
confusion matrix:
       0     1
0  42134   129
1    478  4059
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.76117814, 'recall': 0.6066353, 'specificity': 0.6066353, 'f1': 0.648696, 'auroc': 0.7974391, 'binary_precision': 0.54771787, 'binary_recall': 0.2192691, 'binary_specificity': 0.99400145, 'binary_f1_score': 0.31316724}
confusion matrix:
       0    1
0  18062  109
1    470  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9168526, 'precision': 0.90663576, 'recall': 0.62833107, 'specificity': 0.62833107, 'f1': 0.67936367, 'auroc': 0.78868914, 'binary_precision': 0.8957346, 'binary_recall': 0.2603306, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.40341517}
confusion matrix:
      0    1
0  5975   22
1   537  189
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_7.png
new oracle model saved
early stop counter: 2
val acc:0.9691578149795532, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9141752123832703 / 0.916852593421936
after epoch: 7,now: 2024-06-19 14:57:37.362875,epoch time: 0:43:50.420552,used: 3:01:34.737103,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98732907, 'precision': 0.9844508, 'recall': 0.9422841, 'specificity': 0.9422841, 'f1': 0.9621576, 'auroc': 0.9937886, 'binary_precision': 0.9809617, 'binary_recall': 0.88641375, 'binary_specificity': 0.9981545, 'binary_f1_score': 0.9312942}
confusion matrix:
       0     1
0  42188    78
1    515  4019
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.7712573, 'recall': 0.5866416, 'specificity': 0.5866416, 'f1': 0.6276076, 'auroc': 0.79402316, 'binary_precision': 0.56914896, 'binary_recall': 0.17774086, 'binary_specificity': 0.99554235, 'binary_f1_score': 0.27088606}
confusion matrix:
       0    1
0  18090   81
1    495  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91149783, 'precision': 0.89984435, 'recall': 0.60172164, 'specificity': 0.60172164, 'f1': 0.64389443, 'auroc': 0.78844607, 'binary_precision': 0.88757396, 'binary_recall': 0.20661157, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.3351955}
confusion matrix:
      0    1
0  5978   19
1   576  150
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_8.png
early stop counter: 3
val acc:0.969317615032196, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9141752123832703 / 0.916852593421936
after epoch: 8,now: 2024-06-19 15:40:46.425435,epoch time: 0:43:09.062560,used: 3:44:43.799663,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.988141, 'precision': 0.98414975, 'recall': 0.9472964, 'specificity': 0.9472964, 'f1': 0.96480215, 'auroc': 0.99460363, 'binary_precision': 0.97929704, 'binary_recall': 0.8966277, 'binary_specificity': 0.9979651, 'binary_f1_score': 0.9361408}
confusion matrix:
       0     1
0  42177    86
1    469  4068
---- Validation: 
scalar performance:
{'acc': 0.9692111, 'precision': 0.76826036, 'recall': 0.58658653, 'specificity': 0.58658653, 'f1': 0.62723786, 'auroc': 0.80287224, 'binary_precision': 0.5631579, 'binary_recall': 0.17774086, 'binary_specificity': 0.99543226, 'binary_f1_score': 0.270202}
confusion matrix:
       0    1
0  18088   83
1    495  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9100104, 'precision': 0.8867509, 'recall': 0.59725595, 'specificity': 0.59725595, 'f1': 0.63715637, 'auroc': 0.790881, 'binary_precision': 0.8622754, 'binary_recall': 0.1983471, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.3225084}
confusion matrix:
      0    1
0  5974   23
1   582  144
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_9.png
early stop counter: 4
val acc:0.9692111015319824, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9141752123832703 / 0.916852593421936
after epoch: 9,now: 2024-06-19 16:15:50.870022,epoch time: 0:35:04.444587,used: 4:19:48.244250,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9887393, 'precision': 0.98412246, 'recall': 0.9507333, 'specificity': 0.9507333, 'f1': 0.9666743, 'auroc': 0.9938476, 'binary_precision': 0.97849977, 'binary_recall': 0.90359586, 'binary_specificity': 0.9978707, 'binary_f1_score': 0.9395573}
confusion matrix:
       0     1
0  42177    90
1    437  4096
---- Validation: 
scalar performance:
{'acc': 0.9694774, 'precision': 0.7779863, 'recall': 0.5827089, 'specificity': 0.5827089, 'f1': 0.6234822, 'auroc': 0.8086889, 'binary_precision': 0.58285713, 'binary_recall': 0.16943522, 'binary_specificity': 0.9959826, 'binary_f1_score': 0.26254827}
confusion matrix:
       0    1
0  18098   73
1    500  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.907928, 'precision': 0.8888762, 'recall': 0.58519274, 'specificity': 0.58519274, 'f1': 0.620049, 'auroc': 0.7935533, 'binary_precision': 0.8689655, 'binary_recall': 0.17355372, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.2893226}
confusion matrix:
      0    1
0  5978   19
1   600  126
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_10.png
better model found
persisted
after epoch: 10,now: 2024-06-19 16:45:36.755957,epoch time: 0:29:45.885935,used: 4:49:34.130185,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9896154, 'precision': 0.98379743, 'recall': 0.95616066, 'specificity': 0.95616066, 'f1': 0.9694648, 'auroc': 0.99560034, 'binary_precision': 0.9766894, 'binary_recall': 0.91466373, 'binary_specificity': 0.99765766, 'binary_f1_score': 0.94465953}
confusion matrix:
       0     1
0  42166    99
1    387  4148
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.7660835, 'recall': 0.5970537, 'specificity': 0.5970537, 'f1': 0.63902396, 'auroc': 0.81975764, 'binary_precision': 0.55813956, 'binary_recall': 0.19933555, 'binary_specificity': 0.9947719, 'binary_f1_score': 0.29375765}
confusion matrix:
       0    1
0  18076   95
1    482  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.907928, 'precision': 0.86342597, 'recall': 0.5924567, 'specificity': 0.5924567, 'f1': 0.62953055, 'auroc': 0.7952627, 'binary_precision': 0.8165681, 'binary_recall': 0.19008264, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.3083799}
confusion matrix:
      0    1
0  5966   31
1   588  138
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_11.png
early stop counter: 1
val acc:0.9692643880844116, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9079279899597168 / 0.916852593421936
after epoch: 11,now: 2024-06-19 17:20:42.983778,epoch time: 0:35:06.227821,used: 5:24:40.358006,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98972225, 'precision': 0.9819837, 'recall': 0.95859957, 'specificity': 0.95859957, 'f1': 0.96992314, 'auroc': 0.9952198, 'binary_precision': 0.972507, 'binary_recall': 0.9199912, 'binary_specificity': 0.99720794, 'binary_f1_score': 0.94552046}
confusion matrix:
       0     1
0  42145   118
1    363  4174
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.76658344, 'recall': 0.5954476, 'specificity': 0.5954476, 'f1': 0.6372875, 'auroc': 0.82790375, 'binary_precision': 0.5592417, 'binary_recall': 0.19601329, 'binary_specificity': 0.9948819, 'binary_f1_score': 0.2902829}
confusion matrix:
       0    1
0  18078   93
1    484  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90644056, 'precision': 0.8668892, 'recall': 0.582543, 'specificity': 0.582543, 'f1': 0.6155535, 'auroc': 0.8029965, 'binary_precision': 0.82550335, 'binary_recall': 0.1694215, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.28114286}
confusion matrix:
      0    1
0  5971   26
1   603  123
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_12.png
early stop counter: 2
val acc:0.9692643880844116, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9079279899597168 / 0.916852593421936
after epoch: 12,now: 2024-06-19 17:50:43.384370,epoch time: 0:30:00.400592,used: 5:54:40.758598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98946583, 'precision': 0.982087, 'recall': 0.95693624, 'specificity': 0.95693624, 'f1': 0.969085, 'auroc': 0.9954436, 'binary_precision': 0.9730616, 'binary_recall': 0.91659313, 'binary_specificity': 0.9972793, 'binary_f1_score': 0.9439837}
confusion matrix:
       0     1
0  42153   115
1    378  4154
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.7705879, 'recall': 0.58824766, 'specificity': 0.58824766, 'f1': 0.6294433, 'auroc': 0.82091624, 'binary_precision': 0.5677083, 'binary_recall': 0.18106312, 'binary_specificity': 0.99543226, 'binary_f1_score': 0.27455917}
confusion matrix:
       0    1
0  18088   83
1    493  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9034657, 'precision': 0.84762, 'recall': 0.56997955, 'specificity': 0.56997955, 'f1': 0.5964546, 'auroc': 0.7923914, 'binary_precision': 0.7894737, 'binary_recall': 0.1446281, 'binary_specificity': 0.995331, 'binary_f1_score': 0.24447031}
confusion matrix:
      0    1
0  5969   28
1   621  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_13.png
early stop counter: 3
val acc:0.969317615032196, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9079279899597168 / 0.916852593421936
after epoch: 13,now: 2024-06-19 18:24:39.714609,epoch time: 0:33:56.330239,used: 6:28:37.088837,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9902137, 'precision': 0.98807687, 'recall': 0.9555077, 'specificity': 0.9555077, 'f1': 0.97108227, 'auroc': 0.99501956, 'binary_precision': 0.98547274, 'binary_recall': 0.91245866, 'binary_specificity': 0.99855673, 'binary_f1_score': 0.94756126}
confusion matrix:
       0     1
0  42204    61
1    397  4138
---- Validation: 
scalar performance:
{'acc': 0.9692111, 'precision': 0.7721158, 'recall': 0.57775307, 'specificity': 0.57775307, 'f1': 0.61681694, 'auroc': 0.8256656, 'binary_precision': 0.5714286, 'binary_recall': 0.15946844, 'binary_specificity': 0.99603766, 'binary_f1_score': 0.24935064}
confusion matrix:
       0   1
0  18099  72
1    506  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9028707, 'precision': 0.85566294, 'recall': 0.5641981, 'specificity': 0.5641981, 'f1': 0.5876988, 'auroc': 0.7971822, 'binary_precision': 0.8067227, 'binary_recall': 0.1322314, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.22721893}
confusion matrix:
      0   1
0  5974  23
1   630  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_14.png
early stop counter: 4
val acc:0.9692111015319824, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9079279899597168 / 0.916852593421936
after epoch: 14,now: 2024-06-19 18:46:36.919940,epoch time: 0:21:57.205331,used: 6:50:34.294168,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9907906, 'precision': 0.9855788, 'recall': 0.9612155, 'specificity': 0.9612155, 'f1': 0.97300035, 'auroc': 0.99622476, 'binary_precision': 0.9792007, 'binary_recall': 0.92453665, 'binary_specificity': 0.9978944, 'binary_f1_score': 0.9510839}
confusion matrix:
       0     1
0  42179    89
1    342  4190
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.75480145, 'recall': 0.58309925, 'specificity': 0.58309925, 'f1': 0.62172335, 'auroc': 0.82863784, 'binary_precision': 0.5364583, 'binary_recall': 0.17109634, 'binary_specificity': 0.9951021, 'binary_f1_score': 0.25944585}
confusion matrix:
       0    1
0  18082   89
1    499  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90420943, 'precision': 0.87076724, 'recall': 0.56858045, 'specificity': 0.56858045, 'f1': 0.5947234, 'auroc': 0.7825423, 'binary_precision': 0.8360656, 'binary_recall': 0.14049587, 'binary_specificity': 0.996665, 'binary_f1_score': 0.24056605}
confusion matrix:
      0    1
0  5977   20
1   624  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_15.png
early stop counter: 5
val acc:0.9686784148216248, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9079279899597168 / 0.916852593421936
after epoch: 15,now: 2024-06-19 18:57:50.091340,epoch time: 0:11:13.171400,used: 7:01:47.465568,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.991218, 'precision': 0.9882957, 'recall': 0.96109164, 'specificity': 0.96109164, 'f1': 0.9742007, 'auroc': 0.99667513, 'binary_precision': 0.98472387, 'binary_recall': 0.9237213, 'binary_specificity': 0.998462, 'binary_f1_score': 0.95324767}
confusion matrix:
       0     1
0  42199    65
1    346  4190
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.75591254, 'recall': 0.571829, 'specificity': 0.571829, 'f1': 0.60802925, 'auroc': 0.8313432, 'binary_precision': 0.53939396, 'binary_recall': 0.14784053, 'binary_specificity': 0.9958175, 'binary_f1_score': 0.232073}
confusion matrix:
       0   1
0  18095  76
1    513  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9004909, 'precision': 0.83698356, 'recall': 0.55378413, 'specificity': 0.55378413, 'f1': 0.5709569, 'auroc': 0.79599166, 'binary_precision': 0.7714286, 'binary_recall': 0.11157025, 'binary_specificity': 0.995998, 'binary_f1_score': 0.19494584}
confusion matrix:
      0   1
0  5973  24
1   645  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_16.png
early stop counter: 6
val acc:0.9686251282691956, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9079279899597168 / 0.916852593421936
after epoch: 16,now: 2024-06-19 19:09:37.839588,epoch time: 0:11:47.748248,used: 7:13:35.213816,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9917949, 'precision': 0.98814094, 'recall': 0.96451414, 'specificity': 0.96451414, 'f1': 0.9759568, 'auroc': 0.99618363, 'binary_precision': 0.98366773, 'binary_recall': 0.9306843, 'binary_specificity': 0.998344, 'binary_f1_score': 0.95644283}
confusion matrix:
       0     1
0  42200    70
1    314  4216
---- Validation: 
scalar performance:
{'acc': 0.9685186, 'precision': 0.7518779, 'recall': 0.5757892, 'specificity': 0.5757892, 'f1': 0.6126304, 'auroc': 0.8388109, 'binary_precision': 0.53107345, 'binary_recall': 0.15614618, 'binary_specificity': 0.99543226, 'binary_f1_score': 0.24133506}
confusion matrix:
       0   1
0  18088  83
1    508  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8985572, 'precision': 0.8106266, 'recall': 0.5472523, 'specificity': 0.5472523, 'f1': 0.56014645, 'auroc': 0.7969825, 'binary_precision': 0.72, 'binary_recall': 0.09917355, 'binary_specificity': 0.995331, 'binary_f1_score': 0.17433415}
confusion matrix:
      0   1
0  5969  28
1   654  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_17.png
early stop counter: 7
val acc:0.9685186147689819, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9079279899597168 / 0.916852593421936
after epoch: 17,now: 2024-06-19 19:22:11.470332,epoch time: 0:12:33.630744,used: 7:26:08.844560,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99051285, 'precision': 0.9868206, 'recall': 0.9584202, 'specificity': 0.9584202, 'f1': 0.9720808, 'auroc': 0.9959831, 'binary_precision': 0.9823113, 'binary_recall': 0.9186149, 'binary_specificity': 0.9982255, 'binary_f1_score': 0.9493959}
confusion matrix:
       0     1
0  42191    75
1    369  4165
---- Validation: 
scalar performance:
{'acc': 0.9687849, 'precision': 0.7657137, 'recall': 0.5606689, 'specificity': 0.5606689, 'f1': 0.5939424, 'auroc': 0.8304597, 'binary_precision': 0.5597015, 'binary_recall': 0.12458472, 'binary_specificity': 0.9967531, 'binary_f1_score': 0.20380434}
confusion matrix:
       0   1
0  18112  59
1    527  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.898111, 'precision': 0.8401102, 'recall': 0.5379222, 'specificity': 0.5379222, 'f1': 0.54425764, 'auroc': 0.7818376, 'binary_precision': 0.7808219, 'binary_recall': 0.0785124, 'binary_specificity': 0.997332, 'binary_f1_score': 0.14267835}
confusion matrix:
      0   1
0  5981  16
1   669  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_18.png
early stop counter: 8
val acc:0.9687849283218384, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9079279899597168 / 0.916852593421936
after epoch: 18,now: 2024-06-19 19:34:09.214457,epoch time: 0:11:57.744125,used: 7:38:06.588685,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99188036, 'precision': 0.9885062, 'recall': 0.96469045, 'specificity': 0.96469045, 'f1': 0.9762218, 'auroc': 0.99644196, 'binary_precision': 0.984375, 'binary_recall': 0.930966, 'binary_specificity': 0.9984148, 'binary_f1_score': 0.95692587}
confusion matrix:
       0     1
0  42199    67
1    313  4221
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.74177074, 'recall': 0.57559663, 'specificity': 0.57559663, 'f1': 0.611459, 'auroc': 0.8420977, 'binary_precision': 0.51086956, 'binary_recall': 0.15614618, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.23918577}
confusion matrix:
       0   1
0  18081  90
1    508  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90197825, 'precision': 0.85012114, 'recall': 0.56006587, 'specificity': 0.56006587, 'f1': 0.58113426, 'auroc': 0.7983854, 'binary_precision': 0.79646015, 'binary_recall': 0.12396694, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.21454112}
confusion matrix:
      0   1
0  5974  23
1   636  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_19.png
early stop counter: 9
val acc:0.9681457281112671, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9079279899597168 / 0.916852593421936
after epoch: 19,now: 2024-06-19 19:46:10.761004,epoch time: 0:12:01.546547,used: 7:50:08.135232,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9922436, 'precision': 0.9903654, 'recall': 0.96499753, 'specificity': 0.96499753, 'f1': 0.9772555, 'auroc': 0.9971646, 'binary_precision': 0.9880674, 'binary_recall': 0.93120176, 'binary_specificity': 0.9987933, 'binary_f1_score': 0.95879215}
confusion matrix:
       0     1
0  42214    51
1    312  4223
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.75025856, 'recall': 0.55078465, 'specificity': 0.55078465, 'f1': 0.57929987, 'auroc': 0.8211884, 'binary_precision': 0.5294118, 'binary_recall': 0.10465116, 'binary_specificity': 0.99691814, 'binary_f1_score': 0.17475727}
confusion matrix:
       0   1
0  18115  56
1    539  63
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90138334, 'precision': 0.8604043, 'recall': 0.5542844, 'specificity': 0.5542844, 'f1': 0.57191604, 'auroc': 0.7812183, 'binary_precision': 0.8181818, 'binary_recall': 0.11157025, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.19636363}
confusion matrix:
      0   1
0  5979  18
1   645  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_20.png
early stop counter: 10
val acc:0.9683055281639099, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9079279899597168 / 0.916852593421936
after epoch: 20,now: 2024-06-19 19:57:52.076509,epoch time: 0:11:41.315505,used: 8:01:49.450737,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99196583, 'precision': 0.989063, 'recall': 0.9646164, 'specificity': 0.9646164, 'f1': 0.9764434, 'auroc': 0.9963287, 'binary_precision': 0.98551065, 'binary_recall': 0.93069965, 'binary_specificity': 0.9985332, 'binary_f1_score': 0.9573212}
confusion matrix:
       0     1
0  42207    62
1    314  4217
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.7456277, 'recall': 0.5796944, 'specificity': 0.5796944, 'f1': 0.61674774, 'auroc': 0.8349005, 'binary_precision': 0.5183246, 'binary_recall': 0.16445182, 'binary_specificity': 0.994937, 'binary_f1_score': 0.24968472}
confusion matrix:
       0   1
0  18079  92
1    503  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8982597, 'precision': 0.79801583, 'recall': 0.5489015, 'specificity': 0.5489015, 'f1': 0.562811, 'auroc': 0.78991926, 'binary_precision': 0.6944444, 'binary_recall': 0.10330579, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.1798561}
confusion matrix:
      0   1
0  5964  33
1   651  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_21.png
early stop counter: 11
val acc:0.9683055281639099, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9079279899597168 / 0.916852593421936
after epoch: 21,now: 2024-06-19 20:10:59.674407,epoch time: 0:13:07.597898,used: 8:14:57.048635,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.991453, 'precision': 0.9875332, 'recall': 0.9632056, 'specificity': 0.9632056, 'f1': 0.97497535, 'auroc': 0.99587893, 'binary_precision': 0.9827345, 'binary_recall': 0.92816216, 'binary_specificity': 0.998249, 'binary_f1_score': 0.95466906}
confusion matrix:
       0     1
0  42188    74
1    326  4212
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.7377176, 'recall': 0.57872623, 'specificity': 0.57872623, 'f1': 0.61478406, 'auroc': 0.8356149, 'binary_precision': 0.50256413, 'binary_recall': 0.1627907, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.24592222}
confusion matrix:
       0   1
0  18074  97
1    504  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89930093, 'precision': 0.8155138, 'recall': 0.5513011, 'specificity': 0.5513011, 'f1': 0.56680006, 'auroc': 0.7944542, 'binary_precision': 0.72897196, 'binary_recall': 0.10743801, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.18727489}
confusion matrix:
      0   1
0  5968  29
1   648  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_22.png
early stop counter: 12
val acc:0.9679859280586243, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9079279899597168 / 0.916852593421936
after epoch: 22,now: 2024-06-19 20:23:16.850424,epoch time: 0:12:17.176017,used: 8:27:14.224652,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99288464, 'precision': 0.9900473, 'recall': 0.96899414, 'specificity': 0.96899414, 'f1': 0.97922814, 'auroc': 0.9975147, 'binary_precision': 0.98656785, 'binary_recall': 0.93936056, 'binary_specificity': 0.9986277, 'binary_f1_score': 0.96238565}
confusion matrix:
       0     1
0  42207    58
1    275  4260
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.76399827, 'recall': 0.58165824, 'specificity': 0.58165824, 'f1': 0.62091076, 'auroc': 0.8331221, 'binary_precision': 0.55494505, 'binary_recall': 0.16777408, 'binary_specificity': 0.99554235, 'binary_f1_score': 0.25765306}
confusion matrix:
       0    1
0  18090   81
1    501  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8982597, 'precision': 0.82506776, 'recall': 0.54163754, 'specificity': 0.54163754, 'f1': 0.5507122, 'auroc': 0.780926, 'binary_precision': 0.75, 'binary_recall': 0.08677686, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.15555556}
confusion matrix:
      0   1
0  5976  21
1   663  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_23.png
early stop counter: 13
val acc:0.9689980149269104, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9079279899597168 / 0.916852593421936
after epoch: 23,now: 2024-06-19 20:37:43.693126,epoch time: 0:14:26.842702,used: 8:41:41.067354,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99209404, 'precision': 0.98976123, 'recall': 0.96471786, 'specificity': 0.96471786, 'f1': 0.97682405, 'auroc': 0.996879, 'binary_precision': 0.9869067, 'binary_recall': 0.93076074, 'binary_specificity': 0.99867505, 'binary_f1_score': 0.95801187}
confusion matrix:
       0     1
0  42209    56
1    314  4221
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.75529766, 'recall': 0.5742382, 'specificity': 0.5742382, 'f1': 0.6110082, 'auroc': 0.8401721, 'binary_precision': 0.53801167, 'binary_recall': 0.15282393, 'binary_specificity': 0.99565244, 'binary_f1_score': 0.23803364}
confusion matrix:
       0   1
0  18092  79
1    510  92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.897516, 'precision': 0.79757965, 'recall': 0.5430367, 'specificity': 0.5430367, 'f1': 0.5531026, 'auroc': 0.79280204, 'binary_precision': 0.69473684, 'binary_recall': 0.09090909, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.16077954}
confusion matrix:
      0   1
0  5968  29
1   660  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_24.png
early stop counter: 14
val acc:0.9686251282691956, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9079279899597168 / 0.916852593421936
after epoch: 24,now: 2024-06-19 20:49:02.254028,epoch time: 0:11:18.560902,used: 8:52:59.628256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9927564, 'precision': 0.9895685, 'recall': 0.9687464, 'specificity': 0.9687464, 'f1': 0.978871, 'auroc': 0.997756, 'binary_precision': 0.9856581, 'binary_recall': 0.9389599, 'binary_specificity': 0.99853295, 'binary_f1_score': 0.96174246}
confusion matrix:
       0     1
0  42200    62
1    277  4261
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.73767066, 'recall': 0.5755141, 'specificity': 0.5755141, 'f1': 0.6109628, 'auroc': 0.8423153, 'binary_precision': 0.5026738, 'binary_recall': 0.15614618, 'binary_specificity': 0.9948819, 'binary_f1_score': 0.2382763}
confusion matrix:
       0   1
0  18078  93
1    508  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90153205, 'precision': 0.83980024, 'recall': 0.5598157, 'specificity': 0.5598157, 'f1': 0.58062685, 'auroc': 0.79249144, 'binary_precision': 0.7758621, 'binary_recall': 0.12396694, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.21377672}
confusion matrix:
      0   1
0  5971  26
1   636  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_25.png
early stop counter: 15
val acc:0.9679859280586243, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9079279899597168 / 0.916852593421936
after epoch: 25,now: 2024-06-19 20:59:53.796071,epoch time: 0:10:51.542043,used: 9:03:51.170299,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9918162, 'precision': 0.9856688, 'recall': 0.9671231, 'specificity': 0.9671231, 'f1': 0.9761671, 'auroc': 0.9974903, 'binary_precision': 0.9781207, 'binary_recall': 0.93649393, 'binary_specificity': 0.99775225, 'binary_f1_score': 0.95685476}
confusion matrix:
       0     1
0  42170    95
1    288  4247
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.74506783, 'recall': 0.5869218, 'specificity': 0.5869218, 'f1': 0.6250704, 'auroc': 0.8459427, 'binary_precision': 0.5167464, 'binary_recall': 0.179402, 'binary_specificity': 0.9944417, 'binary_f1_score': 0.26633784}
confusion matrix:
       0    1
0  18070  101
1    494  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90182954, 'precision': 0.83320343, 'recall': 0.5636144, 'specificity': 0.5636144, 'f1': 0.5864731, 'auroc': 0.794484, 'binary_precision': 0.7619048, 'binary_recall': 0.1322314, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.2253521}
confusion matrix:
      0   1
0  5967  30
1   630  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_26.png
early stop counter: 16
val acc:0.9683055281639099, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9079279899597168 / 0.916852593421936
after epoch: 26,now: 2024-06-19 21:14:53.963802,epoch time: 0:15:00.167731,used: 9:18:51.338030,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9924573, 'precision': 0.9885654, 'recall': 0.9679495, 'specificity': 0.9679495, 'f1': 0.97797614, 'auroc': 0.996932, 'binary_precision': 0.98379254, 'binary_recall': 0.93755513, 'binary_specificity': 0.9983439, 'binary_f1_score': 0.9601175}
confusion matrix:
       0     1
0  42198    70
1    283  4249
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.7562065, 'recall': 0.5831267, 'specificity': 0.5831267, 'f1': 0.6219008, 'auroc': 0.8398551, 'binary_precision': 0.539267, 'binary_recall': 0.17109634, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.25977302}
confusion matrix:
       0    1
0  18083   88
1    499  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8995984, 'precision': 0.83777547, 'recall': 0.5478359, 'specificity': 0.5478359, 'f1': 0.56118363, 'auroc': 0.7930368, 'binary_precision': 0.7741935, 'binary_recall': 0.09917355, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.17582418}
confusion matrix:
      0   1
0  5976  21
1   654  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_27.png
early stop counter: 17
val acc:0.968731701374054, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9079279899597168 / 0.916852593421936
after epoch: 27,now: 2024-06-19 21:30:27.705759,epoch time: 0:15:33.741957,used: 9:34:25.079987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9933547, 'precision': 0.9896345, 'recall': 0.9720967, 'specificity': 0.9720967, 'f1': 0.98066306, 'auroc': 0.99738944, 'binary_precision': 0.9850643, 'binary_recall': 0.9457313, 'binary_specificity': 0.99846214, 'binary_f1_score': 0.9649972}
confusion matrix:
       0     1
0  42202    65
1    246  4287
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.73285055, 'recall': 0.58102536, 'specificity': 0.58102536, 'f1': 0.6169211, 'auroc': 0.8448248, 'binary_precision': 0.49268293, 'binary_recall': 0.16777408, 'binary_specificity': 0.9942766, 'binary_f1_score': 0.25030977}
confusion matrix:
       0    1
0  18067  104
1    501  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9000446, 'precision': 0.8089391, 'recall': 0.55898196, 'specificity': 0.55898196, 'f1': 0.57895446, 'auroc': 0.794786, 'binary_precision': 0.71428573, 'binary_recall': 0.12396694, 'binary_specificity': 0.993997, 'binary_f1_score': 0.2112676}
confusion matrix:
      0   1
0  5961  36
1   636  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_28.png
early stop counter: 18
val acc:0.9677728414535522, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9079279899597168 / 0.916852593421936
after epoch: 28,now: 2024-06-19 21:43:53.858680,epoch time: 0:13:26.152921,used: 9:47:51.232908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9928205, 'precision': 0.98950636, 'recall': 0.9691687, 'specificity': 0.9691687, 'f1': 0.97906435, 'auroc': 0.9975127, 'binary_precision': 0.98544025, 'binary_recall': 0.9398281, 'binary_specificity': 0.99850935, 'binary_f1_score': 0.96209383}
confusion matrix:
       0     1
0  42200    63
1    273  4264
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.749146, 'recall': 0.5741281, 'specificity': 0.5741281, 'f1': 0.61034024, 'auroc': 0.8368716, 'binary_precision': 0.5257143, 'binary_recall': 0.15282393, 'binary_specificity': 0.99543226, 'binary_f1_score': 0.23680824}
confusion matrix:
       0   1
0  18088  83
1    510  92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89692104, 'precision': 0.79464674, 'recall': 0.5390712, 'specificity': 0.5390712, 'f1': 0.5463726, 'auroc': 0.7780595, 'binary_precision': 0.6896552, 'binary_recall': 0.08264463, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.14760147}
confusion matrix:
      0   1
0  5970  27
1   666  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_29.png
early stop counter: 19
val acc:0.9684121012687683, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9079279899597168 / 0.916852593421936
after epoch: 29,now: 2024-06-19 21:57:42.989156,epoch time: 0:13:49.130476,used: 10:01:40.363384,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9929701, 'precision': 0.9879043, 'recall': 0.9716004, 'specificity': 0.9716004, 'f1': 0.9795767, 'auroc': 0.9976086, 'binary_precision': 0.9816766, 'binary_recall': 0.9450937, 'binary_specificity': 0.9981072, 'binary_f1_score': 0.96303785}
confusion matrix:
       0     1
0  42185    80
1    249  4286
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.75592256, 'recall': 0.59763664, 'specificity': 0.59763664, 'f1': 0.6383461, 'auroc': 0.8539906, 'binary_precision': 0.5377778, 'binary_recall': 0.20099668, 'binary_specificity': 0.9942766, 'binary_f1_score': 0.29262394}
confusion matrix:
       0    1
0  18067  104
1    481  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9001934, 'precision': 0.8118036, 'recall': 0.55906534, 'specificity': 0.55906534, 'f1': 0.57912034, 'auroc': 0.8014667, 'binary_precision': 0.72, 'binary_recall': 0.12396694, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.21151586}
confusion matrix:
      0   1
0  5962  35
1   636  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504648_30.png
early stop counter: 20
val acc:0.9688382148742676, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9079279899597168 / 0.916852593421936
after epoch: 30,now: 2024-06-19 22:14:04.037235,epoch time: 0:16:21.048079,used: 10:18:01.411463,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_11_56_02_seed_2_21504648
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 30 with time: 10:18:01.411463 at 2024-06-19 22:14:04.037235
persisted model performance metric: 

scalar performance:
{'acc': 0.907928, 'precision': 0.8888762, 'recall': 0.58519274, 'specificity': 0.58519274, 'f1': 0.620049, 'auroc': 0.7935533, 'binary_precision': 0.8689655, 'binary_recall': 0.17355372, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.2893226}
confusion matrix:
      0    1
0  5978   19
1   600  126
oracle model performance metric: 

scalar performance:
{'acc': 0.9168526, 'precision': 0.90663576, 'recall': 0.62833107, 'specificity': 0.62833107, 'f1': 0.67936367, 'auroc': 0.78868914, 'binary_precision': 0.8957346, 'binary_recall': 0.2603306, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.40341517}
confusion matrix:
      0    1
0  5975   22
1   537  189
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204208 KiB |   1436 MiB |   1254 TiB |   1254 TiB |
|       from large pool | 167936 KiB |   1366 MiB |   1254 TiB |   1254 TiB |
|       from small pool |  36272 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204208 KiB |   1436 MiB |   1254 TiB |   1254 TiB |
|       from large pool | 167936 KiB |   1366 MiB |   1254 TiB |   1254 TiB |
|       from small pool |  36272 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201110 KiB |   1428 MiB |   1254 TiB |   1254 TiB |
|       from large pool | 165120 KiB |   1358 MiB |   1254 TiB |   1254 TiB |
|       from small pool |  35990 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   3432 MiB |   1966 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   3298 MiB |   1906 MiB |
|       from small pool |     74 MiB |     74 MiB |    134 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320079 KiB | 628877 KiB |    964 TiB |    964 TiB |
|       from large pool | 311296 KiB | 627520 KiB |    964 TiB |    964 TiB |
|       from small pool |   8783 KiB |  16378 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1308    |    1965    |   42260 K  |   42259 K  |
|       from large pool |      36    |      76    |   16858 K  |   16858 K  |
|       from small pool |    1272    |    1894    |   25402 K  |   25401 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1308    |    1965    |   42260 K  |   42259 K  |
|       from large pool |      36    |      76    |   16858 K  |   16858 K  |
|       from small pool |    1272    |    1894    |   25402 K  |   25401 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      86    |      37    |
|       from large pool |      12    |      13    |      19    |       7    |
|       from small pool |      37    |      37    |      67    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |     483    |   23281 K  |   23281 K  |
|       from large pool |       5    |      11    |    6644 K  |    6644 K  |
|       from small pool |      29    |     478    |   16637 K  |   16637 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |   1254 TiB |   1254 TiB |
|       from large pool |  16640 KiB |   1366 MiB |   1254 TiB |   1254 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |   1254 TiB |   1254 TiB |
|       from large pool |  16640 KiB |   1366 MiB |   1254 TiB |   1254 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |   1254 TiB |   1254 TiB |
|       from large pool |  16640 KiB |   1358 MiB |   1254 TiB |   1254 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   3432 MiB |   2920 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   3298 MiB |   2830 MiB |
|       from small pool |  45056 KiB |     74 MiB |    134 MiB |     90 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 628877 KiB |    964 TiB |    964 TiB |
|       from large pool | 298752 KiB | 627520 KiB |    964 TiB |    964 TiB |
|       from small pool |      0 KiB |  16378 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1965    |   42260 K  |   42260 K  |
|       from large pool |       2    |      76    |   16858 K  |   16858 K  |
|       from small pool |       0    |    1894    |   25402 K  |   25402 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1965    |   42260 K  |   42260 K  |
|       from large pool |       2    |      76    |   16858 K  |   16858 K  |
|       from small pool |       0    |    1894    |   25402 K  |   25402 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      86    |      55    |
|       from large pool |       9    |      13    |      19    |      10    |
|       from small pool |      22    |      37    |      67    |      45    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     483    |   23281 K  |   23281 K  |
|       from large pool |       1    |      11    |    6644 K  |    6644 K  |
|       from small pool |       0    |     478    |   16637 K  |   16637 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jun 19 22:14:51 2024]
Finished job 0.
1 of 1 steps (100%) done
