Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jun  7 01:17:50 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180

 Experiment start at: 2024-06-07 01:25:50.786343
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97273475, 'precision': 0.8140131, 'recall': 0.7026229, 'specificity': 0.7026229, 'f1': 0.745273, 'auroc': 0.9633211, 'binary_precision': 0.64818764, 'binary_recall': 0.41304347, 'binary_specificity': 0.9922023, 'binary_f1_score': 0.5045643}
confusion matrix:
       0    1
0  41990  330
1    864  608
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9709983, 'precision': 0.8152708, 'recall': 0.6587114, 'specificity': 0.6587114, 'f1': 0.7090005, 'auroc': 0.95727426, 'binary_precision': 0.6540881, 'binary_recall': 0.32348368, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.43288243}
confusion matrix:
       0    1
0  18039  110
1    435  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9753915, 'precision': 0.9874817, 'recall': 0.70498085, 'specificity': 0.70498085, 'f1': 0.7844224, 'auroc': 0.95476425, 'binary_precision': 1.0, 'binary_recall': 0.4099617, 'binary_specificity': 1.0, 'binary_f1_score': 0.58152175}
confusion matrix:
      0    1
0  5997    0
1   154  107
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-07 01:53:18.462800,epoch time: 0:27:27.676457,used: 0:27:27.676457,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97965384, 'precision': 0.878546, 'recall': 0.77702034, 'specificity': 0.77702034, 'f1': 0.81929886, 'auroc': 0.9712833, 'binary_precision': 0.7722587, 'binary_recall': 0.5597826, 'binary_specificity': 0.99425805, 'binary_f1_score': 0.6490745}
confusion matrix:
       0    1
0  42077  243
1    648  824
---- Validation: 
scalar performance:
{'acc': 0.9771711, 'precision': 0.86512804, 'recall': 0.74816346, 'specificity': 0.74816346, 'f1': 0.7945899, 'auroc': 0.9689208, 'binary_precision': 0.7476852, 'binary_recall': 0.5023328, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.6009302}
confusion matrix:
       0    1
0  18040  109
1    320  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.87182665, 'recall': 0.5605523, 'specificity': 0.5605523, 'f1': 0.59621733, 'auroc': 0.9488579, 'binary_precision': 0.7804878, 'binary_recall': 0.12260536, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.21192051}
confusion matrix:
      0   1
0  5988   9
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_2.png
better model found
persisted
after epoch: 2,now: 2024-06-07 02:19:41.183664,epoch time: 0:26:22.720864,used: 0:53:50.397321,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9806814, 'precision': 0.8888618, 'recall': 0.78527653, 'specificity': 0.78527653, 'f1': 0.8284906, 'auroc': 0.97422165, 'binary_precision': 0.79232925, 'binary_recall': 0.57579875, 'binary_specificity': 0.9947544, 'binary_f1_score': 0.6669291}
confusion matrix:
       0    1
0  42099  222
1    624  847
---- Validation: 
scalar performance:
{'acc': 0.9782354, 'precision': 0.89327157, 'recall': 0.7382137, 'specificity': 0.7382137, 'f1': 0.79528236, 'auroc': 0.96808815, 'binary_precision': 0.8046875, 'binary_recall': 0.4805599, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.6017527}
confusion matrix:
       0    1
0  18074   75
1    334  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8863846, 'recall': 0.5246541, 'specificity': 0.5246541, 'f1': 0.5366773, 'auroc': 0.9470944, 'binary_precision': 0.8125, 'binary_recall': 0.049808428, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.09386282}
confusion matrix:
      0   1
0  5994   3
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_3.png
better model found
persisted
after epoch: 3,now: 2024-06-07 02:46:03.163599,epoch time: 0:26:21.979935,used: 1:20:12.377256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98212004, 'precision': 0.87755835, 'recall': 0.8330488, 'specificity': 0.8330488, 'f1': 0.853793, 'auroc': 0.9815918, 'binary_precision': 0.76643467, 'binary_recall': 0.6732337, 'binary_specificity': 0.9928639, 'binary_f1_score': 0.7168174}
confusion matrix:
       0    1
0  42018  302
1    481  991
---- Validation: 
scalar performance:
{'acc': 0.9785547, 'precision': 0.8561437, 'recall': 0.7953832, 'specificity': 0.7953832, 'f1': 0.8226842, 'auroc': 0.9732512, 'binary_precision': 0.7264151, 'binary_recall': 0.59875584, 'binary_specificity': 0.9920106, 'binary_f1_score': 0.65643644}
confusion matrix:
       0    1
0  18004  145
1    258  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971876, 'precision': 0.9156214, 'recall': 0.6939849, 'specificity': 0.6939849, 'f1': 0.7611699, 'auroc': 0.9635575, 'binary_precision': 0.85714287, 'binary_recall': 0.3908046, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.5368421}
confusion matrix:
      0    1
0  5980   17
1   159  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_4.png
better model found
persisted
after epoch: 4,now: 2024-06-07 03:12:22.510548,epoch time: 0:26:19.346949,used: 1:46:31.724205,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9796081, 'precision': 0.8967917, 'recall': 0.75470227, 'specificity': 0.75470227, 'f1': 0.8091032, 'auroc': 0.9819907, 'binary_precision': 0.8102894, 'binary_recall': 0.51358694, 'binary_specificity': 0.9958176, 'binary_f1_score': 0.6286902}
confusion matrix:
       0    1
0  42143  177
1    716  756
---- Validation: 
scalar performance:
{'acc': 0.9778097, 'precision': 0.8705232, 'recall': 0.7552446, 'specificity': 0.7552446, 'f1': 0.80141115, 'auroc': 0.97670794, 'binary_precision': 0.7579909, 'binary_recall': 0.5163297, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.6142461}
confusion matrix:
       0    1
0  18043  106
1    311  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.90889764, 'recall': 0.60836166, 'specificity': 0.60836166, 'f1': 0.6650014, 'auroc': 0.958857, 'binary_precision': 0.8507463, 'binary_recall': 0.21839081, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.347561}
confusion matrix:
      0   1
0  5987  10
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_5.png
early stop counter: 1
val acc:0.977809727191925, best validation acc: 0.9785547256469727, corresponding to test acc:                         0.9718760251998901 / 0.9753915071487427
after epoch: 5,now: 2024-06-07 03:38:42.307302,epoch time: 0:26:19.796754,used: 2:12:51.520959,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98364997, 'precision': 0.9233438, 'recall': 0.80498874, 'specificity': 0.80498874, 'f1': 0.8538405, 'auroc': 0.98637855, 'binary_precision': 0.86, 'binary_recall': 0.61345106, 'binary_specificity': 0.9965265, 'binary_f1_score': 0.7160983}
confusion matrix:
       0    1
0  42173  147
1    569  903
---- Validation: 
scalar performance:
{'acc': 0.9831311, 'precision': 0.9358063, 'recall': 0.7895019, 'specificity': 0.7895019, 'f1': 0.8468335, 'auroc': 0.9818858, 'binary_precision': 0.8862559, 'binary_recall': 0.5816485, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.70234746}
confusion matrix:
       0    1
0  18101   48
1    269  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.9344934, 'recall': 0.5553054, 'specificity': 0.5553054, 'f1': 0.5893631, 'auroc': 0.96124685, 'binary_precision': 0.90625, 'binary_recall': 0.11111111, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.19795221}
confusion matrix:
      0   1
0  5994   3
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_6.png
better model found
persisted
after epoch: 6,now: 2024-06-07 04:05:07.307107,epoch time: 0:26:24.999805,used: 2:39:16.520764,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98513424, 'precision': 0.9214394, 'recall': 0.8342805, 'specificity': 0.8342805, 'f1': 0.87245125, 'auroc': 0.98843753, 'binary_precision': 0.8541846, 'binary_recall': 0.6725544, 'binary_specificity': 0.9960066, 'binary_f1_score': 0.75256556}
confusion matrix:
       0    1
0  42151  169
1    482  990
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.9048879, 'recall': 0.8395014, 'specificity': 0.8395014, 'f1': 0.86909103, 'auroc': 0.9815642, 'binary_precision': 0.8208955, 'binary_recall': 0.6842924, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.74639523}
confusion matrix:
       0    1
0  18053   96
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.86516035, 'recall': 0.6096104, 'specificity': 0.6096104, 'f1': 0.66303384, 'auroc': 0.95124936, 'binary_precision': 0.7631579, 'binary_recall': 0.22222222, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.34421366}
confusion matrix:
      0   1
0  5979  18
1   203  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_7.png
better model found
persisted
after epoch: 7,now: 2024-06-07 04:31:28.854751,epoch time: 0:26:21.547644,used: 3:05:38.068408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98641306, 'precision': 0.88563615, 'recall': 0.91362834, 'specificity': 0.91362834, 'f1': 0.8990991, 'auroc': 0.98884, 'binary_precision': 0.7770057, 'binary_recall': 0.8355978, 'binary_specificity': 0.9916588, 'binary_f1_score': 0.8052373}
confusion matrix:
       0     1
0  41967   353
1    242  1230
---- Validation: 
scalar performance:
{'acc': 0.98291826, 'precision': 0.8564888, 'recall': 0.9049002, 'specificity': 0.9049002, 'f1': 0.8790094, 'auroc': 0.98239976, 'binary_precision': 0.71934605, 'binary_recall': 0.82115084, 'binary_specificity': 0.9886495, 'binary_f1_score': 0.76688457}
confusion matrix:
       0    1
0  17943  206
1    115  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.8318411, 'recall': 0.6803229, 'specificity': 0.6803229, 'f1': 0.73141634, 'auroc': 0.96295255, 'binary_precision': 0.6906475, 'binary_recall': 0.3678161, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.48000002}
confusion matrix:
      0   1
0  5954  43
1   165  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_8.png
early stop counter: 1
val acc:0.9829182624816895, best validation acc: 0.9840889573097229, corresponding to test acc:                         0.9646852016448975 / 0.9753915071487427
after epoch: 8,now: 2024-06-07 04:58:19.526903,epoch time: 0:26:50.672152,used: 3:32:28.740560,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98894775, 'precision': 0.92352724, 'recall': 0.90235186, 'specificity': 0.90235186, 'f1': 0.91264635, 'auroc': 0.9912596, 'binary_precision': 0.85365856, 'binary_recall': 0.8095238, 'binary_specificity': 0.99517983, 'binary_f1_score': 0.8310056}
confusion matrix:
       0     1
0  42118   204
1    280  1190
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.9146631, 'recall': 0.8653001, 'specificity': 0.8653001, 'f1': 0.88829327, 'auroc': 0.9833162, 'binary_precision': 0.8386525, 'binary_recall': 0.7356143, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.7837614}
confusion matrix:
       0    1
0  18058   91
1    170  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.84009373, 'recall': 0.59411794, 'specificity': 0.59411794, 'f1': 0.64157856, 'auroc': 0.9607767, 'binary_precision': 0.71428573, 'binary_recall': 0.19157088, 'binary_specificity': 0.996665, 'binary_f1_score': 0.3021148}
confusion matrix:
      0   1
0  5977  20
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_9.png
better model found
persisted
after epoch: 9,now: 2024-06-07 05:25:04.300366,epoch time: 0:26:44.773463,used: 3:59:13.514023,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98725796, 'precision': 0.8939126, 'recall': 0.9155954, 'specificity': 0.9155954, 'f1': 0.9044387, 'auroc': 0.9921596, 'binary_precision': 0.7934363, 'binary_recall': 0.8387755, 'binary_specificity': 0.9924153, 'binary_f1_score': 0.8154762}
confusion matrix:
       0     1
0  42001   321
1    237  1233
---- Validation: 
scalar performance:
{'acc': 0.9850468, 'precision': 0.88626283, 'recall': 0.88800085, 'specificity': 0.88800085, 'f1': 0.8871298, 'auroc': 0.9845786, 'binary_precision': 0.78018576, 'binary_recall': 0.7838258, 'binary_specificity': 0.9921759, 'binary_f1_score': 0.7820016}
confusion matrix:
       0    1
0  18007  142
1    139  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.8512739, 'recall': 0.6828222, 'specificity': 0.6828222, 'f1': 0.7379434, 'auroc': 0.9615493, 'binary_precision': 0.7293233, 'binary_recall': 0.3716475, 'binary_specificity': 0.993997, 'binary_f1_score': 0.49238577}
confusion matrix:
      0   1
0  5961  36
1   164  97
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_10.png
early stop counter: 1
val acc:0.9850468039512634, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.963087260723114 / 0.9753915071487427
after epoch: 10,now: 2024-06-07 05:51:21.195984,epoch time: 0:26:16.895618,used: 4:25:30.409641,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9899525, 'precision': 0.9442353, 'recall': 0.8950622, 'specificity': 0.8950622, 'f1': 0.9180981, 'auroc': 0.9938855, 'binary_precision': 0.8956255, 'binary_recall': 0.7933379, 'binary_specificity': 0.9967865, 'binary_f1_score': 0.8413843}
confusion matrix:
       0     1
0  42185   136
1    304  1167
---- Validation: 
scalar performance:
{'acc': 0.98541933, 'precision': 0.91011816, 'recall': 0.8581915, 'specificity': 0.8581915, 'f1': 0.8822577, 'auroc': 0.9839568, 'binary_precision': 0.8300537, 'binary_recall': 0.7216174, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.7720466}
confusion matrix:
       0    1
0  18054   95
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.8790424, 'recall': 0.63443124, 'specificity': 0.63443124, 'f1': 0.693689, 'auroc': 0.9527508, 'binary_precision': 0.7888889, 'binary_recall': 0.27203065, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.4045584}
confusion matrix:
      0   1
0  5978  19
1   190  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_11.png
early stop counter: 2
val acc:0.9854193329811096, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.963087260723114 / 0.9753915071487427
after epoch: 11,now: 2024-06-07 06:17:38.718718,epoch time: 0:26:17.522734,used: 4:51:47.932375,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.990158, 'precision': 0.9329621, 'recall': 0.912171, 'specificity': 0.912171, 'f1': 0.92229056, 'auroc': 0.994812, 'binary_precision': 0.8718683, 'binary_recall': 0.82857144, 'binary_specificity': 0.9957705, 'binary_f1_score': 0.8496687}
confusion matrix:
       0     1
0  42143   179
1    252  1218
---- Validation: 
scalar performance:
{'acc': 0.9853661, 'precision': 0.9275808, 'recall': 0.8364123, 'specificity': 0.8364123, 'f1': 0.87613916, 'auroc': 0.98154765, 'binary_precision': 0.8665339, 'binary_recall': 0.67651635, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.7598253}
confusion matrix:
       0    1
0  18082   67
1    208  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8560934, 'recall': 0.5943681, 'specificity': 0.5943681, 'f1': 0.64308554, 'auroc': 0.95038056, 'binary_precision': 0.74626863, 'binary_recall': 0.19157088, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.30487803}
confusion matrix:
      0   1
0  5980  17
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_12.png
early stop counter: 3
val acc:0.9853661060333252, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.963087260723114 / 0.9753915071487427
after epoch: 12,now: 2024-06-07 06:43:55.353475,epoch time: 0:26:16.634757,used: 5:18:04.567132,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9880115, 'precision': 0.96766245, 'recall': 0.84035915, 'specificity': 0.84035915, 'f1': 0.89328146, 'auroc': 0.993956, 'binary_precision': 0.9462771, 'binary_recall': 0.6820652, 'binary_specificity': 0.9986531, 'binary_f1_score': 0.7927358}
confusion matrix:
       0     1
0  42263    57
1    468  1004
---- Validation: 
scalar performance:
{'acc': 0.9826522, 'precision': 0.9273802, 'recall': 0.7885039, 'specificity': 0.7885039, 'f1': 0.84348345, 'auroc': 0.98075116, 'binary_precision': 0.86946386, 'binary_recall': 0.5800933, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.6958955}
confusion matrix:
       0    1
0  18093   56
1    270  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.8986722, 'recall': 0.60253114, 'specificity': 0.60253114, 'f1': 0.6567024, 'auroc': 0.9492837, 'binary_precision': 0.83076924, 'binary_recall': 0.20689656, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.33128834}
confusion matrix:
      0   1
0  5986  11
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_13.png
early stop counter: 4
val acc:0.9826521873474121, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.963087260723114 / 0.9753915071487427
after epoch: 13,now: 2024-06-07 07:10:05.967331,epoch time: 0:26:10.613856,used: 5:44:15.180988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98686975, 'precision': 0.92680883, 'recall': 0.86009574, 'specificity': 0.86009574, 'f1': 0.8904066, 'auroc': 0.99346185, 'binary_precision': 0.86315787, 'binary_recall': 0.7241848, 'binary_specificity': 0.9960066, 'binary_f1_score': 0.7875877}
confusion matrix:
       0     1
0  42151   169
1    406  1066
---- Validation: 
scalar performance:
{'acc': 0.9835568, 'precision': 0.91821575, 'recall': 0.81372404, 'specificity': 0.81372404, 'f1': 0.8579395, 'auroc': 0.97959006, 'binary_precision': 0.8493724, 'binary_recall': 0.63141525, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.72435325}
confusion matrix:
       0    1
0  18077   72
1    237  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8956452, 'recall': 0.5550553, 'specificity': 0.5550553, 'f1': 0.58823484, 'auroc': 0.95000905, 'binary_precision': 0.82857144, 'binary_recall': 0.11111111, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.19594595}
confusion matrix:
      0   1
0  5991   6
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_14.png
early stop counter: 5
val acc:0.9835568070411682, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.963087260723114 / 0.9753915071487427
after epoch: 14,now: 2024-06-07 07:36:23.157454,epoch time: 0:26:17.190123,used: 6:10:32.371111,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99134547, 'precision': 0.949025, 'recall': 0.91388524, 'specificity': 0.91388524, 'f1': 0.93068457, 'auroc': 0.9959046, 'binary_precision': 0.9039172, 'binary_recall': 0.8308424, 'binary_specificity': 0.99692816, 'binary_f1_score': 0.8658407}
confusion matrix:
       0     1
0  42190   130
1    249  1223
---- Validation: 
scalar performance:
{'acc': 0.9864304, 'precision': 0.9266638, 'recall': 0.85646474, 'specificity': 0.85646474, 'f1': 0.8881717, 'auroc': 0.98383844, 'binary_precision': 0.86329585, 'binary_recall': 0.7169518, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.7833475}
confusion matrix:
       0    1
0  18076   73
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.86725396, 'recall': 0.60019857, 'specificity': 0.60019857, 'f1': 0.65141517, 'auroc': 0.9536713, 'binary_precision': 0.76811594, 'binary_recall': 0.20306513, 'binary_specificity': 0.997332, 'binary_f1_score': 0.3212121}
confusion matrix:
      0   1
0  5981  16
1   208  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_15.png
better model found
persisted
after epoch: 15,now: 2024-06-07 08:02:46.522306,epoch time: 0:26:23.364852,used: 6:36:55.735963,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99132264, 'precision': 0.9379095, 'recall': 0.9269878, 'specificity': 0.9269878, 'f1': 0.93237424, 'auroc': 0.99690807, 'binary_precision': 0.88075316, 'binary_recall': 0.8580163, 'binary_specificity': 0.99595934, 'binary_f1_score': 0.86923605}
confusion matrix:
       0     1
0  42149   171
1    209  1263
---- Validation: 
scalar performance:
{'acc': 0.98541933, 'precision': 0.9112538, 'recall': 0.85669136, 'specificity': 0.85669136, 'f1': 0.88187754, 'auroc': 0.9848487, 'binary_precision': 0.83243245, 'binary_recall': 0.718507, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.7712855}
confusion matrix:
       0    1
0  18056   93
1    181  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8253925, 'recall': 0.5619678, 'specificity': 0.5619678, 'f1': 0.5968428, 'auroc': 0.9449363, 'binary_precision': 0.6875, 'binary_recall': 0.12643678, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.21359225}
confusion matrix:
      0   1
0  5982  15
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_16.png
early stop counter: 1
val acc:0.9854193329811096, best validation acc: 0.9864304065704346, corresponding to test acc:                         0.964205801486969 / 0.9753915071487427
after epoch: 16,now: 2024-06-07 08:29:07.341896,epoch time: 0:26:20.819590,used: 7:03:16.555553,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9932636, 'precision': 0.9593215, 'recall': 0.93487716, 'specificity': 0.93487716, 'f1': 0.9467396, 'auroc': 0.9976592, 'binary_precision': 0.9230769, 'binary_recall': 0.8722826, 'binary_specificity': 0.99747163, 'binary_f1_score': 0.8969612}
confusion matrix:
       0     1
0  42213   107
1    188  1284
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.9271653, 'recall': 0.8549371, 'specificity': 0.8549371, 'f1': 0.8874556, 'auroc': 0.98308074, 'binary_precision': 0.86440676, 'binary_recall': 0.7138414, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.7819421}
confusion matrix:
       0    1
0  18077   72
1    184  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.8588392, 'recall': 0.6453418, 'specificity': 0.6453418, 'f1': 0.7028979, 'auroc': 0.9417211, 'binary_precision': 0.74757284, 'binary_recall': 0.29501915, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.4230769}
confusion matrix:
      0   1
0  5971  26
1   184  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_17.png
early stop counter: 2
val acc:0.9863771796226501, best validation acc: 0.9864304065704346, corresponding to test acc:                         0.964205801486969 / 0.9753915071487427
after epoch: 17,now: 2024-06-07 08:55:37.622297,epoch time: 0:26:30.280401,used: 7:29:46.835954,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98901623, 'precision': 0.89367634, 'recall': 0.95399046, 'specificity': 0.95399046, 'f1': 0.92149794, 'auroc': 0.9963881, 'binary_precision': 0.79027534, 'binary_recall': 0.9164402, 'binary_specificity': 0.9915407, 'binary_f1_score': 0.8486945}
confusion matrix:
       0     1
0  41962   358
1    123  1349
---- Validation: 
scalar performance:
{'acc': 0.98440826, 'precision': 0.8795244, 'recall': 0.8869202, 'specificity': 0.8869202, 'f1': 0.8831835, 'auroc': 0.98265105, 'binary_precision': 0.7667683, 'binary_recall': 0.7822706, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.7744419}
confusion matrix:
       0    1
0  17996  153
1    140  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.86060035, 'recall': 0.6585851, 'specificity': 0.6585851, 'f1': 0.71676, 'auroc': 0.94039273, 'binary_precision': 0.75, 'binary_recall': 0.3218391, 'binary_specificity': 0.995331, 'binary_f1_score': 0.45040217}
confusion matrix:
      0   1
0  5969  28
1   177  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_18.png
early stop counter: 3
val acc:0.9844082593917847, best validation acc: 0.9864304065704346, corresponding to test acc:                         0.964205801486969 / 0.9753915071487427
after epoch: 18,now: 2024-06-07 09:22:09.644507,epoch time: 0:26:32.022210,used: 7:56:18.858164,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98602486, 'precision': 0.88952327, 'recall': 0.8976902, 'specificity': 0.8976902, 'f1': 0.89356065, 'auroc': 0.9950003, 'binary_precision': 0.7859042, 'binary_recall': 0.8029891, 'binary_specificity': 0.9923913, 'binary_f1_score': 0.79435474}
confusion matrix:
       0     1
0  41998   322
1    290  1182
---- Validation: 
scalar performance:
{'acc': 0.9813218, 'precision': 0.8674005, 'recall': 0.840319, 'specificity': 0.840319, 'f1': 0.85329604, 'auroc': 0.97490615, 'binary_precision': 0.74579126, 'binary_recall': 0.688958, 'binary_specificity': 0.99167997, 'binary_f1_score': 0.716249}
confusion matrix:
       0    1
0  17998  151
1    200  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.91699445, 'recall': 0.57612807, 'specificity': 0.57612807, 'f1': 0.6209967, 'auroc': 0.9397143, 'binary_precision': 0.8695652, 'binary_recall': 0.1532567, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.2605863}
confusion matrix:
      0   1
0  5991   6
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_19.png
early stop counter: 4
val acc:0.9813218116760254, best validation acc: 0.9864304065704346, corresponding to test acc:                         0.964205801486969 / 0.9753915071487427
after epoch: 19,now: 2024-06-07 09:48:39.332664,epoch time: 0:26:29.688157,used: 8:22:48.546321,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99310374, 'precision': 0.9711727, 'recall': 0.9196048, 'specificity': 0.9196048, 'f1': 0.94378555, 'auroc': 0.9980972, 'binary_precision': 0.9478528, 'binary_recall': 0.8408163, 'binary_specificity': 0.9983933, 'binary_f1_score': 0.89113194}
confusion matrix:
       0     1
0  42254    68
1    234  1236
---- Validation: 
scalar performance:
{'acc': 0.9868029, 'precision': 0.9387844, 'recall': 0.8499071, 'specificity': 0.8499071, 'f1': 0.8889575, 'auroc': 0.9805476, 'binary_precision': 0.8880157, 'binary_recall': 0.7029549, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.78472227}
confusion matrix:
       0    1
0  18092   57
1    191  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.82381487, 'recall': 0.54505986, 'specificity': 0.54505986, 'f1': 0.57093376, 'auroc': 0.9346284, 'binary_precision': 0.6857143, 'binary_recall': 0.09195402, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.16216215}
confusion matrix:
      0   1
0  5986  11
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_20.png
better model found
persisted
after epoch: 20,now: 2024-06-07 10:14:52.626572,epoch time: 0:26:13.293908,used: 8:49:01.840229,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99388015, 'precision': 0.9742135, 'recall': 0.9292471, 'specificity': 0.9292471, 'f1': 0.9505282, 'auroc': 0.9982134, 'binary_precision': 0.95327806, 'binary_recall': 0.8599592, 'binary_specificity': 0.998535, 'binary_f1_score': 0.9042173}
confusion matrix:
       0     1
0  42259    62
1    206  1265
---- Validation: 
scalar performance:
{'acc': 0.98515326, 'precision': 0.929085, 'recall': 0.8310517, 'specificity': 0.8310517, 'f1': 0.87326527, 'auroc': 0.98086524, 'binary_precision': 0.8699187, 'binary_recall': 0.66562986, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.754185}
confusion matrix:
       0    1
0  18085   64
1    215  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.84521025, 'recall': 0.5603022, 'specificity': 0.5603022, 'f1': 0.59504986, 'auroc': 0.94349045, 'binary_precision': 0.72727275, 'binary_recall': 0.12260536, 'binary_specificity': 0.997999, 'binary_f1_score': 0.20983605}
confusion matrix:
      0   1
0  5985  12
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_21.png
early stop counter: 1
val acc:0.9851532578468323, best validation acc: 0.986802875995636, corresponding to test acc:                         0.9603707194328308 / 0.9753915071487427
after epoch: 21,now: 2024-06-07 10:41:16.968945,epoch time: 0:26:24.342373,used: 9:15:26.182602,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99490774, 'precision': 0.95346236, 'recall': 0.96980584, 'specificity': 0.96980584, 'f1': 0.961478, 'auroc': 0.9989355, 'binary_precision': 0.9089122, 'binary_recall': 0.942896, 'binary_specificity': 0.9967156, 'binary_f1_score': 0.92559224}
confusion matrix:
       0     1
0  42182   139
1     84  1387
---- Validation: 
scalar performance:
{'acc': 0.9871222, 'precision': 0.9195162, 'recall': 0.8778244, 'specificity': 0.8778244, 'f1': 0.8974922, 'auroc': 0.9810369, 'binary_precision': 0.847487, 'binary_recall': 0.7604977, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.8016393}
confusion matrix:
       0    1
0  18061   88
1    154  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.78377986, 'recall': 0.6747407, 'specificity': 0.6747407, 'f1': 0.7147958, 'auroc': 0.916521, 'binary_precision': 0.5949367, 'binary_recall': 0.36015326, 'binary_specificity': 0.989328, 'binary_f1_score': 0.44868734}
confusion matrix:
      0   1
0  5933  64
1   167  94
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_22.png
better model found
persisted
after epoch: 22,now: 2024-06-07 11:07:47.148769,epoch time: 0:26:30.179824,used: 9:41:56.362426,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9903179, 'precision': 0.97978926, 'recall': 0.86745334, 'specificity': 0.86745334, 'f1': 0.91565245, 'auroc': 0.9983337, 'binary_precision': 0.9686941, 'binary_recall': 0.7357337, 'binary_specificity': 0.999173, 'binary_f1_score': 0.8362935}
confusion matrix:
       0     1
0  42285    35
1    389  1083
---- Validation: 
scalar performance:
{'acc': 0.9818008, 'precision': 0.9363216, 'recall': 0.76631147, 'specificity': 0.76631147, 'f1': 0.82930255, 'auroc': 0.97809386, 'binary_precision': 0.8888889, 'binary_recall': 0.5349922, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.6679612}
confusion matrix:
       0    1
0  18106   43
1    299  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.818444, 'recall': 0.55813634, 'specificity': 0.55813634, 'f1': 0.59094363, 'auroc': 0.93126917, 'binary_precision': 0.67391306, 'binary_recall': 0.118773945, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.20195441}
confusion matrix:
      0   1
0  5982  15
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_23.png
early stop counter: 1
val acc:0.9818007946014404, best validation acc: 0.9871221780776978, corresponding to test acc:                         0.963087260723114 / 0.9753915071487427
after epoch: 23,now: 2024-06-07 11:34:05.333592,epoch time: 0:26:18.184823,used: 10:08:14.547249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9950676, 'precision': 0.9592974, 'recall': 0.96531785, 'specificity': 0.96531785, 'f1': 0.9622865, 'auroc': 0.99880946, 'binary_precision': 0.92091155, 'binary_recall': 0.93342394, 'binary_specificity': 0.9972117, 'binary_f1_score': 0.9271255}
confusion matrix:
       0     1
0  42202   118
1     98  1374
---- Validation: 
scalar performance:
{'acc': 0.98722863, 'precision': 0.91270757, 'recall': 0.88913035, 'specificity': 0.88913035, 'f1': 0.9005437, 'auroc': 0.98309696, 'binary_precision': 0.8330579, 'binary_recall': 0.7838258, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.8076923}
confusion matrix:
       0    1
0  18048  101
1    139  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.84904885, 'recall': 0.67899084, 'specificity': 0.67899084, 'f1': 0.73401636, 'auroc': 0.94799167, 'binary_precision': 0.7251908, 'binary_recall': 0.36398467, 'binary_specificity': 0.993997, 'binary_f1_score': 0.48469386}
confusion matrix:
      0   1
0  5961  36
1   166  95
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_24.png
better model found
persisted
after epoch: 24,now: 2024-06-07 12:00:26.084354,epoch time: 0:26:20.750762,used: 10:34:35.298011,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.993629, 'precision': 0.98584104, 'recall': 0.91441107, 'specificity': 0.91441107, 'f1': 0.94708824, 'auroc': 0.9990546, 'binary_precision': 0.97758204, 'binary_recall': 0.8294837, 'binary_specificity': 0.9993384, 'binary_f1_score': 0.89746416}
confusion matrix:
       0     1
0  42292    28
1    251  1221
---- Validation: 
scalar performance:
{'acc': 0.9850468, 'precision': 0.9324801, 'recall': 0.82574624, 'specificity': 0.82574624, 'f1': 0.8710352, 'auroc': 0.9793918, 'binary_precision': 0.87708336, 'binary_recall': 0.6547434, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.7497774}
confusion matrix:
       0    1
0  18090   59
1    222  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.7824944, 'recall': 0.6078595, 'specificity': 0.6078595, 'f1': 0.6520589, 'auroc': 0.93120813, 'binary_precision': 0.5979381, 'binary_recall': 0.22222222, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.32402235}
confusion matrix:
      0   1
0  5958  39
1   203  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_25.png
early stop counter: 1
val acc:0.9850468039512634, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9677213430404663 / 0.9753915071487427
after epoch: 25,now: 2024-06-07 12:27:15.232452,epoch time: 0:26:49.148098,used: 11:01:24.446109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9935833, 'precision': 0.9907284, 'recall': 0.9094081, 'specificity': 0.9094081, 'f1': 0.9461339, 'auroc': 0.999476, 'binary_precision': 0.98770493, 'binary_recall': 0.81917065, 'binary_specificity': 0.9996456, 'binary_f1_score': 0.89557785}
confusion matrix:
       0     1
0  42306    15
1    266  1205
---- Validation: 
scalar performance:
{'acc': 0.9841954, 'precision': 0.95786035, 'recall': 0.7900529, 'specificity': 0.7900529, 'f1': 0.8538306, 'auroc': 0.9806696, 'binary_precision': 0.9303483, 'binary_recall': 0.5816485, 'binary_specificity': 0.9984572, 'binary_f1_score': 0.71578956}
confusion matrix:
       0    1
0  18121   28
1    269  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.8185448, 'recall': 0.55438834, 'specificity': 0.55438834, 'f1': 0.58532274, 'auroc': 0.93854904, 'binary_precision': 0.6744186, 'binary_recall': 0.11111111, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.19078949}
confusion matrix:
      0   1
0  5983  14
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_26.png
early stop counter: 2
val acc:0.9841954112052917, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9677213430404663 / 0.9753915071487427
after epoch: 26,now: 2024-06-07 12:54:00.910515,epoch time: 0:26:45.678063,used: 11:28:10.124172,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.994314, 'precision': 0.9602175, 'recall': 0.9514536, 'specificity': 0.9514536, 'f1': 0.95579016, 'auroc': 0.9990053, 'binary_precision': 0.9237171, 'binary_recall': 0.90550643, 'binary_specificity': 0.9974008, 'binary_f1_score': 0.9145211}
confusion matrix:
       0     1
0  42211   110
1    139  1332
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.9077151, 'recall': 0.86657983, 'specificity': 0.86657983, 'f1': 0.885965, 'auroc': 0.98417807, 'binary_precision': 0.8246528, 'binary_recall': 0.7387247, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.77932733}
confusion matrix:
       0    1
0  18048  101
1    168  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9696389, 'precision': 0.84230125, 'recall': 0.72763205, 'specificity': 0.72763205, 'f1': 0.772231, 'auroc': 0.9538641, 'binary_precision': 0.7076023, 'binary_recall': 0.46360153, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.5601852}
confusion matrix:
      0    1
0  5947   50
1   140  121
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_27.png
early stop counter: 3
val acc:0.985685408115387, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9677213430404663 / 0.9753915071487427
after epoch: 27,now: 2024-06-07 13:20:27.565936,epoch time: 0:26:26.655421,used: 11:54:36.779593,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99502194, 'precision': 0.96507674, 'recall': 0.9577534, 'specificity': 0.9577534, 'f1': 0.9613838, 'auroc': 0.9986414, 'binary_precision': 0.93301105, 'binary_recall': 0.91779894, 'binary_specificity': 0.99770796, 'binary_f1_score': 0.92534244}
confusion matrix:
       0     1
0  42223    97
1    121  1351
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.90825415, 'recall': 0.8781613, 'specificity': 0.8781613, 'f1': 0.8925843, 'auroc': 0.9774027, 'binary_precision': 0.8249158, 'binary_recall': 0.7620529, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.79223937}
confusion matrix:
       0    1
0  18045  104
1    153  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.8208196, 'recall': 0.6162727, 'specificity': 0.6162727, 'f1': 0.66622365, 'auroc': 0.9236384, 'binary_precision': 0.67391306, 'binary_recall': 0.23754789, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.35127482}
confusion matrix:
      0   1
0  5967  30
1   199  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_28.png
early stop counter: 4
val acc:0.9863239526748657, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9677213430404663 / 0.9753915071487427
after epoch: 28,now: 2024-06-07 13:46:59.045555,epoch time: 0:26:31.479619,used: 12:21:08.259212,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9934691, 'precision': 0.9330267, 'recall': 0.97267044, 'specificity': 0.97267044, 'f1': 0.95190924, 'auroc': 0.9987789, 'binary_precision': 0.86778396, 'binary_recall': 0.9503739, 'binary_specificity': 0.99496704, 'binary_f1_score': 0.907203}
confusion matrix:
       0     1
0  42108   213
1     73  1398
---- Validation: 
scalar performance:
{'acc': 0.9830779, 'precision': 0.8641683, 'recall': 0.8892317, 'specificity': 0.8892317, 'f1': 0.87624466, 'auroc': 0.97497, 'binary_precision': 0.7358491, 'binary_recall': 0.7884914, 'binary_specificity': 0.9899719, 'binary_f1_score': 0.7612613}
confusion matrix:
       0    1
0  17967  182
1    136  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.79553545, 'recall': 0.6752409, 'specificity': 0.6752409, 'f1': 0.71830773, 'auroc': 0.9197865, 'binary_precision': 0.6184211, 'binary_recall': 0.36015326, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.4552058}
confusion matrix:
      0   1
0  5939  58
1   167  94
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_29.png
early stop counter: 5
val acc:0.983077883720398, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9677213430404663 / 0.9753915071487427
after epoch: 29,now: 2024-06-07 14:14:21.361738,epoch time: 0:27:22.316183,used: 12:48:30.575395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99561566, 'precision': 0.96595156, 'recall': 0.96656305, 'specificity': 0.96656305, 'f1': 0.9662571, 'auroc': 0.9989704, 'binary_precision': 0.934148, 'binary_recall': 0.93541807, 'binary_specificity': 0.997708, 'binary_f1_score': 0.9347826}
confusion matrix:
       0     1
0  42224    97
1     95  1376
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.89837873, 'recall': 0.87622035, 'specificity': 0.87622035, 'f1': 0.88695586, 'auroc': 0.97653925, 'binary_precision': 0.8052805, 'binary_recall': 0.7589425, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.7814251}
confusion matrix:
       0    1
0  18031  118
1    155  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.86969167, 'recall': 0.66258323, 'specificity': 0.66258323, 'f1': 0.7222866, 'auroc': 0.9384948, 'binary_precision': 0.76785713, 'binary_recall': 0.32950193, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.461126}
confusion matrix:
      0   1
0  5971  26
1   175  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_30.png
early stop counter: 6
val acc:0.985472559928894, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9677213430404663 / 0.9753915071487427
after epoch: 30,now: 2024-06-07 14:41:00.677371,epoch time: 0:26:39.315633,used: 13:15:09.891028,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:15:09.891028 at 2024-06-07 14:41:00.677371
persisted model performance metric: 

scalar performance:
{'acc': 0.9654842, 'precision': 0.8230145, 'recall': 0.6631649, 'specificity': 0.6631649, 'f1': 0.71417046, 'auroc': 0.95151055, 'binary_precision': 0.6744186, 'binary_recall': 0.33333334, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.44615388}
confusion matrix:
      0   1
0  5955  42
1   174  87
oracle model performance metric: 

scalar performance:
{'acc': 0.97619045, 'precision': 0.9753989, 'recall': 0.7200564, 'specificity': 0.7200564, 'f1': 0.7972919, 'auroc': 0.95847285, 'binary_precision': 0.9745763, 'binary_recall': 0.44061303, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.6068602}
confusion matrix:
      0    1
0  5994    3
1   146  115
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455924 KiB |   2003 MiB |    933 TiB |    933 TiB |
|       from large pool | 414237 KiB |   1971 MiB |    921 TiB |    921 TiB |
|       from small pool |  41687 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 455924 KiB |   2003 MiB |    933 TiB |    933 TiB |
|       from large pool | 414237 KiB |   1971 MiB |    921 TiB |    921 TiB |
|       from small pool |  41687 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |   1998 MiB |    932 TiB |    932 TiB |
|       from large pool | 407075 KiB |   1966 MiB |    920 TiB |    920 TiB |
|       from small pool |  40679 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2282 MiB |   2282 MiB |   2282 MiB |      0 B   |
|       from large pool |   2212 MiB |   2212 MiB |   2212 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 332555 KiB | 366275 KiB | 765502 GiB | 765502 GiB |
|       from large pool | 323043 KiB | 360722 KiB | 752507 GiB | 752507 GiB |
|       from small pool |   9512 KiB |  14571 KiB |  12994 GiB |  12994 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6459    |  180478 K  |  180475 K  |
|       from large pool |     187    |     311    |   87857 K  |   87857 K  |
|       from small pool |    3301    |    6271    |   92621 K  |   92618 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6459    |  180478 K  |  180475 K  |
|       from large pool |     187    |     311    |   87857 K  |   87857 K  |
|       from small pool |    3301    |    6271    |   92621 K  |   92618 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     127    |     127    |     127    |       0    |
|       from large pool |      92    |      92    |      92    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      63    |    2787    |   91357 K  |   91357 K  |
|       from large pool |      32    |      88    |   55392 K  |   55392 K  |
|       from small pool |      31    |    2755    |   35964 K  |   35964 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |    933 TiB |    933 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    921 TiB |    921 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |    933 TiB |    933 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    921 TiB |    921 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |    932 TiB |    932 TiB |
|       from large pool |  16640 KiB |   1966 MiB |    920 TiB |    920 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    770 MiB |   2282 MiB |   2282 MiB |   1512 MiB |
|       from large pool |    720 MiB |   2212 MiB |   2212 MiB |   1492 MiB |
|       from small pool |     50 MiB |     70 MiB |     70 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 428787 KiB | 765503 GiB | 765503 GiB |
|       from large pool |  24320 KiB | 408037 KiB | 752508 GiB | 752508 GiB |
|       from small pool |      0 KiB |  21494 KiB |  12994 GiB |  12994 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6459    |  180478 K  |  180478 K  |
|       from large pool |       2    |     311    |   87857 K  |   87857 K  |
|       from small pool |       0    |    6271    |   92621 K  |   92621 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6459    |  180478 K  |  180478 K  |
|       from large pool |       2    |     311    |   87857 K  |   87857 K  |
|       from small pool |       0    |    6271    |   92621 K  |   92621 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     127    |      69    |
|       from large pool |      33    |      92    |      92    |      59    |
|       from small pool |      25    |      35    |      35    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2787    |   91358 K  |   91358 K  |
|       from large pool |       3    |      88    |   55392 K  |   55392 K  |
|       from small pool |       0    |    2755    |   35966 K  |   35966 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |    933 TiB |    933 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    921 TiB |    921 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |    933 TiB |    933 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    921 TiB |    921 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |    932 TiB |    932 TiB |
|       from large pool |  16640 KiB |   1966 MiB |    920 TiB |    920 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    770 MiB |   2282 MiB |   2282 MiB |   1512 MiB |
|       from large pool |    720 MiB |   2212 MiB |   2212 MiB |   1492 MiB |
|       from small pool |     50 MiB |     70 MiB |     70 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 428787 KiB | 765503 GiB | 765503 GiB |
|       from large pool |  24320 KiB | 408037 KiB | 752508 GiB | 752508 GiB |
|       from small pool |      0 KiB |  21494 KiB |  12994 GiB |  12994 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6459    |  180478 K  |  180478 K  |
|       from large pool |       2    |     311    |   87857 K  |   87857 K  |
|       from small pool |       0    |    6271    |   92621 K  |   92621 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6459    |  180478 K  |  180478 K  |
|       from large pool |       2    |     311    |   87857 K  |   87857 K  |
|       from small pool |       0    |    6271    |   92621 K  |   92621 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     127    |      69    |
|       from large pool |      33    |      92    |      92    |      59    |
|       from small pool |      25    |      35    |      35    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2787    |   91358 K  |   91358 K  |
|       from large pool |       3    |      88    |   55392 K  |   55392 K  |
|       from small pool |       0    |    2755    |   35966 K  |   35966 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180

 Experiment start at: 2024-06-07 14:51:30.713962
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9725237, 'precision': 0.8302778, 'recall': 0.65050775, 'specificity': 0.65050775, 'f1': 0.70427155, 'auroc': 0.96347463, 'binary_precision': 0.68372095, 'binary_recall': 0.30582523, 'binary_specificity': 0.99519026, 'binary_f1_score': 0.42261618}
confusion matrix:
       0    1
0  42210  204
1   1001  441
---- Validation: 
scalar performance:
{'acc': 0.96947706, 'precision': 0.83133376, 'recall': 0.6344043, 'specificity': 0.6344043, 'f1': 0.68791765, 'auroc': 0.96057236, 'binary_precision': 0.6891386, 'binary_recall': 0.27340266, 'binary_specificity': 0.995406, 'binary_f1_score': 0.39148936}
confusion matrix:
       0    1
0  17984   83
1    489  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.8916141, 'recall': 0.58569753, 'specificity': 0.58569753, 'f1': 0.6335573, 'auroc': 0.95191014, 'binary_precision': 0.8181818, 'binary_recall': 0.17307693, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.28571427}
confusion matrix:
      0   1
0  5936  10
1   215  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-07 15:19:06.597665,epoch time: 0:27:35.883703,used: 0:27:35.883703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9764, 'precision': 0.8063721, 'recall': 0.85070515, 'specificity': 0.85070515, 'f1': 0.8268945, 'auroc': 0.97225595, 'binary_precision': 0.62243664, 'binary_recall': 0.7161693, 'binary_specificity': 0.98524106, 'binary_f1_score': 0.6660213}
confusion matrix:
       0     1
0  41789   626
1    409  1032
---- Validation: 
scalar performance:
{'acc': 0.97321236, 'precision': 0.80412316, 'recall': 0.81801945, 'specificity': 0.81801945, 'f1': 0.8108995, 'auroc': 0.9723262, 'binary_precision': 0.6212766, 'binary_recall': 0.6508172, 'binary_specificity': 0.9852217, 'binary_f1_score': 0.635704}
confusion matrix:
       0    1
0  17800  267
1    235  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.7665709, 'recall': 0.54464024, 'specificity': 0.54464024, 'f1': 0.568983, 'auroc': 0.9589121, 'binary_precision': 0.5714286, 'binary_recall': 0.092307694, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.1589404}
confusion matrix:
      0   1
0  5928  18
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_2.png
better model found
persisted
after epoch: 2,now: 2024-06-07 15:45:50.564037,epoch time: 0:26:43.966372,used: 0:54:19.850075,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97975194, 'precision': 0.9021368, 'recall': 0.7436769, 'specificity': 0.7436769, 'f1': 0.802093, 'auroc': 0.9792209, 'binary_precision': 0.8213457, 'binary_recall': 0.49098474, 'binary_specificity': 0.9963691, 'binary_f1_score': 0.61458325}
confusion matrix:
       0    1
0  42260  154
1    734  708
---- Validation: 
scalar performance:
{'acc': 0.9729989, 'precision': 0.9119842, 'recall': 0.6498209, 'specificity': 0.6498209, 'f1': 0.7156691, 'auroc': 0.9724618, 'binary_precision': 0.8493724, 'binary_recall': 0.30163446, 'binary_specificity': 0.9980074, 'binary_f1_score': 0.44517544}
confusion matrix:
       0    1
0  18031   36
1    470  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.819781, 'recall': 0.5357817, 'specificity': 0.5357817, 'f1': 0.55566216, 'auroc': 0.96395767, 'binary_precision': 0.6785714, 'binary_recall': 0.073076926, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.13194445}
confusion matrix:
      0   1
0  5937   9
1   241  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_3.png
early stop counter: 1
val acc:0.9729989171028137, best validation acc: 0.9732123613357544, corresponding to test acc:                         0.9590718746185303 / 0.9637447595596313
after epoch: 3,now: 2024-06-07 16:12:37.730801,epoch time: 0:26:47.166764,used: 1:21:07.016839,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98132527, 'precision': 0.8892567, 'recall': 0.79004383, 'specificity': 0.79004383, 'f1': 0.83185136, 'auroc': 0.9814757, 'binary_precision': 0.7924883, 'binary_recall': 0.5852982, 'binary_specificity': 0.9947895, 'binary_f1_score': 0.67331475}
confusion matrix:
       0    1
0  42193  221
1    598  844
---- Validation: 
scalar performance:
{'acc': 0.9775347, 'precision': 0.87715805, 'recall': 0.7630397, 'specificity': 0.7630397, 'f1': 0.80907166, 'auroc': 0.9733244, 'binary_precision': 0.7715517, 'binary_recall': 0.5319465, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.6297273}
confusion matrix:
       0    1
0  17961  106
1    315  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.8777279, 'recall': 0.63301766, 'specificity': 0.63301766, 'f1': 0.6919102, 'auroc': 0.9610766, 'binary_precision': 0.78651685, 'binary_recall': 0.26923078, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.40114614}
confusion matrix:
      0   1
0  5927  19
1   190  70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-07 16:39:33.719416,epoch time: 0:26:55.988615,used: 1:48:03.005454,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9832178, 'precision': 0.91827273, 'recall': 0.79537666, 'specificity': 0.79537666, 'f1': 0.8454798, 'auroc': 0.98497295, 'binary_precision': 0.8501984, 'binary_recall': 0.59431344, 'binary_specificity': 0.9964399, 'binary_f1_score': 0.69959176}
confusion matrix:
       0    1
0  42263  151
1    585  857
---- Validation: 
scalar performance:
{'acc': 0.98127, 'precision': 0.9299474, 'recall': 0.7771365, 'specificity': 0.7771365, 'f1': 0.83577526, 'auroc': 0.97544074, 'binary_precision': 0.87616825, 'binary_recall': 0.5572065, 'binary_specificity': 0.9970665, 'binary_f1_score': 0.6811989}
confusion matrix:
       0    1
0  18014   53
1    298  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.8302468, 'recall': 0.5735705, 'specificity': 0.5735705, 'f1': 0.61357975, 'auroc': 0.9647732, 'binary_precision': 0.6964286, 'binary_recall': 0.15, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.24683544}
confusion matrix:
      0   1
0  5929  17
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_5.png
better model found
persisted
after epoch: 5,now: 2024-06-07 17:06:12.794922,epoch time: 0:26:39.075506,used: 2:14:42.080960,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9841755, 'precision': 0.88687074, 'recall': 0.85515827, 'specificity': 0.85515827, 'f1': 0.8702817, 'auroc': 0.9844142, 'binary_precision': 0.78333336, 'binary_recall': 0.7170596, 'binary_specificity': 0.9932569, 'binary_f1_score': 0.7487328}
confusion matrix:
       0     1
0  42128   286
1    408  1034
---- Validation: 
scalar performance:
{'acc': 0.98164356, 'precision': 0.89603186, 'recall': 0.81953096, 'specificity': 0.81953096, 'f1': 0.8533433, 'auroc': 0.9792863, 'binary_precision': 0.8051948, 'binary_recall': 0.6448737, 'binary_specificity': 0.9941883, 'binary_f1_score': 0.71617156}
confusion matrix:
       0    1
0  17962  105
1    239  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.795204, 'recall': 0.55994076, 'specificity': 0.55994076, 'f1': 0.5926881, 'auroc': 0.9475631, 'binary_precision': 0.627451, 'binary_recall': 0.12307692, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.20578778}
confusion matrix:
      0   1
0  5927  19
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_6.png
better model found
persisted
after epoch: 6,now: 2024-06-07 17:32:37.926020,epoch time: 0:26:25.131098,used: 2:41:07.212058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9845631, 'precision': 0.9323419, 'recall': 0.80679065, 'specificity': 0.80679065, 'f1': 0.85814774, 'auroc': 0.9875885, 'binary_precision': 0.8775913, 'binary_recall': 0.61650485, 'binary_specificity': 0.99707645, 'binary_f1_score': 0.72423625}
confusion matrix:
       0    1
0  42290  124
1    553  889
---- Validation: 
scalar performance:
{'acc': 0.9810032, 'precision': 0.914863, 'recall': 0.7862966, 'specificity': 0.7862966, 'f1': 0.8378591, 'auroc': 0.9793638, 'binary_precision': 0.84531593, 'binary_recall': 0.576523, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.68551236}
confusion matrix:
       0    1
0  17996   71
1    285  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.8311871, 'recall': 0.5528371, 'specificity': 0.5528371, 'f1': 0.58326066, 'auroc': 0.9538413, 'binary_precision': 0.7, 'binary_recall': 0.10769231, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.18666667}
confusion matrix:
      0   1
0  5934  12
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_7.png
early stop counter: 1
val acc:0.9810032248497009, best validation acc: 0.981643557548523, corresponding to test acc:                         0.9601998329162598 / 0.9663228988647461
after epoch: 7,now: 2024-06-07 17:59:08.788603,epoch time: 0:26:30.862583,used: 3:07:38.074641,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9875958, 'precision': 0.9303998, 'recall': 0.86429554, 'specificity': 0.86429554, 'f1': 0.8943925, 'auroc': 0.9893483, 'binary_precision': 0.8698517, 'binary_recall': 0.73231626, 'binary_specificity': 0.9962748, 'binary_f1_score': 0.7951807}
confusion matrix:
       0     1
0  42256   158
1    386  1056
---- Validation: 
scalar performance:
{'acc': 0.984952, 'precision': 0.916482, 'recall': 0.8541491, 'specificity': 0.8541491, 'f1': 0.8825825, 'auroc': 0.9825529, 'binary_precision': 0.84358525, 'binary_recall': 0.71322435, 'binary_specificity': 0.9950739, 'binary_f1_score': 0.77294683}
confusion matrix:
       0    1
0  17978   89
1    193  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.7980951, 'recall': 0.54873866, 'specificity': 0.54873866, 'f1': 0.57609886, 'auroc': 0.96066475, 'binary_precision': 0.63414633, 'binary_recall': 0.1, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.17275748}
confusion matrix:
      0   1
0  5931  15
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_8.png
better model found
persisted
after epoch: 8,now: 2024-06-07 18:25:53.079415,epoch time: 0:26:44.290812,used: 3:34:22.365453,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98647845, 'precision': 0.8882538, 'recall': 0.9035772, 'specificity': 0.9035772, 'f1': 0.8957547, 'auroc': 0.99135613, 'binary_precision': 0.78281146, 'binary_recall': 0.8148405, 'binary_specificity': 0.99231386, 'binary_f1_score': 0.79850495}
confusion matrix:
       0     1
0  42088   326
1    267  1175
---- Validation: 
scalar performance:
{'acc': 0.98052293, 'precision': 0.8588953, 'recall': 0.86043537, 'specificity': 0.86043537, 'f1': 0.8596635, 'auroc': 0.97921395, 'binary_precision': 0.7278106, 'binary_recall': 0.73105496, 'binary_specificity': 0.9898157, 'binary_f1_score': 0.7294291}
confusion matrix:
       0    1
0  17883  184
1    181  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.8117602, 'recall': 0.66527855, 'specificity': 0.66527855, 'f1': 0.7136727, 'auroc': 0.9571051, 'binary_precision': 0.65185183, 'binary_recall': 0.33846155, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.44556963}
confusion matrix:
      0   1
0  5899  47
1   172  88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_9.png
early stop counter: 1
val acc:0.9805229306221008, best validation acc: 0.9849519729614258, corresponding to test acc:                         0.9598775506019592 / 0.9663228988647461
after epoch: 9,now: 2024-06-07 18:52:35.153660,epoch time: 0:26:42.074245,used: 4:01:04.439698,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98843944, 'precision': 0.90964776, 'recall': 0.9082755, 'specificity': 0.9082755, 'f1': 0.90896034, 'auroc': 0.99164104, 'binary_precision': 0.82533056, 'binary_recall': 0.8224688, 'binary_specificity': 0.99408215, 'binary_f1_score': 0.8238972}
confusion matrix:
       0     1
0  42163   251
1    256  1186
---- Validation: 
scalar performance:
{'acc': 0.9838314, 'precision': 0.89428186, 'recall': 0.864297, 'specificity': 0.864297, 'f1': 0.878644, 'auroc': 0.97987044, 'binary_precision': 0.7983871, 'binary_recall': 0.7355126, 'binary_specificity': 0.99308133, 'binary_f1_score': 0.7656612}
confusion matrix:
       0    1
0  17942  125
1    178  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.820706, 'recall': 0.6091839, 'specificity': 0.6091839, 'f1': 0.6580992, 'auroc': 0.9591592, 'binary_precision': 0.6744186, 'binary_recall': 0.22307692, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.33526012}
confusion matrix:
      0   1
0  5918  28
1   202  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_10.png
early stop counter: 2
val acc:0.9838314056396484, best validation acc: 0.9849519729614258, corresponding to test acc:                         0.9598775506019592 / 0.9663228988647461
after epoch: 10,now: 2024-06-07 19:19:21.301674,epoch time: 0:26:46.148014,used: 4:27:50.587712,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98830265, 'precision': 0.8971089, 'recall': 0.9265788, 'specificity': 0.9265788, 'f1': 0.9112724, 'auroc': 0.9937087, 'binary_precision': 0.7989691, 'binary_recall': 0.8605135, 'binary_specificity': 0.99264413, 'binary_f1_score': 0.8286001}
confusion matrix:
       0     1
0  42103   312
1    201  1240
---- Validation: 
scalar performance:
{'acc': 0.98623264, 'precision': 0.90690136, 'recall': 0.8905767, 'specificity': 0.8905767, 'f1': 0.8985572, 'auroc': 0.984192, 'binary_precision': 0.8217054, 'binary_recall': 0.78751856, 'binary_specificity': 0.9936348, 'binary_f1_score': 0.80424887}
confusion matrix:
       0    1
0  17952  115
1    143  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.8026577, 'recall': 0.64997804, 'specificity': 0.64997804, 'f1': 0.6978576, 'auroc': 0.9569467, 'binary_precision': 0.63492066, 'binary_recall': 0.30769232, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.41450778}
confusion matrix:
      0   1
0  5900  46
1   180  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_11.png
better model found
persisted
after epoch: 11,now: 2024-06-07 19:46:04.235176,epoch time: 0:26:42.933502,used: 4:54:33.521214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9891691, 'precision': 0.9038938, 'recall': 0.93276924, 'specificity': 0.93276924, 'f1': 0.91779184, 'auroc': 0.994423, 'binary_precision': 0.8121369, 'binary_recall': 0.87239945, 'binary_specificity': 0.993139, 'binary_f1_score': 0.8411903}
confusion matrix:
       0     1
0  42123   291
1    184  1258
---- Validation: 
scalar performance:
{'acc': 0.9848452, 'precision': 0.88481516, 'recall': 0.9013014, 'specificity': 0.9013014, 'f1': 0.8928693, 'auroc': 0.9826765, 'binary_precision': 0.7766714, 'binary_recall': 0.8112927, 'binary_specificity': 0.9913101, 'binary_f1_score': 0.79360473}
confusion matrix:
       0    1
0  17910  157
1    127  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7402033, 'recall': 0.60139656, 'specificity': 0.60139656, 'f1': 0.63919544, 'auroc': 0.9495976, 'binary_precision': 0.5140187, 'binary_recall': 0.21153846, 'binary_specificity': 0.9912546, 'binary_f1_score': 0.2997275}
confusion matrix:
      0   1
0  5894  52
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_12.png
early stop counter: 1
val acc:0.9848452210426331, best validation acc: 0.9862326383590698, corresponding to test acc:                         0.9635836482048035 / 0.9663228988647461
after epoch: 12,now: 2024-06-07 20:12:16.459549,epoch time: 0:26:12.224373,used: 5:20:45.745587,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9884166, 'precision': 0.91967905, 'recall': 0.89319086, 'specificity': 0.89319086, 'f1': 0.9059696, 'auroc': 0.99383914, 'binary_precision': 0.8464392, 'binary_recall': 0.79126215, 'binary_specificity': 0.9951195, 'binary_f1_score': 0.81792116}
confusion matrix:
       0     1
0  42207   207
1    301  1141
---- Validation: 
scalar performance:
{'acc': 0.98340446, 'precision': 0.90414405, 'recall': 0.84190226, 'specificity': 0.84190226, 'f1': 0.87020487, 'auroc': 0.9796585, 'binary_precision': 0.819788, 'binary_recall': 0.6894502, 'binary_specificity': 0.99435437, 'binary_f1_score': 0.74899113}
confusion matrix:
       0    1
0  17965  102
1    209  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.7182875, 'recall': 0.5896058, 'specificity': 0.5896058, 'f1': 0.6235762, 'auroc': 0.9526721, 'binary_precision': 0.47115386, 'binary_recall': 0.18846154, 'binary_specificity': 0.9907501, 'binary_f1_score': 0.26923078}
confusion matrix:
      0   1
0  5891  55
1   211  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_13.png
early stop counter: 2
val acc:0.9834044575691223, best validation acc: 0.9862326383590698, corresponding to test acc:                         0.9635836482048035 / 0.9663228988647461
after epoch: 13,now: 2024-06-07 20:38:19.872231,epoch time: 0:26:03.412682,used: 5:46:49.158269,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9887131, 'precision': 0.8941814, 'recall': 0.9412422, 'specificity': 0.9412422, 'f1': 0.91627306, 'auroc': 0.99402344, 'binary_precision': 0.79210365, 'binary_recall': 0.89043, 'binary_specificity': 0.9920545, 'binary_f1_score': 0.83839375}
confusion matrix:
       0     1
0  42077   337
1    158  1284
---- Validation: 
scalar performance:
{'acc': 0.9851121, 'precision': 0.8918903, 'recall': 0.89357185, 'specificity': 0.89357185, 'f1': 0.8927291, 'auroc': 0.98088115, 'binary_precision': 0.7914201, 'binary_recall': 0.794948, 'binary_specificity': 0.9921957, 'binary_f1_score': 0.7931801}
confusion matrix:
       0    1
0  17926  141
1    138  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.82935965, 'recall': 0.63008547, 'specificity': 0.63008547, 'f1': 0.68245655, 'auroc': 0.95532227, 'binary_precision': 0.69, 'binary_recall': 0.2653846, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.38333333}
confusion matrix:
      0   1
0  5915  31
1   191  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_14.png
early stop counter: 3
val acc:0.9851120710372925, best validation acc: 0.9862326383590698, corresponding to test acc:                         0.9635836482048035 / 0.9663228988647461
after epoch: 14,now: 2024-06-07 21:04:38.784969,epoch time: 0:26:18.912738,used: 6:13:08.071007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98711693, 'precision': 0.8828162, 'recall': 0.92902863, 'specificity': 0.92902863, 'f1': 0.904493, 'auroc': 0.9938042, 'binary_precision': 0.7701787, 'binary_recall': 0.86685157, 'binary_specificity': 0.99120575, 'binary_f1_score': 0.8156607}
confusion matrix:
       0     1
0  42041   373
1    192  1250
---- Validation: 
scalar performance:
{'acc': 0.9861793, 'precision': 0.9004203, 'recall': 0.8998475, 'specificity': 0.8998475, 'f1': 0.90013367, 'auroc': 0.98107326, 'binary_precision': 0.80803573, 'binary_recall': 0.80683506, 'binary_specificity': 0.9928599, 'binary_f1_score': 0.8074349}
confusion matrix:
       0    1
0  17938  129
1    130  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7785567, 'recall': 0.54664737, 'specificity': 0.54664737, 'f1': 0.57237685, 'auroc': 0.95314866, 'binary_precision': 0.5952381, 'binary_recall': 0.09615385, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.16556291}
confusion matrix:
      0   1
0  5929  17
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_15.png
early stop counter: 4
val acc:0.9861792922019958, best validation acc: 0.9862326383590698, corresponding to test acc:                         0.9635836482048035 / 0.9663228988647461
after epoch: 15,now: 2024-06-07 21:31:01.671730,epoch time: 0:26:22.886761,used: 6:39:30.957768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99117565, 'precision': 0.9655744, 'recall': 0.8905978, 'specificity': 0.8905978, 'f1': 0.9245685, 'auroc': 0.99617064, 'binary_precision': 0.9384871, 'binary_recall': 0.7829404, 'binary_specificity': 0.9982553, 'binary_f1_score': 0.8536863}
confusion matrix:
       0     1
0  42340    74
1    313  1129
---- Validation: 
scalar performance:
{'acc': 0.9848452, 'precision': 0.9432547, 'recall': 0.8240526, 'specificity': 0.8240526, 'f1': 0.87367654, 'auroc': 0.9828927, 'binary_precision': 0.89938396, 'binary_recall': 0.6508172, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.7551724}
confusion matrix:
       0    1
0  18018   49
1    235  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.7757179, 'recall': 0.5820086, 'specificity': 0.5820086, 'f1': 0.62111723, 'auroc': 0.9547818, 'binary_precision': 0.58666664, 'binary_recall': 0.16923077, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.26268658}
confusion matrix:
      0   1
0  5915  31
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_16.png
early stop counter: 5
val acc:0.9848452210426331, best validation acc: 0.9862326383590698, corresponding to test acc:                         0.9635836482048035 / 0.9663228988647461
after epoch: 16,now: 2024-06-07 21:57:25.024125,epoch time: 0:26:23.352395,used: 7:05:54.310163,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9914493, 'precision': 0.95571744, 'recall': 0.9051422, 'specificity': 0.9051422, 'f1': 0.92883474, 'auroc': 0.996266, 'binary_precision': 0.91777605, 'binary_recall': 0.81276006, 'binary_specificity': 0.9975244, 'binary_f1_score': 0.86208165}
confusion matrix:
       0     1
0  42309   105
1    270  1172
---- Validation: 
scalar performance:
{'acc': 0.9863394, 'precision': 0.95141673, 'recall': 0.8405633, 'specificity': 0.8405633, 'f1': 0.8876307, 'auroc': 0.9787148, 'binary_precision': 0.91451293, 'binary_recall': 0.68350667, 'binary_specificity': 0.99762, 'binary_f1_score': 0.7823129}
confusion matrix:
       0    1
0  18024   43
1    213  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7452984, 'recall': 0.5517439, 'specificity': 0.5517439, 'f1': 0.57883614, 'auroc': 0.93820155, 'binary_precision': 0.5283019, 'binary_recall': 0.10769231, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.17891374}
confusion matrix:
      0   1
0  5921  25
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_17.png
better model found
persisted
after epoch: 17,now: 2024-06-07 22:24:03.908867,epoch time: 0:26:38.884742,used: 7:32:33.194905,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9920877, 'precision': 0.9342222, 'recall': 0.942652, 'specificity': 0.942652, 'f1': 0.93839335, 'auroc': 0.99690247, 'binary_precision': 0.8721958, 'binary_recall': 0.8897365, 'binary_specificity': 0.9955675, 'binary_f1_score': 0.8808788}
confusion matrix:
       0     1
0  42226   188
1    159  1283
---- Validation: 
scalar performance:
{'acc': 0.9859125, 'precision': 0.9155022, 'recall': 0.8725289, 'specificity': 0.8725289, 'f1': 0.8927435, 'auroc': 0.9797798, 'binary_precision': 0.8402662, 'binary_recall': 0.75037146, 'binary_specificity': 0.9946864, 'binary_f1_score': 0.7927787}
confusion matrix:
       0    1
0  17971   96
1    168  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.80627, 'recall': 0.59948444, 'specificity': 0.59948444, 'f1': 0.6451945, 'auroc': 0.94468826, 'binary_precision': 0.64634144, 'binary_recall': 0.20384616, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.30994153}
confusion matrix:
      0   1
0  5917  29
1   207  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_18.png
early stop counter: 1
val acc:0.9859125018119812, best validation acc: 0.9863393902778625, corresponding to test acc:                         0.9585884809494019 / 0.9663228988647461
after epoch: 18,now: 2024-06-07 22:50:43.407988,epoch time: 0:26:39.499121,used: 7:59:12.694026,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.992749, 'precision': 0.93180263, 'recall': 0.9583745, 'specificity': 0.9583745, 'f1': 0.94466025, 'auroc': 0.99777615, 'binary_precision': 0.86627525, 'binary_recall': 0.9215822, 'binary_specificity': 0.9951668, 'binary_f1_score': 0.89307326}
confusion matrix:
       0     1
0  42210   205
1    113  1328
---- Validation: 
scalar performance:
{'acc': 0.98810035, 'precision': 0.9217249, 'recall': 0.90298957, 'specificity': 0.90298957, 'f1': 0.91212606, 'auroc': 0.98349404, 'binary_precision': 0.85046726, 'binary_recall': 0.8112927, 'binary_specificity': 0.9946864, 'binary_f1_score': 0.8304182}
confusion matrix:
       0    1
0  17971   96
1    127  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8059341, 'recall': 0.58259726, 'specificity': 0.58259726, 'f1': 0.6242159, 'auroc': 0.9555176, 'binary_precision': 0.64705884, 'binary_recall': 0.16923077, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.2682927}
confusion matrix:
      0   1
0  5922  24
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_19.png
better model found
persisted
after epoch: 19,now: 2024-06-07 23:17:00.301688,epoch time: 0:26:16.893700,used: 8:25:29.587726,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9935471, 'precision': 0.95462555, 'recall': 0.94273657, 'specificity': 0.94273657, 'f1': 0.94859636, 'auroc': 0.99760234, 'binary_precision': 0.9130435, 'binary_recall': 0.88834953, 'binary_specificity': 0.9971236, 'binary_f1_score': 0.9005273}
confusion matrix:
       0     1
0  42292   122
1    161  1281
---- Validation: 
scalar performance:
{'acc': 0.9863394, 'precision': 0.92174006, 'recall': 0.8720351, 'specificity': 0.8720351, 'f1': 0.8951999, 'auroc': 0.98253864, 'binary_precision': 0.8527919, 'binary_recall': 0.7488856, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.7974684}
confusion matrix:
       0    1
0  17980   87
1    169  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.80906427, 'recall': 0.5676331, 'specificity': 0.5676331, 'f1': 0.6042419, 'auroc': 0.91854286, 'binary_precision': 0.6545454, 'binary_recall': 0.13846155, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.22857143}
confusion matrix:
      0   1
0  5927  19
1   224  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_20.png
early stop counter: 1
val acc:0.9863393902778625, best validation acc: 0.9881003499031067, corresponding to test acc:                         0.9613277316093445 / 0.9663228988647461
after epoch: 20,now: 2024-06-07 23:43:30.234100,epoch time: 0:26:29.932412,used: 8:51:59.520138,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9928174, 'precision': 0.9836358, 'recall': 0.90116024, 'specificity': 0.90116024, 'f1': 0.9382857, 'auroc': 0.99818313, 'binary_precision': 0.9739277, 'binary_recall': 0.8030513, 'binary_specificity': 0.9992691, 'binary_f1_score': 0.8802737}
confusion matrix:
       0     1
0  42383    31
1    284  1158
---- Validation: 
scalar performance:
{'acc': 0.98441833, 'precision': 0.9607515, 'recall': 0.8030884, 'specificity': 0.8030884, 'f1': 0.86445415, 'auroc': 0.97614014, 'binary_precision': 0.9359268, 'binary_recall': 0.6077266, 'binary_specificity': 0.9984502, 'binary_f1_score': 0.7369369}
confusion matrix:
       0    1
0  18039   28
1    264  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.8841704, 'recall': 0.57800525, 'specificity': 0.57800525, 'f1': 0.62237084, 'auroc': 0.9213265, 'binary_precision': 0.8039216, 'binary_recall': 0.15769231, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.26366562}
confusion matrix:
      0   1
0  5936  10
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_21.png
early stop counter: 2
val acc:0.9844183325767517, best validation acc: 0.9881003499031067, corresponding to test acc:                         0.9613277316093445 / 0.9663228988647461
after epoch: 21,now: 2024-06-08 00:10:13.139334,epoch time: 0:26:42.905234,used: 9:18:42.425372,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9949152, 'precision': 0.9644855, 'recall': 0.9548322, 'specificity': 0.9548322, 'f1': 0.9596044, 'auroc': 0.9981494, 'binary_precision': 0.93196315, 'binary_recall': 0.9119279, 'binary_specificity': 0.9977366, 'binary_f1_score': 0.9218367}
confusion matrix:
       0     1
0  42318    96
1    127  1315
---- Validation: 
scalar performance:
{'acc': 0.9868196, 'precision': 0.9406061, 'recall': 0.8586941, 'specificity': 0.8586941, 'f1': 0.89511526, 'auroc': 0.9810432, 'binary_precision': 0.8915441, 'binary_recall': 0.7206538, 'binary_specificity': 0.9967344, 'binary_f1_score': 0.7970419}
confusion matrix:
       0    1
0  18008   59
1    188  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.8508066, 'recall': 0.62490493, 'specificity': 0.62490493, 'f1': 0.6795348, 'auroc': 0.91753405, 'binary_precision': 0.73333335, 'binary_recall': 0.25384617, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.37714288}
confusion matrix:
      0   1
0  5922  24
1   194  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_22.png
early stop counter: 3
val acc:0.9868196249008179, best validation acc: 0.9881003499031067, corresponding to test acc:                         0.9613277316093445 / 0.9663228988647461
after epoch: 22,now: 2024-06-08 00:36:58.010240,epoch time: 0:26:44.870906,used: 9:45:27.296278,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9917913, 'precision': 0.96450853, 'recall': 0.90196955, 'specificity': 0.90196955, 'f1': 0.930819, 'auroc': 0.9970734, 'binary_precision': 0.93558776, 'binary_recall': 0.80582523, 'binary_specificity': 0.9981138, 'binary_f1_score': 0.86587185}
confusion matrix:
       0     1
0  42334    80
1    280  1162
---- Validation: 
scalar performance:
{'acc': 0.98372465, 'precision': 0.9584272, 'recall': 0.7941454, 'specificity': 0.7941454, 'f1': 0.8570457, 'auroc': 0.97881335, 'binary_precision': 0.9319249, 'binary_recall': 0.58989596, 'binary_specificity': 0.99839485, 'binary_f1_score': 0.72247493}
confusion matrix:
       0    1
0  18038   29
1    276  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8020007, 'recall': 0.58627516, 'specificity': 0.58627516, 'f1': 0.6286204, 'auroc': 0.9193289, 'binary_precision': 0.6388889, 'binary_recall': 0.17692308, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.27710843}
confusion matrix:
      0   1
0  5920  26
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_23.png
early stop counter: 4
val acc:0.9837246537208557, best validation acc: 0.9881003499031067, corresponding to test acc:                         0.9613277316093445 / 0.9663228988647461
after epoch: 23,now: 2024-06-08 01:03:32.938434,epoch time: 0:26:34.928194,used: 10:12:02.224472,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99468714, 'precision': 0.9822171, 'recall': 0.93260753, 'specificity': 0.93260753, 'f1': 0.95597076, 'auroc': 0.99893177, 'binary_precision': 0.9689682, 'binary_recall': 0.8661581, 'binary_specificity': 0.99905694, 'binary_f1_score': 0.9146833}
confusion matrix:
       0     1
0  42374    40
1    193  1249
---- Validation: 
scalar performance:
{'acc': 0.98628604, 'precision': 0.9537302, 'recall': 0.8376746, 'specificity': 0.8376746, 'f1': 0.8865381, 'auroc': 0.9817158, 'binary_precision': 0.91935486, 'binary_recall': 0.67756313, 'binary_specificity': 0.99778605, 'binary_f1_score': 0.78015393}
confusion matrix:
       0    1
0  18027   40
1    217  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.8210882, 'recall': 0.57532537, 'specificity': 0.57532537, 'f1': 0.61551017, 'auroc': 0.9409852, 'binary_precision': 0.6779661, 'binary_recall': 0.15384616, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.2507837}
confusion matrix:
      0   1
0  5927  19
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_24.png
early stop counter: 5
val acc:0.9862860441207886, best validation acc: 0.9881003499031067, corresponding to test acc:                         0.9613277316093445 / 0.9663228988647461
after epoch: 24,now: 2024-06-08 01:30:19.493897,epoch time: 0:26:46.555463,used: 10:38:48.779935,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9952116, 'precision': 0.95655596, 'recall': 0.9693884, 'specificity': 0.9693884, 'f1': 0.96287644, 'auroc': 0.99901253, 'binary_precision': 0.9150943, 'binary_recall': 0.94174755, 'binary_specificity': 0.9970293, 'binary_f1_score': 0.9282297}
confusion matrix:
       0     1
0  42288   126
1     84  1358
---- Validation: 
scalar performance:
{'acc': 0.98762006, 'precision': 0.9258261, 'recall': 0.8891504, 'specificity': 0.8891504, 'f1': 0.90659285, 'auroc': 0.9811668, 'binary_precision': 0.85970634, 'binary_recall': 0.7830609, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.8195957}
confusion matrix:
       0    1
0  17981   86
1    146  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.7901621, 'recall': 0.595386, 'specificity': 0.595386, 'f1': 0.6387038, 'auroc': 0.9000145, 'binary_precision': 0.61445785, 'binary_recall': 0.19615385, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.2973761}
confusion matrix:
      0   1
0  5914  32
1   209  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_25.png
early stop counter: 6
val acc:0.9876200556755066, best validation acc: 0.9881003499031067, corresponding to test acc:                         0.9613277316093445 / 0.9663228988647461
after epoch: 25,now: 2024-06-08 01:56:57.541950,epoch time: 0:26:38.048053,used: 11:05:26.827988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.995508, 'precision': 0.96226966, 'recall': 0.9675319, 'specificity': 0.9675319, 'f1': 0.96488476, 'auroc': 0.99912536, 'binary_precision': 0.9266621, 'binary_recall': 0.93758667, 'binary_specificity': 0.99747723, 'binary_f1_score': 0.93209237}
confusion matrix:
       0     1
0  42307   107
1     90  1352
---- Validation: 
scalar performance:
{'acc': 0.9874066, 'precision': 0.9230384, 'recall': 0.88903975, 'specificity': 0.88903975, 'f1': 0.9052665, 'auroc': 0.9824082, 'binary_precision': 0.8541329, 'binary_recall': 0.7830609, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.8170543}
confusion matrix:
       0    1
0  17977   90
1    146  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.8136265, 'recall': 0.58836645, 'specificity': 0.58836645, 'f1': 0.6321852, 'auroc': 0.9113382, 'binary_precision': 0.6619718, 'binary_recall': 0.18076923, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.28398794}
confusion matrix:
      0   1
0  5922  24
1   213  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_26.png
early stop counter: 7
val acc:0.9874066114425659, best validation acc: 0.9881003499031067, corresponding to test acc:                         0.9613277316093445 / 0.9663228988647461
after epoch: 26,now: 2024-06-08 02:23:16.757791,epoch time: 0:26:19.215841,used: 11:31:46.043829,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99309105, 'precision': 0.97159505, 'recall': 0.9167095, 'specificity': 0.9167095, 'f1': 0.9423343, 'auroc': 0.99812984, 'binary_precision': 0.94877857, 'binary_recall': 0.83495146, 'binary_specificity': 0.9984675, 'binary_f1_score': 0.8882331}
confusion matrix:
       0     1
0  42349    65
1    238  1204
---- Validation: 
scalar performance:
{'acc': 0.9839381, 'precision': 0.9550072, 'recall': 0.79997826, 'specificity': 0.79997826, 'f1': 0.8603983, 'auroc': 0.98232156, 'binary_precision': 0.9246575, 'binary_recall': 0.60178304, 'binary_specificity': 0.9981735, 'binary_f1_score': 0.72907287}
confusion matrix:
       0    1
0  18034   33
1    268  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7297931, 'recall': 0.5183899, 'specificity': 0.5183899, 'f1': 0.5249988, 'auroc': 0.9045983, 'binary_precision': 0.5, 'binary_recall': 0.03846154, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.07142857}
confusion matrix:
      0   1
0  5936  10
1   250  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_27.png
early stop counter: 8
val acc:0.9839380979537964, best validation acc: 0.9881003499031067, corresponding to test acc:                         0.9613277316093445 / 0.9663228988647461
after epoch: 27,now: 2024-06-08 02:49:56.587200,epoch time: 0:26:39.829409,used: 11:58:25.873238,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99543965, 'precision': 0.9740886, 'recall': 0.95309365, 'specificity': 0.95309365, 'f1': 0.9633359, 'auroc': 0.9986819, 'binary_precision': 0.95130813, 'binary_recall': 0.907767, 'binary_specificity': 0.99842036, 'binary_f1_score': 0.9290277}
confusion matrix:
       0     1
0  42347    67
1    133  1309
---- Validation: 
scalar performance:
{'acc': 0.98762006, 'precision': 0.9424695, 'recall': 0.86983824, 'specificity': 0.86983824, 'f1': 0.902644, 'auroc': 0.9825903, 'binary_precision': 0.89445436, 'binary_recall': 0.74294204, 'binary_specificity': 0.9967344, 'binary_f1_score': 0.8116883}
confusion matrix:
       0    1
0  18008   59
1    173  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.83846056, 'recall': 0.6019962, 'specificity': 0.6019962, 'f1': 0.6512741, 'auroc': 0.9360782, 'binary_precision': 0.7105263, 'binary_recall': 0.20769231, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.32142857}
confusion matrix:
      0   1
0  5924  22
1   206  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_28.png
early stop counter: 9
val acc:0.9876200556755066, best validation acc: 0.9881003499031067, corresponding to test acc:                         0.9613277316093445 / 0.9663228988647461
after epoch: 28,now: 2024-06-08 03:16:38.971116,epoch time: 0:26:42.383916,used: 12:25:08.257154,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9929542, 'precision': 0.9372319, 'recall': 0.9544883, 'specificity': 0.9544883, 'f1': 0.9456799, 'auroc': 0.9984392, 'binary_precision': 0.87741506, 'binary_recall': 0.9133148, 'binary_specificity': 0.9956618, 'binary_f1_score': 0.8950051}
confusion matrix:
       0     1
0  42230   184
1    125  1317
---- Validation: 
scalar performance:
{'acc': 0.98671293, 'precision': 0.917857, 'recall': 0.8836731, 'specificity': 0.8836731, 'f1': 0.8999734, 'auroc': 0.97707725, 'binary_precision': 0.84415585, 'binary_recall': 0.7726597, 'binary_specificity': 0.9946864, 'binary_f1_score': 0.806827}
confusion matrix:
       0    1
0  17971   96
1    153  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.75266445, 'recall': 0.546311, 'specificity': 0.546311, 'f1': 0.5711261, 'auroc': 0.8852894, 'binary_precision': 0.54347825, 'binary_recall': 0.09615385, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.1633987}
confusion matrix:
      0   1
0  5925  21
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_29.png
early stop counter: 10
val acc:0.9867129325866699, best validation acc: 0.9881003499031067, corresponding to test acc:                         0.9613277316093445 / 0.9663228988647461
after epoch: 29,now: 2024-06-08 03:43:16.589448,epoch time: 0:26:37.618332,used: 12:51:45.875486,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9962833, 'precision': 0.9838361, 'recall': 0.9568794, 'specificity': 0.9568794, 'f1': 0.9699434, 'auroc': 0.99946225, 'binary_precision': 0.9705666, 'binary_recall': 0.9147018, 'binary_specificity': 0.99905694, 'binary_f1_score': 0.94180644}
confusion matrix:
       0     1
0  42374    40
1    123  1319
---- Validation: 
scalar performance:
{'acc': 0.98628604, 'precision': 0.9451197, 'recall': 0.84554255, 'specificity': 0.84554255, 'f1': 0.8885664, 'auroc': 0.97930866, 'binary_precision': 0.9015444, 'binary_recall': 0.69390786, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.78421485}
confusion matrix:
       0    1
0  18016   51
1    206  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7710154, 'recall': 0.5614434, 'specificity': 0.5614434, 'f1': 0.5937248, 'auroc': 0.9164498, 'binary_precision': 0.57894737, 'binary_recall': 0.12692308, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.2082019}
confusion matrix:
      0   1
0  5922  24
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170180_30.png
early stop counter: 11
val acc:0.9862860441207886, best validation acc: 0.9881003499031067, corresponding to test acc:                         0.9613277316093445 / 0.9663228988647461
after epoch: 30,now: 2024-06-08 04:09:49.511323,epoch time: 0:26:32.921875,used: 13:18:18.797361,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_51_30_seed_1_21170180
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:18:18.797361 at 2024-06-08 04:09:49.511323
persisted model performance metric: 

scalar performance:
{'acc': 0.95939416, 'precision': 0.7613277, 'recall': 0.5705542, 'specificity': 0.5705542, 'f1': 0.6054266, 'auroc': 0.94891346, 'binary_precision': 0.5588235, 'binary_recall': 0.14615385, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.23170732}
confusion matrix:
      0   1
0  5916  30
1   222  38
oracle model performance metric: 

scalar performance:
{'acc': 0.9661618, 'precision': 0.859851, 'recall': 0.6421285, 'specificity': 0.6421285, 'f1': 0.6996211, 'auroc': 0.9626085, 'binary_precision': 0.75, 'binary_recall': 0.28846154, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.41666663}
confusion matrix:
      0   1
0  5921  25
1   185  75
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454154 KiB |   2003 MiB |   1868 TiB |   1868 TiB |
|       from large pool | 412478 KiB |   1971 MiB |   1843 TiB |   1843 TiB |
|       from small pool |  41675 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 454154 KiB |   2003 MiB |   1868 TiB |   1868 TiB |
|       from large pool | 412478 KiB |   1971 MiB |   1843 TiB |   1843 TiB |
|       from small pool |  41675 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |   1998 MiB |   1866 TiB |   1866 TiB |
|       from large pool | 407075 KiB |   1966 MiB |   1841 TiB |   1841 TiB |
|       from small pool |  40676 KiB |     60 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2278 MiB |   2282 MiB |   3790 MiB |   1512 MiB |
|       from large pool |   2214 MiB |   2214 MiB |   3706 MiB |   1492 MiB |
|       from small pool |     64 MiB |     70 MiB |     84 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 367094 KiB | 428787 KiB |   1457 TiB |   1457 TiB |
|       from large pool | 357569 KiB | 408037 KiB |   1432 TiB |   1432 TiB |
|       from small pool |   9524 KiB |  21494 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    6467    |  360991 K  |  360988 K  |
|       from large pool |     187    |     311    |  175753 K  |  175753 K  |
|       from small pool |    3277    |    6279    |  185237 K  |  185234 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    6467    |  360991 K  |  360988 K  |
|       from large pool |     187    |     311    |  175753 K  |  175753 K  |
|       from small pool |    3277    |    6279    |  185237 K  |  185234 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     127    |     194    |      69    |
|       from large pool |      93    |      93    |     152    |      59    |
|       from small pool |      32    |      35    |      42    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    2799    |  190809 K  |  190809 K  |
|       from large pool |      40    |      93    |  118942 K  |  118942 K  |
|       from small pool |      31    |    2759    |   71866 K  |   71866 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |   1868 TiB |   1868 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1843 TiB |   1843 TiB |
|       from small pool |      0 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |   1868 TiB |   1868 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1843 TiB |   1843 TiB |
|       from small pool |      0 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |   1866 TiB |   1866 TiB |
|       from large pool |  16640 KiB |   1966 MiB |   1841 TiB |   1841 TiB |
|       from small pool |      0 KiB |     60 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    802 MiB |   2282 MiB |   3790 MiB |   2988 MiB |
|       from large pool |    752 MiB |   2214 MiB |   3706 MiB |   2954 MiB |
|       from small pool |     50 MiB |     70 MiB |     84 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 459453 KiB |   1457 TiB |   1457 TiB |
|       from large pool |  24320 KiB | 444488 KiB |   1432 TiB |   1432 TiB |
|       from small pool |      0 KiB |  22399 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6467    |  360991 K  |  360991 K  |
|       from large pool |       2    |     311    |  175753 K  |  175753 K  |
|       from small pool |       0    |    6279    |  185237 K  |  185237 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6467    |  360991 K  |  360991 K  |
|       from large pool |       2    |     311    |  175753 K  |  175753 K  |
|       from small pool |       0    |    6279    |  185237 K  |  185237 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     127    |     194    |     135    |
|       from large pool |      34    |      93    |     152    |     118    |
|       from small pool |      25    |      35    |      42    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2799    |  190810 K  |  190810 K  |
|       from large pool |       3    |      93    |  118942 K  |  118942 K  |
|       from small pool |       0    |    2759    |   71868 K  |   71868 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |   1868 TiB |   1868 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1843 TiB |   1843 TiB |
|       from small pool |      0 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |   1868 TiB |   1868 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1843 TiB |   1843 TiB |
|       from small pool |      0 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |   1866 TiB |   1866 TiB |
|       from large pool |  16640 KiB |   1966 MiB |   1841 TiB |   1841 TiB |
|       from small pool |      0 KiB |     60 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    802 MiB |   2282 MiB |   3790 MiB |   2988 MiB |
|       from large pool |    752 MiB |   2214 MiB |   3706 MiB |   2954 MiB |
|       from small pool |     50 MiB |     70 MiB |     84 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 459453 KiB |   1457 TiB |   1457 TiB |
|       from large pool |  24320 KiB | 444488 KiB |   1432 TiB |   1432 TiB |
|       from small pool |      0 KiB |  22399 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6467    |  360991 K  |  360991 K  |
|       from large pool |       2    |     311    |  175753 K  |  175753 K  |
|       from small pool |       0    |    6279    |  185237 K  |  185237 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6467    |  360991 K  |  360991 K  |
|       from large pool |       2    |     311    |  175753 K  |  175753 K  |
|       from small pool |       0    |    6279    |  185237 K  |  185237 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     127    |     194    |     135    |
|       from large pool |      34    |      93    |     152    |     118    |
|       from small pool |      25    |      35    |      42    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2799    |  190810 K  |  190810 K  |
|       from large pool |       3    |      93    |  118942 K  |  118942 K  |
|       from small pool |       0    |    2759    |   71868 K  |   71868 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jun  8 04:12:27 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/0.csv

RuleException:
ValueError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
too many values to unpack (expected 2)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 168, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 30, in __init__
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/tasks/zoo_tasks.py", line 36, in __call__
  File "/lustre/groups/aih/sina.wendrich/MA_code/MA_thesis/tasks/task_CAMELYON17.py", line 185, in get_task
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
