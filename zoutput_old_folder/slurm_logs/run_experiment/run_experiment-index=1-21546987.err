Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun 22 11:26:19 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987

 Experiment start at: 2024-06-22 11:32:00.078816
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98996145, 'precision': 0.98247457, 'recall': 0.95813537, 'specificity': 0.95813537, 'f1': 0.9699088, 'auroc': 0.9950514, 'binary_precision': 0.97336215, 'binary_recall': 0.9188944, 'binary_specificity': 0.99737626, 'binary_f1_score': 0.9453444}
confusion matrix:
       0     1
0  42195   111
1    358  4056
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7472396, 'recall': 0.6256174, 'specificity': 0.6256174, 'f1': 0.6646347, 'auroc': 0.82710624, 'binary_precision': 0.52024925, 'binary_recall': 0.25972006, 'binary_specificity': 0.9915147, 'binary_f1_score': 0.34647304}
confusion matrix:
       0    1
0  17995  154
1    476  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.79772484, 'recall': 0.6194371, 'specificity': 0.6194371, 'f1': 0.66664016, 'auroc': 0.82668376, 'binary_precision': 0.627451, 'binary_recall': 0.24521072, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.35261708}
confusion matrix:
      0   1
0  5959  38
1   197  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 11:47:04.917325,epoch time: 0:15:04.838509,used: 0:15:04.838509,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9915454, 'precision': 0.9877626, 'recall': 0.96234137, 'specificity': 0.96234137, 'f1': 0.97462475, 'auroc': 0.9961485, 'binary_precision': 0.9831609, 'binary_recall': 0.92633724, 'binary_specificity': 0.9983455, 'binary_f1_score': 0.95390356}
confusion matrix:
       0     1
0  42238    70
1    325  4087
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.761363, 'recall': 0.5808069, 'specificity': 0.5808069, 'f1': 0.6193606, 'auroc': 0.8243604, 'binary_precision': 0.5515464, 'binary_recall': 0.16640747, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.25567502}
confusion matrix:
       0    1
0  18062   87
1    536  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95669544, 'precision': 0.6677187, 'recall': 0.52665126, 'specificity': 0.52665126, 'f1': 0.53874093, 'auroc': 0.78575623, 'binary_precision': 0.375, 'binary_recall': 0.057471264, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.09966777}
confusion matrix:
      0   1
0  5972  25
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_2.png
better model found
persisted
after epoch: 2,now: 2024-06-22 12:00:40.591231,epoch time: 0:13:35.673906,used: 0:28:40.512415,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99195206, 'precision': 0.97722054, 'recall': 0.9756706, 'specificity': 0.9756706, 'f1': 0.976444, 'auroc': 0.9968833, 'binary_precision': 0.9590723, 'binary_recall': 0.95559585, 'binary_specificity': 0.9957453, 'binary_f1_score': 0.95733094}
confusion matrix:
       0     1
0  42126   180
1    196  4218
---- Validation: 
scalar performance:
{'acc': 0.9632822, 'precision': 0.71381134, 'recall': 0.6607171, 'specificity': 0.6607171, 'f1': 0.68305147, 'auroc': 0.84452844, 'binary_precision': 0.45093945, 'binary_recall': 0.33592534, 'binary_specificity': 0.98550886, 'binary_f1_score': 0.38502675}
confusion matrix:
       0    1
0  17886  263
1    427  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.7240758, 'recall': 0.61318785, 'specificity': 0.61318785, 'f1': 0.6480062, 'auroc': 0.8332803, 'binary_precision': 0.48062015, 'binary_recall': 0.23754789, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.3179487}
confusion matrix:
      0   1
0  5930  67
1   199  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_3.png
early stop counter: 1
val acc:0.9632822275161743, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9566954374313354 / 0.9624480605125427
after epoch: 3,now: 2024-06-22 12:14:01.166937,epoch time: 0:13:20.575706,used: 0:42:01.088121,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9926156, 'precision': 0.9794977, 'recall': 0.9772591, 'specificity': 0.9772591, 'f1': 0.9783751, 'auroc': 0.9975426, 'binary_precision': 0.9633424, 'binary_recall': 0.9583239, 'binary_specificity': 0.9961943, 'binary_f1_score': 0.9608266}
confusion matrix:
       0     1
0  42144   161
1    184  4231
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.7425363, 'recall': 0.66670513, 'specificity': 0.66670513, 'f1': 0.69684416, 'auroc': 0.84765005, 'binary_precision': 0.50800914, 'binary_recall': 0.3452566, 'binary_specificity': 0.98815364, 'binary_f1_score': 0.4111111}
confusion matrix:
       0    1
0  17934  215
1    421  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95541704, 'precision': 0.6924117, 'recall': 0.5846189, 'specificity': 0.5846189, 'f1': 0.6145172, 'auroc': 0.798032, 'binary_precision': 0.41964287, 'binary_recall': 0.18007663, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.2520107}
confusion matrix:
      0   1
0  5932  65
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_4.png
early stop counter: 2
val acc:0.9661558270454407, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9566954374313354 / 0.9624480605125427
after epoch: 4,now: 2024-06-22 12:27:23.510834,epoch time: 0:13:22.343897,used: 0:55:23.432018,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9942209, 'precision': 0.98766863, 'recall': 0.9783437, 'specificity': 0.9783437, 'f1': 0.98294944, 'auroc': 0.99798626, 'binary_precision': 0.97962964, 'binary_recall': 0.95876753, 'binary_specificity': 0.9979199, 'binary_f1_score': 0.96908635}
confusion matrix:
       0     1
0  42218    88
1    182  4232
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.73574495, 'recall': 0.61023057, 'specificity': 0.61023057, 'f1': 0.64792967, 'auroc': 0.8431449, 'binary_precision': 0.49830508, 'binary_recall': 0.22861587, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.31343284}
confusion matrix:
       0    1
0  18001  148
1    496  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.71173894, 'recall': 0.58903396, 'specificity': 0.58903396, 'f1': 0.6220392, 'auroc': 0.828956, 'binary_precision': 0.45794392, 'binary_recall': 0.18773946, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.2663043}
confusion matrix:
      0   1
0  5939  58
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_5.png
early stop counter: 3
val acc:0.9657300710678101, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9566954374313354 / 0.9624480605125427
after epoch: 5,now: 2024-06-22 12:40:41.991755,epoch time: 0:13:18.480921,used: 1:08:41.912939,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.993643, 'precision': 0.9841431, 'recall': 0.9785364, 'specificity': 0.9785364, 'f1': 0.9813192, 'auroc': 0.99768794, 'binary_precision': 0.97246444, 'binary_recall': 0.9599094, 'binary_specificity': 0.9971635, 'binary_f1_score': 0.9661462}
confusion matrix:
       0     1
0  42185   120
1    177  4238
---- Validation: 
scalar performance:
{'acc': 0.963708, 'precision': 0.7137042, 'recall': 0.6376858, 'specificity': 0.6376858, 'f1': 0.66652125, 'auroc': 0.8573265, 'binary_precision': 0.45232275, 'binary_recall': 0.28771386, 'binary_specificity': 0.9876577, 'binary_f1_score': 0.35171106}
confusion matrix:
       0    1
0  17925  224
1    458  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95541704, 'precision': 0.69077235, 'recall': 0.58095425, 'specificity': 0.58095425, 'f1': 0.6104669, 'auroc': 0.81689215, 'binary_precision': 0.41666666, 'binary_recall': 0.1724138, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.24390244}
confusion matrix:
      0   1
0  5934  63
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_6.png
early stop counter: 4
val acc:0.9637079834938049, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9566954374313354 / 0.9624480605125427
after epoch: 6,now: 2024-06-22 12:54:07.007730,epoch time: 0:13:25.015975,used: 1:22:06.928914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9943707, 'precision': 0.98956716, 'recall': 0.97730553, 'specificity': 0.97730553, 'f1': 0.98333836, 'auroc': 0.99779296, 'binary_precision': 0.983683, 'binary_recall': 0.95626557, 'binary_specificity': 0.99834543, 'binary_f1_score': 0.9697805}
confusion matrix:
       0     1
0  42237    70
1    193  4220
---- Validation: 
scalar performance:
{'acc': 0.9649851, 'precision': 0.7193543, 'recall': 0.58059275, 'specificity': 0.58059275, 'f1': 0.6146077, 'auroc': 0.84375453, 'binary_precision': 0.46753246, 'binary_recall': 0.16796267, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.24713959}
confusion matrix:
       0    1
0  18026  123
1    535  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.7525749, 'recall': 0.6032777, 'specificity': 0.6032777, 'f1': 0.643014, 'auroc': 0.83189297, 'binary_precision': 0.53846157, 'binary_recall': 0.21455939, 'binary_specificity': 0.991996, 'binary_f1_score': 0.30684933}
confusion matrix:
      0   1
0  5949  48
1   205  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_7.png
early stop counter: 5
val acc:0.9649850726127625, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9566954374313354 / 0.9624480605125427
after epoch: 7,now: 2024-06-22 13:07:40.269382,epoch time: 0:13:33.261652,used: 1:35:40.190566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9929152, 'precision': 0.9821768, 'recall': 0.9761974, 'specificity': 0.9761974, 'f1': 0.9791635, 'auroc': 0.99777424, 'binary_precision': 0.9689798, 'binary_recall': 0.9555858, 'binary_specificity': 0.99680907, 'binary_f1_score': 0.96223617}
confusion matrix:
       0     1
0  42172   135
1    196  4217
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.7459785, 'recall': 0.6383408, 'specificity': 0.6383408, 'f1': 0.6755605, 'auroc': 0.84581023, 'binary_precision': 0.5168539, 'binary_recall': 0.28615862, 'binary_specificity': 0.9905229, 'binary_f1_score': 0.36836836}
confusion matrix:
       0    1
0  17977  172
1    459  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9552573, 'precision': 0.6963729, 'recall': 0.5991942, 'specificity': 0.5991942, 'f1': 0.6294802, 'auroc': 0.82036966, 'binary_precision': 0.42635658, 'binary_recall': 0.21072797, 'binary_specificity': 0.98766047, 'binary_f1_score': 0.2820513}
confusion matrix:
      0   1
0  5923  74
1   206  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_8.png
early stop counter: 6
val acc:0.966421902179718, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9566954374313354 / 0.9624480605125427
after epoch: 8,now: 2024-06-22 13:21:22.509117,epoch time: 0:13:42.239735,used: 1:49:22.430301,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9943279, 'precision': 0.98461986, 'recall': 0.98216045, 'specificity': 0.98216045, 'f1': 0.9833862, 'auroc': 0.9983511, 'binary_precision': 0.97266513, 'binary_recall': 0.9671574, 'binary_specificity': 0.9971635, 'binary_f1_score': 0.96990347}
confusion matrix:
       0     1
0  42185   120
1    145  4270
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.73180306, 'recall': 0.58989644, 'specificity': 0.58989644, 'f1': 0.626472, 'auroc': 0.8273039, 'binary_precision': 0.4918033, 'binary_recall': 0.1866252, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.270575}
confusion matrix:
       0    1
0  18025  124
1    523  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95222116, 'precision': 0.63221663, 'recall': 0.54996943, 'specificity': 0.54996943, 'f1': 0.5689371, 'auroc': 0.7910408, 'binary_precision': 0.30208334, 'binary_recall': 0.11111111, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.16246499}
confusion matrix:
      0   1
0  5930  67
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_9.png
early stop counter: 7
val acc:0.9655704498291016, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9566954374313354 / 0.9624480605125427
after epoch: 9,now: 2024-06-22 13:34:59.559466,epoch time: 0:13:37.050349,used: 2:02:59.480650,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.994756, 'precision': 0.98971194, 'recall': 0.9794464, 'specificity': 0.9794464, 'f1': 0.98451066, 'auroc': 0.99785745, 'binary_precision': 0.9835267, 'binary_recall': 0.96057105, 'binary_specificity': 0.9983218, 'binary_f1_score': 0.97191334}
confusion matrix:
       0     1
0  42236    71
1    174  4239
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.7288383, 'recall': 0.5808407, 'specificity': 0.5808407, 'f1': 0.61601806, 'auroc': 0.8422501, 'binary_precision': 0.4864865, 'binary_recall': 0.16796267, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.24971098}
confusion matrix:
       0    1
0  18035  114
1    535  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95573664, 'precision': 0.69307804, 'recall': 0.57745636, 'specificity': 0.57745636, 'f1': 0.60706097, 'auroc': 0.82478154, 'binary_precision': 0.42156863, 'binary_recall': 0.16475096, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.2369146}
confusion matrix:
      0   1
0  5938  59
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_10.png
early stop counter: 8
val acc:0.9654640555381775, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9566954374313354 / 0.9624480605125427
after epoch: 10,now: 2024-06-22 13:48:25.912931,epoch time: 0:13:26.353465,used: 2:16:25.834115,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9929152, 'precision': 0.97776985, 'recall': 0.9809671, 'specificity': 0.9809671, 'f1': 0.9793618, 'auroc': 0.99819756, 'binary_precision': 0.9590643, 'binary_recall': 0.9662361, 'binary_specificity': 0.9956981, 'binary_f1_score': 0.9626369}
confusion matrix:
       0     1
0  42125   182
1    149  4264
---- Validation: 
scalar performance:
{'acc': 0.9634951, 'precision': 0.71406424, 'recall': 0.65107656, 'specificity': 0.65107656, 'f1': 0.6764981, 'auroc': 0.8549742, 'binary_precision': 0.4521158, 'binary_recall': 0.31570762, 'binary_specificity': 0.98644555, 'binary_f1_score': 0.37179485}
confusion matrix:
       0    1
0  17903  246
1    440  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9534995, 'precision': 0.6842806, 'recall': 0.6092711, 'specificity': 0.6092711, 'f1': 0.63567793, 'auroc': 0.8220954, 'binary_precision': 0.40131578, 'binary_recall': 0.23371647, 'binary_specificity': 0.98482573, 'binary_f1_score': 0.29539952}
confusion matrix:
      0   1
0  5906  91
1   200  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_11.png
early stop counter: 9
val acc:0.9634950757026672, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9566954374313354 / 0.9624480605125427
after epoch: 11,now: 2024-06-22 14:01:52.749373,epoch time: 0:13:26.836442,used: 2:29:52.670557,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99452055, 'precision': 0.9922159, 'recall': 0.9755508, 'specificity': 0.9755508, 'f1': 0.9837029, 'auroc': 0.9983725, 'binary_precision': 0.9893993, 'binary_recall': 0.95216507, 'binary_specificity': 0.9989364, 'binary_f1_score': 0.9704252}
confusion matrix:
       0     1
0  42264    45
1    211  4200
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.7281877, 'recall': 0.59278643, 'specificity': 0.59278643, 'f1': 0.6290582, 'auroc': 0.84446555, 'binary_precision': 0.484375, 'binary_recall': 0.19284603, 'binary_specificity': 0.99272686, 'binary_f1_score': 0.27586207}
confusion matrix:
       0    1
0  18017  132
1    519  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95174176, 'precision': 0.6472837, 'recall': 0.56987494, 'specificity': 0.56987494, 'f1': 0.59226763, 'auroc': 0.8064262, 'binary_precision': 0.3305785, 'binary_recall': 0.1532567, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.20942406}
confusion matrix:
      0   1
0  5916  81
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_12.png
early stop counter: 10
val acc:0.9653576016426086, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9566954374313354 / 0.9624480605125427
after epoch: 12,now: 2024-06-22 14:16:13.560362,epoch time: 0:14:20.810989,used: 2:44:13.481546,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9942209, 'precision': 0.9868747, 'recall': 0.97915095, 'specificity': 0.97915095, 'f1': 0.9829739, 'auroc': 0.9978341, 'binary_precision': 0.97785467, 'binary_recall': 0.96057105, 'binary_specificity': 0.99773085, 'binary_f1_score': 0.96913576}
confusion matrix:
       0     1
0  42211    96
1    174  4239
---- Validation: 
scalar performance:
{'acc': 0.9653044, 'precision': 0.72733766, 'recall': 0.59350896, 'specificity': 0.59350896, 'f1': 0.62969375, 'auroc': 0.82364583, 'binary_precision': 0.48262548, 'binary_recall': 0.19440125, 'binary_specificity': 0.99261665, 'binary_f1_score': 0.27716187}
confusion matrix:
       0    1
0  18015  134
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95317996, 'precision': 0.64230436, 'recall': 0.5504697, 'specificity': 0.5504697, 'f1': 0.57057834, 'auroc': 0.7848079, 'binary_precision': 0.32222223, 'binary_recall': 0.11111111, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.16524218}
confusion matrix:
      0   1
0  5936  61
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_13.png
early stop counter: 11
val acc:0.9653043746948242, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9566954374313354 / 0.9624480605125427
after epoch: 13,now: 2024-06-22 14:30:26.309584,epoch time: 0:14:12.749222,used: 2:58:26.230768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99441355, 'precision': 0.9900011, 'recall': 0.9771311, 'specificity': 0.9771311, 'f1': 0.9834583, 'auroc': 0.99833924, 'binary_precision': 0.98459744, 'binary_recall': 0.9558224, 'binary_specificity': 0.9984399, 'binary_f1_score': 0.9699965}
confusion matrix:
       0     1
0  42240    66
1    195  4219
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.73650575, 'recall': 0.5645323, 'specificity': 0.5645323, 'f1': 0.59692115, 'auroc': 0.815477, 'binary_precision': 0.50292397, 'binary_recall': 0.13374805, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.2113022}
confusion matrix:
       0   1
0  18064  85
1    557  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9546181, 'precision': 0.6362121, 'recall': 0.5328967, 'specificity': 0.5328967, 'f1': 0.5473611, 'auroc': 0.7719693, 'binary_precision': 0.3114754, 'binary_recall': 0.07279693, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.11801242}
confusion matrix:
      0   1
0  5955  42
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_14.png
early stop counter: 12
val acc:0.9658365249633789, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9566954374313354 / 0.9624480605125427
after epoch: 14,now: 2024-06-22 14:44:44.764995,epoch time: 0:14:18.455411,used: 3:12:44.686179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99415666, 'precision': 0.9863348, 'recall': 0.9793097, 'specificity': 0.9793097, 'f1': 0.98279005, 'auroc': 0.9978187, 'binary_precision': 0.9767281, 'binary_recall': 0.9610066, 'binary_specificity': 0.9976128, 'binary_f1_score': 0.96880364}
confusion matrix:
       0     1
0  42208   101
1    172  4239
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.73368025, 'recall': 0.56597733, 'specificity': 0.56597733, 'f1': 0.5985585, 'auroc': 0.8358624, 'binary_precision': 0.49717513, 'binary_recall': 0.13685848, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.21463414}
confusion matrix:
       0   1
0  18060  89
1    555  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9549377, 'precision': 0.62296665, 'recall': 0.5239018, 'specificity': 0.5239018, 'f1': 0.53360957, 'auroc': 0.758599, 'binary_precision': 0.2857143, 'binary_recall': 0.053639848, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.09032258}
confusion matrix:
      0   1
0  5962  35
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_15.png
early stop counter: 13
val acc:0.9657300710678101, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9566954374313354 / 0.9624480605125427
after epoch: 15,now: 2024-06-22 14:58:44.352797,epoch time: 0:13:59.587802,used: 3:26:44.273981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9940283, 'precision': 0.9868423, 'recall': 0.9780251, 'specificity': 0.9780251, 'f1': 0.9823829, 'auroc': 0.998371, 'binary_precision': 0.97802454, 'binary_recall': 0.9582956, 'binary_specificity': 0.9977546, 'binary_f1_score': 0.9680596}
confusion matrix:
       0     1
0  42213    95
1    184  4228
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.75366145, 'recall': 0.59797555, 'specificity': 0.59797555, 'f1': 0.6381978, 'auroc': 0.8399695, 'binary_precision': 0.5349794, 'binary_recall': 0.2021773, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.29345372}
confusion matrix:
       0    1
0  18036  113
1    513  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95317996, 'precision': 0.6254065, 'recall': 0.5376434, 'specificity': 0.5376434, 'f1': 0.553253, 'auroc': 0.78872406, 'binary_precision': 0.28947368, 'binary_recall': 0.08429119, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.1305638}
confusion matrix:
      0   1
0  5943  54
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_16.png
early stop counter: 14
val acc:0.9666879773139954, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9566954374313354 / 0.9624480605125427
after epoch: 16,now: 2024-06-22 15:12:11.682690,epoch time: 0:13:27.329893,used: 3:40:11.603874,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9946918, 'precision': 0.98877007, 'recall': 0.9800198, 'specificity': 0.9800198, 'f1': 0.9843451, 'auroc': 0.99788666, 'binary_precision': 0.9815029, 'binary_recall': 0.96193063, 'binary_specificity': 0.99810904, 'binary_f1_score': 0.9716182}
confusion matrix:
       0     1
0  42227    80
1    168  4245
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.7361591, 'recall': 0.5975072, 'specificity': 0.5975072, 'f1': 0.63519984, 'auroc': 0.8425679, 'binary_precision': 0.5, 'binary_recall': 0.2021773, 'binary_specificity': 0.9928371, 'binary_f1_score': 0.28792915}
confusion matrix:
       0    1
0  18019  130
1    513  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95589644, 'precision': 0.6648588, 'recall': 0.53722835, 'specificity': 0.53722835, 'f1': 0.5547244, 'auroc': 0.79825145, 'binary_precision': 0.36842105, 'binary_recall': 0.08045977, 'binary_specificity': 0.993997, 'binary_f1_score': 0.13207547}
confusion matrix:
      0   1
0  5961  36
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_17.png
early stop counter: 15
val acc:0.9657832980155945, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9566954374313354 / 0.9624480605125427
after epoch: 17,now: 2024-06-22 15:25:32.492644,epoch time: 0:13:20.809954,used: 3:53:32.413828,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9943707, 'precision': 0.9890611, 'recall': 0.9778081, 'specificity': 0.9778081, 'f1': 0.9833521, 'auroc': 0.9985479, 'binary_precision': 0.9825541, 'binary_recall': 0.95738894, 'binary_specificity': 0.9982273, 'binary_f1_score': 0.9698083}
confusion matrix:
       0     1
0  42233    75
1    188  4224
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.7509428, 'recall': 0.57005817, 'specificity': 0.57005817, 'f1': 0.605097, 'auroc': 0.84360695, 'binary_precision': 0.5314286, 'binary_recall': 0.14463453, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.22738387}
confusion matrix:
       0   1
0  18067  82
1    550  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9550975, 'precision': 0.63018686, 'recall': 0.5258175, 'specificity': 0.5258175, 'f1': 0.53671986, 'auroc': 0.7699348, 'binary_precision': 0.3, 'binary_recall': 0.057471264, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.09646302}
confusion matrix:
      0   1
0  5962  35
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_18.png
early stop counter: 16
val acc:0.9663686752319336, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9566954374313354 / 0.9624480605125427
after epoch: 18,now: 2024-06-22 15:38:48.970681,epoch time: 0:13:16.478037,used: 4:06:48.891865,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.992851, 'precision': 0.974843, 'recall': 0.98387766, 'specificity': 0.98387766, 'f1': 0.97930634, 'auroc': 0.9981829, 'binary_precision': 0.95252883, 'binary_recall': 0.9728138, 'binary_specificity': 0.9949416, 'binary_f1_score': 0.96256447}
confusion matrix:
       0     1
0  42092   214
1    120  4294
---- Validation: 
scalar performance:
{'acc': 0.96376115, 'precision': 0.708343, 'recall': 0.61071134, 'specificity': 0.61071134, 'f1': 0.64289415, 'auroc': 0.84370804, 'binary_precision': 0.4434524, 'binary_recall': 0.23172629, 'binary_specificity': 0.9896964, 'binary_f1_score': 0.30439225}
confusion matrix:
       0    1
0  17962  187
1    494  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9511026, 'precision': 0.6124324, 'recall': 0.54205644, 'specificity': 0.54205644, 'f1': 0.5576425, 'auroc': 0.772334, 'binary_precision': 0.2631579, 'binary_recall': 0.09578544, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.14044945}
confusion matrix:
      0   1
0  5927  70
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_19.png
early stop counter: 17
val acc:0.9637611508369446, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9566954374313354 / 0.9624480605125427
after epoch: 19,now: 2024-06-22 15:52:02.476051,epoch time: 0:13:13.505370,used: 4:20:02.397235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9947988, 'precision': 0.9905429, 'recall': 0.9788519, 'specificity': 0.9788519, 'f1': 0.98460865, 'auroc': 0.9983707, 'binary_precision': 0.9853284, 'binary_recall': 0.95919293, 'binary_specificity': 0.99851096, 'binary_f1_score': 0.97208506}
confusion matrix:
       0     1
0  42246    63
1    180  4231
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.74966526, 'recall': 0.5948651, 'specificity': 0.5948651, 'f1': 0.6342745, 'auroc': 0.84870315, 'binary_precision': 0.52719665, 'binary_recall': 0.19595645, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.28571427}
confusion matrix:
       0    1
0  18036  113
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.72766525, 'recall': 0.5585513, 'specificity': 0.5585513, 'f1': 0.587413, 'auroc': 0.80776095, 'binary_precision': 0.4923077, 'binary_recall': 0.12260536, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.19631901}
confusion matrix:
      0   1
0  5964  33
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_20.png
early stop counter: 18
val acc:0.9664750695228577, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9566954374313354 / 0.9624480605125427
after epoch: 20,now: 2024-06-22 16:05:14.215793,epoch time: 0:13:11.739742,used: 4:33:14.136977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99458474, 'precision': 0.98691416, 'recall': 0.98126817, 'specificity': 0.98126817, 'f1': 0.98407036, 'auroc': 0.99755603, 'binary_precision': 0.9774868, 'binary_recall': 0.96485263, 'binary_specificity': 0.99768376, 'binary_f1_score': 0.9711286}
confusion matrix:
       0     1
0  42212    98
1    155  4255
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.7380494, 'recall': 0.593812, 'specificity': 0.593812, 'f1': 0.63155717, 'auroc': 0.8430159, 'binary_precision': 0.50403225, 'binary_recall': 0.19440125, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.28058362}
confusion matrix:
       0    1
0  18026  123
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95317996, 'precision': 0.62248695, 'recall': 0.535811, 'specificity': 0.535811, 'f1': 0.55065966, 'auroc': 0.7401041, 'binary_precision': 0.2837838, 'binary_recall': 0.08045977, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.12537314}
confusion matrix:
      0   1
0  5944  53
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_21.png
early stop counter: 19
val acc:0.9658897519111633, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9566954374313354 / 0.9624480605125427
after epoch: 21,now: 2024-06-22 16:18:35.786169,epoch time: 0:13:21.570376,used: 4:46:35.707353,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99456334, 'precision': 0.9907051, 'recall': 0.9773153, 'specificity': 0.9773153, 'f1': 0.98389363, 'auroc': 0.9981632, 'binary_precision': 0.9859813, 'binary_recall': 0.9560489, 'binary_specificity': 0.99858177, 'binary_f1_score': 0.9707844}
confusion matrix:
       0     1
0  42246    60
1    194  4220
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.7219795, 'recall': 0.5888709, 'specificity': 0.5888709, 'f1': 0.6240072, 'auroc': 0.8329103, 'binary_precision': 0.4722222, 'binary_recall': 0.18506998, 'binary_specificity': 0.9926718, 'binary_f1_score': 0.26592177}
confusion matrix:
       0    1
0  18016  133
1    524  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95669544, 'precision': 0.70961607, 'recall': 0.58895063, 'specificity': 0.58895063, 'f1': 0.62163633, 'auroc': 0.81155187, 'binary_precision': 0.4537037, 'binary_recall': 0.18773946, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.26558268}
confusion matrix:
      0   1
0  5938  59
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_22.png
early stop counter: 20
val acc:0.9650382995605469, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9566954374313354 / 0.9624480605125427
after epoch: 22,now: 2024-06-22 16:32:01.522015,epoch time: 0:13:25.735846,used: 5:00:01.443199,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_11_31_59_seed_0_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 22 with time: 5:00:01.443199 at 2024-06-22 16:32:01.522015
persisted model performance metric: 

scalar performance:
{'acc': 0.95669544, 'precision': 0.6677187, 'recall': 0.52665126, 'specificity': 0.52665126, 'f1': 0.53874093, 'auroc': 0.78575623, 'binary_precision': 0.375, 'binary_recall': 0.057471264, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.09966777}
confusion matrix:
      0   1
0  5972  25
1   246  15
oracle model performance metric: 

scalar performance:
{'acc': 0.96244806, 'precision': 0.79772484, 'recall': 0.6194371, 'specificity': 0.6194371, 'f1': 0.66664016, 'auroc': 0.82668376, 'binary_precision': 0.627451, 'binary_recall': 0.24521072, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.35261708}
confusion matrix:
      0   1
0  5959  38
1   197  64
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204391 KiB | 737101 KiB | 295924 GiB | 295924 GiB |
|       from large pool | 167936 KiB | 664960 KiB | 295688 GiB | 295688 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    235 GiB |    235 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204391 KiB | 737101 KiB | 295924 GiB | 295924 GiB |
|       from large pool | 167936 KiB | 664960 KiB | 295688 GiB | 295688 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    235 GiB |    235 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 730152 KiB | 295839 GiB | 295838 GiB |
|       from large pool | 165120 KiB | 658560 KiB | 295609 GiB | 295609 GiB |
|       from small pool |  35968 KiB |  72872 KiB |    229 GiB |    229 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    900 MiB |    900 MiB |    900 MiB |      0 B   |
|       from large pool |    828 MiB |    828 MiB |    828 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 104856 KiB | 260793 KiB | 199562 GiB | 199562 GiB |
|       from large pool |  96256 KiB | 259208 KiB | 199324 GiB | 199324 GiB |
|       from small pool |   8600 KiB |  12448 KiB |    238 GiB |    238 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2076    |    3669    |   32430 K  |   32428 K  |
|       from large pool |      36    |      76    |   10885 K  |   10885 K  |
|       from small pool |    2040    |    3632    |   21544 K  |   21542 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2076    |    3669    |   32430 K  |   32428 K  |
|       from large pool |      36    |      76    |   10885 K  |   10885 K  |
|       from small pool |    2040    |    3632    |   21544 K  |   21542 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      15    |      15    |      15    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    1476    |   14292 K  |   14292 K  |
|       from large pool |       5    |      10    |    4064 K  |    4064 K  |
|       from small pool |      30    |    1471    |   10228 K  |   10227 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 737101 KiB | 295924 GiB | 295924 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 295688 GiB | 295688 GiB |
|       from small pool |      0 KiB |  73422 KiB |    235 GiB |    235 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 737101 KiB | 295924 GiB | 295924 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 295688 GiB | 295688 GiB |
|       from small pool |      0 KiB |  73422 KiB |    235 GiB |    235 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 730152 KiB | 295839 GiB | 295839 GiB |
|       from large pool |  16640 KiB | 658560 KiB | 295609 GiB | 295609 GiB |
|       from small pool |      0 KiB |  72872 KiB |    229 GiB |    229 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    900 MiB |    900 MiB | 612352 KiB |
|       from large pool | 264192 KiB |    828 MiB |    828 MiB | 583680 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 260793 KiB | 199562 GiB | 199562 GiB |
|       from large pool |  83712 KiB | 259208 KiB | 199324 GiB | 199324 GiB |
|       from small pool |      0 KiB |  16195 KiB |    238 GiB |    238 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   32430 K  |   32430 K  |
|       from large pool |       2    |      76    |   10885 K  |   10885 K  |
|       from small pool |       0    |    3632    |   21544 K  |   21544 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   32430 K  |   32430 K  |
|       from large pool |       2    |      76    |   10885 K  |   10885 K  |
|       from small pool |       0    |    3632    |   21544 K  |   21544 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   14292 K  |   14292 K  |
|       from large pool |       1    |      11    |    4064 K  |    4064 K  |
|       from small pool |       0    |    1471    |   10228 K  |   10228 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 737101 KiB | 295924 GiB | 295924 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 295688 GiB | 295688 GiB |
|       from small pool |      0 KiB |  73422 KiB |    235 GiB |    235 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 737101 KiB | 295924 GiB | 295924 GiB |
|       from large pool |  16640 KiB | 664960 KiB | 295688 GiB | 295688 GiB |
|       from small pool |      0 KiB |  73422 KiB |    235 GiB |    235 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 730152 KiB | 295839 GiB | 295839 GiB |
|       from large pool |  16640 KiB | 658560 KiB | 295609 GiB | 295609 GiB |
|       from small pool |      0 KiB |  72872 KiB |    229 GiB |    229 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    900 MiB |    900 MiB | 612352 KiB |
|       from large pool | 264192 KiB |    828 MiB |    828 MiB | 583680 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 260793 KiB | 199562 GiB | 199562 GiB |
|       from large pool |  83712 KiB | 259208 KiB | 199324 GiB | 199324 GiB |
|       from small pool |      0 KiB |  16195 KiB |    238 GiB |    238 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   32430 K  |   32430 K  |
|       from large pool |       2    |      76    |   10885 K  |   10885 K  |
|       from small pool |       0    |    3632    |   21544 K  |   21544 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   32430 K  |   32430 K  |
|       from large pool |       2    |      76    |   10885 K  |   10885 K  |
|       from small pool |       0    |    3632    |   21544 K  |   21544 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   14292 K  |   14292 K  |
|       from large pool |       1    |      11    |    4064 K  |    4064 K  |
|       from small pool |       0    |    1471    |   10228 K  |   10228 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987

 Experiment start at: 2024-06-22 16:37:49.774651
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9903467, 'precision': 0.97759783, 'recall': 0.9643598, 'specificity': 0.9643598, 'f1': 0.9708621, 'auroc': 0.9946457, 'binary_precision': 0.9620616, 'binary_recall': 0.93246996, 'binary_specificity': 0.9962497, 'binary_f1_score': 0.9470347}
confusion matrix:
       0     1
0  42237   159
1    292  4032
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.76367724, 'recall': 0.6246822, 'specificity': 0.6246822, 'f1': 0.6668799, 'auroc': 0.85103965, 'binary_precision': 0.55448717, 'binary_recall': 0.25705793, 'binary_specificity': 0.9923064, 'binary_f1_score': 0.351269}
confusion matrix:
       0    1
0  17928  139
1    500  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.7897799, 'recall': 0.5748208, 'specificity': 0.5748208, 'f1': 0.6129421, 'auroc': 0.85700697, 'binary_precision': 0.61538464, 'binary_recall': 0.15384616, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.24615386}
confusion matrix:
      0   1
0  5921  25
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 16:52:05.665878,epoch time: 0:14:15.891227,used: 0:14:15.891227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.991738, 'precision': 0.9821993, 'recall': 0.96811676, 'specificity': 0.96811676, 'f1': 0.9750272, 'auroc': 0.9964816, 'binary_precision': 0.9705812, 'binary_recall': 0.9391345, 'binary_specificity': 0.997099, 'binary_f1_score': 0.9545989}
confusion matrix:
       0     1
0  42276   123
1    263  4058
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.7649448, 'recall': 0.61896, 'specificity': 0.61896, 'f1': 0.6615279, 'auroc': 0.8389641, 'binary_precision': 0.5574324, 'binary_recall': 0.24517088, 'binary_specificity': 0.9927492, 'binary_f1_score': 0.34055728}
confusion matrix:
       0    1
0  17936  131
1    508  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9553658, 'precision': 0.67604196, 'recall': 0.5537401, 'specificity': 0.5537401, 'f1': 0.5775508, 'auroc': 0.83351505, 'binary_precision': 0.38961038, 'binary_recall': 0.115384616, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.17804155}
confusion matrix:
      0   1
0  5899  47
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_2.png
early stop counter: 1
val acc:0.965901792049408, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9605220556259155 / 0.9605220556259155
after epoch: 2,now: 2024-06-22 17:05:51.575890,epoch time: 0:13:45.910012,used: 0:28:01.801239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9928296, 'precision': 0.99119186, 'recall': 0.9658317, 'specificity': 0.9658317, 'f1': 0.9780922, 'auroc': 0.99716926, 'binary_precision': 0.98920774, 'binary_recall': 0.93270123, 'binary_specificity': 0.99896216, 'binary_f1_score': 0.9601238}
confusion matrix:
       0     1
0  42352    44
1    291  4033
---- Validation: 
scalar performance:
{'acc': 0.96542156, 'precision': 0.7714742, 'recall': 0.57007277, 'specificity': 0.57007277, 'f1': 0.60635865, 'auroc': 0.83478475, 'binary_precision': 0.5739645, 'binary_recall': 0.14413075, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.2304038}
confusion matrix:
       0   1
0  17995  72
1    576  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.70779854, 'recall': 0.5364434, 'specificity': 0.5364434, 'f1': 0.5548876, 'auroc': 0.8161655, 'binary_precision': 0.45454547, 'binary_recall': 0.07692308, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.13157895}
confusion matrix:
      0   1
0  5922  24
1   240  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_3.png
early stop counter: 2
val acc:0.9654215574264526, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9605220556259155 / 0.9605220556259155
after epoch: 3,now: 2024-06-22 17:19:40.592307,epoch time: 0:13:49.016417,used: 0:41:50.817656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9927012, 'precision': 0.97840255, 'recall': 0.97810423, 'specificity': 0.97810423, 'f1': 0.97825336, 'auroc': 0.9977137, 'binary_precision': 0.9608615, 'binary_recall': 0.9601944, 'binary_specificity': 0.99601406, 'binary_f1_score': 0.96052784}
confusion matrix:
       0     1
0  42230   169
1    172  4149
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.73761755, 'recall': 0.61306757, 'specificity': 0.61306757, 'f1': 0.6508875, 'auroc': 0.8379614, 'binary_precision': 0.50318474, 'binary_recall': 0.23476969, 'binary_specificity': 0.9913655, 'binary_f1_score': 0.32016212}
confusion matrix:
       0    1
0  17911  156
1    515  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9505317, 'precision': 0.6169153, 'recall': 0.5475394, 'specificity': 0.5475394, 'f1': 0.56439537, 'auroc': 0.7952069, 'binary_precision': 0.27184466, 'binary_recall': 0.10769231, 'binary_specificity': 0.98738647, 'binary_f1_score': 0.15426998}
confusion matrix:
      0   1
0  5871  75
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_4.png
early stop counter: 3
val acc:0.9641942381858826, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9605220556259155 / 0.9605220556259155
after epoch: 4,now: 2024-06-22 17:33:39.006415,epoch time: 0:13:58.414108,used: 0:55:49.231764,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9946918, 'precision': 0.9901207, 'recall': 0.97807246, 'specificity': 0.97807246, 'f1': 0.9840027, 'auroc': 0.9975265, 'binary_precision': 0.9845459, 'binary_recall': 0.9576781, 'binary_specificity': 0.99846685, 'binary_f1_score': 0.9709261}
confusion matrix:
       0     1
0  42331    65
1    183  4141
---- Validation: 
scalar performance:
{'acc': 0.9654749, 'precision': 0.77407646, 'recall': 0.5686699, 'specificity': 0.5686699, 'f1': 0.6046722, 'auroc': 0.8282489, 'binary_precision': 0.5792683, 'binary_recall': 0.14115898, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.22700119}
confusion matrix:
       0   1
0  17998  69
1    578  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.6998576, 'recall': 0.5199766, 'specificity': 0.5199766, 'f1': 0.52775294, 'auroc': 0.7922803, 'binary_precision': 0.44, 'binary_recall': 0.042307694, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.077192985}
confusion matrix:
      0   1
0  5932  14
1   249  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_5.png
early stop counter: 4
val acc:0.9654749035835266, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9605220556259155 / 0.9605220556259155
after epoch: 5,now: 2024-06-22 17:47:25.600203,epoch time: 0:13:46.593788,used: 1:09:35.825552,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.993857, 'precision': 0.9895958, 'recall': 0.9735746, 'specificity': 0.9735746, 'f1': 0.9814184, 'auroc': 0.997753, 'binary_precision': 0.98440874, 'binary_recall': 0.94868237, 'binary_specificity': 0.9984668, 'binary_f1_score': 0.96621543}
confusion matrix:
       0     1
0  42329    65
1    222  4104
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.7817465, 'recall': 0.5948347, 'specificity': 0.5948347, 'f1': 0.6378952, 'auroc': 0.83139837, 'binary_precision': 0.5927602, 'binary_recall': 0.19465081, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.29306486}
confusion matrix:
       0    1
0  17977   90
1    542  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9537544, 'precision': 0.611657, 'recall': 0.5253144, 'specificity': 0.5253144, 'f1': 0.5354542, 'auroc': 0.78949404, 'binary_precision': 0.2631579, 'binary_recall': 0.057692308, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.09463722}
confusion matrix:
      0   1
0  5904  42
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_6.png
better model found
persisted
after epoch: 6,now: 2024-06-22 18:00:56.575633,epoch time: 0:13:30.975430,used: 1:23:06.800982,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9938356, 'precision': 0.9889487, 'recall': 0.9740586, 'specificity': 0.9740586, 'f1': 0.9813596, 'auroc': 0.997103, 'binary_precision': 0.9829981, 'binary_recall': 0.9497918, 'binary_specificity': 0.9983254, 'binary_f1_score': 0.96610975}
confusion matrix:
       0     1
0  42327    71
1    217  4105
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.7648356, 'recall': 0.5735661, 'specificity': 0.5735661, 'f1': 0.61041087, 'auroc': 0.81964076, 'binary_precision': 0.5604396, 'binary_recall': 0.15156017, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.23859648}
confusion matrix:
       0    1
0  17987   80
1    571  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95649374, 'precision': 0.6892152, 'recall': 0.54513377, 'specificity': 0.54513377, 'f1': 0.5669606, 'auroc': 0.7866006, 'binary_precision': 0.41666666, 'binary_recall': 0.09615385, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.15625001}
confusion matrix:
      0   1
0  5911  35
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_7.png
early stop counter: 1
val acc:0.9652614593505859, best validation acc: 0.9662753343582153, corresponding to test acc:                         0.9537544250488281 / 0.9605220556259155
after epoch: 7,now: 2024-06-22 18:14:17.707622,epoch time: 0:13:21.131989,used: 1:36:27.932971,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99304366, 'precision': 0.97877514, 'recall': 0.9798683, 'specificity': 0.9798683, 'f1': 0.979321, 'auroc': 0.99768364, 'binary_precision': 0.9612546, 'binary_recall': 0.9636994, 'binary_specificity': 0.99603724, 'binary_f1_score': 0.9624755}
confusion matrix:
       0     1
0  42227   168
1    157  4168
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.74249125, 'recall': 0.61466414, 'specificity': 0.61466414, 'f1': 0.6533257, 'auroc': 0.8517071, 'binary_precision': 0.51282054, 'binary_recall': 0.23774146, 'binary_specificity': 0.99158686, 'binary_f1_score': 0.3248731}
confusion matrix:
       0    1
0  17915  152
1    513  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.950854, 'precision': 0.61961305, 'recall': 0.54770756, 'specificity': 0.54770756, 'f1': 0.5649078, 'auroc': 0.7925074, 'binary_precision': 0.27722773, 'binary_recall': 0.10769231, 'binary_specificity': 0.9877228, 'binary_f1_score': 0.15512466}
confusion matrix:
      0   1
0  5873  73
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_8.png
early stop counter: 2
val acc:0.964514434337616, best validation acc: 0.9662753343582153, corresponding to test acc:                         0.9537544250488281 / 0.9605220556259155
after epoch: 8,now: 2024-06-22 18:27:39.357317,epoch time: 0:13:21.649695,used: 1:49:49.582666,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99407107, 'precision': 0.9891056, 'recall': 0.97534764, 'specificity': 0.97534764, 'f1': 0.9821037, 'auroc': 0.9977735, 'binary_precision': 0.9830549, 'binary_recall': 0.9523699, 'binary_specificity': 0.9983253, 'binary_f1_score': 0.96746916}
confusion matrix:
       0     1
0  42324    71
1    206  4119
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.78453106, 'recall': 0.54058075, 'specificity': 0.54058075, 'f1': 0.5642004, 'auroc': 0.8232838, 'binary_precision': 0.60215056, 'binary_recall': 0.08320951, 'binary_specificity': 0.99795204, 'binary_f1_score': 0.1462141}
confusion matrix:
       0   1
0  18030  37
1    617  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9550435, 'precision': 0.59386766, 'recall': 0.5131142, 'specificity': 0.5131142, 'f1': 0.51560587, 'auroc': 0.7771665, 'binary_precision': 0.22857143, 'binary_recall': 0.03076923, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.054237287}
confusion matrix:
      0   1
0  5919  27
1   252   8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_9.png
early stop counter: 3
val acc:0.9651013612747192, best validation acc: 0.9662753343582153, corresponding to test acc:                         0.9537544250488281 / 0.9605220556259155
after epoch: 9,now: 2024-06-22 18:40:55.842194,epoch time: 0:13:16.484877,used: 2:03:06.067543,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9943065, 'precision': 0.9890501, 'recall': 0.9768269, 'specificity': 0.9768269, 'f1': 0.9828416, 'auroc': 0.9979174, 'binary_precision': 0.98263973, 'binary_recall': 0.95537573, 'binary_specificity': 0.9982781, 'binary_f1_score': 0.9688159}
confusion matrix:
       0     1
0  42322    73
1    193  4132
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.74233913, 'recall': 0.5709775, 'specificity': 0.5709775, 'f1': 0.60534257, 'auroc': 0.8213538, 'binary_precision': 0.515625, 'binary_recall': 0.14710252, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.22890171}
confusion matrix:
       0   1
0  17974  93
1    574  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.68696004, 'recall': 0.534268, 'specificity': 0.534268, 'f1': 0.55102265, 'auroc': 0.8001349, 'binary_precision': 0.41304347, 'binary_recall': 0.073076926, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.12418301}
confusion matrix:
      0   1
0  5919  27
1   241  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_10.png
early stop counter: 4
val acc:0.9644076824188232, best validation acc: 0.9662753343582153, corresponding to test acc:                         0.9537544250488281 / 0.9605220556259155
after epoch: 10,now: 2024-06-22 18:54:10.248020,epoch time: 0:13:14.405826,used: 2:16:20.473369,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99452055, 'precision': 0.9921075, 'recall': 0.9750593, 'specificity': 0.9750593, 'f1': 0.9833956, 'auroc': 0.99795216, 'binary_precision': 0.9891723, 'binary_recall': 0.95118, 'binary_specificity': 0.9989386, 'binary_f1_score': 0.9698042}
confusion matrix:
       0     1
0  42353    45
1    211  4111
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.76492965, 'recall': 0.55915004, 'specificity': 0.55915004, 'f1': 0.5911889, 'auroc': 0.834962, 'binary_precision': 0.56164384, 'binary_recall': 0.121842496, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.20024419}
confusion matrix:
       0   1
0  18003  64
1    591  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.69279516, 'recall': 0.5307582, 'specificity': 0.5307582, 'f1': 0.5456858, 'auroc': 0.7843723, 'binary_precision': 0.425, 'binary_recall': 0.06538462, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.11333334}
confusion matrix:
      0   1
0  5923  23
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_11.png
early stop counter: 5
val acc:0.9650480151176453, best validation acc: 0.9662753343582153, corresponding to test acc:                         0.9537544250488281 / 0.9605220556259155
after epoch: 11,now: 2024-06-22 19:07:30.428471,epoch time: 0:13:20.180451,used: 2:29:40.653820,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9942423, 'precision': 0.99056613, 'recall': 0.97491163, 'specificity': 0.97491163, 'f1': 0.98258007, 'auroc': 0.9975636, 'binary_precision': 0.98609114, 'binary_recall': 0.9511913, 'binary_specificity': 0.99863195, 'binary_f1_score': 0.96832687}
confusion matrix:
       0     1
0  42339    58
1    211  4112
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.789544, 'recall': 0.595716, 'specificity': 0.595716, 'f1': 0.6397604, 'auroc': 0.8360147, 'binary_precision': 0.6082949, 'binary_recall': 0.1961367, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.29662922}
confusion matrix:
       0    1
0  17982   85
1    541  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9555269, 'precision': 0.6431571, 'recall': 0.52623934, 'specificity': 0.52623934, 'f1': 0.5376203, 'auroc': 0.7651228, 'binary_precision': 0.32608697, 'binary_recall': 0.057692308, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.09803922}
confusion matrix:
      0   1
0  5915  31
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_12.png
better model found
persisted
after epoch: 12,now: 2024-06-22 19:21:06.190878,epoch time: 0:13:35.762407,used: 2:43:16.416227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9921447, 'precision': 0.97526777, 'recall': 0.97812724, 'specificity': 0.97812724, 'f1': 0.9766921, 'auroc': 0.9973529, 'binary_precision': 0.9545246, 'binary_recall': 0.96092486, 'binary_specificity': 0.9953296, 'binary_f1_score': 0.957714}
confusion matrix:
       0     1
0  42197   198
1    169  4156
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.73814344, 'recall': 0.6716641, 'specificity': 0.6716641, 'f1': 0.69888955, 'auroc': 0.874084, 'binary_precision': 0.5, 'binary_recall': 0.35661218, 'binary_specificity': 0.9867161, 'binary_f1_score': 0.41630527}
confusion matrix:
       0    1
0  17827  240
1    433  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95246536, 'precision': 0.641051, 'recall': 0.55406547, 'specificity': 0.55406547, 'f1': 0.57459915, 'auroc': 0.7928302, 'binary_precision': 0.31958762, 'binary_recall': 0.11923077, 'binary_specificity': 0.9889001, 'binary_f1_score': 0.17366947}
confusion matrix:
      0   1
0  5880  66
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_13.png
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9555268883705139 / 0.9605220556259155
after epoch: 13,now: 2024-06-22 19:34:46.078826,epoch time: 0:13:39.887948,used: 2:56:56.304175,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99445635, 'precision': 0.98904157, 'recall': 0.97773504, 'specificity': 0.97773504, 'f1': 0.98330545, 'auroc': 0.9981188, 'binary_precision': 0.98243535, 'binary_recall': 0.95721555, 'binary_specificity': 0.99825454, 'binary_f1_score': 0.9696615}
confusion matrix:
       0     1
0  42322    74
1    185  4139
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.76676595, 'recall': 0.58657926, 'specificity': 0.58657926, 'f1': 0.6266136, 'auroc': 0.85558605, 'binary_precision': 0.5633803, 'binary_recall': 0.17830609, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.27088034}
confusion matrix:
       0    1
0  17974   93
1    553  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95568806, 'precision': 0.64678353, 'recall': 0.52632344, 'specificity': 0.52632344, 'f1': 0.5378233, 'auroc': 0.7596364, 'binary_precision': 0.33333334, 'binary_recall': 0.057692308, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.09836066}
confusion matrix:
      0   1
0  5916  30
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_14.png
early stop counter: 2
val acc:0.9655283093452454, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9555268883705139 / 0.9605220556259155
after epoch: 14,now: 2024-06-22 19:48:24.397062,epoch time: 0:13:38.318236,used: 3:10:34.622411,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9931507, 'precision': 0.9782862, 'recall': 0.9810654, 'specificity': 0.9810654, 'f1': 0.97967076, 'auroc': 0.99780184, 'binary_precision': 0.9600184, 'binary_recall': 0.966235, 'binary_specificity': 0.99589586, 'binary_f1_score': 0.9631167}
confusion matrix:
       0     1
0  42222   174
1    146  4178
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.74655735, 'recall': 0.6534823, 'specificity': 0.6534823, 'f1': 0.68801343, 'auroc': 0.8687169, 'binary_precision': 0.5181598, 'binary_recall': 0.3179792, 'binary_specificity': 0.9889854, 'binary_f1_score': 0.3941068}
confusion matrix:
       0    1
0  17868  199
1    459  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9510152, 'precision': 0.6416737, 'recall': 0.5680205, 'specificity': 0.5680205, 'f1': 0.5894592, 'auroc': 0.81702614, 'binary_precision': 0.31967214, 'binary_recall': 0.15, 'binary_specificity': 0.986041, 'binary_f1_score': 0.2041885}
confusion matrix:
      0   1
0  5863  83
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_15.png
early stop counter: 3
val acc:0.9648879170417786, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9555268883705139 / 0.9605220556259155
after epoch: 15,now: 2024-06-22 20:01:50.792894,epoch time: 0:13:26.395832,used: 3:24:01.018243,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9941995, 'precision': 0.9887667, 'recall': 0.97643566, 'specificity': 0.97643566, 'f1': 0.98250246, 'auroc': 0.9981684, 'binary_precision': 0.98214287, 'binary_recall': 0.95464015, 'binary_specificity': 0.9982311, 'binary_f1_score': 0.96819615}
confusion matrix:
       0     1
0  42324    75
1    196  4125
---- Validation: 
scalar performance:
{'acc': 0.9635539, 'precision': 0.72450227, 'recall': 0.581979, 'specificity': 0.581979, 'f1': 0.61661935, 'auroc': 0.8512243, 'binary_precision': 0.47916666, 'binary_recall': 0.17087667, 'binary_specificity': 0.99308133, 'binary_f1_score': 0.25191677}
confusion matrix:
       0    1
0  17942  125
1    558  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9545601, 'precision': 0.62831724, 'recall': 0.5275738, 'specificity': 0.5275738, 'f1': 0.53930056, 'auroc': 0.7768896, 'binary_precision': 0.2962963, 'binary_recall': 0.06153846, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.10191083}
confusion matrix:
      0   1
0  5908  38
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_16.png
early stop counter: 4
val acc:0.9635539054870605, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9555268883705139 / 0.9605220556259155
after epoch: 16,now: 2024-06-22 20:15:23.618232,epoch time: 0:13:32.825338,used: 3:37:33.843581,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99454194, 'precision': 0.98786926, 'recall': 0.97943914, 'specificity': 0.97943914, 'f1': 0.9836081, 'auroc': 0.9984354, 'binary_precision': 0.97971696, 'binary_recall': 0.9609068, 'binary_specificity': 0.99797153, 'binary_f1_score': 0.9702207}
confusion matrix:
       0     1
0  42311    86
1    169  4154
---- Validation: 
scalar performance:
{'acc': 0.96286017, 'precision': 0.7205867, 'recall': 0.6216742, 'specificity': 0.6216742, 'f1': 0.65519047, 'auroc': 0.8554342, 'binary_precision': 0.46849316, 'binary_recall': 0.25408617, 'binary_specificity': 0.98926216, 'binary_f1_score': 0.32947975}
confusion matrix:
       0    1
0  17873  194
1    502  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95294875, 'precision': 0.6667569, 'recall': 0.5800635, 'specificity': 0.5800635, 'f1': 0.60566473, 'auroc': 0.82967854, 'binary_precision': 0.36885247, 'binary_recall': 0.17307693, 'binary_specificity': 0.9870501, 'binary_f1_score': 0.23560211}
confusion matrix:
      0   1
0  5869  77
1   215  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_17.png
early stop counter: 5
val acc:0.9628601670265198, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9555268883705139 / 0.9605220556259155
after epoch: 17,now: 2024-06-22 20:28:56.087643,epoch time: 0:13:32.469411,used: 3:51:06.312992,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9943493, 'precision': 0.9874376, 'recall': 0.9787098, 'specificity': 0.9787098, 'f1': 0.9830243, 'auroc': 0.99772143, 'binary_precision': 0.97899455, 'binary_recall': 0.95951885, 'binary_specificity': 0.9979008, 'binary_f1_score': 0.9691589}
confusion matrix:
       0     1
0  42308    89
1    175  4148
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.74349546, 'recall': 0.5889145, 'specificity': 0.5889145, 'f1': 0.62672305, 'auroc': 0.83281726, 'binary_precision': 0.51666665, 'binary_recall': 0.18424962, 'binary_specificity': 0.99357945, 'binary_f1_score': 0.27163196}
confusion matrix:
       0    1
0  17951  116
1    549  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.7261613, 'recall': 0.57523024, 'specificity': 0.57523024, 'f1': 0.60833085, 'auroc': 0.8141212, 'binary_precision': 0.48809522, 'binary_recall': 0.15769231, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.23837209}
confusion matrix:
      0   1
0  5903  43
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_18.png
early stop counter: 6
val acc:0.964514434337616, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9555268883705139 / 0.9605220556259155
after epoch: 18,now: 2024-06-22 20:43:01.262733,epoch time: 0:14:05.175090,used: 4:05:11.488082,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99377143, 'precision': 0.98093605, 'recall': 0.98203415, 'specificity': 0.98203415, 'f1': 0.9814843, 'auroc': 0.99843013, 'binary_precision': 0.9651753, 'binary_recall': 0.96763, 'binary_specificity': 0.99643826, 'binary_f1_score': 0.9664011}
confusion matrix:
       0     1
0  42244   151
1    140  4185
---- Validation: 
scalar performance:
{'acc': 0.9626467, 'precision': 0.7218653, 'recall': 0.64659786, 'specificity': 0.64659786, 'f1': 0.67562795, 'auroc': 0.85855055, 'binary_precision': 0.4692483, 'binary_recall': 0.3060921, 'binary_specificity': 0.9871036, 'binary_f1_score': 0.37050357}
confusion matrix:
       0    1
0  17834  233
1    467  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94956493, 'precision': 0.65174985, 'recall': 0.5966875, 'specificity': 0.5966875, 'f1': 0.61697006, 'auroc': 0.8031469, 'binary_precision': 0.33742332, 'binary_recall': 0.21153846, 'binary_specificity': 0.98183656, 'binary_f1_score': 0.26004732}
confusion matrix:
      0    1
0  5838  108
1   205   55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_19.png
early stop counter: 7
val acc:0.9626467227935791, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9555268883705139 / 0.9605220556259155
after epoch: 19,now: 2024-06-22 20:57:26.550101,epoch time: 0:14:25.287368,used: 4:19:36.775450,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99443495, 'precision': 0.9888264, 'recall': 0.97783685, 'specificity': 0.97783685, 'f1': 0.98325336, 'auroc': 0.9982488, 'binary_precision': 0.981982, 'binary_recall': 0.9574665, 'binary_specificity': 0.9982073, 'binary_f1_score': 0.9695693}
confusion matrix:
       0     1
0  42318    76
1    184  4142
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.731835, 'recall': 0.59716564, 'specificity': 0.59716564, 'f1': 0.6340426, 'auroc': 0.8469149, 'binary_precision': 0.49275362, 'binary_recall': 0.20208023, 'binary_specificity': 0.99225104, 'binary_f1_score': 0.2866175}
confusion matrix:
       0    1
0  17927  140
1    537  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95327103, 'precision': 0.6478635, 'recall': 0.5526469, 'specificity': 0.5526469, 'f1': 0.57369304, 'auroc': 0.80529785, 'binary_precision': 0.33333334, 'binary_recall': 0.115384616, 'binary_specificity': 0.9899092, 'binary_f1_score': 0.17142858}
confusion matrix:
      0   1
0  5886  60
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_20.png
early stop counter: 8
val acc:0.9638740420341492, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9555268883705139 / 0.9605220556259155
after epoch: 20,now: 2024-06-22 21:11:31.272381,epoch time: 0:14:04.722280,used: 4:33:41.497730,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9942637, 'precision': 0.98850584, 'recall': 0.9771097, 'specificity': 0.9771097, 'f1': 0.9827235, 'auroc': 0.9979908, 'binary_precision': 0.9814815, 'binary_recall': 0.9560592, 'binary_specificity': 0.9981602, 'binary_f1_score': 0.96860355}
confusion matrix:
       0     1
0  42318    78
1    190  4134
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.7424335, 'recall': 0.6175252, 'specificity': 0.6175252, 'f1': 0.65604323, 'auroc': 0.85781515, 'binary_precision': 0.5125, 'binary_recall': 0.24368499, 'binary_specificity': 0.9913655, 'binary_f1_score': 0.33031216}
confusion matrix:
       0    1
0  17911  156
1    509  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95568806, 'precision': 0.7031442, 'recall': 0.5998829, 'specificity': 0.5998829, 'f1': 0.63142455, 'auroc': 0.82363904, 'binary_precision': 0.44, 'binary_recall': 0.21153846, 'binary_specificity': 0.98822737, 'binary_f1_score': 0.28571427}
confusion matrix:
      0   1
0  5876  70
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_21.png
early stop counter: 9
val acc:0.964514434337616, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9555268883705139 / 0.9605220556259155
after epoch: 21,now: 2024-06-22 21:25:03.462311,epoch time: 0:13:32.189930,used: 4:47:13.687660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99445635, 'precision': 0.9896606, 'recall': 0.97711205, 'specificity': 0.97711205, 'f1': 0.98328435, 'auroc': 0.9977983, 'binary_precision': 0.9838134, 'binary_recall': 0.95582795, 'binary_specificity': 0.9983961, 'binary_f1_score': 0.9696188}
confusion matrix:
       0     1
0  42328    68
1    191  4133
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.72956777, 'recall': 0.57070076, 'specificity': 0.57070076, 'f1': 0.60389555, 'auroc': 0.83257544, 'binary_precision': 0.490099, 'binary_recall': 0.14710252, 'binary_specificity': 0.994299, 'binary_f1_score': 0.2262857}
confusion matrix:
       0    1
0  17964  103
1    574   99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9537544, 'precision': 0.59750086, 'recall': 0.51979744, 'specificity': 0.51979744, 'f1': 0.52672666, 'auroc': 0.73476934, 'binary_precision': 0.23529412, 'binary_recall': 0.046153847, 'binary_specificity': 0.993441, 'binary_f1_score': 0.07717042}
confusion matrix:
      0   1
0  5907  39
1   248  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_22.png
early stop counter: 10
val acc:0.9638740420341492, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9555268883705139 / 0.9605220556259155
after epoch: 22,now: 2024-06-22 21:38:26.244478,epoch time: 0:13:22.782167,used: 5:00:36.469827,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9942209, 'precision': 0.98231506, 'recall': 0.98331654, 'specificity': 0.98331654, 'f1': 0.98281515, 'auroc': 0.9984165, 'binary_precision': 0.96769726, 'binary_recall': 0.96993524, 'binary_specificity': 0.9966978, 'binary_f1_score': 0.96881497}
confusion matrix:
       0     1
0  42256   140
1    130  4194
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.7393107, 'recall': 0.6217061, 'specificity': 0.6217061, 'f1': 0.659312, 'auroc': 0.8666711, 'binary_precision': 0.50595236, 'binary_recall': 0.25260028, 'binary_specificity': 0.990812, 'binary_f1_score': 0.3369673}
confusion matrix:
       0    1
0  17901  166
1    503  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9518208, 'precision': 0.64699376, 'recall': 0.566602, 'specificity': 0.566602, 'f1': 0.5889133, 'auroc': 0.81495816, 'binary_precision': 0.33043477, 'binary_recall': 0.14615385, 'binary_specificity': 0.9870501, 'binary_f1_score': 0.20266667}
confusion matrix:
      0   1
0  5869  77
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_23.png
early stop counter: 11
val acc:0.9643009901046753, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9555268883705139 / 0.9605220556259155
after epoch: 23,now: 2024-06-22 21:51:44.756216,epoch time: 0:13:18.511738,used: 5:13:54.981565,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9936858, 'precision': 0.9800119, 'recall': 0.98250246, 'specificity': 0.98250246, 'f1': 0.98125315, 'auroc': 0.99817264, 'binary_precision': 0.9632099, 'binary_recall': 0.9687789, 'binary_specificity': 0.9962261, 'binary_f1_score': 0.96598643}
confusion matrix:
       0     1
0  42236   160
1    135  4189
---- Validation: 
scalar performance:
{'acc': 0.9629136, 'precision': 0.7222755, 'recall': 0.6288545, 'specificity': 0.6288545, 'f1': 0.6616987, 'auroc': 0.8598944, 'binary_precision': 0.47135416, 'binary_recall': 0.268945, 'binary_specificity': 0.98876405, 'binary_f1_score': 0.3424787}
confusion matrix:
       0    1
0  17864  203
1    492  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95262647, 'precision': 0.6514507, 'recall': 0.5633445, 'specificity': 0.5633445, 'f1': 0.58615744, 'auroc': 0.7926855, 'binary_precision': 0.33962265, 'binary_recall': 0.13846155, 'binary_specificity': 0.98822737, 'binary_f1_score': 0.1967213}
confusion matrix:
      0   1
0  5876  70
1   224  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_24.png
early stop counter: 12
val acc:0.9629135727882385, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9555268883705139 / 0.9605220556259155
after epoch: 24,now: 2024-06-22 22:05:08.199943,epoch time: 0:13:23.443727,used: 5:27:18.425292,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99454194, 'precision': 0.99023354, 'recall': 0.9770553, 'specificity': 0.9770553, 'f1': 0.9835321, 'auroc': 0.9981616, 'binary_precision': 0.98498213, 'binary_recall': 0.9555967, 'binary_specificity': 0.998514, 'binary_f1_score': 0.97006696}
confusion matrix:
       0     1
0  42333    63
1    192  4132
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.757781, 'recall': 0.5914201, 'specificity': 0.5914201, 'f1': 0.63126314, 'auroc': 0.85965884, 'binary_precision': 0.5450644, 'binary_recall': 0.18870728, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.2803532}
confusion matrix:
       0    1
0  17961  106
1    546  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9547212, 'precision': 0.6569039, 'recall': 0.54420877, 'specificity': 0.54420877, 'f1': 0.56389886, 'auroc': 0.7861093, 'binary_precision': 0.35211268, 'binary_recall': 0.09615385, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.15105739}
confusion matrix:
      0   1
0  5900  46
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_25.png
early stop counter: 13
val acc:0.965208113193512, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9555268883705139 / 0.9605220556259155
after epoch: 25,now: 2024-06-22 22:18:27.320147,epoch time: 0:13:19.120204,used: 5:40:37.545496,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9950128, 'precision': 0.9880836, 'recall': 0.98209536, 'specificity': 0.98209536, 'f1': 0.9850663, 'auroc': 0.99875176, 'binary_precision': 0.9796062, 'binary_recall': 0.9662428, 'binary_specificity': 0.9979479, 'binary_f1_score': 0.97287863}
confusion matrix:
       0     1
0  42308    87
1    146  4179
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.7535903, 'recall': 0.60855883, 'specificity': 0.60855883, 'f1': 0.6491761, 'auroc': 0.85512364, 'binary_precision': 0.535461, 'binary_recall': 0.2243685, 'binary_specificity': 0.9927492, 'binary_f1_score': 0.31623036}
confusion matrix:
       0    1
0  17936  131
1    522  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.7229988, 'recall': 0.5733072, 'specificity': 0.5733072, 'f1': 0.60572237, 'auroc': 0.81175125, 'binary_precision': 0.48192772, 'binary_recall': 0.15384616, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.23323616}
confusion matrix:
      0   1
0  5903  43
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_26.png
early stop counter: 14
val acc:0.965154767036438, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9555268883705139 / 0.9605220556259155
after epoch: 26,now: 2024-06-22 22:31:47.620595,epoch time: 0:13:20.300448,used: 5:53:57.845944,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99304366, 'precision': 0.97820437, 'recall': 0.9804872, 'specificity': 0.9804872, 'f1': 0.97934246, 'auroc': 0.9977657, 'binary_precision': 0.9599724, 'binary_recall': 0.96507865, 'binary_specificity': 0.99589586, 'binary_f1_score': 0.9625188}
confusion matrix:
       0     1
0  42222   174
1    151  4173
---- Validation: 
scalar performance:
{'acc': 0.96221983, 'precision': 0.7134168, 'recall': 0.62277263, 'specificity': 0.62277263, 'f1': 0.65441823, 'auroc': 0.84805596, 'binary_precision': 0.45406824, 'binary_recall': 0.25705793, 'binary_specificity': 0.9884873, 'binary_f1_score': 0.32827324}
confusion matrix:
       0    1
0  17859  208
1    500  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.72930765, 'recall': 0.6504606, 'specificity': 0.6504606, 'f1': 0.68057406, 'auroc': 0.8265109, 'binary_precision': 0.48809522, 'binary_recall': 0.31538463, 'binary_specificity': 0.9855365, 'binary_f1_score': 0.38317758}
confusion matrix:
      0   1
0  5860  86
1   178  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_27.png
early stop counter: 15
val acc:0.9622198343276978, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9555268883705139 / 0.9605220556259155
after epoch: 27,now: 2024-06-22 22:45:00.806239,epoch time: 0:13:13.185644,used: 6:07:11.031588,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99375, 'precision': 0.9864342, 'recall': 0.976105, 'specificity': 0.976105, 'f1': 0.9812001, 'auroc': 0.9975376, 'binary_precision': 0.97750413, 'binary_recall': 0.95445085, 'binary_specificity': 0.99775916, 'binary_f1_score': 0.9658399}
confusion matrix:
       0     1
0  42300    95
1    197  4128
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.7561203, 'recall': 0.57771933, 'specificity': 0.57771933, 'f1': 0.61489344, 'auroc': 0.8409667, 'binary_precision': 0.5427136, 'binary_recall': 0.16047548, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.24770641}
confusion matrix:
       0    1
0  17976   91
1    565  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7311382, 'recall': 0.5514916, 'specificity': 0.5514916, 'f1': 0.57786024, 'auroc': 0.7762932, 'binary_precision': 0.5, 'binary_recall': 0.10769231, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.17721519}
confusion matrix:
      0   1
0  5918  28
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_28.png
early stop counter: 16
val acc:0.9649946689605713, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9555268883705139 / 0.9605220556259155
after epoch: 28,now: 2024-06-22 22:58:13.613197,epoch time: 0:13:12.806958,used: 6:20:23.838546,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99458474, 'precision': 0.989953, 'recall': 0.9776081, 'specificity': 0.9776081, 'f1': 0.98368186, 'auroc': 0.99780786, 'binary_precision': 0.9843044, 'binary_recall': 0.956773, 'binary_specificity': 0.9984432, 'binary_f1_score': 0.9703434}
confusion matrix:
       0     1
0  42328    66
1    187  4139
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.77184683, 'recall': 0.5996755, 'specificity': 0.5996755, 'f1': 0.64226073, 'auroc': 0.8522587, 'binary_precision': 0.57261413, 'binary_recall': 0.205052, 'binary_specificity': 0.994299, 'binary_f1_score': 0.30196935}
confusion matrix:
       0    1
0  17964  103
1    535  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.6998637, 'recall': 0.5508189, 'specificity': 0.5508189, 'f1': 0.57533437, 'auroc': 0.78914994, 'binary_precision': 0.4375, 'binary_recall': 0.10769231, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.17283951}
confusion matrix:
      0   1
0  5910  36
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_29.png
early stop counter: 17
val acc:0.9659551978111267, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9555268883705139 / 0.9605220556259155
after epoch: 29,now: 2024-06-22 23:11:23.957210,epoch time: 0:13:10.344013,used: 6:33:34.182559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9943065, 'precision': 0.984916, 'recall': 0.98108727, 'specificity': 0.98108727, 'f1': 0.9829921, 'auroc': 0.99795604, 'binary_precision': 0.9734142, 'binary_recall': 0.9648636, 'binary_specificity': 0.99731094, 'binary_f1_score': 0.96912}
confusion matrix:
       0     1
0  42280   114
1    152  4174
---- Validation: 
scalar performance:
{'acc': 0.9632871, 'precision': 0.72166014, 'recall': 0.5925696, 'specificity': 0.5925696, 'f1': 0.6277144, 'auroc': 0.8413246, 'binary_precision': 0.47272727, 'binary_recall': 0.19316493, 'binary_specificity': 0.9919743, 'binary_f1_score': 0.2742616}
confusion matrix:
       0    1
0  17922  145
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9521431, 'precision': 0.6358145, 'recall': 0.5520583, 'specificity': 0.5520583, 'f1': 0.5717151, 'auroc': 0.7781209, 'binary_precision': 0.30927834, 'binary_recall': 0.115384616, 'binary_specificity': 0.9887319, 'binary_f1_score': 0.16806723}
confusion matrix:
      0   1
0  5879  67
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_30.png
early stop counter: 18
val acc:0.9632871150970459, best validation acc: 0.9665955305099487, corresponding to test acc:                         0.9555268883705139 / 0.9605220556259155
after epoch: 30,now: 2024-06-22 23:25:18.499384,epoch time: 0:13:54.542174,used: 6:47:28.724733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_16_37_49_seed_1_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 6:47:28.724733 at 2024-06-22 23:25:18.499384
persisted model performance metric: 

scalar performance:
{'acc': 0.9555269, 'precision': 0.6431571, 'recall': 0.52623934, 'specificity': 0.52623934, 'f1': 0.5376203, 'auroc': 0.7651228, 'binary_precision': 0.32608697, 'binary_recall': 0.057692308, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.09803922}
confusion matrix:
      0   1
0  5915  31
1   245  15
oracle model performance metric: 

scalar performance:
{'acc': 0.96052206, 'precision': 0.7897799, 'recall': 0.5748208, 'specificity': 0.5748208, 'f1': 0.6129421, 'auroc': 0.85700697, 'binary_precision': 0.61538464, 'binary_recall': 0.15384616, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.24615386}
confusion matrix:
      0   1
0  5921  25
1   220  40
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204385 KiB | 737735 KiB | 698185 GiB | 698185 GiB |
|       from large pool | 167936 KiB | 665600 KiB | 697630 GiB | 697629 GiB |
|       from small pool |  36449 KiB |  73422 KiB |    555 GiB |    555 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204385 KiB | 737735 KiB | 698185 GiB | 698185 GiB |
|       from large pool | 167936 KiB | 665600 KiB | 697630 GiB | 697629 GiB |
|       from small pool |  36449 KiB |  73422 KiB |    555 GiB |    555 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 730152 KiB | 697983 GiB | 697983 GiB |
|       from large pool | 165120 KiB | 658560 KiB | 697442 GiB | 697442 GiB |
|       from small pool |  35966 KiB |  72872 KiB |    541 GiB |    541 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |    900 MiB |   1478 MiB | 612352 KiB |
|       from large pool |    808 MiB |    828 MiB |   1378 MiB | 583680 KiB |
|       from small pool |     72 MiB |     72 MiB |    100 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 104862 KiB | 260793 KiB | 512715 GiB | 512715 GiB |
|       from large pool |  96256 KiB | 259208 KiB | 512152 GiB | 512152 GiB |
|       from small pool |   8606 KiB |  16195 KiB |    562 GiB |    562 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2064    |    3669    |   76510 K  |   76508 K  |
|       from large pool |      36    |      76    |   25678 K  |   25678 K  |
|       from small pool |    2028    |    3632    |   50831 K  |   50829 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2064    |    3669    |   76510 K  |   76508 K  |
|       from large pool |      36    |      76    |   25678 K  |   25678 K  |
|       from small pool |    2028    |    3632    |   50831 K  |   50829 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      51    |      70    |      20    |
|       from large pool |      14    |      15    |      20    |       6    |
|       from small pool |      36    |      36    |      50    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    1476    |   33697 K  |   33697 K  |
|       from large pool |       5    |      11    |    9585 K  |    9585 K  |
|       from small pool |      29    |    1471    |   24111 K  |   24111 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 737735 KiB | 698185 GiB | 698185 GiB |
|       from large pool |  16640 KiB | 665600 KiB | 697630 GiB | 697630 GiB |
|       from small pool |      0 KiB |  73422 KiB |    555 GiB |    555 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 737735 KiB | 698185 GiB | 698185 GiB |
|       from large pool |  16640 KiB | 665600 KiB | 697630 GiB | 697630 GiB |
|       from small pool |      0 KiB |  73422 KiB |    555 GiB |    555 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 730152 KiB | 697983 GiB | 697983 GiB |
|       from large pool |  16640 KiB | 658560 KiB | 697442 GiB | 697442 GiB |
|       from small pool |      0 KiB |  72872 KiB |    541 GiB |    541 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    900 MiB |   1478 MiB |   1176 MiB |
|       from large pool | 264192 KiB |    828 MiB |   1378 MiB |   1120 MiB |
|       from small pool |  45056 KiB |     72 MiB |    100 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 260793 KiB | 512715 GiB | 512715 GiB |
|       from large pool |  83712 KiB | 259208 KiB | 512153 GiB | 512152 GiB |
|       from small pool |      0 KiB |  16201 KiB |    562 GiB |    562 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   76510 K  |   76510 K  |
|       from large pool |       2    |      76    |   25678 K  |   25678 K  |
|       from small pool |       0    |    3632    |   50831 K  |   50831 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   76510 K  |   76510 K  |
|       from large pool |       2    |      76    |   25678 K  |   25678 K  |
|       from small pool |       0    |    3632    |   50831 K  |   50831 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      70    |      39    |
|       from large pool |       9    |      15    |      20    |      11    |
|       from small pool |      22    |      36    |      50    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   33698 K  |   33698 K  |
|       from large pool |       1    |      11    |    9585 K  |    9585 K  |
|       from small pool |       0    |    1471    |   24112 K  |   24112 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 737735 KiB | 698185 GiB | 698185 GiB |
|       from large pool |  16640 KiB | 665600 KiB | 697630 GiB | 697630 GiB |
|       from small pool |      0 KiB |  73422 KiB |    555 GiB |    555 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 737735 KiB | 698185 GiB | 698185 GiB |
|       from large pool |  16640 KiB | 665600 KiB | 697630 GiB | 697630 GiB |
|       from small pool |      0 KiB |  73422 KiB |    555 GiB |    555 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 730152 KiB | 697983 GiB | 697983 GiB |
|       from large pool |  16640 KiB | 658560 KiB | 697442 GiB | 697442 GiB |
|       from small pool |      0 KiB |  72872 KiB |    541 GiB |    541 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    900 MiB |   1478 MiB |   1176 MiB |
|       from large pool | 264192 KiB |    828 MiB |   1378 MiB |   1120 MiB |
|       from small pool |  45056 KiB |     72 MiB |    100 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 260793 KiB | 512715 GiB | 512715 GiB |
|       from large pool |  83712 KiB | 259208 KiB | 512153 GiB | 512152 GiB |
|       from small pool |      0 KiB |  16201 KiB |    562 GiB |    562 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   76510 K  |   76510 K  |
|       from large pool |       2    |      76    |   25678 K  |   25678 K  |
|       from small pool |       0    |    3632    |   50831 K  |   50831 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   76510 K  |   76510 K  |
|       from large pool |       2    |      76    |   25678 K  |   25678 K  |
|       from small pool |       0    |    3632    |   50831 K  |   50831 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      70    |      39    |
|       from large pool |       9    |      15    |      20    |      11    |
|       from small pool |      22    |      36    |      50    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   33698 K  |   33698 K  |
|       from large pool |       1    |      11    |    9585 K  |    9585 K  |
|       from small pool |       0    |    1471    |   24112 K  |   24112 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_23_30_53_seed_2_21546987

 Experiment start at: 2024-06-22 23:30:53.580265
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99082136, 'precision': 0.9833361, 'recall': 0.96364665, 'specificity': 0.96364665, 'f1': 0.9732318, 'auroc': 0.9954747, 'binary_precision': 0.97415185, 'binary_recall': 0.9299405, 'binary_specificity': 0.99735284, 'binary_f1_score': 0.95153296}
confusion matrix:
       0     1
0  42197   112
1    318  4221
---- Validation: 
scalar performance:
{'acc': 0.96649444, 'precision': 0.72108203, 'recall': 0.6438058, 'specificity': 0.6438058, 'f1': 0.67339903, 'auroc': 0.8323418, 'binary_precision': 0.4651163, 'binary_recall': 0.29900333, 'binary_specificity': 0.98860824, 'binary_f1_score': 0.36400405}
confusion matrix:
       0    1
0  17964  207
1    422  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.7557355, 'recall': 0.6017868, 'specificity': 0.6017868, 'f1': 0.64214975, 'auroc': 0.81744623, 'binary_precision': 0.5425532, 'binary_recall': 0.2107438, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.30357143}
confusion matrix:
      0   1
0  5954  43
1   191  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 23:44:56.815312,epoch time: 0:14:03.235047,used: 0:14:03.235047,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_23_30_53_seed_2_21546987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99240094, 'precision': 0.9807465, 'recall': 0.97563344, 'specificity': 0.97563344, 'f1': 0.97817254, 'auroc': 0.99680954, 'binary_precision': 0.9663322, 'binary_recall': 0.9548359, 'binary_specificity': 0.996431, 'binary_f1_score': 0.96054965}
confusion matrix:
       0     1
0  42158   151
1    205  4334
---- Validation: 
scalar performance:
{'acc': 0.9673467, 'precision': 0.7327653, 'recall': 0.66592836, 'specificity': 0.66592836, 'f1': 0.69316506, 'auroc': 0.86758435, 'binary_precision': 0.48705882, 'binary_recall': 0.34385383, 'binary_specificity': 0.98800284, 'binary_f1_score': 0.40311587}
confusion matrix:
       0    1
0  17953  218
1    395  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9588075, 'precision': 0.70470726, 'recall': 0.6078001, 'specificity': 0.6078001, 'f1': 0.6392536, 'auroc': 0.82564354, 'binary_precision': 0.44, 'binary_recall': 0.22727273, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.29972753}
confusion matrix:
      0   1
0  5927  70
1   187  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546987_2.png
[Sat Jun 22 23:58:46 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/rule_results/1.csv

--- Logging error ---
Traceback (most recent call last):
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 628, in save
    _save(obj, opened_zipfile, pickle_module, pickle_protocol, _disable_byteorder_record)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 862, in _save
    zip_file.write_record(name, storage, num_bytes)
RuntimeError: [enforce fail at inline_container.cc:764] . PytorchStreamWriter failed writing file data/72: file write failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 2656, in run_wrapper
    run(
Shutting down, this might take some time.
--- Logging error ---
