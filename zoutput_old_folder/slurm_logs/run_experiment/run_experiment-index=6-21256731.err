Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun  8 12:13:26 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731

 Experiment start at: 2024-06-08 12:19:42.823029
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97131896, 'precision': 0.8089235, 'recall': 0.66385865, 'specificity': 0.66385865, 'f1': 0.7122844, 'auroc': 0.9507314, 'binary_precision': 0.640625, 'binary_recall': 0.33423913, 'binary_specificity': 0.99347824, 'binary_f1_score': 0.4392857}
confusion matrix:
       0    1
0  42044  276
1    980  492
---- Validation: 
scalar performance:
{'acc': 0.96945506, 'precision': 0.7819251, 'recall': 0.6781639, 'specificity': 0.6781639, 'f1': 0.71724135, 'auroc': 0.9468347, 'binary_precision': 0.5860349, 'binary_recall': 0.36547434, 'binary_specificity': 0.9908535, 'binary_f1_score': 0.4501916}
confusion matrix:
       0    1
0  17983  166
1    408  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.9454799, 'recall': 0.5725468, 'specificity': 0.5725468, 'f1': 0.61657614, 'auroc': 0.93550146, 'binary_precision': 0.9268293, 'binary_recall': 0.14559387, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.25165564}
confusion matrix:
      0   1
0  5994   3
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-08 12:37:00.191390,epoch time: 0:17:17.368361,used: 0:17:17.368361,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97488123, 'precision': 0.87369967, 'recall': 0.67827106, 'specificity': 0.67827106, 'f1': 0.7389319, 'auroc': 0.9653184, 'binary_precision': 0.7692308, 'binary_recall': 0.3602991, 'binary_specificity': 0.996243, 'binary_f1_score': 0.49074072}
confusion matrix:
       0    1
0  42162  159
1    941  530
---- Validation: 
scalar performance:
{'acc': 0.9732333, 'precision': 0.9122795, 'recall': 0.6313664, 'specificity': 0.6313664, 'f1': 0.6948155, 'auroc': 0.96165717, 'binary_precision': 0.85, 'binary_recall': 0.2643857, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.40332147}
confusion matrix:
       0    1
0  18119   30
1    473  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.83299243, 'recall': 0.5225716, 'specificity': 0.5225716, 'f1': 0.5327879, 'auroc': 0.9365717, 'binary_precision': 0.7058824, 'binary_recall': 0.04597701, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.086330935}
confusion matrix:
      0   1
0  5992   5
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_2.png
better model found
persisted
after epoch: 2,now: 2024-06-08 12:53:20.595980,epoch time: 0:16:20.404590,used: 0:33:37.772951,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97842073, 'precision': 0.84882104, 'recall': 0.79657435, 'specificity': 0.79657435, 'f1': 0.8203994, 'auroc': 0.97321403, 'binary_precision': 0.7114148, 'binary_recall': 0.6016315, 'binary_specificity': 0.9915172, 'binary_f1_score': 0.65193367}
confusion matrix:
       0    1
0  41962  359
1    586  885
---- Validation: 
scalar performance:
{'acc': 0.97647935, 'precision': 0.8380502, 'recall': 0.7778076, 'specificity': 0.7778076, 'f1': 0.804719, 'auroc': 0.9683962, 'binary_precision': 0.69142854, 'binary_recall': 0.5645412, 'binary_specificity': 0.9910739, 'binary_f1_score': 0.62157536}
confusion matrix:
       0    1
0  17987  162
1    280  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.9182507, 'recall': 0.53997976, 'specificity': 0.53997976, 'f1': 0.5637504, 'auroc': 0.946327, 'binary_precision': 0.875, 'binary_recall': 0.08045977, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.14736843}
confusion matrix:
      0   1
0  5994   3
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_3.png
better model found
persisted
after epoch: 3,now: 2024-06-08 13:09:39.375897,epoch time: 0:16:18.779917,used: 0:49:56.552868,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97880894, 'precision': 0.93718314, 'recall': 0.70871633, 'specificity': 0.70871633, 'f1': 0.77995205, 'auroc': 0.9772607, 'binary_precision': 0.8942029, 'binary_recall': 0.4191576, 'binary_specificity': 0.99827504, 'binary_f1_score': 0.57076776}
confusion matrix:
       0    1
0  42247   73
1    855  617
---- Validation: 
scalar performance:
{'acc': 0.9765858, 'precision': 0.93785274, 'recall': 0.67735523, 'specificity': 0.67735523, 'f1': 0.74901426, 'auroc': 0.970389, 'binary_precision': 0.8980392, 'binary_recall': 0.3561431, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.5100222}
confusion matrix:
       0    1
0  18123   26
1    414  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.97945315, 'recall': 0.50766283, 'specificity': 0.50766283, 'f1': 0.5046054, 'auroc': 0.94210386, 'binary_precision': 1.0, 'binary_recall': 0.01532567, 'binary_specificity': 1.0, 'binary_f1_score': 0.030188678}
confusion matrix:
      0  1
0  5997  0
1   257  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_4.png
better model found
persisted
after epoch: 4,now: 2024-06-08 13:25:57.424136,epoch time: 0:16:18.048239,used: 1:06:14.601107,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98116094, 'precision': 0.8612537, 'recall': 0.8410769, 'specificity': 0.8410769, 'f1': 0.8508501, 'auroc': 0.978855, 'binary_precision': 0.7332372, 'binary_recall': 0.69089675, 'binary_specificity': 0.9912571, 'binary_f1_score': 0.7114375}
confusion matrix:
       0     1
0  41950   370
1    455  1017
---- Validation: 
scalar performance:
{'acc': 0.9808961, 'precision': 0.87289643, 'recall': 0.8205972, 'specificity': 0.8205972, 'f1': 0.8446064, 'auroc': 0.97382706, 'binary_precision': 0.7581818, 'binary_recall': 0.64852256, 'binary_specificity': 0.9926718, 'binary_f1_score': 0.6990779}
confusion matrix:
       0    1
0  18016  133
1    226  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7950828, 'recall': 0.5410617, 'specificity': 0.5410617, 'f1': 0.56401336, 'auroc': 0.9394729, 'binary_precision': 0.62857145, 'binary_recall': 0.08429119, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.14864865}
confusion matrix:
      0   1
0  5984  13
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_5.png
better model found
persisted
after epoch: 5,now: 2024-06-08 13:42:19.402724,epoch time: 0:16:21.978588,used: 1:22:36.579695,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9823027, 'precision': 0.9131776, 'recall': 0.7901938, 'specificity': 0.7901938, 'f1': 0.84013534, 'auroc': 0.9816774, 'binary_precision': 0.8406647, 'binary_recall': 0.5842391, 'binary_specificity': 0.9961484, 'binary_f1_score': 0.6893787}
confusion matrix:
       0    1
0  42157  163
1    612  860
---- Validation: 
scalar performance:
{'acc': 0.98020434, 'precision': 0.90509063, 'recall': 0.7647349, 'specificity': 0.7647349, 'f1': 0.8191043, 'auroc': 0.9761001, 'binary_precision': 0.826506, 'binary_recall': 0.533437, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.6483932}
confusion matrix:
       0    1
0  18077   72
1    300  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8812791, 'recall': 0.55305624, 'specificity': 0.55305624, 'f1': 0.5847746, 'auroc': 0.9482883, 'binary_precision': 0.8, 'binary_recall': 0.107279696, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.1891892}
confusion matrix:
      0   1
0  5990   7
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_6.png
early stop counter: 1
val acc:0.9802043437957764, best validation acc: 0.9808961153030396, corresponding to test acc:                         0.9597315192222595 / 0.9638862013816833
after epoch: 6,now: 2024-06-08 13:58:37.280937,epoch time: 0:16:17.878213,used: 1:38:54.457908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9842437, 'precision': 0.93177044, 'recall': 0.80759096, 'specificity': 0.80759096, 'f1': 0.8584945, 'auroc': 0.9848697, 'binary_precision': 0.8766859, 'binary_recall': 0.6182065, 'binary_specificity': 0.9969754, 'binary_f1_score': 0.7250996}
confusion matrix:
       0    1
0  42192  128
1    562  910
---- Validation: 
scalar performance:
{'acc': 0.9807897, 'precision': 0.928009, 'recall': 0.7552873, 'specificity': 0.7552873, 'f1': 0.8182758, 'auroc': 0.9760356, 'binary_precision': 0.8730159, 'binary_recall': 0.5132193, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.64642507}
confusion matrix:
       0    1
0  18101   48
1    313  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.9134711, 'recall': 0.5247375, 'specificity': 0.5247375, 'f1': 0.536889, 'auroc': 0.94002396, 'binary_precision': 0.8666667, 'binary_recall': 0.049808428, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.09420289}
confusion matrix:
      0   1
0  5995   2
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_7.png
early stop counter: 2
val acc:0.9807897210121155, best validation acc: 0.9808961153030396, corresponding to test acc:                         0.9597315192222595 / 0.9638862013816833
after epoch: 7,now: 2024-06-08 14:14:58.434541,epoch time: 0:16:21.153604,used: 1:55:15.611512,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9854083, 'precision': 0.8908686, 'recall': 0.8818841, 'specificity': 0.8818841, 'f1': 0.88631976, 'auroc': 0.9875245, 'binary_precision': 0.7896936, 'binary_recall': 0.7709041, 'binary_specificity': 0.9928641, 'binary_f1_score': 0.7801858}
confusion matrix:
       0     1
0  42019   302
1    337  1134
---- Validation: 
scalar performance:
{'acc': 0.98318434, 'precision': 0.89026415, 'recall': 0.84203327, 'specificity': 0.84203327, 'f1': 0.86442775, 'auroc': 0.97933674, 'binary_precision': 0.7914438, 'binary_recall': 0.6905132, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.73754156}
confusion matrix:
       0    1
0  18032  117
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.8622442, 'recall': 0.56613266, 'specificity': 0.56613266, 'f1': 0.60430056, 'auroc': 0.94322175, 'binary_precision': 0.76086956, 'binary_recall': 0.13409962, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.22801304}
confusion matrix:
      0   1
0  5986  11
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_8.png
better model found
persisted
after epoch: 8,now: 2024-06-08 14:31:17.808362,epoch time: 0:16:19.373821,used: 2:11:34.985333,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9844492, 'precision': 0.95049965, 'recall': 0.7952387, 'specificity': 0.7952387, 'f1': 0.8555893, 'auroc': 0.98832166, 'binary_precision': 0.91500527, 'binary_recall': 0.5923913, 'binary_specificity': 0.99808604, 'binary_f1_score': 0.7191753}
confusion matrix:
       0    1
0  42239   81
1    600  872
---- Validation: 
scalar performance:
{'acc': 0.9808961, 'precision': 0.9417788, 'recall': 0.74709177, 'specificity': 0.74709177, 'f1': 0.8150538, 'auroc': 0.97873557, 'binary_precision': 0.90112996, 'binary_recall': 0.496112, 'binary_specificity': 0.9980715, 'binary_f1_score': 0.6399198}
confusion matrix:
       0    1
0  18114   35
1    324  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.9182507, 'recall': 0.53997976, 'specificity': 0.53997976, 'f1': 0.5637504, 'auroc': 0.94214344, 'binary_precision': 0.875, 'binary_recall': 0.08045977, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.14736843}
confusion matrix:
      0   1
0  5994   3
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_9.png
early stop counter: 1
val acc:0.9808961153030396, best validation acc: 0.9831843376159668, corresponding to test acc:                         0.9621284604072571 / 0.9638862013816833
after epoch: 9,now: 2024-06-08 14:47:39.869347,epoch time: 0:16:22.060985,used: 2:27:57.046318,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98648155, 'precision': 0.9297451, 'recall': 0.8497312, 'specificity': 0.8497312, 'f1': 0.8853198, 'auroc': 0.9888619, 'binary_precision': 0.8697479, 'binary_recall': 0.703125, 'binary_specificity': 0.9963374, 'binary_f1_score': 0.7776108}
confusion matrix:
       0     1
0  42165   155
1    437  1035
---- Validation: 
scalar performance:
{'acc': 0.98259896, 'precision': 0.920761, 'recall': 0.7937267, 'specificity': 0.7937267, 'f1': 0.84510624, 'auroc': 0.9781759, 'binary_precision': 0.8558559, 'binary_recall': 0.59097975, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.699172}
confusion matrix:
       0    1
0  18085   64
1    263  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.91402704, 'recall': 0.5608858, 'specificity': 0.5608858, 'f1': 0.5978065, 'auroc': 0.94722474, 'binary_precision': 0.8648649, 'binary_recall': 0.12260536, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.2147651}
confusion matrix:
      0   1
0  5992   5
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_10.png
early stop counter: 2
val acc:0.9825989603996277, best validation acc: 0.9831843376159668, corresponding to test acc:                         0.9621284604072571 / 0.9638862013816833
after epoch: 10,now: 2024-06-08 15:03:55.742477,epoch time: 0:16:15.873130,used: 2:44:12.919448,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9858878, 'precision': 0.8915757, 'recall': 0.89106214, 'specificity': 0.89106214, 'f1': 0.89131874, 'auroc': 0.99003386, 'binary_precision': 0.7904762, 'binary_recall': 0.7894022, 'binary_specificity': 0.9927221, 'binary_f1_score': 0.78993887}
confusion matrix:
       0     1
0  42012   308
1    310  1162
---- Validation: 
scalar performance:
{'acc': 0.9837165, 'precision': 0.88409567, 'recall': 0.86331034, 'specificity': 0.86331034, 'f1': 0.87338907, 'auroc': 0.9782574, 'binary_precision': 0.77759475, 'binary_recall': 0.7340591, 'binary_specificity': 0.9925616, 'binary_f1_score': 0.75519997}
confusion matrix:
       0    1
0  18014  135
1    171  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.9039017, 'recall': 0.5418121, 'specificity': 0.5418121, 'f1': 0.56671965, 'auroc': 0.94370544, 'binary_precision': 0.84615386, 'binary_recall': 0.08429119, 'binary_specificity': 0.999333, 'binary_f1_score': 0.1533101}
confusion matrix:
      0   1
0  5993   4
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_11.png
better model found
persisted
after epoch: 11,now: 2024-06-08 15:22:38.214233,epoch time: 0:18:42.471756,used: 3:02:55.391204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98837686, 'precision': 0.9112868, 'recall': 0.9093986, 'specificity': 0.9093986, 'f1': 0.9103403, 'auroc': 0.9912292, 'binary_precision': 0.82866895, 'binary_recall': 0.82472825, 'binary_specificity': 0.994069, 'binary_f1_score': 0.8266939}
confusion matrix:
       0     1
0  42069   251
1    258  1214
---- Validation: 
scalar performance:
{'acc': 0.98738825, 'precision': 0.9106355, 'recall': 0.8952135, 'specificity': 0.8952135, 'f1': 0.90276456, 'auroc': 0.98023355, 'binary_precision': 0.828479, 'binary_recall': 0.7962675, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.8120539}
confusion matrix:
       0    1
0  18043  106
1    131  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.8690648, 'recall': 0.57754356, 'specificity': 0.57754356, 'f1': 0.6210666, 'auroc': 0.93007743, 'binary_precision': 0.7735849, 'binary_recall': 0.15708812, 'binary_specificity': 0.997999, 'binary_f1_score': 0.2611465}
confusion matrix:
      0   1
0  5985  12
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_12.png
better model found
persisted
after epoch: 12,now: 2024-06-08 15:38:51.480485,epoch time: 0:16:13.266252,used: 3:19:08.657456,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9888107, 'precision': 0.9305999, 'recall': 0.8909352, 'specificity': 0.8909352, 'f1': 0.909735, 'auroc': 0.9921564, 'binary_precision': 0.8686186, 'binary_recall': 0.78600544, 'binary_specificity': 0.99586487, 'binary_f1_score': 0.8252497}
confusion matrix:
       0     1
0  42145   175
1    315  1157
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.91545045, 'recall': 0.84835815, 'specificity': 0.84835815, 'f1': 0.87872314, 'auroc': 0.9796132, 'binary_precision': 0.8414179, 'binary_recall': 0.7013997, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.7650551}
confusion matrix:
       0    1
0  18064   85
1    192  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.86248434, 'recall': 0.5245707, 'specificity': 0.5245707, 'f1': 0.53646684, 'auroc': 0.90571934, 'binary_precision': 0.7647059, 'binary_recall': 0.049808428, 'binary_specificity': 0.999333, 'binary_f1_score': 0.09352518}
confusion matrix:
      0   1
0  5993   4
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_13.png
early stop counter: 1
val acc:0.9852597117424011, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9629274606704712 / 0.9638862013816833
after epoch: 13,now: 2024-06-08 15:55:20.135690,epoch time: 0:16:28.655205,used: 3:35:37.312661,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98648155, 'precision': 0.9272162, 'recall': 0.8520566, 'specificity': 0.8520566, 'f1': 0.88573563, 'auroc': 0.9927993, 'binary_precision': 0.8645054, 'binary_recall': 0.7079646, 'binary_specificity': 0.99614865, 'binary_f1_score': 0.7784431}
confusion matrix:
       0     1
0  42160   163
1    429  1040
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.92246246, 'recall': 0.8401075, 'specificity': 0.8401075, 'f1': 0.8764917, 'auroc': 0.9796287, 'binary_precision': 0.8560311, 'binary_recall': 0.6842924, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.7605877}
confusion matrix:
       0    1
0  18075   74
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.9144669, 'recall': 0.54947495, 'specificity': 0.54947495, 'f1': 0.579572, 'auroc': 0.91713256, 'binary_precision': 0.8666667, 'binary_recall': 0.099616855, 'binary_specificity': 0.999333, 'binary_f1_score': 0.17869414}
confusion matrix:
      0   1
0  5993   4
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_14.png
early stop counter: 2
val acc:0.9852597117424011, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9629274606704712 / 0.9638862013816833
after epoch: 14,now: 2024-06-08 16:11:37.195059,epoch time: 0:16:17.059369,used: 3:51:54.372030,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98924464, 'precision': 0.9303459, 'recall': 0.89889383, 'specificity': 0.89889383, 'f1': 0.91397643, 'auroc': 0.9931407, 'binary_precision': 0.86754966, 'binary_recall': 0.8020408, 'binary_specificity': 0.9957469, 'binary_f1_score': 0.8335101}
confusion matrix:
       0     1
0  42142   180
1    291  1179
---- Validation: 
scalar performance:
{'acc': 0.9856322, 'precision': 0.91912293, 'recall': 0.8508011, 'specificity': 0.8508011, 'f1': 0.88169074, 'auroc': 0.98111796, 'binary_precision': 0.8485981, 'binary_recall': 0.7060653, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.7707979}
confusion matrix:
       0    1
0  18068   81
1    189  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.86292946, 'recall': 0.5548052, 'specificity': 0.5548052, 'f1': 0.5871267, 'auroc': 0.9282072, 'binary_precision': 0.7631579, 'binary_recall': 0.11111111, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.19397995}
confusion matrix:
      0   1
0  5988   9
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_15.png
early stop counter: 3
val acc:0.9856321811676025, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9629274606704712 / 0.9638862013816833
after epoch: 15,now: 2024-06-08 16:27:48.024640,epoch time: 0:16:10.829581,used: 4:08:05.201611,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98906195, 'precision': 0.9428117, 'recall': 0.8812293, 'specificity': 0.8812293, 'f1': 0.9095448, 'auroc': 0.9936243, 'binary_precision': 0.8937351, 'binary_recall': 0.765625, 'binary_specificity': 0.9968336, 'binary_f1_score': 0.82473475}
confusion matrix:
       0     1
0  42186   134
1    345  1127
---- Validation: 
scalar performance:
{'acc': 0.98690933, 'precision': 0.9354637, 'recall': 0.85521257, 'specificity': 0.85521257, 'f1': 0.89095265, 'auroc': 0.9799156, 'binary_precision': 0.8809981, 'binary_recall': 0.7138414, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.7886598}
confusion matrix:
       0    1
0  18087   62
1    184  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.87975353, 'recall': 0.51515895, 'specificity': 0.51515895, 'f1': 0.5191079, 'auroc': 0.9170211, 'binary_precision': 0.8, 'binary_recall': 0.03065134, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.05904059}
confusion matrix:
      0  1
0  5995  2
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_16.png
early stop counter: 4
val acc:0.9869093298912048, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9629274606704712 / 0.9638862013816833
after epoch: 16,now: 2024-06-08 16:44:04.615856,epoch time: 0:16:16.591216,used: 4:24:21.792827,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98924464, 'precision': 0.95638955, 'recall': 0.8705045, 'specificity': 0.8705045, 'f1': 0.9086598, 'auroc': 0.99442136, 'binary_precision': 0.92165124, 'binary_recall': 0.7432065, 'binary_specificity': 0.99780244, 'binary_f1_score': 0.8228657}
confusion matrix:
       0     1
0  42227    93
1    378  1094
---- Validation: 
scalar performance:
{'acc': 0.9832908, 'precision': 0.9201703, 'recall': 0.8068358, 'specificity': 0.8068358, 'f1': 0.853999, 'auroc': 0.9814082, 'binary_precision': 0.85376346, 'binary_recall': 0.61741835, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.7166065}
confusion matrix:
       0    1
0  18081   68
1    246  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.89772, 'recall': 0.5474758, 'specificity': 0.5474758, 'f1': 0.5760538, 'auroc': 0.92470264, 'binary_precision': 0.8333333, 'binary_recall': 0.09578544, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.17182131}
confusion matrix:
      0   1
0  5992   5
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_17.png
early stop counter: 5
val acc:0.9832907915115356, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9629274606704712 / 0.9638862013816833
after epoch: 17,now: 2024-06-08 17:00:17.878518,epoch time: 0:16:13.262662,used: 4:40:35.055489,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9903407, 'precision': 0.9516952, 'recall': 0.8936225, 'specificity': 0.8936225, 'f1': 0.92051387, 'auroc': 0.9954258, 'binary_precision': 0.9106583, 'binary_recall': 0.7899388, 'binary_specificity': 0.9973063, 'binary_f1_score': 0.84601384}
confusion matrix:
       0     1
0  42207   114
1    309  1162
---- Validation: 
scalar performance:
{'acc': 0.98738825, 'precision': 0.9402667, 'recall': 0.8584608, 'specificity': 0.8584608, 'f1': 0.8948547, 'auroc': 0.98230636, 'binary_precision': 0.8903846, 'binary_recall': 0.7200622, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.79621667}
confusion matrix:
       0    1
0  18092   57
1    180  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8782606, 'recall': 0.55114055, 'specificity': 0.55114055, 'f1': 0.58166534, 'auroc': 0.90476286, 'binary_precision': 0.7941176, 'binary_recall': 0.10344828, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.18305086}
confusion matrix:
      0   1
0  5990   7
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_18.png
early stop counter: 6
val acc:0.9873882532119751, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9629274606704712 / 0.9638862013816833
after epoch: 18,now: 2024-06-08 17:16:33.448097,epoch time: 0:16:15.569579,used: 4:56:50.625068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9910486, 'precision': 0.9362072, 'recall': 0.9241731, 'specificity': 0.9241731, 'f1': 0.9300993, 'auroc': 0.9948959, 'binary_precision': 0.8775367, 'binary_recall': 0.8524813, 'binary_specificity': 0.9958649, 'binary_f1_score': 0.8648276}
confusion matrix:
       0     1
0  42146   175
1    217  1254
---- Validation: 
scalar performance:
{'acc': 0.9868561, 'precision': 0.9094622, 'recall': 0.8866874, 'specificity': 0.8866874, 'f1': 0.897722, 'auroc': 0.981364, 'binary_precision': 0.8267327, 'binary_recall': 0.7791602, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.80224186}
confusion matrix:
       0    1
0  18044  105
1    142  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.8750222, 'recall': 0.52840215, 'specificity': 0.52840215, 'f1': 0.54335564, 'auroc': 0.9177401, 'binary_precision': 0.7894737, 'binary_recall': 0.057471264, 'binary_specificity': 0.999333, 'binary_f1_score': 0.10714286}
confusion matrix:
      0   1
0  5993   4
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_19.png
early stop counter: 7
val acc:0.9868561029434204, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9629274606704712 / 0.9638862013816833
after epoch: 19,now: 2024-06-08 17:32:41.483197,epoch time: 0:16:08.035100,used: 5:12:58.660168,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9908888, 'precision': 0.93997574, 'recall': 0.9165443, 'specificity': 0.9165443, 'f1': 0.92791444, 'auroc': 0.995934, 'binary_precision': 0.88561153, 'binary_recall': 0.8368457, 'binary_specificity': 0.996243, 'binary_f1_score': 0.86053836}
confusion matrix:
       0     1
0  42162   159
1    240  1231
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.9184826, 'recall': 0.86929834, 'specificity': 0.86929834, 'f1': 0.8922315, 'auroc': 0.9827346, 'binary_precision': 0.8460177, 'binary_recall': 0.7433904, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.7913907}
confusion matrix:
       0    1
0  18062   87
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.830202, 'recall': 0.5263197, 'specificity': 0.5263197, 'f1': 0.5394829, 'auroc': 0.9141568, 'binary_precision': 0.7, 'binary_recall': 0.053639848, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.09964413}
confusion matrix:
      0   1
0  5991   6
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_20.png
early stop counter: 8
val acc:0.9865900278091431, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9629274606704712 / 0.9638862013816833
after epoch: 20,now: 2024-06-08 17:48:55.396644,epoch time: 0:16:13.913447,used: 5:29:12.573615,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99180216, 'precision': 0.9619787, 'recall': 0.9074401, 'specificity': 0.9074401, 'f1': 0.9328711, 'auroc': 0.9966787, 'binary_precision': 0.9302866, 'binary_recall': 0.8170068, 'binary_specificity': 0.9978734, 'binary_f1_score': 0.8699746}
confusion matrix:
       0     1
0  42232    90
1    269  1201
---- Validation: 
scalar performance:
{'acc': 0.9881865, 'precision': 0.945823, 'recall': 0.86637455, 'specificity': 0.86637455, 'f1': 0.90191764, 'auroc': 0.98240054, 'binary_precision': 0.9009524, 'binary_recall': 0.7356143, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.8099315}
confusion matrix:
       0    1
0  18097   52
1    170  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.9054425, 'recall': 0.5323169, 'specificity': 0.5323169, 'f1': 0.55040425, 'auroc': 0.8817222, 'binary_precision': 0.85, 'binary_recall': 0.0651341, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.12099644}
confusion matrix:
      0   1
0  5994   3
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_21.png
better model found
persisted
after epoch: 21,now: 2024-06-08 18:05:07.354028,epoch time: 0:16:11.957384,used: 5:45:24.530999,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99257857, 'precision': 0.9515021, 'recall': 0.9322277, 'specificity': 0.9322277, 'f1': 0.94163835, 'auroc': 0.996685, 'binary_precision': 0.9076048, 'binary_recall': 0.8675272, 'binary_specificity': 0.99692816, 'binary_f1_score': 0.88711363}
confusion matrix:
       0     1
0  42190   130
1    195  1277
---- Validation: 
scalar performance:
{'acc': 0.9886122, 'precision': 0.9216037, 'recall': 0.90259767, 'specificity': 0.90259767, 'f1': 0.91186357, 'auroc': 0.9843136, 'binary_precision': 0.8499184, 'binary_recall': 0.8102644, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.82961786}
confusion matrix:
       0    1
0  18057   92
1    122  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.9124147, 'recall': 0.5361483, 'specificity': 0.5361483, 'f1': 0.5571239, 'auroc': 0.9140584, 'binary_precision': 0.8636364, 'binary_recall': 0.07279693, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.13427562}
confusion matrix:
      0   1
0  5994   3
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_22.png
better model found
persisted
after epoch: 22,now: 2024-06-08 18:21:30.048848,epoch time: 0:16:22.694820,used: 6:01:47.225819,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9905919, 'precision': 0.9753383, 'recall': 0.87537944, 'specificity': 0.87537944, 'f1': 0.91906923, 'auroc': 0.9975147, 'binary_precision': 0.9592368, 'binary_recall': 0.7518695, 'binary_specificity': 0.99888945, 'binary_f1_score': 0.84298784}
confusion matrix:
       0     1
0  42274    47
1    365  1106
---- Validation: 
scalar performance:
{'acc': 0.9871754, 'precision': 0.9530174, 'recall': 0.8425994, 'specificity': 0.8425994, 'f1': 0.8895838, 'auroc': 0.982617, 'binary_precision': 0.91701245, 'binary_recall': 0.6874028, 'binary_specificity': 0.997796, 'binary_f1_score': 0.7857778}
confusion matrix:
       0    1
0  18109   40
1    201  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8550545, 'recall': 0.522655, 'specificity': 0.522655, 'f1': 0.5329855, 'auroc': 0.8916275, 'binary_precision': 0.75, 'binary_recall': 0.04597701, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0866426}
confusion matrix:
      0   1
0  5993   4
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_23.png
early stop counter: 1
val acc:0.9871754050254822, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9608501195907593 / 0.9638862013816833
after epoch: 23,now: 2024-06-08 18:37:52.218260,epoch time: 0:16:22.169412,used: 6:18:09.395231,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9914596, 'precision': 0.9742031, 'recall': 0.8902644, 'specificity': 0.8902644, 'f1': 0.92786497, 'auroc': 0.9973552, 'binary_precision': 0.95594347, 'binary_recall': 0.7817811, 'binary_specificity': 0.99874765, 'binary_f1_score': 0.86013466}
confusion matrix:
       0     1
0  42268    53
1    321  1150
---- Validation: 
scalar performance:
{'acc': 0.987335, 'precision': 0.9533551, 'recall': 0.8449322, 'specificity': 0.8449322, 'f1': 0.8912393, 'auroc': 0.9831981, 'binary_precision': 0.91752577, 'binary_recall': 0.69206846, 'binary_specificity': 0.997796, 'binary_f1_score': 0.78900707}
confusion matrix:
       0    1
0  18109   40
1    198  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.9177147, 'recall': 0.5266532, 'specificity': 0.5266532, 'f1': 0.5403691, 'auroc': 0.9176951, 'binary_precision': 0.875, 'binary_recall': 0.053639848, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.10108303}
confusion matrix:
      0   1
0  5995   2
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_24.png
early stop counter: 2
val acc:0.9873350262641907, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9608501195907593 / 0.9638862013816833
after epoch: 24,now: 2024-06-08 18:54:12.676350,epoch time: 0:16:20.458090,used: 6:34:29.853321,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99292105, 'precision': 0.9527185, 'recall': 0.9366671, 'specificity': 0.9366671, 'f1': 0.9445367, 'auroc': 0.9972657, 'binary_precision': 0.90973204, 'binary_recall': 0.8763587, 'binary_specificity': 0.9969754, 'binary_f1_score': 0.8927336}
confusion matrix:
       0     1
0  42192   128
1    182  1290
---- Validation: 
scalar performance:
{'acc': 0.98855895, 'precision': 0.9410075, 'recall': 0.8778182, 'specificity': 0.8778182, 'f1': 0.9067859, 'auroc': 0.98342985, 'binary_precision': 0.890511, 'binary_recall': 0.7589425, 'binary_specificity': 0.996694, 'binary_f1_score': 0.8194795}
confusion matrix:
       0    1
0  18089   60
1    155  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.83073217, 'recall': 0.5394795, 'specificity': 0.5394795, 'f1': 0.5619809, 'auroc': 0.8928224, 'binary_precision': 0.7, 'binary_recall': 0.08045977, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.1443299}
confusion matrix:
      0   1
0  5988   9
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_25.png
early stop counter: 3
val acc:0.9885589480400085, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9608501195907593 / 0.9638862013816833
after epoch: 25,now: 2024-06-08 19:10:44.533105,epoch time: 0:16:31.856755,used: 6:51:01.710076,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99264705, 'precision': 0.93724734, 'recall': 0.9515754, 'specificity': 0.9515754, 'f1': 0.9442866, 'auroc': 0.9979425, 'binary_precision': 0.877712, 'binary_recall': 0.90754586, 'binary_specificity': 0.995605, 'binary_f1_score': 0.8923797}
confusion matrix:
       0     1
0  42135   186
1    136  1335
---- Validation: 
scalar performance:
{'acc': 0.9872818, 'precision': 0.9021876, 'recall': 0.9064092, 'specificity': 0.9064092, 'f1': 0.9042864, 'auroc': 0.9836172, 'binary_precision': 0.81076926, 'binary_recall': 0.81959563, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.81515855}
confusion matrix:
       0    1
0  18026  123
1    116  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.8324328, 'recall': 0.53573143, 'specificity': 0.53573143, 'f1': 0.5557498, 'auroc': 0.9190689, 'binary_precision': 0.7037037, 'binary_recall': 0.07279693, 'binary_specificity': 0.998666, 'binary_f1_score': 0.13194445}
confusion matrix:
      0   1
0  5989   8
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_26.png
early stop counter: 4
val acc:0.9872817993164062, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9608501195907593 / 0.9638862013816833
after epoch: 26,now: 2024-06-08 19:27:03.343034,epoch time: 0:16:18.809929,used: 7:07:20.520005,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99342346, 'precision': 0.9584384, 'recall': 0.93856627, 'specificity': 0.93856627, 'f1': 0.94826525, 'auroc': 0.9979173, 'binary_precision': 0.92105263, 'binary_recall': 0.87975544, 'binary_specificity': 0.9973771, 'binary_f1_score': 0.89993054}
confusion matrix:
       0     1
0  42209   111
1    177  1295
---- Validation: 
scalar performance:
{'acc': 0.98616433, 'precision': 0.9114702, 'recall': 0.87057805, 'specificity': 0.87057805, 'f1': 0.88986766, 'auroc': 0.9838084, 'binary_precision': 0.8318891, 'binary_recall': 0.7465008, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.7868853}
confusion matrix:
       0    1
0  18052   97
1    163  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.8930844, 'recall': 0.5702142, 'specificity': 0.5702142, 'f1': 0.6114146, 'auroc': 0.9314027, 'binary_precision': 0.82222223, 'binary_recall': 0.14176245, 'binary_specificity': 0.998666, 'binary_f1_score': 0.24183007}
confusion matrix:
      0   1
0  5989   8
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_27.png
early stop counter: 5
val acc:0.9861643314361572, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9608501195907593 / 0.9638862013816833
after epoch: 27,now: 2024-06-08 19:43:28.247694,epoch time: 0:16:24.904660,used: 7:23:45.424665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9939258, 'precision': 0.95059174, 'recall': 0.9565022, 'specificity': 0.9565022, 'f1': 0.9535262, 'auroc': 0.9982096, 'binary_precision': 0.90409124, 'binary_recall': 0.9163834, 'binary_specificity': 0.9966211, 'binary_f1_score': 0.9101958}
confusion matrix:
       0     1
0  42178   143
1    123  1348
---- Validation: 
scalar performance:
{'acc': 0.98797363, 'precision': 0.9144623, 'recall': 0.9007669, 'specificity': 0.9007669, 'f1': 0.90749, 'auroc': 0.98350185, 'binary_precision': 0.8357488, 'binary_recall': 0.80715394, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.8212025}
confusion matrix:
       0    1
0  18047  102
1    124  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.81413656, 'recall': 0.5412285, 'specificity': 0.5412285, 'f1': 0.5646025, 'auroc': 0.8835863, 'binary_precision': 0.6666667, 'binary_recall': 0.08429119, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.14965987}
confusion matrix:
      0   1
0  5986  11
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_28.png
early stop counter: 6
val acc:0.9879736304283142, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9608501195907593 / 0.9638862013816833
after epoch: 28,now: 2024-06-08 19:59:48.097725,epoch time: 0:16:19.850031,used: 7:40:05.274696,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9899297, 'precision': 0.9032759, 'recall': 0.95410657, 'specificity': 0.95410657, 'f1': 0.92705405, 'auroc': 0.9969678, 'binary_precision': 0.8094952, 'binary_recall': 0.9157036, 'binary_specificity': 0.9925096, 'binary_f1_score': 0.8593302}
confusion matrix:
       0     1
0  42004   317
1    124  1347
---- Validation: 
scalar performance:
{'acc': 0.98483396, 'precision': 0.876773, 'recall': 0.9021417, 'specificity': 0.9021417, 'f1': 0.88900685, 'auroc': 0.983233, 'binary_precision': 0.7601744, 'binary_recall': 0.8133748, 'binary_specificity': 0.99090856, 'binary_f1_score': 0.7858752}
confusion matrix:
       0    1
0  17984  165
1    120  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.8557956, 'recall': 0.6358467, 'specificity': 0.6358467, 'f1': 0.69231653, 'auroc': 0.954376, 'binary_precision': 0.742268, 'binary_recall': 0.27586207, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.40223464}
confusion matrix:
      0   1
0  5972  25
1   189  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_29.png
new oracle model saved
early stop counter: 7
val acc:0.9848339557647705, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9608501195907593 / 0.9658037424087524
after epoch: 29,now: 2024-06-08 20:16:06.037979,epoch time: 0:16:17.940254,used: 7:56:23.214950,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99388015, 'precision': 0.94873774, 'recall': 0.9581462, 'specificity': 0.9581462, 'f1': 0.9533893, 'auroc': 0.9985111, 'binary_precision': 0.90026593, 'binary_recall': 0.91983694, 'binary_specificity': 0.99645555, 'binary_f1_score': 0.9099462}
confusion matrix:
       0     1
0  42170   150
1    118  1354
---- Validation: 
scalar performance:
{'acc': 0.9878672, 'precision': 0.91465855, 'recall': 0.89846164, 'specificity': 0.89846164, 'f1': 0.9063854, 'auroc': 0.9818187, 'binary_precision': 0.8363047, 'binary_recall': 0.8024883, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.81904763}
confusion matrix:
       0    1
0  18048  101
1    127  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8673812, 'recall': 0.5699641, 'specificity': 0.5699641, 'f1': 0.61011547, 'auroc': 0.910131, 'binary_precision': 0.7708333, 'binary_recall': 0.14176245, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.23948221}
confusion matrix:
      0   1
0  5986  11
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_30.png
early stop counter: 8
val acc:0.9878671765327454, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9608501195907593 / 0.9658037424087524
after epoch: 30,now: 2024-06-08 20:32:30.986322,epoch time: 0:16:24.948343,used: 8:12:48.163293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_12_19_42_seed_0_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:12:48.163293 at 2024-06-08 20:32:30.986322
persisted model performance metric: 

scalar performance:
{'acc': 0.9608501, 'precision': 0.8845907, 'recall': 0.53981304, 'specificity': 0.53981304, 'f1': 0.56315356, 'auroc': 0.9235919, 'binary_precision': 0.8076923, 'binary_recall': 0.08045977, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.14634146}
confusion matrix:
      0   1
0  5992   5
1   240  21
oracle model performance metric: 

scalar performance:
{'acc': 0.96580374, 'precision': 0.82697207, 'recall': 0.665164, 'specificity': 0.665164, 'f1': 0.716817, 'auroc': 0.95239747, 'binary_precision': 0.68217057, 'binary_recall': 0.33716476, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.45128208}
confusion matrix:
      0   1
0  5956  41
1   173  88
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1706 MiB |  15850 MiB |   1044 TiB |   1044 TiB |
|       from large pool |   1699 MiB |  15825 MiB |   1031 TiB |   1031 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1706 MiB |  15850 MiB |   1044 TiB |   1044 TiB |
|       from large pool |   1699 MiB |  15825 MiB |   1031 TiB |   1031 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1700 MiB |  15818 MiB |   1040 TiB |   1040 TiB |
|       from large pool |   1695 MiB |  15793 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16678 MiB |  16678 MiB |  16678 MiB |      0 B   |
|       from large pool |  16650 MiB |  16650 MiB |  16650 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 474654 KiB |    851 MiB | 464776 GiB | 464776 GiB |
|       from large pool | 454720 KiB |    848 MiB | 451884 GiB | 451884 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12892 GiB |  12892 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  151973 K  |  151969 K  |
|       from large pool |     247    |     989    |   62076 K  |   62076 K  |
|       from small pool |    3119    |    6108    |   89897 K  |   89893 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  151973 K  |  151969 K  |
|       from large pool |     247    |     989    |   62076 K  |   62076 K  |
|       from small pool |    3119    |    6108    |   89897 K  |   89893 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     617    |     617    |     617    |       0    |
|       from large pool |     603    |     603    |     603    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     146    |    2873    |   83410 K  |   83410 K  |
|       from large pool |     110    |     506    |   40711 K  |   40711 K  |
|       from small pool |      36    |    2761    |   42698 K  |   42698 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  15850 MiB |   1044 TiB |   1044 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   1031 TiB |   1031 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  15850 MiB |   1044 TiB |   1044 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   1031 TiB |   1031 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  15818 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  65536 KiB |  15793 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2170 MiB |  16678 MiB |  16678 MiB |  14508 MiB |
|       from large pool |   2144 MiB |  16650 MiB |  16650 MiB |  14506 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |    851 MiB | 464777 GiB | 464777 GiB |
|       from large pool |      0 B   |    848 MiB | 451885 GiB | 451885 GiB |
|       from small pool |      0 B   |     25 MiB |  12892 GiB |  12892 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  151973 K  |  151973 K  |
|       from large pool |       2    |     989    |   62076 K  |   62076 K  |
|       from small pool |       0    |    6108    |   89897 K  |   89897 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  151973 K  |  151973 K  |
|       from large pool |       2    |     989    |   62076 K  |   62076 K  |
|       from small pool |       0    |    6108    |   89897 K  |   89897 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     119    |     617    |     617    |     498    |
|       from large pool |     106    |     603    |     603    |     497    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2873    |   83411 K  |   83411 K  |
|       from large pool |       0    |     506    |   40711 K  |   40711 K  |
|       from small pool |       0    |    2761    |   42700 K  |   42700 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  15850 MiB |   1044 TiB |   1044 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   1031 TiB |   1031 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  15850 MiB |   1044 TiB |   1044 TiB |
|       from large pool |  65536 KiB |  15825 MiB |   1031 TiB |   1031 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  15818 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  65536 KiB |  15793 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2170 MiB |  16678 MiB |  16678 MiB |  14508 MiB |
|       from large pool |   2144 MiB |  16650 MiB |  16650 MiB |  14506 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |    851 MiB | 464777 GiB | 464777 GiB |
|       from large pool |      0 B   |    848 MiB | 451885 GiB | 451885 GiB |
|       from small pool |      0 B   |     25 MiB |  12892 GiB |  12892 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  151973 K  |  151973 K  |
|       from large pool |       2    |     989    |   62076 K  |   62076 K  |
|       from small pool |       0    |    6108    |   89897 K  |   89897 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  151973 K  |  151973 K  |
|       from large pool |       2    |     989    |   62076 K  |   62076 K  |
|       from small pool |       0    |    6108    |   89897 K  |   89897 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     119    |     617    |     617    |     498    |
|       from large pool |     106    |     603    |     603    |     497    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2873    |   83411 K  |   83411 K  |
|       from large pool |       0    |     506    |   40711 K  |   40711 K  |
|       from small pool |       0    |    2761    |   42700 K  |   42700 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_20_39_51_seed_1_21256731

 Experiment start at: 2024-06-08 20:39:51.606924
before training, model accuracy: 0.06461489200592041
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9713608, 'precision': 0.7878649, 'recall': 0.69579494, 'specificity': 0.69579494, 'f1': 0.7322729, 'auroc': 0.9442204, 'binary_precision': 0.5958763, 'binary_recall': 0.40083218, 'binary_specificity': 0.99075776, 'binary_f1_score': 0.4792703}
confusion matrix:
       0    1
0  42022  392
1    864  578
---- Validation: 
scalar performance:
{'acc': 0.9688367, 'precision': 0.786484, 'recall': 0.70273787, 'specificity': 0.70273787, 'f1': 0.73671913, 'auroc': 0.9464984, 'binary_precision': 0.59447986, 'binary_recall': 0.41604754, 'binary_specificity': 0.9894282, 'binary_f1_score': 0.4895105}
confusion matrix:
       0    1
0  17876  191
1    393  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.74099416, 'recall': 0.54798186, 'specificity': 0.54798186, 'f1': 0.57321155, 'auroc': 0.92553544, 'binary_precision': 0.52, 'binary_recall': 0.1, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.16774192}
confusion matrix:
      0   1
0  5922  24
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-08 20:57:08.070851,epoch time: 0:17:16.463927,used: 0:17:16.463927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_20_39_51_seed_1_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97377783, 'precision': 0.7984898, 'recall': 0.7695736, 'specificity': 0.7695736, 'f1': 0.78322595, 'auroc': 0.95917916, 'binary_precision': 0.61218196, 'binary_recall': 0.55100626, 'binary_specificity': 0.988141, 'binary_f1_score': 0.5799854}
confusion matrix:
       0    1
0  41912  503
1    647  794
---- Validation: 
scalar performance:
{'acc': 0.9705443, 'precision': 0.79173255, 'recall': 0.7615601, 'specificity': 0.7615601, 'f1': 0.77573645, 'auroc': 0.9613019, 'binary_precision': 0.60066557, 'binary_recall': 0.53640413, 'binary_specificity': 0.9867161, 'binary_f1_score': 0.566719}
confusion matrix:
       0    1
0  17827  240
1    312  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.7798686, 'recall': 0.5634505, 'specificity': 0.5634505, 'f1': 0.596962, 'auroc': 0.9299871, 'binary_precision': 0.5964912, 'binary_recall': 0.13076924, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.21451104}
confusion matrix:
      0   1
0  5923  23
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-08 21:13:43.406954,epoch time: 0:16:35.336103,used: 0:33:51.800030,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_20_39_51_seed_1_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9723185, 'precision': 0.77512956, 'recall': 0.8654409, 'specificity': 0.8654409, 'f1': 0.81321645, 'auroc': 0.9684428, 'binary_precision': 0.5588235, 'binary_recall': 0.7510402, 'binary_specificity': 0.9798416, 'binary_f1_score': 0.6408284}
confusion matrix:
       0     1
0  41559   855
1    359  1083
---- Validation: 
scalar performance:
{'acc': 0.9703842, 'precision': 0.779644, 'recall': 0.8465939, 'specificity': 0.8465939, 'f1': 0.8091159, 'auroc': 0.96895605, 'binary_precision': 0.5700713, 'binary_recall': 0.71322435, 'binary_specificity': 0.9799635, 'binary_f1_score': 0.6336634}
confusion matrix:
       0    1
0  17705  362
1    193  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.82709956, 'recall': 0.65073484, 'specificity': 0.65073484, 'f1': 0.7031863, 'auroc': 0.9421885, 'binary_precision': 0.6837607, 'binary_recall': 0.30769232, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.4244032}
confusion matrix:
      0   1
0  5909  37
1   180  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_3.png
new oracle model saved
early stop counter: 1
val acc:0.9703841805458069, best validation acc: 0.9705442786216736, corresponding to test acc:                         0.9598775506019592 / 0.9650338292121887
after epoch: 3,now: 2024-06-08 21:30:13.039618,epoch time: 0:16:29.632664,used: 0:50:21.432694,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_20_39_51_seed_1_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9785434, 'precision': 0.85725003, 'recall': 0.77252793, 'specificity': 0.77252793, 'f1': 0.8087282, 'auroc': 0.97209656, 'binary_precision': 0.72960585, 'binary_recall': 0.5520111, 'binary_specificity': 0.99304473, 'binary_f1_score': 0.62850374}
confusion matrix:
       0    1
0  42119  295
1    646  796
---- Validation: 
scalar performance:
{'acc': 0.97646743, 'precision': 0.8873967, 'recall': 0.73029923, 'specificity': 0.73029923, 'f1': 0.78729033, 'auroc': 0.97156566, 'binary_precision': 0.79441625, 'binary_recall': 0.46508172, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.5866917}
confusion matrix:
       0    1
0  17986   81
1    360  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.94896, 'recall': 0.52876204, 'specificity': 0.52876204, 'f1': 0.5442127, 'auroc': 0.9405028, 'binary_precision': 0.9375, 'binary_recall': 0.057692308, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.108695656}
confusion matrix:
      0   1
0  5945   1
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_4.png
better model found
persisted
after epoch: 4,now: 2024-06-08 21:46:44.565745,epoch time: 0:16:31.526127,used: 1:06:52.958821,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_20_39_51_seed_1_21256731
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98150766, 'precision': 0.8755992, 'recall': 0.8135848, 'specificity': 0.8135848, 'f1': 0.8415768, 'auroc': 0.9776368, 'binary_precision': 0.7635756, 'binary_recall': 0.6338419, 'binary_specificity': 0.9933277, 'binary_f1_score': 0.6926866}
confusion matrix:
       0    1
0  42131  283
1    528  914
---- Validation: 
scalar performance:
{'acc': 0.9794557, 'precision': 0.89834344, 'recall': 0.7754803, 'specificity': 0.7754803, 'f1': 0.82480085, 'auroc': 0.97600853, 'binary_precision': 0.8130435, 'binary_recall': 0.5557206, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.6601941}
confusion matrix:
       0    1
0  17981   86
1    299  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.86050475, 'recall': 0.5360339, 'specificity': 0.5360339, 'f1': 0.5564828, 'auroc': 0.94999146, 'binary_precision': 0.76, 'binary_recall': 0.073076926, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.13333334}
confusion matrix:
      0   1
0  5940   6
1   241  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21256731_5.png
[Sat Jun  8 22:03:14 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new/rule_results/6.csv

--- Logging error ---
Traceback (most recent call last):
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 628, in save
    _save(obj, opened_zipfile, pickle_module, pickle_protocol, _disable_byteorder_record)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 862, in _save
    zip_file.write_record(name, storage, num_bytes)
RuntimeError: [enforce fail at inline_container.cc:764] . PytorchStreamWriter failed writing file data/92: file write failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 2656, in run_wrapper
    run(
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 187, in __rule_run_experiment
    rule all:
Shutting down, this might take some time.
--- Logging error ---
