Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Jun  6 20:15:11 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_20_23_38_seed_0_21127990

 Experiment start at: 2024-06-06 20:23:38.615942
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9695606, 'precision': 0.7678317, 'recall': 0.7380287, 'specificity': 0.7380287, 'f1': 0.751961, 'auroc': 0.9499036, 'binary_precision': 0.55333847, 'binary_recall': 0.48980978, 'binary_specificity': 0.98624766, 'binary_f1_score': 0.5196397}
confusion matrix:
       0    1
0  41738  582
1    751  721
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.7542765, 'recall': 0.74089926, 'specificity': 0.74089926, 'f1': 0.74738705, 'auroc': 0.94611454, 'binary_precision': 0.5263158, 'binary_recall': 0.4976672, 'binary_specificity': 0.98413134, 'binary_f1_score': 0.5115907}
confusion matrix:
       0    1
0  17861  288
1    323  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9715564, 'precision': 0.9006636, 'recall': 0.6993152, 'specificity': 0.6993152, 'f1': 0.76328015, 'auroc': 0.93699527, 'binary_precision': 0.8267717, 'binary_recall': 0.40229884, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.5412371}
confusion matrix:
      0    1
0  5975   22
1   156  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21127990_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-06 20:41:47.986892,epoch time: 0:18:09.370950,used: 0:18:09.370950,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_20_23_38_seed_0_21127990
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97405916, 'precision': 0.83836794, 'recall': 0.6987181, 'specificity': 0.6987181, 'f1': 0.7489318, 'auroc': 0.9634752, 'binary_precision': 0.6971831, 'binary_recall': 0.4035326, 'binary_specificity': 0.9939036, 'binary_f1_score': 0.5111876}
confusion matrix:
       0    1
0  42062  258
1    878  594
---- Validation: 
scalar performance:
{'acc': 0.9725415, 'precision': 0.83876395, 'recall': 0.6700111, 'specificity': 0.6700111, 'f1': 0.72420543, 'auroc': 0.9595499, 'binary_precision': 0.7003155, 'binary_recall': 0.3452566, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.4625}
confusion matrix:
       0    1
0  18054   95
1    421  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.95398045, 'recall': 0.56496733, 'specificity': 0.56496733, 'f1': 0.6051074, 'auroc': 0.9453294, 'binary_precision': 0.9444444, 'binary_recall': 0.1302682, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.22895622}
confusion matrix:
      0   1
0  5995   2
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21127990_2.png
better model found
persisted
after epoch: 2,now: 2024-06-06 20:58:18.678014,epoch time: 0:16:30.691122,used: 0:34:40.062072,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_20_23_38_seed_0_21127990
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.975338, 'precision': 0.80573946, 'recall': 0.8305234, 'specificity': 0.8305234, 'f1': 0.81760025, 'auroc': 0.97184426, 'binary_precision': 0.622807, 'binary_recall': 0.67527175, 'binary_specificity': 0.98577505, 'binary_f1_score': 0.64797914}
confusion matrix:
       0    1
0  41718  602
1    478  994
---- Validation: 
scalar performance:
{'acc': 0.9754683, 'precision': 0.82199526, 'recall': 0.78853494, 'specificity': 0.78853494, 'f1': 0.8042617, 'auroc': 0.9665927, 'binary_precision': 0.6585366, 'binary_recall': 0.58786935, 'binary_specificity': 0.98920053, 'binary_f1_score': 0.62119967}
confusion matrix:
       0    1
0  17953  196
1    265  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8803383, 'recall': 0.60228103, 'specificity': 0.60228103, 'f1': 0.6550667, 'auroc': 0.953555, 'binary_precision': 0.7941176, 'binary_recall': 0.20689656, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.32826746}
confusion matrix:
      0   1
0  5983  14
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21127990_3.png
better model found
persisted
after epoch: 3,now: 2024-06-06 21:14:42.348866,epoch time: 0:16:23.670852,used: 0:51:03.732924,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_20_23_38_seed_0_21127990
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9806129, 'precision': 0.8797154, 'recall': 0.79606813, 'specificity': 0.79606813, 'f1': 0.8322984, 'auroc': 0.97770727, 'binary_precision': 0.77328646, 'binary_recall': 0.5982325, 'binary_specificity': 0.99390376, 'binary_f1_score': 0.67458797}
confusion matrix:
       0    1
0  42063  258
1    591  880
---- Validation: 
scalar performance:
{'acc': 0.9758408, 'precision': 0.87020814, 'recall': 0.71222216, 'specificity': 0.71222216, 'f1': 0.76814795, 'auroc': 0.97174907, 'binary_precision': 0.76033056, 'binary_recall': 0.42923796, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.5487077}
confusion matrix:
       0    1
0  18062   87
1    367  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.8432194, 'recall': 0.573462, 'specificity': 0.573462, 'f1': 0.61409724, 'auroc': 0.9473742, 'binary_precision': 0.7222222, 'binary_recall': 0.14942528, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.24761903}
confusion matrix:
      0   1
0  5982  15
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21127990_4.png
better model found
persisted
after epoch: 4,now: 2024-06-06 21:31:01.224714,epoch time: 0:16:18.875848,used: 1:07:22.608772,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_20_23_38_seed_0_21127990
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.981846, 'precision': 0.88182974, 'recall': 0.8201205, 'specificity': 0.8201205, 'f1': 0.8480404, 'auroc': 0.98112094, 'binary_precision': 0.7758761, 'binary_recall': 0.6467391, 'binary_specificity': 0.9935019, 'binary_f1_score': 0.7054464}
confusion matrix:
       0    1
0  42045  275
1    520  952
---- Validation: 
scalar performance:
{'acc': 0.9804704, 'precision': 0.8789629, 'recall': 0.8016254, 'specificity': 0.8016254, 'f1': 0.83553684, 'auroc': 0.9747988, 'binary_precision': 0.77165353, 'binary_recall': 0.6096423, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.68114686}
confusion matrix:
       0    1
0  18033  116
1    251  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.9490423, 'recall': 0.5802096, 'specificity': 0.5802096, 'f1': 0.628164, 'auroc': 0.9456842, 'binary_precision': 0.93333334, 'binary_recall': 0.16091955, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.27450982}
confusion matrix:
      0   1
0  5994   3
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21127990_5.png
better model found
persisted
after epoch: 5,now: 2024-06-06 21:47:18.966912,epoch time: 0:16:17.742198,used: 1:23:40.350970,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_20_23_38_seed_0_21127990
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9831933, 'precision': 0.90353084, 'recall': 0.81819475, 'specificity': 0.81819475, 'f1': 0.85542464, 'auroc': 0.9839763, 'binary_precision': 0.8194444, 'binary_recall': 0.6413044, 'binary_specificity': 0.99508506, 'binary_f1_score': 0.7195122}
confusion matrix:
       0    1
0  42112  208
1    528  944
---- Validation: 
scalar performance:
{'acc': 0.9813218, 'precision': 0.91057664, 'recall': 0.78031456, 'specificity': 0.78031456, 'f1': 0.8322401, 'auroc': 0.97676414, 'binary_precision': 0.8364055, 'binary_recall': 0.5645412, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.67409474}
confusion matrix:
       0    1
0  18078   71
1    280  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8557384, 'recall': 0.53964627, 'specificity': 0.53964627, 'f1': 0.5625638, 'auroc': 0.9428284, 'binary_precision': 0.75, 'binary_recall': 0.08045977, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.14532873}
confusion matrix:
      0   1
0  5990   7
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21127990_6.png
better model found
persisted
after epoch: 6,now: 2024-06-06 22:04:18.942053,epoch time: 0:16:59.975141,used: 1:40:40.326111,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_20_23_38_seed_0_21127990
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98269093, 'precision': 0.8612374, 'recall': 0.8787588, 'specificity': 0.8787588, 'f1': 0.86977196, 'auroc': 0.9848945, 'binary_precision': 0.73056996, 'binary_recall': 0.7673469, 'binary_specificity': 0.9901706, 'binary_f1_score': 0.7485069}
confusion matrix:
       0     1
0  41906   416
1    342  1128
---- Validation: 
scalar performance:
{'acc': 0.9816411, 'precision': 0.8571129, 'recall': 0.8704865, 'specificity': 0.8704865, 'f1': 0.86366546, 'auroc': 0.977288, 'binary_precision': 0.7230539, 'binary_recall': 0.7511664, 'binary_specificity': 0.9898066, 'binary_f1_score': 0.7368421}
confusion matrix:
       0    1
0  17964  185
1    160  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.8830985, 'recall': 0.6269351, 'specificity': 0.6269351, 'f1': 0.6855347, 'auroc': 0.94610476, 'binary_precision': 0.79761904, 'binary_recall': 0.256705, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.3884058}
confusion matrix:
      0   1
0  5980  17
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21127990_7.png
better model found
persisted
after epoch: 7,now: 2024-06-06 22:21:28.471508,epoch time: 0:17:09.529455,used: 1:57:49.855566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_20_23_38_seed_0_21127990
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9835358, 'precision': 0.88843596, 'recall': 0.8462399, 'specificity': 0.8462399, 'f1': 0.8660261, 'auroc': 0.9850681, 'binary_precision': 0.78729916, 'binary_recall': 0.69904894, 'binary_specificity': 0.993431, 'binary_f1_score': 0.7405541}
confusion matrix:
       0     1
0  42042   278
1    443  1029
---- Validation: 
scalar performance:
{'acc': 0.9822797, 'precision': 0.8860497, 'recall': 0.8295641, 'specificity': 0.8295641, 'f1': 0.8553915, 'auroc': 0.97918785, 'binary_precision': 0.7838828, 'binary_recall': 0.66562986, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.7199327}
confusion matrix:
       0    1
0  18031  118
1    215  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.8745173, 'recall': 0.56246805, 'specificity': 0.56246805, 'f1': 0.5992082, 'auroc': 0.9542038, 'binary_precision': 0.78571427, 'binary_recall': 0.12643678, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.21782179}
confusion matrix:
      0   1
0  5988   9
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21127990_8.png
better model found
persisted
after epoch: 8,now: 2024-06-06 22:38:50.987285,epoch time: 0:17:22.515777,used: 2:15:12.371343,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_20_23_38_seed_0_21127990
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98570514, 'precision': 0.9109189, 'recall': 0.8578539, 'specificity': 0.8578539, 'f1': 0.88240945, 'auroc': 0.9885386, 'binary_precision': 0.8315047, 'binary_recall': 0.72078806, 'binary_specificity': 0.99491966, 'binary_f1_score': 0.7721979}
confusion matrix:
       0     1
0  42105   215
1    411  1061
---- Validation: 
scalar performance:
{'acc': 0.9827054, 'precision': 0.8950912, 'recall': 0.8252841, 'specificity': 0.8252841, 'f1': 0.85652983, 'auroc': 0.9791758, 'binary_precision': 0.8022814, 'binary_recall': 0.6562986, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.7219845}
confusion matrix:
       0    1
0  18045  104
1    221  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.9004331, 'recall': 0.5588867, 'specificity': 0.5588867, 'f1': 0.59436893, 'auroc': 0.9483557, 'binary_precision': 0.8378378, 'binary_recall': 0.118773945, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.20805368}
confusion matrix:
      0   1
0  5991   6
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21127990_9.png
better model found
persisted
after epoch: 9,now: 2024-06-06 22:56:04.174662,epoch time: 0:17:13.187377,used: 2:32:25.558720,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_20_23_38_seed_0_21127990
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98412955, 'precision': 0.9430176, 'recall': 0.79559094, 'specificity': 0.79559094, 'f1': 0.853559, 'auroc': 0.98896444, 'binary_precision': 0.9, 'binary_recall': 0.59347385, 'binary_specificity': 0.997708, 'binary_f1_score': 0.71528065}
confusion matrix:
       0    1
0  42224   97
1    598  873
---- Validation: 
scalar performance:
{'acc': 0.98063004, 'precision': 0.9245705, 'recall': 0.7552046, 'specificity': 0.7552046, 'f1': 0.81728745, 'auroc': 0.97894543, 'binary_precision': 0.86614174, 'binary_recall': 0.5132193, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.64453125}
confusion matrix:
       0    1
0  18098   51
1    313  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.8051218, 'recall': 0.5243206, 'specificity': 0.5243206, 'f1': 0.5358424, 'auroc': 0.90901345, 'binary_precision': 0.65, 'binary_recall': 0.049808428, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.09252669}
confusion matrix:
      0   1
0  5990   7
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21127990_10.png
early stop counter: 1
val acc:0.9806300401687622, best validation acc: 0.9827054142951965, corresponding to test acc:                         0.9622882604598999 / 0.9715564250946045
after epoch: 10,now: 2024-06-06 23:13:09.510264,epoch time: 0:17:05.335602,used: 2:49:30.894322,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_20_23_38_seed_0_21127990
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98602486, 'precision': 0.8812789, 'recall': 0.91369975, 'specificity': 0.91369975, 'f1': 0.89676976, 'auroc': 0.9893743, 'binary_precision': 0.76826984, 'binary_recall': 0.83616585, 'binary_specificity': 0.99123365, 'binary_f1_score': 0.8007812}
confusion matrix:
       0     1
0  41950   371
1    241  1230
---- Validation: 
scalar performance:
{'acc': 0.98499364, 'precision': 0.88406456, 'recall': 0.8909735, 'specificity': 0.8909735, 'f1': 0.8874855, 'auroc': 0.98070717, 'binary_precision': 0.77557254, 'binary_recall': 0.79004663, 'binary_specificity': 0.9919004, 'binary_f1_score': 0.7827427}
confusion matrix:
       0    1
0  18002  147
1    135  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8909866, 'recall': 0.5682985, 'specificity': 0.5682985, 'f1': 0.6084922, 'auroc': 0.9267568, 'binary_precision': 0.8181818, 'binary_recall': 0.13793103, 'binary_specificity': 0.998666, 'binary_f1_score': 0.23606557}
confusion matrix:
      0   1
0  5989   8
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21127990_11.png
better model found
persisted
after epoch: 11,now: 2024-06-06 23:30:14.679820,epoch time: 0:17:05.169556,used: 3:06:36.063878,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_20_23_38_seed_0_21127990
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98524845, 'precision': 0.8663064, 'recall': 0.93073016, 'specificity': 0.93073016, 'f1': 0.8956738, 'auroc': 0.990605, 'binary_precision': 0.7370838, 'binary_recall': 0.8722826, 'binary_specificity': 0.9891777, 'binary_f1_score': 0.7990044}
confusion matrix:
       0     1
0  41862   458
1    188  1284
---- Validation: 
scalar performance:
{'acc': 0.98499364, 'precision': 0.8763335, 'recall': 0.9067247, 'specificity': 0.9067247, 'f1': 0.89088583, 'auroc': 0.9825777, 'binary_precision': 0.758967, 'binary_recall': 0.82270604, 'binary_specificity': 0.9907433, 'binary_f1_score': 0.7895522}
confusion matrix:
       0    1
0  17981  168
1    114  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8639338, 'recall': 0.5850397, 'specificity': 0.5850397, 'f1': 0.63119566, 'auroc': 0.9364246, 'binary_precision': 0.7627119, 'binary_recall': 0.1724138, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.28125}
confusion matrix:
      0   1
0  5983  14
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21127990_12.png
early stop counter: 1
val acc:0.9849936366081238, best validation acc: 0.9849936366081238, corresponding to test acc:                         0.9627676606178284 / 0.9715564250946045
after epoch: 12,now: 2024-06-06 23:47:31.040203,epoch time: 0:17:16.360383,used: 3:23:52.424261,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_20_23_38_seed_0_21127990
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98657286, 'precision': 0.9626761, 'recall': 0.82092685, 'specificity': 0.82092685, 'f1': 0.8780924, 'auroc': 0.99199134, 'binary_precision': 0.93762374, 'binary_recall': 0.6433424, 'binary_specificity': 0.9985113, 'binary_f1_score': 0.76309425}
confusion matrix:
       0    1
0  42257   63
1    525  947
---- Validation: 
scalar performance:
{'acc': 0.9833972, 'precision': 0.9468429, 'recall': 0.7851393, 'specificity': 0.7851393, 'f1': 0.8468753, 'auroc': 0.9797282, 'binary_precision': 0.908642, 'binary_recall': 0.57231724, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.70229006}
confusion matrix:
       0    1
0  18112   37
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.9081747, 'recall': 0.5114109, 'specificity': 0.5114109, 'f1': 0.5119374, 'auroc': 0.8885813, 'binary_precision': 0.85714287, 'binary_recall': 0.022988506, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.04477612}
confusion matrix:
      0  1
0  5996  1
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21127990_13.png
early stop counter: 2
val acc:0.9833971858024597, best validation acc: 0.9849936366081238, corresponding to test acc:                         0.9627676606178284 / 0.9715564250946045
after epoch: 13,now: 2024-06-07 00:04:41.796395,epoch time: 0:17:10.756192,used: 3:41:03.180453,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_20_23_38_seed_0_21127990
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98876506, 'precision': 0.91587484, 'recall': 0.909868, 'specificity': 0.909868, 'f1': 0.91284776, 'auroc': 0.9931042, 'binary_precision': 0.83781916, 'binary_recall': 0.8252889, 'binary_specificity': 0.9944472, 'binary_f1_score': 0.8315068}
confusion matrix:
       0     1
0  42086   235
1    257  1214
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.90612245, 'recall': 0.86883, 'specificity': 0.86883, 'f1': 0.8865048, 'auroc': 0.9804354, 'binary_precision': 0.8213059, 'binary_recall': 0.7433904, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.78040814}
confusion matrix:
       0    1
0  18045  104
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.92604196, 'recall': 0.5609692, 'specificity': 0.5609692, 'f1': 0.59820974, 'auroc': 0.9225833, 'binary_precision': 0.8888889, 'binary_recall': 0.12260536, 'binary_specificity': 0.999333, 'binary_f1_score': 0.2154882}
confusion matrix:
      0   1
0  5993   4
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21127990_14.png
better model found
persisted
after epoch: 14,now: 2024-06-07 00:21:47.945347,epoch time: 0:17:06.148952,used: 3:58:09.329405,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_20_23_38_seed_0_21127990
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98874223, 'precision': 0.95504546, 'recall': 0.8633595, 'specificity': 0.8633595, 'f1': 0.90369153, 'auroc': 0.99351424, 'binary_precision': 0.9194516, 'binary_recall': 0.7289402, 'binary_specificity': 0.99777883, 'binary_f1_score': 0.8131868}
confusion matrix:
       0     1
0  42226    94
1    399  1073
---- Validation: 
scalar performance:
{'acc': 0.98392934, 'precision': 0.9267856, 'recall': 0.8116667, 'specificity': 0.8116667, 'f1': 0.8595787, 'auroc': 0.9802941, 'binary_precision': 0.8666667, 'binary_recall': 0.62674963, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.72743684}
confusion matrix:
       0    1
0  18087   62
1    240  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.9344558, 'recall': 0.5190737, 'specificity': 0.5190737, 'f1': 0.52647394, 'auroc': 0.9268172, 'binary_precision': 0.90909094, 'binary_recall': 0.038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.07352941}
confusion matrix:
      0   1
0  5996   1
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21127990_15.png
early stop counter: 1
val acc:0.9839293360710144, best validation acc: 0.985685408115387, corresponding to test acc:                         0.9627676606178284 / 0.9715564250946045
after epoch: 15,now: 2024-06-07 00:38:56.342104,epoch time: 0:17:08.396757,used: 4:15:17.726162,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_20_23_38_seed_0_21127990
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99038637, 'precision': 0.95458543, 'recall': 0.8912765, 'specificity': 0.8912765, 'f1': 0.9203849, 'auroc': 0.9948524, 'binary_precision': 0.91660047, 'binary_recall': 0.785034, 'binary_specificity': 0.997519, 'binary_f1_score': 0.8457311}
confusion matrix:
       0     1
0  42217   105
1    316  1154
---- Validation: 
scalar performance:
{'acc': 0.9855257, 'precision': 0.9338541, 'recall': 0.8327447, 'specificity': 0.8327447, 'f1': 0.8761277, 'auroc': 0.9821148, 'binary_precision': 0.8793456, 'binary_recall': 0.6687403, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.7597173}
confusion matrix:
       0    1
0  18090   59
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.87744755, 'recall': 0.54356104, 'specificity': 0.54356104, 'f1': 0.5693316, 'auroc': 0.9223467, 'binary_precision': 0.79310346, 'binary_recall': 0.08812261, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.15862069}
confusion matrix:
      0   1
0  5991   6
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21127990_16.png
early stop counter: 2
val acc:0.9855257272720337, best validation acc: 0.985685408115387, corresponding to test acc:                         0.9627676606178284 / 0.9715564250946045
after epoch: 16,now: 2024-06-07 00:55:57.497321,epoch time: 0:17:01.155217,used: 4:32:18.881379,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_20_23_38_seed_0_21127990
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9897698, 'precision': 0.9273316, 'recall': 0.9127422, 'specificity': 0.9127422, 'f1': 0.91990006, 'auroc': 0.9948273, 'binary_precision': 0.8605634, 'binary_recall': 0.83016306, 'binary_specificity': 0.99532133, 'binary_f1_score': 0.84508985}
confusion matrix:
       0     1
0  42122   198
1    250  1222
---- Validation: 
scalar performance:
{'acc': 0.9871754, 'precision': 0.91967535, 'recall': 0.878602, 'specificity': 0.878602, 'f1': 0.89799654, 'auroc': 0.9811106, 'binary_precision': 0.84775084, 'binary_recall': 0.7620529, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.8026208}
confusion matrix:
       0    1
0  18061   88
1    153  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.8936369, 'recall': 0.536065, 'specificity': 0.536065, 'f1': 0.55684584, 'auroc': 0.9254123, 'binary_precision': 0.82608694, 'binary_recall': 0.07279693, 'binary_specificity': 0.999333, 'binary_f1_score': 0.13380282}
confusion matrix:
      0   1
0  5993   4
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21127990_17.png
better model found
persisted
after epoch: 17,now: 2024-06-07 01:13:00.981402,epoch time: 0:17:03.484081,used: 4:49:22.365460,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_20_23_38_seed_0_21127990
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
slurmstepd: error: *** JOB 21127990 ON supergpu15 CANCELLED AT 2024-06-07T01:15:39 ***
