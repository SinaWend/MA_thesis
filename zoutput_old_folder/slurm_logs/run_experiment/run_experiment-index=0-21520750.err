Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jun 21 11:04:49 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750

 Experiment start at: 2024-06-21 11:23:15.187620
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90638906, 'precision': 0.9406651, 'recall': 0.504407, 'specificity': 0.504407, 'f1': 0.4841847, 'auroc': 0.89579535, 'binary_precision': 0.975, 'binary_recall': 0.008837526, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.017516281}
confusion matrix:
       0   1
0  42322   1
1   4374  39
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.45349258, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.4619671, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 11:40:04.590014,epoch time: 0:16:49.402394,used: 0:16:49.402394,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94304174, 'precision': 0.9252281, 'recall': 0.71922064, 'specificity': 0.71922064, 'f1': 0.78228015, 'auroc': 0.94660175, 'binary_precision': 0.90559924, 'binary_recall': 0.4432616, 'binary_specificity': 0.9951797, 'binary_f1_score': 0.59519464}
confusion matrix:
       0     1
0  42117   204
1   2458  1957
---- Validation: 
scalar performance:
{'acc': 0.965198, 'precision': 0.5495979, 'recall': 0.5011971, 'specificity': 0.5011971, 'f1': 0.49418396, 'auroc': 0.6180349, 'binary_precision': 0.13333334, 'binary_recall': 0.00311042, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.0060790274}
confusion matrix:
       0   1
0  18136  13
1    641   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.52464455, 'recall': 0.50108194, 'specificity': 0.50108194, 'f1': 0.4926507, 'auroc': 0.6970901, 'binary_precision': 0.09090909, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.0073529407}
confusion matrix:
      0   1
0  5987  10
1   260   1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_2.png
early stop counter: 1
val acc:0.9651979804039001, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-21 11:56:18.460565,epoch time: 0:16:13.870551,used: 0:33:03.272945,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9580623, 'precision': 0.92836344, 'recall': 0.811545, 'specificity': 0.811545, 'f1': 0.85848516, 'auroc': 0.9650899, 'binary_precision': 0.894095, 'binary_recall': 0.6308877, 'binary_specificity': 0.9922023, 'binary_f1_score': 0.7397769}
confusion matrix:
       0     1
0  41990   330
1   1630  2786
---- Validation: 
scalar performance:
{'acc': 0.9633887, 'precision': 0.6124806, 'recall': 0.5167616, 'specificity': 0.5167616, 'f1': 0.52327305, 'auroc': 0.70058024, 'binary_precision': 0.2580645, 'binary_recall': 0.03732504, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.0652174}
confusion matrix:
       0   1
0  18080  69
1    619  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.69163585, 'recall': 0.5342307, 'specificity': 0.5342307, 'f1': 0.5511169, 'auroc': 0.7612721, 'binary_precision': 0.42222223, 'binary_recall': 0.07279693, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.12418301}
confusion matrix:
      0   1
0  5971  26
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_3.png
early stop counter: 2
val acc:0.9633886814117432, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-21 12:11:59.069474,epoch time: 0:15:40.608909,used: 0:48:43.881854,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9654656, 'precision': 0.95353305, 'recall': 0.8366897, 'specificity': 0.8366897, 'f1': 0.884418, 'auroc': 0.9717419, 'binary_precision': 0.9397174, 'binary_recall': 0.67791617, 'binary_specificity': 0.99546325, 'binary_f1_score': 0.7876315}
confusion matrix:
       0     1
0  42129   192
1   1422  2993
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.741616, 'recall': 0.5390855, 'specificity': 0.5390855, 'f1': 0.5612063, 'auroc': 0.7056259, 'binary_precision': 0.5148515, 'binary_recall': 0.08087092, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.13978495}
confusion matrix:
       0   1
0  18100  49
1    591  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.72258896, 'recall': 0.5511386, 'specificity': 0.5511386, 'f1': 0.576993, 'auroc': 0.76990604, 'binary_precision': 0.4827586, 'binary_recall': 0.107279696, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.1755486}
confusion matrix:
      0   1
0  5967  30
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_4.png
better model found
persisted
after epoch: 4,now: 2024-06-21 12:27:32.531945,epoch time: 0:15:33.462471,used: 1:04:17.344325,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9719488, 'precision': 0.9648108, 'recall': 0.8665116, 'specificity': 0.8665116, 'f1': 0.90844893, 'auroc': 0.97722137, 'binary_precision': 0.9564578, 'binary_recall': 0.7365202, 'binary_specificity': 0.996503, 'binary_f1_score': 0.83220273}
confusion matrix:
       0     1
0  42174   148
1   1163  3251
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.73812574, 'recall': 0.5570593, 'specificity': 0.5570593, 'f1': 0.5871272, 'auroc': 0.7026622, 'binary_precision': 0.50666666, 'binary_recall': 0.11819596, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.19167718}
confusion matrix:
       0   1
0  18075  74
1    567  76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.73924565, 'recall': 0.5624661, 'specificity': 0.5624661, 'f1': 0.5933512, 'auroc': 0.7466928, 'binary_precision': 0.5151515, 'binary_recall': 0.1302682, 'binary_specificity': 0.994664, 'binary_f1_score': 0.20795105}
confusion matrix:
      0   1
0  5965  32
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_5.png
new oracle model saved
early stop counter: 1
val acc:0.9658897519111633, best validation acc: 0.9659429788589478, corresponding to test acc:                         0.9579737782478333 / 0.9586129784584045
after epoch: 5,now: 2024-06-21 12:46:31.964594,epoch time: 0:18:59.432649,used: 1:23:16.776974,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9767417, 'precision': 0.9631903, 'recall': 0.8968798, 'specificity': 0.8968798, 'f1': 0.9268373, 'auroc': 0.9813951, 'binary_precision': 0.9470715, 'binary_recall': 0.79841447, 'binary_specificity': 0.9953451, 'binary_f1_score': 0.8664127}
confusion matrix:
       0     1
0  42124   197
1    890  3525
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.735625, 'recall': 0.58175606, 'specificity': 0.58175606, 'f1': 0.61784226, 'auroc': 0.7409923, 'binary_precision': 0.5, 'binary_recall': 0.16951789, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.25319397}
confusion matrix:
       0    1
0  18040  109
1    534  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.7567254, 'recall': 0.60894144, 'specificity': 0.60894144, 'f1': 0.64955986, 'auroc': 0.77391124, 'binary_precision': 0.5462963, 'binary_recall': 0.22605364, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.31978318}
confusion matrix:
      0   1
0  5948  49
1   202  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_6.png
new oracle model saved
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9659429788589478, corresponding to test acc:                         0.9579737782478333 / 0.9598913192749023
after epoch: 6,now: 2024-06-21 13:08:39.948462,epoch time: 0:22:07.983868,used: 1:45:24.760842,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9787102, 'precision': 0.9601073, 'recall': 0.91194564, 'specificity': 0.91194564, 'f1': 0.9343547, 'auroc': 0.98578393, 'binary_precision': 0.9377721, 'binary_recall': 0.829633, 'binary_specificity': 0.9942583, 'binary_f1_score': 0.88039434}
confusion matrix:
       0     1
0  42079   243
1    752  3662
---- Validation: 
scalar performance:
{'acc': 0.96514475, 'precision': 0.7290873, 'recall': 0.6316791, 'specificity': 0.6316791, 'f1': 0.66582286, 'auroc': 0.77607864, 'binary_precision': 0.48351648, 'binary_recall': 0.27371696, 'binary_specificity': 0.9896413, 'binary_f1_score': 0.34955314}
confusion matrix:
       0    1
0  17961  188
1    467  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.78825724, 'recall': 0.6489212, 'specificity': 0.6489212, 'f1': 0.6939525, 'auroc': 0.80462646, 'binary_precision': 0.6060606, 'binary_recall': 0.3065134, 'binary_specificity': 0.991329, 'binary_f1_score': 0.40712467}
confusion matrix:
      0   1
0  5945  52
1   181  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_7.png
new oracle model saved
early stop counter: 3
val acc:0.9651447534561157, best validation acc: 0.9659429788589478, corresponding to test acc:                         0.9579737782478333 / 0.9627676606178284
after epoch: 7,now: 2024-06-21 13:26:51.976497,epoch time: 0:18:12.028035,used: 2:03:36.788877,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9798442, 'precision': 0.97791255, 'recall': 0.902346, 'specificity': 0.902346, 'f1': 0.9360919, 'auroc': 0.98513234, 'binary_precision': 0.97562313, 'binary_recall': 0.806795, 'binary_specificity': 0.997897, 'binary_f1_score': 0.88321346}
confusion matrix:
       0     1
0  42232    89
1    853  3562
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.7770929, 'recall': 0.5826101, 'specificity': 0.5826101, 'f1': 0.6229997, 'auroc': 0.73799396, 'binary_precision': 0.5828877, 'binary_recall': 0.16951789, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.2626506}
confusion matrix:
       0    1
0  18071   78
1    534  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.80466473, 'recall': 0.600947, 'specificity': 0.600947, 'f1': 0.6467855, 'auroc': 0.76541257, 'binary_precision': 0.64285713, 'binary_recall': 0.20689656, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.3130435}
confusion matrix:
      0   1
0  5967  30
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_8.png
better model found
persisted
after epoch: 8,now: 2024-06-21 13:44:55.740385,epoch time: 0:18:03.763888,used: 2:21:40.552765,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98078567, 'precision': 0.9606093, 'recall': 0.92435384, 'specificity': 0.92435384, 'f1': 0.94154555, 'auroc': 0.988538, 'binary_precision': 0.9362283, 'binary_recall': 0.85478026, 'binary_specificity': 0.9939275, 'binary_f1_score': 0.8936523}
confusion matrix:
       0     1
0  42065   257
1    641  3773
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.728122, 'recall': 0.653293, 'specificity': 0.653293, 'f1': 0.68255115, 'auroc': 0.7952502, 'binary_precision': 0.4800937, 'binary_recall': 0.31881803, 'binary_specificity': 0.98776793, 'binary_f1_score': 0.38317758}
confusion matrix:
       0    1
0  17927  222
1    438  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.7868125, 'recall': 0.6711593, 'specificity': 0.6711593, 'f1': 0.7127197, 'auroc': 0.81932986, 'binary_precision': 0.6013072, 'binary_recall': 0.35249043, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.44444448}
confusion matrix:
      0   1
0  5936  61
1   169  92
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_9.png
new oracle model saved
early stop counter: 1
val acc:0.9648786783218384, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9621284604072571 / 0.9632470607757568
after epoch: 9,now: 2024-06-21 14:02:47.435130,epoch time: 0:17:51.694745,used: 2:39:32.247510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98296815, 'precision': 0.97068846, 'recall': 0.92758816, 'specificity': 0.92758816, 'f1': 0.94783986, 'auroc': 0.98867387, 'binary_precision': 0.95589715, 'binary_recall': 0.8593113, 'binary_specificity': 0.99586505, 'binary_f1_score': 0.9050346}
confusion matrix:
       0     1
0  42147   175
1    621  3793
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.73700315, 'recall': 0.622259, 'specificity': 0.622259, 'f1': 0.6594341, 'auroc': 0.7693974, 'binary_precision': 0.5, 'binary_recall': 0.2534992, 'binary_specificity': 0.9910188, 'binary_f1_score': 0.3364293}
confusion matrix:
       0    1
0  17986  163
1    480  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.7944712, 'recall': 0.65100366, 'specificity': 0.65100366, 'f1': 0.6971473, 'auroc': 0.7914061, 'binary_precision': 0.6183206, 'binary_recall': 0.31034482, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.41326532}
confusion matrix:
      0   1
0  5947  50
1   180  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_10.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9621284604072571 / 0.9632470607757568
after epoch: 10,now: 2024-06-21 14:21:23.019342,epoch time: 0:18:35.584212,used: 2:58:07.831722,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9818555, 'precision': 0.9672165, 'recall': 0.9242509, 'specificity': 0.9242509, 'f1': 0.94443244, 'auroc': 0.987818, 'binary_precision': 0.94958407, 'binary_recall': 0.8532276, 'binary_specificity': 0.9952742, 'binary_f1_score': 0.89883083}
confusion matrix:
       0     1
0  42121   200
1    648  3767
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.7272185, 'recall': 0.64429235, 'specificity': 0.64429235, 'f1': 0.6754807, 'auroc': 0.77873003, 'binary_precision': 0.47890818, 'binary_recall': 0.30015552, 'binary_specificity': 0.9884291, 'binary_f1_score': 0.36902484}
confusion matrix:
       0    1
0  17939  210
1    450  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.8281418, 'recall': 0.68207186, 'specificity': 0.68207186, 'f1': 0.7320677, 'auroc': 0.82281184, 'binary_precision': 0.6830986, 'binary_recall': 0.3716475, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.48138955}
confusion matrix:
      0   1
0  5952  45
1   164  97
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_11.png
new oracle model saved
early stop counter: 3
val acc:0.9648786783218384, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9621284604072571 / 0.9666027426719666
after epoch: 11,now: 2024-06-21 14:39:37.465678,epoch time: 0:18:14.446336,used: 3:16:22.278058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9823049, 'precision': 0.95514286, 'recall': 0.9400313, 'specificity': 0.9400313, 'f1': 0.9474253, 'auroc': 0.9883827, 'binary_precision': 0.92193747, 'binary_recall': 0.8879076, 'binary_specificity': 0.992155, 'binary_f1_score': 0.9046026}
confusion matrix:
       0     1
0  41988   332
1    495  3921
---- Validation: 
scalar performance:
{'acc': 0.96290976, 'precision': 0.7145121, 'recall': 0.68377596, 'specificity': 0.68377596, 'f1': 0.6978128, 'auroc': 0.8130056, 'binary_precision': 0.45072994, 'binary_recall': 0.38413686, 'binary_specificity': 0.98341507, 'binary_f1_score': 0.41477752}
confusion matrix:
       0    1
0  17848  301
1    396  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.7857541, 'recall': 0.7008102, 'specificity': 0.7008102, 'f1': 0.73498493, 'auroc': 0.83764875, 'binary_precision': 0.5966851, 'binary_recall': 0.41379312, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.48868778}
confusion matrix:
      0    1
0  5924   73
1   153  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_12.png
early stop counter: 4
val acc:0.9629097580909729, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9621284604072571 / 0.9666027426719666
after epoch: 12,now: 2024-06-21 14:58:31.947391,epoch time: 0:18:54.481713,used: 3:35:16.759771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98303235, 'precision': 0.9633038, 'recall': 0.93555146, 'specificity': 0.93555146, 'f1': 0.9488869, 'auroc': 0.98954165, 'binary_precision': 0.93934983, 'binary_recall': 0.87701017, 'binary_specificity': 0.99409276, 'binary_f1_score': 0.9071102}
confusion matrix:
       0     1
0  42071   250
1    543  3872
---- Validation: 
scalar performance:
{'acc': 0.96397406, 'precision': 0.7179969, 'recall': 0.6468242, 'specificity': 0.6468242, 'f1': 0.67466956, 'auroc': 0.7717662, 'binary_precision': 0.4602804, 'binary_recall': 0.30637637, 'binary_specificity': 0.987272, 'binary_f1_score': 0.3678805}
confusion matrix:
       0    1
0  17918  231
1    446  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.7948439, 'recall': 0.67707324, 'specificity': 0.67707324, 'f1': 0.7196189, 'auroc': 0.80722404, 'binary_precision': 0.6168831, 'binary_recall': 0.36398467, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.45783132}
confusion matrix:
      0   1
0  5938  59
1   166  95
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_13.png
early stop counter: 5
val acc:0.9639740586280823, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9621284604072571 / 0.9666027426719666
after epoch: 13,now: 2024-06-21 15:15:01.945934,epoch time: 0:16:29.998543,used: 3:51:46.758314,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9837598, 'precision': 0.9649904, 'recall': 0.9382862, 'specificity': 0.9382862, 'f1': 0.95114005, 'auroc': 0.98915553, 'binary_precision': 0.9421868, 'binary_recall': 0.88221973, 'binary_specificity': 0.9943527, 'binary_f1_score': 0.9112177}
confusion matrix:
       0     1
0  42082   239
1    520  3895
---- Validation: 
scalar performance:
{'acc': 0.9641869, 'precision': 0.7213284, 'recall': 0.655185, 'specificity': 0.655185, 'f1': 0.68178046, 'auroc': 0.799033, 'binary_precision': 0.46636772, 'binary_recall': 0.32348368, 'binary_specificity': 0.9868863, 'binary_f1_score': 0.38200185}
confusion matrix:
       0    1
0  17911  238
1    435  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.800212, 'recall': 0.6791557, 'specificity': 0.6791557, 'f1': 0.72271204, 'auroc': 0.827162, 'binary_precision': 0.627451, 'binary_recall': 0.3678161, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.46376812}
confusion matrix:
      0   1
0  5940  57
1   165  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_14.png
early stop counter: 6
val acc:0.9641869068145752, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9621284604072571 / 0.9666027426719666
after epoch: 14,now: 2024-06-21 15:30:27.928890,epoch time: 0:15:25.982956,used: 4:07:12.741270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98461574, 'precision': 0.97149086, 'recall': 0.93681777, 'specificity': 0.93681777, 'f1': 0.9533218, 'auroc': 0.98937106, 'binary_precision': 0.95561033, 'binary_recall': 0.87788856, 'binary_specificity': 0.9957469, 'binary_f1_score': 0.9151021}
confusion matrix:
       0     1
0  42142   180
1    539  3875
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.7354407, 'recall': 0.6491508, 'specificity': 0.6491508, 'f1': 0.6815771, 'auroc': 0.7957971, 'binary_precision': 0.4950249, 'binary_recall': 0.30948678, 'binary_specificity': 0.98881483, 'binary_f1_score': 0.38086122}
confusion matrix:
       0    1
0  17946  203
1    444  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.8073225, 'recall': 0.6962303, 'specificity': 0.6962303, 'f1': 0.7381679, 'auroc': 0.8265202, 'binary_precision': 0.6402439, 'binary_recall': 0.40229884, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.49411765}
confusion matrix:
      0    1
0  5938   59
1   156  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_15.png
early stop counter: 7
val acc:0.9655704498291016, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9621284604072571 / 0.9666027426719666
after epoch: 15,now: 2024-06-21 15:46:16.345800,epoch time: 0:15:48.416910,used: 4:23:01.158180,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98478687, 'precision': 0.96855724, 'recall': 0.9408692, 'specificity': 0.9408692, 'f1': 0.9541818, 'auroc': 0.9918127, 'binary_precision': 0.9488485, 'binary_recall': 0.88672405, 'binary_specificity': 0.9950144, 'binary_f1_score': 0.916735}
confusion matrix:
       0     1
0  42111   211
1    500  3914
---- Validation: 
scalar performance:
{'acc': 0.964453, 'precision': 0.72294617, 'recall': 0.64707214, 'specificity': 0.64707214, 'f1': 0.67635393, 'auroc': 0.7825675, 'binary_precision': 0.47016707, 'binary_recall': 0.30637637, 'binary_specificity': 0.98776793, 'binary_f1_score': 0.3709981}
confusion matrix:
       0    1
0  17927  222
1    446  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.7942303, 'recall': 0.66774476, 'specificity': 0.66774476, 'f1': 0.71175706, 'auroc': 0.81369835, 'binary_precision': 0.6164383, 'binary_recall': 0.3448276, 'binary_specificity': 0.990662, 'binary_f1_score': 0.44226044}
confusion matrix:
      0   1
0  5941  56
1   171  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_16.png
early stop counter: 8
val acc:0.9644529819488525, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9621284604072571 / 0.9666027426719666
after epoch: 16,now: 2024-06-21 16:04:11.924649,epoch time: 0:17:55.578849,used: 4:40:56.737029,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9841022, 'precision': 0.96138895, 'recall': 0.94437027, 'specificity': 0.94437027, 'f1': 0.95267713, 'auroc': 0.9893383, 'binary_precision': 0.93364817, 'binary_recall': 0.89538044, 'binary_specificity': 0.9933601, 'binary_f1_score': 0.91411394}
confusion matrix:
       0     1
0  42039   281
1    462  3954
---- Validation: 
scalar performance:
{'acc': 0.96285653, 'precision': 0.71200264, 'recall': 0.6709975, 'specificity': 0.6709975, 'f1': 0.68903726, 'auroc': 0.8115439, 'binary_precision': 0.44660193, 'binary_recall': 0.3576983, 'binary_specificity': 0.9842967, 'binary_f1_score': 0.39723662}
confusion matrix:
       0    1
0  17864  285
1    413  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.80258083, 'recall': 0.67365867, 'specificity': 0.67365867, 'f1': 0.7187737, 'auroc': 0.8278333, 'binary_precision': 0.63265306, 'binary_recall': 0.35632184, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.45588234}
confusion matrix:
      0   1
0  5943  54
1   168  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_17.png
early stop counter: 9
val acc:0.9628565311431885, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9621284604072571 / 0.9666027426719666
after epoch: 17,now: 2024-06-21 16:19:58.945534,epoch time: 0:15:47.020885,used: 4:56:43.757914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98495805, 'precision': 0.97247994, 'recall': 0.937947, 'specificity': 0.937947, 'f1': 0.95438963, 'auroc': 0.9914063, 'binary_precision': 0.9573787, 'binary_recall': 0.8799819, 'binary_specificity': 0.9959121, 'binary_f1_score': 0.9170501}
confusion matrix:
       0     1
0  42147   173
1    530  3886
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7524494, 'recall': 0.6415889, 'specificity': 0.6415889, 'f1': 0.6798762, 'auroc': 0.7745345, 'binary_precision': 0.5295775, 'binary_recall': 0.29237947, 'binary_specificity': 0.9907984, 'binary_f1_score': 0.3767535}
confusion matrix:
       0    1
0  17982  167
1    455  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8065245, 'recall': 0.6700774, 'specificity': 0.6700774, 'f1': 0.716684, 'auroc': 0.8100034, 'binary_precision': 0.64084506, 'binary_recall': 0.348659, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.4516129}
confusion matrix:
      0   1
0  5946  51
1   170  91
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_18.png
early stop counter: 10
val acc:0.9669008255004883, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9621284604072571 / 0.9666027426719666
after epoch: 18,now: 2024-06-21 16:38:12.134397,epoch time: 0:18:13.188863,used: 5:14:56.946777,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9858353, 'precision': 0.9751941, 'recall': 0.940561, 'specificity': 0.940561, 'f1': 0.95705426, 'auroc': 0.99280655, 'binary_precision': 0.96231526, 'binary_recall': 0.8847373, 'binary_specificity': 0.9963847, 'binary_f1_score': 0.9218971}
confusion matrix:
       0     1
0  42167   153
1    509  3907
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.7462227, 'recall': 0.6308402, 'specificity': 0.6308402, 'f1': 0.66911334, 'auroc': 0.78612363, 'binary_precision': 0.51785713, 'binary_recall': 0.27060652, 'binary_specificity': 0.9910739, 'binary_f1_score': 0.35546473}
confusion matrix:
       0    1
0  17987  162
1    469  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.83358073, 'recall': 0.6428425, 'specificity': 0.6428425, 'f1': 0.6964313, 'auroc': 0.8165962, 'binary_precision': 0.6972477, 'binary_recall': 0.29118773, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.41081083}
confusion matrix:
      0   1
0  5964  33
1   185  76
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_19.png
early stop counter: 11
val acc:0.966421902179718, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9621284604072571 / 0.9666027426719666
after epoch: 19,now: 2024-06-21 16:55:16.839370,epoch time: 0:17:04.704973,used: 5:32:01.651750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98512924, 'precision': 0.9615149, 'recall': 0.95071775, 'specificity': 0.95071775, 'f1': 0.9560353, 'auroc': 0.9909934, 'binary_precision': 0.9325738, 'binary_recall': 0.90828806, 'binary_specificity': 0.99314743, 'binary_f1_score': 0.9202708}
confusion matrix:
       0     1
0  42030   290
1    405  4011
---- Validation: 
scalar performance:
{'acc': 0.9640272, 'precision': 0.7207106, 'recall': 0.66185284, 'specificity': 0.66185284, 'f1': 0.68622863, 'auroc': 0.80760604, 'binary_precision': 0.4646681, 'binary_recall': 0.33748055, 'binary_specificity': 0.9862251, 'binary_f1_score': 0.39099097}
confusion matrix:
       0    1
0  17899  250
1    426  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.76634085, 'recall': 0.6831519, 'specificity': 0.6831519, 'f1': 0.716092, 'auroc': 0.8273517, 'binary_precision': 0.55932206, 'binary_recall': 0.37931034, 'binary_specificity': 0.9869935, 'binary_f1_score': 0.4520548}
confusion matrix:
      0   1
0  5919  78
1   162  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_20.png
early stop counter: 12
val acc:0.9640272259712219, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9621284604072571 / 0.9666027426719666
after epoch: 20,now: 2024-06-21 17:10:56.212811,epoch time: 0:15:39.373441,used: 5:47:41.025191,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9858781, 'precision': 0.9677607, 'recall': 0.9484946, 'specificity': 0.9484946, 'f1': 0.9578717, 'auroc': 0.9920963, 'binary_precision': 0.9456573, 'binary_recall': 0.9024004, 'binary_specificity': 0.99458885, 'binary_f1_score': 0.92352253}
confusion matrix:
       0     1
0  42091   229
1    431  3985
---- Validation: 
scalar performance:
{'acc': 0.9649319, 'precision': 0.7306256, 'recall': 0.6758222, 'specificity': 0.6758222, 'f1': 0.69911027, 'auroc': 0.82875335, 'binary_precision': 0.4835391, 'binary_recall': 0.36547434, 'binary_specificity': 0.98617005, 'binary_f1_score': 0.4162976}
confusion matrix:
       0    1
0  17898  251
1    408  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.8269843, 'recall': 0.6914003, 'specificity': 0.6914003, 'f1': 0.73962504, 'auroc': 0.8501339, 'binary_precision': 0.68, 'binary_recall': 0.3908046, 'binary_specificity': 0.991996, 'binary_f1_score': 0.49635038}
confusion matrix:
      0    1
0  5949   48
1   159  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_21.png
new oracle model saved
early stop counter: 13
val acc:0.9649319052696228, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9621284604072571 / 0.9669223427772522
after epoch: 21,now: 2024-06-21 17:26:31.457800,epoch time: 0:15:35.244989,used: 6:03:16.270180,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.986627, 'precision': 0.96904266, 'recall': 0.9517373, 'specificity': 0.9517373, 'f1': 0.9601846, 'auroc': 0.9931536, 'binary_precision': 0.9475673, 'binary_recall': 0.90872025, 'binary_specificity': 0.9947544, 'binary_f1_score': 0.92773736}
confusion matrix:
       0     1
0  42099   222
1    403  4012
---- Validation: 
scalar performance:
{'acc': 0.96466583, 'precision': 0.72669137, 'recall': 0.66068333, 'specificity': 0.66068333, 'f1': 0.6874281, 'auroc': 0.8052752, 'binary_precision': 0.4767184, 'binary_recall': 0.33437014, 'binary_specificity': 0.98699653, 'binary_f1_score': 0.393053}
confusion matrix:
       0    1
0  17913  236
1    428  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.80527675, 'recall': 0.6868185, 'specificity': 0.6868185, 'f1': 0.7302247, 'auroc': 0.83197415, 'binary_precision': 0.6369427, 'binary_recall': 0.38314176, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.47846892}
confusion matrix:
      0    1
0  5940   57
1   161  100
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_22.png
early stop counter: 14
val acc:0.9646658301353455, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9621284604072571 / 0.9669223427772522
after epoch: 22,now: 2024-06-21 17:41:49.651169,epoch time: 0:15:18.193369,used: 6:18:34.463549,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.986627, 'precision': 0.9708502, 'recall': 0.94981, 'specificity': 0.94981, 'f1': 0.9600267, 'auroc': 0.99246925, 'binary_precision': 0.9516206, 'binary_recall': 0.90441674, 'binary_specificity': 0.9952033, 'binary_f1_score': 0.92741835}
confusion matrix:
       0     1
0  42118   203
1    422  3993
---- Validation: 
scalar performance:
{'acc': 0.96514475, 'precision': 0.7313793, 'recall': 0.65868115, 'specificity': 0.65868115, 'f1': 0.68750685, 'auroc': 0.80337757, 'binary_precision': 0.48623854, 'binary_recall': 0.32970452, 'binary_specificity': 0.9876577, 'binary_f1_score': 0.39295647}
confusion matrix:
       0    1
0  17925  224
1    431  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.80059385, 'recall': 0.7089733, 'specificity': 0.7089733, 'f1': 0.74560213, 'auroc': 0.83531404, 'binary_precision': 0.6256983, 'binary_recall': 0.42911878, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.5090909}
confusion matrix:
      0    1
0  5930   67
1   149  112
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_23.png
early stop counter: 15
val acc:0.9651447534561157, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9621284604072571 / 0.9669223427772522
after epoch: 23,now: 2024-06-21 17:58:30.236430,epoch time: 0:16:40.585261,used: 6:35:15.048810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9875043, 'precision': 0.9746547, 'recall': 0.9511968, 'specificity': 0.9511968, 'f1': 0.96255124, 'auroc': 0.9933541, 'binary_precision': 0.95901245, 'binary_recall': 0.90643406, 'binary_specificity': 0.9959595, 'binary_f1_score': 0.9319822}
confusion matrix:
       0     1
0  42151   171
1    413  4001
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.7390601, 'recall': 0.64406574, 'specificity': 0.64406574, 'f1': 0.6785504, 'auroc': 0.8113823, 'binary_precision': 0.5026178, 'binary_recall': 0.29860032, 'binary_specificity': 0.9895311, 'binary_f1_score': 0.37463415}
confusion matrix:
       0    1
0  17959  190
1    451  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.8546749, 'recall': 0.6791576, 'specificity': 0.6791576, 'f1': 0.735343, 'auroc': 0.83416176, 'binary_precision': 0.7364341, 'binary_recall': 0.36398467, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.4871795}
confusion matrix:
      0   1
0  5963  34
1   166  95
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_24.png
new oracle model saved
early stop counter: 16
val acc:0.9658897519111633, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9621284604072571 / 0.9680408835411072
after epoch: 24,now: 2024-06-21 18:14:49.159035,epoch time: 0:16:18.922605,used: 6:51:33.971415,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98564273, 'precision': 0.966056, 'recall': 0.9488608, 'specificity': 0.9488608, 'f1': 0.95725405, 'auroc': 0.9925693, 'binary_precision': 0.9421351, 'binary_recall': 0.90351075, 'binary_specificity': 0.9942109, 'binary_f1_score': 0.9224188}
confusion matrix:
       0     1
0  42076   245
1    426  3989
---- Validation: 
scalar performance:
{'acc': 0.96376115, 'precision': 0.7201419, 'recall': 0.6752161, 'specificity': 0.6752161, 'f1': 0.69482434, 'auroc': 0.8044528, 'binary_precision': 0.4625984, 'binary_recall': 0.36547434, 'binary_specificity': 0.9849579, 'binary_f1_score': 0.40834054}
confusion matrix:
       0    1
0  17876  273
1    408  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.7948822, 'recall': 0.71055543, 'specificity': 0.71055543, 'f1': 0.74486125, 'auroc': 0.8354805, 'binary_precision': 0.61413044, 'binary_recall': 0.4329502, 'binary_specificity': 0.9881607, 'binary_f1_score': 0.50786513}
confusion matrix:
      0    1
0  5926   71
1   148  113
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_25.png
early stop counter: 17
val acc:0.9637611508369446, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9621284604072571 / 0.9680408835411072
after epoch: 25,now: 2024-06-21 18:31:17.512945,epoch time: 0:16:28.353910,used: 7:08:02.325325,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98645586, 'precision': 0.9652959, 'recall': 0.9547873, 'specificity': 0.9547873, 'f1': 0.9599656, 'auroc': 0.99341536, 'binary_precision': 0.9393587, 'binary_recall': 0.9157418, 'binary_specificity': 0.9938328, 'binary_f1_score': 0.92739993}
confusion matrix:
       0     1
0  42060   261
1    372  4043
---- Validation: 
scalar performance:
{'acc': 0.9646126, 'precision': 0.7274573, 'recall': 0.6734067, 'specificity': 0.6734067, 'f1': 0.6963708, 'auroc': 0.8096243, 'binary_precision': 0.47736627, 'binary_recall': 0.3608087, 'binary_specificity': 0.9860047, 'binary_f1_score': 0.41098318}
confusion matrix:
       0    1
0  17895  254
1    411  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.79984, 'recall': 0.69031644, 'specificity': 0.69031644, 'f1': 0.73146904, 'auroc': 0.8341677, 'binary_precision': 0.6257669, 'binary_recall': 0.3908046, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.48113203}
confusion matrix:
      0    1
0  5936   61
1   159  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_26.png
early stop counter: 18
val acc:0.964612603187561, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9621284604072571 / 0.9680408835411072
after epoch: 26,now: 2024-06-21 18:50:16.560212,epoch time: 0:18:59.047267,used: 7:27:01.372592,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9855358, 'precision': 0.9643126, 'recall': 0.95013094, 'specificity': 0.95013094, 'f1': 0.9570825, 'auroc': 0.99403197, 'binary_precision': 0.9383497, 'binary_recall': 0.90647644, 'binary_specificity': 0.99378544, 'binary_f1_score': 0.9221377}
confusion matrix:
       0     1
0  42057   263
1    413  4003
---- Validation: 
scalar performance:
{'acc': 0.96301615, 'precision': 0.71331286, 'recall': 0.6710801, 'specificity': 0.6710801, 'f1': 0.6895951, 'auroc': 0.82317144, 'binary_precision': 0.44921875, 'binary_recall': 0.3576983, 'binary_specificity': 0.98446196, 'binary_f1_score': 0.39826837}
confusion matrix:
       0    1
0  17867  282
1    413  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.803259, 'recall': 0.68673515, 'specificity': 0.68673515, 'f1': 0.72961164, 'auroc': 0.8409792, 'binary_precision': 0.6329114, 'binary_recall': 0.38314176, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.47732693}
confusion matrix:
      0    1
0  5939   58
1   161  100
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_27.png
early stop counter: 19
val acc:0.963016152381897, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9621284604072571 / 0.9680408835411072
after epoch: 27,now: 2024-06-21 19:05:57.873309,epoch time: 0:15:41.313097,used: 7:42:42.685689,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9872475, 'precision': 0.97106254, 'recall': 0.9533887, 'specificity': 0.9533887, 'f1': 0.9620122, 'auroc': 0.9940486, 'binary_precision': 0.95130026, 'binary_recall': 0.91164476, 'binary_specificity': 0.99513257, 'binary_f1_score': 0.9310504}
confusion matrix:
       0     1
0  42116   206
1    390  4024
---- Validation: 
scalar performance:
{'acc': 0.96525115, 'precision': 0.73365146, 'recall': 0.6759875, 'specificity': 0.6759875, 'f1': 0.7003061, 'auroc': 0.82159144, 'binary_precision': 0.48958334, 'binary_recall': 0.36547434, 'binary_specificity': 0.9865006, 'binary_f1_score': 0.4185218}
confusion matrix:
       0    1
0  17904  245
1    408  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.78423804, 'recall': 0.6933141, 'specificity': 0.6933141, 'f1': 0.72909504, 'auroc': 0.8418475, 'binary_precision': 0.5942857, 'binary_recall': 0.39846742, 'binary_specificity': 0.9881607, 'binary_f1_score': 0.47706422}
confusion matrix:
      0    1
0  5926   71
1   157  104
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_28.png
early stop counter: 20
val acc:0.9652511477470398, best validation acc: 0.967432975769043, corresponding to test acc:                         0.9621284604072571 / 0.9680408835411072
after epoch: 28,now: 2024-06-21 19:24:05.244297,epoch time: 0:18:07.370988,used: 8:00:50.056677,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_15_seed_0_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 28 with time: 8:00:50.056677 at 2024-06-21 19:24:05.244297
persisted model performance metric: 

scalar performance:
{'acc': 0.96212846, 'precision': 0.80466473, 'recall': 0.600947, 'specificity': 0.600947, 'f1': 0.6467855, 'auroc': 0.76541257, 'binary_precision': 0.64285713, 'binary_recall': 0.20689656, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.3130435}
confusion matrix:
      0   1
0  5967  30
1   207  54
oracle model performance metric: 

scalar performance:
{'acc': 0.9680409, 'precision': 0.8546749, 'recall': 0.6791576, 'specificity': 0.6791576, 'f1': 0.735343, 'auroc': 0.83416176, 'binary_precision': 0.7364341, 'binary_recall': 0.36398467, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.4871795}
confusion matrix:
      0   1
0  5963  34
1   166  95
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204979 KiB | 571737 KiB | 407653 GiB | 407652 GiB |
|       from large pool | 167936 KiB | 499008 KiB | 407076 GiB | 407076 GiB |
|       from small pool |  37043 KiB |  75475 KiB |    576 GiB |    576 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204979 KiB | 571737 KiB | 407653 GiB | 407652 GiB |
|       from large pool | 167936 KiB | 499008 KiB | 407076 GiB | 407076 GiB |
|       from small pool |  37043 KiB |  75475 KiB |    576 GiB |    576 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 563304 KiB | 404040 GiB | 404040 GiB |
|       from large pool | 165120 KiB | 491712 KiB | 403481 GiB | 403481 GiB |
|       from small pool |  35968 KiB |  74337 KiB |    559 GiB |    559 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 727040 KiB | 727040 KiB | 727040 KiB |      0 B   |
|       from large pool | 651264 KiB | 651264 KiB | 651264 KiB |      0 B   |
|       from small pool |  75776 KiB |  75776 KiB |  75776 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  79692 KiB | 209453 KiB | 255048 GiB | 255048 GiB |
|       from large pool |  67584 KiB | 208064 KiB | 254450 GiB | 254450 GiB |
|       from small pool |  12108 KiB |  13958 KiB |    598 GiB |    598 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3252    |    6591    |   82389 K  |   82386 K  |
|       from large pool |      36    |      76    |   27668 K  |   27668 K  |
|       from small pool |    3216    |    6554    |   54721 K  |   54717 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3252    |    6591    |   82389 K  |   82386 K  |
|       from large pool |      36    |      76    |   27668 K  |   27668 K  |
|       from small pool |    3216    |    6554    |   54721 K  |   54717 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      52    |      52    |      52    |       0    |
|       from large pool |      15    |      15    |      15    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    2938    |   36671 K  |   36671 K  |
|       from large pool |       7    |      11    |   10779 K  |   10779 K  |
|       from small pool |      30    |    2931    |   25891 K  |   25891 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 571737 KiB | 407653 GiB | 407653 GiB |
|       from large pool |  16640 KiB | 499008 KiB | 407076 GiB | 407076 GiB |
|       from small pool |      0 KiB |  75475 KiB |    576 GiB |    576 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 571737 KiB | 407653 GiB | 407653 GiB |
|       from large pool |  16640 KiB | 499008 KiB | 407076 GiB | 407076 GiB |
|       from small pool |      0 KiB |  75475 KiB |    576 GiB |    576 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB | 404040 GiB | 404040 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 403481 GiB | 403481 GiB |
|       from small pool |      0 KiB |  74337 KiB |    559 GiB |    559 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 727040 KiB | 727040 KiB | 442368 KiB |
|       from large pool | 235520 KiB | 651264 KiB | 651264 KiB | 415744 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 209453 KiB | 255048 GiB | 255048 GiB |
|       from large pool |  55040 KiB | 208064 KiB | 254450 GiB | 254450 GiB |
|       from small pool |      0 KiB |  19703 KiB |    598 GiB |    598 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6591    |   82389 K  |   82389 K  |
|       from large pool |       2    |      76    |   27668 K  |   27668 K  |
|       from small pool |       0    |    6554    |   54721 K  |   54721 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6591    |   82389 K  |   82389 K  |
|       from large pool |       2    |      76    |   27668 K  |   27668 K  |
|       from small pool |       0    |    6554    |   54721 K  |   54721 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      52    |      52    |      18    |
|       from large pool |      10    |      15    |      15    |       5    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2938    |   36672 K  |   36672 K  |
|       from large pool |       3    |      13    |   10779 K  |   10779 K  |
|       from small pool |       0    |    2931    |   25893 K  |   25893 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 571737 KiB | 407653 GiB | 407653 GiB |
|       from large pool |  16640 KiB | 499008 KiB | 407076 GiB | 407076 GiB |
|       from small pool |      0 KiB |  75475 KiB |    576 GiB |    576 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 571737 KiB | 407653 GiB | 407653 GiB |
|       from large pool |  16640 KiB | 499008 KiB | 407076 GiB | 407076 GiB |
|       from small pool |      0 KiB |  75475 KiB |    576 GiB |    576 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB | 404040 GiB | 404040 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 403481 GiB | 403481 GiB |
|       from small pool |      0 KiB |  74337 KiB |    559 GiB |    559 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 727040 KiB | 727040 KiB | 442368 KiB |
|       from large pool | 235520 KiB | 651264 KiB | 651264 KiB | 415744 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 209453 KiB | 255048 GiB | 255048 GiB |
|       from large pool |  55040 KiB | 208064 KiB | 254450 GiB | 254450 GiB |
|       from small pool |      0 KiB |  19703 KiB |    598 GiB |    598 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6591    |   82389 K  |   82389 K  |
|       from large pool |       2    |      76    |   27668 K  |   27668 K  |
|       from small pool |       0    |    6554    |   54721 K  |   54721 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6591    |   82389 K  |   82389 K  |
|       from large pool |       2    |      76    |   27668 K  |   27668 K  |
|       from small pool |       0    |    6554    |   54721 K  |   54721 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      52    |      52    |      18    |
|       from large pool |      10    |      15    |      15    |       5    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2938    |   36672 K  |   36672 K  |
|       from large pool |       3    |      13    |   10779 K  |   10779 K  |
|       from small pool |       0    |    2931    |   25893 K  |   25893 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750

 Experiment start at: 2024-06-21 19:30:53.247582
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.905576, 'precision': 0.51126814, 'recall': 0.50032353, 'specificity': 0.50032353, 'f1': 0.47814566, 'auroc': 0.8714311, 'binary_precision': 0.11504425, 'binary_recall': 0.0030050855, 'binary_specificity': 0.99764204, 'binary_f1_score': 0.005857175}
confusion matrix:
       0    1
0  42310  100
1   4313   13
---- Validation: 
scalar performance:
{'acc': 0.96302027, 'precision': 0.48202458, 'recall': 0.4994465, 'specificity': 0.4994465, 'f1': 0.49058095, 'auroc': 0.45356447, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.998893, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18047  20
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.4378729, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 19:49:21.098996,epoch time: 0:18:27.851414,used: 0:18:27.851414,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93655854, 'precision': 0.895609, 'recall': 0.68730015, 'specificity': 0.68730015, 'f1': 0.7463681, 'auroc': 0.9321097, 'binary_precision': 0.8509541, 'binary_recall': 0.3814147, 'binary_specificity': 0.9931856, 'binary_f1_score': 0.52673584}
confusion matrix:
       0     1
0  42121   289
1   2676  1650
---- Validation: 
scalar performance:
{'acc': 0.9590182, 'precision': 0.48195228, 'recall': 0.4973709, 'specificity': 0.4973709, 'f1': 0.48954022, 'auroc': 0.57319117, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  17972  95
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.47904578, 'recall': 0.49983183, 'specificity': 0.49983183, 'f1': 0.4892181, 'auroc': 0.6395652, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5944  2
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_2.png
early stop counter: 1
val acc:0.9590181708335876, best validation acc: 0.9630202651023865, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 2,now: 2024-06-21 20:05:39.708981,epoch time: 0:16:18.609985,used: 0:34:46.461399,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9593247, 'precision': 0.9279386, 'recall': 0.8150518, 'specificity': 0.8150518, 'f1': 0.8608717, 'auroc': 0.964934, 'binary_precision': 0.8917609, 'binary_recall': 0.63800275, 'binary_specificity': 0.9921009, 'binary_f1_score': 0.743835}
confusion matrix:
       0     1
0  42075   335
1   1566  2760
---- Validation: 
scalar performance:
{'acc': 0.9605656, 'precision': 0.57681787, 'recall': 0.51247877, 'specificity': 0.51247877, 'f1': 0.5156061, 'auroc': 0.6445774, 'binary_precision': 0.18867925, 'binary_recall': 0.029717682, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.05134788}
confusion matrix:
       0   1
0  17981  86
1    653  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.5902946, 'recall': 0.5032575, 'specificity': 0.5032575, 'f1': 0.4965233, 'auroc': 0.7142507, 'binary_precision': 0.22222222, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.014869888}
confusion matrix:
      0  1
0  5939  7
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_3.png
early stop counter: 2
val acc:0.9605656266212463, best validation acc: 0.9630202651023865, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 3,now: 2024-06-21 20:21:13.906424,epoch time: 0:15:34.197443,used: 0:50:20.658842,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96516603, 'precision': 0.93434894, 'recall': 0.84743667, 'specificity': 0.84743667, 'f1': 0.8848771, 'auroc': 0.9730486, 'binary_precision': 0.89831513, 'binary_recall': 0.70298404, 'binary_specificity': 0.9918893, 'binary_f1_score': 0.78873605}
confusion matrix:
       0     1
0  42069   344
1   1284  3039
---- Validation: 
scalar performance:
{'acc': 0.96334046, 'precision': 0.7125625, 'recall': 0.5532576, 'specificity': 0.5532576, 'f1': 0.58023155, 'auroc': 0.7058894, 'binary_precision': 0.45731708, 'binary_recall': 0.11144131, 'binary_specificity': 0.9950739, 'binary_f1_score': 0.17921147}
confusion matrix:
       0   1
0  17978  89
1    598  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.6745093, 'recall': 0.5250731, 'specificity': 0.5250731, 'f1': 0.53623754, 'auroc': 0.75839996, 'binary_precision': 0.3888889, 'binary_recall': 0.053846154, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.0945946}
confusion matrix:
      0   1
0  5924  22
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_4.png
better model found
persisted
after epoch: 4,now: 2024-06-21 20:36:36.341325,epoch time: 0:15:22.434901,used: 1:05:43.093743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9714781, 'precision': 0.9441061, 'recall': 0.8792484, 'specificity': 0.8792484, 'f1': 0.9084851, 'auroc': 0.97520816, 'binary_precision': 0.9116919, 'binary_recall': 0.76606566, 'binary_specificity': 0.99243104, 'binary_f1_score': 0.8325588}
confusion matrix:
       0     1
0  42089   321
1   1012  3314
---- Validation: 
scalar performance:
{'acc': 0.9630736, 'precision': 0.7071643, 'recall': 0.55598027, 'specificity': 0.55598027, 'f1': 0.5834954, 'auroc': 0.7170713, 'binary_precision': 0.4463277, 'binary_recall': 0.11738484, 'binary_specificity': 0.99457574, 'binary_f1_score': 0.18588236}
confusion matrix:
       0   1
0  17969  98
1    594  79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.74682903, 'recall': 0.5647009, 'specificity': 0.5647009, 'f1': 0.5967712, 'auroc': 0.78075045, 'binary_precision': 0.530303, 'binary_recall': 0.13461539, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.21472393}
confusion matrix:
      0   1
0  5915  31
1   225  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_5.png
new oracle model saved
early stop counter: 1
val acc:0.9630736112594604, best validation acc: 0.9633404612541199, corresponding to test acc:                         0.9568159580230713 / 0.9587495923042297
after epoch: 5,now: 2024-06-21 20:53:33.994910,epoch time: 0:16:57.653585,used: 1:22:40.747328,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97314703, 'precision': 0.95680267, 'recall': 0.8776493, 'specificity': 0.8776493, 'f1': 0.91256297, 'auroc': 0.98019195, 'binary_precision': 0.9375713, 'binary_recall': 0.7604624, 'binary_specificity': 0.9948363, 'binary_f1_score': 0.8397804}
confusion matrix:
       0     1
0  42192   219
1   1036  3289
---- Validation: 
scalar performance:
{'acc': 0.965635, 'precision': 0.7765038, 'recall': 0.57304454, 'specificity': 0.57304454, 'f1': 0.6105957, 'auroc': 0.73090434, 'binary_precision': 0.58381504, 'binary_recall': 0.15007429, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.23877066}
confusion matrix:
       0    1
0  17995   72
1    572  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.808561, 'recall': 0.56387097, 'specificity': 0.56387097, 'f1': 0.5988917, 'auroc': 0.7904247, 'binary_precision': 0.65384614, 'binary_recall': 0.13076924, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.21794872}
confusion matrix:
      0   1
0  5928  18
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-21 21:10:03.337707,epoch time: 0:16:29.342797,used: 1:39:10.090125,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97488016, 'precision': 0.95439965, 'recall': 0.8908547, 'specificity': 0.8908547, 'f1': 0.91964793, 'auroc': 0.97934544, 'binary_precision': 0.93011194, 'binary_recall': 0.78774565, 'binary_specificity': 0.99396384, 'binary_f1_score': 0.85302955}
confusion matrix:
       0     1
0  42155   256
1    918  3407
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.7512682, 'recall': 0.5819279, 'specificity': 0.5819279, 'f1': 0.61951864, 'auroc': 0.7377941, 'binary_precision': 0.53271025, 'binary_recall': 0.16939078, 'binary_specificity': 0.99446505, 'binary_f1_score': 0.25704622}
confusion matrix:
       0    1
0  17967  100
1    559  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.87061656, 'recall': 0.60442376, 'specificity': 0.60442376, 'f1': 0.6570165, 'auroc': 0.7850022, 'binary_precision': 0.7746479, 'binary_recall': 0.21153846, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.3323263}
confusion matrix:
      0   1
0  5930  16
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_7.png
new oracle model saved
early stop counter: 1
val acc:0.9648345708847046, best validation acc: 0.9656350016593933, corresponding to test acc:                         0.9606832265853882 / 0.9643893241882324
after epoch: 7,now: 2024-06-21 21:26:23.554088,epoch time: 0:16:20.216381,used: 1:55:30.306506,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9779185, 'precision': 0.9574249, 'recall': 0.9071671, 'specificity': 0.9071671, 'f1': 0.93046963, 'auroc': 0.98331285, 'binary_precision': 0.9329477, 'binary_recall': 0.82034683, 'binary_specificity': 0.9939874, 'binary_f1_score': 0.87303156}
confusion matrix:
       0     1
0  42156   255
1    777  3548
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.74487406, 'recall': 0.5996989, 'specificity': 0.5996989, 'f1': 0.63864267, 'auroc': 0.75495636, 'binary_precision': 0.51865673, 'binary_recall': 0.20653789, 'binary_specificity': 0.9928599, 'binary_f1_score': 0.2954304}
confusion matrix:
       0    1
0  17938  129
1    534  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.7930524, 'recall': 0.63843954, 'specificity': 0.63843954, 'f1': 0.6850959, 'auroc': 0.79599476, 'binary_precision': 0.6166667, 'binary_recall': 0.2846154, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.3894737}
confusion matrix:
      0   1
0  5900  46
1   186  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_8.png
early stop counter: 2
val acc:0.9646211266517639, best validation acc: 0.9656350016593933, corresponding to test acc:                         0.9606832265853882 / 0.9643893241882324
after epoch: 8,now: 2024-06-21 21:41:56.629517,epoch time: 0:15:33.075429,used: 2:11:03.381935,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98114944, 'precision': 0.96806896, 'recall': 0.9169413, 'specificity': 0.9169413, 'f1': 0.9406629, 'auroc': 0.98738205, 'binary_precision': 0.9524435, 'binary_recall': 0.83815026, 'binary_specificity': 0.99573225, 'binary_f1_score': 0.8916492}
confusion matrix:
       0     1
0  42230   181
1    700  3625
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.75874734, 'recall': 0.6173358, 'specificity': 0.6173358, 'f1': 0.6588481, 'auroc': 0.76523733, 'binary_precision': 0.5451505, 'binary_recall': 0.24219911, 'binary_specificity': 0.99247247, 'binary_f1_score': 0.33539096}
confusion matrix:
       0    1
0  17931  136
1    510  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.8361037, 'recall': 0.6509871, 'specificity': 0.6509871, 'f1': 0.70501524, 'auroc': 0.8163018, 'binary_precision': 0.7017544, 'binary_recall': 0.30769232, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.4278075}
confusion matrix:
      0   1
0  5912  34
1   180  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_9.png
new oracle model saved
early stop counter: 3
val acc:0.9655283093452454, best validation acc: 0.9656350016593933, corresponding to test acc:                         0.9606832265853882 / 0.9655172228813171
after epoch: 9,now: 2024-06-21 21:57:16.951075,epoch time: 0:15:20.321558,used: 2:26:23.703493,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9817057, 'precision': 0.96017456, 'recall': 0.92847586, 'specificity': 0.92847586, 'f1': 0.9436157, 'auroc': 0.98680985, 'binary_precision': 0.93420064, 'binary_recall': 0.86315304, 'binary_specificity': 0.9937986, 'binary_f1_score': 0.8972726}
confusion matrix:
       0     1
0  42147   263
1    592  3734
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.7367948, 'recall': 0.6344702, 'specificity': 0.6344702, 'f1': 0.6699817, 'auroc': 0.7665705, 'binary_precision': 0.5, 'binary_recall': 0.2793462, 'binary_specificity': 0.9895943, 'binary_f1_score': 0.35843658}
confusion matrix:
       0    1
0  17879  188
1    485  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.79985154, 'recall': 0.67045915, 'specificity': 0.67045915, 'f1': 0.7154051, 'auroc': 0.809101, 'binary_precision': 0.6275862, 'binary_recall': 0.35, 'binary_specificity': 0.9909183, 'binary_f1_score': 0.44938272}
confusion matrix:
      0   1
0  5892  54
1   169  91
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_10.png
early stop counter: 4
val acc:0.9640874862670898, best validation acc: 0.9656350016593933, corresponding to test acc:                         0.9606832265853882 / 0.9655172228813171
after epoch: 10,now: 2024-06-21 22:13:14.949777,epoch time: 0:15:57.998702,used: 2:42:21.702195,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98258305, 'precision': 0.9668561, 'recall': 0.927091, 'specificity': 0.927091, 'f1': 0.94586724, 'auroc': 0.9890114, 'binary_precision': 0.9479592, 'binary_recall': 0.85899216, 'binary_specificity': 0.9951898, 'binary_f1_score': 0.9012855}
confusion matrix:
       0     1
0  42206   204
1    610  3716
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.75047666, 'recall': 0.6299892, 'specificity': 0.6299892, 'f1': 0.6691818, 'auroc': 0.7918637, 'binary_precision': 0.5276968, 'binary_recall': 0.268945, 'binary_specificity': 0.9910334, 'binary_f1_score': 0.3562992}
confusion matrix:
       0    1
0  17905  162
1    492  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.8323096, 'recall': 0.66595125, 'specificity': 0.66595125, 'f1': 0.71861684, 'auroc': 0.82627296, 'binary_precision': 0.6929134, 'binary_recall': 0.33846155, 'binary_specificity': 0.993441, 'binary_f1_score': 0.4547804}
confusion matrix:
      0   1
0  5907  39
1   172  88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_11.png
new oracle model saved
early stop counter: 5
val acc:0.9651013612747192, best validation acc: 0.9656350016593933, corresponding to test acc:                         0.9606832265853882 / 0.9660006165504456
after epoch: 11,now: 2024-06-21 22:29:27.299769,epoch time: 0:16:12.349992,used: 2:58:34.052187,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98241186, 'precision': 0.97060394, 'recall': 0.9223086, 'specificity': 0.9223086, 'f1': 0.94482696, 'auroc': 0.9886266, 'binary_precision': 0.9564764, 'binary_recall': 0.8485549, 'binary_specificity': 0.99606234, 'binary_f1_score': 0.89928937}
confusion matrix:
       0     1
0  42244   167
1    655  3670
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.73786354, 'recall': 0.6237966, 'specificity': 0.6237966, 'f1': 0.66090703, 'auroc': 0.7874585, 'binary_precision': 0.502907, 'binary_recall': 0.25705793, 'binary_specificity': 0.99053526, 'binary_f1_score': 0.3402163}
confusion matrix:
       0    1
0  17896  171
1    500  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.8406986, 'recall': 0.66620356, 'specificity': 0.66620356, 'f1': 0.72052014, 'auroc': 0.8274747, 'binary_precision': 0.7096774, 'binary_recall': 0.33846155, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.4583333}
confusion matrix:
      0   1
0  5910  36
1   172  88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_12.png
new oracle model saved
early stop counter: 6
val acc:0.9641942381858826, best validation acc: 0.9656350016593933, corresponding to test acc:                         0.9606832265853882 / 0.9664840698242188
after epoch: 12,now: 2024-06-21 22:45:40.207822,epoch time: 0:16:12.908053,used: 3:14:46.960240,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98234767, 'precision': 0.96309984, 'recall': 0.92942107, 'specificity': 0.92942107, 'f1': 0.945464, 'auroc': 0.9894985, 'binary_precision': 0.93990445, 'binary_recall': 0.86447734, 'binary_specificity': 0.9943648, 'binary_f1_score': 0.9006144}
confusion matrix:
       0     1
0  42173   239
1    586  3738
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.75228584, 'recall': 0.63579434, 'specificity': 0.63579434, 'f1': 0.67474365, 'auroc': 0.80909747, 'binary_precision': 0.53089887, 'binary_recall': 0.28083208, 'binary_specificity': 0.99075663, 'binary_f1_score': 0.3673469}
confusion matrix:
       0    1
0  17900  167
1    484  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96745086, 'precision': 0.84626603, 'recall': 0.679581, 'specificity': 0.679581, 'f1': 0.7339443, 'auroc': 0.843624, 'binary_precision': 0.719697, 'binary_recall': 0.3653846, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.4846939}
confusion matrix:
      0   1
0  5909  37
1   165  95
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_13.png
new oracle model saved
early stop counter: 7
val acc:0.9652614593505859, best validation acc: 0.9656350016593933, corresponding to test acc:                         0.9606832265853882 / 0.9674508571624756
after epoch: 13,now: 2024-06-21 23:01:16.872453,epoch time: 0:15:36.664631,used: 3:30:23.624871,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98294675, 'precision': 0.958951, 'recall': 0.93777424, 'specificity': 0.93777424, 'f1': 0.948048, 'auroc': 0.99002194, 'binary_precision': 0.92984164, 'binary_recall': 0.88233936, 'binary_specificity': 0.9932091, 'binary_f1_score': 0.9054679}
confusion matrix:
       0     1
0  42122   288
1    509  3817
---- Validation: 
scalar performance:
{'acc': 0.963127, 'precision': 0.72832525, 'recall': 0.6625828, 'specificity': 0.6625828, 'f1': 0.68927014, 'auroc': 0.8044555, 'binary_precision': 0.48101267, 'binary_recall': 0.33878157, 'binary_specificity': 0.98638403, 'binary_f1_score': 0.39755884}
confusion matrix:
       0    1
0  17821  246
1    445  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.80018944, 'recall': 0.7003875, 'specificity': 0.7003875, 'f1': 0.7392038, 'auroc': 0.84019125, 'binary_precision': 0.625731, 'binary_recall': 0.41153845, 'binary_specificity': 0.9892365, 'binary_f1_score': 0.49651968}
confusion matrix:
      0    1
0  5882   64
1   153  107
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_14.png
early stop counter: 8
val acc:0.9631270170211792, best validation acc: 0.9656350016593933, corresponding to test acc:                         0.9606832265853882 / 0.9674508571624756
after epoch: 14,now: 2024-06-21 23:16:30.236140,epoch time: 0:15:13.363687,used: 3:45:36.988558,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9835031, 'precision': 0.96106386, 'recall': 0.9390149, 'specificity': 0.9390149, 'f1': 0.94969976, 'auroc': 0.9902078, 'binary_precision': 0.93385404, 'binary_recall': 0.8844198, 'binary_specificity': 0.99361, 'binary_f1_score': 0.90846497}
confusion matrix:
       0     1
0  42139   271
1    500  3826
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.74154496, 'recall': 0.637525, 'specificity': 0.637525, 'f1': 0.67371637, 'auroc': 0.80977917, 'binary_precision': 0.50928384, 'binary_recall': 0.28528973, 'binary_specificity': 0.98976034, 'binary_f1_score': 0.36571428}
confusion matrix:
       0    1
0  17882  185
1    481  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.7671056, 'recall': 0.68942666, 'specificity': 0.68942666, 'f1': 0.7208277, 'auroc': 0.8457948, 'binary_precision': 0.5604396, 'binary_recall': 0.3923077, 'binary_specificity': 0.98654556, 'binary_f1_score': 0.4615385}
confusion matrix:
      0    1
0  5866   80
1   158  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_15.png
early stop counter: 9
val acc:0.9644610285758972, best validation acc: 0.9656350016593933, corresponding to test acc:                         0.9606832265853882 / 0.9674508571624756
after epoch: 15,now: 2024-06-21 23:32:03.525091,epoch time: 0:15:33.288951,used: 4:01:10.277509,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98301095, 'precision': 0.96156573, 'recall': 0.93531865, 'specificity': 0.93531865, 'f1': 0.9479598, 'auroc': 0.98902416, 'binary_precision': 0.9356191, 'binary_recall': 0.8767915, 'binary_specificity': 0.9938458, 'binary_f1_score': 0.90525055}
confusion matrix:
       0     1
0  42149   261
1    533  3793
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.76223373, 'recall': 0.6368694, 'specificity': 0.6368694, 'f1': 0.6778916, 'auroc': 0.7972373, 'binary_precision': 0.5507246, 'binary_recall': 0.28231797, 'binary_specificity': 0.9914208, 'binary_f1_score': 0.3732809}
confusion matrix:
       0    1
0  17912  155
1    483  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.82568526, 'recall': 0.6789082, 'specificity': 0.6789082, 'f1': 0.7287587, 'auroc': 0.841236, 'binary_precision': 0.6785714, 'binary_recall': 0.3653846, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.47499996}
confusion matrix:
      0   1
0  5901  45
1   165  95
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_16.png
better model found
persisted
after epoch: 16,now: 2024-06-21 23:48:26.919004,epoch time: 0:16:23.393913,used: 4:17:33.671422,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9852362, 'precision': 0.96393764, 'recall': 0.94690084, 'specificity': 0.94690084, 'f1': 0.9552188, 'auroc': 0.9915941, 'binary_precision': 0.9380424, 'binary_recall': 0.8998612, 'binary_specificity': 0.9939404, 'binary_f1_score': 0.9185552}
confusion matrix:
       0     1
0  42155   257
1    433  3891
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.7409295, 'recall': 0.64465004, 'specificity': 0.64465004, 'f1': 0.67944896, 'auroc': 0.8204547, 'binary_precision': 0.50753766, 'binary_recall': 0.30014858, 'binary_specificity': 0.9891515, 'binary_f1_score': 0.37721753}
confusion matrix:
       0    1
0  17871  196
1    471  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.80645967, 'recall': 0.6800745, 'specificity': 0.6800745, 'f1': 0.7250645, 'auroc': 0.84494215, 'binary_precision': 0.64, 'binary_recall': 0.36923078, 'binary_specificity': 0.9909183, 'binary_f1_score': 0.4682927}
confusion matrix:
      0   1
0  5892  54
1   164  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_17.png
early stop counter: 1
val acc:0.9644076824188232, best validation acc: 0.9659551978111267, corresponding to test acc:                         0.9661617875099182 / 0.9674508571624756
after epoch: 17,now: 2024-06-22 00:06:04.033818,epoch time: 0:17:37.114814,used: 4:35:10.786236,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98564273, 'precision': 0.96468246, 'recall': 0.94869363, 'specificity': 0.94869363, 'f1': 0.95651203, 'auroc': 0.99214625, 'binary_precision': 0.9391827, 'binary_recall': 0.9033526, 'binary_specificity': 0.9940346, 'binary_f1_score': 0.92091936}
confusion matrix:
       0     1
0  42158   253
1    418  3907
---- Validation: 
scalar performance:
{'acc': 0.9635539, 'precision': 0.7320606, 'recall': 0.657082, 'specificity': 0.657082, 'f1': 0.68651086, 'auroc': 0.812353, 'binary_precision': 0.4888889, 'binary_recall': 0.3268945, 'binary_specificity': 0.9872696, 'binary_f1_score': 0.39180765}
confusion matrix:
       0    1
0  17837  230
1    453  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.81964827, 'recall': 0.676817, 'specificity': 0.676817, 'f1': 0.72554713, 'auroc': 0.83942854, 'binary_precision': 0.6666667, 'binary_recall': 0.36153847, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.46882793}
confusion matrix:
      0   1
0  5899  47
1   166  94
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_18.png
early stop counter: 2
val acc:0.9635539054870605, best validation acc: 0.9659551978111267, corresponding to test acc:                         0.9661617875099182 / 0.9674508571624756
after epoch: 18,now: 2024-06-22 00:21:39.967180,epoch time: 0:15:35.933362,used: 4:50:46.719598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9867126, 'precision': 0.9747275, 'recall': 0.9448312, 'specificity': 0.9448312, 'f1': 0.9591711, 'auroc': 0.992332, 'binary_precision': 0.9602485, 'binary_recall': 0.89343506, 'binary_specificity': 0.9962273, 'binary_f1_score': 0.92563766}
confusion matrix:
       0     1
0  42250   160
1    461  3865
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.74410945, 'recall': 0.64908004, 'specificity': 0.64908004, 'f1': 0.683857, 'auroc': 0.8102439, 'binary_precision': 0.51358026, 'binary_recall': 0.30906388, 'binary_specificity': 0.98909616, 'binary_f1_score': 0.3858998}
confusion matrix:
       0    1
0  17870  197
1    465  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96825653, 'precision': 0.8429921, 'recall': 0.70023024, 'specificity': 0.70023024, 'f1': 0.7509624, 'auroc': 0.84904456, 'binary_precision': 0.7114094, 'binary_recall': 0.4076923, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.51833737}
confusion matrix:
      0    1
0  5903   43
1   154  106
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_19.png
new oracle model saved
early stop counter: 3
val acc:0.9646744728088379, best validation acc: 0.9659551978111267, corresponding to test acc:                         0.9661617875099182 / 0.9682565331459045
after epoch: 19,now: 2024-06-22 00:36:54.599364,epoch time: 0:15:14.632184,used: 5:06:01.351782,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.984252, 'precision': 0.9573616, 'recall': 0.94803107, 'specificity': 0.94803107, 'f1': 0.95263565, 'auroc': 0.9914316, 'binary_precision': 0.9245328, 'binary_recall': 0.9035838, 'binary_specificity': 0.9924784, 'binary_f1_score': 0.9139382}
confusion matrix:
       0     1
0  42092   319
1    417  3908
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.7378231, 'recall': 0.6459422, 'specificity': 0.6459422, 'f1': 0.6796581, 'auroc': 0.80596143, 'binary_precision': 0.5012285, 'binary_recall': 0.30312034, 'binary_specificity': 0.98876405, 'binary_f1_score': 0.37777776}
confusion matrix:
       0    1
0  17864  203
1    469  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.793484, 'recall': 0.67020684, 'specificity': 0.67020684, 'f1': 0.71362567, 'auroc': 0.8348607, 'binary_precision': 0.6148649, 'binary_recall': 0.35, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.44607845}
confusion matrix:
      0   1
0  5889  57
1   169  91
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_20.png
early stop counter: 4
val acc:0.9641408920288086, best validation acc: 0.9659551978111267, corresponding to test acc:                         0.9661617875099182 / 0.9682565331459045
after epoch: 20,now: 2024-06-22 00:52:11.015750,epoch time: 0:15:16.416386,used: 5:21:17.768168,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9860279, 'precision': 0.96011865, 'recall': 0.9563898, 'specificity': 0.9563898, 'f1': 0.9582447, 'auroc': 0.9926934, 'binary_precision': 0.9283882, 'binary_recall': 0.9200185, 'binary_specificity': 0.99276114, 'binary_f1_score': 0.92418444}
confusion matrix:
       0     1
0  42103   307
1    346  3980
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.7366212, 'recall': 0.6722964, 'specificity': 0.6722964, 'f1': 0.69881177, 'auroc': 0.8170053, 'binary_precision': 0.4969072, 'binary_recall': 0.35809806, 'binary_specificity': 0.9864947, 'binary_f1_score': 0.41623488}
confusion matrix:
       0    1
0  17823  244
1    432  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.8076904, 'recall': 0.6913607, 'specificity': 0.6913607, 'f1': 0.73447317, 'auroc': 0.8376355, 'binary_precision': 0.6415094, 'binary_recall': 0.3923077, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.48687354}
confusion matrix:
      0    1
0  5889   57
1   158  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_21.png
early stop counter: 5
val acc:0.9639274477958679, best validation acc: 0.9659551978111267, corresponding to test acc:                         0.9661617875099182 / 0.9682565331459045
after epoch: 21,now: 2024-06-22 01:07:51.262245,epoch time: 0:15:40.246495,used: 5:36:58.014663,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9863061, 'precision': 0.9707587, 'recall': 0.94635975, 'specificity': 0.94635975, 'f1': 0.9581522, 'auroc': 0.9936766, 'binary_precision': 0.95192546, 'binary_recall': 0.897341, 'binary_specificity': 0.99537855, 'binary_f1_score': 0.9238276}
confusion matrix:
       0     1
0  42215   196
1    444  3881
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.77435875, 'recall': 0.638715, 'specificity': 0.638715, 'f1': 0.68212473, 'auroc': 0.8219255, 'binary_precision': 0.5748503, 'binary_recall': 0.28528973, 'binary_specificity': 0.99214035, 'binary_f1_score': 0.38133067}
confusion matrix:
       0    1
0  17925  142
1    481  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.8288653, 'recall': 0.6413717, 'specificity': 0.6413717, 'f1': 0.6941596, 'auroc': 0.83684504, 'binary_precision': 0.6880734, 'binary_recall': 0.28846154, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.40650403}
confusion matrix:
      0   1
0  5912  34
1   185  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_22.png
better model found
persisted
after epoch: 22,now: 2024-06-22 01:23:58.692148,epoch time: 0:16:07.429903,used: 5:53:05.444566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98679817, 'precision': 0.9749993, 'recall': 0.9450859, 'specificity': 0.9450859, 'f1': 0.95943415, 'auroc': 0.99195945, 'binary_precision': 0.96074533, 'binary_recall': 0.89389735, 'binary_specificity': 0.9962745, 'binary_f1_score': 0.9261167}
confusion matrix:
       0     1
0  42252   158
1    459  3867
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.74841726, 'recall': 0.63923234, 'specificity': 0.63923234, 'f1': 0.67682165, 'auroc': 0.80555797, 'binary_precision': 0.5229111, 'binary_recall': 0.2882615, 'binary_specificity': 0.99020314, 'binary_f1_score': 0.37164748}
confusion matrix:
       0    1
0  17890  177
1    479  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9666452, 'precision': 0.8373178, 'recall': 0.6736436, 'specificity': 0.6736436, 'f1': 0.72668415, 'auroc': 0.8435977, 'binary_precision': 0.70229006, 'binary_recall': 0.35384616, 'binary_specificity': 0.993441, 'binary_f1_score': 0.47058824}
confusion matrix:
      0   1
0  5907  39
1   168  92
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_23.png
early stop counter: 1
val acc:0.9649946689605713, best validation acc: 0.9667556285858154, corresponding to test acc:                         0.9647115468978882 / 0.9682565331459045
after epoch: 23,now: 2024-06-22 01:40:27.686973,epoch time: 0:16:28.994825,used: 6:09:34.439391,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9861135, 'precision': 0.96261644, 'recall': 0.9540498, 'specificity': 0.9540498, 'f1': 0.9582827, 'auroc': 0.9920459, 'binary_precision': 0.9339155, 'binary_recall': 0.9147018, 'binary_specificity': 0.9933978, 'binary_f1_score': 0.9242088}
confusion matrix:
       0     1
0  42130   280
1    369  3957
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.7357956, 'recall': 0.6658313, 'specificity': 0.6658313, 'f1': 0.6940154, 'auroc': 0.8234643, 'binary_precision': 0.4957265, 'binary_recall': 0.3447251, 'binary_specificity': 0.9869375, 'binary_f1_score': 0.4066608}
confusion matrix:
       0    1
0  17831  236
1    441  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.78537434, 'recall': 0.68291163, 'specificity': 0.68291163, 'f1': 0.7216226, 'auroc': 0.8402973, 'binary_precision': 0.597561, 'binary_recall': 0.37692308, 'binary_specificity': 0.9889001, 'binary_f1_score': 0.46226418}
confusion matrix:
      0   1
0  5880  66
1   162  98
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_24.png
early stop counter: 2
val acc:0.9638740420341492, best validation acc: 0.9667556285858154, corresponding to test acc:                         0.9647115468978882 / 0.9682565331459045
after epoch: 24,now: 2024-06-22 01:56:38.248806,epoch time: 0:16:10.561833,used: 6:25:45.001224,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98637027, 'precision': 0.96458876, 'recall': 0.95346475, 'specificity': 0.95346475, 'f1': 0.95894194, 'auroc': 0.99325454, 'binary_precision': 0.93801945, 'binary_recall': 0.9130837, 'binary_specificity': 0.9938458, 'binary_f1_score': 0.9253836}
confusion matrix:
       0     1
0  42149   261
1    376  3950
---- Validation: 
scalar performance:
{'acc': 0.96350056, 'precision': 0.73292124, 'recall': 0.6770819, 'specificity': 0.6770819, 'f1': 0.70074797, 'auroc': 0.8203217, 'binary_precision': 0.48915187, 'binary_recall': 0.36849925, 'binary_specificity': 0.9856645, 'binary_f1_score': 0.42033896}
confusion matrix:
       0    1
0  17808  259
1    425  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.7935466, 'recall': 0.69261104, 'specificity': 0.69261104, 'f1': 0.73139185, 'auroc': 0.84784096, 'binary_precision': 0.6130952, 'binary_recall': 0.39615384, 'binary_specificity': 0.98906827, 'binary_f1_score': 0.4813084}
confusion matrix:
      0    1
0  5881   65
1   157  103
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_25.png
early stop counter: 3
val acc:0.9635005593299866, best validation acc: 0.9667556285858154, corresponding to test acc:                         0.9647115468978882 / 0.9682565331459045
after epoch: 25,now: 2024-06-22 02:13:08.954341,epoch time: 0:16:30.705535,used: 6:42:15.706759,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98656285, 'precision': 0.97420037, 'recall': 0.94443727, 'specificity': 0.94443727, 'f1': 0.9587153, 'auroc': 0.99274755, 'binary_precision': 0.95926476, 'binary_recall': 0.89274156, 'binary_specificity': 0.99613297, 'binary_f1_score': 0.92480844}
confusion matrix:
       0     1
0  42246   164
1    464  3862
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.76857567, 'recall': 0.630598, 'specificity': 0.630598, 'f1': 0.67343175, 'auroc': 0.8075354, 'binary_precision': 0.5638629, 'binary_recall': 0.268945, 'binary_specificity': 0.99225104, 'binary_f1_score': 0.36418512}
confusion matrix:
       0    1
0  17927  140
1    492  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.84322655, 'recall': 0.6568404, 'specificity': 0.6568404, 'f1': 0.7120209, 'auroc': 0.8443278, 'binary_precision': 0.7155172, 'binary_recall': 0.31923077, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.44148937}
confusion matrix:
      0   1
0  5913  33
1   177  83
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_26.png
early stop counter: 4
val acc:0.9662753343582153, best validation acc: 0.9667556285858154, corresponding to test acc:                         0.9647115468978882 / 0.9682565331459045
after epoch: 26,now: 2024-06-22 02:29:53.126784,epoch time: 0:16:44.172443,used: 6:58:59.879202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98686236, 'precision': 0.9718126, 'recall': 0.94875395, 'specificity': 0.94875395, 'f1': 0.95992106, 'auroc': 0.99222314, 'binary_precision': 0.9535679, 'binary_recall': 0.90198797, 'binary_specificity': 0.99551994, 'binary_f1_score': 0.927061}
confusion matrix:
       0     1
0  42220   190
1    424  3902
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.74882704, 'recall': 0.64498216, 'specificity': 0.64498216, 'f1': 0.6817539, 'auroc': 0.8276434, 'binary_precision': 0.5233161, 'binary_recall': 0.30014858, 'binary_specificity': 0.9898157, 'binary_f1_score': 0.38149196}
confusion matrix:
       0    1
0  17883  184
1    471  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668063, 'precision': 0.8385256, 'recall': 0.6755667, 'specificity': 0.6755667, 'f1': 0.72867584, 'auroc': 0.85287637, 'binary_precision': 0.70454544, 'binary_recall': 0.3576923, 'binary_specificity': 0.993441, 'binary_f1_score': 0.47448975}
confusion matrix:
      0   1
0  5907  39
1   167  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_27.png
early stop counter: 5
val acc:0.9650480151176453, best validation acc: 0.9667556285858154, corresponding to test acc:                         0.9647115468978882 / 0.9682565331459045
after epoch: 27,now: 2024-06-22 02:46:13.850632,epoch time: 0:16:20.723848,used: 7:15:20.603050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98718333, 'precision': 0.97705495, 'recall': 0.9454019, 'specificity': 0.9454019, 'f1': 0.9605493, 'auroc': 0.9920429, 'binary_precision': 0.96482915, 'binary_recall': 0.8941285, 'binary_specificity': 0.9966753, 'binary_f1_score': 0.9281343}
confusion matrix:
       0     1
0  42269   141
1    458  3868
---- Validation: 
scalar performance:
{'acc': 0.96600854, 'precision': 0.7677922, 'recall': 0.61543906, 'specificity': 0.61543906, 'f1': 0.6584686, 'auroc': 0.81090826, 'binary_precision': 0.5633803, 'binary_recall': 0.23774146, 'binary_specificity': 0.99313664, 'binary_f1_score': 0.33437824}
confusion matrix:
       0    1
0  17943  124
1    513  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96761197, 'precision': 0.8812976, 'recall': 0.65208024, 'specificity': 0.65208024, 'f1': 0.7132671, 'auroc': 0.84364134, 'binary_precision': 0.7920792, 'binary_recall': 0.30769232, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.4432133}
confusion matrix:
      0   1
0  5925  21
1   180  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_28.png
early stop counter: 6
val acc:0.9660085439682007, best validation acc: 0.9667556285858154, corresponding to test acc:                         0.9647115468978882 / 0.9682565331459045
after epoch: 28,now: 2024-06-22 03:02:46.019234,epoch time: 0:16:32.168602,used: 7:31:52.771652,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9882104, 'precision': 0.97387505, 'recall': 0.95498776, 'specificity': 0.95498776, 'f1': 0.9641905, 'auroc': 0.9938847, 'binary_precision': 0.9564586, 'binary_recall': 0.9142197, 'binary_specificity': 0.9957558, 'binary_f1_score': 0.9348623}
confusion matrix:
       0     1
0  42231   180
1    371  3954
---- Validation: 
scalar performance:
{'acc': 0.9653148, 'precision': 0.752542, 'recall': 0.64154416, 'specificity': 0.64154416, 'f1': 0.67977756, 'auroc': 0.81420505, 'binary_precision': 0.5309973, 'binary_recall': 0.29271916, 'binary_specificity': 0.9903692, 'binary_f1_score': 0.37739462}
confusion matrix:
       0    1
0  17893  174
1    476  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.8294496, 'recall': 0.6733913, 'specificity': 0.6733913, 'f1': 0.72476566, 'auroc': 0.8445885, 'binary_precision': 0.6865672, 'binary_recall': 0.35384616, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.46700507}
confusion matrix:
      0   1
0  5904  42
1   168  92
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_29.png
early stop counter: 7
val acc:0.9653148055076599, best validation acc: 0.9667556285858154, corresponding to test acc:                         0.9647115468978882 / 0.9682565331459045
after epoch: 29,now: 2024-06-22 03:19:24.573724,epoch time: 0:16:38.554490,used: 7:48:31.326142,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98639166, 'precision': 0.96305054, 'recall': 0.95534474, 'specificity': 0.95534474, 'f1': 0.9591569, 'auroc': 0.99323124, 'binary_precision': 0.9345266, 'binary_recall': 0.91724455, 'binary_specificity': 0.9934449, 'binary_f1_score': 0.925805}
confusion matrix:
       0     1
0  42132   278
1    358  3968
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.7489251, 'recall': 0.675794, 'specificity': 0.675794, 'f1': 0.7053629, 'auroc': 0.8209589, 'binary_precision': 0.5212766, 'binary_recall': 0.3640416, 'binary_specificity': 0.9875464, 'binary_f1_score': 0.42869642}
confusion matrix:
       0    1
0  17842  225
1    428  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.81106985, 'recall': 0.6708796, 'specificity': 0.6708796, 'f1': 0.71842575, 'auroc': 0.84609044, 'binary_precision': 0.65, 'binary_recall': 0.35, 'binary_specificity': 0.9917592, 'binary_f1_score': 0.45499998}
confusion matrix:
      0   1
0  5897  49
1   169  91
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_30.png
early stop counter: 8
val acc:0.965154767036438, best validation acc: 0.9667556285858154, corresponding to test acc:                         0.9647115468978882 / 0.9682565331459045
after epoch: 30,now: 2024-06-22 03:35:57.910607,epoch time: 0:16:33.336883,used: 8:05:04.663025,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_30_53_seed_1_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:05:04.663025 at 2024-06-22 03:35:57.910607
persisted model performance metric: 

scalar performance:
{'acc': 0.96471155, 'precision': 0.8288653, 'recall': 0.6413717, 'specificity': 0.6413717, 'f1': 0.6941596, 'auroc': 0.83684504, 'binary_precision': 0.6880734, 'binary_recall': 0.28846154, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.40650403}
confusion matrix:
      0   1
0  5912  34
1   185  75
oracle model performance metric: 

scalar performance:
{'acc': 0.96825653, 'precision': 0.8429921, 'recall': 0.70023024, 'specificity': 0.70023024, 'f1': 0.7509624, 'auroc': 0.84904456, 'binary_precision': 0.7114094, 'binary_recall': 0.4076923, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.51833737}
confusion matrix:
      0    1
0  5903   43
1   154  106
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204071 KiB | 571737 KiB |    826 TiB |    826 TiB |
|       from large pool | 167040 KiB | 499008 KiB |    825 TiB |    825 TiB |
|       from small pool |  37031 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204071 KiB | 571737 KiB |    826 TiB |    826 TiB |
|       from large pool | 167040 KiB | 499008 KiB |    825 TiB |    825 TiB |
|       from small pool |  37031 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 563304 KiB |    816 TiB |    816 TiB |
|       from large pool | 165120 KiB | 491712 KiB |    815 TiB |    815 TiB |
|       from small pool |  35966 KiB |  74337 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 778240 KiB | 778240 KiB |   1192 MiB | 442368 KiB |
|       from large pool | 702464 KiB | 702464 KiB |   1092 MiB | 415744 KiB |
|       from small pool |  75776 KiB |  75776 KiB |    100 MiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  80600 KiB | 209453 KiB | 532163 GiB | 532163 GiB |
|       from large pool |  68480 KiB | 208064 KiB | 530923 GiB | 530922 GiB |
|       from small pool |  12120 KiB |  19703 KiB |   1240 GiB |   1240 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3228    |    6591    |  170517 K  |  170514 K  |
|       from large pool |      36    |      76    |   57261 K  |   57261 K  |
|       from small pool |    3192    |    6554    |  113256 K  |  113253 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3228    |    6591    |  170517 K  |  170514 K  |
|       from large pool |      36    |      76    |   57261 K  |   57261 K  |
|       from small pool |    3192    |    6554    |  113256 K  |  113253 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |      53    |      71    |      18    |
|       from large pool |      16    |      16    |      21    |       5    |
|       from small pool |      37    |      37    |      50    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    2938    |   76805 K  |   76805 K  |
|       from large pool |       5    |      13    |   23240 K  |   23240 K  |
|       from small pool |      32    |    2931    |   53565 K  |   53565 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 571737 KiB |    826 TiB |    826 TiB |
|       from large pool |  16640 KiB | 499008 KiB |    825 TiB |    825 TiB |
|       from small pool |      0 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 571737 KiB |    826 TiB |    826 TiB |
|       from large pool |  16640 KiB | 499008 KiB |    825 TiB |    825 TiB |
|       from small pool |      0 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB |    816 TiB |    816 TiB |
|       from large pool |  16640 KiB | 491712 KiB |    815 TiB |    815 TiB |
|       from small pool |      0 KiB |  74337 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 778240 KiB |   1192 MiB |    914 MiB |
|       from large pool | 235520 KiB | 702464 KiB |   1092 MiB |    862 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 209453 KiB | 532164 GiB | 532163 GiB |
|       from large pool |  55040 KiB | 208064 KiB | 530923 GiB | 530923 GiB |
|       from small pool |      0 KiB |  19715 KiB |   1240 GiB |   1240 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6591    |  170517 K  |  170517 K  |
|       from large pool |       2    |      76    |   57261 K  |   57261 K  |
|       from small pool |       0    |    6554    |  113256 K  |  113256 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6591    |  170517 K  |  170517 K  |
|       from large pool |       2    |      76    |   57261 K  |   57261 K  |
|       from small pool |       0    |    6554    |  113256 K  |  113256 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      53    |      71    |      37    |
|       from large pool |      10    |      16    |      21    |      11    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2938    |   76806 K  |   76806 K  |
|       from large pool |       3    |      13    |   23240 K  |   23240 K  |
|       from small pool |       0    |    2931    |   53566 K  |   53566 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 571737 KiB |    826 TiB |    826 TiB |
|       from large pool |  16640 KiB | 499008 KiB |    825 TiB |    825 TiB |
|       from small pool |      0 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 571737 KiB |    826 TiB |    826 TiB |
|       from large pool |  16640 KiB | 499008 KiB |    825 TiB |    825 TiB |
|       from small pool |      0 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB |    816 TiB |    816 TiB |
|       from large pool |  16640 KiB | 491712 KiB |    815 TiB |    815 TiB |
|       from small pool |      0 KiB |  74337 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 778240 KiB |   1192 MiB |    914 MiB |
|       from large pool | 235520 KiB | 702464 KiB |   1092 MiB |    862 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 209453 KiB | 532164 GiB | 532163 GiB |
|       from large pool |  55040 KiB | 208064 KiB | 530923 GiB | 530923 GiB |
|       from small pool |      0 KiB |  19715 KiB |   1240 GiB |   1240 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6591    |  170517 K  |  170517 K  |
|       from large pool |       2    |      76    |   57261 K  |   57261 K  |
|       from small pool |       0    |    6554    |  113256 K  |  113256 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6591    |  170517 K  |  170517 K  |
|       from large pool |       2    |      76    |   57261 K  |   57261 K  |
|       from small pool |       0    |    6554    |  113256 K  |  113256 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      53    |      71    |      37    |
|       from large pool |      10    |      16    |      21    |      11    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2938    |   76806 K  |   76806 K  |
|       from large pool |       3    |      13    |   23240 K  |   23240 K  |
|       from small pool |       0    |    2931    |   53566 K  |   53566 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750

 Experiment start at: 2024-06-22 03:42:02.604752
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.904457, 'precision': 0.9521642, 'recall': 0.5069398, 'specificity': 0.5069398, 'f1': 0.48857012, 'auroc': 0.8836931, 'binary_precision': 1.0, 'binary_recall': 0.013879709, 'binary_specificity': 1.0, 'binary_f1_score': 0.027379401}
confusion matrix:
       0   1
0  42309   0
1   4476  63
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.49455875, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.5657424, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 03:58:49.696525,epoch time: 0:16:47.091773,used: 0:16:47.091773,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93893015, 'precision': 0.96052796, 'recall': 0.68759596, 'specificity': 0.68759596, 'f1': 0.75559616, 'auroc': 0.9373095, 'binary_precision': 0.9838524, 'binary_recall': 0.37585372, 'binary_specificity': 0.9993382, 'binary_f1_score': 0.5439184}
confusion matrix:
       0     1
0  42281    28
1   2833  1706
---- Validation: 
scalar performance:
{'acc': 0.96708035, 'precision': 0.48395267, 'recall': 0.49955973, 'specificity': 0.49955973, 'f1': 0.49163237, 'auroc': 0.563766, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99911946, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18155  16
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.48059654, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.4899861, 'auroc': 0.6216502, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_2.png
early stop counter: 1
val acc:0.9670803546905518, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-22 04:14:29.049273,epoch time: 0:15:39.352748,used: 0:32:26.444521,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96177, 'precision': 0.95275855, 'recall': 0.82031244, 'specificity': 0.82031244, 'f1': 0.872458, 'auroc': 0.96242106, 'binary_precision': 0.9423696, 'binary_recall': 0.6448557, 'binary_specificity': 0.9957692, 'binary_f1_score': 0.76572925}
confusion matrix:
       0     1
0  42130   179
1   1612  2927
---- Validation: 
scalar performance:
{'acc': 0.96606827, 'precision': 0.6340127, 'recall': 0.5199162, 'specificity': 0.5199162, 'f1': 0.52909434, 'auroc': 0.6689608, 'binary_precision': 0.29885057, 'binary_recall': 0.04318937, 'binary_specificity': 0.996643, 'binary_f1_score': 0.07547169}
confusion matrix:
       0   1
0  18110  61
1    576  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9586472, 'precision': 0.6447163, 'recall': 0.5284071, 'specificity': 0.5284071, 'f1': 0.54150087, 'auroc': 0.73234344, 'binary_precision': 0.32608697, 'binary_recall': 0.06198347, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.10416667}
confusion matrix:
      0   1
0  5966  31
1   227  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_3.png
early stop counter: 2
val acc:0.9660682678222656, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 3,now: 2024-06-22 04:29:45.916703,epoch time: 0:15:16.867430,used: 0:47:43.311951,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9678108, 'precision': 0.9580587, 'recall': 0.8516834, 'specificity': 0.8516834, 'f1': 0.89615047, 'auroc': 0.97664344, 'binary_precision': 0.94665486, 'binary_recall': 0.7076449, 'binary_specificity': 0.99572194, 'binary_f1_score': 0.809884}
confusion matrix:
       0     1
0  42128   181
1   1327  3212
---- Validation: 
scalar performance:
{'acc': 0.96761304, 'precision': 0.72377336, 'recall': 0.54882085, 'specificity': 0.54882085, 'f1': 0.5753044, 'auroc': 0.7222408, 'binary_precision': 0.4765625, 'binary_recall': 0.1013289, 'binary_specificity': 0.9963128, 'binary_f1_score': 0.16712329}
confusion matrix:
       0   1
0  18104  67
1    541  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.7372427, 'recall': 0.5556001, 'specificity': 0.5556001, 'f1': 0.5843836, 'auroc': 0.7595988, 'binary_precision': 0.5090909, 'binary_recall': 0.11570248, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.18855219}
confusion matrix:
      0   1
0  5970  27
1   214  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_4.png
new oracle model saved
early stop counter: 3
val acc:0.9676130414009094, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9613720178604126
after epoch: 4,now: 2024-06-22 04:45:01.363055,epoch time: 0:15:15.446352,used: 1:02:58.758303,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97018015, 'precision': 0.95523566, 'recall': 0.8681109, 'specificity': 0.8681109, 'f1': 0.9058889, 'auroc': 0.9781281, 'binary_precision': 0.9375871, 'binary_recall': 0.7415161, 'binary_specificity': 0.99470574, 'binary_f1_score': 0.8281039}
confusion matrix:
       0     1
0  42086   224
1   1173  3365
---- Validation: 
scalar performance:
{'acc': 0.96708035, 'precision': 0.71323824, 'recall': 0.5638036, 'specificity': 0.5638036, 'f1': 0.5944237, 'auroc': 0.74063134, 'binary_precision': 0.45454547, 'binary_recall': 0.13289036, 'binary_specificity': 0.9947169, 'binary_f1_score': 0.20565552}
confusion matrix:
       0   1
0  18075  96
1    522  80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.7583922, 'recall': 0.58989036, 'specificity': 0.58989036, 'f1': 0.62926245, 'auroc': 0.7764729, 'binary_precision': 0.5487805, 'binary_recall': 0.18595041, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.2777778}
confusion matrix:
      0   1
0  5960  37
1   197  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_5.png
new oracle model saved
early stop counter: 4
val acc:0.9670803546905518, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9624940156936646
after epoch: 5,now: 2024-06-22 05:00:19.611503,epoch time: 0:15:18.248448,used: 1:18:17.006751,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9748762, 'precision': 0.95346415, 'recall': 0.89827406, 'specificity': 0.89827406, 'f1': 0.9236062, 'auroc': 0.982213, 'binary_precision': 0.9277354, 'binary_recall': 0.8032606, 'binary_specificity': 0.9932875, 'binary_f1_score': 0.8610226}
confusion matrix:
       0     1
0  42025   284
1    893  3646
---- Validation: 
scalar performance:
{'acc': 0.96585524, 'precision': 0.711535, 'recall': 0.6306268, 'specificity': 0.6306268, 'f1': 0.6604843, 'auroc': 0.7727357, 'binary_precision': 0.44686648, 'binary_recall': 0.27242523, 'binary_specificity': 0.98882836, 'binary_f1_score': 0.3384933}
confusion matrix:
       0    1
0  17968  203
1    438  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.76735336, 'recall': 0.6660682, 'specificity': 0.6660682, 'f1': 0.7035551, 'auroc': 0.7924864, 'binary_precision': 0.5608108, 'binary_recall': 0.3429752, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.42564103}
confusion matrix:
      0   1
0  5932  65
1   159  83
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_6.png
new oracle model saved
early stop counter: 5
val acc:0.9658552408218384, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9640967845916748
after epoch: 6,now: 2024-06-22 05:16:33.064461,epoch time: 0:16:13.452958,used: 1:34:30.459709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.975666, 'precision': 0.9639339, 'recall': 0.8929846, 'specificity': 0.8929846, 'f1': 0.9247651, 'auroc': 0.98286986, 'binary_precision': 0.94994706, 'binary_recall': 0.7904363, 'binary_specificity': 0.995533, 'binary_f1_score': 0.8628819}
confusion matrix:
       0     1
0  42121   189
1    951  3587
---- Validation: 
scalar performance:
{'acc': 0.9685186, 'precision': 0.74870956, 'recall': 0.5998807, 'specificity': 0.5998807, 'f1': 0.63974476, 'auroc': 0.7611325, 'binary_precision': 0.5232068, 'binary_recall': 0.20598006, 'binary_specificity': 0.9937813, 'binary_f1_score': 0.29558998}
confusion matrix:
       0    1
0  18058  113
1    478  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.8144697, 'recall': 0.63956046, 'specificity': 0.63956046, 'f1': 0.69023293, 'auroc': 0.78892064, 'binary_precision': 0.6571429, 'binary_recall': 0.28512397, 'binary_specificity': 0.993997, 'binary_f1_score': 0.39769453}
confusion matrix:
      0   1
0  5961  36
1   173  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-22 05:36:07.081615,epoch time: 0:19:34.017154,used: 1:54:04.476863,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9794655, 'precision': 0.9660702, 'recall': 0.9135989, 'specificity': 0.9135989, 'f1': 0.9378581, 'auroc': 0.9848668, 'binary_precision': 0.9499371, 'binary_recall': 0.8319013, 'binary_specificity': 0.99529654, 'binary_f1_score': 0.8870097}
confusion matrix:
       0     1
0  42110   199
1    763  3776
---- Validation: 
scalar performance:
{'acc': 0.9668673, 'precision': 0.7229631, 'recall': 0.6255283, 'specificity': 0.6255283, 'f1': 0.6592401, 'auroc': 0.7791756, 'binary_precision': 0.47005987, 'binary_recall': 0.26079735, 'binary_specificity': 0.99025923, 'binary_f1_score': 0.33547008}
confusion matrix:
       0    1
0  17994  177
1    445  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685847, 'precision': 0.83134747, 'recall': 0.6703855, 'specificity': 0.6703855, 'f1': 0.72267944, 'auroc': 0.7981001, 'binary_precision': 0.6885246, 'binary_recall': 0.34710744, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.46153846}
confusion matrix:
      0   1
0  5959  38
1   158  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_8.png
new oracle model saved
early stop counter: 1
val acc:0.9668673276901245, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9665010571479797 / 0.9685847163200378
after epoch: 8,now: 2024-06-22 05:59:19.969249,epoch time: 0:23:12.887634,used: 2:17:17.364497,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98008454, 'precision': 0.9713615, 'recall': 0.91226983, 'specificity': 0.91226983, 'f1': 0.939327, 'auroc': 0.9840264, 'binary_precision': 0.9608896, 'binary_recall': 0.828156, 'binary_specificity': 0.9963837, 'binary_f1_score': 0.8895989}
confusion matrix:
       0     1
0  42156   153
1    780  3759
---- Validation: 
scalar performance:
{'acc': 0.96644115, 'precision': 0.715606, 'recall': 0.6156716, 'specificity': 0.6156716, 'f1': 0.6490083, 'auroc': 0.7551925, 'binary_precision': 0.45597485, 'binary_recall': 0.24086379, 'binary_specificity': 0.99047935, 'binary_f1_score': 0.31521738}
confusion matrix:
       0    1
0  17998  173
1    457  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.79363656, 'recall': 0.6631032, 'specificity': 0.6631032, 'f1': 0.7078201, 'auroc': 0.7771394, 'binary_precision': 0.6136364, 'binary_recall': 0.33471075, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.4331551}
confusion matrix:
      0   1
0  5946  51
1   161  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_9.png
early stop counter: 2
val acc:0.9664411544799805, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9665010571479797 / 0.9685847163200378
after epoch: 9,now: 2024-06-22 06:19:43.651534,epoch time: 0:20:23.682285,used: 2:37:41.046782,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9831156, 'precision': 0.97064507, 'recall': 0.9308622, 'specificity': 0.9308622, 'f1': 0.94964266, 'auroc': 0.98898804, 'binary_precision': 0.95551777, 'binary_recall': 0.86604977, 'binary_specificity': 0.99567467, 'binary_f1_score': 0.90858656}
confusion matrix:
       0     1
0  42126   183
1    608  3931
---- Validation: 
scalar performance:
{'acc': 0.9665477, 'precision': 0.7224563, 'recall': 0.6494546, 'specificity': 0.6494546, 'f1': 0.67803437, 'auroc': 0.7927233, 'binary_precision': 0.4675, 'binary_recall': 0.31063122, 'binary_specificity': 0.98827803, 'binary_f1_score': 0.3732535}
confusion matrix:
       0    1
0  17958  213
1    415  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.80493414, 'recall': 0.68566376, 'specificity': 0.68566376, 'f1': 0.72933143, 'auroc': 0.7994127, 'binary_precision': 0.63448274, 'binary_recall': 0.38016528, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.4754522}
confusion matrix:
      0   1
0  5944  53
1   150  92
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_10.png
early stop counter: 3
val acc:0.9665477275848389, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9665010571479797 / 0.9685847163200378
after epoch: 10,now: 2024-06-22 06:46:32.865905,epoch time: 0:26:49.214371,used: 3:04:30.261153,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9826887, 'precision': 0.968624, 'recall': 0.9303309, 'specificity': 0.9303309, 'f1': 0.94844437, 'auroc': 0.9890269, 'binary_precision': 0.95155036, 'binary_recall': 0.8653889, 'binary_specificity': 0.9952729, 'binary_f1_score': 0.90642667}
confusion matrix:
       0     1
0  42109   200
1    611  3928
---- Validation: 
scalar performance:
{'acc': 0.96729344, 'precision': 0.7288179, 'recall': 0.62655145, 'specificity': 0.62655145, 'f1': 0.66150814, 'auroc': 0.77819854, 'binary_precision': 0.4817073, 'binary_recall': 0.26245847, 'binary_specificity': 0.99064445, 'binary_f1_score': 0.33978492}
confusion matrix:
       0    1
0  18001  170
1    444  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.80108595, 'recall': 0.6734338, 'specificity': 0.6734338, 'f1': 0.7183585, 'auroc': 0.80397975, 'binary_precision': 0.6277372, 'binary_recall': 0.3553719, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.45382583}
confusion matrix:
      0   1
0  5946  51
1   156  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_11.png
early stop counter: 4
val acc:0.9672934412956238, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9665010571479797 / 0.9685847163200378
after epoch: 11,now: 2024-06-22 07:18:04.720069,epoch time: 0:31:31.854164,used: 3:36:02.115317,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98290217, 'precision': 0.96638644, 'recall': 0.9338909, 'specificity': 0.9338909, 'f1': 0.94939446, 'auroc': 0.98947644, 'binary_precision': 0.94627506, 'binary_recall': 0.8730998, 'binary_specificity': 0.99468195, 'binary_f1_score': 0.9082159}
confusion matrix:
       0     1
0  42084   225
1    576  3963
---- Validation: 
scalar performance:
{'acc': 0.96665424, 'precision': 0.7243264, 'recall': 0.655131, 'specificity': 0.655131, 'f1': 0.6827537, 'auroc': 0.80599844, 'binary_precision': 0.47087377, 'binary_recall': 0.32225913, 'binary_specificity': 0.98800284, 'binary_f1_score': 0.38264298}
confusion matrix:
       0    1
0  17953  218
1    408  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.7883302, 'recall': 0.6849967, 'specificity': 0.6849967, 'f1': 0.7241801, 'auroc': 0.81946534, 'binary_precision': 0.6013072, 'binary_recall': 0.38016528, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.4658228}
confusion matrix:
      0   1
0  5936  61
1   150  92
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_12.png
early stop counter: 5
val acc:0.9666542410850525, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9665010571479797 / 0.9685847163200378
after epoch: 12,now: 2024-06-22 07:50:49.605771,epoch time: 0:32:44.885702,used: 4:08:47.001019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.982646, 'precision': 0.96819776, 'recall': 0.9305039, 'specificity': 0.9305039, 'f1': 0.94834936, 'auroc': 0.9872718, 'binary_precision': 0.95065314, 'binary_recall': 0.86582947, 'binary_specificity': 0.99517834, 'binary_f1_score': 0.90626085}
confusion matrix:
       0     1
0  42105   204
1    609  3930
---- Validation: 
scalar performance:
{'acc': 0.9670271, 'precision': 0.7287829, 'recall': 0.65933883, 'specificity': 0.65933883, 'f1': 0.68720084, 'auroc': 0.81329596, 'binary_precision': 0.4795181, 'binary_recall': 0.3305648, 'binary_specificity': 0.9881129, 'binary_f1_score': 0.3913471}
confusion matrix:
       0    1
0  17955  216
1    403  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96906555, 'precision': 0.83244073, 'recall': 0.68054926, 'specificity': 0.68054926, 'f1': 0.73192155, 'auroc': 0.8145044, 'binary_precision': 0.68992245, 'binary_recall': 0.3677686, 'binary_specificity': 0.99333, 'binary_f1_score': 0.47978434}
confusion matrix:
      0   1
0  5957  40
1   153  89
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_13.png
new oracle model saved
early stop counter: 6
val acc:0.9670271277427673, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9665010571479797 / 0.9690655469894409
after epoch: 13,now: 2024-06-22 08:22:46.607596,epoch time: 0:31:57.001825,used: 4:40:44.002844,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98388404, 'precision': 0.9747663, 'recall': 0.931386, 'specificity': 0.931386, 'f1': 0.9517642, 'auroc': 0.990095, 'binary_precision': 0.9637255, 'binary_recall': 0.8662701, 'binary_specificity': 0.9965019, 'binary_f1_score': 0.91240287}
confusion matrix:
       0     1
0  42161   148
1    607  3932
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.73573977, 'recall': 0.6292082, 'specificity': 0.6292082, 'f1': 0.6654178, 'auroc': 0.8045247, 'binary_precision': 0.4953846, 'binary_recall': 0.26744187, 'binary_specificity': 0.9909746, 'binary_f1_score': 0.34735706}
confusion matrix:
       0    1
0  18007  164
1    441  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.8257464, 'recall': 0.64997447, 'specificity': 0.64997447, 'f1': 0.7024565, 'auroc': 0.8094984, 'binary_precision': 0.6788991, 'binary_recall': 0.30578512, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.4216524}
confusion matrix:
      0   1
0  5962  35
1   168  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_14.png
early stop counter: 7
val acc:0.9677728414535522, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9665010571479797 / 0.9690655469894409
after epoch: 14,now: 2024-06-22 08:55:30.166846,epoch time: 0:32:43.559250,used: 5:13:27.562094,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9843323, 'precision': 0.97121644, 'recall': 0.9375345, 'specificity': 0.9375345, 'f1': 0.95358443, 'auroc': 0.9910381, 'binary_precision': 0.95525247, 'binary_recall': 0.8794889, 'binary_specificity': 0.99558014, 'binary_f1_score': 0.91580635}
confusion matrix:
       0     1
0  42122   187
1    547  3992
---- Validation: 
scalar performance:
{'acc': 0.96681404, 'precision': 0.7252303, 'recall': 0.6479861, 'specificity': 0.6479861, 'f1': 0.6777823, 'auroc': 0.8104634, 'binary_precision': 0.47314578, 'binary_recall': 0.30730897, 'binary_specificity': 0.98866326, 'binary_f1_score': 0.37260824}
confusion matrix:
       0    1
0  17965  206
1    417  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685847, 'precision': 0.8210403, 'recall': 0.68624735, 'specificity': 0.68624735, 'f1': 0.73400474, 'auroc': 0.8174535, 'binary_precision': 0.6666667, 'binary_recall': 0.38016528, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.48421055}
confusion matrix:
      0   1
0  5951  46
1   150  92
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_15.png
early stop counter: 8
val acc:0.9668140411376953, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9665010571479797 / 0.9690655469894409
after epoch: 15,now: 2024-06-22 09:31:01.213127,epoch time: 0:35:31.046281,used: 5:48:58.608375,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98219776, 'precision': 0.95985997, 'recall': 0.9365494, 'specificity': 0.9365494, 'f1': 0.94781864, 'auroc': 0.98945475, 'binary_precision': 0.9325239, 'binary_recall': 0.8799295, 'binary_specificity': 0.9931693, 'binary_f1_score': 0.9054636}
confusion matrix:
       0     1
0  42020   289
1    545  3994
---- Validation: 
scalar performance:
{'acc': 0.9627657, 'precision': 0.68976104, 'recall': 0.6563345, 'specificity': 0.6563345, 'f1': 0.6712338, 'auroc': 0.8134369, 'binary_precision': 0.4016227, 'binary_recall': 0.32890365, 'binary_specificity': 0.98376536, 'binary_f1_score': 0.36164385}
confusion matrix:
       0    1
0  17876  295
1    404  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.73699737, 'recall': 0.6981907, 'specificity': 0.6981907, 'f1': 0.71563804, 'auroc': 0.8283098, 'binary_precision': 0.49751243, 'binary_recall': 0.41322315, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.45146725}
confusion matrix:
      0    1
0  5896  101
1   142  100
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_16.png
early stop counter: 9
val acc:0.9627656936645508, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9665010571479797 / 0.9690655469894409
after epoch: 16,now: 2024-06-22 10:14:20.587426,epoch time: 0:43:19.374299,used: 6:32:17.982674,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98435366, 'precision': 0.96657956, 'recall': 0.9424633, 'specificity': 0.9424633, 'f1': 0.9541147, 'auroc': 0.9896228, 'binary_precision': 0.94483405, 'binary_recall': 0.89050454, 'binary_specificity': 0.994422, 'binary_f1_score': 0.9168651}
confusion matrix:
       0     1
0  42073   236
1    497  4042
---- Validation: 
scalar performance:
{'acc': 0.96617484, 'precision': 0.7196413, 'recall': 0.6572925, 'specificity': 0.6572925, 'f1': 0.68275344, 'auroc': 0.80904233, 'binary_precision': 0.4613583, 'binary_recall': 0.32724252, 'binary_specificity': 0.9873425, 'binary_f1_score': 0.38289604}
confusion matrix:
       0    1
0  17941  230
1    405  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9677833, 'precision': 0.8075808, 'recall': 0.689796, 'specificity': 0.689796, 'f1': 0.7333319, 'auroc': 0.8121259, 'binary_precision': 0.6394558, 'binary_recall': 0.38842976, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.4832905}
confusion matrix:
      0   1
0  5944  53
1   148  94
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_17.png
early stop counter: 10
val acc:0.966174840927124, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9665010571479797 / 0.9690655469894409
after epoch: 17,now: 2024-06-22 10:32:11.015421,epoch time: 0:17:50.427995,used: 6:50:08.410669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.984439, 'precision': 0.9705198, 'recall': 0.9388591, 'specificity': 0.9388591, 'f1': 0.9539906, 'auroc': 0.9910108, 'binary_precision': 0.95356035, 'binary_recall': 0.882327, 'binary_specificity': 0.9953912, 'binary_f1_score': 0.91656166}
confusion matrix:
       0     1
0  42115   195
1    534  4004
---- Validation: 
scalar performance:
{'acc': 0.96660095, 'precision': 0.7214973, 'recall': 0.63823944, 'specificity': 0.63823944, 'f1': 0.66922873, 'auroc': 0.80238056, 'binary_precision': 0.46630728, 'binary_recall': 0.28737542, 'binary_specificity': 0.9891035, 'binary_f1_score': 0.35560122}
confusion matrix:
       0    1
0  17973  198
1    429  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.8129853, 'recall': 0.67385066, 'specificity': 0.67385066, 'f1': 0.7216022, 'auroc': 0.81224203, 'binary_precision': 0.6515151, 'binary_recall': 0.3553719, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.45989305}
confusion matrix:
      0   1
0  5951  46
1   156  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_18.png
early stop counter: 11
val acc:0.9666009545326233, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9665010571479797 / 0.9690655469894409
after epoch: 18,now: 2024-06-22 10:47:20.579624,epoch time: 0:15:09.564203,used: 7:05:17.974872,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98384136, 'precision': 0.97452986, 'recall': 0.9313624, 'specificity': 0.9313624, 'f1': 0.95164657, 'auroc': 0.99094176, 'binary_precision': 0.9632533, 'binary_recall': 0.8662701, 'binary_specificity': 0.99645466, 'binary_f1_score': 0.91219115}
confusion matrix:
       0     1
0  42159   150
1    607  3932
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.7342726, 'recall': 0.62995625, 'specificity': 0.62995625, 'f1': 0.6657175, 'auroc': 0.8097645, 'binary_precision': 0.4924012, 'binary_recall': 0.269103, 'binary_specificity': 0.99080956, 'binary_f1_score': 0.3480129}
confusion matrix:
       0    1
0  18004  167
1    440  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96842444, 'precision': 0.83797014, 'recall': 0.65840566, 'specificity': 0.65840566, 'f1': 0.7128394, 'auroc': 0.8206788, 'binary_precision': 0.7027027, 'binary_recall': 0.32231405, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.44192633}
confusion matrix:
      0   1
0  5964  33
1   164  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_19.png
early stop counter: 12
val acc:0.9676663279533386, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9665010571479797 / 0.9690655469894409
after epoch: 19,now: 2024-06-22 11:02:41.488743,epoch time: 0:15:20.909119,used: 7:20:38.883991,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98516476, 'precision': 0.9658996, 'recall': 0.9481243, 'specificity': 0.9481243, 'f1': 0.95679176, 'auroc': 0.99131525, 'binary_precision': 0.9422457, 'binary_recall': 0.9021811, 'binary_specificity': 0.99406743, 'binary_f1_score': 0.9217782}
confusion matrix:
       0     1
0  42058   251
1    444  4095
---- Validation: 
scalar performance:
{'acc': 0.96601504, 'precision': 0.7208635, 'recall': 0.67728615, 'specificity': 0.67728615, 'f1': 0.6964272, 'auroc': 0.81794536, 'binary_precision': 0.4625, 'binary_recall': 0.36877078, 'binary_specificity': 0.9858016, 'binary_f1_score': 0.4103512}
confusion matrix:
       0    1
0  17913  258
1    380  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.7881162, 'recall': 0.6789652, 'specificity': 0.6789652, 'f1': 0.7194361, 'auroc': 0.82438326, 'binary_precision': 0.6013514, 'binary_recall': 0.3677686, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.45641026}
confusion matrix:
      0   1
0  5938  59
1   153  89
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_20.png
early stop counter: 13
val acc:0.9660150408744812, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9665010571479797 / 0.9690655469894409
after epoch: 20,now: 2024-06-22 11:18:22.035121,epoch time: 0:15:40.546378,used: 7:36:19.430369,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98510075, 'precision': 0.9682191, 'recall': 0.9452256, 'specificity': 0.9452256, 'f1': 0.9563544, 'auroc': 0.99099433, 'binary_precision': 0.94755244, 'binary_recall': 0.89576906, 'binary_specificity': 0.99468213, 'binary_f1_score': 0.92093337}
confusion matrix:
       0     1
0  42085   225
1    473  4065
---- Validation: 
scalar performance:
{'acc': 0.96660095, 'precision': 0.72395295, 'recall': 0.6567096, 'specificity': 0.6567096, 'f1': 0.6837627, 'auroc': 0.80194485, 'binary_precision': 0.470024, 'binary_recall': 0.3255814, 'binary_specificity': 0.9878378, 'binary_f1_score': 0.38469085}
confusion matrix:
       0    1
0  17950  221
1    406  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.78304696, 'recall': 0.68276393, 'specificity': 0.68276393, 'f1': 0.72094184, 'auroc': 0.8158294, 'binary_precision': 0.59090906, 'binary_recall': 0.37603307, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.45959595}
confusion matrix:
      0   1
0  5934  63
1   151  91
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_21.png
early stop counter: 14
val acc:0.9666009545326233, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9665010571479797 / 0.9690655469894409
after epoch: 21,now: 2024-06-22 11:34:27.194310,epoch time: 0:16:05.159189,used: 7:52:24.589558,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98586917, 'precision': 0.9718567, 'recall': 0.94605577, 'specificity': 0.94605577, 'f1': 0.958496, 'auroc': 0.9916897, 'binary_precision': 0.9547267, 'binary_recall': 0.89667326, 'binary_specificity': 0.99543834, 'binary_f1_score': 0.92478985}
confusion matrix:
       0     1
0  42116   193
1    469  4070
---- Validation: 
scalar performance:
{'acc': 0.96697384, 'precision': 0.72626364, 'recall': 0.64084125, 'specificity': 0.64084125, 'f1': 0.67259395, 'auroc': 0.80865824, 'binary_precision': 0.47567567, 'binary_recall': 0.29235882, 'binary_specificity': 0.9893237, 'binary_f1_score': 0.36213994}
confusion matrix:
       0    1
0  17977  194
1    426  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96666133, 'precision': 0.8062669, 'recall': 0.6574885, 'specificity': 0.6574885, 'f1': 0.70570064, 'auroc': 0.80366313, 'binary_precision': 0.6393443, 'binary_recall': 0.32231405, 'binary_specificity': 0.992663, 'binary_f1_score': 0.42857143}
confusion matrix:
      0   1
0  5953  44
1   164  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_22.png
early stop counter: 15
val acc:0.9669738411903381, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9665010571479797 / 0.9690655469894409
after epoch: 22,now: 2024-06-22 11:50:52.647558,epoch time: 0:16:25.453248,used: 8:08:50.042806,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98618937, 'precision': 0.96967816, 'recall': 0.95026493, 'specificity': 0.95026493, 'f1': 0.959711, 'auroc': 0.99268275, 'binary_precision': 0.94942266, 'binary_recall': 0.9057061, 'binary_specificity': 0.9948238, 'binary_f1_score': 0.9270493}
confusion matrix:
       0     1
0  42090   219
1    428  4111
---- Validation: 
scalar performance:
{'acc': 0.96644115, 'precision': 0.72469825, 'recall': 0.6767032, 'specificity': 0.6767032, 'f1': 0.69752043, 'auroc': 0.843022, 'binary_precision': 0.47021276, 'binary_recall': 0.36710963, 'binary_specificity': 0.98629683, 'binary_f1_score': 0.41231343}
confusion matrix:
       0    1
0  17922  249
1    381  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96970665, 'precision': 0.84348774, 'recall': 0.6808828, 'specificity': 0.6808828, 'f1': 0.73470396, 'auroc': 0.8318767, 'binary_precision': 0.712, 'binary_recall': 0.3677686, 'binary_specificity': 0.993997, 'binary_f1_score': 0.4850136}
confusion matrix:
      0   1
0  5961  36
1   153  89
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_23.png
new oracle model saved
early stop counter: 16
val acc:0.9664411544799805, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9665010571479797 / 0.969706654548645
after epoch: 23,now: 2024-06-22 12:07:31.735430,epoch time: 0:16:39.087872,used: 8:25:29.130678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98552763, 'precision': 0.96522707, 'recall': 0.95107865, 'specificity': 0.95107865, 'f1': 0.9580136, 'auroc': 0.99298775, 'binary_precision': 0.9402509, 'binary_recall': 0.9083499, 'binary_specificity': 0.99380744, 'binary_f1_score': 0.9240251}
confusion matrix:
       0     1
0  42047   262
1    416  4123
---- Validation: 
scalar performance:
{'acc': 0.96500295, 'precision': 0.7103411, 'recall': 0.6671268, 'specificity': 0.6671268, 'f1': 0.6859784, 'auroc': 0.82357717, 'binary_precision': 0.44210526, 'binary_recall': 0.3488372, 'binary_specificity': 0.9854163, 'binary_f1_score': 0.38997215}
confusion matrix:
       0    1
0  17906  265
1    392  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.7801995, 'recall': 0.686646, 'specificity': 0.686646, 'f1': 0.723019, 'auroc': 0.8280201, 'binary_precision': 0.5849057, 'binary_recall': 0.38429752, 'binary_specificity': 0.9889945, 'binary_f1_score': 0.4638404}
confusion matrix:
      0   1
0  5931  66
1   149  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_24.png
early stop counter: 17
val acc:0.9650029540061951, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9665010571479797 / 0.969706654548645
after epoch: 24,now: 2024-06-22 12:23:56.503859,epoch time: 0:16:24.768429,used: 8:41:53.899107,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98516476, 'precision': 0.9650019, 'recall': 0.94910765, 'specificity': 0.94910765, 'f1': 0.95687866, 'auroc': 0.9916514, 'binary_precision': 0.9402199, 'binary_recall': 0.9043842, 'binary_specificity': 0.9938311, 'binary_f1_score': 0.921954}
confusion matrix:
       0     1
0  42048   261
1    434  4105
---- Validation: 
scalar performance:
{'acc': 0.96644115, 'precision': 0.7233888, 'recall': 0.6654606, 'specificity': 0.6654606, 'f1': 0.6896462, 'auroc': 0.8148223, 'binary_precision': 0.4683258, 'binary_recall': 0.34385383, 'binary_specificity': 0.9870673, 'binary_f1_score': 0.39655173}
confusion matrix:
       0    1
0  17936  235
1    395  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.7950611, 'recall': 0.67723256, 'specificity': 0.67723256, 'f1': 0.71993005, 'auroc': 0.8123511, 'binary_precision': 0.61538464, 'binary_recall': 0.36363637, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.45714286}
confusion matrix:
      0   1
0  5942  55
1   154  88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_25.png
early stop counter: 18
val acc:0.9664411544799805, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9665010571479797 / 0.969706654548645
after epoch: 25,now: 2024-06-22 12:40:38.024714,epoch time: 0:16:41.520855,used: 8:58:35.419962,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9853355, 'precision': 0.96514976, 'recall': 0.9499889, 'specificity': 0.9499889, 'f1': 0.95740926, 'auroc': 0.99208665, 'binary_precision': 0.9403292, 'binary_recall': 0.9061467, 'binary_specificity': 0.9938311, 'binary_f1_score': 0.92292154}
confusion matrix:
       0     1
0  42048   261
1    426  4113
---- Validation: 
scalar performance:
{'acc': 0.96564215, 'precision': 0.7155646, 'recall': 0.6642448, 'specificity': 0.6642448, 'f1': 0.6860529, 'auroc': 0.8178011, 'binary_precision': 0.45274726, 'binary_recall': 0.34219268, 'binary_specificity': 0.98629683, 'binary_f1_score': 0.3897824}
confusion matrix:
       0    1
0  17922  249
1    396  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.77018684, 'recall': 0.6821803, 'specificity': 0.6821803, 'f1': 0.7166553, 'auroc': 0.82500863, 'binary_precision': 0.5652174, 'binary_recall': 0.37603307, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.4516129}
confusion matrix:
      0   1
0  5927  70
1   151  91
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_26.png
early stop counter: 19
val acc:0.9656421542167664, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9665010571479797 / 0.969706654548645
after epoch: 26,now: 2024-06-22 12:56:58.026734,epoch time: 0:16:20.002020,used: 9:14:55.421982,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98631746, 'precision': 0.9661735, 'recall': 0.95485944, 'specificity': 0.95485944, 'f1': 0.9604279, 'auroc': 0.9925895, 'binary_precision': 0.9413496, 'binary_recall': 0.9158405, 'binary_specificity': 0.99387836, 'binary_f1_score': 0.9284199}
confusion matrix:
       0     1
0  42050   259
1    382  4157
---- Validation: 
scalar performance:
{'acc': 0.96633464, 'precision': 0.72105473, 'recall': 0.65576893, 'specificity': 0.65576893, 'f1': 0.6821505, 'auroc': 0.8097468, 'binary_precision': 0.4642857, 'binary_recall': 0.32392028, 'binary_specificity': 0.9876176, 'binary_f1_score': 0.3816047}
confusion matrix:
       0    1
0  17946  225
1    407  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96666133, 'precision': 0.79963744, 'recall': 0.6713677, 'specificity': 0.6713677, 'f1': 0.71627265, 'auroc': 0.8104534, 'binary_precision': 0.625, 'binary_recall': 0.35123968, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.44973546}
confusion matrix:
      0   1
0  5946  51
1   157  85
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520750_27.png
early stop counter: 20
val acc:0.9663346409797668, best validation acc: 0.9685186147689819, corresponding to test acc:                         0.9665010571479797 / 0.969706654548645
after epoch: 27,now: 2024-06-22 13:13:38.925219,epoch time: 0:16:40.898485,used: 9:31:36.320467,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_03_42_02_seed_2_21520750
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 27 with time: 9:31:36.320467 at 2024-06-22 13:13:38.925219
persisted model performance metric: 

scalar performance:
{'acc': 0.96650106, 'precision': 0.8144697, 'recall': 0.63956046, 'specificity': 0.63956046, 'f1': 0.69023293, 'auroc': 0.78892064, 'binary_precision': 0.6571429, 'binary_recall': 0.28512397, 'binary_specificity': 0.993997, 'binary_f1_score': 0.39769453}
confusion matrix:
      0   1
0  5961  36
1   173  69
oracle model performance metric: 

scalar performance:
{'acc': 0.96970665, 'precision': 0.84348774, 'recall': 0.6808828, 'specificity': 0.6808828, 'f1': 0.73470396, 'auroc': 0.8318767, 'binary_precision': 0.712, 'binary_recall': 0.3677686, 'binary_specificity': 0.993997, 'binary_f1_score': 0.4850136}
confusion matrix:
      0   1
0  5961  36
1   153  89
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204077 KiB | 632448 KiB |   1213 TiB |   1213 TiB |
|       from large pool | 167040 KiB | 559724 KiB |   1211 TiB |   1211 TiB |
|       from small pool |  37037 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204077 KiB | 632448 KiB |   1213 TiB |   1213 TiB |
|       from large pool | 167040 KiB | 559724 KiB |   1211 TiB |   1211 TiB |
|       from small pool |  37037 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB | 625043 KiB |   1197 TiB |   1197 TiB |
|       from large pool | 165120 KiB | 553452 KiB |   1195 TiB |   1195 TiB |
|       from small pool |  35967 KiB |  74337 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 778240 KiB | 778240 KiB |   1674 MiB |    914 MiB |
|       from large pool | 702464 KiB | 702464 KiB |   1548 MiB |    862 MiB |
|       from small pool |  75776 KiB |  75776 KiB |    126 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  78546 KiB | 209453 KiB | 782484 GiB | 782484 GiB |
|       from large pool |  68480 KiB | 208064 KiB | 780571 GiB | 780571 GiB |
|       from small pool |  10066 KiB |  19715 KiB |   1912 GiB |   1912 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3240    |    6605    |  250071 K  |  250068 K  |
|       from large pool |      36    |      76    |   83978 K  |   83978 K  |
|       from small pool |    3204    |    6568    |  166093 K  |  166089 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3240    |    6605    |  250071 K  |  250068 K  |
|       from large pool |      36    |      76    |   83978 K  |   83978 K  |
|       from small pool |    3204    |    6568    |  166093 K  |  166089 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |      53    |      90    |      37    |
|       from large pool |      16    |      16    |      27    |      11    |
|       from small pool |      37    |      37    |      63    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    2942    |  113055 K  |  113055 K  |
|       from large pool |       5    |      13    |   34491 K  |   34491 K  |
|       from small pool |      30    |    2937    |   78564 K  |   78564 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 632448 KiB |   1213 TiB |   1213 TiB |
|       from large pool |  16640 KiB | 559724 KiB |   1211 TiB |   1211 TiB |
|       from small pool |      0 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 632448 KiB |   1213 TiB |   1213 TiB |
|       from large pool |  16640 KiB | 559724 KiB |   1211 TiB |   1211 TiB |
|       from small pool |      0 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 625043 KiB |   1197 TiB |   1197 TiB |
|       from large pool |  16640 KiB | 553452 KiB |   1195 TiB |   1195 TiB |
|       from small pool |      0 KiB |  74337 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 282624 KiB | 778240 KiB |   1674 MiB |   1398 MiB |
|       from large pool | 235520 KiB | 702464 KiB |   1548 MiB |   1318 MiB |
|       from small pool |  47104 KiB |  75776 KiB |    126 MiB |     80 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 209453 KiB | 782484 GiB | 782484 GiB |
|       from large pool |  55040 KiB | 208064 KiB | 780571 GiB | 780571 GiB |
|       from small pool |      0 KiB |  19715 KiB |   1913 GiB |   1913 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6605    |  250071 K  |  250071 K  |
|       from large pool |       2    |      76    |   83978 K  |   83978 K  |
|       from small pool |       0    |    6568    |  166093 K  |  166093 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6605    |  250071 K  |  250071 K  |
|       from large pool |       2    |      76    |   83978 K  |   83978 K  |
|       from small pool |       0    |    6568    |  166093 K  |  166093 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      33    |      53    |      90    |      57    |
|       from large pool |      10    |      16    |      27    |      17    |
|       from small pool |      23    |      37    |      63    |      40    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2942    |  113057 K  |  113057 K  |
|       from large pool |       3    |      13    |   34491 K  |   34491 K  |
|       from small pool |       0    |    2937    |   78565 K  |   78565 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jun 22 13:14:57 2024]
Finished job 0.
1 of 1 steps (100%) done
