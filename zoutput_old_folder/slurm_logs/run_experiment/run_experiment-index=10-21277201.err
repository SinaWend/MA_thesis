Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jun 10 16:22:36 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/10.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=10
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201

 Experiment start at: 2024-06-10 16:26:16.687616
before training, model accuracy: 0.43879055976867676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97500855, 'precision': 0.90639305, 'recall': 0.96145034, 'specificity': 0.96145034, 'f1': 0.9316354, 'auroc': 0.9894556, 'binary_precision': 0.8186457, 'binary_recall': 0.94473386, 'binary_specificity': 0.9781669, 'binary_f1_score': 0.8771819}
confusion matrix:
       0     1
0  41397   924
1    244  4171
---- Validation: 
scalar performance:
{'acc': 0.9539698, 'precision': 0.6501241, 'recall': 0.6476453, 'specificity': 0.6476453, 'f1': 0.6488726, 'auroc': 0.7585751, 'binary_precision': 0.32436708, 'binary_recall': 0.31881803, 'binary_specificity': 0.97647256, 'binary_f1_score': 0.3215686}
confusion matrix:
       0    1
0  17722  427
1    438  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9762537, 'precision': 0.92560536, 'recall': 0.9660344, 'specificity': 0.9660344, 'f1': 0.94453996, 'auroc': 0.99068654, 'binary_precision': 0.8574713, 'binary_recall': 0.95274585, 'binary_specificity': 0.97932297, 'binary_f1_score': 0.90260136}
confusion matrix:
      0    1
0  5873  124
1    37  746
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-10 16:44:39.973871,epoch time: 0:18:23.286255,used: 0:18:23.286255,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8670618, 'precision': 0.705204, 'recall': 0.91513324, 'specificity': 0.91513324, 'f1': 0.75081956, 'auroc': 0.9848554, 'binary_precision': 0.41351792, 'binary_recall': 0.9743996, 'binary_specificity': 0.8558669, 'binary_f1_score': 0.58062774}
confusion matrix:
       0     1
0  36222  6100
1    113  4301
---- Validation: 
scalar performance:
{'acc': 0.71599615, 'precision': 0.51311964, 'recall': 0.579947, 'specificity': 0.579947, 'f1': 0.4631192, 'auroc': 0.6220945, 'binary_precision': 0.05312262, 'binary_recall': 0.43390357, 'binary_specificity': 0.7259904, 'binary_f1_score': 0.0946565}
confusion matrix:
       0     1
0  13176  4973
1    364   279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86253685, 'precision': 0.7270403, 'recall': 0.91674256, 'specificity': 0.91674256, 'f1': 0.76989496, 'auroc': 0.99046695, 'binary_precision': 0.4560472, 'binary_recall': 0.98722863, 'binary_specificity': 0.84625643, 'binary_f1_score': 0.6238902}
confusion matrix:
      0    1
0  5075  922
1    10  773
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_2.png
early stop counter: 1
val acc:0.7159961462020874, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 2,now: 2024-06-10 17:02:04.412476,epoch time: 0:17:24.438605,used: 0:35:47.724860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8265791, 'precision': 0.67385477, 'recall': 0.894709, 'specificity': 0.894709, 'f1': 0.70522535, 'auroc': 0.97786576, 'binary_precision': 0.3504419, 'binary_recall': 0.97871375, 'binary_specificity': 0.8107042, 'binary_f1_score': 0.5160905}
confusion matrix:
       0     1
0  34309  8011
1     94  4322
---- Validation: 
scalar performance:
{'acc': 0.6867816, 'precision': 0.5107225, 'recall': 0.5693225, 'specificity': 0.5693225, 'f1': 0.4495999, 'auroc': 0.5793532, 'binary_precision': 0.04902804, 'binary_recall': 0.44323483, 'binary_specificity': 0.6954102, 'binary_f1_score': 0.08828996}
confusion matrix:
       0     1
0  12621  5528
1    358   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8321534, 'precision': 0.7036491, 'recall': 0.904564, 'specificity': 0.904564, 'f1': 0.73701143, 'auroc': 0.99160784, 'binary_precision': 0.4075039, 'binary_recall': 0.99872285, 'binary_specificity': 0.8104052, 'binary_f1_score': 0.5788305}
confusion matrix:
      0     1
0  4860  1137
1     1   782
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_3.png
early stop counter: 2
val acc:0.6867815852165222, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 3,now: 2024-06-10 17:19:28.619587,epoch time: 0:17:24.207111,used: 0:53:11.931971,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7082121, 'precision': 0.62004143, 'recall': 0.8318931, 'specificity': 0.8318931, 'f1': 0.59871864, 'auroc': 0.9702611, 'binary_precision': 0.24247669, 'binary_recall': 0.9843608, 'binary_specificity': 0.67942536, 'binary_f1_score': 0.3891054}
confusion matrix:
       0      1
0  28756  13568
1     69   4343
---- Validation: 
scalar performance:
{'acc': 0.5449659, 'precision': 0.5009541, 'recall': 0.50715333, 'specificity': 0.50715333, 'f1': 0.38241225, 'auroc': 0.5705143, 'binary_precision': 0.03526093, 'binary_recall': 0.466563, 'binary_specificity': 0.5477437, 'binary_f1_score': 0.06556661}
confusion matrix:
      0     1
0  9941  8208
1   343   300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64070797, 'precision': 0.6214015, 'recall': 0.7963432, 'specificity': 0.7963432, 'f1': 0.56809413, 'auroc': 0.98229635, 'binary_precision': 0.24308361, 'binary_recall': 0.99872285, 'binary_specificity': 0.5939636, 'binary_f1_score': 0.39099997}
confusion matrix:
      0     1
0  3562  2435
1     1   782
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_4.png
early stop counter: 3
val acc:0.544965922832489, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 4,now: 2024-06-10 17:36:46.072545,epoch time: 0:17:17.452958,used: 1:10:29.384929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.66004795, 'precision': 0.6070669, 'recall': 0.80722314, 'specificity': 0.80722314, 'f1': 0.5619118, 'auroc': 0.95867497, 'binary_precision': 0.21601821, 'binary_recall': 0.98867244, 'binary_specificity': 0.62577385, 'binary_f1_score': 0.35456613}
confusion matrix:
       0      1
0  26484  15838
1     50   4364
---- Validation: 
scalar performance:
{'acc': 0.4434866, 'precision': 0.49563158, 'recall': 0.46736693, 'specificity': 0.46736693, 'f1': 0.3311988, 'auroc': 0.5546224, 'binary_precision': 0.030337831, 'binary_recall': 0.49300155, 'binary_specificity': 0.44173232, 'binary_f1_score': 0.057158314}
confusion matrix:
      0      1
0  8017  10132
1   326    317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5610619, 'precision': 0.603907, 'recall': 0.7513207, 'specificity': 0.7513207, 'f1': 0.50727993, 'auroc': 0.96618927, 'binary_precision': 0.2081448, 'binary_recall': 0.99872285, 'binary_specificity': 0.50391865, 'binary_f1_score': 0.34449336}
confusion matrix:
      0     1
0  3022  2975
1     1   782
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_5.png
early stop counter: 4
val acc:0.44348660111427307, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 5,now: 2024-06-10 17:58:15.815071,epoch time: 0:21:29.742526,used: 1:31:59.127455,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.6988189, 'precision': 0.6164085, 'recall': 0.8241631, 'specificity': 0.8241631, 'f1': 0.5907546, 'auroc': 0.95688534, 'binary_precision': 0.23612325, 'binary_recall': 0.97871375, 'binary_specificity': 0.66961247, 'binary_f1_score': 0.38045776}
confusion matrix:
       0      1
0  28338  13982
1     94   4322
---- Validation: 
scalar performance:
{'acc': 0.44694552, 'precision': 0.49407774, 'recall': 0.45565668, 'specificity': 0.45565668, 'f1': 0.33179548, 'auroc': 0.51279056, 'binary_precision': 0.028894473, 'binary_recall': 0.46500778, 'binary_specificity': 0.44630557, 'binary_f1_score': 0.05440815}
confusion matrix:
      0      1
0  8100  10049
1   344    299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5955752, 'precision': 0.61013484, 'recall': 0.7691649, 'specificity': 0.7691649, 'f1': 0.5331066, 'auroc': 0.9729367, 'binary_precision': 0.2214956, 'binary_recall': 0.99489146, 'binary_specificity': 0.5434384, 'binary_f1_score': 0.3623256}
confusion matrix:
      0     1
0  3259  2738
1     4   779
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_6.png
early stop counter: 5
val acc:0.44694551825523376, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 6,now: 2024-06-10 18:14:44.984445,epoch time: 0:16:29.169374,used: 1:48:28.296829,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.64614004, 'precision': 0.6020127, 'recall': 0.79457635, 'specificity': 0.79457635, 'f1': 0.550341, 'auroc': 0.9468664, 'binary_precision': 0.20783539, 'binary_recall': 0.9775612, 'binary_specificity': 0.6115915, 'binary_f1_score': 0.3427913}
confusion matrix:
       0      1
0  25885  16439
1     99   4313
---- Validation: 
scalar performance:
{'acc': 0.44002768, 'precision': 0.49237874, 'recall': 0.44307455, 'specificity': 0.44307455, 'f1': 0.32721823, 'auroc': 0.512895, 'binary_precision': 0.027453607, 'binary_recall': 0.44634527, 'binary_specificity': 0.43980384, 'binary_f1_score': 0.051725693}
confusion matrix:
      0      1
0  7982  10167
1   356    287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5402655, 'precision': 0.5998843, 'recall': 0.7390097, 'specificity': 0.7390097, 'f1': 0.49142903, 'auroc': 0.97543293, 'binary_precision': 0.20046201, 'binary_recall': 0.9974457, 'binary_specificity': 0.48057362, 'binary_f1_score': 0.33383203}
confusion matrix:
      0     1
0  2882  3115
1     2   781
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_7.png
early stop counter: 6
val acc:0.4400276839733124, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 7,now: 2024-06-10 18:29:49.746506,epoch time: 0:15:04.762061,used: 2:03:33.058890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.6223254, 'precision': 0.59792745, 'recall': 0.7850691, 'specificity': 0.7850691, 'f1': 0.5336572, 'auroc': 0.9498476, 'binary_precision': 0.1983957, 'binary_recall': 0.9857337, 'binary_specificity': 0.5844045, 'binary_f1_score': 0.33031076}
confusion matrix:
       0      1
0  24732  17588
1     63   4353
---- Validation: 
scalar performance:
{'acc': 0.4820136, 'precision': 0.49613822, 'recall': 0.47081172, 'specificity': 0.47081172, 'f1': 0.3500342, 'auroc': 0.5450475, 'binary_precision': 0.030472059, 'binary_recall': 0.45878693, 'binary_specificity': 0.4828365, 'binary_f1_score': 0.057148393}
confusion matrix:
      0     1
0  8763  9386
1   348   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51563424, 'precision': 0.5962626, 'recall': 0.7261964, 'specificity': 0.7261964, 'f1': 0.4729244, 'auroc': 0.9644319, 'binary_precision': 0.19252521, 'binary_recall': 1.0, 'binary_specificity': 0.45239288, 'binary_f1_score': 0.32288662}
confusion matrix:
      0     1
0  2713  3284
1     0   783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_8.png
early stop counter: 7
val acc:0.48201361298561096, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 8,now: 2024-06-10 18:45:18.823680,epoch time: 0:15:29.077174,used: 2:19:02.136064,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.63856554, 'precision': 0.6012299, 'recall': 0.7933353, 'specificity': 0.7933353, 'f1': 0.54539454, 'auroc': 0.96161294, 'binary_precision': 0.20519726, 'binary_recall': 0.9841378, 'binary_specificity': 0.6025329, 'binary_f1_score': 0.3395887}
confusion matrix:
       0      1
0  25501  16822
1     70   4343
---- Validation: 
scalar performance:
{'acc': 0.55667305, 'precision': 0.501269, 'recall': 0.50946397, 'specificity': 0.50946397, 'f1': 0.38774127, 'auroc': 0.55397266, 'binary_precision': 0.035636626, 'binary_recall': 0.45878693, 'binary_specificity': 0.560141, 'binary_f1_score': 0.066136084}
confusion matrix:
       0     1
0  10166  7983
1    348   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5205015, 'precision': 0.5970501, 'recall': 0.7289478, 'specificity': 0.7289478, 'f1': 0.47662914, 'auroc': 0.9814465, 'binary_precision': 0.19410014, 'binary_recall': 1.0, 'binary_specificity': 0.4578956, 'binary_f1_score': 0.3250986}
confusion matrix:
      0     1
0  2746  3251
1     0   783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_9.png
early stop counter: 8
val acc:0.5566730499267578, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 9,now: 2024-06-10 19:00:55.136822,epoch time: 0:15:36.313142,used: 2:34:38.449206,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.574311, 'precision': 0.5885801, 'recall': 0.7585608, 'specificity': 0.7585608, 'f1': 0.4988351, 'auroc': 0.9403562, 'binary_precision': 0.1799537, 'binary_recall': 0.98573047, 'binary_specificity': 0.531391, 'binary_f1_score': 0.3043463}
confusion matrix:
       0      1
0  22489  19832
1     63   4352
---- Validation: 
scalar performance:
{'acc': 0.349404, 'precision': 0.48657647, 'recall': 0.40740818, 'specificity': 0.40740818, 'f1': 0.2765886, 'auroc': 0.51122785, 'binary_precision': 0.024780504, 'binary_recall': 0.4696734, 'binary_specificity': 0.345143, 'binary_f1_score': 0.047077164}
confusion matrix:
      0      1
0  6264  11885
1   341    302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.45427728, 'precision': 0.5873299, 'recall': 0.6915124, 'specificity': 0.6915124, 'f1': 0.42563692, 'auroc': 0.9593798, 'binary_precision': 0.17465983, 'binary_recall': 1.0, 'binary_specificity': 0.38302484, 'binary_f1_score': 0.29737943}
confusion matrix:
      0     1
0  2297  3700
1     0   783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_10.png
early stop counter: 9
val acc:0.3494040071964264, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 10,now: 2024-06-10 19:16:16.993093,epoch time: 0:15:21.856271,used: 2:50:00.305477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.5504964, 'precision': 0.5842399, 'recall': 0.7444943, 'specificity': 0.7444943, 'f1': 0.4815809, 'auroc': 0.9288027, 'binary_precision': 0.17183544, 'binary_recall': 0.9836956, 'binary_specificity': 0.505293, 'binary_f1_score': 0.29256466}
confusion matrix:
       0      1
0  21384  20936
1     72   4344
---- Validation: 
scalar performance:
{'acc': 0.34690294, 'precision': 0.48591545, 'recall': 0.40311313, 'specificity': 0.40311313, 'f1': 0.27486593, 'auroc': 0.5188973, 'binary_precision': 0.024374284, 'binary_recall': 0.46345258, 'binary_specificity': 0.3427737, 'binary_f1_score': 0.046312843}
confusion matrix:
      0      1
0  6221  11928
1   345    298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.41946903, 'precision': 0.5829625, 'recall': 0.6718359, 'specificity': 0.6718359, 'f1': 0.39808255, 'auroc': 0.94927955, 'binary_precision': 0.16592498, 'binary_recall': 1.0, 'binary_specificity': 0.34367183, 'binary_f1_score': 0.28462377}
confusion matrix:
      0     1
0  2061  3936
1     0   783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_11.png
early stop counter: 10
val acc:0.3469029366970062, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 11,now: 2024-06-10 19:31:59.488683,epoch time: 0:15:42.495590,used: 3:05:42.801067,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.6272895, 'precision': 0.59824026, 'recall': 0.7855818, 'specificity': 0.7855818, 'f1': 0.53679955, 'auroc': 0.94742835, 'binary_precision': 0.19987075, 'binary_recall': 0.98074746, 'binary_specificity': 0.59041613, 'binary_f1_score': 0.33206797}
confusion matrix:
       0      1
0  24987  17334
1     85   4330
---- Validation: 
scalar performance:
{'acc': 0.45136228, 'precision': 0.49409354, 'recall': 0.45569313, 'specificity': 0.45569313, 'f1': 0.3339496, 'auroc': 0.5314667, 'binary_precision': 0.028852714, 'binary_recall': 0.46034214, 'binary_specificity': 0.45104414, 'binary_f1_score': 0.054301962}
confusion matrix:
      0     1
0  8186  9963
1   347   296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56312686, 'precision': 0.6045394, 'recall': 0.7530432, 'specificity': 0.7530432, 'f1': 0.5089515, 'auroc': 0.971834, 'binary_precision': 0.20907877, 'binary_recall': 1.0, 'binary_specificity': 0.50608635, 'binary_f1_score': 0.34584805}
confusion matrix:
      0     1
0  3035  2962
1     0   783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_12.png
early stop counter: 11
val acc:0.451362282037735, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 12,now: 2024-06-10 19:47:31.146032,epoch time: 0:15:31.657349,used: 3:21:14.458416,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.538771, 'precision': 0.5817557, 'recall': 0.7364048, 'specificity': 0.7364048, 'f1': 0.47284165, 'auroc': 0.9208418, 'binary_precision': 0.16771342, 'binary_recall': 0.98006344, 'binary_specificity': 0.49274608, 'binary_f1_score': 0.2864142}
confusion matrix:
       0      1
0  20854  21468
1     88   4326
---- Validation: 
scalar performance:
{'acc': 0.32391444, 'precision': 0.4840895, 'recall': 0.3942119, 'specificity': 0.3942119, 'f1': 0.26100245, 'auroc': 0.46758097, 'binary_precision': 0.023843361, 'binary_recall': 0.4696734, 'binary_specificity': 0.31875035, 'binary_f1_score': 0.045382828}
confusion matrix:
      0      1
0  5785  12364
1   341    302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4078171, 'precision': 0.5815965, 'recall': 0.6652493, 'specificity': 0.6652493, 'f1': 0.3886995, 'auroc': 0.94832635, 'binary_precision': 0.163193, 'binary_recall': 1.0, 'binary_specificity': 0.33049858, 'binary_f1_score': 0.2805949}
confusion matrix:
      0     1
0  1982  4015
1     0   783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_13.png
early stop counter: 12
val acc:0.32391443848609924, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 13,now: 2024-06-10 20:02:54.259195,epoch time: 0:15:23.113163,used: 3:36:37.571579,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.5284791, 'precision': 0.5813192, 'recall': 0.73386747, 'specificity': 0.73386747, 'f1': 0.46601164, 'auroc': 0.934184, 'binary_precision': 0.16543266, 'binary_recall': 0.98708653, 'binary_specificity': 0.48064837, 'binary_f1_score': 0.2833729}
confusion matrix:
       0      1
0  20342  21980
1     57   4357
---- Validation: 
scalar performance:
{'acc': 0.32481906, 'precision': 0.48429257, 'recall': 0.39543027, 'specificity': 0.39543027, 'f1': 0.2616148, 'auroc': 0.5020087, 'binary_precision': 0.023950676, 'binary_recall': 0.47122863, 'binary_specificity': 0.31963193, 'binary_f1_score': 0.045584474}
confusion matrix:
      0      1
0  5801  12348
1   340    303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4278761, 'precision': 0.58397686, 'recall': 0.6765883, 'specificity': 0.6765883, 'f1': 0.40479982, 'auroc': 0.9533396, 'binary_precision': 0.16795367, 'binary_recall': 1.0, 'binary_specificity': 0.3531766, 'binary_f1_score': 0.2876033}
confusion matrix:
      0     1
0  2118  3879
1     0   783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_14.png
early stop counter: 13
val acc:0.32481905817985535, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 14,now: 2024-06-10 20:18:08.505771,epoch time: 0:15:14.246576,used: 3:51:51.818155,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.60995805, 'precision': 0.59391373, 'recall': 0.77419347, 'specificity': 0.77419347, 'f1': 0.52369905, 'auroc': 0.9437967, 'binary_precision': 0.19206597, 'binary_recall': 0.9766546, 'binary_specificity': 0.57173234, 'binary_f1_score': 0.32100418}
confusion matrix:
       0      1
0  24198  18126
1    103   4309
---- Validation: 
scalar performance:
{'acc': 0.39506173, 'precision': 0.49017468, 'recall': 0.4287957, 'specificity': 0.4287957, 'f1': 0.3031122, 'auroc': 0.49877638, 'binary_precision': 0.02640643, 'binary_recall': 0.46500778, 'binary_specificity': 0.3925836, 'binary_f1_score': 0.04997493}
confusion matrix:
      0      1
0  7125  11024
1   344    299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53716815, 'precision': 0.59984696, 'recall': 0.73836917, 'specificity': 0.73836917, 'f1': 0.48928607, 'auroc': 0.97481096, 'binary_precision': 0.19969396, 'binary_recall': 1.0, 'binary_specificity': 0.47673836, 'binary_f1_score': 0.33290818}
confusion matrix:
      0     1
0  2859  3138
1     0   783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_15.png
early stop counter: 14
val acc:0.395061731338501, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 15,now: 2024-06-10 20:33:19.805543,epoch time: 0:15:11.299772,used: 4:07:03.117927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.5671859, 'precision': 0.58774465, 'recall': 0.755738, 'specificity': 0.755738, 'f1': 0.49394414, 'auroc': 0.95741737, 'binary_precision': 0.17783211, 'binary_recall': 0.9882246, 'binary_specificity': 0.5232514, 'binary_f1_score': 0.30142283}
confusion matrix:
       0      1
0  22144  20176
1     52   4364
---- Validation: 
scalar performance:
{'acc': 0.35265008, 'precision': 0.4865556, 'recall': 0.40683857, 'specificity': 0.40683857, 'f1': 0.27837253, 'auroc': 0.53616357, 'binary_precision': 0.024669968, 'binary_recall': 0.46500778, 'binary_specificity': 0.34866935, 'binary_f1_score': 0.046854187}
confusion matrix:
      0      1
0  6328  11821
1   344    299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.46061948, 'precision': 0.58788925, 'recall': 0.69454235, 'specificity': 0.69454235, 'f1': 0.43050885, 'auroc': 0.97390014, 'binary_precision': 0.1762055, 'binary_recall': 0.99872285, 'binary_specificity': 0.39036185, 'binary_f1_score': 0.2995595}
confusion matrix:
      0     1
0  2341  3656
1     1   782
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_16.png
early stop counter: 15
val acc:0.35265007615089417, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 16,now: 2024-06-10 20:48:29.430457,epoch time: 0:15:09.624914,used: 4:22:12.742841,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.5446551, 'precision': 0.582961, 'recall': 0.7404692, 'specificity': 0.7404692, 'f1': 0.477188, 'auroc': 0.94504845, 'binary_precision': 0.1696953, 'binary_recall': 0.9818717, 'binary_specificity': 0.4990667, 'binary_f1_score': 0.2893779}
confusion matrix:
       0      1
0  21122  21201
1     80   4333
---- Validation: 
scalar performance:
{'acc': 0.35456577, 'precision': 0.48683694, 'recall': 0.40858042, 'specificity': 0.40858042, 'f1': 0.27957305, 'auroc': 0.52576405, 'binary_precision': 0.024822108, 'binary_recall': 0.466563, 'binary_specificity': 0.35059783, 'binary_f1_score': 0.04713646}
confusion matrix:
      0      1
0  6363  11786
1   343    300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.46843657, 'precision': 0.58895886, 'recall': 0.69896126, 'specificity': 0.69896126, 'f1': 0.43658748, 'auroc': 0.9821533, 'binary_precision': 0.17833523, 'binary_recall': 0.99872285, 'binary_specificity': 0.3991996, 'binary_f1_score': 0.30263156}
confusion matrix:
      0     1
0  2394  3603
1     1   782
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_17.png
early stop counter: 16
val acc:0.3545657694339752, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 17,now: 2024-06-10 21:04:12.521232,epoch time: 0:15:43.090775,used: 4:37:55.833616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.5087085, 'precision': 0.5779176, 'recall': 0.7215307, 'specificity': 0.7215307, 'f1': 0.4515391, 'auroc': 0.9246571, 'binary_precision': 0.15947564, 'binary_recall': 0.9839148, 'binary_specificity': 0.45914653, 'binary_f1_score': 0.2744652}
confusion matrix:
       0      1
0  19432  22890
1     71   4343
---- Validation: 
scalar performance:
{'acc': 0.31619838, 'precision': 0.48316854, 'recall': 0.38946712, 'specificity': 0.38946712, 'f1': 0.25613186, 'auroc': 0.4941994, 'binary_precision': 0.023499101, 'binary_recall': 0.4681182, 'binary_specificity': 0.31081602, 'binary_f1_score': 0.044751707}
confusion matrix:
      0      1
0  5641  12508
1   342    301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.39277285, 'precision': 0.57989794, 'recall': 0.6567451, 'specificity': 0.6567451, 'f1': 0.3764489, 'auroc': 0.94752073, 'binary_precision': 0.15979593, 'binary_recall': 1.0, 'binary_specificity': 0.3134901, 'binary_f1_score': 0.2755587}
confusion matrix:
      0     1
0  1880  4117
1     0   783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_18.png
early stop counter: 17
val acc:0.3161983788013458, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 18,now: 2024-06-10 21:19:24.184935,epoch time: 0:15:11.663703,used: 4:53:07.497319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.5133302, 'precision': 0.57915676, 'recall': 0.7255996, 'specificity': 0.7255996, 'f1': 0.45514286, 'auroc': 0.9471416, 'binary_precision': 0.16115794, 'binary_recall': 0.98731595, 'binary_specificity': 0.4638832, 'binary_f1_score': 0.27708736}
confusion matrix:
       0      1
0  19632  22689
1     56   4359
---- Validation: 
scalar performance:
{'acc': 0.31039804, 'precision': 0.48242697, 'recall': 0.3857141, 'specificity': 0.3857141, 'f1': 0.25242728, 'auroc': 0.5122858, 'binary_precision': 0.023227004, 'binary_recall': 0.466563, 'binary_specificity': 0.30486527, 'binary_f1_score': 0.044251047}
confusion matrix:
      0      1
0  5533  12616
1   343    300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.44513273, 'precision': 0.5861386, 'recall': 0.6863432, 'specificity': 0.6863432, 'f1': 0.4184609, 'auroc': 0.97218865, 'binary_precision': 0.17227723, 'binary_recall': 1.0, 'binary_specificity': 0.37268636, 'binary_f1_score': 0.2939189}
confusion matrix:
      0     1
0  2235  3762
1     0   783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_19.png
early stop counter: 18
val acc:0.31039804220199585, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 19,now: 2024-06-10 21:34:34.231174,epoch time: 0:15:10.046239,used: 5:08:17.543558,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.51300925, 'precision': 0.5791558, 'recall': 0.7256351, 'specificity': 0.7256351, 'f1': 0.45491153, 'auroc': 0.9471816, 'binary_precision': 0.16105671, 'binary_recall': 0.9877634, 'binary_specificity': 0.46350685, 'binary_f1_score': 0.27695534}
confusion matrix:
       0      1
0  19617  22706
1     54   4359
---- Validation: 
scalar performance:
{'acc': 0.298212, 'precision': 0.48138353, 'recall': 0.38165542, 'specificity': 0.38165542, 'f1': 0.24479078, 'auroc': 0.49948552, 'binary_precision': 0.023040073, 'binary_recall': 0.47122863, 'binary_specificity': 0.29208222, 'binary_f1_score': 0.04393214}
confusion matrix:
      0      1
0  5301  12848
1   340    303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.44247788, 'precision': 0.5857988, 'recall': 0.6848424, 'specificity': 0.6848424, 'f1': 0.4163697, 'auroc': 0.9730616, 'binary_precision': 0.17159763, 'binary_recall': 1.0, 'binary_specificity': 0.36968485, 'binary_f1_score': 0.2929293}
confusion matrix:
      0     1
0  2217  3780
1     0   783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_20.png
early stop counter: 19
val acc:0.2982119917869568, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 20,now: 2024-06-10 21:49:41.482322,epoch time: 0:15:07.251148,used: 5:23:24.794706,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.49860922, 'precision': 0.57763106, 'recall': 0.71889675, 'specificity': 0.71889675, 'f1': 0.44472408, 'auroc': 0.9426373, 'binary_precision': 0.15747578, 'binary_recall': 0.99048483, 'binary_specificity': 0.44730872, 'binary_f1_score': 0.2717469}
confusion matrix:
       0      1
0  18931  23391
1     42   4372
---- Validation: 
scalar performance:
{'acc': 0.29081523, 'precision': 0.48061725, 'recall': 0.37857604, 'specificity': 0.37857604, 'f1': 0.2400489, 'auroc': 0.49686423, 'binary_precision': 0.0228709, 'binary_recall': 0.47278383, 'binary_specificity': 0.28436828, 'binary_f1_score': 0.043631148}
confusion matrix:
      0      1
0  5161  12988
1   339    304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.420059, 'precision': 0.58303285, 'recall': 0.67216945, 'specificity': 0.67216945, 'f1': 0.39855534, 'auroc': 0.96564436, 'binary_precision': 0.16606575, 'binary_recall': 1.0, 'binary_specificity': 0.34433883, 'binary_f1_score': 0.28483087}
confusion matrix:
      0     1
0  2065  3932
1     0   783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_21.png
early stop counter: 20
val acc:0.29081523418426514, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 21,now: 2024-06-10 22:04:52.462503,epoch time: 0:15:10.980181,used: 5:38:35.774887,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.51506335, 'precision': 0.5789149, 'recall': 0.7252379, 'specificity': 0.7252379, 'f1': 0.456169, 'auroc': 0.9263655, 'binary_precision': 0.16131547, 'binary_recall': 0.9843715, 'binary_specificity': 0.4661043, 'binary_f1_score': 0.2772037}
confusion matrix:
       0      1
0  19726  22595
1     69   4346
---- Validation: 
scalar performance:
{'acc': 0.30752447, 'precision': 0.4821079, 'recall': 0.38422644, 'specificity': 0.38422644, 'f1': 0.25060558, 'auroc': 0.48233438, 'binary_precision': 0.023130301, 'binary_recall': 0.466563, 'binary_specificity': 0.3018899, 'binary_f1_score': 0.044075515}
confusion matrix:
      0      1
0  5479  12670
1   343    300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.41342184, 'precision': 0.5822479, 'recall': 0.6684176, 'specificity': 0.6684176, 'f1': 0.39322382, 'auroc': 0.95150554, 'binary_precision': 0.1644958, 'binary_recall': 1.0, 'binary_specificity': 0.3368351, 'binary_f1_score': 0.28251848}
confusion matrix:
      0     1
0  2020  3977
1     0   783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_22.png
early stop counter: 21
val acc:0.3075244724750519, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 22,now: 2024-06-10 22:20:08.253971,epoch time: 0:15:15.791468,used: 5:53:51.566355,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.5113617, 'precision': 0.5798782, 'recall': 0.72714436, 'specificity': 0.72714436, 'f1': 0.45418078, 'auroc': 0.9535415, 'binary_precision': 0.16129151, 'binary_recall': 0.9932065, 'binary_specificity': 0.46108222, 'binary_f1_score': 0.27751592}
confusion matrix:
       0      1
0  19513  22807
1     30   4386
---- Validation: 
scalar performance:
{'acc': 0.296722, 'precision': 0.4813232, 'recall': 0.3816341, 'specificity': 0.3816341, 'f1': 0.2438763, 'auroc': 0.50496626, 'binary_precision': 0.023063501, 'binary_recall': 0.47278383, 'binary_specificity': 0.29048434, 'binary_f1_score': 0.04398148}
confusion matrix:
      0      1
0  5272  12877
1   339    304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.41769913, 'precision': 0.58275205, 'recall': 0.67083544, 'specificity': 0.67083544, 'f1': 0.3966629, 'auroc': 0.95477986, 'binary_precision': 0.16550413, 'binary_recall': 1.0, 'binary_specificity': 0.34167084, 'binary_f1_score': 0.28400436}
confusion matrix:
      0     1
0  2049  3948
1     0   783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_23.png
early stop counter: 22
val acc:0.2967219948768616, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 23,now: 2024-06-10 22:35:25.695898,epoch time: 0:15:17.441927,used: 6:09:09.008282,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.50119823, 'precision': 0.5779676, 'recall': 0.7203317, 'specificity': 0.7203317, 'f1': 0.4465821, 'auroc': 0.9551269, 'binary_precision': 0.15813465, 'binary_recall': 0.9904827, 'binary_specificity': 0.45018074, 'binary_f1_score': 0.27272725}
confusion matrix:
       0      1
0  19053  23270
1     42   4371
---- Validation: 
scalar performance:
{'acc': 0.33381227, 'precision': 0.4850873, 'recall': 0.3993361, 'specificity': 0.3993361, 'f1': 0.2671159, 'auroc': 0.5088091, 'binary_precision': 0.024198718, 'binary_recall': 0.4696734, 'binary_specificity': 0.32899883, 'binary_f1_score': 0.046026062}
confusion matrix:
      0      1
0  5971  12178
1   341    302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3977876, 'precision': 0.58045626, 'recall': 0.65957975, 'specificity': 0.65957975, 'f1': 0.3805502, 'auroc': 0.9668744, 'binary_precision': 0.16091245, 'binary_recall': 1.0, 'binary_specificity': 0.31915957, 'binary_f1_score': 0.27721718}
confusion matrix:
      0     1
0  1914  4083
1     0   783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_24.png
early stop counter: 23
val acc:0.33381226658821106, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 24,now: 2024-06-10 22:50:58.774475,epoch time: 0:15:33.078577,used: 6:24:42.086859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.519792, 'precision': 0.5805975, 'recall': 0.73059285, 'specificity': 0.73059285, 'f1': 0.46002287, 'auroc': 0.95133626, 'binary_precision': 0.16329885, 'binary_recall': 0.99048483, 'binary_specificity': 0.47070083, 'binary_f1_score': 0.28037322}
confusion matrix:
       0      1
0  19921  22401
1     42   4372
---- Validation: 
scalar performance:
{'acc': 0.3094402, 'precision': 0.48277035, 'recall': 0.38821846, 'specificity': 0.38821846, 'f1': 0.2520122, 'auroc': 0.49552053, 'binary_precision': 0.023489414, 'binary_recall': 0.47278383, 'binary_specificity': 0.3036531, 'binary_f1_score': 0.044755246}
confusion matrix:
      0      1
0  5511  12638
1   339    304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.42507374, 'precision': 0.583636, 'recall': 0.6750042, 'specificity': 0.6750042, 'f1': 0.40256545, 'auroc': 0.96612716, 'binary_precision': 0.16727196, 'binary_recall': 1.0, 'binary_specificity': 0.35000834, 'binary_f1_score': 0.2866032}
confusion matrix:
      0     1
0  2099  3898
1     0   783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_25.png
early stop counter: 24
val acc:0.3094401955604553, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 25,now: 2024-06-10 23:06:28.104996,epoch time: 0:15:29.330521,used: 6:40:11.417380,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.49689746, 'precision': 0.5763274, 'recall': 0.7152217, 'specificity': 0.7152217, 'f1': 0.44300914, 'auroc': 0.93412775, 'binary_precision': 0.1562961, 'binary_recall': 0.9843608, 'binary_specificity': 0.4460826, 'binary_f1_score': 0.26975992}
confusion matrix:
       0      1
0  18880  23444
1     69   4343
---- Validation: 
scalar performance:
{'acc': 0.28820774, 'precision': 0.48006615, 'recall': 0.37572598, 'specificity': 0.37572598, 'f1': 0.23826048, 'auroc': 0.4694263, 'binary_precision': 0.022643773, 'binary_recall': 0.4696734, 'binary_specificity': 0.2817786, 'binary_f1_score': 0.043204576}
confusion matrix:
      0      1
0  5114  13035
1   341    302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.36828908, 'precision': 0.5772799, 'recall': 0.64290476, 'specificity': 0.64290476, 'f1': 0.3561489, 'auroc': 0.94941163, 'binary_precision': 0.1545598, 'binary_recall': 1.0, 'binary_specificity': 0.28580958, 'binary_f1_score': 0.26773804}
confusion matrix:
      0     1
0  1714  4283
1     0   783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_26.png
early stop counter: 25
val acc:0.2882077395915985, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 26,now: 2024-06-10 23:21:43.192567,epoch time: 0:15:15.087571,used: 6:55:26.504951,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.48887366, 'precision': 0.5758894, 'recall': 0.7124105, 'specificity': 0.7124105, 'f1': 0.43746874, 'auroc': 0.93218434, 'binary_precision': 0.15463735, 'binary_recall': 0.98799, 'binary_specificity': 0.43683103, 'binary_f1_score': 0.26741904}
confusion matrix:
       0      1
0  18488  23835
1     53   4360
---- Validation: 
scalar performance:
{'acc': 0.29901022, 'precision': 0.48147663, 'recall': 0.38206866, 'specificity': 0.38206866, 'f1': 0.2453044, 'auroc': 0.47860062, 'binary_precision': 0.023066383, 'binary_recall': 0.47122863, 'binary_specificity': 0.2929087, 'binary_f1_score': 0.043979973}
confusion matrix:
      0      1
0  5316  12833
1   340    303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.379646, 'precision': 0.5784726, 'recall': 0.64932466, 'specificity': 0.64932466, 'f1': 0.36562407, 'auroc': 0.9572062, 'binary_precision': 0.15694527, 'binary_recall': 1.0, 'binary_specificity': 0.2986493, 'binary_f1_score': 0.27130976}
confusion matrix:
      0     1
0  1791  4206
1     0   783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_27.png
early stop counter: 26
val acc:0.2990102171897888, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 27,now: 2024-06-10 23:36:54.035708,epoch time: 0:15:10.843141,used: 7:10:37.348092,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.51166123, 'precision': 0.5790484, 'recall': 0.7249774, 'specificity': 0.7249774, 'f1': 0.4540075, 'auroc': 0.943388, 'binary_precision': 0.1608005, 'binary_recall': 0.9879982, 'binary_specificity': 0.46195653, 'binary_f1_score': 0.27658564}
confusion matrix:
       0      1
0  19550  22770
1     53   4363
---- Validation: 
scalar performance:
{'acc': 0.33030012, 'precision': 0.484629, 'recall': 0.3967678, 'specificity': 0.3967678, 'f1': 0.26490444, 'auroc': 0.47192913, 'binary_precision': 0.023995535, 'binary_recall': 0.4681182, 'binary_specificity': 0.32541737, 'binary_f1_score': 0.04565102}
confusion matrix:
      0      1
0  5906  12243
1   342    301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.429941, 'precision': 0.58422977, 'recall': 0.67775553, 'specificity': 0.67775553, 'f1': 0.40644324, 'auroc': 0.9591126, 'binary_precision': 0.16845955, 'binary_recall': 1.0, 'binary_specificity': 0.3555111, 'binary_f1_score': 0.28834468}
confusion matrix:
      0     1
0  2132  3865
1     0   783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_28.png
early stop counter: 27
val acc:0.33030012249946594, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 28,now: 2024-06-10 23:52:14.663771,epoch time: 0:15:20.628063,used: 7:25:57.976155,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.45093718, 'precision': 0.57227206, 'recall': 0.69409025, 'specificity': 0.69409025, 'f1': 0.41008395, 'auroc': 0.93875206, 'binary_precision': 0.14615948, 'binary_recall': 0.9938845, 'binary_specificity': 0.394296, 'binary_f1_score': 0.2548422}
confusion matrix:
       0      1
0  16687  25634
1     27   4388
---- Validation: 
scalar performance:
{'acc': 0.26607066, 'precision': 0.47738457, 'recall': 0.36576545, 'specificity': 0.36576545, 'f1': 0.2236646, 'auroc': 0.37531787, 'binary_precision': 0.02209784, 'binary_recall': 0.47278383, 'binary_specificity': 0.25874704, 'binary_f1_score': 0.04222222}
confusion matrix:
      0      1
0  4696  13453
1   339    304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.34351033, 'precision': 0.5747994, 'recall': 0.6288978, 'specificity': 0.6288978, 'f1': 0.33508953, 'auroc': 0.9344554, 'binary_precision': 0.14959878, 'binary_recall': 1.0, 'binary_specificity': 0.25779557, 'binary_f1_score': 0.26026258}
confusion matrix:
      0     1
0  1546  4451
1     0   783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_29.png
early stop counter: 28
val acc:0.2660706639289856, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 29,now: 2024-06-11 00:07:37.729672,epoch time: 0:15:23.065901,used: 7:41:21.042056,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.5065902, 'precision': 0.57908356, 'recall': 0.72421104, 'specificity': 0.72421104, 'f1': 0.45066524, 'auroc': 0.95996404, 'binary_precision': 0.1598745, 'binary_recall': 0.99252546, 'binary_specificity': 0.4558966, 'binary_f1_score': 0.27538964}
confusion matrix:
       0      1
0  19294  23027
1     33   4382
---- Validation: 
scalar performance:
{'acc': 0.2884738, 'precision': 0.48126084, 'recall': 0.38336432, 'specificity': 0.38336432, 'f1': 0.23887767, 'auroc': 0.48691595, 'binary_precision': 0.023367286, 'binary_recall': 0.4852255, 'binary_specificity': 0.2815031, 'binary_f1_score': 0.04458735}
confusion matrix:
      0      1
0  5109  13040
1   331    312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4182891, 'precision': 0.5828221, 'recall': 0.6711689, 'specificity': 0.6711689, 'f1': 0.39713633, 'auroc': 0.96200776, 'binary_precision': 0.16564417, 'binary_recall': 1.0, 'binary_specificity': 0.34233785, 'binary_f1_score': 0.28421053}
confusion matrix:
      0     1
0  2053  3944
1     0   783
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_30.png
early stop counter: 29
val acc:0.28847381472587585, best validation acc: 0.9539697766304016, corresponding to test acc:                         0.9762536883354187 / 0.9762536883354187
after epoch: 30,now: 2024-06-11 00:23:00.544405,epoch time: 0:15:22.814733,used: 7:56:43.856789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_16_26_16_seed_0_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:56:43.856789 at 2024-06-11 00:23:00.544405
persisted model performance metric: 

scalar performance:
{'acc': 0.9769912, 'precision': 0.92514575, 'recall': 0.97144806, 'specificity': 0.97144806, 'f1': 0.9466233, 'auroc': 0.9939915, 'binary_precision': 0.85503966, 'binary_recall': 0.9642401, 'binary_specificity': 0.978656, 'binary_f1_score': 0.90636253}
confusion matrix:
      0    1
0  5869  128
1    28  755
oracle model performance metric: 

scalar performance:
{'acc': 0.97433627, 'precision': 0.92084354, 'recall': 0.9621746, 'specificity': 0.9621746, 'f1': 0.94015527, 'auroc': 0.9894211, 'binary_precision': 0.84879726, 'binary_recall': 0.9463602, 'binary_specificity': 0.977989, 'binary_f1_score': 0.8949275}
confusion matrix:
      0    1
0  5865  132
1    42  741
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/10.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494459 KiB |  11071 MiB |   1776 TiB |   1776 TiB |
|       from large pool | 404544 KiB |  10998 MiB |   1773 TiB |   1773 TiB |
|       from small pool |  89915 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 494459 KiB |  11071 MiB |   1776 TiB |   1776 TiB |
|       from large pool | 404544 KiB |  10998 MiB |   1773 TiB |   1773 TiB |
|       from small pool |  89915 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476597 KiB |  10961 MiB |   1769 TiB |   1769 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   1766 TiB |   1766 TiB |
|       from small pool |  88757 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11224 MiB |  11224 MiB |  11224 MiB |      0 B   |
|       from large pool |  11100 MiB |  11100 MiB |  11100 MiB |      0 B   |
|       from small pool |    124 MiB |    124 MiB |    124 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1341 MiB |   1726 MiB | 638115 GiB | 638114 GiB |
|       from large pool |   1332 MiB |   1724 MiB | 634884 GiB | 634882 GiB |
|       from small pool |      8 MiB |     12 MiB |   3231 GiB |   3231 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3921    |    7088    |  147069 K  |  147065 K  |
|       from large pool |      87    |     909    |   69488 K  |   69488 K  |
|       from small pool |    3834    |    6999    |   77581 K  |   77577 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3921    |    7088    |  147069 K  |  147065 K  |
|       from large pool |      87    |     909    |   69488 K  |   69488 K  |
|       from small pool |    3834    |    6999    |   77581 K  |   77577 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     231    |     231    |     231    |       0    |
|       from large pool |     169    |     169    |     169    |       0    |
|       from small pool |      62    |      62    |      62    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |    2953    |   75645 K  |   75645 K  |
|       from large pool |      20    |      59    |   34404 K  |   34404 K  |
|       from small pool |      50    |    2932    |   41240 K  |   41240 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1776 TiB |   1776 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1773 TiB |   1773 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1776 TiB |   1776 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1773 TiB |   1773 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1769 TiB |   1769 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1766 TiB |   1766 TiB |
|       from small pool |      0 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1824 MiB |  11224 MiB |  11224 MiB |   9400 MiB |
|       from large pool |   1728 MiB |  11100 MiB |  11100 MiB |   9372 MiB |
|       from small pool |     96 MiB |    124 MiB |    124 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1726 MiB | 638115 GiB | 638115 GiB |
|       from large pool | 134912 KiB |   1724 MiB | 634884 GiB | 634884 GiB |
|       from small pool |      0 KiB |     26 MiB |   3231 GiB |   3231 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7088    |  147069 K  |  147069 K  |
|       from large pool |       2    |     909    |   69488 K  |   69488 K  |
|       from small pool |       0    |    6999    |   77581 K  |   77581 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7088    |  147069 K  |  147069 K  |
|       from large pool |       2    |     909    |   69488 K  |   69488 K  |
|       from small pool |       0    |    6999    |   77581 K  |   77581 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      78    |     231    |     231    |     153    |
|       from large pool |      30    |     169    |     169    |     139    |
|       from small pool |      48    |      62    |      62    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2953    |   75646 K  |   75646 K  |
|       from large pool |       4    |      59    |   34404 K  |   34404 K  |
|       from small pool |       0    |    2932    |   41242 K  |   41242 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1776 TiB |   1776 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1773 TiB |   1773 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1776 TiB |   1776 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1773 TiB |   1773 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1769 TiB |   1769 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1766 TiB |   1766 TiB |
|       from small pool |      0 KiB |    122 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1824 MiB |  11224 MiB |  11224 MiB |   9400 MiB |
|       from large pool |   1728 MiB |  11100 MiB |  11100 MiB |   9372 MiB |
|       from small pool |     96 MiB |    124 MiB |    124 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1726 MiB | 638115 GiB | 638115 GiB |
|       from large pool | 134912 KiB |   1724 MiB | 634884 GiB | 634884 GiB |
|       from small pool |      0 KiB |     26 MiB |   3231 GiB |   3231 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7088    |  147069 K  |  147069 K  |
|       from large pool |       2    |     909    |   69488 K  |   69488 K  |
|       from small pool |       0    |    6999    |   77581 K  |   77581 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7088    |  147069 K  |  147069 K  |
|       from large pool |       2    |     909    |   69488 K  |   69488 K  |
|       from small pool |       0    |    6999    |   77581 K  |   77581 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      78    |     231    |     231    |     153    |
|       from large pool |      30    |     169    |     169    |     139    |
|       from small pool |      48    |      62    |      62    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2953    |   75646 K  |   75646 K  |
|       from large pool |       4    |      59    |   34404 K  |   34404 K  |
|       from small pool |       0    |    2932    |   41242 K  |   41242 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201

 Experiment start at: 2024-06-11 00:29:13.727388
before training, model accuracy: 0.12607790529727936
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9309954, 'precision': 0.7860757, 'recall': 0.9471363, 'specificity': 0.9471363, 'f1': 0.8411902, 'auroc': 0.9872449, 'binary_precision': 0.57577425, 'binary_recall': 0.96694404, 'binary_specificity': 0.92732847, 'binary_f1_score': 0.7217669}
confusion matrix:
       0     1
0  39328  3082
1    143  4183
---- Validation: 
scalar performance:
{'acc': 0.7532017, 'precision': 0.53952897, 'recall': 0.7196523, 'specificity': 0.7196523, 'f1': 0.5105449, 'auroc': 0.77624404, 'binary_precision': 0.09441708, 'binary_recall': 0.68350667, 'binary_specificity': 0.75579786, 'binary_f1_score': 0.16591524}
confusion matrix:
       0     1
0  13655  4412
1    213   460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620874, 'precision': 0.88034374, 'recall': 0.96686137, 'specificity': 0.96686137, 'f1': 0.91717094, 'auroc': 0.9917741, 'binary_precision': 0.7643505, 'binary_recall': 0.97307694, 'binary_specificity': 0.9606458, 'binary_f1_score': 0.85617596}
confusion matrix:
      0    1
0  5712  234
1    21  759
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-11 00:45:13.993796,epoch time: 0:16:00.266408,used: 0:16:00.266408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8603646, 'precision': 0.69671285, 'recall': 0.9117452, 'specificity': 0.9117452, 'f1': 0.7402683, 'auroc': 0.9839276, 'binary_precision': 0.3964447, 'binary_recall': 0.9747919, 'binary_specificity': 0.8486985, 'binary_f1_score': 0.5636534}
confusion matrix:
       0     1
0  35995  6417
1    109  4215
---- Validation: 
scalar performance:
{'acc': 0.6641942, 'precision': 0.51305526, 'recall': 0.58408237, 'specificity': 0.58408237, 'f1': 0.44500494, 'auroc': 0.6279441, 'binary_precision': 0.05325914, 'binary_recall': 0.49777117, 'binary_specificity': 0.6703935, 'binary_f1_score': 0.09622289}
confusion matrix:
       0     1
0  12112  5955
1    338   335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8899792, 'precision': 0.7560563, 'recall': 0.9344317, 'specificity': 0.9344317, 'f1': 0.8051444, 'auroc': 0.9941702, 'binary_precision': 0.51326257, 'binary_recall': 0.99230766, 'binary_specificity': 0.8765557, 'binary_f1_score': 0.6765734}
confusion matrix:
      0    1
0  5212  734
1     6  774
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_2.png
early stop counter: 1
val acc:0.6641942262649536, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 2,now: 2024-06-11 01:00:42.102055,epoch time: 0:15:28.108259,used: 0:31:28.374667,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.69845515, 'precision': 0.6153804, 'recall': 0.82720554, 'specificity': 0.82720554, 'f1': 0.5889927, 'auroc': 0.97295785, 'binary_precision': 0.23301077, 'binary_recall': 0.9852057, 'binary_specificity': 0.66920537, 'binary_f1_score': 0.37688464}
confusion matrix:
       0      1
0  28381  14029
1     64   4262
---- Validation: 
scalar performance:
{'acc': 0.4189968, 'precision': 0.49104255, 'recall': 0.43688932, 'specificity': 0.43688932, 'f1': 0.31712908, 'auroc': 0.514773, 'binary_precision': 0.028349802, 'binary_recall': 0.45616642, 'binary_specificity': 0.41761222, 'binary_f1_score': 0.053382024}
confusion matrix:
      0      1
0  7545  10522
1   366    307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6845079, 'precision': 0.63396925, 'recall': 0.82044685, 'specificity': 0.82044685, 'f1': 0.60297465, 'auroc': 0.98632824, 'binary_precision': 0.26846102, 'binary_recall': 0.99743587, 'binary_specificity': 0.6434578, 'binary_f1_score': 0.423056}
confusion matrix:
      0     1
0  3826  2120
1     2   778
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_3.png
early stop counter: 2
val acc:0.41899681091308594, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 3,now: 2024-06-11 01:16:06.483748,epoch time: 0:15:24.381693,used: 0:46:52.756360,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.77490586, 'precision': 0.64127475, 'recall': 0.8606117, 'specificity': 0.8606117, 'f1': 0.6508261, 'auroc': 0.96890855, 'binary_precision': 0.28714776, 'binary_recall': 0.96578825, 'binary_specificity': 0.75543505, 'binary_f1_score': 0.4426785}
confusion matrix:
       0      1
0  32038  10372
1    148   4178
---- Validation: 
scalar performance:
{'acc': 0.49215582, 'precision': 0.4952264, 'recall': 0.46553296, 'specificity': 0.46553296, 'f1': 0.355268, 'auroc': 0.503169, 'binary_precision': 0.031170484, 'binary_recall': 0.43684992, 'binary_specificity': 0.49421597, 'binary_f1_score': 0.058189016}
confusion matrix:
      0     1
0  8929  9138
1   379   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79423136, 'precision': 0.6791768, 'recall': 0.88027763, 'specificity': 0.88027763, 'f1': 0.69820416, 'auroc': 0.9920759, 'binary_precision': 0.35966542, 'binary_recall': 0.99230766, 'binary_specificity': 0.76824754, 'binary_f1_score': 0.5279673}
confusion matrix:
      0     1
0  4568  1378
1     6   774
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_4.png
early stop counter: 3
val acc:0.4921558201313019, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 4,now: 2024-06-11 01:31:26.942878,epoch time: 0:15:20.459130,used: 1:02:13.215490,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.67384887, 'precision': 0.6073955, 'recall': 0.8103261, 'specificity': 0.8103261, 'f1': 0.5692194, 'auroc': 0.9672651, 'binary_precision': 0.21830004, 'binary_recall': 0.9778086, 'binary_specificity': 0.64284366, 'binary_f1_score': 0.35691687}
confusion matrix:
       0      1
0  27263  15147
1     96   4230
---- Validation: 
scalar performance:
{'acc': 0.41878334, 'precision': 0.48961398, 'recall': 0.42676488, 'specificity': 0.42676488, 'f1': 0.31608167, 'auroc': 0.47742277, 'binary_precision': 0.027117075, 'binary_recall': 0.43536404, 'binary_specificity': 0.4181657, 'binary_f1_score': 0.05105419}
confusion matrix:
      0      1
0  7555  10512
1   380    293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62786204, 'precision': 0.61856866, 'recall': 0.78896546, 'specificity': 0.78896546, 'f1': 0.55855876, 'auroc': 0.9816061, 'binary_precision': 0.2374276, 'binary_recall': 0.99871796, 'binary_specificity': 0.5792129, 'binary_f1_score': 0.38364932}
confusion matrix:
      0     1
0  3444  2502
1     1   779
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_5.png
early stop counter: 4
val acc:0.4187833368778229, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 5,now: 2024-06-11 01:46:47.795264,epoch time: 0:15:20.852386,used: 1:17:34.067876,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.66240156, 'precision': 0.6052516, 'recall': 0.80661345, 'specificity': 0.80661345, 'f1': 0.5611601, 'auroc': 0.9691506, 'binary_precision': 0.213155, 'binary_recall': 0.9835876, 'binary_specificity': 0.6296392, 'binary_f1_score': 0.3503788}
confusion matrix:
       0      1
0  26703  15707
1     71   4255
---- Validation: 
scalar performance:
{'acc': 0.378762, 'precision': 0.4872686, 'recall': 0.41316146, 'specificity': 0.41316146, 'f1': 0.2940396, 'auroc': 0.49602318, 'binary_precision': 0.026177106, 'binary_recall': 0.45022288, 'binary_specificity': 0.37610006, 'binary_f1_score': 0.049477465}
confusion matrix:
      0      1
0  6795  11272
1   370    303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61284566, 'precision': 0.6147899, 'recall': 0.7799154, 'specificity': 0.7799154, 'f1': 0.5468987, 'auroc': 0.98666555, 'binary_precision': 0.23017752, 'binary_recall': 0.99743587, 'binary_specificity': 0.5623949, 'binary_f1_score': 0.37403846}
confusion matrix:
      0     1
0  3344  2602
1     2   778
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_6.png
early stop counter: 5
val acc:0.37876200675964355, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 6,now: 2024-06-11 02:02:04.085671,epoch time: 0:15:16.290407,used: 1:32:50.358283,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.6696979, 'precision': 0.60675997, 'recall': 0.809492, 'specificity': 0.809492, 'f1': 0.5664052, 'auroc': 0.9624678, 'binary_precision': 0.21654166, 'binary_recall': 0.9810448, 'binary_specificity': 0.63793916, 'binary_f1_score': 0.35477534}
confusion matrix:
       0      1
0  27055  15355
1     82   4244
---- Validation: 
scalar performance:
{'acc': 0.4205443, 'precision': 0.49076188, 'recall': 0.4348308, 'specificity': 0.4348308, 'f1': 0.31772172, 'auroc': 0.50184655, 'binary_precision': 0.028076353, 'binary_recall': 0.45022288, 'binary_specificity': 0.41943875, 'binary_f1_score': 0.052856516}
confusion matrix:
      0      1
0  7578  10489
1   370    303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62563187, 'precision': 0.6180278, 'recall': 0.7877041, 'specificity': 0.7877041, 'f1': 0.5568397, 'auroc': 0.98264575, 'binary_precision': 0.2363471, 'binary_recall': 0.99871796, 'binary_specificity': 0.5766902, 'binary_f1_score': 0.3822375}
confusion matrix:
      0     1
0  3429  2517
1     1   779
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_7.png
early stop counter: 6
val acc:0.420544296503067, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 7,now: 2024-06-11 02:17:21.239210,epoch time: 0:15:17.153539,used: 1:48:07.511822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.5847955, 'precision': 0.5886917, 'recall': 0.76395607, 'specificity': 0.76395607, 'f1': 0.5044464, 'auroc': 0.953133, 'binary_precision': 0.18040778, 'binary_recall': 0.98381877, 'binary_specificity': 0.5440934, 'binary_f1_score': 0.3049038}
confusion matrix:
       0      1
0  23075  19335
1     70   4256
---- Validation: 
scalar performance:
{'acc': 0.37182498, 'precision': 0.48716688, 'recall': 0.4131401, 'specificity': 0.4131401, 'f1': 0.290286, 'auroc': 0.49864691, 'binary_precision': 0.02629108, 'binary_recall': 0.4576523, 'binary_specificity': 0.36862788, 'binary_f1_score': 0.049725544}
confusion matrix:
      0      1
0  6660  11407
1   365    308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5325602, 'precision': 0.59913325, 'recall': 0.7350637, 'specificity': 0.7350637, 'f1': 0.48601702, 'auroc': 0.98355925, 'binary_precision': 0.19862315, 'binary_recall': 0.99871796, 'binary_specificity': 0.47140935, 'binary_f1_score': 0.33134836}
confusion matrix:
      0     1
0  2803  3143
1     1   779
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_8.png
early stop counter: 7
val acc:0.3718249797821045, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 8,now: 2024-06-11 02:32:37.400198,epoch time: 0:15:16.160988,used: 2:03:23.672810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.6083319, 'precision': 0.59036064, 'recall': 0.7684139, 'specificity': 0.7684139, 'f1': 0.51963073, 'auroc': 0.8860669, 'binary_precision': 0.18694854, 'binary_recall': 0.9648636, 'binary_specificity': 0.57196414, 'binary_f1_score': 0.31321055}
confusion matrix:
       0      1
0  24257  18153
1    152   4174
---- Validation: 
scalar performance:
{'acc': 0.3552828, 'precision': 0.4855229, 'recall': 0.40384567, 'specificity': 0.40384567, 'f1': 0.2804349, 'auroc': 0.49945486, 'binary_precision': 0.025534393, 'binary_recall': 0.45616642, 'binary_specificity': 0.3515249, 'binary_f1_score': 0.04836169}
confusion matrix:
      0      1
0  6351  11716
1   366    307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5921796, 'precision': 0.609996, 'recall': 0.7676699, 'specificity': 0.7676699, 'f1': 0.531015, 'auroc': 0.94489396, 'binary_precision': 0.22092693, 'binary_recall': 0.99615383, 'binary_specificity': 0.539186, 'binary_f1_score': 0.36164767}
confusion matrix:
      0     1
0  3206  2740
1     3   777
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_9.png
early stop counter: 8
val acc:0.35528281331062317, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 9,now: 2024-06-11 02:47:52.847944,epoch time: 0:15:15.447746,used: 2:18:39.120556,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.62579167, 'precision': 0.5957997, 'recall': 0.7835351, 'specificity': 0.7835351, 'f1': 0.5334416, 'auroc': 0.9531978, 'binary_precision': 0.19554055, 'binary_recall': 0.9771151, 'binary_specificity': 0.5899552, 'binary_f1_score': 0.32586828}
confusion matrix:
       0      1
0  25020  17390
1     99   4227
---- Validation: 
scalar performance:
{'acc': 0.35757738, 'precision': 0.4860588, 'recall': 0.40718147, 'specificity': 0.40718147, 'f1': 0.2819721, 'auroc': 0.51541805, 'binary_precision': 0.025863508, 'binary_recall': 0.46062407, 'binary_specificity': 0.35373887, 'binary_f1_score': 0.048977014}
confusion matrix:
      0      1
0  6391  11676
1   363    310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58920604, 'precision': 0.60960424, 'recall': 0.76654506, 'specificity': 0.76654506, 'f1': 0.5288696, 'auroc': 0.9823537, 'binary_precision': 0.21983612, 'binary_recall': 0.99743587, 'binary_specificity': 0.53565425, 'binary_f1_score': 0.36026856}
confusion matrix:
      0     1
0  3185  2761
1     2   778
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_10.png
early stop counter: 9
val acc:0.357577383518219, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 10,now: 2024-06-11 03:03:12.796896,epoch time: 0:15:19.948952,used: 2:33:59.069508,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.6043735, 'precision': 0.59195805, 'recall': 0.77350104, 'specificity': 0.77350104, 'f1': 0.518257, 'auroc': 0.94215846, 'binary_precision': 0.18732065, 'binary_recall': 0.9810405, 'binary_specificity': 0.56596166, 'binary_f1_score': 0.3145759}
confusion matrix:
       0      1
0  24003  18408
1     82   4243
---- Validation: 
scalar performance:
{'acc': 0.36232656, 'precision': 0.4861897, 'recall': 0.40749872, 'specificity': 0.40749872, 'f1': 0.28462917, 'auroc': 0.49956492, 'binary_precision': 0.025817845, 'binary_recall': 0.45616642, 'binary_specificity': 0.35883102, 'binary_f1_score': 0.04886979}
confusion matrix:
      0      1
0  6483  11584
1   366    307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5529289, 'precision': 0.6029839, 'recall': 0.74714094, 'specificity': 0.74714094, 'f1': 0.50157267, 'auroc': 0.971494, 'binary_precision': 0.20596778, 'binary_recall': 1.0, 'binary_specificity': 0.49428186, 'binary_f1_score': 0.3415809}
confusion matrix:
      0     1
0  2939  3007
1     0   780
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_11.png
early stop counter: 10
val acc:0.36232656240463257, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 11,now: 2024-06-11 03:18:22.279159,epoch time: 0:15:09.482263,used: 2:49:08.551771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.5988317, 'precision': 0.5911751, 'recall': 0.7712749, 'specificity': 0.7712749, 'f1': 0.5144514, 'auroc': 0.9481077, 'binary_precision': 0.1854582, 'binary_recall': 0.9828941, 'binary_specificity': 0.5596557, 'binary_f1_score': 0.31203902}
confusion matrix:
       0      1
0  23735  18675
1     74   4252
---- Validation: 
scalar performance:
{'acc': 0.3905016, 'precision': 0.48859927, 'recall': 0.42139572, 'specificity': 0.42139572, 'f1': 0.3009919, 'auroc': 0.51351863, 'binary_precision': 0.02693425, 'binary_recall': 0.45468053, 'binary_specificity': 0.3881109, 'binary_f1_score': 0.050855912}
confusion matrix:
      0      1
0  7012  11055
1   367    306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55605114, 'precision': 0.60331154, 'recall': 0.7483499, 'specificity': 0.7483499, 'f1': 0.5038327, 'auroc': 0.9765159, 'binary_precision': 0.20696068, 'binary_recall': 0.99871796, 'binary_specificity': 0.49798185, 'binary_f1_score': 0.3428697}
confusion matrix:
      0     1
0  2961  2985
1     1   779
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_12.png
early stop counter: 11
val acc:0.39050158858299255, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 12,now: 2024-06-11 03:33:26.924814,epoch time: 0:15:04.645655,used: 3:04:13.197426,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.64586186, 'precision': 0.60178673, 'recall': 0.7992676, 'specificity': 0.7992676, 'f1': 0.54918283, 'auroc': 0.96945816, 'binary_precision': 0.20565292, 'binary_recall': 0.98751444, 'binary_specificity': 0.61102074, 'binary_f1_score': 0.34041366}
confusion matrix:
       0      1
0  25914  16497
1     54   4271
---- Validation: 
scalar performance:
{'acc': 0.36248666, 'precision': 0.4866251, 'recall': 0.41044283, 'specificity': 0.41044283, 'f1': 0.28494972, 'auroc': 0.5261185, 'binary_precision': 0.026143242, 'binary_recall': 0.46210995, 'binary_specificity': 0.35877568, 'binary_f1_score': 0.04948683}
confusion matrix:
      0      1
0  6482  11585
1   362    311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60987216, 'precision': 0.6143411, 'recall': 0.77879053, 'specificity': 0.77879053, 'f1': 0.5447427, 'auroc': 0.9885284, 'binary_precision': 0.22898296, 'binary_recall': 0.99871796, 'binary_specificity': 0.5588631, 'binary_f1_score': 0.372549}
confusion matrix:
      0     1
0  3323  2623
1     1   779
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_13.png
early stop counter: 12
val acc:0.36248666048049927, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 13,now: 2024-06-11 03:48:35.348783,epoch time: 0:15:08.423969,used: 3:19:21.621395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.5925839, 'precision': 0.5901983, 'recall': 0.7684551, 'specificity': 0.7684551, 'f1': 0.5100801, 'auroc': 0.94564, 'binary_precision': 0.18328957, 'binary_recall': 0.98428106, 'binary_specificity': 0.5526291, 'binary_f1_score': 0.3090322}
confusion matrix:
       0      1
0  23437  18973
1     68   4258
---- Validation: 
scalar performance:
{'acc': 0.33847386, 'precision': 0.4841796, 'recall': 0.3972739, 'specificity': 0.3972739, 'f1': 0.27043235, 'auroc': 0.49750626, 'binary_precision': 0.025113415, 'binary_recall': 0.46062407, 'binary_specificity': 0.33392373, 'binary_f1_score': 0.047630023}
confusion matrix:
      0      1
0  6033  12034
1   363    310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.534493, 'precision': 0.59971875, 'recall': 0.73671377, 'specificity': 0.73671377, 'f1': 0.4875862, 'auroc': 0.97201216, 'binary_precision': 0.19943748, 'binary_recall': 1.0, 'binary_specificity': 0.4734275, 'binary_f1_score': 0.3325517}
confusion matrix:
      0     1
0  2815  3131
1     0   780
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_14.png
early stop counter: 13
val acc:0.3384738564491272, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 14,now: 2024-06-11 04:03:44.533262,epoch time: 0:15:09.184479,used: 3:34:30.805874,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.52550495, 'precision': 0.57999444, 'recall': 0.73409426, 'specificity': 0.73409426, 'f1': 0.46254545, 'auroc': 0.9417082, 'binary_precision': 0.16210486, 'binary_recall': 0.9900578, 'binary_specificity': 0.47813067, 'binary_f1_score': 0.27859464}
confusion matrix:
       0      1
0  20278  22133
1     43   4282
---- Validation: 
scalar performance:
{'acc': 0.28633937, 'precision': 0.47872156, 'recall': 0.373812, 'specificity': 0.373812, 'f1': 0.23764946, 'auroc': 0.4990036, 'binary_precision': 0.023629135, 'binary_recall': 0.4680535, 'binary_specificity': 0.2795705, 'binary_f1_score': 0.044987146}
confusion matrix:
      0      1
0  5051  13016
1   358    315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4827535, 'precision': 0.5915708, 'recall': 0.7074504, 'specificity': 0.7074504, 'f1': 0.44802928, 'auroc': 0.9689298, 'binary_precision': 0.18314159, 'binary_recall': 1.0, 'binary_specificity': 0.41490078, 'binary_f1_score': 0.30958524}
confusion matrix:
      0     1
0  2467  3479
1     0   780
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_15.png
early stop counter: 14
val acc:0.2863393723964691, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 15,now: 2024-06-11 04:18:47.604974,epoch time: 0:15:03.071712,used: 3:49:33.877586,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.5119394, 'precision': 0.57765913, 'recall': 0.7254729, 'specificity': 0.7254729, 'f1': 0.4526484, 'auroc': 0.9026526, 'binary_precision': 0.15805832, 'binary_recall': 0.98751736, 'binary_specificity': 0.46342844, 'binary_f1_score': 0.27250114}
confusion matrix:
       0      1
0  19654  22756
1     54   4272
---- Validation: 
scalar performance:
{'acc': 0.2839381, 'precision': 0.47828785, 'recall': 0.37185135, 'specificity': 0.37185135, 'f1': 0.23602656, 'auroc': 0.47217238, 'binary_precision': 0.02347839, 'binary_recall': 0.4665676, 'binary_specificity': 0.2771351, 'binary_f1_score': 0.044707052}
confusion matrix:
      0      1
0  5007  13060
1   359    314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4079691, 'precision': 0.58189833, 'recall': 0.665153, 'specificity': 0.665153, 'f1': 0.38903672, 'auroc': 0.9195361, 'binary_precision': 0.16379672, 'binary_recall': 1.0, 'binary_specificity': 0.33030608, 'binary_f1_score': 0.28148684}
confusion matrix:
      0     1
0  1964  3982
1     0   780
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_16.png
early stop counter: 15
val acc:0.28393810987472534, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 16,now: 2024-06-11 04:33:56.649882,epoch time: 0:15:09.044908,used: 4:04:42.922494,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.5405041, 'precision': 0.5810106, 'recall': 0.7388249, 'specificity': 0.7388249, 'f1': 0.4726638, 'auroc': 0.9232062, 'binary_precision': 0.16567239, 'binary_recall': 0.9822006, 'binary_specificity': 0.4954492, 'binary_f1_score': 0.28352183}
confusion matrix:
       0      1
0  21012  21398
1     77   4249
---- Validation: 
scalar performance:
{'acc': 0.28639275, 'precision': 0.47849682, 'recall': 0.37240914, 'specificity': 0.37240914, 'f1': 0.2375966, 'auroc': 0.4755075, 'binary_precision': 0.023487918, 'binary_recall': 0.46508172, 'binary_specificity': 0.27973655, 'binary_f1_score': 0.044717476}
confusion matrix:
      0      1
0  5054  13013
1   360    313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.46833184, 'precision': 0.58953166, 'recall': 0.6992936, 'specificity': 0.6992936, 'f1': 0.43686193, 'auroc': 0.9452787, 'binary_precision': 0.17906336, 'binary_recall': 1.0, 'binary_specificity': 0.3985873, 'binary_f1_score': 0.30373833}
confusion matrix:
      0     1
0  2370  3576
1     0   780
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_17.png
early stop counter: 16
val acc:0.2863927483558655, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 17,now: 2024-06-11 04:48:59.409004,epoch time: 0:15:02.759122,used: 4:19:45.681616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.48506504, 'precision': 0.57464606, 'recall': 0.7122219, 'specificity': 0.7122219, 'f1': 0.43353483, 'auroc': 0.9174739, 'binary_precision': 0.1514092, 'binary_recall': 0.99098474, 'binary_specificity': 0.4334591, 'binary_f1_score': 0.2626838}
confusion matrix:
       0      1
0  18383  24027
1     39   4287
---- Validation: 
scalar performance:
{'acc': 0.30218783, 'precision': 0.48037407, 'recall': 0.3798856, 'specificity': 0.3798856, 'f1': 0.24780257, 'auroc': 0.4791124, 'binary_precision': 0.023948418, 'binary_recall': 0.46359584, 'binary_specificity': 0.29617536, 'binary_f1_score': 0.045544118}
confusion matrix:
      0      1
0  5351  12716
1   361    312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3981564, 'precision': 0.5807788, 'recall': 0.6596031, 'specificity': 0.6596031, 'f1': 0.38105538, 'auroc': 0.92145306, 'binary_precision': 0.16155759, 'binary_recall': 1.0, 'binary_specificity': 0.31920618, 'binary_f1_score': 0.27817404}
confusion matrix:
      0     1
0  1898  4048
1     0   780
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_18.png
early stop counter: 17
val acc:0.30218783020973206, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 18,now: 2024-06-11 05:04:05.471110,epoch time: 0:15:06.062106,used: 4:34:51.743722,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.5745678, 'precision': 0.58647966, 'recall': 0.7571789, 'specificity': 0.7571789, 'f1': 0.4969005, 'auroc': 0.94918144, 'binary_precision': 0.1765293, 'binary_recall': 0.98127604, 'binary_specificity': 0.5330818, 'binary_f1_score': 0.29922816}
confusion matrix:
       0      1
0  22608  19802
1     81   4245
---- Validation: 
scalar performance:
{'acc': 0.34546426, 'precision': 0.48467, 'recall': 0.39946878, 'specificity': 0.39946878, 'f1': 0.2745801, 'auroc': 0.48894298, 'binary_precision': 0.025227292, 'binary_recall': 0.4576523, 'binary_specificity': 0.34128523, 'binary_f1_score': 0.047818664}
confusion matrix:
      0      1
0  6166  11901
1   365    308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.47606304, 'precision': 0.59061337, 'recall': 0.7036663, 'specificity': 0.7036663, 'f1': 0.44285846, 'auroc': 0.97103626, 'binary_precision': 0.18122676, 'binary_recall': 1.0, 'binary_specificity': 0.40733266, 'binary_f1_score': 0.306845}
confusion matrix:
      0     1
0  2422  3524
1     0   780
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_19.png
early stop counter: 18
val acc:0.3454642593860626, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 19,now: 2024-06-11 05:19:02.065216,epoch time: 0:14:56.594106,used: 4:49:48.337828,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.58201385, 'precision': 0.5885757, 'recall': 0.76367664, 'specificity': 0.76367664, 'f1': 0.5026547, 'auroc': 0.94625586, 'binary_precision': 0.17967401, 'binary_recall': 0.9865865, 'binary_specificity': 0.5407668, 'binary_f1_score': 0.3039869}
confusion matrix:
       0      1
0  22935  19477
1     58   4266
---- Validation: 
scalar performance:
{'acc': 0.37785485, 'precision': 0.48770618, 'recall': 0.41626734, 'specificity': 0.41626734, 'f1': 0.29380816, 'auroc': 0.5137303, 'binary_precision': 0.026547147, 'binary_recall': 0.4576523, 'binary_specificity': 0.37488237, 'binary_f1_score': 0.0501833}
confusion matrix:
      0      1
0  6773  11294
1   365    308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4571811, 'precision': 0.5880163, 'recall': 0.69298685, 'specificity': 0.69298685, 'f1': 0.42816898, 'auroc': 0.9617759, 'binary_precision': 0.1760325, 'binary_recall': 1.0, 'binary_specificity': 0.38597375, 'binary_f1_score': 0.2993667}
confusion matrix:
      0     1
0  2295  3651
1     0   780
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_20.png
early stop counter: 19
val acc:0.3778548538684845, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 20,now: 2024-06-11 05:34:13.596479,epoch time: 0:15:11.531263,used: 5:04:59.869091,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.49317443, 'precision': 0.57477087, 'recall': 0.71431285, 'specificity': 0.71431285, 'f1': 0.4389865, 'auroc': 0.935791, 'binary_precision': 0.15283106, 'binary_recall': 0.98566145, 'binary_specificity': 0.44296426, 'binary_f1_score': 0.26463008}
confusion matrix:
       0      1
0  18787  23625
1     62   4262
---- Validation: 
scalar performance:
{'acc': 0.29236928, 'precision': 0.47961465, 'recall': 0.3776545, 'specificity': 0.3776545, 'f1': 0.241637, 'auroc': 0.47767347, 'binary_precision': 0.023903176, 'binary_recall': 0.46953937, 'binary_specificity': 0.28576964, 'binary_f1_score': 0.045490533}
confusion matrix:
      0      1
0  5163  12904
1   357    316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.38016653, 'precision': 0.5788038, 'recall': 0.6494282, 'specificity': 0.6494282, 'f1': 0.36624134, 'auroc': 0.9522457, 'binary_precision': 0.1576076, 'binary_recall': 1.0, 'binary_specificity': 0.29885638, 'binary_f1_score': 0.27229884}
confusion matrix:
      0     1
0  1777  4169
1     0   780
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_21.png
early stop counter: 20
val acc:0.2923692762851715, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 21,now: 2024-06-11 05:49:17.348376,epoch time: 0:15:03.751897,used: 5:20:03.620988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.52522683, 'precision': 0.5796713, 'recall': 0.73310566, 'specificity': 0.73310566, 'f1': 0.4622214, 'auroc': 0.9522701, 'binary_precision': 0.16185212, 'binary_recall': 0.9882108, 'binary_specificity': 0.47800046, 'binary_f1_score': 0.2781483}
confusion matrix:
       0      1
0  20272  22138
1     51   4275
---- Validation: 
scalar performance:
{'acc': 0.28201708, 'precision': 0.47838074, 'recall': 0.37300086, 'specificity': 0.37300086, 'f1': 0.23488921, 'auroc': 0.47856128, 'binary_precision': 0.023628503, 'binary_recall': 0.47102526, 'binary_specificity': 0.27497646, 'binary_f1_score': 0.044999644}
confusion matrix:
      0      1
0  4968  13099
1   356    317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.40365744, 'precision': 0.58140266, 'recall': 0.6627144, 'specificity': 0.6627144, 'f1': 0.38553798, 'auroc': 0.9580471, 'binary_precision': 0.16280526, 'binary_recall': 1.0, 'binary_specificity': 0.32542887, 'binary_f1_score': 0.28002152}
confusion matrix:
      0     1
0  1935  4011
1     0   780
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_22.png
early stop counter: 21
val acc:0.2820170819759369, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 22,now: 2024-06-11 06:04:20.337479,epoch time: 0:15:02.989103,used: 5:35:06.610091,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.50684696, 'precision': 0.5773722, 'recall': 0.72380865, 'specificity': 0.72380865, 'f1': 0.4491803, 'auroc': 0.95203614, 'binary_precision': 0.15695544, 'binary_recall': 0.9900601, 'binary_specificity': 0.45755717, 'binary_f1_score': 0.2709559}
confusion matrix:
       0      1
0  19405  23005
1     43   4283
---- Validation: 
scalar performance:
{'acc': 0.27870864, 'precision': 0.47781497, 'recall': 0.37056977, 'specificity': 0.37056977, 'f1': 0.23265475, 'auroc': 0.45024976, 'binary_precision': 0.023449095, 'binary_recall': 0.46953937, 'binary_specificity': 0.27160016, 'binary_f1_score': 0.044667467}
confusion matrix:
      0      1
0  4907  13160
1   357    316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.43250075, 'precision': 0.5848379, 'recall': 0.6790279, 'specificity': 0.6790279, 'f1': 0.40871555, 'auroc': 0.96243966, 'binary_precision': 0.16967587, 'binary_recall': 1.0, 'binary_specificity': 0.35805583, 'binary_f1_score': 0.29012462}
confusion matrix:
      0     1
0  2129  3817
1     0   780
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_23.png
early stop counter: 22
val acc:0.27870863676071167, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 23,now: 2024-06-11 06:19:22.345681,epoch time: 0:15:02.008202,used: 5:50:08.618293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.624679, 'precision': 0.5958319, 'recall': 0.78375244, 'specificity': 0.78375244, 'f1': 0.5328073, 'auroc': 0.9675685, 'binary_precision': 0.19529629, 'binary_recall': 0.9789644, 'binary_specificity': 0.58854043, 'binary_f1_score': 0.32563147}
confusion matrix:
       0      1
0  24960  17450
1     91   4235
---- Validation: 
scalar performance:
{'acc': 0.39978656, 'precision': 0.489994, 'recall': 0.43050274, 'specificity': 0.43050274, 'f1': 0.30666143, 'auroc': 0.5344465, 'binary_precision': 0.02785963, 'binary_recall': 0.46359584, 'binary_specificity': 0.39740965, 'binary_f1_score': 0.052560646}
confusion matrix:
      0      1
0  7180  10887
1   361    312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5550104, 'precision': 0.603366, 'recall': 0.7483182, 'specificity': 0.7483182, 'f1': 0.50315064, 'auroc': 0.9882208, 'binary_precision': 0.20673205, 'binary_recall': 1.0, 'binary_specificity': 0.4966364, 'binary_f1_score': 0.34263125}
confusion matrix:
      0     1
0  2953  2993
1     0   780
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_24.png
early stop counter: 23
val acc:0.3997865617275238, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 24,now: 2024-06-11 06:34:50.122792,epoch time: 0:15:27.777111,used: 6:05:36.395404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.6045875, 'precision': 0.59265417, 'recall': 0.7755915, 'specificity': 0.7755915, 'f1': 0.5188142, 'auroc': 0.96679586, 'binary_precision': 0.18792716, 'binary_recall': 0.9854335, 'binary_specificity': 0.56574947, 'binary_f1_score': 0.31565693}
confusion matrix:
       0      1
0  23994  18417
1     63   4262
---- Validation: 
scalar performance:
{'acc': 0.3311633, 'precision': 0.48385566, 'recall': 0.39634353, 'specificity': 0.39634353, 'f1': 0.2661462, 'auroc': 0.47612518, 'binary_precision': 0.025142126, 'binary_recall': 0.4665676, 'binary_specificity': 0.32611945, 'binary_f1_score': 0.047713116}
confusion matrix:
      0      1
0  5892  12175
1   359    314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54965806, 'precision': 0.6023891, 'recall': 0.74529094, 'specificity': 0.74529094, 'f1': 0.49909276, 'auroc': 0.97743696, 'binary_precision': 0.20477815, 'binary_recall': 1.0, 'binary_specificity': 0.4905819, 'binary_f1_score': 0.33994332}
confusion matrix:
      0     1
0  2917  3029
1     0   780
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_25.png
early stop counter: 24
val acc:0.33116328716278076, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 25,now: 2024-06-11 06:49:52.506559,epoch time: 0:15:02.383767,used: 6:20:38.779171,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.6315688, 'precision': 0.5975589, 'recall': 0.7883841, 'specificity': 0.7883841, 'f1': 0.5379749, 'auroc': 0.96835446, 'binary_precision': 0.1983908, 'binary_recall': 0.9808048, 'binary_specificity': 0.5959634, 'binary_f1_score': 0.33002606}
confusion matrix:
       0      1
0  25276  17136
1     83   4241
---- Validation: 
scalar performance:
{'acc': 0.40426895, 'precision': 0.49036294, 'recall': 0.4328274, 'specificity': 0.4328274, 'f1': 0.3092015, 'auroc': 0.5436198, 'binary_precision': 0.028070176, 'binary_recall': 0.46359584, 'binary_specificity': 0.402059, 'binary_f1_score': 0.052935187}
confusion matrix:
      0      1
0  7264  10803
1   361    312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5077312, 'precision': 0.5953312, 'recall': 0.7215775, 'specificity': 0.7215775, 'f1': 0.46720517, 'auroc': 0.9791214, 'binary_precision': 0.19066243, 'binary_recall': 1.0, 'binary_specificity': 0.44315505, 'binary_f1_score': 0.3202628}
confusion matrix:
      0     1
0  2635  3311
1     0   780
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_26.png
early stop counter: 25
val acc:0.40426895022392273, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 26,now: 2024-06-11 07:04:59.183562,epoch time: 0:15:06.677003,used: 6:35:45.456174,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.51495636, 'precision': 0.57766837, 'recall': 0.7259935, 'specificity': 0.7259935, 'f1': 0.4546202, 'auroc': 0.9556016, 'binary_precision': 0.15860786, 'binary_recall': 0.98497456, 'binary_specificity': 0.4670125, 'binary_f1_score': 0.27321982}
confusion matrix:
       0      1
0  19806  22604
1     65   4261
---- Validation: 
scalar performance:
{'acc': 0.32657418, 'precision': 0.48358804, 'recall': 0.39539403, 'specificity': 0.39539403, 'f1': 0.263403, 'auroc': 0.5282011, 'binary_precision': 0.025121234, 'binary_recall': 0.46953937, 'binary_specificity': 0.32124868, 'binary_f1_score': 0.047690917}
confusion matrix:
      0      1
0  5804  12263
1   357    316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.42105263, 'precision': 0.5834403, 'recall': 0.67255294, 'specificity': 0.67255294, 'f1': 0.39957845, 'auroc': 0.9701946, 'binary_precision': 0.16688062, 'binary_recall': 1.0, 'binary_specificity': 0.34510595, 'binary_f1_score': 0.28602862}
confusion matrix:
      0     1
0  2052  3894
1     0   780
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_27.png
early stop counter: 26
val acc:0.3265741765499115, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 27,now: 2024-06-11 07:20:07.111004,epoch time: 0:15:07.927442,used: 6:50:53.383616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.52939916, 'precision': 0.5803965, 'recall': 0.735716, 'specificity': 0.735716, 'f1': 0.4652608, 'auroc': 0.9580285, 'binary_precision': 0.16313301, 'binary_recall': 0.9889043, 'binary_specificity': 0.4825277, 'binary_f1_score': 0.28006548}
confusion matrix:
       0      1
0  20464  21946
1     48   4278
---- Validation: 
scalar performance:
{'acc': 0.29925293, 'precision': 0.4803572, 'recall': 0.3805093, 'specificity': 0.3805093, 'f1': 0.24605298, 'auroc': 0.50283176, 'binary_precision': 0.02406601, 'binary_recall': 0.4680535, 'binary_specificity': 0.29296508, 'binary_f1_score': 0.04577823}
confusion matrix:
      0      1
0  5293  12774
1   358    315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.45539698, 'precision': 0.5877785, 'recall': 0.6919778, 'specificity': 0.6919778, 'f1': 0.42677292, 'auroc': 0.9736907, 'binary_precision': 0.17555706, 'binary_recall': 1.0, 'binary_specificity': 0.3839556, 'binary_f1_score': 0.29867893}
confusion matrix:
      0     1
0  2283  3663
1     0   780
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_28.png
early stop counter: 27
val acc:0.2992529273033142, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 28,now: 2024-06-11 07:35:14.737363,epoch time: 0:15:07.626359,used: 7:06:01.009975,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.49567786, 'precision': 0.5759849, 'recall': 0.71796584, 'specificity': 0.71796584, 'f1': 0.44118857, 'auroc': 0.9438319, 'binary_precision': 0.15408398, 'binary_recall': 0.9907536, 'binary_specificity': 0.44517803, 'binary_f1_score': 0.26669154}
confusion matrix:
       0      1
0  18880  23530
1     40   4286
---- Validation: 
scalar performance:
{'acc': 0.28201708, 'precision': 0.4782639, 'recall': 0.3722856, 'specificity': 0.3722856, 'f1': 0.234846, 'auroc': 0.44449946, 'binary_precision': 0.023557477, 'binary_recall': 0.46953937, 'binary_specificity': 0.27503183, 'binary_f1_score': 0.04486406}
confusion matrix:
      0      1
0  4969  13098
1   357    316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.42685103, 'precision': 0.5841424, 'recall': 0.6758325, 'specificity': 0.6758325, 'f1': 0.40421605, 'auroc': 0.9623137, 'binary_precision': 0.16828479, 'binary_recall': 1.0, 'binary_specificity': 0.351665, 'binary_f1_score': 0.28808865}
confusion matrix:
      0     1
0  2091  3855
1     0   780
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_29.png
early stop counter: 28
val acc:0.2820170819759369, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 29,now: 2024-06-11 07:50:19.265774,epoch time: 0:15:04.528411,used: 7:21:05.538386,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.42847055, 'precision': 0.5682031, 'recall': 0.68156374, 'specificity': 0.68156374, 'f1': 0.3920234, 'auroc': 0.9341552, 'binary_precision': 0.13856238, 'binary_recall': 0.99213874, 'binary_specificity': 0.37098867, 'binary_f1_score': 0.24316438}
confusion matrix:
       0      1
0  15734  26677
1     34   4291
---- Validation: 
scalar performance:
{'acc': 0.25005338, 'precision': 0.47363737, 'recall': 0.35642368, 'specificity': 0.35642368, 'f1': 0.21327232, 'auroc': 0.36178577, 'binary_precision': 0.022618623, 'binary_recall': 0.47102526, 'binary_specificity': 0.24182211, 'binary_f1_score': 0.043164488}
confusion matrix:
      0      1
0  4369  13698
1   356    317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.34730896, 'precision': 0.5754352, 'recall': 0.63084424, 'specificity': 0.63084424, 'f1': 0.3385038, 'auroc': 0.9351427, 'binary_precision': 0.15087041, 'binary_recall': 1.0, 'binary_specificity': 0.26168853, 'binary_f1_score': 0.2621849}
confusion matrix:
      0     1
0  1556  4390
1     0   780
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_30.png
early stop counter: 29
val acc:0.25005337595939636, best validation acc: 0.7532017230987549, corresponding to test acc:                         0.9620873928070068 / 0.9620873928070068
after epoch: 30,now: 2024-06-11 08:05:27.100453,epoch time: 0:15:07.834679,used: 7:36:13.373065,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_00_29_13_seed_1_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:36:13.373065 at 2024-06-11 08:05:27.100453
persisted model performance metric: 

scalar performance:
{'acc': 0.96045196, 'precision': 0.8759853, 'recall': 0.9664933, 'specificity': 0.9664933, 'f1': 0.9141313, 'auroc': 0.99184203, 'binary_precision': 0.7554672, 'binary_recall': 0.974359, 'binary_specificity': 0.95862764, 'binary_f1_score': 0.8510638}
confusion matrix:
      0    1
0  5700  246
1    20  760
oracle model performance metric: 

scalar performance:
{'acc': 0.96015465, 'precision': 0.87490714, 'recall': 0.967439, 'specificity': 0.967439, 'f1': 0.9137309, 'auroc': 0.99242043, 'binary_precision': 0.75296444, 'binary_recall': 0.97692305, 'binary_specificity': 0.95795494, 'binary_f1_score': 0.8504464}
confusion matrix:
      0    1
0  5696  250
1    18  762
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 496946 KiB |  11071 MiB |   3556 TiB |   3556 TiB |
|       from large pool | 407040 KiB |  10998 MiB |   3550 TiB |   3550 TiB |
|       from small pool |  89906 KiB |    123 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 496946 KiB |  11071 MiB |   3556 TiB |   3556 TiB |
|       from large pool | 407040 KiB |  10998 MiB |   3550 TiB |   3550 TiB |
|       from small pool |  89906 KiB |    123 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476595 KiB |  10961 MiB |   3540 TiB |   3540 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   3534 TiB |   3534 TiB |
|       from small pool |  88755 KiB |    122 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11392 MiB |  11392 MiB |  20792 MiB |   9400 MiB |
|       from large pool |  11266 MiB |  11266 MiB |  20638 MiB |   9372 MiB |
|       from small pool |    126 MiB |    126 MiB |    154 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1480 MiB |   2595 MiB |   1221 TiB |   1221 TiB |
|       from large pool |   1472 MiB |   2593 MiB |   1215 TiB |   1215 TiB |
|       from small pool |      8 MiB |     26 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3903    |    7088    |  294212 K  |  294208 K  |
|       from large pool |      87    |     909    |  139028 K  |  139028 K  |
|       from small pool |    3816    |    6999    |  155183 K  |  155179 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3903    |    7088    |  294212 K  |  294208 K  |
|       from large pool |      87    |     909    |  139028 K  |  139028 K  |
|       from small pool |    3816    |    6999    |  155183 K  |  155179 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     235    |     235    |     388    |     153    |
|       from large pool |     172    |     172    |     311    |     139    |
|       from small pool |      63    |      63    |      77    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |    2955    |  154133 K  |  154133 K  |
|       from large pool |      24    |      65    |   71905 K  |   71905 K  |
|       from small pool |      53    |    2932    |   82228 K  |   82228 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   3556 TiB |   3556 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   3550 TiB |   3550 TiB |
|       from small pool |      0 KiB |    123 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   3556 TiB |   3556 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   3550 TiB |   3550 TiB |
|       from small pool |      0 KiB |    123 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   3540 TiB |   3540 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   3534 TiB |   3534 TiB |
|       from small pool |      0 KiB |    122 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1966 MiB |  11392 MiB |  20792 MiB |  18826 MiB |
|       from large pool |   1870 MiB |  11266 MiB |  20638 MiB |  18768 MiB |
|       from small pool |     96 MiB |    126 MiB |    154 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1221 TiB |   1221 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1215 TiB |   1215 TiB |
|       from small pool |      0 KiB |     28 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7088    |  294212 K  |  294212 K  |
|       from large pool |       2    |     909    |  139028 K  |  139028 K  |
|       from small pool |       0    |    6999    |  155183 K  |  155183 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7088    |  294212 K  |  294212 K  |
|       from large pool |       2    |     909    |  139028 K  |  139028 K  |
|       from small pool |       0    |    6999    |  155183 K  |  155183 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      83    |     235    |     388    |     305    |
|       from large pool |      35    |     172    |     311    |     276    |
|       from small pool |      48    |      63    |      77    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2955    |  154134 K  |  154134 K  |
|       from large pool |       4    |      65    |   71905 K  |   71905 K  |
|       from small pool |       0    |    2932    |   82229 K  |   82229 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   3556 TiB |   3556 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   3550 TiB |   3550 TiB |
|       from small pool |      0 KiB |    123 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   3556 TiB |   3556 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   3550 TiB |   3550 TiB |
|       from small pool |      0 KiB |    123 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   3540 TiB |   3540 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   3534 TiB |   3534 TiB |
|       from small pool |      0 KiB |    122 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1966 MiB |  11392 MiB |  20792 MiB |  18826 MiB |
|       from large pool |   1870 MiB |  11266 MiB |  20638 MiB |  18768 MiB |
|       from small pool |     96 MiB |    126 MiB |    154 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1221 TiB |   1221 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1215 TiB |   1215 TiB |
|       from small pool |      0 KiB |     28 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7088    |  294212 K  |  294212 K  |
|       from large pool |       2    |     909    |  139028 K  |  139028 K  |
|       from small pool |       0    |    6999    |  155183 K  |  155183 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7088    |  294212 K  |  294212 K  |
|       from large pool |       2    |     909    |  139028 K  |  139028 K  |
|       from small pool |       0    |    6999    |  155183 K  |  155183 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      83    |     235    |     388    |     305    |
|       from large pool |      35    |     172    |     311    |     276    |
|       from small pool |      48    |      63    |      77    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2955    |  154134 K  |  154134 K  |
|       from large pool |       4    |      65    |   71905 K  |   71905 K  |
|       from small pool |       0    |    2932    |   82229 K  |   82229 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201

 Experiment start at: 2024-06-11 08:10:58.891421
before training, model accuracy: 0.17283949255943298
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8952143, 'precision': 0.738286, 'recall': 0.9298891, 'specificity': 0.9298891, 'f1': 0.79065025, 'auroc': 0.98397756, 'binary_precision': 0.47983915, 'binary_recall': 0.97289556, 'binary_specificity': 0.88688254, 'binary_f1_score': 0.64269596}
confusion matrix:
       0     1
0  37524  4786
1    123  4415
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.77622116, 'precision': 0.5291063, 'recall': 0.66436845, 'specificity': 0.66436845, 'f1': 0.5032743, 'auroc': 0.7122048, 'binary_precision': 0.07708578, 'binary_recall': 0.54485047, 'binary_specificity': 0.78388643, 'binary_f1_score': 0.13506278}
confusion matrix:
       0     1
0  14244  3927
1    274   328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.923546, 'precision': 0.79237247, 'recall': 0.94564396, 'specificity': 0.94564396, 'f1': 0.84438837, 'auroc': 0.9885459, 'binary_precision': 0.5881864, 'binary_recall': 0.9738292, 'binary_specificity': 0.9174587, 'binary_f1_score': 0.73340255}
confusion matrix:
      0    1
0  5502  495
1    19  707
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-11 08:26:57.132049,epoch time: 0:15:58.240628,used: 0:15:58.240628,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.88684684, 'precision': 0.7281435, 'recall': 0.9232913, 'specificity': 0.9232913, 'f1': 0.77863145, 'auroc': 0.98464215, 'binary_precision': 0.46012142, 'binary_recall': 0.96849525, 'binary_specificity': 0.8780874, 'binary_f1_score': 0.6238558}
confusion matrix:
       0     1
0  37151  5158
1    143  4396
---- Validation: 
scalar performance:
{'acc': 0.7785117, 'precision': 0.5158888, 'recall': 0.58604985, 'specificity': 0.58604985, 'f1': 0.48647612, 'auroc': 0.5939469, 'binary_precision': 0.057050325, 'binary_recall': 0.38039866, 'binary_specificity': 0.7917011, 'binary_f1_score': 0.099220105}
confusion matrix:
       0     1
0  14386  3785
1    373   229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9355942, 'precision': 0.81367576, 'recall': 0.951792, 'specificity': 0.951792, 'f1': 0.86399364, 'auroc': 0.9919262, 'binary_precision': 0.63092047, 'binary_recall': 0.9724518, 'binary_specificity': 0.93113226, 'binary_f1_score': 0.76531166}
confusion matrix:
      0    1
0  5584  413
1    20  706
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-11 08:42:07.407734,epoch time: 0:15:10.275685,used: 0:31:08.516313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.85788083, 'precision': 0.7001569, 'recall': 0.9104005, 'specificity': 0.9104005, 'f1': 0.7428129, 'auroc': 0.9860034, 'binary_precision': 0.40340805, 'binary_recall': 0.97553986, 'binary_specificity': 0.84526116, 'binary_f1_score': 0.57078385}
confusion matrix:
       0     1
0  35763  6547
1    111  4427
---- Validation: 
scalar performance:
{'acc': 0.73302084, 'precision': 0.51301384, 'recall': 0.581021, 'specificity': 0.581021, 'f1': 0.46744612, 'auroc': 0.5962182, 'binary_precision': 0.051282052, 'binary_recall': 0.41860464, 'binary_specificity': 0.74343735, 'binary_f1_score': 0.09137056}
confusion matrix:
       0     1
0  13509  4662
1    350   252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90361446, 'precision': 0.7636856, 'recall': 0.9417356, 'specificity': 0.9417356, 'f1': 0.8161577, 'auroc': 0.99540085, 'binary_precision': 0.52867645, 'binary_recall': 0.9903581, 'binary_specificity': 0.8931132, 'binary_f1_score': 0.6893576}
confusion matrix:
      0    1
0  5356  641
1     7  719
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_3.png
early stop counter: 1
val acc:0.7330208420753479, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 3,now: 2024-06-11 08:57:20.194842,epoch time: 0:15:12.787108,used: 0:46:21.303421,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.6605618, 'precision': 0.6095631, 'recall': 0.8076478, 'specificity': 0.8076478, 'f1': 0.5649977, 'auroc': 0.9392191, 'binary_precision': 0.22082452, 'binary_recall': 0.9900859, 'binary_specificity': 0.62520975, 'binary_f1_score': 0.36110887}
confusion matrix:
       0      1
0  26452  15857
1     45   4494
---- Validation: 
scalar performance:
{'acc': 0.39381027, 'precision': 0.49152088, 'recall': 0.4347065, 'specificity': 0.4347065, 'f1': 0.30173585, 'auroc': 0.5123123, 'binary_precision': 0.02536551, 'binary_recall': 0.47840533, 'binary_specificity': 0.39100766, 'binary_f1_score': 0.048176646}
confusion matrix:
      0      1
0  7105  11066
1   314    288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6398929, 'precision': 0.61489725, 'recall': 0.7969384, 'specificity': 0.7969384, 'f1': 0.5607319, 'auroc': 0.954201, 'binary_precision': 0.23035316, 'binary_recall': 0.9972452, 'binary_specificity': 0.59663165, 'binary_f1_score': 0.3742569}
confusion matrix:
      0     1
0  3578  2419
1     2   724
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_4.png
early stop counter: 2
val acc:0.3938102722167969, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 4,now: 2024-06-11 09:12:31.608289,epoch time: 0:15:11.413447,used: 1:01:32.716868,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.6637423, 'precision': 0.60960364, 'recall': 0.80704856, 'specificity': 0.80704856, 'f1': 0.56687576, 'auroc': 0.9630132, 'binary_precision': 0.2217922, 'binary_recall': 0.98479843, 'binary_specificity': 0.62929875, 'binary_f1_score': 0.3620459}
confusion matrix:
       0      1
0  26625  15684
1     69   4470
---- Validation: 
scalar performance:
{'acc': 0.43093804, 'precision': 0.49275175, 'recall': 0.44264272, 'specificity': 0.44264272, 'f1': 0.32141367, 'auroc': 0.5281931, 'binary_precision': 0.02577853, 'binary_recall': 0.4551495, 'binary_specificity': 0.43013594, 'binary_f1_score': 0.048793517}
confusion matrix:
      0      1
0  7816  10355
1   328    274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6198126, 'precision': 0.6103731, 'recall': 0.78628814, 'specificity': 0.78628814, 'f1': 0.54559714, 'auroc': 0.9783812, 'binary_precision': 0.22103658, 'binary_recall': 0.9986226, 'binary_specificity': 0.5739536, 'binary_f1_score': 0.36195704}
confusion matrix:
      0     1
0  3442  2555
1     1   725
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_5.png
early stop counter: 3
val acc:0.4309380352497101, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 5,now: 2024-06-11 09:28:06.465896,epoch time: 0:15:34.857607,used: 1:17:07.574475,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.7389643, 'precision': 0.6329198, 'recall': 0.84761286, 'specificity': 0.84761286, 'f1': 0.62657636, 'auroc': 0.9789565, 'binary_precision': 0.26848507, 'binary_recall': 0.98237497, 'binary_specificity': 0.7128507, 'binary_f1_score': 0.42171466}
confusion matrix:
       0      1
0  30160  12149
1     80   4459
---- Validation: 
scalar performance:
{'acc': 0.5326266, 'precision': 0.49909675, 'recall': 0.49276233, 'specificity': 0.49276233, 'f1': 0.3736877, 'auroc': 0.55897737, 'binary_precision': 0.03109938, 'binary_recall': 0.4501661, 'binary_specificity': 0.53535855, 'binary_f1_score': 0.058179475}
confusion matrix:
      0     1
0  9728  8443
1   331   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72527146, 'precision': 0.64108044, 'recall': 0.84600633, 'specificity': 0.84600633, 'f1': 0.62905455, 'auroc': 0.9929791, 'binary_precision': 0.2821609, 'binary_recall': 1.0, 'binary_specificity': 0.69201267, 'binary_f1_score': 0.4401334}
confusion matrix:
      0     1
0  4150  1847
1     0   726
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_6.png
early stop counter: 4
val acc:0.5326266288757324, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 6,now: 2024-06-11 09:43:40.511442,epoch time: 0:15:34.045546,used: 1:32:41.620021,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.72011614, 'precision': 0.62645316, 'recall': 0.8383598, 'specificity': 0.8383598, 'f1': 0.61119473, 'auroc': 0.9778887, 'binary_precision': 0.2552244, 'binary_recall': 0.98501545, 'binary_specificity': 0.6917041, 'binary_f1_score': 0.40540543}
confusion matrix:
       0      1
0  29266  13044
1     68   4470
---- Validation: 
scalar performance:
{'acc': 0.56591916, 'precision': 0.5012607, 'recall': 0.50996006, 'specificity': 0.50996006, 'f1': 0.38997567, 'auroc': 0.5657697, 'binary_precision': 0.03350229, 'binary_recall': 0.4501661, 'binary_specificity': 0.569754, 'binary_f1_score': 0.062363368}
confusion matrix:
       0     1
0  10353  7818
1    331   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6636918, 'precision': 0.6213068, 'recall': 0.81088376, 'specificity': 0.81088376, 'f1': 0.57923776, 'auroc': 0.99306023, 'binary_precision': 0.24288107, 'binary_recall': 0.9986226, 'binary_specificity': 0.6231449, 'binary_f1_score': 0.39073026}
confusion matrix:
      0     1
0  3737  2260
1     1   725
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_7.png
early stop counter: 5
val acc:0.5659191608428955, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 7,now: 2024-06-11 09:59:30.639483,epoch time: 0:15:50.128041,used: 1:48:31.748062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.604679, 'precision': 0.5957262, 'recall': 0.77336526, 'specificity': 0.77336526, 'f1': 0.52277553, 'auroc': 0.9412159, 'binary_precision': 0.19475132, 'binary_recall': 0.98259526, 'binary_specificity': 0.5641353, 'binary_f1_score': 0.32507288}
confusion matrix:
       0      1
0  23868  18441
1     79   4460
---- Validation: 
scalar performance:
{'acc': 0.38432854, 'precision': 0.48997152, 'recall': 0.4233842, 'specificity': 0.4233842, 'f1': 0.295837, 'auroc': 0.5297339, 'binary_precision': 0.024313997, 'binary_recall': 0.4651163, 'binary_specificity': 0.3816521, 'binary_f1_score': 0.04621225}
confusion matrix:
      0      1
0  6935  11236
1   322    280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49248847, 'precision': 0.58772355, 'recall': 0.71552444, 'specificity': 0.71552444, 'f1': 0.4504717, 'auroc': 0.9668665, 'binary_precision': 0.17544708, 'binary_recall': 1.0, 'binary_specificity': 0.43104887, 'binary_f1_score': 0.29851973}
confusion matrix:
      0     1
0  2585  3412
1     0   726
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_8.png
early stop counter: 6
val acc:0.38432854413986206, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 8,now: 2024-06-11 10:15:02.650153,epoch time: 0:15:32.010670,used: 2:04:03.758732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.5365224, 'precision': 0.58387, 'recall': 0.7365204, 'specificity': 0.7365204, 'f1': 0.47358268, 'auroc': 0.9367455, 'binary_precision': 0.17111562, 'binary_recall': 0.9845747, 'binary_specificity': 0.48846608, 'binary_f1_score': 0.29155925}
confusion matrix:
       0      1
0  20667  21643
1     70   4468
---- Validation: 
scalar performance:
{'acc': 0.2987269, 'precision': 0.4826326, 'recall': 0.38237756, 'specificity': 0.38237756, 'f1': 0.24425545, 'auroc': 0.4598279, 'binary_precision': 0.021628208, 'binary_recall': 0.4717608, 'binary_specificity': 0.29299432, 'binary_f1_score': 0.04136023}
confusion matrix:
      0      1
0  5324  12847
1   318    284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.41603452, 'precision': 0.57803094, 'recall': 0.67266965, 'specificity': 0.67266965, 'f1': 0.3916875, 'auroc': 0.9587095, 'binary_precision': 0.1560619, 'binary_recall': 1.0, 'binary_specificity': 0.34533933, 'binary_f1_score': 0.26998883}
confusion matrix:
      0     1
0  2071  3926
1     0   726
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_9.png
early stop counter: 7
val acc:0.298726886510849, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 9,now: 2024-06-11 10:30:29.929356,epoch time: 0:15:27.279203,used: 2:19:31.037935,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.55776125, 'precision': 0.5881581, 'recall': 0.7505412, 'specificity': 0.7505412, 'f1': 0.48934266, 'auroc': 0.94282776, 'binary_precision': 0.17848343, 'binary_recall': 0.98964304, 'binary_specificity': 0.5114394, 'binary_f1_score': 0.30242425}
confusion matrix:
       0      1
0  21639  20671
1     47   4491
---- Validation: 
scalar performance:
{'acc': 0.28897884, 'precision': 0.4817731, 'recall': 0.37894815, 'specificity': 0.37894815, 'f1': 0.23806058, 'auroc': 0.48536602, 'binary_precision': 0.021474697, 'binary_recall': 0.47508305, 'binary_specificity': 0.28281328, 'binary_f1_score': 0.041091956}
confusion matrix:
      0      1
0  5139  13032
1   316    286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.448758, 'precision': 0.58190435, 'recall': 0.69101214, 'specificity': 0.69101214, 'f1': 0.41717598, 'auroc': 0.9638655, 'binary_precision': 0.16380866, 'binary_recall': 1.0, 'binary_specificity': 0.38202435, 'binary_f1_score': 0.28150445}
confusion matrix:
      0     1
0  2291  3706
1     0   726
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_10.png
early stop counter: 8
val acc:0.28897884488105774, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 10,now: 2024-06-11 10:45:54.658683,epoch time: 0:15:24.729327,used: 2:34:55.767262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.57492316, 'precision': 0.59066796, 'recall': 0.7586614, 'specificity': 0.7586614, 'f1': 0.5015133, 'auroc': 0.9368037, 'binary_precision': 0.18404505, 'binary_recall': 0.98656094, 'binary_specificity': 0.5307618, 'binary_f1_score': 0.31021821}
confusion matrix:
       0      1
0  22456  19853
1     61   4478
---- Validation: 
scalar performance:
{'acc': 0.3251478, 'precision': 0.48511285, 'recall': 0.39441958, 'specificity': 0.39441958, 'f1': 0.26077074, 'auroc': 0.47377056, 'binary_precision': 0.022326022, 'binary_recall': 0.46843854, 'binary_specificity': 0.32040063, 'binary_f1_score': 0.04262072}
confusion matrix:
      0      1
0  5822  12349
1   320    282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.47954783, 'precision': 0.5859172, 'recall': 0.7082708, 'specificity': 0.7082708, 'f1': 0.44069237, 'auroc': 0.96061563, 'binary_precision': 0.17183432, 'binary_recall': 1.0, 'binary_specificity': 0.4165416, 'binary_f1_score': 0.29327407}
confusion matrix:
      0     1
0  2498  3499
1     0   726
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_11.png
early stop counter: 9
val acc:0.325147807598114, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 11,now: 2024-06-11 11:01:15.744816,epoch time: 0:15:21.086133,used: 2:50:16.853395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.5462987, 'precision': 0.58492833, 'recall': 0.74055576, 'specificity': 0.74055576, 'f1': 0.48038906, 'auroc': 0.9457763, 'binary_precision': 0.17381464, 'binary_recall': 0.98148966, 'binary_specificity': 0.49962184, 'binary_f1_score': 0.2953287}
confusion matrix:
       0      1
0  21139  21171
1     84   4454
---- Validation: 
scalar performance:
{'acc': 0.32509455, 'precision': 0.48544016, 'recall': 0.39680123, 'specificity': 0.39680123, 'f1': 0.26089045, 'auroc': 0.50656366, 'binary_precision': 0.022551037, 'binary_recall': 0.47342193, 'binary_specificity': 0.3201805, 'binary_f1_score': 0.043051362}
confusion matrix:
      0      1
0  5818  12353
1   317    285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.405325, 'precision': 0.57684165, 'recall': 0.6666667, 'specificity': 0.6666667, 'f1': 0.38321102, 'auroc': 0.96336895, 'binary_precision': 0.15368332, 'binary_recall': 1.0, 'binary_specificity': 0.33333334, 'binary_f1_score': 0.26642203}
confusion matrix:
      0     1
0  1999  3998
1     0   726
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_12.png
early stop counter: 10
val acc:0.3250945508480072, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 12,now: 2024-06-11 11:16:32.377559,epoch time: 0:15:16.632743,used: 3:05:33.486138,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.5676016, 'precision': 0.5890499, 'recall': 0.7537228, 'specificity': 0.7537228, 'f1': 0.4960456, 'auroc': 0.92464435, 'binary_precision': 0.18125406, 'binary_recall': 0.9845781, 'binary_specificity': 0.5228675, 'binary_f1_score': 0.3061483}
confusion matrix:
       0      1
0  22122  20187
1     70   4469
---- Validation: 
scalar performance:
{'acc': 0.3276514, 'precision': 0.48557323, 'recall': 0.39731896, 'specificity': 0.39731896, 'f1': 0.26241666, 'auroc': 0.45963657, 'binary_precision': 0.02256117, 'binary_recall': 0.4717608, 'binary_specificity': 0.3228771, 'binary_f1_score': 0.04306293}
confusion matrix:
      0      1
0  5867  12304
1   318    284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4547077, 'precision': 0.5826503, 'recall': 0.69434714, 'specificity': 0.69434714, 'f1': 0.42175144, 'auroc': 0.92512757, 'binary_precision': 0.16530055, 'binary_recall': 1.0, 'binary_specificity': 0.38869435, 'binary_f1_score': 0.28370455}
confusion matrix:
      0     1
0  2331  3666
1     0   726
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_13.png
early stop counter: 11
val acc:0.32765141129493713, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 13,now: 2024-06-11 11:31:48.139258,epoch time: 0:15:15.761699,used: 3:20:49.247837,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.54023653, 'precision': 0.58518624, 'recall': 0.7405439, 'specificity': 0.7405439, 'f1': 0.4766205, 'auroc': 0.9393816, 'binary_precision': 0.17276822, 'binary_recall': 0.9889819, 'binary_specificity': 0.49210587, 'binary_f1_score': 0.29415044}
confusion matrix:
       0      1
0  20821  21489
1     50   4488
---- Validation: 
scalar performance:
{'acc': 0.2945187, 'precision': 0.48239946, 'recall': 0.38180986, 'specificity': 0.38180986, 'f1': 0.24164459, 'auroc': 0.4861902, 'binary_precision': 0.021643711, 'binary_recall': 0.47508305, 'binary_specificity': 0.28853667, 'binary_f1_score': 0.041401275}
confusion matrix:
      0      1
0  5243  12928
1   316    286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.44206455, 'precision': 0.5810811, 'recall': 0.68726027, 'specificity': 0.68726027, 'f1': 0.41200852, 'auroc': 0.9616803, 'binary_precision': 0.16216215, 'binary_recall': 1.0, 'binary_specificity': 0.3745206, 'binary_f1_score': 0.27906975}
confusion matrix:
      0     1
0  2246  3751
1     0   726
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_14.png
early stop counter: 12
val acc:0.29451870918273926, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 14,now: 2024-06-11 11:47:15.024819,epoch time: 0:15:26.885561,used: 3:36:16.133398,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.509264, 'precision': 0.5810196, 'recall': 0.72467536, 'specificity': 0.72467536, 'f1': 0.45439878, 'auroc': 0.95269835, 'binary_precision': 0.16394697, 'binary_recall': 0.9918466, 'binary_specificity': 0.45750412, 'binary_f1_score': 0.28138286}
confusion matrix:
       0      1
0  19357  22953
1     37   4501
---- Validation: 
scalar performance:
{'acc': 0.2771001, 'precision': 0.48036173, 'recall': 0.37281203, 'specificity': 0.37281203, 'f1': 0.23028056, 'auroc': 0.47664168, 'binary_precision': 0.02112104, 'binary_recall': 0.47508305, 'binary_specificity': 0.27054098, 'binary_f1_score': 0.04044404}
confusion matrix:
      0      1
0  4916  13255
1   316    286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.42525658, 'precision': 0.5787763, 'recall': 0.6772336, 'specificity': 0.6772336, 'f1': 0.3988521, 'auroc': 0.96488583, 'binary_precision': 0.15802093, 'binary_recall': 0.9986226, 'binary_specificity': 0.3558446, 'binary_f1_score': 0.27286413}
confusion matrix:
      0     1
0  2134  3863
1     1   725
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_15.png
early stop counter: 13
val acc:0.2771000862121582, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 15,now: 2024-06-11 12:02:29.837020,epoch time: 0:15:14.812201,used: 3:51:30.945599,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.54638404, 'precision': 0.585753, 'recall': 0.74276257, 'specificity': 0.74276257, 'f1': 0.48086607, 'auroc': 0.9463568, 'binary_precision': 0.1744331, 'binary_recall': 0.9863406, 'binary_specificity': 0.49918458, 'binary_f1_score': 0.296441}
confusion matrix:
       0      1
0  21120  21189
1     62   4477
---- Validation: 
scalar performance:
{'acc': 0.32589358, 'precision': 0.48551655, 'recall': 0.39721397, 'specificity': 0.39721397, 'f1': 0.26138398, 'auroc': 0.47363225, 'binary_precision': 0.022577833, 'binary_recall': 0.47342193, 'binary_specificity': 0.321006, 'binary_f1_score': 0.04310019}
confusion matrix:
      0      1
0  5833  12338
1   317    285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.47791165, 'precision': 0.58541554, 'recall': 0.70674837, 'specificity': 0.70674837, 'f1': 0.43935814, 'auroc': 0.9640385, 'binary_precision': 0.17123288, 'binary_recall': 0.9986226, 'binary_specificity': 0.4148741, 'binary_f1_score': 0.29233873}
confusion matrix:
      0     1
0  2488  3509
1     1   725
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_16.png
early stop counter: 14
val acc:0.3258935809135437, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 16,now: 2024-06-11 12:17:50.526859,epoch time: 0:15:20.689839,used: 4:06:51.635438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.62045336, 'precision': 0.5994259, 'recall': 0.7832787, 'specificity': 0.7832787, 'f1': 0.5345825, 'auroc': 0.9723996, 'binary_precision': 0.20156856, 'binary_recall': 0.985239, 'binary_specificity': 0.5813184, 'binary_f1_score': 0.33466792}
confusion matrix:
       0      1
0  24595  17714
1     67   4472
---- Validation: 
scalar performance:
{'acc': 0.37468705, 'precision': 0.48963583, 'recall': 0.4216159, 'specificity': 0.4216159, 'f1': 0.29051954, 'auroc': 0.52032906, 'binary_precision': 0.024263136, 'binary_recall': 0.4717608, 'binary_specificity': 0.37147102, 'binary_f1_score': 0.046152595}
confusion matrix:
      0      1
0  6750  11421
1   318    284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60345083, 'precision': 0.60654783, 'recall': 0.77651155, 'specificity': 0.77651155, 'f1': 0.5331426, 'auroc': 0.9868527, 'binary_precision': 0.21369539, 'binary_recall': 0.9972452, 'binary_specificity': 0.5557779, 'binary_f1_score': 0.35196888}
confusion matrix:
      0     1
0  3333  2664
1     2   724
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_17.png
early stop counter: 15
val acc:0.3746870458126068, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 17,now: 2024-06-11 12:33:09.395216,epoch time: 0:15:18.868357,used: 4:22:10.503795,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.55654454, 'precision': 0.5881682, 'recall': 0.75045776, 'specificity': 0.75045776, 'f1': 0.48857313, 'auroc': 0.96542585, 'binary_precision': 0.17823313, 'binary_recall': 0.9909652, 'binary_specificity': 0.50995034, 'binary_f1_score': 0.30212638}
confusion matrix:
       0      1
0  21576  20734
1     41   4497
---- Validation: 
scalar performance:
{'acc': 0.3176903, 'precision': 0.48471856, 'recall': 0.39297646, 'specificity': 0.39297646, 'f1': 0.2562919, 'auroc': 0.49374437, 'binary_precision': 0.022305705, 'binary_recall': 0.47342193, 'binary_specificity': 0.31253096, 'binary_f1_score': 0.042604078}
confusion matrix:
      0      1
0  5679  12492
1   317    285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4573851, 'precision': 0.5829904, 'recall': 0.6958479, 'specificity': 0.6958479, 'f1': 0.42380515, 'auroc': 0.97777593, 'binary_precision': 0.1659808, 'binary_recall': 1.0, 'binary_specificity': 0.39169586, 'binary_f1_score': 0.28470588}
confusion matrix:
      0     1
0  2349  3648
1     0   726
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_18.png
early stop counter: 16
val acc:0.31769031286239624, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 18,now: 2024-06-11 12:48:40.394041,epoch time: 0:15:30.998825,used: 4:37:41.502620,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.5902493, 'precision': 0.59381896, 'recall': 0.7680316, 'specificity': 0.7680316, 'f1': 0.5128067, 'auroc': 0.96709645, 'binary_precision': 0.1898777, 'binary_recall': 0.98854375, 'binary_specificity': 0.54751945, 'binary_f1_score': 0.31856585}
confusion matrix:
       0      1
0  23165  19144
1     52   4487
---- Validation: 
scalar performance:
{'acc': 0.3677622, 'precision': 0.48886973, 'recall': 0.41643268, 'specificity': 0.41643268, 'f1': 0.28636968, 'auroc': 0.50714594, 'binary_precision': 0.023835685, 'binary_recall': 0.46843854, 'binary_specificity': 0.36442682, 'binary_f1_score': 0.045363147}
confusion matrix:
      0      1
0  6622  11549
1   320    282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.47761416, 'precision': 0.5850966, 'recall': 0.70597625, 'specificity': 0.70597625, 'f1': 0.4390387, 'auroc': 0.9704868, 'binary_precision': 0.1709967, 'binary_recall': 0.9972452, 'binary_specificity': 0.41470736, 'binary_f1_score': 0.29193547}
confusion matrix:
      0     1
0  2487  3510
1     2   724
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_19.png
early stop counter: 17
val acc:0.3677622079849243, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 19,now: 2024-06-11 13:04:09.094014,epoch time: 0:15:28.699973,used: 4:53:10.202593,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.49792948, 'precision': 0.57810634, 'recall': 0.71495277, 'specificity': 0.71495277, 'f1': 0.44560033, 'auroc': 0.93765604, 'binary_precision': 0.16001576, 'binary_recall': 0.9841375, 'binary_specificity': 0.44576803, 'binary_f1_score': 0.27527347}
confusion matrix:
       0      1
0  18860  23449
1     72   4467
---- Validation: 
scalar performance:
{'acc': 0.35401908, 'precision': 0.48804706, 'recall': 0.41174263, 'specificity': 0.41174263, 'f1': 0.2784324, 'auroc': 0.47799388, 'binary_precision': 0.023563456, 'binary_recall': 0.47342193, 'binary_specificity': 0.3500633, 'binary_f1_score': 0.044892494}
confusion matrix:
      0      1
0  6361  11810
1   317    285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.40547374, 'precision': 0.57653487, 'recall': 0.6661447, 'specificity': 0.6661447, 'f1': 0.3832571, 'auroc': 0.95886517, 'binary_precision': 0.15356916, 'binary_recall': 0.9986226, 'binary_specificity': 0.33366683, 'binary_f1_score': 0.2662016}
confusion matrix:
      0     1
0  2001  3996
1     1   725
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_20.png
early stop counter: 18
val acc:0.35401907563209534, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 20,now: 2024-06-11 13:19:48.470081,epoch time: 0:15:39.376067,used: 5:08:49.578660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.53628755, 'precision': 0.58392197, 'recall': 0.73658276, 'specificity': 0.73658276, 'f1': 0.47346598, 'auroc': 0.9446609, 'binary_precision': 0.17112565, 'binary_recall': 0.98501873, 'binary_specificity': 0.48814672, 'binary_f1_score': 0.29159328}
confusion matrix:
       0      1
0  20653  21656
1     68   4471
---- Validation: 
scalar performance:
{'acc': 0.37948117, 'precision': 0.49011728, 'recall': 0.42489544, 'specificity': 0.42489544, 'f1': 0.29335237, 'auroc': 0.49275753, 'binary_precision': 0.024533013, 'binary_recall': 0.47342193, 'binary_specificity': 0.37636894, 'binary_f1_score': 0.046648663}
confusion matrix:
      0      1
0  6839  11332
1   317    285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.46348357, 'precision': 0.5837757, 'recall': 0.6992663, 'specificity': 0.6992663, 'f1': 0.42847145, 'auroc': 0.97141576, 'binary_precision': 0.16755135, 'binary_recall': 1.0, 'binary_specificity': 0.3985326, 'binary_f1_score': 0.28701323}
confusion matrix:
      0     1
0  2390  3607
1     0   726
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_21.png
early stop counter: 19
val acc:0.37948116660118103, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 21,now: 2024-06-11 13:35:36.759467,epoch time: 0:15:48.289386,used: 5:24:37.868046,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.46853656, 'precision': 0.5755628, 'recall': 0.70202315, 'specificity': 0.70202315, 'f1': 0.42458168, 'auroc': 0.9391087, 'binary_precision': 0.15329859, 'binary_recall': 0.9916281, 'binary_specificity': 0.41241816, 'binary_f1_score': 0.26554573}
confusion matrix:
       0      1
0  17449  24860
1     38   4501
---- Validation: 
scalar performance:
{'acc': 0.2883929, 'precision': 0.4817057, 'recall': 0.37864548, 'specificity': 0.37864548, 'f1': 0.23767987, 'auroc': 0.41402847, 'binary_precision': 0.021456974, 'binary_recall': 0.47508305, 'binary_specificity': 0.2822079, 'binary_f1_score': 0.041059505}
confusion matrix:
      0      1
0  5128  13043
1   316    286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.36174327, 'precision': 0.572354, 'recall': 0.6422378, 'specificity': 0.6422378, 'f1': 0.34788692, 'auroc': 0.93735856, 'binary_precision': 0.144708, 'binary_recall': 1.0, 'binary_specificity': 0.28447556, 'binary_f1_score': 0.25282952}
confusion matrix:
      0     1
0  1706  4291
1     0   726
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_22.png
early stop counter: 20
val acc:0.28839290142059326, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 22,now: 2024-06-11 13:52:37.854625,epoch time: 0:17:01.095158,used: 5:41:38.963204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.5014515, 'precision': 0.57970786, 'recall': 0.7197545, 'specificity': 0.7197545, 'f1': 0.44863182, 'auroc': 0.9489724, 'binary_precision': 0.16167428, 'binary_recall': 0.99052656, 'binary_specificity': 0.44898248, 'binary_f1_score': 0.277977}
confusion matrix:
       0      1
0  18996  23313
1     43   4496
---- Validation: 
scalar performance:
{'acc': 0.33654717, 'precision': 0.48651, 'recall': 0.40271723, 'specificity': 0.40271723, 'f1': 0.267915, 'auroc': 0.45946336, 'binary_precision': 0.02294132, 'binary_recall': 0.47342193, 'binary_specificity': 0.33201253, 'binary_f1_score': 0.043762}
confusion matrix:
      0      1
0  6033  12138
1   317    285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.40101147, 'precision': 0.5763728, 'recall': 0.6642488, 'specificity': 0.6642488, 'f1': 0.37977594, 'auroc': 0.9467259, 'binary_precision': 0.15274563, 'binary_recall': 1.0, 'binary_specificity': 0.3284976, 'binary_f1_score': 0.26501188}
confusion matrix:
      0     1
0  1970  4027
1     0   726
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_23.png
early stop counter: 21
val acc:0.3365471661090851, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 23,now: 2024-06-11 14:08:13.675507,epoch time: 0:15:35.820882,used: 5:57:14.784086,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.5478142, 'precision': 0.586889, 'recall': 0.7460128, 'specificity': 0.7460128, 'f1': 0.48234996, 'auroc': 0.9700738, 'binary_precision': 0.17552342, 'binary_recall': 0.9918484, 'binary_specificity': 0.50017726, 'binary_f1_score': 0.2982642}
confusion matrix:
       0      1
0  21162  21147
1     37   4502
---- Validation: 
scalar performance:
{'acc': 0.36957332, 'precision': 0.4896496, 'recall': 0.42218655, 'specificity': 0.42218655, 'f1': 0.28777653, 'auroc': 0.49350014, 'binary_precision': 0.02438818, 'binary_recall': 0.47840533, 'binary_specificity': 0.36596775, 'binary_f1_score': 0.046410445}
confusion matrix:
      0      1
0  6650  11521
1   314    288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.47106946, 'precision': 0.5847735, 'recall': 0.7035184, 'specificity': 0.7035184, 'f1': 0.4342546, 'auroc': 0.98116124, 'binary_precision': 0.16954695, 'binary_recall': 1.0, 'binary_specificity': 0.40703684, 'binary_f1_score': 0.2899361}
confusion matrix:
      0     1
0  2441  3556
1     0   726
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_24.png
early stop counter: 22
val acc:0.36957332491874695, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 24,now: 2024-06-11 14:25:38.604907,epoch time: 0:17:24.929400,used: 6:14:39.713486,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.47649845, 'precision': 0.57666206, 'recall': 0.7067382, 'specificity': 0.7067382, 'f1': 0.4304641, 'auroc': 0.936774, 'binary_precision': 0.15528421, 'binary_recall': 0.99228567, 'binary_specificity': 0.4211907, 'binary_f1_score': 0.26854363}
confusion matrix:
       0      1
0  17821  24490
1     35   4502
---- Validation: 
scalar performance:
{'acc': 0.28610238, 'precision': 0.4815577, 'recall': 0.37826532, 'specificity': 0.37826532, 'f1': 0.23623312, 'auroc': 0.4299652, 'binary_precision': 0.021459548, 'binary_recall': 0.47674417, 'binary_specificity': 0.27978647, 'binary_f1_score': 0.041070405}
confusion matrix:
      0      1
0  5084  13087
1   315    287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.38435224, 'precision': 0.5746146, 'recall': 0.6549108, 'specificity': 0.6549108, 'f1': 0.3663888, 'auroc': 0.9454771, 'binary_precision': 0.14922918, 'binary_recall': 1.0, 'binary_specificity': 0.30982158, 'binary_f1_score': 0.2597031}
confusion matrix:
      0     1
0  1858  4139
1     0   726
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_25.png
early stop counter: 23
val acc:0.28610238432884216, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 25,now: 2024-06-11 14:41:17.400338,epoch time: 0:15:38.795431,used: 6:30:18.508917,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.5212816, 'precision': 0.5824796, 'recall': 0.7305366, 'specificity': 0.7305366, 'f1': 0.46300578, 'auroc': 0.9496629, 'binary_precision': 0.16721238, 'binary_recall': 0.9900859, 'binary_specificity': 0.47098726, 'binary_f1_score': 0.28610536}
confusion matrix:
       0      1
0  19927  22382
1     45   4494
---- Validation: 
scalar performance:
{'acc': 0.32338998, 'precision': 0.4852762, 'recall': 0.3959207, 'specificity': 0.3959207, 'f1': 0.25983578, 'auroc': 0.4657982, 'binary_precision': 0.022494081, 'binary_recall': 0.47342193, 'binary_specificity': 0.31841946, 'binary_f1_score': 0.04294756}
confusion matrix:
      0      1
0  5786  12385
1   317    285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.41856313, 'precision': 0.57769084, 'recall': 0.67287636, 'specificity': 0.67287636, 'f1': 0.39352584, 'auroc': 0.9644939, 'binary_precision': 0.15633772, 'binary_recall': 0.9972452, 'binary_specificity': 0.34850758, 'binary_f1_score': 0.27030054}
confusion matrix:
      0     1
0  2090  3907
1     2   724
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_26.png
early stop counter: 24
val acc:0.3233899772167206, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 26,now: 2024-06-11 14:56:11.672428,epoch time: 0:14:54.272090,used: 6:45:12.781007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.5156677, 'precision': 0.5815792, 'recall': 0.72723186, 'specificity': 0.72723186, 'f1': 0.4589008, 'auroc': 0.9554217, 'binary_precision': 0.16554266, 'binary_recall': 0.9896453, 'binary_specificity': 0.46481836, 'binary_f1_score': 0.28363958}
confusion matrix:
       0      1
0  19666  22643
1     47   4492
---- Validation: 
scalar performance:
{'acc': 0.27832526, 'precision': 0.48039278, 'recall': 0.37264186, 'specificity': 0.37264186, 'f1': 0.23104581, 'auroc': 0.41544074, 'binary_precision': 0.021086121, 'binary_recall': 0.47342193, 'binary_specificity': 0.27186176, 'binary_f1_score': 0.040373992}
confusion matrix:
      0      1
0  4940  13231
1   317    285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.43685853, 'precision': 0.58045214, 'recall': 0.68434215, 'specificity': 0.68434215, 'f1': 0.4079739, 'auroc': 0.96251905, 'binary_precision': 0.16090426, 'binary_recall': 1.0, 'binary_specificity': 0.36868435, 'binary_f1_score': 0.27720505}
confusion matrix:
      0     1
0  2211  3786
1     0   726
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_27.png
early stop counter: 25
val acc:0.27832525968551636, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 27,now: 2024-06-11 15:11:20.594313,epoch time: 0:15:08.921885,used: 7:00:21.702892,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.5223489, 'precision': 0.5822876, 'recall': 0.7302474, 'specificity': 0.7302474, 'f1': 0.46360928, 'auroc': 0.9368173, 'binary_precision': 0.16726974, 'binary_recall': 0.98810047, 'binary_specificity': 0.47239423, 'binary_f1_score': 0.2861062}
confusion matrix:
       0      1
0  19987  22323
1     54   4484
---- Validation: 
scalar performance:
{'acc': 0.32445532, 'precision': 0.48537883, 'recall': 0.39647102, 'specificity': 0.39647102, 'f1': 0.26049525, 'auroc': 0.46314734, 'binary_precision': 0.022529645, 'binary_recall': 0.47342193, 'binary_specificity': 0.31952012, 'binary_f1_score': 0.043012377}
confusion matrix:
      0      1
0  5806  12365
1   317    285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.44548565, 'precision': 0.58149976, 'recall': 0.68917793, 'specificity': 0.68917793, 'f1': 0.41465238, 'auroc': 0.9611824, 'binary_precision': 0.16299956, 'binary_recall': 1.0, 'binary_specificity': 0.37835583, 'binary_f1_score': 0.2803089}
confusion matrix:
      0     1
0  2269  3728
1     0   726
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_28.png
early stop counter: 26
val acc:0.3244553208351135, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 28,now: 2024-06-11 15:28:05.268861,epoch time: 0:16:44.674548,used: 7:17:06.377440,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.51724726, 'precision': 0.5824478, 'recall': 0.7297781, 'specificity': 0.7297781, 'f1': 0.46033162, 'auroc': 0.9578765, 'binary_precision': 0.16641447, 'binary_recall': 0.9933906, 'binary_specificity': 0.4661656, 'binary_f1_score': 0.28507304}
confusion matrix:
       0      1
0  19723  22586
1     30   4509
---- Validation: 
scalar performance:
{'acc': 0.28679487, 'precision': 0.48246157, 'recall': 0.38424438, 'specificity': 0.38424438, 'f1': 0.2369962, 'auroc': 0.44194773, 'binary_precision': 0.021981308, 'binary_recall': 0.4883721, 'binary_specificity': 0.28011668, 'binary_f1_score': 0.042069115}
confusion matrix:
      0      1
0  5090  13081
1   308    294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.42957014, 'precision': 0.5795878, 'recall': 0.6802568, 'specificity': 0.6802568, 'f1': 0.40230143, 'auroc': 0.9540601, 'binary_precision': 0.15917562, 'binary_recall': 1.0, 'binary_specificity': 0.3605136, 'binary_f1_score': 0.27463588}
confusion matrix:
      0     1
0  2162  3835
1     0   726
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_29.png
early stop counter: 27
val acc:0.28679487109184265, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 29,now: 2024-06-11 15:45:16.203579,epoch time: 0:17:10.934718,used: 7:34:17.312158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.49058658, 'precision': 0.57906604, 'recall': 0.7159089, 'specificity': 0.7159089, 'f1': 0.44103107, 'auroc': 0.94230384, 'binary_precision': 0.159268, 'binary_recall': 0.9953724, 'binary_specificity': 0.4364453, 'binary_f1_score': 0.274598}
confusion matrix:
       0      1
0  18466  23844
1     21   4517
---- Validation: 
scalar performance:
{'acc': 0.2662867, 'precision': 0.4793524, 'recall': 0.36963534, 'specificity': 0.36963534, 'f1': 0.22320634, 'auroc': 0.4128359, 'binary_precision': 0.021018181, 'binary_recall': 0.48006645, 'binary_specificity': 0.25920424, 'binary_f1_score': 0.040273134}
confusion matrix:
      0      1
0  4710  13461
1   313    289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.39178938, 'precision': 0.5753894, 'recall': 0.65907955, 'specificity': 0.65907955, 'f1': 0.3723895, 'auroc': 0.9333453, 'binary_precision': 0.15077882, 'binary_recall': 1.0, 'binary_specificity': 0.31815907, 'binary_f1_score': 0.26204658}
confusion matrix:
      0     1
0  1908  4089
1     0   726
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277201_30.png
early stop counter: 28
val acc:0.266286700963974, best validation acc: 0.7785117030143738, corresponding to test acc:                         0.9355942010879517 / 0.9355942010879517
after epoch: 30,now: 2024-06-11 16:04:22.110070,epoch time: 0:19:05.906491,used: 7:53:23.218649,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_08_10_58_seed_2_21277201
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:53:23.218649 at 2024-06-11 16:04:22.110070
persisted model performance metric: 

scalar performance:
{'acc': 0.9300907, 'precision': 0.8035437, 'recall': 0.9511285, 'specificity': 0.9511285, 'f1': 0.85532564, 'auroc': 0.99042475, 'binary_precision': 0.6099656, 'binary_recall': 0.9779614, 'binary_specificity': 0.9242955, 'binary_f1_score': 0.75132275}
confusion matrix:
      0    1
0  5543  454
1    16  710
oracle model performance metric: 

scalar performance:
{'acc': 0.93856907, 'precision': 0.8190005, 'recall': 0.9601182, 'specificity': 0.9601182, 'f1': 0.87039375, 'auroc': 0.9954345, 'binary_precision': 0.6396075, 'binary_recall': 0.9876033, 'binary_specificity': 0.932633, 'binary_f1_score': 0.7763941}
confusion matrix:
      0    1
0  5593  404
1     9  717
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 495986 KiB |  11071 MiB |   5330 TiB |   5330 TiB |
|       from large pool | 406080 KiB |  10998 MiB |   5321 TiB |   5321 TiB |
|       from small pool |  89906 KiB |    123 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 495986 KiB |  11071 MiB |   5330 TiB |   5330 TiB |
|       from large pool | 406080 KiB |  10998 MiB |   5321 TiB |   5321 TiB |
|       from small pool |  89906 KiB |    123 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476595 KiB |  10961 MiB |   5307 TiB |   5307 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   5298 TiB |   5298 TiB |
|       from small pool |  88755 KiB |    122 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11238 MiB |  11392 MiB |  30064 MiB |  18826 MiB |
|       from large pool |  11112 MiB |  11266 MiB |  29880 MiB |  18768 MiB |
|       from small pool |    126 MiB |    126 MiB |    184 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1347 MiB |   2595 MiB |   1802 TiB |   1802 TiB |
|       from large pool |   1339 MiB |   2593 MiB |   1792 TiB |   1792 TiB |
|       from small pool |      8 MiB |     28 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3903    |    7102    |  441134 K  |  441130 K  |
|       from large pool |      87    |     909    |  208417 K  |  208417 K  |
|       from small pool |    3816    |    7013    |  232717 K  |  232713 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3903    |    7102    |  441134 K  |  441130 K  |
|       from large pool |      87    |     909    |  208417 K  |  208417 K  |
|       from small pool |    3816    |    7013    |  232717 K  |  232713 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     235    |     235    |     540    |     305    |
|       from large pool |     172    |     172    |     448    |     276    |
|       from small pool |      63    |      63    |      92    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |    2963    |  231944 K  |  231944 K  |
|       from large pool |      24    |      65    |  108588 K  |  108588 K  |
|       from small pool |      53    |    2938    |  123356 K  |  123356 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   5330 TiB |   5330 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   5321 TiB |   5321 TiB |
|       from small pool |      0 KiB |    123 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   5330 TiB |   5330 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   5321 TiB |   5321 TiB |
|       from small pool |      0 KiB |    123 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   5307 TiB |   5307 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   5298 TiB |   5298 TiB |
|       from small pool |      0 KiB |    122 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1832 MiB |  11392 MiB |  30064 MiB |  28232 MiB |
|       from large pool |   1736 MiB |  11266 MiB |  29880 MiB |  28144 MiB |
|       from small pool |     96 MiB |    126 MiB |    184 MiB |     88 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   2595 MiB |   1802 TiB |   1802 TiB |
|       from large pool | 134912 KiB |   2593 MiB |   1792 TiB |   1792 TiB |
|       from small pool |      0 KiB |     32 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7102    |  441134 K  |  441134 K  |
|       from large pool |       2    |     909    |  208417 K  |  208417 K  |
|       from small pool |       0    |    7013    |  232717 K  |  232717 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7102    |  441134 K  |  441134 K  |
|       from large pool |       2    |     909    |  208417 K  |  208417 K  |
|       from small pool |       0    |    7013    |  232717 K  |  232717 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     235    |     540    |     458    |
|       from large pool |      34    |     172    |     448    |     414    |
|       from small pool |      48    |      63    |      92    |      44    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2963    |  231945 K  |  231945 K  |
|       from large pool |       4    |      65    |  108588 K  |  108588 K  |
|       from small pool |       0    |    2938    |  123357 K  |  123357 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jun 11 16:05:47 2024]
Finished job 0.
1 of 1 steps (100%) done
