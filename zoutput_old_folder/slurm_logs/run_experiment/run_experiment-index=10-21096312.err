Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jun  4 21:41:10 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/10.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=10
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312

 Experiment start at: 2024-06-04 21:50:26.837845
before training, model accuracy: 0.2401725947856903
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96211636, 'precision': 0.55845606, 'recall': 0.510905, 'specificity': 0.510905, 'f1': 0.513339, 'auroc': 0.6093095, 'binary_precision': 0.14981273, 'binary_recall': 0.027173912, 'binary_specificity': 0.9946361, 'binary_f1_score': 0.046003446}
confusion matrix:
       0    1
0  42093  227
1   1432   40
---- Validation: 
scalar performance:
{'acc': 0.95540655, 'precision': 0.49266464, 'recall': 0.497628, 'specificity': 0.497628, 'f1': 0.49332306, 'auroc': 0.5176467, 'binary_precision': 0.019704433, 'binary_recall': 0.00622084, 'binary_specificity': 0.9890352, 'binary_f1_score': 0.009456266}
confusion matrix:
       0    1
0  17950  199
1    639    4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9493448, 'precision': 0.48765293, 'recall': 0.49716336, 'specificity': 0.49716336, 'f1': 0.49013978, 'auroc': 0.51471007, 'binary_precision': 0.01724138, 'binary_recall': 0.0038314175, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.006269592}
confusion matrix:
      0   1
0  5940  57
1   260   1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-04 22:09:02.177468,epoch time: 0:18:35.339623,used: 0:18:35.339623,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9661354, 'precision': 0.7059348, 'recall': 0.5156066, 'specificity': 0.5156066, 'f1': 0.5217774, 'auroc': 0.72419345, 'binary_precision': 0.44444445, 'binary_recall': 0.032630865, 'binary_specificity': 0.99858224, 'binary_f1_score': 0.060797974}
confusion matrix:
       0   1
0  42261  60
1   1423  48
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.6116711, 'recall': 0.50628215, 'specificity': 0.50628215, 'f1': 0.50433266, 'auroc': 0.6549897, 'binary_precision': 0.25714287, 'binary_recall': 0.01399689, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.026548672}
confusion matrix:
       0   1
0  18123  26
1    634   9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95621604, 'precision': 0.4791033, 'recall': 0.49891612, 'specificity': 0.49891612, 'f1': 0.48880902, 'auroc': 0.669796, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5984  13
1   261   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-04 22:26:21.463053,epoch time: 0:17:19.285585,used: 0:35:54.625208,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.7214061, 'recall': 0.5032691, 'specificity': 0.5032691, 'f1': 0.49815345, 'auroc': 0.800982, 'binary_precision': 0.47619048, 'binary_recall': 0.0067980965, 'binary_specificity': 0.99974006, 'binary_f1_score': 0.013404826}
confusion matrix:
       0   1
0  42310  11
1   1461  10
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.56624615, 'recall': 0.50063986, 'specificity': 0.50063986, 'f1': 0.4927822, 'auroc': 0.77579665, 'binary_precision': 0.16666667, 'binary_recall': 0.00155521, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.0030816644}
confusion matrix:
       0  1
0  18144  5
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.47914, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.48926792, 'auroc': 0.7745429, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-04 22:43:53.760832,epoch time: 0:17:32.297779,used: 0:53:26.922987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96620387, 'precision': 0.6690541, 'recall': 0.50415885, 'specificity': 0.50415885, 'f1': 0.5000353, 'auroc': 0.8340435, 'binary_precision': 0.37142858, 'binary_recall': 0.008837526, 'binary_specificity': 0.9994802, 'binary_f1_score': 0.017264277}
confusion matrix:
       0   1
0  42299  22
1   1458  13
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.5543405, 'recall': 0.5006123, 'specificity': 0.5006123, 'f1': 0.49276605, 'auroc': 0.8303832, 'binary_precision': 0.14285715, 'binary_recall': 0.00155521, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.0030769233}
confusion matrix:
       0  1
0  18143  6
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.47914, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.48926792, 'auroc': 0.8145147, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_4.png
early stop counter: 1
val acc:0.9655172228813171, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9579737782478333 / 0.9579737782478333
after epoch: 4,now: 2024-06-04 23:01:25.872411,epoch time: 0:17:32.111579,used: 1:10:59.034566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9664779, 'precision': 0.76118577, 'recall': 0.50660443, 'specificity': 0.50660443, 'f1': 0.50473523, 'auroc': 0.8671607, 'binary_precision': 0.5555556, 'binary_recall': 0.013586956, 'binary_specificity': 0.9996219, 'binary_f1_score': 0.0265252}
confusion matrix:
       0   1
0  42304  16
1   1452  20
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.59404784, 'recall': 0.5013624, 'specificity': 0.5013624, 'f1': 0.4942946, 'auroc': 0.84896725, 'binary_precision': 0.22222222, 'binary_recall': 0.00311042, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.006134969}
confusion matrix:
       0  1
0  18142  7
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.9796065, 'recall': 0.5114943, 'specificity': 0.5114943, 'f1': 0.5120629, 'auroc': 0.84715986, 'binary_precision': 1.0, 'binary_recall': 0.022988506, 'binary_specificity': 1.0, 'binary_f1_score': 0.044943817}
confusion matrix:
      0  1
0  5997  0
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_5.png
new oracle model saved
early stop counter: 2
val acc:0.9655172228813171, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9579737782478333 / 0.9592521786689758
after epoch: 5,now: 2024-06-04 23:18:46.145072,epoch time: 0:17:20.272661,used: 1:28:19.307227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.70832264, 'recall': 0.5029334, 'specificity': 0.5029334, 'f1': 0.49750143, 'auroc': 0.8784129, 'binary_precision': 0.45, 'binary_recall': 0.0061266166, 'binary_specificity': 0.9997401, 'binary_f1_score': 0.01208865}
confusion matrix:
       0   1
0  42312  11
1   1460   9
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.6495822, 'recall': 0.5007225, 'specificity': 0.5007225, 'f1': 0.4928307, 'auroc': 0.8428328, 'binary_precision': 0.33333334, 'binary_recall': 0.00155521, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.0030959754}
confusion matrix:
       0  1
0  18147  2
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.97952986, 'recall': 0.5095785, 'specificity': 0.5095785, 'f1': 0.508348, 'auroc': 0.86463225, 'binary_precision': 1.0, 'binary_recall': 0.019157087, 'binary_specificity': 1.0, 'binary_f1_score': 0.037593983}
confusion matrix:
      0  1
0  5997  0
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_6.png
better model found
persisted
after epoch: 6,now: 2024-06-04 23:36:00.258299,epoch time: 0:17:14.113227,used: 1:45:33.420454,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9661354, 'precision': 0.6801884, 'recall': 0.50772613, 'specificity': 0.50772613, 'f1': 0.5070593, 'auroc': 0.8892926, 'binary_precision': 0.39344263, 'binary_recall': 0.01632653, 'binary_specificity': 0.9991258, 'binary_f1_score': 0.031352058}
confusion matrix:
       0   1
0  42285  37
1   1446  24
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.68303776, 'recall': 0.50441766, 'specificity': 0.50441766, 'f1': 0.50037134, 'auroc': 0.8735292, 'binary_precision': 0.4, 'binary_recall': 0.00933126, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.018237082}
confusion matrix:
       0  1
0  18140  9
1    637  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.9054425, 'recall': 0.5323169, 'specificity': 0.5323169, 'f1': 0.55040425, 'auroc': 0.8785778, 'binary_precision': 0.85, 'binary_recall': 0.0651341, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.12099644}
confusion matrix:
      0   1
0  5994   3
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_7.png
new oracle model saved
early stop counter: 1
val acc:0.965623676776886, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.959092378616333 / 0.9605305194854736
after epoch: 7,now: 2024-06-04 23:53:16.589164,epoch time: 0:17:16.330865,used: 2:02:49.751319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96627235, 'precision': 0.71593773, 'recall': 0.51076025, 'specificity': 0.51076025, 'f1': 0.5128038, 'auroc': 0.8963722, 'binary_precision': 0.46478873, 'binary_recall': 0.022418479, 'binary_specificity': 0.99910206, 'binary_f1_score': 0.042773817}
confusion matrix:
       0   1
0  42282  38
1   1439  33
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.6735618, 'recall': 0.5058627, 'specificity': 0.5058627, 'f1': 0.5032725, 'auroc': 0.8759558, 'binary_precision': 0.3809524, 'binary_recall': 0.01244168, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.024096388}
confusion matrix:
       0   1
0  18136  13
1    635   8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.9068279, 'recall': 0.5437278, 'specificity': 0.5437278, 'f1': 0.5699658, 'auroc': 0.89289665, 'binary_precision': 0.8518519, 'binary_recall': 0.08812261, 'binary_specificity': 0.999333, 'binary_f1_score': 0.15972222}
confusion matrix:
      0   1
0  5993   4
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_8.png
new oracle model saved
early stop counter: 2
val acc:0.9655172228813171, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.959092378616333 / 0.9613295197486877
after epoch: 8,now: 2024-06-05 00:10:34.570359,epoch time: 0:17:17.981195,used: 2:20:07.732514,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9662267, 'precision': 0.7139652, 'recall': 0.51335955, 'specificity': 0.51335955, 'f1': 0.51766866, 'auroc': 0.9001379, 'binary_precision': 0.46067417, 'binary_recall': 0.027853262, 'binary_specificity': 0.9988658, 'binary_f1_score': 0.05253043}
confusion matrix:
       0   1
0  42272  48
1   1431  41
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.6832818, 'recall': 0.5117805, 'specificity': 0.5117805, 'f1': 0.51460516, 'auroc': 0.8882576, 'binary_precision': 0.4, 'binary_recall': 0.02488336, 'binary_specificity': 0.9986776, 'binary_f1_score': 0.046852123}
confusion matrix:
       0   1
0  18125  24
1    627  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.9224582, 'recall': 0.5704644, 'specificity': 0.5704644, 'f1': 0.61273694, 'auroc': 0.8836117, 'binary_precision': 0.88095236, 'binary_recall': 0.14176245, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.2442244}
confusion matrix:
      0   1
0  5992   5
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_9.png
new oracle model saved
early stop counter: 3
val acc:0.9653576016426086, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.959092378616333 / 0.9634068608283997
after epoch: 9,now: 2024-06-05 00:27:51.595542,epoch time: 0:17:17.025183,used: 2:37:24.757697,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9660897, 'precision': 0.72139996, 'recall': 0.5385338, 'specificity': 0.5385338, 'f1': 0.55991733, 'auroc': 0.9015715, 'binary_precision': 0.47389558, 'binary_recall': 0.08016305, 'binary_specificity': 0.99690455, 'binary_f1_score': 0.13712958}
confusion matrix:
       0    1
0  42189  131
1   1354  118
---- Validation: 
scalar performance:
{'acc': 0.96482545, 'precision': 0.69311297, 'recall': 0.53400666, 'specificity': 0.53400666, 'f1': 0.55211556, 'auroc': 0.89714074, 'binary_precision': 0.4181818, 'binary_recall': 0.071539655, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.12217795}
confusion matrix:
       0   1
0  18085  64
1    597  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9683605, 'precision': 0.915964, 'recall': 0.64267766, 'specificity': 0.64267766, 'f1': 0.7073811, 'auroc': 0.8985745, 'binary_precision': 0.86206895, 'binary_recall': 0.28735632, 'binary_specificity': 0.997999, 'binary_f1_score': 0.43103448}
confusion matrix:
      0   1
0  5985  12
1   186  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_10.png
new oracle model saved
early stop counter: 4
val acc:0.964825451374054, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.959092378616333 / 0.9683604836463928
after epoch: 10,now: 2024-06-05 00:45:07.395736,epoch time: 0:17:15.800194,used: 2:54:40.557891,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96650076, 'precision': 0.7387397, 'recall': 0.55612296, 'specificity': 0.55612296, 'f1': 0.5859759, 'auroc': 0.9062381, 'binary_precision': 0.5074184, 'binary_recall': 0.11616848, 'binary_specificity': 0.9960775, 'binary_f1_score': 0.18905471}
confusion matrix:
       0    1
0  42154  166
1   1301  171
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.7101968, 'recall': 0.5483679, 'specificity': 0.5483679, 'f1': 0.5736648, 'auroc': 0.89685166, 'binary_precision': 0.4513889, 'binary_recall': 0.10108865, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.16518426}
confusion matrix:
       0   1
0  18070  79
1    578  65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.90987325, 'recall': 0.6596689, 'specificity': 0.6596689, 'f1': 0.72543603, 'auroc': 0.8962361, 'binary_precision': 0.8484849, 'binary_recall': 0.3218391, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.4666667}
confusion matrix:
      0   1
0  5982  15
1   177  84
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_11.png
new oracle model saved
early stop counter: 5
val acc:0.9650382995605469, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.959092378616333 / 0.9693192839622498
after epoch: 11,now: 2024-06-05 01:02:22.187346,epoch time: 0:17:14.791610,used: 3:11:55.349501,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9667063, 'precision': 0.7505237, 'recall': 0.53525925, 'specificity': 0.53525925, 'f1': 0.5555098, 'auroc': 0.90666574, 'binary_precision': 0.5323383, 'binary_recall': 0.07273963, 'binary_specificity': 0.9977789, 'binary_f1_score': 0.12799042}
confusion matrix:
       0    1
0  42227   94
1   1364  107
---- Validation: 
scalar performance:
{'acc': 0.9649851, 'precision': 0.699646, 'recall': 0.53483933, 'specificity': 0.53483933, 'f1': 0.5535675, 'auroc': 0.8976842, 'binary_precision': 0.43119267, 'binary_recall': 0.07309487, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.125}
confusion matrix:
       0   1
0  18087  62
1    596  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.89520574, 'recall': 0.6062792, 'specificity': 0.6062792, 'f1': 0.66130984, 'auroc': 0.89792407, 'binary_precision': 0.8235294, 'binary_recall': 0.21455939, 'binary_specificity': 0.997999, 'binary_f1_score': 0.34042555}
confusion matrix:
      0   1
0  5985  12
1   205  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_12.png
early stop counter: 6
val acc:0.9649850726127625, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.959092378616333 / 0.9693192839622498
after epoch: 12,now: 2024-06-05 01:19:37.883359,epoch time: 0:17:15.696013,used: 3:29:11.045514,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.73629117, 'recall': 0.57837015, 'specificity': 0.57837015, 'f1': 0.6140382, 'auroc': 0.912439, 'binary_precision': 0.5010482, 'binary_recall': 0.16236413, 'binary_specificity': 0.9943762, 'binary_f1_score': 0.24525398}
confusion matrix:
       0    1
0  42082  238
1   1233  239
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.71355677, 'recall': 0.5670366, 'specificity': 0.5670366, 'f1': 0.5981618, 'auroc': 0.90227795, 'binary_precision': 0.4568528, 'binary_recall': 0.1399689, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.21428573}
confusion matrix:
       0    1
0  18042  107
1    553   90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97283477, 'precision': 0.9114232, 'recall': 0.7109762, 'specificity': 0.7109762, 'f1': 0.7761524, 'auroc': 0.90318143, 'binary_precision': 0.84732825, 'binary_recall': 0.42528737, 'binary_specificity': 0.996665, 'binary_f1_score': 0.5663265}
confusion matrix:
      0    1
0  5977   20
1   150  111
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_13.png
new oracle model saved
early stop counter: 7
val acc:0.9648786783218384, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.959092378616333 / 0.9728347659111023
after epoch: 13,now: 2024-06-05 01:36:56.785839,epoch time: 0:17:18.902480,used: 3:46:29.947994,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9654046, 'precision': 0.71978986, 'recall': 0.60020393, 'specificity': 0.60020393, 'f1': 0.63533485, 'auroc': 0.91423225, 'binary_precision': 0.46656534, 'binary_recall': 0.20870157, 'binary_specificity': 0.99170625, 'binary_f1_score': 0.2883983}
confusion matrix:
       0    1
0  41970  351
1   1164  307
---- Validation: 
scalar performance:
{'acc': 0.9640272, 'precision': 0.7084077, 'recall': 0.59809816, 'specificity': 0.59809816, 'f1': 0.6312016, 'auroc': 0.90774107, 'binary_precision': 0.44444445, 'binary_recall': 0.20528771, 'binary_specificity': 0.99090856, 'binary_f1_score': 0.28085107}
confusion matrix:
       0    1
0  17984  165
1    511  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9750719, 'precision': 0.91991067, 'recall': 0.73779607, 'specificity': 0.73779607, 'f1': 0.80144083, 'auroc': 0.91440964, 'binary_precision': 0.86206895, 'binary_recall': 0.4789272, 'binary_specificity': 0.996665, 'binary_f1_score': 0.61576355}
confusion matrix:
      0    1
0  5977   20
1   136  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_14.png
new oracle model saved
early stop counter: 8
val acc:0.9640272259712219, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.959092378616333 / 0.975071907043457
after epoch: 14,now: 2024-06-05 01:54:09.695055,epoch time: 0:17:12.909216,used: 4:03:42.857210,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.966044, 'precision': 0.7299457, 'recall': 0.5982381, 'specificity': 0.5982381, 'f1': 0.63505083, 'auroc': 0.91406417, 'binary_precision': 0.48701298, 'binary_recall': 0.2039429, 'binary_specificity': 0.99253327, 'binary_f1_score': 0.287494}
confusion matrix:
       0    1
0  42005  316
1   1171  300
---- Validation: 
scalar performance:
{'acc': 0.965198, 'precision': 0.72713524, 'recall': 0.6062048, 'specificity': 0.6062048, 'f1': 0.64246273, 'auroc': 0.9040657, 'binary_precision': 0.48135594, 'binary_recall': 0.22083981, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.30277184}
confusion matrix:
       0    1
0  17996  153
1    501  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9753915, 'precision': 0.9119302, 'recall': 0.74895686, 'specificity': 0.74895686, 'f1': 0.8085402, 'auroc': 0.9044765, 'binary_precision': 0.8451613, 'binary_recall': 0.5019157, 'binary_specificity': 0.995998, 'binary_f1_score': 0.6298077}
confusion matrix:
      0    1
0  5973   24
1   130  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_15.png
new oracle model saved
early stop counter: 9
val acc:0.9651979804039001, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.959092378616333 / 0.9753915071487427
after epoch: 15,now: 2024-06-05 02:11:22.248870,epoch time: 0:17:12.553815,used: 4:20:55.411025,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9654046, 'precision': 0.7176999, 'recall': 0.59172684, 'specificity': 0.59172684, 'f1': 0.62643236, 'auroc': 0.9125582, 'binary_precision': 0.46293247, 'binary_recall': 0.19115646, 'binary_specificity': 0.9922972, 'binary_f1_score': 0.2705826}
confusion matrix:
       0    1
0  41996  326
1   1189  281
---- Validation: 
scalar performance:
{'acc': 0.9643465, 'precision': 0.7114404, 'recall': 0.592263, 'specificity': 0.592263, 'f1': 0.6259397, 'auroc': 0.91326463, 'binary_precision': 0.45090908, 'binary_recall': 0.19284603, 'binary_specificity': 0.99167997, 'binary_f1_score': 0.2701525}
confusion matrix:
       0    1
0  17998  151
1    519  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9750719, 'precision': 0.8969246, 'recall': 0.75795174, 'specificity': 0.75795174, 'f1': 0.81130433, 'auroc': 0.9072108, 'binary_precision': 0.8143712, 'binary_recall': 0.5210728, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.635514}
confusion matrix:
      0    1
0  5966   31
1   125  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_16.png
early stop counter: 10
val acc:0.9643465280532837, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.959092378616333 / 0.9753915071487427
after epoch: 16,now: 2024-06-05 02:28:35.022446,epoch time: 0:17:12.773576,used: 4:38:08.184601,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96618104, 'precision': 0.732018, 'recall': 0.5940438, 'specificity': 0.5940438, 'f1': 0.6310015, 'auroc': 0.91555023, 'binary_precision': 0.49143836, 'binary_recall': 0.19510537, 'binary_specificity': 0.9929822, 'binary_f1_score': 0.27931875}
confusion matrix:
       0    1
0  42024  297
1   1184  287
---- Validation: 
scalar performance:
{'acc': 0.9650915, 'precision': 0.7236645, 'recall': 0.59339875, 'specificity': 0.59339875, 'f1': 0.6290264, 'auroc': 0.9111692, 'binary_precision': 0.47528517, 'binary_recall': 0.19440125, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.27593818}
confusion matrix:
       0    1
0  18011  138
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9742729, 'precision': 0.903419, 'recall': 0.73921156, 'specificity': 0.73921156, 'f1': 0.7984335, 'auroc': 0.90882367, 'binary_precision': 0.82894737, 'binary_recall': 0.4827586, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.6101695}
confusion matrix:
      0    1
0  5971   26
1   135  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_17.png
early stop counter: 11
val acc:0.9650915265083313, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.959092378616333 / 0.9753915071487427
after epoch: 17,now: 2024-06-05 02:45:48.456129,epoch time: 0:17:13.433683,used: 4:55:21.618284,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.7371314, 'recall': 0.6078775, 'specificity': 0.6078775, 'f1': 0.64592576, 'auroc': 0.9186461, 'binary_precision': 0.50076103, 'binary_recall': 0.22350544, 'binary_specificity': 0.99224955, 'binary_f1_score': 0.30906528}
confusion matrix:
       0    1
0  41992  328
1   1143  329
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.7215936, 'recall': 0.60153913, 'specificity': 0.60153913, 'f1': 0.63691914, 'auroc': 0.9142009, 'binary_precision': 0.47058824, 'binary_recall': 0.21150856, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.2918455}
confusion matrix:
       0    1
0  17996  153
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9749121, 'precision': 0.91695654, 'recall': 0.73771274, 'specificity': 0.73771274, 'f1': 0.8006425, 'auroc': 0.8999002, 'binary_precision': 0.8561644, 'binary_recall': 0.4789272, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.6142506}
confusion matrix:
      0    1
0  5976   21
1   136  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_18.png
early stop counter: 12
val acc:0.9648786783218384, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.959092378616333 / 0.9753915071487427
after epoch: 18,now: 2024-06-05 03:02:59.396927,epoch time: 0:17:10.940798,used: 5:12:32.559082,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.7385329, 'recall': 0.6527942, 'specificity': 0.6527942, 'f1': 0.6852897, 'auroc': 0.9219874, 'binary_precision': 0.50053704, 'binary_recall': 0.3165761, 'binary_specificity': 0.9890123, 'binary_f1_score': 0.3878485}
confusion matrix:
       0    1
0  41855  465
1   1006  466
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.7285497, 'recall': 0.6577933, 'specificity': 0.6577933, 'f1': 0.68596864, 'auroc': 0.91650176, 'binary_precision': 0.48063782, 'binary_recall': 0.3281493, 'binary_specificity': 0.9874373, 'binary_f1_score': 0.39001846}
confusion matrix:
       0    1
0  17921  228
1    432  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97651005, 'precision': 0.8956717, 'recall': 0.7825225, 'specificity': 0.7825225, 'f1': 0.8287425, 'auroc': 0.90775144, 'binary_precision': 0.8097826, 'binary_recall': 0.57088125, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.66966295}
confusion matrix:
      0    1
0  5962   35
1   112  149
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_19.png
new oracle model saved
early stop counter: 13
val acc:0.9648786783218384, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.959092378616333 / 0.9765100479125977
after epoch: 19,now: 2024-06-05 03:20:10.693059,epoch time: 0:17:11.296132,used: 5:29:43.855214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9667063, 'precision': 0.7422472, 'recall': 0.6050803, 'specificity': 0.6050803, 'f1': 0.6439985, 'auroc': 0.9196453, 'binary_precision': 0.5111821, 'binary_recall': 0.2173913, 'binary_specificity': 0.99276936, 'binary_f1_score': 0.30505243}
confusion matrix:
       0    1
0  42014  306
1   1152  320
---- Validation: 
scalar performance:
{'acc': 0.9649851, 'precision': 0.7256286, 'recall': 0.6188455, 'specificity': 0.6188455, 'f1': 0.65392274, 'auroc': 0.9132352, 'binary_precision': 0.4774775, 'binary_recall': 0.24727838, 'binary_specificity': 0.9904127, 'binary_f1_score': 0.32581967}
confusion matrix:
       0    1
0  17975  174
1    484  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97666985, 'precision': 0.93494165, 'recall': 0.74962384, 'specificity': 0.74962384, 'f1': 0.8150493, 'auroc': 0.9047968, 'binary_precision': 0.89115644, 'binary_recall': 0.5019157, 'binary_specificity': 0.997332, 'binary_f1_score': 0.64215684}
confusion matrix:
      0    1
0  5981   16
1   130  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_20.png
new oracle model saved
early stop counter: 14
val acc:0.9649850726127625, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.959092378616333 / 0.9766698479652405
after epoch: 20,now: 2024-06-05 03:37:24.023505,epoch time: 0:17:13.330446,used: 5:46:57.185660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9668661, 'precision': 0.74376667, 'recall': 0.65214217, 'specificity': 0.65214217, 'f1': 0.6862688, 'auroc': 0.9229983, 'binary_precision': 0.5110375, 'binary_recall': 0.31475186, 'binary_specificity': 0.9895324, 'binary_f1_score': 0.3895667}
confusion matrix:
       0    1
0  41878  443
1   1008  463
---- Validation: 
scalar performance:
{'acc': 0.96514475, 'precision': 0.7316071, 'recall': 0.6616813, 'specificity': 0.6616813, 'f1': 0.6897387, 'auroc': 0.9171129, 'binary_precision': 0.4864865, 'binary_recall': 0.33592534, 'binary_specificity': 0.9874373, 'binary_f1_score': 0.39742407}
confusion matrix:
       0    1
0  17921  228
1    427  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97730905, 'precision': 0.91642797, 'recall': 0.7737777, 'specificity': 0.7737777, 'f1': 0.8290092, 'auroc': 0.9133098, 'binary_precision': 0.852071, 'binary_recall': 0.55172414, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.66976744}
confusion matrix:
      0    1
0  5972   25
1   117  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_21.png
new oracle model saved
early stop counter: 15
val acc:0.9651447534561157, best validation acc: 0.9657300710678101, corresponding to test acc:                         0.959092378616333 / 0.9773090481758118
after epoch: 21,now: 2024-06-05 03:54:39.509100,epoch time: 0:17:15.485595,used: 6:04:12.671255,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9659755, 'precision': 0.7334475, 'recall': 0.65529037, 'specificity': 0.65529037, 'f1': 0.6856719, 'auroc': 0.9274603, 'binary_precision': 0.4901758, 'binary_recall': 0.32222977, 'binary_specificity': 0.9883509, 'binary_f1_score': 0.3888433}
confusion matrix:
       0    1
0  41828  493
1    997  474
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.7409146, 'recall': 0.67187285, 'specificity': 0.67187285, 'f1': 0.69999456, 'auroc': 0.9191781, 'binary_precision': 0.50440526, 'binary_recall': 0.3561431, 'binary_specificity': 0.98760265, 'binary_f1_score': 0.41750225}
confusion matrix:
       0    1
0  17924  225
1    414  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97666985, 'precision': 0.90475094, 'recall': 0.77527654, 'specificity': 0.77527654, 'f1': 0.82652575, 'auroc': 0.91284025, 'binary_precision': 0.82857144, 'binary_recall': 0.5555556, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.66513765}
confusion matrix:
      0    1
0  5967   30
1   116  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_22.png
better model found
persisted
after epoch: 22,now: 2024-06-05 04:11:54.203373,epoch time: 0:17:14.694273,used: 6:21:27.365528,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96666056, 'precision': 0.7415893, 'recall': 0.67270553, 'specificity': 0.67270553, 'f1': 0.70081395, 'auroc': 0.92300403, 'binary_precision': 0.50528336, 'binary_recall': 0.3575799, 'binary_specificity': 0.9878311, 'binary_f1_score': 0.41878983}
confusion matrix:
       0    1
0  41806  515
1    945  526
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.7380185, 'recall': 0.6814583, 'specificity': 0.6814583, 'f1': 0.70550245, 'auroc': 0.92052025, 'binary_precision': 0.4979424, 'binary_recall': 0.3763608, 'binary_specificity': 0.98655576, 'binary_f1_score': 0.42869797}
confusion matrix:
       0    1
0  17905  244
1    401  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9755513, 'precision': 0.88727254, 'recall': 0.77652526, 'specificity': 0.77652526, 'f1': 0.8217524, 'auroc': 0.9129782, 'binary_precision': 0.79347825, 'binary_recall': 0.55938697, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.6561798}
confusion matrix:
      0    1
0  5959   38
1   115  146
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_23.png
early stop counter: 1
val acc:0.9656769037246704, best validation acc: 0.9659961462020874, corresponding to test acc:                         0.9766698479652405 / 0.9773090481758118
after epoch: 23,now: 2024-06-05 04:29:08.701168,epoch time: 0:17:14.497795,used: 6:38:41.863323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96650076, 'precision': 0.7405565, 'recall': 0.68792236, 'specificity': 0.68792236, 'f1': 0.71065587, 'auroc': 0.92875147, 'binary_precision': 0.50219107, 'binary_recall': 0.3892663, 'binary_specificity': 0.98657846, 'binary_f1_score': 0.43857637}
confusion matrix:
       0    1
0  41752  568
1    899  573
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.73920727, 'recall': 0.69948715, 'specificity': 0.69948715, 'f1': 0.71734625, 'auroc': 0.92237544, 'binary_precision': 0.4990619, 'binary_recall': 0.41368586, 'binary_specificity': 0.98528844, 'binary_f1_score': 0.45238099}
confusion matrix:
       0    1
0  17882  267
1    377  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97698945, 'precision': 0.8943231, 'recall': 0.79193425, 'specificity': 0.79193425, 'f1': 0.83473974, 'auroc': 0.9152418, 'binary_precision': 0.8062827, 'binary_recall': 0.5900383, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.68141586}
confusion matrix:
      0    1
0  5960   37
1   107  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_24.png
early stop counter: 2
val acc:0.9657300710678101, best validation acc: 0.9659961462020874, corresponding to test acc:                         0.9766698479652405 / 0.9773090481758118
after epoch: 24,now: 2024-06-05 04:46:21.120189,epoch time: 0:17:12.419021,used: 6:55:54.282344,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.966044, 'precision': 0.73720455, 'recall': 0.70735765, 'specificity': 0.70735765, 'f1': 0.7211665, 'auroc': 0.9308593, 'binary_precision': 0.49414518, 'binary_recall': 0.4300272, 'binary_specificity': 0.9846881, 'binary_f1_score': 0.45986196}
confusion matrix:
       0    1
0  41672  648
1    839  633
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.73979414, 'recall': 0.71523833, 'specificity': 0.71523833, 'f1': 0.7267778, 'auroc': 0.9243635, 'binary_precision': 0.49913043, 'binary_recall': 0.44634527, 'binary_specificity': 0.98413134, 'binary_f1_score': 0.47126436}
confusion matrix:
       0    1
0  17861  288
1    356  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.89061815, 'recall': 0.81259024, 'specificity': 0.81259024, 'f1': 0.84683704, 'auroc': 0.91389954, 'binary_precision': 0.79710144, 'binary_recall': 0.6321839, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.70512825}
confusion matrix:
      0    1
0  5955   42
1    96  165
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_25.png
new oracle model saved
early stop counter: 3
val acc:0.9657300710678101, best validation acc: 0.9659961462020874, corresponding to test acc:                         0.9766698479652405 / 0.9779482483863831
after epoch: 25,now: 2024-06-05 05:03:34.898081,epoch time: 0:17:13.777892,used: 7:13:08.060236,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9663637, 'precision': 0.7407856, 'recall': 0.73145676, 'specificity': 0.73145676, 'f1': 0.73601854, 'auroc': 0.923218, 'binary_precision': 0.49964616, 'binary_recall': 0.47961956, 'binary_specificity': 0.98329395, 'binary_f1_score': 0.4894281}
confusion matrix:
       0    1
0  41613  707
1    766  706
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.73851305, 'recall': 0.750298, 'specificity': 0.750298, 'f1': 0.74424654, 'auroc': 0.9215374, 'binary_precision': 0.49408284, 'binary_recall': 0.5194401, 'binary_specificity': 0.981156, 'binary_f1_score': 0.5064443}
confusion matrix:
       0    1
0  17807  342
1    309  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97746885, 'precision': 0.8875346, 'recall': 0.8086754, 'specificity': 0.8086754, 'f1': 0.8431853, 'auroc': 0.9164156, 'binary_precision': 0.79126215, 'binary_recall': 0.6245211, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.69807285}
confusion matrix:
      0    1
0  5954   43
1    98  163
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_26.png
early stop counter: 4
val acc:0.9653576016426086, best validation acc: 0.9659961462020874, corresponding to test acc:                         0.9766698479652405 / 0.9779482483863831
after epoch: 26,now: 2024-06-05 05:20:45.629101,epoch time: 0:17:10.731020,used: 7:30:18.791256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9668204, 'precision': 0.7437467, 'recall': 0.6936614, 'specificity': 0.6936614, 'f1': 0.715527, 'auroc': 0.92669034, 'binary_precision': 0.5081826, 'binary_recall': 0.40081522, 'binary_specificity': 0.98650753, 'binary_f1_score': 0.448158}
confusion matrix:
       0    1
0  41749  571
1    882  590
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.7335054, 'recall': 0.7028793, 'specificity': 0.7028793, 'f1': 0.7169932, 'auroc': 0.9219522, 'binary_precision': 0.48741007, 'binary_recall': 0.4214619, 'binary_specificity': 0.9842967, 'binary_f1_score': 0.45204338}
confusion matrix:
       0    1
0  17864  285
1    372  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97746885, 'precision': 0.89759517, 'recall': 0.7958491, 'specificity': 0.7958491, 'f1': 0.8385265, 'auroc': 0.919631, 'binary_precision': 0.8125, 'binary_recall': 0.59770113, 'binary_specificity': 0.993997, 'binary_f1_score': 0.68874174}
confusion matrix:
      0    1
0  5961   36
1   105  156
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_27.png
early stop counter: 5
val acc:0.9650382995605469, best validation acc: 0.9659961462020874, corresponding to test acc:                         0.9766698479652405 / 0.9779482483863831
after epoch: 27,now: 2024-06-05 05:37:56.958723,epoch time: 0:17:11.329622,used: 7:47:30.120878,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96629524, 'precision': 0.7388532, 'recall': 0.6997479, 'specificity': 0.6997479, 'f1': 0.7173643, 'auroc': 0.9280031, 'binary_precision': 0.49795586, 'binary_recall': 0.4140041, 'binary_specificity': 0.9854918, 'binary_f1_score': 0.45211583}
confusion matrix:
       0    1
0  41707  614
1    862  609
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.73445505, 'recall': 0.71788037, 'specificity': 0.71788037, 'f1': 0.7258284, 'auroc': 0.92150486, 'binary_precision': 0.48825502, 'binary_recall': 0.4525661, 'binary_specificity': 0.98319465, 'binary_f1_score': 0.46973366}
confusion matrix:
       0    1
0  17844  305
1    352  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97762865, 'precision': 0.8894658, 'recall': 0.8087588, 'specificity': 0.8087588, 'f1': 0.8439763, 'auroc': 0.92081356, 'binary_precision': 0.79512197, 'binary_recall': 0.6245211, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.69957083}
confusion matrix:
      0    1
0  5955   42
1    98  163
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_28.png
early stop counter: 6
val acc:0.9650382995605469, best validation acc: 0.9659961462020874, corresponding to test acc:                         0.9766698479652405 / 0.9779482483863831
after epoch: 28,now: 2024-06-05 05:55:08.376329,epoch time: 0:17:11.417606,used: 8:04:41.538484,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9663181, 'precision': 0.7400321, 'recall': 0.7253508, 'specificity': 0.7253508, 'f1': 0.7324336, 'auroc': 0.93180704, 'binary_precision': 0.49854863, 'binary_recall': 0.46702924, 'binary_specificity': 0.9836724, 'binary_f1_score': 0.4822745}
confusion matrix:
       0    1
0  41630  691
1    784  687
---- Validation: 
scalar performance:
{'acc': 0.96514475, 'precision': 0.73608464, 'recall': 0.73218656, 'specificity': 0.73218656, 'f1': 0.73411745, 'auroc': 0.92540616, 'binary_precision': 0.49050632, 'binary_recall': 0.4821151, 'binary_specificity': 0.98225796, 'binary_f1_score': 0.4862745}
confusion matrix:
       0    1
0  17827  322
1    333  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9787472, 'precision': 0.89208734, 'recall': 0.8240011, 'specificity': 0.8240011, 'f1': 0.85447717, 'auroc': 0.91496134, 'binary_precision': 0.7990654, 'binary_recall': 0.6551724, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.71999997}
confusion matrix:
      0    1
0  5954   43
1    90  171
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_29.png
new oracle model saved
early stop counter: 7
val acc:0.9651447534561157, best validation acc: 0.9659961462020874, corresponding to test acc:                         0.9766698479652405 / 0.9787471890449524
after epoch: 29,now: 2024-06-05 06:12:23.415517,epoch time: 0:17:15.039188,used: 8:21:56.577672,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9675968, 'precision': 0.7511945, 'recall': 0.7025874, 'specificity': 0.7025874, 'f1': 0.7240115, 'auroc': 0.9321525, 'binary_precision': 0.5224767, 'binary_recall': 0.41847825, 'binary_specificity': 0.9866966, 'binary_f1_score': 0.4647303}
confusion matrix:
       0    1
0  41757  563
1    856  616
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.73943114, 'recall': 0.7054876, 'specificity': 0.7054876, 'f1': 0.72101766, 'auroc': 0.9245169, 'binary_precision': 0.49908924, 'binary_recall': 0.42612752, 'binary_specificity': 0.98484766, 'binary_f1_score': 0.45973152}
confusion matrix:
       0    1
0  17874  275
1    369  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9782678, 'precision': 0.9035082, 'recall': 0.80176294, 'specificity': 0.80176294, 'f1': 0.8445827, 'auroc': 0.91765106, 'binary_precision': 0.8238342, 'binary_recall': 0.6091954, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.70044047}
confusion matrix:
      0    1
0  5963   34
1   102  159
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_30.png
early stop counter: 8
val acc:0.9657300710678101, best validation acc: 0.9659961462020874, corresponding to test acc:                         0.9766698479652405 / 0.9787471890449524
after epoch: 30,now: 2024-06-05 06:29:34.621896,epoch time: 0:17:11.206379,used: 8:39:07.784051,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_21_50_26_seed_0_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:39:07.784051 at 2024-06-05 06:29:34.621896
persisted model performance metric: 

scalar performance:
{'acc': 0.9785874, 'precision': 0.9112208, 'recall': 0.79826504, 'specificity': 0.79826504, 'f1': 0.8448945, 'auroc': 0.91619754, 'binary_precision': 0.8395722, 'binary_recall': 0.6015326, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.70089287}
confusion matrix:
      0    1
0  5967   30
1   104  157
oracle model performance metric: 

scalar performance:
{'acc': 0.9784276, 'precision': 0.8883855, 'recall': 0.8238343, 'specificity': 0.8238343, 'f1': 0.8528838, 'auroc': 0.9182789, 'binary_precision': 0.7916667, 'binary_recall': 0.6551724, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.7169812}
confusion matrix:
      0    1
0  5952   45
1    90  171
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/10.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 494363 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool | 404544 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |  89819 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 494363 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool | 404544 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |  89819 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  10961 MiB |   1653 TiB |   1653 TiB |
|       from large pool | 387840 KiB |  10889 MiB |   1651 TiB |   1651 TiB |
|       from small pool |  88733 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11226 MiB |  11226 MiB |  11226 MiB |      0 B   |
|       from large pool |  11100 MiB |  11100 MiB |  11100 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1341 MiB |   1726 MiB | 593276 GiB | 593275 GiB |
|       from large pool |   1332 MiB |   1724 MiB | 590348 GiB | 590346 GiB |
|       from small pool |      8 MiB |      9 MiB |   2928 GiB |   2928 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6720    |  137824 K  |  137820 K  |
|       from large pool |      87    |     909    |   64894 K  |   64894 K  |
|       from small pool |    3642    |    6631    |   72929 K  |   72926 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6720    |  137824 K  |  137820 K  |
|       from large pool |      87    |     909    |   64894 K  |   64894 K  |
|       from small pool |    3642    |    6631    |   72929 K  |   72926 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     232    |     232    |     232    |       0    |
|       from large pool |     169    |     169    |     169    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      69    |    2768    |   70692 K  |   70692 K  |
|       from large pool |      20    |      59    |   32175 K  |   32175 K  |
|       from small pool |      49    |    2747    |   38516 K  |   38516 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1653 TiB |   1653 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1651 TiB |   1651 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1824 MiB |  11226 MiB |  11226 MiB |   9402 MiB |
|       from large pool |   1728 MiB |  11100 MiB |  11100 MiB |   9372 MiB |
|       from small pool |     96 MiB |    126 MiB |    126 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1726 MiB | 593277 GiB | 593277 GiB |
|       from large pool | 134912 KiB |   1724 MiB | 590348 GiB | 590348 GiB |
|       from small pool |      0 KiB |     22 MiB |   2928 GiB |   2928 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  137824 K  |  137824 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72929 K  |   72929 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  137824 K  |  137824 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72929 K  |   72929 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      78    |     232    |     232    |     154    |
|       from large pool |      30    |     169    |     169    |     139    |
|       from small pool |      48    |      63    |      63    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |   70693 K  |   70693 K  |
|       from large pool |       4    |      59    |   32175 K  |   32175 K  |
|       from small pool |       0    |    2747    |   38518 K  |   38518 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  11071 MiB |   1660 TiB |   1660 TiB |
|       from large pool |  16640 KiB |  10998 MiB |   1657 TiB |   1657 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10961 MiB |   1653 TiB |   1653 TiB |
|       from large pool |  16640 KiB |  10889 MiB |   1651 TiB |   1651 TiB |
|       from small pool |      0 KiB |    123 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1824 MiB |  11226 MiB |  11226 MiB |   9402 MiB |
|       from large pool |   1728 MiB |  11100 MiB |  11100 MiB |   9372 MiB |
|       from small pool |     96 MiB |    126 MiB |    126 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1726 MiB | 593277 GiB | 593277 GiB |
|       from large pool | 134912 KiB |   1724 MiB | 590348 GiB | 590348 GiB |
|       from small pool |      0 KiB |     22 MiB |   2928 GiB |   2928 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  137824 K  |  137824 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72929 K  |   72929 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  137824 K  |  137824 K  |
|       from large pool |       2    |     909    |   64894 K  |   64894 K  |
|       from small pool |       0    |    6631    |   72929 K  |   72929 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      78    |     232    |     232    |     154    |
|       from large pool |      30    |     169    |     169    |     139    |
|       from small pool |      48    |      63    |      63    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2768    |   70693 K  |   70693 K  |
|       from large pool |       4    |      59    |   32175 K  |   32175 K  |
|       from small pool |       0    |    2747    |   38518 K  |   38518 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_06_38_21_seed_1_21096312

 Experiment start at: 2024-06-05 06:38:21.578632
before training, model accuracy: 0.09458588808774948
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.88865834, 'precision': 0.5102588, 'recall': 0.52575606, 'specificity': 0.52575606, 'f1': 0.5078891, 'auroc': 0.5373311, 'binary_precision': 0.051602814, 'binary_recall': 0.1373093, 'binary_specificity': 0.91420287, 'binary_f1_score': 0.07501421}
confusion matrix:
       0     1
0  38775  3639
1   1244   198
---- Validation: 
scalar performance:
{'acc': 0.79279613, 'precision': 0.51618534, 'recall': 0.57352966, 'specificity': 0.57352966, 'f1': 0.49376085, 'auroc': 0.52114344, 'binary_precision': 0.061954148, 'binary_recall': 0.33729568, 'binary_specificity': 0.80976367, 'binary_f1_score': 0.10468066}
confusion matrix:
       0     1
0  14630  3437
1    446   227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91169834, 'precision': 0.48336658, 'recall': 0.48129898, 'specificity': 0.48129898, 'f1': 0.4823084, 'auroc': 0.43809882, 'binary_precision': 0.010204081, 'binary_recall': 0.011538462, 'binary_specificity': 0.9510595, 'binary_f1_score': 0.010830325}
confusion matrix:
      0    1
0  5655  291
1   257    3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-05 06:56:20.856827,epoch time: 0:17:59.278195,used: 0:17:59.278195,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_06_38_21_seed_1_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95824975, 'precision': 0.53086984, 'recall': 0.5104871, 'specificity': 0.5104871, 'f1': 0.512754, 'auroc': 0.63445604, 'binary_precision': 0.09394572, 'binary_recall': 0.031206658, 'binary_specificity': 0.98976755, 'binary_f1_score': 0.0468506}
confusion matrix:
       0    1
0  41980  434
1   1397   45
---- Validation: 
scalar performance:
{'acc': 0.94167554, 'precision': 0.54591584, 'recall': 0.5384453, 'specificity': 0.5384453, 'f1': 0.541695, 'auroc': 0.5895692, 'binary_precision': 0.125, 'binary_recall': 0.104011886, 'binary_specificity': 0.97287875, 'binary_f1_score': 0.113544196}
confusion matrix:
       0    1
0  17577  490
1    603   70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9540767, 'precision': 0.4975604, 'recall': 0.49973673, 'specificity': 0.49973673, 'f1': 0.49173173, 'auroc': 0.58313406, 'binary_precision': 0.037037037, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.0069686407}
confusion matrix:
      0   1
0  5920  26
1   259   1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-05 07:13:36.273996,epoch time: 0:17:15.417169,used: 0:35:14.695364,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_06_38_21_seed_1_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96616197, 'precision': 0.59912074, 'recall': 0.505534, 'specificity': 0.505534, 'f1': 0.50323343, 'auroc': 0.74739766, 'binary_precision': 0.23076923, 'binary_recall': 0.012482663, 'binary_specificity': 0.99858534, 'binary_f1_score': 0.023684211}
confusion matrix:
       0   1
0  42354  60
1   1424  18
---- Validation: 
scalar performance:
{'acc': 0.96344715, 'precision': 0.69335425, 'recall': 0.5225564, 'specificity': 0.5225564, 'f1': 0.5333991, 'auroc': 0.7228855, 'binary_precision': 0.42105263, 'binary_recall': 0.04754829, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.08544726}
confusion matrix:
       0   1
0  18023  44
1    641  32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.72912633, 'recall': 0.501839, 'specificity': 0.501839, 'f1': 0.49311718, 'auroc': 0.72848797, 'binary_precision': 0.5, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0076335873}
confusion matrix:
      0  1
0  5945  1
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-05 07:30:55.184948,epoch time: 0:17:18.910952,used: 0:52:33.606316,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_06_38_21_seed_1_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96709687, 'precision': 0.7244388, 'recall': 0.50434256, 'specificity': 0.50434256, 'f1': 0.50048363, 'auroc': 0.820976, 'binary_precision': 0.4814815, 'binary_recall': 0.009015257, 'binary_specificity': 0.9996699, 'binary_f1_score': 0.017699115}
confusion matrix:
       0   1
0  42400  14
1   1429  13
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.746406, 'recall': 0.5136454, 'specificity': 0.5136454, 'f1': 0.5176743, 'auroc': 0.81498134, 'binary_precision': 0.5277778, 'binary_recall': 0.028231798, 'binary_specificity': 0.9990591, 'binary_f1_score': 0.053596616}
confusion matrix:
       0   1
0  18050  17
1    654  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8069277, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_4.png
better model found
persisted
after epoch: 4,now: 2024-06-05 07:48:14.993646,epoch time: 0:17:19.808698,used: 1:09:53.415014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_06_38_21_seed_1_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9671653, 'precision': 0.75453246, 'recall': 0.50437796, 'specificity': 0.50437796, 'f1': 0.50051945, 'auroc': 0.8493117, 'binary_precision': 0.5416667, 'binary_recall': 0.009015257, 'binary_specificity': 0.99974066, 'binary_f1_score': 0.017735334}
confusion matrix:
       0   1
0  42403  11
1   1429  13
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.66073525, 'recall': 0.50346565, 'specificity': 0.50346565, 'f1': 0.49807793, 'auroc': 0.8511369, 'binary_precision': 0.35714287, 'binary_recall': 0.0074294205, 'binary_specificity': 0.9995019, 'binary_f1_score': 0.014556041}
confusion matrix:
       0  1
0  18058  9
1    668  5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.72912633, 'recall': 0.501839, 'specificity': 0.501839, 'f1': 0.49311718, 'auroc': 0.8420819, 'binary_precision': 0.5, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0076335873}
confusion matrix:
      0  1
0  5945  1
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_5.png
early stop counter: 1
val acc:0.9638740420341492, best validation acc: 0.9641942381858826, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-05 08:05:44.925316,epoch time: 0:17:29.931670,used: 1:27:23.346684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_06_38_21_seed_1_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.7337304, 'recall': 0.50535923, 'specificity': 0.50535923, 'f1': 0.5024943, 'auroc': 0.87015617, 'binary_precision': 0.5, 'binary_recall': 0.011095701, 'binary_specificity': 0.99962276, 'binary_f1_score': 0.021709634}
confusion matrix:
       0   1
0  42398  16
1   1426  16
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.76815873, 'recall': 0.51155496, 'specificity': 0.51155496, 'f1': 0.5137297, 'auroc': 0.85493046, 'binary_precision': 0.5714286, 'binary_recall': 0.023774145, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.045649074}
confusion matrix:
       0   1
0  18055  12
1    657  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.9794388, 'recall': 0.50961536, 'specificity': 0.50961536, 'f1': 0.50837153, 'auroc': 0.85238194, 'binary_precision': 1.0, 'binary_recall': 0.01923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.037735853}
confusion matrix:
      0  1
0  5946  0
1   255  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-05 08:23:03.741975,epoch time: 0:17:18.816659,used: 1:44:42.163343,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_06_38_21_seed_1_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9671197, 'precision': 0.73374104, 'recall': 0.5056942, 'specificity': 0.5056942, 'f1': 0.50315684, 'auroc': 0.8789282, 'binary_precision': 0.5, 'binary_recall': 0.011789181, 'binary_specificity': 0.9995992, 'binary_f1_score': 0.023035228}
confusion matrix:
       0   1
0  42397  17
1   1425  17
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.7264416, 'recall': 0.51427764, 'specificity': 0.51427764, 'f1': 0.51884514, 'auroc': 0.8829862, 'binary_precision': 0.4878049, 'binary_recall': 0.029717682, 'binary_specificity': 0.99883765, 'binary_f1_score': 0.05602241}
confusion matrix:
       0   1
0  18046  21
1    653  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.89610213, 'recall': 0.50953126, 'specificity': 0.50953126, 'f1': 0.5082585, 'auroc': 0.8704908, 'binary_precision': 0.8333333, 'binary_recall': 0.01923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.037593987}
confusion matrix:
      0  1
0  5945  1
1   255  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_7.png
early stop counter: 1
val acc:0.9640341401100159, best validation acc: 0.9643009901046753, corresponding to test acc:                         0.9589107036590576 / 0.9589107036590576
after epoch: 7,now: 2024-06-05 08:40:23.768841,epoch time: 0:17:20.026866,used: 2:02:02.190209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_06_38_21_seed_1_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96714246, 'precision': 0.73936105, 'recall': 0.5077157, 'specificity': 0.5077157, 'f1': 0.5071114, 'auroc': 0.87998456, 'binary_precision': 0.51111114, 'binary_recall': 0.015950069, 'binary_specificity': 0.9994813, 'binary_f1_score': 0.030934766}
confusion matrix:
       0   1
0  42392  22
1   1419  23
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.7653037, 'recall': 0.518763, 'specificity': 0.518763, 'f1': 0.52708924, 'auroc': 0.87322176, 'binary_precision': 0.5652174, 'binary_recall': 0.038632985, 'binary_specificity': 0.998893, 'binary_f1_score': 0.07232267}
confusion matrix:
       0   1
0  18047  20
1    647  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.97936153, 'recall': 0.50769234, 'specificity': 0.50769234, 'f1': 0.5046148, 'auroc': 0.87509686, 'binary_precision': 1.0, 'binary_recall': 0.015384615, 'binary_specificity': 1.0, 'binary_f1_score': 0.03030303}
confusion matrix:
      0  1
0  5946  0
1   256  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_8.png
better model found
persisted
after epoch: 8,now: 2024-06-05 08:57:44.158909,epoch time: 0:17:20.390068,used: 2:19:22.580277,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_06_38_21_seed_1_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96705127, 'precision': 0.7296047, 'recall': 0.52575594, 'specificity': 0.52575594, 'f1': 0.53976494, 'auroc': 0.89392626, 'binary_precision': 0.49044585, 'binary_recall': 0.053398058, 'binary_specificity': 0.9981138, 'binary_f1_score': 0.09631019}
confusion matrix:
       0   1
0  42334  80
1   1365  77
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.75186896, 'recall': 0.5596716, 'specificity': 0.5596716, 'f1': 0.59121066, 'auroc': 0.8937103, 'binary_precision': 0.5354839, 'binary_recall': 0.12332838, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.20048308}
confusion matrix:
       0   1
0  17995  72
1    590  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.91395295, 'recall': 0.561118, 'specificity': 0.561118, 'f1': 0.5981279, 'auroc': 0.8864866, 'binary_precision': 0.8648649, 'binary_recall': 0.12307692, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.21548823}
confusion matrix:
      0   1
0  5941   5
1   228  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_9.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-06-05 09:15:07.313355,epoch time: 0:17:23.154446,used: 2:36:45.734723,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_06_38_21_seed_1_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9671653, 'precision': 0.7373116, 'recall': 0.5305042, 'specificity': 0.5305042, 'f1': 0.5477402, 'auroc': 0.89610624, 'binary_precision': 0.50555557, 'binary_recall': 0.0631068, 'binary_specificity': 0.9979016, 'binary_f1_score': 0.11220716}
confusion matrix:
       0   1
0  42325  89
1   1351  91
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.7388216, 'recall': 0.5573044, 'specificity': 0.5573044, 'f1': 0.58724505, 'auroc': 0.8993325, 'binary_precision': 0.50955415, 'binary_recall': 0.11887073, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.19277108}
confusion matrix:
       0   1
0  17990  77
1    593  80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.90545094, 'recall': 0.5534257, 'specificity': 0.5534257, 'f1': 0.5857851, 'auroc': 0.8884187, 'binary_precision': 0.8484849, 'binary_recall': 0.10769231, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.19112627}
confusion matrix:
      0   1
0  5941   5
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_10.png
early stop counter: 1
val acc:0.9642475843429565, best validation acc: 0.9646744728088379, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 10,now: 2024-06-05 09:32:29.118462,epoch time: 0:17:21.805107,used: 2:54:07.539830,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_06_38_21_seed_1_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96689165, 'precision': 0.7251947, 'recall': 0.54141617, 'specificity': 0.54141617, 'f1': 0.56450045, 'auroc': 0.9034863, 'binary_precision': 0.48062015, 'binary_recall': 0.08599168, 'binary_specificity': 0.99684066, 'binary_f1_score': 0.14588237}
confusion matrix:
       0    1
0  42280  134
1   1318  124
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.73823, 'recall': 0.583054, 'specificity': 0.583054, 'f1': 0.6194446, 'auroc': 0.90363455, 'binary_precision': 0.5065502, 'binary_recall': 0.17236255, 'binary_specificity': 0.9937455, 'binary_f1_score': 0.2572062}
confusion matrix:
       0    1
0  17954  113
1    557  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.86840105, 'recall': 0.5835222, 'specificity': 0.5835222, 'f1': 0.62933457, 'auroc': 0.885924, 'binary_precision': 0.7719298, 'binary_recall': 0.16923077, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.27760252}
confusion matrix:
      0   1
0  5933  13
1   216  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_11.png
new oracle model saved
early stop counter: 2
val acc:0.9642475843429565, best validation acc: 0.9646744728088379, corresponding to test acc:                         0.962455689907074 / 0.963100254535675
after epoch: 11,now: 2024-06-05 09:50:00.273807,epoch time: 0:17:31.155345,used: 3:11:38.695175,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_06_38_21_seed_1_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96698284, 'precision': 0.7275845, 'recall': 0.5344293, 'specificity': 0.5344293, 'f1': 0.55386037, 'auroc': 0.9052079, 'binary_precision': 0.48584905, 'binary_recall': 0.071428575, 'binary_specificity': 0.9974301, 'binary_f1_score': 0.12454656}
confusion matrix:
       0    1
0  42305  109
1   1339  103
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.7505114, 'recall': 0.57903916, 'specificity': 0.57903916, 'f1': 0.6159836, 'auroc': 0.9059786, 'binary_precision': 0.531401, 'binary_recall': 0.16344725, 'binary_specificity': 0.9946311, 'binary_f1_score': 0.25}
confusion matrix:
       0    1
0  17970   97
1    563  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.9192548, 'recall': 0.56688726, 'specificity': 0.56688726, 'f1': 0.60717195, 'auroc': 0.90314364, 'binary_precision': 0.875, 'binary_recall': 0.13461539, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.23333333}
confusion matrix:
      0   1
0  5941   5
1   225  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_12.png
better model found
persisted
after epoch: 12,now: 2024-06-05 10:07:33.844998,epoch time: 0:17:33.571191,used: 3:29:12.266366,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_06_38_21_seed_1_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96670926, 'precision': 0.72304845, 'recall': 0.5577345, 'specificity': 0.5577345, 'f1': 0.5872941, 'auroc': 0.91056645, 'binary_precision': 0.4752747, 'binary_recall': 0.11997226, 'binary_specificity': 0.99549675, 'binary_f1_score': 0.1915836}
confusion matrix:
       0    1
0  42223  191
1   1269  173
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.7610439, 'recall': 0.6058915, 'specificity': 0.6058915, 'f1': 0.6475434, 'auroc': 0.906234, 'binary_precision': 0.5505618, 'binary_recall': 0.21842496, 'binary_specificity': 0.9933581, 'binary_f1_score': 0.31276596}
confusion matrix:
       0    1
0  17947  120
1    526  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96841764, 'precision': 0.93465555, 'recall': 0.63778883, 'specificity': 0.63778883, 'f1': 0.7036468, 'auroc': 0.89967525, 'binary_precision': 0.9, 'binary_recall': 0.2769231, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.42352945}
confusion matrix:
      0   1
0  5938   8
1   188  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_13.png
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-06-05 10:25:02.370502,epoch time: 0:17:28.525504,used: 3:46:40.791870,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_06_38_21_seed_1_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9674389, 'precision': 0.74457335, 'recall': 0.56916517, 'specificity': 0.56916517, 'f1': 0.6036418, 'auroc': 0.9105162, 'binary_precision': 0.51758796, 'binary_recall': 0.14285715, 'binary_specificity': 0.9954732, 'binary_f1_score': 0.22391306}
confusion matrix:
       0    1
0  42222  192
1   1236  206
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.751138, 'recall': 0.6135104, 'specificity': 0.6135104, 'f1': 0.6537484, 'auroc': 0.90902424, 'binary_precision': 0.5302013, 'binary_recall': 0.23476969, 'binary_specificity': 0.99225104, 'binary_f1_score': 0.32543766}
confusion matrix:
       0    1
0  17927  140
1    515  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.9039341, 'recall': 0.6201448, 'specificity': 0.6201448, 'f1': 0.6794069, 'auroc': 0.9040078, 'binary_precision': 0.84, 'binary_recall': 0.2423077, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.3761194}
confusion matrix:
      0   1
0  5934  12
1   197  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_14.png
early stop counter: 1
val acc:0.9650480151176453, best validation acc: 0.9655283093452454, corresponding to test acc:                         0.9684176445007324 / 0.9684176445007324
after epoch: 14,now: 2024-06-05 10:42:26.956126,epoch time: 0:17:24.585624,used: 4:04:05.377494,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_06_38_21_seed_1_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9660936, 'precision': 0.7136444, 'recall': 0.57617354, 'specificity': 0.57617354, 'f1': 0.609069, 'auroc': 0.91028655, 'binary_precision': 0.45526838, 'binary_recall': 0.15880722, 'binary_specificity': 0.99353987, 'binary_f1_score': 0.23547558}
confusion matrix:
       0    1
0  42140  274
1   1213  229
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.7388998, 'recall': 0.63884485, 'specificity': 0.63884485, 'f1': 0.6741671, 'auroc': 0.9132851, 'binary_precision': 0.5038961, 'binary_recall': 0.2882615, 'binary_specificity': 0.9894282, 'binary_f1_score': 0.36672965}
confusion matrix:
       0    1
0  17876  191
1    479  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97019017, 'precision': 0.9082411, 'recall': 0.67549354, 'specificity': 0.67549354, 'f1': 0.7416417, 'auroc': 0.90843165, 'binary_precision': 0.8440367, 'binary_recall': 0.35384616, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.49864498}
confusion matrix:
      0   1
0  5929  17
1   168  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_15.png
new oracle model saved
early stop counter: 2
val acc:0.9642475843429565, best validation acc: 0.9655283093452454, corresponding to test acc:                         0.9684176445007324 / 0.970190167427063
after epoch: 15,now: 2024-06-05 10:59:55.389090,epoch time: 0:17:28.432964,used: 4:21:33.810458,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_06_38_21_seed_1_21096312
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96698284, 'precision': 0.73077035, 'recall': 0.5605874, 'specificity': 0.5605874, 'f1': 0.5915718, 'auroc': 0.90928185, 'binary_precision': 0.4905149, 'binary_recall': 0.12560722, 'binary_specificity': 0.9955676, 'binary_f1_score': 0.2}
confusion matrix:
       0    1
0  42227  188
1   1260  181
---- Validation: 
scalar performance:
{'acc': 0.9653148, 'precision': 0.7559992, 'recall': 0.61150295, 'specificity': 0.61150295, 'f1': 0.6525591, 'auroc': 0.91253984, 'binary_precision': 0.5400697, 'binary_recall': 0.23031203, 'binary_specificity': 0.99269384, 'binary_f1_score': 0.32291666}
confusion matrix:
       0    1
0  17935  132
1    518  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.90851533, 'recall': 0.61830574, 'specificity': 0.61830574, 'f1': 0.6775348, 'auroc': 0.9164338, 'binary_precision': 0.84931505, 'binary_recall': 0.23846154, 'binary_specificity': 0.99815, 'binary_f1_score': 0.3723724}
confusion matrix:
      0   1
0  5935  11
1   198  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096312_16.png
[Wed Jun  5 11:17:23 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/10.csv

RuleException:
RuntimeError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[enforce fail at inline_container.cc:595] . unexpected pos 69273152 vs 69272984
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_irm.py", line 51, in tr_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_irm.py", line 66, in after_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 60, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/a_model_sel.py", line 63, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/c_msel_oracle.py", line 37, in base_update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model.py", line 159, in save
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_utils.py", line 88, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 627, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 475, in __exit__
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
