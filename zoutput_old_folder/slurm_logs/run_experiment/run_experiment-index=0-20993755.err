Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed May 29 13:26:15 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755

 Experiment start at: 2024-05-29 13:38:03.303664
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9741962, 'precision': 0.8189053, 'recall': 0.7399257, 'specificity': 0.7399257, 'f1': 0.7733386, 'auroc': 0.9639935, 'binary_precision': 0.6554239, 'binary_recall': 0.48878315, 'binary_specificity': 0.99106824, 'binary_f1_score': 0.5599689}
confusion matrix:
       0    1
0  41943  378
1    752  719
---- Validation: 
scalar performance:
{'acc': 0.97227544, 'precision': 0.83276474, 'recall': 0.6706234, 'specificity': 0.6706234, 'f1': 0.72349596, 'auroc': 0.9627746, 'binary_precision': 0.6882716, 'binary_recall': 0.34681183, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.4612203}
confusion matrix:
       0    1
0  18048  101
1    420  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.9432152, 'recall': 0.60877854, 'specificity': 0.60877854, 'f1': 0.6679001, 'auroc': 0.9487815, 'binary_precision': 0.91935486, 'binary_recall': 0.21839081, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.3529412}
confusion matrix:
      0   1
0  5992   5
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-29 14:13:54.337513,epoch time: 0:35:51.033849,used: 0:35:51.033849,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9780782, 'precision': 0.8593707, 'recall': 0.7689922, 'specificity': 0.7689922, 'f1': 0.8071468, 'auroc': 0.9750006, 'binary_precision': 0.7344322, 'binary_recall': 0.54483694, 'binary_specificity': 0.99314743, 'binary_f1_score': 0.62558496}
confusion matrix:
       0    1
0  42030  290
1    670  802
---- Validation: 
scalar performance:
{'acc': 0.97605366, 'precision': 0.854437, 'recall': 0.73708415, 'specificity': 0.73708415, 'f1': 0.78316414, 'auroc': 0.9682363, 'binary_precision': 0.7270588, 'binary_recall': 0.4805599, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.57865167}
confusion matrix:
       0    1
0  18033  116
1    334  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.92092884, 'recall': 0.5685486, 'specificity': 0.5685486, 'f1': 0.60978985, 'auroc': 0.95522153, 'binary_precision': 0.8780488, 'binary_recall': 0.13793103, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.2384106}
confusion matrix:
      0   1
0  5992   5
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 2,now: 2024-05-29 14:47:15.951752,epoch time: 0:33:21.614239,used: 1:09:12.648088,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97992784, 'precision': 0.8896479, 'recall': 0.7689656, 'specificity': 0.7689656, 'f1': 0.81740355, 'auroc': 0.9769275, 'binary_precision': 0.7950249, 'binary_recall': 0.54279894, 'binary_specificity': 0.9951323, 'binary_f1_score': 0.6451352}
confusion matrix:
       0    1
0  42114  206
1    673  799
---- Validation: 
scalar performance:
{'acc': 0.9772776, 'precision': 0.87273115, 'recall': 0.740718, 'specificity': 0.740718, 'f1': 0.7914016, 'auroc': 0.97525144, 'binary_precision': 0.7634146, 'binary_recall': 0.4867807, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.59449196}
confusion matrix:
       0    1
0  18052   97
1    330  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8502389, 'recall': 0.61877203, 'specificity': 0.61877203, 'f1': 0.6724757, 'auroc': 0.9632528, 'binary_precision': 0.73255813, 'binary_recall': 0.2413793, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.3631124}
confusion matrix:
      0   1
0  5974  23
1   198  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 3,now: 2024-05-29 15:21:51.406968,epoch time: 0:34:35.455216,used: 1:43:48.103304,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9827594, 'precision': 0.8657845, 'recall': 0.87034285, 'specificity': 0.87034285, 'f1': 0.8680483, 'auroc': 0.98136973, 'binary_precision': 0.74026847, 'binary_recall': 0.74983007, 'binary_specificity': 0.9908556, 'binary_f1_score': 0.7450186}
confusion matrix:
       0     1
0  41934   387
1    368  1103
---- Validation: 
scalar performance:
{'acc': 0.9807365, 'precision': 0.86667246, 'recall': 0.8280151, 'specificity': 0.8280151, 'f1': 0.8461744, 'auroc': 0.9778993, 'binary_precision': 0.7452007, 'binary_recall': 0.66407466, 'binary_specificity': 0.99195546, 'binary_f1_score': 0.7023027}
confusion matrix:
       0    1
0  18003  146
1    216  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.83072567, 'recall': 0.6746592, 'specificity': 0.6746592, 'f1': 0.72618514, 'auroc': 0.9580652, 'binary_precision': 0.6888889, 'binary_recall': 0.35632184, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.46969697}
confusion matrix:
      0   1
0  5955  42
1   168  93
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 4,now: 2024-05-29 15:56:55.129161,epoch time: 0:35:03.722193,used: 2:18:51.825497,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9836728, 'precision': 0.9173552, 'recall': 0.81155777, 'specificity': 0.81155777, 'f1': 0.85620135, 'auroc': 0.98365825, 'binary_precision': 0.8475666, 'binary_recall': 0.62703806, 'binary_specificity': 0.9960775, 'binary_f1_score': 0.72081226}
confusion matrix:
       0    1
0  42154  166
1    549  923
---- Validation: 
scalar performance:
{'acc': 0.98212004, 'precision': 0.9087287, 'recall': 0.79722905, 'specificity': 0.79722905, 'f1': 0.8434957, 'auroc': 0.979793, 'binary_precision': 0.8315335, 'binary_recall': 0.59875584, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.6962026}
confusion matrix:
       0    1
0  18071   78
1    258  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.879213, 'recall': 0.5871221, 'specificity': 0.5871221, 'f1': 0.6348951, 'auroc': 0.96286076, 'binary_precision': 0.79310346, 'binary_recall': 0.17624521, 'binary_specificity': 0.997999, 'binary_f1_score': 0.28840125}
confusion matrix:
      0   1
0  5985  12
1   215  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 5,now: 2024-05-29 16:36:56.631305,epoch time: 0:40:01.502144,used: 2:58:53.327641,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98533976, 'precision': 0.8815075, 'recall': 0.8979915, 'specificity': 0.8979915, 'f1': 0.88956, 'auroc': 0.98491544, 'binary_precision': 0.76983094, 'binary_recall': 0.8043478, 'binary_specificity': 0.99163514, 'binary_f1_score': 0.786711}
confusion matrix:
       0     1
0  41966   354
1    288  1184
---- Validation: 
scalar performance:
{'acc': 0.9844615, 'precision': 0.8900542, 'recall': 0.86894643, 'specificity': 0.86894643, 'f1': 0.87918174, 'auroc': 0.98072684, 'binary_precision': 0.7891269, 'binary_recall': 0.7449456, 'binary_specificity': 0.9929473, 'binary_f1_score': 0.76640004}
confusion matrix:
       0    1
0  18021  128
1    164  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.87315285, 'recall': 0.66266656, 'specificity': 0.66266656, 'f1': 0.7229483, 'auroc': 0.95902145, 'binary_precision': 0.7747748, 'binary_recall': 0.32950193, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.46236566}
confusion matrix:
      0   1
0  5972  25
1   175  86
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-05-29 17:14:28.986881,epoch time: 0:37:32.355576,used: 3:36:25.683217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9859563, 'precision': 0.880715, 'recall': 0.9133362, 'specificity': 0.9133362, 'f1': 0.8962963, 'auroc': 0.9884847, 'binary_precision': 0.767166, 'binary_recall': 0.83548605, 'binary_specificity': 0.9911864, 'binary_f1_score': 0.79986984}
confusion matrix:
       0     1
0  41948   373
1    242  1229
---- Validation: 
scalar performance:
{'acc': 0.98440826, 'precision': 0.87409914, 'recall': 0.898171, 'specificity': 0.898171, 'f1': 0.8857259, 'auroc': 0.983195, 'binary_precision': 0.75510204, 'binary_recall': 0.80559874, 'binary_specificity': 0.9907433, 'binary_f1_score': 0.7795335}
confusion matrix:
       0    1
0  17981  168
1    125  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9683605, 'precision': 0.8828896, 'recall': 0.661001, 'specificity': 0.661001, 'f1': 0.72282875, 'auroc': 0.95953643, 'binary_precision': 0.7943925, 'binary_recall': 0.3256705, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.4619565}
confusion matrix:
      0   1
0  5975  22
1   176  85
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
new oracle model saved
early stop counter: 1
val acc:0.9844082593917847, best validation acc: 0.9844614863395691, corresponding to test acc:                         0.9680408835411072 / 0.9683604836463928
after epoch: 7,now: 2024-05-29 17:52:28.546352,epoch time: 0:37:59.559471,used: 4:14:25.242688,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98707527, 'precision': 0.92629135, 'recall': 0.86446416, 'specificity': 0.86446416, 'f1': 0.89277375, 'auroc': 0.98992145, 'binary_precision': 0.8618211, 'binary_recall': 0.7330163, 'binary_specificity': 0.9959121, 'binary_f1_score': 0.7922174}
confusion matrix:
       0     1
0  42147   173
1    393  1079
---- Validation: 
scalar performance:
{'acc': 0.98440826, 'precision': 0.90547514, 'recall': 0.8449171, 'specificity': 0.8449171, 'f1': 0.87255454, 'auroc': 0.9820235, 'binary_precision': 0.82169116, 'binary_recall': 0.69517887, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.7531592}
confusion matrix:
       0    1
0  18052   97
1    196  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.92199135, 'recall': 0.6085284, 'specificity': 0.6085284, 'f1': 0.666151, 'auroc': 0.9523071, 'binary_precision': 0.8769231, 'binary_recall': 0.21839081, 'binary_specificity': 0.998666, 'binary_f1_score': 0.34969327}
confusion matrix:
      0   1
0  5989   8
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 2
val acc:0.9844082593917847, best validation acc: 0.9844614863395691, corresponding to test acc:                         0.9680408835411072 / 0.9683604836463928
after epoch: 8,now: 2024-05-29 18:26:41.931578,epoch time: 0:34:13.385226,used: 4:48:38.627914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9805444, 'precision': 0.9525057, 'recall': 0.72895795, 'specificity': 0.72895795, 'f1': 0.80172557, 'auroc': 0.9875902, 'binary_precision': 0.92349726, 'binary_recall': 0.45923913, 'binary_specificity': 0.9986768, 'binary_f1_score': 0.6134301}
confusion matrix:
       0    1
0  42264   56
1    796  676
---- Validation: 
scalar performance:
{'acc': 0.9794061, 'precision': 0.95774007, 'recall': 0.71331793, 'specificity': 0.71331793, 'f1': 0.78820974, 'auroc': 0.9816557, 'binary_precision': 0.93537414, 'binary_recall': 0.42768273, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.5869797}
confusion matrix:
       0    1
0  18130   19
1    368  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.9030609, 'recall': 0.52090603, 'specificity': 0.52090603, 'f1': 0.5298535, 'auroc': 0.9162273, 'binary_precision': 0.84615386, 'binary_recall': 0.042145595, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.08029197}
confusion matrix:
      0   1
0  5995   2
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 3
val acc:0.9794061183929443, best validation acc: 0.9844614863395691, corresponding to test acc:                         0.9680408835411072 / 0.9683604836463928
after epoch: 9,now: 2024-05-29 19:00:26.489765,epoch time: 0:33:44.558187,used: 5:22:23.186101,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9873949, 'precision': 0.90481853, 'recall': 0.90003836, 'specificity': 0.90003836, 'f1': 0.90241313, 'auroc': 0.9918889, 'binary_precision': 0.81636864, 'binary_recall': 0.8063859, 'binary_specificity': 0.9936909, 'binary_f1_score': 0.81134653}
confusion matrix:
       0     1
0  42053   267
1    285  1187
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.9106759, 'recall': 0.882882, 'specificity': 0.882882, 'f1': 0.89625204, 'auroc': 0.9825765, 'binary_precision': 0.8294314, 'binary_recall': 0.7713841, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.7993553}
confusion matrix:
       0    1
0  18047  102
1    147  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.79314566, 'recall': 0.5373137, 'specificity': 0.5373137, 'f1': 0.55791, 'auroc': 0.94141275, 'binary_precision': 0.625, 'binary_recall': 0.07662835, 'binary_specificity': 0.997999, 'binary_f1_score': 0.13651878}
confusion matrix:
      0   1
0  5985  12
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 10,now: 2024-05-29 19:34:07.522969,epoch time: 0:33:41.033204,used: 5:56:04.219305,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9893131, 'precision': 0.9130043, 'recall': 0.9249157, 'specificity': 0.9249157, 'f1': 0.9188683, 'auroc': 0.9930631, 'binary_precision': 0.8310231, 'binary_recall': 0.8558804, 'binary_specificity': 0.993951, 'binary_f1_score': 0.84326863}
confusion matrix:
       0     1
0  42065   256
1    212  1259
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.89945805, 'recall': 0.89166224, 'specificity': 0.89166224, 'f1': 0.8955185, 'auroc': 0.9843123, 'binary_precision': 0.8063492, 'binary_recall': 0.79004663, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.7981147}
confusion matrix:
       0    1
0  18027  122
1    135  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685203, 'precision': 0.91682625, 'recall': 0.64459336, 'specificity': 0.64459336, 'f1': 0.70966935, 'auroc': 0.9642069, 'binary_precision': 0.8636364, 'binary_recall': 0.29118773, 'binary_specificity': 0.997999, 'binary_f1_score': 0.43553007}
confusion matrix:
      0   1
0  5985  12
1   185  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
new oracle model saved
early stop counter: 1
val acc:0.9863239526748657, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9595717191696167 / 0.9685202836990356
after epoch: 11,now: 2024-05-29 20:07:19.569193,epoch time: 0:33:12.046224,used: 6:29:16.265529,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99102575, 'precision': 0.941398, 'recall': 0.91732633, 'specificity': 0.91732633, 'f1': 0.92899835, 'auroc': 0.9954085, 'binary_precision': 0.8884089, 'binary_recall': 0.8383152, 'binary_specificity': 0.9963374, 'binary_f1_score': 0.8626354}
confusion matrix:
       0     1
0  42165   155
1    238  1234
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.9033142, 'recall': 0.8802737, 'specificity': 0.8802737, 'f1': 0.8914268, 'auroc': 0.98448133, 'binary_precision': 0.814876, 'binary_recall': 0.7667185, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.79006416}
confusion matrix:
       0    1
0  18037  112
1    150  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694791, 'precision': 0.8847058, 'recall': 0.6780757, 'specificity': 0.6780757, 'f1': 0.7401526, 'auroc': 0.9648721, 'binary_precision': 0.7966102, 'binary_recall': 0.36015326, 'binary_specificity': 0.995998, 'binary_f1_score': 0.4960422}
confusion matrix:
      0   1
0  5973  24
1   167  94
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
new oracle model saved
early stop counter: 2
val acc:0.9860578775405884, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9595717191696167 / 0.9694790840148926
after epoch: 12,now: 2024-05-29 20:40:56.972586,epoch time: 0:33:37.403393,used: 7:02:53.668922,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9913683, 'precision': 0.944557, 'recall': 0.91941714, 'specificity': 0.91941714, 'f1': 0.9315929, 'auroc': 0.9956877, 'binary_precision': 0.89458483, 'binary_recall': 0.84228414, 'binary_specificity': 0.9965502, 'binary_f1_score': 0.86764705}
confusion matrix:
       0     1
0  42175   146
1    232  1239
---- Validation: 
scalar performance:
{'acc': 0.98616433, 'precision': 0.9093088, 'recall': 0.8735783, 'specificity': 0.8735783, 'f1': 0.890561, 'auroc': 0.98466325, 'binary_precision': 0.82735044, 'binary_recall': 0.7527216, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.7882736}
confusion matrix:
       0    1
0  18048  101
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9701182, 'precision': 0.90443754, 'recall': 0.6747445, 'specificity': 0.6747445, 'f1': 0.74027985, 'auroc': 0.9566573, 'binary_precision': 0.8363636, 'binary_recall': 0.35249043, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.49595693}
confusion matrix:
      0   1
0  5979  18
1   169  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
new oracle model saved
early stop counter: 3
val acc:0.9861643314361572, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9595717191696167 / 0.9701182246208191
after epoch: 13,now: 2024-05-29 21:14:36.497126,epoch time: 0:33:39.524540,used: 7:36:33.193462,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9906147, 'precision': 0.96266615, 'recall': 0.88727844, 'specificity': 0.88727844, 'f1': 0.9213834, 'auroc': 0.9959004, 'binary_precision': 0.93306124, 'binary_recall': 0.77649456, 'binary_specificity': 0.9980624, 'binary_f1_score': 0.84760845}
confusion matrix:
       0     1
0  42238    82
1    329  1143
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.9354688, 'recall': 0.8459364, 'specificity': 0.8459364, 'f1': 0.8851825, 'auroc': 0.98388064, 'binary_precision': 0.8816568, 'binary_recall': 0.69517887, 'binary_specificity': 0.996694, 'binary_f1_score': 0.7773914}
confusion matrix:
       0    1
0  18089   60
1    196  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8920453, 'recall': 0.61002725, 'specificity': 0.61002725, 'f1': 0.66583467, 'auroc': 0.9466193, 'binary_precision': 0.8169014, 'binary_recall': 0.22222222, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.3493976}
confusion matrix:
      0   1
0  5984  13
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 4
val acc:0.9863771796226501, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9595717191696167 / 0.9701182246208191
after epoch: 14,now: 2024-05-29 21:47:20.863963,epoch time: 0:32:44.366837,used: 8:09:17.560299,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98440355, 'precision': 0.9889861, 'recall': 0.769642, 'specificity': 0.769642, 'f1': 0.84562284, 'auroc': 0.996521, 'binary_precision': 0.99374217, 'binary_recall': 0.5394022, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.6992515}
confusion matrix:
       0    1
0  42315    5
1    678  794
---- Validation: 
scalar performance:
{'acc': 0.98142827, 'precision': 0.97201115, 'recall': 0.73761654, 'specificity': 0.73761654, 'f1': 0.8136535, 'auroc': 0.98244643, 'binary_precision': 0.9622642, 'binary_recall': 0.47589424, 'binary_specificity': 0.9993388, 'binary_f1_score': 0.63683665}
confusion matrix:
       0    1
0  18137   12
1    337  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.94642854, 'recall': 0.57446253, 'specificity': 0.57446253, 'f1': 0.61950135, 'auroc': 0.95603514, 'binary_precision': 0.9285714, 'binary_recall': 0.14942528, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.25742573}
confusion matrix:
      0   1
0  5994   3
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 5
val acc:0.9814282655715942, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9595717191696167 / 0.9701182246208191
after epoch: 15,now: 2024-05-29 22:20:47.295824,epoch time: 0:33:26.431861,used: 8:42:43.992160,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9899525, 'precision': 0.90100765, 'recall': 0.95906484, 'specificity': 0.95906484, 'f1': 0.92790556, 'auroc': 0.9967119, 'binary_precision': 0.8046045, 'binary_recall': 0.92595106, 'binary_specificity': 0.9921786, 'binary_f1_score': 0.86102337}
confusion matrix:
       0     1
0  41989   331
1    109  1363
---- Validation: 
scalar performance:
{'acc': 0.98573864, 'precision': 0.8790912, 'recall': 0.9176111, 'specificity': 0.9176111, 'f1': 0.8973354, 'auroc': 0.9796579, 'binary_precision': 0.76371306, 'binary_recall': 0.844479, 'binary_specificity': 0.9907433, 'binary_f1_score': 0.80206794}
confusion matrix:
       0    1
0  17981  168
1    100  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97363377, 'precision': 0.9442785, 'recall': 0.7022314, 'specificity': 0.7022314, 'f1': 0.7743708, 'auroc': 0.95303607, 'binary_precision': 0.9137931, 'binary_recall': 0.40613025, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.5623342}
confusion matrix:
      0    1
0  5987   10
1   155  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
new oracle model saved
early stop counter: 6
val acc:0.9857386350631714, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9595717191696167 / 0.9736337661743164
after epoch: 16,now: 2024-05-29 22:54:12.203977,epoch time: 0:33:24.908153,used: 9:16:08.900313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9897698, 'precision': 0.9050979, 'recall': 0.9474621, 'specificity': 0.9474621, 'f1': 0.92513704, 'auroc': 0.9961113, 'binary_precision': 0.81361127, 'binary_recall': 0.9021074, 'binary_specificity': 0.9928168, 'binary_f1_score': 0.855577}
confusion matrix:
       0     1
0  42017   304
1    144  1327
---- Validation: 
scalar performance:
{'acc': 0.9853129, 'precision': 0.88485587, 'recall': 0.89638925, 'specificity': 0.89638925, 'f1': 0.8905299, 'auroc': 0.9798311, 'binary_precision': 0.77677226, 'binary_recall': 0.8009331, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.7886677}
confusion matrix:
       0    1
0  18001  148
1    128  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.8361956, 'recall': 0.7273819, 'specificity': 0.7273819, 'f1': 0.7701732, 'auroc': 0.9541302, 'binary_precision': 0.6954023, 'binary_recall': 0.46360153, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.55632186}
confusion matrix:
      0    1
0  5944   53
1   140  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 7
val acc:0.9853128790855408, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9595717191696167 / 0.9736337661743164
after epoch: 17,now: 2024-05-29 23:27:45.428217,epoch time: 0:33:33.224240,used: 9:49:42.124553,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9931723, 'precision': 0.95237225, 'recall': 0.94138706, 'specificity': 0.94138706, 'f1': 0.9468069, 'auroc': 0.99740446, 'binary_precision': 0.9087108, 'binary_recall': 0.88586956, 'binary_specificity': 0.99690455, 'binary_f1_score': 0.89714485}
confusion matrix:
       0     1
0  42189   131
1    168  1304
---- Validation: 
scalar performance:
{'acc': 0.98738825, 'precision': 0.9197372, 'recall': 0.8824625, 'specificity': 0.8824625, 'f1': 0.90016365, 'auroc': 0.9839251, 'binary_precision': 0.8476027, 'binary_recall': 0.7698289, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.80684596}
confusion matrix:
       0    1
0  18060   89
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.8499385, 'recall': 0.62818384, 'specificity': 0.62818384, 'f1': 0.6831281, 'auroc': 0.9332094, 'binary_precision': 0.7311828, 'binary_recall': 0.2605364, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.38418078}
confusion matrix:
      0   1
0  5972  25
1   193  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 18,now: 2024-05-30 00:00:21.177152,epoch time: 0:32:35.748935,used: 10:22:17.873488,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9930124, 'precision': 0.9409752, 'recall': 0.95310724, 'specificity': 0.95310724, 'f1': 0.94695234, 'auroc': 0.9983187, 'binary_precision': 0.88507265, 'binary_recall': 0.91032606, 'binary_specificity': 0.9958885, 'binary_f1_score': 0.8975218}
confusion matrix:
       0     1
0  42146   174
1    132  1340
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.90181065, 'recall': 0.896383, 'specificity': 0.896383, 'f1': 0.8990768, 'auroc': 0.9829316, 'binary_precision': 0.81072557, 'binary_recall': 0.7993779, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.80501175}
confusion matrix:
       0    1
0  18029  120
1    129  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.88467896, 'recall': 0.63643026, 'specificity': 0.63643026, 'f1': 0.69662017, 'auroc': 0.9476886, 'binary_precision': 0.8, 'binary_recall': 0.27586207, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.41025642}
confusion matrix:
      0   1
0  5979  18
1   189  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 1
val acc:0.9867497086524963, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9651646018028259 / 0.9736337661743164
after epoch: 19,now: 2024-05-30 00:33:26.516842,epoch time: 0:33:05.339690,used: 10:55:23.213178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.993355, 'precision': 0.9755802, 'recall': 0.919515, 'specificity': 0.919515, 'f1': 0.94566256, 'auroc': 0.99787354, 'binary_precision': 0.9566899, 'binary_recall': 0.84035325, 'binary_specificity': 0.9986768, 'binary_f1_score': 0.8947559}
confusion matrix:
       0     1
0  42264    56
1    235  1237
---- Validation: 
scalar performance:
{'acc': 0.9860047, 'precision': 0.93667865, 'recall': 0.838243, 'specificity': 0.838243, 'f1': 0.88073677, 'auroc': 0.9848893, 'binary_precision': 0.88461536, 'binary_recall': 0.67962676, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.7686895}
confusion matrix:
       0    1
0  18092   57
1    206  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.92423093, 'recall': 0.6256864, 'specificity': 0.6256864, 'f1': 0.6880542, 'auroc': 0.9488432, 'binary_precision': 0.88, 'binary_recall': 0.25287357, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.39285716}
confusion matrix:
      0   1
0  5988   9
1   195  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 2
val acc:0.9860047101974487, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9651646018028259 / 0.9736337661743164
after epoch: 20,now: 2024-05-30 01:06:26.457165,epoch time: 0:32:59.940323,used: 11:28:23.153501,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99219036, 'precision': 0.9535559, 'recall': 0.92312336, 'specificity': 0.92312336, 'f1': 0.9377709, 'auroc': 0.99761045, 'binary_precision': 0.91234475, 'binary_recall': 0.84908223, 'binary_specificity': 0.99716455, 'binary_f1_score': 0.87957746}
confusion matrix:
       0     1
0  42201   120
1    222  1249
---- Validation: 
scalar performance:
{'acc': 0.9864304, 'precision': 0.9260129, 'recall': 0.8572148, 'specificity': 0.8572148, 'f1': 0.88835526, 'auroc': 0.98184013, 'binary_precision': 0.8619403, 'binary_recall': 0.718507, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.783715}
confusion matrix:
       0    1
0  18075   74
1    181  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.9224305, 'recall': 0.621855, 'specificity': 0.621855, 'f1': 0.6831617, 'auroc': 0.92994356, 'binary_precision': 0.8767123, 'binary_recall': 0.24521072, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.38323352}
confusion matrix:
      0   1
0  5988   9
1   197  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 3
val acc:0.9864304065704346, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9651646018028259 / 0.9736337661743164
after epoch: 21,now: 2024-05-30 01:39:51.079708,epoch time: 0:33:24.622543,used: 12:01:47.776044,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99237305, 'precision': 0.92868054, 'recall': 0.9589797, 'specificity': 0.9589797, 'f1': 0.9432703, 'auroc': 0.9978647, 'binary_precision': 0.860038, 'binary_recall': 0.92318153, 'binary_specificity': 0.994778, 'binary_f1_score': 0.8904918}
confusion matrix:
       0     1
0  42100   221
1    113  1358
---- Validation: 
scalar performance:
{'acc': 0.9853661, 'precision': 0.8831317, 'recall': 0.90091705, 'specificity': 0.90091705, 'f1': 0.8918047, 'auroc': 0.98153466, 'binary_precision': 0.772997, 'binary_recall': 0.8102644, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.7911921}
confusion matrix:
       0    1
0  17996  153
1    122  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697987, 'precision': 0.8467791, 'recall': 0.72405076, 'specificity': 0.72405076, 'f1': 0.7708715, 'auroc': 0.9516296, 'binary_precision': 0.71686745, 'binary_recall': 0.4559387, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.55737704}
confusion matrix:
      0    1
0  5950   47
1   142  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 4
val acc:0.9853661060333252, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9651646018028259 / 0.9736337661743164
after epoch: 22,now: 2024-05-30 02:13:10.291428,epoch time: 0:33:19.211720,used: 12:35:06.987764,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99538726, 'precision': 0.9708485, 'recall': 0.95723, 'specificity': 0.95723, 'f1': 0.9639317, 'auroc': 0.998497, 'binary_precision': 0.9446003, 'binary_recall': 0.9163265, 'binary_specificity': 0.99813336, 'binary_f1_score': 0.9302486}
confusion matrix:
       0     1
0  42243    79
1    123  1347
---- Validation: 
scalar performance:
{'acc': 0.98690933, 'precision': 0.90811306, 'recall': 0.88971514, 'specificity': 0.88971514, 'f1': 0.89868426, 'auroc': 0.98220295, 'binary_precision': 0.8238173, 'binary_recall': 0.785381, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.80414015}
confusion matrix:
       0    1
0  18041  108
1    138  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.8729046, 'recall': 0.60028195, 'specificity': 0.60028195, 'f1': 0.6519451, 'auroc': 0.93999505, 'binary_precision': 0.7794118, 'binary_recall': 0.20306513, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.32218844}
confusion matrix:
      0   1
0  5982  15
1   208  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 5
val acc:0.9869093298912048, best validation acc: 0.9873882532119751, corresponding to test acc:                         0.9651646018028259 / 0.9736337661743164
after epoch: 23,now: 2024-05-30 02:46:24.006248,epoch time: 0:33:13.714820,used: 13:08:20.702584,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9944282, 'precision': 0.9635762, 'recall': 0.9495776, 'specificity': 0.9495776, 'f1': 0.95646137, 'auroc': 0.99873537, 'binary_precision': 0.930575, 'binary_recall': 0.90149456, 'binary_specificity': 0.9976607, 'binary_f1_score': 0.91580397}
confusion matrix:
       0     1
0  42221    99
1    145  1327
---- Validation: 
scalar performance:
{'acc': 0.9876011, 'precision': 0.9226609, 'recall': 0.88257277, 'specificity': 0.88257277, 'f1': 0.9015385, 'auroc': 0.97932357, 'binary_precision': 0.8534483, 'binary_recall': 0.7698289, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.8094849}
confusion matrix:
       0    1
0  18064   85
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9686801, 'precision': 0.896436, 'recall': 0.65750307, 'specificity': 0.65750307, 'f1': 0.7212186, 'auroc': 0.9319831, 'binary_precision': 0.8217822, 'binary_recall': 0.31800765, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.45856354}
confusion matrix:
      0   1
0  5979  18
1   178  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 24,now: 2024-05-30 03:19:41.285463,epoch time: 0:33:17.279215,used: 13:41:37.981799,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99388015, 'precision': 0.9331558, 'recall': 0.9801128, 'specificity': 0.9801128, 'f1': 0.9553269, 'auroc': 0.9990194, 'binary_precision': 0.86752135, 'binary_recall': 0.96535325, 'binary_specificity': 0.9948724, 'binary_f1_score': 0.9138264}
confusion matrix:
       0     1
0  42103   217
1     51  1421
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.8917453, 'recall': 0.90055275, 'specificity': 0.90055275, 'f1': 0.8960958, 'auroc': 0.98380136, 'binary_precision': 0.79027355, 'binary_recall': 0.8087092, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.7993851}
confusion matrix:
       0    1
0  18011  138
1    123  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.83820724, 'recall': 0.7274653, 'specificity': 0.7274653, 'f1': 0.77085614, 'auroc': 0.95670485, 'binary_precision': 0.69942194, 'binary_recall': 0.46360153, 'binary_specificity': 0.991329, 'binary_f1_score': 0.55760366}
confusion matrix:
      0    1
0  5945   52
1   140  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 1
val acc:0.9861111044883728, best validation acc: 0.987601101398468, corresponding to test acc:                         0.9686800837516785 / 0.9736337661743164
after epoch: 25,now: 2024-05-30 03:52:40.189546,epoch time: 0:32:58.904083,used: 14:14:36.885882,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99483925, 'precision': 0.9627712, 'recall': 0.9573029, 'specificity': 0.9573029, 'f1': 0.9600196, 'auroc': 0.99855006, 'binary_precision': 0.92842394, 'binary_recall': 0.91706324, 'binary_specificity': 0.9975426, 'binary_f1_score': 0.92270863}
confusion matrix:
       0     1
0  42217   104
1    122  1349
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.9204176, 'recall': 0.8531615, 'specificity': 0.8531615, 'f1': 0.8836347, 'auroc': 0.9849436, 'binary_precision': 0.8510242, 'binary_recall': 0.71073097, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.7745763}
confusion matrix:
       0    1
0  18069   80
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.88624454, 'recall': 0.6743276, 'specificity': 0.6743276, 'f1': 0.73677313, 'auroc': 0.9419638, 'binary_precision': 0.8, 'binary_recall': 0.35249043, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.48936173}
confusion matrix:
      0   1
0  5974  23
1   169  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 2
val acc:0.9858450293540955, best validation acc: 0.987601101398468, corresponding to test acc:                         0.9686800837516785 / 0.9736337661743164
after epoch: 26,now: 2024-05-30 04:25:20.450151,epoch time: 0:32:40.260605,used: 14:47:17.146487,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9919392, 'precision': 0.97448283, 'recall': 0.8977995, 'specificity': 0.8977995, 'f1': 0.9325261, 'auroc': 0.99793375, 'binary_precision': 0.9559902, 'binary_recall': 0.796875, 'binary_specificity': 0.998724, 'binary_f1_score': 0.86921084}
confusion matrix:
       0     1
0  42266    54
1    299  1173
---- Validation: 
scalar performance:
{'acc': 0.9832908, 'precision': 0.92947835, 'recall': 0.7978351, 'specificity': 0.7978351, 'f1': 0.8508647, 'auroc': 0.971329, 'binary_precision': 0.8730159, 'binary_recall': 0.59875584, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.71033216}
confusion matrix:
       0    1
0  18093   56
1    258  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8043295, 'recall': 0.5411451, 'specificity': 0.5411451, 'f1': 0.56430703, 'auroc': 0.9285982, 'binary_precision': 0.64705884, 'binary_recall': 0.08429119, 'binary_specificity': 0.997999, 'binary_f1_score': 0.14915255}
confusion matrix:
      0   1
0  5985  12
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 3
val acc:0.9832907915115356, best validation acc: 0.987601101398468, corresponding to test acc:                         0.9686800837516785 / 0.9736337661743164
after epoch: 27,now: 2024-05-30 04:58:05.623739,epoch time: 0:32:45.173588,used: 15:20:02.320075,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9939715, 'precision': 0.9773489, 'recall': 0.92770267, 'specificity': 0.92770267, 'f1': 0.95106363, 'auroc': 0.9988513, 'binary_precision': 0.9596651, 'binary_recall': 0.8566576, 'binary_specificity': 0.99874765, 'binary_f1_score': 0.9052405}
confusion matrix:
       0     1
0  42267    53
1    211  1261
---- Validation: 
scalar performance:
{'acc': 0.98557895, 'precision': 0.9393998, 'recall': 0.8282719, 'specificity': 0.8282719, 'f1': 0.87519383, 'auroc': 0.9814148, 'binary_precision': 0.8907563, 'binary_recall': 0.65940905, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.7578195}
confusion matrix:
       0    1
0  18097   52
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685203, 'precision': 0.92533207, 'recall': 0.6409287, 'specificity': 0.6409287, 'f1': 0.70639974, 'auroc': 0.9378314, 'binary_precision': 0.88095236, 'binary_recall': 0.2835249, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.4289855}
confusion matrix:
      0   1
0  5987  10
1   187  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 4
val acc:0.9855789542198181, best validation acc: 0.987601101398468, corresponding to test acc:                         0.9686800837516785 / 0.9736337661743164
after epoch: 28,now: 2024-05-30 05:31:08.911633,epoch time: 0:33:03.287894,used: 15:53:05.607969,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9960267, 'precision': 0.9720253, 'recall': 0.9664476, 'specificity': 0.9664476, 'f1': 0.9692186, 'auroc': 0.99920547, 'binary_precision': 0.946318, 'binary_recall': 0.9347383, 'binary_specificity': 0.99815696, 'binary_f1_score': 0.94049245}
confusion matrix:
       0     1
0  42243    78
1     96  1375
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.92425835, 'recall': 0.85252166, 'specificity': 0.85252166, 'f1': 0.8848177, 'auroc': 0.984498, 'binary_precision': 0.8587571, 'binary_recall': 0.70917577, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.7768313}
confusion matrix:
       0    1
0  18074   75
1    187  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709172, 'precision': 0.86257255, 'recall': 0.72463435, 'specificity': 0.72463435, 'f1': 0.7758101, 'auroc': 0.9495241, 'binary_precision': 0.7484277, 'binary_recall': 0.4559387, 'binary_specificity': 0.99333, 'binary_f1_score': 0.56666666}
confusion matrix:
      0    1
0  5957   40
1   142  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 5
val acc:0.9860578775405884, best validation acc: 0.987601101398468, corresponding to test acc:                         0.9686800837516785 / 0.9736337661743164
after epoch: 29,now: 2024-05-30 06:03:57.138432,epoch time: 0:32:48.226799,used: 16:25:53.834768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9948849, 'precision': 0.9865856, 'recall': 0.9333309, 'specificity': 0.9333309, 'f1': 0.9583045, 'auroc': 0.9993527, 'binary_precision': 0.97776073, 'binary_recall': 0.86734694, 'binary_specificity': 0.9993148, 'binary_f1_score': 0.9192502}
confusion matrix:
       0     1
0  42293    29
1    195  1275
---- Validation: 
scalar performance:
{'acc': 0.98706895, 'precision': 0.9494821, 'recall': 0.84404445, 'specificity': 0.84404445, 'f1': 0.8892399, 'auroc': 0.98286927, 'binary_precision': 0.90983605, 'binary_recall': 0.6905132, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.78514594}
confusion matrix:
       0    1
0  18105   44
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9683605, 'precision': 0.89768195, 'recall': 0.6518393, 'specificity': 0.6518393, 'f1': 0.7153209, 'auroc': 0.95643795, 'binary_precision': 0.82474226, 'binary_recall': 0.3065134, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.4469274}
confusion matrix:
      0   1
0  5980  17
1   181  80
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 6
val acc:0.9870689511299133, best validation acc: 0.987601101398468, corresponding to test acc:                         0.9686800837516785 / 0.9736337661743164
after epoch: 30,now: 2024-05-30 06:37:06.599982,epoch time: 0:33:09.461550,used: 16:59:03.296318,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 16:59:03.296318 at 2024-05-30 06:37:06.599982
persisted model performance metric: 

scalar performance:
{'acc': 0.9678811, 'precision': 0.9091885, 'recall': 0.63876283, 'specificity': 0.63876283, 'f1': 0.7021159, 'auroc': 0.94100386, 'binary_precision': 0.8488372, 'binary_recall': 0.27969348, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.42074925}
confusion matrix:
      0   1
0  5984  13
1   188  73
oracle model performance metric: 

scalar performance:
{'acc': 0.97203577, 'precision': 0.92231977, 'recall': 0.69223595, 'specificity': 0.69223595, 'f1': 0.7606963, 'auroc': 0.9446182, 'binary_precision': 0.87068963, 'binary_recall': 0.38697317, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.53580904}
confusion matrix:
      0    1
0  5982   15
1   160  101
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457596 KiB |   2003 MiB |    928 TiB |    928 TiB |
|       from large pool | 415909 KiB |   1971 MiB |    916 TiB |    916 TiB |
|       from small pool |  41687 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457596 KiB |   2003 MiB |    928 TiB |    928 TiB |
|       from large pool | 415909 KiB |   1971 MiB |    916 TiB |    916 TiB |
|       from small pool |  41687 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |   1998 MiB |    928 TiB |    928 TiB |
|       from large pool | 407075 KiB |   1966 MiB |    916 TiB |    916 TiB |
|       from small pool |  40679 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2272 MiB |   2272 MiB |   2272 MiB |      0 B   |
|       from large pool |   2202 MiB |   2202 MiB |   2202 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 291971 KiB | 361588 KiB | 756240 GiB | 756239 GiB |
|       from large pool | 286555 KiB | 357150 KiB | 743248 GiB | 743248 GiB |
|       from small pool |   5416 KiB |  10980 KiB |  12991 GiB |  12991 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6459    |  180480 K  |  180476 K  |
|       from large pool |     187    |     311    |   87939 K  |   87939 K  |
|       from small pool |    3301    |    6271    |   92540 K  |   92537 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6459    |  180480 K  |  180476 K  |
|       from large pool |     187    |     311    |   87939 K  |   87939 K  |
|       from small pool |    3301    |    6271    |   92540 K  |   92537 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     127    |     127    |     127    |       0    |
|       from large pool |      92    |      92    |      92    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      58    |    2782    |   95766 K  |   95766 K  |
|       from large pool |      26    |      89    |   59622 K  |   59622 K  |
|       from small pool |      32    |    2756    |   36143 K  |   36143 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |    928 TiB |    928 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    916 TiB |    916 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |    928 TiB |    928 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    916 TiB |    916 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |    928 TiB |    928 TiB |
|       from large pool |  16640 KiB |   1966 MiB |    916 TiB |    916 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 749568 KiB |   2272 MiB |   2272 MiB |   1540 MiB |
|       from large pool | 702464 KiB |   2202 MiB |   2202 MiB |   1516 MiB |
|       from small pool |  47104 KiB |     70 MiB |     70 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 414066 KiB | 756240 GiB | 756240 GiB |
|       from large pool |  24320 KiB | 392029 KiB | 743249 GiB | 743249 GiB |
|       from small pool |      0 KiB |  24350 KiB |  12991 GiB |  12991 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6459    |  180480 K  |  180480 K  |
|       from large pool |       2    |     311    |   87939 K  |   87939 K  |
|       from small pool |       0    |    6271    |   92540 K  |   92540 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6459    |  180480 K  |  180480 K  |
|       from large pool |       2    |     311    |   87939 K  |   87939 K  |
|       from small pool |       0    |    6271    |   92540 K  |   92540 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |     127    |     127    |      73    |
|       from large pool |      31    |      92    |      92    |      61    |
|       from small pool |      23    |      35    |      35    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2782    |   95767 K  |   95767 K  |
|       from large pool |       3    |      89    |   59622 K  |   59622 K  |
|       from small pool |       0    |    2756    |   36145 K  |   36145 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |    928 TiB |    928 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    916 TiB |    916 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |    928 TiB |    928 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    916 TiB |    916 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |    928 TiB |    928 TiB |
|       from large pool |  16640 KiB |   1966 MiB |    916 TiB |    916 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 749568 KiB |   2272 MiB |   2272 MiB |   1540 MiB |
|       from large pool | 702464 KiB |   2202 MiB |   2202 MiB |   1516 MiB |
|       from small pool |  47104 KiB |     70 MiB |     70 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 414066 KiB | 756240 GiB | 756240 GiB |
|       from large pool |  24320 KiB | 392029 KiB | 743249 GiB | 743249 GiB |
|       from small pool |      0 KiB |  24350 KiB |  12991 GiB |  12991 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6459    |  180480 K  |  180480 K  |
|       from large pool |       2    |     311    |   87939 K  |   87939 K  |
|       from small pool |       0    |    6271    |   92540 K  |   92540 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6459    |  180480 K  |  180480 K  |
|       from large pool |       2    |     311    |   87939 K  |   87939 K  |
|       from small pool |       0    |    6271    |   92540 K  |   92540 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |     127    |     127    |      73    |
|       from large pool |      31    |      92    |      92    |      61    |
|       from small pool |      23    |      35    |      35    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2782    |   95767 K  |   95767 K  |
|       from large pool |       3    |      89    |   59622 K  |   59622 K  |
|       from small pool |       0    |    2756    |   36145 K  |   36145 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755

 Experiment start at: 2024-05-30 06:49:39.700248
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9677125, 'precision': 0.7486188, 'recall': 0.8587052, 'specificity': 0.8587052, 'f1': 0.7924869, 'auroc': 0.9660026, 'binary_precision': 0.5061495, 'binary_recall': 0.74202496, 'binary_specificity': 0.9753855, 'binary_f1_score': 0.6017998}
confusion matrix:
       0     1
0  41370  1044
1    372  1070
---- Validation: 
scalar performance:
{'acc': 0.9670224, 'precision': 0.76071924, 'recall': 0.7926359, 'specificity': 0.7926359, 'f1': 0.77564603, 'auroc': 0.9636948, 'binary_precision': 0.5362319, 'binary_recall': 0.6047548, 'binary_specificity': 0.98051697, 'binary_f1_score': 0.5684358}
confusion matrix:
       0    1
0  17715  352
1    266  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97260714, 'precision': 0.85292625, 'recall': 0.7742212, 'specificity': 0.7742212, 'f1': 0.8081056, 'auroc': 0.9524852, 'binary_precision': 0.725, 'binary_recall': 0.5576923, 'binary_specificity': 0.9907501, 'binary_f1_score': 0.63043475}
confusion matrix:
      0    1
0  5891   55
1   115  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-30 07:24:45.096944,epoch time: 0:35:05.396696,used: 0:35:05.396696,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97749454, 'precision': 0.9088533, 'recall': 0.69427675, 'specificity': 0.69427675, 'f1': 0.7609013, 'auroc': 0.9725344, 'binary_precision': 0.8380386, 'binary_recall': 0.39112344, 'binary_specificity': 0.9974301, 'binary_f1_score': 0.5333333}
confusion matrix:
       0    1
0  42305  109
1    878  564
---- Validation: 
scalar performance:
{'acc': 0.97321236, 'precision': 0.8820379, 'recall': 0.67210495, 'specificity': 0.67210495, 'f1': 0.7343623, 'auroc': 0.96873224, 'binary_precision': 0.7878788, 'binary_recall': 0.34769687, 'binary_specificity': 0.996513, 'binary_f1_score': 0.48247424}
confusion matrix:
       0    1
0  18004   63
1    439  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.94534755, 'recall': 0.5498318, 'specificity': 0.5498318, 'f1': 0.580545, 'auroc': 0.9584278, 'binary_precision': 0.9285714, 'binary_recall': 0.1, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.18055557}
confusion matrix:
      0   1
0  5944   2
1   234  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 2,now: 2024-05-30 07:57:26.064710,epoch time: 0:32:40.967766,used: 1:07:46.364462,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98137087, 'precision': 0.86516905, 'recall': 0.8285869, 'specificity': 0.8285869, 'f1': 0.8458327, 'auroc': 0.97815245, 'binary_precision': 0.741686, 'binary_recall': 0.66504854, 'binary_specificity': 0.9921252, 'binary_f1_score': 0.70127976}
confusion matrix:
       0    1
0  42080  334
1    483  959
---- Validation: 
scalar performance:
{'acc': 0.97758806, 'precision': 0.84813803, 'recall': 0.8131361, 'specificity': 0.8131361, 'f1': 0.82962275, 'auroc': 0.973668, 'binary_precision': 0.7097844, 'binary_recall': 0.6359584, 'binary_specificity': 0.9903138, 'binary_f1_score': 0.6708464}
confusion matrix:
       0    1
0  17892  175
1    245  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.83093536, 'recall': 0.56980836, 'specificity': 0.56980836, 'f1': 0.608334, 'auroc': 0.96643126, 'binary_precision': 0.6981132, 'binary_recall': 0.1423077, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.23642173}
confusion matrix:
      0   1
0  5930  16
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 3,now: 2024-05-30 08:30:51.044203,epoch time: 0:33:24.979493,used: 1:41:11.343955,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.982853, 'precision': 0.9034965, 'recall': 0.80423176, 'specificity': 0.80423176, 'f1': 0.8463801, 'auroc': 0.9825959, 'binary_precision': 0.8200371, 'binary_recall': 0.61303747, 'binary_specificity': 0.99542606, 'binary_f1_score': 0.7015873}
confusion matrix:
       0    1
0  42220  194
1    558  884
---- Validation: 
scalar performance:
{'acc': 0.9790288, 'precision': 0.8855257, 'recall': 0.7824116, 'specificity': 0.7824116, 'f1': 0.82533896, 'auroc': 0.97769904, 'binary_precision': 0.78688526, 'binary_recall': 0.57057947, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.66149867}
confusion matrix:
       0    1
0  17963  104
1    289  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.75357765, 'recall': 0.54447204, 'specificity': 0.54447204, 'f1': 0.5683759, 'auroc': 0.96437454, 'binary_precision': 0.54545456, 'binary_recall': 0.092307694, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.15789475}
confusion matrix:
      0   1
0  5926  20
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 4,now: 2024-05-30 09:04:10.623222,epoch time: 0:33:19.579019,used: 2:14:30.922974,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9788855, 'precision': 0.81667686, 'recall': 0.9015987, 'specificity': 0.9015987, 'f1': 0.85361516, 'auroc': 0.98300946, 'binary_precision': 0.6395664, 'binary_recall': 0.8188758, 'binary_specificity': 0.9843216, 'binary_f1_score': 0.7181984}
confusion matrix:
       0     1
0  41750   665
1    261  1180
---- Validation: 
scalar performance:
{'acc': 0.976841, 'precision': 0.8147837, 'recall': 0.90644866, 'specificity': 0.90644866, 'f1': 0.8541405, 'auroc': 0.9798682, 'binary_precision': 0.63594997, 'binary_recall': 0.8306092, 'binary_specificity': 0.9822881, 'binary_f1_score': 0.7203608}
confusion matrix:
       0    1
0  17747  320
1    114  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.81941384, 'recall': 0.6335953, 'specificity': 0.6335953, 'f1': 0.6846914, 'auroc': 0.96389544, 'binary_precision': 0.6698113, 'binary_recall': 0.27307692, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.38797814}
confusion matrix:
      0   1
0  5911  35
1   189  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 1
val acc:0.9768409729003906, best validation acc: 0.9790288209915161, corresponding to test acc:                         0.9587495923042297 / 0.9726071357727051
after epoch: 5,now: 2024-05-30 09:37:29.318773,epoch time: 0:33:18.695551,used: 2:47:49.618525,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98346865, 'precision': 0.95543253, 'recall': 0.7693801, 'specificity': 0.7693801, 'f1': 0.83697444, 'auroc': 0.9868661, 'binary_precision': 0.92627823, 'binary_recall': 0.5402219, 'binary_specificity': 0.9985382, 'binary_f1_score': 0.68243545}
confusion matrix:
       0    1
0  42352   62
1    663  779
---- Validation: 
scalar performance:
{'acc': 0.9801494, 'precision': 0.93450785, 'recall': 0.75509727, 'specificity': 0.75509727, 'f1': 0.8197514, 'auroc': 0.9812812, 'binary_precision': 0.88688946, 'binary_recall': 0.51263, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.6497175}
confusion matrix:
       0    1
0  18023   44
1    328  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.7905426, 'recall': 0.54865456, 'specificity': 0.54865456, 'f1': 0.5757707, 'auroc': 0.9558928, 'binary_precision': 0.61904764, 'binary_recall': 0.1, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.17218544}
confusion matrix:
      0   1
0  5930  16
1   234  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 6,now: 2024-05-30 10:10:49.765037,epoch time: 0:33:20.446264,used: 3:21:10.064789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98501915, 'precision': 0.8645719, 'recall': 0.9211942, 'specificity': 0.9211942, 'f1': 0.89065945, 'auroc': 0.98791766, 'binary_precision': 0.73416966, 'binary_recall': 0.85287994, 'binary_specificity': 0.98950845, 'binary_f1_score': 0.7890851}
confusion matrix:
       0     1
0  41970   445
1    212  1229
---- Validation: 
scalar performance:
{'acc': 0.98281753, 'precision': 0.8663762, 'recall': 0.89667344, 'specificity': 0.89667344, 'f1': 0.88086486, 'auroc': 0.98225933, 'binary_precision': 0.7400821, 'binary_recall': 0.8038633, 'binary_specificity': 0.9894836, 'binary_f1_score': 0.7706553}
confusion matrix:
       0    1
0  17877  190
1    132  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96809536, 'precision': 0.8491349, 'recall': 0.68911225, 'specificity': 0.68911225, 'f1': 0.7430159, 'auroc': 0.96160525, 'binary_precision': 0.7246377, 'binary_recall': 0.3846154, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.5025126}
confusion matrix:
      0    1
0  5908   38
1   160  100
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 7,now: 2024-05-30 10:43:59.723876,epoch time: 0:33:09.958839,used: 3:54:20.023628,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9850876, 'precision': 0.9189817, 'recall': 0.8301735, 'specificity': 0.8301735, 'f1': 0.868922, 'auroc': 0.98834324, 'binary_precision': 0.8492908, 'binary_recall': 0.66435504, 'binary_specificity': 0.9959919, 'binary_f1_score': 0.74552524}
confusion matrix:
       0    1
0  42244  170
1    484  958
---- Validation: 
scalar performance:
{'acc': 0.9798826, 'precision': 0.91678464, 'recall': 0.7649727, 'specificity': 0.7649727, 'f1': 0.8226732, 'auroc': 0.9810091, 'binary_precision': 0.8507109, 'binary_recall': 0.53343236, 'binary_specificity': 0.996513, 'binary_f1_score': 0.6557077}
confusion matrix:
       0    1
0  18004   63
1    314  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.77565664, 'recall': 0.5428853, 'specificity': 0.5428853, 'f1': 0.56647974, 'auroc': 0.9531561, 'binary_precision': 0.5897436, 'binary_recall': 0.08846154, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.15384616}
confusion matrix:
      0   1
0  5930  16
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 1
val acc:0.9798825979232788, best validation acc: 0.982817530632019, corresponding to test acc:                         0.9680953621864319 / 0.9726071357727051
after epoch: 8,now: 2024-05-30 11:17:01.548098,epoch time: 0:33:01.824222,used: 4:27:21.847850,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.983423, 'precision': 0.8494979, 'recall': 0.92175967, 'specificity': 0.92175967, 'f1': 0.8819276, 'auroc': 0.9887934, 'binary_precision': 0.7039361, 'binary_recall': 0.85575587, 'binary_specificity': 0.98776346, 'binary_f1_score': 0.77245694}
confusion matrix:
       0     1
0  41895   519
1    208  1234
---- Validation: 
scalar performance:
{'acc': 0.9822839, 'precision': 0.8645999, 'recall': 0.88852876, 'specificity': 0.88852876, 'f1': 0.8761473, 'auroc': 0.9801595, 'binary_precision': 0.73713493, 'binary_recall': 0.78751856, 'binary_specificity': 0.98953897, 'binary_f1_score': 0.76149434}
confusion matrix:
       0    1
0  17878  189
1    143  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970029, 'precision': 0.8793057, 'recall': 0.6937993, 'specificity': 0.6937993, 'f1': 0.75380266, 'auroc': 0.9601232, 'binary_precision': 0.7846154, 'binary_recall': 0.3923077, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.52307695}
confusion matrix:
      0    1
0  5918   28
1   158  102
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 2
val acc:0.982283890247345, best validation acc: 0.982817530632019, corresponding to test acc:                         0.9680953621864319 / 0.9726071357727051
after epoch: 9,now: 2024-05-30 11:50:36.943019,epoch time: 0:33:35.394921,used: 5:00:57.242771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98643285, 'precision': 0.88498247, 'recall': 0.90891284, 'specificity': 0.90891284, 'f1': 0.89655626, 'auroc': 0.990124, 'binary_precision': 0.7758958, 'binary_recall': 0.8259362, 'binary_specificity': 0.9918895, 'binary_f1_score': 0.8001344}
confusion matrix:
       0     1
0  42070   344
1    251  1191
---- Validation: 
scalar performance:
{'acc': 0.98036283, 'precision': 0.84848493, 'recall': 0.8832408, 'specificity': 0.8832408, 'f1': 0.8649545, 'auroc': 0.98163146, 'binary_precision': 0.705249, 'binary_recall': 0.77860326, 'binary_specificity': 0.98787844, 'binary_f1_score': 0.74011296}
confusion matrix:
       0    1
0  17848  219
1    149  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.8265243, 'recall': 0.57917154, 'specificity': 0.57917154, 'f1': 0.62104046, 'auroc': 0.9496782, 'binary_precision': 0.6885246, 'binary_recall': 0.16153847, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.26168224}
confusion matrix:
      0   1
0  5927  19
1   218  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 3
val acc:0.9803628325462341, best validation acc: 0.982817530632019, corresponding to test acc:                         0.9680953621864319 / 0.9726071357727051
after epoch: 10,now: 2024-05-30 12:23:56.062101,epoch time: 0:33:19.119082,used: 5:34:16.361853,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9862732, 'precision': 0.886093, 'recall': 0.90313613, 'specificity': 0.90313613, 'f1': 0.89441496, 'auroc': 0.99188673, 'binary_precision': 0.77851456, 'binary_recall': 0.814147, 'binary_specificity': 0.9921252, 'binary_f1_score': 0.7959322}
confusion matrix:
       0     1
0  42080   334
1    268  1174
---- Validation: 
scalar performance:
{'acc': 0.98313767, 'precision': 0.8824254, 'recall': 0.87037456, 'specificity': 0.87037456, 'f1': 0.87629473, 'auroc': 0.9801526, 'binary_precision': 0.7741935, 'binary_recall': 0.7488856, 'binary_specificity': 0.9918636, 'binary_f1_score': 0.7613293}
confusion matrix:
       0    1
0  17920  147
1    169  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.80081975, 'recall': 0.6012393, 'specificity': 0.6012393, 'f1': 0.6467016, 'auroc': 0.955145, 'binary_precision': 0.63529414, 'binary_recall': 0.20769231, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.3130435}
confusion matrix:
      0   1
0  5915  31
1   206  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 11,now: 2024-05-30 12:56:54.817807,epoch time: 0:32:58.755706,used: 6:07:15.117559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9893515, 'precision': 0.9042815, 'recall': 0.93587816, 'specificity': 0.93587816, 'f1': 0.91943616, 'auroc': 0.9937271, 'binary_precision': 0.81270045, 'binary_recall': 0.8786408, 'binary_specificity': 0.9931155, 'binary_f1_score': 0.8443852}
confusion matrix:
       0     1
0  42122   292
1    175  1267
---- Validation: 
scalar performance:
{'acc': 0.98457843, 'precision': 0.88611984, 'recall': 0.8932951, 'specificity': 0.8932951, 'f1': 0.8896714, 'auroc': 0.9824946, 'binary_precision': 0.7798834, 'binary_recall': 0.794948, 'binary_specificity': 0.99164224, 'binary_f1_score': 0.7873437}
confusion matrix:
       0    1
0  17916  151
1    138  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96761197, 'precision': 0.88417083, 'recall': 0.65024126, 'specificity': 0.65024126, 'f1': 0.7117175, 'auroc': 0.95544726, 'binary_precision': 0.7979798, 'binary_recall': 0.30384615, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.4401114}
confusion matrix:
      0   1
0  5926  20
1   181  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 12,now: 2024-05-30 13:30:10.043336,epoch time: 0:33:15.225529,used: 6:40:30.343088,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9901268, 'precision': 0.9250797, 'recall': 0.91852653, 'specificity': 0.91852653, 'f1': 0.92177564, 'auroc': 0.994227, 'binary_precision': 0.85553205, 'binary_recall': 0.8418863, 'binary_specificity': 0.9951667, 'binary_f1_score': 0.84865427}
confusion matrix:
       0     1
0  42209   205
1    228  1214
---- Validation: 
scalar performance:
{'acc': 0.98404485, 'precision': 0.8978131, 'recall': 0.86297715, 'specificity': 0.86297715, 'f1': 0.87952715, 'auroc': 0.97902584, 'binary_precision': 0.8055556, 'binary_recall': 0.73254085, 'binary_specificity': 0.9934134, 'binary_f1_score': 0.7673152}
confusion matrix:
       0    1
0  17948  119
1    180  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.8489212, 'recall': 0.6418762, 'specificity': 0.6418762, 'f1': 0.6977727, 'auroc': 0.9576434, 'binary_precision': 0.7281553, 'binary_recall': 0.28846154, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.41322315}
confusion matrix:
      0   1
0  5918  28
1   185  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 1
val acc:0.9840448498725891, best validation acc: 0.9845784306526184, corresponding to test acc:                         0.9676119685173035 / 0.9726071357727051
after epoch: 13,now: 2024-05-30 14:03:31.990465,epoch time: 0:33:21.947129,used: 7:13:52.290217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98907787, 'precision': 0.89389247, 'recall': 0.94980466, 'specificity': 0.94980466, 'f1': 0.91983664, 'auroc': 0.9952041, 'binary_precision': 0.7909365, 'binary_recall': 0.907767, 'binary_specificity': 0.9918423, 'binary_f1_score': 0.84533423}
confusion matrix:
       0     1
0  42068   346
1    133  1309
---- Validation: 
scalar performance:
{'acc': 0.98553896, 'precision': 0.8933299, 'recall': 0.8995154, 'specificity': 0.8995154, 'f1': 0.89639634, 'auroc': 0.98265535, 'binary_precision': 0.79385966, 'binary_recall': 0.80683506, 'binary_specificity': 0.9921957, 'binary_f1_score': 0.80029476}
confusion matrix:
       0    1
0  17926  141
1    130  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.7961363, 'recall': 0.64788675, 'specificity': 0.64788675, 'f1': 0.69461256, 'auroc': 0.9573572, 'binary_precision': 0.62204725, 'binary_recall': 0.30384615, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.40826872}
confusion matrix:
      0   1
0  5898  48
1   181  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 14,now: 2024-05-30 14:36:50.975627,epoch time: 0:33:18.985162,used: 7:47:11.275379,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9914037, 'precision': 0.96594435, 'recall': 0.89406526, 'specificity': 0.89406526, 'f1': 0.9267857, 'auroc': 0.99651694, 'binary_precision': 0.9389942, 'binary_recall': 0.78987515, 'binary_specificity': 0.9982553, 'binary_f1_score': 0.8580037}
confusion matrix:
       0     1
0  42340    74
1    303  1139
---- Validation: 
scalar performance:
{'acc': 0.983778, 'precision': 0.9365518, 'recall': 0.81277, 'specificity': 0.81277, 'f1': 0.8636422, 'auroc': 0.97964376, 'binary_precision': 0.8867925, 'binary_recall': 0.62852895, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.73565215}
confusion matrix:
       0    1
0  18013   54
1    250  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.85634935, 'recall': 0.5568514, 'specificity': 0.5568514, 'f1': 0.5900925, 'auroc': 0.940156, 'binary_precision': 0.75, 'binary_recall': 0.115384616, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.2}
confusion matrix:
      0   1
0  5936  10
1   230  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 1
val acc:0.9837779998779297, best validation acc: 0.9855389595031738, corresponding to test acc:                         0.963100254535675 / 0.9726071357727051
after epoch: 15,now: 2024-05-30 15:09:58.532551,epoch time: 0:33:07.556924,used: 8:20:18.832303,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9926806, 'precision': 0.9586277, 'recall': 0.9231963, 'specificity': 0.9231963, 'f1': 0.94014734, 'auroc': 0.9962145, 'binary_precision': 0.9223813, 'binary_recall': 0.8488211, 'binary_specificity': 0.9975715, 'binary_f1_score': 0.8840737}
confusion matrix:
       0     1
0  42311   103
1    218  1224
---- Validation: 
scalar performance:
{'acc': 0.9854322, 'precision': 0.9214512, 'recall': 0.856544, 'specificity': 0.856544, 'f1': 0.88606405, 'auroc': 0.9810683, 'binary_precision': 0.8533569, 'binary_recall': 0.717682, 'binary_specificity': 0.995406, 'binary_f1_score': 0.779661}
confusion matrix:
       0    1
0  17984   83
1    190  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.8452095, 'recall': 0.59455615, 'specificity': 0.59455615, 'f1': 0.64249957, 'auroc': 0.94751805, 'binary_precision': 0.7246377, 'binary_recall': 0.1923077, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.30395138}
confusion matrix:
      0   1
0  5927  19
1   210  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 2
val acc:0.9854322075843811, best validation acc: 0.9855389595031738, corresponding to test acc:                         0.963100254535675 / 0.9726071357727051
after epoch: 16,now: 2024-05-30 15:43:24.217021,epoch time: 0:33:25.684470,used: 8:53:44.516773,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9904688, 'precision': 0.95912176, 'recall': 0.88487315, 'specificity': 0.88487315, 'f1': 0.9184963, 'auroc': 0.9946047, 'binary_precision': 0.9259567, 'binary_recall': 0.7718447, 'binary_specificity': 0.9979016, 'binary_f1_score': 0.84190625}
confusion matrix:
       0     1
0  42325    89
1    329  1113
---- Validation: 
scalar performance:
{'acc': 0.9860192, 'precision': 0.9379561, 'recall': 0.8482652, 'specificity': 0.8482652, 'f1': 0.8875848, 'auroc': 0.9771549, 'binary_precision': 0.8870056, 'binary_recall': 0.6998514, 'binary_specificity': 0.996679, 'binary_f1_score': 0.78239197}
confusion matrix:
       0    1
0  18007   60
1    202  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.9023597, 'recall': 0.5705652, 'specificity': 0.5705652, 'f1': 0.6122127, 'auroc': 0.94209844, 'binary_precision': 0.84090906, 'binary_recall': 0.1423077, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.24342106}
confusion matrix:
      0   1
0  5939   7
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 17,now: 2024-05-30 16:16:39.005175,epoch time: 0:33:14.788154,used: 9:26:59.304927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9916317, 'precision': 0.928833, 'recall': 0.94174635, 'specificity': 0.94174635, 'f1': 0.9351863, 'auroc': 0.9964479, 'binary_precision': 0.86146605, 'binary_recall': 0.88834953, 'binary_specificity': 0.9951431, 'binary_f1_score': 0.8747013}
confusion matrix:
       0     1
0  42208   206
1    161  1281
---- Validation: 
scalar performance:
{'acc': 0.98415154, 'precision': 0.88654083, 'recall': 0.88377523, 'specificity': 0.88377523, 'f1': 0.88515264, 'auroc': 0.97876084, 'binary_precision': 0.7814371, 'binary_recall': 0.7756315, 'binary_specificity': 0.991919, 'binary_f1_score': 0.7785235}
confusion matrix:
       0    1
0  17921  146
1    151  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96696746, 'precision': 0.841217, 'recall': 0.6756507, 'specificity': 0.6756507, 'f1': 0.7293249, 'auroc': 0.9462578, 'binary_precision': 0.7099237, 'binary_recall': 0.3576923, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.47570333}
confusion matrix:
      0   1
0  5908  38
1   167  93
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 1
val acc:0.9841515421867371, best validation acc: 0.9860191941261292, corresponding to test acc:                         0.9629390835762024 / 0.9726071357727051
after epoch: 18,now: 2024-05-30 16:50:11.460984,epoch time: 0:33:32.455809,used: 10:00:31.760736,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9939575, 'precision': 0.9741236, 'recall': 0.92854583, 'specificity': 0.92854583, 'f1': 0.95010066, 'auroc': 0.9976429, 'binary_precision': 0.9530408, 'binary_recall': 0.8585298, 'binary_specificity': 0.9985618, 'binary_f1_score': 0.90331995}
confusion matrix:
       0     1
0  42353    61
1    204  1238
---- Validation: 
scalar performance:
{'acc': 0.98639274, 'precision': 0.9417058, 'recall': 0.8506048, 'specificity': 0.8506048, 'f1': 0.89050037, 'auroc': 0.98175967, 'binary_precision': 0.8943396, 'binary_recall': 0.70430905, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.78802997}
confusion matrix:
       0    1
0  18011   56
1    199  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.8291147, 'recall': 0.5810946, 'specificity': 0.5810946, 'f1': 0.6237802, 'auroc': 0.9559314, 'binary_precision': 0.6935484, 'binary_recall': 0.16538462, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.26708075}
confusion matrix:
      0   1
0  5927  19
1   217  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 19,now: 2024-05-30 17:23:15.212029,epoch time: 0:33:03.751045,used: 10:33:35.511781,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9931594, 'precision': 0.9727193, 'recall': 0.9167448, 'specificity': 0.9167448, 'f1': 0.9428439, 'auroc': 0.99736124, 'binary_precision': 0.95102686, 'binary_recall': 0.83495146, 'binary_specificity': 0.9985382, 'binary_f1_score': 0.88921714}
confusion matrix:
       0     1
0  42352    62
1    238  1204
---- Validation: 
scalar performance:
{'acc': 0.9860726, 'precision': 0.9269166, 'recall': 0.86116767, 'specificity': 0.86116767, 'f1': 0.8910722, 'auroc': 0.9771158, 'binary_precision': 0.8639576, 'binary_recall': 0.7265973, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.7893462}
confusion matrix:
       0    1
0  17990   77
1    184  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.8498479, 'recall': 0.5889551, 'specificity': 0.5889551, 'f1': 0.6355481, 'auroc': 0.93237984, 'binary_precision': 0.734375, 'binary_recall': 0.18076923, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.29012346}
confusion matrix:
      0   1
0  5929  17
1   213  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 1
val acc:0.9860725998878479, best validation acc: 0.9863927364349365, corresponding to test acc:                         0.9619722962379456 / 0.9726071357727051
after epoch: 20,now: 2024-05-30 17:56:39.971307,epoch time: 0:33:24.759278,used: 11:07:00.271059,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9927262, 'precision': 0.96599185, 'recall': 0.9161284, 'specificity': 0.9161284, 'f1': 0.93954825, 'auroc': 0.99791753, 'binary_precision': 0.9375975, 'binary_recall': 0.834143, 'binary_specificity': 0.9981139, 'binary_f1_score': 0.8828498}
confusion matrix:
       0     1
0  42335    80
1    239  1202
---- Validation: 
scalar performance:
{'acc': 0.9820171, 'precision': 0.9110099, 'recall': 0.80828047, 'specificity': 0.80828047, 'f1': 0.8517103, 'auroc': 0.9797658, 'binary_precision': 0.836, 'binary_recall': 0.62109953, 'binary_specificity': 0.99546134, 'binary_f1_score': 0.7127025}
confusion matrix:
       0    1
0  17985   82
1    255  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.85166913, 'recall': 0.6457224, 'specificity': 0.6457224, 'f1': 0.70220155, 'auroc': 0.9459637, 'binary_precision': 0.73333335, 'binary_recall': 0.29615384, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.42191783}
confusion matrix:
      0   1
0  5918  28
1   183  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 2
val acc:0.9820170998573303, best validation acc: 0.9863927364349365, corresponding to test acc:                         0.9619722962379456 / 0.9726071357727051
after epoch: 21,now: 2024-05-30 18:29:52.108446,epoch time: 0:33:12.137139,used: 11:40:12.408198,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9927946, 'precision': 0.971871, 'recall': 0.9115319, 'specificity': 0.9115319, 'f1': 0.9394927, 'auroc': 0.99744624, 'binary_precision': 0.9496805, 'binary_recall': 0.82454926, 'binary_specificity': 0.99851465, 'binary_f1_score': 0.8827023}
confusion matrix:
       0     1
0  42351    63
1    253  1189
---- Validation: 
scalar performance:
{'acc': 0.9847919, 'precision': 0.9439222, 'recall': 0.82259434, 'specificity': 0.82259434, 'f1': 0.8729135, 'auroc': 0.97405976, 'binary_precision': 0.90082645, 'binary_recall': 0.64784545, 'binary_specificity': 0.99734324, 'binary_f1_score': 0.7536732}
confusion matrix:
       0    1
0  18019   48
1    237  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.8282373, 'recall': 0.5886187, 'specificity': 0.5886187, 'f1': 0.6336104, 'auroc': 0.8964958, 'binary_precision': 0.6911765, 'binary_recall': 0.18076923, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.28658536}
confusion matrix:
      0   1
0  5925  21
1   213  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 3
val acc:0.9847918748855591, best validation acc: 0.9863927364349365, corresponding to test acc:                         0.9619722962379456 / 0.9726071357727051
after epoch: 22,now: 2024-05-30 19:03:11.295888,epoch time: 0:33:19.187442,used: 12:13:31.595640,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99331903, 'precision': 0.93735605, 'recall': 0.96104103, 'specificity': 0.96104103, 'f1': 0.9488616, 'auroc': 0.99826545, 'binary_precision': 0.87721604, 'binary_recall': 0.92649096, 'binary_specificity': 0.9955911, 'binary_f1_score': 0.90118045}
confusion matrix:
       0     1
0  42227   187
1    106  1336
---- Validation: 
scalar performance:
{'acc': 0.984952, 'precision': 0.9009054, 'recall': 0.87560713, 'specificity': 0.87560713, 'f1': 0.88780767, 'auroc': 0.9801071, 'binary_precision': 0.8108108, 'binary_recall': 0.7578009, 'binary_specificity': 0.9934134, 'binary_f1_score': 0.78341013}
confusion matrix:
       0    1
0  17948  119
1    163  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.8067838, 'recall': 0.6032465, 'specificity': 0.6032465, 'f1': 0.649683, 'auroc': 0.9324994, 'binary_precision': 0.64705884, 'binary_recall': 0.21153846, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.3188406}
confusion matrix:
      0   1
0  5916  30
1   205  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 4
val acc:0.9849519729614258, best validation acc: 0.9863927364349365, corresponding to test acc:                         0.9619722962379456 / 0.9726071357727051
after epoch: 23,now: 2024-05-30 19:36:56.746775,epoch time: 0:33:45.450887,used: 12:47:17.046527,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99455035, 'precision': 0.97655636, 'recall': 0.9358863, 'specificity': 0.9358863, 'f1': 0.9552492, 'auroc': 0.99869835, 'binary_precision': 0.95741445, 'binary_recall': 0.87309295, 'binary_specificity': 0.9986797, 'binary_f1_score': 0.9133116}
confusion matrix:
       0     1
0  42358    56
1    183  1259
---- Validation: 
scalar performance:
{'acc': 0.9846318, 'precision': 0.9435319, 'recall': 0.82036555, 'specificity': 0.82036555, 'f1': 0.87125254, 'auroc': 0.9783211, 'binary_precision': 0.9002079, 'binary_recall': 0.6433878, 'binary_specificity': 0.99734324, 'binary_f1_score': 0.7504332}
confusion matrix:
       0    1
0  18019   48
1    240  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.78513384, 'recall': 0.56913567, 'specificity': 0.56913567, 'f1': 0.60505056, 'auroc': 0.8796859, 'binary_precision': 0.60655737, 'binary_recall': 0.1423077, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.2305296}
confusion matrix:
      0   1
0  5922  24
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 5
val acc:0.9846317768096924, best validation acc: 0.9863927364349365, corresponding to test acc:                         0.9619722962379456 / 0.9726071357727051
after epoch: 24,now: 2024-05-30 20:10:54.058832,epoch time: 0:33:57.312057,used: 13:21:14.358584,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9950976, 'precision': 0.9836888, 'recall': 0.937844, 'specificity': 0.937844, 'f1': 0.9595442, 'auroc': 0.9989213, 'binary_precision': 0.97156036, 'binary_recall': 0.87656033, 'binary_specificity': 0.9991276, 'binary_f1_score': 0.9216187}
confusion matrix:
       0     1
0  42377    37
1    178  1264
---- Validation: 
scalar performance:
{'acc': 0.98399144, 'precision': 0.9355849, 'recall': 0.81717235, 'specificity': 0.81717235, 'f1': 0.8663366, 'auroc': 0.979939, 'binary_precision': 0.8845361, 'binary_recall': 0.63744426, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.7409327}
confusion matrix:
       0    1
0  18011   56
1    244  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.8009685, 'recall': 0.59187627, 'specificity': 0.59187627, 'f1': 0.6355041, 'auroc': 0.9354181, 'binary_precision': 0.6363636, 'binary_recall': 0.18846154, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.2908012}
confusion matrix:
      0   1
0  5918  28
1   211  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 6
val acc:0.9839914441108704, best validation acc: 0.9863927364349365, corresponding to test acc:                         0.9619722962379456 / 0.9726071357727051
after epoch: 25,now: 2024-05-30 20:44:39.417100,epoch time: 0:33:45.358268,used: 13:54:59.716852,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.993205, 'precision': 0.9875065, 'recall': 0.9040402, 'specificity': 0.9040402, 'f1': 0.9415947, 'auroc': 0.9990014, 'binary_precision': 0.9814815, 'binary_recall': 0.8085992, 'binary_specificity': 0.9994813, 'binary_f1_score': 0.886692}
confusion matrix:
       0     1
0  42392    22
1    276  1166
---- Validation: 
scalar performance:
{'acc': 0.984952, 'precision': 0.9598512, 'recall': 0.81194836, 'specificity': 0.81194836, 'f1': 0.8706769, 'auroc': 0.9757607, 'binary_precision': 0.93348116, 'binary_recall': 0.6255572, 'binary_specificity': 0.99833953, 'binary_f1_score': 0.7491103}
confusion matrix:
       0    1
0  18037   30
1    252  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.819781, 'recall': 0.5357817, 'specificity': 0.5357817, 'f1': 0.55566216, 'auroc': 0.91270894, 'binary_precision': 0.6785714, 'binary_recall': 0.073076926, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.13194445}
confusion matrix:
      0   1
0  5937   9
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 7
val acc:0.9849519729614258, best validation acc: 0.9863927364349365, corresponding to test acc:                         0.9619722962379456 / 0.9726071357727051
after epoch: 26,now: 2024-05-30 21:18:18.312501,epoch time: 0:33:38.895401,used: 14:28:38.612253,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9949152, 'precision': 0.95629805, 'recall': 0.96454585, 'specificity': 0.96454585, 'f1': 0.96038216, 'auroc': 0.9989748, 'binary_precision': 0.9149081, 'binary_recall': 0.93203884, 'binary_specificity': 0.99705285, 'binary_f1_score': 0.923394}
confusion matrix:
       0     1
0  42289   125
1     98  1344
---- Validation: 
scalar performance:
{'acc': 0.98564565, 'precision': 0.9109957, 'recall': 0.87382114, 'specificity': 0.87382114, 'f1': 0.89145184, 'auroc': 0.9805695, 'binary_precision': 0.83114755, 'binary_recall': 0.7533432, 'binary_specificity': 0.994299, 'binary_f1_score': 0.7903352}
confusion matrix:
       0    1
0  17964  103
1    166  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.8227715, 'recall': 0.60358286, 'specificity': 0.60358286, 'f1': 0.6517219, 'auroc': 0.9129879, 'binary_precision': 0.67901236, 'binary_recall': 0.21153846, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.32258064}
confusion matrix:
      0   1
0  5920  26
1   205  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 8
val acc:0.9856456518173218, best validation acc: 0.9863927364349365, corresponding to test acc:                         0.9619722962379456 / 0.9726071357727051
after epoch: 27,now: 2024-05-30 21:52:08.824440,epoch time: 0:33:50.511939,used: 15:02:29.124192,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99573606, 'precision': 0.95934474, 'recall': 0.9750188, 'specificity': 0.9750188, 'f1': 0.9670402, 'auroc': 0.9992349, 'binary_precision': 0.9202947, 'binary_recall': 0.95284325, 'binary_specificity': 0.99719435, 'binary_f1_score': 0.9362862}
confusion matrix:
       0     1
0  42295   119
1     68  1374
---- Validation: 
scalar performance:
{'acc': 0.9858591, 'precision': 0.9038602, 'recall': 0.8882371, 'specificity': 0.8882371, 'f1': 0.89588094, 'auroc': 0.97839904, 'binary_precision': 0.81578946, 'binary_recall': 0.7830609, 'binary_specificity': 0.9934134, 'binary_f1_score': 0.7990902}
confusion matrix:
       0    1
0  17948  119
1    146  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.822744, 'recall': 0.64872766, 'specificity': 0.64872766, 'f1': 0.7004506, 'auroc': 0.94202256, 'binary_precision': 0.6752137, 'binary_recall': 0.30384615, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.41909814}
confusion matrix:
      0   1
0  5908  38
1   181  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 9
val acc:0.9858590960502625, best validation acc: 0.9863927364349365, corresponding to test acc:                         0.9619722962379456 / 0.9726071357727051
after epoch: 28,now: 2024-05-30 22:26:01.899373,epoch time: 0:33:53.074933,used: 15:36:22.199125,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9967393, 'precision': 0.98395497, 'recall': 0.9641491, 'specificity': 0.9641491, 'f1': 0.9738301, 'auroc': 0.9993336, 'binary_precision': 0.97031134, 'binary_recall': 0.9292649, 'binary_specificity': 0.99903333, 'binary_f1_score': 0.9493447}
confusion matrix:
       0     1
0  42373    41
1    102  1340
---- Validation: 
scalar performance:
{'acc': 0.9874066, 'precision': 0.94545734, 'recall': 0.8632901, 'specificity': 0.8632901, 'f1': 0.89986575, 'auroc': 0.98231816, 'binary_precision': 0.9009174, 'binary_recall': 0.7295691, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.80623966}
confusion matrix:
       0    1
0  18013   54
1    182  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.831372, 'recall': 0.60375106, 'specificity': 0.60375106, 'f1': 0.65275794, 'auroc': 0.9353461, 'binary_precision': 0.6962025, 'binary_recall': 0.21153846, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.32448378}
confusion matrix:
      0   1
0  5922  24
1   205  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 29,now: 2024-05-30 22:59:39.562105,epoch time: 0:33:37.662732,used: 16:09:59.861857,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99664813, 'precision': 0.98222834, 'recall': 0.9644369, 'specificity': 0.9644369, 'f1': 0.9731531, 'auroc': 0.99950933, 'binary_precision': 0.9668349, 'binary_recall': 0.9299584, 'binary_specificity': 0.99891543, 'binary_f1_score': 0.9480381}
confusion matrix:
       0     1
0  42368    46
1    101  1341
---- Validation: 
scalar performance:
{'acc': 0.9859125, 'precision': 0.9342364, 'recall': 0.8503556, 'specificity': 0.8503556, 'f1': 0.8874495, 'auroc': 0.9794669, 'binary_precision': 0.87940633, 'binary_recall': 0.70430905, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.7821782}
confusion matrix:
       0    1
0  18002   65
1    199  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.8662863, 'recall': 0.5815991, 'specificity': 0.5815991, 'f1': 0.6265687, 'auroc': 0.9204782, 'binary_precision': 0.76785713, 'binary_recall': 0.16538462, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.27215192}
confusion matrix:
      0   1
0  5933  13
1   217  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 1
val acc:0.9859125018119812, best validation acc: 0.9874066114425659, corresponding to test acc:                         0.963100254535675 / 0.9726071357727051
after epoch: 30,now: 2024-05-30 23:33:18.585141,epoch time: 0:33:39.023036,used: 16:43:38.884893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_06_49_39_seed_1_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 16:43:38.884893 at 2024-05-30 23:33:18.585141
persisted model performance metric: 

scalar performance:
{'acc': 0.962778, 'precision': 0.81503105, 'recall': 0.61093885, 'specificity': 0.61093885, 'f1': 0.65947974, 'auroc': 0.9423683, 'binary_precision': 0.66292137, 'binary_recall': 0.22692308, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.3381089}
confusion matrix:
      0   1
0  5916  30
1   201  59
oracle model performance metric: 

scalar performance:
{'acc': 0.9722849, 'precision': 0.8464328, 'recall': 0.77957, 'specificity': 0.77957, 'f1': 0.80903906, 'auroc': 0.95831454, 'binary_precision': 0.71153843, 'binary_recall': 0.5692308, 'binary_specificity': 0.9899092, 'binary_f1_score': 0.63247865}
confusion matrix:
      0    1
0  5886   60
1   112  148
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456850 KiB |   2004 MiB |   1860 TiB |   1860 TiB |
|       from large pool | 415174 KiB |   1971 MiB |   1836 TiB |   1836 TiB |
|       from small pool |  41675 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456850 KiB |   2004 MiB |   1860 TiB |   1860 TiB |
|       from large pool | 415174 KiB |   1971 MiB |   1836 TiB |   1836 TiB |
|       from small pool |  41675 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |   1998 MiB |   1856 TiB |   1856 TiB |
|       from large pool | 407075 KiB |   1966 MiB |   1832 TiB |   1832 TiB |
|       from small pool |  40676 KiB |     60 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2260 MiB |   2272 MiB |   3800 MiB |   1540 MiB |
|       from large pool |   2196 MiB |   2202 MiB |   3712 MiB |   1516 MiB |
|       from small pool |     64 MiB |     70 MiB |     88 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 368494 KiB | 414066 KiB |   1447 TiB |   1447 TiB |
|       from large pool | 361017 KiB | 402413 KiB |   1421 TiB |   1421 TiB |
|       from small pool |   7476 KiB |  24350 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    6467    |  360993 K  |  360990 K  |
|       from large pool |     187    |     311    |  175918 K  |  175918 K  |
|       from small pool |    3277    |    6279    |  185075 K  |  185072 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    6467    |  360993 K  |  360990 K  |
|       from large pool |     187    |     311    |  175918 K  |  175918 K  |
|       from small pool |    3277    |    6279    |  185075 K  |  185072 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     127    |     197    |      73    |
|       from large pool |      92    |      92    |     153    |      61    |
|       from small pool |      32    |      35    |      44    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      62    |    2793    |  190225 K  |  190225 K  |
|       from large pool |      34    |      89    |  118163 K  |  118163 K  |
|       from small pool |      28    |    2759    |   72061 K  |   72061 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |   1860 TiB |   1860 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1836 TiB |   1836 TiB |
|       from small pool |      0 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |   1860 TiB |   1860 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1836 TiB |   1836 TiB |
|       from small pool |      0 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |   1856 TiB |   1856 TiB |
|       from large pool |  16640 KiB |   1966 MiB |   1832 TiB |   1832 TiB |
|       from small pool |      0 KiB |     60 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    806 MiB |   2272 MiB |   3800 MiB |   2994 MiB |
|       from large pool |    758 MiB |   2202 MiB |   3712 MiB |   2954 MiB |
|       from small pool |     48 MiB |     70 MiB |     88 MiB |     40 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 414066 KiB |   1447 TiB |   1447 TiB |
|       from large pool |  24320 KiB | 402413 KiB |   1421 TiB |   1421 TiB |
|       from small pool |      0 KiB |  24350 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6467    |  360993 K  |  360993 K  |
|       from large pool |       2    |     311    |  175918 K  |  175918 K  |
|       from small pool |       0    |    6279    |  185075 K  |  185075 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6467    |  360993 K  |  360993 K  |
|       from large pool |       2    |     311    |  175918 K  |  175918 K  |
|       from small pool |       0    |    6279    |  185075 K  |  185075 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     197    |     139    |
|       from large pool |      34    |      92    |     153    |     119    |
|       from small pool |      24    |      35    |      44    |      20    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2793    |  190227 K  |  190227 K  |
|       from large pool |       3    |      89    |  118163 K  |  118163 K  |
|       from small pool |       0    |    2759    |   72063 K  |   72063 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |   1860 TiB |   1860 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1836 TiB |   1836 TiB |
|       from small pool |      0 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |   1860 TiB |   1860 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1836 TiB |   1836 TiB |
|       from small pool |      0 KiB |     61 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |   1856 TiB |   1856 TiB |
|       from large pool |  16640 KiB |   1966 MiB |   1832 TiB |   1832 TiB |
|       from small pool |      0 KiB |     60 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    806 MiB |   2272 MiB |   3800 MiB |   2994 MiB |
|       from large pool |    758 MiB |   2202 MiB |   3712 MiB |   2954 MiB |
|       from small pool |     48 MiB |     70 MiB |     88 MiB |     40 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 414066 KiB |   1447 TiB |   1447 TiB |
|       from large pool |  24320 KiB | 402413 KiB |   1421 TiB |   1421 TiB |
|       from small pool |      0 KiB |  24350 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6467    |  360993 K  |  360993 K  |
|       from large pool |       2    |     311    |  175918 K  |  175918 K  |
|       from small pool |       0    |    6279    |  185075 K  |  185075 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6467    |  360993 K  |  360993 K  |
|       from large pool |       2    |     311    |  175918 K  |  175918 K  |
|       from small pool |       0    |    6279    |  185075 K  |  185075 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     197    |     139    |
|       from large pool |      34    |      92    |     153    |     119    |
|       from small pool |      24    |      35    |      44    |      20    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2793    |  190227 K  |  190227 K  |
|       from large pool |       3    |      89    |  118163 K  |  118163 K  |
|       from small pool |       0    |    2759    |   72063 K  |   72063 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755

 Experiment start at: 2024-05-30 23:46:02.222871
before training, model accuracy: 0.7679115533828735
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9709748, 'precision': 0.8272884, 'recall': 0.64847195, 'specificity': 0.64847195, 'f1': 0.70161575, 'auroc': 0.9608766, 'binary_precision': 0.679049, 'binary_recall': 0.30204892, 'binary_specificity': 0.9948949, 'binary_f1_score': 0.4181153}
confusion matrix:
       0    1
0  42095  216
1   1056  457
---- Validation: 
scalar performance:
{'acc': 0.97096896, 'precision': 0.80200124, 'recall': 0.6131922, 'specificity': 0.6131922, 'f1': 0.6614739, 'auroc': 0.95555806, 'binary_precision': 0.6289593, 'binary_recall': 0.23089701, 'binary_specificity': 0.99548733, 'binary_f1_score': 0.33778858}
confusion matrix:
       0    1
0  18089   82
1    463  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9679436, 'precision': 0.8987589, 'recall': 0.608587, 'specificity': 0.608587, 'f1': 0.664987, 'auroc': 0.9484818, 'binary_precision': 0.828125, 'binary_recall': 0.21900827, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.34640524}
confusion matrix:
      0   1
0  5986  11
1   189  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-31 00:21:10.177161,epoch time: 0:35:07.954290,used: 0:35:07.954290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97469425, 'precision': 0.8066073, 'recall': 0.82629406, 'specificity': 0.82629406, 'f1': 0.816113, 'auroc': 0.96981597, 'binary_precision': 0.6251549, 'binary_recall': 0.666887, 'binary_specificity': 0.98570114, 'binary_f1_score': 0.645347}
confusion matrix:
       0     1
0  41706   605
1    504  1009
---- Validation: 
scalar performance:
{'acc': 0.9767219, 'precision': 0.81891274, 'recall': 0.7896224, 'specificity': 0.7896224, 'f1': 0.8035002, 'auroc': 0.96671057, 'binary_precision': 0.6513761, 'binary_recall': 0.589701, 'binary_specificity': 0.9895438, 'binary_f1_score': 0.6190061}
confusion matrix:
       0    1
0  17981  190
1    247  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9764385, 'precision': 0.84873813, 'recall': 0.82515913, 'specificity': 0.82515913, 'f1': 0.836493, 'auroc': 0.9538514, 'binary_precision': 0.7111111, 'binary_recall': 0.661157, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.68522483}
confusion matrix:
      0    1
0  5932   65
1    82  160
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-31 00:55:01.298698,epoch time: 0:33:51.121537,used: 1:08:59.075827,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9760177, 'precision': 0.9468706, 'recall': 0.6673348, 'specificity': 0.6673348, 'f1': 0.7396264, 'auroc': 0.9779644, 'binary_precision': 0.9169675, 'binary_recall': 0.33575678, 'binary_specificity': 0.9989128, 'binary_f1_score': 0.4915336}
confusion matrix:
       0    1
0  42265   46
1   1005  508
---- Validation: 
scalar performance:
{'acc': 0.9776807, 'precision': 0.9293117, 'recall': 0.67528176, 'specificity': 0.67528176, 'f1': 0.74577487, 'auroc': 0.9711467, 'binary_precision': 0.87966806, 'binary_recall': 0.35215947, 'binary_specificity': 0.998404, 'binary_f1_score': 0.5029656}
confusion matrix:
       0    1
0  18142   29
1    390  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.7537806, 'recall': 0.5119798, 'specificity': 0.5119798, 'f1': 0.51385856, 'auroc': 0.9475259, 'binary_precision': 0.54545456, 'binary_recall': 0.024793388, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.047430832}
confusion matrix:
      0  1
0  5992  5
1   236  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 3,now: 2024-05-31 01:29:01.007214,epoch time: 0:33:59.708516,used: 1:42:58.784343,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98281765, 'precision': 0.8867434, 'recall': 0.8429284, 'specificity': 0.8429284, 'f1': 0.8634085, 'auroc': 0.98326916, 'binary_precision': 0.78443116, 'binary_recall': 0.6926636, 'binary_specificity': 0.99319327, 'binary_f1_score': 0.7356968}
confusion matrix:
       0     1
0  42023   288
1    465  1048
---- Validation: 
scalar performance:
{'acc': 0.9798647, 'precision': 0.851392, 'recall': 0.80489767, 'specificity': 0.80489767, 'f1': 0.8263619, 'auroc': 0.9688213, 'binary_precision': 0.7153846, 'binary_recall': 0.6179402, 'binary_specificity': 0.99185514, 'binary_f1_score': 0.66310155}
confusion matrix:
       0    1
0  18023  148
1    230  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.8579005, 'recall': 0.5611497, 'specificity': 0.5611497, 'f1': 0.59728163, 'auroc': 0.9390148, 'binary_precision': 0.75, 'binary_recall': 0.12396694, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.21276596}
confusion matrix:
      0   1
0  5987  10
1   212  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 4,now: 2024-05-31 02:03:06.062503,epoch time: 0:34:05.055289,used: 2:17:03.839632,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98357064, 'precision': 0.88211507, 'recall': 0.8664944, 'specificity': 0.8664944, 'f1': 0.87412745, 'auroc': 0.98580337, 'binary_precision': 0.77348065, 'binary_recall': 0.7407407, 'binary_specificity': 0.99224806, 'binary_f1_score': 0.7567567}
confusion matrix:
       0     1
0  41984   328
1    392  1120
---- Validation: 
scalar performance:
{'acc': 0.9826879, 'precision': 0.8773564, 'recall': 0.82803833, 'specificity': 0.82803833, 'f1': 0.8508369, 'auroc': 0.9719702, 'binary_precision': 0.7658349, 'binary_recall': 0.6627907, 'binary_specificity': 0.993286, 'binary_f1_score': 0.7105966}
confusion matrix:
       0    1
0  18049  122
1    203  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.81992114, 'recall': 0.562799, 'specificity': 0.562799, 'f1': 0.598369, 'auroc': 0.9529985, 'binary_precision': 0.67391306, 'binary_recall': 0.12809917, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.21527779}
confusion matrix:
      0   1
0  5982  15
1   211  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 5,now: 2024-05-31 02:36:52.129325,epoch time: 0:33:46.066822,used: 2:50:49.906454,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9862632, 'precision': 0.92209554, 'recall': 0.86096406, 'specificity': 0.86096406, 'f1': 0.8889525, 'auroc': 0.9870343, 'binary_precision': 0.85392386, 'binary_recall': 0.72637147, 'binary_specificity': 0.9955567, 'binary_f1_score': 0.78499997}
confusion matrix:
       0     1
0  42123   188
1    414  1099
---- Validation: 
scalar performance:
{'acc': 0.9840196, 'precision': 0.8883846, 'recall': 0.84077203, 'specificity': 0.84077203, 'f1': 0.8629024, 'auroc': 0.9773675, 'binary_precision': 0.78707224, 'binary_recall': 0.68770766, 'binary_specificity': 0.99383634, 'binary_f1_score': 0.7340426}
confusion matrix:
       0    1
0  18059  112
1    188  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.8575802, 'recall': 0.6018884, 'specificity': 0.6018884, 'f1': 0.6532249, 'auroc': 0.956852, 'binary_precision': 0.74626863, 'binary_recall': 0.20661157, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.3236246}
confusion matrix:
      0   1
0  5980  17
1   192  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 6,now: 2024-05-31 03:10:48.742455,epoch time: 0:33:56.613130,used: 3:24:46.519584,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97770625, 'precision': 0.9310515, 'recall': 0.703261, 'specificity': 0.703261, 'f1': 0.77354115, 'auroc': 0.9853295, 'binary_precision': 0.88285714, 'binary_recall': 0.40846002, 'binary_specificity': 0.99806195, 'binary_f1_score': 0.5585179}
confusion matrix:
       0    1
0  42229   82
1    895  618
---- Validation: 
scalar performance:
{'acc': 0.97730786, 'precision': 0.9075937, 'recall': 0.6807105, 'specificity': 0.6807105, 'f1': 0.7476655, 'auroc': 0.97757804, 'binary_precision': 0.83587784, 'binary_recall': 0.36378738, 'binary_specificity': 0.9976336, 'binary_f1_score': 0.5069444}
confusion matrix:
       0    1
0  18128   43
1    383  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.7632059, 'recall': 0.53602284, 'specificity': 0.53602284, 'f1': 0.55594254, 'auroc': 0.9429076, 'binary_precision': 0.5625, 'binary_recall': 0.07438017, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.13138686}
confusion matrix:
      0   1
0  5983  14
1   224  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 1
val acc:0.9773078560829163, best validation acc: 0.9840195775032043, corresponding to test acc:                         0.9665010571479797 / 0.9764385223388672
after epoch: 7,now: 2024-05-31 03:44:48.611644,epoch time: 0:33:59.869189,used: 3:58:46.388773,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9866511, 'precision': 0.88700557, 'recall': 0.9236208, 'specificity': 0.9236208, 'f1': 0.9044114, 'auroc': 0.99059325, 'binary_precision': 0.7791817, 'binary_recall': 0.8559154, 'binary_specificity': 0.99132615, 'binary_f1_score': 0.81574804}
confusion matrix:
       0     1
0  41944   367
1    218  1295
---- Validation: 
scalar performance:
{'acc': 0.9841794, 'precision': 0.8660901, 'recall': 0.88662827, 'specificity': 0.88662827, 'f1': 0.8760551, 'auroc': 0.9789834, 'binary_precision': 0.7394034, 'binary_recall': 0.782392, 'binary_specificity': 0.9908646, 'binary_f1_score': 0.76029056}
confusion matrix:
       0    1
0  18005  166
1    131  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.8399429, 'recall': 0.6239487, 'specificity': 0.6239487, 'f1': 0.6774982, 'auroc': 0.9409281, 'binary_precision': 0.7093023, 'binary_recall': 0.2520661, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.3719512}
confusion matrix:
      0   1
0  5972  25
1   181  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 8,now: 2024-05-31 04:18:55.842486,epoch time: 0:34:07.230842,used: 4:32:53.619615,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9879518, 'precision': 0.92417896, 'recall': 0.888924, 'specificity': 0.888924, 'f1': 0.9057248, 'auroc': 0.99134094, 'binary_precision': 0.8561099, 'binary_recall': 0.7825512, 'binary_specificity': 0.9952967, 'binary_f1_score': 0.8176796}
confusion matrix:
       0     1
0  42112   199
1    329  1184
---- Validation: 
scalar performance:
{'acc': 0.98455226, 'precision': 0.894905, 'recall': 0.8426533, 'specificity': 0.8426533, 'f1': 0.8667855, 'auroc': 0.9814928, 'binary_precision': 0.8, 'binary_recall': 0.6910299, 'binary_specificity': 0.9942766, 'binary_f1_score': 0.741533}
confusion matrix:
       0    1
0  18067  104
1    186  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.81542826, 'recall': 0.5991553, 'specificity': 0.5991553, 'f1': 0.646101, 'auroc': 0.94235444, 'binary_precision': 0.6621622, 'binary_recall': 0.20247933, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.31012654}
confusion matrix:
      0   1
0  5972  25
1   193  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 9,now: 2024-05-31 04:52:51.330894,epoch time: 0:33:55.488408,used: 5:06:49.108023,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98674244, 'precision': 0.8787619, 'recall': 0.9437431, 'specificity': 0.9437431, 'f1': 0.90844566, 'auroc': 0.9920969, 'binary_precision': 0.76121074, 'binary_recall': 0.8975545, 'binary_specificity': 0.9899317, 'binary_f1_score': 0.82377917}
confusion matrix:
       0     1
0  41885   426
1    155  1358
---- Validation: 
scalar performance:
{'acc': 0.98487186, 'precision': 0.8719211, 'recall': 0.8910012, 'specificity': 0.8910012, 'f1': 0.88120246, 'auroc': 0.9831284, 'binary_precision': 0.7507886, 'binary_recall': 0.7906977, 'binary_specificity': 0.9913048, 'binary_f1_score': 0.77022654}
confusion matrix:
       0    1
0  18013  158
1    126  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.79438317, 'recall': 0.6671521, 'specificity': 0.6671521, 'f1': 0.71144086, 'auroc': 0.95301, 'binary_precision': 0.6148148, 'binary_recall': 0.3429752, 'binary_specificity': 0.991329, 'binary_f1_score': 0.4403183}
confusion matrix:
      0   1
0  5945  52
1   159  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 10,now: 2024-05-31 05:26:42.455389,epoch time: 0:33:51.124495,used: 5:40:40.232518,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9885679, 'precision': 0.91168517, 'recall': 0.91824037, 'specificity': 0.91824037, 'f1': 0.9149347, 'auroc': 0.9926486, 'binary_precision': 0.8289987, 'binary_recall': 0.8426966, 'binary_specificity': 0.9937841, 'binary_f1_score': 0.8357916}
confusion matrix:
       0     1
0  42048   263
1    238  1275
---- Validation: 
scalar performance:
{'acc': 0.98471206, 'precision': 0.889276, 'recall': 0.8547815, 'specificity': 0.8547815, 'f1': 0.87116617, 'auroc': 0.9747324, 'binary_precision': 0.7879342, 'binary_recall': 0.71594685, 'binary_specificity': 0.9936162, 'binary_f1_score': 0.7502176}
confusion matrix:
       0    1
0  18055  116
1    171  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96906555, 'precision': 0.8417149, 'recall': 0.6686529, 'specificity': 0.6686529, 'f1': 0.7232351, 'auroc': 0.9490406, 'binary_precision': 0.7094017, 'binary_recall': 0.3429752, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.46239552}
confusion matrix:
      0   1
0  5963  34
1   159  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 1
val acc:0.9847120642662048, best validation acc: 0.9848718643188477, corresponding to test acc:                         0.9661805033683777 / 0.9764385223388672
after epoch: 11,now: 2024-05-31 06:00:30.321253,epoch time: 0:33:47.865864,used: 6:14:28.098382,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.988682, 'precision': 0.95937574, 'recall': 0.86317265, 'specificity': 0.86317265, 'f1': 0.90522873, 'auroc': 0.9941435, 'binary_precision': 0.9283909, 'binary_recall': 0.7283543, 'binary_specificity': 0.9979911, 'binary_f1_score': 0.8162963}
confusion matrix:
       0     1
0  42226    85
1    411  1102
---- Validation: 
scalar performance:
{'acc': 0.9851915, 'precision': 0.92413306, 'recall': 0.819695, 'specificity': 0.819695, 'f1': 0.8640619, 'auroc': 0.9766327, 'binary_precision': 0.86, 'binary_recall': 0.64285713, 'binary_specificity': 0.9965329, 'binary_f1_score': 0.73574144}
confusion matrix:
       0    1
0  18108   63
1    215  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.79870886, 'recall': 0.5383391, 'specificity': 0.5383391, 'f1': 0.56026745, 'auroc': 0.94638866, 'binary_precision': 0.6333333, 'binary_recall': 0.0785124, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.13970588}
confusion matrix:
      0   1
0  5986  11
1   223  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 12,now: 2024-05-31 06:34:23.621479,epoch time: 0:33:53.300226,used: 6:48:21.398608,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99034774, 'precision': 0.9414843, 'recall': 0.9096025, 'specificity': 0.9096025, 'f1': 0.92489845, 'auroc': 0.9949653, 'binary_precision': 0.88928574, 'binary_recall': 0.82286847, 'binary_specificity': 0.99633664, 'binary_f1_score': 0.85478896}
confusion matrix:
       0     1
0  42156   155
1    268  1245
---- Validation: 
scalar performance:
{'acc': 0.98471206, 'precision': 0.8939327, 'recall': 0.8475541, 'specificity': 0.8475541, 'f1': 0.86918044, 'auroc': 0.9772227, 'binary_precision': 0.7977316, 'binary_recall': 0.7009967, 'binary_specificity': 0.9941115, 'binary_f1_score': 0.7462423}
confusion matrix:
       0    1
0  18064  107
1    180  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.8564553, 'recall': 0.61205226, 'specificity': 0.61205226, 'f1': 0.66558164, 'auroc': 0.94876707, 'binary_precision': 0.7432432, 'binary_recall': 0.22727273, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.3481013}
confusion matrix:
      0   1
0  5978  19
1   187  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 1
val acc:0.9847120642662048, best validation acc: 0.9851915240287781, corresponding to test acc:                         0.9624940156936646 / 0.9764385223388672
after epoch: 13,now: 2024-05-31 07:07:52.388432,epoch time: 0:33:28.766953,used: 7:21:50.165561,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9903706, 'precision': 0.91202796, 'recall': 0.9523138, 'specificity': 0.9523138, 'f1': 0.93114984, 'auroc': 0.9942944, 'binary_precision': 0.82723457, 'binary_recall': 0.91143423, 'binary_specificity': 0.99319327, 'binary_f1_score': 0.8672956}
confusion matrix:
       0     1
0  42023   288
1    134  1379
---- Validation: 
scalar performance:
{'acc': 0.98439246, 'precision': 0.8620331, 'recall': 0.90199625, 'specificity': 0.90199625, 'f1': 0.8808787, 'auroc': 0.9855069, 'binary_precision': 0.73025334, 'binary_recall': 0.81395346, 'binary_specificity': 0.99003905, 'binary_f1_score': 0.769835}
confusion matrix:
       0    1
0  17990  181
1    112  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96826416, 'precision': 0.81053996, 'recall': 0.69797707, 'specificity': 0.69797707, 'f1': 0.74053836, 'auroc': 0.94890076, 'binary_precision': 0.6447368, 'binary_recall': 0.40495867, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.49746192}
confusion matrix:
      0   1
0  5943  54
1   144  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 2
val acc:0.9843924641609192, best validation acc: 0.9851915240287781, corresponding to test acc:                         0.9624940156936646 / 0.9764385223388672
after epoch: 14,now: 2024-05-31 07:41:16.213587,epoch time: 0:33:23.825155,used: 7:55:13.990716,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99112356, 'precision': 0.92615616, 'recall': 0.9437815, 'specificity': 0.9437815, 'f1': 0.9347751, 'auroc': 0.9959829, 'binary_precision': 0.85614705, 'binary_recall': 0.89292794, 'binary_specificity': 0.994635, 'binary_f1_score': 0.87415075}
confusion matrix:
       0     1
0  42084   227
1    162  1351
---- Validation: 
scalar performance:
{'acc': 0.98412615, 'precision': 0.86909413, 'recall': 0.8785703, 'specificity': 0.8785703, 'f1': 0.87376714, 'auroc': 0.97887635, 'binary_precision': 0.7459547, 'binary_recall': 0.76578075, 'binary_specificity': 0.99135983, 'binary_f1_score': 0.7557377}
confusion matrix:
       0    1
0  18014  157
1    141  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.8101226, 'recall': 0.5909742, 'specificity': 0.5909742, 'f1': 0.6356126, 'auroc': 0.95478976, 'binary_precision': 0.65217394, 'binary_recall': 0.18595041, 'binary_specificity': 0.995998, 'binary_f1_score': 0.28938907}
confusion matrix:
      0   1
0  5973  24
1   197  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 3
val acc:0.9841261506080627, best validation acc: 0.9851915240287781, corresponding to test acc:                         0.9624940156936646 / 0.9764385223388672
after epoch: 15,now: 2024-05-31 08:14:41.965434,epoch time: 0:33:25.751847,used: 8:28:39.742563,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99105513, 'precision': 0.97261596, 'recall': 0.8888649, 'specificity': 0.8888649, 'f1': 0.9263668, 'auroc': 0.9971292, 'binary_precision': 0.95307446, 'binary_recall': 0.77910054, 'binary_specificity': 0.9986292, 'binary_f1_score': 0.8573508}
confusion matrix:
       0     1
0  42254    58
1    334  1178
---- Validation: 
scalar performance:
{'acc': 0.9865232, 'precision': 0.9448489, 'recall': 0.82439816, 'specificity': 0.82439816, 'f1': 0.8745487, 'auroc': 0.9804485, 'binary_precision': 0.90114945, 'binary_recall': 0.6511628, 'binary_specificity': 0.9976336, 'binary_f1_score': 0.75602704}
confusion matrix:
       0    1
0  18128   43
1    210  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.8466872, 'recall': 0.5651152, 'specificity': 0.5651152, 'f1': 0.6027838, 'auroc': 0.9352009, 'binary_precision': 0.72727275, 'binary_recall': 0.1322314, 'binary_specificity': 0.997999, 'binary_f1_score': 0.22377622}
confusion matrix:
      0   1
0  5985  12
1   210  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 16,now: 2024-05-31 08:48:32.547043,epoch time: 0:33:50.581609,used: 9:02:30.324172,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98995984, 'precision': 0.91371024, 'recall': 0.94158554, 'specificity': 0.94158554, 'f1': 0.9271543, 'auroc': 0.99570656, 'binary_precision': 0.8313774, 'binary_recall': 0.8896233, 'binary_specificity': 0.9935478, 'binary_f1_score': 0.8595147}
confusion matrix:
       0     1
0  42038   273
1    167  1346
---- Validation: 
scalar performance:
{'acc': 0.9827412, 'precision': 0.8531158, 'recall': 0.88026404, 'specificity': 0.88026404, 'f1': 0.86614347, 'auroc': 0.97257614, 'binary_precision': 0.71384615, 'binary_recall': 0.7707641, 'binary_specificity': 0.9897639, 'binary_f1_score': 0.74121404}
confusion matrix:
       0    1
0  17985  186
1    138  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.84427506, 'recall': 0.54272145, 'specificity': 0.54272145, 'f1': 0.5681109, 'auroc': 0.93779534, 'binary_precision': 0.7241379, 'binary_recall': 0.08677686, 'binary_specificity': 0.998666, 'binary_f1_score': 0.15498155}
confusion matrix:
      0   1
0  5989   8
1   221  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 1
val acc:0.9827411770820618, best validation acc: 0.9865232110023499, corresponding to test acc:                         0.9644173979759216 / 0.9764385223388672
after epoch: 17,now: 2024-05-31 09:22:03.341769,epoch time: 0:33:30.794726,used: 9:36:01.118898,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99326855, 'precision': 0.96569556, 'recall': 0.9308716, 'specificity': 0.9308716, 'f1': 0.94755465, 'auroc': 0.9971466, 'binary_precision': 0.9362464, 'binary_recall': 0.86384666, 'binary_specificity': 0.99789655, 'binary_f1_score': 0.89859056}
confusion matrix:
       0     1
0  42222    89
1    206  1307
---- Validation: 
scalar performance:
{'acc': 0.98545784, 'precision': 0.9024439, 'recall': 0.85115147, 'specificity': 0.85115147, 'f1': 0.8749188, 'auroc': 0.9786365, 'binary_precision': 0.81453156, 'binary_recall': 0.7076412, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.7573334}
confusion matrix:
       0    1
0  18074   97
1    176  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9681039, 'precision': 0.8748424, 'recall': 0.6225496, 'specificity': 0.6225496, 'f1': 0.6799045, 'auroc': 0.95638084, 'binary_precision': 0.77922076, 'binary_recall': 0.24793388, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.37617552}
confusion matrix:
      0   1
0  5980  17
1   182  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 2
val acc:0.9854578375816345, best validation acc: 0.9865232110023499, corresponding to test acc:                         0.9644173979759216 / 0.9764385223388672
after epoch: 18,now: 2024-05-31 09:55:41.984854,epoch time: 0:33:38.643085,used: 10:09:39.761983,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9901424, 'precision': 0.93557084, 'recall': 0.91332006, 'specificity': 0.91332006, 'f1': 0.9241301, 'auroc': 0.99615526, 'binary_precision': 0.87718076, 'binary_recall': 0.83079976, 'binary_specificity': 0.9958403, 'binary_f1_score': 0.8533605}
confusion matrix:
       0     1
0  42135   176
1    256  1257
---- Validation: 
scalar performance:
{'acc': 0.98449904, 'precision': 0.8869021, 'recall': 0.8538684, 'specificity': 0.8538684, 'f1': 0.8695904, 'auroc': 0.98044044, 'binary_precision': 0.7832423, 'binary_recall': 0.71428573, 'binary_specificity': 0.9934511, 'binary_f1_score': 0.74717635}
confusion matrix:
       0    1
0  18052  119
1    172  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.78115064, 'recall': 0.7067236, 'specificity': 0.7067236, 'f1': 0.7376221, 'auroc': 0.93725896, 'binary_precision': 0.58522725, 'binary_recall': 0.42561984, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.49282295}
confusion matrix:
      0    1
0  5924   73
1   139  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 3
val acc:0.9844990372657776, best validation acc: 0.9865232110023499, corresponding to test acc:                         0.9644173979759216 / 0.9764385223388672
after epoch: 19,now: 2024-05-31 10:29:12.549683,epoch time: 0:33:30.564829,used: 10:43:10.326812,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9931088, 'precision': 0.9524507, 'recall': 0.9432163, 'specificity': 0.9432163, 'f1': 0.94778204, 'auroc': 0.9971302, 'binary_precision': 0.90884537, 'binary_recall': 0.8896233, 'binary_specificity': 0.99680936, 'binary_f1_score': 0.8991316}
confusion matrix:
       0     1
0  42176   135
1    167  1346
---- Validation: 
scalar performance:
{'acc': 0.98513824, 'precision': 0.89152116, 'recall': 0.860623, 'specificity': 0.860623, 'f1': 0.87538743, 'auroc': 0.982347, 'binary_precision': 0.7920434, 'binary_recall': 0.72757477, 'binary_specificity': 0.99367124, 'binary_f1_score': 0.7584415}
confusion matrix:
       0    1
0  18056  115
1    164  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.74921143, 'recall': 0.56576395, 'specificity': 0.56576395, 'f1': 0.5987777, 'auroc': 0.9317796, 'binary_precision': 0.5322581, 'binary_recall': 0.13636364, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.21710527}
confusion matrix:
      0   1
0  5968  29
1   209  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 4
val acc:0.9851382374763489, best validation acc: 0.9865232110023499, corresponding to test acc:                         0.9644173979759216 / 0.9764385223388672
after epoch: 20,now: 2024-05-31 11:02:43.591571,epoch time: 0:33:31.041888,used: 11:16:41.368700,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99338263, 'precision': 0.9449162, 'recall': 0.9573788, 'specificity': 0.9573788, 'f1': 0.95105433, 'auroc': 0.9978438, 'binary_precision': 0.89274246, 'binary_recall': 0.91870457, 'binary_specificity': 0.99605304, 'binary_f1_score': 0.9055375}
confusion matrix:
       0     1
0  42144   167
1    123  1390
---- Validation: 
scalar performance:
{'acc': 0.9856709, 'precision': 0.8856785, 'recall': 0.88258046, 'specificity': 0.88258046, 'f1': 0.8841227, 'auroc': 0.97658885, 'binary_precision': 0.7788945, 'binary_recall': 0.77242523, 'binary_specificity': 0.9927357, 'binary_f1_score': 0.7756464}
confusion matrix:
       0    1
0  18039  132
1    137  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.8225206, 'recall': 0.58510935, 'specificity': 0.58510935, 'f1': 0.62912226, 'auroc': 0.91334665, 'binary_precision': 0.67741936, 'binary_recall': 0.17355372, 'binary_specificity': 0.996665, 'binary_f1_score': 0.27631578}
confusion matrix:
      0   1
0  5977  20
1   200  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 5
val acc:0.9856709241867065, best validation acc: 0.9865232110023499, corresponding to test acc:                         0.9644173979759216 / 0.9764385223388672
after epoch: 21,now: 2024-05-31 11:36:23.994694,epoch time: 0:33:40.403123,used: 11:50:21.771823,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9930403, 'precision': 0.96474457, 'recall': 0.9282042, 'specificity': 0.9282042, 'f1': 0.9456686, 'auroc': 0.9978664, 'binary_precision': 0.93453234, 'binary_recall': 0.85855913, 'binary_specificity': 0.9978493, 'binary_f1_score': 0.89493626}
confusion matrix:
       0     1
0  42220    91
1    214  1299
---- Validation: 
scalar performance:
{'acc': 0.9860438, 'precision': 0.9111966, 'recall': 0.8514542, 'specificity': 0.8514542, 'f1': 0.87881005, 'auroc': 0.9759969, 'binary_precision': 0.83203125, 'binary_recall': 0.7076412, 'binary_specificity': 0.9952672, 'binary_f1_score': 0.7648115}
confusion matrix:
       0    1
0  18085   86
1    176  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96906555, 'precision': 0.84714234, 'recall': 0.6627046, 'specificity': 0.6627046, 'f1': 0.7186701, 'auroc': 0.9063518, 'binary_precision': 0.7207207, 'binary_recall': 0.3305785, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.45325777}
confusion matrix:
      0   1
0  5966  31
1   162  80
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 6
val acc:0.9860438108444214, best validation acc: 0.9865232110023499, corresponding to test acc:                         0.9644173979759216 / 0.9764385223388672
after epoch: 22,now: 2024-05-31 12:09:40.087812,epoch time: 0:33:16.093118,used: 12:23:37.864941,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9956188, 'precision': 0.9719585, 'recall': 0.96172345, 'specificity': 0.96172345, 'f1': 0.9667805, 'auroc': 0.99877286, 'binary_precision': 0.94658554, 'binary_recall': 0.92531395, 'binary_specificity': 0.9981329, 'binary_f1_score': 0.9358289}
confusion matrix:
       0     1
0  42232    79
1    113  1400
---- Validation: 
scalar performance:
{'acc': 0.9872157, 'precision': 0.91345173, 'recall': 0.87213576, 'specificity': 0.87213576, 'f1': 0.8916248, 'auroc': 0.9750621, 'binary_precision': 0.83518517, 'binary_recall': 0.7491694, 'binary_specificity': 0.9951021, 'binary_f1_score': 0.7898423}
confusion matrix:
       0    1
0  18082   89
1    151  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.8035534, 'recall': 0.5928736, 'specificity': 0.5928736, 'f1': 0.63737154, 'auroc': 0.92607975, 'binary_precision': 0.6388889, 'binary_recall': 0.19008264, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.29299363}
confusion matrix:
      0   1
0  5971  26
1   196  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
better model found
persisted
after epoch: 23,now: 2024-05-31 12:39:23.658351,epoch time: 0:29:43.570539,used: 12:53:21.435480,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99317724, 'precision': 0.99025613, 'recall': 0.90628815, 'specificity': 0.90628815, 'f1': 0.9440526, 'auroc': 0.9990145, 'binary_precision': 0.9871589, 'binary_recall': 0.81295437, 'binary_specificity': 0.99962187, 'binary_f1_score': 0.89162743}
confusion matrix:
       0     1
0  42295    16
1    283  1230
---- Validation: 
scalar performance:
{'acc': 0.98641664, 'precision': 0.94103885, 'recall': 0.82594925, 'specificity': 0.82594925, 'f1': 0.87426364, 'auroc': 0.9749715, 'binary_precision': 0.89342403, 'binary_recall': 0.65448505, 'binary_specificity': 0.99741346, 'binary_f1_score': 0.75551295}
confusion matrix:
       0    1
0  18124   47
1    208  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663408, 'precision': 0.90035266, 'recall': 0.5819776, 'specificity': 0.5819776, 'f1': 0.629316, 'auroc': 0.9112022, 'binary_precision': 0.8333333, 'binary_recall': 0.16528925, 'binary_specificity': 0.998666, 'binary_f1_score': 0.27586207}
confusion matrix:
      0   1
0  5989   8
1   202  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993755.png
early stop counter: 1
val acc:0.9864166378974915, best validation acc: 0.9872156977653503, corresponding to test acc:                         0.9644173979759216 / 0.9764385223388672
after epoch: 24,now: 2024-05-31 13:08:02.725646,epoch time: 0:28:39.067295,used: 13:22:00.502775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_23_46_02_seed_2_20993755
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
slurmstepd: error: *** JOB 20993755 ON gpusrv39 CANCELLED AT 2024-05-31T13:26:11 DUE TO TIME LIMIT ***
