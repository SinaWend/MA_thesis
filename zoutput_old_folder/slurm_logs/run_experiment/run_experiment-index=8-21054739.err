Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jun  3 07:37:30 2024]
rule parameter_sampling:
    input: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/conf/CAMELYON_benchmark.yaml
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256_oversampling/hyperparameters.csv
    jobid: 1
    reason: Missing output files: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256_oversampling/hyperparameters.csv
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal




!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
[Mon Jun  3 07:38:02 2024]
Finished job 1.
1 of 2 steps (50%) done
Select jobs to execute...

[Mon Jun  3 07:38:02 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256_oversampling/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256_oversampling/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739

 Experiment start at: 2024-06-03 07:43:02.308768
before training, model accuracy: 0.4410029351711273
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.995956, 'precision': 0.9850923, 'recall': 0.9914781, 'specificity': 0.9914781, 'f1': 0.9882587, 'auroc': 0.99940264, 'binary_precision': 0.9716518, 'binary_recall': 0.98595697, 'binary_specificity': 0.99699914, 'binary_f1_score': 0.97875214}
confusion matrix:
       0     1
0  42194   127
1     62  4353
---- Validation: 
scalar performance:
{'acc': 0.96152616, 'precision': 0.6999634, 'recall': 0.6628082, 'specificity': 0.6628082, 'f1': 0.67924035, 'auroc': 0.87114507, 'binary_precision': 0.42307693, 'binary_recall': 0.3421462, 'binary_specificity': 0.98347014, 'binary_f1_score': 0.37833187}
confusion matrix:
       0    1
0  17849  300
1    423  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9941003, 'precision': 0.98452115, 'recall': 0.9866715, 'specificity': 0.9866715, 'f1': 0.9855931, 'auroc': 0.9973108, 'binary_precision': 0.9720457, 'binary_recall': 0.9770115, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.97452223}
confusion matrix:
      0    1
0  5975   22
1    18  765
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-03 08:01:46.586691,epoch time: 0:18:44.277923,used: 0:18:44.277923,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.997411, 'precision': 0.9932734, 'recall': 0.9915714, 'specificity': 0.9915714, 'f1': 0.9924205, 'auroc': 0.9992408, 'binary_precision': 0.98817647, 'binary_recall': 0.9843715, 'binary_specificity': 0.9987713, 'binary_f1_score': 0.98627025}
confusion matrix:
       0     1
0  42269    52
1     69  4346
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.77866054, 'recall': 0.5826376, 'specificity': 0.5826376, 'f1': 0.6231719, 'auroc': 0.8891399, 'binary_precision': 0.5860215, 'binary_recall': 0.16951789, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.26296744}
confusion matrix:
       0    1
0  18072   77
1    534  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99587023, 'precision': 0.9937018, 'recall': 0.9860064, 'specificity': 0.9860064, 'f1': 0.98981345, 'auroc': 0.9994606, 'binary_precision': 0.9908973, 'binary_recall': 0.97318006, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.98195875}
confusion matrix:
      0    1
0  5990    7
1    21  762
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-03 08:19:38.198795,epoch time: 0:17:51.612104,used: 0:36:35.890027,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9978603, 'precision': 0.99454224, 'recall': 0.99293673, 'specificity': 0.99293673, 'f1': 0.99373794, 'auroc': 0.9992976, 'binary_precision': 0.99045455, 'binary_recall': 0.98686594, 'binary_specificity': 0.9990076, 'binary_f1_score': 0.988657}
confusion matrix:
       0     1
0  42278    42
1     58  4358
---- Validation: 
scalar performance:
{'acc': 0.96376115, 'precision': 0.694718, 'recall': 0.5724585, 'specificity': 0.5724585, 'f1': 0.6024684, 'auroc': 0.8670385, 'binary_precision': 0.41880342, 'binary_recall': 0.15241058, 'binary_specificity': 0.99250644, 'binary_f1_score': 0.22348917}
confusion matrix:
       0    1
0  18013  136
1    545   98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9954277, 'precision': 0.9874939, 'recall': 0.99019784, 'specificity': 0.99019784, 'f1': 0.9888408, 'auroc': 0.9996799, 'binary_precision': 0.97715735, 'binary_recall': 0.9833972, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.98026735}
confusion matrix:
      0    1
0  5979   18
1    13  770
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_3.png
early stop counter: 1
val acc:0.9637611508369446, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.9958702325820923 / 0.9958702325820923
after epoch: 3,now: 2024-06-03 08:37:34.436062,epoch time: 0:17:56.237267,used: 0:54:32.127294,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9985236, 'precision': 0.99754703, 'recall': 0.9938087, 'specificity': 0.9938087, 'f1': 0.995669, 'auroc': 0.99938554, 'binary_precision': 0.99634534, 'binary_recall': 0.98799545, 'binary_specificity': 0.9996219, 'binary_f1_score': 0.9921528}
confusion matrix:
       0     1
0  42305    16
1     53  4362
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.7725509, 'recall': 0.5855552, 'specificity': 0.5855552, 'f1': 0.62616867, 'auroc': 0.91707945, 'binary_precision': 0.57360405, 'binary_recall': 0.17573872, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.2690476}
confusion matrix:
       0    1
0  18065   84
1    530  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99867254, 'precision': 0.99757695, 'recall': 0.99591845, 'specificity': 0.99591845, 'f1': 0.9967458, 'auroc': 0.9993675, 'binary_precision': 0.99615383, 'binary_recall': 0.99233717, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.9942418}
confusion matrix:
      0    1
0  5994    3
1     6  777
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_4.png
new oracle model saved
early stop counter: 2
val acc:0.9673265218734741, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.9958702325820923 / 0.9986725449562073
after epoch: 4,now: 2024-06-03 08:55:29.357135,epoch time: 0:17:54.921073,used: 1:12:27.048367,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9987376, 'precision': 0.9988926, 'recall': 0.99372256, 'specificity': 0.99372256, 'f1': 0.9962907, 'auroc': 0.99965566, 'binary_precision': 0.9990832, 'binary_recall': 0.98753965, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.99327797}
confusion matrix:
       0     1
0  42318     4
1     55  4359
---- Validation: 
scalar performance:
{'acc': 0.9660494, 'precision': 0.76720154, 'recall': 0.51588887, 'specificity': 0.51588887, 'f1': 0.5222383, 'auroc': 0.8826977, 'binary_precision': 0.5675676, 'binary_recall': 0.032659408, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.061764702}
confusion matrix:
       0   1
0  18133  16
1    622  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99764013, 'precision': 0.99697745, 'recall': 0.99144846, 'specificity': 0.99144846, 'f1': 0.9941921, 'auroc': 0.9989886, 'binary_precision': 0.996119, 'binary_recall': 0.9833972, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.9897172}
confusion matrix:
      0    1
0  5994    3
1    13  770
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_5.png
early stop counter: 3
val acc:0.9660493731498718, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.9958702325820923 / 0.9986725449562073
after epoch: 5,now: 2024-06-03 09:14:01.771440,epoch time: 0:18:32.414305,used: 1:30:59.462672,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99899435, 'precision': 0.99832153, 'recall': 0.9957912, 'specificity': 0.9957912, 'f1': 0.9970523, 'auroc': 0.99981195, 'binary_precision': 0.99749315, 'binary_recall': 0.99184227, 'binary_specificity': 0.9997401, 'binary_f1_score': 0.99465966}
confusion matrix:
       0     1
0  42312    11
1     36  4377
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.792133, 'recall': 0.5220547, 'specificity': 0.5220547, 'f1': 0.53346395, 'auroc': 0.89523983, 'binary_precision': 0.61702126, 'binary_recall': 0.045101088, 'binary_specificity': 0.99900824, 'binary_f1_score': 0.084057964}
confusion matrix:
       0   1
0  18131  18
1    614  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99867254, 'precision': 0.99757695, 'recall': 0.99591845, 'specificity': 0.99591845, 'f1': 0.9967458, 'auroc': 0.99988294, 'binary_precision': 0.99615383, 'binary_recall': 0.99233717, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.9942418}
confusion matrix:
      0    1
0  5994    3
1     6  777
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_6.png
early stop counter: 4
val acc:0.9663686752319336, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.9958702325820923 / 0.9986725449562073
after epoch: 6,now: 2024-06-03 09:32:12.078072,epoch time: 0:18:10.306632,used: 1:49:09.769304,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99897295, 'precision': 0.99770164, 'recall': 0.9962868, 'specificity': 0.9962868, 'f1': 0.99699295, 'auroc': 0.9998524, 'binary_precision': 0.9961355, 'binary_recall': 0.9929753, 'binary_specificity': 0.9995983, 'binary_f1_score': 0.99455285}
confusion matrix:
       0     1
0  42306    17
1     31  4382
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.8117725, 'recall': 0.5305256, 'specificity': 0.5305256, 'f1': 0.5483583, 'auroc': 0.8694699, 'binary_precision': 0.6557377, 'binary_recall': 0.0622084, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.11363636}
confusion matrix:
       0   1
0  18128  21
1    603  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9989675, 'precision': 0.9971988, 'recall': 0.99775076, 'specificity': 0.99775076, 'f1': 0.9974746, 'auroc': 0.9998809, 'binary_precision': 0.99489796, 'binary_recall': 0.99616855, 'binary_specificity': 0.999333, 'binary_f1_score': 0.9955329}
confusion matrix:
      0    1
0  5993    4
1     3  780
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_7.png
new oracle model saved
early stop counter: 5
val acc:0.9667943716049194, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.9958702325820923 / 0.9989675283432007
after epoch: 7,now: 2024-06-03 09:49:57.377341,epoch time: 0:17:45.299269,used: 2:06:55.068573,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9992939, 'precision': 0.99828887, 'recall': 0.9975809, 'specificity': 0.9975809, 'f1': 0.9979345, 'auroc': 0.9997409, 'binary_precision': 0.99705017, 'binary_recall': 0.995469, 'binary_specificity': 0.99969286, 'binary_f1_score': 0.9962589}
confusion matrix:
       0     1
0  42309    13
1     20  4394
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.73363763, 'recall': 0.52250165, 'specificity': 0.52250165, 'f1': 0.53395706, 'auroc': 0.86013556, 'binary_precision': 0.5, 'binary_recall': 0.0466563, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.08534851}
confusion matrix:
       0   1
0  18119  30
1    613  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979351, 'precision': 0.9944041, 'recall': 0.9955016, 'specificity': 0.9955016, 'f1': 0.99495196, 'auroc': 0.99980253, 'binary_precision': 0.9898089, 'binary_recall': 0.99233717, 'binary_specificity': 0.998666, 'binary_f1_score': 0.99107146}
confusion matrix:
      0    1
0  5989    8
1     6  777
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_8.png
early stop counter: 6
val acc:0.9657832980155945, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.9958702325820923 / 0.9989675283432007
after epoch: 8,now: 2024-06-03 10:07:25.282862,epoch time: 0:17:27.905521,used: 2:24:22.974094,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9994437, 'precision': 0.9991833, 'recall': 0.9975611, 'specificity': 0.9975611, 'f1': 0.9983705, 'auroc': 0.9999056, 'binary_precision': 0.9988626, 'binary_recall': 0.9952403, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.99704814}
confusion matrix:
       0     1
0  42319     5
1     21  4391
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.7396959, 'recall': 0.5338076, 'specificity': 0.5338076, 'f1': 0.5528628, 'auroc': 0.8786115, 'binary_precision': 0.5113636, 'binary_recall': 0.06998445, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.12311903}
confusion matrix:
       0   1
0  18106  43
1    598  45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9980826, 'precision': 0.9955802, 'recall': 0.99502975, 'specificity': 0.99502975, 'f1': 0.9953047, 'auroc': 0.99993145, 'binary_precision': 0.9923274, 'binary_recall': 0.99106, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.99169326}
confusion matrix:
      0    1
0  5991    6
1     7  776
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_9.png
early stop counter: 7
val acc:0.9658897519111633, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.9958702325820923 / 0.9989675283432007
after epoch: 9,now: 2024-06-03 10:25:21.388038,epoch time: 0:17:56.105176,used: 2:42:19.079270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9993795, 'precision': 0.9982369, 'recall': 0.9981358, 'specificity': 0.9981358, 'f1': 0.99818635, 'auroc': 0.99988425, 'binary_precision': 0.99682826, 'binary_recall': 0.9966025, 'binary_specificity': 0.9996692, 'binary_f1_score': 0.99671537}
confusion matrix:
       0     1
0  42307    14
1     15  4400
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.76026285, 'recall': 0.54002845, 'specificity': 0.54002845, 'f1': 0.5631285, 'auroc': 0.90605175, 'binary_precision': 0.5520833, 'binary_recall': 0.08242613, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.14343707}
confusion matrix:
       0   1
0  18106  43
1    590  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9974926, 'precision': 0.9904108, 'recall': 0.9974722, 'specificity': 0.9974722, 'f1': 0.9939074, 'auroc': 0.9999697, 'binary_precision': 0.98115575, 'binary_recall': 0.9974457, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.9892337}
confusion matrix:
      0    1
0  5982   15
1     2  781
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_10.png
early stop counter: 8
val acc:0.9663154482841492, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.9958702325820923 / 0.9989675283432007
after epoch: 10,now: 2024-06-03 10:43:05.952162,epoch time: 0:17:44.564124,used: 3:00:03.643394,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99955064, 'precision': 0.9992434, 'recall': 0.9981289, 'specificity': 0.9981289, 'f1': 0.99868536, 'auroc': 0.99996746, 'binary_precision': 0.99886465, 'binary_recall': 0.996376, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.99761873}
confusion matrix:
       0     1
0  42316     5
1     16  4399
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.7861018, 'recall': 0.5174717, 'specificity': 0.5174717, 'f1': 0.5251702, 'auroc': 0.8645067, 'binary_precision': 0.6052632, 'binary_recall': 0.035769828, 'binary_specificity': 0.9991735, 'binary_f1_score': 0.06754772}
confusion matrix:
       0   1
0  18134  15
1    620  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9995575, 'precision': 0.9991939, 'recall': 0.99863946, 'specificity': 0.99863946, 'f1': 0.9989165, 'auroc': 0.999987, 'binary_precision': 0.99872124, 'binary_recall': 0.9974457, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.99808306}
confusion matrix:
      0    1
0  5996    1
1     2  781
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_11.png
new oracle model saved
early stop counter: 9
val acc:0.9662090539932251, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.9958702325820923 / 0.9995574951171875
after epoch: 11,now: 2024-06-03 11:00:37.580011,epoch time: 0:17:31.627849,used: 3:17:35.271243,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9993795, 'precision': 0.9994534, 'recall': 0.9969186, 'specificity': 0.9969186, 'f1': 0.99818194, 'auroc': 0.9995921, 'binary_precision': 0.99954444, 'binary_recall': 0.9938845, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9967064}
confusion matrix:
       0     1
0  42319     2
1     27  4388
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.8017801, 'recall': 0.52133214, 'specificity': 0.52133214, 'f1': 0.53220606, 'auroc': 0.8284776, 'binary_precision': 0.6363636, 'binary_recall': 0.04354588, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.08151382}
confusion matrix:
       0   1
0  18133  16
1    615  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9992625, 'precision': 0.9995835, 'recall': 0.99680716, 'specificity': 0.99680716, 'f1': 0.9981901, 'auroc': 0.9993702, 'binary_precision': 1.0, 'binary_recall': 0.9936143, 'binary_specificity': 1.0, 'binary_f1_score': 0.9967969}
confusion matrix:
      0    1
0  5997    0
1     5  778
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_12.png
early stop counter: 10
val acc:0.966421902179718, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.9958702325820923 / 0.9995574951171875
after epoch: 12,now: 2024-06-03 11:18:17.054646,epoch time: 0:17:39.474635,used: 3:35:14.745878,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99961483, 'precision': 0.999279, 'recall': 0.99846834, 'specificity': 0.99846834, 'f1': 0.9988733, 'auroc': 0.9999866, 'binary_precision': 0.9988652, 'binary_recall': 0.9970548, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.9979592}
confusion matrix:
       0     1
0  42317     5
1     13  4401
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.85880816, 'recall': 0.5276632, 'specificity': 0.5276632, 'f1': 0.5437093, 'auroc': 0.9171022, 'binary_precision': 0.75, 'binary_recall': 0.05598756, 'binary_specificity': 0.9993388, 'binary_f1_score': 0.10419682}
confusion matrix:
       0   1
0  18137  12
1    607  36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99867254, 'precision': 0.9981315, 'recall': 0.99536324, 'specificity': 0.99536324, 'f1': 0.99674225, 'auroc': 0.99924064, 'binary_precision': 0.9974293, 'binary_recall': 0.99106, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.99423444}
confusion matrix:
      0    1
0  5995    2
1     7  776
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_13.png
early stop counter: 11
val acc:0.9670604467391968, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.9958702325820923 / 0.9995574951171875
after epoch: 13,now: 2024-06-03 11:36:06.970356,epoch time: 0:17:49.915710,used: 3:53:04.661588,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9994437, 'precision': 0.99898064, 'recall': 0.99776554, 'specificity': 0.99776554, 'f1': 0.99837214, 'auroc': 0.99981344, 'binary_precision': 0.99841017, 'binary_recall': 0.9956965, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.9970515}
confusion matrix:
       0     1
0  42314     7
1     19  4396
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.76558524, 'recall': 0.53025013, 'specificity': 0.53025013, 'f1': 0.5474246, 'auroc': 0.8319744, 'binary_precision': 0.5633803, 'binary_recall': 0.0622084, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.11204482}
confusion matrix:
       0   1
0  18118  31
1    603  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9992625, 'precision': 0.99902564, 'recall': 0.9973624, 'specificity': 0.9973624, 'f1': 0.9981922, 'auroc': 0.9998498, 'binary_precision': 0.99871796, 'binary_recall': 0.99489146, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9968011}
confusion matrix:
      0    1
0  5996    1
1     4  779
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_14.png
early stop counter: 12
val acc:0.9662622213363647, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.9958702325820923 / 0.9995574951171875
after epoch: 14,now: 2024-06-03 11:53:50.307692,epoch time: 0:17:43.337336,used: 4:10:47.998924,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.999679, 'precision': 0.99972105, 'recall': 0.9984027, 'specificity': 0.9984027, 'f1': 0.99906075, 'auroc': 0.99997556, 'binary_precision': 0.99977285, 'binary_recall': 0.996829, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99829876}
confusion matrix:
       0     1
0  42320     1
1     14  4401
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.8537703, 'recall': 0.5153592, 'specificity': 0.5153592, 'f1': 0.5213174, 'auroc': 0.8698051, 'binary_precision': 0.7407407, 'binary_recall': 0.0311042, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.059701495}
confusion matrix:
       0   1
0  18142   7
1    623  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99882007, 'precision': 0.99933386, 'recall': 0.9948914, 'specificity': 0.9948914, 'f1': 0.9970994, 'auroc': 0.999889, 'binary_precision': 1.0, 'binary_recall': 0.98978287, 'binary_specificity': 1.0, 'binary_f1_score': 0.99486524}
confusion matrix:
      0    1
0  5997    0
1     8  775
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_15.png
early stop counter: 13
val acc:0.9664750695228577, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.9958702325820923 / 0.9995574951171875
after epoch: 15,now: 2024-06-03 12:11:18.600860,epoch time: 0:17:28.293168,used: 4:28:16.292092,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99950784, 'precision': 0.9995246, 'recall': 0.99759865, 'specificity': 0.99759865, 'f1': 0.99855924, 'auroc': 0.9999857, 'binary_precision': 0.99954516, 'binary_recall': 0.99524456, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9973902}
confusion matrix:
       0     1
0  42318     2
1     21  4395
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.8941933, 'recall': 0.51774716, 'specificity': 0.51774716, 'f1': 0.5258114, 'auroc': 0.90949047, 'binary_precision': 0.8214286, 'binary_recall': 0.035769828, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.068554394}
confusion matrix:
       0   1
0  18144   5
1    620  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9992625, 'precision': 0.9995835, 'recall': 0.99680716, 'specificity': 0.99680716, 'f1': 0.9981901, 'auroc': 0.9999753, 'binary_precision': 1.0, 'binary_recall': 0.9936143, 'binary_specificity': 1.0, 'binary_f1_score': 0.9967969}
confusion matrix:
      0    1
0  5997    0
1     5  778
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_16.png
early stop counter: 14
val acc:0.966741144657135, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.9958702325820923 / 0.9995574951171875
after epoch: 16,now: 2024-06-03 12:28:35.947844,epoch time: 0:17:17.346984,used: 4:45:33.639076,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99965763, 'precision': 0.99981105, 'recall': 0.99818754, 'specificity': 0.99818754, 'f1': 0.9989977, 'auroc': 0.9999299, 'binary_precision': 1.0, 'binary_recall': 0.99637514, 'binary_specificity': 1.0, 'binary_f1_score': 0.9981843}
confusion matrix:
       0     1
0  42322     0
1     16  4398
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.94178927, 'recall': 0.51705223, 'specificity': 0.51705223, 'f1': 0.5245456, 'auroc': 0.8377969, 'binary_precision': 0.9166667, 'binary_recall': 0.03421462, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.065967016}
confusion matrix:
       0   1
0  18147   2
1    621  22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99941003, 'precision': 0.9996667, 'recall': 0.9974457, 'specificity': 0.9974457, 'f1': 0.9985529, 'auroc': 0.9996288, 'binary_precision': 1.0, 'binary_recall': 0.99489146, 'binary_specificity': 1.0, 'binary_f1_score': 0.9974392}
confusion matrix:
      0    1
0  5997    0
1     4  779
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_17.png
early stop counter: 15
val acc:0.9668475985527039, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.9958702325820923 / 0.9995574951171875
after epoch: 17,now: 2024-06-03 12:46:04.110220,epoch time: 0:17:28.162376,used: 5:03:01.801452,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9980743, 'precision': 0.9908694, 'recall': 0.998024, 'specificity': 0.998024, 'f1': 0.994414, 'auroc': 0.9999299, 'binary_precision': 0.9819519, 'binary_recall': 0.99796194, 'binary_specificity': 0.99808604, 'binary_f1_score': 0.9898922}
confusion matrix:
       0     1
0  42239    81
1      9  4407
---- Validation: 
scalar performance:
{'acc': 0.9731269, 'precision': 0.9286643, 'recall': 0.62306064, 'specificity': 0.62306064, 'f1': 0.686327, 'auroc': 0.90272725, 'binary_precision': 0.8833333, 'binary_recall': 0.24727838, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.38639128}
confusion matrix:
       0    1
0  18128   21
1    484  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9992625, 'precision': 0.99902564, 'recall': 0.9973624, 'specificity': 0.9973624, 'f1': 0.9981922, 'auroc': 0.9998021, 'binary_precision': 0.99871796, 'binary_recall': 0.99489146, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9968011}
confusion matrix:
      0    1
0  5996    1
1     4  779
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_18.png
better model found
persisted
after epoch: 18,now: 2024-06-03 13:03:54.366310,epoch time: 0:17:50.256090,used: 5:20:52.057542,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9997004, 'precision': 0.9997329, 'recall': 0.9985163, 'specificity': 0.9985163, 'f1': 0.9991237, 'auroc': 0.99993134, 'binary_precision': 0.9997729, 'binary_recall': 0.9970562, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9984127}
confusion matrix:
       0     1
0  42319     1
1     13  4403
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.85850215, 'recall': 0.51844215, 'specificity': 0.51844215, 'f1': 0.5270617, 'auroc': 0.835951, 'binary_precision': 0.75, 'binary_recall': 0.03732504, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.07111111}
confusion matrix:
       0   1
0  18141   8
1    619  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9992625, 'precision': 0.9995835, 'recall': 0.99680716, 'specificity': 0.99680716, 'f1': 0.9981901, 'auroc': 0.99886936, 'binary_precision': 1.0, 'binary_recall': 0.9936143, 'binary_specificity': 1.0, 'binary_f1_score': 0.9967969}
confusion matrix:
      0    1
0  5997    0
1     5  778
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_19.png
early stop counter: 1
val acc:0.9666347503662109, best validation acc: 0.9731268882751465, corresponding to test acc:                         0.9992625117301941 / 0.9995574951171875
after epoch: 19,now: 2024-06-03 13:21:43.396258,epoch time: 0:17:49.029948,used: 5:38:41.087490,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99959344, 'precision': 0.99916583, 'recall': 0.99845684, 'specificity': 0.99845684, 'f1': 0.998811, 'auroc': 0.99992144, 'binary_precision': 0.9986388, 'binary_recall': 0.9970555, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.9978465}
confusion matrix:
       0     1
0  42315     6
1     13  4402
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.84326786, 'recall': 0.5467727, 'specificity': 0.5467727, 'f1': 0.57557, 'auroc': 0.8787829, 'binary_precision': 0.7176471, 'binary_recall': 0.09486781, 'binary_specificity': 0.9986776, 'binary_f1_score': 0.16758242}
confusion matrix:
       0   1
0  18125  24
1    582  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9998525, 'precision': 0.99936223, 'recall': 0.9999166, 'specificity': 0.9999166, 'f1': 0.9996392, 'auroc': 0.99999976, 'binary_precision': 0.99872446, 'binary_recall': 1.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9993618}
confusion matrix:
      0    1
0  5996    1
1     0  783
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_20.png
new oracle model saved
early stop counter: 2
val acc:0.96775221824646, best validation acc: 0.9731268882751465, corresponding to test acc:                         0.9992625117301941 / 0.9998524785041809
after epoch: 20,now: 2024-06-03 13:39:54.079708,epoch time: 0:18:10.683450,used: 5:56:51.770940,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9994651, 'precision': 0.9987904, 'recall': 0.99808204, 'specificity': 0.99808204, 'f1': 0.99843585, 'auroc': 0.9999242, 'binary_precision': 0.9979587, 'binary_recall': 0.9963768, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.9971671}
confusion matrix:
       0     1
0  42311     9
1     16  4400
---- Validation: 
scalar performance:
{'acc': 0.9680183, 'precision': 0.92164814, 'recall': 0.5379098, 'specificity': 0.5379098, 'f1': 0.5619532, 'auroc': 0.87559474, 'binary_precision': 0.875, 'binary_recall': 0.07620529, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.14020029}
confusion matrix:
       0   1
0  18142   7
1    594  49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99941003, 'precision': 0.99800575, 'recall': 0.9991113, 'specificity': 0.9991113, 'f1': 0.9985577, 'auroc': 0.9994352, 'binary_precision': 0.9961783, 'binary_recall': 0.99872285, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.997449}
confusion matrix:
      0    1
0  5994    3
1     1  782
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_21.png
early stop counter: 3
val acc:0.9680182933807373, best validation acc: 0.9731268882751465, corresponding to test acc:                         0.9992625117301941 / 0.9998524785041809
after epoch: 21,now: 2024-06-03 13:58:58.822964,epoch time: 0:19:04.743256,used: 6:15:56.514196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99959344, 'precision': 0.99977565, 'recall': 0.9978483, 'specificity': 0.9978483, 'f1': 0.9988096, 'auroc': 0.9999279, 'binary_precision': 1.0, 'binary_recall': 0.9956965, 'binary_specificity': 1.0, 'binary_f1_score': 0.99784356}
confusion matrix:
       0     1
0  42321     0
1     19  4396
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.90832627, 'recall': 0.5131366, 'specificity': 0.5131366, 'f1': 0.51712286, 'auroc': 0.8998634, 'binary_precision': 0.85, 'binary_recall': 0.02643857, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.05128205}
confusion matrix:
       0   1
0  18146   3
1    626  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99911505, 'precision': 0.9995003, 'recall': 0.9961686, 'specificity': 0.9961686, 'f1': 0.99782693, 'auroc': 0.999045, 'binary_precision': 1.0, 'binary_recall': 0.99233717, 'binary_specificity': 1.0, 'binary_f1_score': 0.99615383}
confusion matrix:
      0    1
0  5997    0
1     6  777
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_22.png
early stop counter: 4
val acc:0.9665282964706421, best validation acc: 0.9731268882751465, corresponding to test acc:                         0.9992625117301941 / 0.9998524785041809
after epoch: 22,now: 2024-06-03 14:17:10.941684,epoch time: 0:18:12.118720,used: 6:34:08.632916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9998288, 'precision': 0.99990547, 'recall': 0.9990942, 'specificity': 0.9990942, 'f1': 0.99949944, 'auroc': 0.99999654, 'binary_precision': 1.0, 'binary_recall': 0.9981884, 'binary_specificity': 1.0, 'binary_f1_score': 0.99909335}
confusion matrix:
       0     1
0  42320     0
1      8  4408
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.88601047, 'recall': 0.52852345, 'specificity': 0.52852345, 'f1': 0.5453666, 'auroc': 0.9364526, 'binary_precision': 0.8043478, 'binary_recall': 0.057542767, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.107402034}
confusion matrix:
       0   1
0  18140   9
1    606  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9995575, 'precision': 0.99864113, 'recall': 0.9991947, 'specificity': 0.9991947, 'f1': 0.9989177, 'auroc': 0.9999976, 'binary_precision': 0.997449, 'binary_recall': 0.99872285, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.99808556}
confusion matrix:
      0    1
0  5995    2
1     1  782
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054739_23.png
early stop counter: 5
val acc:0.9672732949256897, best validation acc: 0.9731268882751465, corresponding to test acc:                         0.9992625117301941 / 0.9998524785041809
after epoch: 23,now: 2024-06-03 14:35:24.323745,epoch time: 0:18:13.382061,used: 6:52:22.014977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_07_43_02_seed_0_21054739
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99963623, 'precision': 0.9994939, 'recall': 0.99837834, 'specificity': 0.99837834, 'f1': 0.99893534, 'auroc': 0.99995995, 'binary_precision': 0.9993185, 'binary_recall': 0.99682754, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9980715}
confusion matrix:
       0     1
0  42320     3
1     14  4399
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.8724941, 'recall': 0.52155256, 'specificity': 0.52155256, 'f1': 0.5327965, 'auroc': 0.9324877, 'binary_precision': 0.7777778, 'binary_recall': 0.04354588, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.082474224}
confusion matrix:
       0   1
0  18141   8
1    615  28
---- Test Domain (oracle): 
scalar performance:
--- Logging error ---
Traceback (most recent call last):
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1084, in flush
    self.stream.flush()
OSError: [Errno 122] Disk quota exceeded
Call stack:
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 973, in _bootstrap
    self._bootstrap_inner()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 83, in _worker
    work_item.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 699, in cached_or_run
    run_func(*args)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 2656, in run_wrapper
    run(
--- Logging error ---
