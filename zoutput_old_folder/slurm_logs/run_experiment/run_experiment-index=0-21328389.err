Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jun 16 13:35:10 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389

 Experiment start at: 2024-06-16 13:46:55.150997
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.7294978, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.68749917, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.6945534, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-16 14:11:45.248736,epoch time: 0:24:50.097739,used: 0:24:50.097739,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96652967, 'precision': 0.7869512, 'recall': 0.5056445, 'specificity': 0.5056445, 'f1': 0.50281996, 'auroc': 0.86009777, 'binary_precision': 0.60714287, 'binary_recall': 0.011548913, 'binary_specificity': 0.9997401, 'binary_f1_score': 0.022666665}
confusion matrix:
       0   1
0  42317  11
1   1455  17
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8406668, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8321691, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-16 14:35:47.139236,epoch time: 0:24:01.890500,used: 0:48:51.988239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.7640544, 'recall': 0.5521919, 'specificity': 0.5521919, 'f1': 0.58164716, 'auroc': 0.88983285, 'binary_precision': 0.5583039, 'binary_recall': 0.10733695, 'binary_specificity': 0.9970469, 'binary_f1_score': 0.18005699}
confusion matrix:
       0    1
0  42203  125
1   1314  158
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.72617006, 'recall': 0.5127234, 'specificity': 0.5127234, 'f1': 0.5163489, 'auroc': 0.8867817, 'binary_precision': 0.4857143, 'binary_recall': 0.02643857, 'binary_specificity': 0.99900824, 'binary_f1_score': 0.050147492}
confusion matrix:
       0   1
0  18131  18
1    626  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.9803749, 'recall': 0.53065133, 'specificity': 0.53065133, 'f1': 0.54775274, 'auroc': 0.8724694, 'binary_precision': 1.0, 'binary_recall': 0.06130268, 'binary_specificity': 1.0, 'binary_f1_score': 0.115523465}
confusion matrix:
      0   1
0  5997   0
1   245  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_3.png
new oracle model saved
early stop counter: 2
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9608501195907593
after epoch: 3,now: 2024-06-16 15:00:02.842102,epoch time: 0:24:15.702866,used: 1:13:07.691105,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9661644, 'precision': 0.72982323, 'recall': 0.5703721, 'specificity': 0.5703721, 'f1': 0.60380006, 'auroc': 0.90632546, 'binary_precision': 0.48863637, 'binary_recall': 0.14605978, 'binary_specificity': 0.9946844, 'binary_f1_score': 0.22489542}
confusion matrix:
       0    1
0  42103  225
1   1257  215
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7888265, 'recall': 0.5402764, 'specificity': 0.5402764, 'f1': 0.5641369, 'auroc': 0.8963736, 'binary_precision': 0.6091954, 'binary_recall': 0.08242613, 'binary_specificity': 0.9981266, 'binary_f1_score': 0.14520548}
confusion matrix:
       0   1
0  18115  34
1    590  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.981919, 'recall': 0.5689655, 'specificity': 0.5689655, 'f1': 0.6120051, 'auroc': 0.8781945, 'binary_precision': 1.0, 'binary_recall': 0.13793103, 'binary_specificity': 1.0, 'binary_f1_score': 0.24242425}
confusion matrix:
      0   1
0  5997   0
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-16 15:24:29.875508,epoch time: 0:24:27.033406,used: 1:37:34.724511,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.749738, 'recall': 0.6063519, 'specificity': 0.6063519, 'f1': 0.6465023, 'auroc': 0.9143215, 'binary_precision': 0.5260586, 'binary_recall': 0.21957852, 'binary_specificity': 0.99312526, 'binary_f1_score': 0.30983213}
confusion matrix:
       0    1
0  42038  291
1   1148  323
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.77422035, 'recall': 0.56136054, 'specificity': 0.56136054, 'f1': 0.595011, 'auroc': 0.9082011, 'binary_precision': 0.57857144, 'binary_recall': 0.125972, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.20689653}
confusion matrix:
       0   1
0  18090  59
1    562  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.98316145, 'recall': 0.5996169, 'specificity': 0.5996169, 'f1': 0.6575707, 'auroc': 0.88302577, 'binary_precision': 1.0, 'binary_recall': 0.19923371, 'binary_specificity': 1.0, 'binary_f1_score': 0.33226836}
confusion matrix:
      0   1
0  5997   0
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-16 15:48:12.969255,epoch time: 0:23:43.093747,used: 2:01:17.818258,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96753424, 'precision': 0.7560867, 'recall': 0.6163257, 'specificity': 0.6163257, 'f1': 0.65756494, 'auroc': 0.9161967, 'binary_precision': 0.5381098, 'binary_recall': 0.23980978, 'binary_specificity': 0.9928416, 'binary_f1_score': 0.3317669}
confusion matrix:
       0    1
0  42025  303
1   1119  353
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.78516793, 'recall': 0.5683315, 'specificity': 0.5683315, 'f1': 0.6051622, 'auroc': 0.9122742, 'binary_precision': 0.6, 'binary_recall': 0.1399689, 'binary_specificity': 0.996694, 'binary_f1_score': 0.22698614}
confusion matrix:
       0   1
0  18089  60
1    553  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.9830836, 'recall': 0.59770113, 'specificity': 0.59770113, 'f1': 0.65485775, 'auroc': 0.88168657, 'binary_precision': 1.0, 'binary_recall': 0.1954023, 'binary_specificity': 1.0, 'binary_f1_score': 0.32692307}
confusion matrix:
      0   1
0  5997   0
1   210  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_6.png
better model found
persisted
after epoch: 6,now: 2024-06-16 16:12:17.430901,epoch time: 0:24:04.461646,used: 2:25:22.279904,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9676712, 'precision': 0.7561358, 'recall': 0.6337732, 'specificity': 0.6337732, 'f1': 0.6739331, 'auroc': 0.9216244, 'binary_precision': 0.537037, 'binary_recall': 0.27581522, 'binary_specificity': 0.9917312, 'binary_f1_score': 0.3644524}
confusion matrix:
       0    1
0  41978  350
1   1066  406
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.7785024, 'recall': 0.5720266, 'specificity': 0.5720266, 'f1': 0.6096516, 'auroc': 0.9161913, 'binary_precision': 0.58641976, 'binary_recall': 0.14774494, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.23602483}
confusion matrix:
       0   1
0  18082  67
1    548  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.9825394, 'recall': 0.5842912, 'specificity': 0.5842912, 'f1': 0.6353768, 'auroc': 0.8845793, 'binary_precision': 1.0, 'binary_recall': 0.16858238, 'binary_specificity': 1.0, 'binary_f1_score': 0.28852457}
confusion matrix:
      0   1
0  5997   0
1   217  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_7.png
early stop counter: 1
val acc:0.9672732949256897, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9664429426193237 / 0.9666027426719666
after epoch: 7,now: 2024-06-16 16:37:20.891238,epoch time: 0:25:03.460337,used: 2:50:25.740241,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9679909, 'precision': 0.75947654, 'recall': 0.64606947, 'specificity': 0.64606947, 'f1': 0.68540204, 'auroc': 0.9252649, 'binary_precision': 0.54289216, 'binary_recall': 0.3009511, 'binary_specificity': 0.9911879, 'binary_f1_score': 0.3872378}
confusion matrix:
       0    1
0  41955  373
1   1029  443
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7615794, 'recall': 0.5845847, 'specificity': 0.5845847, 'f1': 0.62392235, 'auroc': 0.92169285, 'binary_precision': 0.55172414, 'binary_recall': 0.17418352, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.26477543}
confusion matrix:
       0    1
0  18058   91
1    531  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.983629, 'recall': 0.6111111, 'specificity': 0.6111111, 'f1': 0.6734965, 'auroc': 0.88877964, 'binary_precision': 1.0, 'binary_recall': 0.22222222, 'binary_specificity': 1.0, 'binary_f1_score': 0.36363637}
confusion matrix:
      0   1
0  5997   0
1   203  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_8.png
new oracle model saved
early stop counter: 2
val acc:0.9669008255004883, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9664429426193237 / 0.9675615429878235
after epoch: 8,now: 2024-06-16 17:02:24.942375,epoch time: 0:25:04.051137,used: 3:15:29.791378,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9681735, 'precision': 0.7637119, 'recall': 0.636656, 'specificity': 0.636656, 'f1': 0.67815495, 'auroc': 0.92607, 'binary_precision': 0.552, 'binary_recall': 0.28125, 'binary_specificity': 0.992062, 'binary_f1_score': 0.37263727}
confusion matrix:
       0    1
0  41992  336
1   1058  414
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.76635206, 'recall': 0.5718338, 'specificity': 0.5718338, 'f1': 0.60853755, 'auroc': 0.9234853, 'binary_precision': 0.56213015, 'binary_recall': 0.14774494, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.23399013}
confusion matrix:
       0   1
0  18075  74
1    548  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.98292804, 'recall': 0.59386975, 'specificity': 0.59386975, 'f1': 0.6493802, 'auroc': 0.88907516, 'binary_precision': 1.0, 'binary_recall': 0.18773946, 'binary_specificity': 1.0, 'binary_f1_score': 0.31612903}
confusion matrix:
      0   1
0  5997   0
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_9.png
early stop counter: 3
val acc:0.9669008255004883, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9664429426193237 / 0.9675615429878235
after epoch: 9,now: 2024-06-16 17:27:46.493728,epoch time: 0:25:21.551353,used: 3:40:51.342731,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9675571, 'precision': 0.7577156, 'recall': 0.6087967, 'specificity': 0.6087967, 'f1': 0.6502695, 'auroc': 0.9264694, 'binary_precision': 0.5418719, 'binary_recall': 0.22418478, 'binary_specificity': 0.9934086, 'binary_f1_score': 0.31715524}
confusion matrix:
       0    1
0  42049  279
1   1142  330
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.77127004, 'recall': 0.56586087, 'specificity': 0.56586087, 'f1': 0.60099393, 'auroc': 0.92438775, 'binary_precision': 0.57236844, 'binary_recall': 0.13530326, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.21886791}
confusion matrix:
       0   1
0  18084  65
1    556  87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.98176414, 'recall': 0.5651341, 'specificity': 0.5651341, 'f1': 0.6059669, 'auroc': 0.89188325, 'binary_precision': 1.0, 'binary_recall': 0.1302682, 'binary_specificity': 1.0, 'binary_f1_score': 0.23050848}
confusion matrix:
      0   1
0  5997   0
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_10.png
early stop counter: 4
val acc:0.9669540524482727, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9664429426193237 / 0.9675615429878235
after epoch: 10,now: 2024-06-16 17:52:22.166502,epoch time: 0:24:35.672774,used: 4:05:27.015505,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96892697, 'precision': 0.78109765, 'recall': 0.62327564, 'specificity': 0.62327564, 'f1': 0.66876256, 'auroc': 0.92808616, 'binary_precision': 0.5876777, 'binary_recall': 0.2527174, 'binary_specificity': 0.99383384, 'binary_f1_score': 0.3534442}
confusion matrix:
       0    1
0  42067  261
1   1100  372
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.785015, 'recall': 0.563776, 'specificity': 0.563776, 'f1': 0.5989239, 'auroc': 0.9273949, 'binary_precision': 0.6, 'binary_recall': 0.13063763, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.21455938}
confusion matrix:
       0   1
0  18093  56
1    559  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.9816867, 'recall': 0.5632184, 'specificity': 0.5632184, 'f1': 0.60291743, 'auroc': 0.89220405, 'binary_precision': 1.0, 'binary_recall': 0.12643678, 'binary_specificity': 1.0, 'binary_f1_score': 0.2244898}
confusion matrix:
      0   1
0  5997   0
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_11.png
early stop counter: 5
val acc:0.9672732949256897, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9664429426193237 / 0.9675615429878235
after epoch: 11,now: 2024-06-16 18:17:56.391962,epoch time: 0:25:34.225460,used: 4:31:01.240965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.968379, 'precision': 0.76402974, 'recall': 0.6538111, 'specificity': 0.6538111, 'f1': 0.6930021, 'auroc': 0.9299656, 'binary_precision': 0.5514793, 'binary_recall': 0.3165761, 'binary_specificity': 0.99104613, 'binary_f1_score': 0.40224427}
confusion matrix:
       0    1
0  41949  379
1   1006  466
---- Validation: 
scalar performance:
{'acc': 0.96796507, 'precision': 0.7800103, 'recall': 0.60463715, 'specificity': 0.60463715, 'f1': 0.64897513, 'auroc': 0.93339807, 'binary_precision': 0.587234, 'binary_recall': 0.21461898, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.31435078}
confusion matrix:
       0    1
0  18052   97
1    505  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.97600216, 'recall': 0.61869055, 'specificity': 0.61869055, 'f1': 0.68315595, 'auroc': 0.8969722, 'binary_precision': 0.984127, 'binary_recall': 0.23754789, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.38271603}
confusion matrix:
      0   1
0  5996   1
1   199  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_12.png
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-06-16 18:42:47.966120,epoch time: 0:24:51.574158,used: 4:55:52.815123,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9692694, 'precision': 0.7765472, 'recall': 0.6575504, 'specificity': 0.6575504, 'f1': 0.699247, 'auroc': 0.9319031, 'binary_precision': 0.5762712, 'binary_recall': 0.32336956, 'binary_specificity': 0.9917312, 'binary_f1_score': 0.41427326}
confusion matrix:
       0    1
0  41978  350
1    996  476
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.77747643, 'recall': 0.593221, 'specificity': 0.593221, 'f1': 0.6357515, 'auroc': 0.934267, 'binary_precision': 0.5829384, 'binary_recall': 0.19129083, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.28805622}
confusion matrix:
       0    1
0  18061   88
1    520  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.982229, 'recall': 0.5766283, 'specificity': 0.5766283, 'f1': 0.62384415, 'auroc': 0.89604914, 'binary_precision': 1.0, 'binary_recall': 0.1532567, 'binary_specificity': 1.0, 'binary_f1_score': 0.26578075}
confusion matrix:
      0   1
0  5997   0
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_13.png
early stop counter: 1
val acc:0.9676458239555359, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9680408835411072 / 0.9680408835411072
after epoch: 13,now: 2024-06-16 19:07:19.128721,epoch time: 0:24:31.162601,used: 5:20:23.977724,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9686986, 'precision': 0.769122, 'recall': 0.6516814, 'specificity': 0.6516814, 'f1': 0.6924889, 'auroc': 0.934253, 'binary_precision': 0.5618115, 'binary_recall': 0.31182066, 'binary_specificity': 0.9915422, 'binary_f1_score': 0.40104848}
confusion matrix:
       0    1
0  41970  358
1   1013  459
---- Validation: 
scalar performance:
{'acc': 0.96796507, 'precision': 0.78647894, 'recall': 0.5926363, 'specificity': 0.5926363, 'f1': 0.63601494, 'auroc': 0.93536776, 'binary_precision': 0.6009852, 'binary_recall': 0.18973562, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.2884161}
confusion matrix:
       0    1
0  18068   81
1    521  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.98176414, 'recall': 0.5651341, 'specificity': 0.5651341, 'f1': 0.6059669, 'auroc': 0.89475566, 'binary_precision': 1.0, 'binary_recall': 0.1302682, 'binary_specificity': 1.0, 'binary_f1_score': 0.23050848}
confusion matrix:
      0   1
0  5997   0
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_14.png
early stop counter: 2
val acc:0.9679650664329529, best validation acc: 0.9679650664329529, corresponding to test acc:                         0.9680408835411072 / 0.9680408835411072
after epoch: 14,now: 2024-06-16 19:32:10.822304,epoch time: 0:24:51.693583,used: 5:45:15.671307,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96899545, 'precision': 0.77071977, 'recall': 0.665933, 'specificity': 0.665933, 'f1': 0.70456576, 'auroc': 0.93528324, 'binary_precision': 0.56404495, 'binary_recall': 0.3410326, 'binary_specificity': 0.99083346, 'binary_f1_score': 0.4250635}
confusion matrix:
       0    1
0  41940  388
1    970  502
---- Validation: 
scalar performance:
{'acc': 0.96855044, 'precision': 0.7907719, 'recall': 0.61094064, 'specificity': 0.61094064, 'f1': 0.65729386, 'auroc': 0.93792737, 'binary_precision': 0.60833335, 'binary_recall': 0.22706065, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.3306908}
confusion matrix:
       0    1
0  18055   94
1    497  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.97142553, 'recall': 0.5842078, 'specificity': 0.5842078, 'f1': 0.63486373, 'auroc': 0.89519024, 'binary_precision': 0.9777778, 'binary_recall': 0.16858238, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.2875817}
confusion matrix:
      0   1
0  5996   1
1   217  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_15.png
better model found
persisted
after epoch: 15,now: 2024-06-16 19:56:58.961546,epoch time: 0:24:48.139242,used: 6:10:03.810549,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96881276, 'precision': 0.77071536, 'recall': 0.6523962, 'specificity': 0.6523962, 'f1': 0.69348013, 'auroc': 0.9347199, 'binary_precision': 0.564951, 'binary_recall': 0.31317934, 'binary_specificity': 0.9916131, 'binary_f1_score': 0.40297204}
confusion matrix:
       0    1
0  41973  355
1   1011  461
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.7828107, 'recall': 0.5887758, 'specificity': 0.5887758, 'f1': 0.6310395, 'auroc': 0.9370005, 'binary_precision': 0.5939086, 'binary_recall': 0.18195957, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.27857143}
confusion matrix:
       0    1
0  18069   80
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.9810685, 'recall': 0.5478927, 'specificity': 0.5478927, 'f1': 0.57776415, 'auroc': 0.8930955, 'binary_precision': 1.0, 'binary_recall': 0.09578544, 'binary_specificity': 1.0, 'binary_f1_score': 0.17482518}
confusion matrix:
      0   1
0  5997   0
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_16.png
early stop counter: 1
val acc:0.96775221824646, best validation acc: 0.968550443649292, corresponding to test acc:                         0.9651646018028259 / 0.9680408835411072
after epoch: 16,now: 2024-06-16 20:21:52.007985,epoch time: 0:24:53.046439,used: 6:34:56.856988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96952057, 'precision': 0.77919865, 'recall': 0.6622704, 'specificity': 0.6622704, 'f1': 0.7038363, 'auroc': 0.9377265, 'binary_precision': 0.5812574, 'binary_recall': 0.33288044, 'binary_specificity': 0.99166036, 'binary_f1_score': 0.42332613}
confusion matrix:
       0    1
0  41975  353
1    982  490
---- Validation: 
scalar performance:
{'acc': 0.9678587, 'precision': 0.7868543, 'recall': 0.58733076, 'specificity': 0.58733076, 'f1': 0.629672, 'auroc': 0.93796015, 'binary_precision': 0.60209423, 'binary_recall': 0.17884915, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.27577937}
confusion matrix:
       0    1
0  18073   76
1    528  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.98076, 'recall': 0.5402299, 'specificity': 0.5402299, 'f1': 0.56465936, 'auroc': 0.89572597, 'binary_precision': 1.0, 'binary_recall': 0.08045977, 'binary_specificity': 1.0, 'binary_f1_score': 0.14893617}
confusion matrix:
      0   1
0  5997   0
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_17.png
early stop counter: 2
val acc:0.9678586721420288, best validation acc: 0.968550443649292, corresponding to test acc:                         0.9651646018028259 / 0.9680408835411072
after epoch: 17,now: 2024-06-16 20:46:47.268545,epoch time: 0:24:55.260560,used: 6:59:52.117548,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97025114, 'precision': 0.7841171, 'recall': 0.68428725, 'specificity': 0.68428725, 'f1': 0.7225797, 'auroc': 0.93929553, 'binary_precision': 0.58960766, 'binary_recall': 0.3777174, 'binary_specificity': 0.9908571, 'binary_f1_score': 0.4604555}
confusion matrix:
       0    1
0  41941  387
1    916  556
---- Validation: 
scalar performance:
{'acc': 0.96855044, 'precision': 0.7925377, 'recall': 0.60794044, 'specificity': 0.60794044, 'f1': 0.65423596, 'auroc': 0.9391804, 'binary_precision': 0.61206895, 'binary_recall': 0.22083981, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.32457143}
confusion matrix:
       0    1
0  18059   90
1    501  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.98145473, 'recall': 0.5574713, 'specificity': 0.5574713, 'f1': 0.5936449, 'auroc': 0.8968912, 'binary_precision': 1.0, 'binary_recall': 0.11494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5997   0
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_18.png
early stop counter: 3
val acc:0.968550443649292, best validation acc: 0.968550443649292, corresponding to test acc:                         0.9651646018028259 / 0.9680408835411072
after epoch: 18,now: 2024-06-16 21:12:24.034720,epoch time: 0:25:36.766175,used: 7:25:28.883723,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.970274, 'precision': 0.78978264, 'recall': 0.6662667, 'specificity': 0.6662667, 'f1': 0.7098157, 'auroc': 0.93962646, 'binary_precision': 0.60216343, 'binary_recall': 0.34035325, 'binary_specificity': 0.9921801, 'binary_f1_score': 0.4348958}
confusion matrix:
       0    1
0  41997  331
1    971  501
---- Validation: 
scalar performance:
{'acc': 0.9686037, 'precision': 0.79792815, 'recall': 0.6019675, 'specificity': 0.6019675, 'f1': 0.64814466, 'auroc': 0.9407445, 'binary_precision': 0.6232558, 'binary_recall': 0.20839813, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.3123543}
confusion matrix:
       0    1
0  18068   81
1    509  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.98114574, 'recall': 0.54980844, 'specificity': 0.54980844, 'f1': 0.580984, 'auroc': 0.8982644, 'binary_precision': 1.0, 'binary_recall': 0.099616855, 'binary_specificity': 1.0, 'binary_f1_score': 0.18118466}
confusion matrix:
      0   1
0  5997   0
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_19.png
better model found
persisted
after epoch: 19,now: 2024-06-16 21:37:06.892786,epoch time: 0:24:42.858066,used: 7:50:11.741789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96958905, 'precision': 0.7860273, 'recall': 0.64394563, 'specificity': 0.64394563, 'f1': 0.68947417, 'auroc': 0.93721765, 'binary_precision': 0.59615386, 'binary_recall': 0.29483697, 'binary_specificity': 0.9930543, 'binary_f1_score': 0.39454547}
confusion matrix:
       0    1
0  42034  294
1   1038  434
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.79633546, 'recall': 0.56771916, 'specificity': 0.56771916, 'f1': 0.6049702, 'auroc': 0.9400413, 'binary_precision': 0.62237763, 'binary_recall': 0.13841368, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.22646311}
confusion matrix:
       0   1
0  18095  54
1    554  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.9803749, 'recall': 0.53065133, 'specificity': 0.53065133, 'f1': 0.54775274, 'auroc': 0.8943571, 'binary_precision': 1.0, 'binary_recall': 0.06130268, 'binary_specificity': 1.0, 'binary_f1_score': 0.115523465}
confusion matrix:
      0   1
0  5997   0
1   245  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_20.png
early stop counter: 1
val acc:0.9676458239555359, best validation acc: 0.9686036705970764, corresponding to test acc:                         0.9624480605125427 / 0.9680408835411072
after epoch: 20,now: 2024-06-16 22:02:22.556814,epoch time: 0:25:15.664028,used: 8:15:27.405817,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.969863, 'precision': 0.78402364, 'recall': 0.6628771, 'specificity': 0.6628771, 'f1': 0.7055552, 'auroc': 0.9387927, 'binary_precision': 0.5908544, 'binary_recall': 0.33378655, 'binary_specificity': 0.9919677, 'binary_f1_score': 0.42658558}
confusion matrix:
       0    1
0  41989  340
1    980  491
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.79870975, 'recall': 0.6209944, 'specificity': 0.6209944, 'f1': 0.66915524, 'auroc': 0.94267356, 'binary_precision': 0.62352943, 'binary_recall': 0.24727838, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.35412025}
confusion matrix:
       0    1
0  18053   96
1    484  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.96883565, 'recall': 0.57079786, 'specificity': 0.57079786, 'f1': 0.61453736, 'auroc': 0.8995136, 'binary_precision': 0.9736842, 'binary_recall': 0.14176245, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.24749163}
confusion matrix:
      0   1
0  5996   1
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_21.png
better model found
persisted
after epoch: 21,now: 2024-06-16 22:27:25.890772,epoch time: 0:25:03.333958,used: 8:40:30.739775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9703196, 'precision': 0.7829515, 'recall': 0.69284713, 'specificity': 0.69284713, 'f1': 0.72856647, 'auroc': 0.9367695, 'binary_precision': 0.5866935, 'binary_recall': 0.39538044, 'binary_specificity': 0.99031377, 'binary_f1_score': 0.47240257}
confusion matrix:
       0    1
0  41918  410
1    890  582
---- Validation: 
scalar performance:
{'acc': 0.96902937, 'precision': 0.7958495, 'recall': 0.6216894, 'specificity': 0.6216894, 'f1': 0.6694505, 'auroc': 0.9428416, 'binary_precision': 0.6177606, 'binary_recall': 0.2488336, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.35476717}
confusion matrix:
       0    1
0  18050   99
1    483  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.9696486, 'recall': 0.57462925, 'specificity': 0.57462925, 'f1': 0.62044, 'auroc': 0.89874107, 'binary_precision': 0.975, 'binary_recall': 0.14942528, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.2591362}
confusion matrix:
      0   1
0  5996   1
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_22.png
early stop counter: 1
val acc:0.9690293669700623, best validation acc: 0.9691358208656311, corresponding to test acc:                         0.9640460014343262 / 0.9680408835411072
after epoch: 22,now: 2024-06-16 22:52:33.507514,epoch time: 0:25:07.616742,used: 9:05:38.356517,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9697945, 'precision': 0.77696806, 'recall': 0.6877767, 'specificity': 0.6877767, 'f1': 0.723, 'auroc': 0.94177, 'binary_precision': 0.5750507, 'binary_recall': 0.38545206, 'binary_specificity': 0.99010134, 'binary_f1_score': 0.4615385}
confusion matrix:
       0    1
0  41910  419
1    904  567
---- Validation: 
scalar performance:
{'acc': 0.96902937, 'precision': 0.7962822, 'recall': 0.6209393, 'specificity': 0.6209393, 'f1': 0.6687341, 'auroc': 0.94219047, 'binary_precision': 0.618677, 'binary_recall': 0.24727838, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.35333332}
confusion matrix:
       0    1
0  18051   98
1    484  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.982229, 'recall': 0.5766283, 'specificity': 0.5766283, 'f1': 0.62384415, 'auroc': 0.89993334, 'binary_precision': 1.0, 'binary_recall': 0.1532567, 'binary_specificity': 1.0, 'binary_f1_score': 0.26578075}
confusion matrix:
      0   1
0  5997   0
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_23.png
early stop counter: 2
val acc:0.9690293669700623, best validation acc: 0.9691358208656311, corresponding to test acc:                         0.9640460014343262 / 0.9680408835411072
after epoch: 23,now: 2024-06-16 23:17:48.707703,epoch time: 0:25:15.200189,used: 9:30:53.556706,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96974885, 'precision': 0.77494264, 'recall': 0.69562733, 'specificity': 0.69562733, 'f1': 0.7279543, 'auroc': 0.9370556, 'binary_precision': 0.5704633, 'binary_recall': 0.4017675, 'binary_specificity': 0.9894871, 'binary_f1_score': 0.47147983}
confusion matrix:
       0    1
0  41884  445
1    880  591
---- Validation: 
scalar performance:
{'acc': 0.96945506, 'precision': 0.80319464, 'recall': 0.62566006, 'specificity': 0.62566006, 'f1': 0.6746977, 'auroc': 0.94400203, 'binary_precision': 0.6321839, 'binary_recall': 0.25660965, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.36504424}
confusion matrix:
       0    1
0  18053   96
1    478  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.96590406, 'recall': 0.5593036, 'specificity': 0.5593036, 'f1': 0.59635264, 'auroc': 0.8997654, 'binary_precision': 0.96875, 'binary_recall': 0.118773945, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.21160409}
confusion matrix:
      0   1
0  5996   1
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_24.png
better model found
persisted
after epoch: 24,now: 2024-06-16 23:44:20.371980,epoch time: 0:26:31.664277,used: 9:57:25.220983,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.97041094, 'precision': 0.7923277, 'recall': 0.66535395, 'specificity': 0.66535395, 'f1': 0.70968145, 'auroc': 0.94192225, 'binary_precision': 0.6073171, 'binary_recall': 0.33831522, 'binary_specificity': 0.9923927, 'binary_f1_score': 0.43455496}
confusion matrix:
       0    1
0  42006  322
1    974  498
---- Validation: 
scalar performance:
{'acc': 0.9695615, 'precision': 0.8183652, 'recall': 0.609964, 'specificity': 0.609964, 'f1': 0.659654, 'auroc': 0.94452274, 'binary_precision': 0.6635945, 'binary_recall': 0.22395024, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.33488372}
confusion matrix:
       0    1
0  18076   73
1    499  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.98091424, 'recall': 0.5440613, 'specificity': 0.5440613, 'f1': 0.57125735, 'auroc': 0.90018076, 'binary_precision': 1.0, 'binary_recall': 0.08812261, 'binary_specificity': 1.0, 'binary_f1_score': 0.16197184}
confusion matrix:
      0   1
0  5997   0
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_25.png
better model found
persisted
after epoch: 25,now: 2024-06-17 00:09:16.810063,epoch time: 0:24:56.438083,used: 10:22:21.659066,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.97084475, 'precision': 0.7932284, 'recall': 0.6822994, 'specificity': 0.6822994, 'f1': 0.72366595, 'auroc': 0.9413148, 'binary_precision': 0.6079734, 'binary_recall': 0.37296197, 'binary_specificity': 0.99163675, 'binary_f1_score': 0.4623158}
confusion matrix:
       0    1
0  41974  354
1    923  549
---- Validation: 
scalar performance:
{'acc': 0.96961474, 'precision': 0.80687225, 'recall': 0.6257427, 'specificity': 0.6257427, 'f1': 0.675347, 'auroc': 0.94476795, 'binary_precision': 0.6395349, 'binary_recall': 0.25660965, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.36625972}
confusion matrix:
       0    1
0  18056   93
1    478  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.98160934, 'recall': 0.56130266, 'specificity': 0.56130266, 'f1': 0.59984744, 'auroc': 0.90022707, 'binary_precision': 1.0, 'binary_recall': 0.12260536, 'binary_specificity': 1.0, 'binary_f1_score': 0.21843004}
confusion matrix:
      0   1
0  5997   0
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_26.png
better model found
persisted
after epoch: 26,now: 2024-06-17 00:34:13.824795,epoch time: 0:24:57.014732,used: 10:47:18.673798,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97075343, 'precision': 0.79074824, 'recall': 0.6849919, 'specificity': 0.6849919, 'f1': 0.7250507, 'auroc': 0.9454703, 'binary_precision': 0.60281384, 'binary_recall': 0.37865397, 'binary_specificity': 0.99132985, 'binary_f1_score': 0.46513566}
confusion matrix:
       0    1
0  41962  367
1    914  557
---- Validation: 
scalar performance:
{'acc': 0.9698808, 'precision': 0.81206214, 'recall': 0.62738055, 'specificity': 0.62738055, 'f1': 0.677841, 'auroc': 0.94426763, 'binary_precision': 0.6498054, 'binary_recall': 0.25972006, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.37111107}
confusion matrix:
       0    1
0  18059   90
1    476  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9813774, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.59051204, 'auroc': 0.8976449, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5997   0
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_27.png
better model found
persisted
after epoch: 27,now: 2024-06-17 00:58:42.088734,epoch time: 0:24:28.263939,used: 11:11:46.937737,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97, 'precision': 0.78727436, 'recall': 0.6605513, 'specificity': 0.6605513, 'f1': 0.70439404, 'auroc': 0.9427887, 'binary_precision': 0.59753084, 'binary_recall': 0.32880434, 'binary_specificity': 0.99229825, 'binary_f1_score': 0.4241893}
confusion matrix:
       0    1
0  42002  326
1    988  484
---- Validation: 
scalar performance:
{'acc': 0.969668, 'precision': 0.82222474, 'recall': 0.609269, 'specificity': 0.609269, 'f1': 0.65929633, 'auroc': 0.94369715, 'binary_precision': 0.6713615, 'binary_recall': 0.22239502, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.33411217}
confusion matrix:
       0    1
0  18079   70
1    500  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.9810685, 'recall': 0.5478927, 'specificity': 0.5478927, 'f1': 0.57776415, 'auroc': 0.89353794, 'binary_precision': 1.0, 'binary_recall': 0.09578544, 'binary_specificity': 1.0, 'binary_f1_score': 0.17482518}
confusion matrix:
      0   1
0  5997   0
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_28.png
early stop counter: 1
val acc:0.9696679711341858, best validation acc: 0.9698808193206787, corresponding to test acc:                         0.9629274606704712 / 0.9680408835411072
after epoch: 28,now: 2024-06-17 01:23:14.352284,epoch time: 0:24:32.263550,used: 11:36:19.201287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97050226, 'precision': 0.7866967, 'recall': 0.6876958, 'specificity': 0.6876958, 'f1': 0.72591406, 'auroc': 0.9409311, 'binary_precision': 0.5945378, 'binary_recall': 0.38451087, 'binary_specificity': 0.9908807, 'binary_f1_score': 0.4669967}
confusion matrix:
       0    1
0  41942  386
1    906  566
---- Validation: 
scalar performance:
{'acc': 0.9698276, 'precision': 0.80576026, 'recall': 0.63485354, 'specificity': 0.63485354, 'f1': 0.6844498, 'auroc': 0.9471035, 'binary_precision': 0.6366907, 'binary_recall': 0.27527216, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.38436478}
confusion matrix:
       0    1
0  18048  101
1    466  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.9684026, 'recall': 0.5688821, 'specificity': 0.5688821, 'f1': 0.6115567, 'auroc': 0.89735293, 'binary_precision': 0.972973, 'binary_recall': 0.13793103, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.24161074}
confusion matrix:
      0   1
0  5996   1
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_29.png
early stop counter: 2
val acc:0.9698275923728943, best validation acc: 0.9698808193206787, corresponding to test acc:                         0.9629274606704712 / 0.9680408835411072
after epoch: 29,now: 2024-06-17 01:48:06.724460,epoch time: 0:24:52.372176,used: 12:01:11.573463,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9711416, 'precision': 0.78983104, 'recall': 0.7080261, 'specificity': 0.7080261, 'f1': 0.741579, 'auroc': 0.9451475, 'binary_precision': 0.5994264, 'binary_recall': 0.4259511, 'binary_specificity': 0.9901011, 'binary_f1_score': 0.4980143}
confusion matrix:
       0    1
0  41909  419
1    845  627
---- Validation: 
scalar performance:
{'acc': 0.9698808, 'precision': 0.80691016, 'recall': 0.6348811, 'specificity': 0.6348811, 'f1': 0.6846726, 'auroc': 0.9455049, 'binary_precision': 0.63898915, 'binary_recall': 0.27527216, 'binary_specificity': 0.99449, 'binary_f1_score': 0.3847826}
confusion matrix:
       0    1
0  18049  100
1    466  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.96883565, 'recall': 0.57079786, 'specificity': 0.57079786, 'f1': 0.61453736, 'auroc': 0.89582855, 'binary_precision': 0.9736842, 'binary_recall': 0.14176245, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.24749163}
confusion matrix:
      0   1
0  5996   1
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_30.png
early stop counter: 3
val acc:0.9698808193206787, best validation acc: 0.9698808193206787, corresponding to test acc:                         0.9629274606704712 / 0.9680408835411072
after epoch: 30,now: 2024-06-17 02:12:57.991600,epoch time: 0:24:51.267140,used: 12:26:02.840603,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:26:02.840603 at 2024-06-17 02:12:57.991600
persisted model performance metric: 

scalar performance:
{'acc': 0.96292746, 'precision': 0.9813774, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.59051204, 'auroc': 0.8976449, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5997   0
1   232  29
oracle model performance metric: 

scalar performance:
{'acc': 0.9680409, 'precision': 0.97600216, 'recall': 0.61869055, 'specificity': 0.61869055, 'f1': 0.68315595, 'auroc': 0.8969722, 'binary_precision': 0.984127, 'binary_recall': 0.23754789, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.38271603}
confusion matrix:
      0   1
0  5996   1
1   199  62
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |  36242 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |  36242 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1428 MiB | 395270 GiB | 395270 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |  35968 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 284057 GiB | 284057 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 283918 GiB | 283918 GiB |
|       from small pool |   8813 KiB |  12610 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   13819 K  |   13818 K  |
|       from large pool |      36    |      76    |    4630 K  |    4630 K  |
|       from small pool |    1242    |    1864    |    9189 K  |    9188 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   13819 K  |   13818 K  |
|       from large pool |      36    |      76    |    4630 K  |    4630 K  |
|       from small pool |    1242    |    1864    |    9189 K  |    9188 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     452    |    7386 K  |    7386 K  |
|       from large pool |       5    |      10    |    1938 K  |    1938 K  |
|       from small pool |      30    |     447    |    5447 K  |    5447 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 395270 GiB | 395270 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |      0 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 284057 GiB | 284057 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 283918 GiB | 283918 GiB |
|       from small pool |      0 KiB |  16408 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13819 K  |   13819 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9189 K  |    9189 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13819 K  |   13819 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9189 K  |    9189 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    7386 K  |    7386 K  |
|       from large pool |       1    |      11    |    1938 K  |    1938 K  |
|       from small pool |       0    |     447    |    5448 K  |    5448 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 395270 GiB | 395270 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |      0 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 284057 GiB | 284057 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 283918 GiB | 283918 GiB |
|       from small pool |      0 KiB |  16408 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13819 K  |   13819 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9189 K  |    9189 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13819 K  |   13819 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9189 K  |    9189 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    7386 K  |    7386 K  |
|       from large pool |       1    |      11    |    1938 K  |    1938 K  |
|       from small pool |       0    |     447    |    5448 K  |    5448 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389

 Experiment start at: 2024-06-17 02:25:23.323482
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.48355022, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163756, 'auroc': 0.6788076, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42359  0
1   1441  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.62435853, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.62554336, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-17 02:50:49.856426,epoch time: 0:25:26.532944,used: 0:25:26.532944,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9671461, 'precision': 0.68360543, 'recall': 0.50066, 'specificity': 0.50066, 'f1': 0.49303496, 'auroc': 0.8312546, 'binary_precision': 0.4, 'binary_recall': 0.0013908206, 'binary_specificity': 0.9999292, 'binary_f1_score': 0.002772003}
confusion matrix:
       0  1
0  42359  3
1   1436  2
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.80272686, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8061688, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_2.png
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 2,now: 2024-06-17 03:15:27.744866,epoch time: 0:24:37.888440,used: 0:50:04.421384,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96678084, 'precision': 0.7076086, 'recall': 0.5236484, 'specificity': 0.5236484, 'f1': 0.53599936, 'auroc': 0.8850823, 'binary_precision': 0.4465409, 'binary_recall': 0.04937413, 'binary_specificity': 0.99792266, 'binary_f1_score': 0.08891672}
confusion matrix:
       0   1
0  42274  88
1   1367  71
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.732391, 'recall': 0.5100137, 'specificity': 0.5100137, 'f1': 0.51082224, 'auroc': 0.8690859, 'binary_precision': 0.5, 'binary_recall': 0.020802377, 'binary_specificity': 0.9992251, 'binary_f1_score': 0.03994294}
confusion matrix:
       0   1
0  18053  14
1    659  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.9795935, 'recall': 0.51346153, 'specificity': 0.51346153, 'f1': 0.5158014, 'auroc': 0.8491777, 'binary_precision': 1.0, 'binary_recall': 0.026923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.05243446}
confusion matrix:
      0  1
0  5946  0
1   253  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_3.png
new oracle model saved
early stop counter: 2
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9592329859733582
after epoch: 3,now: 2024-06-17 03:40:17.895362,epoch time: 0:24:50.150496,used: 1:14:54.571880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96787673, 'precision': 0.7552929, 'recall': 0.5778712, 'specificity': 0.5778712, 'f1': 0.6153896, 'auroc': 0.90063936, 'binary_precision': 0.53846157, 'binary_recall': 0.16041666, 'binary_specificity': 0.9953258, 'binary_f1_score': 0.24719101}
confusion matrix:
       0    1
0  42162  198
1   1209  231
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.7604965, 'recall': 0.5367554, 'specificity': 0.5367554, 'f1': 0.5576377, 'auroc': 0.89079535, 'binary_precision': 0.5543478, 'binary_recall': 0.075780086, 'binary_specificity': 0.9977307, 'binary_f1_score': 0.13333333}
confusion matrix:
       0   1
0  18026  41
1    622  51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.980446, 'recall': 0.5346154, 'specificity': 0.5346154, 'f1': 0.55477625, 'auroc': 0.86256677, 'binary_precision': 1.0, 'binary_recall': 0.06923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.12949641}
confusion matrix:
      0   1
0  5946   0
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-17 04:05:06.887292,epoch time: 0:24:48.991930,used: 1:39:43.563810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96762556, 'precision': 0.74772453, 'recall': 0.5797993, 'specificity': 0.5797993, 'f1': 0.616992, 'auroc': 0.9049765, 'binary_precision': 0.5231788, 'binary_recall': 0.1646977, 'binary_specificity': 0.99490094, 'binary_f1_score': 0.25052854}
confusion matrix:
       0    1
0  42145  216
1   1202  237
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.7501118, 'recall': 0.5402487, 'specificity': 0.5402487, 'f1': 0.5629064, 'auroc': 0.89916265, 'binary_precision': 0.53333336, 'binary_recall': 0.08320951, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.14395887}
confusion matrix:
       0   1
0  18018  49
1    617  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.9805237, 'recall': 0.5365385, 'specificity': 0.5365385, 'f1': 0.55816877, 'auroc': 0.8644134, 'binary_precision': 1.0, 'binary_recall': 0.073076926, 'binary_specificity': 1.0, 'binary_f1_score': 0.13620071}
confusion matrix:
      0   1
0  5946   0
1   241  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_5.png
new oracle model saved
early stop counter: 1
val acc:0.9644610285758972, best validation acc: 0.9646211266517639, corresponding to test acc:                         0.961005449295044 / 0.9611666202545166
after epoch: 5,now: 2024-06-17 04:30:25.847491,epoch time: 0:25:18.960199,used: 2:05:02.524009,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9676712, 'precision': 0.74683535, 'recall': 0.606611, 'specificity': 0.606611, 'f1': 0.64635825, 'auroc': 0.9129058, 'binary_precision': 0.51967216, 'binary_recall': 0.22013889, 'binary_specificity': 0.9930831, 'binary_f1_score': 0.3092683}
confusion matrix:
       0    1
0  42067  293
1   1123  317
---- Validation: 
scalar performance:
{'acc': 0.9653682, 'precision': 0.7758299, 'recall': 0.5607466, 'specificity': 0.5607466, 'f1': 0.5939643, 'auroc': 0.90732193, 'binary_precision': 0.5833333, 'binary_recall': 0.124814264, 'binary_specificity': 0.996679, 'binary_f1_score': 0.20563035}
confusion matrix:
       0   1
0  18007  60
1    589  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.98075676, 'recall': 0.5423077, 'specificity': 0.5423077, 'f1': 0.5682038, 'auroc': 0.86780816, 'binary_precision': 1.0, 'binary_recall': 0.08461539, 'binary_specificity': 1.0, 'binary_f1_score': 0.15602838}
confusion matrix:
      0   1
0  5946   0
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-17 04:55:16.885285,epoch time: 0:24:51.037794,used: 2:29:53.561803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96803653, 'precision': 0.752958, 'recall': 0.6138436, 'specificity': 0.6138436, 'f1': 0.6546283, 'auroc': 0.9171471, 'binary_precision': 0.5314465, 'binary_recall': 0.23472223, 'binary_specificity': 0.99296504, 'binary_f1_score': 0.3256262}
confusion matrix:
       0    1
0  42062  298
1   1102  338
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.77316606, 'recall': 0.58165544, 'specificity': 0.58165544, 'f1': 0.621253, 'auroc': 0.91481495, 'binary_precision': 0.57653064, 'binary_recall': 0.1679049, 'binary_specificity': 0.995406, 'binary_f1_score': 0.26006904}
confusion matrix:
       0    1
0  17984   83
1    560  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.9813016, 'recall': 0.5557692, 'specificity': 0.5557692, 'f1': 0.59081864, 'auroc': 0.8765964, 'binary_precision': 1.0, 'binary_recall': 0.11153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.20069206}
confusion matrix:
      0   1
0  5946   0
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-17 05:19:56.995520,epoch time: 0:24:40.110235,used: 2:54:33.672038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9683105, 'precision': 0.7625427, 'recall': 0.59514564, 'specificity': 0.59514564, 'f1': 0.6363642, 'auroc': 0.9217719, 'binary_precision': 0.5518591, 'binary_recall': 0.19569743, 'binary_specificity': 0.99459386, 'binary_f1_score': 0.2889344}
confusion matrix:
       0    1
0  42130  229
1   1159  282
---- Validation: 
scalar performance:
{'acc': 0.9654749, 'precision': 0.79285365, 'recall': 0.5493577, 'specificity': 0.5493577, 'f1': 0.57803005, 'auroc': 0.91377795, 'binary_precision': 0.6181818, 'binary_recall': 0.10104012, 'binary_specificity': 0.9976753, 'binary_f1_score': 0.17369093}
confusion matrix:
       0   1
0  18025  42
1    605  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.87143326, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_8.png
early stop counter: 1
val acc:0.9654749035835266, best validation acc: 0.9656883478164673, corresponding to test acc:                         0.9627779722213745 / 0.9627779722213745
after epoch: 8,now: 2024-06-17 05:44:25.767385,epoch time: 0:24:28.771865,used: 3:19:02.443903,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96776253, 'precision': 0.7469455, 'recall': 0.6355042, 'specificity': 0.6355042, 'f1': 0.6734265, 'auroc': 0.92492473, 'binary_precision': 0.5179949, 'binary_recall': 0.27986112, 'binary_specificity': 0.9911473, 'binary_f1_score': 0.36339048}
confusion matrix:
       0    1
0  41985  375
1   1037  403
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.7996299, 'recall': 0.592278, 'specificity': 0.592278, 'f1': 0.6366604, 'auroc': 0.9223196, 'binary_precision': 0.6287129, 'binary_recall': 0.18870728, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.2902857}
confusion matrix:
       0    1
0  17992   75
1    546  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.98114586, 'recall': 0.5519231, 'specificity': 0.5519231, 'f1': 0.58446836, 'auroc': 0.8812033, 'binary_precision': 1.0, 'binary_recall': 0.103846155, 'binary_specificity': 1.0, 'binary_f1_score': 0.18815331}
confusion matrix:
      0   1
0  5946   0
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_9.png
better model found
persisted
after epoch: 9,now: 2024-06-17 06:09:16.558566,epoch time: 0:24:50.791181,used: 3:43:53.235084,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96812785, 'precision': 0.7519128, 'recall': 0.642066, 'specificity': 0.642066, 'f1': 0.6802157, 'auroc': 0.92943954, 'binary_precision': 0.5275, 'binary_recall': 0.29305556, 'binary_specificity': 0.99107647, 'binary_f1_score': 0.37678573}
confusion matrix:
       0    1
0  41982  378
1   1018  422
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.7996299, 'recall': 0.592278, 'specificity': 0.592278, 'f1': 0.6366604, 'auroc': 0.923663, 'binary_precision': 0.6287129, 'binary_recall': 0.18870728, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.2902857}
confusion matrix:
       0    1
0  17992   75
1    546  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.9812237, 'recall': 0.5538462, 'specificity': 0.5538462, 'f1': 0.5876544, 'auroc': 0.88410926, 'binary_precision': 1.0, 'binary_recall': 0.10769231, 'binary_specificity': 1.0, 'binary_f1_score': 0.19444443}
confusion matrix:
      0   1
0  5946   0
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_10.png
early stop counter: 1
val acc:0.9668623208999634, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.962455689907074 / 0.9627779722213745
after epoch: 10,now: 2024-06-17 06:34:06.964250,epoch time: 0:24:50.405684,used: 4:08:43.640768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96888125, 'precision': 0.76828194, 'recall': 0.6150919, 'specificity': 0.6150919, 'f1': 0.6584565, 'auroc': 0.9271574, 'binary_precision': 0.56198347, 'binary_recall': 0.2364395, 'binary_specificity': 0.9937444, 'binary_f1_score': 0.33284387}
confusion matrix:
       0    1
0  42097  265
1   1098  340
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.80653596, 'recall': 0.57494557, 'specificity': 0.57494557, 'f1': 0.61509484, 'auroc': 0.923194, 'binary_precision': 0.64375, 'binary_recall': 0.15304606, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.24729891}
confusion matrix:
       0    1
0  18010   57
1    570  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.98067904, 'recall': 0.5403846, 'specificity': 0.5403846, 'f1': 0.56488234, 'auroc': 0.88291967, 'binary_precision': 1.0, 'binary_recall': 0.08076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.1494662}
confusion matrix:
      0   1
0  5946   0
1   239  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_11.png
early stop counter: 2
val acc:0.9665421843528748, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.962455689907074 / 0.9627779722213745
after epoch: 11,now: 2024-06-17 06:59:27.482328,epoch time: 0:25:20.518078,used: 4:34:04.158846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96890414, 'precision': 0.76692307, 'recall': 0.6272944, 'specificity': 0.6272944, 'f1': 0.67019993, 'auroc': 0.9309945, 'binary_precision': 0.5585185, 'binary_recall': 0.26162386, 'binary_specificity': 0.9929649, 'binary_f1_score': 0.3563327}
confusion matrix:
       0    1
0  42061  298
1   1064  377
---- Validation: 
scalar performance:
{'acc': 0.9660619, 'precision': 0.79415417, 'recall': 0.56968963, 'specificity': 0.56968963, 'f1': 0.60726583, 'auroc': 0.92557895, 'binary_precision': 0.61935484, 'binary_recall': 0.14264487, 'binary_specificity': 0.9967344, 'binary_f1_score': 0.23188405}
confusion matrix:
       0   1
0  18008  59
1    577  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.9806014, 'recall': 0.53846157, 'specificity': 0.53846157, 'f1': 0.5615374, 'auroc': 0.8843533, 'binary_precision': 1.0, 'binary_recall': 0.07692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.14285713}
confusion matrix:
      0   1
0  5946   0
1   240  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_12.png
early stop counter: 3
val acc:0.9660618901252747, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.962455689907074 / 0.9627779722213745
after epoch: 12,now: 2024-06-17 07:24:37.469813,epoch time: 0:25:09.987485,used: 4:59:14.146331,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9694749, 'precision': 0.7718678, 'recall': 0.6442864, 'specificity': 0.6442864, 'f1': 0.6867826, 'auroc': 0.9339991, 'binary_precision': 0.5672437, 'binary_recall': 0.29624477, 'binary_specificity': 0.99232805, 'binary_f1_score': 0.3892188}
confusion matrix:
       0    1
0  42037  325
1   1012  426
---- Validation: 
scalar performance:
{'acc': 0.9669691, 'precision': 0.8076782, 'recall': 0.5873265, 'specificity': 0.5873265, 'f1': 0.6312459, 'auroc': 0.9274469, 'binary_precision': 0.6451613, 'binary_recall': 0.17830609, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.27939463}
confusion matrix:
       0    1
0  18001   66
1    553  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.98083454, 'recall': 0.54423076, 'specificity': 0.54423076, 'f1': 0.5715021, 'auroc': 0.8885424, 'binary_precision': 1.0, 'binary_recall': 0.08846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.16254418}
confusion matrix:
      0   1
0  5946   0
1   237  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_13.png
better model found
persisted
after epoch: 13,now: 2024-06-17 07:49:48.203209,epoch time: 0:25:10.733396,used: 5:24:24.879727,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9683105, 'precision': 0.75536436, 'recall': 0.637378, 'specificity': 0.637378, 'f1': 0.6769911, 'auroc': 0.9324138, 'binary_precision': 0.5347313, 'binary_recall': 0.28313673, 'binary_specificity': 0.9916192, 'binary_f1_score': 0.37023592}
confusion matrix:
       0    1
0  42004  355
1   1033  408
---- Validation: 
scalar performance:
{'acc': 0.9669691, 'precision': 0.8034315, 'recall': 0.5916181, 'specificity': 0.5916181, 'f1': 0.6362071, 'auroc': 0.92803454, 'binary_precision': 0.6363636, 'binary_recall': 0.1872214, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.2893226}
confusion matrix:
       0    1
0  17995   72
1    547  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.98067904, 'recall': 0.5403846, 'specificity': 0.5403846, 'f1': 0.56488234, 'auroc': 0.8879509, 'binary_precision': 1.0, 'binary_recall': 0.08076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.1494662}
confusion matrix:
      0   1
0  5946   0
1   239  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_14.png
early stop counter: 1
val acc:0.9669690728187561, best validation acc: 0.9669690728187561, corresponding to test acc:                         0.9618111252784729 / 0.9627779722213745
after epoch: 14,now: 2024-06-17 08:14:33.392559,epoch time: 0:24:45.189350,used: 5:49:10.069077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9693607, 'precision': 0.7702727, 'recall': 0.6460576, 'specificity': 0.6460576, 'f1': 0.6879719, 'auroc': 0.9320965, 'binary_precision': 0.56396866, 'binary_recall': 0.3, 'binary_specificity': 0.9921152, 'binary_f1_score': 0.3916591}
confusion matrix:
       0    1
0  42026  334
1   1008  432
---- Validation: 
scalar performance:
{'acc': 0.96734256, 'precision': 0.8105307, 'recall': 0.5961034, 'specificity': 0.5961034, 'f1': 0.64232516, 'auroc': 0.9311662, 'binary_precision': 0.6502463, 'binary_recall': 0.1961367, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.30136985}
confusion matrix:
       0    1
0  17996   71
1    541  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.98067904, 'recall': 0.5403846, 'specificity': 0.5403846, 'f1': 0.56488234, 'auroc': 0.88861805, 'binary_precision': 1.0, 'binary_recall': 0.08076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.1494662}
confusion matrix:
      0   1
0  5946   0
1   239  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_15.png
better model found
persisted
after epoch: 15,now: 2024-06-17 08:39:26.110859,epoch time: 0:24:52.718300,used: 6:14:02.787377,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9693379, 'precision': 0.76827043, 'recall': 0.6560087, 'specificity': 0.6560087, 'f1': 0.6959244, 'auroc': 0.9386723, 'binary_precision': 0.55932206, 'binary_recall': 0.32061067, 'binary_specificity': 0.9914068, 'binary_f1_score': 0.4075871}
confusion matrix:
       0    1
0  41995  364
1    979  462
---- Validation: 
scalar performance:
{'acc': 0.96755606, 'precision': 0.8055857, 'recall': 0.6083737, 'specificity': 0.6083737, 'f1': 0.65614724, 'auroc': 0.9332471, 'binary_precision': 0.639485, 'binary_recall': 0.22139673, 'binary_specificity': 0.99535066, 'binary_f1_score': 0.3289183}
confusion matrix:
       0    1
0  17983   84
1    524  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.98075676, 'recall': 0.5423077, 'specificity': 0.5423077, 'f1': 0.5682038, 'auroc': 0.8917506, 'binary_precision': 1.0, 'binary_recall': 0.08461539, 'binary_specificity': 1.0, 'binary_f1_score': 0.15602838}
confusion matrix:
      0   1
0  5946   0
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_16.png
better model found
persisted
after epoch: 16,now: 2024-06-17 09:04:15.713225,epoch time: 0:24:49.602366,used: 6:38:52.389743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.969726, 'precision': 0.7769426, 'recall': 0.6451485, 'specificity': 0.6451485, 'f1': 0.6886666, 'auroc': 0.9384028, 'binary_precision': 0.57738894, 'binary_recall': 0.2977099, 'binary_specificity': 0.99258715, 'binary_f1_score': 0.39285716}
confusion matrix:
       0    1
0  42045  314
1   1012  429
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.80673087, 'recall': 0.5814937, 'specificity': 0.5814937, 'f1': 0.62372816, 'auroc': 0.9321839, 'binary_precision': 0.6436782, 'binary_recall': 0.16641901, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.2644628}
confusion matrix:
       0    1
0  18005   62
1    561  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.980446, 'recall': 0.5346154, 'specificity': 0.5346154, 'f1': 0.55477625, 'auroc': 0.89102435, 'binary_precision': 1.0, 'binary_recall': 0.06923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.12949641}
confusion matrix:
      0   1
0  5946   0
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_17.png
early stop counter: 1
val acc:0.9667556285858154, best validation acc: 0.9675560593605042, corresponding to test acc:                         0.961650013923645 / 0.9627779722213745
after epoch: 17,now: 2024-06-17 09:29:14.161568,epoch time: 0:24:58.448343,used: 7:03:50.838086,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9699315, 'precision': 0.78062046, 'recall': 0.64366937, 'specificity': 0.64366937, 'f1': 0.6881354, 'auroc': 0.9374865, 'binary_precision': 0.5848276, 'binary_recall': 0.29444444, 'binary_specificity': 0.99289423, 'binary_f1_score': 0.3916859}
confusion matrix:
       0    1
0  42059  301
1   1016  424
---- Validation: 
scalar performance:
{'acc': 0.9671825, 'precision': 0.81310844, 'recall': 0.5888677, 'specificity': 0.5888677, 'f1': 0.6336288, 'auroc': 0.93307805, 'binary_precision': 0.65591395, 'binary_recall': 0.18127786, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.2840512}
confusion matrix:
       0    1
0  18003   64
1    551  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.89031297, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_18.png
early stop counter: 2
val acc:0.9671825170516968, best validation acc: 0.9675560593605042, corresponding to test acc:                         0.961650013923645 / 0.9627779722213745
after epoch: 18,now: 2024-06-17 09:54:21.959038,epoch time: 0:25:07.797470,used: 7:28:58.635556,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96899545, 'precision': 0.766689, 'recall': 0.63412905, 'specificity': 0.63412905, 'f1': 0.67653316, 'auroc': 0.93950737, 'binary_precision': 0.5575843, 'binary_recall': 0.27569443, 'binary_specificity': 0.9925637, 'binary_f1_score': 0.3689591}
confusion matrix:
       0    1
0  42045  315
1   1043  397
---- Validation: 
scalar performance:
{'acc': 0.96766275, 'precision': 0.8180008, 'recall': 0.59841526, 'specificity': 0.59841526, 'f1': 0.6458318, 'auroc': 0.9342087, 'binary_precision': 0.66502464, 'binary_recall': 0.20059435, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.30821916}
confusion matrix:
       0    1
0  17999   68
1    538  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.89082885, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_19.png
better model found
persisted
after epoch: 19,now: 2024-06-17 10:20:20.529242,epoch time: 0:25:58.570204,used: 7:54:57.205760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.969863, 'precision': 0.7714167, 'recall': 0.6800778, 'specificity': 0.6800778, 'f1': 0.7156412, 'auroc': 0.942472, 'binary_precision': 0.56402117, 'binary_recall': 0.36988202, 'binary_specificity': 0.9902736, 'binary_f1_score': 0.44677284}
confusion matrix:
       0    1
0  41947  412
1    908  533
---- Validation: 
scalar performance:
{'acc': 0.9686233, 'precision': 0.8123501, 'recall': 0.63324624, 'specificity': 0.63324624, 'f1': 0.6837748, 'auroc': 0.93481714, 'binary_precision': 0.65124553, 'binary_recall': 0.27191678, 'binary_specificity': 0.99457574, 'binary_f1_score': 0.38364777}
confusion matrix:
       0    1
0  17969   98
1    490  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.9816135, 'recall': 0.56346154, 'specificity': 0.56346154, 'f1': 0.60326254, 'auroc': 0.8923976, 'binary_precision': 1.0, 'binary_recall': 0.12692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.22525598}
confusion matrix:
      0   1
0  5946   0
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_20.png
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-06-17 10:46:22.265285,epoch time: 0:26:01.736043,used: 8:20:58.941803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97041094, 'precision': 0.7846327, 'recall': 0.6560916, 'specificity': 0.6560916, 'f1': 0.699992, 'auroc': 0.9404074, 'binary_precision': 0.5920206, 'binary_recall': 0.31966645, 'binary_specificity': 0.9925167, 'binary_f1_score': 0.41516247}
confusion matrix:
       0    1
0  42044  317
1    979  460
---- Validation: 
scalar performance:
{'acc': 0.9677161, 'precision': 0.81232023, 'recall': 0.60559565, 'specificity': 0.60559565, 'f1': 0.6537428, 'auroc': 0.93574786, 'binary_precision': 0.6531532, 'binary_recall': 0.2154532, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.32402235}
confusion matrix:
       0    1
0  17990   77
1    528  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.980446, 'recall': 0.5346154, 'specificity': 0.5346154, 'f1': 0.55477625, 'auroc': 0.8916625, 'binary_precision': 1.0, 'binary_recall': 0.06923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.12949641}
confusion matrix:
      0   1
0  5946   0
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_21.png
early stop counter: 1
val acc:0.9677160978317261, best validation acc: 0.9686232805252075, corresponding to test acc:                         0.9634224772453308 / 0.9634224772453308
after epoch: 21,now: 2024-06-17 11:10:54.446451,epoch time: 0:24:32.181166,used: 8:45:31.122969,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97075343, 'precision': 0.78750265, 'recall': 0.6667959, 'specificity': 0.6667959, 'f1': 0.7097128, 'auroc': 0.94504356, 'binary_precision': 0.5970874, 'binary_recall': 0.34142956, 'binary_specificity': 0.9921622, 'binary_f1_score': 0.43443707}
confusion matrix:
       0    1
0  42027  332
1    949  492
---- Validation: 
scalar performance:
{'acc': 0.9684632, 'precision': 0.810898, 'recall': 0.6303022, 'specificity': 0.6303022, 'f1': 0.68053055, 'auroc': 0.93551767, 'binary_precision': 0.64855075, 'binary_recall': 0.26597324, 'binary_specificity': 0.9946311, 'binary_f1_score': 0.3772392}
confusion matrix:
       0    1
0  17970   97
1    494  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.9809902, 'recall': 0.5480769, 'specificity': 0.5480769, 'f1': 0.57803017, 'auroc': 0.89394146, 'binary_precision': 1.0, 'binary_recall': 0.09615385, 'binary_specificity': 1.0, 'binary_f1_score': 0.1754386}
confusion matrix:
      0   1
0  5946   0
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_22.png
early stop counter: 2
val acc:0.9684631824493408, best validation acc: 0.9686232805252075, corresponding to test acc:                         0.9634224772453308 / 0.9634224772453308
after epoch: 22,now: 2024-06-17 11:35:59.696075,epoch time: 0:25:05.249624,used: 9:10:36.372593,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9694521, 'precision': 0.7705095, 'recall': 0.65338635, 'specificity': 0.65338635, 'f1': 0.69429916, 'auroc': 0.94170046, 'binary_precision': 0.56397516, 'binary_recall': 0.31505898, 'binary_specificity': 0.9917137, 'binary_f1_score': 0.40427426}
confusion matrix:
       0    1
0  42008  351
1    987  454
---- Validation: 
scalar performance:
{'acc': 0.96792954, 'precision': 0.81102705, 'recall': 0.61357427, 'specificity': 0.61357427, 'f1': 0.6626475, 'auroc': 0.93588424, 'binary_precision': 0.65, 'binary_recall': 0.23179792, 'binary_specificity': 0.99535066, 'binary_f1_score': 0.34173054}
confusion matrix:
       0    1
0  17983   84
1    517  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.9806014, 'recall': 0.53846157, 'specificity': 0.53846157, 'f1': 0.5615374, 'auroc': 0.8918766, 'binary_precision': 1.0, 'binary_recall': 0.07692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.14285713}
confusion matrix:
      0   1
0  5946   0
1   240  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_23.png
early stop counter: 3
val acc:0.9679295420646667, best validation acc: 0.9686232805252075, corresponding to test acc:                         0.9634224772453308 / 0.9634224772453308
after epoch: 23,now: 2024-06-17 12:00:36.230030,epoch time: 0:24:36.533955,used: 9:35:12.906548,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97009134, 'precision': 0.7817476, 'recall': 0.65127474, 'specificity': 0.65127474, 'f1': 0.69514287, 'auroc': 0.94253445, 'binary_precision': 0.5866142, 'binary_recall': 0.30998614, 'binary_specificity': 0.99256337, 'binary_f1_score': 0.40562612}
confusion matrix:
       0    1
0  42043  315
1    995  447
---- Validation: 
scalar performance:
{'acc': 0.96824974, 'precision': 0.82005775, 'recall': 0.61302507, 'specificity': 0.61302507, 'f1': 0.6631367, 'auroc': 0.9353936, 'binary_precision': 0.66810346, 'binary_recall': 0.23031203, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.34254143}
confusion matrix:
       0    1
0  17990   77
1    518  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.9809902, 'recall': 0.5480769, 'specificity': 0.5480769, 'f1': 0.57803017, 'auroc': 0.8932524, 'binary_precision': 1.0, 'binary_recall': 0.09615385, 'binary_specificity': 1.0, 'binary_f1_score': 0.1754386}
confusion matrix:
      0   1
0  5946   0
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_24.png
early stop counter: 4
val acc:0.9682497382164001, best validation acc: 0.9686232805252075, corresponding to test acc:                         0.9634224772453308 / 0.9634224772453308
after epoch: 24,now: 2024-06-17 12:25:31.902492,epoch time: 0:24:55.672462,used: 10:00:08.579010,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9713014, 'precision': 0.80257714, 'recall': 0.65333694, 'specificity': 0.65333694, 'f1': 0.701537, 'auroc': 0.94265914, 'binary_precision': 0.6281337, 'binary_recall': 0.3129771, 'binary_specificity': 0.99369675, 'binary_f1_score': 0.417786}
confusion matrix:
       0    1
0  42092  267
1    990  451
---- Validation: 
scalar performance:
{'acc': 0.96739596, 'precision': 0.81364036, 'recall': 0.5947006, 'specificity': 0.5947006, 'f1': 0.6409088, 'auroc': 0.935328, 'binary_precision': 0.65656567, 'binary_recall': 0.19316493, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.29850748}
confusion matrix:
       0    1
0  17999   68
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.980446, 'recall': 0.5346154, 'specificity': 0.5346154, 'f1': 0.55477625, 'auroc': 0.88997984, 'binary_precision': 1.0, 'binary_recall': 0.06923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.12949641}
confusion matrix:
      0   1
0  5946   0
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_25.png
early stop counter: 5
val acc:0.9673959612846375, best validation acc: 0.9686232805252075, corresponding to test acc:                         0.9634224772453308 / 0.9634224772453308
after epoch: 25,now: 2024-06-17 12:50:31.567756,epoch time: 0:24:59.665264,used: 10:25:08.244274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.97068495, 'precision': 0.794574, 'recall': 0.6440588, 'specificity': 0.6440588, 'f1': 0.69136274, 'auroc': 0.9441029, 'binary_precision': 0.61271673, 'binary_recall': 0.29444444, 'binary_specificity': 0.99367326, 'binary_f1_score': 0.3977486}
confusion matrix:
       0    1
0  42092  268
1   1016  424
---- Validation: 
scalar performance:
{'acc': 0.968143, 'precision': 0.8229567, 'recall': 0.6072476, 'specificity': 0.6072476, 'f1': 0.65682495, 'auroc': 0.93644845, 'binary_precision': 0.67431194, 'binary_recall': 0.21842496, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.32996634}
confusion matrix:
       0    1
0  17996   71
1    526  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.980446, 'recall': 0.5346154, 'specificity': 0.5346154, 'f1': 0.55477625, 'auroc': 0.8916217, 'binary_precision': 1.0, 'binary_recall': 0.06923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.12949641}
confusion matrix:
      0   1
0  5946   0
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_26.png
early stop counter: 6
val acc:0.9681429862976074, best validation acc: 0.9686232805252075, corresponding to test acc:                         0.9634224772453308 / 0.9634224772453308
after epoch: 26,now: 2024-06-17 13:15:30.694418,epoch time: 0:24:59.126662,used: 10:50:07.370936,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97041094, 'precision': 0.77652097, 'recall': 0.6886506, 'specificity': 0.6886506, 'f1': 0.72351384, 'auroc': 0.9466789, 'binary_precision': 0.5736354, 'binary_recall': 0.38707435, 'binary_specificity': 0.99022686, 'binary_f1_score': 0.46224067}
confusion matrix:
       0    1
0  41947  414
1    882  557
---- Validation: 
scalar performance:
{'acc': 0.9692636, 'precision': 0.8152498, 'recall': 0.64859897, 'specificity': 0.64859897, 'f1': 0.6994258, 'auroc': 0.9385431, 'binary_precision': 0.6559486, 'binary_recall': 0.30312034, 'binary_specificity': 0.9940776, 'binary_f1_score': 0.41463417}
confusion matrix:
       0    1
0  17960  107
1    469  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.9814575, 'recall': 0.5596154, 'specificity': 0.5596154, 'f1': 0.59708285, 'auroc': 0.89587986, 'binary_precision': 1.0, 'binary_recall': 0.11923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.21305843}
confusion matrix:
      0   1
0  5946   0
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_27.png
better model found
persisted
after epoch: 27,now: 2024-06-17 13:40:38.591819,epoch time: 0:25:07.897401,used: 11:15:15.268337,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.969863, 'precision': 0.77479565, 'recall': 0.66264856, 'specificity': 0.66264856, 'f1': 0.70304424, 'auroc': 0.94346553, 'binary_precision': 0.57193816, 'binary_recall': 0.33379596, 'binary_specificity': 0.9915012, 'binary_f1_score': 0.42156002}
confusion matrix:
       0    1
0  41999  360
1    960  481
---- Validation: 
scalar performance:
{'acc': 0.9694237, 'precision': 0.8328151, 'recall': 0.63151556, 'specificity': 0.63151556, 'f1': 0.68508685, 'auroc': 0.9378483, 'binary_precision': 0.6923077, 'binary_recall': 0.26745912, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.38585207}
confusion matrix:
       0    1
0  17987   80
1    493  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.9805237, 'recall': 0.5365385, 'specificity': 0.5365385, 'f1': 0.55816877, 'auroc': 0.89236605, 'binary_precision': 1.0, 'binary_recall': 0.073076926, 'binary_specificity': 1.0, 'binary_f1_score': 0.13620071}
confusion matrix:
      0   1
0  5946   0
1   241  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_28.png
better model found
persisted
after epoch: 28,now: 2024-06-17 14:06:04.496843,epoch time: 0:25:25.905024,used: 11:40:41.173361,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9712329, 'precision': 0.7918149, 'recall': 0.67318654, 'specificity': 0.67318654, 'f1': 0.7160578, 'auroc': 0.94567835, 'binary_precision': 0.6052319, 'binary_recall': 0.35421017, 'binary_specificity': 0.99216294, 'binary_f1_score': 0.44688323}
confusion matrix:
       0    1
0  42031  332
1    928  509
---- Validation: 
scalar performance:
{'acc': 0.9689968, 'precision': 0.82634556, 'recall': 0.6270026, 'specificity': 0.6270026, 'f1': 0.6793504, 'auroc': 0.93742555, 'binary_precision': 0.6796875, 'binary_recall': 0.25854382, 'binary_specificity': 0.99546134, 'binary_f1_score': 0.37459633}
confusion matrix:
       0    1
0  17985   82
1    499  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.9813795, 'recall': 0.5576923, 'specificity': 0.5576923, 'f1': 0.5939614, 'auroc': 0.8937052, 'binary_precision': 1.0, 'binary_recall': 0.115384616, 'binary_specificity': 1.0, 'binary_f1_score': 0.20689656}
confusion matrix:
      0   1
0  5946   0
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_29.png
early stop counter: 1
val acc:0.9689968228340149, best validation acc: 0.9694237112998962, corresponding to test acc:                         0.9611666202545166 / 0.9634224772453308
after epoch: 29,now: 2024-06-17 14:29:24.177866,epoch time: 0:23:19.681023,used: 12:04:00.854384,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9709589, 'precision': 0.78344613, 'recall': 0.6914945, 'specificity': 0.6914945, 'f1': 0.72775567, 'auroc': 0.9475411, 'binary_precision': 0.58731806, 'binary_recall': 0.3923611, 'binary_specificity': 0.99062794, 'binary_f1_score': 0.47044128}
confusion matrix:
       0    1
0  41963  397
1    875  565
---- Validation: 
scalar performance:
{'acc': 0.9689968, 'precision': 0.8142217, 'recall': 0.6420232, 'specificity': 0.6420232, 'f1': 0.6928669, 'auroc': 0.9387194, 'binary_precision': 0.65436244, 'binary_recall': 0.2897474, 'binary_specificity': 0.994299, 'binary_f1_score': 0.4016478}
confusion matrix:
       0    1
0  17964  103
1    478  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.9813016, 'recall': 0.5557692, 'specificity': 0.5557692, 'f1': 0.59081864, 'auroc': 0.8949135, 'binary_precision': 1.0, 'binary_recall': 0.11153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.20069206}
confusion matrix:
      0   1
0  5946   0
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_30.png
early stop counter: 2
val acc:0.9689968228340149, best validation acc: 0.9694237112998962, corresponding to test acc:                         0.9611666202545166 / 0.9634224772453308
after epoch: 30,now: 2024-06-17 14:55:28.456258,epoch time: 0:26:04.278392,used: 12:30:05.132776,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:30:05.132776 at 2024-06-17 14:55:28.456258
persisted model performance metric: 

scalar performance:
{'acc': 0.9611666, 'precision': 0.9805237, 'recall': 0.5365385, 'specificity': 0.5365385, 'f1': 0.55816877, 'auroc': 0.89236605, 'binary_precision': 1.0, 'binary_recall': 0.073076926, 'binary_specificity': 1.0, 'binary_f1_score': 0.13620071}
confusion matrix:
      0   1
0  5946   0
1   241  19
oracle model performance metric: 

scalar performance:
{'acc': 0.9634225, 'precision': 0.9816135, 'recall': 0.56346154, 'specificity': 0.56346154, 'f1': 0.60326254, 'auroc': 0.8923976, 'binary_precision': 1.0, 'binary_recall': 0.12692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.22525598}
confusion matrix:
      0   1
0  5946   0
1   227  33
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool | 167936 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool | 167936 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1428 MiB |    771 TiB |    771 TiB |
|       from large pool | 165120 KiB |   1358 MiB |    771 TiB |    771 TiB |
|       from small pool |  35966 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   2478 MiB |   1012 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   2374 MiB |    982 MiB |
|       from small pool |     74 MiB |     74 MiB |    104 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 568690 GiB | 568689 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 568413 GiB | 568413 GiB |
|       from small pool |   8813 KiB |  16408 KiB |    276 GiB |    276 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   27640 K  |   27638 K  |
|       from large pool |      36    |      76    |    9260 K  |    9260 K  |
|       from small pool |    1242    |    1864    |   18379 K  |   18378 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   27640 K  |   27638 K  |
|       from large pool |      36    |      76    |    9260 K  |    9260 K  |
|       from small pool |    1242    |    1864    |   18379 K  |   18378 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      68    |      19    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      52    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |     453    |   15732 K  |   15732 K  |
|       from large pool |       5    |      11    |    4128 K  |    4128 K  |
|       from small pool |      31    |     448    |   11604 K  |   11604 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1358 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 568690 GiB | 568690 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 568413 GiB | 568413 GiB |
|       from small pool |      0 KiB |  16408 KiB |    276 GiB |    276 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   27640 K  |   27640 K  |
|       from large pool |       2    |      76    |    9260 K  |    9260 K  |
|       from small pool |       0    |    1864    |   18379 K  |   18379 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   27640 K  |   27640 K  |
|       from large pool |       2    |      76    |    9260 K  |    9260 K  |
|       from small pool |       0    |    1864    |   18379 K  |   18379 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   15733 K  |   15733 K  |
|       from large pool |       1    |      11    |    4128 K  |    4128 K  |
|       from small pool |       0    |     448    |   11604 K  |   11604 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1358 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 568690 GiB | 568690 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 568413 GiB | 568413 GiB |
|       from small pool |      0 KiB |  16408 KiB |    276 GiB |    276 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   27640 K  |   27640 K  |
|       from large pool |       2    |      76    |    9260 K  |    9260 K  |
|       from small pool |       0    |    1864    |   18379 K  |   18379 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   27640 K  |   27640 K  |
|       from large pool |       2    |      76    |    9260 K  |    9260 K  |
|       from small pool |       0    |    1864    |   18379 K  |   18379 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   15733 K  |   15733 K  |
|       from large pool |       1    |      11    |    4128 K  |    4128 K  |
|       from small pool |       0    |     448    |   11604 K  |   11604 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389

 Experiment start at: 2024-06-17 15:07:16.223545
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.6991973, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.64502144, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.6484746, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-17 15:32:16.894950,epoch time: 0:25:00.671405,used: 0:25:00.671405,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96547943, 'precision': 0.71968853, 'recall': 0.50285995, 'specificity': 0.50285995, 'f1': 0.4970988, 'auroc': 0.8553549, 'binary_precision': 0.47368422, 'binary_recall': 0.00595632, 'binary_specificity': 0.99976355, 'binary_f1_score': 0.011764705}
confusion matrix:
       0   1
0  42279  10
1   1502   9
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.83891875, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.80705106, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_2.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-17 15:57:02.271320,epoch time: 0:24:45.376370,used: 0:49:46.047775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.965274, 'precision': 0.72292227, 'recall': 0.5282649, 'specificity': 0.5282649, 'f1': 0.5435306, 'auroc': 0.8869755, 'binary_precision': 0.4784946, 'binary_recall': 0.05882353, 'binary_specificity': 0.9977062, 'binary_f1_score': 0.1047675}
confusion matrix:
       0   1
0  42190  97
1   1424  89
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73424083, 'recall': 0.5088335, 'specificity': 0.5088335, 'f1': 0.5094759, 'auroc': 0.87451774, 'binary_precision': 0.5, 'binary_recall': 0.018272426, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.035256412}
confusion matrix:
       0   1
0  18160  11
1    591  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.9813774, 'recall': 0.5206612, 'specificity': 0.5206612, 'f1': 0.5301945, 'auroc': 0.8461228, 'binary_precision': 1.0, 'binary_recall': 0.041322313, 'binary_specificity': 1.0, 'binary_f1_score': 0.079365075}
confusion matrix:
      0   1
0  5997   0
1   232  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_3.png
new oracle model saved
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9628145694732666
after epoch: 3,now: 2024-06-17 16:20:39.354263,epoch time: 0:23:37.082943,used: 1:13:23.130718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9662329, 'precision': 0.751863, 'recall': 0.5899414, 'specificity': 0.5899414, 'f1': 0.6290344, 'auroc': 0.9011462, 'binary_precision': 0.532197, 'binary_recall': 0.18572372, 'binary_specificity': 0.994159, 'binary_f1_score': 0.27535522}
confusion matrix:
       0    1
0  42040  247
1   1232  281
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.7509637, 'recall': 0.5483755, 'specificity': 0.5483755, 'f1': 0.5758386, 'auroc': 0.8924517, 'binary_precision': 0.53097343, 'binary_recall': 0.09966777, 'binary_specificity': 0.99708325, 'binary_f1_score': 0.16783217}
confusion matrix:
       0   1
0  18118  53
1    542  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.98331726, 'recall': 0.572314, 'specificity': 0.572314, 'f1': 0.61787087, 'auroc': 0.8615316, 'binary_precision': 1.0, 'binary_recall': 0.1446281, 'binary_specificity': 1.0, 'binary_f1_score': 0.25270757}
confusion matrix:
      0   1
0  5997   0
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-17 16:44:54.572471,epoch time: 0:24:15.218208,used: 1:37:38.348926,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96561646, 'precision': 0.73755956, 'recall': 0.5881748, 'specificity': 0.5881748, 'f1': 0.6253081, 'auroc': 0.91118777, 'binary_precision': 0.50364965, 'binary_recall': 0.18278146, 'binary_specificity': 0.99356824, 'binary_f1_score': 0.2682216}
confusion matrix:
       0    1
0  42018  272
1   1234  276
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.75509423, 'recall': 0.55003667, 'specificity': 0.55003667, 'f1': 0.57842064, 'auroc': 0.90224195, 'binary_precision': 0.53913045, 'binary_recall': 0.10299003, 'binary_specificity': 0.99708325, 'binary_f1_score': 0.17294282}
confusion matrix:
       0   1
0  18118  53
1    540  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.98331726, 'recall': 0.572314, 'specificity': 0.572314, 'f1': 0.61787087, 'auroc': 0.86855614, 'binary_precision': 1.0, 'binary_recall': 0.1446281, 'binary_specificity': 1.0, 'binary_f1_score': 0.25270757}
confusion matrix:
      0   1
0  5997   0
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_5.png
better model found
persisted
after epoch: 5,now: 2024-06-17 17:08:50.101336,epoch time: 0:23:55.528865,used: 2:01:33.877791,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9662557, 'precision': 0.7505083, 'recall': 0.6036549, 'specificity': 0.6036549, 'f1': 0.64375293, 'auroc': 0.91636735, 'binary_precision': 0.5285481, 'binary_recall': 0.21414408, 'binary_specificity': 0.99316573, 'binary_f1_score': 0.3047977}
confusion matrix:
       0    1
0  41998  289
1   1189  324
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.75068104, 'recall': 0.55723655, 'specificity': 0.55723655, 'f1': 0.58839893, 'auroc': 0.905583, 'binary_precision': 0.5298507, 'binary_recall': 0.1179402, 'binary_specificity': 0.9965329, 'binary_f1_score': 0.1929348}
confusion matrix:
       0   1
0  18108  63
1    531  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.98347306, 'recall': 0.5764463, 'specificity': 0.5764463, 'f1': 0.6242141, 'auroc': 0.87063813, 'binary_precision': 1.0, 'binary_recall': 0.15289256, 'binary_specificity': 1.0, 'binary_f1_score': 0.26523295}
confusion matrix:
      0   1
0  5997   0
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_6.png
new oracle model saved
early stop counter: 1
val acc:0.9683588147163391, best validation acc: 0.9684121012687683, corresponding to test acc:                         0.9668216109275818 / 0.9671421647071838
after epoch: 6,now: 2024-06-17 17:33:13.829465,epoch time: 0:24:23.728129,used: 2:25:57.605920,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9663242, 'precision': 0.7525583, 'recall': 0.5951401, 'specificity': 0.5951401, 'f1': 0.634925, 'auroc': 0.9188732, 'binary_precision': 0.5332136, 'binary_recall': 0.19642857, 'binary_specificity': 0.99385166, 'binary_f1_score': 0.28709522}
confusion matrix:
       0    1
0  42028  260
1   1215  297
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.76364005, 'recall': 0.56064135, 'specificity': 0.56064135, 'f1': 0.5937903, 'auroc': 0.90863717, 'binary_precision': 0.5555556, 'binary_recall': 0.12458472, 'binary_specificity': 0.996698, 'binary_f1_score': 0.20352781}
confusion matrix:
       0   1
0  18111  60
1    527  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.98331726, 'recall': 0.572314, 'specificity': 0.572314, 'f1': 0.61787087, 'auroc': 0.8753566, 'binary_precision': 1.0, 'binary_recall': 0.1446281, 'binary_specificity': 1.0, 'binary_f1_score': 0.25270757}
confusion matrix:
      0   1
0  5997   0
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_7.png
better model found
persisted
after epoch: 7,now: 2024-06-17 17:57:09.967914,epoch time: 0:23:56.138449,used: 2:49:53.744369,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96643835, 'precision': 0.7518928, 'recall': 0.61751974, 'specificity': 0.61751974, 'f1': 0.6579085, 'auroc': 0.9285429, 'binary_precision': 0.5303468, 'binary_recall': 0.24272487, 'binary_specificity': 0.9923146, 'binary_f1_score': 0.33303088}
confusion matrix:
       0    1
0  41963  325
1   1145  367
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.75710046, 'recall': 0.5734626, 'specificity': 0.5734626, 'f1': 0.6101875, 'auroc': 0.9175123, 'binary_precision': 0.5416667, 'binary_recall': 0.15116279, 'binary_specificity': 0.99576247, 'binary_f1_score': 0.23636363}
confusion matrix:
       0   1
0  18094  77
1    511  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.960524, 'recall': 0.584544, 'specificity': 0.584544, 'f1': 0.63553524, 'auroc': 0.8816416, 'binary_precision': 0.95348835, 'binary_recall': 0.1694215, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.2877193}
confusion matrix:
      0   1
0  5995   2
1   201  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_8.png
new oracle model saved
early stop counter: 1
val acc:0.9686784148216248, best validation acc: 0.968731701374054, corresponding to test acc:                         0.9668216109275818 / 0.9674627184867859
after epoch: 8,now: 2024-06-17 18:20:25.293250,epoch time: 0:23:15.325336,used: 3:13:09.069705,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.75896853, 'recall': 0.64742815, 'specificity': 0.64742815, 'f1': 0.68637997, 'auroc': 0.9298015, 'binary_precision': 0.5424528, 'binary_recall': 0.30403173, 'binary_specificity': 0.9908246, 'binary_f1_score': 0.3896654}
confusion matrix:
       0    1
0  41899  388
1   1053  460
---- Validation: 
scalar performance:
{'acc': 0.9688915, 'precision': 0.76006365, 'recall': 0.5848154, 'specificity': 0.5848154, 'f1': 0.62429667, 'auroc': 0.9200343, 'binary_precision': 0.546875, 'binary_recall': 0.1744186, 'binary_specificity': 0.99521214, 'binary_f1_score': 0.26448363}
confusion matrix:
       0    1
0  18084   87
1    497  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9681039, 'precision': 0.96281576, 'recall': 0.5928085, 'specificity': 0.5928085, 'f1': 0.64754623, 'auroc': 0.8877531, 'binary_precision': 0.9574468, 'binary_recall': 0.18595041, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.31141868}
confusion matrix:
      0   1
0  5995   2
1   197  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_9.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-06-17 18:48:06.165118,epoch time: 0:27:40.871868,used: 3:40:49.941573,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.7568424, 'recall': 0.66845876, 'specificity': 0.66845876, 'f1': 0.70252496, 'auroc': 0.9319891, 'binary_precision': 0.5367347, 'binary_recall': 0.34765366, 'binary_specificity': 0.98926383, 'binary_f1_score': 0.42198154}
confusion matrix:
       0    1
0  41833  454
1    987  526
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.7673882, 'recall': 0.59708124, 'specificity': 0.59708124, 'f1': 0.63921785, 'auroc': 0.9216085, 'binary_precision': 0.5607477, 'binary_recall': 0.19933555, 'binary_specificity': 0.9948269, 'binary_f1_score': 0.29411766}
confusion matrix:
       0    1
0  18077   94
1    482  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96906555, 'precision': 0.9746822, 'recall': 0.60322237, 'specificity': 0.60322237, 'f1': 0.6627289, 'auroc': 0.88506013, 'binary_precision': 0.98039216, 'binary_recall': 0.20661157, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.34129694}
confusion matrix:
      0   1
0  5996   1
1   192  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_10.png
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-06-17 19:15:54.271353,epoch time: 0:27:48.106235,used: 4:08:38.047808,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96737444, 'precision': 0.7615112, 'recall': 0.65499276, 'specificity': 0.65499276, 'f1': 0.6932845, 'auroc': 0.93362796, 'binary_precision': 0.54699886, 'binary_recall': 0.31944445, 'binary_specificity': 0.99054104, 'binary_f1_score': 0.4033403}
confusion matrix:
       0    1
0  41888  400
1   1029  483
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.76903945, 'recall': 0.5922629, 'specificity': 0.5922629, 'f1': 0.6339526, 'auroc': 0.9244764, 'binary_precision': 0.56435645, 'binary_recall': 0.18936877, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.2835821}
confusion matrix:
       0    1
0  18083   88
1    488  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9681039, 'precision': 0.96281576, 'recall': 0.5928085, 'specificity': 0.5928085, 'f1': 0.64754623, 'auroc': 0.8889431, 'binary_precision': 0.9574468, 'binary_recall': 0.18595041, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.31141868}
confusion matrix:
      0   1
0  5995   2
1   197  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_11.png
early stop counter: 1
val acc:0.969317615032196, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9690655469894409 / 0.9690655469894409
after epoch: 11,now: 2024-06-17 19:43:03.827791,epoch time: 0:27:09.556438,used: 4:35:47.604246,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96778536, 'precision': 0.7700883, 'recall': 0.64236593, 'specificity': 0.64236593, 'f1': 0.68458974, 'auroc': 0.9348415, 'binary_precision': 0.565051, 'binary_recall': 0.29279578, 'binary_specificity': 0.991936, 'binary_f1_score': 0.38572052}
confusion matrix:
       0    1
0  41946  341
1   1070  443
---- Validation: 
scalar performance:
{'acc': 0.9692111, 'precision': 0.76737005, 'recall': 0.58899575, 'specificity': 0.58899575, 'f1': 0.6299802, 'auroc': 0.92527056, 'binary_precision': 0.56122446, 'binary_recall': 0.18272425, 'binary_specificity': 0.9952672, 'binary_f1_score': 0.27568924}
confusion matrix:
       0    1
0  18085   86
1    492  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.97150934, 'recall': 0.58256125, 'specificity': 0.58256125, 'f1': 0.6330197, 'auroc': 0.8884819, 'binary_precision': 0.9756098, 'binary_recall': 0.16528925, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.28268552}
confusion matrix:
      0   1
0  5996   1
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_12.png
early stop counter: 2
val acc:0.9692111015319824, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9690655469894409 / 0.9690655469894409
after epoch: 12,now: 2024-06-17 20:09:36.151674,epoch time: 0:26:32.323883,used: 5:02:19.928129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96828765, 'precision': 0.7730016, 'recall': 0.6621618, 'specificity': 0.6621618, 'f1': 0.7021117, 'auroc': 0.93743336, 'binary_precision': 0.5694915, 'binary_recall': 0.33333334, 'binary_specificity': 0.99099034, 'binary_f1_score': 0.42052567}
confusion matrix:
       0    1
0  41907  381
1   1008  504
---- Validation: 
scalar performance:
{'acc': 0.9696905, 'precision': 0.7748438, 'recall': 0.60209215, 'specificity': 0.60209215, 'f1': 0.6457246, 'auroc': 0.92668873, 'binary_precision': 0.5753425, 'binary_recall': 0.20930232, 'binary_specificity': 0.9948819, 'binary_f1_score': 0.30694276}
confusion matrix:
       0    1
0  18078   93
1    476  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9681039, 'precision': 0.98394126, 'recall': 0.588843, 'specificity': 0.588843, 'f1': 0.64271677, 'auroc': 0.8880601, 'binary_precision': 1.0, 'binary_recall': 0.17768595, 'binary_specificity': 1.0, 'binary_f1_score': 0.3017544}
confusion matrix:
      0   1
0  5997   0
1   199  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_13.png
better model found
persisted
after epoch: 13,now: 2024-06-17 20:36:18.126579,epoch time: 0:26:41.974905,used: 5:29:01.903034,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9672146, 'precision': 0.7589575, 'recall': 0.6559612, 'specificity': 0.6559612, 'f1': 0.69339925, 'auroc': 0.9395907, 'binary_precision': 0.54180604, 'binary_recall': 0.3216413, 'binary_specificity': 0.99028116, 'binary_f1_score': 0.40365452}
confusion matrix:
       0    1
0  41878  411
1   1025  486
---- Validation: 
scalar performance:
{'acc': 0.9696373, 'precision': 0.7729373, 'recall': 0.6036707, 'specificity': 0.6036707, 'f1': 0.64720225, 'auroc': 0.9283576, 'binary_precision': 0.5714286, 'binary_recall': 0.21262458, 'binary_specificity': 0.9947169, 'binary_f1_score': 0.30992734}
confusion matrix:
       0    1
0  18075   96
1    474  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.9718777, 'recall': 0.5846274, 'specificity': 0.5846274, 'f1': 0.6360834, 'auroc': 0.8874029, 'binary_precision': 0.97619045, 'binary_recall': 0.1694215, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.28873238}
confusion matrix:
      0   1
0  5996   1
1   201  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_14.png
early stop counter: 1
val acc:0.9696372747421265, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9681038856506348 / 0.9690655469894409
after epoch: 14,now: 2024-06-17 21:00:03.190549,epoch time: 0:23:45.063970,used: 5:52:46.967004,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9681735, 'precision': 0.7730239, 'recall': 0.65445, 'specificity': 0.65445, 'f1': 0.6957319, 'auroc': 0.9377394, 'binary_precision': 0.5700713, 'binary_recall': 0.31746033, 'binary_specificity': 0.99143964, 'binary_f1_score': 0.4078165}
confusion matrix:
       0    1
0  41926  362
1   1032  480
---- Validation: 
scalar performance:
{'acc': 0.9694774, 'precision': 0.7739918, 'recall': 0.59073937, 'specificity': 0.59073937, 'f1': 0.63273084, 'auroc': 0.9296782, 'binary_precision': 0.574359, 'binary_recall': 0.18604651, 'binary_specificity': 0.99543226, 'binary_f1_score': 0.28105393}
confusion matrix:
       0    1
0  18088   83
1    490  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.97072786, 'recall': 0.578429, 'specificity': 0.578429, 'f1': 0.6268276, 'auroc': 0.88642853, 'binary_precision': 0.974359, 'binary_recall': 0.1570248, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.27046263}
confusion matrix:
      0   1
0  5996   1
1   204  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_15.png
early stop counter: 2
val acc:0.9694774150848389, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9681038856506348 / 0.9690655469894409
after epoch: 15,now: 2024-06-17 21:21:57.203662,epoch time: 0:21:54.013113,used: 6:14:40.980117,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96821916, 'precision': 0.7725463, 'recall': 0.661072, 'specificity': 0.661072, 'f1': 0.70110476, 'auroc': 0.93773603, 'binary_precision': 0.56867194, 'binary_recall': 0.3311302, 'binary_specificity': 0.99101377, 'binary_f1_score': 0.41854635}
confusion matrix:
       0    1
0  41907  380
1   1012  501
---- Validation: 
scalar performance:
{'acc': 0.9691046, 'precision': 0.762449, 'recall': 0.5961681, 'specificity': 0.5961681, 'f1': 0.6375809, 'auroc': 0.92954606, 'binary_precision': 0.5509259, 'binary_recall': 0.19767442, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.29095352}
confusion matrix:
       0    1
0  18074   97
1    483  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685847, 'precision': 0.9841757, 'recall': 0.59504133, 'specificity': 0.59504133, 'f1': 0.65168285, 'auroc': 0.8868706, 'binary_precision': 1.0, 'binary_recall': 0.19008264, 'binary_specificity': 1.0, 'binary_f1_score': 0.31944442}
confusion matrix:
      0   1
0  5997   0
1   196  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_16.png
early stop counter: 3
val acc:0.9691045880317688, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9681038856506348 / 0.9690655469894409
after epoch: 16,now: 2024-06-17 21:45:42.960067,epoch time: 0:23:45.756405,used: 6:38:26.736522,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96863014, 'precision': 0.7787304, 'recall': 0.66032887, 'specificity': 0.66032887, 'f1': 0.70206606, 'auroc': 0.9414901, 'binary_precision': 0.5810968, 'binary_recall': 0.3291474, 'binary_specificity': 0.9915104, 'binary_f1_score': 0.42025316}
confusion matrix:
       0    1
0  41928  359
1   1015  498
---- Validation: 
scalar performance:
{'acc': 0.9694774, 'precision': 0.77078855, 'recall': 0.59876984, 'specificity': 0.59876984, 'f1': 0.64152646, 'auroc': 0.9311272, 'binary_precision': 0.5674419, 'binary_recall': 0.2026578, 'binary_specificity': 0.9948819, 'binary_f1_score': 0.2986536}
confusion matrix:
       0    1
0  18078   93
1    480  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.9703125, 'recall': 0.5763629, 'specificity': 0.5763629, 'f1': 0.62369883, 'auroc': 0.8881133, 'binary_precision': 0.9736842, 'binary_recall': 0.15289256, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.2642857}
confusion matrix:
      0   1
0  5996   1
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_17.png
early stop counter: 4
val acc:0.9694774150848389, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9681038856506348 / 0.9690655469894409
after epoch: 17,now: 2024-06-17 22:09:20.716744,epoch time: 0:23:37.756677,used: 7:02:04.493199,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9689726, 'precision': 0.77583694, 'recall': 0.6946013, 'specificity': 0.6946013, 'f1': 0.727509, 'auroc': 0.94409704, 'binary_precision': 0.5729167, 'binary_recall': 0.3998678, 'binary_specificity': 0.98933476, 'binary_f1_score': 0.4710004}
confusion matrix:
       0    1
0  41836  451
1    908  605
---- Validation: 
scalar performance:
{'acc': 0.9694242, 'precision': 0.7627357, 'recall': 0.62524295, 'specificity': 0.62524295, 'f1': 0.6675111, 'auroc': 0.9333046, 'binary_precision': 0.54964536, 'binary_recall': 0.25747508, 'binary_specificity': 0.9930108, 'binary_f1_score': 0.3506787}
confusion matrix:
       0    1
0  18044  127
1    447  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9711492, 'precision': 0.97043085, 'recall': 0.63206464, 'specificity': 0.63206464, 'f1': 0.70039696, 'auroc': 0.8912271, 'binary_precision': 0.969697, 'binary_recall': 0.2644628, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.4155844}
confusion matrix:
      0   1
0  5995   2
1   178  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_18.png
new oracle model saved
early stop counter: 5
val acc:0.9694241881370544, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9681038856506348 / 0.971149206161499
after epoch: 18,now: 2024-06-17 22:34:03.707387,epoch time: 0:24:42.990643,used: 7:26:47.483842,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96968037, 'precision': 0.79839754, 'recall': 0.65354395, 'specificity': 0.65354395, 'f1': 0.7007339, 'auroc': 0.9428204, 'binary_precision': 0.62091506, 'binary_recall': 0.3139458, 'binary_specificity': 0.9931421, 'binary_f1_score': 0.41703248}
confusion matrix:
       0    1
0  41997  290
1   1038  475
---- Validation: 
scalar performance:
{'acc': 0.9693709, 'precision': 0.77684826, 'recall': 0.5786386, 'specificity': 0.5786386, 'f1': 0.61832047, 'auroc': 0.9321835, 'binary_precision': 0.5808383, 'binary_recall': 0.16112956, 'binary_specificity': 0.9961477, 'binary_f1_score': 0.25227565}
confusion matrix:
       0   1
0  18101  70
1    505  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.98285025, 'recall': 0.55991733, 'specificity': 0.55991733, 'f1': 0.59828657, 'auroc': 0.8870065, 'binary_precision': 1.0, 'binary_recall': 0.11983471, 'binary_specificity': 1.0, 'binary_f1_score': 0.21402216}
confusion matrix:
      0   1
0  5997   0
1   213  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_19.png
early stop counter: 6
val acc:0.9693709015846252, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9681038856506348 / 0.971149206161499
after epoch: 19,now: 2024-06-17 22:57:57.771946,epoch time: 0:23:54.064559,used: 7:50:41.548401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9697717, 'precision': 0.78911126, 'recall': 0.68057853, 'specificity': 0.68057853, 'f1': 0.7211369, 'auroc': 0.9433162, 'binary_precision': 0.60042965, 'binary_recall': 0.36995366, 'binary_specificity': 0.99120337, 'binary_f1_score': 0.45782146}
confusion matrix:
       0    1
0  41917  372
1    952  559
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.7648381, 'recall': 0.6059148, 'specificity': 0.6059148, 'f1': 0.64847887, 'auroc': 0.934494, 'binary_precision': 0.55508476, 'binary_recall': 0.21760798, 'binary_specificity': 0.99422157, 'binary_f1_score': 0.31264916}
confusion matrix:
       0    1
0  18066  105
1    471  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.97150934, 'recall': 0.58256125, 'specificity': 0.58256125, 'f1': 0.6330197, 'auroc': 0.8888284, 'binary_precision': 0.9756098, 'binary_recall': 0.16528925, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.28268552}
confusion matrix:
      0   1
0  5996   1
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_20.png
early stop counter: 7
val acc:0.969317615032196, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9681038856506348 / 0.971149206161499
after epoch: 20,now: 2024-06-17 23:23:47.351850,epoch time: 0:25:49.579904,used: 8:16:31.128305,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96968037, 'precision': 0.7917385, 'recall': 0.6701135, 'specificity': 0.6701135, 'f1': 0.71345085, 'auroc': 0.9406734, 'binary_precision': 0.6064442, 'binary_recall': 0.3483146, 'binary_specificity': 0.9919124, 'binary_f1_score': 0.4424853}
confusion matrix:
       0    1
0  41945  342
1    986  527
---- Validation: 
scalar performance:
{'acc': 0.9696905, 'precision': 0.7832471, 'recall': 0.58522815, 'specificity': 0.58522815, 'f1': 0.6270503, 'auroc': 0.93259525, 'binary_precision': 0.59322035, 'binary_recall': 0.1744186, 'binary_specificity': 0.99603766, 'binary_f1_score': 0.2695764}
confusion matrix:
       0    1
0  18099   72
1    497  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.9825394, 'recall': 0.5516529, 'specificity': 0.5516529, 'f1': 0.5847475, 'auroc': 0.8861824, 'binary_precision': 1.0, 'binary_recall': 0.10330579, 'binary_specificity': 1.0, 'binary_f1_score': 0.18726592}
confusion matrix:
      0   1
0  5997   0
1   217  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328389_21.png
early stop counter: 8
val acc:0.9696905016899109, best validation acc: 0.9696905016899109, corresponding to test acc:                         0.9681038856506348 / 0.971149206161499
after epoch: 21,now: 2024-06-17 23:47:53.546890,epoch time: 0:24:06.195040,used: 8:40:37.323345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328389
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
[Mon Jun 17 23:57:57 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/rule_results/0.csv

RuleException:
OSError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[Errno 122] Disk quota exceeded
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 49, in tr_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 68, in after_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 154, in plot_losses
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/matplotlib/pyplot.py", line 1119, in savefig
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/matplotlib/figure.py", line 3390, in savefig
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/matplotlib/backend_bases.py", line 2193, in print_figure
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/matplotlib/backend_bases.py", line 2043, in <lambda>
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/matplotlib/backends/backend_agg.py", line 497, in print_png
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/matplotlib/backends/backend_agg.py", line 446, in _print_pil
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/matplotlib/image.py", line 1656, in imsave
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/PIL/Image.py", line 2462, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
