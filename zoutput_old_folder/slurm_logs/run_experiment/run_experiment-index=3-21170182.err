Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jun  7 01:17:49 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182

 Experiment start at: 2024-06-07 01:24:28.363796
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9706111, 'precision': 0.8463807, 'recall': 0.60152704, 'specificity': 0.60152704, 'f1': 0.6525538, 'auroc': 0.9495009, 'binary_precision': 0.71971494, 'binary_recall': 0.20584239, 'binary_specificity': 0.9972117, 'binary_f1_score': 0.32012677}
confusion matrix:
       0    1
0  42202  118
1   1169  303
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.9555502, 'recall': 0.51319176, 'specificity': 0.51319176, 'f1': 0.517228, 'auroc': 0.9459703, 'binary_precision': 0.9444444, 'binary_recall': 0.02643857, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.051437218}
confusion matrix:
       0   1
0  18148   1
1    626  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.9004331, 'recall': 0.5588867, 'specificity': 0.5588867, 'f1': 0.59436893, 'auroc': 0.9309046, 'binary_precision': 0.8378378, 'binary_recall': 0.118773945, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.20805368}
confusion matrix:
      0   1
0  5991   6
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-07 01:41:57.877010,epoch time: 0:17:29.513214,used: 0:17:29.513214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97111344, 'precision': 0.79202163, 'recall': 0.6988333, 'specificity': 0.6988333, 'f1': 0.7357688, 'auroc': 0.9593805, 'binary_precision': 0.60444, 'binary_recall': 0.40692934, 'binary_specificity': 0.99073726, 'binary_f1_score': 0.4863987}
confusion matrix:
       0    1
0  41928  392
1    873  599
---- Validation: 
scalar performance:
{'acc': 0.97153044, 'precision': 0.81164145, 'recall': 0.68298864, 'specificity': 0.68298864, 'f1': 0.72913826, 'auroc': 0.9587751, 'binary_precision': 0.6451613, 'binary_recall': 0.3732504, 'binary_specificity': 0.99272686, 'binary_f1_score': 0.4729064}
confusion matrix:
       0    1
0  18017  132
1    403  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9742729, 'precision': 0.8993584, 'recall': 0.74287623, 'specificity': 0.74287623, 'f1': 0.800301, 'auroc': 0.94741094, 'binary_precision': 0.82051283, 'binary_recall': 0.49042144, 'binary_specificity': 0.995331, 'binary_f1_score': 0.6139089}
confusion matrix:
      0    1
0  5969   28
1   133  128
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-07 01:58:39.481973,epoch time: 0:16:41.604963,used: 0:34:11.118177,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9754978, 'precision': 0.8257972, 'recall': 0.7648778, 'specificity': 0.7648778, 'f1': 0.79191506, 'auroc': 0.9672537, 'binary_precision': 0.6675084, 'binary_recall': 0.5390891, 'binary_specificity': 0.99066657, 'binary_f1_score': 0.5964648}
confusion matrix:
       0    1
0  41926  395
1    678  793
---- Validation: 
scalar performance:
{'acc': 0.97195613, 'precision': 0.8231087, 'recall': 0.6757085, 'specificity': 0.6757085, 'f1': 0.72582936, 'auroc': 0.9627054, 'binary_precision': 0.6686047, 'binary_recall': 0.3576983, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.4660588}
confusion matrix:
       0    1
0  18035  114
1    413  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697987, 'precision': 0.909021, 'recall': 0.66724837, 'specificity': 0.66724837, 'f1': 0.73331875, 'auroc': 0.949442, 'binary_precision': 0.84615386, 'binary_recall': 0.33716476, 'binary_specificity': 0.997332, 'binary_f1_score': 0.48219177}
confusion matrix:
      0   1
0  5981  16
1   173  88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_3.png
better model found
persisted
after epoch: 3,now: 2024-06-07 02:15:17.003163,epoch time: 0:16:37.521190,used: 0:50:48.639367,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98052156, 'precision': 0.87646425, 'recall': 0.799108, 'specificity': 0.799108, 'f1': 0.83299696, 'auroc': 0.97359324, 'binary_precision': 0.7665805, 'binary_recall': 0.60461956, 'binary_specificity': 0.99359643, 'binary_f1_score': 0.6760349}
confusion matrix:
       0    1
0  42049  271
1    582  890
---- Validation: 
scalar performance:
{'acc': 0.9767454, 'precision': 0.8931958, 'recall': 0.7089402, 'specificity': 0.7089402, 'f1': 0.7708439, 'auroc': 0.96955323, 'binary_precision': 0.80654764, 'binary_recall': 0.4214619, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.5536261}
confusion matrix:
       0    1
0  18084   65
1    372  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694791, 'precision': 0.91420454, 'recall': 0.6597523, 'specificity': 0.6597523, 'f1': 0.72612774, 'auroc': 0.94846916, 'binary_precision': 0.85714287, 'binary_recall': 0.3218391, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.4679666}
confusion matrix:
      0   1
0  5983  14
1   177  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_4.png
better model found
persisted
after epoch: 4,now: 2024-06-07 02:31:54.841873,epoch time: 0:16:37.838710,used: 1:07:26.478077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9811381, 'precision': 0.8985089, 'recall': 0.7833619, 'specificity': 0.7833619, 'f1': 0.83047247, 'auroc': 0.9737063, 'binary_precision': 0.81177604, 'binary_recall': 0.5713315, 'binary_specificity': 0.99539226, 'binary_f1_score': 0.6706539}
confusion matrix:
       0    1
0  42125  195
1    631  841
---- Validation: 
scalar performance:
{'acc': 0.97690505, 'precision': 0.94541, 'recall': 0.67902064, 'specificity': 0.67902064, 'f1': 0.75189775, 'auroc': 0.9727372, 'binary_precision': 0.9130435, 'binary_recall': 0.3592535, 'binary_specificity': 0.9987878, 'binary_f1_score': 0.515625}
confusion matrix:
       0    1
0  18127   22
1    412  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.808851, 'recall': 0.5393127, 'specificity': 0.5393127, 'f1': 0.5614048, 'auroc': 0.9437314, 'binary_precision': 0.65625, 'binary_recall': 0.08045977, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.14334472}
confusion matrix:
      0   1
0  5986  11
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_5.png
better model found
persisted
after epoch: 5,now: 2024-06-07 02:48:35.535537,epoch time: 0:16:40.693664,used: 1:24:07.171741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98166335, 'precision': 0.9037445, 'recall': 0.7878958, 'specificity': 0.7878958, 'f1': 0.8353841, 'auroc': 0.97773737, 'binary_precision': 0.8219442, 'binary_recall': 0.58016306, 'binary_specificity': 0.99562854, 'binary_f1_score': 0.68020713}
confusion matrix:
       0    1
0  42135  185
1    618  854
---- Validation: 
scalar performance:
{'acc': 0.9778097, 'precision': 0.91441953, 'recall': 0.71249145, 'specificity': 0.71249145, 'f1': 0.77869064, 'auroc': 0.9715903, 'binary_precision': 0.84876543, 'binary_recall': 0.42768273, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.5687694}
confusion matrix:
       0    1
0  18100   49
1    368  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.9035577, 'recall': 0.64625895, 'specificity': 0.64625895, 'f1': 0.70994973, 'auroc': 0.94652116, 'binary_precision': 0.8369565, 'binary_recall': 0.29501915, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.4362606}
confusion matrix:
      0   1
0  5982  15
1   184  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_6.png
better model found
persisted
after epoch: 6,now: 2024-06-07 03:05:21.317945,epoch time: 0:16:45.782408,used: 1:40:52.954149,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.983787, 'precision': 0.90001094, 'recall': 0.83456695, 'specificity': 0.83456695, 'f1': 0.86414146, 'auroc': 0.9799048, 'binary_precision': 0.8112745, 'binary_recall': 0.6745924, 'binary_specificity': 0.9945416, 'binary_f1_score': 0.7366469}
confusion matrix:
       0    1
0  42089  231
1    479  993
---- Validation: 
scalar performance:
{'acc': 0.9803108, 'precision': 0.8997232, 'recall': 0.7722906, 'specificity': 0.7722906, 'f1': 0.82299954, 'auroc': 0.9752895, 'binary_precision': 0.81524247, 'binary_recall': 0.5489891, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.65613383}
confusion matrix:
       0    1
0  18069   80
1    290  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.85950965, 'recall': 0.564217, 'specificity': 0.564217, 'f1': 0.60136503, 'auroc': 0.95149124, 'binary_precision': 0.75555557, 'binary_recall': 0.1302682, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.22222222}
confusion matrix:
      0   1
0  5986  11
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_7.png
better model found
persisted
after epoch: 7,now: 2024-06-07 03:21:59.444892,epoch time: 0:16:38.126947,used: 1:57:31.081096,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98287356, 'precision': 0.8950567, 'recall': 0.8225007, 'specificity': 0.8225007, 'f1': 0.85481834, 'auroc': 0.9833733, 'binary_precision': 0.8021794, 'binary_recall': 0.65057784, 'binary_specificity': 0.99442357, 'binary_f1_score': 0.7184685}
confusion matrix:
       0    1
0  42085  236
1    514  957
---- Validation: 
scalar performance:
{'acc': 0.9804172, 'precision': 0.92662424, 'recall': 0.749844, 'specificity': 0.749844, 'f1': 0.813509, 'auroc': 0.9732175, 'binary_precision': 0.87061995, 'binary_recall': 0.5023328, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.6370809}
confusion matrix:
       0    1
0  18101   48
1    320  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.92498577, 'recall': 0.58762234, 'specificity': 0.58762234, 'f1': 0.6379097, 'auroc': 0.95451254, 'binary_precision': 0.88461536, 'binary_recall': 0.17624521, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.2939297}
confusion matrix:
      0   1
0  5991   6
1   215  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_8.png
better model found
persisted
after epoch: 8,now: 2024-06-07 03:38:48.895718,epoch time: 0:16:49.450826,used: 2:14:20.531922,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98479176, 'precision': 0.92488134, 'recall': 0.8242675, 'specificity': 0.8242675, 'f1': 0.86731195, 'auroc': 0.9840028, 'binary_precision': 0.8617594, 'binary_recall': 0.65217394, 'binary_specificity': 0.9963611, 'binary_f1_score': 0.74245936}
confusion matrix:
       0    1
0  42166  154
1    512  960
---- Validation: 
scalar performance:
{'acc': 0.98137504, 'precision': 0.93394697, 'recall': 0.76084065, 'specificity': 0.76084065, 'f1': 0.82431495, 'auroc': 0.97499466, 'binary_precision': 0.88451445, 'binary_recall': 0.5241057, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.6582031}
confusion matrix:
       0    1
0  18105   44
1    306  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.90955055, 'recall': 0.5456435, 'specificity': 0.5456435, 'f1': 0.57318974, 'auroc': 0.9542031, 'binary_precision': 0.85714287, 'binary_recall': 0.09195402, 'binary_specificity': 0.999333, 'binary_f1_score': 0.16608995}
confusion matrix:
      0   1
0  5993   4
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_9.png
better model found
persisted
after epoch: 9,now: 2024-06-07 03:55:36.882722,epoch time: 0:16:47.987004,used: 2:31:08.518926,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9854996, 'precision': 0.8941934, 'recall': 0.87840265, 'specificity': 0.87840265, 'f1': 0.8861232, 'auroc': 0.9846095, 'binary_precision': 0.79659814, 'binary_recall': 0.76358694, 'binary_specificity': 0.99321836, 'binary_f1_score': 0.7797433}
confusion matrix:
       0     1
0  42033   287
1    348  1124
---- Validation: 
scalar performance:
{'acc': 0.9815347, 'precision': 0.8953804, 'recall': 0.8014263, 'specificity': 0.8014263, 'f1': 0.8415649, 'auroc': 0.97362643, 'binary_precision': 0.80452675, 'binary_recall': 0.60808706, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.69264835}
confusion matrix:
       0    1
0  18054   95
1    252  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.8972408, 'recall': 0.6176901, 'specificity': 0.6176901, 'f1': 0.675821, 'auroc': 0.9475924, 'binary_precision': 0.82666665, 'binary_recall': 0.23754789, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.36904758}
confusion matrix:
      0   1
0  5984  13
1   199  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_10.png
better model found
persisted
after epoch: 10,now: 2024-06-07 04:12:27.290471,epoch time: 0:16:50.407749,used: 2:47:58.926675,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98433506, 'precision': 0.87440145, 'recall': 0.8891307, 'specificity': 0.8891307, 'f1': 0.8816115, 'auroc': 0.9847591, 'binary_precision': 0.75620914, 'binary_recall': 0.7870748, 'binary_specificity': 0.9911866, 'binary_f1_score': 0.7713333}
confusion matrix:
       0     1
0  41949   373
1    313  1157
---- Validation: 
scalar performance:
{'acc': 0.9799915, 'precision': 0.8722429, 'recall': 0.8013774, 'specificity': 0.8013774, 'f1': 0.8327696, 'auroc': 0.97188663, 'binary_precision': 0.7582205, 'binary_recall': 0.6096423, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.6758621}
confusion matrix:
       0    1
0  18024  125
1    251  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.8503537, 'recall': 0.64325935, 'specificity': 0.64325935, 'f1': 0.6994544, 'auroc': 0.9525726, 'binary_precision': 0.7307692, 'binary_recall': 0.29118773, 'binary_specificity': 0.995331, 'binary_f1_score': 0.41643834}
confusion matrix:
      0   1
0  5969  28
1   185  76
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_11.png
early stop counter: 1
val acc:0.9799914956092834, best validation acc: 0.9815347194671631, corresponding to test acc:                         0.9661233425140381 / 0.9742729067802429
after epoch: 11,now: 2024-06-07 04:29:05.294208,epoch time: 0:16:38.003737,used: 3:04:36.930412,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9852941, 'precision': 0.95714116, 'recall': 0.8042002, 'specificity': 0.8042002, 'f1': 0.864251, 'auroc': 0.9860704, 'binary_precision': 0.927686, 'binary_recall': 0.6100544, 'binary_specificity': 0.9983459, 'binary_f1_score': 0.7360656}
confusion matrix:
       0    1
0  42250   70
1    574  898
---- Validation: 
scalar performance:
{'acc': 0.97903365, 'precision': 0.9416094, 'recall': 0.7161253, 'specificity': 0.7161253, 'f1': 0.78768945, 'auroc': 0.9713341, 'binary_precision': 0.9029126, 'binary_recall': 0.43390357, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.58613443}
confusion matrix:
       0    1
0  18119   30
1    364  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7293666, 'recall': 0.505497, 'specificity': 0.505497, 'f1': 0.50058204, 'auroc': 0.94503164, 'binary_precision': 0.5, 'binary_recall': 0.011494253, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.022471908}
confusion matrix:
      0  1
0  5994  3
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_12.png
early stop counter: 2
val acc:0.9790336489677429, best validation acc: 0.9815347194671631, corresponding to test acc:                         0.9661233425140381 / 0.9742729067802429
after epoch: 12,now: 2024-06-07 04:45:49.834275,epoch time: 0:16:44.540067,used: 3:21:21.470479,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9868469, 'precision': 0.9438293, 'recall': 0.8416171, 'specificity': 0.8416171, 'f1': 0.8855859, 'auroc': 0.9864251, 'binary_precision': 0.8984862, 'binary_recall': 0.6859279, 'binary_specificity': 0.9973063, 'binary_f1_score': 0.7779491}
confusion matrix:
       0     1
0  42207   114
1    462  1009
---- Validation: 
scalar performance:
{'acc': 0.98334396, 'precision': 0.9364475, 'recall': 0.7926123, 'specificity': 0.7926123, 'f1': 0.8493155, 'auroc': 0.97693324, 'binary_precision': 0.8873239, 'binary_recall': 0.58786935, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.707203}
confusion matrix:
       0    1
0  18101   48
1    265  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.8966157, 'recall': 0.59112024, 'specificity': 0.59112024, 'f1': 0.64132863, 'auroc': 0.9506209, 'binary_precision': 0.82758623, 'binary_recall': 0.18390805, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.30094042}
confusion matrix:
      0   1
0  5987  10
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_13.png
better model found
persisted
after epoch: 13,now: 2024-06-07 05:02:32.409934,epoch time: 0:16:42.575659,used: 3:38:04.046138,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9856595, 'precision': 0.9073632, 'recall': 0.86176455, 'specificity': 0.86176455, 'f1': 0.8831037, 'auroc': 0.985566, 'binary_precision': 0.82411677, 'binary_recall': 0.7289402, 'binary_specificity': 0.99458885, 'binary_f1_score': 0.77361214}
confusion matrix:
       0     1
0  42091   229
1    399  1073
---- Validation: 
scalar performance:
{'acc': 0.98185396, 'precision': 0.88179916, 'recall': 0.8270935, 'specificity': 0.8270935, 'f1': 0.852158, 'auroc': 0.975773, 'binary_precision': 0.77554744, 'binary_recall': 0.66096425, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.7136859}
confusion matrix:
       0    1
0  18026  123
1    218  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.94673413, 'recall': 0.5515574, 'specificity': 0.5515574, 'f1': 0.58345187, 'auroc': 0.94651544, 'binary_precision': 0.9310345, 'binary_recall': 0.10344828, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.18620689}
confusion matrix:
      0   1
0  5995   2
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_14.png
early stop counter: 1
val acc:0.9818539619445801, best validation acc: 0.9833439588546753, corresponding to test acc:                         0.9643656015396118 / 0.9742729067802429
after epoch: 14,now: 2024-06-07 05:19:17.577873,epoch time: 0:16:45.167939,used: 3:54:49.214077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98668706, 'precision': 0.93275356, 'recall': 0.8501654, 'specificity': 0.8501654, 'f1': 0.8867749, 'auroc': 0.9877274, 'binary_precision': 0.87573963, 'binary_recall': 0.7038044, 'binary_specificity': 0.9965265, 'binary_f1_score': 0.7804143}
confusion matrix:
       0     1
0  42173   147
1    436  1036
---- Validation: 
scalar performance:
{'acc': 0.98286504, 'precision': 0.93772054, 'recall': 0.7833637, 'specificity': 0.7833637, 'f1': 0.84284127, 'auroc': 0.97784936, 'binary_precision': 0.890511, 'binary_recall': 0.56920683, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.69449717}
confusion matrix:
       0    1
0  18104   45
1    277  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.9100113, 'recall': 0.5570544, 'specificity': 0.5570544, 'f1': 0.5916951, 'auroc': 0.9534204, 'binary_precision': 0.85714287, 'binary_recall': 0.11494253, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.2027027}
confusion matrix:
      0   1
0  5992   5
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_15.png
early stop counter: 2
val acc:0.982865035533905, best validation acc: 0.9833439588546753, corresponding to test acc:                         0.9643656015396118 / 0.9742729067802429
after epoch: 15,now: 2024-06-07 05:36:03.715258,epoch time: 0:16:46.137385,used: 4:11:35.351462,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9885824, 'precision': 0.9346414, 'recall': 0.8819648, 'specificity': 0.8819648, 'f1': 0.90647304, 'auroc': 0.99025166, 'binary_precision': 0.8773292, 'binary_recall': 0.76766306, 'binary_specificity': 0.99626654, 'binary_f1_score': 0.81884056}
confusion matrix:
       0     1
0  42162   158
1    342  1130
---- Validation: 
scalar performance:
{'acc': 0.9841954, 'precision': 0.9415302, 'recall': 0.80280375, 'specificity': 0.80280375, 'f1': 0.8583046, 'auroc': 0.97916394, 'binary_precision': 0.896789, 'binary_recall': 0.60808706, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.7247451}
confusion matrix:
       0    1
0  18104   45
1    252  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.89589787, 'recall': 0.5816251, 'specificity': 0.5816251, 'f1': 0.6280792, 'auroc': 0.9451436, 'binary_precision': 0.8269231, 'binary_recall': 0.16475096, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.27476037}
confusion matrix:
      0   1
0  5988   9
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_16.png
better model found
persisted
after epoch: 16,now: 2024-06-07 05:52:46.674725,epoch time: 0:16:42.959467,used: 4:28:18.310929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9885367, 'precision': 0.9251416, 'recall': 0.8926892, 'specificity': 0.8926892, 'f1': 0.9082205, 'auroc': 0.99027574, 'binary_precision': 0.85756457, 'binary_recall': 0.7899388, 'binary_specificity': 0.9954396, 'binary_f1_score': 0.82236373}
confusion matrix:
       0     1
0  42128   193
1    309  1162
---- Validation: 
scalar performance:
{'acc': 0.98275864, 'precision': 0.92773676, 'recall': 0.7900591, 'specificity': 0.7900591, 'f1': 0.8447249, 'auroc': 0.9773387, 'binary_precision': 0.8700696, 'binary_recall': 0.58320373, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.6983241}
confusion matrix:
       0    1
0  18093   56
1    268  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8812791, 'recall': 0.55305624, 'specificity': 0.55305624, 'f1': 0.5847746, 'auroc': 0.9493083, 'binary_precision': 0.8, 'binary_recall': 0.107279696, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.1891892}
confusion matrix:
      0   1
0  5990   7
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_17.png
early stop counter: 1
val acc:0.982758641242981, best validation acc: 0.9841954112052917, corresponding to test acc:                         0.9637264013290405 / 0.9742729067802429
after epoch: 17,now: 2024-06-07 06:09:31.925550,epoch time: 0:16:45.250825,used: 4:45:03.561754,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9831933, 'precision': 0.9775974, 'recall': 0.7572129, 'specificity': 0.7572129, 'f1': 0.8322771, 'auroc': 0.9914193, 'binary_precision': 0.97179484, 'binary_recall': 0.5149456, 'binary_specificity': 0.9994801, 'binary_f1_score': 0.6731794}
confusion matrix:
       0    1
0  42298   22
1    714  758
---- Validation: 
scalar performance:
{'acc': 0.9771711, 'precision': 0.9692888, 'recall': 0.67315793, 'specificity': 0.67315793, 'f1': 0.7490139, 'auroc': 0.9788582, 'binary_precision': 0.9612069, 'binary_recall': 0.34681183, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.5097143}
confusion matrix:
       0    1
0  18140    9
1    420  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.88892126, 'recall': 0.51707464, 'specificity': 0.51707464, 'f1': 0.5227158, 'auroc': 0.94501084, 'binary_precision': 0.8181818, 'binary_recall': 0.03448276, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.06617647}
confusion matrix:
      0  1
0  5995  2
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_18.png
early stop counter: 2
val acc:0.9771711230278015, best validation acc: 0.9841954112052917, corresponding to test acc:                         0.9637264013290405 / 0.9742729067802429
after epoch: 18,now: 2024-06-07 06:26:15.248043,epoch time: 0:16:43.322493,used: 5:01:46.884247,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9891076, 'precision': 0.92475355, 'recall': 0.9038116, 'specificity': 0.9038116, 'f1': 0.91399676, 'auroc': 0.99247754, 'binary_precision': 0.8560172, 'binary_recall': 0.81237257, 'binary_specificity': 0.9952506, 'binary_f1_score': 0.833624}
confusion matrix:
       0     1
0  42120   201
1    276  1195
---- Validation: 
scalar performance:
{'acc': 0.9853129, 'precision': 0.91147184, 'recall': 0.8543861, 'specificity': 0.8543861, 'f1': 0.8806299, 'auroc': 0.97960955, 'binary_precision': 0.8330309, 'binary_recall': 0.7138414, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.76884425}
confusion matrix:
       0    1
0  18057   92
1    184  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.9154562, 'recall': 0.53806406, 'specificity': 0.53806406, 'f1': 0.56044865, 'auroc': 0.9364016, 'binary_precision': 0.8695652, 'binary_recall': 0.07662835, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.14084506}
confusion matrix:
      0   1
0  5994   3
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_19.png
better model found
persisted
after epoch: 19,now: 2024-06-07 06:42:40.860954,epoch time: 0:16:25.612911,used: 5:18:12.497158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9873721, 'precision': 0.8871867, 'recall': 0.9314575, 'specificity': 0.9314575, 'f1': 0.9080194, 'auroc': 0.9921688, 'binary_precision': 0.7788578, 'binary_recall': 0.871516, 'binary_specificity': 0.99139905, 'binary_f1_score': 0.8225858}
confusion matrix:
       0     1
0  41957   364
1    189  1282
---- Validation: 
scalar performance:
{'acc': 0.98398256, 'precision': 0.88471234, 'recall': 0.8679484, 'specificity': 0.8679484, 'f1': 0.87612754, 'auroc': 0.9788346, 'binary_precision': 0.77850163, 'binary_recall': 0.7433904, 'binary_specificity': 0.99250644, 'binary_f1_score': 0.76054096}
confusion matrix:
       0    1
0  18013  136
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.87118036, 'recall': 0.59836626, 'specificity': 0.59836626, 'f1': 0.6493472, 'auroc': 0.9592751, 'binary_precision': 0.7761194, 'binary_recall': 0.19923371, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.31707317}
confusion matrix:
      0   1
0  5982  15
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_20.png
early stop counter: 1
val acc:0.9839825630187988, best validation acc: 0.9853128790855408, corresponding to test acc:                         0.9610099196434021 / 0.9742729067802429
after epoch: 20,now: 2024-06-07 06:59:08.013946,epoch time: 0:16:27.152992,used: 5:34:39.650150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9898383, 'precision': 0.94085205, 'recall': 0.8970404, 'specificity': 0.8970404, 'f1': 0.91771245, 'auroc': 0.99331534, 'binary_precision': 0.8887207, 'binary_recall': 0.7975544, 'binary_specificity': 0.9965265, 'binary_f1_score': 0.84067315}
confusion matrix:
       0     1
0  42173   147
1    298  1174
---- Validation: 
scalar performance:
{'acc': 0.9856322, 'precision': 0.92296135, 'recall': 0.84630084, 'specificity': 0.84630084, 'f1': 0.8805126, 'auroc': 0.9790758, 'binary_precision': 0.8565965, 'binary_recall': 0.6967341, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.7684391}
confusion matrix:
       0    1
0  18074   75
1    195  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8947692, 'recall': 0.5455601, 'specificity': 0.5455601, 'f1': 0.5728617, 'auroc': 0.9493267, 'binary_precision': 0.82758623, 'binary_recall': 0.09195402, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.16551723}
confusion matrix:
      0   1
0  5992   5
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_21.png
better model found
persisted
after epoch: 21,now: 2024-06-07 07:15:31.231693,epoch time: 0:16:23.217747,used: 5:51:02.867897,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9891076, 'precision': 0.89969766, 'recall': 0.9438386, 'specificity': 0.9438386, 'f1': 0.92051315, 'auroc': 0.9925307, 'binary_precision': 0.8030488, 'binary_recall': 0.8953093, 'binary_specificity': 0.99236786, 'binary_f1_score': 0.8466732}
confusion matrix:
       0     1
0  41998   323
1    154  1317
---- Validation: 
scalar performance:
{'acc': 0.98483396, 'precision': 0.8854687, 'recall': 0.88489044, 'specificity': 0.88489044, 'f1': 0.88517934, 'auroc': 0.97989225, 'binary_precision': 0.7788162, 'binary_recall': 0.777605, 'binary_specificity': 0.9921759, 'binary_f1_score': 0.7782101}
confusion matrix:
       0    1
0  18007  142
1    143  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.86202884, 'recall': 0.6227702, 'specificity': 0.6227702, 'f1': 0.6784038, 'auroc': 0.9617702, 'binary_precision': 0.75581396, 'binary_recall': 0.24904214, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.37463978}
confusion matrix:
      0   1
0  5976  21
1   196  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_22.png
early stop counter: 1
val acc:0.9848339557647705, best validation acc: 0.9856321811676025, corresponding to test acc:                         0.9613295197486877 / 0.9742729067802429
after epoch: 22,now: 2024-06-07 07:33:21.705865,epoch time: 0:17:50.474172,used: 6:08:53.342069,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9911856, 'precision': 0.94666123, 'recall': 0.9137451, 'specificity': 0.9137451, 'f1': 0.9295249, 'auroc': 0.99405, 'binary_precision': 0.8991906, 'binary_recall': 0.8307274, 'binary_specificity': 0.9967628, 'binary_f1_score': 0.86360425}
confusion matrix:
       0     1
0  42184   137
1    249  1222
---- Validation: 
scalar performance:
{'acc': 0.98499364, 'precision': 0.931568, 'recall': 0.8257187, 'specificity': 0.8257187, 'f1': 0.87068784, 'auroc': 0.9800637, 'binary_precision': 0.8752599, 'binary_recall': 0.6547434, 'binary_specificity': 0.996694, 'binary_f1_score': 0.7491103}
confusion matrix:
       0    1
0  18089   60
1    222  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.838521, 'recall': 0.60161406, 'specificity': 0.60161406, 'f1': 0.650836, 'auroc': 0.94019425, 'binary_precision': 0.7105263, 'binary_recall': 0.20689656, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.32047477}
confusion matrix:
      0   1
0  5975  22
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_23.png
early stop counter: 2
val acc:0.9849936366081238, best validation acc: 0.9856321811676025, corresponding to test acc:                         0.9613295197486877 / 0.9742729067802429
after epoch: 23,now: 2024-06-07 07:49:47.781311,epoch time: 0:16:26.075446,used: 6:25:19.417515,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99095726, 'precision': 0.94508076, 'recall': 0.9117173, 'specificity': 0.9117173, 'f1': 0.9276992, 'auroc': 0.9941559, 'binary_precision': 0.89617085, 'binary_recall': 0.8267663, 'binary_specificity': 0.9966682, 'binary_f1_score': 0.8600707}
confusion matrix:
       0     1
0  42179   141
1    255  1217
---- Validation: 
scalar performance:
{'acc': 0.98435503, 'precision': 0.91301656, 'recall': 0.83438873, 'specificity': 0.83438873, 'f1': 0.86924005, 'auroc': 0.9808375, 'binary_precision': 0.8375242, 'binary_recall': 0.6734059, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.7465517}
confusion matrix:
       0    1
0  18065   84
1    210  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.8852012, 'recall': 0.53223354, 'specificity': 0.53223354, 'f1': 0.550148, 'auroc': 0.9338657, 'binary_precision': 0.8095238, 'binary_recall': 0.0651341, 'binary_specificity': 0.999333, 'binary_f1_score': 0.120567374}
confusion matrix:
      0   1
0  5993   4
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_24.png
early stop counter: 3
val acc:0.9843550324440002, best validation acc: 0.9856321811676025, corresponding to test acc:                         0.9613295197486877 / 0.9742729067802429
after epoch: 24,now: 2024-06-07 08:06:15.997499,epoch time: 0:16:28.216188,used: 6:41:47.633703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98803437, 'precision': 0.8997092, 'recall': 0.9216801, 'specificity': 0.9216801, 'f1': 0.9103757, 'auroc': 0.9932128, 'binary_precision': 0.80462724, 'binary_recall': 0.8505435, 'binary_specificity': 0.9928166, 'binary_f1_score': 0.8269485}
confusion matrix:
       0     1
0  42016   304
1    220  1252
---- Validation: 
scalar performance:
{'acc': 0.9832908, 'precision': 0.8747144, 'recall': 0.8713405, 'specificity': 0.8713405, 'f1': 0.87301916, 'auroc': 0.9785957, 'binary_precision': 0.7582418, 'binary_recall': 0.7511664, 'binary_specificity': 0.9915147, 'binary_f1_score': 0.7546875}
confusion matrix:
       0    1
0  17995  154
1    160  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.9085984, 'recall': 0.58745563, 'specificity': 0.58745563, 'f1': 0.63689315, 'auroc': 0.94122624, 'binary_precision': 0.8518519, 'binary_recall': 0.17624521, 'binary_specificity': 0.998666, 'binary_f1_score': 0.29206347}
confusion matrix:
      0   1
0  5989   8
1   215  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_25.png
early stop counter: 4
val acc:0.9832907915115356, best validation acc: 0.9856321811676025, corresponding to test acc:                         0.9613295197486877 / 0.9742729067802429
after epoch: 25,now: 2024-06-07 08:22:47.360810,epoch time: 0:16:31.363311,used: 6:58:18.997014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99246436, 'precision': 0.94268763, 'recall': 0.94094324, 'specificity': 0.94094324, 'f1': 0.9418136, 'auroc': 0.99538755, 'binary_precision': 0.8893443, 'binary_recall': 0.8857143, 'binary_specificity': 0.9961722, 'binary_f1_score': 0.8875256}
confusion matrix:
       0     1
0  42160   162
1    168  1302
---- Validation: 
scalar performance:
{'acc': 0.9845147, 'precision': 0.9041846, 'recall': 0.84872246, 'specificity': 0.84872246, 'f1': 0.8742442, 'auroc': 0.9796674, 'binary_precision': 0.81884056, 'binary_recall': 0.7029549, 'binary_specificity': 0.99449, 'binary_f1_score': 0.7564853}
confusion matrix:
       0    1
0  18049  100
1    191  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.9062915, 'recall': 0.6140254, 'specificity': 0.6140254, 'f1': 0.67202294, 'auroc': 0.9457598, 'binary_precision': 0.8450704, 'binary_recall': 0.22988506, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.36144578}
confusion matrix:
      0   1
0  5986  11
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_26.png
early stop counter: 5
val acc:0.9845147132873535, best validation acc: 0.9856321811676025, corresponding to test acc:                         0.9613295197486877 / 0.9742729067802429
after epoch: 26,now: 2024-06-07 08:39:14.255531,epoch time: 0:16:26.894721,used: 7:14:45.891735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9907061, 'precision': 0.9395508, 'recall': 0.9138251, 'specificity': 0.9138251, 'f1': 0.9262699, 'auroc': 0.9945365, 'binary_precision': 0.8849493, 'binary_recall': 0.8314072, 'binary_specificity': 0.996243, 'binary_f1_score': 0.85734314}
confusion matrix:
       0     1
0  42162   159
1    248  1223
---- Validation: 
scalar performance:
{'acc': 0.9856322, 'precision': 0.9216616, 'recall': 0.8478009, 'specificity': 0.8478009, 'f1': 0.880908, 'auroc': 0.97835743, 'binary_precision': 0.85388994, 'binary_recall': 0.6998445, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.7692307}
confusion matrix:
       0    1
0  18072   77
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.839326, 'recall': 0.5752943, 'specificity': 0.5752943, 'f1': 0.616469, 'auroc': 0.9390994, 'binary_precision': 0.71428573, 'binary_recall': 0.1532567, 'binary_specificity': 0.997332, 'binary_f1_score': 0.25236592}
confusion matrix:
      0   1
0  5981  16
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_27.png
early stop counter: 6
val acc:0.9856321811676025, best validation acc: 0.9856321811676025, corresponding to test acc:                         0.9613295197486877 / 0.9742729067802429
after epoch: 27,now: 2024-06-07 08:55:51.116021,epoch time: 0:16:36.860490,used: 7:31:22.752225,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99047774, 'precision': 0.9141549, 'recall': 0.9458598, 'specificity': 0.9458598, 'f1': 0.9293738, 'auroc': 0.9953737, 'binary_precision': 0.831864, 'binary_recall': 0.89802855, 'binary_specificity': 0.9936911, 'binary_f1_score': 0.863681}
confusion matrix:
       0     1
0  42054   267
1    150  1321
---- Validation: 
scalar performance:
{'acc': 0.9847807, 'precision': 0.88733995, 'recall': 0.8803625, 'specificity': 0.8803625, 'f1': 0.8838168, 'auroc': 0.9810691, 'binary_precision': 0.7828843, 'binary_recall': 0.7682737, 'binary_specificity': 0.99245137, 'binary_f1_score': 0.7755102}
confusion matrix:
       0    1
0  18012  137
1    149  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7755096, 'recall': 0.5557204, 'specificity': 0.5557204, 'f1': 0.5858293, 'auroc': 0.9335129, 'binary_precision': 0.5882353, 'binary_recall': 0.11494253, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.19230768}
confusion matrix:
      0   1
0  5976  21
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_28.png
early stop counter: 7
val acc:0.9847807288169861, best validation acc: 0.9856321811676025, corresponding to test acc:                         0.9613295197486877 / 0.9742729067802429
after epoch: 28,now: 2024-06-07 09:14:19.336053,epoch time: 0:18:28.220032,used: 7:49:50.972257,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99161947, 'precision': 0.9487372, 'recall': 0.91894495, 'specificity': 0.91894495, 'f1': 0.9332901, 'auroc': 0.9962388, 'binary_precision': 0.9029905, 'binary_recall': 0.8410326, 'binary_specificity': 0.9968573, 'binary_f1_score': 0.87091106}
confusion matrix:
       0     1
0  42187   133
1    234  1238
---- Validation: 
scalar performance:
{'acc': 0.9843018, 'precision': 0.9264672, 'recall': 0.8186101, 'specificity': 0.8186101, 'f1': 0.86414087, 'auroc': 0.9823065, 'binary_precision': 0.8655462, 'binary_recall': 0.6407465, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.73637176}
confusion matrix:
       0    1
0  18085   64
1    231  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8096023, 'recall': 0.57112944, 'specificity': 0.57112944, 'f1': 0.6091608, 'auroc': 0.93838286, 'binary_precision': 0.6551724, 'binary_recall': 0.14559387, 'binary_specificity': 0.996665, 'binary_f1_score': 0.2382445}
confusion matrix:
      0   1
0  5977  20
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_29.png
early stop counter: 8
val acc:0.9843018054962158, best validation acc: 0.9856321811676025, corresponding to test acc:                         0.9613295197486877 / 0.9742729067802429
after epoch: 29,now: 2024-06-07 09:31:01.512382,epoch time: 0:16:42.176329,used: 8:06:33.148586,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9915053, 'precision': 0.9765035, 'recall': 0.88905066, 'specificity': 0.88905066, 'f1': 0.92804223, 'auroc': 0.99640256, 'binary_precision': 0.9606365, 'binary_recall': 0.77921194, 'binary_specificity': 0.9988894, 'binary_f1_score': 0.86046517}
confusion matrix:
       0     1
0  42273    47
1    325  1147
---- Validation: 
scalar performance:
{'acc': 0.9846211, 'precision': 0.95572037, 'recall': 0.7985239, 'specificity': 0.7985239, 'f1': 0.8595943, 'auroc': 0.9805117, 'binary_precision': 0.9254808, 'binary_recall': 0.59875584, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.72710097}
confusion matrix:
       0    1
0  18118   31
1    258  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8728379, 'recall': 0.52082264, 'specificity': 0.52082264, 'f1': 0.5296659, 'auroc': 0.9231974, 'binary_precision': 0.78571427, 'binary_recall': 0.042145595, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.080000006}
confusion matrix:
      0   1
0  5994   3
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_30.png
early stop counter: 9
val acc:0.9846211075782776, best validation acc: 0.9856321811676025, corresponding to test acc:                         0.9613295197486877 / 0.9742729067802429
after epoch: 30,now: 2024-06-07 09:47:37.207059,epoch time: 0:16:35.694677,used: 8:23:08.843263,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_24_28_seed_0_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:23:08.843263 at 2024-06-07 09:47:37.207059
persisted model performance metric: 

scalar performance:
{'acc': 0.9610099, 'precision': 0.88822913, 'recall': 0.54172873, 'specificity': 0.54172873, 'f1': 0.5664118, 'auroc': 0.9449604, 'binary_precision': 0.8148148, 'binary_recall': 0.08429119, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.15277778}
confusion matrix:
      0   1
0  5992   5
1   239  22
oracle model performance metric: 

scalar performance:
{'acc': 0.97379357, 'precision': 0.8916123, 'recall': 0.7426261, 'specificity': 0.7426261, 'f1': 0.7979828, 'auroc': 0.9499661, 'binary_precision': 0.8050314, 'binary_recall': 0.49042144, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.6095238}
confusion matrix:
      0    1
0  5966   31
1   133  128
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 502701 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool | 461013 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 502701 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool | 461013 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 496650 KiB |  13261 MiB |   1125 TiB |   1125 TiB |
|       from large pool | 455971 KiB |  13223 MiB |   1112 TiB |   1112 TiB |
|       from small pool |  40679 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14520 MiB |  14520 MiB |  14520 MiB |      0 B   |
|       from large pool |  14450 MiB |  14450 MiB |  14450 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 537683 KiB |   1244 MiB |    799 TiB |    799 TiB |
|       from large pool | 526122 KiB |   1235 MiB |    785 TiB |    785 TiB |
|       from small pool |  11560 KiB |     17 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  197601 K  |  197597 K  |
|       from large pool |     187    |    1413    |  102880 K  |  102880 K  |
|       from small pool |    3301    |    6290    |   94720 K  |   94717 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  197601 K  |  197597 K  |
|       from large pool |     187    |    1413    |  102880 K  |  102880 K  |
|       from small pool |    3301    |    6290    |   94720 K  |   94717 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     638    |     638    |     638    |       0    |
|       from large pool |     603    |     603    |     603    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      91    |    2811    |  111245 K  |  111245 K  |
|       from large pool |      46    |     600    |   60597 K  |   60597 K  |
|       from small pool |      45    |    2764    |   50648 K  |   50648 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13261 MiB |   1125 TiB |   1125 TiB |
|       from large pool |  65536 KiB |  13223 MiB |   1112 TiB |   1112 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1016 MiB |  14520 MiB |  14520 MiB |  13504 MiB |
|       from large pool |    964 MiB |  14450 MiB |  14450 MiB |  13486 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |   1244 MiB |    799 TiB |    799 TiB |
|       from large pool |      0 B   |   1235 MiB |    785 TiB |    785 TiB |
|       from small pool |      0 B   |     45 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102880 K  |  102880 K  |
|       from small pool |       0    |    6290    |   94720 K  |   94720 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102880 K  |  102880 K  |
|       from small pool |       0    |    6290    |   94720 K  |   94720 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     638    |     638    |     569    |
|       from large pool |      43    |     603    |     603    |     560    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2811    |  111247 K  |  111247 K  |
|       from large pool |       0    |     600    |   60597 K  |   60597 K  |
|       from small pool |       0    |    2764    |   50649 K  |   50649 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13261 MiB |   1125 TiB |   1125 TiB |
|       from large pool |  65536 KiB |  13223 MiB |   1112 TiB |   1112 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1016 MiB |  14520 MiB |  14520 MiB |  13504 MiB |
|       from large pool |    964 MiB |  14450 MiB |  14450 MiB |  13486 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |   1244 MiB |    799 TiB |    799 TiB |
|       from large pool |      0 B   |   1235 MiB |    785 TiB |    785 TiB |
|       from small pool |      0 B   |     45 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102880 K  |  102880 K  |
|       from small pool |       0    |    6290    |   94720 K  |   94720 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102880 K  |  102880 K  |
|       from small pool |       0    |    6290    |   94720 K  |   94720 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     638    |     638    |     569    |
|       from large pool |      43    |     603    |     603    |     560    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2811    |  111247 K  |  111247 K  |
|       from large pool |       0    |     600    |   60597 K  |   60597 K  |
|       from small pool |       0    |    2764    |   50649 K  |   50649 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182

 Experiment start at: 2024-06-07 09:56:34.778635
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96889824, 'precision': 0.81097066, 'recall': 0.5571915, 'specificity': 0.5571915, 'f1': 0.5908944, 'auroc': 0.94885814, 'binary_precision': 0.6511628, 'binary_recall': 0.116504855, 'binary_specificity': 0.9978781, 'binary_f1_score': 0.19764706}
confusion matrix:
       0    1
0  42324   90
1   1274  168
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.7778244, 'recall': 0.5094092, 'specificity': 0.5094092, 'f1': 0.50961167, 'auroc': 0.9475108, 'binary_precision': 0.59090906, 'binary_recall': 0.019316493, 'binary_specificity': 0.9995019, 'binary_f1_score': 0.03741007}
confusion matrix:
       0   1
0  18058   9
1    660  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.9243026, 'recall': 0.559279, 'specificity': 0.559279, 'f1': 0.5954702, 'auroc': 0.9460292, 'binary_precision': 0.8857143, 'binary_recall': 0.11923077, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.2101695}
confusion matrix:
      0   1
0  5942   4
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-07 10:14:06.454582,epoch time: 0:17:31.675947,used: 0:17:31.675947,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9722729, 'precision': 0.81370294, 'recall': 0.6671257, 'specificity': 0.6671257, 'f1': 0.716275, 'auroc': 0.9587176, 'binary_precision': 0.6494709, 'binary_recall': 0.3404993, 'binary_specificity': 0.99375206, 'binary_f1_score': 0.44676983}
confusion matrix:
       0    1
0  42149  265
1    951  491
---- Validation: 
scalar performance:
{'acc': 0.97022414, 'precision': 0.81780577, 'recall': 0.6734162, 'specificity': 0.6734162, 'f1': 0.7225189, 'auroc': 0.9550842, 'binary_precision': 0.65927976, 'binary_recall': 0.3536404, 'binary_specificity': 0.993192, 'binary_f1_score': 0.46034816}
confusion matrix:
       0    1
0  17944  123
1    435  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693845, 'precision': 0.93861914, 'recall': 0.6493273, 'specificity': 0.6493273, 'f1': 0.7175602, 'auroc': 0.9520202, 'binary_precision': 0.90697676, 'binary_recall': 0.3, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.45086706}
confusion matrix:
      0   1
0  5938   8
1   182  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-07 10:30:48.660084,epoch time: 0:16:42.205502,used: 0:34:13.881449,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97026634, 'precision': 0.9248835, 'recall': 0.5552192, 'specificity': 0.5552192, 'f1': 0.5909485, 'auroc': 0.96582043, 'binary_precision': 0.8791209, 'binary_recall': 0.110957004, 'binary_specificity': 0.9994813, 'binary_f1_score': 0.19704433}
confusion matrix:
       0    1
0  42392   22
1   1282  160
---- Validation: 
scalar performance:
{'acc': 0.9689968, 'precision': 0.9145628, 'recall': 0.58122545, 'specificity': 0.58122545, 'f1': 0.62940824, 'auroc': 0.96625006, 'binary_precision': 0.859375, 'binary_recall': 0.16344725, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.27465665}
confusion matrix:
       0    1
0  18049   18
1    563  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.72912633, 'recall': 0.501839, 'specificity': 0.501839, 'f1': 0.49311718, 'auroc': 0.9531621, 'binary_precision': 0.5, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0076335873}
confusion matrix:
      0  1
0  5945  1
1   259  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_3.png
early stop counter: 1
val acc:0.9689968228340149, best validation acc: 0.970224142074585, corresponding to test acc:                         0.969384491443634 / 0.969384491443634
after epoch: 3,now: 2024-06-07 10:47:16.190483,epoch time: 0:16:27.530399,used: 0:50:41.411848,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9743935, 'precision': 0.89185804, 'recall': 0.64410543, 'specificity': 0.64410543, 'f1': 0.7071185, 'auroc': 0.9709631, 'binary_precision': 0.8073218, 'binary_recall': 0.29056865, 'binary_specificity': 0.9976423, 'binary_f1_score': 0.427333}
confusion matrix:
       0    1
0  42314  100
1   1023  419
---- Validation: 
scalar performance:
{'acc': 0.97097117, 'precision': 0.9067812, 'recall': 0.61729753, 'specificity': 0.61729753, 'f1': 0.67702675, 'auroc': 0.9626476, 'binary_precision': 0.84126985, 'binary_recall': 0.23625557, 'binary_specificity': 0.99833953, 'binary_f1_score': 0.3689095}
confusion matrix:
       0    1
0  18037   30
1    514  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.8549677, 'recall': 0.5227406, 'specificity': 0.5227406, 'f1': 0.53309596, 'auroc': 0.9606199, 'binary_precision': 0.75, 'binary_recall': 0.046153847, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.08695652}
confusion matrix:
      0   1
0  5942   4
1   248  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_4.png
better model found
persisted
after epoch: 4,now: 2024-06-07 11:04:04.253335,epoch time: 0:16:48.062852,used: 1:07:29.474700,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97895384, 'precision': 0.8719115, 'recall': 0.7603469, 'specificity': 0.7603469, 'f1': 0.805526, 'auroc': 0.97629404, 'binary_precision': 0.7597598, 'binary_recall': 0.5263523, 'binary_specificity': 0.9943415, 'binary_f1_score': 0.6218763}
confusion matrix:
       0    1
0  42174  240
1    683  759
---- Validation: 
scalar performance:
{'acc': 0.9746531, 'precision': 0.8738969, 'recall': 0.7079002, 'specificity': 0.7079002, 'f1': 0.7653363, 'auroc': 0.96895236, 'binary_precision': 0.76902175, 'binary_recall': 0.4205052, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.54370797}
confusion matrix:
       0    1
0  17982   85
1    390  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.79762185, 'recall': 0.5861911, 'specificity': 0.5861911, 'f1': 0.62816215, 'auroc': 0.96031463, 'binary_precision': 0.63013697, 'binary_recall': 0.17692308, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.27627626}
confusion matrix:
      0   1
0  5919  27
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_5.png
better model found
persisted
after epoch: 5,now: 2024-06-07 11:21:56.825457,epoch time: 0:17:52.572122,used: 1:25:22.046822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9748951, 'precision': 0.7891227, 'recall': 0.8989284, 'specificity': 0.8989284, 'f1': 0.8343161, 'auroc': 0.97639763, 'binary_precision': 0.5845315, 'binary_recall': 0.81761444, 'binary_specificity': 0.9802424, 'binary_f1_score': 0.68169993}
confusion matrix:
       0     1
0  41576   838
1    263  1179
---- Validation: 
scalar performance:
{'acc': 0.9738527, 'precision': 0.79644036, 'recall': 0.89846146, 'specificity': 0.89846146, 'f1': 0.8390855, 'auroc': 0.971395, 'binary_precision': 0.5997819, 'binary_recall': 0.81723624, 'binary_specificity': 0.97968674, 'binary_f1_score': 0.69182384}
confusion matrix:
       0    1
0  17700  367
1    123  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96745086, 'precision': 0.7965937, 'recall': 0.8009541, 'specificity': 0.8009541, 'f1': 0.79875594, 'auroc': 0.9584265, 'binary_precision': 0.6098485, 'binary_recall': 0.61923075, 'binary_specificity': 0.98267746, 'binary_f1_score': 0.6145038}
confusion matrix:
      0    1
0  5843  103
1    99  161
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_6.png
early stop counter: 1
val acc:0.9738526940345764, best validation acc: 0.9746531248092651, corresponding to test acc:                         0.9611666202545166 / 0.969384491443634
after epoch: 6,now: 2024-06-07 11:38:57.365035,epoch time: 0:17:00.539578,used: 1:42:22.586400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9810288, 'precision': 0.83696485, 'recall': 0.891716, 'specificity': 0.891716, 'f1': 0.86208946, 'auroc': 0.9808192, 'binary_precision': 0.6809015, 'binary_recall': 0.79611653, 'binary_specificity': 0.98731554, 'binary_f1_score': 0.7340153}
confusion matrix:
       0     1
0  41876   538
1    294  1148
---- Validation: 
scalar performance:
{'acc': 0.9797759, 'precision': 0.84773445, 'recall': 0.87006164, 'specificity': 0.87006164, 'f1': 0.85851616, 'auroc': 0.97421485, 'binary_precision': 0.7047354, 'binary_recall': 0.75185734, 'binary_specificity': 0.9882659, 'binary_f1_score': 0.7275341}
confusion matrix:
       0    1
0  17855  212
1    167  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.76054025, 'recall': 0.61502624, 'specificity': 0.61502624, 'f1': 0.65636766, 'auroc': 0.95408255, 'binary_precision': 0.5535714, 'binary_recall': 0.23846154, 'binary_specificity': 0.991591, 'binary_f1_score': 0.3333333}
confusion matrix:
      0   1
0  5896  50
1   198  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_7.png
better model found
persisted
after epoch: 7,now: 2024-06-07 11:55:27.953143,epoch time: 0:16:30.588108,used: 1:58:53.174508,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97904503, 'precision': 0.81796086, 'recall': 0.90134597, 'specificity': 0.90134597, 'f1': 0.8543382, 'auroc': 0.9803225, 'binary_precision': 0.64215684, 'binary_recall': 0.8181818, 'binary_specificity': 0.9845102, 'binary_f1_score': 0.7195606}
confusion matrix:
       0     1
0  41758   657
1    262  1179
---- Validation: 
scalar performance:
{'acc': 0.9775347, 'precision': 0.8263984, 'recall': 0.87605196, 'specificity': 0.87605196, 'f1': 0.8492845, 'auroc': 0.9733693, 'binary_precision': 0.6615385, 'binary_recall': 0.7667162, 'binary_specificity': 0.98538774, 'binary_f1_score': 0.7102547}
confusion matrix:
       0    1
0  17803  264
1    157  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.8296932, 'recall': 0.6621051, 'specificity': 0.6621051, 'f1': 0.7145216, 'auroc': 0.95419526, 'binary_precision': 0.688, 'binary_recall': 0.33076924, 'binary_specificity': 0.993441, 'binary_f1_score': 0.44675326}
confusion matrix:
      0   1
0  5907  39
1   174  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_8.png
early stop counter: 1
val acc:0.9775347113609314, best validation acc: 0.9797759056091309, corresponding to test acc:                         0.9600386619567871 / 0.969384491443634
after epoch: 8,now: 2024-06-07 12:11:46.841910,epoch time: 0:16:18.888767,used: 2:15:12.063275,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9831266, 'precision': 0.85537446, 'recall': 0.89615005, 'specificity': 0.89615005, 'f1': 0.87455606, 'auroc': 0.9824225, 'binary_precision': 0.71747214, 'binary_recall': 0.8030513, 'binary_specificity': 0.9892488, 'binary_f1_score': 0.7578534}
confusion matrix:
       0     1
0  41958   456
1    284  1158
---- Validation: 
scalar performance:
{'acc': 0.98249733, 'precision': 0.8871029, 'recall': 0.8492998, 'specificity': 0.8492998, 'f1': 0.86714435, 'auroc': 0.9767391, 'binary_precision': 0.78512394, 'binary_recall': 0.70579493, 'binary_specificity': 0.9928046, 'binary_f1_score': 0.74334896}
confusion matrix:
       0    1
0  17937  130
1    198  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.79618114, 'recall': 0.62732154, 'specificity': 0.62732154, 'f1': 0.6746082, 'auroc': 0.9575592, 'binary_precision': 0.6238532, 'binary_recall': 0.26153848, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.36856368}
confusion matrix:
      0   1
0  5905  41
1   192  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_9.png
better model found
persisted
after epoch: 9,now: 2024-06-07 12:28:04.431772,epoch time: 0:16:17.589862,used: 2:31:29.653137,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98365104, 'precision': 0.9286254, 'recall': 0.7935909, 'specificity': 0.7935909, 'f1': 0.8475951, 'auroc': 0.98400474, 'binary_precision': 0.8710338, 'binary_recall': 0.59015256, 'binary_specificity': 0.9970293, 'binary_f1_score': 0.7035965}
confusion matrix:
       0    1
0  42288  126
1    591  851
---- Validation: 
scalar performance:
{'acc': 0.9810566, 'precision': 0.92588925, 'recall': 0.7770258, 'specificity': 0.7770258, 'f1': 0.8344868, 'auroc': 0.9785011, 'binary_precision': 0.8680556, 'binary_recall': 0.5572065, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.678733}
confusion matrix:
       0    1
0  18010   57
1    298  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.838871, 'recall': 0.56613046, 'specificity': 0.56613046, 'f1': 0.603395, 'auroc': 0.957811, 'binary_precision': 0.71428573, 'binary_recall': 0.13461539, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.22653723}
confusion matrix:
      0   1
0  5932  14
1   225  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_10.png
early stop counter: 1
val acc:0.9810565710067749, best validation acc: 0.9824973344802856, corresponding to test acc:                         0.962455689907074 / 0.969384491443634
after epoch: 10,now: 2024-06-07 12:44:06.819927,epoch time: 0:16:02.388155,used: 2:47:32.041292,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9857488, 'precision': 0.8934584, 'recall': 0.87841344, 'specificity': 0.87841344, 'f1': 0.88577735, 'auroc': 0.985392, 'binary_precision': 0.79494584, 'binary_recall': 0.76352286, 'binary_specificity': 0.9933041, 'binary_f1_score': 0.7789176}
confusion matrix:
       0     1
0  42130   284
1    341  1101
---- Validation: 
scalar performance:
{'acc': 0.98297757, 'precision': 0.91185474, 'recall': 0.82451445, 'specificity': 0.82451445, 'f1': 0.86257625, 'auroc': 0.9796533, 'binary_precision': 0.8365019, 'binary_recall': 0.653789, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.73394495}
confusion matrix:
       0    1
0  17981   86
1    233  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.8118185, 'recall': 0.5939675, 'specificity': 0.5939675, 'f1': 0.6390381, 'auroc': 0.95674324, 'binary_precision': 0.65789473, 'binary_recall': 0.1923077, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.29761904}
confusion matrix:
      0   1
0  5920  26
1   210  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_11.png
better model found
persisted
after epoch: 11,now: 2024-06-07 12:59:48.225303,epoch time: 0:15:41.405376,used: 3:03:13.446668,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9854524, 'precision': 0.93541306, 'recall': 0.8199786, 'specificity': 0.8199786, 'f1': 0.8682471, 'auroc': 0.986355, 'binary_precision': 0.88285714, 'binary_recall': 0.64285713, 'binary_specificity': 0.9971, 'binary_f1_score': 0.74398077}
confusion matrix:
       0    1
0  42291  123
1    515  927
---- Validation: 
scalar performance:
{'acc': 0.98223054, 'precision': 0.9312891, 'recall': 0.79194, 'specificity': 0.79194, 'f1': 0.8471568, 'auroc': 0.9799044, 'binary_precision': 0.87777776, 'binary_recall': 0.5869242, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.70347285}
confusion matrix:
       0    1
0  18012   55
1    278  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.8301774, 'recall': 0.55659914, 'specificity': 0.55659914, 'f1': 0.588976, 'auroc': 0.95850587, 'binary_precision': 0.6976744, 'binary_recall': 0.115384616, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.1980198}
confusion matrix:
      0   1
0  5933  13
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_12.png
early stop counter: 1
val acc:0.982230544090271, best validation acc: 0.982977569103241, corresponding to test acc:                         0.9619722962379456 / 0.969384491443634
after epoch: 12,now: 2024-06-07 13:15:39.059855,epoch time: 0:15:50.834552,used: 3:19:04.281220,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98609084, 'precision': 0.9328622, 'recall': 0.8340417, 'specificity': 0.8340417, 'f1': 0.87662303, 'auroc': 0.98713255, 'binary_precision': 0.8768116, 'binary_recall': 0.67128986, 'binary_specificity': 0.9967935, 'binary_f1_score': 0.7604085}
confusion matrix:
       0    1
0  42278  136
1    474  968
---- Validation: 
scalar performance:
{'acc': 0.98356456, 'precision': 0.9291325, 'recall': 0.81623566, 'specificity': 0.81623566, 'f1': 0.8634571, 'auroc': 0.979561, 'binary_precision': 0.87169045, 'binary_recall': 0.6359584, 'binary_specificity': 0.996513, 'binary_f1_score': 0.7353952}
confusion matrix:
       0    1
0  18004   63
1    245  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.8209688, 'recall': 0.57908744, 'specificity': 0.57908744, 'f1': 0.6205919, 'auroc': 0.95579743, 'binary_precision': 0.67741936, 'binary_recall': 0.16153847, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.26086956}
confusion matrix:
      0   1
0  5926  20
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_13.png
better model found
persisted
after epoch: 13,now: 2024-06-07 13:31:31.420850,epoch time: 0:15:52.360995,used: 3:34:56.642215,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9868661, 'precision': 0.889318, 'recall': 0.9101417, 'specificity': 0.9101417, 'f1': 0.89943576, 'auroc': 0.98720455, 'binary_precision': 0.7844941, 'binary_recall': 0.82801664, 'binary_specificity': 0.9922667, 'binary_f1_score': 0.80566806}
confusion matrix:
       0     1
0  42086   328
1    248  1194
---- Validation: 
scalar performance:
{'acc': 0.9830843, 'precision': 0.87804043, 'recall': 0.8774996, 'specificity': 0.8774996, 'f1': 0.8777698, 'auroc': 0.98037577, 'binary_precision': 0.76488096, 'binary_recall': 0.7637444, 'binary_specificity': 0.99125475, 'binary_f1_score': 0.76431227}
confusion matrix:
       0    1
0  17909  158
1    159  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.8121702, 'recall': 0.6390282, 'specificity': 0.6390282, 'f1': 0.6890468, 'auroc': 0.94274443, 'binary_precision': 0.65486723, 'binary_recall': 0.2846154, 'binary_specificity': 0.993441, 'binary_f1_score': 0.39678288}
confusion matrix:
      0   1
0  5907  39
1   186  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_14.png
early stop counter: 1
val acc:0.9830843210220337, best validation acc: 0.983564555644989, corresponding to test acc:                         0.961650013923645 / 0.969384491443634
after epoch: 14,now: 2024-06-07 13:47:22.126330,epoch time: 0:15:50.705480,used: 3:50:47.347695,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98609084, 'precision': 0.9072434, 'recall': 0.86452234, 'specificity': 0.86452234, 'f1': 0.88460755, 'auroc': 0.9879523, 'binary_precision': 0.82348365, 'binary_recall': 0.7343967, 'binary_specificity': 0.994648, 'binary_f1_score': 0.77639294}
confusion matrix:
       0     1
0  42187   227
1    383  1059
---- Validation: 
scalar performance:
{'acc': 0.98537886, 'precision': 0.91120464, 'recall': 0.8686758, 'specificity': 0.8686758, 'f1': 0.8886808, 'auroc': 0.9788742, 'binary_precision': 0.83194673, 'binary_recall': 0.74294204, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.78492934}
confusion matrix:
       0    1
0  17966  101
1    173  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.818479, 'recall': 0.5959747, 'specificity': 0.5959747, 'f1': 0.64209706, 'auroc': 0.9598816, 'binary_precision': 0.67105263, 'binary_recall': 0.19615385, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.30357143}
confusion matrix:
      0   1
0  5921  25
1   209  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_15.png
better model found
persisted
after epoch: 15,now: 2024-06-07 14:03:25.443972,epoch time: 0:16:03.317642,used: 4:06:50.665337,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.987687, 'precision': 0.91498923, 'recall': 0.88544464, 'specificity': 0.88544464, 'f1': 0.8996288, 'auroc': 0.9902058, 'binary_precision': 0.83757484, 'binary_recall': 0.77600557, 'binary_specificity': 0.9948838, 'binary_f1_score': 0.8056155}
confusion matrix:
       0     1
0  42197   217
1    323  1119
---- Validation: 
scalar performance:
{'acc': 0.9840982, 'precision': 0.896137, 'recall': 0.86658114, 'specificity': 0.86658114, 'f1': 0.8807355, 'auroc': 0.9783867, 'binary_precision': 0.8019324, 'binary_recall': 0.73997027, 'binary_specificity': 0.993192, 'binary_f1_score': 0.76970637}
confusion matrix:
       0    1
0  17944  123
1    175  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.8752961, 'recall': 0.5836063, 'specificity': 0.5836063, 'f1': 0.6298159, 'auroc': 0.95850956, 'binary_precision': 0.78571427, 'binary_recall': 0.16923077, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.27848104}
confusion matrix:
      0   1
0  5934  12
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_16.png
early stop counter: 1
val acc:0.9840981960296631, best validation acc: 0.9853788614273071, corresponding to test acc:                         0.9622945785522461 / 0.969384491443634
after epoch: 16,now: 2024-06-07 14:19:29.836446,epoch time: 0:16:04.392474,used: 4:22:55.057811,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98839384, 'precision': 0.9226126, 'recall': 0.8888247, 'specificity': 0.8888247, 'f1': 0.90496063, 'auroc': 0.9900744, 'binary_precision': 0.8526077, 'binary_recall': 0.7822469, 'binary_specificity': 0.99540246, 'binary_f1_score': 0.81591326}
confusion matrix:
       0     1
0  42219   195
1    314  1128
---- Validation: 
scalar performance:
{'acc': 0.98388475, 'precision': 0.8972522, 'recall': 0.8607483, 'specificity': 0.8607483, 'f1': 0.8780438, 'auroc': 0.9776372, 'binary_precision': 0.8045977, 'binary_recall': 0.7280832, 'binary_specificity': 0.9934134, 'binary_f1_score': 0.7644306}
confusion matrix:
       0    1
0  17948  119
1    183  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.8229555, 'recall': 0.5960588, 'specificity': 0.5960588, 'f1': 0.6425924, 'auroc': 0.952595, 'binary_precision': 0.68, 'binary_recall': 0.19615385, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.30447763}
confusion matrix:
      0   1
0  5922  24
1   209  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_17.png
early stop counter: 2
val acc:0.9838847517967224, best validation acc: 0.9853788614273071, corresponding to test acc:                         0.9622945785522461 / 0.969384491443634
after epoch: 17,now: 2024-06-07 14:35:37.960212,epoch time: 0:16:08.123766,used: 4:39:03.181577,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.987687, 'precision': 0.9342433, 'recall': 0.86166304, 'specificity': 0.86166304, 'f1': 0.89439845, 'auroc': 0.9905739, 'binary_precision': 0.87772197, 'binary_recall': 0.7267684, 'binary_specificity': 0.9965577, 'binary_f1_score': 0.7951442}
confusion matrix:
       0     1
0  42268   146
1    394  1048
---- Validation: 
scalar performance:
{'acc': 0.98431164, 'precision': 0.91564727, 'recall': 0.8438033, 'specificity': 0.8438033, 'f1': 0.87604314, 'auroc': 0.9789139, 'binary_precision': 0.8426763, 'binary_recall': 0.692422, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.7601957}
confusion matrix:
       0    1
0  17980   87
1    207  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.8561183, 'recall': 0.5511663, 'specificity': 0.5511663, 'f1': 0.58122945, 'auroc': 0.9537685, 'binary_precision': 0.75, 'binary_recall': 0.103846155, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.18243243}
confusion matrix:
      0   1
0  5937   9
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_18.png
early stop counter: 3
val acc:0.9843116402626038, best validation acc: 0.9853788614273071, corresponding to test acc:                         0.9622945785522461 / 0.969384491443634
after epoch: 18,now: 2024-06-07 14:51:31.812658,epoch time: 0:15:53.852446,used: 4:54:57.034023,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9878238, 'precision': 0.90531385, 'recall': 0.90259796, 'specificity': 0.90259796, 'f1': 0.9039509, 'auroc': 0.99082816, 'binary_precision': 0.81703913, 'binary_recall': 0.8113731, 'binary_specificity': 0.9938228, 'binary_f1_score': 0.8141962}
confusion matrix:
       0     1
0  42152   262
1    272  1170
---- Validation: 
scalar performance:
{'acc': 0.98457843, 'precision': 0.9010715, 'recall': 0.86826074, 'specificity': 0.86826074, 'f1': 0.88390493, 'auroc': 0.98104465, 'binary_precision': 0.8116883, 'binary_recall': 0.74294204, 'binary_specificity': 0.99357945, 'binary_f1_score': 0.7757952}
confusion matrix:
       0    1
0  17951  116
1    173  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.86719304, 'recall': 0.6005776, 'specificity': 0.6005776, 'f1': 0.6518664, 'auroc': 0.9612838, 'binary_precision': 0.76811594, 'binary_recall': 0.20384616, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.32218847}
confusion matrix:
      0   1
0  5930  16
1   207  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_19.png
early stop counter: 4
val acc:0.9845784306526184, best validation acc: 0.9853788614273071, corresponding to test acc:                         0.9622945785522461 / 0.969384491443634
after epoch: 19,now: 2024-06-07 15:07:24.457203,epoch time: 0:15:52.644545,used: 5:10:49.678568,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98941994, 'precision': 0.9463874, 'recall': 0.87964153, 'specificity': 0.87964153, 'f1': 0.91011965, 'auroc': 0.9912871, 'binary_precision': 0.90081966, 'binary_recall': 0.7621359, 'binary_specificity': 0.99714714, 'binary_f1_score': 0.82569504}
confusion matrix:
       0     1
0  42293   121
1    343  1099
---- Validation: 
scalar performance:
{'acc': 0.98441833, 'precision': 0.92149615, 'recall': 0.83885175, 'specificity': 0.83885175, 'f1': 0.87531346, 'auroc': 0.9820335, 'binary_precision': 0.8547486, 'binary_recall': 0.6820208, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.75867766}
confusion matrix:
       0    1
0  17989   78
1    214  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8020007, 'recall': 0.58627516, 'specificity': 0.58627516, 'f1': 0.6286204, 'auroc': 0.9597325, 'binary_precision': 0.6388889, 'binary_recall': 0.17692308, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.27710843}
confusion matrix:
      0   1
0  5920  26
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_20.png
early stop counter: 5
val acc:0.9844183325767517, best validation acc: 0.9853788614273071, corresponding to test acc:                         0.9622945785522461 / 0.969384491443634
after epoch: 20,now: 2024-06-07 15:23:17.393297,epoch time: 0:15:52.936094,used: 5:26:42.614662,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9878466, 'precision': 0.95202243, 'recall': 0.8466728, 'specificity': 0.8466728, 'f1': 0.8919085, 'auroc': 0.991966, 'binary_precision': 0.91431177, 'binary_recall': 0.6955617, 'binary_specificity': 0.9977838, 'binary_f1_score': 0.7900748}
confusion matrix:
       0     1
0  42320    94
1    439  1003
---- Validation: 
scalar performance:
{'acc': 0.9815368, 'precision': 0.93692005, 'recall': 0.77584434, 'specificity': 0.77584434, 'f1': 0.8368207, 'auroc': 0.9813322, 'binary_precision': 0.8902148, 'binary_recall': 0.55423474, 'binary_specificity': 0.9974539, 'binary_f1_score': 0.6831502}
confusion matrix:
       0    1
0  18021   46
1    300  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.8183099, 'recall': 0.5846885, 'specificity': 0.5846885, 'f1': 0.62780917, 'auroc': 0.94857514, 'binary_precision': 0.67164177, 'binary_recall': 0.17307693, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.27522936}
confusion matrix:
      0   1
0  5924  22
1   215  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_21.png
early stop counter: 6
val acc:0.9815368056297302, best validation acc: 0.9853788614273071, corresponding to test acc:                         0.9622945785522461 / 0.969384491443634
after epoch: 21,now: 2024-06-07 15:39:10.759779,epoch time: 0:15:53.366482,used: 5:42:35.981144,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9869573, 'precision': 0.89124364, 'recall': 0.9085141, 'specificity': 0.9085141, 'f1': 0.8996767, 'auroc': 0.9924388, 'binary_precision': 0.78846157, 'binary_recall': 0.82454926, 'binary_specificity': 0.9924789, 'binary_f1_score': 0.8061017}
confusion matrix:
       0     1
0  42095   319
1    253  1189
---- Validation: 
scalar performance:
{'acc': 0.9825507, 'precision': 0.88598907, 'recall': 0.85218847, 'specificity': 0.85218847, 'f1': 0.8682455, 'auroc': 0.9795482, 'binary_precision': 0.78267974, 'binary_recall': 0.71173847, 'binary_specificity': 0.9926385, 'binary_f1_score': 0.7455253}
confusion matrix:
       0    1
0  17934  133
1    194  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.8141451, 'recall': 0.695375, 'specificity': 0.695375, 'f1': 0.7394132, 'auroc': 0.93731856, 'binary_precision': 0.6540881, 'binary_recall': 0.4, 'binary_specificity': 0.9907501, 'binary_f1_score': 0.49642006}
confusion matrix:
      0    1
0  5891   55
1   156  104
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_22.png
early stop counter: 7
val acc:0.9825506806373596, best validation acc: 0.9853788614273071, corresponding to test acc:                         0.9622945785522461 / 0.969384491443634
after epoch: 22,now: 2024-06-07 15:55:08.493927,epoch time: 0:15:57.734148,used: 5:58:33.715292,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.990332, 'precision': 0.9393139, 'recall': 0.90389466, 'specificity': 0.90389466, 'f1': 0.9208039, 'auroc': 0.9934384, 'binary_precision': 0.8850227, 'binary_recall': 0.8113731, 'binary_specificity': 0.9964163, 'binary_f1_score': 0.8465991}
confusion matrix:
       0     1
0  42262   152
1    272  1170
---- Validation: 
scalar performance:
{'acc': 0.9857524, 'precision': 0.9206226, 'recall': 0.86314744, 'specificity': 0.86314744, 'f1': 0.8896005, 'auroc': 0.98338497, 'binary_precision': 0.8512111, 'binary_recall': 0.73105496, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.7865707}
confusion matrix:
       0    1
0  17981   86
1    181  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.882753, 'recall': 0.59129864, 'specificity': 0.59129864, 'f1': 0.64073765, 'auroc': 0.94864917, 'binary_precision': 0.8, 'binary_recall': 0.18461539, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.3}
confusion matrix:
      0   1
0  5934  12
1   212  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_23.png
better model found
persisted
after epoch: 23,now: 2024-06-07 16:11:04.324005,epoch time: 0:15:55.830078,used: 6:14:29.545370,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99056, 'precision': 0.92939615, 'recall': 0.92076015, 'specificity': 0.92076015, 'f1': 0.9250308, 'auroc': 0.99174726, 'binary_precision': 0.8640227, 'binary_recall': 0.84604716, 'binary_specificity': 0.9954732, 'binary_f1_score': 0.8549404}
confusion matrix:
       0     1
0  42222   192
1    222  1220
---- Validation: 
scalar performance:
{'acc': 0.98447174, 'precision': 0.8943059, 'recall': 0.8767886, 'specificity': 0.8767886, 'f1': 0.8853304, 'auroc': 0.9808517, 'binary_precision': 0.79750776, 'binary_recall': 0.76077265, 'binary_specificity': 0.9928046, 'binary_f1_score': 0.7787072}
confusion matrix:
       0    1
0  17937  130
1    161  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.78707826, 'recall': 0.6345093, 'specificity': 0.6345093, 'f1': 0.6802088, 'auroc': 0.95475143, 'binary_precision': 0.60504204, 'binary_recall': 0.2769231, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.37994725}
confusion matrix:
      0   1
0  5899  47
1   188  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_24.png
early stop counter: 1
val acc:0.9844717383384705, best validation acc: 0.9857524037361145, corresponding to test acc:                         0.9639058709144592 / 0.969384491443634
after epoch: 24,now: 2024-06-07 16:27:03.179520,epoch time: 0:15:58.855515,used: 6:30:28.400885,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99094766, 'precision': 0.9589937, 'recall': 0.89315957, 'specificity': 0.89315957, 'f1': 0.9233491, 'auroc': 0.9936113, 'binary_precision': 0.9251424, 'binary_recall': 0.7884882, 'binary_specificity': 0.9978309, 'binary_f1_score': 0.8513665}
confusion matrix:
       0     1
0  42322    92
1    305  1137
---- Validation: 
scalar performance:
{'acc': 0.98537886, 'precision': 0.9268617, 'recall': 0.8493637, 'specificity': 0.8493637, 'f1': 0.88392663, 'auroc': 0.9842825, 'binary_precision': 0.86471665, 'binary_recall': 0.70282316, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.7754099}
confusion matrix:
       0    1
0  17993   74
1    200  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.9007561, 'recall': 0.62390685, 'specificity': 0.62390685, 'f1': 0.6836942, 'auroc': 0.9602364, 'binary_precision': 0.8333333, 'binary_recall': 0.25, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.3846154}
confusion matrix:
      0   1
0  5933  13
1   195  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_25.png
early stop counter: 2
val acc:0.9853788614273071, best validation acc: 0.9857524037361145, corresponding to test acc:                         0.9639058709144592 / 0.969384491443634
after epoch: 25,now: 2024-06-07 16:43:29.227967,epoch time: 0:16:26.048447,used: 6:46:54.449332,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9911529, 'precision': 0.9538782, 'recall': 0.90197444, 'specificity': 0.90197444, 'f1': 0.9262364, 'auroc': 0.99465466, 'binary_precision': 0.9143082, 'binary_recall': 0.80651873, 'binary_specificity': 0.9974301, 'binary_f1_score': 0.8570376}
confusion matrix:
       0     1
0  42305   109
1    279  1163
---- Validation: 
scalar performance:
{'acc': 0.9872999, 'precision': 0.9403752, 'recall': 0.8668111, 'specificity': 0.8668111, 'f1': 0.8999692, 'auroc': 0.9839754, 'binary_precision': 0.89048475, 'binary_recall': 0.7369985, 'binary_specificity': 0.9966237, 'binary_f1_score': 0.8065041}
confusion matrix:
       0    1
0  18006   61
1    177  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.841954, 'recall': 0.5869479, 'specificity': 0.5869479, 'f1': 0.63237906, 'auroc': 0.94403684, 'binary_precision': 0.71875, 'binary_recall': 0.17692308, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.28395063}
confusion matrix:
      0   1
0  5928  18
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_26.png
better model found
persisted
after epoch: 26,now: 2024-06-07 16:59:39.457134,epoch time: 0:16:10.229167,used: 7:03:04.678499,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99097043, 'precision': 0.950102, 'recall': 0.90288496, 'specificity': 0.90288496, 'f1': 0.9250895, 'auroc': 0.9938138, 'binary_precision': 0.9066874, 'binary_recall': 0.8085992, 'binary_specificity': 0.99717075, 'binary_f1_score': 0.8548387}
confusion matrix:
       0     1
0  42294   120
1    276  1166
---- Validation: 
scalar performance:
{'acc': 0.9857524, 'precision': 0.9235794, 'recall': 0.8595711, 'specificity': 0.8595711, 'f1': 0.88874155, 'auroc': 0.98220557, 'binary_precision': 0.85739434, 'binary_recall': 0.72362554, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.7848509}
confusion matrix:
       0    1
0  17986   81
1    186  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8358165, 'recall': 0.5642074, 'specificity': 0.5642074, 'f1': 0.60047555, 'auroc': 0.9395406, 'binary_precision': 0.7083333, 'binary_recall': 0.13076924, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.22077924}
confusion matrix:
      0   1
0  5932  14
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_27.png
early stop counter: 1
val acc:0.9857524037361145, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9626168012619019 / 0.969384491443634
after epoch: 27,now: 2024-06-07 17:17:22.323668,epoch time: 0:17:42.866534,used: 7:20:47.545033,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99005836, 'precision': 0.97571635, 'recall': 0.863224, 'specificity': 0.863224, 'f1': 0.9114107, 'auroc': 0.99467707, 'binary_precision': 0.9606227, 'binary_recall': 0.7274619, 'binary_specificity': 0.9989862, 'binary_f1_score': 0.82794005}
confusion matrix:
       0     1
0  42371    43
1    393  1049
---- Validation: 
scalar performance:
{'acc': 0.98399144, 'precision': 0.95325494, 'recall': 0.80215174, 'specificity': 0.80215174, 'f1': 0.8614664, 'auroc': 0.98206997, 'binary_precision': 0.9209932, 'binary_recall': 0.6062407, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.73118275}
confusion matrix:
       0    1
0  18032   35
1    265  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.8551972, 'recall': 0.5284257, 'specificity': 0.5284257, 'f1': 0.5432681, 'auroc': 0.9415879, 'binary_precision': 0.75, 'binary_recall': 0.057692308, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.107142866}
confusion matrix:
      0   1
0  5941   5
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_28.png
early stop counter: 2
val acc:0.9839914441108704, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9626168012619019 / 0.969384491443634
after epoch: 28,now: 2024-06-07 17:35:02.923857,epoch time: 0:17:40.600189,used: 7:38:28.145222,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9922246, 'precision': 0.9340291, 'recall': 0.945366, 'specificity': 0.945366, 'f1': 0.9396187, 'auroc': 0.9959117, 'binary_precision': 0.8716216, 'binary_recall': 0.89521164, 'binary_specificity': 0.9955205, 'binary_f1_score': 0.8832591}
confusion matrix:
       0     1
0  42225   190
1    151  1290
---- Validation: 
scalar performance:
{'acc': 0.98596585, 'precision': 0.90896523, 'recall': 0.8825704, 'specificity': 0.8825704, 'f1': 0.89528924, 'auroc': 0.98401725, 'binary_precision': 0.8264331, 'binary_recall': 0.77117383, 'binary_specificity': 0.9939669, 'binary_f1_score': 0.79784787}
confusion matrix:
       0    1
0  17958  109
1    154  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.83431387, 'recall': 0.61512136, 'specificity': 0.61512136, 'f1': 0.666468, 'auroc': 0.9549422, 'binary_precision': 0.7011494, 'binary_recall': 0.23461539, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.35158503}
confusion matrix:
      0   1
0  5920  26
1   199  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_29.png
early stop counter: 3
val acc:0.9859658479690552, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9626168012619019 / 0.969384491443634
after epoch: 29,now: 2024-06-07 17:52:05.959029,epoch time: 0:17:03.035172,used: 7:55:31.180394,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9923842, 'precision': 0.95625377, 'recall': 0.9206984, 'specificity': 0.9206984, 'f1': 0.93770164, 'auroc': 0.9958739, 'binary_precision': 0.91779786, 'binary_recall': 0.8439667, 'binary_specificity': 0.9974301, 'binary_f1_score': 0.8793353}
confusion matrix:
       0     1
0  42305   109
1    225  1217
---- Validation: 
scalar performance:
{'acc': 0.9861793, 'precision': 0.9224342, 'recall': 0.8683757, 'specificity': 0.8683757, 'f1': 0.89340186, 'auroc': 0.9831109, 'binary_precision': 0.8544521, 'binary_recall': 0.74145615, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.79395384}
confusion matrix:
       0    1
0  17982   85
1    174  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.89409256, 'recall': 0.5628729, 'specificity': 0.5628729, 'f1': 0.6003401, 'auroc': 0.94848096, 'binary_precision': 0.825, 'binary_recall': 0.12692308, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.22}
confusion matrix:
      0   1
0  5939   7
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_30.png
early stop counter: 4
val acc:0.9861792922019958, best validation acc: 0.987299919128418, corresponding to test acc:                         0.9626168012619019 / 0.969384491443634
after epoch: 30,now: 2024-06-07 18:08:53.948187,epoch time: 0:16:47.989158,used: 8:12:19.169552,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_09_56_34_seed_1_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:12:19.169552 at 2024-06-07 18:08:53.948187
persisted model performance metric: 

scalar performance:
{'acc': 0.9624557, 'precision': 0.8549253, 'recall': 0.5776689, 'specificity': 0.5776689, 'f1': 0.6205282, 'auroc': 0.9522258, 'binary_precision': 0.74545455, 'binary_recall': 0.15769231, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.26031747}
confusion matrix:
      0   1
0  5932  14
1   219  41
oracle model performance metric: 

scalar performance:
{'acc': 0.9690622, 'precision': 0.9327234, 'recall': 0.64732015, 'specificity': 0.64732015, 'f1': 0.7145871, 'auroc': 0.95807266, 'binary_precision': 0.89534885, 'binary_recall': 0.29615384, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.44508672}
confusion matrix:
      0   1
0  5937   9
1   183  77
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 502239 KiB |  13264 MiB |   2260 TiB |   2260 TiB |
|       from large pool | 460563 KiB |  13226 MiB |   2234 TiB |   2234 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 502239 KiB |  13264 MiB |   2260 TiB |   2260 TiB |
|       from large pool | 460563 KiB |  13226 MiB |   2234 TiB |   2234 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 496647 KiB |  13261 MiB |   2256 TiB |   2256 TiB |
|       from large pool | 455971 KiB |  13223 MiB |   2230 TiB |   2230 TiB |
|       from small pool |  40676 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14504 MiB |  14520 MiB |  28008 MiB |  13504 MiB |
|       from large pool |  14438 MiB |  14450 MiB |  27924 MiB |  13486 MiB |
|       from small pool |     66 MiB |     70 MiB |     84 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 517665 KiB |   1244 MiB |   1670 TiB |   1670 TiB |
|       from large pool | 506092 KiB |   1235 MiB |   1643 TiB |   1643 TiB |
|       from small pool |  11572 KiB |     45 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    6487    |  395835 K  |  395832 K  |
|       from large pool |     187    |    1413    |  206181 K  |  206181 K  |
|       from small pool |    3277    |    6298    |  189653 K  |  189650 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    6487    |  395835 K  |  395832 K  |
|       from large pool |     187    |    1413    |  206181 K  |  206181 K  |
|       from small pool |    3277    |    6298    |  189653 K  |  189650 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     638    |    1206    |     569    |
|       from large pool |     604    |     604    |    1164    |     560    |
|       from small pool |      33    |      35    |      42    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      86    |    2812    |  233608 K  |  233607 K  |
|       from large pool |      42    |     600    |  133285 K  |  133285 K  |
|       from small pool |      44    |    2768    |  100322 K  |  100322 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13264 MiB |   2260 TiB |   2260 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   2234 TiB |   2234 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13264 MiB |   2260 TiB |   2260 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   2234 TiB |   2234 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13261 MiB |   2256 TiB |   2256 TiB |
|       from large pool |  65536 KiB |  13223 MiB |   2230 TiB |   2230 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    996 MiB |  14520 MiB |  28008 MiB |  27012 MiB |
|       from large pool |    944 MiB |  14450 MiB |  27924 MiB |  26980 MiB |
|       from small pool |     52 MiB |     70 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |   1244 MiB |   1670 TiB |   1670 TiB |
|       from large pool |      0 B   |   1235 MiB |   1643 TiB |   1643 TiB |
|       from small pool |      0 B   |     45 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395835 K  |  395835 K  |
|       from large pool |       2    |    1413    |  206181 K  |  206181 K  |
|       from small pool |       0    |    6298    |  189653 K  |  189653 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395835 K  |  395835 K  |
|       from large pool |       2    |    1413    |  206181 K  |  206181 K  |
|       from small pool |       0    |    6298    |  189653 K  |  189653 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     638    |    1206    |    1137    |
|       from large pool |      43    |     604    |    1164    |    1121    |
|       from small pool |      26    |      35    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2812    |  233609 K  |  233609 K  |
|       from large pool |       0    |     600    |  133285 K  |  133285 K  |
|       from small pool |       0    |    2768    |  100323 K  |  100323 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13264 MiB |   2260 TiB |   2260 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   2234 TiB |   2234 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13264 MiB |   2260 TiB |   2260 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   2234 TiB |   2234 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13261 MiB |   2256 TiB |   2256 TiB |
|       from large pool |  65536 KiB |  13223 MiB |   2230 TiB |   2230 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    996 MiB |  14520 MiB |  28008 MiB |  27012 MiB |
|       from large pool |    944 MiB |  14450 MiB |  27924 MiB |  26980 MiB |
|       from small pool |     52 MiB |     70 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |   1244 MiB |   1670 TiB |   1670 TiB |
|       from large pool |      0 B   |   1235 MiB |   1643 TiB |   1643 TiB |
|       from small pool |      0 B   |     45 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395835 K  |  395835 K  |
|       from large pool |       2    |    1413    |  206181 K  |  206181 K  |
|       from small pool |       0    |    6298    |  189653 K  |  189653 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395835 K  |  395835 K  |
|       from large pool |       2    |    1413    |  206181 K  |  206181 K  |
|       from small pool |       0    |    6298    |  189653 K  |  189653 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     638    |    1206    |    1137    |
|       from large pool |      43    |     604    |    1164    |    1121    |
|       from small pool |      26    |      35    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2812    |  233609 K  |  233609 K  |
|       from large pool |       0    |     600    |  133285 K  |  133285 K  |
|       from small pool |       0    |    2768    |  100323 K  |  100323 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182

 Experiment start at: 2024-06-07 18:17:08.877750
before training, model accuracy: 0.7679115533828735
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9654071, 'precision': 0.74317944, 'recall': 0.8103316, 'specificity': 0.8103316, 'f1': 0.7721737, 'auroc': 0.9483246, 'binary_precision': 0.49923116, 'binary_recall': 0.6437541, 'binary_specificity': 0.9769091, 'binary_f1_score': 0.5623556}
confusion matrix:
       0    1
0  41334  977
1    539  974
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.7461686, 'recall': 0.75564456, 'specificity': 0.75564456, 'f1': 0.7508074, 'auroc': 0.93713444, 'binary_precision': 0.5079872, 'binary_recall': 0.5282392, 'binary_specificity': 0.9830499, 'binary_f1_score': 0.51791525}
confusion matrix:
       0    1
0  17863  308
1    284  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9765988, 'precision': 0.8854395, 'recall': 0.767743, 'specificity': 0.767743, 'f1': 0.81503034, 'auroc': 0.9387161, 'binary_precision': 0.7891566, 'binary_recall': 0.5413223, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.64215684}
confusion matrix:
      0    1
0  5962   35
1   111  131
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-07 18:34:18.869461,epoch time: 0:17:09.991711,used: 0:17:09.991711,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96965134, 'precision': 0.8947305, 'recall': 0.5770458, 'specificity': 0.5770458, 'f1': 0.6228093, 'auroc': 0.96109605, 'binary_precision': 0.81881535, 'binary_recall': 0.15532055, 'binary_specificity': 0.998771, 'binary_f1_score': 0.2611111}
confusion matrix:
       0    1
0  42259   52
1   1278  235
---- Validation: 
scalar performance:
{'acc': 0.9693709, 'precision': 0.86234784, 'recall': 0.53286487, 'specificity': 0.53286487, 'f1': 0.55327547, 'auroc': 0.95023775, 'binary_precision': 0.754717, 'binary_recall': 0.06644518, 'binary_specificity': 0.99928457, 'binary_f1_score': 0.1221374}
confusion matrix:
       0   1
0  18158  13
1    562  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.898422, 'recall': 0.53074163, 'specificity': 0.53074163, 'f1': 0.54827994, 'auroc': 0.9518527, 'binary_precision': 0.8333333, 'binary_recall': 0.06198347, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.11538461}
confusion matrix:
      0   1
0  5994   3
1   227  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_2.png
better model found
persisted
after epoch: 2,now: 2024-06-07 18:50:10.662465,epoch time: 0:15:51.793004,used: 0:33:01.784715,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9735761, 'precision': 0.9035522, 'recall': 0.64599526, 'specificity': 0.64599526, 'f1': 0.71052116, 'auroc': 0.9687797, 'binary_precision': 0.8317757, 'binary_recall': 0.29411766, 'binary_specificity': 0.9978729, 'binary_f1_score': 0.43457034}
confusion matrix:
       0    1
0  42221   90
1   1068  445
---- Validation: 
scalar performance:
{'acc': 0.97240716, 'precision': 0.9207318, 'recall': 0.58181316, 'specificity': 0.58181316, 'f1': 0.63123584, 'auroc': 0.95086443, 'binary_precision': 0.8684211, 'binary_recall': 0.16445182, 'binary_specificity': 0.99917454, 'binary_f1_score': 0.27653632}
confusion matrix:
       0   1
0  18156  15
1    503  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.9825394, 'recall': 0.5516529, 'specificity': 0.5516529, 'f1': 0.5847475, 'auroc': 0.9505367, 'binary_precision': 1.0, 'binary_recall': 0.10330579, 'binary_specificity': 1.0, 'binary_f1_score': 0.18726592}
confusion matrix:
      0   1
0  5997   0
1   217  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_3.png
better model found
persisted
after epoch: 3,now: 2024-06-07 19:05:58.623258,epoch time: 0:15:47.960793,used: 0:48:49.745508,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97861904, 'precision': 0.87056744, 'recall': 0.7773423, 'specificity': 0.7773423, 'f1': 0.8166902, 'auroc': 0.9724581, 'binary_precision': 0.7566845, 'binary_recall': 0.56113684, 'binary_specificity': 0.9935478, 'binary_f1_score': 0.6444023}
confusion matrix:
       0    1
0  42038  273
1    664  849
---- Validation: 
scalar performance:
{'acc': 0.97677517, 'precision': 0.92761385, 'recall': 0.65955603, 'specificity': 0.65955603, 'f1': 0.72885704, 'auroc': 0.9630345, 'binary_precision': 0.8772727, 'binary_recall': 0.320598, 'binary_specificity': 0.9985141, 'binary_f1_score': 0.46958637}
confusion matrix:
       0    1
0  18144   27
1    409  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96970665, 'precision': 0.9077157, 'recall': 0.633297, 'specificity': 0.633297, 'f1': 0.6959897, 'auroc': 0.9513967, 'binary_precision': 0.84415585, 'binary_recall': 0.26859504, 'binary_specificity': 0.997999, 'binary_f1_score': 0.4075235}
confusion matrix:
      0   1
0  5985  12
1   177  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_4.png
better model found
persisted
after epoch: 4,now: 2024-06-07 19:22:04.775653,epoch time: 0:16:06.152395,used: 1:04:55.897903,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9768392, 'precision': 0.8154961, 'recall': 0.8688296, 'specificity': 0.8688296, 'f1': 0.83986896, 'auroc': 0.97574013, 'binary_precision': 0.63988763, 'binary_recall': 0.752809, 'binary_specificity': 0.9848503, 'binary_f1_score': 0.6917704}
confusion matrix:
       0     1
0  41670   641
1    374  1139
---- Validation: 
scalar performance:
{'acc': 0.97927874, 'precision': 0.8450443, 'recall': 0.8021859, 'specificity': 0.8021859, 'f1': 0.8220773, 'auroc': 0.96169794, 'binary_precision': 0.70285714, 'binary_recall': 0.6129568, 'binary_specificity': 0.9914149, 'binary_f1_score': 0.6548358}
confusion matrix:
       0    1
0  18015  156
1    233  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97371376, 'precision': 0.8603325, 'recall': 0.74443215, 'specificity': 0.74443215, 'f1': 0.79023826, 'auroc': 0.9557015, 'binary_precision': 0.7407407, 'binary_recall': 0.49586776, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.5940594}
confusion matrix:
      0    1
0  5955   42
1   122  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_5.png
better model found
persisted
after epoch: 5,now: 2024-06-07 19:38:22.558260,epoch time: 0:16:17.782607,used: 1:21:13.680510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98185927, 'precision': 0.8972523, 'recall': 0.80865496, 'specificity': 0.80865496, 'f1': 0.8469455, 'auroc': 0.977036, 'binary_precision': 0.80789024, 'binary_recall': 0.6226041, 'binary_specificity': 0.99470586, 'binary_f1_score': 0.7032474}
confusion matrix:
       0    1
0  42087  224
1    571  942
---- Validation: 
scalar performance:
{'acc': 0.9810366, 'precision': 0.8991896, 'recall': 0.7629415, 'specificity': 0.7629415, 'f1': 0.8160558, 'auroc': 0.96452045, 'binary_precision': 0.81377554, 'binary_recall': 0.5299003, 'binary_specificity': 0.9959826, 'binary_f1_score': 0.64185107}
confusion matrix:
       0    1
0  18098   73
1    283  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96537906, 'precision': 0.86886036, 'recall': 0.57552916, 'specificity': 0.57552916, 'f1': 0.61872506, 'auroc': 0.94092584, 'binary_precision': 0.7708333, 'binary_recall': 0.15289256, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.2551724}
confusion matrix:
      0   1
0  5986  11
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_6.png
better model found
persisted
after epoch: 6,now: 2024-06-07 19:54:57.482515,epoch time: 0:16:34.924255,used: 1:37:48.604765,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9815398, 'precision': 0.89031935, 'recall': 0.8113574, 'specificity': 0.8113574, 'f1': 0.8460307, 'auroc': 0.9779513, 'binary_precision': 0.79382306, 'binary_recall': 0.62855256, 'binary_specificity': 0.99416226, 'binary_f1_score': 0.7015861}
confusion matrix:
       0    1
0  42064  247
1    562  951
---- Validation: 
scalar performance:
{'acc': 0.9814095, 'precision': 0.89032185, 'recall': 0.7808012, 'specificity': 0.7808012, 'f1': 0.825968, 'auroc': 0.959857, 'binary_precision': 0.7948718, 'binary_recall': 0.5664452, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.6614937}
confusion matrix:
       0    1
0  18083   88
1    261  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663408, 'precision': 0.9438355, 'recall': 0.5720639, 'specificity': 0.5720639, 'f1': 0.616392, 'auroc': 0.9354741, 'binary_precision': 0.92105263, 'binary_recall': 0.1446281, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.25}
confusion matrix:
      0   1
0  5994   3
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_7.png
better model found
persisted
after epoch: 7,now: 2024-06-07 20:11:18.013856,epoch time: 0:16:20.531341,used: 1:54:09.136106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98395854, 'precision': 0.9063275, 'recall': 0.8377836, 'specificity': 0.8377836, 'f1': 0.86864233, 'auroc': 0.9828069, 'binary_precision': 0.824, 'binary_recall': 0.6807667, 'binary_specificity': 0.9948004, 'binary_f1_score': 0.7455664}
confusion matrix:
       0     1
0  42091   220
1    483  1030
---- Validation: 
scalar performance:
{'acc': 0.9816225, 'precision': 0.8661618, 'recall': 0.8218667, 'specificity': 0.8218667, 'f1': 0.84247315, 'auroc': 0.96873146, 'binary_precision': 0.743833, 'binary_recall': 0.6511628, 'binary_specificity': 0.9925706, 'binary_f1_score': 0.6944198}
confusion matrix:
       0    1
0  18036  135
1    210  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.8500365, 'recall': 0.5997389, 'specificity': 0.5997389, 'f1': 0.64990646, 'auroc': 0.95059067, 'binary_precision': 0.73134327, 'binary_recall': 0.20247933, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.31715208}
confusion matrix:
      0   1
0  5979  18
1   193  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_8.png
better model found
persisted
after epoch: 8,now: 2024-06-07 20:26:59.682181,epoch time: 0:15:41.668325,used: 2:09:50.804431,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9825894, 'precision': 0.8585589, 'recall': 0.89475054, 'specificity': 0.89475054, 'f1': 0.875703, 'auroc': 0.9828491, 'binary_precision': 0.7242823, 'binary_recall': 0.80039656, 'binary_specificity': 0.9891045, 'binary_f1_score': 0.7604396}
confusion matrix:
       0     1
0  41850   461
1    302  1211
---- Validation: 
scalar performance:
{'acc': 0.9802376, 'precision': 0.8301078, 'recall': 0.8749555, 'specificity': 0.8749555, 'f1': 0.8509737, 'auroc': 0.97344023, 'binary_precision': 0.6681223, 'binary_recall': 0.76245844, 'binary_specificity': 0.9874525, 'binary_f1_score': 0.71218}
confusion matrix:
       0    1
0  17943  228
1    143  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.80957544, 'recall': 0.6051035, 'specificity': 0.6051035, 'f1': 0.65252393, 'auroc': 0.9399786, 'binary_precision': 0.65, 'binary_recall': 0.21487603, 'binary_specificity': 0.995331, 'binary_f1_score': 0.32298136}
confusion matrix:
      0   1
0  5969  28
1   190  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_9.png
early stop counter: 1
val acc:0.980237603187561, best validation acc: 0.9816225171089172, corresponding to test acc:                         0.9661805033683777 / 0.9765987992286682
after epoch: 9,now: 2024-06-07 20:42:27.424504,epoch time: 0:15:27.742323,used: 2:25:18.546754,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98544174, 'precision': 0.9131426, 'recall': 0.8570335, 'specificity': 0.8570335, 'f1': 0.88287795, 'auroc': 0.98479235, 'binary_precision': 0.8362798, 'binary_recall': 0.71910113, 'binary_specificity': 0.99496585, 'binary_f1_score': 0.77327645}
confusion matrix:
       0     1
0  42098   213
1    425  1088
---- Validation: 
scalar performance:
{'acc': 0.98263466, 'precision': 0.8800781, 'recall': 0.8223895, 'specificity': 0.8223895, 'f1': 0.8486796, 'auroc': 0.973275, 'binary_precision': 0.77165353, 'binary_recall': 0.6511628, 'binary_specificity': 0.9936162, 'binary_f1_score': 0.7063064}
confusion matrix:
       0    1
0  18055  116
1    210  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.8305767, 'recall': 0.61361814, 'specificity': 0.61361814, 'f1': 0.6646951, 'auroc': 0.93770075, 'binary_precision': 0.69135803, 'binary_recall': 0.23140496, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.34674925}
confusion matrix:
      0   1
0  5972  25
1   186  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_10.png
better model found
persisted
after epoch: 10,now: 2024-06-07 20:58:03.758338,epoch time: 0:15:36.333834,used: 2:40:54.880588,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98553306, 'precision': 0.92203027, 'recall': 0.84783983, 'specificity': 0.84783983, 'f1': 0.88107705, 'auroc': 0.98482895, 'binary_precision': 0.85472155, 'binary_recall': 0.6999339, 'binary_specificity': 0.9957458, 'binary_f1_score': 0.7696221}
confusion matrix:
       0     1
0  42131   180
1    454  1059
---- Validation: 
scalar performance:
{'acc': 0.98327386, 'precision': 0.8911137, 'recall': 0.82031053, 'specificity': 0.82031053, 'f1': 0.8519203, 'auroc': 0.9725864, 'binary_precision': 0.79387754, 'binary_recall': 0.6461794, 'binary_specificity': 0.9944417, 'binary_f1_score': 0.7124542}
confusion matrix:
       0    1
0  18070  101
1    213  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.84475017, 'recall': 0.60981935, 'specificity': 0.60981935, 'f1': 0.66175395, 'auroc': 0.9459742, 'binary_precision': 0.72, 'binary_recall': 0.2231405, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.340694}
confusion matrix:
      0   1
0  5976  21
1   188  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_11.png
better model found
persisted
after epoch: 11,now: 2024-06-07 21:13:29.049335,epoch time: 0:15:25.290997,used: 2:56:20.171585,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98649144, 'precision': 0.9281938, 'recall': 0.85789573, 'specificity': 0.85789573, 'f1': 0.88965344, 'auroc': 0.98728645, 'binary_precision': 0.86634845, 'binary_recall': 0.7197621, 'binary_specificity': 0.9960294, 'binary_f1_score': 0.7862816}
confusion matrix:
       0     1
0  42143   168
1    424  1089
---- Validation: 
scalar performance:
{'acc': 0.98465884, 'precision': 0.9047345, 'recall': 0.8314656, 'specificity': 0.8314656, 'f1': 0.8641817, 'auroc': 0.9740193, 'binary_precision': 0.82040817, 'binary_recall': 0.6677741, 'binary_specificity': 0.9951571, 'binary_f1_score': 0.73626375}
confusion matrix:
       0    1
0  18083   88
1    200  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.8478655, 'recall': 0.5712302, 'specificity': 0.5712302, 'f1': 0.61166435, 'auroc': 0.9378627, 'binary_precision': 0.7291667, 'binary_recall': 0.1446281, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.24137929}
confusion matrix:
      0   1
0  5984  13
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_12.png
better model found
persisted
after epoch: 12,now: 2024-06-07 21:29:04.584138,epoch time: 0:15:35.534803,used: 3:11:55.706388,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9849169, 'precision': 0.88129485, 'recall': 0.89754915, 'specificity': 0.89754915, 'f1': 0.8892371, 'auroc': 0.9860179, 'binary_precision': 0.76962024, 'binary_recall': 0.8037013, 'binary_specificity': 0.991397, 'binary_f1_score': 0.7862916}
confusion matrix:
       0     1
0  41947   364
1    297  1216
---- Validation: 
scalar performance:
{'acc': 0.9821552, 'precision': 0.851877, 'recall': 0.8671125, 'specificity': 0.8671125, 'f1': 0.8593193, 'auroc': 0.97331357, 'binary_precision': 0.71224165, 'binary_recall': 0.74418604, 'binary_specificity': 0.99003905, 'binary_f1_score': 0.72786355}
confusion matrix:
       0    1
0  17990  181
1    154  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663408, 'precision': 0.8520904, 'recall': 0.60180503, 'specificity': 0.60180503, 'f1': 0.65266114, 'auroc': 0.94505465, 'binary_precision': 0.7352941, 'binary_recall': 0.20661157, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.32258067}
confusion matrix:
      0   1
0  5979  18
1   192  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_13.png
early stop counter: 1
val acc:0.9821552038192749, best validation acc: 0.9846588373184204, corresponding to test acc:                         0.9647379517555237 / 0.9765987992286682
after epoch: 13,now: 2024-06-07 21:44:45.139607,epoch time: 0:15:40.555469,used: 3:27:36.261857,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9862176, 'precision': 0.88972104, 'recall': 0.9090569, 'specificity': 0.9090569, 'f1': 0.89913404, 'auroc': 0.9872637, 'binary_precision': 0.7856694, 'binary_recall': 0.8261732, 'binary_specificity': 0.9919406, 'binary_f1_score': 0.80541235}
confusion matrix:
       0     1
0  41970   341
1    263  1250
---- Validation: 
scalar performance:
{'acc': 0.9838598, 'precision': 0.8682935, 'recall': 0.87361443, 'specificity': 0.87361443, 'f1': 0.8709333, 'auroc': 0.9779426, 'binary_precision': 0.7446808, 'binary_recall': 0.75581396, 'binary_specificity': 0.9914149, 'binary_f1_score': 0.7502061}
confusion matrix:
       0    1
0  18015  156
1    147  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.85351974, 'recall': 0.5977562, 'specificity': 0.5977562, 'f1': 0.6476836, 'auroc': 0.9440962, 'binary_precision': 0.73846155, 'binary_recall': 0.1983471, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.31270358}
confusion matrix:
      0   1
0  5980  17
1   194  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_14.png
early stop counter: 2
val acc:0.9838597774505615, best validation acc: 0.9846588373184204, corresponding to test acc:                         0.9647379517555237 / 0.9765987992286682
after epoch: 14,now: 2024-06-07 22:00:23.773227,epoch time: 0:15:38.633620,used: 3:43:14.895477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98790616, 'precision': 0.9240514, 'recall': 0.888263, 'specificity': 0.888263, 'f1': 0.90530455, 'auroc': 0.9898629, 'binary_precision': 0.85590154, 'binary_recall': 0.7812293, 'binary_specificity': 0.9952967, 'binary_f1_score': 0.81686246}
confusion matrix:
       0     1
0  42112   199
1    331  1182
---- Validation: 
scalar performance:
{'acc': 0.98460555, 'precision': 0.8883345, 'recall': 0.85392344, 'specificity': 0.85392344, 'f1': 0.8702684, 'auroc': 0.97585857, 'binary_precision': 0.78610605, 'binary_recall': 0.71428573, 'binary_specificity': 0.99356115, 'binary_f1_score': 0.74847704}
confusion matrix:
       0    1
0  18054  117
1    172  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.8818263, 'recall': 0.610403, 'specificity': 0.610403, 'f1': 0.6658931, 'auroc': 0.9424814, 'binary_precision': 0.7941176, 'binary_recall': 0.2231405, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.34838706}
confusion matrix:
      0   1
0  5983  14
1   188  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_15.png
early stop counter: 3
val acc:0.9846055507659912, best validation acc: 0.9846588373184204, corresponding to test acc:                         0.9647379517555237 / 0.9765987992286682
after epoch: 15,now: 2024-06-07 22:15:58.974674,epoch time: 0:15:35.201447,used: 3:58:50.096924,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9867196, 'precision': 0.94012296, 'recall': 0.84909165, 'specificity': 0.84909165, 'f1': 0.8889559, 'auroc': 0.9891883, 'binary_precision': 0.89084804, 'binary_recall': 0.7012558, 'binary_specificity': 0.9969275, 'binary_f1_score': 0.78476334}
confusion matrix:
       0     1
0  42181   130
1    452  1061
---- Validation: 
scalar performance:
{'acc': 0.98423266, 'precision': 0.9131619, 'recall': 0.8127754, 'specificity': 0.8127754, 'f1': 0.8555268, 'auroc': 0.9724711, 'binary_precision': 0.83849555, 'binary_recall': 0.6295681, 'binary_specificity': 0.9959826, 'binary_f1_score': 0.7191651}
confusion matrix:
       0    1
0  18098   73
1    223  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.9229348, 'recall': 0.530825, 'specificity': 0.530825, 'f1': 0.5485444, 'auroc': 0.92293996, 'binary_precision': 0.88235295, 'binary_recall': 0.06198347, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.11583011}
confusion matrix:
      0   1
0  5995   2
1   227  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_16.png
early stop counter: 4
val acc:0.9842326641082764, best validation acc: 0.9846588373184204, corresponding to test acc:                         0.9647379517555237 / 0.9765987992286682
after epoch: 16,now: 2024-06-07 22:31:36.020693,epoch time: 0:15:37.046019,used: 4:14:27.142943,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98906994, 'precision': 0.93115425, 'recall': 0.9000186, 'specificity': 0.9000186, 'f1': 0.91495585, 'auroc': 0.99112314, 'binary_precision': 0.8692857, 'binary_recall': 0.8043622, 'binary_specificity': 0.9956749, 'binary_f1_score': 0.8355647}
confusion matrix:
       0     1
0  42128   183
1    296  1217
---- Validation: 
scalar performance:
{'acc': 0.985884, 'precision': 0.9151139, 'recall': 0.8433412, 'specificity': 0.8433412, 'f1': 0.8755808, 'auroc': 0.97213864, 'binary_precision': 0.84040403, 'binary_recall': 0.6910299, 'binary_specificity': 0.99565244, 'binary_f1_score': 0.7584321}
confusion matrix:
       0    1
0  18092   79
1    186  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.90822315, 'recall': 0.5697477, 'specificity': 0.5697477, 'f1': 0.611794, 'auroc': 0.9290646, 'binary_precision': 0.85, 'binary_recall': 0.14049587, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.24113475}
confusion matrix:
      0   1
0  5991   6
1   208  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_17.png
better model found
persisted
after epoch: 17,now: 2024-06-07 22:47:10.819870,epoch time: 0:15:34.799177,used: 4:30:01.942120,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9890243, 'precision': 0.9426357, 'recall': 0.8856555, 'specificity': 0.8856555, 'f1': 0.91203195, 'auroc': 0.9925524, 'binary_precision': 0.89329267, 'binary_recall': 0.77461994, 'binary_specificity': 0.99669117, 'binary_f1_score': 0.8297345}
confusion matrix:
       0     1
0  42171   140
1    341  1172
---- Validation: 
scalar performance:
{'acc': 0.9855111, 'precision': 0.91649044, 'recall': 0.834315, 'specificity': 0.834315, 'f1': 0.8705772, 'auroc': 0.97487545, 'binary_precision': 0.84375, 'binary_recall': 0.67275745, 'binary_specificity': 0.99587256, 'binary_f1_score': 0.7486137}
confusion matrix:
       0    1
0  18096   75
1    197  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.89456284, 'recall': 0.57577926, 'specificity': 0.57577926, 'f1': 0.6201839, 'auroc': 0.9307555, 'binary_precision': 0.82222223, 'binary_recall': 0.15289256, 'binary_specificity': 0.998666, 'binary_f1_score': 0.2578397}
confusion matrix:
      0   1
0  5989   8
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_18.png
early stop counter: 1
val acc:0.9855111241340637, best validation acc: 0.9858840107917786, corresponding to test acc:                         0.9656996130943298 / 0.9765987992286682
after epoch: 18,now: 2024-06-07 23:02:45.903979,epoch time: 0:15:35.084109,used: 4:45:37.026229,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9866968, 'precision': 0.9581803, 'recall': 0.8321912, 'specificity': 0.8321912, 'f1': 0.8844141, 'auroc': 0.9917112, 'binary_precision': 0.9281768, 'binary_recall': 0.666226, 'binary_specificity': 0.9981565, 'binary_f1_score': 0.775683}
confusion matrix:
       0     1
0  42233    78
1    505  1008
---- Validation: 
scalar performance:
{'acc': 0.98433924, 'precision': 0.92600703, 'recall': 0.8015877, 'specificity': 0.8015877, 'f1': 0.85242033, 'auroc': 0.97184, 'binary_precision': 0.8649289, 'binary_recall': 0.6063123, 'binary_specificity': 0.9968631, 'binary_f1_score': 0.71289057}
confusion matrix:
       0    1
0  18114   57
1    237  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96537906, 'precision': 0.8879796, 'recall': 0.5695809, 'specificity': 0.5695809, 'f1': 0.6108615, 'auroc': 0.9241973, 'binary_precision': 0.8095238, 'binary_recall': 0.14049587, 'binary_specificity': 0.998666, 'binary_f1_score': 0.23943661}
confusion matrix:
      0   1
0  5989   8
1   208  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_19.png
early stop counter: 2
val acc:0.9843392372131348, best validation acc: 0.9858840107917786, corresponding to test acc:                         0.9656996130943298 / 0.9765987992286682
after epoch: 19,now: 2024-06-07 23:18:14.346114,epoch time: 0:15:28.442135,used: 5:01:05.468364,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9899142, 'precision': 0.9399635, 'recall': 0.90396094, 'specificity': 0.90396094, 'f1': 0.9211328, 'auroc': 0.9920894, 'binary_precision': 0.8866426, 'binary_recall': 0.8116325, 'binary_specificity': 0.9962894, 'binary_f1_score': 0.84748095}
confusion matrix:
       0     1
0  42154   157
1    285  1228
---- Validation: 
scalar performance:
{'acc': 0.98476535, 'precision': 0.8952304, 'recall': 0.8467786, 'specificity': 0.8467786, 'f1': 0.86930037, 'auroc': 0.97703934, 'binary_precision': 0.80038023, 'binary_recall': 0.6993356, 'binary_specificity': 0.99422157, 'binary_f1_score': 0.7464539}
confusion matrix:
       0    1
0  18066  105
1    181  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9677833, 'precision': 0.90819484, 'recall': 0.6025554, 'specificity': 0.6025554, 'f1': 0.6578597, 'auroc': 0.943431, 'binary_precision': 0.84745765, 'binary_recall': 0.20661157, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.33222592}
confusion matrix:
      0   1
0  5988   9
1   192  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_20.png
early stop counter: 3
val acc:0.984765350818634, best validation acc: 0.9858840107917786, corresponding to test acc:                         0.9656996130943298 / 0.9765987992286682
after epoch: 20,now: 2024-06-07 23:33:54.607538,epoch time: 0:15:40.261424,used: 5:16:45.729788,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9885679, 'precision': 0.91088074, 'recall': 0.919515, 'specificity': 0.919515, 'f1': 0.9151491, 'auroc': 0.9918885, 'binary_precision': 0.82729626, 'binary_recall': 0.8453404, 'binary_specificity': 0.9936896, 'binary_f1_score': 0.836221}
confusion matrix:
       0     1
0  42044   267
1    234  1279
---- Validation: 
scalar performance:
{'acc': 0.9831673, 'precision': 0.8550744, 'recall': 0.88690853, 'specificity': 0.88690853, 'f1': 0.87024885, 'auroc': 0.9760082, 'binary_precision': 0.7173252, 'binary_recall': 0.78405315, 'binary_specificity': 0.9897639, 'binary_f1_score': 0.74920636}
confusion matrix:
       0    1
0  17985  186
1    130  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.8124521, 'recall': 0.65162367, 'specificity': 0.65162367, 'f1': 0.7015451, 'auroc': 0.9406926, 'binary_precision': 0.65217394, 'binary_recall': 0.30991736, 'binary_specificity': 0.99333, 'binary_f1_score': 0.42016804}
confusion matrix:
      0   1
0  5957  40
1   167  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_21.png
early stop counter: 4
val acc:0.983167290687561, best validation acc: 0.9858840107917786, corresponding to test acc:                         0.9656996130943298 / 0.9765987992286682
after epoch: 21,now: 2024-06-07 23:49:24.698625,epoch time: 0:15:30.091087,used: 5:32:15.820875,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9898229, 'precision': 0.9378954, 'recall': 0.9048696, 'specificity': 0.9048696, 'f1': 0.9206834, 'auroc': 0.99345195, 'binary_precision': 0.8824373, 'binary_recall': 0.8136153, 'binary_specificity': 0.9961239, 'binary_f1_score': 0.84663}
confusion matrix:
       0     1
0  42147   164
1    282  1231
---- Validation: 
scalar performance:
{'acc': 0.98513824, 'precision': 0.8967312, 'recall': 0.85259247, 'specificity': 0.85259247, 'f1': 0.8732612, 'auroc': 0.9721777, 'binary_precision': 0.8030019, 'binary_recall': 0.7109634, 'binary_specificity': 0.99422157, 'binary_f1_score': 0.75418496}
confusion matrix:
       0    1
0  18066  105
1    174  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.8123542, 'recall': 0.5586667, 'specificity': 0.5586667, 'f1': 0.5920482, 'auroc': 0.92541504, 'binary_precision': 0.65909094, 'binary_recall': 0.11983471, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.2027972}
confusion matrix:
      0   1
0  5982  15
1   213  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_22.png
early stop counter: 5
val acc:0.9851382374763489, best validation acc: 0.9858840107917786, corresponding to test acc:                         0.9656996130943298 / 0.9765987992286682
after epoch: 22,now: 2024-06-08 00:04:54.940140,epoch time: 0:15:30.241515,used: 5:47:46.062390,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98973167, 'precision': 0.920811, 'recall': 0.926172, 'specificity': 0.926172, 'f1': 0.9234731, 'auroc': 0.993262, 'binary_precision': 0.8467058, 'binary_recall': 0.85789824, 'binary_specificity': 0.99444586, 'binary_f1_score': 0.85226524}
confusion matrix:
       0     1
0  42076   235
1    215  1298
---- Validation: 
scalar performance:
{'acc': 0.9856709, 'precision': 0.8907162, 'recall': 0.87374693, 'specificity': 0.87374693, 'f1': 0.8820282, 'auroc': 0.9720992, 'binary_precision': 0.7895652, 'binary_recall': 0.75415283, 'binary_specificity': 0.993341, 'binary_f1_score': 0.77145284}
confusion matrix:
       0    1
0  18050  121
1    148  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.8933209, 'recall': 0.5655321, 'specificity': 0.5655321, 'f1': 0.6049833, 'auroc': 0.93438816, 'binary_precision': 0.82051283, 'binary_recall': 0.1322314, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.22775799}
confusion matrix:
      0   1
0  5990   7
1   210  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_23.png
early stop counter: 6
val acc:0.9856709241867065, best validation acc: 0.9858840107917786, corresponding to test acc:                         0.9656996130943298 / 0.9765987992286682
after epoch: 23,now: 2024-06-08 00:20:22.445701,epoch time: 0:15:27.505561,used: 6:03:13.567951,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.989686, 'precision': 0.9365243, 'recall': 0.90416145, 'specificity': 0.90416145, 'f1': 0.91966975, 'auroc': 0.9933138, 'binary_precision': 0.8797423, 'binary_recall': 0.81229347, 'binary_specificity': 0.9960294, 'binary_f1_score': 0.8446736}
confusion matrix:
       0     1
0  42143   168
1    284  1229
---- Validation: 
scalar performance:
{'acc': 0.98508495, 'precision': 0.9021611, 'recall': 0.84373146, 'specificity': 0.84373146, 'f1': 0.870484, 'auroc': 0.9758111, 'binary_precision': 0.8144531, 'binary_recall': 0.692691, 'binary_specificity': 0.9947719, 'binary_f1_score': 0.74865353}
confusion matrix:
       0    1
0  18076   95
1    185  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.8392713, 'recall': 0.5406553, 'specificity': 0.5406553, 'f1': 0.564654, 'auroc': 0.92837775, 'binary_precision': 0.71428573, 'binary_recall': 0.08264463, 'binary_specificity': 0.998666, 'binary_f1_score': 0.14814815}
confusion matrix:
      0   1
0  5989   8
1   222  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_24.png
early stop counter: 7
val acc:0.9850849509239197, best validation acc: 0.9858840107917786, corresponding to test acc:                         0.9656996130943298 / 0.9765987992286682
after epoch: 24,now: 2024-06-08 00:35:52.276967,epoch time: 0:15:29.831266,used: 6:18:43.399217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9900283, 'precision': 0.9154599, 'recall': 0.9400277, 'specificity': 0.9400277, 'f1': 0.9273606, 'auroc': 0.9946374, 'binary_precision': 0.8349938, 'binary_recall': 0.88631856, 'binary_specificity': 0.99373686, 'binary_f1_score': 0.859891}
confusion matrix:
       0     1
0  42046   265
1    172  1341
---- Validation: 
scalar performance:
{'acc': 0.98396635, 'precision': 0.8627752, 'recall': 0.88892734, 'specificity': 0.88892734, 'f1': 0.8753572, 'auroc': 0.9775393, 'binary_precision': 0.7326121, 'binary_recall': 0.7873754, 'binary_specificity': 0.99047935, 'binary_f1_score': 0.75900716}
confusion matrix:
       0    1
0  17998  173
1    128  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.8039262, 'recall': 0.60700285, 'specificity': 0.60700285, 'f1': 0.6540668, 'auroc': 0.92795247, 'binary_precision': 0.6385542, 'binary_recall': 0.21900827, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.32615384}
confusion matrix:
      0   1
0  5967  30
1   189  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_25.png
early stop counter: 8
val acc:0.9839663505554199, best validation acc: 0.9858840107917786, corresponding to test acc:                         0.9656996130943298 / 0.9765987992286682
after epoch: 25,now: 2024-06-08 00:51:24.279007,epoch time: 0:15:32.002040,used: 6:34:15.401257,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9891612, 'precision': 0.9061693, 'recall': 0.93894136, 'specificity': 0.93894136, 'f1': 0.92186415, 'auroc': 0.99351746, 'binary_precision': 0.8164634, 'binary_recall': 0.8849967, 'binary_specificity': 0.992886, 'binary_f1_score': 0.84934986}
confusion matrix:
       0     1
0  42010   301
1    174  1339
---- Validation: 
scalar performance:
{'acc': 0.98311406, 'precision': 0.86028886, 'recall': 0.87242615, 'specificity': 0.87242615, 'f1': 0.86624837, 'auroc': 0.97581476, 'binary_precision': 0.72873193, 'binary_recall': 0.75415283, 'binary_specificity': 0.99069947, 'binary_f1_score': 0.7412245}
confusion matrix:
       0    1
0  18002  169
1    148  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.76960325, 'recall': 0.6341776, 'specificity': 0.6341776, 'f1': 0.6767861, 'auroc': 0.9338858, 'binary_precision': 0.5677966, 'binary_recall': 0.2768595, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.3722222}
confusion matrix:
      0   1
0  5946  51
1   175  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_26.png
early stop counter: 9
val acc:0.9831140637397766, best validation acc: 0.9858840107917786, corresponding to test acc:                         0.9656996130943298 / 0.9765987992286682
after epoch: 26,now: 2024-06-08 01:06:58.421590,epoch time: 0:15:34.142583,used: 6:49:49.543840,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9913061, 'precision': 0.95583165, 'recall': 0.9094616, 'specificity': 0.9094616, 'f1': 0.93130726, 'auroc': 0.9946531, 'binary_precision': 0.91802067, 'binary_recall': 0.8215466, 'binary_specificity': 0.99737656, 'binary_f1_score': 0.86710846}
confusion matrix:
       0     1
0  42200   111
1    270  1243
---- Validation: 
scalar performance:
{'acc': 0.98577744, 'precision': 0.92022014, 'recall': 0.8352556, 'specificity': 0.8352556, 'f1': 0.8726135, 'auroc': 0.9731133, 'binary_precision': 0.851153, 'binary_recall': 0.6744186, 'binary_specificity': 0.9960927, 'binary_f1_score': 0.7525487}
confusion matrix:
       0    1
0  18100   71
1    196  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.88557875, 'recall': 0.56751484, 'specificity': 0.56751484, 'f1': 0.6077107, 'auroc': 0.943039, 'binary_precision': 0.80487806, 'binary_recall': 0.13636364, 'binary_specificity': 0.998666, 'binary_f1_score': 0.23321557}
confusion matrix:
      0   1
0  5989   8
1   209  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_27.png
early stop counter: 10
val acc:0.9857774376869202, best validation acc: 0.9858840107917786, corresponding to test acc:                         0.9656996130943298 / 0.9765987992286682
after epoch: 27,now: 2024-06-08 01:22:24.754175,epoch time: 0:15:26.332585,used: 7:05:15.876425,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9900283, 'precision': 0.9559029, 'recall': 0.88840604, 'specificity': 0.88840604, 'f1': 0.91924965, 'auroc': 0.9951297, 'binary_precision': 0.9196568, 'binary_recall': 0.7792465, 'binary_specificity': 0.9975656, 'binary_f1_score': 0.8436493}
confusion matrix:
       0     1
0  42208   103
1    334  1179
---- Validation: 
scalar performance:
{'acc': 0.98561764, 'precision': 0.92633975, 'recall': 0.8255365, 'specificity': 0.8255365, 'f1': 0.8687009, 'auroc': 0.9686185, 'binary_precision': 0.86403507, 'binary_recall': 0.65448505, 'binary_specificity': 0.996588, 'binary_f1_score': 0.7448015}
confusion matrix:
       0    1
0  18109   62
1    208  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.86838675, 'recall': 0.55511814, 'specificity': 0.55511814, 'f1': 0.5883343, 'auroc': 0.90623856, 'binary_precision': 0.7714286, 'binary_recall': 0.11157025, 'binary_specificity': 0.998666, 'binary_f1_score': 0.19494584}
confusion matrix:
      0   1
0  5989   8
1   215  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_28.png
early stop counter: 11
val acc:0.9856176376342773, best validation acc: 0.9858840107917786, corresponding to test acc:                         0.9656996130943298 / 0.9765987992286682
after epoch: 28,now: 2024-06-08 01:37:52.349296,epoch time: 0:15:27.595121,used: 7:20:43.471546,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9900511, 'precision': 0.97125816, 'recall': 0.8743972, 'specificity': 0.8743972, 'f1': 0.9168718, 'auroc': 0.99574035, 'binary_precision': 0.95138305, 'binary_recall': 0.7501652, 'binary_specificity': 0.9986292, 'binary_f1_score': 0.8388765}
confusion matrix:
       0     1
0  42253    58
1    378  1135
---- Validation: 
scalar performance:
{'acc': 0.98492515, 'precision': 0.9535449, 'recall': 0.78904164, 'specificity': 0.78904164, 'f1': 0.8518896, 'auroc': 0.976781, 'binary_precision': 0.9208443, 'binary_recall': 0.5797342, 'binary_specificity': 0.998349, 'binary_f1_score': 0.7115188}
confusion matrix:
       0    1
0  18141   30
1    253  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.8751466, 'recall': 0.5449543, 'specificity': 0.5449543, 'f1': 0.5722253, 'auroc': 0.929709, 'binary_precision': 0.78571427, 'binary_recall': 0.09090909, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.16296297}
confusion matrix:
      0   1
0  5991   6
1   220  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_29.png
early stop counter: 12
val acc:0.9849251508712769, best validation acc: 0.9858840107917786, corresponding to test acc:                         0.9656996130943298 / 0.9765987992286682
after epoch: 29,now: 2024-06-08 01:53:16.669300,epoch time: 0:15:24.320004,used: 7:36:07.791550,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9904618, 'precision': 0.94979227, 'recall': 0.902014, 'specificity': 0.902014, 'f1': 0.9244581, 'auroc': 0.9951899, 'binary_precision': 0.9064588, 'binary_recall': 0.80700594, 'binary_specificity': 0.99702203, 'binary_f1_score': 0.85384613}
confusion matrix:
       0     1
0  42185   126
1    292  1221
---- Validation: 
scalar performance:
{'acc': 0.98492515, 'precision': 0.91793203, 'recall': 0.82116354, 'specificity': 0.82116354, 'f1': 0.86275697, 'auroc': 0.9676039, 'binary_precision': 0.84749454, 'binary_recall': 0.6461794, 'binary_specificity': 0.9961477, 'binary_f1_score': 0.73327047}
confusion matrix:
       0    1
0  18101   70
1    213  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.82812715, 'recall': 0.5365231, 'specificity': 0.5365231, 'f1': 0.5576638, 'auroc': 0.8946097, 'binary_precision': 0.6923077, 'binary_recall': 0.07438017, 'binary_specificity': 0.998666, 'binary_f1_score': 0.13432837}
confusion matrix:
      0   1
0  5989   8
1   224  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170182_30.png
early stop counter: 13
val acc:0.9849251508712769, best validation acc: 0.9858840107917786, corresponding to test acc:                         0.9656996130943298 / 0.9765987992286682
after epoch: 30,now: 2024-06-08 02:08:42.317697,epoch time: 0:15:25.648397,used: 7:51:33.439947,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_18_17_08_seed_2_21170182
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:51:33.439947 at 2024-06-08 02:08:42.317697
persisted model performance metric: 

scalar performance:
{'acc': 0.9661805, 'precision': 0.93202436, 'recall': 0.57198054, 'specificity': 0.57198054, 'f1': 0.61590546, 'auroc': 0.9456683, 'binary_precision': 0.8974359, 'binary_recall': 0.1446281, 'binary_specificity': 0.999333, 'binary_f1_score': 0.24911033}
confusion matrix:
      0   1
0  5993   4
1   207  35
oracle model performance metric: 

scalar performance:
{'acc': 0.9764385, 'precision': 0.88147163, 'recall': 0.7696424, 'specificity': 0.7696424, 'f1': 0.81507695, 'auroc': 0.933054, 'binary_precision': 0.7810651, 'binary_recall': 0.54545456, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.6423358}
confusion matrix:
      0    1
0  5960   37
1   110  132
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 502021 KiB |  13264 MiB |   3385 TiB |   3385 TiB |
|       from large pool | 460339 KiB |  13226 MiB |   3345 TiB |   3345 TiB |
|       from small pool |  41681 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 502021 KiB |  13264 MiB |   3385 TiB |   3385 TiB |
|       from large pool | 460339 KiB |  13226 MiB |   3345 TiB |   3345 TiB |
|       from small pool |  41681 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 496649 KiB |  13261 MiB |   3380 TiB |   3380 TiB |
|       from large pool | 455971 KiB |  13223 MiB |   3341 TiB |   3341 TiB |
|       from small pool |  40678 KiB |     60 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14524 MiB |  14524 MiB |  41536 MiB |  27012 MiB |
|       from large pool |  14458 MiB |  14458 MiB |  41438 MiB |  26980 MiB |
|       from small pool |     66 MiB |     70 MiB |     98 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 491259 KiB |   1253 MiB |   2448 TiB |   2448 TiB |
|       from large pool | 479692 KiB |   1244 MiB |   2408 TiB |   2408 TiB |
|       from small pool |  11566 KiB |     45 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    6487    |  593147 K  |  593143 K  |
|       from large pool |     187    |    1413    |  308897 K  |  308897 K  |
|       from small pool |    3289    |    6298    |  284250 K  |  284246 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    6487    |  593147 K  |  593143 K  |
|       from large pool |     187    |    1413    |  308897 K  |  308897 K  |
|       from small pool |    3289    |    6298    |  284250 K  |  284246 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     639    |     639    |    1776    |    1137    |
|       from large pool |     606    |     606    |    1727    |    1121    |
|       from small pool |      33    |      35    |      49    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      89    |    2812    |  342912 K  |  342912 K  |
|       from large pool |      42    |     600    |  193104 K  |  193104 K  |
|       from small pool |      47    |    2768    |  149808 K  |  149808 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13264 MiB |   3385 TiB |   3385 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   3345 TiB |   3345 TiB |
|       from small pool |      0 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13264 MiB |   3385 TiB |   3385 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   3345 TiB |   3345 TiB |
|       from small pool |      0 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13261 MiB |   3380 TiB |   3380 TiB |
|       from large pool |  65536 KiB |  13223 MiB |   3341 TiB |   3341 TiB |
|       from small pool |      0 KiB |     60 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    970 MiB |  14524 MiB |  41536 MiB |  40566 MiB |
|       from large pool |    918 MiB |  14458 MiB |  41438 MiB |  40520 MiB |
|       from small pool |     52 MiB |     70 MiB |     98 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |   1253 MiB |   2448 TiB |   2448 TiB |
|       from large pool |      0 B   |   1244 MiB |   2408 TiB |   2408 TiB |
|       from small pool |      0 B   |     46 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  593147 K  |  593147 K  |
|       from large pool |       2    |    1413    |  308897 K  |  308897 K  |
|       from small pool |       0    |    6298    |  284250 K  |  284250 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  593147 K  |  593147 K  |
|       from large pool |       2    |    1413    |  308897 K  |  308897 K  |
|       from small pool |       0    |    6298    |  284250 K  |  284250 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     639    |    1776    |    1707    |
|       from large pool |      43    |     606    |    1727    |    1684    |
|       from small pool |      26    |      35    |      49    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2812    |  342913 K  |  342913 K  |
|       from large pool |       0    |     600    |  193104 K  |  193104 K  |
|       from small pool |       0    |    2768    |  149809 K  |  149809 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jun  8 02:10:22 2024]
Finished job 0.
1 of 1 steps (100%) done
