Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jun  7 01:22:19 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_29_35_seed_0_21170267

 Experiment start at: 2024-06-07 01:29:35.217195
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9717528, 'precision': 0.7868155, 'recall': 0.7549002, 'specificity': 0.7549002, 'f1': 0.76982427, 'auroc': 0.9667883, 'binary_precision': 0.5901765, 'binary_recall': 0.5224185, 'binary_specificity': 0.9873819, 'binary_f1_score': 0.5542342}
confusion matrix:
       0    1
0  41786  534
1    703  769
---- Validation: 
scalar performance:
{'acc': 0.969668, 'precision': 0.77218187, 'recall': 0.7525296, 'specificity': 0.7525296, 'f1': 0.7619487, 'auroc': 0.96697414, 'binary_precision': 0.56134456, 'binary_recall': 0.5194401, 'binary_specificity': 0.98561907, 'binary_f1_score': 0.53958}
confusion matrix:
       0    1
0  17888  261
1    309  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97219557, 'precision': 0.8456526, 'recall': 0.7766067, 'specificity': 0.7766067, 'f1': 0.8068814, 'auroc': 0.9473381, 'binary_precision': 0.71014494, 'binary_recall': 0.5632184, 'binary_specificity': 0.989995, 'binary_f1_score': 0.6282052}
confusion matrix:
      0    1
0  5937   60
1   114  147
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170267_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-07 02:10:50.659712,epoch time: 0:41:15.442517,used: 0:41:15.442517,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_29_35_seed_0_21170267
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9788774, 'precision': 0.85936165, 'recall': 0.78781056, 'specificity': 0.78781056, 'f1': 0.8192996, 'auroc': 0.9791486, 'binary_precision': 0.73310524, 'binary_recall': 0.5829932, 'binary_specificity': 0.9926279, 'binary_f1_score': 0.64948845}
confusion matrix:
       0    1
0  42010  312
1    613  857
---- Validation: 
scalar performance:
{'acc': 0.9780758, 'precision': 0.8810977, 'recall': 0.74788177, 'specificity': 0.74788177, 'f1': 0.7992847, 'auroc': 0.9751835, 'binary_precision': 0.779661, 'binary_recall': 0.5007776, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.60984844}
confusion matrix:
       0    1
0  18058   91
1    321  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8156578, 'recall': 0.5787089, 'specificity': 0.5787089, 'f1': 0.6197871, 'auroc': 0.95369285, 'binary_precision': 0.6666667, 'binary_recall': 0.16091955, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.25925928}
confusion matrix:
      0   1
0  5976  21
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170267_2.png
better model found
persisted
after epoch: 2,now: 2024-06-07 02:50:38.819400,epoch time: 0:39:48.159688,used: 1:21:03.602205,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_29_35_seed_0_21170267
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.981572, 'precision': 0.8506874, 'recall': 0.8766184, 'specificity': 0.8766184, 'f1': 0.863148, 'auroc': 0.983322, 'binary_precision': 0.709596, 'binary_recall': 0.76410604, 'binary_specificity': 0.9891307, 'binary_f1_score': 0.73584294}
confusion matrix:
       0     1
0  41861   460
1    347  1124
---- Validation: 
scalar performance:
{'acc': 0.98020434, 'precision': 0.85845256, 'recall': 0.8314898, 'specificity': 0.8314898, 'f1': 0.8443974, 'auroc': 0.97687197, 'binary_precision': 0.7284992, 'binary_recall': 0.6718507, 'binary_specificity': 0.991129, 'binary_f1_score': 0.69902915}
confusion matrix:
       0    1
0  17988  161
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.8310502, 'recall': 0.6634151, 'specificity': 0.6634151, 'f1': 0.7160256, 'auroc': 0.94728696, 'binary_precision': 0.6904762, 'binary_recall': 0.33333334, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.44961238}
confusion matrix:
      0   1
0  5958  39
1   174  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170267_3.png
better model found
persisted
after epoch: 3,now: 2024-06-07 03:30:25.911693,epoch time: 0:39:47.092293,used: 2:00:50.694498,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_29_35_seed_0_21170267
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98079556, 'precision': 0.9367182, 'recall': 0.7431859, 'specificity': 0.7431859, 'f1': 0.81055987, 'auroc': 0.9856007, 'binary_precision': 0.89095414, 'binary_recall': 0.4884511, 'binary_specificity': 0.99792063, 'binary_f1_score': 0.63097847}
confusion matrix:
       0    1
0  42232   88
1    753  719
---- Validation: 
scalar performance:
{'acc': 0.97871435, 'precision': 0.9444617, 'recall': 0.7092095, 'specificity': 0.7092095, 'f1': 0.78177613, 'auroc': 0.9788672, 'binary_precision': 0.90909094, 'binary_recall': 0.41990668, 'binary_specificity': 0.9985123, 'binary_f1_score': 0.5744681}
confusion matrix:
       0    1
0  18122   27
1    373  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8389435, 'recall': 0.56588256, 'specificity': 0.56588256, 'f1': 0.603072, 'auroc': 0.9515364, 'binary_precision': 0.71428573, 'binary_recall': 0.13409962, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.22580646}
confusion matrix:
      0   1
0  5983  14
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170267_4.png
early stop counter: 1
val acc:0.9787143468856812, best validation acc: 0.9802043437957764, corresponding to test acc:                         0.9659635424613953 / 0.972195565700531
after epoch: 4,now: 2024-06-07 04:10:05.858796,epoch time: 0:39:39.947103,used: 2:40:30.641601,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_29_35_seed_0_21170267
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9838098, 'precision': 0.87006366, 'recall': 0.8863065, 'specificity': 0.8863065, 'f1': 0.87799525, 'auroc': 0.9882752, 'binary_precision': 0.7477243, 'binary_recall': 0.7817811, 'binary_specificity': 0.990832, 'binary_f1_score': 0.76437354}
confusion matrix:
       0     1
0  41933   388
1    321  1150
---- Validation: 
scalar performance:
{'acc': 0.98318434, 'precision': 0.8742791, 'recall': 0.8697853, 'specificity': 0.8697853, 'f1': 0.8720174, 'auroc': 0.9826685, 'binary_precision': 0.7574803, 'binary_recall': 0.748056, 'binary_specificity': 0.9915147, 'binary_f1_score': 0.75273865}
confusion matrix:
       0    1
0  17995  154
1    162  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8229151, 'recall': 0.5994482, 'specificity': 0.5994482, 'f1': 0.646775, 'auroc': 0.9510993, 'binary_precision': 0.67948717, 'binary_recall': 0.20306513, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.31268436}
confusion matrix:
      0   1
0  5972  25
1   208  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170267_5.png
better model found
persisted
after epoch: 5,now: 2024-06-07 04:49:43.214897,epoch time: 0:39:37.356101,used: 3:20:07.997702,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_29_35_seed_0_21170267
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9842665, 'precision': 0.92221093, 'recall': 0.81743854, 'specificity': 0.81743854, 'f1': 0.8618489, 'auroc': 0.98834616, 'binary_precision': 0.8568824, 'binary_recall': 0.63858694, 'binary_specificity': 0.99629015, 'binary_f1_score': 0.7318022}
confusion matrix:
       0    1
0  42163  157
1    532  940
---- Validation: 
scalar performance:
{'acc': 0.9828118, 'precision': 0.90302026, 'recall': 0.8170886, 'specificity': 0.8170886, 'f1': 0.85451984, 'auroc': 0.97759444, 'binary_precision': 0.8187251, 'binary_recall': 0.63919127, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.7179039}
confusion matrix:
       0    1
0  18058   91
1    232  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.8605872, 'recall': 0.5358982, 'specificity': 0.5358982, 'f1': 0.55629456, 'auroc': 0.94920087, 'binary_precision': 0.76, 'binary_recall': 0.07279693, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.13286713}
confusion matrix:
      0   1
0  5991   6
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170267_6.png
early stop counter: 1
val acc:0.9828118085861206, best validation acc: 0.9831843376159668, corresponding to test acc:                         0.9627676606178284 / 0.972195565700531
after epoch: 6,now: 2024-06-07 05:29:24.386691,epoch time: 0:39:41.171794,used: 3:59:49.169496,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_29_35_seed_0_21170267
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9878517, 'precision': 0.9510761, 'recall': 0.8520794, 'specificity': 0.8520794, 'f1': 0.8950319, 'auroc': 0.9925333, 'binary_precision': 0.9122807, 'binary_recall': 0.70652175, 'binary_specificity': 0.99763703, 'binary_f1_score': 0.7963247}
confusion matrix:
       0     1
0  42220   100
1    432  1040
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.92756724, 'recall': 0.84877133, 'specificity': 0.84877133, 'f1': 0.8838601, 'auroc': 0.98421717, 'binary_precision': 0.86564296, 'binary_recall': 0.7013997, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.7749141}
confusion matrix:
       0    1
0  18079   70
1    192  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8402616, 'recall': 0.54331094, 'specificity': 0.54331094, 'f1': 0.56839436, 'auroc': 0.95263886, 'binary_precision': 0.71875, 'binary_recall': 0.08812261, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.1569966}
confusion matrix:
      0   1
0  5988   9
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170267_7.png
better model found
persisted
after epoch: 7,now: 2024-06-07 06:09:01.658389,epoch time: 0:39:37.271698,used: 4:39:26.441194,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_29_35_seed_0_21170267
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9860477, 'precision': 0.94615626, 'recall': 0.82590085, 'specificity': 0.82590085, 'f1': 0.87599003, 'auroc': 0.9921, 'binary_precision': 0.90422535, 'binary_recall': 0.65421194, 'binary_specificity': 0.99758977, 'binary_f1_score': 0.7591643}
confusion matrix:
       0    1
0  42218  102
1    509  963
---- Validation: 
scalar performance:
{'acc': 0.98185396, 'precision': 0.9090741, 'recall': 0.7918409, 'specificity': 0.7918409, 'f1': 0.8399032, 'auroc': 0.98091185, 'binary_precision': 0.8325991, 'binary_recall': 0.58786935, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.6891522}
confusion matrix:
       0    1
0  18073   76
1    265  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7683965, 'recall': 0.55005664, 'specificity': 0.55005664, 'f1': 0.5772593, 'auroc': 0.9420059, 'binary_precision': 0.5744681, 'binary_recall': 0.10344828, 'binary_specificity': 0.996665, 'binary_f1_score': 0.17532468}
confusion matrix:
      0   1
0  5977  20
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170267_8.png
early stop counter: 1
val acc:0.9818539619445801, best validation acc: 0.9860578775405884, corresponding to test acc:                         0.9605305194854736 / 0.972195565700531
after epoch: 8,now: 2024-06-07 06:48:38.872263,epoch time: 0:39:37.213874,used: 5:19:03.655068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_29_35_seed_0_21170267
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98951864, 'precision': 0.927392, 'recall': 0.9080222, 'specificity': 0.9080222, 'f1': 0.9174646, 'auroc': 0.99435943, 'binary_precision': 0.8610121, 'binary_recall': 0.8206522, 'binary_specificity': 0.99539226, 'binary_f1_score': 0.8403479}
confusion matrix:
       0     1
0  42125   195
1    264  1208
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.89599466, 'recall': 0.8691944, 'specificity': 0.8691944, 'f1': 0.88208556, 'auroc': 0.9823848, 'binary_precision': 0.80100334, 'binary_recall': 0.7449456, 'binary_specificity': 0.9934432, 'binary_f1_score': 0.77195805}
confusion matrix:
       0    1
0  18030  119
1    164  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.8524017, 'recall': 0.6112759, 'specificity': 0.6112759, 'f1': 0.6638624, 'auroc': 0.9486332, 'binary_precision': 0.7375, 'binary_recall': 0.22605364, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.34604105}
confusion matrix:
      0   1
0  5976  21
1   202  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170267_9.png
early stop counter: 2
val acc:0.9849404096603394, best validation acc: 0.9860578775405884, corresponding to test acc:                         0.9605305194854736 / 0.972195565700531
after epoch: 9,now: 2024-06-07 07:28:14.577353,epoch time: 0:39:35.705090,used: 5:58:39.360158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_29_35_seed_0_21170267
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9868241, 'precision': 0.9252161, 'recall': 0.8609626, 'specificity': 0.8609626, 'f1': 0.8902609, 'auroc': 0.9906416, 'binary_precision': 0.8599034, 'binary_recall': 0.7260367, 'binary_specificity': 0.9958886, 'binary_f1_score': 0.7873203}
confusion matrix:
       0     1
0  42147   174
1    403  1068
---- Validation: 
scalar performance:
{'acc': 0.9830779, 'precision': 0.91796523, 'recall': 0.8052255, 'specificity': 0.8052255, 'f1': 0.8521392, 'auroc': 0.96747696, 'binary_precision': 0.8494624, 'binary_recall': 0.61430794, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.7129964}
confusion matrix:
       0    1
0  18079   70
1    248  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.85482705, 'recall': 0.51699126, 'specificity': 0.51699126, 'f1': 0.5225529, 'auroc': 0.91434336, 'binary_precision': 0.75, 'binary_recall': 0.03448276, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.06593406}
confusion matrix:
      0  1
0  5994  3
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170267_10.png
early stop counter: 3
val acc:0.983077883720398, best validation acc: 0.9860578775405884, corresponding to test acc:                         0.9605305194854736 / 0.972195565700531
after epoch: 10,now: 2024-06-07 08:07:53.624635,epoch time: 0:39:39.047282,used: 6:38:18.407440,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_29_35_seed_0_21170267
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9885824, 'precision': 0.8987247, 'recall': 0.9347084, 'specificity': 0.9347084, 'f1': 0.91587275, 'auroc': 0.995345, 'binary_precision': 0.8017402, 'binary_recall': 0.87695444, 'binary_specificity': 0.9924624, 'binary_f1_score': 0.83766234}
confusion matrix:
       0     1
0  42002   319
1    181  1290
---- Validation: 
scalar performance:
{'acc': 0.9837165, 'precision': 0.87207174, 'recall': 0.88656205, 'specificity': 0.88656205, 'f1': 0.879166, 'auroc': 0.97770417, 'binary_precision': 0.7518685, 'binary_recall': 0.7822706, 'binary_specificity': 0.9908535, 'binary_f1_score': 0.7667683}
confusion matrix:
       0    1
0  17983  166
1    140  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.7927695, 'recall': 0.5279853, 'specificity': 0.5279853, 'f1': 0.54220724, 'auroc': 0.9418814, 'binary_precision': 0.625, 'binary_recall': 0.057471264, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.10526315}
confusion matrix:
      0   1
0  5988   9
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170267_11.png
early stop counter: 4
val acc:0.9837164878845215, best validation acc: 0.9860578775405884, corresponding to test acc:                         0.9605305194854736 / 0.972195565700531
after epoch: 11,now: 2024-06-07 08:47:25.871602,epoch time: 0:39:32.246967,used: 7:17:50.654407,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_29_35_seed_0_21170267
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99063754, 'precision': 0.9100846, 'recall': 0.95614076, 'specificity': 0.95614076, 'f1': 0.93178356, 'auroc': 0.9969705, 'binary_precision': 0.8229927, 'binary_recall': 0.9191576, 'binary_specificity': 0.9931238, 'binary_f1_score': 0.8684211}
confusion matrix:
       0     1
0  42029   291
1    119  1353
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.8830193, 'recall': 0.9116658, 'specificity': 0.9116658, 'f1': 0.89677995, 'auroc': 0.98192716, 'binary_precision': 0.7720058, 'binary_recall': 0.8320373, 'binary_specificity': 0.99129426, 'binary_f1_score': 0.8008982}
confusion matrix:
       0    1
0  17991  158
1    108  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.7101187, 'recall': 0.5308995, 'specificity': 0.5308995, 'f1': 0.54624325, 'auroc': 0.9281088, 'binary_precision': 0.45945945, 'binary_recall': 0.0651341, 'binary_specificity': 0.996665, 'binary_f1_score': 0.11409397}
confusion matrix:
      0   1
0  5977  20
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170267_12.png
early stop counter: 5
val acc:0.9858450293540955, best validation acc: 0.9860578775405884, corresponding to test acc:                         0.9605305194854736 / 0.972195565700531
after epoch: 12,now: 2024-06-07 09:27:09.947258,epoch time: 0:39:44.075656,used: 7:57:34.730063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_29_35_seed_0_21170267
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9908202, 'precision': 0.95580673, 'recall': 0.89754844, 'specificity': 0.89754844, 'f1': 0.9245398, 'auroc': 0.99701345, 'binary_precision': 0.91862285, 'binary_recall': 0.7975544, 'binary_specificity': 0.99754256, 'binary_f1_score': 0.8538182}
confusion matrix:
       0     1
0  42216   104
1    298  1174
---- Validation: 
scalar performance:
{'acc': 0.98573864, 'precision': 0.93671435, 'recall': 0.83360493, 'specificity': 0.83360493, 'f1': 0.87774, 'auroc': 0.9723528, 'binary_precision': 0.88501024, 'binary_recall': 0.6702955, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.76283187}
confusion matrix:
       0    1
0  18093   56
1    212  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.8459687, 'recall': 0.5358148, 'specificity': 0.5358148, 'f1': 0.55602133, 'auroc': 0.93713206, 'binary_precision': 0.7307692, 'binary_recall': 0.07279693, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.13240418}
confusion matrix:
      0   1
0  5990   7
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170267_13.png
early stop counter: 6
val acc:0.9857386350631714, best validation acc: 0.9860578775405884, corresponding to test acc:                         0.9605305194854736 / 0.972195565700531
after epoch: 13,now: 2024-06-07 10:06:44.940095,epoch time: 0:39:34.992837,used: 8:37:09.722900,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_29_35_seed_0_21170267
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9916423, 'precision': 0.93789756, 'recall': 0.93272686, 'specificity': 0.93272686, 'f1': 0.9352956, 'auroc': 0.9971255, 'binary_precision': 0.88033015, 'binary_recall': 0.8695652, 'binary_specificity': 0.9958885, 'binary_f1_score': 0.8749145}
confusion matrix:
       0     1
0  42146   174
1    192  1280
---- Validation: 
scalar performance:
{'acc': 0.9870157, 'precision': 0.9245601, 'recall': 0.86951876, 'specificity': 0.86951876, 'f1': 0.8949802, 'auroc': 0.9803467, 'binary_precision': 0.8581688, 'binary_recall': 0.7433904, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.7966667}
confusion matrix:
       0    1
0  18070   79
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.82381487, 'recall': 0.54505986, 'specificity': 0.54505986, 'f1': 0.57093376, 'auroc': 0.9294997, 'binary_precision': 0.6857143, 'binary_recall': 0.09195402, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.16216215}
confusion matrix:
      0   1
0  5986  11
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170267_14.png
better model found
persisted
after epoch: 14,now: 2024-06-07 10:46:17.613886,epoch time: 0:39:32.673791,used: 9:16:42.396691,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_29_35_seed_0_21170267
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
slurmstepd: error: *** JOB 21170267 ON gpusrv31 CANCELLED AT 2024-06-07T10:47:27 ***
