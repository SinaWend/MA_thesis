Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed May 29 13:26:15 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752

 Experiment start at: 2024-05-29 13:39:48.386852
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9706111, 'precision': 0.7835859, 'recall': 0.7067698, 'specificity': 0.7067698, 'f1': 0.7385876, 'auroc': 0.9491574, 'binary_precision': 0.5870179, 'binary_recall': 0.42391303, 'binary_specificity': 0.98962665, 'binary_f1_score': 0.4923077}
confusion matrix:
       0    1
0  41881  439
1    848  624
---- Validation: 
scalar performance:
{'acc': 0.9687633, 'precision': 0.7754698, 'recall': 0.66430473, 'specificity': 0.66430473, 'f1': 0.7045095, 'auroc': 0.946989, 'binary_precision': 0.5740741, 'binary_recall': 0.33748055, 'binary_specificity': 0.991129, 'binary_f1_score': 0.42507344}
confusion matrix:
       0    1
0  17988  161
1    426  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709172, 'precision': 0.9176132, 'recall': 0.678826, 'specificity': 0.678826, 'f1': 0.7465619, 'auroc': 0.9329729, 'binary_precision': 0.86238533, 'binary_recall': 0.36015326, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.50810814}
confusion matrix:
      0   1
0  5982  15
1   167  94
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-29 14:26:58.687935,epoch time: 0:47:10.301083,used: 0:47:10.301083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97481275, 'precision': 0.82293785, 'recall': 0.74959224, 'specificity': 0.74959224, 'f1': 0.78115034, 'auroc': 0.96517015, 'binary_precision': 0.66282165, 'binary_recall': 0.5081633, 'binary_specificity': 0.9910212, 'binary_f1_score': 0.5752791}
confusion matrix:
       0    1
0  41942  380
1    723  747
---- Validation: 
scalar performance:
{'acc': 0.97451043, 'precision': 0.856038, 'recall': 0.6980324, 'specificity': 0.6980324, 'f1': 0.75275075, 'auroc': 0.95950305, 'binary_precision': 0.73295456, 'binary_recall': 0.40124416, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.51859295}
confusion matrix:
       0    1
0  18055   94
1    385  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8620393, 'recall': 0.5717964, 'specificity': 0.5717964, 'f1': 0.6125593, 'auroc': 0.93900204, 'binary_precision': 0.76, 'binary_recall': 0.14559387, 'binary_specificity': 0.997999, 'binary_f1_score': 0.24437298}
confusion matrix:
      0   1
0  5985  12
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
better model found
persisted
after epoch: 2,now: 2024-05-29 15:11:52.545650,epoch time: 0:44:53.857715,used: 1:32:04.158798,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97634274, 'precision': 0.8163353, 'recall': 0.8233869, 'specificity': 0.8233869, 'f1': 0.8198185, 'auroc': 0.97274774, 'binary_precision': 0.64451826, 'binary_recall': 0.65941536, 'binary_specificity': 0.9873585, 'binary_f1_score': 0.6518817}
confusion matrix:
       0    1
0  41786  535
1    501  970
---- Validation: 
scalar performance:
{'acc': 0.97690505, 'precision': 0.8441381, 'recall': 0.7765279, 'specificity': 0.7765279, 'f1': 0.80632675, 'auroc': 0.96586967, 'binary_precision': 0.7037037, 'binary_recall': 0.5614308, 'binary_specificity': 0.9916249, 'binary_f1_score': 0.62456745}
confusion matrix:
       0    1
0  17997  152
1    282  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.88937885, 'recall': 0.59861636, 'specificity': 0.59861636, 'f1': 0.65093595, 'auroc': 0.9420183, 'binary_precision': 0.8125, 'binary_recall': 0.19923371, 'binary_specificity': 0.997999, 'binary_f1_score': 0.32}
confusion matrix:
      0   1
0  5985  12
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
better model found
persisted
after epoch: 3,now: 2024-05-29 15:57:43.323481,epoch time: 0:45:50.777831,used: 2:17:54.936629,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97995067, 'precision': 0.8932332, 'recall': 0.76537097, 'specificity': 0.76537097, 'f1': 0.8159516, 'auroc': 0.9770289, 'binary_precision': 0.802444, 'binary_recall': 0.53532606, 'binary_specificity': 0.99541587, 'binary_f1_score': 0.6422168}
confusion matrix:
       0    1
0  42126  194
1    684  788
---- Validation: 
scalar performance:
{'acc': 0.975149, 'precision': 0.9362434, 'recall': 0.6541097, 'specificity': 0.6541097, 'f1': 0.7236987, 'auroc': 0.96848094, 'binary_precision': 0.8963964, 'binary_recall': 0.30948678, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.46011564}
confusion matrix:
       0    1
0  18126   23
1    444  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8728379, 'recall': 0.52082264, 'specificity': 0.52082264, 'f1': 0.5296659, 'auroc': 0.94936246, 'binary_precision': 0.78571427, 'binary_recall': 0.042145595, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.080000006}
confusion matrix:
      0   1
0  5994   3
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 1
val acc:0.9751489758491516, best validation acc: 0.9769050478935242, corresponding to test acc:                         0.9646852016448975 / 0.9709172248840332
after epoch: 4,now: 2024-05-29 16:47:48.128812,epoch time: 0:50:04.805331,used: 3:07:59.741960,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98059005, 'precision': 0.84613097, 'recall': 0.8620025, 'specificity': 0.8620025, 'f1': 0.8538724, 'auroc': 0.9790435, 'binary_precision': 0.70149255, 'binary_recall': 0.73487425, 'binary_specificity': 0.9891307, 'binary_f1_score': 0.71779555}
confusion matrix:
       0     1
0  41861   460
1    390  1081
---- Validation: 
scalar performance:
{'acc': 0.9812154, 'precision': 0.87616026, 'recall': 0.8222625, 'specificity': 0.8222625, 'f1': 0.84695536, 'auroc': 0.9740515, 'binary_precision': 0.76459855, 'binary_recall': 0.65163296, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.7036104}
confusion matrix:
       0    1
0  18020  129
1    224  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.8962941, 'recall': 0.632849, 'specificity': 0.632849, 'f1': 0.69384867, 'auroc': 0.94473594, 'binary_precision': 0.8235294, 'binary_recall': 0.26819924, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.40462425}
confusion matrix:
      0   1
0  5982  15
1   191  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
better model found
persisted
after epoch: 5,now: 2024-05-29 17:36:40.436131,epoch time: 0:48:52.307319,used: 3:56:52.049279,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9824397, 'precision': 0.93393743, 'recall': 0.77387166, 'specificity': 0.77387166, 'f1': 0.83454084, 'auroc': 0.98281276, 'binary_precision': 0.88331515, 'binary_recall': 0.55027175, 'binary_specificity': 0.99747163, 'binary_f1_score': 0.67810804}
confusion matrix:
       0    1
0  42213  107
1    662  810
---- Validation: 
scalar performance:
{'acc': 0.9753619, 'precision': 0.9321929, 'recall': 0.6594703, 'specificity': 0.6594703, 'f1': 0.7291222, 'auroc': 0.9743647, 'binary_precision': 0.88793105, 'binary_recall': 0.32037324, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.4708571}
confusion matrix:
       0    1
0  18123   26
1    437  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.87642366, 'recall': 0.5359816, 'specificity': 0.5359816, 'f1': 0.55656934, 'auroc': 0.9455151, 'binary_precision': 0.7916667, 'binary_recall': 0.07279693, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.13333333}
confusion matrix:
      0   1
0  5992   5
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 1
val acc:0.9753618836402893, best validation acc: 0.9812154173851013, corresponding to test acc:                         0.967082142829895 / 0.9709172248840332
after epoch: 6,now: 2024-05-29 18:23:21.488889,epoch time: 0:46:41.052758,used: 4:43:33.102037,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98467755, 'precision': 0.8901162, 'recall': 0.8678137, 'specificity': 0.8678137, 'f1': 0.87860936, 'auroc': 0.98418, 'binary_precision': 0.78916967, 'binary_recall': 0.7425272, 'binary_specificity': 0.99310017, 'binary_f1_score': 0.76513827}
confusion matrix:
       0     1
0  42028   292
1    379  1093
---- Validation: 
scalar performance:
{'acc': 0.98361003, 'precision': 0.8975721, 'recall': 0.8400035, 'specificity': 0.8400035, 'f1': 0.86635673, 'auroc': 0.9761538, 'binary_precision': 0.8062157, 'binary_recall': 0.6858476, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.7411764}
confusion matrix:
       0    1
0  18043  106
1    202  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.84384453, 'recall': 0.55463845, 'specificity': 0.55463845, 'f1': 0.5863987, 'auroc': 0.9487124, 'binary_precision': 0.725, 'binary_recall': 0.11111111, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.19269103}
confusion matrix:
      0   1
0  5986  11
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
better model found
persisted
after epoch: 7,now: 2024-05-29 19:08:48.989537,epoch time: 0:45:27.500648,used: 5:29:00.602685,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98202866, 'precision': 0.93133366, 'recall': 0.76874113, 'specificity': 0.76874113, 'f1': 0.829837, 'auroc': 0.9857908, 'binary_precision': 0.878453, 'binary_recall': 0.5400815, 'binary_specificity': 0.99740076, 'binary_f1_score': 0.6689104}
confusion matrix:
       0    1
0  42210  110
1    677  795
---- Validation: 
scalar performance:
{'acc': 0.9789804, 'precision': 0.911186, 'recall': 0.7363492, 'specificity': 0.7363492, 'f1': 0.79847336, 'auroc': 0.97706294, 'binary_precision': 0.8406593, 'binary_recall': 0.47589424, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.60774577}
confusion matrix:
       0    1
0  18091   58
1    337  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8596515, 'recall': 0.55288947, 'specificity': 0.55288947, 'f1': 0.5840563, 'auroc': 0.9383695, 'binary_precision': 0.7567568, 'binary_recall': 0.107279696, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.18791947}
confusion matrix:
      0   1
0  5988   9
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 1
val acc:0.9789804220199585, best validation acc: 0.9836100339889526, corresponding to test acc:                         0.9611697196960449 / 0.9709172248840332
after epoch: 8,now: 2024-05-29 19:53:57.482301,epoch time: 0:45:08.492764,used: 6:14:09.095449,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98570514, 'precision': 0.8872889, 'recall': 0.894902, 'specificity': 0.894902, 'f1': 0.8910552, 'auroc': 0.98708165, 'binary_precision': 0.7816245, 'binary_recall': 0.7975544, 'binary_specificity': 0.99224955, 'binary_f1_score': 0.7895091}
confusion matrix:
       0     1
0  41992   328
1    298  1174
---- Validation: 
scalar performance:
{'acc': 0.98424864, 'precision': 0.9077853, 'recall': 0.83883405, 'specificity': 0.83883405, 'f1': 0.8698704, 'auroc': 0.97845596, 'binary_precision': 0.826742, 'binary_recall': 0.6827372, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.7478705}
confusion matrix:
       0    1
0  18057   92
1    204  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.8745173, 'recall': 0.56246805, 'specificity': 0.56246805, 'f1': 0.5992082, 'auroc': 0.939281, 'binary_precision': 0.78571427, 'binary_recall': 0.12643678, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.21782179}
confusion matrix:
      0   1
0  5988   9
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
better model found
persisted
after epoch: 9,now: 2024-05-29 20:39:46.187578,epoch time: 0:45:48.705277,used: 6:59:57.800726,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9858878, 'precision': 0.9358822, 'recall': 0.8325906, 'specificity': 0.8325906, 'f1': 0.87678266, 'auroc': 0.98925364, 'binary_precision': 0.88319856, 'binary_recall': 0.6682529, 'binary_specificity': 0.9969282, 'binary_f1_score': 0.76083595}
confusion matrix:
       0    1
0  42191  130
1    488  983
---- Validation: 
scalar performance:
{'acc': 0.9833972, 'precision': 0.93572927, 'recall': 0.79414, 'specificity': 0.79414, 'f1': 0.85020506, 'auroc': 0.9781532, 'binary_precision': 0.8857809, 'binary_recall': 0.59097975, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.7089552}
confusion matrix:
       0    1
0  18100   49
1    263  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.9030609, 'recall': 0.52090603, 'specificity': 0.52090603, 'f1': 0.5298535, 'auroc': 0.9302956, 'binary_precision': 0.84615386, 'binary_recall': 0.042145595, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.08029197}
confusion matrix:
      0   1
0  5995   2
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 1
val acc:0.9833971858024597, best validation acc: 0.9842486381530762, corresponding to test acc:                         0.9621284604072571 / 0.9709172248840332
after epoch: 10,now: 2024-05-29 21:25:10.075501,epoch time: 0:45:23.887923,used: 7:45:21.688649,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9868926, 'precision': 0.9205656, 'recall': 0.867888, 'specificity': 0.867888, 'f1': 0.892329, 'auroc': 0.98905355, 'binary_precision': 0.8501171, 'binary_recall': 0.7403127, 'binary_specificity': 0.99546325, 'binary_f1_score': 0.7914244}
confusion matrix:
       0     1
0  42129   192
1    382  1089
---- Validation: 
scalar performance:
{'acc': 0.9837165, 'precision': 0.9082669, 'recall': 0.82805777, 'specificity': 0.82805777, 'f1': 0.86344695, 'auroc': 0.97592854, 'binary_precision': 0.82846004, 'binary_recall': 0.66096425, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.7352941}
confusion matrix:
       0    1
0  18061   88
1    218  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.84338665, 'recall': 0.51507556, 'specificity': 0.51507556, 'f1': 0.5189576, 'auroc': 0.91755056, 'binary_precision': 0.72727275, 'binary_recall': 0.03065134, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.058823526}
confusion matrix:
      0  1
0  5994  3
1   253  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 2
val acc:0.9837164878845215, best validation acc: 0.9842486381530762, corresponding to test acc:                         0.9621284604072571 / 0.9709172248840332
after epoch: 11,now: 2024-05-29 22:10:08.239313,epoch time: 0:44:58.163812,used: 8:30:19.852461,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9882399, 'precision': 0.9223486, 'recall': 0.8909676, 'specificity': 0.8909676, 'f1': 0.90600455, 'auroc': 0.99046946, 'binary_precision': 0.85209715, 'binary_recall': 0.7866848, 'binary_specificity': 0.99525046, 'binary_f1_score': 0.8180855}
confusion matrix:
       0     1
0  42119   201
1    314  1158
---- Validation: 
scalar performance:
{'acc': 0.9867497, 'precision': 0.922552, 'recall': 0.8671308, 'specificity': 0.8671308, 'f1': 0.89274174, 'auroc': 0.9791454, 'binary_precision': 0.85431653, 'binary_recall': 0.7387247, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.7923269}
confusion matrix:
       0    1
0  18068   81
1    168  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8552821, 'recall': 0.52831876, 'specificity': 0.52831876, 'f1': 0.5431233, 'auroc': 0.9114773, 'binary_precision': 0.75, 'binary_recall': 0.057471264, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.10676157}
confusion matrix:
      0   1
0  5992   5
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
better model found
persisted
after epoch: 12,now: 2024-05-29 22:55:21.683042,epoch time: 0:45:13.443729,used: 9:15:33.296190,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98828554, 'precision': 0.94033146, 'recall': 0.8703362, 'specificity': 0.8703362, 'f1': 0.9020835, 'auroc': 0.99185216, 'binary_precision': 0.8895207, 'binary_recall': 0.7438859, 'binary_specificity': 0.9967864, 'binary_f1_score': 0.8102108}
confusion matrix:
       0     1
0  42184   136
1    377  1095
---- Validation: 
scalar performance:
{'acc': 0.98541933, 'precision': 0.93583524, 'recall': 0.8289393, 'specificity': 0.8289393, 'f1': 0.8743563, 'auroc': 0.9791104, 'binary_precision': 0.88357586, 'binary_recall': 0.66096425, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.75622773}
confusion matrix:
       0    1
0  18093   56
1    218  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8916132, 'recall': 0.5436444, 'specificity': 0.5436444, 'f1': 0.5696478, 'auroc': 0.9244175, 'binary_precision': 0.8214286, 'binary_recall': 0.08812261, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.15916955}
confusion matrix:
      0   1
0  5992   5
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 1
val acc:0.9854193329811096, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9598913192749023 / 0.9709172248840332
after epoch: 13,now: 2024-05-29 23:40:51.625659,epoch time: 0:45:29.942617,used: 10:01:03.238807,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98901623, 'precision': 0.96018374, 'recall': 0.8631735, 'specificity': 0.8631735, 'f1': 0.90555024, 'auroc': 0.9923034, 'binary_precision': 0.9297485, 'binary_recall': 0.7282609, 'binary_specificity': 0.99808604, 'binary_f1_score': 0.816762}
confusion matrix:
       0     1
0  42239    81
1    400  1072
---- Validation: 
scalar performance:
{'acc': 0.98403573, 'precision': 0.9359108, 'recall': 0.80497134, 'specificity': 0.80497134, 'f1': 0.85802233, 'auroc': 0.9785926, 'binary_precision': 0.88539326, 'binary_recall': 0.61275274, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.7242647}
confusion matrix:
       0    1
0  18098   51
1    249  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.8237244, 'recall': 0.52065593, 'specificity': 0.52065593, 'f1': 0.52929366, 'auroc': 0.93055964, 'binary_precision': 0.6875, 'binary_recall': 0.042145595, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.07942238}
confusion matrix:
      0   1
0  5992   5
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 2
val acc:0.9840357303619385, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9598913192749023 / 0.9709172248840332
after epoch: 14,now: 2024-05-30 00:26:19.099587,epoch time: 0:45:27.473928,used: 10:46:30.712735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9882627, 'precision': 0.9013751, 'recall': 0.9234375, 'specificity': 0.9234375, 'f1': 0.91208607, 'auroc': 0.9937347, 'binary_precision': 0.80784065, 'binary_recall': 0.8539402, 'binary_specificity': 0.99293476, 'binary_f1_score': 0.830251}
confusion matrix:
       0     1
0  42021   299
1    215  1257
---- Validation: 
scalar performance:
{'acc': 0.9848872, 'precision': 0.8805964, 'recall': 0.89541876, 'specificity': 0.89541876, 'f1': 0.88785344, 'auroc': 0.98087436, 'binary_precision': 0.7683109, 'binary_recall': 0.7993779, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.7835366}
confusion matrix:
       0    1
0  17994  155
1    129  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.81197757, 'recall': 0.5655491, 'specificity': 0.5655491, 'f1': 0.6014666, 'auroc': 0.90452516, 'binary_precision': 0.6603774, 'binary_recall': 0.13409962, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.22292995}
confusion matrix:
      0   1
0  5979  18
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 3
val acc:0.9848871827125549, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9598913192749023 / 0.9709172248840332
after epoch: 15,now: 2024-05-30 01:11:46.348946,epoch time: 0:45:27.249359,used: 11:31:57.962094,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98999816, 'precision': 0.9262656, 'recall': 0.9184339, 'specificity': 0.9184339, 'f1': 0.9223106, 'auroc': 0.99424964, 'binary_precision': 0.85803324, 'binary_recall': 0.84171194, 'binary_specificity': 0.99515593, 'binary_f1_score': 0.84979427}
confusion matrix:
       0     1
0  42115   205
1    233  1239
---- Validation: 
scalar performance:
{'acc': 0.98648363, 'precision': 0.9124986, 'recall': 0.87524366, 'specificity': 0.87524366, 'f1': 0.8929181, 'auroc': 0.98153996, 'binary_precision': 0.83361924, 'binary_recall': 0.755832, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.7928222}
confusion matrix:
       0    1
0  18052   97
1    157  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.87894416, 'recall': 0.55872, 'specificity': 0.55872, 'f1': 0.59359205, 'auroc': 0.9165293, 'binary_precision': 0.7948718, 'binary_recall': 0.118773945, 'binary_specificity': 0.998666, 'binary_f1_score': 0.20666666}
confusion matrix:
      0   1
0  5989   8
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 4
val acc:0.986483633518219, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9598913192749023 / 0.9709172248840332
after epoch: 16,now: 2024-05-30 01:57:08.973883,epoch time: 0:45:22.624937,used: 12:17:20.587031,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98972416, 'precision': 0.96579015, 'recall': 0.86976904, 'specificity': 0.86976904, 'f1': 0.9118651, 'auroc': 0.9947568, 'binary_precision': 0.94051725, 'binary_recall': 0.7411685, 'binary_specificity': 0.9983696, 'binary_f1_score': 0.8290274}
confusion matrix:
       0     1
0  42251    69
1    381  1091
---- Validation: 
scalar performance:
{'acc': 0.98648363, 'precision': 0.9402081, 'recall': 0.84299135, 'specificity': 0.84299135, 'f1': 0.8851117, 'auroc': 0.9791249, 'binary_precision': 0.89134806, 'binary_recall': 0.688958, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.77719295}
confusion matrix:
       0    1
0  18095   54
1    200  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.9134711, 'recall': 0.5247375, 'specificity': 0.5247375, 'f1': 0.536889, 'auroc': 0.8971902, 'binary_precision': 0.8666667, 'binary_recall': 0.049808428, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.09420289}
confusion matrix:
      0   1
0  5995   2
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 5
val acc:0.986483633518219, best validation acc: 0.9867497086524963, corresponding to test acc:                         0.9598913192749023 / 0.9709172248840332
after epoch: 17,now: 2024-05-30 02:42:20.889540,epoch time: 0:45:11.915657,used: 13:02:32.502688,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99047774, 'precision': 0.94040763, 'recall': 0.90884626, 'specificity': 0.90884626, 'f1': 0.9239948, 'auroc': 0.9955666, 'binary_precision': 0.8870139, 'binary_recall': 0.8213315, 'binary_specificity': 0.9963611, 'binary_f1_score': 0.85291004}
confusion matrix:
       0     1
0  42166   154
1    263  1209
---- Validation: 
scalar performance:
{'acc': 0.9872818, 'precision': 0.93235266, 'recall': 0.8651562, 'specificity': 0.8651562, 'f1': 0.89570284, 'auroc': 0.98388654, 'binary_precision': 0.8740741, 'binary_recall': 0.7340591, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.7979713}
confusion matrix:
       0    1
0  18081   68
1    171  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.84024143, 'recall': 0.5527227, 'specificity': 0.5527227, 'f1': 0.5833464, 'auroc': 0.92334944, 'binary_precision': 0.71794873, 'binary_recall': 0.107279696, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.18666667}
confusion matrix:
      0   1
0  5986  11
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
better model found
persisted
after epoch: 18,now: 2024-05-30 03:27:52.510376,epoch time: 0:45:31.620836,used: 13:48:04.123524,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99102575, 'precision': 0.9361526, 'recall': 0.92383325, 'specificity': 0.92383325, 'f1': 0.92989767, 'auroc': 0.995316, 'binary_precision': 0.877451, 'binary_recall': 0.8518015, 'binary_specificity': 0.9958649, 'binary_f1_score': 0.86443603}
confusion matrix:
       0     1
0  42146   175
1    218  1253
---- Validation: 
scalar performance:
{'acc': 0.98781395, 'precision': 0.93054324, 'recall': 0.8766825, 'specificity': 0.8766825, 'f1': 0.90167403, 'auroc': 0.9832675, 'binary_precision': 0.86964285, 'binary_recall': 0.7573872, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.8096425}
confusion matrix:
       0    1
0  18076   73
1    156  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8486882, 'recall': 0.5471424, 'specificity': 0.5471424, 'f1': 0.57472205, 'auroc': 0.9082594, 'binary_precision': 0.7352941, 'binary_recall': 0.09578544, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.16949151}
confusion matrix:
      0   1
0  5988   9
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
better model found
persisted
after epoch: 19,now: 2024-05-30 04:13:23.530558,epoch time: 0:45:31.020182,used: 14:33:35.143706,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9911171, 'precision': 0.9648687, 'recall': 0.8934399, 'specificity': 0.8934399, 'f1': 0.9259636, 'auroc': 0.99620867, 'binary_precision': 0.937046, 'binary_recall': 0.7887228, 'binary_specificity': 0.9981569, 'binary_f1_score': 0.85651046}
confusion matrix:
       0     1
0  42242    78
1    311  1161
---- Validation: 
scalar performance:
{'acc': 0.98557895, 'precision': 0.93860894, 'recall': 0.829022, 'specificity': 0.829022, 'f1': 0.8754097, 'auroc': 0.9803169, 'binary_precision': 0.88912135, 'binary_recall': 0.66096425, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.7582516}
confusion matrix:
       0    1
0  18096   53
1    218  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.927814, 'recall': 0.5324003, 'specificity': 0.5324003, 'f1': 0.550662, 'auroc': 0.9078043, 'binary_precision': 0.8947368, 'binary_recall': 0.0651341, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.12142857}
confusion matrix:
      0   1
0  5995   2
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 1
val acc:0.9855789542198181, best validation acc: 0.9878139495849609, corresponding to test acc:                         0.9608501195907593 / 0.9709172248840332
after epoch: 20,now: 2024-05-30 04:58:48.854837,epoch time: 0:45:25.324279,used: 15:19:00.467985,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9916423, 'precision': 0.93890285, 'recall': 0.93141544, 'specificity': 0.93141544, 'f1': 0.9351244, 'auroc': 0.9962679, 'binary_precision': 0.8824343, 'binary_recall': 0.8668478, 'binary_specificity': 0.995983, 'binary_f1_score': 0.8745716}
confusion matrix:
       0     1
0  42150   170
1    196  1276
---- Validation: 
scalar performance:
{'acc': 0.9883461, 'precision': 0.9241977, 'recall': 0.89420927, 'specificity': 0.89420927, 'f1': 0.90860945, 'auroc': 0.98350906, 'binary_precision': 0.8557047, 'binary_recall': 0.7931571, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.8232445}
confusion matrix:
       0    1
0  18063   86
1    133  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.86347437, 'recall': 0.5491414, 'specificity': 0.5491414, 'f1': 0.57819366, 'auroc': 0.8754983, 'binary_precision': 0.7647059, 'binary_recall': 0.099616855, 'binary_specificity': 0.998666, 'binary_f1_score': 0.17627117}
confusion matrix:
      0   1
0  5989   8
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
better model found
persisted
after epoch: 21,now: 2024-05-30 05:44:14.651746,epoch time: 0:45:25.796909,used: 16:04:26.264894,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98828554, 'precision': 0.8835511, 'recall': 0.95979387, 'specificity': 0.95979387, 'f1': 0.91791403, 'auroc': 0.99661815, 'binary_precision': 0.76957744, 'binary_recall': 0.92925173, 'binary_specificity': 0.990336, 'binary_f1_score': 0.8419106}
confusion matrix:
       0     1
0  41913   409
1    104  1366
---- Validation: 
scalar performance:
{'acc': 0.98557895, 'precision': 0.87233746, 'recall': 0.92952937, 'specificity': 0.92952937, 'f1': 0.8987042, 'auroc': 0.9827719, 'binary_precision': 0.74932975, 'binary_recall': 0.86936235, 'binary_specificity': 0.9896964, 'binary_f1_score': 0.8048956}
confusion matrix:
       0    1
0  17962  187
1     84  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.88250846, 'recall': 0.583374, 'specificity': 0.583374, 'f1': 0.6298962, 'auroc': 0.921167, 'binary_precision': 0.8, 'binary_recall': 0.16858238, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.27848104}
confusion matrix:
      0   1
0  5986  11
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 1
val acc:0.9855789542198181, best validation acc: 0.9883460998535156, corresponding to test acc:                         0.9611697196960449 / 0.9709172248840332
after epoch: 22,now: 2024-05-30 06:29:41.806235,epoch time: 0:45:27.154489,used: 16:49:53.419383,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9918478, 'precision': 0.9480543, 'recall': 0.92360234, 'specificity': 0.92360234, 'f1': 0.9354588, 'auroc': 0.99689376, 'binary_precision': 0.90129685, 'binary_recall': 0.8504419, 'binary_specificity': 0.9967628, 'binary_f1_score': 0.87513113}
confusion matrix:
       0     1
0  42184   137
1    220  1251
---- Validation: 
scalar performance:
{'acc': 0.98770756, 'precision': 0.93348897, 'recall': 0.871377, 'specificity': 0.871377, 'f1': 0.89984906, 'auroc': 0.9825953, 'binary_precision': 0.8759124, 'binary_recall': 0.7465008, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.8060454}
confusion matrix:
       0    1
0  18081   68
1    163  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8559669, 'recall': 0.54531, 'specificity': 0.54531, 'f1': 0.57188916, 'auroc': 0.85283244, 'binary_precision': 0.75, 'binary_recall': 0.09195402, 'binary_specificity': 0.998666, 'binary_f1_score': 0.16382253}
confusion matrix:
      0   1
0  5989   8
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 2
val acc:0.9877075552940369, best validation acc: 0.9883460998535156, corresponding to test acc:                         0.9611697196960449 / 0.9709172248840332
after epoch: 23,now: 2024-05-30 07:15:16.854815,epoch time: 0:45:35.048580,used: 17:35:28.467963,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99207616, 'precision': 0.94800985, 'recall': 0.9277055, 'specificity': 0.9277055, 'f1': 0.93760395, 'auroc': 0.9975612, 'binary_precision': 0.9009266, 'binary_recall': 0.8586956, 'binary_specificity': 0.9967155, 'binary_f1_score': 0.87930435}
confusion matrix:
       0     1
0  42181   139
1    208  1264
---- Validation: 
scalar performance:
{'acc': 0.9883461, 'precision': 0.9411884, 'recall': 0.87395775, 'specificity': 0.87395775, 'f1': 0.90458655, 'auroc': 0.9822032, 'binary_precision': 0.8911439, 'binary_recall': 0.7511664, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.81518984}
confusion matrix:
       0    1
0  18090   59
1    160  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.9068279, 'recall': 0.5437278, 'specificity': 0.5437278, 'f1': 0.5699658, 'auroc': 0.9182332, 'binary_precision': 0.8518519, 'binary_recall': 0.08812261, 'binary_specificity': 0.999333, 'binary_f1_score': 0.15972222}
confusion matrix:
      0   1
0  5993   4
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 3
val acc:0.9883460998535156, best validation acc: 0.9883460998535156, corresponding to test acc:                         0.9611697196960449 / 0.9709172248840332
after epoch: 24,now: 2024-05-30 08:01:12.516105,epoch time: 0:45:55.661290,used: 18:21:24.129253,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.992236, 'precision': 0.9596363, 'recall': 0.91729677, 'specificity': 0.91729677, 'f1': 0.93736714, 'auroc': 0.99738055, 'binary_precision': 0.9249249, 'binary_recall': 0.8369565, 'binary_specificity': 0.99763703, 'binary_f1_score': 0.87874466}
confusion matrix:
       0     1
0  42220   100
1    240  1232
---- Validation: 
scalar performance:
{'acc': 0.9871222, 'precision': 0.9448513, 'recall': 0.8493223, 'specificity': 0.8493223, 'f1': 0.89091027, 'auroc': 0.98292977, 'binary_precision': 0.9001996, 'binary_recall': 0.7013997, 'binary_specificity': 0.997245, 'binary_f1_score': 0.78846157}
confusion matrix:
       0    1
0  18099   50
1    192  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7798174, 'recall': 0.5167411, 'specificity': 0.5167411, 'f1': 0.5220695, 'auroc': 0.84040475, 'binary_precision': 0.6, 'binary_recall': 0.03448276, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.06521738}
confusion matrix:
      0  1
0  5991  6
1   252  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 4
val acc:0.9871221780776978, best validation acc: 0.9883460998535156, corresponding to test acc:                         0.9611697196960449 / 0.9709172248840332
after epoch: 25,now: 2024-05-30 08:47:24.595481,epoch time: 0:46:12.079376,used: 19:07:36.208629,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9930581, 'precision': 0.96885204, 'recall': 0.92132854, 'specificity': 0.92132854, 'f1': 0.94372714, 'auroc': 0.9975498, 'binary_precision': 0.9430956, 'binary_recall': 0.8444294, 'binary_specificity': 0.9982278, 'binary_f1_score': 0.8910395}
confusion matrix:
       0     1
0  42245    75
1    229  1243
---- Validation: 
scalar performance:
{'acc': 0.9881865, 'precision': 0.945823, 'recall': 0.86637455, 'specificity': 0.86637455, 'f1': 0.90191764, 'auroc': 0.981959, 'binary_precision': 0.9009524, 'binary_recall': 0.7356143, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.8099315}
confusion matrix:
       0    1
0  18097   52
1    170  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.78964245, 'recall': 0.5242372, 'specificity': 0.5242372, 'f1': 0.5356366, 'auroc': 0.85387254, 'binary_precision': 0.61904764, 'binary_recall': 0.049808428, 'binary_specificity': 0.998666, 'binary_f1_score': 0.09219858}
confusion matrix:
      0   1
0  5989   8
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 5
val acc:0.9881864786148071, best validation acc: 0.9883460998535156, corresponding to test acc:                         0.9611697196960449 / 0.9709172248840332
after epoch: 26,now: 2024-05-30 09:33:52.337687,epoch time: 0:46:27.742206,used: 19:54:03.950835,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9931951, 'precision': 0.9661828, 'recall': 0.92631733, 'specificity': 0.92631733, 'f1': 0.94529283, 'auroc': 0.9977554, 'binary_precision': 0.93740684, 'binary_recall': 0.85461956, 'binary_specificity': 0.9980151, 'binary_f1_score': 0.89410096}
confusion matrix:
       0     1
0  42236    84
1    214  1258
---- Validation: 
scalar performance:
{'acc': 0.9876543, 'precision': 0.9346783, 'recall': 0.8690993, 'specificity': 0.8690993, 'f1': 0.8990053, 'auroc': 0.9827368, 'binary_precision': 0.878453, 'binary_recall': 0.7418352, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.8043845}
confusion matrix:
       0    1
0  18083   66
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.62956077, 'recall': 0.51032704, 'specificity': 0.51032704, 'f1': 0.5103592, 'auroc': 0.88904536, 'binary_precision': 0.3, 'binary_recall': 0.022988506, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.042704627}
confusion matrix:
      0   1
0  5983  14
1   255   6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 6
val acc:0.9876543283462524, best validation acc: 0.9883460998535156, corresponding to test acc:                         0.9611697196960449 / 0.9709172248840332
after epoch: 27,now: 2024-05-30 10:19:53.517760,epoch time: 0:46:01.180073,used: 20:40:05.130908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99257857, 'precision': 0.94022745, 'recall': 0.94629055, 'specificity': 0.94629055, 'f1': 0.9432366, 'auroc': 0.9972613, 'binary_precision': 0.8840483, 'binary_recall': 0.8966689, 'binary_specificity': 0.9959122, 'binary_f1_score': 0.8903139}
confusion matrix:
       0     1
0  42148   173
1    152  1319
---- Validation: 
scalar performance:
{'acc': 0.98813325, 'precision': 0.9139217, 'recall': 0.90459985, 'specificity': 0.90459985, 'f1': 0.9092033, 'auroc': 0.98327863, 'binary_precision': 0.83439493, 'binary_recall': 0.81493, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.82454765}
confusion matrix:
       0    1
0  18045  104
1    119  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7373065, 'recall': 0.5348977, 'specificity': 0.5348977, 'f1': 0.55311835, 'auroc': 0.83416617, 'binary_precision': 0.5135135, 'binary_recall': 0.07279693, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.12751678}
confusion matrix:
      0   1
0  5979  18
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 7
val acc:0.9881332516670227, best validation acc: 0.9883460998535156, corresponding to test acc:                         0.9611697196960449 / 0.9709172248840332
after epoch: 28,now: 2024-05-30 11:05:49.585902,epoch time: 0:45:56.068142,used: 21:26:01.199050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99321795, 'precision': 0.94508463, 'recall': 0.9512147, 'specificity': 0.9512147, 'f1': 0.948127, 'auroc': 0.99785864, 'binary_precision': 0.89343166, 'binary_recall': 0.9061863, 'binary_specificity': 0.996243, 'binary_f1_score': 0.8997637}
confusion matrix:
       0     1
0  42162   159
1    138  1333
---- Validation: 
scalar performance:
{'acc': 0.9887718, 'precision': 0.9225951, 'recall': 0.9041804, 'specificity': 0.9041804, 'f1': 0.9131658, 'auroc': 0.98266923, 'binary_precision': 0.85179156, 'binary_recall': 0.8133748, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.83214}
confusion matrix:
       0    1
0  18058   91
1    120  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8728379, 'recall': 0.52082264, 'specificity': 0.52082264, 'f1': 0.5296659, 'auroc': 0.87312907, 'binary_precision': 0.78571427, 'binary_recall': 0.042145595, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.080000006}
confusion matrix:
      0   1
0  5994   3
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
better model found
persisted
after epoch: 29,now: 2024-05-30 11:51:37.572892,epoch time: 0:45:47.986990,used: 22:11:49.186040,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9944054, 'precision': 0.96409863, 'recall': 0.9485481, 'specificity': 0.9485481, 'f1': 0.95618075, 'auroc': 0.99859715, 'binary_precision': 0.93169016, 'binary_recall': 0.8993882, 'binary_specificity': 0.997708, 'binary_f1_score': 0.9152543}
confusion matrix:
       0     1
0  42224    97
1    148  1323
---- Validation: 
scalar performance:
{'acc': 0.9885057, 'precision': 0.9311383, 'recall': 0.8882915, 'specificity': 0.8882915, 'f1': 0.90850544, 'auroc': 0.98400694, 'binary_precision': 0.87001735, 'binary_recall': 0.7807154, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.82295084}
confusion matrix:
       0    1
0  18074   75
1    141  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.8245563, 'recall': 0.54131186, 'specificity': 0.54131186, 'f1': 0.5648996, 'auroc': 0.879759, 'binary_precision': 0.6875, 'binary_recall': 0.08429119, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.15017064}
confusion matrix:
      0   1
0  5987  10
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 1
val acc:0.9885057210922241, best validation acc: 0.9887717962265015, corresponding to test acc:                         0.9595717191696167 / 0.9709172248840332
after epoch: 30,now: 2024-05-30 12:37:13.911760,epoch time: 0:45:36.338868,used: 22:57:25.524908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_48_seed_0_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 22:57:25.524908 at 2024-05-30 12:37:13.911760
persisted model performance metric: 

scalar performance:
{'acc': 0.9598913, 'precision': 0.86909723, 'recall': 0.52648646, 'specificity': 0.52648646, 'f1': 0.5399234, 'auroc': 0.8744452, 'binary_precision': 0.7777778, 'binary_recall': 0.053639848, 'binary_specificity': 0.999333, 'binary_f1_score': 0.100358434}
confusion matrix:
      0   1
0  5993   4
1   247  14
oracle model performance metric: 

scalar performance:
{'acc': 0.9694791, 'precision': 0.9178483, 'recall': 0.65791994, 'specificity': 0.65791994, 'f1': 0.7246387, 'auroc': 0.9378289, 'binary_precision': 0.8645833, 'binary_recall': 0.31800765, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.46498597}
confusion matrix:
      0   1
0  5984  13
1   178  83
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |   1647 MiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430238 KiB |    863 MiB | 413549 GiB | 413548 GiB |
|       from large pool | 410304 KiB |    862 MiB | 400661 GiB | 400660 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12888 GiB |  12888 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  152169 K  |  152166 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89842 K  |   89839 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  152169 K  |  152166 K  |
|       from large pool |     247    |     989    |   62327 K  |   62326 K  |
|       from small pool |    3119    |    6108    |   89842 K  |   89839 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     147    |    2872    |   90396 K  |   90396 K  |
|       from large pool |     112    |     516    |   47275 K  |   47275 K  |
|       from small pool |      35    |    2760    |   43121 K  |   43121 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413550 GiB | 413550 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400662 GiB | 400662 GiB |
|       from small pool |      0 KiB |     24 MiB |  12888 GiB |  12888 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152169 K  |  152169 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152169 K  |  152169 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2872    |   90397 K  |   90397 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2760    |   43122 K  |   43122 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413550 GiB | 413550 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400662 GiB | 400662 GiB |
|       from small pool |      0 KiB |     24 MiB |  12888 GiB |  12888 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152169 K  |  152169 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152169 K  |  152169 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89842 K  |   89842 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2872    |   90397 K  |   90397 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2760    |   43122 K  |   43122 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752

 Experiment start at: 2024-05-30 12:50:38.877381
before training, model accuracy: 0.06445375829935074
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97017515, 'precision': 0.7776496, 'recall': 0.6693907, 'specificity': 0.6693907, 'f1': 0.70922524, 'auroc': 0.9451072, 'binary_precision': 0.57718897, 'binary_recall': 0.34743413, 'binary_specificity': 0.9913472, 'binary_f1_score': 0.43376625}
confusion matrix:
       0    1
0  42047  367
1    941  501
---- Validation: 
scalar performance:
{'acc': 0.9685699, 'precision': 0.7830435, 'recall': 0.70403004, 'specificity': 0.70403004, 'f1': 0.7364724, 'auroc': 0.94741464, 'binary_precision': 0.5875, 'binary_recall': 0.4190193, 'binary_specificity': 0.9890408, 'binary_f1_score': 0.4891587}
confusion matrix:
       0    1
0  17869  198
1    391  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.7074283, 'recall': 0.52733254, 'specificity': 0.52733254, 'f1': 0.5403438, 'auroc': 0.9238274, 'binary_precision': 0.45454547, 'binary_recall': 0.057692308, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.102389075}
confusion matrix:
      0   1
0  5928  18
1   245  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-30 13:38:12.669920,epoch time: 0:47:33.792539,used: 0:47:33.792539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97261494, 'precision': 0.78091955, 'recall': 0.81522906, 'specificity': 0.81522906, 'f1': 0.7969842, 'auroc': 0.95965147, 'binary_precision': 0.57389164, 'binary_recall': 0.6467731, 'binary_specificity': 0.983685, 'binary_f1_score': 0.6081566}
confusion matrix:
       0    1
0  41723  692
1    509  932
---- Validation: 
scalar performance:
{'acc': 0.97139806, 'precision': 0.793852, 'recall': 0.7913289, 'specificity': 0.7913289, 'f1': 0.7925844, 'auroc': 0.96251607, 'binary_precision': 0.6026986, 'binary_recall': 0.5973254, 'binary_specificity': 0.98533237, 'binary_f1_score': 0.59999996}
confusion matrix:
       0    1
0  17802  265
1    271  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.7843895, 'recall': 0.604581, 'specificity': 0.604581, 'f1': 0.64864767, 'auroc': 0.9382969, 'binary_precision': 0.60215056, 'binary_recall': 0.21538462, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.31728047}
confusion matrix:
      0   1
0  5909  37
1   204  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-30 14:24:30.524226,epoch time: 0:46:17.854306,used: 1:33:51.646845,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9770157, 'precision': 0.8470504, 'recall': 0.7503012, 'specificity': 0.7503012, 'f1': 0.79020375, 'auroc': 0.9694658, 'binary_precision': 0.7106796, 'binary_recall': 0.5076283, 'binary_specificity': 0.99297404, 'binary_f1_score': 0.592233}
confusion matrix:
       0    1
0  42116  298
1    710  732
---- Validation: 
scalar performance:
{'acc': 0.97438633, 'precision': 0.8384586, 'recall': 0.7513932, 'specificity': 0.7513932, 'f1': 0.7879112, 'auroc': 0.97004837, 'binary_precision': 0.6949495, 'binary_recall': 0.5111441, 'binary_specificity': 0.99164224, 'binary_f1_score': 0.5890411}
confusion matrix:
       0    1
0  17916  151
1    329  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.8295836, 'recall': 0.5132093, 'specificity': 0.5132093, 'f1': 0.515384, 'auroc': 0.9392429, 'binary_precision': 0.7, 'binary_recall': 0.026923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.051851854}
confusion matrix:
      0  1
0  5943  3
1   253  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
better model found
persisted
after epoch: 3,now: 2024-05-30 15:10:19.895012,epoch time: 0:45:49.370786,used: 2:19:41.017631,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9782698, 'precision': 0.88533485, 'recall': 0.7295126, 'specificity': 0.7295126, 'f1': 0.7862524, 'auroc': 0.9730611, 'binary_precision': 0.7886659, 'binary_recall': 0.46324548, 'binary_specificity': 0.9957797, 'binary_f1_score': 0.58366096}
confusion matrix:
       0    1
0  42235  179
1    774  668
---- Validation: 
scalar performance:
{'acc': 0.97604054, 'precision': 0.90408087, 'recall': 0.7079045, 'specificity': 0.7079045, 'f1': 0.77222484, 'auroc': 0.97257185, 'binary_precision': 0.82941175, 'binary_recall': 0.4190193, 'binary_specificity': 0.99678975, 'binary_f1_score': 0.5567621}
confusion matrix:
       0    1
0  18009   58
1    391  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.97912973, 'recall': 0.5019231, 'specificity': 0.5019231, 'f1': 0.49317387, 'auroc': 0.94608885, 'binary_precision': 1.0, 'binary_recall': 0.0038461538, 'binary_specificity': 1.0, 'binary_f1_score': 0.007662835}
confusion matrix:
      0  1
0  5946  0
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
better model found
persisted
after epoch: 4,now: 2024-05-30 15:56:06.573085,epoch time: 0:45:46.678073,used: 3:05:27.695704,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9809832, 'precision': 0.909796, 'recall': 0.7607262, 'specificity': 0.7607262, 'f1': 0.8175171, 'auroc': 0.9798856, 'binary_precision': 0.83554083, 'binary_recall': 0.52496535, 'binary_specificity': 0.996487, 'binary_f1_score': 0.6448041}
confusion matrix:
       0    1
0  42265  149
1    685  757
---- Validation: 
scalar performance:
{'acc': 0.9754002, 'precision': 0.9076642, 'recall': 0.69398236, 'specificity': 0.69398236, 'f1': 0.7601478, 'auroc': 0.9757601, 'binary_precision': 0.8375796, 'binary_recall': 0.3907875, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.5329281}
confusion matrix:
       0    1
0  18016   51
1    410  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.97982574, 'recall': 0.5192308, 'specificity': 0.5192308, 'f1': 0.52674216, 'auroc': 0.94954264, 'binary_precision': 1.0, 'binary_recall': 0.03846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.074074075}
confusion matrix:
      0   1
0  5946   0
1   250  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 1
val acc:0.9754002094268799, best validation acc: 0.9760405421257019, corresponding to test acc:                         0.9582661986351013 / 0.9611666202545166
after epoch: 5,now: 2024-05-30 16:41:54.709033,epoch time: 0:45:48.135948,used: 3:51:15.831652,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9820549, 'precision': 0.8757529, 'recall': 0.82592595, 'specificity': 0.82592595, 'f1': 0.84892607, 'auroc': 0.9804082, 'binary_precision': 0.7630522, 'binary_recall': 0.6588072, 'binary_specificity': 0.99304473, 'binary_f1_score': 0.7071083}
confusion matrix:
       0    1
0  42119  295
1    492  950
---- Validation: 
scalar performance:
{'acc': 0.97998935, 'precision': 0.90953964, 'recall': 0.7736112, 'specificity': 0.7736112, 'f1': 0.82698333, 'auroc': 0.9782171, 'binary_precision': 0.8355856, 'binary_recall': 0.551263, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.66427934}
confusion matrix:
       0    1
0  17994   73
1    302  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.86239815, 'recall': 0.5246636, 'specificity': 0.5246636, 'f1': 0.5365894, 'auroc': 0.949581, 'binary_precision': 0.7647059, 'binary_recall': 0.05, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.09386282}
confusion matrix:
      0   1
0  5942   4
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
better model found
persisted
after epoch: 6,now: 2024-05-30 17:27:41.150809,epoch time: 0:45:46.441776,used: 4:37:02.273428,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98232853, 'precision': 0.9546399, 'recall': 0.7507032, 'specificity': 0.7507032, 'f1': 0.82130986, 'auroc': 0.98254925, 'binary_precision': 0.9259259, 'binary_recall': 0.50277394, 'binary_specificity': 0.99863255, 'binary_f1_score': 0.6516854}
confusion matrix:
       0    1
0  42356   58
1    717  725
---- Validation: 
scalar performance:
{'acc': 0.9758271, 'precision': 0.9599042, 'recall': 0.67346096, 'specificity': 0.67346096, 'f1': 0.74787617, 'auroc': 0.97892296, 'binary_precision': 0.9435484, 'binary_recall': 0.34769687, 'binary_specificity': 0.9992251, 'binary_f1_score': 0.5081433}
confusion matrix:
       0    1
0  18053   14
1    439  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.9170902, 'recall': 0.5133774, 'specificity': 0.5133774, 'f1': 0.51566154, 'auroc': 0.94919384, 'binary_precision': 0.875, 'binary_recall': 0.026923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5945  1
1   253  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 1
val acc:0.9758270978927612, best validation acc: 0.9799893498420715, corresponding to test acc:                         0.9595552682876587 / 0.9611666202545166
after epoch: 7,now: 2024-05-30 18:13:20.959096,epoch time: 0:45:39.808287,used: 5:22:42.081715,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9834458, 'precision': 0.8736781, 'recall': 0.86215, 'specificity': 0.86215, 'f1': 0.8678161, 'auroc': 0.98426646, 'binary_precision': 0.756447, 'binary_recall': 0.73231626, 'binary_specificity': 0.9919838, 'binary_f1_score': 0.7441861}
confusion matrix:
       0     1
0  42074   340
1    386  1056
---- Validation: 
scalar performance:
{'acc': 0.9783885, 'precision': 0.8649794, 'recall': 0.79924583, 'specificity': 0.79924583, 'f1': 0.8285675, 'auroc': 0.9775138, 'binary_precision': 0.74452555, 'binary_recall': 0.6062407, 'binary_specificity': 0.99225104, 'binary_f1_score': 0.6683047}
confusion matrix:
       0    1
0  17927  140
1    265  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.85963666, 'recall': 0.58720016, 'specificity': 0.58720016, 'f1': 0.63383234, 'auroc': 0.9577104, 'binary_precision': 0.75409836, 'binary_recall': 0.17692308, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.28660434}
confusion matrix:
      0   1
0  5931  15
1   214  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
new oracle model saved
early stop counter: 2
val acc:0.9783884882926941, best validation acc: 0.9799893498420715, corresponding to test acc:                         0.9595552682876587 / 0.963100254535675
after epoch: 8,now: 2024-05-30 18:58:55.428307,epoch time: 0:45:34.469211,used: 6:08:16.550926,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9849051, 'precision': 0.88347644, 'recall': 0.8773074, 'specificity': 0.8773074, 'f1': 0.8803649, 'auroc': 0.98624676, 'binary_precision': 0.77503526, 'binary_recall': 0.7621359, 'binary_specificity': 0.9924789, 'binary_f1_score': 0.7685315}
confusion matrix:
       0     1
0  42095   319
1    343  1099
---- Validation: 
scalar performance:
{'acc': 0.9788154, 'precision': 0.8633832, 'recall': 0.8116268, 'specificity': 0.8116268, 'f1': 0.83533955, 'auroc': 0.9793496, 'binary_precision': 0.74041814, 'binary_recall': 0.6315007, 'binary_specificity': 0.9917529, 'binary_f1_score': 0.6816359}
confusion matrix:
       0    1
0  17918  149
1    248  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.8431494, 'recall': 0.57373863, 'specificity': 0.57373863, 'f1': 0.6144501, 'auroc': 0.9525258, 'binary_precision': 0.7222222, 'binary_recall': 0.15, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.24840766}
confusion matrix:
      0   1
0  5931  15
1   221  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 3
val acc:0.9788153767585754, best validation acc: 0.9799893498420715, corresponding to test acc:                         0.9595552682876587 / 0.963100254535675
after epoch: 9,now: 2024-05-30 19:44:49.440461,epoch time: 0:45:54.012154,used: 6:54:10.563080,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9870485, 'precision': 0.9402205, 'recall': 0.84391546, 'specificity': 0.84391546, 'f1': 0.8857273, 'auroc': 0.9884789, 'binary_precision': 0.8908766, 'binary_recall': 0.6907073, 'binary_specificity': 0.9971236, 'binary_f1_score': 0.778125}
confusion matrix:
       0    1
0  42292  122
1    446  996
---- Validation: 
scalar performance:
{'acc': 0.9802028, 'precision': 0.9386288, 'recall': 0.75297916, 'specificity': 0.75297916, 'f1': 0.81907797, 'auroc': 0.98096955, 'binary_precision': 0.89528793, 'binary_recall': 0.50817233, 'binary_specificity': 0.99778605, 'binary_f1_score': 0.6483412}
confusion matrix:
       0    1
0  18027   40
1    331  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.8972554, 'recall': 0.5381252, 'specificity': 0.5381252, 'f1': 0.5603632, 'auroc': 0.9506502, 'binary_precision': 0.8333333, 'binary_recall': 0.07692308, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.14084508}
confusion matrix:
      0   1
0  5942   4
1   240  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
better model found
persisted
after epoch: 10,now: 2024-05-30 20:30:41.869776,epoch time: 0:45:52.429315,used: 7:40:02.992395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98757297, 'precision': 0.9327136, 'recall': 0.8612691, 'specificity': 0.8612691, 'f1': 0.893538, 'auroc': 0.9901159, 'binary_precision': 0.8746867, 'binary_recall': 0.7260749, 'binary_specificity': 0.9964634, 'binary_f1_score': 0.7934823}
confusion matrix:
       0     1
0  42264   150
1    395  1047
---- Validation: 
scalar performance:
{'acc': 0.98041624, 'precision': 0.912668, 'recall': 0.7781242, 'specificity': 0.7781242, 'f1': 0.83125997, 'auroc': 0.9802289, 'binary_precision': 0.84151787, 'binary_recall': 0.5601783, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.6726137}
confusion matrix:
       0    1
0  17996   71
1    296  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.9436172, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
better model found
persisted
after epoch: 11,now: 2024-05-30 21:17:16.845802,epoch time: 0:46:34.976026,used: 8:26:37.968421,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9878694, 'precision': 0.90588534, 'recall': 0.9026215, 'specificity': 0.9026215, 'f1': 0.9042463, 'auroc': 0.989382, 'binary_precision': 0.8181818, 'binary_recall': 0.8113731, 'binary_specificity': 0.99386996, 'binary_f1_score': 0.8147632}
confusion matrix:
       0     1
0  42154   260
1    272  1170
---- Validation: 
scalar performance:
{'acc': 0.98340446, 'precision': 0.89506704, 'recall': 0.8547771, 'specificity': 0.8547771, 'f1': 0.87374425, 'auroc': 0.9821499, 'binary_precision': 0.8006644, 'binary_recall': 0.7161961, 'binary_specificity': 0.9933581, 'binary_f1_score': 0.7560784}
confusion matrix:
       0    1
0  17947  120
1    191  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.9231329, 'recall': 0.5439785, 'specificity': 0.5439785, 'f1': 0.5705235, 'auroc': 0.94650024, 'binary_precision': 0.88461536, 'binary_recall': 0.08846154, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.16083917}
confusion matrix:
      0   1
0  5943   3
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
better model found
persisted
after epoch: 12,now: 2024-05-30 22:03:49.181621,epoch time: 0:46:32.335819,used: 9:13:10.304240,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98850787, 'precision': 0.91088533, 'recall': 0.90757895, 'specificity': 0.90757895, 'f1': 0.9092249, 'auroc': 0.9901675, 'binary_precision': 0.82785165, 'binary_recall': 0.82095766, 'binary_specificity': 0.99420017, 'binary_f1_score': 0.8243903}
confusion matrix:
       0     1
0  42169   246
1    258  1183
---- Validation: 
scalar performance:
{'acc': 0.98356456, 'precision': 0.8872436, 'recall': 0.870596, 'specificity': 0.870596, 'f1': 0.8787203, 'auroc': 0.982306, 'binary_precision': 0.7838258, 'binary_recall': 0.7488856, 'binary_specificity': 0.9923064, 'binary_f1_score': 0.7659574}
confusion matrix:
       0    1
0  17928  139
1    169  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.88407326, 'recall': 0.570397, 'specificity': 0.570397, 'f1': 0.611333, 'auroc': 0.9401474, 'binary_precision': 0.8043478, 'binary_recall': 0.1423077, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.24183008}
confusion matrix:
      0   1
0  5937   9
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
better model found
persisted
after epoch: 13,now: 2024-05-30 22:50:25.033663,epoch time: 0:46:35.852042,used: 9:59:46.156282,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9886674, 'precision': 0.927843, 'recall': 0.8872914, 'specificity': 0.8872914, 'f1': 0.9064812, 'auroc': 0.99248576, 'binary_precision': 0.8631822, 'binary_recall': 0.77877945, 'binary_specificity': 0.9958033, 'binary_f1_score': 0.8188116}
confusion matrix:
       0     1
0  42236   178
1    319  1123
---- Validation: 
scalar performance:
{'acc': 0.98345786, 'precision': 0.9059613, 'recall': 0.8404994, 'specificity': 0.8404994, 'f1': 0.8701159, 'auroc': 0.9824652, 'binary_precision': 0.8235294, 'binary_recall': 0.68647844, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.7487845}
confusion matrix:
       0    1
0  17968   99
1    211  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.91762924, 'recall': 0.5267549, 'specificity': 0.5267549, 'f1': 0.54050714, 'auroc': 0.9337331, 'binary_precision': 0.875, 'binary_recall': 0.053846154, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.10144927}
confusion matrix:
      0   1
0  5944   2
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 1
val acc:0.9834578633308411, best validation acc: 0.983564555644989, corresponding to test acc:                         0.9626168012619019 / 0.963100254535675
after epoch: 14,now: 2024-05-30 23:36:37.757580,epoch time: 0:46:12.723917,used: 10:45:58.880199,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9897848, 'precision': 0.9338198, 'recall': 0.9005972, 'specificity': 0.9005972, 'f1': 0.91649646, 'auroc': 0.9928783, 'binary_precision': 0.874247, 'binary_recall': 0.80513173, 'binary_specificity': 0.99606264, 'binary_f1_score': 0.83826715}
confusion matrix:
       0     1
0  42247   167
1    281  1161
---- Validation: 
scalar performance:
{'acc': 0.9848452, 'precision': 0.91331375, 'recall': 0.85623956, 'specificity': 0.85623956, 'f1': 0.8824805, 'auroc': 0.98330814, 'binary_precision': 0.8370884, 'binary_recall': 0.717682, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.7727999}
confusion matrix:
       0    1
0  17973   94
1    190  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.9411421, 'recall': 0.5651323, 'specificity': 0.5651323, 'f1': 0.605027, 'auroc': 0.952589, 'binary_precision': 0.9189189, 'binary_recall': 0.13076924, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.22895625}
confusion matrix:
      0   1
0  5943   3
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
better model found
persisted
after epoch: 15,now: 2024-05-31 00:23:05.282888,epoch time: 0:46:27.525308,used: 11:32:26.405507,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99014956, 'precision': 0.9483385, 'recall': 0.8904023, 'specificity': 0.8904023, 'f1': 0.91722167, 'auroc': 0.9942721, 'binary_precision': 0.904, 'binary_recall': 0.7836338, 'binary_specificity': 0.99717075, 'binary_f1_score': 0.8395245}
confusion matrix:
       0     1
0  42294   120
1    312  1130
---- Validation: 
scalar performance:
{'acc': 0.9836713, 'precision': 0.9272891, 'recall': 0.8198674, 'specificity': 0.8198674, 'f1': 0.86524, 'auroc': 0.98318946, 'binary_precision': 0.86773545, 'binary_recall': 0.6433878, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.7389079}
confusion matrix:
       0    1
0  18001   66
1    240  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.85634935, 'recall': 0.5568514, 'specificity': 0.5568514, 'f1': 0.5900925, 'auroc': 0.9457358, 'binary_precision': 0.75, 'binary_recall': 0.115384616, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.2}
confusion matrix:
      0   1
0  5936  10
1   230  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 1
val acc:0.9836713075637817, best validation acc: 0.9848452210426331, corresponding to test acc:                         0.963100254535675 / 0.963100254535675
after epoch: 16,now: 2024-05-31 01:09:47.440544,epoch time: 0:46:42.157656,used: 12:19:08.563163,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.989876, 'precision': 0.908009, 'recall': 0.9401687, 'specificity': 0.9401687, 'f1': 0.92342854, 'auroc': 0.9945519, 'binary_precision': 0.8198718, 'binary_recall': 0.88696253, 'binary_specificity': 0.9933748, 'binary_f1_score': 0.8520986}
confusion matrix:
       0     1
0  42133   281
1    163  1279
---- Validation: 
scalar performance:
{'acc': 0.9850587, 'precision': 0.8893295, 'recall': 0.8971205, 'specificity': 0.8971205, 'f1': 0.8931829, 'auroc': 0.9834962, 'binary_precision': 0.7860262, 'binary_recall': 0.8023774, 'binary_specificity': 0.9918636, 'binary_f1_score': 0.7941176}
confusion matrix:
       0    1
0  17920  147
1    133  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.96787775, 'recall': 0.5672236, 'specificity': 0.5672236, 'f1': 0.60891676, 'auroc': 0.9406949, 'binary_precision': 0.9722222, 'binary_recall': 0.13461539, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.2364865}
confusion matrix:
      0   1
0  5945   1
1   225  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-05-31 01:56:26.892377,epoch time: 0:46:39.451833,used: 13:05:48.014996,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99090207, 'precision': 0.9420628, 'recall': 0.91088843, 'specificity': 0.91088843, 'f1': 0.92586267, 'auroc': 0.9945878, 'binary_precision': 0.8900524, 'binary_recall': 0.8252427, 'binary_specificity': 0.99653417, 'binary_f1_score': 0.8564232}
confusion matrix:
       0     1
0  42267   147
1    252  1190
---- Validation: 
scalar performance:
{'acc': 0.98628604, 'precision': 0.9187854, 'recall': 0.8748685, 'specificity': 0.8748685, 'f1': 0.89550835, 'auroc': 0.9841658, 'binary_precision': 0.8466667, 'binary_recall': 0.7548291, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.7981148}
confusion matrix:
       0    1
0  17975   92
1    165  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.9806014, 'recall': 0.53846157, 'specificity': 0.53846157, 'f1': 0.5615374, 'auroc': 0.9239322, 'binary_precision': 1.0, 'binary_recall': 0.07692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.14285713}
confusion matrix:
      0   1
0  5946   0
1   240  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
better model found
persisted
after epoch: 18,now: 2024-05-31 02:44:59.739401,epoch time: 0:48:32.847024,used: 13:54:20.862020,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99097043, 'precision': 0.9383895, 'recall': 0.916618, 'specificity': 0.916618, 'f1': 0.92720526, 'auroc': 0.99515426, 'binary_precision': 0.8823099, 'binary_recall': 0.8370319, 'binary_specificity': 0.9962041, 'binary_f1_score': 0.8590747}
confusion matrix:
       0     1
0  42253   161
1    235  1207
---- Validation: 
scalar performance:
{'acc': 0.98537886, 'precision': 0.9081179, 'recall': 0.8729675, 'specificity': 0.8729675, 'f1': 0.8896829, 'auroc': 0.98381275, 'binary_precision': 0.82544863, 'binary_recall': 0.75185734, 'binary_specificity': 0.9940776, 'binary_f1_score': 0.78693616}
confusion matrix:
       0    1
0  17960  107
1    167  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9123324, 'recall': 0.5362862, 'specificity': 0.5362862, 'f1': 0.5573182, 'auroc': 0.94018495, 'binary_precision': 0.8636364, 'binary_recall': 0.073076926, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.13475178}
confusion matrix:
      0   1
0  5943   3
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 1
val acc:0.9853788614273071, best validation acc: 0.9862860441207886, corresponding to test acc:                         0.9613277316093445 / 0.9635836482048035
after epoch: 19,now: 2024-05-31 03:33:58.405173,epoch time: 0:48:58.665772,used: 14:43:19.527792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99176854, 'precision': 0.9405307, 'recall': 0.928419, 'specificity': 0.928419, 'f1': 0.934384, 'auroc': 0.9956261, 'binary_precision': 0.88579583, 'binary_recall': 0.86061025, 'binary_specificity': 0.9962277, 'binary_f1_score': 0.8730215}
confusion matrix:
       0     1
0  42254   160
1    201  1241
---- Validation: 
scalar performance:
{'acc': 0.98719317, 'precision': 0.9235587, 'recall': 0.8846374, 'specificity': 0.8846374, 'f1': 0.9030811, 'auroc': 0.9838356, 'binary_precision': 0.8555008, 'binary_recall': 0.7741456, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.8127925}
confusion matrix:
       0    1
0  17979   88
1    152  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.93733084, 'recall': 0.5593631, 'specificity': 0.5593631, 'f1': 0.59586966, 'auroc': 0.9347671, 'binary_precision': 0.9117647, 'binary_recall': 0.11923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.21088435}
confusion matrix:
      0   1
0  5943   3
1   229  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
better model found
persisted
after epoch: 20,now: 2024-05-31 04:22:36.693920,epoch time: 0:48:38.288747,used: 15:31:57.816539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9904916, 'precision': 0.9829299, 'recall': 0.86445284, 'specificity': 0.86445284, 'f1': 0.91484725, 'auroc': 0.9958729, 'binary_precision': 0.97497684, 'binary_recall': 0.7295423, 'binary_specificity': 0.9993634, 'binary_f1_score': 0.8345894}
confusion matrix:
       0     1
0  42387    27
1    390  1052
---- Validation: 
scalar performance:
{'acc': 0.98249733, 'precision': 0.9579598, 'recall': 0.77562726, 'specificity': 0.77562726, 'f1': 0.8425104, 'auroc': 0.98330635, 'binary_precision': 0.93233085, 'binary_recall': 0.55274886, 'binary_specificity': 0.9985056, 'binary_f1_score': 0.6940298}
confusion matrix:
       0    1
0  18040   27
1    301  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.9443406, 'recall': 0.5249159, 'specificity': 0.5249159, 'f1': 0.5372294, 'auroc': 0.9375422, 'binary_precision': 0.9285714, 'binary_recall': 0.05, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.09489051}
confusion matrix:
      0   1
0  5945   1
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 1
val acc:0.9824973344802856, best validation acc: 0.9871931672096252, corresponding to test acc:                         0.9626168012619019 / 0.9635836482048035
after epoch: 21,now: 2024-05-31 05:10:53.640902,epoch time: 0:48:16.946982,used: 16:20:14.763521,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9917001, 'precision': 0.93135154, 'recall': 0.93943703, 'specificity': 0.93943703, 'f1': 0.93535376, 'auroc': 0.99650156, 'binary_precision': 0.8666667, 'binary_recall': 0.88349515, 'binary_specificity': 0.9953789, 'binary_f1_score': 0.875}
confusion matrix:
       0     1
0  42218   196
1    168  1274
---- Validation: 
scalar performance:
{'acc': 0.98580575, 'precision': 0.910469, 'recall': 0.8774805, 'specificity': 0.8774805, 'f1': 0.8932242, 'auroc': 0.9845226, 'binary_precision': 0.8298217, 'binary_recall': 0.76077265, 'binary_specificity': 0.9941883, 'binary_f1_score': 0.79379845}
confusion matrix:
       0    1
0  17962  105
1    161  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.8794702, 'recall': 0.5665509, 'specificity': 0.5665509, 'f1': 0.6054686, 'auroc': 0.9464842, 'binary_precision': 0.79545456, 'binary_recall': 0.13461539, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.23026319}
confusion matrix:
      0   1
0  5937   9
1   225  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 2
val acc:0.9858057498931885, best validation acc: 0.9871931672096252, corresponding to test acc:                         0.9626168012619019 / 0.9635836482048035
after epoch: 22,now: 2024-05-31 05:59:08.196025,epoch time: 0:48:14.555123,used: 17:08:29.318644,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9922702, 'precision': 0.96462286, 'recall': 0.909921, 'specificity': 0.909921, 'f1': 0.9354367, 'auroc': 0.9967666, 'binary_precision': 0.9352802, 'binary_recall': 0.8217753, 'binary_specificity': 0.99806666, 'binary_f1_score': 0.8748616}
confusion matrix:
       0     1
0  42332    82
1    257  1185
---- Validation: 
scalar performance:
{'acc': 0.9870865, 'precision': 0.9461835, 'recall': 0.8574019, 'specificity': 0.8574019, 'f1': 0.8964985, 'auroc': 0.983295, 'binary_precision': 0.9028037, 'binary_recall': 0.717682, 'binary_specificity': 0.9971218, 'binary_f1_score': 0.7996688}
confusion matrix:
       0    1
0  18015   52
1    190  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.95999813, 'recall': 0.54414666, 'specificity': 0.54414666, 'f1': 0.5711739, 'auroc': 0.9205786, 'binary_precision': 0.9583333, 'binary_recall': 0.08846154, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.16197182}
confusion matrix:
      0   1
0  5945   1
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 3
val acc:0.9870864748954773, best validation acc: 0.9871931672096252, corresponding to test acc:                         0.9626168012619019 / 0.9635836482048035
after epoch: 23,now: 2024-05-31 06:47:16.073674,epoch time: 0:48:07.877649,used: 17:56:37.196293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99122125, 'precision': 0.95495915, 'recall': 0.9020098, 'specificity': 0.9020098, 'f1': 0.9267283, 'auroc': 0.9956398, 'binary_precision': 0.91646963, 'binary_recall': 0.80651873, 'binary_specificity': 0.99750084, 'binary_f1_score': 0.857986}
confusion matrix:
       0     1
0  42308   106
1    279  1163
---- Validation: 
scalar performance:
{'acc': 0.9842049, 'precision': 0.92475474, 'recall': 0.8315884, 'specificity': 0.8315884, 'f1': 0.87196815, 'auroc': 0.9818245, 'binary_precision': 0.86180425, 'binary_recall': 0.66716194, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.7520938}
confusion matrix:
       0    1
0  17995   72
1    224  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.9813795, 'recall': 0.5576923, 'specificity': 0.5576923, 'f1': 0.5939614, 'auroc': 0.93407965, 'binary_precision': 1.0, 'binary_recall': 0.115384616, 'binary_specificity': 1.0, 'binary_f1_score': 0.20689656}
confusion matrix:
      0   1
0  5946   0
1   230  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 4
val acc:0.984204888343811, best validation acc: 0.9871931672096252, corresponding to test acc:                         0.9626168012619019 / 0.9635836482048035
after epoch: 24,now: 2024-05-31 07:32:36.296860,epoch time: 0:45:20.223186,used: 18:41:57.419479,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99245256, 'precision': 0.95398855, 'recall': 0.9244182, 'specificity': 0.9244182, 'f1': 0.9386684, 'auroc': 0.9967052, 'binary_precision': 0.91301113, 'binary_recall': 0.851595, 'binary_specificity': 0.9972415, 'binary_f1_score': 0.8812343}
confusion matrix:
       0     1
0  42297   117
1    214  1228
---- Validation: 
scalar performance:
{'acc': 0.98804694, 'precision': 0.94755054, 'recall': 0.8714901, 'specificity': 0.8714901, 'f1': 0.90570533, 'auroc': 0.98429245, 'binary_precision': 0.9045045, 'binary_recall': 0.7459138, 'binary_specificity': 0.9970665, 'binary_f1_score': 0.8175896}
confusion matrix:
       0    1
0  18014   53
1    171  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.9386693, 'recall': 0.5612862, 'specificity': 0.5612862, 'f1': 0.5989425, 'auroc': 0.92421484, 'binary_precision': 0.9142857, 'binary_recall': 0.12307692, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.21694915}
confusion matrix:
      0   1
0  5943   3
1   228  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
better model found
persisted
after epoch: 25,now: 2024-05-31 08:18:00.904241,epoch time: 0:45:24.607381,used: 19:27:22.026860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9920877, 'precision': 0.9523869, 'recall': 0.91987526, 'specificity': 0.91987526, 'f1': 0.93547976, 'auroc': 0.9975586, 'binary_precision': 0.9101124, 'binary_recall': 0.8425797, 'binary_specificity': 0.99717075, 'binary_f1_score': 0.875045}
confusion matrix:
       0     1
0  42294   120
1    227  1215
---- Validation: 
scalar performance:
{'acc': 0.98655283, 'precision': 0.9365448, 'recall': 0.8585557, 'specificity': 0.8585557, 'f1': 0.8934152, 'auroc': 0.98351836, 'binary_precision': 0.8834244, 'binary_recall': 0.7206538, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.7937807}
confusion matrix:
       0    1
0  18003   64
1    188  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.9508759, 'recall': 0.5306851, 'specificity': 0.5306851, 'f1': 0.5476669, 'auroc': 0.917626, 'binary_precision': 0.9411765, 'binary_recall': 0.06153846, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.11552346}
confusion matrix:
      0   1
0  5945   1
1   244  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 1
val acc:0.9865528345108032, best validation acc: 0.9880469441413879, corresponding to test acc:                         0.9627779722213745 / 0.9635836482048035
after epoch: 26,now: 2024-05-31 09:03:23.069549,epoch time: 0:45:22.165308,used: 20:12:44.192168,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99254376, 'precision': 0.9589989, 'recall': 0.920446, 'specificity': 0.920446, 'f1': 0.93881476, 'auroc': 0.9968508, 'binary_precision': 0.9233106, 'binary_recall': 0.8432732, 'binary_specificity': 0.99761873, 'binary_f1_score': 0.8814788}
confusion matrix:
       0     1
0  42313   101
1    226  1216
---- Validation: 
scalar performance:
{'acc': 0.9872999, 'precision': 0.9417335, 'recall': 0.8653805, 'specificity': 0.8653805, 'f1': 0.8996539, 'auroc': 0.98292637, 'binary_precision': 0.89330924, 'binary_recall': 0.73402673, 'binary_specificity': 0.9967344, 'binary_f1_score': 0.8058727}
confusion matrix:
       0    1
0  18008   59
1    179  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.9805237, 'recall': 0.5365385, 'specificity': 0.5365385, 'f1': 0.55816877, 'auroc': 0.91691554, 'binary_precision': 1.0, 'binary_recall': 0.073076926, 'binary_specificity': 1.0, 'binary_f1_score': 0.13620071}
confusion matrix:
      0   1
0  5946   0
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 2
val acc:0.987299919128418, best validation acc: 0.9880469441413879, corresponding to test acc:                         0.9627779722213745 / 0.9635836482048035
after epoch: 27,now: 2024-05-31 09:48:20.677317,epoch time: 0:44:57.607768,used: 20:57:41.799936,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99309105, 'precision': 0.9768541, 'recall': 0.9116852, 'specificity': 0.9116852, 'f1': 0.9417095, 'auroc': 0.99800444, 'binary_precision': 0.95964485, 'binary_recall': 0.82454926, 'binary_specificity': 0.99882114, 'binary_f1_score': 0.88698244}
confusion matrix:
       0     1
0  42364    50
1    253  1189
---- Validation: 
scalar performance:
{'acc': 0.9863394, 'precision': 0.94827914, 'recall': 0.8434244, 'specificity': 0.8434244, 'f1': 0.88836527, 'auroc': 0.98231846, 'binary_precision': 0.9080235, 'binary_recall': 0.6894502, 'binary_specificity': 0.99739856, 'binary_f1_score': 0.78378373}
confusion matrix:
       0    1
0  18020   47
1    209  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.9555205, 'recall': 0.5364544, 'specificity': 0.5364544, 'f1': 0.5578835, 'auroc': 0.9212283, 'binary_precision': 0.95, 'binary_recall': 0.073076926, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.13571429}
confusion matrix:
      0   1
0  5945   1
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 3
val acc:0.9863393902778625, best validation acc: 0.9880469441413879, corresponding to test acc:                         0.9627779722213745 / 0.9635836482048035
after epoch: 28,now: 2024-05-31 10:32:59.514562,epoch time: 0:44:38.837245,used: 21:42:20.637181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99361545, 'precision': 0.9743577, 'recall': 0.9226748, 'specificity': 0.9226748, 'f1': 0.9469199, 'auroc': 0.9982766, 'binary_precision': 0.95390624, 'binary_recall': 0.84674066, 'binary_specificity': 0.99860895, 'binary_f1_score': 0.8971344}
confusion matrix:
       0     1
0  42355    59
1    221  1221
---- Validation: 
scalar performance:
{'acc': 0.9864995, 'precision': 0.9434002, 'recall': 0.8506601, 'specificity': 0.8506601, 'f1': 0.8911843, 'auroc': 0.9803641, 'binary_precision': 0.89772725, 'binary_recall': 0.70430905, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.7893422}
confusion matrix:
       0    1
0  18013   54
1    199  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.92074746, 'recall': 0.5420554, 'specificity': 0.5420554, 'f1': 0.56725645, 'auroc': 0.9181384, 'binary_precision': 0.88, 'binary_recall': 0.08461539, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.15438597}
confusion matrix:
      0   1
0  5943   3
1   238  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 4
val acc:0.9864994883537292, best validation acc: 0.9880469441413879, corresponding to test acc:                         0.9627779722213745 / 0.9635836482048035
after epoch: 29,now: 2024-05-31 11:17:51.558044,epoch time: 0:44:52.043482,used: 22:27:12.680663,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9935927, 'precision': 0.9516547, 'recall': 0.9471145, 'specificity': 0.9471145, 'f1': 0.9493723, 'auroc': 0.998268, 'binary_precision': 0.90679747, 'binary_recall': 0.8973648, 'binary_specificity': 0.99686426, 'binary_f1_score': 0.9020565}
confusion matrix:
       0     1
0  42281   133
1    148  1294
---- Validation: 
scalar performance:
{'acc': 0.9875667, 'precision': 0.9279562, 'recall': 0.88554645, 'specificity': 0.88554645, 'f1': 0.9055525, 'auroc': 0.9828605, 'binary_precision': 0.8642384, 'binary_recall': 0.7756315, 'binary_specificity': 0.99546134, 'binary_f1_score': 0.81754106}
confusion matrix:
       0    1
0  17985   82
1    151  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.9085456, 'recall': 0.52290875, 'specificity': 0.52290875, 'f1': 0.5334974, 'auroc': 0.9272787, 'binary_precision': 0.85714287, 'binary_recall': 0.046153847, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.087591246}
confusion matrix:
      0   1
0  5944   2
1   248  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
early stop counter: 5
val acc:0.9875667095184326, best validation acc: 0.9880469441413879, corresponding to test acc:                         0.9627779722213745 / 0.9635836482048035
after epoch: 30,now: 2024-05-31 12:02:40.963443,epoch time: 0:44:49.405399,used: 23:12:02.086062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_12_50_38_seed_1_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 23:12:02.086062 at 2024-05-31 12:02:40.963443
persisted model performance metric: 

scalar performance:
{'acc': 0.96052206, 'precision': 0.8805857, 'recall': 0.5380411, 'specificity': 0.5380411, 'f1': 0.560074, 'auroc': 0.92851114, 'binary_precision': 0.8, 'binary_recall': 0.07692308, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.14035088}
confusion matrix:
      0   1
0  5941   5
1   240  20
oracle model performance metric: 

scalar performance:
{'acc': 0.96310025, 'precision': 0.8969524, 'recall': 0.5743273, 'specificity': 0.5743273, 'f1': 0.6175769, 'auroc': 0.9333193, 'binary_precision': 0.82978725, 'binary_recall': 0.15, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.25407168}
confusion matrix:
      0   1
0  5938   8
1   221  39
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1664 MiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |   1657 MiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1664 MiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |   1657 MiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |   1979 TiB |   1979 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   1953 TiB |   1953 TiB |
|       from small pool |      5 MiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16758 MiB |  16758 MiB |  31406 MiB |  14648 MiB |
|       from large pool |  16730 MiB |  16730 MiB |  31376 MiB |  14646 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 397178 KiB |    905 MiB |    809 TiB |    809 TiB |
|       from large pool | 377232 KiB |    904 MiB |    784 TiB |    784 TiB |
|       from small pool |  19946 KiB |     24 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3342    |    6365    |  304805 K  |  304801 K  |
|       from large pool |     247    |     989    |  124920 K  |  124920 K  |
|       from small pool |    3095    |    6116    |  179884 K  |  179881 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3342    |    6365    |  304805 K  |  304801 K  |
|       from large pool |     247    |     989    |  124920 K  |  124920 K  |
|       from small pool |    3095    |    6116    |  179884 K  |  179881 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |    1127    |     506    |
|       from large pool |     607    |     607    |    1112    |     505    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     143    |    2872    |  180198 K  |  180198 K  |
|       from large pool |     107    |     516    |   93732 K  |   93731 K  |
|       from small pool |      36    |    2763    |   86466 K  |   86466 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1979 TiB |   1979 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1953 TiB |   1953 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2052 MiB |  16758 MiB |  31406 MiB |  29354 MiB |
|       from large pool |   2026 MiB |  16730 MiB |  31376 MiB |  29350 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    905 MiB |    809 TiB |    809 TiB |
|       from large pool |  24320 KiB |    904 MiB |    784 TiB |    784 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304805 K  |  304805 K  |
|       from large pool |       2    |     989    |  124920 K  |  124920 K  |
|       from small pool |       0    |    6116    |  179884 K  |  179884 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304805 K  |  304805 K  |
|       from large pool |       2    |     989    |  124920 K  |  124920 K  |
|       from small pool |       0    |    6116    |  179884 K  |  179884 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     113    |     621    |    1127    |    1014    |
|       from large pool |     100    |     607    |    1112    |    1012    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2872    |  180200 K  |  180200 K  |
|       from large pool |       2    |     516    |   93732 K  |   93732 K  |
|       from small pool |       0    |    2763    |   86468 K  |   86468 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1979 TiB |   1979 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1953 TiB |   1953 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2052 MiB |  16758 MiB |  31406 MiB |  29354 MiB |
|       from large pool |   2026 MiB |  16730 MiB |  31376 MiB |  29350 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    905 MiB |    809 TiB |    809 TiB |
|       from large pool |  24320 KiB |    904 MiB |    784 TiB |    784 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304805 K  |  304805 K  |
|       from large pool |       2    |     989    |  124920 K  |  124920 K  |
|       from small pool |       0    |    6116    |  179884 K  |  179884 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304805 K  |  304805 K  |
|       from large pool |       2    |     989    |  124920 K  |  124920 K  |
|       from small pool |       0    |    6116    |  179884 K  |  179884 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     113    |     621    |    1127    |    1014    |
|       from large pool |     100    |     607    |    1112    |    1012    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2872    |  180200 K  |  180200 K  |
|       from large pool |       2    |     516    |   93732 K  |   93732 K  |
|       from small pool |       0    |    2763    |   86468 K  |   86468 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_12_58_seed_2_20993752

 Experiment start at: 2024-05-31 12:12:59.037446
before training, model accuracy: 0.18945343792438507
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9680768, 'precision': 0.761291, 'recall': 0.74543464, 'specificity': 0.74543464, 'f1': 0.75308734, 'auroc': 0.9442883, 'binary_precision': 0.54019743, 'binary_recall': 0.50627893, 'binary_specificity': 0.9845903, 'binary_f1_score': 0.5226885}
confusion matrix:
       0    1
0  41659  652
1    747  766
---- Validation: 
scalar performance:
{'acc': 0.9694242, 'precision': 0.75404453, 'recall': 0.7368667, 'specificity': 0.7368667, 'f1': 0.745124, 'auroc': 0.9413837, 'binary_precision': 0.525, 'binary_recall': 0.4883721, 'binary_specificity': 0.9853613, 'binary_f1_score': 0.5060241}
confusion matrix:
       0    1
0  17905  266
1    308  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9717904, 'precision': 0.8775776, 'recall': 0.68791485, 'specificity': 0.68791485, 'f1': 0.74829364, 'auroc': 0.925779, 'binary_precision': 0.779661, 'binary_recall': 0.38016528, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.5111111}
confusion matrix:
      0   1
0  5971  26
1   150  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993752.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-31 12:55:13.134063,epoch time: 0:42:14.096617,used: 0:42:14.096617,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_31_12_12_58_seed_2_20993752
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
slurmstepd: error: *** JOB 20993752 ON gpusrv30 CANCELLED AT 2024-05-31T13:26:11 DUE TO TIME LIMIT ***
