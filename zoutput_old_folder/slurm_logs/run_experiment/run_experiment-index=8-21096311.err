Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jun  4 18:56:15 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311

 Experiment start at: 2024-06-04 19:03:10.611135
before training, model accuracy: 0.2401725947856903
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9663181, 'precision': 0.6498908, 'recall': 0.50094813, 'specificity': 0.50094813, 'f1': 0.49346033, 'auroc': 0.83928466, 'binary_precision': 0.33333334, 'binary_recall': 0.0020380435, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.004051317}
confusion matrix:
       0  1
0  42314  6
1   1469  3
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.48288894, 'recall': 0.49991736, 'specificity': 0.49991736, 'f1': 0.4912556, 'auroc': 0.8194325, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18146  3
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.81246626, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-04 19:25:03.280408,epoch time: 0:21:52.669273,used: 0:21:52.669273,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9668204, 'precision': 0.7808708, 'recall': 0.51989603, 'specificity': 0.51989603, 'f1': 0.52969706, 'auroc': 0.89662135, 'binary_precision': 0.5940594, 'binary_recall': 0.04076087, 'binary_specificity': 0.9990312, 'binary_f1_score': 0.07628735}
confusion matrix:
       0   1
0  42279  41
1   1412  60
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.8319595, 'recall': 0.5176094, 'specificity': 0.5176094, 'f1': 0.525489, 'auroc': 0.89208734, 'binary_precision': 0.6969697, 'binary_recall': 0.035769828, 'binary_specificity': 0.999449, 'binary_f1_score': 0.06804734}
confusion matrix:
       0   1
0  18139  10
1    620  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8661351, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_2.png
better model found
persisted
after epoch: 2,now: 2024-06-04 19:45:47.604434,epoch time: 0:20:44.324026,used: 0:42:36.993299,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9671173, 'precision': 0.75742066, 'recall': 0.5649663, 'specificity': 0.5649663, 'f1': 0.599019, 'auroc': 0.9150662, 'binary_precision': 0.5441989, 'binary_recall': 0.13383152, 'binary_specificity': 0.99610114, 'binary_f1_score': 0.21483096}
confusion matrix:
       0    1
0  42155  165
1   1275  197
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.747843, 'recall': 0.59105974, 'specificity': 0.59105974, 'f1': 0.6298359, 'auroc': 0.91325974, 'binary_precision': 0.52380955, 'binary_recall': 0.1881804, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.27688786}
confusion matrix:
       0    1
0  18039  110
1    522  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.9796065, 'recall': 0.5114943, 'specificity': 0.5114943, 'f1': 0.5120629, 'auroc': 0.8809221, 'binary_precision': 1.0, 'binary_recall': 0.022988506, 'binary_specificity': 1.0, 'binary_f1_score': 0.044943817}
confusion matrix:
      0  1
0  5997  0
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_3.png
new oracle model saved
early stop counter: 1
val acc:0.9663686752319336, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9582933783531189 / 0.9592521786689758
after epoch: 3,now: 2024-06-04 20:06:51.082808,epoch time: 0:21:03.478374,used: 1:03:40.471673,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9669346, 'precision': 0.74533623, 'recall': 0.6291322, 'specificity': 0.6291322, 'f1': 0.66743493, 'auroc': 0.9201441, 'binary_precision': 0.515748, 'binary_recall': 0.2669837, 'binary_specificity': 0.99128073, 'binary_f1_score': 0.35183528}
confusion matrix:
       0    1
0  41951  369
1   1079  393
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.7402621, 'recall': 0.6358702, 'specificity': 0.6358702, 'f1': 0.67208564, 'auroc': 0.92521936, 'binary_precision': 0.50558656, 'binary_recall': 0.281493, 'binary_specificity': 0.99024737, 'binary_f1_score': 0.36163837}
confusion matrix:
       0    1
0  17972  177
1    462  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.9423591, 'recall': 0.5667997, 'specificity': 0.5667997, 'f1': 0.6076847, 'auroc': 0.9006885, 'binary_precision': 0.92105263, 'binary_recall': 0.13409962, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.2341137}
confusion matrix:
      0   1
0  5994   3
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_4.png
new oracle model saved
early stop counter: 2
val acc:0.9659961462020874, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9582933783531189 / 0.9634068608283997
after epoch: 4,now: 2024-06-04 20:27:41.789271,epoch time: 0:20:50.706463,used: 1:24:31.178136,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9666149, 'precision': 0.7410555, 'recall': 0.67038524, 'specificity': 0.67038524, 'f1': 0.69900846, 'auroc': 0.93059456, 'binary_precision': 0.5043732, 'binary_recall': 0.3528212, 'binary_specificity': 0.98794925, 'binary_f1_score': 0.4152}
confusion matrix:
       0    1
0  41811  510
1    952  519
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.738918, 'recall': 0.6777631, 'specificity': 0.6777631, 'f1': 0.7033593, 'auroc': 0.93144405, 'binary_precision': 0.5, 'binary_recall': 0.36858475, 'binary_specificity': 0.98694146, 'binary_f1_score': 0.42435095}
confusion matrix:
       0    1
0  17912  237
1    406  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.8991684, 'recall': 0.61202633, 'specificity': 0.61202633, 'f1': 0.66892886, 'auroc': 0.9016994, 'binary_precision': 0.8309859, 'binary_recall': 0.22605364, 'binary_specificity': 0.997999, 'binary_f1_score': 0.3554217}
confusion matrix:
      0   1
0  5985  12
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_5.png
new oracle model saved
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9582933783531189 / 0.9658037424087524
after epoch: 5,now: 2024-06-04 20:49:04.931825,epoch time: 0:21:23.142554,used: 1:45:54.320690,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9657015, 'precision': 0.73659176, 'recall': 0.7461957, 'specificity': 0.7461957, 'f1': 0.741287, 'auroc': 0.93284845, 'binary_precision': 0.49022165, 'binary_recall': 0.51086956, 'binary_specificity': 0.9815217, 'binary_f1_score': 0.50033265}
confusion matrix:
       0    1
0  41538  782
1    720  752
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.7384776, 'recall': 0.74954796, 'specificity': 0.74954796, 'f1': 0.7438722, 'auroc': 0.9349291, 'binary_precision': 0.49406528, 'binary_recall': 0.5178849, 'binary_specificity': 0.98121107, 'binary_f1_score': 0.5056947}
confusion matrix:
       0    1
0  17808  341
1    310  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97203577, 'precision': 0.93219817, 'recall': 0.68673897, 'specificity': 0.68673897, 'f1': 0.7569463, 'auroc': 0.90904295, 'binary_precision': 0.8909091, 'binary_recall': 0.37547892, 'binary_specificity': 0.997999, 'binary_f1_score': 0.5283019}
confusion matrix:
      0   1
0  5985  12
1   163  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_6.png
new oracle model saved
early stop counter: 4
val acc:0.9653576016426086, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9582933783531189 / 0.9720357656478882
after epoch: 6,now: 2024-06-04 21:09:48.955403,epoch time: 0:20:44.023578,used: 2:06:38.344268,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9670031, 'precision': 0.74586403, 'recall': 0.73342687, 'specificity': 0.73342687, 'f1': 0.739466, 'auroc': 0.9345387, 'binary_precision': 0.5096774, 'binary_recall': 0.4830163, 'binary_specificity': 0.9838374, 'binary_f1_score': 0.49598885}
confusion matrix:
       0    1
0  41636  684
1    761  711
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.73957956, 'recall': 0.74065757, 'specificity': 0.74065757, 'f1': 0.7401172, 'auroc': 0.9394469, 'binary_precision': 0.49690402, 'binary_recall': 0.4992224, 'binary_specificity': 0.9820927, 'binary_f1_score': 0.49806052}
confusion matrix:
       0    1
0  17824  325
1    322  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97315437, 'precision': 0.923608, 'recall': 0.7074783, 'specificity': 0.7074783, 'f1': 0.77545846, 'auroc': 0.9152389, 'binary_precision': 0.872, 'binary_recall': 0.41762453, 'binary_specificity': 0.997332, 'binary_f1_score': 0.5647669}
confusion matrix:
      0    1
0  5981   16
1   152  109
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_7.png
new oracle model saved
early stop counter: 5
val acc:0.9655704498291016, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9582933783531189 / 0.9731543660163879
after epoch: 7,now: 2024-06-04 21:30:15.458209,epoch time: 0:20:26.502806,used: 2:27:04.847074,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9668661, 'precision': 0.7447972, 'recall': 0.7433512, 'specificity': 0.7433512, 'f1': 0.74407184, 'auroc': 0.9406909, 'binary_precision': 0.50683993, 'binary_recall': 0.50373894, 'binary_specificity': 0.98296356, 'binary_f1_score': 0.50528467}
confusion matrix:
       0    1
0  41600  721
1    730  741
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.739233, 'recall': 0.732407, 'specificity': 0.732407, 'f1': 0.7357648, 'auroc': 0.9400101, 'binary_precision': 0.49679488, 'binary_recall': 0.4821151, 'binary_specificity': 0.9826988, 'binary_f1_score': 0.48934492}
confusion matrix:
       0    1
0  17835  314
1    333  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9742729, 'precision': 0.9333223, 'recall': 0.7172236, 'specificity': 0.7172236, 'f1': 0.78642106, 'auroc': 0.9209143, 'binary_precision': 0.890625, 'binary_recall': 0.43678162, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.5861182}
confusion matrix:
      0    1
0  5983   14
1   147  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_8.png
new oracle model saved
early stop counter: 6
val acc:0.9655704498291016, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9582933783531189 / 0.9742729067802429
after epoch: 8,now: 2024-06-04 21:51:02.952029,epoch time: 0:20:47.493820,used: 2:47:52.340894,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9679165, 'precision': 0.7528274, 'recall': 0.76193964, 'specificity': 0.76193964, 'f1': 0.7572938, 'auroc': 0.94115764, 'binary_precision': 0.52162516, 'binary_recall': 0.54112846, 'binary_specificity': 0.9827509, 'binary_f1_score': 0.53119785}
confusion matrix:
       0    1
0  41591  730
1    675  796
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.74934816, 'recall': 0.77357113, 'specificity': 0.77357113, 'f1': 0.7608329, 'auroc': 0.94524604, 'binary_precision': 0.5141243, 'binary_recall': 0.5660964, 'binary_specificity': 0.9810458, 'binary_f1_score': 0.5388601}
confusion matrix:
       0    1
0  17805  344
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9749121, 'precision': 0.92696786, 'recall': 0.7303834, 'specificity': 0.7303834, 'f1': 0.79677963, 'auroc': 0.9189465, 'binary_precision': 0.8768116, 'binary_recall': 0.46360153, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.60651636}
confusion matrix:
      0    1
0  5980   17
1   140  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_9.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-06-04 22:11:33.316206,epoch time: 0:20:30.364177,used: 3:08:22.705071,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9683504, 'precision': 0.7563434, 'recall': 0.7529776, 'specificity': 0.7529776, 'f1': 0.7546482, 'auroc': 0.94423133, 'binary_precision': 0.52929014, 'binary_recall': 0.52209383, 'binary_specificity': 0.98386145, 'binary_f1_score': 0.52566737}
confusion matrix:
       0    1
0  41638  683
1    703  768
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7519443, 'recall': 0.7632632, 'specificity': 0.7632632, 'f1': 0.7574651, 'auroc': 0.946751, 'binary_precision': 0.5200594, 'binary_recall': 0.5443235, 'binary_specificity': 0.9822029, 'binary_f1_score': 0.5319149}
confusion matrix:
       0    1
0  17826  323
1    293  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9757111, 'precision': 0.93214583, 'recall': 0.7381296, 'specificity': 0.7381296, 'f1': 0.8046715, 'auroc': 0.9219934, 'binary_precision': 0.8865248, 'binary_recall': 0.4789272, 'binary_specificity': 0.997332, 'binary_f1_score': 0.62189054}
confusion matrix:
      0    1
0  5981   16
1   136  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_10.png
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-06-04 22:32:17.715503,epoch time: 0:20:44.399297,used: 3:29:07.104368,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9675968, 'precision': 0.7506423, 'recall': 0.77438855, 'specificity': 0.77438855, 'f1': 0.761917, 'auroc': 0.9446959, 'binary_precision': 0.51638836, 'binary_recall': 0.56725544, 'binary_specificity': 0.9815217, 'binary_f1_score': 0.540628}
confusion matrix:
       0    1
0  41538  782
1    637  835
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.75079757, 'recall': 0.76918095, 'specificity': 0.76918095, 'f1': 0.7596266, 'auroc': 0.9474967, 'binary_precision': 0.517341, 'binary_recall': 0.55676514, 'binary_specificity': 0.98159677, 'binary_f1_score': 0.53632957}
confusion matrix:
       0    1
0  17815  334
1    285  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97619045, 'precision': 0.9362282, 'recall': 0.7420444, 'specificity': 0.7420444, 'f1': 0.80898607, 'auroc': 0.9276246, 'binary_precision': 0.8943662, 'binary_recall': 0.48659003, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.630273}
confusion matrix:
      0    1
0  5982   15
1   134  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_11.png
new oracle model saved
early stop counter: 1
val acc:0.9670604467391968, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9757111072540283 / 0.976190447807312
after epoch: 11,now: 2024-06-04 22:53:06.857048,epoch time: 0:20:49.141545,used: 3:49:56.245913,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9672086, 'precision': 0.7477313, 'recall': 0.7691195, 'specificity': 0.7691195, 'f1': 0.75793207, 'auroc': 0.94898784, 'binary_precision': 0.510917, 'binary_recall': 0.5567641, 'binary_specificity': 0.98147494, 'binary_f1_score': 0.5328562}
confusion matrix:
       0    1
0  41537  784
1    652  819
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.74921674, 'recall': 0.75481975, 'specificity': 0.75481975, 'f1': 0.7519835, 'auroc': 0.94864, 'binary_precision': 0.5151976, 'binary_recall': 0.5272162, 'binary_specificity': 0.98242325, 'binary_f1_score': 0.52113765}
confusion matrix:
       0    1
0  17830  319
1    304  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97619045, 'precision': 0.9446932, 'recall': 0.7365474, 'specificity': 0.7365474, 'f1': 0.80619514, 'auroc': 0.92835945, 'binary_precision': 0.9117647, 'binary_recall': 0.47509578, 'binary_specificity': 0.997999, 'binary_f1_score': 0.6246851}
confusion matrix:
      0    1
0  5985   12
1   137  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_12.png
early stop counter: 2
val acc:0.9668475985527039, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9757111072540283 / 0.976190447807312
after epoch: 12,now: 2024-06-04 23:13:56.268577,epoch time: 0:20:49.411529,used: 4:10:45.657442,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96876144, 'precision': 0.7585105, 'recall': 0.7976134, 'specificity': 0.7976134, 'f1': 0.7765313, 'auroc': 0.94997716, 'binary_precision': 0.53051645, 'binary_recall': 0.61413044, 'binary_specificity': 0.9810964, 'binary_f1_score': 0.56926954}
confusion matrix:
       0    1
0  41520  800
1    568  904
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.74672294, 'recall': 0.7853516, 'specificity': 0.7853516, 'f1': 0.7644676, 'auroc': 0.9513587, 'binary_precision': 0.5080214, 'binary_recall': 0.59097975, 'binary_specificity': 0.9797234, 'binary_f1_score': 0.54636955}
confusion matrix:
       0    1
0  17781  368
1    263  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97730905, 'precision': 0.9392699, 'recall': 0.75545436, 'specificity': 0.75545436, 'f1': 0.8209644, 'auroc': 0.9297061, 'binary_precision': 0.8993289, 'binary_recall': 0.51341, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.65365857}
confusion matrix:
      0    1
0  5982   15
1   127  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_13.png
new oracle model saved
early stop counter: 3
val acc:0.966421902179718, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9757111072540283 / 0.9773090481758118
after epoch: 13,now: 2024-06-04 23:34:28.302918,epoch time: 0:20:32.034341,used: 4:31:17.691783,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9689898, 'precision': 0.7600157, 'recall': 0.7946478, 'specificity': 0.7946478, 'f1': 0.77612895, 'auroc': 0.952579, 'binary_precision': 0.53373134, 'binary_recall': 0.6077498, 'binary_specificity': 0.9815458, 'binary_f1_score': 0.5683407}
confusion matrix:
       0    1
0  41540  781
1    577  894
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.74876887, 'recall': 0.7847668, 'specificity': 0.7847668, 'f1': 0.7654096, 'auroc': 0.9523194, 'binary_precision': 0.51216215, 'binary_recall': 0.58942455, 'binary_specificity': 0.9801091, 'binary_f1_score': 0.5480839}
confusion matrix:
       0    1
0  17788  361
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97746885, 'precision': 0.93222904, 'recall': 0.7628671, 'specificity': 0.7628671, 'f1': 0.8251083, 'auroc': 0.9281421, 'binary_precision': 0.88461536, 'binary_recall': 0.52873564, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.6618705}
confusion matrix:
      0    1
0  5979   18
1   123  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_14.png
new oracle model saved
early stop counter: 4
val acc:0.966741144657135, best validation acc: 0.9672200679779053, corresponding to test acc:                         0.9757111072540283 / 0.9774688482284546
after epoch: 14,now: 2024-06-04 23:55:12.595307,epoch time: 0:20:44.292389,used: 4:52:01.984172,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96864724, 'precision': 0.7578373, 'recall': 0.7916529, 'specificity': 0.7916529, 'f1': 0.77358687, 'auroc': 0.9561106, 'binary_precision': 0.52958757, 'binary_recall': 0.6019022, 'binary_specificity': 0.9814036, 'binary_f1_score': 0.563434}
confusion matrix:
       0    1
0  41533  787
1    586  886
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.7533747, 'recall': 0.77987456, 'specificity': 0.77987456, 'f1': 0.76588976, 'auroc': 0.9529352, 'binary_precision': 0.5217391, 'binary_recall': 0.5785381, 'binary_specificity': 0.98121107, 'binary_f1_score': 0.5486726}
confusion matrix:
       0    1
0  17808  341
1    271  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97762865, 'precision': 0.94815123, 'recall': 0.75378877, 'specificity': 0.75378877, 'f1': 0.82180583, 'auroc': 0.93319905, 'binary_precision': 0.9172414, 'binary_recall': 0.5095785, 'binary_specificity': 0.997999, 'binary_f1_score': 0.6551724}
confusion matrix:
      0    1
0  5985   12
1   128  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_15.png
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-06-05 00:15:53.796414,epoch time: 0:20:41.201107,used: 5:12:43.185279,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96981186, 'precision': 0.7654518, 'recall': 0.80117804, 'specificity': 0.80117804, 'f1': 0.7820637, 'auroc': 0.95374215, 'binary_precision': 0.54415274, 'binary_recall': 0.6204082, 'binary_specificity': 0.9819479, 'binary_f1_score': 0.57978386}
confusion matrix:
       0    1
0  41558  764
1    558  912
---- Validation: 
scalar performance:
{'acc': 0.96812475, 'precision': 0.7584614, 'recall': 0.7712321, 'specificity': 0.7712321, 'f1': 0.7646754, 'auroc': 0.9527824, 'binary_precision': 0.5325444, 'binary_recall': 0.5598756, 'binary_specificity': 0.9825886, 'binary_f1_score': 0.5458681}
confusion matrix:
       0    1
0  17833  316
1    283  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97635025, 'precision': 0.9422062, 'recall': 0.7402954, 'specificity': 0.7402954, 'f1': 0.80889237, 'auroc': 0.9365462, 'binary_precision': 0.9064748, 'binary_recall': 0.4827586, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.63}
confusion matrix:
      0    1
0  5984   13
1   135  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_16.png
better model found
persisted
after epoch: 16,now: 2024-06-05 00:36:12.209630,epoch time: 0:20:18.413216,used: 5:33:01.598495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96846455, 'precision': 0.7561927, 'recall': 0.8186548, 'specificity': 0.8186548, 'f1': 0.78363574, 'auroc': 0.95513403, 'binary_precision': 0.52437705, 'binary_recall': 0.6580557, 'binary_specificity': 0.97925377, 'binary_f1_score': 0.58365995}
confusion matrix:
       0    1
0  41443  878
1    503  968
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.74996555, 'recall': 0.79835045, 'specificity': 0.79835045, 'f1': 0.77176845, 'auroc': 0.95361906, 'binary_precision': 0.5135834, 'binary_recall': 0.61741835, 'binary_specificity': 0.9792826, 'binary_f1_score': 0.56073445}
confusion matrix:
       0    1
0  17773  376
1    246  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9784276, 'precision': 0.94463396, 'recall': 0.767032, 'specificity': 0.767032, 'f1': 0.8317714, 'auroc': 0.92386425, 'binary_precision': 0.90909094, 'binary_recall': 0.5363985, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.6746988}
confusion matrix:
      0    1
0  5983   14
1   121  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_17.png
new oracle model saved
early stop counter: 1
val acc:0.9669008255004883, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.9763502478599548 / 0.9784275889396667
after epoch: 17,now: 2024-06-05 00:56:43.857840,epoch time: 0:20:31.648210,used: 5:53:33.246705,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96960634, 'precision': 0.764693, 'recall': 0.7914934, 'specificity': 0.7914934, 'f1': 0.7773762, 'auroc': 0.95746726, 'binary_precision': 0.54333127, 'binary_recall': 0.6005435, 'binary_specificity': 0.9824433, 'binary_f1_score': 0.57050663}
confusion matrix:
       0    1
0  41577  743
1    588  884
---- Validation: 
scalar performance:
{'acc': 0.96934867, 'precision': 0.76730806, 'recall': 0.7801163, 'specificity': 0.7801163, 'f1': 0.7735458, 'auroc': 0.9547237, 'binary_precision': 0.5496296, 'binary_recall': 0.5769829, 'binary_specificity': 0.9832498, 'binary_f1_score': 0.5629742}
confusion matrix:
       0    1
0  17845  304
1    272  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9755513, 'precision': 0.9264598, 'recall': 0.73987854, 'specificity': 0.73987854, 'f1': 0.80479455, 'auroc': 0.93401283, 'binary_precision': 0.875, 'binary_recall': 0.4827586, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.62222224}
confusion matrix:
      0    1
0  5979   18
1   135  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_18.png
better model found
persisted
after epoch: 18,now: 2024-06-05 01:17:12.619937,epoch time: 0:20:28.762097,used: 6:14:02.008802,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.969378, 'precision': 0.76254606, 'recall': 0.8007543, 'specificity': 0.8007543, 'f1': 0.7802091, 'auroc': 0.9579851, 'binary_precision': 0.5383707, 'binary_recall': 0.6199864, 'binary_specificity': 0.9815222, 'binary_f1_score': 0.5763033}
confusion matrix:
       0    1
0  41539  782
1    559  912
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.753683, 'recall': 0.7941532, 'specificity': 0.7941532, 'f1': 0.77224785, 'auroc': 0.95666564, 'binary_precision': 0.52133334, 'binary_recall': 0.60808706, 'binary_specificity': 0.9802193, 'binary_f1_score': 0.5613783}
confusion matrix:
       0    1
0  17790  359
1    252  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9785874, 'precision': 0.9329872, 'recall': 0.7781094, 'specificity': 0.7781094, 'f1': 0.8371812, 'auroc': 0.9418279, 'binary_precision': 0.8848485, 'binary_recall': 0.55938697, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.685446}
confusion matrix:
      0    1
0  5978   19
1   115  146
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_19.png
new oracle model saved
early stop counter: 1
val acc:0.9674861431121826, best validation acc: 0.969348669052124, corresponding to test acc:                         0.9755513072013855 / 0.9785873889923096
after epoch: 19,now: 2024-06-05 01:37:54.700634,epoch time: 0:20:42.080697,used: 6:34:44.089499,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9713418, 'precision': 0.7763078, 'recall': 0.81075144, 'specificity': 0.81075144, 'f1': 0.79240996, 'auroc': 0.95983934, 'binary_precision': 0.56524354, 'binary_recall': 0.63858694, 'binary_specificity': 0.9829159, 'binary_f1_score': 0.599681}
confusion matrix:
       0    1
0  41597  723
1    532  940
---- Validation: 
scalar performance:
{'acc': 0.96945506, 'precision': 0.7677908, 'recall': 0.78542185, 'specificity': 0.78542185, 'f1': 0.7762941, 'auroc': 0.95823246, 'binary_precision': 0.55021834, 'binary_recall': 0.58786935, 'binary_specificity': 0.9829743, 'binary_f1_score': 0.568421}
confusion matrix:
       0    1
0  17840  309
1    265  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97810805, 'precision': 0.9492303, 'recall': 0.7595359, 'specificity': 0.7595359, 'f1': 0.8268604, 'auroc': 0.932058, 'binary_precision': 0.9189189, 'binary_recall': 0.5210728, 'binary_specificity': 0.997999, 'binary_f1_score': 0.6650367}
confusion matrix:
      0    1
0  5985   12
1   125  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_20.png
better model found
persisted
after epoch: 20,now: 2024-06-05 01:58:26.299101,epoch time: 0:20:31.598467,used: 6:55:15.687966,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.969652, 'precision': 0.76328075, 'recall': 0.8329426, 'specificity': 0.8329426, 'f1': 0.7935755, 'auroc': 0.96079624, 'binary_precision': 0.5375599, 'binary_recall': 0.6863946, 'binary_specificity': 0.9794906, 'binary_f1_score': 0.602928}
confusion matrix:
       0     1
0  41454   868
1    461  1009
---- Validation: 
scalar performance:
{'acc': 0.9680715, 'precision': 0.75733566, 'recall': 0.8117075, 'specificity': 0.8117075, 'f1': 0.7816186, 'auroc': 0.9591063, 'binary_precision': 0.5273885, 'binary_recall': 0.64385694, 'binary_specificity': 0.9795581, 'binary_f1_score': 0.5798319}
confusion matrix:
       0    1
0  17778  371
1    229  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97810805, 'precision': 0.92299026, 'recall': 0.7796916, 'specificity': 0.7796916, 'f1': 0.83539915, 'auroc': 0.93508947, 'binary_precision': 0.86470586, 'binary_recall': 0.5632184, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.68213457}
confusion matrix:
      0    1
0  5974   23
1   114  147
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_21.png
early stop counter: 1
val acc:0.9680715203285217, best validation acc: 0.9694550633430481, corresponding to test acc:                         0.9781080484390259 / 0.9785873889923096
after epoch: 21,now: 2024-06-05 02:19:02.409201,epoch time: 0:20:36.110100,used: 7:15:51.798066,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96951497, 'precision': 0.7634021, 'recall': 0.8075112, 'specificity': 0.8075112, 'f1': 0.783561, 'auroc': 0.96258295, 'binary_precision': 0.53961825, 'binary_recall': 0.6338315, 'binary_specificity': 0.9811909, 'binary_f1_score': 0.5829428}
confusion matrix:
       0    1
0  41524  796
1    539  933
---- Validation: 
scalar performance:
{'acc': 0.9688165, 'precision': 0.7626811, 'recall': 0.7948419, 'specificity': 0.7948419, 'f1': 0.7777284, 'auroc': 0.9587568, 'binary_precision': 0.53931034, 'binary_recall': 0.60808706, 'binary_specificity': 0.98159677, 'binary_f1_score': 0.57163745}
confusion matrix:
       0    1
0  17815  334
1    252  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97698945, 'precision': 0.94383407, 'recall': 0.74795824, 'specificity': 0.74795824, 'f1': 0.8158377, 'auroc': 0.932268, 'binary_precision': 0.90909094, 'binary_recall': 0.49808428, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.6435644}
confusion matrix:
      0    1
0  5984   13
1   131  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_22.png
early stop counter: 2
val acc:0.9688165187835693, best validation acc: 0.9694550633430481, corresponding to test acc:                         0.9781080484390259 / 0.9785873889923096
after epoch: 22,now: 2024-06-05 02:39:36.563517,epoch time: 0:20:34.154316,used: 7:36:25.952382,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9721182, 'precision': 0.78155345, 'recall': 0.81738245, 'specificity': 0.81738245, 'f1': 0.7982818, 'auroc': 0.9626678, 'binary_precision': 0.57528496, 'binary_recall': 0.65149456, 'binary_specificity': 0.98327035, 'binary_f1_score': 0.61102265}
confusion matrix:
       0    1
0  41612  708
1    513  959
---- Validation: 
scalar performance:
{'acc': 0.9701469, 'precision': 0.7717248, 'recall': 0.8037813, 'specificity': 0.8037813, 'f1': 0.7867609, 'auroc': 0.96045613, 'binary_precision': 0.5567867, 'binary_recall': 0.62519443, 'binary_specificity': 0.9823682, 'binary_f1_score': 0.589011}
confusion matrix:
       0    1
0  17829  320
1    241  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9785874, 'precision': 0.9285908, 'recall': 0.78177404, 'specificity': 0.78177404, 'f1': 0.8386424, 'auroc': 0.94059813, 'binary_precision': 0.87573963, 'binary_recall': 0.5670498, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.6883721}
confusion matrix:
      0    1
0  5976   21
1   113  148
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_23.png
better model found
persisted
after epoch: 23,now: 2024-06-05 03:00:12.390481,epoch time: 0:20:35.826964,used: 7:57:01.779346,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9713646, 'precision': 0.7761501, 'recall': 0.8146975, 'specificity': 0.8146975, 'f1': 0.79403, 'auroc': 0.96513027, 'binary_precision': 0.56465006, 'binary_recall': 0.6467391, 'binary_specificity': 0.98265594, 'binary_f1_score': 0.60291326}
confusion matrix:
       0    1
0  41586  734
1    520  952
---- Validation: 
scalar performance:
{'acc': 0.968923, 'precision': 0.76292133, 'recall': 0.8091481, 'specificity': 0.8091481, 'f1': 0.783952, 'auroc': 0.9606929, 'binary_precision': 0.5387648, 'binary_recall': 0.63763607, 'binary_specificity': 0.9806601, 'binary_f1_score': 0.5840455}
confusion matrix:
       0    1
0  17798  351
1    233  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9782678, 'precision': 0.9276856, 'recall': 0.7779426, 'specificity': 0.7779426, 'f1': 0.83549607, 'auroc': 0.9389252, 'binary_precision': 0.8742515, 'binary_recall': 0.55938697, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.682243}
confusion matrix:
      0    1
0  5976   21
1   115  146
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_24.png
early stop counter: 1
val acc:0.9689229726791382, best validation acc: 0.970146894454956, corresponding to test acc:                         0.9785873889923096 / 0.9785873889923096
after epoch: 24,now: 2024-06-05 03:20:57.477696,epoch time: 0:20:45.087215,used: 8:17:46.866561,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.97305447, 'precision': 0.79262173, 'recall': 0.79262173, 'specificity': 0.79262173, 'f1': 0.79262173, 'auroc': 0.96539927, 'binary_precision': 0.5991848, 'binary_recall': 0.5991848, 'binary_specificity': 0.9860586, 'binary_f1_score': 0.5991848}
confusion matrix:
       0    1
0  41730  590
1    590  882
---- Validation: 
scalar performance:
{'acc': 0.9723819, 'precision': 0.79063684, 'recall': 0.7936876, 'specificity': 0.7936876, 'f1': 0.7921535, 'auroc': 0.9616574, 'binary_precision': 0.5953846, 'binary_recall': 0.60186625, 'binary_specificity': 0.98550886, 'binary_f1_score': 0.5986079}
confusion matrix:
       0    1
0  17886  263
1    256  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9750719, 'precision': 0.9548842, 'recall': 0.7158081, 'specificity': 0.7158081, 'f1': 0.7893833, 'auroc': 0.9369048, 'binary_precision': 0.9338843, 'binary_recall': 0.4329502, 'binary_specificity': 0.998666, 'binary_f1_score': 0.591623}
confusion matrix:
      0    1
0  5989    8
1   148  113
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_25.png
better model found
persisted
after epoch: 25,now: 2024-06-05 03:41:33.484939,epoch time: 0:20:36.007243,used: 8:38:22.873804,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9704969, 'precision': 0.7690562, 'recall': 0.8309694, 'specificity': 0.8309694, 'f1': 0.7964593, 'auroc': 0.9648691, 'binary_precision': 0.54928803, 'binary_recall': 0.6813859, 'binary_specificity': 0.9805529, 'binary_f1_score': 0.6082474}
confusion matrix:
       0     1
0  41497   823
1    469  1003
---- Validation: 
scalar performance:
{'acc': 0.96961474, 'precision': 0.76663333, 'recall': 0.8320079, 'specificity': 0.8320079, 'f1': 0.7953378, 'auroc': 0.96171623, 'binary_precision': 0.5445545, 'binary_recall': 0.6842924, 'binary_specificity': 0.9797234, 'binary_f1_score': 0.60647833}
confusion matrix:
       0    1
0  17781  368
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.978907, 'precision': 0.92532635, 'recall': 0.7892701, 'specificity': 0.7892701, 'f1': 0.8431603, 'auroc': 0.94492006, 'binary_precision': 0.8685714, 'binary_recall': 0.58237547, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.69724774}
confusion matrix:
      0    1
0  5974   23
1   109  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_26.png
new oracle model saved
early stop counter: 1
val acc:0.9696147441864014, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.975071907043457 / 0.9789069890975952
after epoch: 26,now: 2024-06-05 04:01:50.512258,epoch time: 0:20:17.027319,used: 8:58:39.901123,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97122765, 'precision': 0.77389574, 'recall': 0.83233106, 'specificity': 0.83233106, 'f1': 0.79998493, 'auroc': 0.9662664, 'binary_precision': 0.5588889, 'binary_recall': 0.68342394, 'binary_specificity': 0.9812382, 'binary_f1_score': 0.6149144}
confusion matrix:
       0     1
0  41526   794
1    466  1006
---- Validation: 
scalar performance:
{'acc': 0.970679, 'precision': 0.7741937, 'recall': 0.82280815, 'specificity': 0.82280815, 'f1': 0.7962997, 'auroc': 0.9625425, 'binary_precision': 0.56036747, 'binary_recall': 0.66407466, 'binary_specificity': 0.9815417, 'binary_f1_score': 0.6078292}
confusion matrix:
       0    1
0  17814  335
1    216  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97810805, 'precision': 0.920949, 'recall': 0.78152394, 'specificity': 0.78152394, 'f1': 0.8361323, 'auroc': 0.9416416, 'binary_precision': 0.8604651, 'binary_recall': 0.5670498, 'binary_specificity': 0.995998, 'binary_f1_score': 0.68360275}
confusion matrix:
      0    1
0  5973   24
1   113  148
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_27.png
early stop counter: 2
val acc:0.970678985118866, best validation acc: 0.9723818898200989, corresponding to test acc:                         0.975071907043457 / 0.9789069890975952
after epoch: 27,now: 2024-06-05 04:22:16.720767,epoch time: 0:20:26.208509,used: 9:19:06.109632,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9716615, 'precision': 0.77791154, 'recall': 0.819769, 'specificity': 0.819769, 'f1': 0.7972158, 'auroc': 0.96652013, 'binary_precision': 0.5678215, 'binary_recall': 0.6569294, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.6091339}
confusion matrix:
       0    1
0  41584  736
1    505  967
---- Validation: 
scalar performance:
{'acc': 0.97307366, 'precision': 0.7924446, 'recall': 0.81954753, 'specificity': 0.81954753, 'f1': 0.80533254, 'auroc': 0.96351403, 'binary_precision': 0.59716314, 'binary_recall': 0.6547434, 'binary_specificity': 0.98435175, 'binary_f1_score': 0.6246291}
confusion matrix:
       0    1
0  17865  284
1    222  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9790668, 'precision': 0.92782366, 'recall': 0.7893535, 'specificity': 0.7893535, 'f1': 0.84400356, 'auroc': 0.9451675, 'binary_precision': 0.87356323, 'binary_recall': 0.58237547, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.6988506}
confusion matrix:
      0    1
0  5975   22
1   109  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_28.png
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-06-05 04:42:32.110711,epoch time: 0:20:15.389944,used: 9:39:21.499576,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9741049, 'precision': 0.8046318, 'recall': 0.78300154, 'specificity': 0.78300154, 'f1': 0.7933801, 'auroc': 0.9683561, 'binary_precision': 0.6239003, 'binary_recall': 0.578125, 'binary_specificity': 0.9878781, 'binary_f1_score': 0.60014105}
confusion matrix:
       0    1
0  41807  513
1    621  851
---- Validation: 
scalar performance:
{'acc': 0.9761069, 'precision': 0.8307539, 'recall': 0.7843652, 'specificity': 0.7843652, 'f1': 0.80564976, 'auroc': 0.96386623, 'binary_precision': 0.67636365, 'binary_recall': 0.5785381, 'binary_specificity': 0.9901923, 'binary_f1_score': 0.62363786}
confusion matrix:
       0    1
0  17971  178
1    271  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97746885, 'precision': 0.95972574, 'recall': 0.74454373, 'specificity': 0.74454373, 'f1': 0.8166008, 'auroc': 0.9423086, 'binary_precision': 0.9411765, 'binary_recall': 0.49042144, 'binary_specificity': 0.998666, 'binary_f1_score': 0.64483625}
confusion matrix:
      0    1
0  5989    8
1   133  128
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_29.png
better model found
persisted
after epoch: 29,now: 2024-06-05 05:02:44.766530,epoch time: 0:20:12.655819,used: 9:59:34.155395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.97300875, 'precision': 0.7907871, 'recall': 0.80145025, 'specificity': 0.80145025, 'f1': 0.7960129, 'auroc': 0.9687618, 'binary_precision': 0.5948953, 'binary_recall': 0.6175272, 'binary_specificity': 0.9853733, 'binary_f1_score': 0.606}
confusion matrix:
       0    1
0  41701  619
1    563  909
---- Validation: 
scalar performance:
{'acc': 0.9741911, 'precision': 0.8026369, 'recall': 0.8148757, 'specificity': 0.8148757, 'f1': 0.8086226, 'auroc': 0.96572137, 'binary_precision': 0.61791044, 'binary_recall': 0.64385694, 'binary_specificity': 0.98589456, 'binary_f1_score': 0.6306169}
confusion matrix:
       0    1
0  17893  256
1    229  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.978907, 'precision': 0.9407977, 'recall': 0.7764438, 'specificity': 0.7764438, 'f1': 0.83814466, 'auroc': 0.9398273, 'binary_precision': 0.9006211, 'binary_recall': 0.5555556, 'binary_specificity': 0.997332, 'binary_f1_score': 0.6872038}
confusion matrix:
      0    1
0  5981   16
1   116  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_30.png
early stop counter: 1
val acc:0.9741911292076111, best validation acc: 0.9761068820953369, corresponding to test acc:                         0.9774688482284546 / 0.979066789150238
after epoch: 30,now: 2024-06-05 05:23:04.418050,epoch time: 0:20:19.651520,used: 10:19:53.806915,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_04_19_03_10_seed_0_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:19:53.806915 at 2024-06-05 05:23:04.418050
persisted model performance metric: 

scalar performance:
{'acc': 0.97698945, 'precision': 0.9466572, 'recall': 0.74612594, 'specificity': 0.74612594, 'f1': 0.81495196, 'auroc': 0.94215715, 'binary_precision': 0.9148936, 'binary_recall': 0.49425286, 'binary_specificity': 0.997999, 'binary_f1_score': 0.641791}
confusion matrix:
      0    1
0  5985   12
1   132  129
oracle model performance metric: 

scalar performance:
{'acc': 0.9787472, 'precision': 0.9248679, 'recall': 0.7873544, 'specificity': 0.7873544, 'f1': 0.84162194, 'auroc': 0.9476168, 'binary_precision': 0.8678161, 'binary_recall': 0.5785441, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.69425297}
confusion matrix:
      0    1
0  5974   23
1   110  151
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 488219 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool | 398400 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |  89819 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 488219 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool | 398400 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |  89819 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |   1821 MiB |   1401 TiB |   1401 TiB |
|       from large pool | 387840 KiB |   1750 MiB |   1398 TiB |   1398 TiB |
|       from small pool |  88733 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2108 MiB |   2108 MiB |   2108 MiB |      0 B   |
|       from large pool |   1982 MiB |   1982 MiB |   1982 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    849 MiB |    866 MiB | 687699 GiB | 687698 GiB |
|       from large pool |    842 MiB |    863 MiB | 684084 GiB | 684083 GiB |
|       from small pool |      6 MiB |     18 MiB |   3615 GiB |   3615 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6700    |  129134 K  |  129130 K  |
|       from large pool |      87    |     178    |   55523 K  |   55522 K  |
|       from small pool |    3642    |    6612    |   73611 K  |   73607 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6700    |  129134 K  |  129130 K  |
|       from large pool |      87    |     178    |   55523 K  |   55522 K  |
|       from small pool |    3642    |    6612    |   73611 K  |   73607 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      96    |      96    |      96    |       0    |
|       from large pool |      33    |      33    |      33    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    2764    |   53025 K  |   53025 K  |
|       from large pool |      18    |      22    |   19255 K  |   19255 K  |
|       from small pool |      34    |    2746    |   33770 K  |   33770 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |      0 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |      0 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   1401 TiB |   1401 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   1398 TiB |   1398 TiB |
|       from small pool |      0 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1326 MiB |   2108 MiB |   2108 MiB |    782 MiB |
|       from large pool |   1232 MiB |   1982 MiB |   1982 MiB |    750 MiB |
|       from small pool |     94 MiB |    126 MiB |    126 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |    954 MiB | 687700 GiB | 687700 GiB |
|       from large pool | 134912 KiB |    938 MiB | 684084 GiB | 684084 GiB |
|       from small pool |      0 KiB |     26 MiB |   3615 GiB |   3615 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6700    |  129134 K  |  129134 K  |
|       from large pool |       2    |     178    |   55523 K  |   55523 K  |
|       from small pool |       0    |    6612    |   73611 K  |   73611 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6700    |  129134 K  |  129134 K  |
|       from large pool |       2    |     178    |   55523 K  |   55523 K  |
|       from small pool |       0    |    6612    |   73611 K  |   73611 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      70    |      96    |      96    |      26    |
|       from large pool |      23    |      33    |      33    |      10    |
|       from small pool |      47    |      63    |      63    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2764    |   53026 K  |   53026 K  |
|       from large pool |       4    |      25    |   19255 K  |   19255 K  |
|       from small pool |       0    |    2746    |   33771 K  |   33771 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |      0 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1837 MiB |   1408 TiB |   1408 TiB |
|       from large pool |  16640 KiB |   1766 MiB |   1405 TiB |   1405 TiB |
|       from small pool |      0 KiB |    124 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1821 MiB |   1401 TiB |   1401 TiB |
|       from large pool |  16640 KiB |   1750 MiB |   1398 TiB |   1398 TiB |
|       from small pool |      0 KiB |    123 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1326 MiB |   2108 MiB |   2108 MiB |    782 MiB |
|       from large pool |   1232 MiB |   1982 MiB |   1982 MiB |    750 MiB |
|       from small pool |     94 MiB |    126 MiB |    126 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |    954 MiB | 687700 GiB | 687700 GiB |
|       from large pool | 134912 KiB |    938 MiB | 684084 GiB | 684084 GiB |
|       from small pool |      0 KiB |     26 MiB |   3615 GiB |   3615 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6700    |  129134 K  |  129134 K  |
|       from large pool |       2    |     178    |   55523 K  |   55523 K  |
|       from small pool |       0    |    6612    |   73611 K  |   73611 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6700    |  129134 K  |  129134 K  |
|       from large pool |       2    |     178    |   55523 K  |   55523 K  |
|       from small pool |       0    |    6612    |   73611 K  |   73611 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      70    |      96    |      96    |      26    |
|       from large pool |      23    |      33    |      33    |      10    |
|       from small pool |      47    |      63    |      63    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2764    |   53026 K  |   53026 K  |
|       from large pool |       4    |      25    |   19255 K  |   19255 K  |
|       from small pool |       0    |    2746    |   33771 K  |   33771 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_31_54_seed_1_21096311

 Experiment start at: 2024-06-05 05:31:54.164634
before training, model accuracy: 0.09458588808774948
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96700567, 'precision': 0.6980036, 'recall': 0.50496536, 'specificity': 0.50496536, 'f1': 0.50176585, 'auroc': 0.8297969, 'binary_precision': 0.42857143, 'binary_recall': 0.010402219, 'binary_specificity': 0.99952847, 'binary_f1_score': 0.020311441}
confusion matrix:
       0   1
0  42394  20
1   1427  15
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.84926957, 'recall': 0.5161233, 'specificity': 0.5161233, 'f1': 0.52233505, 'auroc': 0.8140422, 'binary_precision': 0.73333335, 'binary_recall': 0.03268945, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.0625889}
confusion matrix:
       0   1
0  18059   8
1    651  22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8016456, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-05 05:52:50.944731,epoch time: 0:20:56.780097,used: 0:20:56.780097,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_31_54_seed_1_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96707404, 'precision': 0.7303258, 'recall': 0.5210784, 'specificity': 0.5210784, 'f1': 0.5317459, 'auroc': 0.893466, 'binary_precision': 0.4921875, 'binary_recall': 0.04368932, 'binary_specificity': 0.9984675, 'binary_f1_score': 0.080254786}
confusion matrix:
       0   1
0  42349  65
1   1379  63
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.7786553, 'recall': 0.5499346, 'specificity': 0.5499346, 'f1': 0.5784565, 'auroc': 0.8944912, 'binary_precision': 0.5897436, 'binary_recall': 0.102526, 'binary_specificity': 0.99734324, 'binary_f1_score': 0.17468354}
confusion matrix:
       0   1
0  18019  48
1    604  69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.97936153, 'recall': 0.50769234, 'specificity': 0.50769234, 'f1': 0.5046148, 'auroc': 0.86154234, 'binary_precision': 1.0, 'binary_recall': 0.015384615, 'binary_specificity': 1.0, 'binary_f1_score': 0.03030303}
confusion matrix:
      0  1
0  5946  0
1   256  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-05 06:12:57.971515,epoch time: 0:20:07.026784,used: 0:41:03.806881,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_31_54_seed_1_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96659523, 'precision': 0.7238794, 'recall': 0.575428, 'specificity': 0.575428, 'f1': 0.6093548, 'auroc': 0.9122515, 'binary_precision': 0.4757895, 'binary_recall': 0.15672676, 'binary_specificity': 0.9941293, 'binary_f1_score': 0.23578508}
confusion matrix:
       0    1
0  42165  249
1   1216  226
---- Validation: 
scalar performance:
{'acc': 0.9653148, 'precision': 0.75215924, 'recall': 0.646551, 'specificity': 0.646551, 'f1': 0.68389344, 'auroc': 0.9157507, 'binary_precision': 0.52987015, 'binary_recall': 0.30312034, 'binary_specificity': 0.9899817, 'binary_f1_score': 0.38563323}
confusion matrix:
       0    1
0  17886  181
1    469  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.9181697, 'recall': 0.54013234, 'specificity': 0.54013234, 'f1': 0.56396675, 'auroc': 0.8834834, 'binary_precision': 0.875, 'binary_recall': 0.08076923, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.14788732}
confusion matrix:
      0   1
0  5943   3
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-05 06:33:01.730857,epoch time: 0:20:03.759342,used: 1:01:07.566223,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_31_54_seed_1_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96650404, 'precision': 0.7264248, 'recall': 0.6031819, 'specificity': 0.6031819, 'f1': 0.6394813, 'auroc': 0.91838515, 'binary_precision': 0.47906977, 'binary_recall': 0.21428572, 'binary_specificity': 0.99207807, 'binary_f1_score': 0.29611883}
confusion matrix:
       0    1
0  42078  336
1   1133  309
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.740682, 'recall': 0.68894124, 'specificity': 0.68894124, 'f1': 0.7113322, 'auroc': 0.9201282, 'binary_precision': 0.5038168, 'binary_recall': 0.3922734, 'binary_specificity': 0.9856091, 'binary_f1_score': 0.44110277}
confusion matrix:
       0    1
0  17807  260
1    409  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.8988037, 'recall': 0.5762504, 'specificity': 0.5762504, 'f1': 0.62045175, 'auroc': 0.8920373, 'binary_precision': 0.8333333, 'binary_recall': 0.15384616, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.2597403}
confusion matrix:
      0   1
0  5938   8
1   220  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_4.png
new oracle model saved
early stop counter: 1
val acc:0.9643009901046753, best validation acc: 0.9653148055076599, corresponding to test acc:                         0.961005449295044 / 0.9632613658905029
after epoch: 4,now: 2024-06-05 06:54:32.348330,epoch time: 0:21:30.617473,used: 1:22:38.183696,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_31_54_seed_1_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96689165, 'precision': 0.7356518, 'recall': 0.6496057, 'specificity': 0.6496057, 'f1': 0.6820325, 'auroc': 0.9287865, 'binary_precision': 0.49446902, 'binary_recall': 0.30998614, 'binary_specificity': 0.98922527, 'binary_f1_score': 0.3810742}
confusion matrix:
       0    1
0  41957  457
1    995  447
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.7386825, 'recall': 0.70951796, 'specificity': 0.70951796, 'f1': 0.723037, 'auroc': 0.9301804, 'binary_precision': 0.49829933, 'binary_recall': 0.43536404, 'binary_specificity': 0.9836719, 'binary_f1_score': 0.46471056}
confusion matrix:
       0    1
0  17772  295
1    380  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692233, 'precision': 0.92484254, 'recall': 0.65292114, 'specificity': 0.65292114, 'f1': 0.7200022, 'auroc': 0.90768844, 'binary_precision': 0.8791209, 'binary_recall': 0.30769232, 'binary_specificity': 0.99815, 'binary_f1_score': 0.45584047}
confusion matrix:
      0   1
0  5935  11
1   180  80
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_5.png
new oracle model saved
early stop counter: 2
val acc:0.9639807939529419, best validation acc: 0.9653148055076599, corresponding to test acc:                         0.961005449295044 / 0.9692233204841614
after epoch: 5,now: 2024-06-05 07:16:21.267560,epoch time: 0:21:48.919230,used: 1:44:27.102926,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_31_54_seed_1_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9665724, 'precision': 0.7344913, 'recall': 0.68829507, 'specificity': 0.68829507, 'f1': 0.7085954, 'auroc': 0.9293723, 'binary_precision': 0.48956522, 'binary_recall': 0.39042994, 'binary_specificity': 0.9861602, 'binary_f1_score': 0.43441358}
confusion matrix:
       0    1
0  41827  587
1    879  563
---- Validation: 
scalar performance:
{'acc': 0.96318036, 'precision': 0.7335847, 'recall': 0.725554, 'specificity': 0.725554, 'f1': 0.72949034, 'auroc': 0.9322686, 'binary_precision': 0.48690292, 'binary_recall': 0.46953937, 'binary_specificity': 0.98156863, 'binary_f1_score': 0.47806355}
confusion matrix:
       0    1
0  17734  333
1    357  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9695456, 'precision': 0.92236006, 'recall': 0.6586063, 'specificity': 0.6586063, 'f1': 0.725965, 'auroc': 0.9042462, 'binary_precision': 0.8736842, 'binary_recall': 0.31923077, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.46760565}
confusion matrix:
      0   1
0  5934  12
1   177  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_6.png
new oracle model saved
early stop counter: 3
val acc:0.9631803631782532, best validation acc: 0.9653148055076599, corresponding to test acc:                         0.961005449295044 / 0.9695456027984619
after epoch: 6,now: 2024-06-05 07:37:32.890122,epoch time: 0:21:11.622562,used: 2:05:38.725488,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_31_54_seed_1_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9673705, 'precision': 0.74280655, 'recall': 0.71684366, 'specificity': 0.71684366, 'f1': 0.72901225, 'auroc': 0.93588996, 'binary_precision': 0.5042868, 'binary_recall': 0.4486824, 'binary_specificity': 0.98500496, 'binary_f1_score': 0.47486243}
confusion matrix:
       0    1
0  41778  636
1    795  647
---- Validation: 
scalar performance:
{'acc': 0.9638207, 'precision': 0.739399, 'recall': 0.75306624, 'specificity': 0.75306624, 'f1': 0.7460191, 'auroc': 0.9338137, 'binary_precision': 0.4964937, 'binary_recall': 0.52600294, 'binary_specificity': 0.98012954, 'binary_f1_score': 0.5108225}
confusion matrix:
       0    1
0  17708  359
1    319  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.973574, 'precision': 0.9253249, 'recall': 0.71403915, 'specificity': 0.71403915, 'f1': 0.7818401, 'auroc': 0.9110341, 'binary_precision': 0.875, 'binary_recall': 0.43076923, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.5773196}
confusion matrix:
      0    1
0  5930   16
1   148  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_7.png
new oracle model saved
early stop counter: 4
val acc:0.9638206958770752, best validation acc: 0.9653148055076599, corresponding to test acc:                         0.961005449295044 / 0.9735739827156067
after epoch: 7,now: 2024-06-05 07:59:33.010491,epoch time: 0:22:00.120369,used: 2:27:38.845857,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_31_54_seed_1_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9674617, 'precision': 0.7438691, 'recall': 0.72995394, 'specificity': 0.72995394, 'f1': 0.7366848, 'auroc': 0.9431528, 'binary_precision': 0.5055269, 'binary_recall': 0.47572815, 'binary_specificity': 0.98417974, 'binary_f1_score': 0.49017504}
confusion matrix:
       0    1
0  41743  671
1    756  686
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.73797655, 'recall': 0.7522403, 'specificity': 0.7522403, 'f1': 0.7448747, 'auroc': 0.93718386, 'binary_precision': 0.4937063, 'binary_recall': 0.52451706, 'binary_specificity': 0.9799635, 'binary_f1_score': 0.50864553}
confusion matrix:
       0    1
0  17705  362
1    320  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9727683, 'precision': 0.95751965, 'recall': 0.6860339, 'specificity': 0.6860339, 'f1': 0.76020455, 'auroc': 0.90886587, 'binary_precision': 0.94174755, 'binary_recall': 0.37307692, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.5344352}
confusion matrix:
      0   1
0  5940   6
1   163  97
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_8.png
early stop counter: 5
val acc:0.9636072516441345, best validation acc: 0.9653148055076599, corresponding to test acc:                         0.961005449295044 / 0.9735739827156067
after epoch: 8,now: 2024-06-05 08:21:52.020569,epoch time: 0:22:19.010078,used: 2:49:57.855935,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_31_54_seed_1_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9675985, 'precision': 0.7451807, 'recall': 0.74074316, 'specificity': 0.74074316, 'f1': 0.7429395, 'auroc': 0.94341564, 'binary_precision': 0.5074205, 'binary_recall': 0.49791956, 'binary_specificity': 0.98356676, 'binary_f1_score': 0.5026251}
confusion matrix:
       0    1
0  41717  697
1    724  718
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.74184334, 'recall': 0.74184334, 'specificity': 0.74184334, 'f1': 0.74184334, 'auroc': 0.9379917, 'binary_precision': 0.5022288, 'binary_recall': 0.5022288, 'binary_specificity': 0.9814579, 'binary_f1_score': 0.5022288}
confusion matrix:
       0    1
0  17732  335
1    335  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97502416, 'precision': 0.9584312, 'recall': 0.714796, 'specificity': 0.714796, 'f1': 0.7890739, 'auroc': 0.9144155, 'binary_precision': 0.9411765, 'binary_recall': 0.43076923, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.591029}
confusion matrix:
      0    1
0  5939    7
1   148  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_9.png
new oracle model saved
early stop counter: 6
val acc:0.9642475843429565, best validation acc: 0.9653148055076599, corresponding to test acc:                         0.961005449295044 / 0.9750241637229919
after epoch: 9,now: 2024-06-05 08:49:12.801908,epoch time: 0:27:20.781339,used: 3:17:18.637274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_31_54_seed_1_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.968237, 'precision': 0.7502836, 'recall': 0.75112176, 'specificity': 0.75112176, 'f1': 0.7507019, 'auroc': 0.9476081, 'binary_precision': 0.5169316, 'binary_recall': 0.51872396, 'binary_specificity': 0.9835196, 'binary_f1_score': 0.51782626}
confusion matrix:
       0    1
0  41715  699
1    694  748
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.7433531, 'recall': 0.7669331, 'specificity': 0.7669331, 'f1': 0.75452983, 'auroc': 0.941481, 'binary_precision': 0.5033738, 'binary_recall': 0.55423474, 'binary_specificity': 0.97963136, 'binary_f1_score': 0.5275813}
confusion matrix:
       0    1
0  17699  368
1    300  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9740574, 'precision': 0.9422201, 'recall': 0.7106135, 'specificity': 0.7106135, 'f1': 0.78202283, 'auroc': 0.93277603, 'binary_precision': 0.90909094, 'binary_recall': 0.42307693, 'binary_specificity': 0.99815, 'binary_f1_score': 0.5774278}
confusion matrix:
      0    1
0  5935   11
1   150  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_10.png
early stop counter: 7
val acc:0.9643543362617493, best validation acc: 0.9653148055076599, corresponding to test acc:                         0.961005449295044 / 0.9750241637229919
after epoch: 10,now: 2024-06-05 09:13:59.225801,epoch time: 0:24:46.423893,used: 3:42:05.061167,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_31_54_seed_1_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9675301, 'precision': 0.7447414, 'recall': 0.7453971, 'specificity': 0.7453971, 'f1': 0.7450688, 'auroc': 0.948126, 'binary_precision': 0.5062241, 'binary_recall': 0.5076283, 'binary_specificity': 0.9831659, 'binary_f1_score': 0.5069253}
confusion matrix:
       0    1
0  41700  714
1    710  732
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.7446953, 'recall': 0.7784604, 'specificity': 0.7784604, 'f1': 0.76035064, 'auroc': 0.9430896, 'binary_precision': 0.5051948, 'binary_recall': 0.5780089, 'binary_specificity': 0.9789118, 'binary_f1_score': 0.5391545}
confusion matrix:
       0    1
0  17686  381
1    284  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9742185, 'precision': 0.949463, 'recall': 0.7088586, 'specificity': 0.7088586, 'f1': 0.78171194, 'auroc': 0.9296368, 'binary_precision': 0.9237288, 'binary_recall': 0.41923076, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.5767196}
confusion matrix:
      0    1
0  5937    9
1   151  109
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_11.png
early stop counter: 8
val acc:0.964514434337616, best validation acc: 0.9653148055076599, corresponding to test acc:                         0.961005449295044 / 0.9750241637229919
after epoch: 11,now: 2024-06-05 09:41:16.691204,epoch time: 0:27:17.465403,used: 4:09:22.526570,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_31_54_seed_1_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9681913, 'precision': 0.7500888, 'recall': 0.78459346, 'specificity': 0.78459346, 'f1': 0.7661022, 'auroc': 0.9489376, 'binary_precision': 0.51425105, 'binary_recall': 0.5880721, 'binary_specificity': 0.98111475, 'binary_f1_score': 0.5486897}
confusion matrix:
       0    1
0  41613  801
1    594  848
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.74934936, 'recall': 0.77598673, 'specificity': 0.77598673, 'f1': 0.7619091, 'auroc': 0.94634753, 'binary_precision': 0.5147059, 'binary_recall': 0.57206535, 'binary_specificity': 0.9799081, 'binary_f1_score': 0.54187196}
confusion matrix:
       0    1
0  17704  363
1    288  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97454077, 'precision': 0.93430394, 'recall': 0.7218997, 'specificity': 0.7218997, 'f1': 0.79086465, 'auroc': 0.92554903, 'binary_precision': 0.8923077, 'binary_recall': 0.44615385, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.5948718}
confusion matrix:
      0    1
0  5932   14
1   144  116
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_12.png
early stop counter: 9
val acc:0.9652614593505859, best validation acc: 0.9653148055076599, corresponding to test acc:                         0.961005449295044 / 0.9750241637229919
after epoch: 12,now: 2024-06-05 10:08:41.462742,epoch time: 0:27:24.771538,used: 4:36:47.298108,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_31_54_seed_1_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96807736, 'precision': 0.74915326, 'recall': 0.76879174, 'specificity': 0.76879174, 'f1': 0.75855863, 'auroc': 0.9511199, 'binary_precision': 0.51346153, 'binary_recall': 0.5554785, 'binary_specificity': 0.98210496, 'binary_f1_score': 0.5336442}
confusion matrix:
       0    1
0  41655  759
1    641  801
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.744062, 'recall': 0.77912027, 'specificity': 0.77912027, 'f1': 0.76026773, 'auroc': 0.9454049, 'binary_precision': 0.503876, 'binary_recall': 0.5794948, 'binary_specificity': 0.97874576, 'binary_f1_score': 0.53904635}
confusion matrix:
       0    1
0  17683  384
1    283  390
---- Test Domain (oracle): 
scalar performance:
--- Logging error ---
Traceback (most recent call last):
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1084, in flush
    self.stream.flush()
OSError: [Errno 122] Disk quota exceeded
Call stack:
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 973, in _bootstrap
    self._bootstrap_inner()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 83, in _worker
    work_item.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 699, in cached_or_run
    run_func(*args)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 2656, in run_wrapper
    run(
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 187, in __rule_run_experiment
    rule all:
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
    exp.execute()
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
    flag_stop = self.trainer.tr_epoch(epoch)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 49, in tr_epoch
    return self.after_epoch(epoch)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 70, in after_epoch
    flag_stop = self.observer.update(epoch)  # Notify observer
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 51, in update
    metric_te = self.host_trainer.model.cal_perf_metric(
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model_classif.py", line 79, in cal_perf_metric
    logger.info(str(metric))
Message: "{'acc': 0.97437966, 'precision': 0.93991315, 'recall': 0.7162986, 'specificity': 0.7162986, 'f1': 0.78689635, 'auroc': 0.9320228, 'binary_precision': 0.904, 'binary_recall': 0.43461537, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.58701295}"
Arguments: ()
{'acc': 0.97437966, 'precision': 0.93991315, 'recall': 0.7162986, 'specificity': 0.7162986, 'f1': 0.78689635, 'auroc': 0.9320228, 'binary_precision': 0.904, 'binary_recall': 0.43461537, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.58701295}
--- Logging error ---
Traceback (most recent call last):
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1084, in flush
    self.stream.flush()
OSError: [Errno 122] Disk quota exceeded
Call stack:
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 973, in _bootstrap
    self._bootstrap_inner()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 83, in _worker
    work_item.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 699, in cached_or_run
    run_func(*args)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 2656, in run_wrapper
    run(
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 187, in __rule_run_experiment
    rule all:
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
    exp.execute()
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
    flag_stop = self.trainer.tr_epoch(epoch)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 49, in tr_epoch
    return self.after_epoch(epoch)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 70, in after_epoch
    flag_stop = self.observer.update(epoch)  # Notify observer
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 51, in update
    metric_te = self.host_trainer.model.cal_perf_metric(
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model_classif.py", line 80, in cal_perf_metric
    logger.info("confusion matrix:")
Message: 'confusion matrix:'
Arguments: ()
confusion matrix:
--- Logging error ---
Traceback (most recent call last):
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1084, in flush
    self.stream.flush()
OSError: [Errno 122] Disk quota exceeded
Call stack:
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 973, in _bootstrap
    self._bootstrap_inner()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 83, in _worker
    work_item.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 699, in cached_or_run
    run_func(*args)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 2656, in run_wrapper
    run(
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 187, in __rule_run_experiment
    rule all:
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
    exp.execute()
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
    flag_stop = self.trainer.tr_epoch(epoch)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 49, in tr_epoch
    return self.after_epoch(epoch)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 70, in after_epoch
    flag_stop = self.observer.update(epoch)  # Notify observer
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 51, in update
    metric_te = self.host_trainer.model.cal_perf_metric(
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model_classif.py", line 81, in cal_perf_metric
    logger.info(pd.DataFrame(confmat))
Message:       0    1
0  5934   12
1   147  113
Arguments: ()
      0    1
0  5934   12
1   147  113
--- Logging error ---
Traceback (most recent call last):
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1084, in flush
    self.stream.flush()
OSError: [Errno 122] Disk quota exceeded
Call stack:
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 973, in _bootstrap
    self._bootstrap_inner()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 83, in _worker
    work_item.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 699, in cached_or_run
    run_func(*args)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 2656, in run_wrapper
    run(
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 187, in __rule_run_experiment
    rule all:
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
    exp.execute()
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
    flag_stop = self.trainer.tr_epoch(epoch)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 49, in tr_epoch
    return self.after_epoch(epoch)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 70, in after_epoch
    flag_stop = self.observer.update(epoch)  # Notify observer
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 58, in update
    self.plot_tsne(features, labels, epoch, dset_type='Test')
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 219, in plot_tsne
    logger.info(f"t-SNE plot saved as {plot_filename}")
Message: 't-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_13.png'
Arguments: ()
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_13.png
--- Logging error ---
Traceback (most recent call last):
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1084, in flush
    self.stream.flush()
OSError: [Errno 122] Disk quota exceeded
Call stack:
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 973, in _bootstrap
    self._bootstrap_inner()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 83, in _worker
    work_item.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 699, in cached_or_run
    run_func(*args)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 2656, in run_wrapper
    run(
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 187, in __rule_run_experiment
    rule all:
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
    exp.execute()
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
    flag_stop = self.trainer.tr_epoch(epoch)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 49, in tr_epoch
    return self.after_epoch(epoch)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 70, in after_epoch
    flag_stop = self.observer.update(epoch)  # Notify observer
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 60, in update
    if self.model_sel.update(epoch):
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/a_model_sel.py", line 63, in update
    update = self.base_update(clear_counter)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/c_msel_oracle.py", line 52, in base_update
    return self.msel.base_update(clear_counter)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/c_msel_val.py", line 66, in base_update
    logger.info(f"early stop counter: {self.es_c}")
Message: 'early stop counter: 10'
Arguments: ()
early stop counter: 10
--- Logging error ---
Traceback (most recent call last):
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1084, in flush
    self.stream.flush()
OSError: [Errno 122] Disk quota exceeded
Call stack:
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 973, in _bootstrap
    self._bootstrap_inner()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 83, in _worker
    work_item.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 699, in cached_or_run
    run_func(*args)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 2656, in run_wrapper
    run(
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 187, in __rule_run_experiment
    rule all:
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
    exp.execute()
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
    flag_stop = self.trainer.tr_epoch(epoch)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 49, in tr_epoch
    return self.after_epoch(epoch)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 70, in after_epoch
    flag_stop = self.observer.update(epoch)  # Notify observer
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 60, in update
    if self.model_sel.update(epoch):
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/a_model_sel.py", line 63, in update
    update = self.base_update(clear_counter)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/c_msel_oracle.py", line 52, in base_update
    return self.msel.base_update(clear_counter)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/c_msel_val.py", line 67, in base_update
    logger.info(
Message: 'val acc:0.9644076824188232, best validation acc: 0.9653148055076599, corresponding to test acc:                         0.961005449295044 / 0.9750241637229919'
Arguments: ()
val acc:0.9644076824188232, best validation acc: 0.9653148055076599, corresponding to test acc:                         0.961005449295044 / 0.9750241637229919
--- Logging error ---
Traceback (most recent call last):
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1084, in flush
    self.stream.flush()
OSError: [Errno 122] Disk quota exceeded
Call stack:
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 973, in _bootstrap
    self._bootstrap_inner()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 83, in _worker
    work_item.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 699, in cached_or_run
    run_func(*args)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 2656, in run_wrapper
    run(
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 187, in __rule_run_experiment
    rule all:
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
    exp.execute()
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 79, in execute
    logger.info(
Message: 'after epoch: 13,now: 2024-06-05 10:35:54.828017,epoch time: 0:27:13.365275,used: 5:04:00.663383,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_31_54_seed_1_21096311'
Arguments: ()
after epoch: 13,now: 2024-06-05 10:35:54.828017,epoch time: 0:27:13.365275,used: 5:04:00.663383,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_31_54_seed_1_21096311
--- Logging error ---
Traceback (most recent call last):
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1084, in flush
    self.stream.flush()
OSError: [Errno 122] Disk quota exceeded
Call stack:
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 973, in _bootstrap
    self._bootstrap_inner()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 83, in _worker
    work_item.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 699, in cached_or_run
    run_func(*args)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 2656, in run_wrapper
    run(
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 187, in __rule_run_experiment
    rule all:
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
    exp.execute()
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 86, in execute
    logger.info(f"working direcotry: {self.curr_dir}")
Message: 'working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab'
Arguments: ()
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
--- Logging error ---
Traceback (most recent call last):
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1084, in flush
    self.stream.flush()
OSError: [Errno 122] Disk quota exceeded
Call stack:
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 973, in _bootstrap
    self._bootstrap_inner()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 83, in _worker
    work_item.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 699, in cached_or_run
    run_func(*args)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 2656, in run_wrapper
    run(
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 187, in __rule_run_experiment
    rule all:
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
    exp.execute()
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
    flag_stop = self.trainer.tr_epoch(epoch)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 49, in tr_epoch
    return self.after_epoch(epoch)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 70, in after_epoch
    flag_stop = self.observer.update(epoch)  # Notify observer
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 39, in update
    logger.info(f"epoch: {epoch}")
Message: 'epoch: 14'
Arguments: ()
epoch: 14
--- Logging error ---
Traceback (most recent call last):
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1084, in flush
    self.stream.flush()
OSError: [Errno 122] Disk quota exceeded
Call stack:
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 973, in _bootstrap
    self._bootstrap_inner()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 83, in _worker
    work_item.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 699, in cached_or_run
    run_func(*args)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 2656, in run_wrapper
    run(
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 187, in __rule_run_experiment
    rule all:
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
    exp.execute()
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
    flag_stop = self.trainer.tr_epoch(epoch)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 49, in tr_epoch
    return self.after_epoch(epoch)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 70, in after_epoch
    flag_stop = self.observer.update(epoch)  # Notify observer
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 42, in update
    logger.info("---- Training Domain: ")
Message: '---- Training Domain: '
Arguments: ()
---- Training Domain: 
--- Logging error ---
Traceback (most recent call last):
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1104, in emit
    self.flush()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/logging/__init__.py", line 1084, in flush
    self.stream.flush()
OSError: [Errno 122] Disk quota exceeded
Call stack:
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 973, in _bootstrap
    self._bootstrap_inner()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 83, in _worker
    work_item.run()
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 699, in cached_or_run
    run_func(*args)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/snakemake/executors/__init__.py", line 2656, in run_wrapper
    run(
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 187, in __rule_run_experiment
    rule all:
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
    exp.execute()
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
    flag_stop = self.trainer.tr_epoch(epoch)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 49, in tr_epoch
    return self.after_epoch(epoch)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 70, in after_epoch
    flag_stop = self.observer.update(epoch)  # Notify observer
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 43, in update
    self.host_trainer.model.cal_perf_metric(self.loader_tr, self.device)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model_classif.py", line 78, in cal_perf_metric
    logger.info("scalar performance:")
Message: 'scalar performance:'
Arguments: ()
scalar performance:
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-06-05 11:02:31.305101,epoch time: 0:26:36.477084,used: 5:30:37.140467,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_05_31_54_seed_1_21096311
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.969035, 'precision': 0.75598294, 'recall': 0.78603446, 'specificity': 0.78603446, 'f1': 0.77008355, 'auroc': 0.9527342, 'binary_precision': 0.525958, 'binary_recall': 0.59015256, 'binary_specificity': 0.98191637, 'binary_f1_score': 0.55620915}
confusion matrix:
       0    1
0  41647  767
1    591  851
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.7458814, 'recall': 0.7864113, 'specificity': 0.7864113, 'f1': 0.764408, 'auroc': 0.949315, 'binary_precision': 0.5069708, 'binary_recall': 0.5943536, 'binary_specificity': 0.978469, 'binary_f1_score': 0.54719555}
confusion matrix:
       0    1
0  17678  389
1    273  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97599095, 'precision': 0.96750647, 'recall': 0.7226565, 'specificity': 0.7226565, 'f1': 0.7982696, 'auroc': 0.93268, 'binary_precision': 0.9586777, 'binary_recall': 0.44615385, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.6089239}
confusion matrix:
      0    1
0  5941    5
1   144  116
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21096311_15.png
[Wed Jun  5 11:29:10 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/8.csv

RuleException:
RuntimeError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[enforce fail at inline_container.cc:595] . unexpected pos 55622784 vs 55622616
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 49, in tr_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 70, in after_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 60, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/a_model_sel.py", line 63, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/c_msel_oracle.py", line 37, in base_update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model.py", line 159, in save
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_utils.py", line 88, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 627, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 475, in __exit__
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
