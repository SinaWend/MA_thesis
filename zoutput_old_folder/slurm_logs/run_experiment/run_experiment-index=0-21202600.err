Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jun  7 20:17:28 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600

 Experiment start at: 2024-06-07 20:24:52.444221
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96741414, 'precision': 0.74939597, 'recall': 0.7051158, 'specificity': 0.7051158, 'f1': 0.7248679, 'auroc': 0.9468424, 'binary_precision': 0.5187032, 'binary_recall': 0.42391303, 'binary_specificity': 0.9863185, 'binary_f1_score': 0.46654204}
confusion matrix:
       0    1
0  41741  579
1    848  624
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.74492854, 'recall': 0.69531745, 'specificity': 0.69531745, 'f1': 0.71702075, 'auroc': 0.9521647, 'binary_precision': 0.5108055, 'binary_recall': 0.4043546, 'binary_specificity': 0.98628026, 'binary_f1_score': 0.4513889}
confusion matrix:
       0    1
0  17900  249
1    383  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.9024307, 'recall': 0.5702976, 'specificity': 0.5702976, 'f1': 0.61185277, 'auroc': 0.9220544, 'binary_precision': 0.84090906, 'binary_recall': 0.14176245, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.24262294}
confusion matrix:
      0   1
0  5990   7
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-07 20:41:44.573314,epoch time: 0:16:52.129093,used: 0:16:52.129093,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.94302356, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.9469934, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.91288114, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9663686752319336, corresponding to test acc:                         0.963087260723114 / 0.963087260723114
after epoch: 2,now: 2024-06-07 20:57:41.286792,epoch time: 0:15:56.713478,used: 0:32:48.842571,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9691725, 'precision': 0.761554, 'recall': 0.79126894, 'specificity': 0.79126894, 'f1': 0.77552366, 'auroc': 0.9598294, 'binary_precision': 0.53705955, 'binary_recall': 0.6005435, 'binary_specificity': 0.98199433, 'binary_f1_score': 0.56703013}
confusion matrix:
       0    1
0  41558  762
1    588  884
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.7653893, 'recall': 0.6978644, 'specificity': 0.6978644, 'f1': 0.7262025, 'auroc': 0.956004, 'binary_precision': 0.55157894, 'binary_recall': 0.407465, 'binary_specificity': 0.98826385, 'binary_f1_score': 0.4686941}
confusion matrix:
       0    1
0  17936  213
1    381  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97379357, 'precision': 0.955698, 'recall': 0.6986501, 'specificity': 0.6986501, 'f1': 0.7728176, 'auroc': 0.94081986, 'binary_precision': 0.9369369, 'binary_recall': 0.39846742, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.5591398}
confusion matrix:
      0    1
0  5990    7
1   157  104
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-07 21:13:40.307722,epoch time: 0:15:59.020930,used: 0:48:47.863501,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9691725, 'precision': 0.8612225, 'recall': 0.56111175, 'specificity': 0.56111175, 'f1': 0.5983237, 'auroc': 0.9642221, 'binary_precision': 0.75206614, 'binary_recall': 0.123641305, 'binary_specificity': 0.99858224, 'binary_f1_score': 0.21236873}
confusion matrix:
       0    1
0  42260   60
1   1290  182
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.88757604, 'recall': 0.5354668, 'specificity': 0.5354668, 'f1': 0.5574722, 'auroc': 0.9623321, 'binary_precision': 0.80701756, 'binary_recall': 0.071539655, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.13142857}
confusion matrix:
       0   1
0  18138  11
1    597  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292199, 'recall': 0.5018323, 'specificity': 0.5018323, 'f1': 0.49315178, 'auroc': 0.9465691, 'binary_precision': 0.5, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.007604562}
confusion matrix:
      0  1
0  5996  1
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_4.png
early stop counter: 1
val acc:0.9676458239555359, best validation acc: 0.9683908224105835, corresponding to test acc:                         0.9737935662269592 / 0.9737935662269592
after epoch: 4,now: 2024-06-07 21:29:44.563249,epoch time: 0:16:04.255527,used: 1:04:52.119028,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9732371, 'precision': 0.78819245, 'recall': 0.83402646, 'specificity': 0.83402646, 'f1': 0.80924225, 'auroc': 0.9699024, 'binary_precision': 0.5874126, 'binary_recall': 0.6847826, 'binary_specificity': 0.98327035, 'binary_f1_score': 0.63237137}
confusion matrix:
       0     1
0  41612   708
1    464  1008
---- Validation: 
scalar performance:
{'acc': 0.9713176, 'precision': 0.77972, 'recall': 0.8118879, 'specificity': 0.8118879, 'f1': 0.79483396, 'auroc': 0.96889174, 'binary_precision': 0.57222223, 'binary_recall': 0.6407465, 'binary_specificity': 0.98302937, 'binary_f1_score': 0.6045488}
confusion matrix:
       0    1
0  17841  308
1    231  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.978907, 'precision': 0.9384188, 'recall': 0.7782761, 'specificity': 0.7782761, 'f1': 0.8388815, 'auroc': 0.95241934, 'binary_precision': 0.8957055, 'binary_recall': 0.55938697, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.6886793}
confusion matrix:
      0    1
0  5980   17
1   115  146
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-07 21:45:42.911984,epoch time: 0:15:58.348735,used: 1:20:50.467763,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97634274, 'precision': 0.82005274, 'recall': 0.8103881, 'specificity': 0.8103881, 'f1': 0.8151393, 'auroc': 0.97164834, 'binary_precision': 0.6528752, 'binary_recall': 0.6324728, 'binary_specificity': 0.9883034, 'binary_f1_score': 0.6425121}
confusion matrix:
       0    1
0  41825  495
1    541  931
---- Validation: 
scalar performance:
{'acc': 0.9765326, 'precision': 0.85172594, 'recall': 0.7530833, 'specificity': 0.7530833, 'f1': 0.79368365, 'auroc': 0.9695592, 'binary_precision': 0.720524, 'binary_recall': 0.5132193, 'binary_specificity': 0.9929473, 'binary_f1_score': 0.59945506}
confusion matrix:
       0    1
0  18021  128
1    313  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.84999824, 'recall': 0.53206676, 'specificity': 0.53206676, 'f1': 0.54964006, 'auroc': 0.9391436, 'binary_precision': 0.73913044, 'binary_recall': 0.0651341, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.11971831}
confusion matrix:
      0   1
0  5991   6
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_6.png
better model found
persisted
after epoch: 6,now: 2024-06-07 22:01:37.752818,epoch time: 0:15:54.840834,used: 1:36:45.308597,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9779183, 'precision': 0.92247, 'recall': 0.7018244, 'specificity': 0.7018244, 'f1': 0.7706009, 'auroc': 0.9729515, 'binary_precision': 0.8652174, 'binary_recall': 0.40584636, 'binary_specificity': 0.9978025, 'binary_f1_score': 0.55252194}
confusion matrix:
       0    1
0  42228   93
1    874  597
---- Validation: 
scalar performance:
{'acc': 0.9741911, 'precision': 0.9591509, 'recall': 0.63036215, 'specificity': 0.63036215, 'f1': 0.6980322, 'auroc': 0.9688649, 'binary_precision': 0.94382024, 'binary_recall': 0.26127526, 'binary_specificity': 0.999449, 'binary_f1_score': 0.40925696}
confusion matrix:
       0    1
0  18139   10
1    475  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.9796065, 'recall': 0.5114943, 'specificity': 0.5114943, 'f1': 0.5120629, 'auroc': 0.9661897, 'binary_precision': 1.0, 'binary_recall': 0.022988506, 'binary_specificity': 1.0, 'binary_f1_score': 0.044943817}
confusion matrix:
      0  1
0  5997  0
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_7.png
early stop counter: 1
val acc:0.9741911292076111, best validation acc: 0.9765325784683228, corresponding to test acc:                         0.9600511193275452 / 0.9789069890975952
after epoch: 7,now: 2024-06-07 22:18:12.496494,epoch time: 0:16:34.743676,used: 1:53:20.052273,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9761372, 'precision': 0.8171543, 'recall': 0.8127817, 'specificity': 0.8127817, 'f1': 0.81495136, 'auroc': 0.97073156, 'binary_precision': 0.64689654, 'binary_recall': 0.63766146, 'binary_specificity': 0.987902, 'binary_f1_score': 0.64224577}
confusion matrix:
       0    1
0  41809  512
1    533  938
---- Validation: 
scalar performance:
{'acc': 0.97498935, 'precision': 0.8323449, 'recall': 0.747784, 'specificity': 0.747784, 'f1': 0.7833589, 'auroc': 0.96955675, 'binary_precision': 0.68210524, 'binary_recall': 0.503888, 'binary_specificity': 0.99167997, 'binary_f1_score': 0.5796064}
confusion matrix:
       0    1
0  17998  151
1    319  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.79056716, 'recall': 0.6322634, 'specificity': 0.6322634, 'f1': 0.67864937, 'auroc': 0.9504712, 'binary_precision': 0.61206895, 'binary_recall': 0.27203065, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.37665784}
confusion matrix:
      0   1
0  5952  45
1   190  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_8.png
early stop counter: 2
val acc:0.9749893546104431, best validation acc: 0.9765325784683228, corresponding to test acc:                         0.9600511193275452 / 0.9789069890975952
after epoch: 8,now: 2024-06-07 22:34:58.678473,epoch time: 0:16:46.181979,used: 2:10:06.234252,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97739315, 'precision': 0.81326675, 'recall': 0.876596, 'specificity': 0.876596, 'f1': 0.84172916, 'auroc': 0.9757584, 'binary_precision': 0.6346262, 'binary_recall': 0.76855004, 'binary_specificity': 0.9846419, 'binary_f1_score': 0.69519705}
confusion matrix:
       0     1
0  41673   650
1    340  1129
---- Validation: 
scalar performance:
{'acc': 0.9808961, 'precision': 0.84913534, 'recall': 0.87160087, 'specificity': 0.87160087, 'f1': 0.85998493, 'auroc': 0.97844434, 'binary_precision': 0.7069971, 'binary_recall': 0.7542768, 'binary_specificity': 0.988925, 'binary_f1_score': 0.72987205}
confusion matrix:
       0    1
0  17948  201
1    158  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.8302426, 'recall': 0.64650714, 'specificity': 0.64650714, 'f1': 0.69957906, 'auroc': 0.94898903, 'binary_precision': 0.6902655, 'binary_recall': 0.29885057, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.41711226}
confusion matrix:
      0   1
0  5962  35
1   183  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_9.png
better model found
persisted
after epoch: 9,now: 2024-06-07 22:51:33.834254,epoch time: 0:16:35.155781,used: 2:26:41.390033,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9775073, 'precision': 0.9060887, 'recall': 0.70574784, 'specificity': 0.70574784, 'f1': 0.7708756, 'auroc': 0.97850907, 'binary_precision': 0.8321965, 'binary_recall': 0.4144022, 'binary_specificity': 0.99709356, 'binary_f1_score': 0.553288}
confusion matrix:
       0    1
0  42197  123
1    862  610
---- Validation: 
scalar performance:
{'acc': 0.9741379, 'precision': 0.8945359, 'recall': 0.6573366, 'specificity': 0.6573366, 'f1': 0.7215649, 'auroc': 0.97454274, 'binary_precision': 0.812749, 'binary_recall': 0.31726283, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.45637587}
confusion matrix:
       0    1
0  18102   47
1    439  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.6967566, 'recall': 0.52348685, 'specificity': 0.52348685, 'f1': 0.5338351, 'auroc': 0.95725036, 'binary_precision': 0.43333334, 'binary_recall': 0.049808428, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.08934707}
confusion matrix:
      0   1
0  5980  17
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_10.png
early stop counter: 1
val acc:0.9741379022598267, best validation acc: 0.9808961153030396, corresponding to test acc:                         0.9651646018028259 / 0.9789069890975952
after epoch: 10,now: 2024-06-07 23:07:44.160284,epoch time: 0:16:10.326030,used: 2:42:51.716063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97435606, 'precision': 0.8528484, 'recall': 0.68739665, 'specificity': 0.68739665, 'f1': 0.7428629, 'auroc': 0.96964574, 'binary_precision': 0.7269181, 'binary_recall': 0.37975544, 'binary_specificity': 0.9950378, 'binary_f1_score': 0.49888447}
confusion matrix:
       0    1
0  42110  210
1    913  559
---- Validation: 
scalar performance:
{'acc': 0.97467005, 'precision': 0.90207314, 'recall': 0.6628625, 'specificity': 0.6628625, 'f1': 0.7284791, 'auroc': 0.9682148, 'binary_precision': 0.827451, 'binary_recall': 0.3281493, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.46993312}
confusion matrix:
       0    1
0  18105   44
1    432  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.9812229, 'recall': 0.55172414, 'specificity': 0.55172414, 'f1': 0.5841818, 'auroc': 0.9368489, 'binary_precision': 1.0, 'binary_recall': 0.10344828, 'binary_specificity': 1.0, 'binary_f1_score': 0.1875}
confusion matrix:
      0   1
0  5997   0
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_11.png
early stop counter: 2
val acc:0.9746700525283813, best validation acc: 0.9808961153030396, corresponding to test acc:                         0.9651646018028259 / 0.9789069890975952
after epoch: 11,now: 2024-06-07 23:23:47.684062,epoch time: 0:16:03.523778,used: 2:58:55.239841,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9780097, 'precision': 0.825486, 'recall': 0.84744453, 'specificity': 0.84744453, 'f1': 0.83607256, 'auroc': 0.9739617, 'binary_precision': 0.661157, 'binary_recall': 0.707483, 'binary_specificity': 0.9874061, 'binary_f1_score': 0.683536}
confusion matrix:
       0     1
0  41789   533
1    430  1040
---- Validation: 
scalar performance:
{'acc': 0.9785547, 'precision': 0.84672266, 'recall': 0.81488466, 'specificity': 0.81488466, 'f1': 0.8299682, 'auroc': 0.97509193, 'binary_precision': 0.7061856, 'binary_recall': 0.63919127, 'binary_specificity': 0.990578, 'binary_f1_score': 0.6710204}
confusion matrix:
       0    1
0  17978  171
1    232  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.85361785, 'recall': 0.5867886, 'specificity': 0.5867886, 'f1': 0.6329422, 'auroc': 0.94387263, 'binary_precision': 0.7419355, 'binary_recall': 0.17624521, 'binary_specificity': 0.997332, 'binary_f1_score': 0.28482974}
confusion matrix:
      0   1
0  5981  16
1   215  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_12.png
early stop counter: 3
val acc:0.9785547256469727, best validation acc: 0.9808961153030396, corresponding to test acc:                         0.9651646018028259 / 0.9789069890975952
after epoch: 12,now: 2024-06-07 23:39:55.500638,epoch time: 0:16:07.816576,used: 3:15:03.056417,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97862625, 'precision': 0.8686399, 'recall': 0.7674806, 'specificity': 0.7674806, 'f1': 0.8093711, 'auroc': 0.97697085, 'binary_precision': 0.75307477, 'binary_recall': 0.54112846, 'binary_specificity': 0.9938328, 'binary_f1_score': 0.6297468}
confusion matrix:
       0    1
0  42060  261
1    675  796
---- Validation: 
scalar performance:
{'acc': 0.9736058, 'precision': 0.8412477, 'recall': 0.69456387, 'specificity': 0.69456387, 'f1': 0.7462084, 'auroc': 0.9726881, 'binary_precision': 0.7036011, 'binary_recall': 0.39502332, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.5059761}
confusion matrix:
       0    1
0  18042  107
1    389  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7587574, 'recall': 0.56654763, 'specificity': 0.56654763, 'f1': 0.60001105, 'auroc': 0.95925486, 'binary_precision': 0.5538462, 'binary_recall': 0.13793103, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.22085889}
confusion matrix:
      0   1
0  5968  29
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_13.png
early stop counter: 4
val acc:0.9736058115959167, best validation acc: 0.9808961153030396, corresponding to test acc:                         0.9651646018028259 / 0.9789069890975952
after epoch: 13,now: 2024-06-07 23:55:57.948084,epoch time: 0:16:02.447446,used: 3:31:05.503863,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98221135, 'precision': 0.8892455, 'recall': 0.8170309, 'specificity': 0.8170309, 'f1': 0.84914976, 'auroc': 0.98085773, 'binary_precision': 0.790932, 'binary_recall': 0.6399456, 'binary_specificity': 0.99411625, 'binary_f1_score': 0.70747274}
confusion matrix:
       0    1
0  42071  249
1    530  942
---- Validation: 
scalar performance:
{'acc': 0.9807897, 'precision': 0.90762514, 'recall': 0.7732886, 'specificity': 0.7732886, 'f1': 0.8262074, 'auroc': 0.97946846, 'binary_precision': 0.8309859, 'binary_recall': 0.5505443, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.6623012}
confusion matrix:
       0    1
0  18077   72
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.83299243, 'recall': 0.5225716, 'specificity': 0.5225716, 'f1': 0.5327879, 'auroc': 0.9528017, 'binary_precision': 0.7058824, 'binary_recall': 0.04597701, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.086330935}
confusion matrix:
      0   1
0  5992   5
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_14.png
early stop counter: 5
val acc:0.9807897210121155, best validation acc: 0.9808961153030396, corresponding to test acc:                         0.9651646018028259 / 0.9789069890975952
after epoch: 14,now: 2024-06-08 00:11:58.568804,epoch time: 0:16:00.620720,used: 3:47:06.124583,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97844356, 'precision': 0.8512737, 'recall': 0.79185426, 'specificity': 0.79185426, 'f1': 0.8185836, 'auroc': 0.98066974, 'binary_precision': 0.7166392, 'binary_recall': 0.59183675, 'binary_specificity': 0.99187183, 'binary_f1_score': 0.64828616}
confusion matrix:
       0    1
0  41978  344
1    600  870
---- Validation: 
scalar performance:
{'acc': 0.9773308, 'precision': 0.86036426, 'recall': 0.75874686, 'specificity': 0.75874686, 'f1': 0.8005254, 'auroc': 0.97587514, 'binary_precision': 0.73741794, 'binary_recall': 0.5241057, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.6127272}
confusion matrix:
       0    1
0  18029  120
1    306  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.7866551, 'recall': 0.5782087, 'specificity': 0.5782087, 'f1': 0.61717916, 'auroc': 0.9541993, 'binary_precision': 0.6086956, 'binary_recall': 0.16091955, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.25454545}
confusion matrix:
      0   1
0  5970  27
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_15.png
early stop counter: 6
val acc:0.9773308038711548, best validation acc: 0.9808961153030396, corresponding to test acc:                         0.9651646018028259 / 0.9789069890975952
after epoch: 15,now: 2024-06-08 00:28:02.977573,epoch time: 0:16:04.408769,used: 4:03:10.533352,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9829421, 'precision': 0.8898592, 'recall': 0.83150697, 'specificity': 0.83150697, 'f1': 0.8581312, 'auroc': 0.98275554, 'binary_precision': 0.79116464, 'binary_recall': 0.6691576, 'binary_specificity': 0.9938563, 'binary_f1_score': 0.7250644}
confusion matrix:
       0    1
0  42060  260
1    487  985
---- Validation: 
scalar performance:
{'acc': 0.9819604, 'precision': 0.909495, 'recall': 0.7933961, 'specificity': 0.7933961, 'f1': 0.8411231, 'auroc': 0.9763548, 'binary_precision': 0.8333333, 'binary_recall': 0.59097975, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.69153774}
confusion matrix:
       0    1
0  18073   76
1    263  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7422133, 'recall': 0.5423104, 'specificity': 0.5423104, 'f1': 0.5648046, 'auroc': 0.94581294, 'binary_precision': 0.52272725, 'binary_recall': 0.08812261, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.15081967}
confusion matrix:
      0   1
0  5976  21
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_16.png
better model found
persisted
after epoch: 16,now: 2024-06-08 00:44:03.515379,epoch time: 0:16:00.537806,used: 4:19:11.071158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98031604, 'precision': 0.91435564, 'recall': 0.7516223, 'specificity': 0.7516223, 'f1': 0.8116949, 'auroc': 0.9817246, 'binary_precision': 0.84563, 'binary_recall': 0.50645816, 'binary_specificity': 0.9967865, 'binary_f1_score': 0.6335034}
confusion matrix:
       0    1
0  42185  136
1    726  745
---- Validation: 
scalar performance:
{'acc': 0.97616005, 'precision': 0.9044957, 'recall': 0.68913573, 'specificity': 0.68913573, 'f1': 0.75508153, 'auroc': 0.97848594, 'binary_precision': 0.8305085, 'binary_recall': 0.38102645, 'binary_specificity': 0.997245, 'binary_f1_score': 0.52238804}
confusion matrix:
       0    1
0  18099   50
1    398  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.83742183, 'recall': 0.5282354, 'specificity': 0.5282354, 'f1': 0.54289234, 'auroc': 0.9559636, 'binary_precision': 0.71428573, 'binary_recall': 0.057471264, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.10638297}
confusion matrix:
      0   1
0  5991   6
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_17.png
early stop counter: 1
val acc:0.9761600494384766, best validation acc: 0.9819604158401489, corresponding to test acc:                         0.9586129784584045 / 0.9789069890975952
after epoch: 17,now: 2024-06-08 01:00:03.578819,epoch time: 0:16:00.063440,used: 4:35:11.134598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98166335, 'precision': 0.85880595, 'recall': 0.8590412, 'specificity': 0.8590412, 'f1': 0.85892355, 'auroc': 0.98320484, 'binary_precision': 0.72708756, 'binary_recall': 0.7275815, 'binary_specificity': 0.9905009, 'binary_f1_score': 0.7273345}
confusion matrix:
       0     1
0  41918   402
1    401  1071
---- Validation: 
scalar performance:
{'acc': 0.9822265, 'precision': 0.8925779, 'recall': 0.81903577, 'specificity': 0.81903577, 'f1': 0.85169715, 'auroc': 0.9787439, 'binary_precision': 0.7976879, 'binary_recall': 0.64385694, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.7125646}
confusion matrix:
       0    1
0  18044  105
1    229  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.69840395, 'recall': 0.5126596, 'specificity': 0.5126596, 'f1': 0.5145264, 'auroc': 0.9465568, 'binary_precision': 0.4375, 'binary_recall': 0.026819924, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.050541516}
confusion matrix:
      0  1
0  5988  9
1   254  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_18.png
better model found
persisted
after epoch: 18,now: 2024-06-08 01:16:06.593101,epoch time: 0:16:03.014282,used: 4:51:14.148880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98090976, 'precision': 0.86132634, 'recall': 0.83471763, 'specificity': 0.83471763, 'f1': 0.8474691, 'auroc': 0.9826249, 'binary_precision': 0.73382354, 'binary_recall': 0.6779891, 'binary_specificity': 0.99144614, 'binary_f1_score': 0.7048023}
confusion matrix:
       0    1
0  41958  362
1    474  998
---- Validation: 
scalar performance:
{'acc': 0.98137504, 'precision': 0.87920594, 'recall': 0.8208451, 'specificity': 0.8208451, 'f1': 0.84738827, 'auroc': 0.978403, 'binary_precision': 0.7707948, 'binary_recall': 0.64852256, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.7043919}
confusion matrix:
       0    1
0  18025  124
1    226  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.74829465, 'recall': 0.5423938, 'specificity': 0.5423938, 'f1': 0.56509453, 'auroc': 0.9579806, 'binary_precision': 0.53488374, 'binary_recall': 0.08812261, 'binary_specificity': 0.996665, 'binary_f1_score': 0.1513158}
confusion matrix:
      0   1
0  5977  20
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_19.png
early stop counter: 1
val acc:0.9813750386238098, best validation acc: 0.9822264909744263, corresponding to test acc:                         0.9579737782478333 / 0.9789069890975952
after epoch: 19,now: 2024-06-08 01:32:05.473408,epoch time: 0:15:58.880307,used: 5:07:13.029187,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9822342, 'precision': 0.9132316, 'recall': 0.78884685, 'specificity': 0.78884685, 'f1': 0.8392037, 'auroc': 0.9845365, 'binary_precision': 0.8408644, 'binary_recall': 0.58152175, 'binary_specificity': 0.996172, 'binary_f1_score': 0.6875502}
confusion matrix:
       0    1
0  42158  162
1    616  856
---- Validation: 
scalar performance:
{'acc': 0.9781822, 'precision': 0.91020393, 'recall': 0.722435, 'specificity': 0.722435, 'f1': 0.7864878, 'auroc': 0.9757869, 'binary_precision': 0.83965015, 'binary_recall': 0.44790047, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.5841785}
confusion matrix:
       0    1
0  18094   55
1    355  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.6860398, 'recall': 0.52515244, 'specificity': 0.52515244, 'f1': 0.5365338, 'auroc': 0.9362675, 'binary_precision': 0.4117647, 'binary_recall': 0.053639848, 'binary_specificity': 0.996665, 'binary_f1_score': 0.094915256}
confusion matrix:
      0   1
0  5977  20
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_20.png
early stop counter: 2
val acc:0.9781821966171265, best validation acc: 0.9822264909744263, corresponding to test acc:                         0.9579737782478333 / 0.9789069890975952
after epoch: 20,now: 2024-06-08 01:48:06.262562,epoch time: 0:16:00.789154,used: 5:23:13.818341,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97869474, 'precision': 0.92560965, 'recall': 0.713903, 'specificity': 0.713903, 'f1': 0.78239465, 'auroc': 0.981442, 'binary_precision': 0.8707015, 'binary_recall': 0.4300272, 'binary_specificity': 0.99777883, 'binary_f1_score': 0.57571626}
confusion matrix:
       0    1
0  42226   94
1    839  633
---- Validation: 
scalar performance:
{'acc': 0.9762133, 'precision': 0.92446077, 'recall': 0.6779125, 'specificity': 0.6779125, 'f1': 0.7474895, 'auroc': 0.97375584, 'binary_precision': 0.8712121, 'binary_recall': 0.3576983, 'binary_specificity': 0.9981266, 'binary_f1_score': 0.50716645}
confusion matrix:
       0    1
0  18115   34
1    413  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7410728, 'recall': 0.54780746, 'specificity': 0.54780746, 'f1': 0.5729909, 'auroc': 0.9480267, 'binary_precision': 0.52, 'binary_recall': 0.099616855, 'binary_specificity': 0.995998, 'binary_f1_score': 0.16720255}
confusion matrix:
      0   1
0  5973  24
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_21.png
early stop counter: 3
val acc:0.976213276386261, best validation acc: 0.9822264909744263, corresponding to test acc:                         0.9579737782478333 / 0.9789069890975952
after epoch: 21,now: 2024-06-08 02:04:05.771978,epoch time: 0:15:59.509416,used: 5:39:13.327757,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98287356, 'precision': 0.8678639, 'recall': 0.868347, 'specificity': 0.868347, 'f1': 0.8681053, 'auroc': 0.9824426, 'binary_precision': 0.7445652, 'binary_recall': 0.7455782, 'binary_specificity': 0.99111575, 'binary_f1_score': 0.7450714}
confusion matrix:
       0     1
0  41946   376
1    374  1096
---- Validation: 
scalar performance:
{'acc': 0.9819072, 'precision': 0.8854542, 'recall': 0.82262075, 'specificity': 0.82262075, 'f1': 0.8510181, 'auroc': 0.9758432, 'binary_precision': 0.78317755, 'binary_recall': 0.65163296, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.71137524}
confusion matrix:
       0    1
0  18033  116
1    224  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.71211916, 'recall': 0.55455315, 'specificity': 0.55455315, 'f1': 0.58111393, 'auroc': 0.9471736, 'binary_precision': 0.46153846, 'binary_recall': 0.11494253, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.18404908}
confusion matrix:
      0   1
0  5962  35
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_22.png
early stop counter: 4
val acc:0.9819071888923645, best validation acc: 0.9822264909744263, corresponding to test acc:                         0.9579737782478333 / 0.9789069890975952
after epoch: 22,now: 2024-06-08 02:20:21.202343,epoch time: 0:16:15.430365,used: 5:55:28.758122,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98337597, 'precision': 0.88736594, 'recall': 0.84451795, 'specificity': 0.84451795, 'f1': 0.864584, 'auroc': 0.9855119, 'binary_precision': 0.78527606, 'binary_recall': 0.6956522, 'binary_specificity': 0.99338377, 'binary_f1_score': 0.7377522}
confusion matrix:
       0     1
0  42040   280
1    448  1024
---- Validation: 
scalar performance:
{'acc': 0.98275864, 'precision': 0.92608815, 'recall': 0.7915592, 'specificity': 0.7915592, 'f1': 0.8452841, 'auroc': 0.97868526, 'binary_precision': 0.8666667, 'binary_recall': 0.58631414, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.69944346}
confusion matrix:
       0    1
0  18091   58
1    266  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.71664655, 'recall': 0.5164076, 'specificity': 0.5164076, 'f1': 0.52143675, 'auroc': 0.9461295, 'binary_precision': 0.47368422, 'binary_recall': 0.03448276, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.06428572}
confusion matrix:
      0   1
0  5987  10
1   252   9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_23.png
better model found
persisted
after epoch: 23,now: 2024-06-08 02:36:56.284027,epoch time: 0:16:35.081684,used: 6:12:03.839806,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9835815, 'precision': 0.8656533, 'recall': 0.89078164, 'specificity': 0.89078164, 'f1': 0.87776256, 'auroc': 0.9861721, 'binary_precision': 0.7385787, 'binary_recall': 0.79129845, 'binary_specificity': 0.9902649, 'binary_f1_score': 0.7640302}
confusion matrix:
       0     1
0  41909   412
1    307  1164
---- Validation: 
scalar performance:
{'acc': 0.98361003, 'precision': 0.88497937, 'recall': 0.85950494, 'specificity': 0.85950494, 'f1': 0.8717689, 'auroc': 0.9811853, 'binary_precision': 0.77963275, 'binary_recall': 0.7262831, 'binary_specificity': 0.99272686, 'binary_f1_score': 0.75201285}
confusion matrix:
       0    1
0  18017  132
1    176  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.70082605, 'recall': 0.5271515, 'specificity': 0.5271515, 'f1': 0.54000545, 'auroc': 0.9465443, 'binary_precision': 0.44117647, 'binary_recall': 0.057471264, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.10169491}
confusion matrix:
      0   1
0  5978  19
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_24.png
better model found
persisted
after epoch: 24,now: 2024-06-08 02:53:25.954261,epoch time: 0:16:29.670234,used: 6:28:33.510040,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9811153, 'precision': 0.8842999, 'recall': 0.8007266, 'specificity': 0.8007266, 'f1': 0.8370073, 'auroc': 0.987419, 'binary_precision': 0.78215224, 'binary_recall': 0.60733694, 'binary_specificity': 0.99411625, 'binary_f1_score': 0.6837476}
confusion matrix:
       0    1
0  42071  249
1    578  894
---- Validation: 
scalar performance:
{'acc': 0.97754365, 'precision': 0.88145435, 'recall': 0.7363554, 'specificity': 0.7363554, 'f1': 0.7905588, 'auroc': 0.97659427, 'binary_precision': 0.7811705, 'binary_recall': 0.47744945, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.5926641}
confusion matrix:
       0    1
0  18063   86
1    336  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95669544, 'precision': 0.68058956, 'recall': 0.5358129, 'specificity': 0.5358129, 'f1': 0.5532067, 'auroc': 0.9421614, 'binary_precision': 0.4, 'binary_recall': 0.07662835, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.12861736}
confusion matrix:
      0   1
0  5967  30
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_25.png
early stop counter: 1
val acc:0.9775436520576477, best validation acc: 0.9836100339889526, corresponding to test acc:                         0.9576541781425476 / 0.9789069890975952
after epoch: 25,now: 2024-06-08 03:09:55.533633,epoch time: 0:16:29.579372,used: 6:45:03.089412,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.986139, 'precision': 0.91694355, 'recall': 0.8584062, 'specificity': 0.8584062, 'f1': 0.8852918, 'auroc': 0.9886278, 'binary_precision': 0.8435266, 'binary_recall': 0.7214674, 'binary_specificity': 0.995345, 'binary_f1_score': 0.77773714}
confusion matrix:
       0     1
0  42123   197
1    410  1062
---- Validation: 
scalar performance:
{'acc': 0.9830247, 'precision': 0.9363781, 'recall': 0.78719664, 'specificity': 0.78719664, 'f1': 0.845303, 'auroc': 0.97929716, 'binary_precision': 0.88755983, 'binary_recall': 0.5769829, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.6993402}
confusion matrix:
       0    1
0  18102   47
1    272  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8402616, 'recall': 0.54331094, 'specificity': 0.54331094, 'f1': 0.56839436, 'auroc': 0.9411727, 'binary_precision': 0.71875, 'binary_recall': 0.08812261, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.1569966}
confusion matrix:
      0   1
0  5988   9
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_26.png
early stop counter: 2
val acc:0.9830247163772583, best validation acc: 0.9836100339889526, corresponding to test acc:                         0.9576541781425476 / 0.9789069890975952
after epoch: 26,now: 2024-06-08 03:26:27.154470,epoch time: 0:16:31.620837,used: 7:01:34.710249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98394686, 'precision': 0.8954923, 'recall': 0.8441576, 'specificity': 0.8441576, 'f1': 0.86789894, 'auroc': 0.98546445, 'binary_precision': 0.8015686, 'binary_recall': 0.6942935, 'binary_specificity': 0.9940217, 'binary_f1_score': 0.7440844}
confusion matrix:
       0     1
0  42067   253
1    450  1022
---- Validation: 
scalar performance:
{'acc': 0.98366326, 'precision': 0.9068539, 'recall': 0.8287803, 'specificity': 0.8287803, 'f1': 0.8633441, 'auroc': 0.97720194, 'binary_precision': 0.8255814, 'binary_recall': 0.66251945, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.7351165}
confusion matrix:
       0    1
0  18059   90
1    217  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.79962337, 'recall': 0.5747107, 'specificity': 0.5747107, 'f1': 0.6134502, 'auroc': 0.9426613, 'binary_precision': 0.63492066, 'binary_recall': 0.1532567, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.24691357}
confusion matrix:
      0   1
0  5974  23
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_27.png
better model found
persisted
after epoch: 27,now: 2024-06-08 03:43:02.335024,epoch time: 0:16:35.180554,used: 7:18:09.890803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98479176, 'precision': 0.9168278, 'recall': 0.8331197, 'specificity': 0.8331197, 'f1': 0.8699434, 'auroc': 0.9858124, 'binary_precision': 0.84503424, 'binary_recall': 0.6705163, 'binary_specificity': 0.99572307, 'binary_f1_score': 0.7477273}
confusion matrix:
       0    1
0  42139  181
1    485  987
---- Validation: 
scalar performance:
{'acc': 0.9819072, 'precision': 0.9386313, 'recall': 0.7663666, 'specificity': 0.7663666, 'f1': 0.8299799, 'auroc': 0.97945356, 'binary_precision': 0.89350647, 'binary_recall': 0.5349922, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.6692606}
confusion matrix:
       0    1
0  18108   41
1    299  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.7994338, 'recall': 0.5523058, 'specificity': 0.5523058, 'f1': 0.5816075, 'auroc': 0.9528783, 'binary_precision': 0.6363636, 'binary_recall': 0.107279696, 'binary_specificity': 0.997332, 'binary_f1_score': 0.18360655}
confusion matrix:
      0   1
0  5981  16
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_28.png
early stop counter: 1
val acc:0.9819071888923645, best validation acc: 0.9836632609367371, corresponding to test acc:                         0.9610099196434021 / 0.9789069890975952
after epoch: 28,now: 2024-06-08 03:59:34.030350,epoch time: 0:16:31.695326,used: 7:34:41.586129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98271376, 'precision': 0.8686683, 'recall': 0.86310124, 'specificity': 0.86310124, 'f1': 0.8658618, 'auroc': 0.9829285, 'binary_precision': 0.746547, 'binary_recall': 0.73487425, 'binary_specificity': 0.9913282, 'binary_f1_score': 0.7406646}
confusion matrix:
       0     1
0  41954   367
1    390  1081
---- Validation: 
scalar performance:
{'acc': 0.9816411, 'precision': 0.87627697, 'recall': 0.8314836, 'specificity': 0.8314836, 'f1': 0.85234165, 'auroc': 0.9780035, 'binary_precision': 0.7641844, 'binary_recall': 0.6702955, 'binary_specificity': 0.9926718, 'binary_f1_score': 0.71416736}
confusion matrix:
       0    1
0  18016  133
1    212  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.7193251, 'recall': 0.53831226, 'specificity': 0.53831226, 'f1': 0.5580835, 'auroc': 0.94587284, 'binary_precision': 0.47727272, 'binary_recall': 0.08045977, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.13770492}
confusion matrix:
      0   1
0  5974  23
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_29.png
early stop counter: 2
val acc:0.9816411137580872, best validation acc: 0.9836632609367371, corresponding to test acc:                         0.9610099196434021 / 0.9789069890975952
after epoch: 29,now: 2024-06-08 04:16:08.626312,epoch time: 0:16:34.595962,used: 7:51:16.182091,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9836043, 'precision': 0.9152102, 'recall': 0.81237984, 'specificity': 0.81237984, 'f1': 0.85597974, 'auroc': 0.9891998, 'binary_precision': 0.84320873, 'binary_recall': 0.62882394, 'binary_specificity': 0.9959358, 'binary_f1_score': 0.7204049}
confusion matrix:
       0    1
0  42149  172
1    546  925
---- Validation: 
scalar performance:
{'acc': 0.9800979, 'precision': 0.92345595, 'recall': 0.7466785, 'specificity': 0.7466785, 'f1': 0.8101042, 'auroc': 0.9800039, 'binary_precision': 0.8644986, 'binary_recall': 0.496112, 'binary_specificity': 0.997245, 'binary_f1_score': 0.6304348}
confusion matrix:
       0    1
0  18099   50
1    324  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8408649, 'recall': 0.61294156, 'specificity': 0.61294156, 'f1': 0.6646698, 'auroc': 0.9531426, 'binary_precision': 0.71428573, 'binary_recall': 0.22988506, 'binary_specificity': 0.995998, 'binary_f1_score': 0.3478261}
confusion matrix:
      0   1
0  5973  24
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202600_30.png
early stop counter: 3
val acc:0.9800978899002075, best validation acc: 0.9836632609367371, corresponding to test acc:                         0.9610099196434021 / 0.9789069890975952
after epoch: 30,now: 2024-06-08 04:32:39.753612,epoch time: 0:16:31.127300,used: 8:07:47.309391,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_20_24_52_seed_0_21202600
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:07:47.309391 at 2024-06-08 04:32:39.753612
persisted model performance metric: 

scalar performance:
{'acc': 0.96164906, 'precision': 0.8242049, 'recall': 0.5732119, 'specificity': 0.5732119, 'f1': 0.6128038, 'auroc': 0.9433625, 'binary_precision': 0.68421054, 'binary_recall': 0.14942528, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.24528302}
confusion matrix:
      0   1
0  5979  18
1   222  39
oracle model performance metric: 

scalar performance:
{'acc': 0.97778845, 'precision': 0.94310087, 'recall': 0.75936913, 'specificity': 0.75936913, 'f1': 0.82515883, 'auroc': 0.9482807, 'binary_precision': 0.9066667, 'binary_recall': 0.5210728, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.6618005}
confusion matrix:
      0    1
0  5983   14
1   125  136
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 504642 KiB |   2050 MiB |    938 TiB |    938 TiB |
|       from large pool | 462955 KiB |   2017 MiB |    926 TiB |    926 TiB |
|       from small pool |  41687 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 504642 KiB |   2050 MiB |    938 TiB |    938 TiB |
|       from large pool | 462955 KiB |   2017 MiB |    926 TiB |    926 TiB |
|       from small pool |  41687 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 496650 KiB |   2046 MiB |    938 TiB |    938 TiB |
|       from large pool | 455971 KiB |   2014 MiB |    925 TiB |    925 TiB |
|       from small pool |  40679 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2324 MiB |   2324 MiB |   2324 MiB |      0 B   |
|       from large pool |   2254 MiB |   2254 MiB |   2254 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 353469 KiB | 387189 KiB | 771793 GiB | 771793 GiB |
|       from large pool | 343957 KiB | 381636 KiB | 758802 GiB | 758802 GiB |
|       from small pool |   9512 KiB |  14571 KiB |  12991 GiB |  12991 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6459    |  180479 K  |  180475 K  |
|       from large pool |     187    |     311    |   88163 K  |   88163 K  |
|       from small pool |    3301    |    6271    |   92315 K  |   92312 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6459    |  180479 K  |  180475 K  |
|       from large pool |     187    |     311    |   88163 K  |   88163 K  |
|       from small pool |    3301    |    6271    |   92315 K  |   92312 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     128    |     128    |       0    |
|       from large pool |      93    |      93    |      93    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      64    |    2787    |   94520 K  |   94519 K  |
|       from large pool |      32    |      86    |   58712 K  |   58712 K  |
|       from small pool |      32    |    2755    |   35807 K  |   35807 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   2050 MiB |    938 TiB |    938 TiB |
|       from large pool |  65536 KiB |   2017 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   2050 MiB |    938 TiB |    938 TiB |
|       from large pool |  65536 KiB |   2017 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   2046 MiB |    938 TiB |    938 TiB |
|       from large pool |  65536 KiB |   2014 MiB |    925 TiB |    925 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    838 MiB |   2324 MiB |   2324 MiB |   1486 MiB |
|       from large pool |    788 MiB |   2254 MiB |   2254 MiB |   1466 MiB |
|       from small pool |     50 MiB |     70 MiB |     70 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 451353 KiB | 771794 GiB | 771794 GiB |
|       from large pool |      0 B   | 430097 KiB | 758802 GiB | 758802 GiB |
|       from small pool |      0 B   |  21494 KiB |  12991 GiB |  12991 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6459    |  180479 K  |  180479 K  |
|       from large pool |       2    |     311    |   88163 K  |   88163 K  |
|       from small pool |       0    |    6271    |   92315 K  |   92315 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6459    |  180479 K  |  180479 K  |
|       from large pool |       2    |     311    |   88163 K  |   88163 K  |
|       from small pool |       0    |    6271    |   92315 K  |   92315 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      60    |     128    |     128    |      68    |
|       from large pool |      35    |      93    |      93    |      58    |
|       from small pool |      25    |      35    |      35    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2787    |   94521 K  |   94521 K  |
|       from large pool |       0    |      86    |   58712 K  |   58712 K  |
|       from small pool |       0    |    2755    |   35808 K  |   35808 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jun  8 04:34:15 2024]
Finished job 0.
1 of 1 steps (100%) done
