Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jun  5 22:36:38 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989

 Experiment start at: 2024-06-05 22:52:07.421198
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9695606, 'precision': 0.7669727, 'recall': 0.7481923, 'specificity': 0.7481923, 'f1': 0.7572042, 'auroc': 0.9511751, 'binary_precision': 0.5509158, 'binary_recall': 0.51086956, 'binary_specificity': 0.9855151, 'binary_f1_score': 0.5301375}
confusion matrix:
       0    1
0  41707  613
1    720  752
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9662622, 'precision': 0.7444395, 'recall': 0.72826475, 'specificity': 0.72826475, 'f1': 0.7360438, 'auroc': 0.94637704, 'binary_precision': 0.5075125, 'binary_recall': 0.47278383, 'binary_specificity': 0.98374563, 'binary_f1_score': 0.489533}
confusion matrix:
       0    1
0  17854  295
1    339  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685203, 'precision': 0.8615416, 'recall': 0.6812401, 'specificity': 0.6812401, 'f1': 0.73866427, 'auroc': 0.94023514, 'binary_precision': 0.75, 'binary_recall': 0.3678161, 'binary_specificity': 0.994664, 'binary_f1_score': 0.49357328}
confusion matrix:
      0   1
0  5965  32
1   165  96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-05 23:25:44.633613,epoch time: 0:33:37.212415,used: 0:33:37.212415,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9739907, 'precision': 0.8101195, 'recall': 0.758353, 'specificity': 0.758353, 'f1': 0.7816602, 'auroc': 0.9647714, 'binary_precision': 0.6365874, 'binary_recall': 0.52717394, 'binary_specificity': 0.9895321, 'binary_f1_score': 0.5767372}
confusion matrix:
       0    1
0  41877  443
1    696  776
---- Validation: 
scalar performance:
{'acc': 0.97275436, 'precision': 0.8059654, 'recall': 0.7421266, 'specificity': 0.7421266, 'f1': 0.76997745, 'auroc': 0.9607352, 'binary_precision': 0.629703, 'binary_recall': 0.49455675, 'binary_specificity': 0.9896964, 'binary_f1_score': 0.554007}
confusion matrix:
       0    1
0  17962  187
1    325  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.9224582, 'recall': 0.5704644, 'specificity': 0.5704644, 'f1': 0.61273694, 'auroc': 0.9457655, 'binary_precision': 0.88095236, 'binary_recall': 0.14176245, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.2442244}
confusion matrix:
      0   1
0  5992   5
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_2.png
better model found
persisted
after epoch: 2,now: 2024-06-05 23:57:29.182734,epoch time: 0:31:44.549121,used: 1:05:21.761536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97707343, 'precision': 0.8912716, 'recall': 0.7091298, 'specificity': 0.7091298, 'f1': 0.770609, 'auroc': 0.9710392, 'binary_precision': 0.8023256, 'binary_recall': 0.421875, 'binary_specificity': 0.9963847, 'binary_f1_score': 0.5529831}
confusion matrix:
       0    1
0  42167  153
1    851  621
---- Validation: 
scalar performance:
{'acc': 0.9765858, 'precision': 0.9017234, 'recall': 0.6991068, 'specificity': 0.6991068, 'f1': 0.7638681, 'auroc': 0.9669781, 'binary_precision': 0.82428116, 'binary_recall': 0.40124416, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.5397489}
confusion matrix:
       0    1
0  18094   55
1    385  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7958343, 'recall': 0.5224049, 'specificity': 0.5224049, 'f1': 0.53239626, 'auroc': 0.9508683, 'binary_precision': 0.6315789, 'binary_recall': 0.04597701, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.08571429}
confusion matrix:
      0   1
0  5990   7
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_3.png
better model found
persisted
after epoch: 3,now: 2024-06-06 00:29:19.644828,epoch time: 0:31:50.462094,used: 1:37:12.223630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97967666, 'precision': 0.861283, 'recall': 0.80457234, 'specificity': 0.80457234, 'f1': 0.83030784, 'auroc': 0.9778073, 'binary_precision': 0.7358185, 'binary_recall': 0.6168478, 'binary_specificity': 0.9922968, 'binary_f1_score': 0.6711012}
confusion matrix:
       0    1
0  41994  326
1    564  908
---- Validation: 
scalar performance:
{'acc': 0.97828865, 'precision': 0.87549037, 'recall': 0.7592428, 'specificity': 0.7592428, 'f1': 0.8058715, 'auroc': 0.9716668, 'binary_precision': 0.76765376, 'binary_recall': 0.5241057, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.6229205}
confusion matrix:
       0    1
0  18047  102
1    306  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.7989384, 'recall': 0.5616343, 'specificity': 0.5616343, 'f1': 0.59531087, 'auroc': 0.9376823, 'binary_precision': 0.63461536, 'binary_recall': 0.12643678, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.21086262}
confusion matrix:
      0   1
0  5978  19
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_4.png
better model found
persisted
after epoch: 4,now: 2024-06-06 01:01:06.830037,epoch time: 0:31:47.185209,used: 2:08:59.408839,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9820515, 'precision': 0.90022457, 'recall': 0.7995717, 'specificity': 0.7995717, 'f1': 0.84210145, 'auroc': 0.98064935, 'binary_precision': 0.8141026, 'binary_recall': 0.6039402, 'binary_specificity': 0.9952032, 'binary_f1_score': 0.6934477}
confusion matrix:
       0    1
0  42117  203
1    583  889
---- Validation: 
scalar performance:
{'acc': 0.9807365, 'precision': 0.9051776, 'recall': 0.77476114, 'specificity': 0.77476114, 'f1': 0.8265136, 'auroc': 0.97470725, 'binary_precision': 0.8259861, 'binary_recall': 0.55365473, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.66294223}
confusion matrix:
       0    1
0  18074   75
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.9224582, 'recall': 0.5704644, 'specificity': 0.5704644, 'f1': 0.61273694, 'auroc': 0.9431309, 'binary_precision': 0.88095236, 'binary_recall': 0.14176245, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.2442244}
confusion matrix:
      0   1
0  5992   5
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_5.png
better model found
persisted
after epoch: 5,now: 2024-06-06 01:32:55.002239,epoch time: 0:31:48.172202,used: 2:40:47.581041,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98287356, 'precision': 0.8698381, 'recall': 0.86449623, 'specificity': 0.86449623, 'f1': 0.867146, 'auroc': 0.9841047, 'binary_precision': 0.7487923, 'binary_recall': 0.7375935, 'binary_specificity': 0.99139905, 'binary_f1_score': 0.7431507}
confusion matrix:
       0     1
0  41957   364
1    386  1085
---- Validation: 
scalar performance:
{'acc': 0.9830779, 'precision': 0.8719804, 'recall': 0.8719804, 'specificity': 0.8719804, 'f1': 0.8719804, 'auroc': 0.97712, 'binary_precision': 0.7527216, 'binary_recall': 0.7527216, 'binary_specificity': 0.9912392, 'binary_f1_score': 0.7527216}
confusion matrix:
       0    1
0  17990  159
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.80710244, 'recall': 0.5897863, 'specificity': 0.5897863, 'f1': 0.63347316, 'auroc': 0.9452411, 'binary_precision': 0.6486486, 'binary_recall': 0.18390805, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.28656715}
confusion matrix:
      0   1
0  5971  26
1   213  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_6.png
better model found
persisted
after epoch: 6,now: 2024-06-06 02:04:50.007487,epoch time: 0:31:55.005248,used: 3:12:42.586289,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97746164, 'precision': 0.80718446, 'recall': 0.9178491, 'specificity': 0.9178491, 'f1': 0.8531711, 'auroc': 0.98521197, 'binary_precision': 0.619517, 'binary_recall': 0.8539402, 'binary_specificity': 0.98175806, 'binary_f1_score': 0.7180806}
confusion matrix:
       0     1
0  41548   772
1    215  1257
---- Validation: 
scalar performance:
{'acc': 0.9749361, 'precision': 0.79337776, 'recall': 0.9210192, 'specificity': 0.9210192, 'f1': 0.84450257, 'auroc': 0.9781215, 'binary_precision': 0.59168446, 'binary_recall': 0.86314154, 'binary_specificity': 0.9788969, 'binary_f1_score': 0.70208734}
confusion matrix:
       0    1
0  17766  383
1     88  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.8416025, 'recall': 0.6712446, 'specificity': 0.6712446, 'f1': 0.7253985, 'auroc': 0.9465009, 'binary_precision': 0.7109375, 'binary_recall': 0.348659, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.46786633}
confusion matrix:
      0   1
0  5960  37
1   170  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_7.png
early stop counter: 1
val acc:0.9749361276626587, best validation acc: 0.983077883720398, corresponding to test acc:                         0.9618088603019714 / 0.9685202836990356
after epoch: 7,now: 2024-06-06 02:36:34.744958,epoch time: 0:31:44.737471,used: 3:44:27.323760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98390114, 'precision': 0.88174117, 'recall': 0.8654448, 'specificity': 0.8654448, 'f1': 0.8734001, 'auroc': 0.986665, 'binary_precision': 0.7725657, 'binary_recall': 0.73845106, 'binary_specificity': 0.99243855, 'binary_f1_score': 0.75512326}
confusion matrix:
       0     1
0  42000   320
1    385  1087
---- Validation: 
scalar performance:
{'acc': 0.9815879, 'precision': 0.88306236, 'recall': 0.8194552, 'specificity': 0.8194552, 'f1': 0.84813946, 'auroc': 0.9781064, 'binary_precision': 0.77861166, 'binary_recall': 0.64541215, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.70578235}
confusion matrix:
       0    1
0  18031  118
1    228  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.82830226, 'recall': 0.5882874, 'specificity': 0.5882874, 'f1': 0.63321567, 'auroc': 0.94629467, 'binary_precision': 0.6911765, 'binary_recall': 0.18007663, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.28571427}
confusion matrix:
      0   1
0  5976  21
1   214  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_8.png
early stop counter: 2
val acc:0.9815878868103027, best validation acc: 0.983077883720398, corresponding to test acc:                         0.9618088603019714 / 0.9685202836990356
after epoch: 8,now: 2024-06-06 03:08:18.509951,epoch time: 0:31:43.764993,used: 4:16:11.088753,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9839697, 'precision': 0.93709195, 'recall': 0.79780483, 'specificity': 0.79780483, 'f1': 0.8533095, 'auroc': 0.9880562, 'binary_precision': 0.8879919, 'binary_recall': 0.5982325, 'binary_specificity': 0.9973772, 'binary_f1_score': 0.714866}
confusion matrix:
       0    1
0  42210  111
1    591  880
---- Validation: 
scalar performance:
{'acc': 0.98169434, 'precision': 0.92754436, 'recall': 0.7715068, 'specificity': 0.7715068, 'f1': 0.8308566, 'auroc': 0.97688544, 'binary_precision': 0.87096775, 'binary_recall': 0.5458787, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.6711281}
confusion matrix:
       0    1
0  18097   52
1    292  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.9182507, 'recall': 0.53997976, 'specificity': 0.53997976, 'f1': 0.5637504, 'auroc': 0.951365, 'binary_precision': 0.875, 'binary_recall': 0.08045977, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.14736843}
confusion matrix:
      0   1
0  5994   3
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_9.png
early stop counter: 3
val acc:0.9816943407058716, best validation acc: 0.983077883720398, corresponding to test acc:                         0.9618088603019714 / 0.9685202836990356
after epoch: 9,now: 2024-06-06 03:39:58.424168,epoch time: 0:31:39.914217,used: 4:47:51.002970,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98668706, 'precision': 0.89535224, 'recall': 0.90131146, 'specificity': 0.90131146, 'f1': 0.8983077, 'auroc': 0.98968554, 'binary_precision': 0.7973244, 'binary_recall': 0.8097826, 'binary_specificity': 0.9928403, 'binary_f1_score': 0.80350524}
confusion matrix:
       0     1
0  42017   303
1    280  1192
---- Validation: 
scalar performance:
{'acc': 0.9855257, 'precision': 0.89715195, 'recall': 0.87924814, 'specificity': 0.87924814, 'f1': 0.8879761, 'auroc': 0.97986484, 'binary_precision': 0.8026101, 'binary_recall': 0.7651633, 'binary_specificity': 0.993333, 'binary_f1_score': 0.7834395}
confusion matrix:
       0    1
0  18028  121
1    151  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.81127167, 'recall': 0.55805296, 'specificity': 0.55805296, 'f1': 0.590574, 'auroc': 0.9223448, 'binary_precision': 0.65957445, 'binary_recall': 0.118773945, 'binary_specificity': 0.997332, 'binary_f1_score': 0.20129871}
confusion matrix:
      0   1
0  5981  16
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_10.png
better model found
persisted
after epoch: 10,now: 2024-06-06 04:11:37.753846,epoch time: 0:31:39.329678,used: 5:19:30.332648,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.985591, 'precision': 0.89386344, 'recall': 0.88066626, 'specificity': 0.88066626, 'f1': 0.887143, 'auroc': 0.98913336, 'binary_precision': 0.79577464, 'binary_recall': 0.7681849, 'binary_specificity': 0.9931476, 'binary_f1_score': 0.78173643}
confusion matrix:
       0     1
0  42031   290
1    341  1130
---- Validation: 
scalar performance:
{'acc': 0.98201364, 'precision': 0.87970257, 'recall': 0.8339266, 'specificity': 0.8339266, 'f1': 0.8552216, 'auroc': 0.97825843, 'binary_precision': 0.7708703, 'binary_recall': 0.6749611, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.71973467}
confusion matrix:
       0    1
0  18020  129
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.7944581, 'recall': 0.5895362, 'specificity': 0.5895362, 'f1': 0.6320759, 'auroc': 0.9138354, 'binary_precision': 0.6233766, 'binary_recall': 0.18390805, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.28402367}
confusion matrix:
      0   1
0  5968  29
1   213  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_11.png
early stop counter: 1
val acc:0.9820136427879333, best validation acc: 0.9855257272720337, corresponding to test acc:                         0.9606903195381165 / 0.9685202836990356
after epoch: 11,now: 2024-06-06 04:43:26.360798,epoch time: 0:31:48.606952,used: 5:51:18.939600,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98830837, 'precision': 0.9047596, 'recall': 0.9185432, 'specificity': 0.9185432, 'f1': 0.9115263, 'auroc': 0.98982805, 'binary_precision': 0.81496066, 'binary_recall': 0.84375, 'binary_specificity': 0.9933365, 'binary_f1_score': 0.8291055}
confusion matrix:
       0     1
0  42038   282
1    230  1242
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.8902358, 'recall': 0.89433193, 'specificity': 0.89433193, 'f1': 0.8922722, 'auroc': 0.98090905, 'binary_precision': 0.7876923, 'binary_recall': 0.7962675, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.79195666}
confusion matrix:
       0    1
0  18011  138
1    131  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8841443, 'recall': 0.5701309, 'specificity': 0.5701309, 'f1': 0.610979, 'auroc': 0.92729926, 'binary_precision': 0.8043478, 'binary_recall': 0.14176245, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.24104235}
confusion matrix:
      0   1
0  5988   9
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_12.png
better model found
persisted
after epoch: 12,now: 2024-06-06 05:15:06.764186,epoch time: 0:31:40.403388,used: 6:22:59.342988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98636734, 'precision': 0.9593574, 'recall': 0.8201648, 'specificity': 0.8201648, 'f1': 0.87646806, 'auroc': 0.9915991, 'binary_precision': 0.9310345, 'binary_recall': 0.6419837, 'binary_specificity': 0.9983459, 'binary_f1_score': 0.7599517}
confusion matrix:
       0    1
0  42250   70
1    527  945
---- Validation: 
scalar performance:
{'acc': 0.98243934, 'precision': 0.9402467, 'recall': 0.7741426, 'specificity': 0.7741426, 'f1': 0.83652556, 'auroc': 0.9805171, 'binary_precision': 0.8962025, 'binary_recall': 0.5505443, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.6820809}
confusion matrix:
       0    1
0  18108   41
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.8803623, 'recall': 0.53031784, 'specificity': 0.53031784, 'f1': 0.5467638, 'auroc': 0.91813546, 'binary_precision': 0.8, 'binary_recall': 0.06130268, 'binary_specificity': 0.999333, 'binary_f1_score': 0.11387901}
confusion matrix:
      0   1
0  5993   4
1   245  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_13.png
early stop counter: 1
val acc:0.9824393391609192, best validation acc: 0.985685408115387, corresponding to test acc:                         0.9627676606178284 / 0.9685202836990356
after epoch: 13,now: 2024-06-06 05:46:47.606023,epoch time: 0:31:40.841837,used: 6:54:40.184825,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.985865, 'precision': 0.90620303, 'recall': 0.86744446, 'specificity': 0.86744446, 'f1': 0.8857744, 'auroc': 0.9913188, 'binary_precision': 0.82140166, 'binary_recall': 0.7404891, 'binary_specificity': 0.9943998, 'binary_f1_score': 0.77884954}
confusion matrix:
       0     1
0  42083   237
1    382  1090
---- Validation: 
scalar performance:
{'acc': 0.9823861, 'precision': 0.88952434, 'recall': 0.8266189, 'specificity': 0.8266189, 'f1': 0.8550807, 'auroc': 0.97862005, 'binary_precision': 0.7910448, 'binary_recall': 0.65940905, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.7192536}
confusion matrix:
       0    1
0  18037  112
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.8862019, 'recall': 0.579626, 'specificity': 0.579626, 'f1': 0.62480235, 'auroc': 0.92948663, 'binary_precision': 0.8076923, 'binary_recall': 0.16091955, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.2683706}
confusion matrix:
      0   1
0  5987  10
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_14.png
early stop counter: 2
val acc:0.9823861122131348, best validation acc: 0.985685408115387, corresponding to test acc:                         0.9627676606178284 / 0.9685202836990356
after epoch: 14,now: 2024-06-06 06:18:31.540443,epoch time: 0:31:43.934420,used: 7:26:24.119245,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98970133, 'precision': 0.93137926, 'recall': 0.90614957, 'specificity': 0.90614957, 'f1': 0.91835433, 'auroc': 0.9936404, 'binary_precision': 0.86912507, 'binary_recall': 0.81657606, 'binary_specificity': 0.99572307, 'binary_f1_score': 0.8420315}
confusion matrix:
       0     1
0  42139   181
1    270  1202
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.91122204, 'recall': 0.87904906, 'specificity': 0.87904906, 'f1': 0.89442676, 'auroc': 0.98215866, 'binary_precision': 0.8307953, 'binary_recall': 0.7636081, 'binary_specificity': 0.99449, 'binary_f1_score': 0.79578614}
confusion matrix:
       0    1
0  18049  100
1    152  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.9004854, 'recall': 0.54939157, 'specificity': 0.54939157, 'f1': 0.57922435, 'auroc': 0.94069195, 'binary_precision': 0.83870965, 'binary_recall': 0.099616855, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.1780822}
confusion matrix:
      0   1
0  5992   5
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_15.png
better model found
persisted
after epoch: 15,now: 2024-06-06 06:50:31.119662,epoch time: 0:31:59.579219,used: 7:58:23.698464,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.989473, 'precision': 0.96537757, 'recall': 0.8660326, 'specificity': 0.8660326, 'f1': 0.9093435, 'auroc': 0.9929875, 'binary_precision': 0.9399478, 'binary_recall': 0.7336956, 'binary_specificity': 0.9983696, 'binary_f1_score': 0.82411295}
confusion matrix:
       0     1
0  42251    69
1    392  1080
---- Validation: 
scalar performance:
{'acc': 0.9856322, 'precision': 0.9495791, 'recall': 0.82004887, 'specificity': 0.82004887, 'f1': 0.87312496, 'auroc': 0.9806268, 'binary_precision': 0.9116998, 'binary_recall': 0.64230174, 'binary_specificity': 0.997796, 'binary_f1_score': 0.75364965}
confusion matrix:
       0    1
0  18109   40
1    230  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.88960725, 'recall': 0.5341493, 'specificity': 0.5341493, 'f1': 0.5535086, 'auroc': 0.9274757, 'binary_precision': 0.8181818, 'binary_recall': 0.06896552, 'binary_specificity': 0.999333, 'binary_f1_score': 0.12720849}
confusion matrix:
      0   1
0  5993   4
1   243  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_16.png
early stop counter: 1
val acc:0.9856321811676025, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9616490602493286 / 0.9685202836990356
after epoch: 16,now: 2024-06-06 07:22:26.944831,epoch time: 0:31:55.825169,used: 8:30:19.523633,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9905234, 'precision': 0.93196994, 'recall': 0.92034495, 'specificity': 0.92034495, 'f1': 0.9260719, 'auroc': 0.9956037, 'binary_precision': 0.8693222, 'binary_recall': 0.8451087, 'binary_specificity': 0.99558127, 'binary_f1_score': 0.85704446}
confusion matrix:
       0     1
0  42133   187
1    228  1244
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.9096687, 'recall': 0.87205064, 'specificity': 0.87205064, 'f1': 0.8898802, 'auroc': 0.9802155, 'binary_precision': 0.8281787, 'binary_recall': 0.7496112, 'binary_specificity': 0.99449, 'binary_f1_score': 0.7869388}
confusion matrix:
       0    1
0  18049  100
1    161  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8795425, 'recall': 0.56629944, 'specificity': 0.56629944, 'f1': 0.6051316, 'auroc': 0.92216814, 'binary_precision': 0.79545456, 'binary_recall': 0.13409962, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.2295082}
confusion matrix:
      0   1
0  5988   9
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_17.png
early stop counter: 2
val acc:0.9861111044883728, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9616490602493286 / 0.9685202836990356
after epoch: 17,now: 2024-06-06 07:54:20.782650,epoch time: 0:31:53.837819,used: 9:02:13.361452,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9911628, 'precision': 0.94426656, 'recall': 0.91586196, 'specificity': 0.91586196, 'f1': 0.9295589, 'auroc': 0.99559176, 'binary_precision': 0.89423776, 'binary_recall': 0.8351499, 'binary_specificity': 0.99657404, 'binary_f1_score': 0.86368436}
confusion matrix:
       0     1
0  42179   145
1    242  1226
---- Validation: 
scalar performance:
{'acc': 0.98722863, 'precision': 0.92275727, 'recall': 0.8756294, 'specificity': 0.8756294, 'f1': 0.8976909, 'auroc': 0.9806843, 'binary_precision': 0.85413, 'binary_recall': 0.755832, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.8019802}
confusion matrix:
       0    1
0  18066   83
1    157  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.9182507, 'recall': 0.53997976, 'specificity': 0.53997976, 'f1': 0.5637504, 'auroc': 0.8927171, 'binary_precision': 0.875, 'binary_recall': 0.08045977, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.14736843}
confusion matrix:
      0   1
0  5994   3
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_18.png
better model found
persisted
after epoch: 18,now: 2024-06-06 08:26:19.197910,epoch time: 0:31:58.415260,used: 9:34:11.776712,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9909116, 'precision': 0.9525408, 'recall': 0.9024483, 'specificity': 0.9024483, 'f1': 0.925916, 'auroc': 0.99587953, 'binary_precision': 0.91174215, 'binary_recall': 0.80761385, 'binary_specificity': 0.9972827, 'binary_f1_score': 0.8565248}
confusion matrix:
       0     1
0  42206   115
1    283  1188
---- Validation: 
scalar performance:
{'acc': 0.9868561, 'precision': 0.9360305, 'recall': 0.85368496, 'specificity': 0.85368496, 'f1': 0.8902355, 'auroc': 0.98188615, 'binary_precision': 0.8822394, 'binary_recall': 0.71073097, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.78725237}
confusion matrix:
       0    1
0  18088   61
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.92748797, 'recall': 0.5476426, 'specificity': 0.5476426, 'f1': 0.57673174, 'auroc': 0.92650366, 'binary_precision': 0.89285713, 'binary_recall': 0.09578544, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.17301038}
confusion matrix:
      0   1
0  5994   3
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_19.png
early stop counter: 1
val acc:0.9868561029434204, best validation acc: 0.9872286319732666, corresponding to test acc:                         0.9611697196960449 / 0.9685202836990356
after epoch: 19,now: 2024-06-06 08:58:22.590237,epoch time: 0:32:03.392327,used: 10:06:15.169039,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9913911, 'precision': 0.9307851, 'recall': 0.9378426, 'specificity': 0.9378426, 'f1': 0.9342829, 'auroc': 0.99627006, 'binary_precision': 0.8657315, 'binary_recall': 0.8804348, 'binary_specificity': 0.99525046, 'binary_f1_score': 0.8730213}
confusion matrix:
       0     1
0  42119   201
1    176  1296
---- Validation: 
scalar performance:
{'acc': 0.9886122, 'precision': 0.91840744, 'recall': 0.90709794, 'specificity': 0.90709794, 'f1': 0.91266876, 'auroc': 0.9826715, 'binary_precision': 0.8432, 'binary_recall': 0.81959563, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.8312303}
confusion matrix:
       0    1
0  18051   98
1    116  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.8745173, 'recall': 0.56246805, 'specificity': 0.56246805, 'f1': 0.5992082, 'auroc': 0.884784, 'binary_precision': 0.78571427, 'binary_recall': 0.12643678, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.21782179}
confusion matrix:
      0   1
0  5988   9
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_20.png
better model found
persisted
after epoch: 20,now: 2024-06-06 09:30:17.247705,epoch time: 0:31:54.657468,used: 10:38:09.826507,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9914596, 'precision': 0.9392466, 'recall': 0.92771447, 'specificity': 0.92771447, 'f1': 0.93339777, 'auroc': 0.9962075, 'binary_precision': 0.8833799, 'binary_recall': 0.859375, 'binary_specificity': 0.9960539, 'binary_f1_score': 0.87121207}
confusion matrix:
       0     1
0  42153   167
1    207  1265
---- Validation: 
scalar performance:
{'acc': 0.98781395, 'precision': 0.9204233, 'recall': 0.88943344, 'specificity': 0.88943344, 'f1': 0.9042871, 'auroc': 0.9832729, 'binary_precision': 0.8484849, 'binary_recall': 0.7838258, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.8148747}
confusion matrix:
       0    1
0  18059   90
1    139  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.8486262, 'recall': 0.52640307, 'specificity': 0.52640307, 'f1': 0.5397025, 'auroc': 0.9043361, 'binary_precision': 0.7368421, 'binary_recall': 0.053639848, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.1}
confusion matrix:
      0   1
0  5992   5
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_21.png
early stop counter: 1
val acc:0.9878139495849609, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 21,now: 2024-06-06 10:02:25.281041,epoch time: 0:32:08.033336,used: 11:10:17.859843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99120843, 'precision': 0.92574304, 'recall': 0.9416446, 'specificity': 0.9416446, 'f1': 0.9335361, 'auroc': 0.996691, 'binary_precision': 0.85536647, 'binary_recall': 0.88851124, 'binary_specificity': 0.994778, 'binary_f1_score': 0.87162393}
confusion matrix:
       0     1
0  42100   221
1    164  1307
---- Validation: 
scalar performance:
{'acc': 0.9882929, 'precision': 0.91748345, 'recall': 0.9024323, 'specificity': 0.9024323, 'f1': 0.9098083, 'auroc': 0.98461974, 'binary_precision': 0.8416801, 'binary_recall': 0.8102644, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.8256735}
confusion matrix:
       0    1
0  18051   98
1    122  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8545854, 'recall': 0.57171303, 'specificity': 0.57171303, 'f1': 0.61212593, 'auroc': 0.9096745, 'binary_precision': 0.74509805, 'binary_recall': 0.14559387, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.24358973}
confusion matrix:
      0   1
0  5984  13
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_22.png
early stop counter: 2
val acc:0.9882928729057312, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 22,now: 2024-06-06 10:34:19.059106,epoch time: 0:31:53.778065,used: 11:42:11.637908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98913044, 'precision': 0.89201975, 'recall': 0.959951, 'specificity': 0.959951, 'f1': 0.923036, 'auroc': 0.9965098, 'binary_precision': 0.7865363, 'binary_recall': 0.9286685, 'binary_specificity': 0.99123347, 'binary_f1_score': 0.8517134}
confusion matrix:
       0     1
0  41949   371
1    105  1367
---- Validation: 
scalar performance:
{'acc': 0.9837697, 'precision': 0.8610282, 'recall': 0.9143416, 'specificity': 0.9143416, 'f1': 0.8856789, 'auroc': 0.9839516, 'binary_precision': 0.7277628, 'binary_recall': 0.83981335, 'binary_specificity': 0.9888699, 'binary_f1_score': 0.7797834}
confusion matrix:
       0    1
0  17947  202
1    103  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8159287, 'recall': 0.6255177, 'specificity': 0.6255177, 'f1': 0.6757032, 'auroc': 0.91942745, 'binary_precision': 0.6633663, 'binary_recall': 0.256705, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.37016574}
confusion matrix:
      0   1
0  5963  34
1   194  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_23.png
early stop counter: 3
val acc:0.9837697148323059, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 23,now: 2024-06-06 11:06:39.814067,epoch time: 0:32:20.754961,used: 12:14:32.392869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99152815, 'precision': 0.97139984, 'recall': 0.89390886, 'specificity': 0.89390886, 'f1': 0.92893255, 'auroc': 0.9973434, 'binary_precision': 0.9500818, 'binary_recall': 0.789259, 'binary_specificity': 0.99855864, 'binary_f1_score': 0.8622354}
confusion matrix:
       0     1
0  42260    61
1    310  1161
---- Validation: 
scalar performance:
{'acc': 0.9856322, 'precision': 0.9504654, 'recall': 0.8192988, 'specificity': 0.8192988, 'f1': 0.8729, 'auroc': 0.983484, 'binary_precision': 0.9135255, 'binary_recall': 0.6407465, 'binary_specificity': 0.99785113, 'binary_f1_score': 0.7531993}
confusion matrix:
       0    1
0  18110   39
1    231  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.86909723, 'recall': 0.52648646, 'specificity': 0.52648646, 'f1': 0.5399234, 'auroc': 0.90070915, 'binary_precision': 0.7777778, 'binary_recall': 0.053639848, 'binary_specificity': 0.999333, 'binary_f1_score': 0.100358434}
confusion matrix:
      0   1
0  5993   4
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_24.png
early stop counter: 4
val acc:0.9856321811676025, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 24,now: 2024-06-06 11:41:08.800385,epoch time: 0:34:28.986318,used: 12:49:01.379187,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99148244, 'precision': 0.92518735, 'recall': 0.94772565, 'specificity': 0.94772565, 'f1': 0.9361415, 'auroc': 0.9975312, 'binary_precision': 0.8538313, 'binary_recall': 0.9008152, 'binary_specificity': 0.9946361, 'binary_f1_score': 0.87669414}
confusion matrix:
       0     1
0  42093   227
1    146  1326
---- Validation: 
scalar performance:
{'acc': 0.98813325, 'precision': 0.9134181, 'recall': 0.90534985, 'specificity': 0.90534985, 'f1': 0.909341, 'auroc': 0.9832773, 'binary_precision': 0.8333333, 'binary_recall': 0.8164852, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.82482326}
confusion matrix:
       0    1
0  18044  105
1    118  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8073467, 'recall': 0.53181666, 'specificity': 0.53181666, 'f1': 0.5488892, 'auroc': 0.866814, 'binary_precision': 0.65384614, 'binary_recall': 0.0651341, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.11846689}
confusion matrix:
      0   1
0  5988   9
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_25.png
early stop counter: 5
val acc:0.9881332516670227, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 25,now: 2024-06-06 12:13:05.208094,epoch time: 0:31:56.407709,used: 13:20:57.786896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99120843, 'precision': 0.9528273, 'recall': 0.9071951, 'specificity': 0.9071951, 'f1': 0.9287087, 'auroc': 0.9975013, 'binary_precision': 0.91198784, 'binary_recall': 0.8171312, 'binary_specificity': 0.997259, 'binary_f1_score': 0.8619577}
confusion matrix:
       0     1
0  42205   116
1    269  1202
---- Validation: 
scalar performance:
{'acc': 0.98781395, 'precision': 0.94876313, 'recall': 0.8571811, 'specificity': 0.8571811, 'f1': 0.8973785, 'auroc': 0.9810322, 'binary_precision': 0.9074803, 'binary_recall': 0.7169518, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.80104256}
confusion matrix:
       0    1
0  18102   47
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.97983676, 'recall': 0.51724136, 'specificity': 0.51724136, 'f1': 0.5230443, 'auroc': 0.88088757, 'binary_precision': 1.0, 'binary_recall': 0.03448276, 'binary_specificity': 1.0, 'binary_f1_score': 0.06666667}
confusion matrix:
      0  1
0  5997  0
1   252  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_26.png
early stop counter: 6
val acc:0.9878139495849609, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 26,now: 2024-06-06 12:44:55.920150,epoch time: 0:31:50.712056,used: 13:52:48.498952,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99276125, 'precision': 0.9658296, 'recall': 0.9195357, 'specificity': 0.9195357, 'f1': 0.9413817, 'auroc': 0.99764395, 'binary_precision': 0.93716884, 'binary_recall': 0.8410326, 'binary_specificity': 0.99803877, 'binary_f1_score': 0.886502}
confusion matrix:
       0     1
0  42237    83
1    234  1238
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.93753314, 'recall': 0.8429086, 'specificity': 0.8429086, 'f1': 0.88405025, 'auroc': 0.9827011, 'binary_precision': 0.886, 'binary_recall': 0.688958, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.7751531}
confusion matrix:
       0    1
0  18092   57
1    200  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.9468845, 'recall': 0.52673656, 'specificity': 0.52673656, 'f1': 0.5405939, 'auroc': 0.8788008, 'binary_precision': 0.93333334, 'binary_recall': 0.053639848, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.10144928}
confusion matrix:
      0   1
0  5996   1
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_27.png
early stop counter: 7
val acc:0.9863239526748657, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 27,now: 2024-06-06 13:16:58.137495,epoch time: 0:32:02.217345,used: 14:24:50.716297,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9918478, 'precision': 0.9715135, 'recall': 0.8990637, 'specificity': 0.8990637, 'f1': 0.932054, 'auroc': 0.9975605, 'binary_precision': 0.94995964, 'binary_recall': 0.7995924, 'binary_specificity': 0.998535, 'binary_f1_score': 0.86831427}
confusion matrix:
       0     1
0  42258    62
1    295  1177
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.95512176, 'recall': 0.823297, 'specificity': 0.823297, 'f1': 0.8772455, 'auroc': 0.9845233, 'binary_precision': 0.92256635, 'binary_recall': 0.64852256, 'binary_specificity': 0.9980715, 'binary_f1_score': 0.7616438}
confusion matrix:
       0    1
0  18114   35
1    226  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8965738, 'recall': 0.51899034, 'specificity': 0.51899034, 'f1': 0.5262976, 'auroc': 0.8789325, 'binary_precision': 0.8333333, 'binary_recall': 0.038314175, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.07326008}
confusion matrix:
      0   1
0  5995   2
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_28.png
early stop counter: 8
val acc:0.9861111044883728, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 28,now: 2024-06-06 13:49:00.653896,epoch time: 0:32:02.516401,used: 14:56:53.232698,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9931266, 'precision': 0.93954563, 'recall': 0.95710063, 'specificity': 0.95710063, 'f1': 0.9481374, 'auroc': 0.99831474, 'binary_precision': 0.8819308, 'binary_recall': 0.91847825, 'binary_specificity': 0.99572307, 'binary_f1_score': 0.89983356}
confusion matrix:
       0     1
0  42139   181
1    120  1352
---- Validation: 
scalar performance:
{'acc': 0.98738825, 'precision': 0.9076699, 'recall': 0.89971375, 'specificity': 0.89971375, 'f1': 0.90364933, 'auroc': 0.9846667, 'binary_precision': 0.82222223, 'binary_recall': 0.80559874, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.8138256}
confusion matrix:
       0    1
0  18037  112
1    125  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.87894416, 'recall': 0.55872, 'specificity': 0.55872, 'f1': 0.59359205, 'auroc': 0.9138557, 'binary_precision': 0.7948718, 'binary_recall': 0.118773945, 'binary_specificity': 0.998666, 'binary_f1_score': 0.20666666}
confusion matrix:
      0   1
0  5989   8
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_29.png
early stop counter: 9
val acc:0.9873882532119751, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 29,now: 2024-06-06 14:21:08.481586,epoch time: 0:32:07.827690,used: 15:29:01.060388,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9938573, 'precision': 0.95580363, 'recall': 0.9489207, 'specificity': 0.9489207, 'f1': 0.9523339, 'auroc': 0.9983237, 'binary_precision': 0.9150553, 'binary_recall': 0.9007478, 'binary_specificity': 0.9970936, 'binary_f1_score': 0.90784514}
confusion matrix:
       0     1
0  42198   123
1    146  1325
---- Validation: 
scalar performance:
{'acc': 0.98648363, 'precision': 0.9187436, 'recall': 0.86699307, 'specificity': 0.86699307, 'f1': 0.89102733, 'auroc': 0.9831647, 'binary_precision': 0.84670234, 'binary_recall': 0.7387247, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.7890365}
confusion matrix:
       0    1
0  18063   86
1    168  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8211849, 'recall': 0.528152, 'specificity': 0.528152, 'f1': 0.5426627, 'auroc': 0.88913935, 'binary_precision': 0.6818182, 'binary_recall': 0.057471264, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.10600707}
confusion matrix:
      0   1
0  5990   7
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_30.png
early stop counter: 10
val acc:0.986483633518219, best validation acc: 0.988612174987793, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 30,now: 2024-06-06 14:53:17.759472,epoch time: 0:32:09.277886,used: 16:01:10.338274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 16:01:10.338274 at 2024-06-06 14:53:17.759472
persisted model performance metric: 

scalar performance:
{'acc': 0.96244806, 'precision': 0.9026443, 'recall': 0.5608024, 'specificity': 0.5608024, 'f1': 0.5974057, 'auroc': 0.8960607, 'binary_precision': 0.84210527, 'binary_recall': 0.12260536, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.21404682}
confusion matrix:
      0   1
0  5991   6
1   229  32
oracle model performance metric: 

scalar performance:
{'acc': 0.9701182, 'precision': 0.88835704, 'recall': 0.68573844, 'specificity': 0.68573844, 'f1': 0.7481684, 'auroc': 0.9294801, 'binary_precision': 0.8032787, 'binary_recall': 0.37547892, 'binary_specificity': 0.995998, 'binary_f1_score': 0.5117493}
confusion matrix:
      0   1
0  5973  24
1   163  98
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1659 MiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |   1652 MiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1659 MiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |   1652 MiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |   1037 TiB |   1037 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   1024 TiB |   1024 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16628 MiB |  16628 MiB |  16628 MiB |      0 B   |
|       from large pool |  16600 MiB |  16600 MiB |  16600 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 436974 KiB |    850 MiB | 463465 GiB | 463464 GiB |
|       from large pool | 417040 KiB |    849 MiB | 450564 GiB | 450564 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12900 GiB |  12900 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  152224 K  |  152220 K  |
|       from large pool |     247    |     989    |   61967 K  |   61967 K  |
|       from small pool |    3119    |    6108    |   90256 K  |   90253 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  152224 K  |  152220 K  |
|       from large pool |     247    |     989    |   61967 K  |   61967 K  |
|       from small pool |    3119    |    6108    |   90256 K  |   90253 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     617    |     617    |     617    |       0    |
|       from large pool |     603    |     603    |     603    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     151    |    2873    |   87566 K  |   87566 K  |
|       from large pool |     112    |     508    |   45005 K  |   45005 K  |
|       from small pool |      39    |    2760    |   42561 K  |   42561 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  16640 KiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  16640 KiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1037 TiB |   1037 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1024 TiB |   1024 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2086 MiB |  16628 MiB |  16628 MiB |  14542 MiB |
|       from large pool |   2060 MiB |  16600 MiB |  16600 MiB |  14540 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    850 MiB | 463466 GiB | 463466 GiB |
|       from large pool |  24320 KiB |    849 MiB | 450565 GiB | 450565 GiB |
|       from small pool |      0 KiB |     25 MiB |  12900 GiB |  12900 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   61967 K  |   61967 K  |
|       from small pool |       0    |    6108    |   90256 K  |   90256 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   61967 K  |   61967 K  |
|       from small pool |       0    |    6108    |   90256 K  |   90256 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     617    |     617    |     501    |
|       from large pool |     103    |     603    |     603    |     500    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |   87568 K  |   87568 K  |
|       from large pool |       2    |     508    |   45005 K  |   45005 K  |
|       from small pool |       0    |    2760    |   42562 K  |   42562 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  16640 KiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15802 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  16640 KiB |  15777 MiB |   1028 TiB |   1028 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1037 TiB |   1037 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1024 TiB |   1024 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2086 MiB |  16628 MiB |  16628 MiB |  14542 MiB |
|       from large pool |   2060 MiB |  16600 MiB |  16600 MiB |  14540 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    850 MiB | 463466 GiB | 463466 GiB |
|       from large pool |  24320 KiB |    849 MiB | 450565 GiB | 450565 GiB |
|       from small pool |      0 KiB |     25 MiB |  12900 GiB |  12900 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   61967 K  |   61967 K  |
|       from small pool |       0    |    6108    |   90256 K  |   90256 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152224 K  |  152224 K  |
|       from large pool |       2    |     989    |   61967 K  |   61967 K  |
|       from small pool |       0    |    6108    |   90256 K  |   90256 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     617    |     617    |     501    |
|       from large pool |     103    |     603    |     603    |     500    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |   87568 K  |   87568 K  |
|       from large pool |       2    |     508    |   45005 K  |   45005 K  |
|       from small pool |       0    |    2760    |   42562 K  |   42562 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_15_04_46_seed_1_21127989

 Experiment start at: 2024-06-06 15:04:46.118482
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.06461489200592041
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97129244, 'precision': 0.814229, 'recall': 0.6331236, 'specificity': 0.6331236, 'f1': 0.6842249, 'auroc': 0.94385344, 'binary_precision': 0.6527546, 'binary_recall': 0.27115119, 'binary_specificity': 0.99509597, 'binary_f1_score': 0.38314554}
confusion matrix:
       0    1
0  42206  208
1   1051  391
---- Validation: 
scalar performance:
{'acc': 0.96963716, 'precision': 0.8228066, 'recall': 0.6487927, 'specificity': 0.6487927, 'f1': 0.70100856, 'auroc': 0.94532377, 'binary_precision': 0.67105263, 'binary_recall': 0.30312034, 'binary_specificity': 0.99446505, 'binary_f1_score': 0.4176049}
confusion matrix:
       0    1
0  17967  100
1    469  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.7021543, 'recall': 0.5218156, 'specificity': 0.5218156, 'f1': 0.53096646, 'auroc': 0.93344295, 'binary_precision': 0.44444445, 'binary_recall': 0.046153847, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.08362369}
confusion matrix:
      0   1
0  5931  15
1   248  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-06 15:38:19.917917,epoch time: 0:33:33.799435,used: 0:33:33.799435,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_15_04_46_seed_1_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97521436, 'precision': 0.83944345, 'recall': 0.7138649, 'specificity': 0.7138649, 'f1': 0.7612695, 'auroc': 0.95951575, 'binary_precision': 0.6978818, 'binary_recall': 0.43411928, 'binary_specificity': 0.9936106, 'binary_f1_score': 0.5352714}
confusion matrix:
       0    1
0  42143  271
1    816  626
---- Validation: 
scalar performance:
{'acc': 0.9723586, 'precision': 0.8382051, 'recall': 0.69955754, 'specificity': 0.69955754, 'f1': 0.74946666, 'auroc': 0.96142745, 'binary_precision': 0.6982097, 'binary_recall': 0.40564635, 'binary_specificity': 0.99346876, 'binary_f1_score': 0.5131579}
confusion matrix:
       0    1
0  17949  118
1    400  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.83180004, 'recall': 0.599989, 'specificity': 0.599989, 'f1': 0.64821506, 'auroc': 0.939469, 'binary_precision': 0.69736844, 'binary_recall': 0.20384616, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.31547618}
confusion matrix:
      0   1
0  5923  23
1   207  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-06 16:10:22.554312,epoch time: 0:32:02.636395,used: 1:05:36.435830,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_15_04_46_seed_1_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9784066, 'precision': 0.85564387, 'recall': 0.7717873, 'specificity': 0.7717873, 'f1': 0.80765593, 'auroc': 0.9710851, 'binary_precision': 0.72644097, 'binary_recall': 0.55062413, 'binary_specificity': 0.99295044, 'binary_f1_score': 0.62643}
confusion matrix:
       0    1
0  42115  299
1    648  794
---- Validation: 
scalar performance:
{'acc': 0.975667, 'precision': 0.86861473, 'recall': 0.73489094, 'specificity': 0.73489094, 'f1': 0.78570426, 'auroc': 0.9708121, 'binary_precision': 0.7565012, 'binary_recall': 0.4754829, 'binary_specificity': 0.994299, 'binary_f1_score': 0.5839416}
confusion matrix:
       0    1
0  17964  103
1    353  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.823401, 'recall': 0.5847726, 'specificity': 0.5847726, 'f1': 0.6282735, 'auroc': 0.94270647, 'binary_precision': 0.6818182, 'binary_recall': 0.17307693, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.27607363}
confusion matrix:
      0   1
0  5925  21
1   215  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_3.png
better model found
persisted
after epoch: 3,now: 2024-06-06 16:42:33.795472,epoch time: 0:32:11.241160,used: 1:37:47.676990,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_15_04_46_seed_1_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97671926, 'precision': 0.92339814, 'recall': 0.6710992, 'specificity': 0.6710992, 'f1': 0.7404415, 'auroc': 0.97487414, 'binary_precision': 0.8686515, 'binary_recall': 0.34396672, 'binary_specificity': 0.9982317, 'binary_f1_score': 0.49279684}
confusion matrix:
       0    1
0  42339   75
1    946  496
---- Validation: 
scalar performance:
{'acc': 0.971238, 'precision': 0.9107311, 'recall': 0.62029696, 'specificity': 0.62029696, 'f1': 0.6810789, 'auroc': 0.9724264, 'binary_precision': 0.8489583, 'binary_recall': 0.24219911, 'binary_specificity': 0.99839485, 'binary_f1_score': 0.37687862}
confusion matrix:
       0    1
0  18038   29
1    510  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.89189076, 'recall': 0.5266708, 'specificity': 0.5266708, 'f1': 0.5402819, 'auroc': 0.9511963, 'binary_precision': 0.8235294, 'binary_recall': 0.053846154, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.10108303}
confusion matrix:
      0   1
0  5943   3
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_4.png
early stop counter: 1
val acc:0.9712380170822144, best validation acc: 0.9756669998168945, corresponding to test acc:                         0.9619722962379456 / 0.9629390835762024
after epoch: 4,now: 2024-06-06 17:14:41.085409,epoch time: 0:32:07.289937,used: 2:09:54.966927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_15_04_46_seed_1_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9762632, 'precision': 0.7983333, 'recall': 0.89762604, 'specificity': 0.89762604, 'f1': 0.8401516, 'auroc': 0.9787768, 'binary_precision': 0.60308486, 'binary_recall': 0.81345356, 'binary_specificity': 0.98179847, 'binary_f1_score': 0.69264835}
confusion matrix:
       0     1
0  41642   772
1    269  1173
---- Validation: 
scalar performance:
{'acc': 0.9774813, 'precision': 0.82441103, 'recall': 0.88246167, 'specificity': 0.88246167, 'f1': 0.85079783, 'auroc': 0.97586584, 'binary_precision': 0.65707135, 'binary_recall': 0.78008914, 'binary_specificity': 0.98483425, 'binary_f1_score': 0.71331525}
confusion matrix:
       0    1
0  17793  274
1    148  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.82569075, 'recall': 0.6450497, 'specificity': 0.6450497, 'f1': 0.6973389, 'auroc': 0.9498404, 'binary_precision': 0.6814159, 'binary_recall': 0.29615384, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.41286862}
confusion matrix:
      0   1
0  5910  36
1   183  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-06 17:47:13.317486,epoch time: 0:32:32.232077,used: 2:42:27.199004,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_15_04_46_seed_1_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9809376, 'precision': 0.92403543, 'recall': 0.74746525, 'specificity': 0.74746525, 'f1': 0.81096685, 'auroc': 0.9811945, 'binary_precision': 0.8648975, 'binary_recall': 0.49757114, 'binary_specificity': 0.9973594, 'binary_f1_score': 0.6317181}
confusion matrix:
       0    1
0  42303  112
1    724  717
---- Validation: 
scalar performance:
{'acc': 0.9757204, 'precision': 0.9136094, 'recall': 0.69557893, 'specificity': 0.69557893, 'f1': 0.76280177, 'auroc': 0.9767442, 'binary_precision': 0.849359, 'binary_recall': 0.39375928, 'binary_specificity': 0.99739856, 'binary_f1_score': 0.53807104}
confusion matrix:
       0    1
0  18020   47
1    408  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.8551972, 'recall': 0.5284257, 'specificity': 0.5284257, 'f1': 0.5432681, 'auroc': 0.94736505, 'binary_precision': 0.75, 'binary_recall': 0.057692308, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.107142866}
confusion matrix:
      0   1
0  5941   5
1   245  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_6.png
early stop counter: 1
val acc:0.9757204055786133, best validation acc: 0.9774813055992126, corresponding to test acc:                         0.9647115468978882 / 0.9647115468978882
after epoch: 6,now: 2024-06-06 18:19:37.295094,epoch time: 0:32:23.977608,used: 3:14:51.176612,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_15_04_46_seed_1_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98283017, 'precision': 0.85968137, 'recall': 0.87723947, 'specificity': 0.87723947, 'f1': 0.8682328, 'auroc': 0.98263943, 'binary_precision': 0.72739273, 'binary_recall': 0.76421636, 'binary_specificity': 0.9902626, 'binary_f1_score': 0.74535}
confusion matrix:
       0     1
0  42001   413
1    340  1102
---- Validation: 
scalar performance:
{'acc': 0.9810032, 'precision': 0.88157785, 'recall': 0.8277821, 'specificity': 0.8277821, 'f1': 0.852459, 'auroc': 0.9779782, 'binary_precision': 0.77565217, 'binary_recall': 0.6627043, 'binary_specificity': 0.9928599, 'binary_f1_score': 0.7147436}
confusion matrix:
       0    1
0  17938  129
1    227  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.88450956, 'recall': 0.53996414, 'specificity': 0.53996414, 'f1': 0.5633656, 'auroc': 0.9515094, 'binary_precision': 0.8076923, 'binary_recall': 0.08076923, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.14685315}
confusion matrix:
      0   1
0  5941   5
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_7.png
better model found
persisted
after epoch: 7,now: 2024-06-06 18:52:01.966570,epoch time: 0:32:24.671476,used: 3:47:15.848088,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_15_04_46_seed_1_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98381066, 'precision': 0.9438689, 'recall': 0.7836249, 'specificity': 0.7836249, 'f1': 0.8449058, 'auroc': 0.98696923, 'binary_precision': 0.9021978, 'binary_recall': 0.56934816, 'binary_specificity': 0.9979016, 'binary_f1_score': 0.6981293}
confusion matrix:
       0    1
0  42325   89
1    621  821
---- Validation: 
scalar performance:
{'acc': 0.9778015, 'precision': 0.94603765, 'recall': 0.71024835, 'specificity': 0.71024835, 'f1': 0.7829187, 'auroc': 0.9800395, 'binary_precision': 0.9131833, 'binary_recall': 0.42199108, 'binary_specificity': 0.9985056, 'binary_f1_score': 0.5772358}
confusion matrix:
       0    1
0  18040   27
1    389  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9525874, 'recall': 0.5326082, 'specificity': 0.5326082, 'f1': 0.5510967, 'auroc': 0.94715285, 'binary_precision': 0.9444444, 'binary_recall': 0.06538462, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.12230216}
confusion matrix:
      0   1
0  5945   1
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_8.png
early stop counter: 1
val acc:0.977801501750946, best validation acc: 0.9810032248497009, corresponding to test acc:                         0.9606832265853882 / 0.9647115468978882
after epoch: 8,now: 2024-06-06 19:24:06.821873,epoch time: 0:32:04.855303,used: 4:19:20.703391,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_15_04_46_seed_1_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9824197, 'precision': 0.96315277, 'recall': 0.7470659, 'specificity': 0.7470659, 'f1': 0.82018495, 'auroc': 0.98832786, 'binary_precision': 0.94319683, 'binary_recall': 0.49514562, 'binary_specificity': 0.9989862, 'binary_f1_score': 0.64938605}
confusion matrix:
       0    1
0  42371   43
1    728  714
---- Validation: 
scalar performance:
{'acc': 0.9760939, 'precision': 0.95718515, 'recall': 0.6786062, 'specificity': 0.6786062, 'f1': 0.75301117, 'auroc': 0.97910994, 'binary_precision': 0.9377432, 'binary_recall': 0.35809806, 'binary_specificity': 0.9991144, 'binary_f1_score': 0.51827955}
confusion matrix:
       0    1
0  18051   16
1    432  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.93823326, 'recall': 0.52106977, 'specificity': 0.52106977, 'f1': 0.5301446, 'auroc': 0.9442018, 'binary_precision': 0.9166667, 'binary_recall': 0.042307694, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.080882356}
confusion matrix:
      0   1
0  5945   1
1   249  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_9.png
early stop counter: 2
val acc:0.9760938882827759, best validation acc: 0.9810032248497009, corresponding to test acc:                         0.9606832265853882 / 0.9647115468978882
after epoch: 9,now: 2024-06-06 19:56:24.362448,epoch time: 0:32:17.540575,used: 4:51:38.243966,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_15_04_46_seed_1_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98570323, 'precision': 0.9195988, 'recall': 0.84121025, 'specificity': 0.84121025, 'f1': 0.8760631, 'auroc': 0.9877304, 'binary_precision': 0.8497854, 'binary_recall': 0.68654644, 'binary_specificity': 0.995874, 'binary_f1_score': 0.7594936}
confusion matrix:
       0    1
0  42239  175
1    452  990
---- Validation: 
scalar performance:
{'acc': 0.982444, 'precision': 0.91251755, 'recall': 0.814224, 'specificity': 0.814224, 'f1': 0.8561795, 'auroc': 0.9805536, 'binary_precision': 0.8385827, 'binary_recall': 0.6329866, 'binary_specificity': 0.99546134, 'binary_f1_score': 0.7214225}
confusion matrix:
       0    1
0  17985   82
1    247  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.9371946, 'recall': 0.54021645, 'specificity': 0.54021645, 'f1': 0.5642701, 'auroc': 0.94589055, 'binary_precision': 0.9130435, 'binary_recall': 0.08076923, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.1484099}
confusion matrix:
      0   1
0  5944   2
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_10.png
better model found
persisted
after epoch: 10,now: 2024-06-06 20:28:35.376890,epoch time: 0:32:11.014442,used: 5:23:49.258408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_15_04_46_seed_1_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9869573, 'precision': 0.921681, 'recall': 0.8626256, 'specificity': 0.8626256, 'f1': 0.88976085, 'auroc': 0.9901682, 'binary_precision': 0.8525122, 'binary_recall': 0.7295423, 'binary_specificity': 0.99570894, 'binary_f1_score': 0.78624815}
confusion matrix:
       0     1
0  42232   182
1    390  1052
---- Validation: 
scalar performance:
{'acc': 0.98180366, 'precision': 0.9267353, 'recall': 0.7888575, 'specificity': 0.7888575, 'f1': 0.8434849, 'auroc': 0.9809794, 'binary_precision': 0.8688889, 'binary_recall': 0.58098066, 'binary_specificity': 0.9967344, 'binary_f1_score': 0.696349}
confusion matrix:
       0    1
0  18008   59
1    282  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.95999813, 'recall': 0.54414666, 'specificity': 0.54414666, 'f1': 0.5711739, 'auroc': 0.946803, 'binary_precision': 0.9583333, 'binary_recall': 0.08846154, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.16197182}
confusion matrix:
      0   1
0  5945   1
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_11.png
early stop counter: 1
val acc:0.9818036556243896, best validation acc: 0.9824439883232117, corresponding to test acc:                         0.9611666202545166 / 0.9647115468978882
after epoch: 11,now: 2024-06-06 21:00:38.792274,epoch time: 0:32:03.415384,used: 5:55:52.673792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_15_04_46_seed_1_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98615927, 'precision': 0.9540624, 'recall': 0.8159896, 'specificity': 0.8159896, 'f1': 0.8718003, 'auroc': 0.9912955, 'binary_precision': 0.9204431, 'binary_recall': 0.6338419, 'binary_specificity': 0.9981374, 'binary_f1_score': 0.75071865}
confusion matrix:
       0    1
0  42335   79
1    528  914
---- Validation: 
scalar performance:
{'acc': 0.9796158, 'precision': 0.9420834, 'recall': 0.7412305, 'specificity': 0.7412305, 'f1': 0.8100399, 'auroc': 0.98105145, 'binary_precision': 0.9030471, 'binary_recall': 0.48439822, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.63056093}
confusion matrix:
       0    1
0  18032   35
1    347  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.91201234, 'recall': 0.5477406, 'specificity': 0.5477406, 'f1': 0.5766479, 'auroc': 0.9411073, 'binary_precision': 0.86206895, 'binary_recall': 0.09615385, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.17301038}
confusion matrix:
      0   1
0  5942   4
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_12.png
early stop counter: 2
val acc:0.9796158075332642, best validation acc: 0.9824439883232117, corresponding to test acc:                         0.9611666202545166 / 0.9647115468978882
after epoch: 12,now: 2024-06-06 21:32:35.490798,epoch time: 0:31:56.698524,used: 6:27:49.372316,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_15_04_46_seed_1_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98907787, 'precision': 0.9169322, 'recall': 0.90994537, 'specificity': 0.90994537, 'f1': 0.9134069, 'auroc': 0.9924717, 'binary_precision': 0.8398024, 'binary_recall': 0.8252427, 'binary_specificity': 0.994648, 'binary_f1_score': 0.8324589}
confusion matrix:
       0     1
0  42187   227
1    252  1190
---- Validation: 
scalar performance:
{'acc': 0.9851654, 'precision': 0.91159415, 'recall': 0.86427355, 'specificity': 0.86427355, 'f1': 0.8863671, 'auroc': 0.98362124, 'binary_precision': 0.8330523, 'binary_recall': 0.73402673, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.7804107}
confusion matrix:
       0    1
0  17968   99
1    179  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.9646319, 'recall': 0.5556851, 'specificity': 0.5556851, 'f1': 0.5904306, 'auroc': 0.9521992, 'binary_precision': 0.96666664, 'binary_recall': 0.11153846, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.2}
confusion matrix:
      0   1
0  5945   1
1   231  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_13.png
better model found
persisted
after epoch: 13,now: 2024-06-06 22:04:32.803868,epoch time: 0:31:57.313070,used: 6:59:46.685386,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_15_04_46_seed_1_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9878238, 'precision': 0.9078763, 'recall': 0.8985785, 'specificity': 0.8985785, 'f1': 0.9031695, 'auroc': 0.9927609, 'binary_precision': 0.8224432, 'binary_recall': 0.8030513, 'binary_specificity': 0.9941057, 'binary_f1_score': 0.81263155}
confusion matrix:
       0     1
0  42164   250
1    284  1158
---- Validation: 
scalar performance:
{'acc': 0.9842049, 'precision': 0.89931846, 'recall': 0.86377543, 'specificity': 0.86377543, 'f1': 0.88064635, 'auroc': 0.9803854, 'binary_precision': 0.80851066, 'binary_recall': 0.73402673, 'binary_specificity': 0.99352413, 'binary_f1_score': 0.7694704}
confusion matrix:
       0    1
0  17950  117
1    179  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.98075676, 'recall': 0.5423077, 'specificity': 0.5423077, 'f1': 0.5682038, 'auroc': 0.9182094, 'binary_precision': 1.0, 'binary_recall': 0.08461539, 'binary_specificity': 1.0, 'binary_f1_score': 0.15602838}
confusion matrix:
      0   1
0  5946   0
1   238  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_14.png
early stop counter: 1
val acc:0.984204888343811, best validation acc: 0.9851654171943665, corresponding to test acc:                         0.9626168012619019 / 0.9647115468978882
after epoch: 14,now: 2024-06-06 22:36:32.548489,epoch time: 0:31:59.744621,used: 7:31:46.430007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_15_04_46_seed_1_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9894427, 'precision': 0.94675696, 'recall': 0.87965333, 'specificity': 0.87965333, 'f1': 0.9102807, 'auroc': 0.99309987, 'binary_precision': 0.90155864, 'binary_recall': 0.7621359, 'binary_specificity': 0.99717075, 'binary_f1_score': 0.8260052}
confusion matrix:
       0     1
0  42294   120
1    343  1099
---- Validation: 
scalar performance:
{'acc': 0.9838314, 'precision': 0.9256693, 'recall': 0.824242, 'specificity': 0.824242, 'f1': 0.8675452, 'auroc': 0.98284817, 'binary_precision': 0.86417323, 'binary_recall': 0.6523031, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.7434377}
confusion matrix:
       0    1
0  17998   69
1    234  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.96254635, 'recall': 0.5499159, 'specificity': 0.5499159, 'f1': 0.5809016, 'auroc': 0.9487343, 'binary_precision': 0.962963, 'binary_recall': 0.1, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.18118468}
confusion matrix:
      0   1
0  5945   1
1   234  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_15.png
early stop counter: 2
val acc:0.9838314056396484, best validation acc: 0.9851654171943665, corresponding to test acc:                         0.9626168012619019 / 0.9647115468978882
after epoch: 15,now: 2024-06-06 23:08:40.876989,epoch time: 0:32:08.328500,used: 8:03:54.758507,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_15_04_46_seed_1_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98946553, 'precision': 0.90952027, 'recall': 0.929238, 'specificity': 0.929238, 'f1': 0.9191284, 'auroc': 0.9940782, 'binary_precision': 0.82364595, 'binary_recall': 0.8647711, 'binary_specificity': 0.9937049, 'binary_f1_score': 0.8437077}
confusion matrix:
       0     1
0  42147   267
1    195  1247
---- Validation: 
scalar performance:
{'acc': 0.9851654, 'precision': 0.8997742, 'recall': 0.88144, 'specificity': 0.88144, 'f1': 0.89037275, 'auroc': 0.98308825, 'binary_precision': 0.8081123, 'binary_recall': 0.76968795, 'binary_specificity': 0.993192, 'binary_f1_score': 0.78843224}
confusion matrix:
       0    1
0  17944  123
1    155  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.89630485, 'recall': 0.564796, 'specificity': 0.564796, 'f1': 0.60333747, 'auroc': 0.9413053, 'binary_precision': 0.8292683, 'binary_recall': 0.13076924, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.22591363}
confusion matrix:
      0   1
0  5939   7
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_16.png
early stop counter: 3
val acc:0.9851654171943665, best validation acc: 0.9851654171943665, corresponding to test acc:                         0.9626168012619019 / 0.9647115468978882
after epoch: 16,now: 2024-06-06 23:40:54.183923,epoch time: 0:32:13.306934,used: 8:36:08.065441,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_15_04_46_seed_1_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98946553, 'precision': 0.9712219, 'recall': 0.85722333, 'specificity': 0.85722333, 'f1': 0.9058393, 'auroc': 0.9945392, 'binary_precision': 0.9520295, 'binary_recall': 0.7156727, 'binary_specificity': 0.998774, 'binary_f1_score': 0.81710213}
confusion matrix:
       0     1
0  42362    52
1    410  1032
---- Validation: 
scalar performance:
{'acc': 0.9836713, 'precision': 0.9488827, 'recall': 0.8005551, 'specificity': 0.8005551, 'f1': 0.8589408, 'auroc': 0.98230267, 'binary_precision': 0.91235954, 'binary_recall': 0.6032689, 'binary_specificity': 0.99784136, 'binary_f1_score': 0.72629696}
confusion matrix:
       0    1
0  18028   39
1    267  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.95901453, 'recall': 0.5422236, 'specificity': 0.5422236, 'f1': 0.5678861, 'auroc': 0.9315867, 'binary_precision': 0.95652175, 'binary_recall': 0.08461539, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.15547705}
confusion matrix:
      0   1
0  5945   1
1   238  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_17.png
early stop counter: 4
val acc:0.9836713075637817, best validation acc: 0.9851654171943665, corresponding to test acc:                         0.9626168012619019 / 0.9647115468978882
after epoch: 17,now: 2024-06-07 00:12:58.834310,epoch time: 0:32:04.650387,used: 9:08:12.715828,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_15_04_46_seed_1_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99142647, 'precision': 0.9472179, 'recall': 0.9141742, 'specificity': 0.9141742, 'f1': 0.9300145, 'auroc': 0.9952793, 'binary_precision': 0.9001502, 'binary_recall': 0.8314841, 'binary_specificity': 0.99686426, 'binary_f1_score': 0.8644557}
confusion matrix:
       0     1
0  42281   133
1    243  1199
---- Validation: 
scalar performance:
{'acc': 0.98564565, 'precision': 0.9295403, 'recall': 0.8509326, 'specificity': 0.8509326, 'f1': 0.8859544, 'auroc': 0.98322195, 'binary_precision': 0.86996335, 'binary_recall': 0.70579493, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.7793273}
confusion matrix:
       0    1
0  17996   71
1    198  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.9411421, 'recall': 0.5651323, 'specificity': 0.5651323, 'f1': 0.605027, 'auroc': 0.93126965, 'binary_precision': 0.9189189, 'binary_recall': 0.13076924, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.22895625}
confusion matrix:
      0   1
0  5943   3
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127989_18.png
better model found
persisted
after epoch: 18,now: 2024-06-07 00:45:02.237675,epoch time: 0:32:03.403365,used: 9:40:16.119193,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_15_04_46_seed_1_21127989
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9914037, 'precision': 0.9702363, 'recall': 0.89004576, 'specificity': 0.89004576, 'f1': 0.9261387, 'auroc': 0.9957334, 'binary_precision': 0.94785535, 'binary_recall': 0.7815534, 'binary_specificity': 0.9985382, 'binary_f1_score': 0.85670847}
confusion matrix:
       0     1
0  42352    62
1    315  1127
---- Validation: 
scalar performance:
{'acc': 0.98415154, 'precision': 0.9491123, 'recall': 0.80795693, 'specificity': 0.80795693, 'f1': 0.8643825, 'auroc': 0.9820879, 'binary_precision': 0.9122807, 'binary_recall': 0.61812776, 'binary_specificity': 0.99778605, 'binary_f1_score': 0.7369353}
confusion matrix:
       0    1
0  18027   40
1    257  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.98005813, 'recall': 0.525, 'specificity': 0.525, 'f1': 0.53744525, 'auroc': 0.9344732, 'binary_precision': 1.0, 'binary_recall': 0.05, 'binary_specificity': 1.0, 'binary_f1_score': 0.095238104}
confusion matrix:
      0   1
0  5946   0
1   247  13
slurmstepd: error: *** JOB 21127989 ON gpusrv16 CANCELLED AT 2024-06-07T01:15:27 ***
