Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jun 16 13:35:10 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390

 Experiment start at: 2024-06-16 13:46:55.148231
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.7236944, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.68612176, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.69962394, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-16 14:11:24.368398,epoch time: 0:24:29.220167,used: 0:24:29.220167,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96652967, 'precision': 0.7594019, 'recall': 0.5105625, 'specificity': 0.5105625, 'f1': 0.5123987, 'auroc': 0.86525613, 'binary_precision': 0.55172414, 'binary_recall': 0.02173913, 'binary_specificity': 0.9993858, 'binary_f1_score': 0.041830067}
confusion matrix:
       0   1
0  42302  26
1   1440  32
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.48289075, 'recall': 0.49997246, 'specificity': 0.49997246, 'f1': 0.4912832, 'auroc': 0.84506196, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18148  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8381012, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_2.png
early stop counter: 1
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-16 14:35:47.700992,epoch time: 0:24:23.332594,used: 0:48:52.552761,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96659815, 'precision': 0.7446971, 'recall': 0.5329038, 'specificity': 0.5329038, 'f1': 0.55162024, 'auroc': 0.8910674, 'binary_precision': 0.5208333, 'binary_recall': 0.06798097, 'binary_specificity': 0.9978266, 'binary_f1_score': 0.12026459}
confusion matrix:
       0    1
0  42237   92
1   1371  100
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.70181346, 'recall': 0.50519526, 'specificity': 0.50519526, 'f1': 0.5018883, 'auroc': 0.87896276, 'binary_precision': 0.4375, 'binary_recall': 0.01088647, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.021244312}
confusion matrix:
       0  1
0  18140  9
1    636  7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.97976, 'recall': 0.51532567, 'specificity': 0.51532567, 'f1': 0.5194107, 'auroc': 0.8640126, 'binary_precision': 1.0, 'binary_recall': 0.03065134, 'binary_specificity': 1.0, 'binary_f1_score': 0.059479553}
confusion matrix:
      0  1
0  5997  0
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_3.png
new oracle model saved
early stop counter: 2
val acc:0.9656769037246704, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9595717191696167
after epoch: 3,now: 2024-06-16 15:00:03.609275,epoch time: 0:24:15.908283,used: 1:13:08.461044,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96652967, 'precision': 0.73913014, 'recall': 0.5666267, 'specificity': 0.5666267, 'f1': 0.5998899, 'auroc': 0.8985729, 'binary_precision': 0.5075, 'binary_recall': 0.13790761, 'binary_specificity': 0.9953459, 'binary_f1_score': 0.21688034}
confusion matrix:
       0    1
0  42131  197
1   1269  203
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.7841011, 'recall': 0.5364435, 'specificity': 0.5364435, 'f1': 0.55788517, 'auroc': 0.89486957, 'binary_precision': 0.6, 'binary_recall': 0.07465008, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.13278009}
confusion matrix:
       0   1
0  18117  32
1    595  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.98160934, 'recall': 0.56130266, 'specificity': 0.56130266, 'f1': 0.59984744, 'auroc': 0.87596524, 'binary_precision': 1.0, 'binary_recall': 0.12260536, 'binary_specificity': 1.0, 'binary_f1_score': 0.21843004}
confusion matrix:
      0   1
0  5997   0
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-16 15:24:29.717772,epoch time: 0:24:26.108497,used: 1:37:34.569541,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96671236, 'precision': 0.74251395, 'recall': 0.5952452, 'specificity': 0.5952452, 'f1': 0.63377625, 'auroc': 0.91232955, 'binary_precision': 0.5123675, 'binary_recall': 0.19701087, 'binary_specificity': 0.9934795, 'binary_f1_score': 0.28459275}
confusion matrix:
       0    1
0  42052  276
1   1182  290
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.7925135, 'recall': 0.546387, 'specificity': 0.546387, 'f1': 0.5737959, 'auroc': 0.90383565, 'binary_precision': 0.61616164, 'binary_recall': 0.09486781, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.16442049}
confusion matrix:
       0   1
0  18111  38
1    582  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.98176414, 'recall': 0.5651341, 'specificity': 0.5651341, 'f1': 0.6059669, 'auroc': 0.8783076, 'binary_precision': 1.0, 'binary_recall': 0.1302682, 'binary_specificity': 1.0, 'binary_f1_score': 0.23050848}
confusion matrix:
      0   1
0  5997   0
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-16 15:48:12.975902,epoch time: 0:23:43.258130,used: 2:01:17.827671,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9672146, 'precision': 0.7499485, 'recall': 0.6223897, 'specificity': 0.6223897, 'f1': 0.6622367, 'auroc': 0.9180331, 'binary_precision': 0.5254237, 'binary_recall': 0.2527174, 'binary_specificity': 0.992062, 'binary_f1_score': 0.3412844}
confusion matrix:
       0    1
0  41992  336
1   1100  372
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.76640993, 'recall': 0.568056, 'specificity': 0.568056, 'f1': 0.6036107, 'auroc': 0.9144473, 'binary_precision': 0.5625, 'binary_recall': 0.1399689, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.22415942}
confusion matrix:
       0   1
0  18079  70
1    553  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.98331726, 'recall': 0.6034483, 'specificity': 0.6034483, 'f1': 0.6629456, 'auroc': 0.8857692, 'binary_precision': 1.0, 'binary_recall': 0.20689656, 'binary_specificity': 1.0, 'binary_f1_score': 0.34285715}
confusion matrix:
      0   1
0  5997   0
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_6.png
new oracle model saved
early stop counter: 1
val acc:0.9668475985527039, best validation acc: 0.9670072197914124, corresponding to test acc:                         0.9637264013290405 / 0.9669223427772522
after epoch: 6,now: 2024-06-16 16:12:17.482274,epoch time: 0:24:04.506372,used: 2:25:22.334043,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96746576, 'precision': 0.75540304, 'recall': 0.61235595, 'specificity': 0.61235595, 'f1': 0.6535075, 'auroc': 0.9206336, 'binary_precision': 0.53700787, 'binary_recall': 0.23165761, 'binary_specificity': 0.9930543, 'binary_f1_score': 0.32368296}
confusion matrix:
       0    1
0  42034  294
1   1131  341
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.7818077, 'recall': 0.56752634, 'specificity': 0.56752634, 'f1': 0.603874, 'auroc': 0.9152975, 'binary_precision': 0.5933333, 'binary_recall': 0.13841368, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.22446406}
confusion matrix:
       0   1
0  18088  61
1    554  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.9823842, 'recall': 0.5804598, 'specificity': 0.5804598, 'f1': 0.629648, 'auroc': 0.8868999, 'binary_precision': 1.0, 'binary_recall': 0.16091955, 'binary_specificity': 1.0, 'binary_f1_score': 0.27722773}
confusion matrix:
      0   1
0  5997   0
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_7.png
better model found
persisted
after epoch: 7,now: 2024-06-16 16:37:21.016483,epoch time: 0:25:03.534209,used: 2:50:25.868252,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9670548, 'precision': 0.74660933, 'recall': 0.6409951, 'specificity': 0.6409951, 'f1': 0.67798215, 'auroc': 0.9262323, 'binary_precision': 0.5174909, 'binary_recall': 0.29144022, 'binary_specificity': 0.99055, 'binary_f1_score': 0.37288135}
confusion matrix:
       0    1
0  41928  400
1   1043  429
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.7758272, 'recall': 0.587888, 'specificity': 0.587888, 'f1': 0.6292888, 'auroc': 0.9211911, 'binary_precision': 0.58, 'binary_recall': 0.18040435, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.27520758}
confusion matrix:
       0    1
0  18065   84
1    527  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.98285025, 'recall': 0.591954, 'specificity': 0.591954, 'f1': 0.64661527, 'auroc': 0.8873019, 'binary_precision': 1.0, 'binary_recall': 0.18390805, 'binary_specificity': 1.0, 'binary_f1_score': 0.3106796}
confusion matrix:
      0   1
0  5997   0
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_8.png
better model found
persisted
after epoch: 8,now: 2024-06-16 17:02:25.647081,epoch time: 0:25:04.630598,used: 3:15:30.498850,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96778536, 'precision': 0.756615, 'recall': 0.6449796, 'specificity': 0.6449796, 'f1': 0.6837859, 'auroc': 0.92500347, 'binary_precision': 0.53724056, 'binary_recall': 0.29891303, 'binary_specificity': 0.99104613, 'binary_f1_score': 0.38411173}
confusion matrix:
       0    1
0  41949  379
1   1032  440
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.7795552, 'recall': 0.58113754, 'specificity': 0.58113754, 'f1': 0.6213861, 'auroc': 0.92637044, 'binary_precision': 0.5879121, 'binary_recall': 0.16640747, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.25939396}
confusion matrix:
       0    1
0  18074   75
1    536  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.9723531, 'recall': 0.5899549, 'specificity': 0.5899549, 'f1': 0.64329714, 'auroc': 0.8914435, 'binary_precision': 0.9791667, 'binary_recall': 0.18007663, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.30420712}
confusion matrix:
      0   1
0  5996   1
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_9.png
early stop counter: 1
val acc:0.9674861431121826, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.9659635424613953 / 0.9669223427772522
after epoch: 9,now: 2024-06-16 17:27:46.777713,epoch time: 0:25:21.130632,used: 3:40:51.629482,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96769404, 'precision': 0.75597155, 'recall': 0.6383751, 'specificity': 0.6383751, 'f1': 0.6779629, 'auroc': 0.92380214, 'binary_precision': 0.5363985, 'binary_recall': 0.2853261, 'binary_specificity': 0.99142414, 'binary_f1_score': 0.37250558}
confusion matrix:
       0    1
0  41965  363
1   1052  420
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.77849805, 'recall': 0.5856654, 'specificity': 0.5856654, 'f1': 0.6268677, 'auroc': 0.92727995, 'binary_precision': 0.58549225, 'binary_recall': 0.17573872, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.27033493}
confusion matrix:
       0    1
0  18069   80
1    530  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.9824618, 'recall': 0.58237547, 'specificity': 0.58237547, 'f1': 0.6325217, 'auroc': 0.8926529, 'binary_precision': 1.0, 'binary_recall': 0.16475096, 'binary_specificity': 1.0, 'binary_f1_score': 0.28289476}
confusion matrix:
      0   1
0  5997   0
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_10.png
better model found
persisted
after epoch: 10,now: 2024-06-16 17:52:26.126907,epoch time: 0:24:39.349194,used: 4:05:30.978676,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96872145, 'precision': 0.7655357, 'recall': 0.6756271, 'specificity': 0.6756271, 'f1': 0.71052706, 'auroc': 0.9299699, 'binary_precision': 0.5530146, 'binary_recall': 0.36141303, 'binary_specificity': 0.9898412, 'binary_f1_score': 0.43714046}
confusion matrix:
       0    1
0  41898  430
1    940  532
---- Validation: 
scalar performance:
{'acc': 0.96812475, 'precision': 0.780625, 'recall': 0.6114703, 'specificity': 0.6114703, 'f1': 0.65645087, 'auroc': 0.93173516, 'binary_precision': 0.588, 'binary_recall': 0.22861587, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.32922733}
confusion matrix:
       0    1
0  18046  103
1    496  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.9746985, 'recall': 0.60719633, 'specificity': 0.60719633, 'f1': 0.66765666, 'auroc': 0.89398706, 'binary_precision': 0.98245615, 'binary_recall': 0.21455939, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.35220128}
confusion matrix:
      0   1
0  5996   1
1   205  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_11.png
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-06-16 18:17:56.949217,epoch time: 0:25:30.822310,used: 4:31:01.800986,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9686073, 'precision': 0.7726817, 'recall': 0.62999535, 'specificity': 0.62999535, 'f1': 0.6738136, 'auroc': 0.93049383, 'binary_precision': 0.5703919, 'binary_recall': 0.2669837, 'binary_specificity': 0.993007, 'binary_f1_score': 0.3637205}
confusion matrix:
       0    1
0  42032  296
1   1079  393
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.7819917, 'recall': 0.569804, 'specificity': 0.569804, 'f1': 0.60694265, 'auroc': 0.93113625, 'binary_precision': 0.59354836, 'binary_recall': 0.14307931, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.23057643}
confusion matrix:
       0   1
0  18086  63
1    551  92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.98145473, 'recall': 0.5574713, 'specificity': 0.5574713, 'f1': 0.5936449, 'auroc': 0.8930549, 'binary_precision': 1.0, 'binary_recall': 0.11494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5997   0
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_12.png
early stop counter: 1
val acc:0.9673265218734741, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 12,now: 2024-06-16 18:42:48.551892,epoch time: 0:24:51.602675,used: 4:55:53.403661,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.968242, 'precision': 0.7623687, 'recall': 0.64957094, 'specificity': 0.64957094, 'f1': 0.68906045, 'auroc': 0.9318501, 'binary_precision': 0.54842615, 'binary_recall': 0.30795377, 'binary_specificity': 0.99118805, 'binary_f1_score': 0.39442754}
confusion matrix:
       0    1
0  41956  373
1   1018  453
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.7816157, 'recall': 0.5728318, 'specificity': 0.5728318, 'f1': 0.6109211, 'auroc': 0.9308541, 'binary_precision': 0.5925926, 'binary_recall': 0.14930016, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.23850933}
confusion matrix:
       0   1
0  18083  66
1    547  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.98114574, 'recall': 0.54980844, 'specificity': 0.54980844, 'f1': 0.580984, 'auroc': 0.8903357, 'binary_precision': 1.0, 'binary_recall': 0.099616855, 'binary_specificity': 1.0, 'binary_f1_score': 0.18118466}
confusion matrix:
      0   1
0  5997   0
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_13.png
early stop counter: 2
val acc:0.9673797488212585, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 13,now: 2024-06-16 19:07:19.185659,epoch time: 0:24:30.633767,used: 5:20:24.037428,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96931505, 'precision': 0.7790068, 'recall': 0.6510168, 'specificity': 0.6510168, 'f1': 0.6942537, 'auroc': 0.9349842, 'binary_precision': 0.5816327, 'binary_recall': 0.3097826, 'binary_specificity': 0.992251, 'binary_f1_score': 0.40425533}
confusion matrix:
       0    1
0  42000  328
1   1016  456
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.79270625, 'recall': 0.5775525, 'specificity': 0.5775525, 'f1': 0.61785585, 'auroc': 0.9350386, 'binary_precision': 0.61445785, 'binary_recall': 0.15863141, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.25216314}
confusion matrix:
       0    1
0  18085   64
1    541  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.9812229, 'recall': 0.55172414, 'specificity': 0.55172414, 'f1': 0.5841818, 'auroc': 0.89322615, 'binary_precision': 1.0, 'binary_recall': 0.10344828, 'binary_specificity': 1.0, 'binary_f1_score': 0.1875}
confusion matrix:
      0   1
0  5997   0
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_14.png
early stop counter: 3
val acc:0.9678054451942444, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 14,now: 2024-06-16 19:32:11.674364,epoch time: 0:24:52.488705,used: 5:45:16.526133,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9694292, 'precision': 0.7732217, 'recall': 0.6826663, 'specificity': 0.6826663, 'f1': 0.71808976, 'auroc': 0.9358463, 'binary_precision': 0.56790125, 'binary_recall': 0.37525493, 'binary_specificity': 0.99007773, 'binary_f1_score': 0.4519034}
confusion matrix:
       0    1
0  41909  420
1    919  552
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.7763318, 'recall': 0.60152674, 'specificity': 0.60152674, 'f1': 0.64506423, 'auroc': 0.9378263, 'binary_precision': 0.5800866, 'binary_recall': 0.20839813, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.30663618}
confusion matrix:
       0    1
0  18052   97
1    509  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.9819965, 'recall': 0.57088125, 'specificity': 0.57088125, 'f1': 0.6149943, 'auroc': 0.8977699, 'binary_precision': 1.0, 'binary_recall': 0.14176245, 'binary_specificity': 1.0, 'binary_f1_score': 0.24832213}
confusion matrix:
      0   1
0  5997   0
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_15.png
early stop counter: 4
val acc:0.96775221824646, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 15,now: 2024-06-16 19:56:58.977947,epoch time: 0:24:47.303583,used: 6:10:03.829716,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9694749, 'precision': 0.7758441, 'recall': 0.6737219, 'specificity': 0.6737219, 'f1': 0.71209633, 'auroc': 0.93502915, 'binary_precision': 0.57377046, 'binary_recall': 0.3566576, 'binary_specificity': 0.99078625, 'binary_f1_score': 0.4398827}
confusion matrix:
       0    1
0  41938  390
1    947  525
---- Validation: 
scalar performance:
{'acc': 0.968178, 'precision': 0.78717387, 'recall': 0.6009971, 'specificity': 0.6009971, 'f1': 0.6457925, 'auroc': 0.9375522, 'binary_precision': 0.60181, 'binary_recall': 0.20684293, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.3078704}
confusion matrix:
       0    1
0  18061   88
1    510  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.981919, 'recall': 0.5689655, 'specificity': 0.5689655, 'f1': 0.6120051, 'auroc': 0.8968934, 'binary_precision': 1.0, 'binary_recall': 0.13793103, 'binary_specificity': 1.0, 'binary_f1_score': 0.24242425}
confusion matrix:
      0   1
0  5997   0
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_16.png
better model found
persisted
after epoch: 16,now: 2024-06-16 20:21:52.692598,epoch time: 0:24:53.714651,used: 6:34:57.544367,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9697032, 'precision': 0.77863157, 'recall': 0.67427766, 'specificity': 0.67427766, 'f1': 0.71331567, 'auroc': 0.93814194, 'binary_precision': 0.57929516, 'binary_recall': 0.3575799, 'binary_specificity': 0.99097544, 'binary_f1_score': 0.4422026}
confusion matrix:
       0    1
0  41947  382
1    945  526
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.7976009, 'recall': 0.5943568, 'specificity': 0.5943568, 'f1': 0.639185, 'auroc': 0.93698525, 'binary_precision': 0.6231156, 'binary_recall': 0.19284603, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.29453683}
confusion matrix:
       0    1
0  18074   75
1    519  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.9808371, 'recall': 0.5421456, 'specificity': 0.5421456, 'f1': 0.56796986, 'auroc': 0.8966172, 'binary_precision': 1.0, 'binary_recall': 0.08429119, 'binary_specificity': 1.0, 'binary_f1_score': 0.15547703}
confusion matrix:
      0   1
0  5997   0
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_17.png
better model found
persisted
after epoch: 17,now: 2024-06-16 20:46:48.007709,epoch time: 0:24:55.315111,used: 6:59:52.859478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96952057, 'precision': 0.77886117, 'recall': 0.66358185, 'specificity': 0.66358185, 'f1': 0.7048286, 'auroc': 0.9376894, 'binary_precision': 0.5804935, 'binary_recall': 0.3355978, 'binary_specificity': 0.9915659, 'binary_f1_score': 0.4253121}
confusion matrix:
       0    1
0  41971  357
1    978  494
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.79322314, 'recall': 0.60035723, 'specificity': 0.60035723, 'f1': 0.6457593, 'auroc': 0.9381405, 'binary_precision': 0.6139535, 'binary_recall': 0.20528771, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.30769232}
confusion matrix:
       0    1
0  18066   83
1    511  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.98160934, 'recall': 0.56130266, 'specificity': 0.56130266, 'f1': 0.59984744, 'auroc': 0.8949037, 'binary_precision': 1.0, 'binary_recall': 0.12260536, 'binary_specificity': 1.0, 'binary_f1_score': 0.21843004}
confusion matrix:
      0   1
0  5997   0
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_18.png
early stop counter: 1
val acc:0.9683908224105835, best validation acc: 0.9683908224105835, corresponding to test acc:                         0.9618088603019714 / 0.967082142829895
after epoch: 18,now: 2024-06-16 21:12:10.614119,epoch time: 0:25:22.606410,used: 7:25:15.465888,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9687443, 'precision': 0.76609176, 'recall': 0.671813, 'specificity': 0.671813, 'f1': 0.7078223, 'auroc': 0.9398546, 'binary_precision': 0.554371, 'binary_recall': 0.35350102, 'binary_specificity': 0.990125, 'binary_f1_score': 0.43171442}
confusion matrix:
       0    1
0  41911  418
1    951  520
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.78991807, 'recall': 0.6056076, 'specificity': 0.6056076, 'f1': 0.65131366, 'auroc': 0.94080865, 'binary_precision': 0.6069869, 'binary_recall': 0.21617419, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.31880733}
confusion matrix:
       0    1
0  18059   90
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.9813002, 'recall': 0.5536398, 'specificity': 0.5536398, 'f1': 0.5873577, 'auroc': 0.8967927, 'binary_precision': 1.0, 'binary_recall': 0.107279696, 'binary_specificity': 1.0, 'binary_f1_score': 0.19377163}
confusion matrix:
      0   1
0  5997   0
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_19.png
early stop counter: 2
val acc:0.9683908224105835, best validation acc: 0.9683908224105835, corresponding to test acc:                         0.9618088603019714 / 0.967082142829895
after epoch: 19,now: 2024-06-16 21:37:07.635652,epoch time: 0:24:57.021533,used: 7:50:12.487421,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9707991, 'precision': 0.7880649, 'recall': 0.69768524, 'specificity': 0.69768524, 'f1': 0.73368573, 'auroc': 0.9399855, 'binary_precision': 0.5965966, 'binary_recall': 0.4048913, 'binary_specificity': 0.9904791, 'binary_f1_score': 0.48239577}
confusion matrix:
       0    1
0  41925  403
1    876  596
---- Validation: 
scalar performance:
{'acc': 0.9686569, 'precision': 0.7956897, 'recall': 0.6072455, 'specificity': 0.6072455, 'f1': 0.6538612, 'auroc': 0.9404094, 'binary_precision': 0.6184211, 'binary_recall': 0.21928461, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.32376578}
confusion matrix:
       0    1
0  18062   87
1    502  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.98145473, 'recall': 0.5574713, 'specificity': 0.5574713, 'f1': 0.5936449, 'auroc': 0.8955123, 'binary_precision': 1.0, 'binary_recall': 0.11494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5997   0
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_20.png
better model found
persisted
after epoch: 20,now: 2024-06-16 22:02:21.666064,epoch time: 0:25:14.030412,used: 8:15:26.517833,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9707991, 'precision': 0.7899296, 'recall': 0.68993694, 'specificity': 0.68993694, 'f1': 0.7285631, 'auroc': 0.9373739, 'binary_precision': 0.60084033, 'binary_recall': 0.38885114, 'binary_specificity': 0.9910227, 'binary_f1_score': 0.47214198}
confusion matrix:
       0    1
0  41949  380
1    899  572
---- Validation: 
scalar performance:
{'acc': 0.968923, 'precision': 0.7890295, 'recall': 0.6306349, 'specificity': 0.6306349, 'f1': 0.6773789, 'auroc': 0.9433032, 'binary_precision': 0.6035088, 'binary_recall': 0.2674961, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.37068963}
confusion matrix:
       0    1
0  18036  113
1    471  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.97075343, 'recall': 0.5803764, 'specificity': 0.5803764, 'f1': 0.6291504, 'auroc': 0.89922583, 'binary_precision': 0.9767442, 'binary_recall': 0.16091955, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.27631578}
confusion matrix:
      0   1
0  5996   1
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_21.png
better model found
persisted
after epoch: 21,now: 2024-06-16 22:27:26.331530,epoch time: 0:25:04.665466,used: 8:40:31.183299,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96981734, 'precision': 0.77952826, 'recall': 0.67848915, 'specificity': 0.67848915, 'f1': 0.7168251, 'auroc': 0.9385853, 'binary_precision': 0.58081895, 'binary_recall': 0.36616847, 'binary_specificity': 0.99080986, 'binary_f1_score': 0.44916666}
confusion matrix:
       0    1
0  41939  389
1    933  539
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.7965069, 'recall': 0.6247447, 'specificity': 0.6247447, 'f1': 0.6727097, 'auroc': 0.9424355, 'binary_precision': 0.61886793, 'binary_recall': 0.25505444, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.3612335}
confusion matrix:
       0    1
0  18048  101
1    479  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.98145473, 'recall': 0.5574713, 'specificity': 0.5574713, 'f1': 0.5936449, 'auroc': 0.89621234, 'binary_precision': 1.0, 'binary_recall': 0.11494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5997   0
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_22.png
better model found
persisted
after epoch: 22,now: 2024-06-16 22:52:32.974895,epoch time: 0:25:06.643365,used: 9:05:37.826664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97041094, 'precision': 0.7896272, 'recall': 0.67322266, 'specificity': 0.67322266, 'f1': 0.71547663, 'auroc': 0.9413637, 'binary_precision': 0.6013825, 'binary_recall': 0.35461956, 'binary_specificity': 0.99182576, 'binary_f1_score': 0.44615385}
confusion matrix:
       0    1
0  41982  346
1    950  522
---- Validation: 
scalar performance:
{'acc': 0.969189, 'precision': 0.8105351, 'recall': 0.6067709, 'specificity': 0.6067709, 'f1': 0.65509725, 'auroc': 0.9416926, 'binary_precision': 0.6481481, 'binary_recall': 0.21772939, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.32596043}
confusion matrix:
       0    1
0  18073   76
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9813774, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.59051204, 'auroc': 0.8957659, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5997   0
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_23.png
better model found
persisted
after epoch: 23,now: 2024-06-16 23:17:47.895264,epoch time: 0:25:14.920369,used: 9:30:52.747033,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97061646, 'precision': 0.79188454, 'recall': 0.67595184, 'specificity': 0.67595184, 'f1': 0.7182721, 'auroc': 0.93934524, 'binary_precision': 0.60571426, 'binary_recall': 0.36005434, 'binary_specificity': 0.99184936, 'binary_f1_score': 0.4516404}
confusion matrix:
       0    1
0  41983  345
1    942  530
---- Validation: 
scalar performance:
{'acc': 0.9686037, 'precision': 0.7911837, 'recall': 0.6124683, 'specificity': 0.6124683, 'f1': 0.65900433, 'auroc': 0.9430381, 'binary_precision': 0.6090535, 'binary_recall': 0.23017107, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.33408576}
confusion matrix:
       0    1
0  18054   95
1    495  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.98145473, 'recall': 0.5574713, 'specificity': 0.5574713, 'f1': 0.5936449, 'auroc': 0.89675677, 'binary_precision': 1.0, 'binary_recall': 0.11494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5997   0
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_24.png
early stop counter: 1
val acc:0.9686036705970764, best validation acc: 0.9691889882087708, corresponding to test acc:                         0.9629274606704712 / 0.967082142829895
after epoch: 24,now: 2024-06-16 23:44:19.686941,epoch time: 0:26:31.791677,used: 9:57:24.538710,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9707078, 'precision': 0.80175173, 'recall': 0.65534383, 'specificity': 0.65534383, 'f1': 0.7031318, 'auroc': 0.9418158, 'binary_precision': 0.62684566, 'binary_recall': 0.31725544, 'binary_specificity': 0.9934322, 'binary_f1_score': 0.42129004}
confusion matrix:
       0    1
0  42050  278
1   1005  467
---- Validation: 
scalar performance:
{'acc': 0.9688165, 'precision': 0.80323005, 'recall': 0.6028278, 'specificity': 0.6028278, 'f1': 0.6497327, 'auroc': 0.9431814, 'binary_precision': 0.63380283, 'binary_recall': 0.20995334, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.31542057}
confusion matrix:
       0    1
0  18071   78
1    508  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.98160934, 'recall': 0.56130266, 'specificity': 0.56130266, 'f1': 0.59984744, 'auroc': 0.8964307, 'binary_precision': 1.0, 'binary_recall': 0.12260536, 'binary_specificity': 1.0, 'binary_f1_score': 0.21843004}
confusion matrix:
      0   1
0  5997   0
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_25.png
early stop counter: 2
val acc:0.9688165187835693, best validation acc: 0.9691889882087708, corresponding to test acc:                         0.9629274606704712 / 0.967082142829895
after epoch: 25,now: 2024-06-17 00:09:16.765270,epoch time: 0:24:57.078329,used: 10:22:21.617039,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.97107303, 'precision': 0.79104674, 'recall': 0.700122, 'specificity': 0.700122, 'f1': 0.73639154, 'auroc': 0.9438648, 'binary_precision': 0.6023976, 'binary_recall': 0.40964675, 'binary_specificity': 0.99059725, 'binary_f1_score': 0.4876668}
confusion matrix:
       0    1
0  41930  398
1    869  603
---- Validation: 
scalar performance:
{'acc': 0.96977437, 'precision': 0.7996036, 'recall': 0.64382666, 'specificity': 0.64382666, 'f1': 0.6920371, 'auroc': 0.9443195, 'binary_precision': 0.62376237, 'binary_recall': 0.29393467, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.39957714}
confusion matrix:
       0    1
0  18035  114
1    454  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.9824618, 'recall': 0.58237547, 'specificity': 0.58237547, 'f1': 0.6325217, 'auroc': 0.8985059, 'binary_precision': 1.0, 'binary_recall': 0.16475096, 'binary_specificity': 1.0, 'binary_f1_score': 0.28289476}
confusion matrix:
      0   1
0  5997   0
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_26.png
better model found
persisted
after epoch: 26,now: 2024-06-17 00:34:14.157412,epoch time: 0:24:57.392142,used: 10:47:19.009181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97111875, 'precision': 0.7957245, 'recall': 0.68616515, 'specificity': 0.68616515, 'f1': 0.72737837, 'auroc': 0.9432851, 'binary_precision': 0.61269146, 'binary_recall': 0.3806934, 'binary_specificity': 0.99163693, 'binary_f1_score': 0.4696017}
confusion matrix:
       0    1
0  41975  354
1    911  560
---- Validation: 
scalar performance:
{'acc': 0.9692422, 'precision': 0.80643356, 'recall': 0.613549, 'specificity': 0.613549, 'f1': 0.6622184, 'auroc': 0.9446728, 'binary_precision': 0.639485, 'binary_recall': 0.23172629, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.34018266}
confusion matrix:
       0    1
0  18065   84
1    494  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.98114574, 'recall': 0.54980844, 'specificity': 0.54980844, 'f1': 0.580984, 'auroc': 0.89608, 'binary_precision': 1.0, 'binary_recall': 0.099616855, 'binary_specificity': 1.0, 'binary_f1_score': 0.18118466}
confusion matrix:
      0   1
0  5997   0
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_27.png
early stop counter: 1
val acc:0.9692422151565552, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.9651646018028259 / 0.967082142829895
after epoch: 27,now: 2024-06-17 00:58:41.621875,epoch time: 0:24:27.464463,used: 11:11:46.473644,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9705708, 'precision': 0.7952001, 'recall': 0.664781, 'specificity': 0.664781, 'f1': 0.7098944, 'auroc': 0.9448445, 'binary_precision': 0.6131026, 'binary_recall': 0.33695653, 'binary_specificity': 0.9926054, 'binary_f1_score': 0.43489695}
confusion matrix:
       0    1
0  42015  313
1    976  496
---- Validation: 
scalar performance:
{'acc': 0.9692422, 'precision': 0.8171295, 'recall': 0.6015481, 'specificity': 0.6015481, 'f1': 0.64971685, 'auroc': 0.9429095, 'binary_precision': 0.66169155, 'binary_recall': 0.20684293, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.31516588}
confusion matrix:
       0    1
0  18081   68
1    510  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.9808371, 'recall': 0.5421456, 'specificity': 0.5421456, 'f1': 0.56796986, 'auroc': 0.8953526, 'binary_precision': 1.0, 'binary_recall': 0.08429119, 'binary_specificity': 1.0, 'binary_f1_score': 0.15547703}
confusion matrix:
      0   1
0  5997   0
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_28.png
early stop counter: 2
val acc:0.9692422151565552, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.9651646018028259 / 0.967082142829895
after epoch: 28,now: 2024-06-17 01:23:14.352289,epoch time: 0:24:32.730414,used: 11:36:19.204058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9715753, 'precision': 0.79750097, 'recall': 0.7013655, 'specificity': 0.7013655, 'f1': 0.739331, 'auroc': 0.9447001, 'binary_precision': 0.6152284, 'binary_recall': 0.41168478, 'binary_specificity': 0.99104613, 'binary_f1_score': 0.49328446}
confusion matrix:
       0    1
0  41949  379
1    866  606
---- Validation: 
scalar performance:
{'acc': 0.97009367, 'precision': 0.8137309, 'recall': 0.6319911, 'specificity': 0.6319911, 'f1': 0.68286693, 'auroc': 0.9460286, 'binary_precision': 0.6528302, 'binary_recall': 0.2690513, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.38105726}
confusion matrix:
       0    1
0  18057   92
1    470  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.9816867, 'recall': 0.5632184, 'specificity': 0.5632184, 'f1': 0.60291743, 'auroc': 0.89676386, 'binary_precision': 1.0, 'binary_recall': 0.12643678, 'binary_specificity': 1.0, 'binary_f1_score': 0.2244898}
confusion matrix:
      0   1
0  5997   0
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_29.png
better model found
persisted
after epoch: 29,now: 2024-06-17 01:48:06.728658,epoch time: 0:24:52.376369,used: 12:01:11.580427,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.97075343, 'precision': 0.7844578, 'recall': 0.71044815, 'specificity': 0.71044815, 'f1': 0.74139106, 'auroc': 0.9432293, 'binary_precision': 0.5885079, 'binary_recall': 0.43138587, 'binary_specificity': 0.9895105, 'binary_f1_score': 0.497844}
confusion matrix:
       0    1
0  41884  444
1    837  635
---- Validation: 
scalar performance:
{'acc': 0.9705726, 'precision': 0.8196694, 'recall': 0.63898957, 'specificity': 0.63898957, 'f1': 0.69093245, 'auroc': 0.94615215, 'binary_precision': 0.66423357, 'binary_recall': 0.2830482, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.39694658}
confusion matrix:
       0    1
0  18057   92
1    461  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.9808371, 'recall': 0.5421456, 'specificity': 0.5421456, 'f1': 0.56796986, 'auroc': 0.8951173, 'binary_precision': 1.0, 'binary_recall': 0.08429119, 'binary_specificity': 1.0, 'binary_f1_score': 0.15547703}
confusion matrix:
      0   1
0  5997   0
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_30.png
better model found
persisted
after epoch: 30,now: 2024-06-17 02:12:58.087173,epoch time: 0:24:51.358515,used: 12:26:02.938942,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:26:02.938942 at 2024-06-17 02:12:58.087173
persisted model performance metric: 

scalar performance:
{'acc': 0.96180886, 'precision': 0.9808371, 'recall': 0.5421456, 'specificity': 0.5421456, 'f1': 0.56796986, 'auroc': 0.8951173, 'binary_precision': 1.0, 'binary_recall': 0.08429119, 'binary_specificity': 1.0, 'binary_f1_score': 0.15547703}
confusion matrix:
      0   1
0  5997   0
1   239  22
oracle model performance metric: 

scalar performance:
{'acc': 0.96708214, 'precision': 0.9746985, 'recall': 0.60719633, 'specificity': 0.60719633, 'f1': 0.66765666, 'auroc': 0.89398706, 'binary_precision': 0.98245615, 'binary_recall': 0.21455939, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.35220128}
confusion matrix:
      0   1
0  5996   1
1   205  56
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 395294 GiB | 395293 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 395173 GiB | 395172 GiB |
|       from small pool |  36242 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 395294 GiB | 395293 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 395173 GiB | 395172 GiB |
|       from small pool |  36242 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1428 MiB | 395271 GiB | 395270 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |  35968 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 284058 GiB | 284057 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 283919 GiB | 283918 GiB |
|       from small pool |   8813 KiB |  12610 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   13822 K  |   13821 K  |
|       from large pool |      36    |      76    |    4630 K  |    4630 K  |
|       from small pool |    1242    |    1864    |    9192 K  |    9190 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   13822 K  |   13821 K  |
|       from large pool |      36    |      76    |    4630 K  |    4630 K  |
|       from small pool |    1242    |    1864    |    9192 K  |    9190 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     452    |    7386 K  |    7386 K  |
|       from large pool |       5    |      10    |    1938 K  |    1938 K  |
|       from small pool |      30    |     447    |    5448 K  |    5448 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 395294 GiB | 395294 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395173 GiB | 395173 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 395294 GiB | 395294 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395173 GiB | 395173 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 395271 GiB | 395271 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |      0 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 284058 GiB | 284057 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 283919 GiB | 283918 GiB |
|       from small pool |      0 KiB |  16408 KiB |    139 GiB |    139 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13822 K  |   13822 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9192 K  |    9192 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13822 K  |   13822 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9192 K  |    9192 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    7386 K  |    7386 K  |
|       from large pool |       1    |      11    |    1938 K  |    1938 K  |
|       from small pool |       0    |     447    |    5448 K  |    5448 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 395294 GiB | 395294 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395173 GiB | 395173 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 395294 GiB | 395294 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395173 GiB | 395173 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 395271 GiB | 395271 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |      0 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 284058 GiB | 284057 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 283919 GiB | 283918 GiB |
|       from small pool |      0 KiB |  16408 KiB |    139 GiB |    139 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13822 K  |   13822 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9192 K  |    9192 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13822 K  |   13822 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9192 K  |    9192 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    7386 K  |    7386 K  |
|       from large pool |       1    |      11    |    1938 K  |    1938 K  |
|       from small pool |       0    |     447    |    5448 K  |    5448 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390

 Experiment start at: 2024-06-17 02:25:23.323280
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96710044, 'precision': 0.48355022, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49163756, 'auroc': 0.6802466, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42359  0
1   1441  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.6144241, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.61767524, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-17 02:50:49.958235,epoch time: 0:25:26.634955,used: 0:25:26.634955,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9672375, 'precision': 0.8407818, 'recall': 0.50171494, 'specificity': 0.50171494, 'f1': 0.49513218, 'auroc': 0.8469393, 'binary_precision': 0.71428573, 'binary_recall': 0.0034770514, 'binary_specificity': 0.9999528, 'binary_f1_score': 0.0069204154}
confusion matrix:
       0  1
0  42360  2
1   1433  5
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.81483066, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.80802757, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_2.png
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 2,now: 2024-06-17 03:15:26.325938,epoch time: 0:24:36.367703,used: 0:50:03.002658,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9673516, 'precision': 0.7425542, 'recall': 0.53303677, 'specificity': 0.53303677, 'f1': 0.55195415, 'auroc': 0.8876189, 'binary_precision': 0.51578945, 'binary_recall': 0.06824513, 'binary_specificity': 0.99782836, 'binary_f1_score': 0.12054121}
confusion matrix:
       0   1
0  42272  92
1   1338  98
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.7471981, 'recall': 0.51293015, 'specificity': 0.51293015, 'f1': 0.51633614, 'auroc': 0.8730519, 'binary_precision': 0.5294118, 'binary_recall': 0.026745914, 'binary_specificity': 0.9991144, 'binary_f1_score': 0.050919376}
confusion matrix:
       0   1
0  18051  16
1    655  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.97974825, 'recall': 0.5173077, 'specificity': 0.5173077, 'f1': 0.5231221, 'auroc': 0.8473544, 'binary_precision': 1.0, 'binary_recall': 0.034615386, 'binary_specificity': 1.0, 'binary_f1_score': 0.0669145}
confusion matrix:
      0  1
0  5946  0
1   251  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-17 03:40:17.836411,epoch time: 0:24:51.510473,used: 1:14:54.513131,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96762556, 'precision': 0.7490014, 'recall': 0.578703, 'specificity': 0.578703, 'f1': 0.61580044, 'auroc': 0.8965647, 'binary_precision': 0.5258427, 'binary_recall': 0.16238724, 'binary_specificity': 0.9950188, 'binary_f1_score': 0.24814424}
confusion matrix:
       0    1
0  42148  211
1   1207  234
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.7629184, 'recall': 0.5374983, 'specificity': 0.5374983, 'f1': 0.5588695, 'auroc': 0.8898776, 'binary_precision': 0.5591398, 'binary_recall': 0.07726597, 'binary_specificity': 0.9977307, 'binary_f1_score': 0.13577023}
confusion matrix:
       0   1
0  18026  41
1    621  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.9803684, 'recall': 0.5326923, 'specificity': 0.5326923, 'f1': 0.55135953, 'auroc': 0.8608017, 'binary_precision': 1.0, 'binary_recall': 0.06538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.12274369}
confusion matrix:
      0   1
0  5946   0
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-17 04:05:07.261360,epoch time: 0:24:49.424949,used: 1:39:43.938080,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9669863, 'precision': 0.73216087, 'recall': 0.56869, 'specificity': 0.56869, 'f1': 0.6020205, 'auroc': 0.9064229, 'binary_precision': 0.49278846, 'binary_recall': 0.1423611, 'binary_specificity': 0.9950189, 'binary_f1_score': 0.22090514}
confusion matrix:
       0    1
0  42149  211
1   1235  205
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.76739025, 'recall': 0.53609544, 'specificity': 0.53609544, 'f1': 0.55670226, 'auroc': 0.89697003, 'binary_precision': 0.5681818, 'binary_recall': 0.0742942, 'binary_specificity': 0.99789673, 'binary_f1_score': 0.13140604}
confusion matrix:
       0   1
0  18029  38
1    623  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.9803684, 'recall': 0.5326923, 'specificity': 0.5326923, 'f1': 0.55135953, 'auroc': 0.86359024, 'binary_precision': 1.0, 'binary_recall': 0.06538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.12274369}
confusion matrix:
      0   1
0  5946   0
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_5.png
better model found
persisted
after epoch: 5,now: 2024-06-17 04:30:26.580272,epoch time: 0:25:19.318912,used: 2:05:03.256992,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9675799, 'precision': 0.7463716, 'recall': 0.59973586, 'specificity': 0.59973586, 'f1': 0.63917196, 'auroc': 0.90985477, 'binary_precision': 0.5192308, 'binary_recall': 0.20596394, 'binary_specificity': 0.99350774, 'binary_f1_score': 0.29493546}
confusion matrix:
       0    1
0  42083  275
1   1145  297
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.7652005, 'recall': 0.56564283, 'specificity': 0.56564283, 'f1': 0.6000722, 'auroc': 0.9089267, 'binary_precision': 0.5617284, 'binary_recall': 0.13521545, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.21796405}
confusion matrix:
       0   1
0  17996  71
1    582  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.98106796, 'recall': 0.55, 'specificity': 0.55, 'f1': 0.58126044, 'auroc': 0.8729642, 'binary_precision': 1.0, 'binary_recall': 0.1, 'binary_specificity': 1.0, 'binary_f1_score': 0.18181819}
confusion matrix:
      0   1
0  5946   0
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-17 04:55:14.295327,epoch time: 0:24:47.715055,used: 2:29:50.972047,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9672146, 'precision': 0.73853993, 'recall': 0.6215444, 'specificity': 0.6215444, 'f1': 0.65918905, 'auroc': 0.91440403, 'binary_precision': 0.50208044, 'binary_recall': 0.25156358, 'binary_specificity': 0.99152523, 'binary_f1_score': 0.33518517}
confusion matrix:
       0    1
0  42002  359
1   1077  362
---- Validation: 
scalar performance:
{'acc': 0.96600854, 'precision': 0.78046155, 'recall': 0.5846826, 'specificity': 0.5846826, 'f1': 0.6256283, 'auroc': 0.91434884, 'binary_precision': 0.59090906, 'binary_recall': 0.17384844, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.2686567}
confusion matrix:
       0    1
0  17986   81
1    556  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.9813016, 'recall': 0.5557692, 'specificity': 0.5557692, 'f1': 0.59081864, 'auroc': 0.87767667, 'binary_precision': 1.0, 'binary_recall': 0.11153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.20069206}
confusion matrix:
      0   1
0  5946   0
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-17 05:19:56.614128,epoch time: 0:24:42.318801,used: 2:54:33.290848,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96789956, 'precision': 0.7493324, 'recall': 0.6235768, 'specificity': 0.6235768, 'f1': 0.6632692, 'auroc': 0.9228358, 'binary_precision': 0.5235378, 'binary_recall': 0.25503823, 'binary_specificity': 0.9921154, 'binary_f1_score': 0.34299067}
confusion matrix:
       0    1
0  42027  334
1   1072  367
---- Validation: 
scalar performance:
{'acc': 0.9654749, 'precision': 0.7715256, 'recall': 0.5729615, 'specificity': 0.5729615, 'f1': 0.6101322, 'auroc': 0.9164417, 'binary_precision': 0.5738636, 'binary_recall': 0.15007429, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.23792696}
confusion matrix:
       0    1
0  17992   75
1    572  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.98114586, 'recall': 0.5519231, 'specificity': 0.5519231, 'f1': 0.58446836, 'auroc': 0.8751809, 'binary_precision': 1.0, 'binary_recall': 0.103846155, 'binary_specificity': 1.0, 'binary_f1_score': 0.18815331}
confusion matrix:
      0   1
0  5946   0
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_8.png
early stop counter: 1
val acc:0.9654749035835266, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9627779722213745 / 0.9627779722213745
after epoch: 8,now: 2024-06-17 05:44:27.010068,epoch time: 0:24:30.395940,used: 3:19:03.686788,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9678311, 'precision': 0.74727356, 'recall': 0.65566474, 'specificity': 0.65566474, 'f1': 0.69002444, 'auroc': 0.92297053, 'binary_precision': 0.5173184, 'binary_recall': 0.32152778, 'binary_specificity': 0.9898017, 'binary_f1_score': 0.39657387}
confusion matrix:
       0    1
0  41928  432
1    977  463
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.78502774, 'recall': 0.6079309, 'specificity': 0.6079309, 'f1': 0.6530708, 'auroc': 0.92302513, 'binary_precision': 0.59839356, 'binary_recall': 0.22139673, 'binary_specificity': 0.99446505, 'binary_f1_score': 0.32321042}
confusion matrix:
       0    1
0  17967  100
1    524  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.9820039, 'recall': 0.5730769, 'specificity': 0.5730769, 'f1': 0.61835384, 'auroc': 0.87973356, 'binary_precision': 1.0, 'binary_recall': 0.14615385, 'binary_specificity': 1.0, 'binary_f1_score': 0.25503358}
confusion matrix:
      0   1
0  5946   0
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_9.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-06-17 06:09:02.682757,epoch time: 0:24:35.672689,used: 3:43:39.359477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.968379, 'precision': 0.75599295, 'recall': 0.6352371, 'specificity': 0.6352371, 'f1': 0.6752485, 'auroc': 0.92625725, 'binary_precision': 0.5360963, 'binary_recall': 0.27866575, 'binary_specificity': 0.9918085, 'binary_f1_score': 0.3667124}
confusion matrix:
       0    1
0  42014  347
1   1038  401
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.79358876, 'recall': 0.60014594, 'specificity': 0.60014594, 'f1': 0.64535856, 'auroc': 0.9239647, 'binary_precision': 0.6160714, 'binary_recall': 0.205052, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.30769232}
confusion matrix:
       0    1
0  17981   86
1    535  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.9813795, 'recall': 0.5576923, 'specificity': 0.5576923, 'f1': 0.5939614, 'auroc': 0.883752, 'binary_precision': 1.0, 'binary_recall': 0.115384616, 'binary_specificity': 1.0, 'binary_f1_score': 0.20689656}
confusion matrix:
      0   1
0  5946   0
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_10.png
better model found
persisted
after epoch: 10,now: 2024-06-17 06:33:44.819198,epoch time: 0:24:42.136441,used: 4:08:21.495918,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96984017, 'precision': 0.7795272, 'recall': 0.641945, 'specificity': 0.641945, 'f1': 0.68634087, 'auroc': 0.92618567, 'binary_precision': 0.58275384, 'binary_recall': 0.29097223, 'binary_specificity': 0.99291784, 'binary_f1_score': 0.38814268}
confusion matrix:
       0    1
0  42060  300
1   1021  419
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.80233115, 'recall': 0.58215356, 'specificity': 0.58215356, 'f1': 0.62425345, 'auroc': 0.923569, 'binary_precision': 0.6348315, 'binary_recall': 0.1679049, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.2655699}
confusion matrix:
       0    1
0  18002   65
1    560  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.98075676, 'recall': 0.5423077, 'specificity': 0.5423077, 'f1': 0.5682038, 'auroc': 0.8825147, 'binary_precision': 1.0, 'binary_recall': 0.08461539, 'binary_specificity': 1.0, 'binary_f1_score': 0.15602838}
confusion matrix:
      0   1
0  5946   0
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_11.png
early stop counter: 1
val acc:0.9666488766670227, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9629390835762024 / 0.9642281532287598
after epoch: 11,now: 2024-06-17 06:59:01.740698,epoch time: 0:25:16.921500,used: 4:33:38.417418,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96922374, 'precision': 0.76572835, 'recall': 0.65557724, 'specificity': 0.65557724, 'f1': 0.6949233, 'auroc': 0.93348897, 'binary_precision': 0.55421686, 'binary_recall': 0.31988874, 'binary_specificity': 0.9912658, 'binary_f1_score': 0.40564373}
confusion matrix:
       0    1
0  41992  370
1    978  460
---- Validation: 
scalar performance:
{'acc': 0.96739596, 'precision': 0.8009925, 'recall': 0.6090059, 'specificity': 0.6090059, 'f1': 0.6563001, 'auroc': 0.9265657, 'binary_precision': 0.6302521, 'binary_recall': 0.22288261, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.32930842}
confusion matrix:
       0    1
0  17979   88
1    523  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.9819257, 'recall': 0.5711539, 'specificity': 0.5711539, 'f1': 0.61537564, 'auroc': 0.8877791, 'binary_precision': 1.0, 'binary_recall': 0.1423077, 'binary_specificity': 1.0, 'binary_f1_score': 0.24915825}
confusion matrix:
      0   1
0  5946   0
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_12.png
better model found
persisted
after epoch: 12,now: 2024-06-17 07:23:55.666143,epoch time: 0:24:53.925445,used: 4:58:32.342863,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.968379, 'precision': 0.7555646, 'recall': 0.63926506, 'specificity': 0.63926506, 'f1': 0.67868334, 'auroc': 0.9328462, 'binary_precision': 0.5349741, 'binary_recall': 0.28700486, 'binary_specificity': 0.99152523, 'binary_f1_score': 0.37358662}
confusion matrix:
       0    1
0  42002  359
1   1026  413
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.80088377, 'recall': 0.5872158, 'specificity': 0.5872158, 'f1': 0.6305428, 'auroc': 0.9262892, 'binary_precision': 0.6315789, 'binary_recall': 0.17830609, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.27809963}
confusion matrix:
       0    1
0  17997   70
1    553  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.9812237, 'recall': 0.5538462, 'specificity': 0.5538462, 'f1': 0.5876544, 'auroc': 0.8886302, 'binary_precision': 1.0, 'binary_recall': 0.10769231, 'binary_specificity': 1.0, 'binary_f1_score': 0.19444443}
confusion matrix:
      0   1
0  5946   0
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_13.png
early stop counter: 1
val acc:0.9667556285858154, best validation acc: 0.9673959612846375, corresponding to test acc:                         0.9640670418739319 / 0.9642281532287598
after epoch: 13,now: 2024-06-17 07:49:04.869746,epoch time: 0:25:09.203603,used: 5:23:41.546466,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.968379, 'precision': 0.7537444, 'recall': 0.66567516, 'specificity': 0.66567516, 'f1': 0.69955754, 'auroc': 0.93656313, 'binary_precision': 0.5296017, 'binary_recall': 0.34166667, 'binary_specificity': 0.9896837, 'binary_f1_score': 0.4153651}
confusion matrix:
       0    1
0  41923  437
1    948  492
---- Validation: 
scalar performance:
{'acc': 0.96782285, 'precision': 0.7994354, 'recall': 0.62639374, 'specificity': 0.62639374, 'f1': 0.6747116, 'auroc': 0.92996514, 'binary_precision': 0.62589926, 'binary_recall': 0.25854382, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.3659306}
confusion matrix:
       0    1
0  17963  104
1    499  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.96918046, 'recall': 0.5729928, 'specificity': 0.5729928, 'f1': 0.61788535, 'auroc': 0.8909559, 'binary_precision': 0.974359, 'binary_recall': 0.14615385, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.2541806}
confusion matrix:
      0   1
0  5945   1
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_14.png
better model found
persisted
after epoch: 14,now: 2024-06-17 08:13:47.023361,epoch time: 0:24:42.153615,used: 5:48:23.700081,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9691324, 'precision': 0.76645184, 'recall': 0.64694583, 'specificity': 0.64694583, 'f1': 0.68785185, 'auroc': 0.9337609, 'binary_precision': 0.556266, 'binary_recall': 0.30208334, 'binary_specificity': 0.9918083, 'binary_f1_score': 0.3915392}
confusion matrix:
       0    1
0  42013  347
1   1005  435
---- Validation: 
scalar performance:
{'acc': 0.96750265, 'precision': 0.8031203, 'recall': 0.60977656, 'specificity': 0.60977656, 'f1': 0.65742517, 'auroc': 0.9316797, 'binary_precision': 0.6344538, 'binary_recall': 0.2243685, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.3315038}
confusion matrix:
       0    1
0  17980   87
1    522  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.9809123, 'recall': 0.54615384, 'specificity': 0.54615384, 'f1': 0.5747775, 'auroc': 0.89107335, 'binary_precision': 1.0, 'binary_recall': 0.092307694, 'binary_specificity': 1.0, 'binary_f1_score': 0.1690141}
confusion matrix:
      0   1
0  5946   0
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_15.png
early stop counter: 1
val acc:0.9675026535987854, best validation acc: 0.9678228497505188, corresponding to test acc:                         0.9640670418739319 / 0.9642281532287598
after epoch: 15,now: 2024-06-17 08:38:40.464152,epoch time: 0:24:53.440791,used: 6:13:17.140872,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9693379, 'precision': 0.76485354, 'recall': 0.67243135, 'specificity': 0.67243135, 'f1': 0.7079493, 'auroc': 0.9372128, 'binary_precision': 0.55135137, 'binary_recall': 0.35465926, 'binary_specificity': 0.9902035, 'binary_f1_score': 0.4316547}
confusion matrix:
       0    1
0  41947  415
1    928  510
---- Validation: 
scalar performance:
{'acc': 0.9681964, 'precision': 0.80333054, 'recall': 0.6330249, 'specificity': 0.6330249, 'f1': 0.68206835, 'auroc': 0.93406415, 'binary_precision': 0.633218, 'binary_recall': 0.27191678, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.38045734}
confusion matrix:
       0    1
0  17961  106
1    490  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.9820039, 'recall': 0.5730769, 'specificity': 0.5730769, 'f1': 0.61835384, 'auroc': 0.8950065, 'binary_precision': 1.0, 'binary_recall': 0.14615385, 'binary_specificity': 1.0, 'binary_f1_score': 0.25503358}
confusion matrix:
      0   1
0  5946   0
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_16.png
better model found
persisted
after epoch: 16,now: 2024-06-17 09:03:28.907971,epoch time: 0:24:48.443819,used: 6:38:05.584691,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97018266, 'precision': 0.781953, 'recall': 0.6556761, 'specificity': 0.6556761, 'f1': 0.699, 'auroc': 0.9383228, 'binary_precision': 0.5867347, 'binary_recall': 0.31900138, 'binary_specificity': 0.99235094, 'binary_f1_score': 0.41329738}
confusion matrix:
       0    1
0  42034  324
1    982  460
---- Validation: 
scalar performance:
{'acc': 0.9680363, 'precision': 0.8163613, 'recall': 0.61076856, 'specificity': 0.61076856, 'f1': 0.6601396, 'auroc': 0.93343186, 'binary_precision': 0.66086954, 'binary_recall': 0.22585438, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.3366556}
confusion matrix:
       0    1
0  17989   78
1    521  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.9809123, 'recall': 0.54615384, 'specificity': 0.54615384, 'f1': 0.5747775, 'auroc': 0.8916911, 'binary_precision': 1.0, 'binary_recall': 0.092307694, 'binary_specificity': 1.0, 'binary_f1_score': 0.1690141}
confusion matrix:
      0   1
0  5946   0
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_17.png
early stop counter: 1
val acc:0.9680362939834595, best validation acc: 0.9681963920593262, corresponding to test acc:                         0.9642281532287598 / 0.9642281532287598
after epoch: 17,now: 2024-06-17 09:28:36.969258,epoch time: 0:25:08.061287,used: 7:03:13.645978,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9692694, 'precision': 0.7706189, 'recall': 0.6408017, 'specificity': 0.6408017, 'f1': 0.6834057, 'auroc': 0.9401618, 'binary_precision': 0.56504065, 'binary_recall': 0.28918168, 'binary_specificity': 0.99242175, 'binary_f1_score': 0.3825688}
confusion matrix:
       0    1
0  42037  321
1   1025  417
---- Validation: 
scalar performance:
{'acc': 0.96734256, 'precision': 0.821236, 'recall': 0.586805, 'specificity': 0.586805, 'f1': 0.63164616, 'auroc': 0.93190515, 'binary_precision': 0.6723164, 'binary_recall': 0.1768202, 'binary_specificity': 0.99678975, 'binary_f1_score': 0.28}
confusion matrix:
       0    1
0  18009   58
1    554  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.98005813, 'recall': 0.525, 'specificity': 0.525, 'f1': 0.53744525, 'auroc': 0.8922129, 'binary_precision': 1.0, 'binary_recall': 0.05, 'binary_specificity': 1.0, 'binary_f1_score': 0.095238104}
confusion matrix:
      0   1
0  5946   0
1   247  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_18.png
early stop counter: 2
val acc:0.9673425555229187, best validation acc: 0.9681963920593262, corresponding to test acc:                         0.9642281532287598 / 0.9642281532287598
after epoch: 18,now: 2024-06-17 09:53:55.366139,epoch time: 0:25:18.396881,used: 7:28:32.042859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96981734, 'precision': 0.77823025, 'recall': 0.64370096, 'specificity': 0.64370096, 'f1': 0.6876544, 'auroc': 0.9414247, 'binary_precision': 0.58002734, 'binary_recall': 0.29464906, 'binary_specificity': 0.9927528, 'binary_f1_score': 0.39078343}
confusion matrix:
       0    1
0  42054  307
1   1015  424
---- Validation: 
scalar performance:
{'acc': 0.96755606, 'precision': 0.8203877, 'recall': 0.5933531, 'specificity': 0.5933531, 'f1': 0.6398458, 'auroc': 0.93295574, 'binary_precision': 0.6701571, 'binary_recall': 0.19019316, 'binary_specificity': 0.996513, 'binary_f1_score': 0.29629627}
confusion matrix:
       0    1
0  18004   63
1    545  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.8932065, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_19.png
early stop counter: 3
val acc:0.9675560593605042, best validation acc: 0.9681963920593262, corresponding to test acc:                         0.9642281532287598 / 0.9642281532287598
after epoch: 19,now: 2024-06-17 10:20:20.841769,epoch time: 0:26:25.475630,used: 7:54:57.518489,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9705708, 'precision': 0.782406, 'recall': 0.67474574, 'specificity': 0.67474574, 'f1': 0.7147604, 'auroc': 0.94086576, 'binary_precision': 0.5863636, 'binary_recall': 0.35808465, 'binary_specificity': 0.9914068, 'binary_f1_score': 0.44463593}
confusion matrix:
       0    1
0  41995  364
1    925  516
---- Validation: 
scalar performance:
{'acc': 0.9685699, 'precision': 0.8184249, 'recall': 0.6239201, 'specificity': 0.6239201, 'f1': 0.6749352, 'auroc': 0.934008, 'binary_precision': 0.6640625, 'binary_recall': 0.25260028, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.3659849}
confusion matrix:
       0    1
0  17981   86
1    503  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.9806014, 'recall': 0.53846157, 'specificity': 0.53846157, 'f1': 0.5615374, 'auroc': 0.89271826, 'binary_precision': 1.0, 'binary_recall': 0.07692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.14285713}
confusion matrix:
      0   1
0  5946   0
1   240  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_20.png
better model found
persisted
after epoch: 20,now: 2024-06-17 10:46:22.561575,epoch time: 0:26:01.719806,used: 8:20:59.238295,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9699543, 'precision': 0.7741629, 'recall': 0.67051464, 'specificity': 0.67051464, 'f1': 0.7091514, 'auroc': 0.94096714, 'binary_precision': 0.5701358, 'binary_recall': 0.35, 'binary_specificity': 0.99102926, 'binary_f1_score': 0.43373495}
confusion matrix:
       0    1
0  41980  380
1    936  504
---- Validation: 
scalar performance:
{'acc': 0.9686233, 'precision': 0.8184919, 'recall': 0.6253783, 'specificity': 0.6253783, 'f1': 0.67650515, 'auroc': 0.93543494, 'binary_precision': 0.66409266, 'binary_recall': 0.25557205, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.3690987}
confusion matrix:
       0    1
0  17980   87
1    501  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.98083454, 'recall': 0.54423076, 'specificity': 0.54423076, 'f1': 0.5715021, 'auroc': 0.893471, 'binary_precision': 1.0, 'binary_recall': 0.08846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.16254418}
confusion matrix:
      0   1
0  5946   0
1   237  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_21.png
better model found
persisted
after epoch: 21,now: 2024-06-17 11:10:54.616271,epoch time: 0:24:32.054696,used: 8:45:31.292991,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9706393, 'precision': 0.78337574, 'recall': 0.6760084, 'specificity': 0.6760084, 'f1': 0.71601933, 'auroc': 0.9443476, 'binary_precision': 0.5882353, 'binary_recall': 0.36061028, 'binary_specificity': 0.99140656, 'binary_f1_score': 0.44711953}
confusion matrix:
       0    1
0  41994  364
1    922  520
---- Validation: 
scalar performance:
{'acc': 0.96915686, 'precision': 0.8243729, 'recall': 0.633523, 'specificity': 0.633523, 'f1': 0.6859459, 'auroc': 0.9360353, 'binary_precision': 0.67527676, 'binary_recall': 0.27191678, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.38771188}
confusion matrix:
       0    1
0  17979   88
1    490  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.98114586, 'recall': 0.5519231, 'specificity': 0.5519231, 'f1': 0.58446836, 'auroc': 0.8965932, 'binary_precision': 1.0, 'binary_recall': 0.103846155, 'binary_specificity': 1.0, 'binary_f1_score': 0.18815331}
confusion matrix:
      0   1
0  5946   0
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_22.png
better model found
persisted
after epoch: 22,now: 2024-06-17 11:36:00.522759,epoch time: 0:25:05.906488,used: 9:10:37.199479,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97068495, 'precision': 0.784501, 'recall': 0.67435735, 'specificity': 0.67435735, 'f1': 0.71503067, 'auroc': 0.94486904, 'binary_precision': 0.5905963, 'binary_recall': 0.35714287, 'binary_specificity': 0.99157184, 'binary_f1_score': 0.4451167}
confusion matrix:
       0    1
0  42001  357
1    927  515
---- Validation: 
scalar performance:
{'acc': 0.9688367, 'precision': 0.8285932, 'recall': 0.62048215, 'specificity': 0.62048215, 'f1': 0.6725396, 'auroc': 0.935287, 'binary_precision': 0.6846473, 'binary_recall': 0.24517088, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.36105034}
confusion matrix:
       0    1
0  17991   76
1    508  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.9805237, 'recall': 0.5365385, 'specificity': 0.5365385, 'f1': 0.55816877, 'auroc': 0.89246064, 'binary_precision': 1.0, 'binary_recall': 0.073076926, 'binary_specificity': 1.0, 'binary_f1_score': 0.13620071}
confusion matrix:
      0   1
0  5946   0
1   241  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_23.png
early stop counter: 1
val acc:0.9688367247581482, best validation acc: 0.9691568613052368, corresponding to test acc:                         0.962455689907074 / 0.9642281532287598
after epoch: 23,now: 2024-06-17 12:00:20.097227,epoch time: 0:24:19.574468,used: 9:34:56.773947,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97025114, 'precision': 0.7856106, 'recall': 0.6418431, 'specificity': 0.6418431, 'f1': 0.6875102, 'auroc': 0.94176364, 'binary_precision': 0.5948645, 'binary_recall': 0.29038998, 'binary_specificity': 0.9932962, 'binary_f1_score': 0.39026675}
confusion matrix:
       0    1
0  42080  284
1   1019  417
---- Validation: 
scalar performance:
{'acc': 0.9677161, 'precision': 0.818848, 'recall': 0.5991582, 'specificity': 0.5991582, 'f1': 0.6468097, 'auroc': 0.93477064, 'binary_precision': 0.6666667, 'binary_recall': 0.20208023, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.31014824}
confusion matrix:
       0    1
0  17999   68
1    537  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.9799806, 'recall': 0.52307695, 'specificity': 0.52307695, 'f1': 0.5339035, 'auroc': 0.89101803, 'binary_precision': 1.0, 'binary_recall': 0.046153847, 'binary_specificity': 1.0, 'binary_f1_score': 0.08823529}
confusion matrix:
      0   1
0  5946   0
1   248  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_24.png
early stop counter: 2
val acc:0.9677160978317261, best validation acc: 0.9691568613052368, corresponding to test acc:                         0.962455689907074 / 0.9642281532287598
after epoch: 24,now: 2024-06-17 12:25:14.946612,epoch time: 0:24:54.849385,used: 9:59:51.623332,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9712329, 'precision': 0.79628813, 'recall': 0.662894, 'specificity': 0.662894, 'f1': 0.7085817, 'auroc': 0.94277716, 'binary_precision': 0.6148909, 'binary_recall': 0.33287004, 'binary_specificity': 0.992918, 'binary_f1_score': 0.43192062}
confusion matrix:
       0    1
0  42061  300
1    960  479
---- Validation: 
scalar performance:
{'acc': 0.9683031, 'precision': 0.82446986, 'recall': 0.61019164, 'specificity': 0.61019164, 'f1': 0.6604085, 'auroc': 0.93536466, 'binary_precision': 0.67713004, 'binary_recall': 0.2243685, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.33705357}
confusion matrix:
       0    1
0  17995   72
1    522  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.9799806, 'recall': 0.52307695, 'specificity': 0.52307695, 'f1': 0.5339035, 'auroc': 0.8901845, 'binary_precision': 1.0, 'binary_recall': 0.046153847, 'binary_specificity': 1.0, 'binary_f1_score': 0.08823529}
confusion matrix:
      0   1
0  5946   0
1   248  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_25.png
early stop counter: 3
val acc:0.9683030843734741, best validation acc: 0.9691568613052368, corresponding to test acc:                         0.962455689907074 / 0.9642281532287598
after epoch: 25,now: 2024-06-17 12:50:31.843735,epoch time: 0:25:16.897123,used: 10:25:08.520455,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.97050226, 'precision': 0.7801235, 'recall': 0.677621, 'specificity': 0.677621, 'f1': 0.7163548, 'auroc': 0.94476914, 'binary_precision': 0.58157605, 'binary_recall': 0.36414176, 'binary_specificity': 0.9911003, 'binary_f1_score': 0.44786325}
confusion matrix:
       0    1
0  41984  377
1    915  524
---- Validation: 
scalar performance:
{'acc': 0.9688367, 'precision': 0.8257292, 'recall': 0.6233432, 'specificity': 0.6233432, 'f1': 0.67530984, 'auroc': 0.93734527, 'binary_precision': 0.6787149, 'binary_recall': 0.2511144, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.36659434}
confusion matrix:
       0    1
0  17987   80
1    504  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.980446, 'recall': 0.5346154, 'specificity': 0.5346154, 'f1': 0.55477625, 'auroc': 0.89261806, 'binary_precision': 1.0, 'binary_recall': 0.06923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.12949641}
confusion matrix:
      0   1
0  5946   0
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_26.png
early stop counter: 4
val acc:0.9688367247581482, best validation acc: 0.9691568613052368, corresponding to test acc:                         0.962455689907074 / 0.9642281532287598
after epoch: 26,now: 2024-06-17 13:15:30.887781,epoch time: 0:24:59.044046,used: 10:50:07.564501,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.970548, 'precision': 0.78141475, 'recall': 0.67618823, 'specificity': 0.67618823, 'f1': 0.71561176, 'auroc': 0.9456029, 'binary_precision': 0.58426964, 'binary_recall': 0.3611111, 'binary_specificity': 0.99126536, 'binary_f1_score': 0.44635192}
confusion matrix:
       0    1
0  41990  370
1    920  520
---- Validation: 
scalar performance:
{'acc': 0.9687834, 'precision': 0.8264583, 'recall': 0.62116975, 'specificity': 0.62116975, 'f1': 0.6730252, 'auroc': 0.9372833, 'binary_precision': 0.6803279, 'binary_recall': 0.24665676, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.36205018}
confusion matrix:
       0    1
0  17989   78
1    507  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.97990316, 'recall': 0.52115387, 'specificity': 0.52115387, 'f1': 0.5303359, 'auroc': 0.89081234, 'binary_precision': 1.0, 'binary_recall': 0.042307694, 'binary_specificity': 1.0, 'binary_f1_score': 0.08118081}
confusion matrix:
      0   1
0  5946   0
1   249  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_27.png
early stop counter: 5
val acc:0.9687833786010742, best validation acc: 0.9691568613052368, corresponding to test acc:                         0.962455689907074 / 0.9642281532287598
after epoch: 27,now: 2024-06-17 13:40:37.838085,epoch time: 0:25:06.950304,used: 11:15:14.514805,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97075343, 'precision': 0.78620166, 'recall': 0.6720482, 'specificity': 0.6720482, 'f1': 0.7136495, 'auroc': 0.9454076, 'binary_precision': 0.59415203, 'binary_recall': 0.35228848, 'binary_specificity': 0.99180794, 'binary_f1_score': 0.44231606}
confusion matrix:
       0    1
0  42011  347
1    934  508
---- Validation: 
scalar performance:
{'acc': 0.9695304, 'precision': 0.82801616, 'recall': 0.63943887, 'specificity': 0.63943887, 'f1': 0.6926036, 'auroc': 0.93764406, 'binary_precision': 0.68214285, 'binary_recall': 0.28380385, 'binary_specificity': 0.9950739, 'binary_f1_score': 0.40083945}
confusion matrix:
       0    1
0  17978   89
1    482  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.9803684, 'recall': 0.5326923, 'specificity': 0.5326923, 'f1': 0.55135953, 'auroc': 0.89422446, 'binary_precision': 1.0, 'binary_recall': 0.06538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.12274369}
confusion matrix:
      0   1
0  5946   0
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_28.png
better model found
persisted
after epoch: 28,now: 2024-06-17 14:06:04.514618,epoch time: 0:25:26.676533,used: 11:40:41.191338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9716667, 'precision': 0.7894607, 'recall': 0.70231926, 'specificity': 0.70231926, 'f1': 0.73746973, 'auroc': 0.9461015, 'binary_precision': 0.59859157, 'binary_recall': 0.41405708, 'binary_specificity': 0.9905814, 'binary_f1_score': 0.48951054}
confusion matrix:
       0    1
0  41964  399
1    842  595
---- Validation: 
scalar performance:
{'acc': 0.96947706, 'precision': 0.8190192, 'recall': 0.6494249, 'specificity': 0.6494249, 'f1': 0.7009216, 'auroc': 0.9387469, 'binary_precision': 0.6634304, 'binary_recall': 0.30460623, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.41751525}
confusion matrix:
       0    1
0  17963  104
1    468  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.9812237, 'recall': 0.5538462, 'specificity': 0.5538462, 'f1': 0.5876544, 'auroc': 0.8928585, 'binary_precision': 1.0, 'binary_recall': 0.10769231, 'binary_specificity': 1.0, 'binary_f1_score': 0.19444443}
confusion matrix:
      0   1
0  5946   0
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_29.png
early stop counter: 1
val acc:0.9694770574569702, best validation acc: 0.9695304036140442, corresponding to test acc:                         0.9608443379402161 / 0.9642281532287598
after epoch: 29,now: 2024-06-17 14:29:24.445928,epoch time: 0:23:19.931310,used: 12:04:01.122648,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.97091323, 'precision': 0.7831293, 'recall': 0.69134647, 'specificity': 0.69134647, 'f1': 0.72754806, 'auroc': 0.94949067, 'binary_precision': 0.5867082, 'binary_recall': 0.39208883, 'binary_specificity': 0.9906041, 'binary_f1_score': 0.47004992}
confusion matrix:
       0    1
0  41961  398
1    876  565
---- Validation: 
scalar performance:
{'acc': 0.9695304, 'precision': 0.8181039, 'recall': 0.6523137, 'specificity': 0.6523137, 'f1': 0.70350075, 'auroc': 0.9384965, 'binary_precision': 0.6613924, 'binary_recall': 0.31054977, 'binary_specificity': 0.9940776, 'binary_f1_score': 0.42264912}
confusion matrix:
       0    1
0  17960  107
1    464  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.98114586, 'recall': 0.5519231, 'specificity': 0.5519231, 'f1': 0.58446836, 'auroc': 0.8970284, 'binary_precision': 1.0, 'binary_recall': 0.103846155, 'binary_specificity': 1.0, 'binary_f1_score': 0.18815331}
confusion matrix:
      0   1
0  5946   0
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_30.png
early stop counter: 2
val acc:0.9695304036140442, best validation acc: 0.9695304036140442, corresponding to test acc:                         0.9608443379402161 / 0.9642281532287598
after epoch: 30,now: 2024-06-17 14:55:28.434955,epoch time: 0:26:03.989027,used: 12:30:05.111675,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:30:05.111675 at 2024-06-17 14:55:28.434955
persisted model performance metric: 

scalar performance:
{'acc': 0.96084434, 'precision': 0.9803684, 'recall': 0.5326923, 'specificity': 0.5326923, 'f1': 0.55135953, 'auroc': 0.89422446, 'binary_precision': 1.0, 'binary_recall': 0.06538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.12274369}
confusion matrix:
      0   1
0  5946   0
1   243  17
oracle model performance metric: 

scalar performance:
{'acc': 0.96422815, 'precision': 0.9820039, 'recall': 0.5730769, 'specificity': 0.5730769, 'f1': 0.61835384, 'auroc': 0.87973356, 'binary_precision': 1.0, 'binary_recall': 0.14615385, 'binary_specificity': 1.0, 'binary_f1_score': 0.25503358}
confusion matrix:
      0   1
0  5946   0
1   222  38
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool | 167936 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool | 167936 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1428 MiB |    771 TiB |    771 TiB |
|       from large pool | 165120 KiB |   1358 MiB |    771 TiB |    771 TiB |
|       from small pool |  35966 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   2478 MiB |   1012 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   2374 MiB |    982 MiB |
|       from small pool |     74 MiB |     74 MiB |    104 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 568691 GiB | 568690 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 568414 GiB | 568414 GiB |
|       from small pool |   8813 KiB |  16408 KiB |    276 GiB |    276 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   27644 K  |   27642 K  |
|       from large pool |      36    |      76    |    9260 K  |    9260 K  |
|       from small pool |    1242    |    1864    |   18383 K  |   18382 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   27644 K  |   27642 K  |
|       from large pool |      36    |      76    |    9260 K  |    9260 K  |
|       from small pool |    1242    |    1864    |   18383 K  |   18382 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      68    |      19    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      52    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |     453    |   15733 K  |   15733 K  |
|       from large pool |       5    |      11    |    4128 K  |    4128 K  |
|       from small pool |      31    |     448    |   11604 K  |   11604 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1358 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 568691 GiB | 568690 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 568414 GiB | 568414 GiB |
|       from small pool |      0 KiB |  16408 KiB |    276 GiB |    276 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   27644 K  |   27644 K  |
|       from large pool |       2    |      76    |    9260 K  |    9260 K  |
|       from small pool |       0    |    1864    |   18383 K  |   18383 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   27644 K  |   27644 K  |
|       from large pool |       2    |      76    |    9260 K  |    9260 K  |
|       from small pool |       0    |    1864    |   18383 K  |   18383 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   15733 K  |   15733 K  |
|       from large pool |       1    |      11    |    4128 K  |    4128 K  |
|       from small pool |       0    |     448    |   11605 K  |   11605 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1358 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 568691 GiB | 568690 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 568414 GiB | 568414 GiB |
|       from small pool |      0 KiB |  16408 KiB |    276 GiB |    276 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   27644 K  |   27644 K  |
|       from large pool |       2    |      76    |    9260 K  |    9260 K  |
|       from small pool |       0    |    1864    |   18383 K  |   18383 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   27644 K  |   27644 K  |
|       from large pool |       2    |      76    |    9260 K  |    9260 K  |
|       from small pool |       0    |    1864    |   18383 K  |   18383 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   15733 K  |   15733 K  |
|       from large pool |       1    |      11    |    4128 K  |    4128 K  |
|       from small pool |       0    |     448    |   11605 K  |   11605 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390

 Experiment start at: 2024-06-17 15:07:14.415839
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.70722324, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.6636185, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.66407967, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-17 15:32:17.208570,epoch time: 0:25:02.792731,used: 0:25:02.792731,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96577626, 'precision': 0.8348208, 'recall': 0.5061968, 'specificity': 0.5061968, 'f1': 0.503653, 'auroc': 0.8460243, 'binary_precision': 0.7037037, 'binary_recall': 0.012582782, 'binary_specificity': 0.9998108, 'binary_f1_score': 0.024723489}
confusion matrix:
       0   1
0  42282   8
1   1491  19
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.8449382, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.8197535, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_2.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-17 15:57:02.602457,epoch time: 0:24:45.393887,used: 0:49:48.186618,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96559364, 'precision': 0.74358636, 'recall': 0.52046645, 'specificity': 0.52046645, 'f1': 0.5303785, 'auroc': 0.8844311, 'binary_precision': 0.5203252, 'binary_recall': 0.04232804, 'binary_specificity': 0.99860483, 'binary_f1_score': 0.07828746}
confusion matrix:
       0   1
0  42229  59
1   1448  64
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73421586, 'recall': 0.5080305, 'specificity': 0.5080305, 'f1': 0.5079253, 'auroc': 0.8739553, 'binary_precision': 0.5, 'binary_recall': 0.016611295, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.03215434}
confusion matrix:
       0   1
0  18161  10
1    592  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.9810685, 'recall': 0.5123967, 'specificity': 0.5123967, 'f1': 0.51454514, 'auroc': 0.8470787, 'binary_precision': 1.0, 'binary_recall': 0.024793388, 'binary_specificity': 1.0, 'binary_f1_score': 0.048387095}
confusion matrix:
      0  1
0  5997  0
1   236  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_3.png
new oracle model saved
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9621734023094177
after epoch: 3,now: 2024-06-17 16:20:35.887734,epoch time: 0:23:33.285277,used: 1:13:21.471895,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9664612, 'precision': 0.757593, 'recall': 0.5875104, 'specificity': 0.5875104, 'f1': 0.62690175, 'auroc': 0.90417325, 'binary_precision': 0.5438247, 'binary_recall': 0.18043622, 'binary_specificity': 0.9945846, 'binary_f1_score': 0.27096775}
confusion matrix:
       0    1
0  42058  229
1   1240  273
---- Validation: 
scalar performance:
{'acc': 0.968199, 'precision': 0.7470567, 'recall': 0.5451083, 'specificity': 0.5451083, 'f1': 0.57088125, 'auroc': 0.89085764, 'binary_precision': 0.5233645, 'binary_recall': 0.093023255, 'binary_specificity': 0.99719334, 'binary_f1_score': 0.15796897}
confusion matrix:
       0   1
0  18120  51
1    546  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.983629, 'recall': 0.5805785, 'specificity': 0.5805785, 'f1': 0.63046837, 'auroc': 0.86105037, 'binary_precision': 1.0, 'binary_recall': 0.16115703, 'binary_specificity': 1.0, 'binary_f1_score': 0.27758008}
confusion matrix:
      0   1
0  5997   0
1   203  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-17 16:44:54.387719,epoch time: 0:24:18.499985,used: 1:37:39.971880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96618724, 'precision': 0.7499036, 'recall': 0.5972465, 'specificity': 0.5972465, 'f1': 0.6368645, 'auroc': 0.91173714, 'binary_precision': 0.5277778, 'binary_recall': 0.20092532, 'binary_specificity': 0.99356776, 'binary_f1_score': 0.29104835}
confusion matrix:
       0    1
0  42015  272
1   1209  304
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.7610308, 'recall': 0.5525283, 'specificity': 0.5525283, 'f1': 0.5822671, 'auroc': 0.9007621, 'binary_precision': 0.5508475, 'binary_recall': 0.10797342, 'binary_specificity': 0.99708325, 'binary_f1_score': 0.18055557}
confusion matrix:
       0   1
0  18118  53
1    537  65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.98347306, 'recall': 0.5764463, 'specificity': 0.5764463, 'f1': 0.6242141, 'auroc': 0.8720648, 'binary_precision': 1.0, 'binary_recall': 0.15289256, 'binary_specificity': 1.0, 'binary_f1_score': 0.26523295}
confusion matrix:
      0   1
0  5997   0
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_5.png
better model found
persisted
after epoch: 5,now: 2024-06-17 17:08:50.831226,epoch time: 0:23:56.443507,used: 2:01:36.415387,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96650684, 'precision': 0.75215113, 'recall': 0.62991387, 'specificity': 0.62991387, 'f1': 0.6695514, 'auroc': 0.9159881, 'binary_precision': 0.53002614, 'binary_recall': 0.26834103, 'binary_specificity': 0.9914867, 'binary_f1_score': 0.35629666}
confusion matrix:
       0    1
0  41927  360
1   1107  406
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.7597512, 'recall': 0.570278, 'specificity': 0.570278, 'f1': 0.60634446, 'auroc': 0.90674245, 'binary_precision': 0.5471698, 'binary_recall': 0.14451827, 'binary_specificity': 0.99603766, 'binary_f1_score': 0.22864653}
confusion matrix:
       0   1
0  18099  72
1    515  87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.9837071, 'recall': 0.58264464, 'specificity': 0.58264464, 'f1': 0.63356256, 'auroc': 0.87453556, 'binary_precision': 1.0, 'binary_recall': 0.16528925, 'binary_specificity': 1.0, 'binary_f1_score': 0.28368792}
confusion matrix:
      0   1
0  5997   0
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-17 17:33:14.769702,epoch time: 0:24:23.938476,used: 2:26:00.353863,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.7686629, 'recall': 0.5991171, 'specificity': 0.5991171, 'f1': 0.6413887, 'auroc': 0.92120785, 'binary_precision': 0.5651376, 'binary_recall': 0.20383851, 'binary_specificity': 0.99439573, 'binary_f1_score': 0.29961088}
confusion matrix:
       0    1
0  42052  237
1   1203  308
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.7875581, 'recall': 0.5446905, 'specificity': 0.5446905, 'f1': 0.57145524, 'auroc': 0.9088267, 'binary_precision': 0.6043956, 'binary_recall': 0.091362126, 'binary_specificity': 0.9980188, 'binary_f1_score': 0.15873015}
confusion matrix:
       0   1
0  18135  36
1    547  55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.98285025, 'recall': 0.55991733, 'specificity': 0.55991733, 'f1': 0.59828657, 'auroc': 0.87591606, 'binary_precision': 1.0, 'binary_recall': 0.11983471, 'binary_specificity': 1.0, 'binary_f1_score': 0.21402216}
confusion matrix:
      0   1
0  5997   0
1   213  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_7.png
better model found
persisted
after epoch: 7,now: 2024-06-17 17:57:09.434179,epoch time: 0:23:54.664477,used: 2:49:55.018340,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96643835, 'precision': 0.7509861, 'recall': 0.6274046, 'specificity': 0.6274046, 'f1': 0.6670267, 'auroc': 0.9228337, 'binary_precision': 0.52785146, 'binary_recall': 0.26322752, 'binary_specificity': 0.99158156, 'binary_f1_score': 0.3512798}
confusion matrix:
       0    1
0  41932  356
1   1114  398
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.76651525, 'recall': 0.5631056, 'specificity': 0.5631056, 'f1': 0.5973159, 'auroc': 0.91479355, 'binary_precision': 0.5611511, 'binary_recall': 0.1295681, 'binary_specificity': 0.996643, 'binary_f1_score': 0.2105263}
confusion matrix:
       0   1
0  18110  61
1    524  78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.9698789, 'recall': 0.5742968, 'specificity': 0.5742968, 'f1': 0.62054795, 'auroc': 0.8841585, 'binary_precision': 0.972973, 'binary_recall': 0.14876033, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.25806454}
confusion matrix:
      0   1
0  5996   1
1   206  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_8.png
early stop counter: 1
val acc:0.9688382148742676, best validation acc: 0.968944787979126, corresponding to test acc:                         0.9658598899841309 / 0.9676229953765869
after epoch: 8,now: 2024-06-17 18:20:16.548217,epoch time: 0:23:07.114038,used: 3:13:02.132378,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9675571, 'precision': 0.7656952, 'recall': 0.6467087, 'specificity': 0.6467087, 'f1': 0.6873845, 'auroc': 0.9253799, 'binary_precision': 0.5559611, 'binary_recall': 0.30204892, 'binary_specificity': 0.99136853, 'binary_f1_score': 0.3914347}
confusion matrix:
       0    1
0  41922  365
1   1056  457
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.75355786, 'recall': 0.5750137, 'specificity': 0.5750137, 'f1': 0.6118225, 'auroc': 0.9181609, 'binary_precision': 0.5344828, 'binary_recall': 0.15448505, 'binary_specificity': 0.99554235, 'binary_f1_score': 0.23969072}
confusion matrix:
       0   1
0  18090  81
1    509  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.9837071, 'recall': 0.58264464, 'specificity': 0.58264464, 'f1': 0.63356256, 'auroc': 0.88296765, 'binary_precision': 1.0, 'binary_recall': 0.16528925, 'binary_specificity': 1.0, 'binary_f1_score': 0.28368792}
confusion matrix:
      0   1
0  5997   0
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_9.png
early stop counter: 2
val acc:0.9685719013214111, best validation acc: 0.968944787979126, corresponding to test acc:                         0.9658598899841309 / 0.9676229953765869
after epoch: 9,now: 2024-06-17 18:48:05.724086,epoch time: 0:27:49.175869,used: 3:40:51.308247,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9678311, 'precision': 0.76975715, 'recall': 0.64415526, 'specificity': 0.64415526, 'f1': 0.68610054, 'auroc': 0.9266957, 'binary_precision': 0.56423175, 'binary_recall': 0.2964924, 'binary_specificity': 0.9918182, 'binary_f1_score': 0.38872018}
confusion matrix:
       0    1
0  41943  346
1   1063  448
---- Validation: 
scalar performance:
{'acc': 0.9688915, 'precision': 0.7625345, 'recall': 0.5767849, 'specificity': 0.5767849, 'f1': 0.6147982, 'auroc': 0.9195524, 'binary_precision': 0.5523256, 'binary_recall': 0.1578073, 'binary_specificity': 0.99576247, 'binary_f1_score': 0.24547803}
confusion matrix:
       0   1
0  18094  77
1    507  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.9837071, 'recall': 0.58264464, 'specificity': 0.58264464, 'f1': 0.63356256, 'auroc': 0.88382757, 'binary_precision': 1.0, 'binary_recall': 0.16528925, 'binary_specificity': 1.0, 'binary_f1_score': 0.28368792}
confusion matrix:
      0   1
0  5997   0
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_10.png
early stop counter: 3
val acc:0.9688915014266968, best validation acc: 0.968944787979126, corresponding to test acc:                         0.9658598899841309 / 0.9676229953765869
after epoch: 10,now: 2024-06-17 19:15:52.953249,epoch time: 0:27:47.229163,used: 4:08:38.537410,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9670776, 'precision': 0.7607326, 'recall': 0.63244003, 'specificity': 0.63244003, 'f1': 0.67364943, 'auroc': 0.9293779, 'binary_precision': 0.54701984, 'binary_recall': 0.2729676, 'binary_specificity': 0.9919124, 'binary_f1_score': 0.36419752}
confusion matrix:
       0    1
0  41945  342
1   1100  413
---- Validation: 
scalar performance:
{'acc': 0.9692111, 'precision': 0.7688885, 'recall': 0.5849805, 'specificity': 0.5849805, 'f1': 0.6253865, 'auroc': 0.92317396, 'binary_precision': 0.5645161, 'binary_recall': 0.1744186, 'binary_specificity': 0.99554235, 'binary_f1_score': 0.26649743}
confusion matrix:
       0    1
0  18090   81
1    497  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.97112644, 'recall': 0.5804951, 'specificity': 0.5804951, 'f1': 0.6299345, 'auroc': 0.8867435, 'binary_precision': 0.975, 'binary_recall': 0.16115703, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.27659577}
confusion matrix:
      0   1
0  5996   1
1   203  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_11.png
better model found
persisted
after epoch: 11,now: 2024-06-17 19:43:02.371471,epoch time: 0:27:09.418222,used: 4:35:47.955632,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9681507, 'precision': 0.77604854, 'recall': 0.63865983, 'specificity': 0.63865983, 'f1': 0.68251467, 'auroc': 0.9343494, 'binary_precision': 0.5771812, 'binary_recall': 0.28476822, 'binary_specificity': 0.99255145, 'binary_f1_score': 0.38137475}
confusion matrix:
       0    1
0  41975  315
1   1080  430
---- Validation: 
scalar performance:
{'acc': 0.9694242, 'precision': 0.7790873, 'recall': 0.5778631, 'specificity': 0.5778631, 'f1': 0.6175232, 'auroc': 0.92205787, 'binary_precision': 0.58536583, 'binary_recall': 0.15946844, 'binary_specificity': 0.9962578, 'binary_f1_score': 0.25065273}
confusion matrix:
       0   1
0  18103  68
1    506  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.98292804, 'recall': 0.56198347, 'specificity': 0.56198347, 'f1': 0.6016098, 'auroc': 0.8826442, 'binary_precision': 1.0, 'binary_recall': 0.12396694, 'binary_specificity': 1.0, 'binary_f1_score': 0.22058824}
confusion matrix:
      0   1
0  5997   0
1   212  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_12.png
better model found
persisted
after epoch: 12,now: 2024-06-17 20:09:31.179733,epoch time: 0:26:28.808262,used: 5:02:16.763894,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9674429, 'precision': 0.7597506, 'recall': 0.67862415, 'specificity': 0.67862415, 'f1': 0.71090907, 'auroc': 0.9352207, 'binary_precision': 0.5418288, 'binary_recall': 0.36838624, 'binary_specificity': 0.9888621, 'binary_f1_score': 0.4385827}
confusion matrix:
       0    1
0  41817  471
1    955  557
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.75716805, 'recall': 0.61701983, 'specificity': 0.61701983, 'f1': 0.6585544, 'auroc': 0.9276372, 'binary_precision': 0.5390335, 'binary_recall': 0.24086379, 'binary_specificity': 0.9931759, 'binary_f1_score': 0.33295062}
confusion matrix:
       0    1
0  18047  124
1    457  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96906555, 'precision': 0.965694, 'recall': 0.6052052, 'specificity': 0.6052052, 'f1': 0.6649605, 'auroc': 0.891767, 'binary_precision': 0.9622642, 'binary_recall': 0.2107438, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.34576273}
confusion matrix:
      0   1
0  5995   2
1   191  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_13.png
new oracle model saved
early stop counter: 1
val acc:0.9690513014793396, best validation acc: 0.9694241881370544, corresponding to test acc:                         0.9660201668739319 / 0.9690655469894409
after epoch: 13,now: 2024-06-17 20:36:24.115574,epoch time: 0:26:52.935841,used: 5:29:09.699735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9684247, 'precision': 0.7724763, 'recall': 0.67137057, 'specificity': 0.67137057, 'f1': 0.7092884, 'auroc': 0.9364402, 'binary_precision': 0.56776947, 'binary_recall': 0.35231787, 'binary_specificity': 0.99042326, 'binary_f1_score': 0.43481815}
confusion matrix:
       0    1
0  41885  405
1    978  532
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.76470006, 'recall': 0.601872, 'specificity': 0.601872, 'f1': 0.644133, 'auroc': 0.9273448, 'binary_precision': 0.5550661, 'binary_recall': 0.20930232, 'binary_specificity': 0.9944417, 'binary_f1_score': 0.3039807}
confusion matrix:
       0    1
0  18070  101
1    476  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692258, 'precision': 0.9844886, 'recall': 0.6033058, 'specificity': 0.6033058, 'f1': 0.663355, 'auroc': 0.88534266, 'binary_precision': 1.0, 'binary_recall': 0.20661157, 'binary_specificity': 1.0, 'binary_f1_score': 0.34246573}
confusion matrix:
      0   1
0  5997   0
1   192  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_14.png
new oracle model saved
early stop counter: 2
val acc:0.9692643880844116, best validation acc: 0.9694241881370544, corresponding to test acc:                         0.9660201668739319 / 0.9692258238792419
after epoch: 14,now: 2024-06-17 20:59:55.754199,epoch time: 0:23:31.638625,used: 5:52:41.338360,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9679452, 'precision': 0.76795006, 'recall': 0.66539115, 'specificity': 0.66539115, 'f1': 0.70334315, 'auroc': 0.93779254, 'binary_precision': 0.55917484, 'binary_recall': 0.34038335, 'binary_specificity': 0.99039894, 'binary_f1_score': 0.42317173}
confusion matrix:
       0    1
0  41881  406
1    998  515
---- Validation: 
scalar performance:
{'acc': 0.9697971, 'precision': 0.77820265, 'recall': 0.6005411, 'specificity': 0.6005411, 'f1': 0.64442897, 'auroc': 0.92824066, 'binary_precision': 0.58215964, 'binary_recall': 0.20598006, 'binary_specificity': 0.9951021, 'binary_f1_score': 0.30429447}
confusion matrix:
       0    1
0  18082   89
1    478  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.9718777, 'recall': 0.5846274, 'specificity': 0.5846274, 'f1': 0.6360834, 'auroc': 0.88995034, 'binary_precision': 0.97619045, 'binary_recall': 0.1694215, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.28873238}
confusion matrix:
      0   1
0  5996   1
1   201  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_15.png
better model found
persisted
after epoch: 15,now: 2024-06-17 21:21:46.649828,epoch time: 0:21:50.895629,used: 6:14:32.233989,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9683333, 'precision': 0.77009535, 'recall': 0.682799, 'specificity': 0.682799, 'f1': 0.7171949, 'auroc': 0.93991446, 'binary_precision': 0.56225294, 'binary_recall': 0.37607402, 'binary_specificity': 0.98952395, 'binary_f1_score': 0.45069304}
confusion matrix:
       0    1
0  41844  443
1    944  569
---- Validation: 
scalar performance:
{'acc': 0.969584, 'precision': 0.7725338, 'recall': 0.6012341, 'specificity': 0.6012341, 'f1': 0.64447933, 'auroc': 0.9285905, 'binary_precision': 0.5707763, 'binary_recall': 0.2076412, 'binary_specificity': 0.9948269, 'binary_f1_score': 0.3045067}
confusion matrix:
       0    1
0  18077   94
1    477  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.98331726, 'recall': 0.572314, 'specificity': 0.572314, 'f1': 0.61787087, 'auroc': 0.88635635, 'binary_precision': 1.0, 'binary_recall': 0.1446281, 'binary_specificity': 1.0, 'binary_f1_score': 0.25270757}
confusion matrix:
      0   1
0  5997   0
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_16.png
early stop counter: 1
val acc:0.9695839881896973, best validation acc: 0.9697970747947693, corresponding to test acc:                         0.9676229953765869 / 0.9692258238792419
after epoch: 16,now: 2024-06-17 21:45:28.114257,epoch time: 0:23:41.464429,used: 6:38:13.698418,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9682648, 'precision': 0.77178097, 'recall': 0.6666141, 'specificity': 0.6666141, 'f1': 0.7053604, 'auroc': 0.9390348, 'binary_precision': 0.5667396, 'binary_recall': 0.3425926, 'binary_specificity': 0.99063563, 'binary_f1_score': 0.42704043}
confusion matrix:
       0    1
0  41892  396
1    994  518
---- Validation: 
scalar performance:
{'acc': 0.969584, 'precision': 0.7737733, 'recall': 0.59802186, 'specificity': 0.59802186, 'f1': 0.64105916, 'auroc': 0.9295314, 'binary_precision': 0.57345974, 'binary_recall': 0.20099668, 'binary_specificity': 0.99504703, 'binary_f1_score': 0.29766297}
confusion matrix:
       0    1
0  18081   90
1    481  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.98347306, 'recall': 0.5764463, 'specificity': 0.5764463, 'f1': 0.6242141, 'auroc': 0.88601136, 'binary_precision': 1.0, 'binary_recall': 0.15289256, 'binary_specificity': 1.0, 'binary_f1_score': 0.26523295}
confusion matrix:
      0   1
0  5997   0
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_17.png
early stop counter: 2
val acc:0.9695839881896973, best validation acc: 0.9697970747947693, corresponding to test acc:                         0.9676229953765869 / 0.9692258238792419
after epoch: 17,now: 2024-06-17 22:08:53.502990,epoch time: 0:23:25.388733,used: 7:01:39.087151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9692694, 'precision': 0.78706145, 'recall': 0.66512096, 'specificity': 0.66512096, 'f1': 0.7081375, 'auroc': 0.9409047, 'binary_precision': 0.5974329, 'binary_recall': 0.33840054, 'binary_specificity': 0.99184144, 'binary_f1_score': 0.4320675}
confusion matrix:
       0    1
0  41942  345
1   1001  512
---- Validation: 
scalar performance:
{'acc': 0.9697438, 'precision': 0.7755127, 'recall': 0.60372573, 'specificity': 0.60372573, 'f1': 0.647606, 'auroc': 0.9316038, 'binary_precision': 0.5765766, 'binary_recall': 0.21262458, 'binary_specificity': 0.9948269, 'binary_f1_score': 0.3106796}
confusion matrix:
       0    1
0  18077   94
1    474  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.98331726, 'recall': 0.572314, 'specificity': 0.572314, 'f1': 0.61787087, 'auroc': 0.8883955, 'binary_precision': 1.0, 'binary_recall': 0.1446281, 'binary_specificity': 1.0, 'binary_f1_score': 0.25270757}
confusion matrix:
      0   1
0  5997   0
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_18.png
early stop counter: 3
val acc:0.9697437882423401, best validation acc: 0.9697970747947693, corresponding to test acc:                         0.9676229953765869 / 0.9692258238792419
after epoch: 18,now: 2024-06-17 22:33:57.627784,epoch time: 0:25:04.124794,used: 7:26:43.211945,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9689726, 'precision': 0.7768202, 'recall': 0.68686545, 'specificity': 0.68686545, 'f1': 0.72226363, 'auroc': 0.9437349, 'binary_precision': 0.57539684, 'binary_recall': 0.38385177, 'binary_specificity': 0.9898792, 'binary_f1_score': 0.4605002}
confusion matrix:
       0    1
0  41861  428
1    931  580
---- Validation: 
scalar performance:
{'acc': 0.9696905, 'precision': 0.77045083, 'recall': 0.61494094, 'specificity': 0.61494094, 'f1': 0.65871775, 'auroc': 0.9335569, 'binary_precision': 0.56573707, 'binary_recall': 0.2358804, 'binary_specificity': 0.99400145, 'binary_f1_score': 0.33294255}
confusion matrix:
       0    1
0  18062  109
1    460  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.9585457, 'recall': 0.57834566, 'specificity': 0.57834566, 'f1': 0.62630635, 'auroc': 0.89238036, 'binary_precision': 0.95, 'binary_recall': 0.1570248, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.26950356}
confusion matrix:
      0   1
0  5995   2
1   204  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_19.png
early stop counter: 4
val acc:0.9696905016899109, best validation acc: 0.9697970747947693, corresponding to test acc:                         0.9676229953765869 / 0.9692258238792419
after epoch: 19,now: 2024-06-17 22:58:05.293483,epoch time: 0:24:07.665699,used: 7:50:50.877644,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96984017, 'precision': 0.79283154, 'recall': 0.6723178, 'specificity': 0.6723178, 'f1': 0.7155416, 'auroc': 0.9408226, 'binary_precision': 0.6084475, 'binary_recall': 0.35274652, 'binary_specificity': 0.9918891, 'binary_f1_score': 0.44658566}
confusion matrix:
       0    1
0  41946  343
1    978  533
---- Validation: 
scalar performance:
{'acc': 0.9695307, 'precision': 0.77510387, 'recall': 0.59156996, 'specificity': 0.59156996, 'f1': 0.63382125, 'auroc': 0.92883503, 'binary_precision': 0.57653064, 'binary_recall': 0.18770765, 'binary_specificity': 0.99543226, 'binary_f1_score': 0.283208}
confusion matrix:
       0    1
0  18088   83
1    489  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.98292804, 'recall': 0.56198347, 'specificity': 0.56198347, 'f1': 0.6016098, 'auroc': 0.88469887, 'binary_precision': 1.0, 'binary_recall': 0.12396694, 'binary_specificity': 1.0, 'binary_f1_score': 0.22058824}
confusion matrix:
      0   1
0  5997   0
1   212  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_20.png
early stop counter: 5
val acc:0.9695307016372681, best validation acc: 0.9697970747947693, corresponding to test acc:                         0.9676229953765869 / 0.9692258238792419
after epoch: 20,now: 2024-06-17 23:23:48.920718,epoch time: 0:25:43.627235,used: 8:16:34.504879,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9686758, 'precision': 0.7750727, 'recall': 0.6765011, 'specificity': 0.6765011, 'f1': 0.7139841, 'auroc': 0.9442556, 'binary_precision': 0.5726228, 'binary_recall': 0.36267373, 'binary_specificity': 0.99032843, 'binary_f1_score': 0.44408426}
confusion matrix:
       0    1
0  41880  409
1    963  548
---- Validation: 
scalar performance:
{'acc': 0.9697438, 'precision': 0.7745819, 'recall': 0.6061349, 'specificity': 0.6061349, 'f1': 0.6500963, 'auroc': 0.9327173, 'binary_precision': 0.5745614, 'binary_recall': 0.21760798, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.31566265}
confusion matrix:
       0    1
0  18074   97
1    471  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.98331726, 'recall': 0.572314, 'specificity': 0.572314, 'f1': 0.61787087, 'auroc': 0.88947225, 'binary_precision': 1.0, 'binary_recall': 0.1446281, 'binary_specificity': 1.0, 'binary_f1_score': 0.25270757}
confusion matrix:
      0   1
0  5997   0
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_21.png
early stop counter: 6
val acc:0.9697437882423401, best validation acc: 0.9697970747947693, corresponding to test acc:                         0.9676229953765869 / 0.9692258238792419
after epoch: 21,now: 2024-06-17 23:47:54.950467,epoch time: 0:24:06.029749,used: 8:40:40.534628,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9691324, 'precision': 0.7799575, 'recall': 0.68416876, 'specificity': 0.68416876, 'f1': 0.7212235, 'auroc': 0.9446889, 'binary_precision': 0.5818922, 'binary_recall': 0.37805685, 'binary_specificity': 0.9902807, 'binary_f1_score': 0.45833337}
confusion matrix:
       0    1
0  41876  411
1    941  572
---- Validation: 
scalar performance:
{'acc': 0.9695307, 'precision': 0.76710784, 'recall': 0.6148584, 'specificity': 0.6148584, 'f1': 0.6580928, 'auroc': 0.93305886, 'binary_precision': 0.5590551, 'binary_recall': 0.2358804, 'binary_specificity': 0.99383634, 'binary_f1_score': 0.3317757}
confusion matrix:
       0    1
0  18059  112
1    460  142
---- Test Domain (oracle): 
scalar performance:
--- Logging error ---
confusion matrix:
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_22.png
early stop counter: 7
val acc:0.9695307016372681, best validation acc: 0.9697970747947693, corresponding to test acc:                         0.9676229953765869 / 0.9692258238792419
after epoch: 22,now: 2024-06-18 00:13:04.945252,epoch time: 0:25:09.994785,used: 9:05:50.529413,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_14_seed_2_21328390
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96997714, 'precision': 0.79387593, 'recall': 0.6769588, 'specificity': 0.6769588, 'f1': 0.71957344, 'auroc': 0.94286585, 'binary_precision': 0.610245, 'binary_recall': 0.36219433, 'binary_specificity': 0.99172324, 'binary_f1_score': 0.45458317}
confusion matrix:
       0    1
0  41937  350
1    965  548
---- Validation: 
scalar performance:
{'acc': 0.9698503, 'precision': 0.77648413, 'recall': 0.607796, 'specificity': 0.607796, 'f1': 0.65214753, 'auroc': 0.9325228, 'binary_precision': 0.5782609, 'binary_recall': 0.22093023, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.31971154}
confusion matrix:
       0    1
0  18074   97
1    469  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.9833951, 'recall': 0.57438016, 'specificity': 0.57438016, 'f1': 0.6210538, 'auroc': 0.8892807, 'binary_precision': 1.0, 'binary_recall': 0.14876033, 'binary_specificity': 1.0, 'binary_f1_score': 0.25899282}
confusion matrix:
      0   1
0  5997   0
1   206  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328390_23.png
[Tue Jun 18 00:38:33 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/rule_results/1.csv

RuleException:
RuntimeError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[enforce fail at inline_container.cc:595] . unexpected pos 77771200 vs 77771032
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 49, in tr_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 70, in after_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 60, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/a_model_sel.py", line 63, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/c_msel_oracle.py", line 37, in base_update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model.py", line 159, in save
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_utils.py", line 89, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 627, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 475, in __exit__
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
