Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jun  7 01:17:50 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177

 Experiment start at: 2024-06-07 01:26:00.472774
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96997166, 'precision': 0.77376366, 'recall': 0.72002316, 'specificity': 0.72002316, 'f1': 0.7436769, 'auroc': 0.9473114, 'binary_precision': 0.5664395, 'binary_recall': 0.45207343, 'binary_specificity': 0.98797286, 'binary_f1_score': 0.5028355}
confusion matrix:
       0    1
0  41812  509
1    806  665
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.969934, 'precision': 0.8071104, 'recall': 0.63640875, 'specificity': 0.63640875, 'f1': 0.6862271, 'auroc': 0.949924, 'binary_precision': 0.63928574, 'binary_recall': 0.27838257, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.38786566}
confusion matrix:
       0    1
0  18048  101
1    464  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.86933875, 'recall': 0.626685, 'specificity': 0.626685, 'f1': 0.6837352, 'auroc': 0.9325801, 'binary_precision': 0.77011496, 'binary_recall': 0.256705, 'binary_specificity': 0.996665, 'binary_f1_score': 0.38505748}
confusion matrix:
      0   1
0  5977  20
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-07 01:53:21.547242,epoch time: 0:27:21.074468,used: 0:27:21.074468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96997166, 'precision': 0.7653395, 'recall': 0.8398777, 'specificity': 0.8398777, 'f1': 0.7974924, 'auroc': 0.96156234, 'binary_precision': 0.5412074, 'binary_recall': 0.7004076, 'binary_specificity': 0.9793478, 'binary_f1_score': 0.6106011}
confusion matrix:
       0     1
0  41446   874
1    441  1031
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.75446177, 'recall': 0.8429619, 'specificity': 0.8429619, 'f1': 0.7913592, 'auroc': 0.9584949, 'binary_precision': 0.5193622, 'binary_recall': 0.70917577, 'binary_specificity': 0.97674805, 'binary_f1_score': 0.5996055}
confusion matrix:
       0    1
0  17727  422
1    187  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9758709, 'precision': 0.87621456, 'recall': 0.7968477, 'specificity': 0.7968477, 'f1': 0.8313694, 'auroc': 0.94844484, 'binary_precision': 0.76960784, 'binary_recall': 0.6015326, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.67526877}
confusion matrix:
      0    1
0  5950   47
1   104  157
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_2.png
new oracle model saved
early stop counter: 1
val acc:0.9675925970077515, best validation acc: 0.9699339866638184, corresponding to test acc:                         0.9658037424087524 / 0.9758709073066711
after epoch: 2,now: 2024-06-07 02:19:35.077782,epoch time: 0:26:13.530540,used: 0:53:34.605008,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97650254, 'precision': 0.8645083, 'recall': 0.7240583, 'specificity': 0.7240583, 'f1': 0.77623105, 'auroc': 0.9665508, 'binary_precision': 0.74775785, 'binary_recall': 0.45343304, 'binary_specificity': 0.9946835, 'binary_f1_score': 0.5645366}
confusion matrix:
       0    1
0  42096  225
1    804  667
---- Validation: 
scalar performance:
{'acc': 0.97307366, 'precision': 0.8702338, 'recall': 0.6522853, 'specificity': 0.6522853, 'f1': 0.71261513, 'auroc': 0.9563823, 'binary_precision': 0.76447874, 'binary_recall': 0.30793157, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.4390244}
confusion matrix:
       0    1
0  18088   61
1    445  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.9746985, 'recall': 0.60719633, 'specificity': 0.60719633, 'f1': 0.66765666, 'auroc': 0.95183766, 'binary_precision': 0.98245615, 'binary_recall': 0.21455939, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.35220128}
confusion matrix:
      0   1
0  5996   1
1   205  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_3.png
better model found
persisted
after epoch: 3,now: 2024-06-07 02:45:48.122283,epoch time: 0:26:13.044501,used: 1:19:47.649509,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97926563, 'precision': 0.88514, 'recall': 0.7604265, 'specificity': 0.7604265, 'f1': 0.8098134, 'auroc': 0.97366416, 'binary_precision': 0.7865854, 'binary_recall': 0.5258152, 'binary_specificity': 0.9950378, 'binary_f1_score': 0.63029313}
confusion matrix:
       0    1
0  42110  210
1    698  774
---- Validation: 
scalar performance:
{'acc': 0.97381866, 'precision': 0.93495643, 'recall': 0.63241947, 'specificity': 0.63241947, 'f1': 0.6983421, 'auroc': 0.966179, 'binary_precision': 0.89528793, 'binary_recall': 0.2659409, 'binary_specificity': 0.998898, 'binary_f1_score': 0.41007194}
confusion matrix:
       0    1
0  18129   20
1    472  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.92199135, 'recall': 0.6085284, 'specificity': 0.6085284, 'f1': 0.666151, 'auroc': 0.9535779, 'binary_precision': 0.8769231, 'binary_recall': 0.21839081, 'binary_specificity': 0.998666, 'binary_f1_score': 0.34969327}
confusion matrix:
      0   1
0  5989   8
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_4.png
better model found
persisted
after epoch: 4,now: 2024-06-07 03:12:02.349143,epoch time: 0:26:14.226860,used: 1:46:01.876369,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9805444, 'precision': 0.86585045, 'recall': 0.817152, 'specificity': 0.817152, 'f1': 0.83961785, 'auroc': 0.9744394, 'binary_precision': 0.7440945, 'binary_recall': 0.6419837, 'binary_specificity': 0.9923204, 'binary_f1_score': 0.68927795}
confusion matrix:
       0    1
0  41995  325
1    527  945
---- Validation: 
scalar performance:
{'acc': 0.97945935, 'precision': 0.9040427, 'recall': 0.75159824, 'specificity': 0.75159824, 'f1': 0.8087845, 'auroc': 0.97141904, 'binary_precision': 0.8253164, 'binary_recall': 0.5069984, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.628131}
confusion matrix:
       0    1
0  18080   69
1    317  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.8892355, 'recall': 0.6061958, 'specificity': 0.6061958, 'f1': 0.6607523, 'auroc': 0.9585754, 'binary_precision': 0.8115942, 'binary_recall': 0.21455939, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.33939394}
confusion matrix:
      0   1
0  5984  13
1   205  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_5.png
better model found
persisted
after epoch: 5,now: 2024-06-07 03:38:13.903354,epoch time: 0:26:11.554211,used: 2:12:13.430580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.979631, 'precision': 0.88609517, 'recall': 0.7666881, 'specificity': 0.7666881, 'f1': 0.8146303, 'auroc': 0.9751218, 'binary_precision': 0.7880597, 'binary_recall': 0.53840923, 'binary_specificity': 0.99496704, 'binary_f1_score': 0.6397415}
confusion matrix:
       0    1
0  42108  213
1    679  792
---- Validation: 
scalar performance:
{'acc': 0.97871435, 'precision': 0.9294803, 'recall': 0.71821016, 'specificity': 0.71821016, 'f1': 0.7870696, 'auroc': 0.97108966, 'binary_precision': 0.8785047, 'binary_recall': 0.43856922, 'binary_specificity': 0.99785113, 'binary_f1_score': 0.5850622}
confusion matrix:
       0    1
0  18110   39
1    361  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.92912084, 'recall': 0.5648006, 'specificity': 0.5648006, 'f1': 0.60425836, 'auroc': 0.9608376, 'binary_precision': 0.8947368, 'binary_recall': 0.1302682, 'binary_specificity': 0.999333, 'binary_f1_score': 0.22742477}
confusion matrix:
      0   1
0  5993   4
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_6.png
early stop counter: 1
val acc:0.9787143468856812, best validation acc: 0.9794593453407288, corresponding to test acc:                         0.9651646018028259 / 0.9758709073066711
after epoch: 6,now: 2024-06-07 04:04:12.600396,epoch time: 0:25:58.697042,used: 2:38:12.127622,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98289645, 'precision': 0.89844894, 'recall': 0.81869686, 'specificity': 0.81869686, 'f1': 0.85378885, 'auroc': 0.97962797, 'binary_precision': 0.8092387, 'binary_recall': 0.64266306, 'binary_specificity': 0.99473065, 'binary_f1_score': 0.7163954}
confusion matrix:
       0    1
0  42097  223
1    526  946
---- Validation: 
scalar performance:
{'acc': 0.98137504, 'precision': 0.9255102, 'recall': 0.7675912, 'specificity': 0.7675912, 'f1': 0.8272647, 'auroc': 0.97331494, 'binary_precision': 0.8671679, 'binary_recall': 0.5381026, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.66410744}
confusion matrix:
       0    1
0  18096   53
1    297  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8327093, 'recall': 0.5620512, 'specificity': 0.5620512, 'f1': 0.5972314, 'auroc': 0.9544994, 'binary_precision': 0.70212764, 'binary_recall': 0.12643678, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.21428573}
confusion matrix:
      0   1
0  5983  14
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_7.png
better model found
persisted
after epoch: 7,now: 2024-06-07 04:30:22.424834,epoch time: 0:26:09.824438,used: 3:04:21.952060,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98296493, 'precision': 0.8846222, 'recall': 0.84004307, 'specificity': 0.84004307, 'f1': 0.86084795, 'auroc': 0.9802792, 'binary_precision': 0.7800926, 'binary_recall': 0.6868206, 'binary_specificity': 0.99326557, 'binary_f1_score': 0.73049134}
confusion matrix:
       0     1
0  42035   285
1    461  1011
---- Validation: 
scalar performance:
{'acc': 0.98052365, 'precision': 0.88619244, 'recall': 0.79265225, 'specificity': 0.79265225, 'f1': 0.8324583, 'auroc': 0.97295314, 'binary_precision': 0.7867495, 'binary_recall': 0.59097975, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.6749556}
confusion matrix:
       0    1
0  18046  103
1    263  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.873646, 'recall': 0.65133905, 'specificity': 0.65133905, 'f1': 0.71138656, 'auroc': 0.9608984, 'binary_precision': 0.776699, 'binary_recall': 0.3065134, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.43956044}
confusion matrix:
      0   1
0  5974  23
1   181  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_8.png
early stop counter: 1
val acc:0.9805236458778381, best validation acc: 0.9813750386238098, corresponding to test acc:                         0.9613295197486877 / 0.9758709073066711
after epoch: 8,now: 2024-06-07 04:57:04.557845,epoch time: 0:26:42.133011,used: 3:31:04.085071,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9834673, 'precision': 0.8986778, 'recall': 0.8296977, 'specificity': 0.8296977, 'f1': 0.86066175, 'auroc': 0.98287123, 'binary_precision': 0.808933, 'binary_recall': 0.6648538, 'binary_specificity': 0.9945417, 'binary_f1_score': 0.7298507}
confusion matrix:
       0    1
0  42090  231
1    493  978
---- Validation: 
scalar performance:
{'acc': 0.98169434, 'precision': 0.89199233, 'recall': 0.80900955, 'specificity': 0.80900955, 'f1': 0.84519243, 'auroc': 0.97493297, 'binary_precision': 0.7972167, 'binary_recall': 0.62363917, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.69982547}
confusion matrix:
       0    1
0  18047  102
1    242  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.85455066, 'recall': 0.6188554, 'specificity': 0.6188554, 'f1': 0.6730423, 'auroc': 0.95064163, 'binary_precision': 0.7411765, 'binary_recall': 0.2413793, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.36416185}
confusion matrix:
      0   1
0  5975  22
1   198  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_9.png
better model found
persisted
after epoch: 9,now: 2024-06-07 05:23:42.846212,epoch time: 0:26:38.288367,used: 3:57:42.373438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98296493, 'precision': 0.87152684, 'recall': 0.8632312, 'specificity': 0.8632312, 'f1': 0.86732817, 'auroc': 0.9817404, 'binary_precision': 0.75226164, 'binary_recall': 0.73487425, 'binary_specificity': 0.9915881, 'binary_f1_score': 0.7434663}
confusion matrix:
       0     1
0  41965   356
1    390  1081
---- Validation: 
scalar performance:
{'acc': 0.9838761, 'precision': 0.89649284, 'recall': 0.84689176, 'specificity': 0.84689176, 'f1': 0.8699006, 'auroc': 0.9765957, 'binary_precision': 0.8035714, 'binary_recall': 0.6998445, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.74812967}
confusion matrix:
       0    1
0  18039  110
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.88281703, 'recall': 0.5909535, 'specificity': 0.5909535, 'f1': 0.6403076, 'auroc': 0.95146537, 'binary_precision': 0.8, 'binary_recall': 0.18390805, 'binary_specificity': 0.997999, 'binary_f1_score': 0.2990654}
confusion matrix:
      0   1
0  5985  12
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_10.png
better model found
persisted
after epoch: 10,now: 2024-06-07 05:49:55.957067,epoch time: 0:26:13.110855,used: 4:23:55.484293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98556817, 'precision': 0.8908937, 'recall': 0.8852477, 'specificity': 0.8852477, 'f1': 0.8880484, 'auroc': 0.98426396, 'binary_precision': 0.78951, 'binary_recall': 0.7777023, 'binary_specificity': 0.9927932, 'binary_f1_score': 0.7835616}
confusion matrix:
       0     1
0  42016   305
1    327  1144
---- Validation: 
scalar performance:
{'acc': 0.9830247, 'precision': 0.8791851, 'recall': 0.8569517, 'specificity': 0.8569517, 'f1': 0.86770356, 'auroc': 0.97438705, 'binary_precision': 0.7682119, 'binary_recall': 0.7216174, 'binary_specificity': 0.9922861, 'binary_f1_score': 0.74418604}
confusion matrix:
       0    1
0  18009  140
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.8971522, 'recall': 0.66699827, 'specificity': 0.66699827, 'f1': 0.7312279, 'auroc': 0.9596276, 'binary_precision': 0.8224299, 'binary_recall': 0.33716476, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.47826084}
confusion matrix:
      0   1
0  5978  19
1   173  88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_11.png
early stop counter: 1
val acc:0.9830247163772583, best validation acc: 0.98387610912323, corresponding to test acc:                         0.9640460014343262 / 0.9758709073066711
after epoch: 11,now: 2024-06-07 06:16:09.536260,epoch time: 0:26:13.579193,used: 4:50:09.063486,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9867327, 'precision': 0.9222592, 'recall': 0.8629756, 'specificity': 0.8629756, 'f1': 0.89020514, 'auroc': 0.9861219, 'binary_precision': 0.8538523, 'binary_recall': 0.73029894, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.7872574}
confusion matrix:
       0     1
0  42136   184
1    397  1075
---- Validation: 
scalar performance:
{'acc': 0.9845147, 'precision': 0.918725, 'recall': 0.83072114, 'specificity': 0.83072114, 'f1': 0.86915416, 'auroc': 0.97584546, 'binary_precision': 0.8492063, 'binary_recall': 0.66562986, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.7462947}
confusion matrix:
       0    1
0  18073   76
1    215  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.9215831, 'recall': 0.59520185, 'specificity': 0.59520185, 'f1': 0.64829683, 'auroc': 0.95892215, 'binary_precision': 0.877193, 'binary_recall': 0.19157088, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.3144654}
confusion matrix:
      0   1
0  5990   7
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_12.png
better model found
persisted
after epoch: 12,now: 2024-06-07 06:42:06.870030,epoch time: 0:25:57.333770,used: 5:16:06.397256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9849287, 'precision': 0.910777, 'recall': 0.84302634, 'specificity': 0.84302634, 'f1': 0.87361825, 'auroc': 0.9837189, 'binary_precision': 0.83224225, 'binary_recall': 0.69089675, 'binary_specificity': 0.99515593, 'binary_f1_score': 0.7550112}
confusion matrix:
       0     1
0  42115   205
1    455  1017
---- Validation: 
scalar performance:
{'acc': 0.9837697, 'precision': 0.8826089, 'recall': 0.8670882, 'specificity': 0.8670882, 'f1': 0.87467396, 'auroc': 0.97837806, 'binary_precision': 0.77435064, 'binary_recall': 0.7418352, 'binary_specificity': 0.99234116, 'binary_f1_score': 0.75774425}
confusion matrix:
       0    1
0  18010  139
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8408649, 'recall': 0.61294156, 'specificity': 0.61294156, 'f1': 0.6646698, 'auroc': 0.9440659, 'binary_precision': 0.71428573, 'binary_recall': 0.22988506, 'binary_specificity': 0.995998, 'binary_f1_score': 0.3478261}
confusion matrix:
      0   1
0  5973  24
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_13.png
early stop counter: 1
val acc:0.9837697148323059, best validation acc: 0.9845147132873535, corresponding to test acc:                         0.9651646018028259 / 0.9758709073066711
after epoch: 13,now: 2024-06-07 07:08:00.090156,epoch time: 0:25:53.220126,used: 5:41:59.617382,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9838098, 'precision': 0.9505536, 'recall': 0.7841243, 'specificity': 0.7841243, 'f1': 0.8472018, 'auroc': 0.986894, 'binary_precision': 0.915847, 'binary_recall': 0.570068, 'binary_specificity': 0.9981806, 'binary_f1_score': 0.7027254}
confusion matrix:
       0    1
0  42245   77
1    632  838
---- Validation: 
scalar performance:
{'acc': 0.98094934, 'precision': 0.9536656, 'recall': 0.74036884, 'specificity': 0.74036884, 'f1': 0.81208354, 'auroc': 0.9776862, 'binary_precision': 0.92537314, 'binary_recall': 0.4821151, 'binary_specificity': 0.99862254, 'binary_f1_score': 0.63394684}
confusion matrix:
       0    1
0  18124   25
1    333  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.9793765, 'recall': 0.50574714, 'specificity': 0.50574714, 'f1': 0.50083476, 'auroc': 0.9241967, 'binary_precision': 1.0, 'binary_recall': 0.011494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.022727272}
confusion matrix:
      0  1
0  5997  0
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_14.png
early stop counter: 2
val acc:0.980949342250824, best validation acc: 0.9845147132873535, corresponding to test acc:                         0.9651646018028259 / 0.9758709073066711
after epoch: 14,now: 2024-06-07 07:34:15.282249,epoch time: 0:26:15.192093,used: 6:08:14.809475,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9870981, 'precision': 0.9135612, 'recall': 0.88119686, 'specificity': 0.88119686, 'f1': 0.896667, 'auroc': 0.9879695, 'binary_precision': 0.83518106, 'binary_recall': 0.76766306, 'binary_specificity': 0.99473065, 'binary_f1_score': 0.8}
confusion matrix:
       0     1
0  42097   223
1    342  1130
---- Validation: 
scalar performance:
{'acc': 0.98573864, 'precision': 0.9329745, 'recall': 0.83735526, 'specificity': 0.83735526, 'f1': 0.8787793, 'auroc': 0.97949135, 'binary_precision': 0.8772636, 'binary_recall': 0.67807156, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.7649123}
confusion matrix:
       0    1
0  18088   61
1    207  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.8762569, 'recall': 0.59087014, 'specificity': 0.59087014, 'f1': 0.6398015, 'auroc': 0.952643, 'binary_precision': 0.78688526, 'binary_recall': 0.18390805, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.29813665}
confusion matrix:
      0   1
0  5984  13
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_15.png
better model found
persisted
after epoch: 15,now: 2024-06-07 08:00:31.348988,epoch time: 0:26:16.066739,used: 6:34:30.876214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9880572, 'precision': 0.9280082, 'recall': 0.8803816, 'specificity': 0.8803816, 'f1': 0.9026823, 'auroc': 0.98960733, 'binary_precision': 0.86415964, 'binary_recall': 0.7649456, 'binary_specificity': 0.9958176, 'binary_f1_score': 0.8115315}
confusion matrix:
       0     1
0  42143   177
1    346  1126
---- Validation: 
scalar performance:
{'acc': 0.9844615, 'precision': 0.9371379, 'recall': 0.81119215, 'specificity': 0.81119215, 'f1': 0.862787, 'auroc': 0.9795816, 'binary_precision': 0.8874172, 'binary_recall': 0.62519443, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.7335767}
confusion matrix:
       0    1
0  18098   51
1    241  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.9085984, 'recall': 0.58745563, 'specificity': 0.58745563, 'f1': 0.63689315, 'auroc': 0.94033986, 'binary_precision': 0.8518519, 'binary_recall': 0.17624521, 'binary_specificity': 0.998666, 'binary_f1_score': 0.29206347}
confusion matrix:
      0   1
0  5989   8
1   215  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_16.png
early stop counter: 1
val acc:0.9844614863395691, best validation acc: 0.9857386350631714, corresponding to test acc:                         0.9638862013816833 / 0.9758709073066711
after epoch: 16,now: 2024-06-07 08:26:47.343511,epoch time: 0:26:15.994523,used: 7:00:46.870737,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9864359, 'precision': 0.9721904, 'recall': 0.8116759, 'specificity': 0.8116759, 'f1': 0.87439036, 'auroc': 0.9906007, 'binary_precision': 0.95729166, 'binary_recall': 0.6243206, 'binary_specificity': 0.9990312, 'binary_f1_score': 0.7557565}
confusion matrix:
       0    1
0  42279   41
1    553  919
---- Validation: 
scalar performance:
{'acc': 0.98110896, 'precision': 0.9604405, 'recall': 0.7389513, 'specificity': 0.7389513, 'f1': 0.81235075, 'auroc': 0.9783044, 'binary_precision': 0.9390244, 'binary_recall': 0.47900465, 'binary_specificity': 0.998898, 'binary_f1_score': 0.6343975}
confusion matrix:
       0    1
0  18129   20
1    335  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.9796833, 'recall': 0.51341, 'specificity': 0.51341, 'f1': 0.51575035, 'auroc': 0.9265982, 'binary_precision': 1.0, 'binary_recall': 0.026819924, 'binary_specificity': 1.0, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5997  0
1   254  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_17.png
early stop counter: 2
val acc:0.9811089634895325, best validation acc: 0.9857386350631714, corresponding to test acc:                         0.9638862013816833 / 0.9758709073066711
after epoch: 17,now: 2024-06-07 08:53:11.326308,epoch time: 0:26:23.982797,used: 7:27:10.853534,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98707527, 'precision': 0.90246695, 'recall': 0.8971825, 'specificity': 0.8971825, 'f1': 0.89980584, 'auroc': 0.99005854, 'binary_precision': 0.8118539, 'binary_recall': 0.80081576, 'binary_specificity': 0.9935493, 'binary_f1_score': 0.80629706}
confusion matrix:
       0     1
0  42048   273
1    293  1178
---- Validation: 
scalar performance:
{'acc': 0.9838229, 'precision': 0.88538146, 'recall': 0.8633654, 'specificity': 0.8633654, 'f1': 0.87402195, 'auroc': 0.9773716, 'binary_precision': 0.7801653, 'binary_recall': 0.7340591, 'binary_specificity': 0.9926718, 'binary_f1_score': 0.75641024}
confusion matrix:
       0    1
0  18016  133
1    171  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.873646, 'recall': 0.65133905, 'specificity': 0.65133905, 'f1': 0.71138656, 'auroc': 0.95721006, 'binary_precision': 0.776699, 'binary_recall': 0.3065134, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.43956044}
confusion matrix:
      0   1
0  5974  23
1   181  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_18.png
early stop counter: 3
val acc:0.9838228821754456, best validation acc: 0.9857386350631714, corresponding to test acc:                         0.9638862013816833 / 0.9758709073066711
after epoch: 18,now: 2024-06-07 09:19:19.724780,epoch time: 0:26:08.398472,used: 7:53:19.252006,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9882627, 'precision': 0.95406353, 'recall': 0.8562264, 'specificity': 0.8562264, 'f1': 0.8988087, 'auroc': 0.99107563, 'binary_precision': 0.91797554, 'binary_recall': 0.71467394, 'binary_specificity': 0.99777883, 'binary_f1_score': 0.80366695}
confusion matrix:
       0     1
0  42226    94
1    420  1052
---- Validation: 
scalar performance:
{'acc': 0.98472756, 'precision': 0.930778, 'recall': 0.8218307, 'specificity': 0.8218307, 'f1': 0.8678252, 'auroc': 0.9792899, 'binary_precision': 0.8739496, 'binary_recall': 0.64696735, 'binary_specificity': 0.996694, 'binary_f1_score': 0.74352103}
confusion matrix:
       0    1
0  18089   60
1    227  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.932904, 'recall': 0.5533897, 'specificity': 0.5533897, 'f1': 0.58623725, 'auroc': 0.94064003, 'binary_precision': 0.9032258, 'binary_recall': 0.107279696, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.19178084}
confusion matrix:
      0   1
0  5994   3
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_19.png
early stop counter: 4
val acc:0.9847275614738464, best validation acc: 0.9857386350631714, corresponding to test acc:                         0.9638862013816833 / 0.9758709073066711
after epoch: 19,now: 2024-06-07 09:45:42.561799,epoch time: 0:26:22.837019,used: 8:19:42.089025,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.989473, 'precision': 0.9399829, 'recall': 0.8916056, 'specificity': 0.8916056, 'f1': 0.91427886, 'auroc': 0.99244046, 'binary_precision': 0.88735634, 'binary_recall': 0.7866848, 'binary_specificity': 0.9965265, 'binary_f1_score': 0.83399355}
confusion matrix:
       0     1
0  42173   147
1    314  1158
---- Validation: 
scalar performance:
{'acc': 0.98467433, 'precision': 0.9361063, 'recall': 0.8158027, 'specificity': 0.8158027, 'f1': 0.8656179, 'auroc': 0.9773861, 'binary_precision': 0.88503253, 'binary_recall': 0.63452566, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.7391304}
confusion matrix:
       0    1
0  18096   53
1    235  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.9243773, 'recall': 0.5590535, 'specificity': 0.5590535, 'f1': 0.5951553, 'auroc': 0.92952514, 'binary_precision': 0.8857143, 'binary_recall': 0.118773945, 'binary_specificity': 0.999333, 'binary_f1_score': 0.20945947}
confusion matrix:
      0   1
0  5993   4
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_20.png
early stop counter: 5
val acc:0.984674334526062, best validation acc: 0.9857386350631714, corresponding to test acc:                         0.9638862013816833 / 0.9758709073066711
after epoch: 20,now: 2024-06-07 10:11:36.348913,epoch time: 0:25:53.787114,used: 8:45:35.876139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9856823, 'precision': 0.9346884, 'recall': 0.8303019, 'specificity': 0.8303019, 'f1': 0.8748473, 'auroc': 0.9898796, 'binary_precision': 0.8809739, 'binary_recall': 0.6637228, 'binary_specificity': 0.9968809, 'binary_f1_score': 0.7570709}
confusion matrix:
       0    1
0  42188  132
1    495  977
---- Validation: 
scalar performance:
{'acc': 0.9812154, 'precision': 0.90939736, 'recall': 0.7795094, 'specificity': 0.7795094, 'f1': 0.83128417, 'auroc': 0.97583556, 'binary_precision': 0.8341014, 'binary_recall': 0.562986, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.67223775}
confusion matrix:
       0    1
0  18077   72
1    281  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.91546756, 'recall': 0.5742124, 'specificity': 0.5742124, 'f1': 0.61811435, 'auroc': 0.89631724, 'binary_precision': 0.8666667, 'binary_recall': 0.14942528, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.25490195}
confusion matrix:
      0   1
0  5991   6
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_21.png
early stop counter: 6
val acc:0.9812154173851013, best validation acc: 0.9857386350631714, corresponding to test acc:                         0.9638862013816833 / 0.9758709073066711
after epoch: 21,now: 2024-06-07 10:38:05.912932,epoch time: 0:26:29.564019,used: 9:12:05.440158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.989747, 'precision': 0.9394673, 'recall': 0.8969244, 'specificity': 0.8969244, 'f1': 0.9170302, 'auroc': 0.99249244, 'binary_precision': 0.88595164, 'binary_recall': 0.79741675, 'binary_specificity': 0.996432, 'binary_f1_score': 0.839356}
confusion matrix:
       0     1
0  42170   151
1    298  1173
---- Validation: 
scalar performance:
{'acc': 0.9850468, 'precision': 0.94552183, 'recall': 0.8137454, 'specificity': 0.8137454, 'f1': 0.86736906, 'auroc': 0.9801877, 'binary_precision': 0.90401787, 'binary_recall': 0.62986004, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.74243814}
confusion matrix:
       0    1
0  18106   43
1    238  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.9152898, 'recall': 0.58562326, 'specificity': 0.58562326, 'f1': 0.63463295, 'auroc': 0.9456141, 'binary_precision': 0.86538464, 'binary_recall': 0.1724138, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.28753996}
confusion matrix:
      0   1
0  5990   7
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_22.png
early stop counter: 7
val acc:0.9850468039512634, best validation acc: 0.9857386350631714, corresponding to test acc:                         0.9638862013816833 / 0.9758709073066711
after epoch: 22,now: 2024-06-07 11:04:37.904835,epoch time: 0:26:31.991903,used: 9:38:37.432061,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98945016, 'precision': 0.92647326, 'recall': 0.90798676, 'specificity': 0.90798676, 'f1': 0.9170089, 'auroc': 0.9924036, 'binary_precision': 0.85917497, 'binary_recall': 0.8206522, 'binary_specificity': 0.99532133, 'binary_f1_score': 0.8394718}
confusion matrix:
       0     1
0  42122   198
1    264  1208
---- Validation: 
scalar performance:
{'acc': 0.9857918, 'precision': 0.9096979, 'recall': 0.8658849, 'specificity': 0.8658849, 'f1': 0.88645273, 'auroc': 0.98126924, 'binary_precision': 0.82867134, 'binary_recall': 0.7371695, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.7802469}
confusion matrix:
       0    1
0  18051   98
1    169  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.9107359, 'recall': 0.62168825, 'specificity': 0.62168825, 'f1': 0.6819376, 'auroc': 0.9452528, 'binary_precision': 0.85333335, 'binary_recall': 0.24521072, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.38095236}
confusion matrix:
      0   1
0  5986  11
1   197  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_23.png
better model found
persisted
after epoch: 23,now: 2024-06-07 11:30:56.454211,epoch time: 0:26:18.549376,used: 10:04:55.981437,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9902265, 'precision': 0.9196777, 'recall': 0.93232214, 'specificity': 0.93232214, 'f1': 0.9258984, 'auroc': 0.99329656, 'binary_precision': 0.8438735, 'binary_recall': 0.87024456, 'binary_specificity': 0.9943998, 'binary_f1_score': 0.85685617}
confusion matrix:
       0     1
0  42083   237
1    191  1281
---- Validation: 
scalar performance:
{'acc': 0.9862707, 'precision': 0.90305406, 'recall': 0.88488424, 'specificity': 0.88488424, 'f1': 0.8937421, 'auroc': 0.9807415, 'binary_precision': 0.81402934, 'binary_recall': 0.7760498, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.794586}
confusion matrix:
       0    1
0  18035  114
1    144  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.80176026, 'recall': 0.5728784, 'specificity': 0.5728784, 'f1': 0.6111131, 'auroc': 0.9281932, 'binary_precision': 0.6393443, 'binary_recall': 0.14942528, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.24223602}
confusion matrix:
      0   1
0  5975  22
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_24.png
better model found
persisted
after epoch: 24,now: 2024-06-07 11:56:48.785556,epoch time: 0:25:52.331345,used: 10:30:48.312782,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98979264, 'precision': 0.95059514, 'recall': 0.8855417, 'specificity': 0.8855417, 'f1': 0.9153479, 'auroc': 0.9943152, 'binary_precision': 0.90901834, 'binary_recall': 0.7737772, 'binary_specificity': 0.9973062, 'binary_f1_score': 0.8359633}
confusion matrix:
       0     1
0  42206   114
1    333  1139
---- Validation: 
scalar performance:
{'acc': 0.98589826, 'precision': 0.91513836, 'recall': 0.86068964, 'specificity': 0.86068964, 'f1': 0.88584965, 'auroc': 0.97859883, 'binary_precision': 0.83992803, 'binary_recall': 0.7262831, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.7789825}
confusion matrix:
       0    1
0  18060   89
1    176  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.87067616, 'recall': 0.60402995, 'specificity': 0.60402995, 'f1': 0.6565523, 'auroc': 0.9389446, 'binary_precision': 0.7746479, 'binary_recall': 0.21072797, 'binary_specificity': 0.997332, 'binary_f1_score': 0.33132532}
confusion matrix:
      0   1
0  5981  16
1   206  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_25.png
early stop counter: 1
val acc:0.9858982563018799, best validation acc: 0.9862707257270813, corresponding to test acc:                         0.9610099196434021 / 0.9758709073066711
after epoch: 25,now: 2024-06-07 12:23:40.487563,epoch time: 0:26:51.702007,used: 10:57:40.014789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9917337, 'precision': 0.95183, 'recall': 0.9173647, 'specificity': 0.9173647, 'f1': 0.9338616, 'auroc': 0.9947337, 'binary_precision': 0.90929204, 'binary_recall': 0.8376359, 'binary_specificity': 0.99709356, 'binary_f1_score': 0.8719943}
confusion matrix:
       0     1
0  42197   123
1    239  1233
---- Validation: 
scalar performance:
{'acc': 0.9872818, 'precision': 0.9182904, 'recall': 0.8824074, 'specificity': 0.8824074, 'f1': 0.89947945, 'auroc': 0.9829861, 'binary_precision': 0.8447099, 'binary_recall': 0.7698289, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.80553293}
confusion matrix:
       0    1
0  18058   91
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.91002303, 'recall': 0.5893713, 'specificity': 0.5893713, 'f1': 0.6396358, 'auroc': 0.9237628, 'binary_precision': 0.8545455, 'binary_recall': 0.18007663, 'binary_specificity': 0.998666, 'binary_f1_score': 0.29746836}
confusion matrix:
      0   1
0  5989   8
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_26.png
better model found
persisted
after epoch: 26,now: 2024-06-07 12:50:14.677614,epoch time: 0:26:34.190051,used: 11:24:14.204840,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9896785, 'precision': 0.95451796, 'recall': 0.87950015, 'specificity': 0.87950015, 'f1': 0.9133853, 'auroc': 0.9949355, 'binary_precision': 0.9172809, 'binary_recall': 0.7613868, 'binary_specificity': 0.9976135, 'binary_f1_score': 0.832095}
confusion matrix:
       0     1
0  42220   101
1    351  1120
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.9477725, 'recall': 0.83315796, 'specificity': 0.83315796, 'f1': 0.881436, 'auroc': 0.9796984, 'binary_precision': 0.907173, 'binary_recall': 0.6687403, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.76991946}
confusion matrix:
       0    1
0  18105   44
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.86292946, 'recall': 0.5548052, 'specificity': 0.5548052, 'f1': 0.5871267, 'auroc': 0.9263495, 'binary_precision': 0.7631579, 'binary_recall': 0.11111111, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.19397995}
confusion matrix:
      0   1
0  5988   9
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_27.png
early stop counter: 1
val acc:0.9863239526748657, best validation acc: 0.9872817993164062, corresponding to test acc:                         0.9645254015922546 / 0.9758709073066711
after epoch: 27,now: 2024-06-07 13:16:10.088468,epoch time: 0:25:55.410854,used: 11:50:09.615694,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99036354, 'precision': 0.97426665, 'recall': 0.87263656, 'specificity': 0.87263656, 'f1': 0.9169208, 'auroc': 0.9956538, 'binary_precision': 0.95727986, 'binary_recall': 0.746431, 'binary_specificity': 0.9988422, 'binary_f1_score': 0.83880824}
confusion matrix:
       0     1
0  42272    49
1    373  1098
---- Validation: 
scalar performance:
{'acc': 0.98350364, 'precision': 0.95111656, 'recall': 0.78369427, 'specificity': 0.78369427, 'f1': 0.8470059, 'auroc': 0.9773553, 'binary_precision': 0.91729325, 'binary_recall': 0.56920683, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.7024952}
confusion matrix:
       0    1
0  18116   33
1    277  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.81943876, 'recall': 0.53939617, 'specificity': 0.53939617, 'f1': 0.561692, 'auroc': 0.9068345, 'binary_precision': 0.67741936, 'binary_recall': 0.08045977, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.14383562}
confusion matrix:
      0   1
0  5987  10
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_28.png
early stop counter: 2
val acc:0.9835036396980286, best validation acc: 0.9872817993164062, corresponding to test acc:                         0.9645254015922546 / 0.9758709073066711
after epoch: 28,now: 2024-06-07 13:42:37.934939,epoch time: 0:26:27.846471,used: 12:16:37.462165,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9918478, 'precision': 0.9552922, 'recall': 0.91545665, 'specificity': 0.91545665, 'f1': 0.9343938, 'auroc': 0.9952141, 'binary_precision': 0.9163555, 'binary_recall': 0.8335598, 'binary_specificity': 0.9973535, 'binary_f1_score': 0.8729989}
confusion matrix:
       0     1
0  42208   112
1    245  1227
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.9212403, 'recall': 0.8570495, 'specificity': 0.8570495, 'f1': 0.88628817, 'auroc': 0.97742075, 'binary_precision': 0.8523985, 'binary_recall': 0.718507, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.7797469}
confusion matrix:
       0    1
0  18069   80
1    181  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.87514126, 'recall': 0.64759105, 'specificity': 0.64759105, 'f1': 0.70763373, 'auroc': 0.93479276, 'binary_precision': 0.78, 'binary_recall': 0.29885057, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.43213296}
confusion matrix:
      0   1
0  5975  22
1   183  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_29.png
early stop counter: 3
val acc:0.9861111044883728, best validation acc: 0.9872817993164062, corresponding to test acc:                         0.9645254015922546 / 0.9758709073066711
after epoch: 29,now: 2024-06-07 14:09:41.406396,epoch time: 0:27:03.471457,used: 12:43:40.933622,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9919392, 'precision': 0.94234776, 'recall': 0.9321799, 'specificity': 0.9321799, 'f1': 0.9372001, 'auroc': 0.9956013, 'binary_precision': 0.8892758, 'binary_recall': 0.8681169, 'binary_specificity': 0.996243, 'binary_f1_score': 0.878569}
confusion matrix:
       0     1
0  42162   159
1    194  1277
---- Validation: 
scalar performance:
{'acc': 0.9876011, 'precision': 0.92562634, 'recall': 0.87882245, 'specificity': 0.87882245, 'f1': 0.90075403, 'auroc': 0.98052585, 'binary_precision': 0.8596491, 'binary_recall': 0.7620529, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.80791426}
confusion matrix:
       0    1
0  18069   80
1    153  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.84831804, 'recall': 0.5622179, 'specificity': 0.5622179, 'f1': 0.5980151, 'auroc': 0.89142, 'binary_precision': 0.73333335, 'binary_recall': 0.12643678, 'binary_specificity': 0.997999, 'binary_f1_score': 0.21568628}
confusion matrix:
      0   1
0  5985  12
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_30.png
better model found
persisted
after epoch: 30,now: 2024-06-07 14:36:01.469469,epoch time: 0:26:20.063073,used: 13:10:00.996695,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_26_00_seed_0_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:10:00.996695 at 2024-06-07 14:36:01.469469
persisted model performance metric: 

scalar performance:
{'acc': 0.9637264, 'precision': 0.87440306, 'recall': 0.58895445, 'specificity': 0.58895445, 'f1': 0.63711035, 'auroc': 0.8947115, 'binary_precision': 0.78333336, 'binary_recall': 0.18007663, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.29283488}
confusion matrix:
      0   1
0  5984  13
1   214  47
oracle model performance metric: 

scalar performance:
{'acc': 0.97363377, 'precision': 0.8629637, 'recall': 0.77552474, 'specificity': 0.77552474, 'f1': 0.8126335, 'auroc': 0.9478799, 'binary_precision': 0.74489796, 'binary_recall': 0.55938697, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.63894963}
confusion matrix:
      0    1
0  5947   50
1   115  146
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456549 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456549 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB |   1119 TiB |   1119 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1106 TiB |   1106 TiB |
|       from small pool |  40679 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14484 MiB |  14484 MiB |  14484 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446619 KiB |   1251 MiB |    802 TiB |    802 TiB |
|       from large pool | 435058 KiB |   1243 MiB |    789 TiB |    789 TiB |
|       from small pool |  11560 KiB |     17 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  197600 K  |  197597 K  |
|       from large pool |     187    |    1413    |  102521 K  |  102521 K  |
|       from small pool |    3301    |    6290    |   95079 K  |   95076 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  197600 K  |  197597 K  |
|       from large pool |     187    |    1413    |  102521 K  |  102521 K  |
|       from small pool |    3301    |    6290    |   95079 K  |   95076 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     636    |     636    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    2802    |  126032 K  |  126032 K  |
|       from large pool |      37    |     600    |   76732 K  |   76732 K  |
|       from small pool |      43    |    2764    |   49299 K  |   49299 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1119 TiB |   1119 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1106 TiB |   1106 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  14484 MiB |  13602 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |    802 TiB |    802 TiB |
|       from large pool |  24320 KiB |   1243 MiB |    789 TiB |    789 TiB |
|       from small pool |      0 KiB |     46 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197600 K  |  197600 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95079 K  |   95079 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197600 K  |  197600 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95079 K  |   95079 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |     636    |     573    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2802    |  126033 K  |  126033 K  |
|       from large pool |       4    |     600    |   76732 K  |   76732 K  |
|       from small pool |       0    |    2764    |   49301 K  |   49301 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1119 TiB |   1119 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1106 TiB |   1106 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  14484 MiB |  13602 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |    802 TiB |    802 TiB |
|       from large pool |  24320 KiB |   1243 MiB |    789 TiB |    789 TiB |
|       from small pool |      0 KiB |     46 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197600 K  |  197600 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95079 K  |   95079 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197600 K  |  197600 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95079 K  |   95079 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |     636    |     573    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2802    |  126033 K  |  126033 K  |
|       from large pool |       4    |     600    |   76732 K  |   76732 K  |
|       from small pool |       0    |    2764    |   49301 K  |   49301 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177

 Experiment start at: 2024-06-07 14:47:01.515024
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9700155, 'precision': 0.8112823, 'recall': 0.59394395, 'specificity': 0.59394395, 'f1': 0.6401716, 'auroc': 0.9508816, 'binary_precision': 0.64941174, 'binary_recall': 0.19140083, 'binary_specificity': 0.996487, 'binary_f1_score': 0.29566148}
confusion matrix:
       0    1
0  42265  149
1   1166  276
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.75830555, 'recall': 0.5115273, 'specificity': 0.5115273, 'f1': 0.5136833, 'auroc': 0.95062995, 'binary_precision': 0.55172414, 'binary_recall': 0.023774145, 'binary_specificity': 0.99928045, 'binary_f1_score': 0.045584045}
confusion matrix:
       0   1
0  18054  13
1    657  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.9480803, 'recall': 0.6015867, 'specificity': 0.6015867, 'f1': 0.6584698, 'auroc': 0.9437479, 'binary_precision': 0.9298246, 'binary_recall': 0.20384616, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.33438486}
confusion matrix:
      0   1
0  5942   4
1   207  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-07 15:14:39.875069,epoch time: 0:27:38.360045,used: 0:27:38.360045,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9722045, 'precision': 0.8293928, 'recall': 0.6423039, 'specificity': 0.6423039, 'f1': 0.69600195, 'auroc': 0.960207, 'binary_precision': 0.6824877, 'binary_recall': 0.28918168, 'binary_specificity': 0.99542606, 'binary_f1_score': 0.40623474}
confusion matrix:
       0    1
0  42220  194
1   1025  417
---- Validation: 
scalar performance:
{'acc': 0.96792954, 'precision': 0.8321143, 'recall': 0.59426206, 'specificity': 0.59426206, 'f1': 0.64196897, 'auroc': 0.95808756, 'binary_precision': 0.6935484, 'binary_recall': 0.19167905, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.30034924}
confusion matrix:
       0    1
0  18010   57
1    544  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96761197, 'precision': 0.930927, 'recall': 0.6281734, 'specificity': 0.6281734, 'f1': 0.6916784, 'auroc': 0.954612, 'binary_precision': 0.8933333, 'binary_recall': 0.2576923, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.39999998}
confusion matrix:
      0   1
0  5938   8
1   193  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-07 15:41:13.178267,epoch time: 0:26:33.303198,used: 0:54:11.663243,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9756248, 'precision': 0.8387703, 'recall': 0.72647035, 'specificity': 0.72647035, 'f1': 0.7705619, 'auroc': 0.96750784, 'binary_precision': 0.6956978, 'binary_recall': 0.4597781, 'binary_specificity': 0.99316263, 'binary_f1_score': 0.5536535}
confusion matrix:
       0    1
0  42124  290
1    779  663
---- Validation: 
scalar performance:
{'acc': 0.9713447, 'precision': 0.8474691, 'recall': 0.6632684, 'specificity': 0.6632684, 'f1': 0.7194998, 'auroc': 0.9678709, 'binary_precision': 0.71935487, 'binary_recall': 0.33135214, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.45371315}
confusion matrix:
       0    1
0  17980   87
1    450  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.89809144, 'recall': 0.59338987, 'specificity': 0.59338987, 'f1': 0.6444675, 'auroc': 0.9536231, 'binary_precision': 0.8305085, 'binary_recall': 0.18846154, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.30721003}
confusion matrix:
      0   1
0  5936  10
1   211  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_3.png
better model found
persisted
after epoch: 3,now: 2024-06-07 16:07:53.975038,epoch time: 0:26:40.796771,used: 1:20:52.460014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97690165, 'precision': 0.8123731, 'recall': 0.8430239, 'specificity': 0.8430239, 'f1': 0.82691216, 'auroc': 0.96907496, 'binary_precision': 0.6349906, 'binary_recall': 0.6997226, 'binary_specificity': 0.98632526, 'binary_f1_score': 0.66578686}
confusion matrix:
       0     1
0  41834   580
1    433  1009
---- Validation: 
scalar performance:
{'acc': 0.9734258, 'precision': 0.8100176, 'recall': 0.8002485, 'specificity': 0.8002485, 'f1': 0.80504674, 'auroc': 0.9657997, 'binary_precision': 0.6344086, 'binary_recall': 0.6136701, 'binary_specificity': 0.98682684, 'binary_f1_score': 0.6238671}
confusion matrix:
       0    1
0  17829  238
1    260  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.8264305, 'recall': 0.61495316, 'specificity': 0.61495316, 'f1': 0.6653762, 'auroc': 0.9551667, 'binary_precision': 0.6853933, 'binary_recall': 0.23461539, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.3495702}
confusion matrix:
      0   1
0  5918  28
1   199  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_4.png
better model found
persisted
after epoch: 4,now: 2024-06-07 16:34:38.764958,epoch time: 0:26:44.789920,used: 1:47:37.249934,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9771981, 'precision': 0.82083035, 'recall': 0.8204005, 'specificity': 0.8204005, 'f1': 0.82061523, 'auroc': 0.9736587, 'binary_precision': 0.65347224, 'binary_recall': 0.6525659, 'binary_specificity': 0.988235, 'binary_f1_score': 0.6530188}
confusion matrix:
       0    1
0  41915  499
1    501  941
---- Validation: 
scalar performance:
{'acc': 0.9770544, 'precision': 0.8454192, 'recall': 0.8057067, 'specificity': 0.8057067, 'f1': 0.82423687, 'auroc': 0.9707166, 'binary_precision': 0.7048904, 'binary_recall': 0.62109953, 'binary_specificity': 0.9903138, 'binary_f1_score': 0.6603475}
confusion matrix:
       0    1
0  17892  175
1    255  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.88051164, 'recall': 0.5817673, 'specificity': 0.5817673, 'f1': 0.6275196, 'auroc': 0.9548903, 'binary_precision': 0.7962963, 'binary_recall': 0.16538462, 'binary_specificity': 0.99815, 'binary_f1_score': 0.27388537}
confusion matrix:
      0   1
0  5935  11
1   217  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_5.png
better model found
persisted
after epoch: 5,now: 2024-06-07 17:01:22.208304,epoch time: 0:26:43.443346,used: 2:14:20.693280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97988874, 'precision': 0.8343086, 'recall': 0.8646654, 'specificity': 0.8646654, 'f1': 0.8487664, 'auroc': 0.9770286, 'binary_precision': 0.6774398, 'binary_recall': 0.74133146, 'binary_specificity': 0.98799926, 'binary_f1_score': 0.707947}
confusion matrix:
       0     1
0  41905   509
1    373  1069
---- Validation: 
scalar performance:
{'acc': 0.9784952, 'precision': 0.8685169, 'recall': 0.79572487, 'specificity': 0.79572487, 'f1': 0.8277779, 'auroc': 0.97107875, 'binary_precision': 0.7518657, 'binary_recall': 0.59881127, 'binary_specificity': 0.9926385, 'binary_f1_score': 0.6666666}
confusion matrix:
       0    1
0  17934  133
1    270  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.77661496, 'recall': 0.650892, 'specificity': 0.650892, 'f1': 0.6931432, 'auroc': 0.94938684, 'binary_precision': 0.5827338, 'binary_recall': 0.31153846, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.40601504}
confusion matrix:
      0   1
0  5888  58
1   179  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_6.png
better model found
persisted
after epoch: 6,now: 2024-06-07 17:27:46.935447,epoch time: 0:26:24.727143,used: 2:40:45.420423,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9818725, 'precision': 0.8880087, 'recall': 0.8033899, 'specificity': 0.8033899, 'f1': 0.840119, 'auroc': 0.97724175, 'binary_precision': 0.7890974, 'binary_recall': 0.61234397, 'binary_specificity': 0.9944358, 'binary_f1_score': 0.6895744}
confusion matrix:
       0    1
0  42178  236
1    559  883
---- Validation: 
scalar performance:
{'acc': 0.9767343, 'precision': 0.9153286, 'recall': 0.7118406, 'specificity': 0.7118406, 'f1': 0.7781809, 'auroc': 0.97058666, 'binary_precision': 0.85163206, 'binary_recall': 0.42644873, 'binary_specificity': 0.9972325, 'binary_f1_score': 0.5683168}
confusion matrix:
       0    1
0  18017   50
1    386  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.75266445, 'recall': 0.546311, 'specificity': 0.546311, 'f1': 0.5711261, 'auroc': 0.94743395, 'binary_precision': 0.54347825, 'binary_recall': 0.09615385, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.1633987}
confusion matrix:
      0   1
0  5925  21
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_7.png
early stop counter: 1
val acc:0.9767342805862427, best validation acc: 0.978495180606842, corresponding to test acc:                         0.9618111252784729 / 0.9676119685173035
after epoch: 7,now: 2024-06-07 17:54:19.773631,epoch time: 0:26:32.838184,used: 3:07:18.258607,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.983879, 'precision': 0.9072654, 'recall': 0.8200469, 'specificity': 0.8200469, 'f1': 0.85803163, 'auroc': 0.9801691, 'binary_precision': 0.82651246, 'binary_recall': 0.64469117, 'binary_specificity': 0.9954026, 'binary_f1_score': 0.7243665}
confusion matrix:
       0    1
0  42220  195
1    512  929
---- Validation: 
scalar performance:
{'acc': 0.97924227, 'precision': 0.9064871, 'recall': 0.76321006, 'specificity': 0.76321006, 'f1': 0.8183159, 'auroc': 0.975656, 'binary_precision': 0.83023256, 'binary_recall': 0.5304606, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.64732546}
confusion matrix:
       0    1
0  17994   73
1    316  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.7984997, 'recall': 0.58059007, 'specificity': 0.58059007, 'f1': 0.62108433, 'auroc': 0.95164573, 'binary_precision': 0.63235295, 'binary_recall': 0.16538462, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.2621951}
confusion matrix:
      0   1
0  5921  25
1   217  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_8.png
better model found
persisted
after epoch: 8,now: 2024-06-07 18:21:05.186688,epoch time: 0:26:45.413057,used: 3:34:03.671664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9832862, 'precision': 0.86619186, 'recall': 0.87379086, 'specificity': 0.87379086, 'f1': 0.86994886, 'auroc': 0.9806379, 'binary_precision': 0.7406653, 'binary_recall': 0.7565881, 'binary_specificity': 0.99099356, 'binary_f1_score': 0.748542}
confusion matrix:
       0     1
0  42032   382
1    351  1091
---- Validation: 
scalar performance:
{'acc': 0.9800427, 'precision': 0.87265956, 'recall': 0.82227707, 'specificity': 0.82227707, 'f1': 0.8454772, 'auroc': 0.97552454, 'binary_precision': 0.7582038, 'binary_recall': 0.6523031, 'binary_specificity': 0.99225104, 'binary_f1_score': 0.7012779}
confusion matrix:
       0    1
0  17927  140
1    234  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.7742325, 'recall': 0.5708065, 'specificity': 0.5708065, 'f1': 0.60662276, 'auroc': 0.9542202, 'binary_precision': 0.5846154, 'binary_recall': 0.14615385, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.23384616}
confusion matrix:
      0   1
0  5919  27
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_9.png
better model found
persisted
after epoch: 9,now: 2024-06-07 18:47:46.427450,epoch time: 0:26:41.240762,used: 4:00:44.912426,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98381066, 'precision': 0.9147059, 'recall': 0.81042105, 'specificity': 0.81042105, 'f1': 0.85451174, 'auroc': 0.9852834, 'binary_precision': 0.8420561, 'binary_recall': 0.6248266, 'binary_specificity': 0.9960155, 'binary_f1_score': 0.71735674}
confusion matrix:
       0    1
0  42245  169
1    541  901
---- Validation: 
scalar performance:
{'acc': 0.9808431, 'precision': 0.9172416, 'recall': 0.7812067, 'specificity': 0.7812067, 'f1': 0.83493817, 'auroc': 0.97646564, 'binary_precision': 0.8504464, 'binary_recall': 0.5661218, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.67975014}
confusion matrix:
       0    1
0  18000   67
1    292  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.8922125, 'recall': 0.57808936, 'specificity': 0.57808936, 'f1': 0.62283814, 'auroc': 0.9618336, 'binary_precision': 0.82, 'binary_recall': 0.15769231, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.26451614}
confusion matrix:
      0   1
0  5937   9
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_10.png
better model found
persisted
after epoch: 10,now: 2024-06-07 19:14:12.481832,epoch time: 0:26:26.054382,used: 4:27:10.966808,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9864101, 'precision': 0.9135463, 'recall': 0.8623427, 'specificity': 0.8623427, 'f1': 0.88612425, 'auroc': 0.98526, 'binary_precision': 0.83624804, 'binary_recall': 0.7295423, 'binary_specificity': 0.9951431, 'binary_f1_score': 0.77925926}
confusion matrix:
       0     1
0  42208   206
1    390  1052
---- Validation: 
scalar performance:
{'acc': 0.98164356, 'precision': 0.9096564, 'recall': 0.80307984, 'specificity': 0.80307984, 'f1': 0.8477506, 'auroc': 0.9781288, 'binary_precision': 0.8336714, 'binary_recall': 0.61069834, 'binary_specificity': 0.99546134, 'binary_f1_score': 0.7049742}
confusion matrix:
       0    1
0  17985   82
1    262  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.80650276, 'recall': 0.58635926, 'specificity': 0.58635926, 'f1': 0.62908125, 'auroc': 0.9558605, 'binary_precision': 0.64788735, 'binary_recall': 0.17692308, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.27794564}
confusion matrix:
      0   1
0  5921  25
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_11.png
better model found
persisted
after epoch: 11,now: 2024-06-07 19:40:44.213928,epoch time: 0:26:31.732096,used: 4:53:42.698904,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9860224, 'precision': 0.8846326, 'recall': 0.90032685, 'specificity': 0.90032685, 'f1': 0.89230955, 'auroc': 0.98578405, 'binary_precision': 0.77578175, 'binary_recall': 0.8085992, 'binary_specificity': 0.9920545, 'binary_f1_score': 0.7918506}
confusion matrix:
       0     1
0  42077   337
1    276  1166
---- Validation: 
scalar performance:
{'acc': 0.98191035, 'precision': 0.88176525, 'recall': 0.84613425, 'specificity': 0.84613425, 'f1': 0.862999, 'auroc': 0.9780643, 'binary_precision': 0.7746711, 'binary_recall': 0.6998514, 'binary_specificity': 0.9924171, 'binary_f1_score': 0.73536295}
confusion matrix:
       0    1
0  17930  137
1    202  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.79408056, 'recall': 0.6104343, 'specificity': 0.6104343, 'f1': 0.65636885, 'auroc': 0.95892084, 'binary_precision': 0.6210526, 'binary_recall': 0.22692308, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.33239436}
confusion matrix:
      0   1
0  5910  36
1   201  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_12.png
better model found
persisted
after epoch: 12,now: 2024-06-07 20:06:47.735824,epoch time: 0:26:03.521896,used: 5:19:46.220800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9867749, 'precision': 0.90302795, 'recall': 0.8846382, 'specificity': 0.8846382, 'f1': 0.8936011, 'auroc': 0.98809624, 'binary_precision': 0.8136827, 'binary_recall': 0.77531207, 'binary_specificity': 0.99396425, 'binary_f1_score': 0.7940341}
confusion matrix:
       0     1
0  42158   256
1    324  1118
---- Validation: 
scalar performance:
{'acc': 0.983031, 'precision': 0.8941797, 'recall': 0.8488612, 'specificity': 0.8488612, 'f1': 0.870017, 'auroc': 0.9795587, 'binary_precision': 0.79932547, 'binary_recall': 0.70430905, 'binary_specificity': 0.9934134, 'binary_f1_score': 0.7488151}
confusion matrix:
       0    1
0  17948  119
1    199  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.818479, 'recall': 0.5959747, 'specificity': 0.5959747, 'f1': 0.64209706, 'auroc': 0.964269, 'binary_precision': 0.67105263, 'binary_recall': 0.19615385, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.30357143}
confusion matrix:
      0   1
0  5921  25
1   209  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_13.png
better model found
persisted
after epoch: 13,now: 2024-06-07 20:33:03.753947,epoch time: 0:26:16.018123,used: 5:46:02.238923,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9868433, 'precision': 0.89210427, 'recall': 0.9044357, 'specificity': 0.9044357, 'f1': 0.89816654, 'auroc': 0.9872891, 'binary_precision': 0.7904634, 'binary_recall': 0.81622744, 'binary_specificity': 0.99264395, 'binary_f1_score': 0.80313885}
confusion matrix:
       0     1
0  42102   312
1    265  1177
---- Validation: 
scalar performance:
{'acc': 0.9835112, 'precision': 0.8891552, 'recall': 0.86627674, 'specificity': 0.86627674, 'f1': 0.8773383, 'auroc': 0.9802846, 'binary_precision': 0.78797466, 'binary_recall': 0.73997027, 'binary_specificity': 0.99258316, 'binary_f1_score': 0.76321834}
confusion matrix:
       0    1
0  17933  134
1    175  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.8210362, 'recall': 0.6355184, 'specificity': 0.6355184, 'f1': 0.68692833, 'auroc': 0.96268725, 'binary_precision': 0.6728972, 'binary_recall': 0.2769231, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.3923706}
confusion matrix:
      0   1
0  5911  35
1   188  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_14.png
better model found
persisted
after epoch: 14,now: 2024-06-07 20:59:24.559313,epoch time: 0:26:20.805366,used: 6:12:23.044289,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.987915, 'precision': 0.93101406, 'recall': 0.86948484, 'specificity': 0.86948484, 'f1': 0.89770716, 'auroc': 0.98915315, 'binary_precision': 0.8707317, 'binary_recall': 0.74271846, 'binary_specificity': 0.9962512, 'binary_f1_score': 0.8016467}
confusion matrix:
       0     1
0  42255   159
1    371  1071
---- Validation: 
scalar performance:
{'acc': 0.983778, 'precision': 0.9188705, 'recall': 0.83065176, 'specificity': 0.83065176, 'f1': 0.8691437, 'auroc': 0.97928417, 'binary_precision': 0.85009485, 'binary_recall': 0.66567606, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.74666667}
confusion matrix:
       0    1
0  17988   79
1    225  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.83093536, 'recall': 0.56980836, 'specificity': 0.56980836, 'f1': 0.608334, 'auroc': 0.959251, 'binary_precision': 0.6981132, 'binary_recall': 0.1423077, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.23642173}
confusion matrix:
      0   1
0  5930  16
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_15.png
better model found
persisted
after epoch: 15,now: 2024-06-07 21:25:47.070625,epoch time: 0:26:22.511312,used: 6:38:45.555601,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98698014, 'precision': 0.9558692, 'recall': 0.8284723, 'specificity': 0.8284723, 'f1': 0.8811104, 'auroc': 0.9901052, 'binary_precision': 0.9232264, 'binary_recall': 0.6588072, 'binary_specificity': 0.9981374, 'binary_f1_score': 0.76891947}
confusion matrix:
       0    1
0  42335   79
1    492  950
---- Validation: 
scalar performance:
{'acc': 0.9827108, 'precision': 0.94470775, 'recall': 0.7886127, 'specificity': 0.7886127, 'f1': 0.8488074, 'auroc': 0.9810224, 'binary_precision': 0.9048724, 'binary_recall': 0.5794948, 'binary_specificity': 0.9977307, 'binary_f1_score': 0.70652175}
confusion matrix:
       0    1
0  18026   41
1    283  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.8763413, 'recall': 0.53611803, 'specificity': 0.53611803, 'f1': 0.5567596, 'auroc': 0.9493978, 'binary_precision': 0.7916667, 'binary_recall': 0.073076926, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.13380282}
confusion matrix:
      0   1
0  5941   5
1   241  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_16.png
early stop counter: 1
val acc:0.9827107787132263, best validation acc: 0.9837779998779297, corresponding to test acc:                         0.9614889025688171 / 0.9676119685173035
after epoch: 16,now: 2024-06-07 21:52:07.506997,epoch time: 0:26:20.436372,used: 7:05:05.991973,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98718536, 'precision': 0.90337366, 'recall': 0.8925543, 'specificity': 0.8925543, 'f1': 0.8978845, 'auroc': 0.9893518, 'binary_precision': 0.81383735, 'binary_recall': 0.79126215, 'binary_specificity': 0.99384636, 'binary_f1_score': 0.802391}
confusion matrix:
       0     1
0  42153   261
1    301  1141
---- Validation: 
scalar performance:
{'acc': 0.9829242, 'precision': 0.893309, 'recall': 0.84809065, 'specificity': 0.84809065, 'f1': 0.8691995, 'auroc': 0.97982657, 'binary_precision': 0.79763913, 'binary_recall': 0.70282316, 'binary_specificity': 0.9933581, 'binary_f1_score': 0.7472354}
confusion matrix:
       0    1
0  17947  120
1    200  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.82561755, 'recall': 0.6563359, 'specificity': 0.6563359, 'f1': 0.7082999, 'auroc': 0.9595405, 'binary_precision': 0.6803279, 'binary_recall': 0.31923077, 'binary_specificity': 0.993441, 'binary_f1_score': 0.43455496}
confusion matrix:
      0   1
0  5907  39
1   177  83
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_17.png
early stop counter: 2
val acc:0.982924222946167, best validation acc: 0.9837779998779297, corresponding to test acc:                         0.9614889025688171 / 0.9676119685173035
after epoch: 17,now: 2024-06-07 22:18:27.397277,epoch time: 0:26:19.890280,used: 7:31:25.882253,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98770976, 'precision': 0.89059305, 'recall': 0.92632055, 'specificity': 0.92632055, 'f1': 0.907609, 'auroc': 0.9905439, 'binary_precision': 0.78594047, 'binary_recall': 0.86061025, 'binary_specificity': 0.9920309, 'binary_f1_score': 0.8215823}
confusion matrix:
       0     1
0  42076   338
1    201  1241
---- Validation: 
scalar performance:
{'acc': 0.9848452, 'precision': 0.88705367, 'recall': 0.89700985, 'specificity': 0.89700985, 'f1': 0.89196265, 'auroc': 0.98164177, 'binary_precision': 0.78147614, 'binary_recall': 0.8023774, 'binary_specificity': 0.99164224, 'binary_f1_score': 0.7917889}
confusion matrix:
       0    1
0  17916  151
1    133  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.8635036, 'recall': 0.6308423, 'specificity': 0.6308423, 'f1': 0.6877511, 'auroc': 0.96330404, 'binary_precision': 0.7582418, 'binary_recall': 0.2653846, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.3931624}
confusion matrix:
      0   1
0  5924  22
1   191  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_18.png
better model found
persisted
after epoch: 18,now: 2024-06-07 22:44:42.688593,epoch time: 0:26:15.291316,used: 7:57:41.173569,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9891007, 'precision': 0.91838115, 'recall': 0.9082824, 'specificity': 0.9082824, 'f1': 0.9132652, 'auroc': 0.98906827, 'binary_precision': 0.8428165, 'binary_recall': 0.8217753, 'binary_specificity': 0.9947895, 'binary_f1_score': 0.8321629}
confusion matrix:
       0     1
0  42193   221
1    257  1185
---- Validation: 
scalar performance:
{'acc': 0.9842583, 'precision': 0.8957847, 'recall': 0.8702405, 'specificity': 0.8702405, 'f1': 0.8825487, 'auroc': 0.9821384, 'binary_precision': 0.8009554, 'binary_recall': 0.7473997, 'binary_specificity': 0.99308133, 'binary_f1_score': 0.77325135}
confusion matrix:
       0    1
0  17942  125
1    170  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.8649446, 'recall': 0.6213951, 'specificity': 0.6213951, 'f1': 0.6770972, 'auroc': 0.96126693, 'binary_precision': 0.7619048, 'binary_recall': 0.24615385, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.37209302}
confusion matrix:
      0   1
0  5926  20
1   196  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_19.png
early stop counter: 1
val acc:0.9842582941055298, best validation acc: 0.9848452210426331, corresponding to test acc:                         0.9656783938407898 / 0.9676119685173035
after epoch: 19,now: 2024-06-07 23:11:08.809462,epoch time: 0:26:26.120869,used: 8:24:07.294438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98848504, 'precision': 0.8953023, 'recall': 0.9340904, 'specificity': 0.9340904, 'f1': 0.9137124, 'auroc': 0.9909539, 'binary_precision': 0.7948395, 'binary_recall': 0.87586683, 'binary_specificity': 0.99231386, 'binary_f1_score': 0.8333883}
confusion matrix:
       0     1
0  42088   326
1    179  1263
---- Validation: 
scalar performance:
{'acc': 0.984365, 'precision': 0.88690877, 'recall': 0.88746226, 'specificity': 0.88746226, 'f1': 0.88718534, 'auroc': 0.9816799, 'binary_precision': 0.7818991, 'binary_recall': 0.7830609, 'binary_specificity': 0.9918636, 'binary_f1_score': 0.7824795}
confusion matrix:
       0    1
0  17920  147
1    146  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.856369, 'recall': 0.60040945, 'specificity': 0.60040945, 'f1': 0.6508087, 'auroc': 0.94657886, 'binary_precision': 0.74647886, 'binary_recall': 0.20384616, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.3202417}
confusion matrix:
      0   1
0  5928  18
1   207  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_20.png
early stop counter: 2
val acc:0.9843649864196777, best validation acc: 0.9848452210426331, corresponding to test acc:                         0.9656783938407898 / 0.9676119685173035
after epoch: 20,now: 2024-06-07 23:37:44.515487,epoch time: 0:26:35.706025,used: 8:50:43.000463,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9821233, 'precision': 0.9716304, 'recall': 0.737534, 'specificity': 0.737534, 'f1': 0.8136, 'auroc': 0.98772013, 'binary_precision': 0.9607843, 'binary_recall': 0.47572815, 'binary_specificity': 0.9993398, 'binary_f1_score': 0.6363636}
confusion matrix:
       0    1
0  42386   28
1    756  686
---- Validation: 
scalar performance:
{'acc': 0.97588044, 'precision': 0.9394008, 'recall': 0.68350244, 'specificity': 0.68350244, 'f1': 0.755417, 'auroc': 0.9773309, 'binary_precision': 0.90181816, 'binary_recall': 0.36849925, 'binary_specificity': 0.9985056, 'binary_f1_score': 0.5232067}
confusion matrix:
       0    1
0  18040   27
1    425  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.79776216, 'recall': 0.5131252, 'specificity': 0.5131252, 'f1': 0.5152463, 'auroc': 0.9383289, 'binary_precision': 0.6363636, 'binary_recall': 0.026923077, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.05166052}
confusion matrix:
      0  1
0  5942  4
1   253  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_21.png
early stop counter: 3
val acc:0.9758804440498352, best validation acc: 0.9848452210426331, corresponding to test acc:                         0.9656783938407898 / 0.9676119685173035
after epoch: 21,now: 2024-06-08 00:04:24.495036,epoch time: 0:26:39.979549,used: 9:17:22.980012,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9896023, 'precision': 0.95465744, 'recall': 0.8742902, 'specificity': 0.8742902, 'f1': 0.91029763, 'auroc': 0.992854, 'binary_precision': 0.9177269, 'binary_recall': 0.7508674, 'binary_specificity': 0.9977131, 'binary_f1_score': 0.82595414}
confusion matrix:
       0     1
0  42318    97
1    359  1082
---- Validation: 
scalar performance:
{'acc': 0.9848452, 'precision': 0.949825, 'recall': 0.8183304, 'specificity': 0.8183304, 'f1': 0.8719661, 'auroc': 0.9800464, 'binary_precision': 0.9129512, 'binary_recall': 0.63893014, 'binary_specificity': 0.9977307, 'binary_f1_score': 0.75174826}
confusion matrix:
       0    1
0  18026   41
1    243  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9671286, 'precision': 0.923289, 'recall': 0.6242432, 'specificity': 0.6242432, 'f1': 0.6861657, 'auroc': 0.9595738, 'binary_precision': 0.8783784, 'binary_recall': 0.25, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.38922155}
confusion matrix:
      0   1
0  5937   9
1   195  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_22.png
early stop counter: 4
val acc:0.9848452210426331, best validation acc: 0.9848452210426331, corresponding to test acc:                         0.9656783938407898 / 0.9676119685173035
after epoch: 22,now: 2024-06-08 00:31:04.656188,epoch time: 0:26:40.161152,used: 9:44:03.141164,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9888043, 'precision': 0.9399297, 'recall': 0.8756387, 'specificity': 0.8756387, 'f1': 0.9050623, 'auroc': 0.9921679, 'binary_precision': 0.88816327, 'binary_recall': 0.7545076, 'binary_specificity': 0.9967699, 'binary_f1_score': 0.815898}
confusion matrix:
       0     1
0  42277   137
1    354  1088
---- Validation: 
scalar performance:
{'acc': 0.98388475, 'precision': 0.9352919, 'recall': 0.81568646, 'specificity': 0.81568646, 'f1': 0.8652201, 'auroc': 0.9802839, 'binary_precision': 0.884058, 'binary_recall': 0.6344725, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.7387543}
confusion matrix:
       0    1
0  18011   56
1    246  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.882753, 'recall': 0.59129864, 'specificity': 0.59129864, 'f1': 0.64073765, 'auroc': 0.9500296, 'binary_precision': 0.8, 'binary_recall': 0.18461539, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.3}
confusion matrix:
      0   1
0  5934  12
1   212  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_23.png
early stop counter: 5
val acc:0.9838847517967224, best validation acc: 0.9848452210426331, corresponding to test acc:                         0.9656783938407898 / 0.9676119685173035
after epoch: 23,now: 2024-06-08 00:57:34.918283,epoch time: 0:26:30.262095,used: 10:10:33.403259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98869026, 'precision': 0.95896816, 'recall': 0.8548128, 'specificity': 0.8548128, 'f1': 0.8997568, 'auroc': 0.9927608, 'binary_precision': 0.92766726, 'binary_recall': 0.7115118, 'binary_specificity': 0.9981138, 'binary_f1_score': 0.8053376}
confusion matrix:
       0     1
0  42334    80
1    416  1026
---- Validation: 
scalar performance:
{'acc': 0.98415154, 'precision': 0.9322864, 'recall': 0.82297754, 'specificity': 0.82297754, 'f1': 0.86909544, 'auroc': 0.9809996, 'binary_precision': 0.87751, 'binary_recall': 0.64933133, 'binary_specificity': 0.9966237, 'binary_f1_score': 0.74637055}
confusion matrix:
       0    1
0  18006   61
1    236  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.8358376, 'recall': 0.60383517, 'specificity': 0.60383517, 'f1': 0.65328014, 'auroc': 0.9326873, 'binary_precision': 0.7051282, 'binary_recall': 0.21153846, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.3254438}
confusion matrix:
      0   1
0  5923  23
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_24.png
early stop counter: 6
val acc:0.9841515421867371, best validation acc: 0.9848452210426331, corresponding to test acc:                         0.9656783938407898 / 0.9676119685173035
after epoch: 24,now: 2024-06-08 01:23:53.438439,epoch time: 0:26:18.520156,used: 10:36:51.923415,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99019516, 'precision': 0.9309473, 'recall': 0.9118628, 'specificity': 0.9118628, 'f1': 0.92117214, 'auroc': 0.99276066, 'binary_precision': 0.8677326, 'binary_recall': 0.82801664, 'binary_specificity': 0.99570894, 'binary_f1_score': 0.8474095}
confusion matrix:
       0     1
0  42232   182
1    248  1194
---- Validation: 
scalar performance:
{'acc': 0.9854856, 'precision': 0.90795505, 'recall': 0.8751686, 'specificity': 0.8751686, 'f1': 0.89081573, 'auroc': 0.9810114, 'binary_precision': 0.82495946, 'binary_recall': 0.756315, 'binary_specificity': 0.99402225, 'binary_f1_score': 0.78914726}
confusion matrix:
       0    1
0  17959  108
1    164  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.8528764, 'recall': 0.6173808, 'specificity': 0.6173808, 'f1': 0.67111754, 'auroc': 0.9500501, 'binary_precision': 0.7380952, 'binary_recall': 0.23846154, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.36046514}
confusion matrix:
      0   1
0  5924  22
1   198  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_25.png
better model found
persisted
after epoch: 25,now: 2024-06-08 01:50:10.925448,epoch time: 0:26:17.487009,used: 11:03:09.410424,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98907787, 'precision': 0.92845786, 'recall': 0.8942026, 'specificity': 0.8942026, 'f1': 0.91056216, 'auroc': 0.99261767, 'binary_precision': 0.8639456, 'binary_recall': 0.7926491, 'binary_specificity': 0.9957561, 'binary_f1_score': 0.8267631}
confusion matrix:
       0     1
0  42234   180
1    299  1143
---- Validation: 
scalar performance:
{'acc': 0.9864461, 'precision': 0.939012, 'recall': 0.8542087, 'specificity': 0.8542087, 'f1': 0.8917128, 'auroc': 0.97761667, 'binary_precision': 0.8886827, 'binary_recall': 0.71173847, 'binary_specificity': 0.996679, 'binary_f1_score': 0.79042906}
confusion matrix:
       0    1
0  18007   60
1    194  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.86972684, 'recall': 0.5721519, 'specificity': 0.5721519, 'f1': 0.61335164, 'auroc': 0.935814, 'binary_precision': 0.7755102, 'binary_recall': 0.14615385, 'binary_specificity': 0.99815, 'binary_f1_score': 0.2459547}
confusion matrix:
      0   1
0  5935  11
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_26.png
better model found
persisted
after epoch: 26,now: 2024-06-08 02:16:35.645727,epoch time: 0:26:24.720279,used: 11:29:34.130703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9905828, 'precision': 0.93963933, 'recall': 0.9080438, 'specificity': 0.9080438, 'f1': 0.9232079, 'auroc': 0.99385315, 'binary_precision': 0.88539326, 'binary_recall': 0.8196949, 'binary_specificity': 0.9963927, 'binary_f1_score': 0.8512783}
confusion matrix:
       0     1
0  42261   153
1    260  1182
---- Validation: 
scalar performance:
{'acc': 0.982604, 'precision': 0.9018302, 'recall': 0.83004284, 'specificity': 0.83004284, 'f1': 0.8621166, 'auroc': 0.9764136, 'binary_precision': 0.81602913, 'binary_recall': 0.66567606, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.7332242}
confusion matrix:
       0    1
0  17966  101
1    225  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.8501843, 'recall': 0.6192198, 'specificity': 0.6192198, 'f1': 0.6729644, 'auroc': 0.9493682, 'binary_precision': 0.73255813, 'binary_recall': 0.2423077, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.36416185}
confusion matrix:
      0   1
0  5923  23
1   197  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_27.png
early stop counter: 1
val acc:0.9826040267944336, best validation acc: 0.9864460825920105, corresponding to test acc:                         0.962455689907074 / 0.9676119685173035
after epoch: 27,now: 2024-06-08 02:43:05.140375,epoch time: 0:26:29.494648,used: 11:56:03.625351,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99078804, 'precision': 0.93763757, 'recall': 0.9141208, 'specificity': 0.9141208, 'f1': 0.9255296, 'auroc': 0.99519163, 'binary_precision': 0.8809699, 'binary_recall': 0.83206105, 'binary_specificity': 0.9961806, 'binary_f1_score': 0.85581726}
confusion matrix:
       0     1
0  42253   162
1    242  1199
---- Validation: 
scalar performance:
{'acc': 0.98415154, 'precision': 0.8986577, 'recall': 0.8637477, 'specificity': 0.8637477, 'f1': 0.880333, 'auroc': 0.9804357, 'binary_precision': 0.8071895, 'binary_recall': 0.73402673, 'binary_specificity': 0.99346876, 'binary_f1_score': 0.76887155}
confusion matrix:
       0    1
0  17949  118
1    179  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.882753, 'recall': 0.59129864, 'specificity': 0.59129864, 'f1': 0.64073765, 'auroc': 0.9487686, 'binary_precision': 0.8, 'binary_recall': 0.18461539, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.3}
confusion matrix:
      0   1
0  5934  12
1   212  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_28.png
early stop counter: 2
val acc:0.9841515421867371, best validation acc: 0.9864460825920105, corresponding to test acc:                         0.962455689907074 / 0.9676119685173035
after epoch: 28,now: 2024-06-08 03:09:32.785235,epoch time: 0:26:27.644860,used: 12:22:31.270211,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98903227, 'precision': 0.97959554, 'recall': 0.8436013, 'specificity': 0.8436013, 'f1': 0.8996129, 'auroc': 0.9957137, 'binary_precision': 0.969697, 'binary_recall': 0.68793344, 'binary_specificity': 0.9992691, 'binary_f1_score': 0.8048682}
confusion matrix:
       0    1
0  42383   31
1    450  992
---- Validation: 
scalar performance:
{'acc': 0.9816969, 'precision': 0.92880917, 'recall': 0.78522587, 'specificity': 0.78522587, 'f1': 0.84147227, 'auroc': 0.9798821, 'binary_precision': 0.8733032, 'binary_recall': 0.57355124, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.6923767}
confusion matrix:
       0    1
0  18011   56
1    287  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.8749373, 'recall': 0.5285098, 'specificity': 0.5285098, 'f1': 0.54350215, 'auroc': 0.93209124, 'binary_precision': 0.7894737, 'binary_recall': 0.057692308, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.10752688}
confusion matrix:
      0   1
0  5942   4
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_29.png
early stop counter: 3
val acc:0.9816969037055969, best validation acc: 0.9864460825920105, corresponding to test acc:                         0.962455689907074 / 0.9676119685173035
after epoch: 29,now: 2024-06-08 03:35:59.907378,epoch time: 0:26:27.122143,used: 12:48:58.392354,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99065125, 'precision': 0.91630924, 'recall': 0.9419093, 'specificity': 0.9419093, 'f1': 0.9286963, 'auroc': 0.9946661, 'binary_precision': 0.8363755, 'binary_recall': 0.8897365, 'binary_specificity': 0.99408215, 'binary_f1_score': 0.8622312}
confusion matrix:
       0     1
0  42163   251
1    159  1283
---- Validation: 
scalar performance:
{'acc': 0.98527217, 'precision': 0.89448214, 'recall': 0.8922243, 'specificity': 0.8922243, 'f1': 0.8933497, 'auroc': 0.9807273, 'binary_precision': 0.7967115, 'binary_recall': 0.7919762, 'binary_specificity': 0.99247247, 'binary_f1_score': 0.79433686}
confusion matrix:
       0    1
0  17931  136
1    140  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.92933464, 'recall': 0.5497477, 'specificity': 0.5497477, 'f1': 0.5801906, 'auroc': 0.95800185, 'binary_precision': 0.8965517, 'binary_recall': 0.1, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.17993079}
confusion matrix:
      0   1
0  5943   3
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170177_30.png
early stop counter: 4
val acc:0.9852721691131592, best validation acc: 0.9864460825920105, corresponding to test acc:                         0.962455689907074 / 0.9676119685173035
after epoch: 30,now: 2024-06-08 04:02:21.011102,epoch time: 0:26:21.103724,used: 13:15:19.496078,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_14_47_01_seed_1_21170177
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:15:19.496078 at 2024-06-08 04:02:21.011102
persisted model performance metric: 

scalar performance:
{'acc': 0.9634225, 'precision': 0.8880267, 'recall': 0.5818514, 'specificity': 0.5818514, 'f1': 0.62799925, 'auroc': 0.9458784, 'binary_precision': 0.8113208, 'binary_recall': 0.16538462, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.2747604}
confusion matrix:
      0   1
0  5936  10
1   217  43
oracle model performance metric: 

scalar performance:
{'acc': 0.96777314, 'precision': 0.9369656, 'recall': 0.6282575, 'specificity': 0.6282575, 'f1': 0.6923193, 'auroc': 0.95771074, 'binary_precision': 0.9054054, 'binary_recall': 0.2576923, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.40119758}
confusion matrix:
      0   1
0  5939   7
1   193  67
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456207 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456207 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  13213 MiB |   2244 TiB |   2244 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   2217 TiB |   2217 TiB |
|       from small pool |  40676 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14484 MiB |  28076 MiB |  13602 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  27992 MiB |  13584 MiB |
|       from small pool |     66 MiB |     70 MiB |     84 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446961 KiB |   1251 MiB |   1605 TiB |   1605 TiB |
|       from large pool | 435388 KiB |   1244 MiB |   1578 TiB |   1578 TiB |
|       from small pool |  11572 KiB |     46 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    6487    |  395837 K  |  395834 K  |
|       from large pool |     187    |    1413    |  205461 K  |  205461 K  |
|       from small pool |    3277    |    6298    |  190375 K  |  190372 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    6487    |  395837 K  |  395834 K  |
|       from large pool |     187    |    1413    |  205461 K  |  205461 K  |
|       from small pool |    3277    |    6298    |  190375 K  |  190372 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    1207    |     573    |
|       from large pool |     601    |     601    |    1165    |     564    |
|       from small pool |      33    |      35    |      42    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      85    |    2810    |  248059 K  |  248059 K  |
|       from large pool |      40    |     604    |  149049 K  |  149049 K  |
|       from small pool |      45    |    2768    |   99010 K  |   99010 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2244 TiB |   2244 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2217 TiB |   2217 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  28076 MiB |  27194 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     70 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1605 TiB |   1605 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   1578 TiB |   1578 TiB |
|       from small pool |      0 KiB |     46 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395837 K  |  395837 K  |
|       from large pool |       2    |    1413    |  205461 K  |  205461 K  |
|       from small pool |       0    |    6298    |  190375 K  |  190375 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395837 K  |  395837 K  |
|       from large pool |       2    |    1413    |  205461 K  |  205461 K  |
|       from small pool |       0    |    6298    |  190375 K  |  190375 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1207    |    1144    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      35    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2810    |  248061 K  |  248061 K  |
|       from large pool |       4    |     604    |  149049 K  |  149049 K  |
|       from small pool |       0    |    2768    |   99011 K  |   99011 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2244 TiB |   2244 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2217 TiB |   2217 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  28076 MiB |  27194 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     70 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1605 TiB |   1605 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   1578 TiB |   1578 TiB |
|       from small pool |      0 KiB |     46 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395837 K  |  395837 K  |
|       from large pool |       2    |    1413    |  205461 K  |  205461 K  |
|       from small pool |       0    |    6298    |  190375 K  |  190375 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395837 K  |  395837 K  |
|       from large pool |       2    |    1413    |  205461 K  |  205461 K  |
|       from small pool |       0    |    6298    |  190375 K  |  190375 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1207    |    1144    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      35    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2810    |  248061 K  |  248061 K  |
|       from large pool |       4    |     604    |  149049 K  |  149049 K  |
|       from small pool |       0    |    2768    |   99011 K  |   99011 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jun  8 04:05:03 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/2.csv

RuleException:
ValueError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
too many values to unpack (expected 2)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 168, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 30, in __init__
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/tasks/zoo_tasks.py", line 36, in __call__
  File "/lustre/groups/aih/sina.wendrich/MA_code/MA_thesis/tasks/task_CAMELYON17.py", line 185, in get_task
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
