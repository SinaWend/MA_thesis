Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun  8 23:39:22 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159

 Experiment start at: 2024-06-08 23:45:54.647189
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9744931, 'precision': 0.8364382, 'recall': 0.71369624, 'specificity': 0.71369624, 'f1': 0.76024985, 'auroc': 0.9628046, 'binary_precision': 0.6923077, 'binary_recall': 0.43410325, 'binary_specificity': 0.99328923, 'binary_f1_score': 0.5336117}
confusion matrix:
       0    1
0  42036  284
1    833  639
---- Validation: 
scalar performance:
{'acc': 0.97408473, 'precision': 0.87684464, 'recall': 0.66855985, 'specificity': 0.66855985, 'f1': 0.73011446, 'auroc': 0.9601472, 'binary_precision': 0.7765958, 'binary_recall': 0.34059098, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.4735135}
confusion matrix:
       0    1
0  18086   63
1    424  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97235537, 'precision': 0.96085346, 'recall': 0.67774403, 'specificity': 0.67774403, 'f1': 0.7519377, 'auroc': 0.94218993, 'binary_precision': 0.9489796, 'binary_recall': 0.35632184, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.51810586}
confusion matrix:
      0   1
0  5992   5
1   168  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-09 00:13:35.595383,epoch time: 0:27:40.948194,used: 0:27:40.948194,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9788774, 'precision': 0.87391853, 'recall': 0.7661271, 'specificity': 0.7661271, 'f1': 0.8102272, 'auroc': 0.9742001, 'binary_precision': 0.76374155, 'binary_recall': 0.5380435, 'binary_specificity': 0.9942108, 'binary_f1_score': 0.6313272}
confusion matrix:
       0    1
0  42075  245
1    680  792
---- Validation: 
scalar performance:
{'acc': 0.9764261, 'precision': 0.83575183, 'recall': 0.78153026, 'specificity': 0.78153026, 'f1': 0.8060446, 'auroc': 0.9664, 'binary_precision': 0.6865672, 'binary_recall': 0.57231724, 'binary_specificity': 0.9907433, 'binary_f1_score': 0.6242578}
confusion matrix:
       0    1
0  17981  168
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.88822913, 'recall': 0.54172873, 'specificity': 0.54172873, 'f1': 0.5664118, 'auroc': 0.95467085, 'binary_precision': 0.8148148, 'binary_recall': 0.08429119, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.15277778}
confusion matrix:
      0   1
0  5992   5
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_2.png
better model found
persisted
after epoch: 2,now: 2024-06-09 00:40:15.033857,epoch time: 0:26:39.438474,used: 0:54:20.386668,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9780782, 'precision': 0.90990776, 'recall': 0.7133903, 'specificity': 0.7133903, 'f1': 0.77854943, 'auroc': 0.97542745, 'binary_precision': 0.83930945, 'binary_recall': 0.4296397, 'binary_specificity': 0.9971409, 'binary_f1_score': 0.5683453}
confusion matrix:
       0    1
0  42200  121
1    839  632
---- Validation: 
scalar performance:
{'acc': 0.97381866, 'precision': 0.8896612, 'recall': 0.65417105, 'specificity': 0.65417105, 'f1': 0.7175108, 'auroc': 0.9704623, 'binary_precision': 0.8032129, 'binary_recall': 0.31104198, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.4484305}
confusion matrix:
       0    1
0  18100   49
1    443  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8557384, 'recall': 0.53964627, 'specificity': 0.53964627, 'f1': 0.5625638, 'auroc': 0.9670007, 'binary_precision': 0.75, 'binary_recall': 0.08045977, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.14532873}
confusion matrix:
      0   1
0  5990   7
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_3.png
early stop counter: 1
val acc:0.9738186597824097, best validation acc: 0.9764261245727539, corresponding to test acc:                         0.9610099196434021 / 0.9723553657531738
after epoch: 3,now: 2024-06-09 01:06:35.948094,epoch time: 0:26:20.914237,used: 1:20:41.300905,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98173183, 'precision': 0.90832853, 'recall': 0.78432477, 'specificity': 0.78432477, 'f1': 0.8343985, 'auroc': 0.98128974, 'binary_precision': 0.83136094, 'binary_recall': 0.5726902, 'binary_specificity': 0.99595934, 'binary_f1_score': 0.6781979}
confusion matrix:
       0    1
0  42149  171
1    629  843
---- Validation: 
scalar performance:
{'acc': 0.9795126, 'precision': 0.887313, 'recall': 0.7703772, 'specificity': 0.7703772, 'f1': 0.8176327, 'auroc': 0.9748856, 'binary_precision': 0.7905405, 'binary_recall': 0.5458787, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.6458142}
confusion matrix:
       0    1
0  18056   93
1    292  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8728617, 'recall': 0.6191889, 'specificity': 0.6191889, 'f1': 0.6753391, 'auroc': 0.95205295, 'binary_precision': 0.7777778, 'binary_recall': 0.2413793, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.36842105}
confusion matrix:
      0   1
0  5979  18
1   198  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_4.png
better model found
persisted
after epoch: 4,now: 2024-06-09 01:33:12.646507,epoch time: 0:26:36.698413,used: 1:47:17.999318,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98449486, 'precision': 0.88267374, 'recall': 0.87689924, 'specificity': 0.87689924, 'f1': 0.87976265, 'auroc': 0.9838982, 'binary_precision': 0.773637, 'binary_recall': 0.76154894, 'binary_specificity': 0.99224955, 'binary_f1_score': 0.76754534}
confusion matrix:
       0     1
0  41992   328
1    351  1121
---- Validation: 
scalar performance:
{'acc': 0.9826522, 'precision': 0.8885977, 'recall': 0.8335072, 'specificity': 0.8335072, 'f1': 0.85877603, 'auroc': 0.9758967, 'binary_precision': 0.7887067, 'binary_recall': 0.6734059, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.72651005}
confusion matrix:
       0    1
0  18033  116
1    210  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.88104427, 'recall': 0.58903784, 'specificity': 0.58903784, 'f1': 0.63760966, 'auroc': 0.95712817, 'binary_precision': 0.7966102, 'binary_recall': 0.18007663, 'binary_specificity': 0.997999, 'binary_f1_score': 0.29375}
confusion matrix:
      0   1
0  5985  12
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_5.png
better model found
persisted
after epoch: 5,now: 2024-06-09 01:59:53.631859,epoch time: 0:26:40.985352,used: 2:13:58.984670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9852713, 'precision': 0.9264034, 'recall': 0.83140063, 'specificity': 0.83140063, 'f1': 0.87249947, 'auroc': 0.988054, 'binary_precision': 0.8643172, 'binary_recall': 0.6664402, 'binary_specificity': 0.9963611, 'binary_f1_score': 0.75258917}
confusion matrix:
       0    1
0  42166  154
1    491  981
---- Validation: 
scalar performance:
{'acc': 0.9831311, 'precision': 0.9174328, 'recall': 0.80675316, 'specificity': 0.80675316, 'f1': 0.85299003, 'auroc': 0.97584426, 'binary_precision': 0.8482906, 'binary_recall': 0.61741835, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.71467143}
confusion matrix:
       0    1
0  18078   71
1    246  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.8936369, 'recall': 0.536065, 'specificity': 0.536065, 'f1': 0.55684584, 'auroc': 0.959447, 'binary_precision': 0.82608694, 'binary_recall': 0.07279693, 'binary_specificity': 0.999333, 'binary_f1_score': 0.13380282}
confusion matrix:
      0   1
0  5993   4
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_6.png
better model found
persisted
after epoch: 6,now: 2024-06-09 02:26:40.763455,epoch time: 0:26:47.131596,used: 2:40:46.116266,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9852028, 'precision': 0.93915856, 'recall': 0.8174721, 'specificity': 0.8174721, 'f1': 0.86782324, 'auroc': 0.9889761, 'binary_precision': 0.8907882, 'binary_recall': 0.63766146, 'binary_specificity': 0.9972827, 'binary_f1_score': 0.7432647}
confusion matrix:
       0    1
0  42206  115
1    533  938
---- Validation: 
scalar performance:
{'acc': 0.9822265, 'precision': 0.9415983, 'recall': 0.7695321, 'specificity': 0.7695321, 'f1': 0.83329546, 'auroc': 0.9779489, 'binary_precision': 0.8992248, 'binary_recall': 0.54121304, 'binary_specificity': 0.99785113, 'binary_f1_score': 0.67572814}
confusion matrix:
       0    1
0  18110   39
1    295  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.9014181, 'recall': 0.53040123, 'specificity': 0.53040123, 'f1': 0.5470089, 'auroc': 0.93827677, 'binary_precision': 0.84210527, 'binary_recall': 0.06130268, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.114285715}
confusion matrix:
      0   1
0  5994   3
1   245  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_7.png
early stop counter: 1
val acc:0.9822264909744263, best validation acc: 0.9831311106681824, corresponding to test acc:                         0.9606903195381165 / 0.9723553657531738
after epoch: 7,now: 2024-06-09 02:53:03.641428,epoch time: 0:26:22.877973,used: 3:07:08.994239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.987943, 'precision': 0.926356, 'recall': 0.8803225, 'specificity': 0.8803225, 'f1': 0.90192294, 'auroc': 0.9894229, 'binary_precision': 0.8608563, 'binary_recall': 0.7649456, 'binary_specificity': 0.9956994, 'binary_f1_score': 0.81007195}
confusion matrix:
       0     1
0  42138   182
1    346  1126
---- Validation: 
scalar performance:
{'acc': 0.9857918, 'precision': 0.9190061, 'recall': 0.853884, 'specificity': 0.853884, 'f1': 0.88348377, 'auroc': 0.97907066, 'binary_precision': 0.84814817, 'binary_recall': 0.7122862, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.7743026}
confusion matrix:
       0    1
0  18067   82
1    185  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8941233, 'recall': 0.5797094, 'specificity': 0.5797094, 'f1': 0.6252742, 'auroc': 0.95759773, 'binary_precision': 0.8235294, 'binary_recall': 0.16091955, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.26923078}
confusion matrix:
      0   1
0  5988   9
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_8.png
better model found
persisted
after epoch: 8,now: 2024-06-09 03:19:48.679618,epoch time: 0:26:45.038190,used: 3:33:54.032429,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98392403, 'precision': 0.9362544, 'recall': 0.79791766, 'specificity': 0.79791766, 'f1': 0.8531233, 'auroc': 0.9897704, 'binary_precision': 0.8863179, 'binary_recall': 0.59850544, 'binary_specificity': 0.9973299, 'binary_f1_score': 0.7145174}
confusion matrix:
       0    1
0  42207  113
1    591  881
---- Validation: 
scalar performance:
{'acc': 0.98185396, 'precision': 0.9134303, 'recall': 0.7873406, 'specificity': 0.7873406, 'f1': 0.8381858, 'auroc': 0.9778594, 'binary_precision': 0.84162897, 'binary_recall': 0.5785381, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.6857143}
confusion matrix:
       0    1
0  18079   70
1    271  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.77475715, 'recall': 0.5371469, 'specificity': 0.5371469, 'f1': 0.55736375, 'auroc': 0.9206023, 'binary_precision': 0.5882353, 'binary_recall': 0.07662835, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.13559322}
confusion matrix:
      0   1
0  5983  14
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_9.png
early stop counter: 1
val acc:0.9818539619445801, best validation acc: 0.985791802406311, corresponding to test acc:                         0.9635666608810425 / 0.9723553657531738
after epoch: 9,now: 2024-06-09 03:46:36.135956,epoch time: 0:26:47.456338,used: 4:00:41.488767,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9876918, 'precision': 0.90634096, 'recall': 0.90340716, 'specificity': 0.90340716, 'f1': 0.90486825, 'auroc': 0.9926683, 'binary_precision': 0.8191781, 'binary_recall': 0.81305236, 'binary_specificity': 0.99376196, 'binary_f1_score': 0.8161037}
confusion matrix:
       0     1
0  42057   264
1    275  1196
---- Validation: 
scalar performance:
{'acc': 0.98398256, 'precision': 0.9080186, 'recall': 0.8334459, 'specificity': 0.8334459, 'f1': 0.866683, 'auroc': 0.9783823, 'binary_precision': 0.82758623, 'binary_recall': 0.6718507, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.7416309}
confusion matrix:
       0    1
0  18059   90
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8564249, 'recall': 0.5566375, 'specificity': 0.5566375, 'f1': 0.5898028, 'auroc': 0.9403147, 'binary_precision': 0.75, 'binary_recall': 0.11494253, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.19933555}
confusion matrix:
      0   1
0  5987  10
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_10.png
early stop counter: 2
val acc:0.9839825630187988, best validation acc: 0.985791802406311, corresponding to test acc:                         0.9635666608810425 / 0.9723553657531738
after epoch: 10,now: 2024-06-09 04:13:12.952724,epoch time: 0:26:36.816768,used: 4:27:18.305535,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9885824, 'precision': 0.931502, 'recall': 0.88541836, 'specificity': 0.88541836, 'f1': 0.9070593, 'auroc': 0.99386716, 'binary_precision': 0.87079513, 'binary_recall': 0.7748299, 'binary_specificity': 0.9960068, 'binary_f1_score': 0.8200144}
confusion matrix:
       0     1
0  42153   169
1    331  1139
---- Validation: 
scalar performance:
{'acc': 0.98589826, 'precision': 0.91934055, 'recall': 0.8554392, 'specificity': 0.8554392, 'f1': 0.88454545, 'auroc': 0.9819556, 'binary_precision': 0.8487085, 'binary_recall': 0.7153966, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.77637136}
confusion matrix:
       0    1
0  18067   82
1    183  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8750639, 'recall': 0.5492248, 'specificity': 0.5492248, 'f1': 0.5785352, 'auroc': 0.9417894, 'binary_precision': 0.7878788, 'binary_recall': 0.099616855, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.17687075}
confusion matrix:
      0   1
0  5990   7
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_11.png
better model found
persisted
after epoch: 11,now: 2024-06-09 04:39:40.318879,epoch time: 0:26:27.366155,used: 4:53:45.671690,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9901352, 'precision': 0.9509969, 'recall': 0.8909647, 'specificity': 0.8909647, 'f1': 0.9186795, 'auroc': 0.9951035, 'binary_precision': 0.9094488, 'binary_recall': 0.78464675, 'binary_specificity': 0.9972826, 'binary_f1_score': 0.84245074}
confusion matrix:
       0     1
0  42205   115
1    317  1155
---- Validation: 
scalar performance:
{'acc': 0.9848872, 'precision': 0.9212793, 'recall': 0.8346642, 'specificity': 0.8346642, 'f1': 0.8726243, 'auroc': 0.9795893, 'binary_precision': 0.85404336, 'binary_recall': 0.6734059, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.7530435}
confusion matrix:
       0    1
0  18075   74
1    210  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8778784, 'recall': 0.5719632, 'specificity': 0.5719632, 'f1': 0.61343366, 'auroc': 0.9443071, 'binary_precision': 0.7916667, 'binary_recall': 0.14559387, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.24595469}
confusion matrix:
      0   1
0  5987  10
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_12.png
early stop counter: 1
val acc:0.9848871827125549, best validation acc: 0.9858982563018799, corresponding to test acc:                         0.9613295197486877 / 0.9723553657531738
after epoch: 12,now: 2024-06-09 05:06:24.015649,epoch time: 0:26:43.696770,used: 5:20:29.368460,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9909801, 'precision': 0.9428396, 'recall': 0.9145662, 'specificity': 0.9145662, 'f1': 0.92820054, 'auroc': 0.9950283, 'binary_precision': 0.89147854, 'binary_recall': 0.83265305, 'binary_specificity': 0.9964794, 'binary_f1_score': 0.8610623}
confusion matrix:
       0     1
0  42173   149
1    246  1224
---- Validation: 
scalar performance:
{'acc': 0.9853661, 'precision': 0.8951968, 'recall': 0.8791655, 'specificity': 0.8791655, 'f1': 0.8870011, 'auroc': 0.9813078, 'binary_precision': 0.7987013, 'binary_recall': 0.7651633, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.7815727}
confusion matrix:
       0    1
0  18025  124
1    151  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.82077765, 'recall': 0.59378445, 'specificity': 0.59378445, 'f1': 0.63960755, 'auroc': 0.954529, 'binary_precision': 0.6756757, 'binary_recall': 0.19157088, 'binary_specificity': 0.995998, 'binary_f1_score': 0.29850745}
confusion matrix:
      0   1
0  5973  24
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_13.png
early stop counter: 2
val acc:0.9853661060333252, best validation acc: 0.9858982563018799, corresponding to test acc:                         0.9613295197486877 / 0.9723553657531738
after epoch: 13,now: 2024-06-09 05:32:40.313030,epoch time: 0:26:16.297381,used: 5:46:45.665841,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99095726, 'precision': 0.9609051, 'recall': 0.8946686, 'specificity': 0.8946686, 'f1': 0.9250328, 'auroc': 0.99530065, 'binary_precision': 0.92902714, 'binary_recall': 0.7914402, 'binary_specificity': 0.99789697, 'binary_f1_score': 0.8547322}
confusion matrix:
       0     1
0  42231    89
1    307  1165
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.9292319, 'recall': 0.8403279, 'specificity': 0.8403279, 'f1': 0.87925017, 'auroc': 0.9786161, 'binary_precision': 0.8695652, 'binary_recall': 0.6842924, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.7658833}
confusion matrix:
       0    1
0  18083   66
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8973372, 'recall': 0.5379807, 'specificity': 0.5379807, 'f1': 0.5601599, 'auroc': 0.9284799, 'binary_precision': 0.8333333, 'binary_recall': 0.07662835, 'binary_specificity': 0.999333, 'binary_f1_score': 0.14035088}
confusion matrix:
      0   1
0  5993   4
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_14.png
early stop counter: 3
val acc:0.985685408115387, best validation acc: 0.9858982563018799, corresponding to test acc:                         0.9613295197486877 / 0.9723553657531738
after epoch: 14,now: 2024-06-09 05:59:19.081367,epoch time: 0:26:38.768337,used: 6:13:24.434178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9872351, 'precision': 0.9803058, 'recall': 0.81864667, 'specificity': 0.81864667, 'f1': 0.88202727, 'auroc': 0.9948522, 'binary_precision': 0.973057, 'binary_recall': 0.6379076, 'binary_specificity': 0.99938565, 'binary_f1_score': 0.77061963}
confusion matrix:
       0    1
0  42294   26
1    533  939
---- Validation: 
scalar performance:
{'acc': 0.98169434, 'precision': 0.9519937, 'recall': 0.75350547, 'specificity': 0.75350547, 'f1': 0.82295406, 'auroc': 0.97244257, 'binary_precision': 0.9211268, 'binary_recall': 0.5085537, 'binary_specificity': 0.9984572, 'binary_f1_score': 0.65531063}
confusion matrix:
       0    1
0  18121   28
1    316  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.86253214, 'recall': 0.5604689, 'specificity': 0.5604689, 'f1': 0.5958259, 'auroc': 0.9168042, 'binary_precision': 0.7619048, 'binary_recall': 0.12260536, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.21122111}
confusion matrix:
      0   1
0  5987  10
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_15.png
early stop counter: 4
val acc:0.9816943407058716, best validation acc: 0.9858982563018799, corresponding to test acc:                         0.9613295197486877 / 0.9723553657531738
after epoch: 15,now: 2024-06-09 06:25:56.134603,epoch time: 0:26:37.053236,used: 6:40:01.487414,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9885139, 'precision': 0.8886478, 'recall': 0.95373046, 'specificity': 0.95373046, 'f1': 0.91845036, 'auroc': 0.99595505, 'binary_precision': 0.7802198, 'binary_recall': 0.9164402, 'binary_specificity': 0.9910208, 'binary_f1_score': 0.8428616}
confusion matrix:
       0     1
0  41940   380
1    123  1349
---- Validation: 
scalar performance:
{'acc': 0.98424864, 'precision': 0.8770386, 'recall': 0.8883376, 'specificity': 0.8883376, 'f1': 0.88259727, 'auroc': 0.9752166, 'binary_precision': 0.7616893, 'binary_recall': 0.785381, 'binary_specificity': 0.99129426, 'binary_f1_score': 0.77335376}
confusion matrix:
       0    1
0  17991  158
1    138  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9686801, 'precision': 0.858956, 'recall': 0.68682045, 'specificity': 0.68682045, 'f1': 0.74318457, 'auroc': 0.94569653, 'binary_precision': 0.7443609, 'binary_recall': 0.37931034, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.5025381}
confusion matrix:
      0   1
0  5963  34
1   162  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_16.png
early stop counter: 5
val acc:0.9842486381530762, best validation acc: 0.9858982563018799, corresponding to test acc:                         0.9613295197486877 / 0.9723553657531738
after epoch: 16,now: 2024-06-09 06:52:27.527858,epoch time: 0:26:31.393255,used: 7:06:32.880669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9911171, 'precision': 0.9210417, 'recall': 0.94720876, 'specificity': 0.94720876, 'f1': 0.9336982, 'auroc': 0.99698484, 'binary_precision': 0.8455648, 'binary_recall': 0.9001359, 'binary_specificity': 0.99428165, 'binary_f1_score': 0.8719974}
confusion matrix:
       0     1
0  42078   242
1    147  1325
---- Validation: 
scalar performance:
{'acc': 0.9845147, 'precision': 0.89686465, 'recall': 0.85922325, 'specificity': 0.85922325, 'f1': 0.8770287, 'auroc': 0.978549, 'binary_precision': 0.80344826, 'binary_recall': 0.7247278, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.76206046}
confusion matrix:
       0    1
0  18035  114
1    177  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.84709144, 'recall': 0.6619996, 'specificity': 0.6619996, 'f1': 0.71774626, 'auroc': 0.9522438, 'binary_precision': 0.7226891, 'binary_recall': 0.32950193, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.4526316}
confusion matrix:
      0   1
0  5964  33
1   175  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_17.png
early stop counter: 6
val acc:0.9845147132873535, best validation acc: 0.9858982563018799, corresponding to test acc:                         0.9613295197486877 / 0.9723553657531738
after epoch: 17,now: 2024-06-09 07:19:13.109101,epoch time: 0:26:45.581243,used: 7:33:18.461912,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99075174, 'precision': 0.9699457, 'recall': 0.88275933, 'specificity': 0.88275933, 'f1': 0.9215734, 'auroc': 0.99715483, 'binary_precision': 0.9479429, 'binary_recall': 0.7669837, 'binary_specificity': 0.998535, 'binary_f1_score': 0.8479159}
confusion matrix:
       0     1
0  42258    62
1    343  1129
---- Validation: 
scalar performance:
{'acc': 0.9829715, 'precision': 0.9467117, 'recall': 0.7781684, 'specificity': 0.7781684, 'f1': 0.84147936, 'auroc': 0.97533935, 'binary_precision': 0.90886074, 'binary_recall': 0.55832034, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.6917148}
confusion matrix:
       0    1
0  18113   36
1    284  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7853941, 'recall': 0.55771947, 'specificity': 0.55771947, 'f1': 0.58911645, 'auroc': 0.90372735, 'binary_precision': 0.60784316, 'binary_recall': 0.118773945, 'binary_specificity': 0.996665, 'binary_f1_score': 0.19871795}
confusion matrix:
      0   1
0  5977  20
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_18.png
early stop counter: 7
val acc:0.9829714894294739, best validation acc: 0.9858982563018799, corresponding to test acc:                         0.9613295197486877 / 0.9723553657531738
after epoch: 18,now: 2024-06-09 07:45:32.367482,epoch time: 0:26:19.258381,used: 7:59:37.720293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.993355, 'precision': 0.9582906, 'recall': 0.9375057, 'specificity': 0.9375057, 'f1': 0.9476385, 'auroc': 0.9981545, 'binary_precision': 0.9208274, 'binary_recall': 0.8776343, 'binary_specificity': 0.9973772, 'binary_f1_score': 0.89871216}
confusion matrix:
       0     1
0  42210   111
1    180  1291
---- Validation: 
scalar performance:
{'acc': 0.9856322, 'precision': 0.92428195, 'recall': 0.8448007, 'specificity': 0.8448007, 'f1': 0.88011444, 'auroc': 0.9791982, 'binary_precision': 0.8593449, 'binary_recall': 0.69362366, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.767642}
confusion matrix:
       0    1
0  18076   73
1    197  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.83481646, 'recall': 0.56771487, 'specificity': 0.56771487, 'f1': 0.6055518, 'auroc': 0.9051847, 'binary_precision': 0.7058824, 'binary_recall': 0.13793103, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.23076923}
confusion matrix:
      0   1
0  5982  15
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_19.png
early stop counter: 8
val acc:0.9856321811676025, best validation acc: 0.9858982563018799, corresponding to test acc:                         0.9613295197486877 / 0.9723553657531738
after epoch: 19,now: 2024-06-09 08:12:13.609242,epoch time: 0:26:41.241760,used: 8:26:18.962053,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9940172, 'precision': 0.9677082, 'recall': 0.93817645, 'specificity': 0.93817645, 'f1': 0.9524245, 'auroc': 0.99804044, 'binary_precision': 0.93963635, 'binary_recall': 0.8783141, 'binary_specificity': 0.9980388, 'binary_f1_score': 0.9079409}
confusion matrix:
       0     1
0  42238    83
1    179  1292
---- Validation: 
scalar performance:
{'acc': 0.9855257, 'precision': 0.9346063, 'recall': 0.83199465, 'specificity': 0.83199465, 'f1': 0.8759153, 'auroc': 0.9787663, 'binary_precision': 0.8809035, 'binary_recall': 0.66718507, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.759292}
confusion matrix:
       0    1
0  18091   58
1    214  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.762836, 'recall': 0.5407282, 'specificity': 0.5407282, 'f1': 0.5628553, 'auroc': 0.9055989, 'binary_precision': 0.5641026, 'binary_recall': 0.08429119, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.14666668}
confusion matrix:
      0   1
0  5980  17
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_20.png
early stop counter: 9
val acc:0.9855257272720337, best validation acc: 0.9858982563018799, corresponding to test acc:                         0.9613295197486877 / 0.9723553657531738
after epoch: 20,now: 2024-06-09 08:38:57.831105,epoch time: 0:26:44.221863,used: 8:53:03.183916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9935376, 'precision': 0.9670162, 'recall': 0.93108463, 'specificity': 0.93108463, 'f1': 0.9482775, 'auroc': 0.9985225, 'binary_precision': 0.9387454, 'binary_recall': 0.86413044, 'binary_specificity': 0.99803877, 'binary_f1_score': 0.89989394}
confusion matrix:
       0     1
0  42237    83
1    200  1272
---- Validation: 
scalar performance:
{'acc': 0.9860579, 'precision': 0.93987644, 'recall': 0.8360204, 'specificity': 0.8360204, 'f1': 0.8804772, 'auroc': 0.97770745, 'binary_precision': 0.89117044, 'binary_recall': 0.6749611, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.76814157}
confusion matrix:
       0    1
0  18096   53
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.9040078, 'recall': 0.5817085, 'specificity': 0.5817085, 'f1': 0.62856126, 'auroc': 0.9169165, 'binary_precision': 0.84313726, 'binary_recall': 0.16475096, 'binary_specificity': 0.998666, 'binary_f1_score': 0.27564102}
confusion matrix:
      0   1
0  5989   8
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_21.png
better model found
persisted
after epoch: 21,now: 2024-06-09 09:05:47.828030,epoch time: 0:26:49.996925,used: 9:19:53.180841,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99433684, 'precision': 0.9700248, 'recall': 0.94096655, 'specificity': 0.94096655, 'f1': 0.9549973, 'auroc': 0.9988637, 'binary_precision': 0.9440813, 'binary_recall': 0.8837525, 'binary_specificity': 0.99818057, 'binary_f1_score': 0.9129213}
confusion matrix:
       0     1
0  42244    77
1    171  1300
---- Validation: 
scalar performance:
{'acc': 0.9852065, 'precision': 0.92431986, 'recall': 0.83707976, 'specificity': 0.83707976, 'f1': 0.8753153, 'auroc': 0.9765922, 'binary_precision': 0.85996056, 'binary_recall': 0.67807156, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.7582609}
confusion matrix:
       0    1
0  18078   71
1    207  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8642261, 'recall': 0.54347765, 'specificity': 0.54347765, 'f1': 0.56901735, 'auroc': 0.8955314, 'binary_precision': 0.76666665, 'binary_recall': 0.08812261, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.1580756}
confusion matrix:
      0   1
0  5990   7
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_22.png
early stop counter: 1
val acc:0.9852064847946167, best validation acc: 0.9860578775405884, corresponding to test acc:                         0.9638862013816833 / 0.9723553657531738
after epoch: 22,now: 2024-06-09 09:32:26.245302,epoch time: 0:26:38.417272,used: 9:46:31.598113,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9941313, 'precision': 0.9682053, 'recall': 0.93958825, 'specificity': 0.93958825, 'f1': 0.9534116, 'auroc': 0.9988109, 'binary_precision': 0.9405366, 'binary_recall': 0.8811141, 'binary_specificity': 0.9980624, 'binary_f1_score': 0.9098562}
confusion matrix:
       0     1
0  42238    82
1    175  1297
---- Validation: 
scalar performance:
{'acc': 0.9866965, 'precision': 0.9217849, 'recall': 0.8671033, 'specificity': 0.8671033, 'f1': 0.8923978, 'auroc': 0.9786641, 'binary_precision': 0.8527828, 'binary_recall': 0.7387247, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.79166675}
confusion matrix:
       0    1
0  18067   82
1    168  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8716722, 'recall': 0.5473091, 'specificity': 0.5473091, 'f1': 0.5753839, 'auroc': 0.93087685, 'binary_precision': 0.78125, 'binary_recall': 0.09578544, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.17064846}
confusion matrix:
      0   1
0  5990   7
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_23.png
better model found
persisted
after epoch: 23,now: 2024-06-09 09:59:09.915488,epoch time: 0:26:43.670186,used: 10:13:15.268299,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.991962, 'precision': 0.98627806, 'recall': 0.8879756, 'specificity': 0.8879756, 'f1': 0.9312109, 'auroc': 0.99841917, 'binary_precision': 0.98027444, 'binary_recall': 0.77649456, 'binary_specificity': 0.9994565, 'binary_f1_score': 0.8665656}
confusion matrix:
       0     1
0  42297    23
1    329  1143
---- Validation: 
scalar performance:
{'acc': 0.9823329, 'precision': 0.96305054, 'recall': 0.7568363, 'specificity': 0.7568363, 'f1': 0.8284612, 'auroc': 0.9741487, 'binary_precision': 0.9430199, 'binary_recall': 0.5147745, 'binary_specificity': 0.998898, 'binary_f1_score': 0.66599596}
confusion matrix:
       0    1
0  18129   20
1    312  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.81338143, 'recall': 0.52248824, 'specificity': 0.52248824, 'f1': 0.5325915, 'auroc': 0.89467245, 'binary_precision': 0.6666667, 'binary_recall': 0.04597701, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.086021505}
confusion matrix:
      0   1
0  5991   6
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_24.png
early stop counter: 1
val acc:0.9823328852653503, best validation acc: 0.9866964817047119, corresponding to test acc:                         0.9611697196960449 / 0.9723553657531738
after epoch: 24,now: 2024-06-09 10:26:00.118102,epoch time: 0:26:50.202614,used: 10:40:05.470913,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9947936, 'precision': 0.9519781, 'recall': 0.9697467, 'specificity': 0.9697467, 'f1': 0.9606775, 'auroc': 0.9986386, 'binary_precision': 0.9059438, 'binary_recall': 0.942896, 'binary_specificity': 0.9965974, 'binary_f1_score': 0.9240506}
confusion matrix:
       0     1
0  42177   144
1     84  1387
---- Validation: 
scalar performance:
{'acc': 0.9872818, 'precision': 0.91287255, 'recall': 0.88990796, 'specificity': 0.88990796, 'f1': 0.9010346, 'auroc': 0.97895503, 'binary_precision': 0.8333333, 'binary_recall': 0.785381, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.80864686}
confusion matrix:
       0    1
0  18048  101
1    138  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.79944545, 'recall': 0.58403915, 'specificity': 0.58403915, 'f1': 0.6256111, 'auroc': 0.9324696, 'binary_precision': 0.63380283, 'binary_recall': 0.1724138, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.27108437}
confusion matrix:
      0   1
0  5971  26
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_25.png
better model found
persisted
after epoch: 25,now: 2024-06-09 10:52:43.669880,epoch time: 0:26:43.551778,used: 11:06:49.022691,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9960267, 'precision': 0.96600306, 'recall': 0.97333753, 'specificity': 0.97333753, 'f1': 0.9696394, 'auroc': 0.9991291, 'binary_precision': 0.93377924, 'binary_recall': 0.94901425, 'binary_specificity': 0.99766076, 'binary_f1_score': 0.94133514}
confusion matrix:
       0     1
0  42222    99
1     75  1396
---- Validation: 
scalar performance:
{'acc': 0.98632395, 'precision': 0.90983087, 'recall': 0.8759111, 'specificity': 0.8759111, 'f1': 0.8920785, 'auroc': 0.98162526, 'binary_precision': 0.8282313, 'binary_recall': 0.7573872, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.7912266}
confusion matrix:
       0    1
0  18048  101
1    156  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.7986313, 'recall': 0.59894794, 'specificity': 0.59894794, 'f1': 0.6438047, 'auroc': 0.93193036, 'binary_precision': 0.63095236, 'binary_recall': 0.20306513, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.30724636}
confusion matrix:
      0   1
0  5966  31
1   208  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_26.png
early stop counter: 1
val acc:0.9863239526748657, best validation acc: 0.9872817993164062, corresponding to test acc:                         0.9613295197486877 / 0.9723553657531738
after epoch: 26,now: 2024-06-09 11:19:03.255033,epoch time: 0:26:19.585153,used: 11:33:08.607844,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.993903, 'precision': 0.9635993, 'recall': 0.9407421, 'specificity': 0.9407421, 'f1': 0.95185983, 'auroc': 0.99823666, 'binary_precision': 0.9312321, 'binary_recall': 0.8837525, 'binary_specificity': 0.9977316, 'binary_f1_score': 0.9068713}
confusion matrix:
       0     1
0  42225    96
1    171  1300
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.9056957, 'recall': 0.8549433, 'specificity': 0.8549433, 'f1': 0.87848794, 'auroc': 0.97640073, 'binary_precision': 0.8214286, 'binary_recall': 0.7153966, 'binary_specificity': 0.99449, 'binary_f1_score': 0.7647548}
confusion matrix:
       0    1
0  18049  100
1    183  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.82891226, 'recall': 0.6408434, 'specificity': 0.6408434, 'f1': 0.6936462, 'auroc': 0.9330275, 'binary_precision': 0.6880734, 'binary_recall': 0.28735632, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.4054054}
confusion matrix:
      0   1
0  5963  34
1   186  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_27.png
early stop counter: 2
val acc:0.9849404096603394, best validation acc: 0.9872817993164062, corresponding to test acc:                         0.9613295197486877 / 0.9723553657531738
after epoch: 27,now: 2024-06-09 11:45:56.676402,epoch time: 0:26:53.421369,used: 12:00:02.029213,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99538726, 'precision': 0.9682252, 'recall': 0.9602375, 'specificity': 0.9602375, 'f1': 0.9641944, 'auroc': 0.99909174, 'binary_precision': 0.93914247, 'binary_recall': 0.9225544, 'binary_specificity': 0.99792063, 'binary_f1_score': 0.93077457}
confusion matrix:
       0     1
0  42232    88
1    114  1358
---- Validation: 
scalar performance:
{'acc': 0.98616433, 'precision': 0.92457753, 'recall': 0.85407686, 'specificity': 0.85407686, 'f1': 0.8858851, 'auroc': 0.9833366, 'binary_precision': 0.8592871, 'binary_recall': 0.7122862, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.77891153}
confusion matrix:
       0    1
0  18074   75
1    185  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.8021078, 'recall': 0.6176881, 'specificity': 0.6176881, 'f1': 0.6653751, 'auroc': 0.9318478, 'binary_precision': 0.6363636, 'binary_recall': 0.2413793, 'binary_specificity': 0.993997, 'binary_f1_score': 0.35}
confusion matrix:
      0   1
0  5961  36
1   198  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_28.png
early stop counter: 3
val acc:0.9861643314361572, best validation acc: 0.9872817993164062, corresponding to test acc:                         0.9613295197486877 / 0.9723553657531738
after epoch: 28,now: 2024-06-09 12:12:48.322205,epoch time: 0:26:51.645803,used: 12:26:53.675016,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99438256, 'precision': 0.9481869, 'recall': 0.96756554, 'specificity': 0.96756554, 'f1': 0.9576547, 'auroc': 0.99902034, 'binary_precision': 0.8985036, 'binary_recall': 0.93881714, 'binary_specificity': 0.99631387, 'binary_f1_score': 0.9182181}
confusion matrix:
       0     1
0  42165   156
1     90  1381
---- Validation: 
scalar performance:
{'acc': 0.9843018, 'precision': 0.90123796, 'recall': 0.8486123, 'specificity': 0.8486123, 'f1': 0.87292695, 'auroc': 0.97334945, 'binary_precision': 0.81294966, 'binary_recall': 0.7029549, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.7539616}
confusion matrix:
       0    1
0  18045  104
1    191  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.75152004, 'recall': 0.56271625, 'specificity': 0.56271625, 'f1': 0.5944396, 'auroc': 0.9152814, 'binary_precision': 0.53968257, 'binary_recall': 0.1302682, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.20987654}
confusion matrix:
      0   1
0  5968  29
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_29.png
early stop counter: 4
val acc:0.9843018054962158, best validation acc: 0.9872817993164062, corresponding to test acc:                         0.9613295197486877 / 0.9723553657531738
after epoch: 29,now: 2024-06-09 12:39:15.378323,epoch time: 0:26:27.056118,used: 12:53:20.731134,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9963007, 'precision': 0.9895245, 'recall': 0.9527777, 'specificity': 0.9527777, 'f1': 0.97038186, 'auroc': 0.9995246, 'binary_precision': 0.9823009, 'binary_recall': 0.90612245, 'binary_specificity': 0.9994329, 'binary_f1_score': 0.9426751}
confusion matrix:
       0     1
0  42298    24
1    138  1332
---- Validation: 
scalar performance:
{'acc': 0.9871754, 'precision': 0.94653225, 'recall': 0.84859985, 'specificity': 0.84859985, 'f1': 0.8910844, 'auroc': 0.9783084, 'binary_precision': 0.90361446, 'binary_recall': 0.6998445, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.7887818}
confusion matrix:
       0    1
0  18101   48
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.83031684, 'recall': 0.5732953, 'specificity': 0.5732953, 'f1': 0.6132325, 'auroc': 0.94155747, 'binary_precision': 0.6964286, 'binary_recall': 0.14942528, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.24605678}
confusion matrix:
      0   1
0  5980  17
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_30.png
early stop counter: 5
val acc:0.9871754050254822, best validation acc: 0.9872817993164062, corresponding to test acc:                         0.9613295197486877 / 0.9723553657531738
after epoch: 30,now: 2024-06-09 13:06:06.519902,epoch time: 0:26:51.141579,used: 13:20:11.872713,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_45_54_seed_0_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:20:11.872713 at 2024-06-09 13:06:06.519902
persisted model performance metric: 

scalar performance:
{'acc': 0.9614893, 'precision': 0.80397546, 'recall': 0.58412254, 'specificity': 0.58412254, 'f1': 0.62606245, 'auroc': 0.935729, 'binary_precision': 0.64285713, 'binary_recall': 0.1724138, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.27190334}
confusion matrix:
      0   1
0  5972  25
1   216  45
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457162 KiB |   2003 MiB |    927 TiB |    927 TiB |
|       from large pool | 415909 KiB |   1971 MiB |    915 TiB |    915 TiB |
|       from small pool |  41253 KiB |     52 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457162 KiB |   2003 MiB |    927 TiB |    927 TiB |
|       from large pool | 415909 KiB |   1971 MiB |    915 TiB |    915 TiB |
|       from small pool |  41253 KiB |     52 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447655 KiB |   1998 MiB |    927 TiB |    927 TiB |
|       from large pool | 407075 KiB |   1966 MiB |    915 TiB |    915 TiB |
|       from small pool |  40580 KiB |     52 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2262 MiB |   2262 MiB |   2262 MiB |      0 B   |
|       from large pool |   2202 MiB |   2202 MiB |   2202 MiB |      0 B   |
|       from small pool |     60 MiB |     60 MiB |     60 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 292405 KiB | 361588 KiB | 755235 GiB | 755235 GiB |
|       from large pool | 286555 KiB | 357150 KiB | 742263 GiB | 742263 GiB |
|       from small pool |   5850 KiB |   9029 KiB |  12971 GiB |  12971 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2620    |    6459    |  180230 K  |  180228 K  |
|       from large pool |     187    |     311    |   87848 K  |   87848 K  |
|       from small pool |    2433    |    6271    |   92382 K  |   92379 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2620    |    6459    |  180230 K  |  180228 K  |
|       from large pool |     187    |     311    |   87848 K  |   87848 K  |
|       from small pool |    2433    |    6271    |   92382 K  |   92379 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     122    |     122    |     122    |       0    |
|       from large pool |      92    |      92    |      92    |       0    |
|       from small pool |      30    |      30    |      30    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    2781    |   95236 K  |   95236 K  |
|       from large pool |      26    |      89    |   59562 K  |   59562 K  |
|       from small pool |      26    |    2755    |   35673 K  |   35673 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |    927 TiB |    927 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    915 TiB |    915 TiB |
|       from small pool |      0 KiB |     52 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |    927 TiB |    927 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    915 TiB |    915 TiB |
|       from small pool |      0 KiB |     52 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |    927 TiB |    927 TiB |
|       from large pool |  16640 KiB |   1966 MiB |    915 TiB |    915 TiB |
|       from small pool |      0 KiB |     52 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 749568 KiB |   2262 MiB |   2262 MiB |   1530 MiB |
|       from large pool | 702464 KiB |   2202 MiB |   2202 MiB |   1516 MiB |
|       from small pool |  47104 KiB |     60 MiB |     60 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 409117 KiB | 755235 GiB | 755235 GiB |
|       from large pool |  24320 KiB | 392029 KiB | 742264 GiB | 742264 GiB |
|       from small pool |      0 KiB |  17832 KiB |  12971 GiB |  12971 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6459    |  180230 K  |  180230 K  |
|       from large pool |       2    |     311    |   87848 K  |   87848 K  |
|       from small pool |       0    |    6271    |   92382 K  |   92382 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6459    |  180230 K  |  180230 K  |
|       from large pool |       2    |     311    |   87848 K  |   87848 K  |
|       from small pool |       0    |    6271    |   92382 K  |   92382 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |     122    |     122    |      68    |
|       from large pool |      31    |      92    |      92    |      61    |
|       from small pool |      23    |      30    |      30    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2781    |   95237 K  |   95237 K  |
|       from large pool |       3    |      89    |   59562 K  |   59562 K  |
|       from small pool |       0    |    2755    |   35674 K  |   35674 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |    927 TiB |    927 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    915 TiB |    915 TiB |
|       from small pool |      0 KiB |     52 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |    927 TiB |    927 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    915 TiB |    915 TiB |
|       from small pool |      0 KiB |     52 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |    927 TiB |    927 TiB |
|       from large pool |  16640 KiB |   1966 MiB |    915 TiB |    915 TiB |
|       from small pool |      0 KiB |     52 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 749568 KiB |   2262 MiB |   2262 MiB |   1530 MiB |
|       from large pool | 702464 KiB |   2202 MiB |   2202 MiB |   1516 MiB |
|       from small pool |  47104 KiB |     60 MiB |     60 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 409117 KiB | 755235 GiB | 755235 GiB |
|       from large pool |  24320 KiB | 392029 KiB | 742264 GiB | 742264 GiB |
|       from small pool |      0 KiB |  17832 KiB |  12971 GiB |  12971 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6459    |  180230 K  |  180230 K  |
|       from large pool |       2    |     311    |   87848 K  |   87848 K  |
|       from small pool |       0    |    6271    |   92382 K  |   92382 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6459    |  180230 K  |  180230 K  |
|       from large pool |       2    |     311    |   87848 K  |   87848 K  |
|       from small pool |       0    |    6271    |   92382 K  |   92382 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |     122    |     122    |      68    |
|       from large pool |      31    |      92    |      92    |      61    |
|       from small pool |      23    |      30    |      30    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2781    |   95237 K  |   95237 K  |
|       from large pool |       3    |      89    |   59562 K  |   59562 K  |
|       from small pool |       0    |    2755    |   35674 K  |   35674 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159

 Experiment start at: 2024-06-09 13:13:50.844338
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.969035, 'precision': 0.7557379, 'recall': 0.8540297, 'specificity': 0.8540297, 'f1': 0.7960372, 'auroc': 0.9625949, 'binary_precision': 0.520751, 'binary_recall': 0.73092926, 'binary_specificity': 0.9771302, 'binary_f1_score': 0.6081939}
confusion matrix:
       0     1
0  41444   970
1    388  1054
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.75729483, 'recall': 0.81456006, 'specificity': 0.81456006, 'f1': 0.7827032, 'auroc': 0.9633391, 'binary_precision': 0.52771086, 'binary_recall': 0.6508172, 'binary_specificity': 0.97830296, 'binary_f1_score': 0.5828343}
confusion matrix:
       0    1
0  17675  392
1    235  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9734128, 'precision': 0.8489448, 'recall': 0.79854846, 'specificity': 0.79854846, 'f1': 0.8215676, 'auroc': 0.955343, 'binary_precision': 0.71493214, 'binary_recall': 0.6076923, 'binary_specificity': 0.9894046, 'binary_f1_score': 0.65696466}
confusion matrix:
      0    1
0  5883   63
1   102  158
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-09 13:41:36.961431,epoch time: 0:27:46.117093,used: 0:27:46.117093,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97446185, 'precision': 0.81562316, 'recall': 0.73926723, 'specificity': 0.73926723, 'f1': 0.7717318, 'auroc': 0.97038496, 'binary_precision': 0.648524, 'binary_recall': 0.48751733, 'binary_specificity': 0.9910171, 'binary_f1_score': 0.55661124}
confusion matrix:
       0    1
0  42033  381
1    739  703
---- Validation: 
scalar performance:
{'acc': 0.97203845, 'precision': 0.8134882, 'recall': 0.7401617, 'specificity': 0.7401617, 'f1': 0.7714978, 'auroc': 0.9689651, 'binary_precision': 0.64579254, 'binary_recall': 0.49034175, 'binary_specificity': 0.9899817, 'binary_f1_score': 0.5574324}
confusion matrix:
       0    1
0  17886  181
1    343  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.81901705, 'recall': 0.66176873, 'specificity': 0.66176873, 'f1': 0.7120553, 'auroc': 0.9607923, 'binary_precision': 0.6666667, 'binary_recall': 0.33076924, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.4421594}
confusion matrix:
      0   1
0  5903  43
1   174  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_2.png
better model found
persisted
after epoch: 2,now: 2024-06-09 14:08:16.698153,epoch time: 0:26:39.736722,used: 0:54:25.853815,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9804588, 'precision': 0.92256224, 'recall': 0.74002296, 'specificity': 0.74002296, 'f1': 0.80445695, 'auroc': 0.97914517, 'binary_precision': 0.8624535, 'binary_recall': 0.48266298, 'binary_specificity': 0.99738294, 'binary_f1_score': 0.6189417}
confusion matrix:
       0    1
0  42303  111
1    746  696
---- Validation: 
scalar performance:
{'acc': 0.9788154, 'precision': 0.90850043, 'recall': 0.7536901, 'specificity': 0.7536901, 'f1': 0.81159663, 'auroc': 0.975224, 'binary_precision': 0.83495146, 'binary_recall': 0.5111441, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.6341014}
confusion matrix:
       0    1
0  17999   68
1    329  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.75081813, 'recall': 0.537032, 'specificity': 0.537032, 'f1': 0.55673337, 'auroc': 0.96274865, 'binary_precision': 0.5405405, 'binary_recall': 0.07692308, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.13468014}
confusion matrix:
      0   1
0  5929  17
1   240  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_3.png
better model found
persisted
after epoch: 3,now: 2024-06-09 14:34:58.403835,epoch time: 0:26:41.705682,used: 1:21:07.559497,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98287576, 'precision': 0.91833633, 'recall': 0.78883576, 'specificity': 0.78883576, 'f1': 0.8408793, 'auroc': 0.98126876, 'binary_precision': 0.8507614, 'binary_recall': 0.5811373, 'binary_specificity': 0.99653417, 'binary_f1_score': 0.6905645}
confusion matrix:
       0    1
0  42267  147
1    604  838
---- Validation: 
scalar performance:
{'acc': 0.9790288, 'precision': 0.8951682, 'recall': 0.77096725, 'specificity': 0.77096725, 'f1': 0.8205465, 'auroc': 0.9774779, 'binary_precision': 0.80701756, 'binary_recall': 0.5468053, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.6519043}
confusion matrix:
       0    1
0  17979   88
1    305  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.78083277, 'recall': 0.59889585, 'specificity': 0.59889585, 'f1': 0.6417904, 'auroc': 0.9600895, 'binary_precision': 0.5955056, 'binary_recall': 0.20384616, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.30372494}
confusion matrix:
      0   1
0  5910  36
1   207  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_4.png
better model found
persisted
after epoch: 4,now: 2024-06-09 15:01:36.252274,epoch time: 0:26:37.848439,used: 1:47:45.407936,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98517877, 'precision': 0.8924322, 'recall': 0.86764586, 'specificity': 0.86764586, 'f1': 0.879602, 'auroc': 0.9847864, 'binary_precision': 0.79361546, 'binary_recall': 0.74184597, 'binary_specificity': 0.9934457, 'binary_f1_score': 0.766858}
confusion matrix:
       0     1
0  42137   278
1    372  1069
---- Validation: 
scalar performance:
{'acc': 0.9839381, 'precision': 0.90083194, 'recall': 0.8564844, 'specificity': 0.8564844, 'f1': 0.8772465, 'auroc': 0.9810916, 'binary_precision': 0.81208056, 'binary_recall': 0.7191679, 'binary_specificity': 0.9938009, 'binary_f1_score': 0.7628054}
confusion matrix:
       0    1
0  17955  112
1    189  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.7535276, 'recall': 0.583343, 'specificity': 0.583343, 'f1': 0.62071395, 'auroc': 0.9624792, 'binary_precision': 0.5421687, 'binary_recall': 0.17307693, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.26239067}
confusion matrix:
      0   1
0  5908  38
1   215  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_5.png
better model found
persisted
after epoch: 5,now: 2024-06-09 15:28:16.831447,epoch time: 0:26:40.579173,used: 2:14:25.987109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9854752, 'precision': 0.9103116, 'recall': 0.84812635, 'specificity': 0.84812635, 'f1': 0.8764734, 'auroc': 0.98742163, 'binary_precision': 0.83073133, 'binary_recall': 0.7011096, 'binary_specificity': 0.9951431, 'binary_f1_score': 0.7604363}
confusion matrix:
       0     1
0  42208   206
1    431  1011
---- Validation: 
scalar performance:
{'acc': 0.98164356, 'precision': 0.878195, 'recall': 0.84671116, 'specificity': 0.84671116, 'f1': 0.86170715, 'auroc': 0.98100764, 'binary_precision': 0.76747966, 'binary_recall': 0.7013373, 'binary_specificity': 0.99208504, 'binary_f1_score': 0.73291916}
confusion matrix:
       0    1
0  17924  143
1    201  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.7667266, 'recall': 0.60223746, 'specificity': 0.60223746, 'f1': 0.6438169, 'auroc': 0.9594419, 'binary_precision': 0.5670103, 'binary_recall': 0.21153846, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.30812326}
confusion matrix:
      0   1
0  5904  42
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_6.png
early stop counter: 1
val acc:0.981643557548523, best validation acc: 0.9839380979537964, corresponding to test acc:                         0.9592329859733582 / 0.973412811756134
after epoch: 6,now: 2024-06-09 15:54:59.948861,epoch time: 0:26:43.117414,used: 2:41:09.104523,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9866153, 'precision': 0.89390457, 'recall': 0.896279, 'specificity': 0.896279, 'f1': 0.8950879, 'auroc': 0.98868454, 'binary_precision': 0.7946244, 'binary_recall': 0.7995839, 'binary_specificity': 0.99297404, 'binary_f1_score': 0.7970965}
confusion matrix:
       0     1
0  42116   298
1    289  1153
---- Validation: 
scalar performance:
{'acc': 0.9835112, 'precision': 0.88788235, 'recall': 0.8684225, 'specificity': 0.8684225, 'f1': 0.87787944, 'auroc': 0.97906125, 'binary_precision': 0.78526646, 'binary_recall': 0.7444279, 'binary_specificity': 0.9924171, 'binary_f1_score': 0.7643021}
confusion matrix:
       0    1
0  17930  137
1    172  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.767623, 'recall': 0.6171175, 'specificity': 0.6171175, 'f1': 0.65963775, 'auroc': 0.9561947, 'binary_precision': 0.5675676, 'binary_recall': 0.2423077, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.33962265}
confusion matrix:
      0   1
0  5898  48
1   197  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_7.png
early stop counter: 2
val acc:0.983511209487915, best validation acc: 0.9839380979537964, corresponding to test acc:                         0.9592329859733582 / 0.973412811756134
after epoch: 7,now: 2024-06-09 16:21:31.336530,epoch time: 0:26:31.387669,used: 3:07:40.492192,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.985612, 'precision': 0.91987455, 'recall': 0.83915335, 'specificity': 0.83915335, 'f1': 0.8749003, 'auroc': 0.9870393, 'binary_precision': 0.8504754, 'binary_recall': 0.68238556, 'binary_specificity': 0.99592113, 'binary_f1_score': 0.7572143}
confusion matrix:
       0    1
0  42241  173
1    458  984
---- Validation: 
scalar performance:
{'acc': 0.983031, 'precision': 0.9218017, 'recall': 0.8145284, 'specificity': 0.8145284, 'f1': 0.8597236, 'auroc': 0.9819182, 'binary_precision': 0.85714287, 'binary_recall': 0.6329866, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.72820514}
confusion matrix:
       0    1
0  17996   71
1    247  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.7761965, 'recall': 0.57456857, 'specificity': 0.57456857, 'f1': 0.61168975, 'auroc': 0.960848, 'binary_precision': 0.5882353, 'binary_recall': 0.15384616, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.24390246}
confusion matrix:
      0   1
0  5918  28
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_8.png
early stop counter: 3
val acc:0.9830309748649597, best validation acc: 0.9839380979537964, corresponding to test acc:                         0.9592329859733582 / 0.973412811756134
after epoch: 8,now: 2024-06-09 16:48:14.579555,epoch time: 0:26:43.243025,used: 3:34:23.735217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98711693, 'precision': 0.9146246, 'recall': 0.8747664, 'specificity': 0.8747664, 'f1': 0.8936108, 'auroc': 0.99053, 'binary_precision': 0.8375674, 'binary_recall': 0.7545076, 'binary_specificity': 0.9950252, 'binary_f1_score': 0.79387087}
confusion matrix:
       0     1
0  42203   211
1    354  1088
---- Validation: 
scalar performance:
{'acc': 0.98345786, 'precision': 0.9059613, 'recall': 0.8404994, 'specificity': 0.8404994, 'f1': 0.8701159, 'auroc': 0.9821117, 'binary_precision': 0.8235294, 'binary_recall': 0.68647844, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.7487845}
confusion matrix:
       0    1
0  17968   99
1    211  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.79755366, 'recall': 0.576828, 'specificity': 0.576828, 'f1': 0.61610174, 'auroc': 0.95870364, 'binary_precision': 0.63076925, 'binary_recall': 0.15769231, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.2523077}
confusion matrix:
      0   1
0  5922  24
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_9.png
early stop counter: 4
val acc:0.9834578633308411, best validation acc: 0.9839380979537964, corresponding to test acc:                         0.9592329859733582 / 0.973412811756134
after epoch: 9,now: 2024-06-09 17:14:51.202719,epoch time: 0:26:36.623164,used: 4:01:00.358381,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9879834, 'precision': 0.8966418, 'recall': 0.9207679, 'specificity': 0.9207679, 'f1': 0.90831894, 'auroc': 0.9921566, 'binary_precision': 0.79843444, 'binary_recall': 0.8488211, 'binary_specificity': 0.99271464, 'binary_f1_score': 0.82285714}
confusion matrix:
       0     1
0  42105   309
1    218  1224
---- Validation: 
scalar performance:
{'acc': 0.98399144, 'precision': 0.87262106, 'recall': 0.9087266, 'specificity': 0.9087266, 'f1': 0.88975894, 'auroc': 0.9835466, 'binary_precision': 0.75168693, 'binary_recall': 0.82763743, 'binary_specificity': 0.9898157, 'binary_f1_score': 0.78783596}
confusion matrix:
       0    1
0  17883  184
1    116  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.77880275, 'recall': 0.57089055, 'specificity': 0.57089055, 'f1': 0.60702586, 'auroc': 0.9561413, 'binary_precision': 0.59375, 'binary_recall': 0.14615385, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.23456791}
confusion matrix:
      0   1
0  5920  26
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_10.png
better model found
persisted
after epoch: 10,now: 2024-06-09 17:41:24.785106,epoch time: 0:26:33.582387,used: 4:27:33.940768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98371947, 'precision': 0.84695065, 'recall': 0.9386227, 'specificity': 0.9386227, 'f1': 0.8869302, 'auroc': 0.99156123, 'binary_precision': 0.69766176, 'binary_recall': 0.8903539, 'binary_specificity': 0.98689145, 'binary_f1_score': 0.78231704}
confusion matrix:
       0     1
0  41859   556
1    158  1283
---- Validation: 
scalar performance:
{'acc': 0.98164356, 'precision': 0.84788346, 'recall': 0.9189532, 'specificity': 0.9189532, 'f1': 0.8797847, 'auroc': 0.9829234, 'binary_precision': 0.7013464, 'binary_recall': 0.8514116, 'binary_specificity': 0.9864947, 'binary_f1_score': 0.76912755}
confusion matrix:
       0    1
0  17823  244
1    100  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.8096771, 'recall': 0.64270616, 'specificity': 0.64270616, 'f1': 0.6922438, 'auroc': 0.9567912, 'binary_precision': 0.6495727, 'binary_recall': 0.2923077, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.40318304}
confusion matrix:
      0   1
0  5905  41
1   184  76
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_11.png
early stop counter: 1
val acc:0.981643557548523, best validation acc: 0.9839914441108704, corresponding to test acc:                         0.9600386619567871 / 0.973412811756134
after epoch: 11,now: 2024-06-09 18:07:59.446553,epoch time: 0:26:34.661447,used: 4:54:08.602215,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9902864, 'precision': 0.9372653, 'recall': 0.90554583, 'specificity': 0.90554583, 'f1': 0.92076313, 'auroc': 0.99321264, 'binary_precision': 0.8808096, 'binary_recall': 0.8148405, 'binary_specificity': 0.9962512, 'binary_f1_score': 0.84654176}
confusion matrix:
       0     1
0  42255   159
1    267  1175
---- Validation: 
scalar performance:
{'acc': 0.9860726, 'precision': 0.9215505, 'recall': 0.8676051, 'specificity': 0.8676051, 'f1': 0.8925787, 'auroc': 0.9823755, 'binary_precision': 0.85273975, 'binary_recall': 0.73997027, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.7923628}
confusion matrix:
       0    1
0  17981   86
1    175  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.8419814, 'recall': 0.6417081, 'specificity': 0.6417081, 'f1': 0.6965561, 'auroc': 0.96019256, 'binary_precision': 0.71428573, 'binary_recall': 0.28846154, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.4109589}
confusion matrix:
      0   1
0  5916  30
1   185  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_12.png
better model found
persisted
after epoch: 12,now: 2024-06-09 18:34:30.057650,epoch time: 0:26:30.611097,used: 5:20:39.213312,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9863645, 'precision': 0.9466677, 'recall': 0.82580936, 'specificity': 0.82580936, 'f1': 0.8761214, 'auroc': 0.9921279, 'binary_precision': 0.9049904, 'binary_recall': 0.65395284, 'binary_specificity': 0.9976659, 'binary_f1_score': 0.7592592}
confusion matrix:
       0    1
0  42315   99
1    499  943
---- Validation: 
scalar performance:
{'acc': 0.9829242, 'precision': 0.9518138, 'recall': 0.7865776, 'specificity': 0.7865776, 'f1': 0.8493504, 'auroc': 0.98115945, 'binary_precision': 0.9192399, 'binary_recall': 0.5750371, 'binary_specificity': 0.9981181, 'binary_f1_score': 0.7074954}
confusion matrix:
       0    1
0  18033   34
1    286  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.7701806, 'recall': 0.5409622, 'specificity': 0.5409622, 'f1': 0.56334174, 'auroc': 0.957595, 'binary_precision': 0.57894737, 'binary_recall': 0.08461539, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.147651}
confusion matrix:
      0   1
0  5930  16
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_13.png
early stop counter: 1
val acc:0.982924222946167, best validation acc: 0.9860725998878479, corresponding to test acc:                         0.9653561115264893 / 0.973412811756134
after epoch: 13,now: 2024-06-09 19:01:08.753604,epoch time: 0:26:38.695954,used: 5:47:17.909266,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9864557, 'precision': 0.86685336, 'recall': 0.9521334, 'specificity': 0.9521334, 'f1': 0.9046476, 'auroc': 0.99495566, 'binary_precision': 0.73660713, 'binary_recall': 0.91539526, 'binary_specificity': 0.9888716, 'binary_f1_score': 0.8163265}
confusion matrix:
       0     1
0  41942   472
1    122  1320
---- Validation: 
scalar performance:
{'acc': 0.98441833, 'precision': 0.86939764, 'recall': 0.9261144, 'specificity': 0.9261144, 'f1': 0.89553475, 'auroc': 0.981722, 'binary_precision': 0.74391806, 'binary_recall': 0.86329865, 'binary_specificity': 0.9889301, 'binary_f1_score': 0.7991747}
confusion matrix:
       0    1
0  17867  200
1     92  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.8042145, 'recall': 0.61068654, 'specificity': 0.61068654, 'f1': 0.65791214, 'auroc': 0.9621911, 'binary_precision': 0.6413044, 'binary_recall': 0.22692308, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.33522728}
confusion matrix:
      0   1
0  5913  33
1   201  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_14.png
early stop counter: 2
val acc:0.9844183325767517, best validation acc: 0.9860725998878479, corresponding to test acc:                         0.9653561115264893 / 0.973412811756134
after epoch: 14,now: 2024-06-09 19:27:46.428995,epoch time: 0:26:37.675391,used: 6:13:55.584657,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99094766, 'precision': 0.9662726, 'recall': 0.88612556, 'specificity': 0.88612556, 'f1': 0.922163, 'auroc': 0.9955934, 'binary_precision': 0.94018537, 'binary_recall': 0.7739251, 'binary_specificity': 0.998326, 'binary_f1_score': 0.848992}
confusion matrix:
       0     1
0  42343    71
1    326  1116
---- Validation: 
scalar performance:
{'acc': 0.9851121, 'precision': 0.9307327, 'recall': 0.8406421, 'specificity': 0.8406421, 'f1': 0.88000166, 'auroc': 0.9804954, 'binary_precision': 0.87310606, 'binary_recall': 0.68499255, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.76769364}
confusion matrix:
       0    1
0  18000   67
1    212  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.7950504, 'recall': 0.55057764, 'specificity': 0.55057764, 'f1': 0.57882726, 'auroc': 0.95229065, 'binary_precision': 0.627907, 'binary_recall': 0.103846155, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.17821783}
confusion matrix:
      0   1
0  5930  16
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_15.png
early stop counter: 3
val acc:0.9851120710372925, best validation acc: 0.9860725998878479, corresponding to test acc:                         0.9653561115264893 / 0.973412811756134
after epoch: 15,now: 2024-06-09 19:54:36.630242,epoch time: 0:26:50.201247,used: 6:40:45.785904,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99126685, 'precision': 0.9454337, 'recall': 0.91342175, 'specificity': 0.91342175, 'f1': 0.92878604, 'auroc': 0.99559593, 'binary_precision': 0.8966292, 'binary_recall': 0.8300971, 'binary_specificity': 0.99674636, 'binary_f1_score': 0.86208135}
confusion matrix:
       0     1
0  42276   138
1    245  1197
---- Validation: 
scalar performance:
{'acc': 0.98623264, 'precision': 0.93241704, 'recall': 0.85767436, 'specificity': 0.85767436, 'f1': 0.8912216, 'auroc': 0.98121905, 'binary_precision': 0.875226, 'binary_recall': 0.7191679, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.78955954}
confusion matrix:
       0    1
0  17998   69
1    189  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.7817768, 'recall': 0.56721264, 'specificity': 0.56721264, 'f1': 0.60224533, 'auroc': 0.9534947, 'binary_precision': 0.6, 'binary_recall': 0.13846155, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.22500002}
confusion matrix:
      0   1
0  5922  24
1   224  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_16.png
better model found
persisted
after epoch: 16,now: 2024-06-09 20:21:14.402126,epoch time: 0:26:37.771884,used: 7:07:23.557788,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99001276, 'precision': 0.94110847, 'recall': 0.8960258, 'specificity': 0.8960258, 'f1': 0.91726184, 'auroc': 0.9945014, 'binary_precision': 0.8891473, 'binary_recall': 0.79542303, 'binary_specificity': 0.99662846, 'binary_f1_score': 0.8396779}
confusion matrix:
       0     1
0  42271   143
1    295  1147
---- Validation: 
scalar performance:
{'acc': 0.98564565, 'precision': 0.94751745, 'recall': 0.83305085, 'specificity': 0.83305085, 'f1': 0.8812403, 'auroc': 0.97899187, 'binary_precision': 0.9072581, 'binary_recall': 0.6686478, 'binary_specificity': 0.9974539, 'binary_f1_score': 0.7698888}
confusion matrix:
       0    1
0  18021   46
1    223  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.795002, 'recall': 0.5412145, 'specificity': 0.5412145, 'f1': 0.56421894, 'auroc': 0.92659867, 'binary_precision': 0.62857145, 'binary_recall': 0.08461539, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.14915253}
confusion matrix:
      0   1
0  5933  13
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_17.png
early stop counter: 1
val acc:0.9856456518173218, best validation acc: 0.9862326383590698, corresponding to test acc:                         0.9600386619567871 / 0.973412811756134
after epoch: 17,now: 2024-06-09 20:47:30.190932,epoch time: 0:26:15.788806,used: 7:33:39.346594,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99215615, 'precision': 0.94735706, 'recall': 0.9269446, 'specificity': 0.9269446, 'f1': 0.9368944, 'auroc': 0.99640304, 'binary_precision': 0.8995633, 'binary_recall': 0.85714287, 'binary_specificity': 0.99674636, 'binary_f1_score': 0.8778409}
confusion matrix:
       0     1
0  42276   138
1    206  1236
---- Validation: 
scalar performance:
{'acc': 0.9857524, 'precision': 0.92297935, 'recall': 0.86028636, 'specificity': 0.86028636, 'f1': 0.88891447, 'auroc': 0.97947896, 'binary_precision': 0.8561404, 'binary_recall': 0.7251114, 'binary_specificity': 0.99546134, 'binary_f1_score': 0.7851971}
confusion matrix:
       0    1
0  17985   82
1    185  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.8131011, 'recall': 0.5808423, 'specificity': 0.5808423, 'f1': 0.622421, 'auroc': 0.94668114, 'binary_precision': 0.6615385, 'binary_recall': 0.16538462, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.2646154}
confusion matrix:
      0   1
0  5924  22
1   217  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_18.png
early stop counter: 2
val acc:0.9857524037361145, best validation acc: 0.9862326383590698, corresponding to test acc:                         0.9600386619567871 / 0.973412811756134
after epoch: 18,now: 2024-06-09 21:14:27.140118,epoch time: 0:26:56.949186,used: 8:00:36.295780,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9929086, 'precision': 0.96828794, 'recall': 0.9169501, 'specificity': 0.9169501, 'f1': 0.9410224, 'auroc': 0.99704754, 'binary_precision': 0.9421423, 'binary_recall': 0.83564496, 'binary_specificity': 0.9982553, 'binary_f1_score': 0.88570386}
confusion matrix:
       0     1
0  42340    74
1    237  1205
---- Validation: 
scalar performance:
{'acc': 0.9867663, 'precision': 0.94769293, 'recall': 0.8507985, 'specificity': 0.8507985, 'f1': 0.89290357, 'auroc': 0.9840839, 'binary_precision': 0.9063097, 'binary_recall': 0.70430905, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.79264206}
confusion matrix:
       0    1
0  18018   49
1    199  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.795204, 'recall': 0.55994076, 'specificity': 0.55994076, 'f1': 0.5926881, 'auroc': 0.9487668, 'binary_precision': 0.627451, 'binary_recall': 0.12307692, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.20578778}
confusion matrix:
      0   1
0  5927  19
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_19.png
better model found
persisted
after epoch: 19,now: 2024-06-09 21:40:59.960287,epoch time: 0:26:32.820169,used: 8:27:09.115949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99322784, 'precision': 0.98596317, 'recall': 0.9057268, 'specificity': 0.9057268, 'f1': 0.9419831, 'auroc': 0.9976963, 'binary_precision': 0.97827905, 'binary_recall': 0.81206656, 'binary_specificity': 0.99938697, 'binary_f1_score': 0.8874573}
confusion matrix:
       0     1
0  42388    26
1    271  1171
---- Validation: 
scalar performance:
{'acc': 0.98564565, 'precision': 0.95409137, 'recall': 0.82732874, 'specificity': 0.82732874, 'f1': 0.87964535, 'auroc': 0.98133034, 'binary_precision': 0.92083335, 'binary_recall': 0.65676075, 'binary_specificity': 0.99789673, 'binary_f1_score': 0.7666956}
confusion matrix:
       0    1
0  18029   38
1    231  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.8098974, 'recall': 0.5469837, 'specificity': 0.5469837, 'f1': 0.57365656, 'auroc': 0.94430983, 'binary_precision': 0.65789473, 'binary_recall': 0.09615385, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.16778524}
confusion matrix:
      0   1
0  5933  13
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_20.png
early stop counter: 1
val acc:0.9856456518173218, best validation acc: 0.9867662787437439, corresponding to test acc:                         0.9601998329162598 / 0.973412811756134
after epoch: 20,now: 2024-06-09 22:07:53.895160,epoch time: 0:26:53.934873,used: 8:54:03.050822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99220175, 'precision': 0.97065943, 'recall': 0.90278476, 'specificity': 0.90278476, 'f1': 0.9338963, 'auroc': 0.9976982, 'binary_precision': 0.9478403, 'binary_recall': 0.8070784, 'binary_specificity': 0.9984911, 'binary_f1_score': 0.87181413}
confusion matrix:
       0     1
0  42351    64
1    278  1163
---- Validation: 
scalar performance:
{'acc': 0.9810566, 'precision': 0.9202977, 'recall': 0.78203267, 'specificity': 0.78203267, 'f1': 0.83649457, 'auroc': 0.9806614, 'binary_precision': 0.85650223, 'binary_recall': 0.5676077, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.68275243}
confusion matrix:
       0    1
0  18003   64
1    291  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.76726484, 'recall': 0.58367944, 'specificity': 0.58367944, 'f1': 0.6224311, 'auroc': 0.94866186, 'binary_precision': 0.56962025, 'binary_recall': 0.17307693, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.26548675}
confusion matrix:
      0   1
0  5912  34
1   215  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_21.png
early stop counter: 2
val acc:0.9810565710067749, best validation acc: 0.9867662787437439, corresponding to test acc:                         0.9601998329162598 / 0.973412811756134
after epoch: 21,now: 2024-06-09 22:35:41.941683,epoch time: 0:27:48.046523,used: 9:21:51.097345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99382067, 'precision': 0.96425354, 'recall': 0.9365139, 'specificity': 0.9365139, 'f1': 0.9499249, 'auroc': 0.9978461, 'binary_precision': 0.93274206, 'binary_recall': 0.8751734, 'binary_specificity': 0.9978545, 'binary_f1_score': 0.9030411}
confusion matrix:
       0     1
0  42323    91
1    180  1262
---- Validation: 
scalar performance:
{'acc': 0.98703307, 'precision': 0.9404243, 'recall': 0.8623811, 'specificity': 0.8623811, 'f1': 0.8973031, 'auroc': 0.9806299, 'binary_precision': 0.8909091, 'binary_recall': 0.7280832, 'binary_specificity': 0.996679, 'binary_f1_score': 0.8013083}
confusion matrix:
       0    1
0  18007   60
1    183  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.7727357, 'recall': 0.58752555, 'specificity': 0.58752555, 'f1': 0.62759876, 'auroc': 0.91856176, 'binary_precision': 0.5802469, 'binary_recall': 0.18076923, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.27565983}
confusion matrix:
      0   1
0  5912  34
1   213  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_22.png
better model found
persisted
after epoch: 22,now: 2024-06-09 23:02:42.862254,epoch time: 0:27:00.920571,used: 9:48:52.017916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9943223, 'precision': 0.96354175, 'recall': 0.945817, 'specificity': 0.945817, 'f1': 0.95449364, 'auroc': 0.9979712, 'binary_precision': 0.93068594, 'binary_recall': 0.89389735, 'binary_specificity': 0.9977366, 'binary_f1_score': 0.9119207}
confusion matrix:
       0     1
0  42318    96
1    153  1289
---- Validation: 
scalar performance:
{'acc': 0.98553896, 'precision': 0.933939, 'recall': 0.8444398, 'specificity': 0.8444398, 'f1': 0.8836298, 'auroc': 0.98035216, 'binary_precision': 0.8792453, 'binary_recall': 0.692422, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.77472985}
confusion matrix:
       0    1
0  18003   64
1    207  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.82480764, 'recall': 0.60550594, 'specificity': 0.60550594, 'f1': 0.6542149, 'auroc': 0.9353769, 'binary_precision': 0.68292683, 'binary_recall': 0.21538462, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.3274854}
confusion matrix:
      0   1
0  5920  26
1   204  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_23.png
early stop counter: 1
val acc:0.9855389595031738, best validation acc: 0.9870330691337585, corresponding to test acc:                         0.9601998329162598 / 0.973412811756134
after epoch: 23,now: 2024-06-09 23:31:08.436014,epoch time: 0:28:25.573760,used: 10:17:17.591676,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99304545, 'precision': 0.9343871, 'recall': 0.96022964, 'specificity': 0.96022964, 'f1': 0.9469054, 'auroc': 0.99822277, 'binary_precision': 0.8713259, 'binary_recall': 0.925104, 'binary_specificity': 0.9953553, 'binary_f1_score': 0.89741004}
confusion matrix:
       0     1
0  42217   197
1    108  1334
---- Validation: 
scalar performance:
{'acc': 0.9846852, 'precision': 0.8933237, 'recall': 0.8826214, 'specificity': 0.8826214, 'f1': 0.8878921, 'auroc': 0.97785133, 'binary_precision': 0.795107, 'binary_recall': 0.7726597, 'binary_specificity': 0.99258316, 'binary_f1_score': 0.7837227}
confusion matrix:
       0    1
0  17933  134
1    153  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.7888917, 'recall': 0.597225, 'specificity': 0.597225, 'f1': 0.6407387, 'auroc': 0.93225646, 'binary_precision': 0.6117647, 'binary_recall': 0.2, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.3014493}
confusion matrix:
      0   1
0  5913  33
1   208  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_24.png
early stop counter: 2
val acc:0.9846851825714111, best validation acc: 0.9870330691337585, corresponding to test acc:                         0.9601998329162598 / 0.973412811756134
after epoch: 24,now: 2024-06-09 23:58:28.329309,epoch time: 0:27:19.893295,used: 10:44:37.484971,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99325067, 'precision': 0.98715293, 'recall': 0.90506864, 'specificity': 0.90506864, 'f1': 0.9420721, 'auroc': 0.9987744, 'binary_precision': 0.9807047, 'binary_recall': 0.8106796, 'binary_specificity': 0.9994577, 'binary_f1_score': 0.8876234}
confusion matrix:
       0     1
0  42391    23
1    273  1169
---- Validation: 
scalar performance:
{'acc': 0.9836179, 'precision': 0.95528114, 'recall': 0.7948053, 'specificity': 0.7948053, 'f1': 0.85661435, 'auroc': 0.98235095, 'binary_precision': 0.9255814, 'binary_recall': 0.59138185, 'binary_specificity': 0.9982288, 'binary_f1_score': 0.7216682}
confusion matrix:
       0    1
0  18035   32
1    275  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.81076574, 'recall': 0.5826813, 'specificity': 0.5826813, 'f1': 0.62466824, 'auroc': 0.93147457, 'binary_precision': 0.6567164, 'binary_recall': 0.16923077, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.26911315}
confusion matrix:
      0   1
0  5923  23
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_25.png
early stop counter: 3
val acc:0.983617901802063, best validation acc: 0.9870330691337585, corresponding to test acc:                         0.9601998329162598 / 0.973412811756134
after epoch: 25,now: 2024-06-10 00:25:28.591423,epoch time: 0:27:00.262114,used: 11:11:37.747085,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99382067, 'precision': 0.96062243, 'recall': 0.94053334, 'specificity': 0.94053334, 'f1': 0.9503372, 'auroc': 0.9984038, 'binary_precision': 0.9251997, 'binary_recall': 0.88349515, 'binary_specificity': 0.9975715, 'binary_f1_score': 0.90386665}
confusion matrix:
       0     1
0  42311   103
1    168  1274
---- Validation: 
scalar performance:
{'acc': 0.9839381, 'precision': 0.8988732, 'recall': 0.85934544, 'specificity': 0.85934544, 'f1': 0.8779886, 'auroc': 0.9781208, 'binary_precision': 0.80794704, 'binary_recall': 0.7251114, 'binary_specificity': 0.99357945, 'binary_f1_score': 0.7642913}
confusion matrix:
       0    1
0  17951  116
1    185  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.7611649, 'recall': 0.59095126, 'specificity': 0.59095126, 'f1': 0.6304432, 'auroc': 0.9335712, 'binary_precision': 0.5568182, 'binary_recall': 0.18846154, 'binary_specificity': 0.993441, 'binary_f1_score': 0.2816092}
confusion matrix:
      0   1
0  5907  39
1   211  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_26.png
early stop counter: 4
val acc:0.9839380979537964, best validation acc: 0.9870330691337585, corresponding to test acc:                         0.9601998329162598 / 0.973412811756134
after epoch: 26,now: 2024-06-10 00:52:55.686847,epoch time: 0:27:27.095424,used: 11:39:04.842509,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9958044, 'precision': 0.97455627, 'recall': 0.9586415, 'specificity': 0.9586415, 'f1': 0.96645314, 'auroc': 0.9987132, 'binary_precision': 0.9518678, 'binary_recall': 0.9188627, 'binary_specificity': 0.99842036, 'binary_f1_score': 0.9350741}
confusion matrix:
       0     1
0  42347    67
1    117  1325
---- Validation: 
scalar performance:
{'acc': 0.98655283, 'precision': 0.9307012, 'recall': 0.8649931, 'specificity': 0.8649931, 'f1': 0.8949102, 'auroc': 0.980916, 'binary_precision': 0.8712522, 'binary_recall': 0.73402673, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.79677415}
confusion matrix:
       0    1
0  17994   73
1    179  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.79153585, 'recall': 0.57298183, 'specificity': 0.57298183, 'f1': 0.6106099, 'auroc': 0.9324695, 'binary_precision': 0.61904764, 'binary_recall': 0.15, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.24148609}
confusion matrix:
      0   1
0  5922  24
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_27.png
early stop counter: 5
val acc:0.9865528345108032, best validation acc: 0.9870330691337585, corresponding to test acc:                         0.9601998329162598 / 0.973412811756134
after epoch: 27,now: 2024-06-10 01:20:37.142492,epoch time: 0:27:41.455645,used: 12:06:46.298154,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9961009, 'precision': 0.96978754, 'recall': 0.96884334, 'specificity': 0.96884334, 'f1': 0.96931493, 'auroc': 0.99915314, 'binary_precision': 0.94162613, 'binary_recall': 0.9396671, 'binary_specificity': 0.9980195, 'binary_f1_score': 0.9406456}
confusion matrix:
       0     1
0  42330    84
1     87  1355
---- Validation: 
scalar performance:
{'acc': 0.98788685, 'precision': 0.92821777, 'recall': 0.8907193, 'specificity': 0.8907193, 'f1': 0.9085373, 'auroc': 0.9827436, 'binary_precision': 0.8643791, 'binary_recall': 0.7860327, 'binary_specificity': 0.995406, 'binary_f1_score': 0.8233463}
confusion matrix:
       0    1
0  17984   83
1    144  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.7984997, 'recall': 0.58059007, 'specificity': 0.58059007, 'f1': 0.62108433, 'auroc': 0.95216644, 'binary_precision': 0.63235295, 'binary_recall': 0.16538462, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.2621951}
confusion matrix:
      0   1
0  5921  25
1   217  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_28.png
better model found
persisted
after epoch: 28,now: 2024-06-10 01:47:20.907005,epoch time: 0:26:43.764513,used: 12:33:30.062667,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9961465, 'precision': 0.97314656, 'recall': 0.9658523, 'specificity': 0.9658523, 'f1': 0.96946895, 'auroc': 0.998276, 'binary_precision': 0.94855535, 'binary_recall': 0.9334258, 'binary_specificity': 0.99827886, 'binary_f1_score': 0.9409298}
confusion matrix:
       0     1
0  42341    73
1     96  1346
---- Validation: 
scalar performance:
{'acc': 0.98788685, 'precision': 0.93532884, 'recall': 0.8821361, 'specificity': 0.8821361, 'f1': 0.9068584, 'auroc': 0.9816462, 'binary_precision': 0.8792517, 'binary_recall': 0.76820207, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.81998414}
confusion matrix:
       0    1
0  17996   71
1    156  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.7943935, 'recall': 0.5898691, 'specificity': 0.5898691, 'f1': 0.6324539, 'auroc': 0.9102302, 'binary_precision': 0.6233766, 'binary_recall': 0.18461539, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.28486648}
confusion matrix:
      0   1
0  5917  29
1   212  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_29.png
early stop counter: 1
val acc:0.9878868460655212, best validation acc: 0.9878868460655212, corresponding to test acc:                         0.961005449295044 / 0.973412811756134
after epoch: 29,now: 2024-06-10 02:17:29.488943,epoch time: 0:30:08.581938,used: 13:03:38.644605,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99585, 'precision': 0.9653556, 'recall': 0.96971846, 'specificity': 0.96971846, 'f1': 0.9675261, 'auroc': 0.9994203, 'binary_precision': 0.9326923, 'binary_recall': 0.94174755, 'binary_specificity': 0.9976894, 'binary_f1_score': 0.93719804}
confusion matrix:
       0     1
0  42316    98
1     84  1358
---- Validation: 
scalar performance:
{'acc': 0.9847385, 'precision': 0.9152423, 'recall': 0.8518926, 'specificity': 0.8518926, 'f1': 0.88073146, 'auroc': 0.97446156, 'binary_precision': 0.84126985, 'binary_recall': 0.7087667, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.7693548}
confusion matrix:
       0    1
0  17977   90
1    196  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.79250693, 'recall': 0.62347543, 'specificity': 0.62347543, 'f1': 0.6700815, 'auroc': 0.8735322, 'binary_precision': 0.6168224, 'binary_recall': 0.25384617, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.35967302}
confusion matrix:
      0   1
0  5905  41
1   194  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_30.png
early stop counter: 2
val acc:0.9847385287284851, best validation acc: 0.9878868460655212, corresponding to test acc:                         0.961005449295044 / 0.973412811756134
after epoch: 30,now: 2024-06-10 02:53:12.609262,epoch time: 0:35:43.120319,used: 13:39:21.764924,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_13_13_50_seed_1_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:39:21.764924 at 2024-06-10 02:53:12.609262
persisted model performance metric: 

scalar performance:
{'acc': 0.95955527, 'precision': 0.7637602, 'recall': 0.57431626, 'specificity': 0.57431626, 'f1': 0.6104577, 'auroc': 0.9485127, 'binary_precision': 0.5633803, 'binary_recall': 0.15384616, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.24169184}
confusion matrix:
      0   1
0  5915  31
1   220  40
oracle model performance metric: 

scalar performance:
{'acc': 0.9740574, 'precision': 0.85363674, 'recall': 0.80256283, 'specificity': 0.80256283, 'f1': 0.8258932, 'auroc': 0.9570993, 'binary_precision': 0.7239819, 'binary_recall': 0.61538464, 'binary_specificity': 0.989741, 'binary_f1_score': 0.6652807}
confusion matrix:
      0    1
0  5885   61
1   100  160
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456850 KiB |   2004 MiB |   1859 TiB |   1859 TiB |
|       from large pool | 415174 KiB |   1971 MiB |   1835 TiB |   1835 TiB |
|       from small pool |  41675 KiB |     57 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456850 KiB |   2004 MiB |   1859 TiB |   1859 TiB |
|       from large pool | 415174 KiB |   1971 MiB |   1835 TiB |   1835 TiB |
|       from small pool |  41675 KiB |     57 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |   1998 MiB |   1856 TiB |   1856 TiB |
|       from large pool | 407075 KiB |   1966 MiB |   1831 TiB |   1831 TiB |
|       from small pool |  40676 KiB |     56 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2260 MiB |   2262 MiB |   3790 MiB |   1530 MiB |
|       from large pool |   2196 MiB |   2202 MiB |   3712 MiB |   1516 MiB |
|       from small pool |     64 MiB |     64 MiB |     78 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 368494 KiB | 409131 KiB |   1446 TiB |   1446 TiB |
|       from large pool | 361017 KiB | 402413 KiB |   1420 TiB |   1420 TiB |
|       from small pool |   7476 KiB |  17832 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    6467    |  360743 K  |  360740 K  |
|       from large pool |     187    |     311    |  175827 K  |  175826 K  |
|       from small pool |    3277    |    6279    |  184916 K  |  184913 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    6467    |  360743 K  |  360740 K  |
|       from large pool |     187    |     311    |  175827 K  |  175826 K  |
|       from small pool |    3277    |    6279    |  184916 K  |  184913 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     124    |     192    |      68    |
|       from large pool |      92    |      92    |     153    |      61    |
|       from small pool |      32    |      32    |      39    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      63    |    2793    |  189629 K  |  189629 K  |
|       from large pool |      34    |      89    |  118104 K  |  118104 K  |
|       from small pool |      29    |    2759    |   71524 K  |   71524 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |   1859 TiB |   1859 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1835 TiB |   1835 TiB |
|       from small pool |      0 KiB |     57 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |   1859 TiB |   1859 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1835 TiB |   1835 TiB |
|       from small pool |      0 KiB |     57 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |   1856 TiB |   1856 TiB |
|       from large pool |  16640 KiB |   1966 MiB |   1831 TiB |   1831 TiB |
|       from small pool |      0 KiB |     56 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    806 MiB |   2262 MiB |   3790 MiB |   2984 MiB |
|       from large pool |    758 MiB |   2202 MiB |   3712 MiB |   2954 MiB |
|       from small pool |     48 MiB |     64 MiB |     78 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 409131 KiB |   1446 TiB |   1446 TiB |
|       from large pool |  24320 KiB | 402413 KiB |   1420 TiB |   1420 TiB |
|       from small pool |      0 KiB |  22399 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6467    |  360743 K  |  360743 K  |
|       from large pool |       2    |     311    |  175827 K  |  175827 K  |
|       from small pool |       0    |    6279    |  184916 K  |  184916 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6467    |  360743 K  |  360743 K  |
|       from large pool |       2    |     311    |  175827 K  |  175827 K  |
|       from small pool |       0    |    6279    |  184916 K  |  184916 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     124    |     192    |     134    |
|       from large pool |      34    |      92    |     153    |     119    |
|       from small pool |      24    |      32    |      39    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2793    |  189630 K  |  189630 K  |
|       from large pool |       3    |      89    |  118104 K  |  118104 K  |
|       from small pool |       0    |    2759    |   71526 K  |   71526 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |   1859 TiB |   1859 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1835 TiB |   1835 TiB |
|       from small pool |      0 KiB |     57 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |   1859 TiB |   1859 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1835 TiB |   1835 TiB |
|       from small pool |      0 KiB |     57 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |   1856 TiB |   1856 TiB |
|       from large pool |  16640 KiB |   1966 MiB |   1831 TiB |   1831 TiB |
|       from small pool |      0 KiB |     56 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    806 MiB |   2262 MiB |   3790 MiB |   2984 MiB |
|       from large pool |    758 MiB |   2202 MiB |   3712 MiB |   2954 MiB |
|       from small pool |     48 MiB |     64 MiB |     78 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 409131 KiB |   1446 TiB |   1446 TiB |
|       from large pool |  24320 KiB | 402413 KiB |   1420 TiB |   1420 TiB |
|       from small pool |      0 KiB |  22399 KiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6467    |  360743 K  |  360743 K  |
|       from large pool |       2    |     311    |  175827 K  |  175827 K  |
|       from small pool |       0    |    6279    |  184916 K  |  184916 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6467    |  360743 K  |  360743 K  |
|       from large pool |       2    |     311    |  175827 K  |  175827 K  |
|       from small pool |       0    |    6279    |  184916 K  |  184916 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     124    |     192    |     134    |
|       from large pool |      34    |      92    |     153    |     119    |
|       from small pool |      24    |      32    |      39    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2793    |  189630 K  |  189630 K  |
|       from large pool |       3    |      89    |  118104 K  |  118104 K  |
|       from small pool |       0    |    2759    |   71526 K  |   71526 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159

 Experiment start at: 2024-06-10 03:03:22.260707
before training, model accuracy: 0.7679115533828735
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9708607, 'precision': 0.7773483, 'recall': 0.82144094, 'specificity': 0.82144094, 'f1': 0.7975894, 'auroc': 0.96313316, 'binary_precision': 0.5668934, 'binary_recall': 0.66093856, 'binary_specificity': 0.98194325, 'binary_f1_score': 0.6103143}
confusion matrix:
       0     1
0  41547   764
1    513  1000
---- Validation: 
scalar performance:
{'acc': 0.97064936, 'precision': 0.76353365, 'recall': 0.7648032, 'specificity': 0.7648032, 'f1': 0.7641668, 'auroc': 0.95326495, 'binary_precision': 0.54214877, 'binary_recall': 0.54485047, 'binary_specificity': 0.98475593, 'binary_f1_score': 0.5434963}
confusion matrix:
       0    1
0  17894  277
1    274  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97884274, 'precision': 0.8829422, 'recall': 0.8125306, 'specificity': 0.8125306, 'f1': 0.8438333, 'auroc': 0.9473876, 'binary_precision': 0.78061223, 'binary_recall': 0.6322314, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.6986301}
confusion matrix:
      0    1
0  5954   43
1    89  153
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-10 03:36:19.313923,epoch time: 0:32:57.053216,used: 0:32:57.053216,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97731835, 'precision': 0.84727764, 'recall': 0.7862283, 'specificity': 0.7862283, 'f1': 0.8135498, 'auroc': 0.97538817, 'binary_precision': 0.7094431, 'binary_recall': 0.580965, 'binary_specificity': 0.99149156, 'binary_f1_score': 0.63880813}
confusion matrix:
       0    1
0  41951  360
1    634  879
---- Validation: 
scalar performance:
{'acc': 0.97714806, 'precision': 0.82165104, 'recall': 0.7962669, 'specificity': 0.7962669, 'f1': 0.8083914, 'auroc': 0.9668155, 'binary_precision': 0.6564195, 'binary_recall': 0.60299003, 'binary_specificity': 0.9895438, 'binary_f1_score': 0.6285714}
confusion matrix:
       0    1
0  17981  190
1    239  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.974996, 'precision': 0.8996369, 'recall': 0.72527176, 'specificity': 0.72527176, 'f1': 0.78610796, 'auroc': 0.95213187, 'binary_precision': 0.8208955, 'binary_recall': 0.45454547, 'binary_specificity': 0.995998, 'binary_f1_score': 0.5851064}
confusion matrix:
      0    1
0  5973   24
1   132  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_2.png
better model found
persisted
after epoch: 2,now: 2024-06-10 04:09:29.938949,epoch time: 0:33:10.625026,used: 1:06:07.678242,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.977113, 'precision': 0.9466503, 'recall': 0.68510926, 'specificity': 0.68510926, 'f1': 0.7583578, 'auroc': 0.9780872, 'binary_precision': 0.9153094, 'binary_recall': 0.37144744, 'binary_specificity': 0.998771, 'binary_f1_score': 0.52844375}
confusion matrix:
       0    1
0  42259   52
1    951  562
---- Validation: 
scalar performance:
{'acc': 0.9791722, 'precision': 0.91588366, 'recall': 0.7113863, 'specificity': 0.7113863, 'f1': 0.77816415, 'auroc': 0.9683893, 'binary_precision': 0.8504983, 'binary_recall': 0.42524916, 'binary_specificity': 0.99752355, 'binary_f1_score': 0.56699884}
confusion matrix:
       0    1
0  18126   45
1    346  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7307538, 'recall': 0.5039655, 'specificity': 0.5039655, 'f1': 0.49823797, 'auroc': 0.949718, 'binary_precision': 0.5, 'binary_recall': 0.008264462, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.016260162}
confusion matrix:
      0  1
0  5995  2
1   240  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_3.png
better model found
persisted
after epoch: 3,now: 2024-06-10 04:40:46.516292,epoch time: 0:31:16.577343,used: 1:37:24.255585,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9824069, 'precision': 0.8796481, 'recall': 0.8459022, 'specificity': 0.8459022, 'f1': 0.8619223, 'auroc': 0.97995687, 'binary_precision': 0.7700146, 'binary_recall': 0.699273, 'binary_specificity': 0.9925315, 'binary_f1_score': 0.7329408}
confusion matrix:
       0     1
0  41995   316
1    455  1058
---- Validation: 
scalar performance:
{'acc': 0.97927874, 'precision': 0.8406058, 'recall': 0.81262547, 'specificity': 0.81262547, 'f1': 0.82596517, 'auroc': 0.9712739, 'binary_precision': 0.6932849, 'binary_recall': 0.63455147, 'binary_specificity': 0.99069947, 'binary_f1_score': 0.66261923}
confusion matrix:
       0    1
0  18002  169
1    220  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.8449062, 'recall': 0.56916404, 'specificity': 0.56916404, 'f1': 0.6085815, 'auroc': 0.95250124, 'binary_precision': 0.7234042, 'binary_recall': 0.14049587, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.23529413}
confusion matrix:
      0   1
0  5984  13
1   208  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_4.png
better model found
persisted
after epoch: 4,now: 2024-06-10 05:10:41.630672,epoch time: 0:29:55.114380,used: 2:07:19.369965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97868747, 'precision': 0.8167154, 'recall': 0.93447316, 'specificity': 0.93447316, 'f1': 0.8653656, 'auroc': 0.98774076, 'binary_precision': 0.6375297, 'binary_recall': 0.8869795, 'binary_specificity': 0.98196685, 'binary_f1_score': 0.7418463}
confusion matrix:
       0     1
0  41548   763
1    171  1342
---- Validation: 
scalar performance:
{'acc': 0.97858626, 'precision': 0.8099215, 'recall': 0.9054214, 'specificity': 0.9054214, 'f1': 0.8506627, 'auroc': 0.9752413, 'binary_precision': 0.6256281, 'binary_recall': 0.82724255, 'binary_specificity': 0.98360026, 'binary_f1_score': 0.71244633}
confusion matrix:
       0    1
0  17873  298
1    104  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97259176, 'precision': 0.83849216, 'recall': 0.75574493, 'specificity': 0.75574493, 'f1': 0.7907798, 'auroc': 0.95986336, 'binary_precision': 0.6961326, 'binary_recall': 0.5206612, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.5957447}
confusion matrix:
      0    1
0  5942   55
1   116  126
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_5.png
early stop counter: 1
val acc:0.9785862565040588, best validation acc: 0.9792787432670593, corresponding to test acc:                         0.9645776748657227 / 0.9788427352905273
after epoch: 5,now: 2024-06-10 05:43:51.553268,epoch time: 0:33:09.922596,used: 2:40:29.292561,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98589814, 'precision': 0.9138837, 'recall': 0.8645988, 'specificity': 0.8645988, 'f1': 0.88755363, 'auroc': 0.9867445, 'binary_precision': 0.8372268, 'binary_recall': 0.7343027, 'binary_specificity': 0.9948949, 'binary_f1_score': 0.78239435}
confusion matrix:
       0     1
0  42095   216
1    402  1111
---- Validation: 
scalar performance:
{'acc': 0.982901, 'precision': 0.86505735, 'recall': 0.8562551, 'specificity': 0.8562551, 'f1': 0.8605981, 'auroc': 0.9754549, 'binary_precision': 0.73935264, 'binary_recall': 0.7209302, 'binary_specificity': 0.99158, 'binary_f1_score': 0.7300253}
confusion matrix:
       0    1
0  18018  153
1    168  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.839751, 'recall': 0.5853595, 'specificity': 0.5853595, 'f1': 0.63062465, 'auroc': 0.9536385, 'binary_precision': 0.7118644, 'binary_recall': 0.17355372, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.27906978}
confusion matrix:
      0   1
0  5980  17
1   200  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_6.png
better model found
persisted
after epoch: 6,now: 2024-06-10 06:16:28.280505,epoch time: 0:32:36.727237,used: 3:13:06.019798,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98197335, 'precision': 0.9464327, 'recall': 0.76442146, 'specificity': 0.76442146, 'f1': 0.8305086, 'auroc': 0.98707914, 'binary_precision': 0.90939975, 'binary_recall': 0.53073364, 'binary_specificity': 0.9981092, 'binary_f1_score': 0.6702838}
confusion matrix:
       0    1
0  42231   80
1    710  803
---- Validation: 
scalar performance:
{'acc': 0.9805572, 'precision': 0.9247103, 'recall': 0.7313749, 'specificity': 0.7313749, 'f1': 0.79771924, 'auroc': 0.9736859, 'binary_precision': 0.8668731, 'binary_recall': 0.4651163, 'binary_specificity': 0.9976336, 'binary_f1_score': 0.6054054}
confusion matrix:
       0    1
0  18128   43
1    322  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.90455586, 'recall': 0.55536824, 'specificity': 0.55536824, 'f1': 0.5895267, 'auroc': 0.95247656, 'binary_precision': 0.84375, 'binary_recall': 0.11157025, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.19708028}
confusion matrix:
      0   1
0  5992   5
1   215  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_7.png
early stop counter: 1
val acc:0.9805572032928467, best validation acc: 0.9829009771347046, corresponding to test acc:                         0.9652187824249268 / 0.9788427352905273
after epoch: 7,now: 2024-06-10 06:46:41.791144,epoch time: 0:30:13.510639,used: 3:43:19.530437,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9866968, 'precision': 0.887948, 'recall': 0.9226884, 'specificity': 0.9226884, 'f1': 0.90450656, 'auroc': 0.9890418, 'binary_precision': 0.78113663, 'binary_recall': 0.85393256, 'binary_specificity': 0.9914443, 'binary_f1_score': 0.81591415}
confusion matrix:
       0     1
0  41949   362
1    221  1292
---- Validation: 
scalar performance:
{'acc': 0.98423266, 'precision': 0.8619804, 'recall': 0.8978985, 'specificity': 0.8978985, 'f1': 0.879017, 'auroc': 0.981068, 'binary_precision': 0.73042166, 'binary_recall': 0.80564785, 'binary_specificity': 0.99014914, 'binary_f1_score': 0.76619273}
confusion matrix:
       0    1
0  17992  179
1    117  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.7430202, 'recall': 0.58352524, 'specificity': 0.58352524, 'f1': 0.6201996, 'auroc': 0.92713535, 'binary_precision': 0.5185185, 'binary_recall': 0.17355372, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.26006192}
confusion matrix:
      0   1
0  5958  39
1   200  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_8.png
better model found
persisted
after epoch: 8,now: 2024-06-10 07:14:53.355772,epoch time: 0:28:11.564628,used: 4:11:31.095065,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98772365, 'precision': 0.9404468, 'recall': 0.86586285, 'specificity': 0.86586285, 'f1': 0.8994379, 'auroc': 0.9912039, 'binary_precision': 0.89031225, 'binary_recall': 0.73496366, 'binary_specificity': 0.9967621, 'binary_f1_score': 0.80521363}
confusion matrix:
       0     1
0  42174   137
1    401  1112
---- Validation: 
scalar performance:
{'acc': 0.98524475, 'precision': 0.91553295, 'recall': 0.83016217, 'specificity': 0.83016217, 'f1': 0.86760426, 'auroc': 0.9720505, 'binary_precision': 0.84210527, 'binary_recall': 0.66445184, 'binary_specificity': 0.99587256, 'binary_f1_score': 0.74280405}
confusion matrix:
       0    1
0  18096   75
1    202  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.8308406, 'recall': 0.5466869, 'specificity': 0.5466869, 'f1': 0.5742534, 'auroc': 0.937845, 'binary_precision': 0.6969697, 'binary_recall': 0.09504132, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.16727273}
confusion matrix:
      0   1
0  5987  10
1   219  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_9.png
better model found
persisted
after epoch: 9,now: 2024-06-10 07:42:46.285881,epoch time: 0:27:52.930109,used: 4:39:24.025174,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98692495, 'precision': 0.8890404, 'recall': 0.9253558, 'specificity': 0.9253558, 'f1': 0.9063153, 'auroc': 0.9923644, 'binary_precision': 0.78313255, 'binary_recall': 0.8592201, 'binary_specificity': 0.99149156, 'binary_f1_score': 0.81941384}
confusion matrix:
       0     1
0  41951   360
1    213  1300
---- Validation: 
scalar performance:
{'acc': 0.98295426, 'precision': 0.85145783, 'recall': 0.8908137, 'specificity': 0.8908137, 'f1': 0.8700001, 'auroc': 0.97916925, 'binary_precision': 0.7098214, 'binary_recall': 0.7923588, 'binary_specificity': 0.9892686, 'binary_f1_score': 0.74882257}
confusion matrix:
       0    1
0  17976  195
1    125  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.7867985, 'recall': 0.59857166, 'specificity': 0.59857166, 'f1': 0.64244735, 'auroc': 0.93384016, 'binary_precision': 0.60493827, 'binary_recall': 0.20247933, 'binary_specificity': 0.994664, 'binary_f1_score': 0.30340555}
confusion matrix:
      0   1
0  5965  32
1   193  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_10.png
early stop counter: 1
val acc:0.9829542636871338, best validation acc: 0.9852447509765625, corresponding to test acc:                         0.9632954001426697 / 0.9788427352905273
after epoch: 10,now: 2024-06-10 08:09:53.007465,epoch time: 0:27:06.721584,used: 5:06:30.746758,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.988933, 'precision': 0.9192637, 'recall': 0.9136497, 'specificity': 0.9136497, 'f1': 0.9164362, 'auroc': 0.99314517, 'binary_precision': 0.844504, 'binary_recall': 0.83278257, 'binary_specificity': 0.9945168, 'binary_f1_score': 0.8386023}
confusion matrix:
       0     1
0  42079   232
1    253  1260
---- Validation: 
scalar performance:
{'acc': 0.9837, 'precision': 0.8747555, 'recall': 0.8566679, 'specificity': 0.8566679, 'f1': 0.8654698, 'auroc': 0.9725654, 'binary_precision': 0.75874126, 'binary_recall': 0.7209302, 'binary_specificity': 0.9924055, 'binary_f1_score': 0.73935264}
confusion matrix:
       0    1
0  18033  138
1    168  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.8049309, 'recall': 0.6009713, 'specificity': 0.6009713, 'f1': 0.6472025, 'auroc': 0.9452529, 'binary_precision': 0.64102566, 'binary_recall': 0.20661157, 'binary_specificity': 0.995331, 'binary_f1_score': 0.3125}
confusion matrix:
      0   1
0  5969  28
1   192  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_11.png
early stop counter: 2
val acc:0.9836999773979187, best validation acc: 0.9852447509765625, corresponding to test acc:                         0.9632954001426697 / 0.9788427352905273
after epoch: 11,now: 2024-06-10 08:39:23.572895,epoch time: 0:29:30.565430,used: 5:36:01.312188,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98699343, 'precision': 0.9504007, 'recall': 0.8438164, 'specificity': 0.8438164, 'f1': 0.88942313, 'auroc': 0.9929044, 'binary_precision': 0.9117904, 'binary_recall': 0.69001985, 'binary_specificity': 0.9976129, 'binary_f1_score': 0.78555304}
confusion matrix:
       0     1
0  42210   101
1    469  1044
---- Validation: 
scalar performance:
{'acc': 0.98423266, 'precision': 0.9082637, 'recall': 0.8183967, 'specificity': 0.8183967, 'f1': 0.85736597, 'auroc': 0.969906, 'binary_precision': 0.82832617, 'binary_recall': 0.641196, 'binary_specificity': 0.99559736, 'binary_f1_score': 0.7228464}
confusion matrix:
       0    1
0  18091   80
1    216  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.70861423, 'recall': 0.51966065, 'specificity': 0.51966065, 'f1': 0.52789026, 'auroc': 0.9142765, 'binary_precision': 0.45454547, 'binary_recall': 0.041322313, 'binary_specificity': 0.997999, 'binary_f1_score': 0.07575758}
confusion matrix:
      0   1
0  5985  12
1   232  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_12.png
early stop counter: 3
val acc:0.9842326641082764, best validation acc: 0.9852447509765625, corresponding to test acc:                         0.9632954001426697 / 0.9788427352905273
after epoch: 12,now: 2024-06-10 09:08:03.768184,epoch time: 0:28:40.195289,used: 6:04:41.507477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9903249, 'precision': 0.93676054, 'recall': 0.9150078, 'specificity': 0.9150078, 'f1': 0.9255839, 'auroc': 0.9946568, 'binary_precision': 0.8794425, 'binary_recall': 0.8341044, 'binary_specificity': 0.99591124, 'binary_f1_score': 0.8561737}
confusion matrix:
       0     1
0  42138   173
1    251  1262
---- Validation: 
scalar performance:
{'acc': 0.98492515, 'precision': 0.884894, 'recall': 0.8669373, 'specificity': 0.8669373, 'f1': 0.875684, 'auroc': 0.97970283, 'binary_precision': 0.77835953, 'binary_recall': 0.7408638, 'binary_specificity': 0.9930108, 'binary_f1_score': 0.759149}
confusion matrix:
       0    1
0  18044  127
1    156  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96906555, 'precision': 0.886863, 'recall': 0.63296354, 'specificity': 0.63296354, 'f1': 0.6932993, 'auroc': 0.95691514, 'binary_precision': 0.80246913, 'binary_recall': 0.26859504, 'binary_specificity': 0.997332, 'binary_f1_score': 0.40247676}
confusion matrix:
      0   1
0  5981  16
1   177  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_13.png
early stop counter: 4
val acc:0.9849251508712769, best validation acc: 0.9852447509765625, corresponding to test acc:                         0.9632954001426697 / 0.9788427352905273
after epoch: 13,now: 2024-06-10 09:35:53.434620,epoch time: 0:27:49.666436,used: 6:32:31.173913,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99073565, 'precision': 0.92431545, 'recall': 0.9394381, 'specificity': 0.9394381, 'f1': 0.93173325, 'auroc': 0.9947779, 'binary_precision': 0.8527725, 'binary_recall': 0.88433576, 'binary_specificity': 0.99454045, 'binary_f1_score': 0.8682674}
confusion matrix:
       0     1
0  42080   231
1    175  1338
---- Validation: 
scalar performance:
{'acc': 0.98508495, 'precision': 0.8735535, 'recall': 0.8927174, 'specificity': 0.8927174, 'f1': 0.8828757, 'auroc': 0.9790597, 'binary_precision': 0.7539432, 'binary_recall': 0.79401994, 'binary_specificity': 0.9914149, 'binary_f1_score': 0.7734628}
confusion matrix:
       0    1
0  18015  156
1    124  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.8110112, 'recall': 0.5990719, 'specificity': 0.5990719, 'f1': 0.6455699, 'auroc': 0.9457051, 'binary_precision': 0.6533333, 'binary_recall': 0.20247933, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.30914825}
confusion matrix:
      0   1
0  5971  26
1   193  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_14.png
early stop counter: 5
val acc:0.9850849509239197, best validation acc: 0.9852447509765625, corresponding to test acc:                         0.9632954001426697 / 0.9788427352905273
after epoch: 14,now: 2024-06-10 10:11:04.661669,epoch time: 0:35:11.227049,used: 7:07:42.400962,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9913518, 'precision': 0.92545867, 'recall': 0.9489981, 'specificity': 0.9489981, 'f1': 0.9368846, 'auroc': 0.9962518, 'binary_precision': 0.854375, 'binary_recall': 0.903503, 'binary_specificity': 0.9944932, 'binary_f1_score': 0.8782525}
confusion matrix:
       0     1
0  42078   233
1    146  1367
---- Validation: 
scalar performance:
{'acc': 0.98471206, 'precision': 0.8762573, 'recall': 0.87806994, 'specificity': 0.87806994, 'f1': 0.87716126, 'auroc': 0.97817385, 'binary_precision': 0.76033056, 'binary_recall': 0.7641196, 'binary_specificity': 0.99202025, 'binary_f1_score': 0.7622204}
confusion matrix:
       0    1
0  18026  145
1    142  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.8420017, 'recall': 0.5772618, 'specificity': 0.5772618, 'f1': 0.6198256, 'auroc': 0.9495903, 'binary_precision': 0.7169811, 'binary_recall': 0.1570248, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.25762713}
confusion matrix:
      0   1
0  5982  15
1   204  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_15.png
early stop counter: 6
val acc:0.9847120642662048, best validation acc: 0.9852447509765625, corresponding to test acc:                         0.9632954001426697 / 0.9788427352905273
after epoch: 15,now: 2024-06-10 10:40:45.453238,epoch time: 0:29:40.791569,used: 7:37:23.192531,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9919907, 'precision': 0.9313009, 'recall': 0.9518782, 'specificity': 0.9518782, 'f1': 0.9413296, 'auroc': 0.9960434, 'binary_precision': 0.86586905, 'binary_recall': 0.90879047, 'binary_specificity': 0.99496585, 'binary_f1_score': 0.8868107}
confusion matrix:
       0     1
0  42098   213
1    138  1375
---- Validation: 
scalar performance:
{'acc': 0.98508495, 'precision': 0.87064576, 'recall': 0.8991418, 'specificity': 0.8991418, 'f1': 0.8843216, 'auroc': 0.9832538, 'binary_precision': 0.7476923, 'binary_recall': 0.807309, 'binary_specificity': 0.9909746, 'binary_f1_score': 0.7763578}
confusion matrix:
       0    1
0  18007  164
1    116  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97002727, 'precision': 0.86537683, 'recall': 0.6651876, 'specificity': 0.6651876, 'f1': 0.7243829, 'auroc': 0.9531705, 'binary_precision': 0.7570093, 'binary_recall': 0.33471075, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.4641834}
confusion matrix:
      0   1
0  5971  26
1   161  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_16.png
early stop counter: 7
val acc:0.9850849509239197, best validation acc: 0.9852447509765625, corresponding to test acc:                         0.9632954001426697 / 0.9788427352905273
after epoch: 16,now: 2024-06-10 11:08:36.064866,epoch time: 0:27:50.611628,used: 8:05:13.804159,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9887048, 'precision': 0.899374, 'recall': 0.9422102, 'specificity': 0.9422102, 'f1': 0.9196046, 'auroc': 0.99338734, 'binary_precision': 0.80261594, 'binary_recall': 0.89226705, 'binary_specificity': 0.99215335, 'binary_f1_score': 0.8450705}
confusion matrix:
       0     1
0  41979   332
1    163  1350
---- Validation: 
scalar performance:
{'acc': 0.9811964, 'precision': 0.83461624, 'recall': 0.8907087, 'specificity': 0.8907087, 'f1': 0.8602935, 'auroc': 0.97761744, 'binary_precision': 0.6760962, 'binary_recall': 0.79401994, 'binary_specificity': 0.9873975, 'binary_f1_score': 0.73032856}
confusion matrix:
       0    1
0  17942  229
1    124  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.78489494, 'recall': 0.55230165, 'specificity': 0.55230165, 'f1': 0.5816734, 'auroc': 0.9340612, 'binary_precision': 0.60465115, 'binary_recall': 0.10743801, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.18245614}
confusion matrix:
      0   1
0  5980  17
1   216  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_17.png
early stop counter: 8
val acc:0.981196403503418, best validation acc: 0.9852447509765625, corresponding to test acc:                         0.9632954001426697 / 0.9788427352905273
after epoch: 17,now: 2024-06-10 11:40:13.826455,epoch time: 0:31:37.761589,used: 8:36:51.565748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9924014, 'precision': 0.9747305, 'recall': 0.9081169, 'specificity': 0.9081169, 'f1': 0.93872154, 'auroc': 0.9970795, 'binary_precision': 0.95595056, 'binary_recall': 0.81758094, 'binary_specificity': 0.9986528, 'binary_f1_score': 0.88136804}
confusion matrix:
       0     1
0  42254    57
1    276  1237
---- Validation: 
scalar performance:
{'acc': 0.98545784, 'precision': 0.9024439, 'recall': 0.85115147, 'specificity': 0.85115147, 'f1': 0.8749188, 'auroc': 0.9768885, 'binary_precision': 0.81453156, 'binary_recall': 0.7076412, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.7573334}
confusion matrix:
       0    1
0  18074   97
1    176  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.7957605, 'recall': 0.57056314, 'specificity': 0.57056314, 'f1': 0.60809004, 'auroc': 0.94682705, 'binary_precision': 0.625, 'binary_recall': 0.1446281, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.23489933}
confusion matrix:
      0   1
0  5976  21
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_18.png
better model found
persisted
after epoch: 18,now: 2024-06-10 12:10:54.828670,epoch time: 0:30:41.002215,used: 9:07:32.567963,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9905303, 'precision': 0.9347615, 'recall': 0.92116857, 'specificity': 0.92116857, 'f1': 0.9278483, 'auroc': 0.99500394, 'binary_precision': 0.875, 'binary_recall': 0.8466623, 'binary_specificity': 0.9956749, 'binary_f1_score': 0.8605979}
confusion matrix:
       0     1
0  42128   183
1    232  1281
---- Validation: 
scalar performance:
{'acc': 0.982315, 'precision': 0.8615148, 'recall': 0.84872496, 'specificity': 0.84872496, 'f1': 0.85499513, 'auroc': 0.97943944, 'binary_precision': 0.73275864, 'binary_recall': 0.70598006, 'binary_specificity': 0.9914699, 'binary_f1_score': 0.71912014}
confusion matrix:
       0    1
0  18016  155
1    177  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.7850976, 'recall': 0.64070946, 'specificity': 0.64070946, 'f1': 0.6859507, 'auroc': 0.93688786, 'binary_precision': 0.5982906, 'binary_recall': 0.2892562, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.38997218}
confusion matrix:
      0   1
0  5950  47
1   172  70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_19.png
early stop counter: 1
val acc:0.9823150038719177, best validation acc: 0.9854578375816345, corresponding to test acc:                         0.9634556770324707 / 0.9788427352905273
after epoch: 19,now: 2024-06-10 12:39:57.485007,epoch time: 0:29:02.656337,used: 9:36:35.224300,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9936793, 'precision': 0.9467164, 'recall': 0.9600817, 'specificity': 0.9600817, 'f1': 0.9532925, 'auroc': 0.9975343, 'binary_precision': 0.89615387, 'binary_recall': 0.9239921, 'binary_specificity': 0.99617124, 'binary_f1_score': 0.90986013}
confusion matrix:
       0     1
0  42149   162
1    115  1398
---- Validation: 
scalar performance:
{'acc': 0.9863101, 'precision': 0.8975991, 'recall': 0.8764863, 'specificity': 0.8764863, 'f1': 0.8867321, 'auroc': 0.9798691, 'binary_precision': 0.80316347, 'binary_recall': 0.7591362, 'binary_specificity': 0.99383634, 'binary_f1_score': 0.78052944}
confusion matrix:
       0    1
0  18059  112
1    145  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.81503963, 'recall': 0.64765817, 'specificity': 0.64765817, 'f1': 0.69826275, 'auroc': 0.9470977, 'binary_precision': 0.6576577, 'binary_recall': 0.30165288, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.41359773}
confusion matrix:
      0   1
0  5959  38
1   169  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_20.png
better model found
persisted
after epoch: 20,now: 2024-06-10 13:08:30.721888,epoch time: 0:28:33.236881,used: 10:05:08.461181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9934967, 'precision': 0.959671, 'recall': 0.94118667, 'specificity': 0.94118667, 'f1': 0.95022416, 'auroc': 0.9975077, 'binary_precision': 0.92344826, 'binary_recall': 0.8849967, 'binary_specificity': 0.99737656, 'binary_f1_score': 0.9038137}
confusion matrix:
       0     1
0  42200   111
1    174  1339
---- Validation: 
scalar performance:
{'acc': 0.98593724, 'precision': 0.90091485, 'recall': 0.86344486, 'specificity': 0.86344486, 'f1': 0.88119036, 'auroc': 0.9680098, 'binary_precision': 0.8106618, 'binary_recall': 0.73255813, 'binary_specificity': 0.9943316, 'binary_f1_score': 0.7696335}
confusion matrix:
       0    1
0  18068  103
1    161  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.8522451, 'recall': 0.5855262, 'specificity': 0.5855262, 'f1': 0.6316416, 'auroc': 0.91974396, 'binary_precision': 0.7368421, 'binary_recall': 0.17355372, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.28093648}
confusion matrix:
      0   1
0  5982  15
1   200  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_21.png
early stop counter: 1
val acc:0.985937237739563, best validation acc: 0.9863101243972778, corresponding to test acc:                         0.9668216109275818 / 0.9788427352905273
after epoch: 21,now: 2024-06-10 13:37:52.949536,epoch time: 0:29:22.227648,used: 10:34:30.688829,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9934739, 'precision': 0.9744171, 'recall': 0.9252422, 'specificity': 0.9252422, 'f1': 0.9483832, 'auroc': 0.99804556, 'binary_precision': 0.95410806, 'binary_recall': 0.85194975, 'binary_specificity': 0.9985347, 'binary_f1_score': 0.9001397}
confusion matrix:
       0     1
0  42249    62
1    224  1289
---- Validation: 
scalar performance:
{'acc': 0.98556435, 'precision': 0.91265297, 'recall': 0.83996385, 'specificity': 0.83996385, 'f1': 0.87253845, 'auroc': 0.9731592, 'binary_precision': 0.8356998, 'binary_recall': 0.68438536, 'binary_specificity': 0.99554235, 'binary_f1_score': 0.75251144}
confusion matrix:
       0    1
0  18090   81
1    190  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96025, 'precision': 0.7076024, 'recall': 0.55303377, 'specificity': 0.55303377, 'f1': 0.57922, 'auroc': 0.8833923, 'binary_precision': 0.45, 'binary_recall': 0.11157025, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.17880794}
confusion matrix:
      0   1
0  5964  33
1   215  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_22.png
early stop counter: 2
val acc:0.9855643510818481, best validation acc: 0.9863101243972778, corresponding to test acc:                         0.9668216109275818 / 0.9788427352905273
after epoch: 22,now: 2024-06-10 14:06:35.788315,epoch time: 0:28:42.838779,used: 11:03:13.527608,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9950484, 'precision': 0.978848, 'recall': 0.94549537, 'specificity': 0.94549537, 'f1': 0.9615238, 'auroc': 0.9984118, 'binary_precision': 0.96153843, 'binary_recall': 0.89226705, 'binary_specificity': 0.99872375, 'binary_f1_score': 0.9256085}
confusion matrix:
       0     1
0  42257    54
1    163  1350
---- Validation: 
scalar performance:
{'acc': 0.9868428, 'precision': 0.92375636, 'recall': 0.85186696, 'specificity': 0.85186696, 'f1': 0.8842366, 'auroc': 0.97182417, 'binary_precision': 0.85714287, 'binary_recall': 0.7076412, 'binary_specificity': 0.9960927, 'binary_f1_score': 0.77525026}
confusion matrix:
       0    1
0  18100   71
1    176  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.7787132, 'recall': 0.55824983, 'specificity': 0.55824983, 'f1': 0.59009695, 'auroc': 0.9127842, 'binary_precision': 0.59183675, 'binary_recall': 0.11983471, 'binary_specificity': 0.996665, 'binary_f1_score': 0.19931273}
confusion matrix:
      0   1
0  5977  20
1   213  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_23.png
better model found
persisted
after epoch: 23,now: 2024-06-10 14:35:29.608251,epoch time: 0:28:53.819936,used: 11:32:07.347544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99450076, 'precision': 0.97631544, 'recall': 0.939476, 'specificity': 0.939476, 'f1': 0.95709777, 'auroc': 0.9984266, 'binary_precision': 0.95689654, 'binary_recall': 0.88037014, 'binary_specificity': 0.99858195, 'binary_f1_score': 0.9170396}
confusion matrix:
       0     1
0  42251    60
1    181  1332
---- Validation: 
scalar performance:
{'acc': 0.9866297, 'precision': 0.9203336, 'recall': 0.8517569, 'specificity': 0.8517569, 'f1': 0.88277566, 'auroc': 0.9762631, 'binary_precision': 0.8502994, 'binary_recall': 0.7076412, 'binary_specificity': 0.99587256, 'binary_f1_score': 0.77243876}
confusion matrix:
       0    1
0  18096   75
1    176  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.7904452, 'recall': 0.6046866, 'specificity': 0.6046866, 'f1': 0.6498452, 'auroc': 0.9359969, 'binary_precision': 0.6117647, 'binary_recall': 0.21487603, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.3180428}
confusion matrix:
      0   1
0  5964  33
1   190  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_24.png
early stop counter: 1
val acc:0.9866297245025635, best validation acc: 0.9868428111076355, corresponding to test acc:                         0.9626542925834656 / 0.9788427352905273
after epoch: 24,now: 2024-06-10 15:08:09.670494,epoch time: 0:32:40.062243,used: 12:04:47.409787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99589264, 'precision': 0.971169, 'recall': 0.96696365, 'specificity': 0.96696365, 'f1': 0.9690561, 'auroc': 0.9990767, 'binary_precision': 0.9446297, 'binary_recall': 0.93588895, 'binary_specificity': 0.99803835, 'binary_f1_score': 0.9402391}
confusion matrix:
       0     1
0  42228    83
1     97  1416
---- Validation: 
scalar performance:
{'acc': 0.9862036, 'precision': 0.887773, 'recall': 0.8908861, 'specificity': 0.8908861, 'f1': 0.8893229, 'auroc': 0.97241515, 'binary_precision': 0.78253704, 'binary_recall': 0.7890366, 'binary_specificity': 0.9927357, 'binary_f1_score': 0.7857734}
confusion matrix:
       0    1
0  18039  132
1    127  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.80957544, 'recall': 0.6051035, 'specificity': 0.6051035, 'f1': 0.65252393, 'auroc': 0.90887165, 'binary_precision': 0.65, 'binary_recall': 0.21487603, 'binary_specificity': 0.995331, 'binary_f1_score': 0.32298136}
confusion matrix:
      0   1
0  5969  28
1   190  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_25.png
early stop counter: 2
val acc:0.9862036108970642, best validation acc: 0.9868428111076355, corresponding to test acc:                         0.9626542925834656 / 0.9788427352905273
after epoch: 25,now: 2024-06-10 15:42:09.314541,epoch time: 0:33:59.644047,used: 12:38:47.053834,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99454635, 'precision': 0.9670034, 'recall': 0.9500152, 'specificity': 0.9500152, 'f1': 0.9583395, 'auroc': 0.9985002, 'binary_precision': 0.9375, 'binary_recall': 0.9021811, 'binary_specificity': 0.9978493, 'binary_f1_score': 0.9195015}
confusion matrix:
       0     1
0  42220    91
1    148  1365
---- Validation: 
scalar performance:
{'acc': 0.9851915, 'precision': 0.89223886, 'recall': 0.86065054, 'specificity': 0.86065054, 'f1': 0.8757298, 'auroc': 0.97753674, 'binary_precision': 0.79347825, 'binary_recall': 0.72757477, 'binary_specificity': 0.99372625, 'binary_f1_score': 0.7590987}
confusion matrix:
       0    1
0  18057  114
1    164  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9748357, 'precision': 0.89013195, 'recall': 0.73113656, 'specificity': 0.73113656, 'f1': 0.7885488, 'auroc': 0.944727, 'binary_precision': 0.8014184, 'binary_recall': 0.46694216, 'binary_specificity': 0.995331, 'binary_f1_score': 0.5900783}
confusion matrix:
      0    1
0  5969   28
1   129  113
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_26.png
early stop counter: 3
val acc:0.9851915240287781, best validation acc: 0.9868428111076355, corresponding to test acc:                         0.9626542925834656 / 0.9788427352905273
after epoch: 26,now: 2024-06-10 16:11:39.977668,epoch time: 0:29:30.663127,used: 13:08:17.716961,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99500275, 'precision': 0.95610064, 'recall': 0.9703266, 'specificity': 0.9703266, 'f1': 0.96309555, 'auroc': 0.99881256, 'binary_precision': 0.9142125, 'binary_recall': 0.94382024, 'binary_specificity': 0.99683297, 'binary_f1_score': 0.9287805}
confusion matrix:
       0     1
0  42177   134
1     85  1428
---- Validation: 
scalar performance:
{'acc': 0.9856709, 'precision': 0.8786262, 'recall': 0.89623225, 'specificity': 0.89623225, 'f1': 0.8872125, 'auroc': 0.97271615, 'binary_precision': 0.7638669, 'binary_recall': 0.8006644, 'binary_specificity': 0.9918001, 'binary_f1_score': 0.78183293}
confusion matrix:
       0    1
0  18022  149
1    120  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.8222573, 'recall': 0.6175002, 'specificity': 0.6175002, 'f1': 0.668105, 'auroc': 0.942028, 'binary_precision': 0.6744186, 'binary_recall': 0.23966943, 'binary_specificity': 0.995331, 'binary_f1_score': 0.35365856}
confusion matrix:
      0   1
0  5969  28
1   184  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_27.png
early stop counter: 4
val acc:0.9856709241867065, best validation acc: 0.9868428111076355, corresponding to test acc:                         0.9626542925834656 / 0.9788427352905273
after epoch: 27,now: 2024-06-10 16:45:07.654246,epoch time: 0:33:27.676578,used: 13:41:45.393539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9954135, 'precision': 0.9894359, 'recall': 0.9409047, 'specificity': 0.9409047, 'f1': 0.9638093, 'auroc': 0.9993532, 'binary_precision': 0.98306334, 'binary_recall': 0.88235295, 'binary_specificity': 0.9994564, 'binary_f1_score': 0.9299895}
confusion matrix:
       0     1
0  42288    23
1    178  1335
---- Validation: 
scalar performance:
{'acc': 0.98545784, 'precision': 0.9227644, 'recall': 0.826257, 'specificity': 0.826257, 'f1': 0.86784834, 'auroc': 0.97128856, 'binary_precision': 0.856833, 'binary_recall': 0.65614617, 'binary_specificity': 0.9963678, 'binary_f1_score': 0.7431797}
confusion matrix:
       0    1
0  18105   66
1    207  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.8305767, 'recall': 0.61361814, 'specificity': 0.61361814, 'f1': 0.6646951, 'auroc': 0.9122693, 'binary_precision': 0.69135803, 'binary_recall': 0.23140496, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.34674925}
confusion matrix:
      0   1
0  5972  25
1   186  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_28.png
early stop counter: 5
val acc:0.9854578375816345, best validation acc: 0.9868428111076355, corresponding to test acc:                         0.9626542925834656 / 0.9788427352905273
after epoch: 28,now: 2024-06-10 17:14:01.435925,epoch time: 0:28:53.781679,used: 14:10:39.175218,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.994341, 'precision': 0.9823444, 'recall': 0.93110836, 'specificity': 0.93110836, 'f1': 0.9551809, 'auroc': 0.9989821, 'binary_precision': 0.969562, 'binary_recall': 0.8631857, 'binary_specificity': 0.999031, 'binary_f1_score': 0.9132867}
confusion matrix:
       0     1
0  42270    41
1    207  1306
---- Validation: 
scalar performance:
{'acc': 0.9833271, 'precision': 0.906655, 'recall': 0.80186796, 'specificity': 0.80186796, 'f1': 0.8459517, 'auroc': 0.9716657, 'binary_precision': 0.8261851, 'binary_recall': 0.6079734, 'binary_specificity': 0.99576247, 'binary_f1_score': 0.70047843}
confusion matrix:
       0    1
0  18094   77
1    236  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.8023318, 'recall': 0.6291465, 'specificity': 0.6291465, 'f1': 0.6777302, 'auroc': 0.92066884, 'binary_precision': 0.63366336, 'binary_recall': 0.2644628, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.37317783}
confusion matrix:
      0   1
0  5960  37
1   178  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_29.png
early stop counter: 6
val acc:0.9833270907402039, best validation acc: 0.9868428111076355, corresponding to test acc:                         0.9626542925834656 / 0.9788427352905273
after epoch: 29,now: 2024-06-10 17:41:47.643306,epoch time: 0:27:46.207381,used: 14:38:25.382599,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9958242, 'precision': 0.98477733, 'recall': 0.95163286, 'specificity': 0.95163286, 'f1': 0.96757376, 'auroc': 0.9992368, 'binary_precision': 0.972973, 'binary_recall': 0.9041639, 'binary_specificity': 0.9991019, 'binary_f1_score': 0.9373073}
confusion matrix:
       0     1
0  42273    38
1    145  1368
---- Validation: 
scalar performance:
{'acc': 0.9859905, 'precision': 0.92987967, 'recall': 0.82894135, 'specificity': 0.82894135, 'f1': 0.8722223, 'auroc': 0.97419846, 'binary_precision': 0.8708972, 'binary_recall': 0.6611296, 'binary_specificity': 0.9967531, 'binary_f1_score': 0.75165254}
confusion matrix:
       0    1
0  18112   59
1    204  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.82749164, 'recall': 0.639894, 'specificity': 0.639894, 'f1': 0.6927196, 'auroc': 0.9452448, 'binary_precision': 0.6831683, 'binary_recall': 0.28512397, 'binary_specificity': 0.994664, 'binary_f1_score': 0.40233237}
confusion matrix:
      0   1
0  5965  32
1   173  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261159_30.png
early stop counter: 7
val acc:0.9859905242919922, best validation acc: 0.9868428111076355, corresponding to test acc:                         0.9626542925834656 / 0.9788427352905273
after epoch: 30,now: 2024-06-10 18:08:52.937203,epoch time: 0:27:05.293897,used: 15:05:30.676496,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_03_03_22_seed_2_21261159
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:05:30.676496 at 2024-06-10 18:08:52.937203
persisted model performance metric: 

scalar performance:
{'acc': 0.96377623, 'precision': 0.80477, 'recall': 0.57271266, 'specificity': 0.57271266, 'f1': 0.61152786, 'auroc': 0.90822047, 'binary_precision': 0.64285713, 'binary_recall': 0.14876033, 'binary_specificity': 0.996665, 'binary_f1_score': 0.24161075}
confusion matrix:
      0   1
0  5977  20
1   206  36
oracle model performance metric: 

scalar performance:
{'acc': 0.97804135, 'precision': 0.8674401, 'recall': 0.82202744, 'specificity': 0.82202744, 'f1': 0.84308946, 'auroc': 0.94710475, 'binary_precision': 0.7488152, 'binary_recall': 0.6528926, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.69757175}
confusion matrix:
      0    1
0  5944   53
1    84  158
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 459792 KiB |   2005 MiB |   2788 TiB |   2788 TiB |
|       from large pool | 418110 KiB |   1972 MiB |   2752 TiB |   2752 TiB |
|       from small pool |  41681 KiB |     57 MiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 459792 KiB |   2005 MiB |   2788 TiB |   2788 TiB |
|       from large pool | 418110 KiB |   1972 MiB |   2752 TiB |   2752 TiB |
|       from small pool |  41681 KiB |     57 MiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447753 KiB |   1998 MiB |   2784 TiB |   2784 TiB |
|       from large pool | 407075 KiB |   1966 MiB |   2748 TiB |   2748 TiB |
|       from small pool |  40678 KiB |     56 MiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2254 MiB |   2262 MiB |   5238 MiB |   2984 MiB |
|       from large pool |   2190 MiB |   2202 MiB |   5144 MiB |   2954 MiB |
|       from small pool |     64 MiB |     64 MiB |     94 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320496 KiB | 409131 KiB |   2131 TiB |   2131 TiB |
|       from large pool | 310977 KiB | 402413 KiB |   2093 TiB |   2093 TiB |
|       from small pool |   9518 KiB |  22399 KiB |     38 TiB |     38 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    6467    |  541248 K  |  541245 K  |
|       from large pool |     187    |     311    |  263795 K  |  263794 K  |
|       from small pool |    3289    |    6279    |  277453 K  |  277450 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    6467    |  541248 K  |  541245 K  |
|       from large pool |     187    |     311    |  263795 K  |  263794 K  |
|       from small pool |    3289    |    6279    |  277453 K  |  277450 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     124    |     258    |     134    |
|       from large pool |      92    |      92    |     211    |     119    |
|       from small pool |      32    |      32    |      47    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      57    |    2793    |  281604 K  |  281604 K  |
|       from large pool |      27    |      89    |  174083 K  |  174083 K  |
|       from small pool |      30    |    2759    |  107521 K  |  107521 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2005 MiB |   2788 TiB |   2788 TiB |
|       from large pool |  16640 KiB |   1972 MiB |   2752 TiB |   2752 TiB |
|       from small pool |      0 KiB |     57 MiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2005 MiB |   2788 TiB |   2788 TiB |
|       from large pool |  16640 KiB |   1972 MiB |   2752 TiB |   2752 TiB |
|       from small pool |      0 KiB |     57 MiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |   2784 TiB |   2784 TiB |
|       from large pool |  16640 KiB |   1966 MiB |   2748 TiB |   2748 TiB |
|       from small pool |      0 KiB |     56 MiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 780288 KiB |   2262 MiB |   5238 MiB |   4476 MiB |
|       from large pool | 729088 KiB |   2202 MiB |   5144 MiB |   4432 MiB |
|       from small pool |  51200 KiB |     64 MiB |     94 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 409131 KiB |   2131 TiB |   2131 TiB |
|       from large pool |  24320 KiB | 402413 KiB |   2093 TiB |   2093 TiB |
|       from small pool |      0 KiB |  22399 KiB |     38 TiB |     38 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6467    |  541248 K  |  541248 K  |
|       from large pool |       2    |     311    |  263795 K  |  263795 K  |
|       from small pool |       0    |    6279    |  277453 K  |  277453 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6467    |  541248 K  |  541248 K  |
|       from large pool |       2    |     311    |  263795 K  |  263795 K  |
|       from small pool |       0    |    6279    |  277453 K  |  277453 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     124    |     258    |     201    |
|       from large pool |      32    |      92    |     211    |     179    |
|       from small pool |      25    |      32    |      47    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2793    |  281605 K  |  281605 K  |
|       from large pool |       3    |      89    |  174083 K  |  174083 K  |
|       from small pool |       0    |    2759    |  107522 K  |  107522 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jun 10 18:11:14 2024]
Finished job 0.
1 of 1 steps (100%) done
