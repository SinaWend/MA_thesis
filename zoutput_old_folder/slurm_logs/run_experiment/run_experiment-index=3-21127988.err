Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jun  5 22:36:38 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988

 Experiment start at: 2024-06-05 22:52:07.416528
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9706796, 'precision': 0.78276646, 'recall': 0.71467394, 'specificity': 0.71467394, 'f1': 0.74361026, 'auroc': 0.948012, 'binary_precision': 0.58483756, 'binary_recall': 0.4402174, 'binary_specificity': 0.98913044, 'binary_f1_score': 0.5023256}
confusion matrix:
       0    1
0  41860  460
1    824  648
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9668476, 'precision': 0.7650229, 'recall': 0.5710562, 'specificity': 0.5710562, 'f1': 0.6074354, 'auroc': 0.94625473, 'binary_precision': 0.5595238, 'binary_recall': 0.14618973, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.23181257}
confusion matrix:
       0   1
0  18075  74
1    549  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.8697877, 'recall': 0.6569195, 'specificity': 0.6569195, 'f1': 0.7165763, 'auroc': 0.9285842, 'binary_precision': 0.7685185, 'binary_recall': 0.31800765, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.44986448}
confusion matrix:
      0   1
0  5972  25
1   178  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-05 23:18:51.186052,epoch time: 0:26:43.769524,used: 0:26:43.769524,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9732371, 'precision': 0.8274, 'recall': 0.69271916, 'specificity': 0.69271916, 'f1': 0.7411921, 'auroc': 0.9558429, 'binary_precision': 0.67564404, 'binary_recall': 0.3919837, 'binary_specificity': 0.99345464, 'binary_f1_score': 0.4961307}
confusion matrix:
       0    1
0  42043  277
1    895  577
---- Validation: 
scalar performance:
{'acc': 0.97190297, 'precision': 0.8235364, 'recall': 0.67343074, 'specificity': 0.67343074, 'f1': 0.7239481, 'auroc': 0.95643103, 'binary_precision': 0.6696165, 'binary_recall': 0.35303265, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.4623218}
confusion matrix:
       0    1
0  18037  112
1    416  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9747523, 'precision': 0.9654269, 'recall': 0.70647967, 'specificity': 0.70647967, 'f1': 0.7822637, 'auroc': 0.927508, 'binary_precision': 0.9557522, 'binary_recall': 0.41379312, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.5775401}
confusion matrix:
      0    1
0  5992    5
1   153  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-05 23:44:19.356339,epoch time: 0:25:28.170287,used: 0:52:11.939811,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9771648, 'precision': 0.8346509, 'recall': 0.79409266, 'specificity': 0.79409266, 'f1': 0.81294596, 'auroc': 0.964454, 'binary_precision': 0.6832298, 'binary_recall': 0.59782606, 'binary_specificity': 0.9903592, 'binary_f1_score': 0.63768107}
confusion matrix:
       0    1
0  41912  408
1    592  880
---- Validation: 
scalar performance:
{'acc': 0.9756811, 'precision': 0.8324518, 'recall': 0.7676436, 'specificity': 0.7676436, 'f1': 0.79623365, 'auroc': 0.96321553, 'binary_precision': 0.68093383, 'binary_recall': 0.5443235, 'binary_specificity': 0.9909637, 'binary_f1_score': 0.60501295}
confusion matrix:
       0    1
0  17985  164
1    293  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9750719, 'precision': 0.938712, 'recall': 0.72496974, 'specificity': 0.72496974, 'f1': 0.7945869, 'auroc': 0.94370526, 'binary_precision': 0.90076333, 'binary_recall': 0.45210728, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.6020408}
confusion matrix:
      0    1
0  5984   13
1   143  118
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-06 00:09:37.512473,epoch time: 0:25:18.156134,used: 1:17:30.095945,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9775301, 'precision': 0.841442, 'recall': 0.78777015, 'specificity': 0.78777015, 'f1': 0.8121164, 'auroc': 0.96945834, 'binary_precision': 0.69724023, 'binary_recall': 0.58435374, 'binary_specificity': 0.9911866, 'binary_f1_score': 0.6358253}
confusion matrix:
       0    1
0  41949  373
1    611  859
---- Validation: 
scalar performance:
{'acc': 0.9771711, 'precision': 0.8609155, 'recall': 0.7541639, 'specificity': 0.7541639, 'f1': 0.79751354, 'auroc': 0.96573687, 'binary_precision': 0.73883927, 'binary_recall': 0.5147745, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.6067828}
confusion matrix:
       0    1
0  18032  117
1    312  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9717162, 'precision': 0.94223714, 'recall': 0.67741054, 'specificity': 0.67741054, 'f1': 0.74891615, 'auroc': 0.9460565, 'binary_precision': 0.9117647, 'binary_recall': 0.35632184, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.5123967}
confusion matrix:
      0   1
0  5988   9
1   168  93
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_4.png
better model found
persisted
after epoch: 4,now: 2024-06-06 00:34:48.720830,epoch time: 0:25:11.208357,used: 1:42:41.304302,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9779183, 'precision': 0.9383687, 'recall': 0.6928462, 'specificity': 0.6928462, 'f1': 0.76487035, 'auroc': 0.97521365, 'binary_precision': 0.8976378, 'binary_recall': 0.38722825, 'binary_specificity': 0.9984641, 'binary_f1_score': 0.5410536}
confusion matrix:
       0    1
0  42255   65
1    902  570
---- Validation: 
scalar performance:
{'acc': 0.9771711, 'precision': 0.94025123, 'recall': 0.6859089, 'specificity': 0.6859089, 'f1': 0.75817776, 'auroc': 0.97006077, 'binary_precision': 0.90225565, 'binary_recall': 0.3732504, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.52805287}
confusion matrix:
       0    1
0  18123   26
1    403  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.9134711, 'recall': 0.5247375, 'specificity': 0.5247375, 'f1': 0.536889, 'auroc': 0.950818, 'binary_precision': 0.8666667, 'binary_recall': 0.049808428, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.09420289}
confusion matrix:
      0   1
0  5995   2
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_5.png
early stop counter: 1
val acc:0.9771711230278015, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.9717162251472473 / 0.975071907043457
after epoch: 5,now: 2024-06-06 01:00:01.412592,epoch time: 0:25:12.691762,used: 2:07:53.996064,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98127514, 'precision': 0.84574294, 'recall': 0.8827741, 'specificity': 0.8827741, 'f1': 0.8632289, 'auroc': 0.97745246, 'binary_precision': 0.6992665, 'binary_recall': 0.77717394, 'binary_specificity': 0.9883743, 'binary_f1_score': 0.7361647}
confusion matrix:
       0     1
0  41828   492
1    328  1144
---- Validation: 
scalar performance:
{'acc': 0.9785547, 'precision': 0.82190394, 'recall': 0.8951405, 'specificity': 0.8951405, 'f1': 0.8543975, 'auroc': 0.9762917, 'binary_precision': 0.6507538, 'binary_recall': 0.80559874, 'binary_specificity': 0.9846824, 'binary_f1_score': 0.7199445}
confusion matrix:
       0    1
0  17871  278
1    125  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.8269843, 'recall': 0.6914003, 'specificity': 0.6914003, 'f1': 0.73962504, 'auroc': 0.9512941, 'binary_precision': 0.68, 'binary_recall': 0.3908046, 'binary_specificity': 0.991996, 'binary_f1_score': 0.49635038}
confusion matrix:
      0    1
0  5949   48
1   159  102
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_6.png
better model found
persisted
after epoch: 6,now: 2024-06-06 01:25:23.539957,epoch time: 0:25:22.127365,used: 2:33:16.123429,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97947115, 'precision': 0.82465255, 'recall': 0.90249586, 'specificity': 0.90249586, 'f1': 0.8589884, 'auroc': 0.97891915, 'binary_precision': 0.65562195, 'binary_recall': 0.8199728, 'binary_specificity': 0.9850189, 'binary_f1_score': 0.7286447}
confusion matrix:
       0     1
0  41686   634
1    265  1207
---- Validation: 
scalar performance:
{'acc': 0.98126864, 'precision': 0.85080683, 'recall': 0.87704414, 'specificity': 0.87704414, 'f1': 0.86340797, 'auroc': 0.9754858, 'binary_precision': 0.7099567, 'binary_recall': 0.7651633, 'binary_specificity': 0.988925, 'binary_f1_score': 0.7365269}
confusion matrix:
       0    1
0  17948  201
1    151  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9686801, 'precision': 0.8507991, 'recall': 0.6959821, 'specificity': 0.6959821, 'f1': 0.7493346, 'auroc': 0.96024853, 'binary_precision': 0.72727275, 'binary_recall': 0.39846742, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.5148515}
confusion matrix:
      0    1
0  5958   39
1   157  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_7.png
better model found
persisted
after epoch: 7,now: 2024-06-06 01:50:43.898192,epoch time: 0:25:20.358235,used: 2:58:36.481664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9831248, 'precision': 0.8852106, 'recall': 0.8423161, 'specificity': 0.8423161, 'f1': 0.8623941, 'auroc': 0.98045695, 'binary_precision': 0.781106, 'binary_recall': 0.69136643, 'binary_specificity': 0.99326575, 'binary_f1_score': 0.7335017}
confusion matrix:
       0     1
0  42036   285
1    454  1017
---- Validation: 
scalar performance:
{'acc': 0.9822265, 'precision': 0.8797184, 'recall': 0.8385372, 'specificity': 0.8385372, 'f1': 0.8578465, 'auroc': 0.9739648, 'binary_precision': 0.7705779, 'binary_recall': 0.6842924, 'binary_specificity': 0.992782, 'binary_f1_score': 0.72487646}
confusion matrix:
       0    1
0  18018  131
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.8063053, 'recall': 0.64767253, 'specificity': 0.64767253, 'f1': 0.69641495, 'auroc': 0.9565324, 'binary_precision': 0.6422764, 'binary_recall': 0.30268198, 'binary_specificity': 0.992663, 'binary_f1_score': 0.4114583}
confusion matrix:
      0   1
0  5953  44
1   182  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_8.png
better model found
persisted
after epoch: 8,now: 2024-06-06 02:16:05.635728,epoch time: 0:25:21.737536,used: 3:23:58.219200,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9849287, 'precision': 0.8968284, 'recall': 0.86237, 'specificity': 0.86237, 'f1': 0.87875295, 'auroc': 0.9833061, 'binary_precision': 0.8029851, 'binary_recall': 0.73097825, 'binary_specificity': 0.99376184, 'binary_f1_score': 0.7652916}
confusion matrix:
       0     1
0  42056   264
1    396  1076
---- Validation: 
scalar performance:
{'acc': 0.98392934, 'precision': 0.894168, 'recall': 0.8514197, 'specificity': 0.8514197, 'f1': 0.87146604, 'auroc': 0.9780149, 'binary_precision': 0.79859895, 'binary_recall': 0.70917577, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.7512356}
confusion matrix:
       0    1
0  18034  115
1    187  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.7929485, 'recall': 0.5615509, 'specificity': 0.5615509, 'f1': 0.59493333, 'auroc': 0.9556852, 'binary_precision': 0.6226415, 'binary_recall': 0.12643678, 'binary_specificity': 0.996665, 'binary_f1_score': 0.21019109}
confusion matrix:
      0   1
0  5977  20
1   228  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_9.png
better model found
persisted
after epoch: 9,now: 2024-06-06 02:41:29.678895,epoch time: 0:25:24.043167,used: 3:49:22.262367,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9842665, 'precision': 0.92606527, 'recall': 0.8135043, 'specificity': 0.8135043, 'f1': 0.8605855, 'auroc': 0.98191106, 'binary_precision': 0.8648649, 'binary_recall': 0.6304348, 'binary_specificity': 0.99657375, 'binary_f1_score': 0.72927314}
confusion matrix:
       0    1
0  42175  145
1    544  928
---- Validation: 
scalar performance:
{'acc': 0.9831311, 'precision': 0.9331781, 'recall': 0.79175204, 'specificity': 0.79175204, 'f1': 0.8476665, 'auroc': 0.9778939, 'binary_precision': 0.88084114, 'binary_recall': 0.58631414, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.70401496}
confusion matrix:
       0    1
0  18098   51
1    266  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.837801, 'recall': 0.5376472, 'specificity': 0.5376472, 'f1': 0.55902183, 'auroc': 0.95504105, 'binary_precision': 0.71428573, 'binary_recall': 0.07662835, 'binary_specificity': 0.998666, 'binary_f1_score': 0.1384083}
confusion matrix:
      0   1
0  5989   8
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_10.png
early stop counter: 1
val acc:0.9831311106681824, best validation acc: 0.9839293360710144, corresponding to test acc:                         0.9603707194328308 / 0.975071907043457
after epoch: 10,now: 2024-06-06 03:06:46.032678,epoch time: 0:25:16.353783,used: 4:14:38.616150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98447204, 'precision': 0.88951945, 'recall': 0.86442876, 'specificity': 0.86442876, 'f1': 0.8765217, 'auroc': 0.98443437, 'binary_precision': 0.7882096, 'binary_recall': 0.7357337, 'binary_specificity': 0.9931238, 'binary_f1_score': 0.76106817}
confusion matrix:
       0     1
0  42029   291
1    389  1083
---- Validation: 
scalar performance:
{'acc': 0.9835568, 'precision': 0.9017701, 'recall': 0.8332255, 'specificity': 0.8332255, 'f1': 0.86404324, 'auroc': 0.97604823, 'binary_precision': 0.81509435, 'binary_recall': 0.6718507, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.73657286}
confusion matrix:
       0    1
0  18051   98
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.78798974, 'recall': 0.5503068, 'specificity': 0.5503068, 'f1': 0.57824695, 'auroc': 0.93779474, 'binary_precision': 0.6136364, 'binary_recall': 0.10344828, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.17704917}
confusion matrix:
      0   1
0  5980  17
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_11.png
early stop counter: 2
val acc:0.9835568070411682, best validation acc: 0.9839293360710144, corresponding to test acc:                         0.9603707194328308 / 0.975071907043457
after epoch: 11,now: 2024-06-06 03:31:57.606223,epoch time: 0:25:11.573545,used: 4:39:50.189695,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9860705, 'precision': 0.92213535, 'recall': 0.85082996, 'specificity': 0.85082996, 'f1': 0.8829402, 'auroc': 0.98444706, 'binary_precision': 0.8544408, 'binary_recall': 0.7058424, 'binary_specificity': 0.9958176, 'binary_f1_score': 0.7730655}
confusion matrix:
       0     1
0  42143   177
1    433  1039
---- Validation: 
scalar performance:
{'acc': 0.9823861, 'precision': 0.92480993, 'recall': 0.786116, 'specificity': 0.786116, 'f1': 0.8409389, 'auroc': 0.97839546, 'binary_precision': 0.864486, 'binary_recall': 0.5754277, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.69094306}
confusion matrix:
       0    1
0  18091   58
1    273  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.8219905, 'recall': 0.56005204, 'specificity': 0.56005204, 'f1': 0.59390265, 'auroc': 0.9298846, 'binary_precision': 0.68085104, 'binary_recall': 0.12260536, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.2077922}
confusion matrix:
      0   1
0  5982  15
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_12.png
early stop counter: 3
val acc:0.9823861122131348, best validation acc: 0.9839293360710144, corresponding to test acc:                         0.9603707194328308 / 0.975071907043457
after epoch: 12,now: 2024-06-06 03:57:10.629866,epoch time: 0:25:13.023643,used: 5:05:03.213338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9857737, 'precision': 0.9356135, 'recall': 0.83100486, 'specificity': 0.83100486, 'f1': 0.87564576, 'auroc': 0.98627746, 'binary_precision': 0.8827773, 'binary_recall': 0.6650815, 'binary_specificity': 0.99692816, 'binary_f1_score': 0.7586207}
confusion matrix:
       0    1
0  42190  130
1    493  979
---- Validation: 
scalar performance:
{'acc': 0.9823329, 'precision': 0.9152522, 'recall': 0.79433906, 'specificity': 0.79433906, 'f1': 0.8437141, 'auroc': 0.974365, 'binary_precision': 0.8447894, 'binary_recall': 0.592535, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.6965266}
confusion matrix:
       0    1
0  18079   70
1    262  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.8822491, 'recall': 0.6325989, 'specificity': 0.6325989, 'f1': 0.69198424, 'auroc': 0.95508754, 'binary_precision': 0.79545456, 'binary_recall': 0.26819924, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.40114614}
confusion matrix:
      0   1
0  5979  18
1   191  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_13.png
early stop counter: 4
val acc:0.9823328852653503, best validation acc: 0.9839293360710144, corresponding to test acc:                         0.9603707194328308 / 0.975071907043457
after epoch: 13,now: 2024-06-06 04:22:30.497645,epoch time: 0:25:19.867779,used: 5:30:23.081117,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98202866, 'precision': 0.8386177, 'recall': 0.9293921, 'specificity': 0.9293921, 'f1': 0.8781103, 'auroc': 0.9875076, 'binary_precision': 0.6816976, 'binary_recall': 0.87296194, 'binary_specificity': 0.9858223, 'binary_f1_score': 0.76556444}
confusion matrix:
       0     1
0  41720   600
1    187  1285
---- Validation: 
scalar performance:
{'acc': 0.9816411, 'precision': 0.8409257, 'recall': 0.91849005, 'specificity': 0.91849005, 'f1': 0.8753526, 'auroc': 0.97640526, 'binary_precision': 0.68718594, 'binary_recall': 0.85069984, 'binary_specificity': 0.98628026, 'binary_f1_score': 0.76025015}
confusion matrix:
       0    1
0  17900  249
1     96  547
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.79211307, 'recall': 0.66208106, 'specificity': 0.66208106, 'f1': 0.7064283, 'auroc': 0.9496755, 'binary_precision': 0.6126761, 'binary_recall': 0.33333334, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.4317618}
confusion matrix:
      0   1
0  5942  55
1   174  87
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_14.png
early stop counter: 5
val acc:0.9816411137580872, best validation acc: 0.9839293360710144, corresponding to test acc:                         0.9603707194328308 / 0.975071907043457
after epoch: 14,now: 2024-06-06 04:47:54.810634,epoch time: 0:25:24.312989,used: 5:55:47.394106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9881485, 'precision': 0.91698444, 'recall': 0.8964255, 'specificity': 0.8964255, 'f1': 0.9064241, 'auroc': 0.98829526, 'binary_precision': 0.8409742, 'binary_recall': 0.79809654, 'binary_specificity': 0.9947544, 'binary_f1_score': 0.8189745}
confusion matrix:
       0     1
0  42099   222
1    297  1174
---- Validation: 
scalar performance:
{'acc': 0.9848872, 'precision': 0.8890132, 'recall': 0.8796676, 'specificity': 0.8796676, 'f1': 0.88427866, 'auroc': 0.9803437, 'binary_precision': 0.7862839, 'binary_recall': 0.7667185, 'binary_specificity': 0.99261665, 'binary_f1_score': 0.776378}
confusion matrix:
       0    1
0  18015  134
1    150  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8229151, 'recall': 0.5994482, 'specificity': 0.5994482, 'f1': 0.646775, 'auroc': 0.9508412, 'binary_precision': 0.67948717, 'binary_recall': 0.20306513, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.31268436}
confusion matrix:
      0   1
0  5972  25
1   208  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_15.png
better model found
persisted
after epoch: 15,now: 2024-06-06 05:13:16.668950,epoch time: 0:25:21.858316,used: 6:21:09.252422,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9861618, 'precision': 0.92520523, 'recall': 0.84880877, 'specificity': 0.84880877, 'f1': 0.8829485, 'auroc': 0.9893378, 'binary_precision': 0.86071724, 'binary_recall': 0.70156354, 'binary_specificity': 0.996054, 'binary_f1_score': 0.7730336}
confusion matrix:
       0     1
0  42154   167
1    439  1032
---- Validation: 
scalar performance:
{'acc': 0.9841422, 'precision': 0.91614175, 'recall': 0.82677805, 'specificity': 0.82677805, 'f1': 0.8656663, 'auroc': 0.9779115, 'binary_precision': 0.84431136, 'binary_recall': 0.6578538, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.7395105}
confusion matrix:
       0    1
0  18071   78
1    220  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8012492, 'recall': 0.5168245, 'specificity': 0.5168245, 'f1': 0.5222298, 'auroc': 0.94424605, 'binary_precision': 0.64285713, 'binary_recall': 0.03448276, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.06545454}
confusion matrix:
      0  1
0  5992  5
1   252  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_16.png
early stop counter: 1
val acc:0.9841421842575073, best validation acc: 0.9848871827125549, corresponding to test acc:                         0.9627676606178284 / 0.975071907043457
after epoch: 16,now: 2024-06-06 05:38:32.067097,epoch time: 0:25:15.398147,used: 6:46:24.650569,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9884454, 'precision': 0.9334415, 'recall': 0.88091034, 'specificity': 0.88091034, 'f1': 0.9053507, 'auroc': 0.9907764, 'binary_precision': 0.875, 'binary_recall': 0.765625, 'binary_specificity': 0.9961957, 'binary_f1_score': 0.81666666}
confusion matrix:
       0     1
0  42159   161
1    345  1127
---- Validation: 
scalar performance:
{'acc': 0.9850468, 'precision': 0.9105717, 'recall': 0.8504981, 'specificity': 0.8504981, 'f1': 0.8779731, 'auroc': 0.9799865, 'binary_precision': 0.83150184, 'binary_recall': 0.7060653, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.7636669}
confusion matrix:
       0    1
0  18057   92
1    189  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.9152652, 'recall': 0.59703416, 'specificity': 0.59703416, 'f1': 0.6504376, 'auroc': 0.94943416, 'binary_precision': 0.86440676, 'binary_recall': 0.1954023, 'binary_specificity': 0.998666, 'binary_f1_score': 0.31874996}
confusion matrix:
      0   1
0  5989   8
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_17.png
better model found
persisted
after epoch: 17,now: 2024-06-06 06:03:39.854645,epoch time: 0:25:07.787548,used: 7:11:32.438117,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9885824, 'precision': 0.93511146, 'recall': 0.8811502, 'specificity': 0.8811502, 'f1': 0.90621, 'auroc': 0.9918908, 'binary_precision': 0.87831515, 'binary_recall': 0.7659864, 'binary_specificity': 0.996314, 'binary_f1_score': 0.818314}
confusion matrix:
       0     1
0  42166   156
1    344  1126
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.92977, 'recall': 0.8472988, 'specificity': 0.8472988, 'f1': 0.88382024, 'auroc': 0.9809775, 'binary_precision': 0.87015504, 'binary_recall': 0.6982893, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.7748059}
confusion matrix:
       0    1
0  18082   67
1    194  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.8822491, 'recall': 0.6325989, 'specificity': 0.6325989, 'f1': 0.69198424, 'auroc': 0.95744056, 'binary_precision': 0.79545456, 'binary_recall': 0.26819924, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.40114614}
confusion matrix:
      0   1
0  5979  18
1   191  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_18.png
better model found
persisted
after epoch: 18,now: 2024-06-06 06:28:55.663145,epoch time: 0:25:15.808500,used: 7:36:48.246617,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98803437, 'precision': 0.9175781, 'recall': 0.89341354, 'specificity': 0.89341354, 'f1': 0.90510684, 'auroc': 0.98970866, 'binary_precision': 0.84237164, 'binary_recall': 0.79197824, 'binary_specificity': 0.9948489, 'binary_f1_score': 0.816398}
confusion matrix:
       0     1
0  42103   218
1    306  1165
---- Validation: 
scalar performance:
{'acc': 0.98573864, 'precision': 0.91345906, 'recall': 0.85985684, 'specificity': 0.85985684, 'f1': 0.8846504, 'auroc': 0.9817575, 'binary_precision': 0.8366248, 'binary_recall': 0.7247278, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.7766667}
confusion matrix:
       0    1
0  18058   91
1    177  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.7208402, 'recall': 0.52373695, 'specificity': 0.52373695, 'f1': 0.5344258, 'auroc': 0.924822, 'binary_precision': 0.4814815, 'binary_recall': 0.049808428, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.09027777}
confusion matrix:
      0   1
0  5983  14
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_19.png
early stop counter: 1
val acc:0.9857386350631714, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9666027426719666 / 0.975071907043457
after epoch: 19,now: 2024-06-06 06:54:12.647878,epoch time: 0:25:16.984733,used: 8:02:05.231350,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98666424, 'precision': 0.9632666, 'recall': 0.8219577, 'specificity': 0.8219577, 'f1': 0.8790164, 'auroc': 0.9922264, 'binary_precision': 0.9387352, 'binary_recall': 0.64538044, 'binary_specificity': 0.998535, 'binary_f1_score': 0.7648954}
confusion matrix:
       0    1
0  42258   62
1    522  950
---- Validation: 
scalar performance:
{'acc': 0.98323756, 'precision': 0.9397416, 'recall': 0.78805685, 'specificity': 0.78805685, 'f1': 0.8469627, 'auroc': 0.9798771, 'binary_precision': 0.8942308, 'binary_recall': 0.5785381, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.70254964}
confusion matrix:
       0    1
0  18105   44
1    271  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.9051653, 'recall': 0.6026145, 'specificity': 0.6026145, 'f1': 0.65725386, 'auroc': 0.9531212, 'binary_precision': 0.84375, 'binary_recall': 0.20689656, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.3323077}
confusion matrix:
      0   1
0  5987  10
1   207  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_20.png
early stop counter: 2
val acc:0.9832375645637512, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9666027426719666 / 0.975071907043457
after epoch: 20,now: 2024-06-06 07:19:27.582283,epoch time: 0:25:14.934405,used: 8:27:20.165755,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9900438, 'precision': 0.94275105, 'recall': 0.8984582, 'specificity': 0.8984582, 'f1': 0.9193488, 'auroc': 0.9918294, 'binary_precision': 0.8924242, 'binary_recall': 0.80027175, 'binary_specificity': 0.9966446, 'binary_f1_score': 0.8438395}
confusion matrix:
       0     1
0  42178   142
1    294  1178
---- Validation: 
scalar performance:
{'acc': 0.9860047, 'precision': 0.9126168, 'recall': 0.86599505, 'specificity': 0.86599505, 'f1': 0.88779676, 'auroc': 0.9774756, 'binary_precision': 0.83450705, 'binary_recall': 0.7371695, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.78282416}
confusion matrix:
       0    1
0  18055   94
1    169  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.80344164, 'recall': 0.5934509, 'specificity': 0.5934509, 'f1': 0.63767904, 'auroc': 0.9382001, 'binary_precision': 0.64102566, 'binary_recall': 0.19157088, 'binary_specificity': 0.995331, 'binary_f1_score': 0.29498523}
confusion matrix:
      0   1
0  5969  28
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_21.png
early stop counter: 3
val acc:0.9860047101974487, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9666027426719666 / 0.975071907043457
after epoch: 21,now: 2024-06-06 07:44:35.008513,epoch time: 0:25:07.426230,used: 8:52:27.591985,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9864359, 'precision': 0.9764571, 'recall': 0.8087252, 'specificity': 0.8087252, 'f1': 0.8734805, 'auroc': 0.9929279, 'binary_precision': 0.9660297, 'binary_recall': 0.6182065, 'binary_specificity': 0.99924386, 'binary_f1_score': 0.75393534}
confusion matrix:
       0    1
0  42288   32
1    562  910
---- Validation: 
scalar performance:
{'acc': 0.98185396, 'precision': 0.9595612, 'recall': 0.7513379, 'specificity': 0.7513379, 'f1': 0.8229445, 'auroc': 0.97740746, 'binary_precision': 0.9364162, 'binary_recall': 0.503888, 'binary_specificity': 0.9987878, 'binary_f1_score': 0.6552073}
confusion matrix:
       0    1
0  18127   22
1    319  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8973372, 'recall': 0.5379807, 'specificity': 0.5379807, 'f1': 0.5601599, 'auroc': 0.94729054, 'binary_precision': 0.8333333, 'binary_recall': 0.07662835, 'binary_specificity': 0.999333, 'binary_f1_score': 0.14035088}
confusion matrix:
      0   1
0  5993   4
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_22.png
early stop counter: 4
val acc:0.9818539619445801, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9666027426719666 / 0.975071907043457
after epoch: 22,now: 2024-06-06 08:09:49.938580,epoch time: 0:25:14.930067,used: 9:17:42.522052,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9869154, 'precision': 0.9011844, 'recall': 0.89618385, 'specificity': 0.89618385, 'f1': 0.8986671, 'auroc': 0.9924823, 'binary_precision': 0.80935997, 'binary_recall': 0.79891306, 'binary_specificity': 0.99345464, 'binary_f1_score': 0.80410254}
confusion matrix:
       0     1
0  42043   277
1    296  1176
---- Validation: 
scalar performance:
{'acc': 0.9838761, 'precision': 0.8891782, 'recall': 0.8581426, 'specificity': 0.8581426, 'f1': 0.8729613, 'auroc': 0.97705805, 'binary_precision': 0.7881356, 'binary_recall': 0.7231726, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.7542579}
confusion matrix:
       0    1
0  18024  125
1    178  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.8565578, 'recall': 0.6471742, 'specificity': 0.6471742, 'f1': 0.7044728, 'auroc': 0.95923984, 'binary_precision': 0.74285716, 'binary_recall': 0.29885057, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.42622948}
confusion matrix:
      0   1
0  5970  27
1   183  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_23.png
early stop counter: 5
val acc:0.98387610912323, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9666027426719666 / 0.975071907043457
after epoch: 23,now: 2024-06-06 08:35:07.176972,epoch time: 0:25:17.238392,used: 9:42:59.760444,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9891989, 'precision': 0.91482186, 'recall': 0.91998756, 'specificity': 0.91998756, 'f1': 0.9173875, 'auroc': 0.99394006, 'binary_precision': 0.83501005, 'binary_recall': 0.84578806, 'binary_specificity': 0.9941871, 'binary_f1_score': 0.8403646}
confusion matrix:
       0     1
0  42074   246
1    227  1245
---- Validation: 
scalar performance:
{'acc': 0.985845, 'precision': 0.89598703, 'recall': 0.8876641, 'specificity': 0.8876641, 'f1': 0.8917776, 'auroc': 0.9759281, 'binary_precision': 0.799682, 'binary_recall': 0.7822706, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.7908805}
confusion matrix:
       0    1
0  18023  126
1    140  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.85688406, 'recall': 0.56796503, 'specificity': 0.56796503, 'f1': 0.6067973, 'auroc': 0.9470322, 'binary_precision': 0.75, 'binary_recall': 0.13793103, 'binary_specificity': 0.997999, 'binary_f1_score': 0.2330097}
confusion matrix:
      0   1
0  5985  12
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_24.png
early stop counter: 6
val acc:0.9858450293540955, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9666027426719666 / 0.975071907043457
after epoch: 24,now: 2024-06-06 09:00:24.518978,epoch time: 0:25:17.342006,used: 10:08:17.102450,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9908659, 'precision': 0.9474426, 'recall': 0.9074079, 'specificity': 0.9074079, 'f1': 0.9264158, 'auroc': 0.994637, 'binary_precision': 0.9011976, 'binary_recall': 0.8179348, 'binary_specificity': 0.9968809, 'binary_f1_score': 0.8575499}
confusion matrix:
       0     1
0  42188   132
1    268  1204
---- Validation: 
scalar performance:
{'acc': 0.9845147, 'precision': 0.9099097, 'recall': 0.8412219, 'specificity': 0.8412219, 'f1': 0.87217396, 'auroc': 0.9778739, 'binary_precision': 0.83082706, 'binary_recall': 0.6874028, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.7523404}
confusion matrix:
       0    1
0  18059   90
1    201  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.83260715, 'recall': 0.6334307, 'specificity': 0.6334307, 'f1': 0.6864999, 'auroc': 0.9488137, 'binary_precision': 0.6960784, 'binary_recall': 0.27203065, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.3911846}
confusion matrix:
      0   1
0  5966  31
1   190  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_25.png
early stop counter: 7
val acc:0.9845147132873535, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9666027426719666 / 0.975071907043457
after epoch: 25,now: 2024-06-06 09:25:37.795432,epoch time: 0:25:13.276454,used: 10:33:30.378904,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99244153, 'precision': 0.94344175, 'recall': 0.93965787, 'specificity': 0.93965787, 'f1': 0.9415411, 'auroc': 0.9951541, 'binary_precision': 0.8909465, 'binary_recall': 0.88307273, 'binary_specificity': 0.996243, 'binary_f1_score': 0.88699216}
confusion matrix:
       0     1
0  42162   159
1    172  1299
---- Validation: 
scalar performance:
{'acc': 0.98659, 'precision': 0.90411913, 'recall': 0.88954985, 'specificity': 0.88954985, 'f1': 0.89668953, 'auroc': 0.97925335, 'binary_precision': 0.81583196, 'binary_recall': 0.785381, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.800317}
confusion matrix:
       0    1
0  18035  114
1    138  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.8368925, 'recall': 0.626018, 'specificity': 0.626018, 'f1': 0.6790739, 'auroc': 0.9461267, 'binary_precision': 0.70526314, 'binary_recall': 0.256705, 'binary_specificity': 0.995331, 'binary_f1_score': 0.3764045}
confusion matrix:
      0   1
0  5969  28
1   194  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_26.png
better model found
persisted
after epoch: 26,now: 2024-06-06 09:50:49.535005,epoch time: 0:25:11.739573,used: 10:58:42.118477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9881257, 'precision': 0.9799051, 'recall': 0.83287746, 'specificity': 0.83287746, 'f1': 0.8921906, 'auroc': 0.9951497, 'binary_precision': 0.97128713, 'binary_recall': 0.6664402, 'binary_specificity': 0.9993147, 'binary_f1_score': 0.7904915}
confusion matrix:
       0    1
0  42291   29
1    491  981
---- Validation: 
scalar performance:
{'acc': 0.9822265, 'precision': 0.962834, 'recall': 0.7552811, 'specificity': 0.7552811, 'f1': 0.8270894, 'auroc': 0.9761331, 'binary_precision': 0.9426934, 'binary_recall': 0.5116641, 'binary_specificity': 0.998898, 'binary_f1_score': 0.6633065}
confusion matrix:
       0    1
0  18129   20
1    314  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.9294125, 'recall': 0.5495583, 'specificity': 0.5495583, 'f1': 0.57992184, 'auroc': 0.9550698, 'binary_precision': 0.8965517, 'binary_recall': 0.099616855, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.17931034}
confusion matrix:
      0   1
0  5994   3
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_27.png
early stop counter: 1
val acc:0.9822264909744263, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9645254015922546 / 0.975071907043457
after epoch: 27,now: 2024-06-06 10:16:23.317378,epoch time: 0:25:33.782373,used: 11:24:15.900850,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99244153, 'precision': 0.96275693, 'recall': 0.9173477, 'specificity': 0.9173477, 'f1': 0.9387929, 'auroc': 0.9962068, 'binary_precision': 0.9311649, 'binary_recall': 0.8368457, 'binary_specificity': 0.99784976, 'binary_f1_score': 0.88148946}
confusion matrix:
       0     1
0  42230    91
1    240  1231
---- Validation: 
scalar performance:
{'acc': 0.98541933, 'precision': 0.92915714, 'recall': 0.8356898, 'specificity': 0.8356898, 'f1': 0.87627566, 'auroc': 0.9738837, 'binary_precision': 0.8697395, 'binary_recall': 0.6749611, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.76007}
confusion matrix:
       0    1
0  18084   65
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.873337, 'recall': 0.581375, 'specificity': 0.581375, 'f1': 0.62664974, 'auroc': 0.9195746, 'binary_precision': 0.7818182, 'binary_recall': 0.16475096, 'binary_specificity': 0.997999, 'binary_f1_score': 0.27215192}
confusion matrix:
      0   1
0  5985  12
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_28.png
early stop counter: 2
val acc:0.9854193329811096, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9645254015922546 / 0.975071907043457
after epoch: 28,now: 2024-06-06 10:41:58.133260,epoch time: 0:25:34.815882,used: 11:49:50.716732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9898155, 'precision': 0.9041617, 'recall': 0.95011044, 'specificity': 0.95011044, 'f1': 0.9257939, 'auroc': 0.995223, 'binary_precision': 0.81155014, 'binary_recall': 0.90754586, 'binary_specificity': 0.992675, 'binary_f1_score': 0.8568678}
confusion matrix:
       0     1
0  42011   310
1    136  1335
---- Validation: 
scalar performance:
{'acc': 0.9844615, 'precision': 0.87749654, 'recall': 0.89219815, 'specificity': 0.89219815, 'f1': 0.88469434, 'auroc': 0.98061025, 'binary_precision': 0.76233184, 'binary_recall': 0.7931571, 'binary_specificity': 0.9912392, 'binary_f1_score': 0.777439}
confusion matrix:
       0    1
0  17990  159
1    133  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.82147324, 'recall': 0.6930659, 'specificity': 0.6930659, 'f1': 0.73955715, 'auroc': 0.9531289, 'binary_precision': 0.66883117, 'binary_recall': 0.394636, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.49638554}
confusion matrix:
      0    1
0  5946   51
1   158  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_29.png
early stop counter: 3
val acc:0.9844614863395691, best validation acc: 0.9865900278091431, corresponding to test acc:                         0.9645254015922546 / 0.975071907043457
after epoch: 29,now: 2024-06-06 11:07:36.852600,epoch time: 0:25:38.719340,used: 12:15:29.436072,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99191636, 'precision': 0.94079316, 'recall': 0.9338522, 'specificity': 0.9338522, 'f1': 0.93729293, 'auroc': 0.9963555, 'binary_precision': 0.88604975, 'binary_recall': 0.87160325, 'binary_specificity': 0.99610114, 'binary_f1_score': 0.87876713}
confusion matrix:
       0     1
0  42155   165
1    189  1283
---- Validation: 
scalar performance:
{'acc': 0.9874947, 'precision': 0.9277824, 'recall': 0.874267, 'specificity': 0.874267, 'f1': 0.8990978, 'auroc': 0.9782637, 'binary_precision': 0.8642857, 'binary_recall': 0.7527216, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.804655}
confusion matrix:
       0    1
0  18073   76
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8434025, 'recall': 0.6111092, 'specificity': 0.6111092, 'f1': 0.6627699, 'auroc': 0.92906064, 'binary_precision': 0.7195122, 'binary_recall': 0.22605364, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.34402335}
confusion matrix:
      0   1
0  5974  23
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_30.png
better model found
persisted
after epoch: 30,now: 2024-06-06 11:33:28.629968,epoch time: 0:25:51.777368,used: 12:41:21.213440,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:41:21.213440 at 2024-06-06 11:33:28.629968
persisted model performance metric: 

scalar performance:
{'acc': 0.965644, 'precision': 0.8679238, 'recall': 0.6247693, 'specificity': 0.6247693, 'f1': 0.6813678, 'auroc': 0.9495789, 'binary_precision': 0.76744187, 'binary_recall': 0.25287357, 'binary_specificity': 0.996665, 'binary_f1_score': 0.3804035}
confusion matrix:
      0   1
0  5977  20
1   195  66
oracle model performance metric: 

scalar performance:
{'acc': 0.9749121, 'precision': 0.9324361, 'recall': 0.7267187, 'specificity': 0.7267187, 'f1': 0.79478943, 'auroc': 0.9515575, 'binary_precision': 0.8880597, 'binary_recall': 0.4559387, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.6025316}
confusion matrix:
      0    1
0  5982   15
1   142  119
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456549 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456549 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB |   1119 TiB |   1119 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1106 TiB |   1106 TiB |
|       from small pool |  40679 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14486 MiB |  14486 MiB |  14486 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446619 KiB |   1251 MiB |    802 TiB |    802 TiB |
|       from large pool | 435058 KiB |   1243 MiB |    789 TiB |    789 TiB |
|       from small pool |  11560 KiB |     17 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  197601 K  |  197597 K  |
|       from large pool |     187    |    1413    |  102521 K  |  102521 K  |
|       from small pool |    3301    |    6290    |   95079 K  |   95076 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  197601 K  |  197597 K  |
|       from large pool |     187    |    1413    |  102521 K  |  102521 K  |
|       from small pool |    3301    |    6290    |   95079 K  |   95076 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |     637    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    2803    |  125442 K  |  125442 K  |
|       from large pool |      37    |     600    |   76732 K  |   76732 K  |
|       from small pool |      43    |    2765    |   48709 K  |   48709 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1119 TiB |   1119 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1106 TiB |   1106 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14486 MiB |  14486 MiB |  13604 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     72 MiB |     72 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |    802 TiB |    802 TiB |
|       from large pool |  24320 KiB |   1243 MiB |    789 TiB |    789 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95079 K  |   95079 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95079 K  |   95079 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |     637    |     574    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      36    |      36    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2803    |  125443 K  |  125443 K  |
|       from large pool |       4    |     600    |   76732 K  |   76732 K  |
|       from small pool |       0    |    2765    |   48710 K  |   48710 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1119 TiB |   1119 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1106 TiB |   1106 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14486 MiB |  14486 MiB |  13604 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     72 MiB |     72 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |    802 TiB |    802 TiB |
|       from large pool |  24320 KiB |   1243 MiB |    789 TiB |    789 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95079 K  |   95079 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95079 K  |   95079 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |     637    |     574    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      36    |      36    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2803    |  125443 K  |  125443 K  |
|       from large pool |       4    |     600    |   76732 K  |   76732 K  |
|       from small pool |       0    |    2765    |   48710 K  |   48710 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988

 Experiment start at: 2024-06-06 11:44:43.497778
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97040313, 'precision': 0.79189813, 'recall': 0.6376881, 'specificity': 0.6376881, 'f1': 0.68483543, 'auroc': 0.9467466, 'binary_precision': 0.60778445, 'binary_recall': 0.2815534, 'binary_specificity': 0.9938228, 'binary_f1_score': 0.3848341}
confusion matrix:
       0    1
0  42152  262
1   1036  406
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.7997631, 'recall': 0.5363445, 'specificity': 0.5363445, 'f1': 0.55761325, 'auroc': 0.9447509, 'binary_precision': 0.6329114, 'binary_recall': 0.0742942, 'binary_specificity': 0.99839485, 'binary_f1_score': 0.13297872}
confusion matrix:
       0   1
0  18038  29
1    623  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687399, 'precision': 0.9313191, 'recall': 0.643474, 'specificity': 0.643474, 'f1': 0.7099855, 'auroc': 0.9444113, 'binary_precision': 0.89285713, 'binary_recall': 0.28846154, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.43604654}
confusion matrix:
      0   1
0  5937   9
1   185  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-06 12:11:57.269290,epoch time: 0:27:13.771512,used: 0:27:13.771512,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97154325, 'precision': 0.778869, 'recall': 0.7545059, 'specificity': 0.7545059, 'f1': 0.7660757, 'auroc': 0.960933, 'binary_precision': 0.57393295, 'binary_recall': 0.5221914, 'binary_specificity': 0.9868204, 'binary_f1_score': 0.54684097}
confusion matrix:
       0    1
0  41855  559
1    689  753
---- Validation: 
scalar performance:
{'acc': 0.96921027, 'precision': 0.78539836, 'recall': 0.72653544, 'specificity': 0.72653544, 'f1': 0.75223017, 'auroc': 0.9553452, 'binary_precision': 0.59056604, 'binary_recall': 0.46508172, 'binary_specificity': 0.9879891, 'binary_f1_score': 0.5203658}
confusion matrix:
       0    1
0  17850  217
1    360  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97454077, 'precision': 0.87086743, 'recall': 0.7825862, 'specificity': 0.7825862, 'f1': 0.8201468, 'auroc': 0.95069563, 'binary_precision': 0.7602041, 'binary_recall': 0.5730769, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.6535087}
confusion matrix:
      0    1
0  5899   47
1   111  149
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-06 12:37:31.693043,epoch time: 0:25:34.423753,used: 0:52:48.195265,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97416544, 'precision': 0.8805366, 'recall': 0.64633226, 'specificity': 0.64633226, 'f1': 0.70800143, 'auroc': 0.9664464, 'binary_precision': 0.7845304, 'binary_recall': 0.29542303, 'binary_specificity': 0.9972415, 'binary_f1_score': 0.42921916}
confusion matrix:
       0    1
0  42297  117
1   1016  426
---- Validation: 
scalar performance:
{'acc': 0.9702775, 'precision': 0.8870509, 'recall': 0.6133614, 'specificity': 0.6133614, 'f1': 0.6704285, 'auroc': 0.9588547, 'binary_precision': 0.8020833, 'binary_recall': 0.22882615, 'binary_specificity': 0.99789673, 'binary_f1_score': 0.35606936}
confusion matrix:
       0    1
0  18029   38
1    519  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.83238554, 'recall': 0.549075, 'specificity': 0.549075, 'f1': 0.5774306, 'auroc': 0.9594592, 'binary_precision': 0.7027027, 'binary_recall': 0.1, 'binary_specificity': 0.99815, 'binary_f1_score': 0.17508417}
confusion matrix:
      0   1
0  5935  11
1   234  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_3.png
better model found
persisted
after epoch: 3,now: 2024-06-06 13:03:11.103097,epoch time: 0:25:39.410054,used: 1:18:27.605319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9783154, 'precision': 0.90308183, 'recall': 0.71446335, 'specificity': 0.71446335, 'f1': 0.77800804, 'auroc': 0.97232175, 'binary_precision': 0.82516557, 'binary_recall': 0.43203884, 'binary_specificity': 0.9968878, 'binary_f1_score': 0.567137}
confusion matrix:
       0    1
0  42282  132
1    819  623
---- Validation: 
scalar performance:
{'acc': 0.97246534, 'precision': 0.91775674, 'recall': 0.6380999, 'specificity': 0.6380999, 'f1': 0.7030612, 'auroc': 0.96352994, 'binary_precision': 0.86175114, 'binary_recall': 0.2778603, 'binary_specificity': 0.99833953, 'binary_f1_score': 0.4202247}
confusion matrix:
       0    1
0  18037   30
1    486  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.6793415, 'recall': 0.5071878, 'specificity': 0.5071878, 'f1': 0.5040258, 'auroc': 0.94914985, 'binary_precision': 0.4, 'binary_recall': 0.015384615, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.02962963}
confusion matrix:
      0  1
0  5940  6
1   256  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_4.png
better model found
persisted
after epoch: 4,now: 2024-06-06 13:28:49.254589,epoch time: 0:25:38.151492,used: 1:44:05.756811,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9798659, 'precision': 0.90022635, 'recall': 0.7477553, 'specificity': 0.7477553, 'f1': 0.80477357, 'auroc': 0.9711538, 'binary_precision': 0.8172531, 'binary_recall': 0.49930653, 'binary_specificity': 0.9962041, 'binary_f1_score': 0.61988807}
confusion matrix:
       0    1
0  42253  161
1    722  720
---- Validation: 
scalar performance:
{'acc': 0.9774813, 'precision': 0.9025005, 'recall': 0.7351166, 'specificity': 0.7351166, 'f1': 0.7951498, 'auroc': 0.9648716, 'binary_precision': 0.8242894, 'binary_recall': 0.47399703, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.60188675}
confusion matrix:
       0    1
0  17999   68
1    354  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.795204, 'recall': 0.55994076, 'specificity': 0.55994076, 'f1': 0.5926881, 'auroc': 0.94667715, 'binary_precision': 0.627451, 'binary_recall': 0.12307692, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.20578778}
confusion matrix:
      0   1
0  5927  19
1   228  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_5.png
better model found
persisted
after epoch: 5,now: 2024-06-06 13:54:34.496606,epoch time: 0:25:45.242017,used: 2:09:50.998828,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9793415, 'precision': 0.8878379, 'recall': 0.74932164, 'specificity': 0.74932164, 'f1': 0.80241776, 'auroc': 0.9771832, 'binary_precision': 0.79234976, 'binary_recall': 0.5031228, 'binary_specificity': 0.9955205, 'binary_f1_score': 0.6154499}
confusion matrix:
       0    1
0  42225  190
1    716  725
---- Validation: 
scalar performance:
{'acc': 0.9747599, 'precision': 0.91317457, 'recall': 0.6793449, 'specificity': 0.6793449, 'f1': 0.7469132, 'auroc': 0.9712742, 'binary_precision': 0.8496503, 'binary_recall': 0.36106983, 'binary_specificity': 0.99762, 'binary_f1_score': 0.5067779}
confusion matrix:
       0    1
0  18024   43
1    430  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7457782, 'recall': 0.54990494, 'specificity': 0.54990494, 'f1': 0.57619774, 'auroc': 0.9575312, 'binary_precision': 0.5294118, 'binary_recall': 0.103846155, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.17363346}
confusion matrix:
      0   1
0  5922  24
1   233  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_6.png
early stop counter: 1
val acc:0.9747598767280579, best validation acc: 0.9774813055992126, corresponding to test acc:                         0.9601998329162598 / 0.9745407700538635
after epoch: 6,now: 2024-06-06 14:20:21.084582,epoch time: 0:25:46.587976,used: 2:35:37.586804,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98276174, 'precision': 0.85923755, 'recall': 0.8765342, 'specificity': 0.8765342, 'f1': 0.8676647, 'auroc': 0.9813875, 'binary_precision': 0.7265522, 'binary_recall': 0.7628294, 'binary_specificity': 0.9902391, 'binary_f1_score': 0.74424905}
confusion matrix:
       0     1
0  42000   414
1    342  1100
---- Validation: 
scalar performance:
{'acc': 0.9808965, 'precision': 0.87804204, 'recall': 0.8313031, 'specificity': 0.8313031, 'f1': 0.85299444, 'auroc': 0.97543, 'binary_precision': 0.76831347, 'binary_recall': 0.6701337, 'binary_specificity': 0.99247247, 'binary_f1_score': 0.71587294}
confusion matrix:
       0    1
0  17931  136
1    222  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7327275, 'recall': 0.59011036, 'specificity': 0.59011036, 'f1': 0.6260867, 'auroc': 0.95261633, 'binary_precision': 0.5, 'binary_recall': 0.18846154, 'binary_specificity': 0.9917592, 'binary_f1_score': 0.27374303}
confusion matrix:
      0   1
0  5897  49
1   211  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_7.png
better model found
persisted
after epoch: 7,now: 2024-06-06 14:46:17.311305,epoch time: 0:25:56.226723,used: 3:01:33.813527,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98148483, 'precision': 0.85822296, 'recall': 0.8457284, 'specificity': 0.8457284, 'f1': 0.8518552, 'auroc': 0.97981375, 'binary_precision': 0.7266187, 'binary_recall': 0.7004161, 'binary_specificity': 0.9910407, 'binary_f1_score': 0.71327686}
confusion matrix:
       0     1
0  42034   380
1    432  1010
---- Validation: 
scalar performance:
{'acc': 0.97908217, 'precision': 0.87737215, 'recall': 0.7945988, 'specificity': 0.7945988, 'f1': 0.83044434, 'auroc': 0.97497547, 'binary_precision': 0.7696737, 'binary_recall': 0.5958395, 'binary_specificity': 0.9933581, 'binary_f1_score': 0.6716918}
confusion matrix:
       0    1
0  17947  120
1    272  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.73522866, 'recall': 0.5699656, 'specificity': 0.5699656, 'f1': 0.60270995, 'auroc': 0.939831, 'binary_precision': 0.50666666, 'binary_recall': 0.14615385, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.22686566}
confusion matrix:
      0   1
0  5909  37
1   222  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_8.png
early stop counter: 1
val acc:0.9790821671485901, best validation acc: 0.9808964729309082, corresponding to test acc:                         0.9581050872802734 / 0.9745407700538635
after epoch: 8,now: 2024-06-06 15:12:02.556874,epoch time: 0:25:45.245569,used: 3:27:19.059096,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98540676, 'precision': 0.90601, 'recall': 0.85244536, 'specificity': 0.85244536, 'f1': 0.8771887, 'auroc': 0.98315454, 'binary_precision': 0.82182986, 'binary_recall': 0.71012485, 'binary_specificity': 0.9947659, 'binary_f1_score': 0.7619048}
confusion matrix:
       0     1
0  42192   222
1    418  1024
---- Validation: 
scalar performance:
{'acc': 0.9816969, 'precision': 0.91878426, 'recall': 0.7945243, 'specificity': 0.7945243, 'f1': 0.8449738, 'auroc': 0.97399914, 'binary_precision': 0.8525641, 'binary_recall': 0.59286773, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.6993865}
confusion matrix:
       0    1
0  17998   69
1    274  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.84335494, 'recall': 0.5642914, 'specificity': 0.5642914, 'f1': 0.60087717, 'auroc': 0.95252967, 'binary_precision': 0.7234042, 'binary_recall': 0.13076924, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.22149837}
confusion matrix:
      0   1
0  5933  13
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_9.png
better model found
persisted
after epoch: 9,now: 2024-06-06 15:37:44.103064,epoch time: 0:25:41.546190,used: 3:53:00.605286,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9856804, 'precision': 0.90065247, 'recall': 0.86564994, 'specificity': 0.86564994, 'f1': 0.88228804, 'auroc': 0.9858091, 'binary_precision': 0.8102134, 'binary_recall': 0.7371706, 'binary_specificity': 0.9941293, 'binary_f1_score': 0.771968}
confusion matrix:
       0     1
0  42165   249
1    379  1063
---- Validation: 
scalar performance:
{'acc': 0.9821238, 'precision': 0.9000529, 'recall': 0.8233564, 'specificity': 0.8233564, 'f1': 0.8572941, 'auroc': 0.9774906, 'binary_precision': 0.81296295, 'binary_recall': 0.6523031, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.7238252}
confusion matrix:
       0    1
0  17966  101
1    234  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.72063607, 'recall': 0.56043434, 'specificity': 0.56043434, 'f1': 0.5894209, 'auroc': 0.95619214, 'binary_precision': 0.47826087, 'binary_recall': 0.12692308, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.20060791}
confusion matrix:
      0   1
0  5910  36
1   227  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_10.png
better model found
persisted
after epoch: 10,now: 2024-06-06 16:03:25.569879,epoch time: 0:25:41.466815,used: 4:18:42.072101,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9859312, 'precision': 0.9033857, 'recall': 0.86678445, 'specificity': 0.86678445, 'f1': 0.8841464, 'auroc': 0.9844808, 'binary_precision': 0.81560826, 'binary_recall': 0.739251, 'binary_specificity': 0.9943179, 'binary_f1_score': 0.7755548}
confusion matrix:
       0     1
0  42173   241
1    376  1066
---- Validation: 
scalar performance:
{'acc': 0.98191035, 'precision': 0.879269, 'recall': 0.85042584, 'specificity': 0.85042584, 'f1': 0.8642255, 'auroc': 0.97612596, 'binary_precision': 0.7693548, 'binary_recall': 0.7087667, 'binary_specificity': 0.99208504, 'binary_f1_score': 0.737819}
confusion matrix:
       0    1
0  17924  143
1    196  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.75984496, 'recall': 0.5742322, 'specificity': 0.5742322, 'f1': 0.61005145, 'auroc': 0.9607247, 'binary_precision': 0.5555556, 'binary_recall': 0.15384616, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.24096388}
confusion matrix:
      0   1
0  5914  32
1   220  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_11.png
early stop counter: 1
val acc:0.9819103479385376, best validation acc: 0.9821237921714783, corresponding to test acc:                         0.9576216340065002 / 0.9745407700538635
after epoch: 11,now: 2024-06-06 16:29:17.298505,epoch time: 0:25:51.728626,used: 4:44:33.800727,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98536116, 'precision': 0.9006046, 'recall': 0.85912085, 'specificity': 0.85912085, 'f1': 0.8786403, 'auroc': 0.9866132, 'binary_precision': 0.81055903, 'binary_recall': 0.72399443, 'binary_specificity': 0.9942472, 'binary_f1_score': 0.7648351}
confusion matrix:
       0     1
0  42170   244
1    398  1044
---- Validation: 
scalar performance:
{'acc': 0.9803095, 'precision': 0.8858547, 'recall': 0.80739486, 'specificity': 0.80739486, 'f1': 0.8418018, 'auroc': 0.9775373, 'binary_precision': 0.78571427, 'binary_recall': 0.62109953, 'binary_specificity': 0.99369013, 'binary_f1_score': 0.6937759}
confusion matrix:
       0    1
0  17953  114
1    255  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.77483296, 'recall': 0.6192088, 'specificity': 0.6192088, 'f1': 0.6629248, 'auroc': 0.95706797, 'binary_precision': 0.58181816, 'binary_recall': 0.24615385, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.34594592}
confusion matrix:
      0   1
0  5900  46
1   196  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_12.png
early stop counter: 2
val acc:0.9803094863891602, best validation acc: 0.9821237921714783, corresponding to test acc:                         0.9576216340065002 / 0.9745407700538635
after epoch: 12,now: 2024-06-06 16:55:02.813102,epoch time: 0:25:45.514597,used: 5:10:19.315324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98634166, 'precision': 0.9313334, 'recall': 0.84020054, 'specificity': 0.84020054, 'f1': 0.8799907, 'auroc': 0.98800176, 'binary_precision': 0.87333924, 'binary_recall': 0.68377256, 'binary_specificity': 0.99662846, 'binary_f1_score': 0.76701677}
confusion matrix:
       0    1
0  42271  143
1    456  986
---- Validation: 
scalar performance:
{'acc': 0.9832444, 'precision': 0.92817676, 'recall': 0.81177807, 'specificity': 0.81177807, 'f1': 0.86009896, 'auroc': 0.97745574, 'binary_precision': 0.8701031, 'binary_recall': 0.62704307, 'binary_specificity': 0.996513, 'binary_f1_score': 0.72884285}
confusion matrix:
       0    1
0  18004   63
1    251  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.87359524, 'recall': 0.5418031, 'specificity': 0.5418031, 'f1': 0.5663262, 'auroc': 0.957526, 'binary_precision': 0.78571427, 'binary_recall': 0.08461539, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.15277779}
confusion matrix:
      0   1
0  5940   6
1   238  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_13.png
better model found
persisted
after epoch: 13,now: 2024-06-06 17:20:53.054655,epoch time: 0:25:50.241553,used: 5:36:09.556877,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98483676, 'precision': 0.86654985, 'recall': 0.91177213, 'specificity': 0.91177213, 'f1': 0.88773024, 'auroc': 0.9860361, 'binary_precision': 0.73878306, 'binary_recall': 0.8335645, 'binary_specificity': 0.98997974, 'binary_f1_score': 0.783317}
confusion matrix:
       0     1
0  41989   425
1    240  1202
---- Validation: 
scalar performance:
{'acc': 0.98372465, 'precision': 0.88700557, 'recall': 0.87425536, 'specificity': 0.87425536, 'f1': 0.8805139, 'auroc': 0.97825676, 'binary_precision': 0.78307694, 'binary_recall': 0.756315, 'binary_specificity': 0.9921957, 'binary_f1_score': 0.76946336}
confusion matrix:
       0    1
0  17926  141
1    164  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7596333, 'recall': 0.5853502, 'specificity': 0.5853502, 'f1': 0.62371224, 'auroc': 0.9512112, 'binary_precision': 0.55421686, 'binary_recall': 0.17692308, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.26822156}
confusion matrix:
      0   1
0  5909  37
1   214  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_14.png
better model found
persisted
after epoch: 14,now: 2024-06-06 17:46:45.236142,epoch time: 0:25:52.181487,used: 6:02:01.738364,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98618203, 'precision': 0.87889135, 'recall': 0.91581714, 'specificity': 0.91581714, 'f1': 0.8964219, 'auroc': 0.9866986, 'binary_precision': 0.7632242, 'binary_recall': 0.8404993, 'binary_specificity': 0.991135, 'binary_f1_score': 0.79999995}
confusion matrix:
       0     1
0  42038   376
1    230  1212
---- Validation: 
scalar performance:
{'acc': 0.98441833, 'precision': 0.89071906, 'recall': 0.8817678, 'specificity': 0.8817678, 'f1': 0.88618684, 'auroc': 0.98037875, 'binary_precision': 0.78995436, 'binary_recall': 0.77117383, 'binary_specificity': 0.9923618, 'binary_f1_score': 0.7804512}
confusion matrix:
       0    1
0  17929  138
1    154  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.80222595, 'recall': 0.65557903, 'specificity': 0.65557903, 'f1': 0.7029176, 'auroc': 0.9576846, 'binary_precision': 0.6335878, 'binary_recall': 0.31923077, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.42455244}
confusion matrix:
      0   1
0  5898  48
1   177  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_15.png
better model found
persisted
after epoch: 15,now: 2024-06-06 18:12:15.959796,epoch time: 0:25:30.723654,used: 6:27:32.462018,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9875958, 'precision': 0.901466, 'recall': 0.9041548, 'specificity': 0.9041548, 'f1': 0.90280557, 'auroc': 0.98946977, 'binary_precision': 0.80922866, 'binary_recall': 0.8148405, 'binary_specificity': 0.9934691, 'binary_f1_score': 0.8120249}
confusion matrix:
       0     1
0  42137   277
1    267  1175
---- Validation: 
scalar performance:
{'acc': 0.98372465, 'precision': 0.88382256, 'recall': 0.87997746, 'specificity': 0.87997746, 'f1': 0.88188946, 'auroc': 0.98029184, 'binary_precision': 0.7762763, 'binary_recall': 0.76820207, 'binary_specificity': 0.9917529, 'binary_f1_score': 0.7722181}
confusion matrix:
       0    1
0  17918  149
1    156  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96777314, 'precision': 0.84252363, 'recall': 0.6907831, 'specificity': 0.6907831, 'f1': 0.7429174, 'auroc': 0.9641601, 'binary_precision': 0.7112676, 'binary_recall': 0.38846153, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.5024876}
confusion matrix:
      0    1
0  5905   41
1   159  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_16.png
early stop counter: 1
val acc:0.9837246537208557, best validation acc: 0.9844183325767517, corresponding to test acc:                         0.9637447595596313 / 0.9745407700538635
after epoch: 16,now: 2024-06-06 18:37:54.233143,epoch time: 0:25:38.273347,used: 6:53:10.735365,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98869026, 'precision': 0.90853965, 'recall': 0.91510415, 'specificity': 0.91510415, 'f1': 0.9117936, 'auroc': 0.9897977, 'binary_precision': 0.8226467, 'binary_recall': 0.8363384, 'binary_specificity': 0.99386996, 'binary_f1_score': 0.829436}
confusion matrix:
       0     1
0  42154   260
1    236  1206
---- Validation: 
scalar performance:
{'acc': 0.98431164, 'precision': 0.8814776, 'recall': 0.89673305, 'specificity': 0.89673305, 'f1': 0.88894176, 'auroc': 0.9810567, 'binary_precision': 0.7703281, 'binary_recall': 0.8023774, 'binary_specificity': 0.99108875, 'binary_f1_score': 0.7860262}
confusion matrix:
       0    1
0  17906  161
1    133  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.84153485, 'recall': 0.60960436, 'specificity': 0.60960436, 'f1': 0.6607681, 'auroc': 0.9603504, 'binary_precision': 0.7160494, 'binary_recall': 0.22307692, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.34017593}
confusion matrix:
      0   1
0  5923  23
1   202  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_17.png
early stop counter: 2
val acc:0.9843116402626038, best validation acc: 0.9844183325767517, corresponding to test acc:                         0.9637447595596313 / 0.9745407700538635
after epoch: 17,now: 2024-06-06 19:03:14.846513,epoch time: 0:25:20.613370,used: 7:18:31.348735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9882342, 'precision': 0.94897485, 'recall': 0.8562518, 'specificity': 0.8562518, 'f1': 0.89689195, 'auroc': 0.99035865, 'binary_precision': 0.9075704, 'binary_recall': 0.7149792, 'binary_specificity': 0.9975244, 'binary_f1_score': 0.79984486}
confusion matrix:
       0     1
0  42309   105
1    411  1031
---- Validation: 
scalar performance:
{'acc': 0.98527217, 'precision': 0.9374896, 'recall': 0.83643353, 'specificity': 0.83643353, 'f1': 0.8798402, 'auroc': 0.9812633, 'binary_precision': 0.8869396, 'binary_recall': 0.67607725, 'binary_specificity': 0.99678975, 'binary_f1_score': 0.7672849}
confusion matrix:
       0    1
0  18009   58
1    218  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.81827223, 'recall': 0.5809264, 'specificity': 0.5809264, 'f1': 0.6228715, 'auroc': 0.9612305, 'binary_precision': 0.671875, 'binary_recall': 0.16538462, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.2654321}
confusion matrix:
      0   1
0  5925  21
1   217  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_18.png
better model found
persisted
after epoch: 18,now: 2024-06-06 19:28:46.492255,epoch time: 0:25:31.645742,used: 7:44:02.994477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98907787, 'precision': 0.92898655, 'recall': 0.89353275, 'specificity': 0.89353275, 'f1': 0.9104368, 'auroc': 0.9913758, 'binary_precision': 0.8650493, 'binary_recall': 0.79126215, 'binary_specificity': 0.9958033, 'binary_f1_score': 0.82651216}
confusion matrix:
       0     1
0  42236   178
1    301  1141
---- Validation: 
scalar performance:
{'acc': 0.98415154, 'precision': 0.90617, 'recall': 0.85301876, 'specificity': 0.85301876, 'f1': 0.87757397, 'auroc': 0.98012006, 'binary_precision': 0.82302403, 'binary_recall': 0.71173847, 'binary_specificity': 0.994299, 'binary_f1_score': 0.7633466}
confusion matrix:
       0    1
0  17964  103
1    194  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.8036946, 'recall': 0.63877594, 'specificity': 0.63877594, 'f1': 0.6873369, 'auroc': 0.9630587, 'binary_precision': 0.63793105, 'binary_recall': 0.2846154, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.39361703}
confusion matrix:
      0   1
0  5904  42
1   186  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_19.png
early stop counter: 1
val acc:0.9841515421867371, best validation acc: 0.9852721691131592, corresponding to test acc:                         0.961650013923645 / 0.9745407700538635
after epoch: 19,now: 2024-06-06 19:54:15.991674,epoch time: 0:25:29.499419,used: 8:09:32.493896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98882705, 'precision': 0.9223756, 'recall': 0.89742243, 'specificity': 0.89742243, 'f1': 0.90948963, 'auroc': 0.9915266, 'binary_precision': 0.85155094, 'binary_recall': 0.7995839, 'binary_specificity': 0.995261, 'binary_f1_score': 0.82474965}
confusion matrix:
       0     1
0  42213   201
1    289  1153
---- Validation: 
scalar performance:
{'acc': 0.9845251, 'precision': 0.9058541, 'recall': 0.86036515, 'specificity': 0.86036515, 'f1': 0.88164246, 'auroc': 0.9796721, 'binary_precision': 0.82184875, 'binary_recall': 0.7265973, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.77129334}
confusion matrix:
       0    1
0  17961  106
1    184  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668063, 'precision': 0.8448131, 'recall': 0.6682107, 'specificity': 0.6682107, 'f1': 0.7232075, 'auroc': 0.9619586, 'binary_precision': 0.7177419, 'binary_recall': 0.3423077, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.4635417}
confusion matrix:
      0   1
0  5911  35
1   171  89
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_20.png
early stop counter: 2
val acc:0.9845250844955444, best validation acc: 0.9852721691131592, corresponding to test acc:                         0.961650013923645 / 0.9745407700538635
after epoch: 20,now: 2024-06-06 20:19:48.745004,epoch time: 0:25:32.753330,used: 8:35:05.247226,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9864557, 'precision': 0.8683176, 'recall': 0.94811404, 'specificity': 0.94811404, 'f1': 0.9039619, 'auroc': 0.9927131, 'binary_precision': 0.739819, 'binary_recall': 0.9070735, 'binary_specificity': 0.9891545, 'binary_f1_score': 0.81495327}
confusion matrix:
       0     1
0  41954   460
1    134  1308
---- Validation: 
scalar performance:
{'acc': 0.98217714, 'precision': 0.8493115, 'recall': 0.92852837, 'specificity': 0.92852837, 'f1': 0.88446796, 'auroc': 0.9833498, 'binary_precision': 0.7034814, 'binary_recall': 0.8707281, 'binary_specificity': 0.98632866, 'binary_f1_score': 0.7782204}
confusion matrix:
       0    1
0  17820  247
1     87  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9666452, 'precision': 0.8054292, 'recall': 0.7361691, 'specificity': 0.7361691, 'f1': 0.7658509, 'auroc': 0.9607302, 'binary_precision': 0.63316584, 'binary_recall': 0.4846154, 'binary_specificity': 0.9877228, 'binary_f1_score': 0.54901963}
confusion matrix:
      0    1
0  5873   73
1   134  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_21.png
early stop counter: 3
val acc:0.9821771383285522, best validation acc: 0.9852721691131592, corresponding to test acc:                         0.961650013923645 / 0.9745407700538635
after epoch: 21,now: 2024-06-06 20:45:11.702551,epoch time: 0:25:22.957547,used: 9:00:28.204773,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9880062, 'precision': 0.9327286, 'recall': 0.869197, 'specificity': 0.869197, 'f1': 0.898258, 'auroc': 0.9932338, 'binary_precision': 0.874183, 'binary_recall': 0.74202496, 'binary_specificity': 0.9963691, 'binary_f1_score': 0.8027007}
confusion matrix:
       0     1
0  42260   154
1    372  1070
---- Validation: 
scalar performance:
{'acc': 0.98404485, 'precision': 0.90905464, 'recall': 0.8472413, 'specificity': 0.8472413, 'f1': 0.8754072, 'auroc': 0.97883356, 'binary_precision': 0.82922536, 'binary_recall': 0.6998514, 'binary_specificity': 0.9946311, 'binary_f1_score': 0.7590653}
confusion matrix:
       0    1
0  17970   97
1    202  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.8067137, 'recall': 0.6163717, 'specificity': 0.6163717, 'f1': 0.6645356, 'auroc': 0.9485365, 'binary_precision': 0.6458333, 'binary_recall': 0.23846154, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.3483146}
confusion matrix:
      0   1
0  5912  34
1   198  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_22.png
early stop counter: 4
val acc:0.9840448498725891, best validation acc: 0.9852721691131592, corresponding to test acc:                         0.961650013923645 / 0.9745407700538635
after epoch: 22,now: 2024-06-06 21:10:29.981604,epoch time: 0:25:18.279053,used: 9:25:46.483826,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9905828, 'precision': 0.9477516, 'recall': 0.89866513, 'specificity': 0.89866513, 'f1': 0.9216791, 'auroc': 0.993358, 'binary_precision': 0.9022674, 'binary_recall': 0.8002774, 'binary_specificity': 0.99705285, 'binary_f1_score': 0.84821755}
confusion matrix:
       0     1
0  42289   125
1    288  1154
---- Validation: 
scalar performance:
{'acc': 0.98628604, 'precision': 0.931265, 'recall': 0.8598479, 'specificity': 0.8598479, 'f1': 0.8920684, 'auroc': 0.981369, 'binary_precision': 0.8727599, 'binary_recall': 0.72362554, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.7912266}
confusion matrix:
       0    1
0  17996   71
1    186  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.79101205, 'recall': 0.60474914, 'specificity': 0.60474914, 'f1': 0.6496362, 'auroc': 0.9509815, 'binary_precision': 0.61538464, 'binary_recall': 0.21538462, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.31908834}
confusion matrix:
      0   1
0  5911  35
1   204  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_23.png
better model found
persisted
after epoch: 23,now: 2024-06-06 21:35:46.452992,epoch time: 0:25:16.471388,used: 9:51:02.955214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99044603, 'precision': 0.9254761, 'recall': 0.92405075, 'specificity': 0.92405075, 'f1': 0.92476207, 'auroc': 0.99427783, 'binary_precision': 0.8559499, 'binary_recall': 0.852982, 'binary_specificity': 0.9951195, 'binary_f1_score': 0.8544633}
confusion matrix:
       0     1
0  42207   207
1    212  1230
---- Validation: 
scalar performance:
{'acc': 0.9845251, 'precision': 0.8944907, 'recall': 0.8775315, 'specificity': 0.8775315, 'f1': 0.8858081, 'auroc': 0.976181, 'binary_precision': 0.7978227, 'binary_recall': 0.7622585, 'binary_specificity': 0.9928046, 'binary_f1_score': 0.77963525}
confusion matrix:
       0    1
0  17937  130
1    160  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.78064966, 'recall': 0.6119369, 'specificity': 0.6119369, 'f1': 0.65620583, 'auroc': 0.9561682, 'binary_precision': 0.5940594, 'binary_recall': 0.23076923, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.33240998}
confusion matrix:
      0   1
0  5905  41
1   200  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_24.png
early stop counter: 1
val acc:0.9845250844955444, best validation acc: 0.9862860441207886, corresponding to test acc:                         0.9614889025688171 / 0.9745407700538635
after epoch: 24,now: 2024-06-06 22:01:09.728062,epoch time: 0:25:23.275070,used: 10:16:26.230284,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9912897, 'precision': 0.96264315, 'recall': 0.8953461, 'specificity': 0.8953461, 'f1': 0.92616487, 'auroc': 0.9940766, 'binary_precision': 0.93230015, 'binary_recall': 0.7926491, 'binary_specificity': 0.9980431, 'binary_f1_score': 0.85682154}
confusion matrix:
       0     1
0  42331    83
1    299  1143
---- Validation: 
scalar performance:
{'acc': 0.9860726, 'precision': 0.9346517, 'recall': 0.8525845, 'specificity': 0.8525845, 'f1': 0.8889941, 'auroc': 0.98233354, 'binary_precision': 0.8800738, 'binary_recall': 0.7087667, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.7851852}
confusion matrix:
       0    1
0  18002   65
1    196  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.8067838, 'recall': 0.6032465, 'specificity': 0.6032465, 'f1': 0.649683, 'auroc': 0.9606569, 'binary_precision': 0.64705884, 'binary_recall': 0.21153846, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.3188406}
confusion matrix:
      0   1
0  5916  30
1   205  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_25.png
early stop counter: 2
val acc:0.9860725998878479, best validation acc: 0.9862860441207886, corresponding to test acc:                         0.9614889025688171 / 0.9745407700538635
after epoch: 25,now: 2024-06-06 22:26:28.599737,epoch time: 0:25:18.871675,used: 10:41:45.101959,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9892375, 'precision': 0.92455006, 'recall': 0.90232396, 'specificity': 0.90232396, 'f1': 0.91311496, 'auroc': 0.9942607, 'binary_precision': 0.85557187, 'binary_recall': 0.8092927, 'binary_specificity': 0.9953553, 'binary_f1_score': 0.831789}
confusion matrix:
       0     1
0  42217   197
1    275  1167
---- Validation: 
scalar performance:
{'acc': 0.98553896, 'precision': 0.9285971, 'recall': 0.8501619, 'specificity': 0.8501619, 'f1': 0.8851065, 'auroc': 0.9809717, 'binary_precision': 0.8681319, 'binary_recall': 0.70430905, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.77768666}
confusion matrix:
       0    1
0  17995   72
1    199  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8001996, 'recall': 0.5881142, 'specificity': 0.5881142, 'f1': 0.63078314, 'auroc': 0.9497587, 'binary_precision': 0.6351351, 'binary_recall': 0.18076923, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.28143713}
confusion matrix:
      0   1
0  5919  27
1   213  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_26.png
early stop counter: 3
val acc:0.9855389595031738, best validation acc: 0.9862860441207886, corresponding to test acc:                         0.9614889025688171 / 0.9745407700538635
after epoch: 26,now: 2024-06-06 22:51:45.445631,epoch time: 0:25:16.845894,used: 11:07:01.947853,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9858172, 'precision': 0.8864889, 'recall': 0.8921819, 'specificity': 0.8921819, 'f1': 0.88931286, 'auroc': 0.99257076, 'binary_precision': 0.7800546, 'binary_recall': 0.7919556, 'binary_specificity': 0.99240816, 'binary_f1_score': 0.7859601}
confusion matrix:
       0     1
0  42092   322
1    300  1142
---- Validation: 
scalar performance:
{'acc': 0.97982925, 'precision': 0.8600598, 'recall': 0.8414786, 'specificity': 0.8414786, 'f1': 0.85049987, 'auroc': 0.97468746, 'binary_precision': 0.73155415, 'binary_recall': 0.692422, 'binary_specificity': 0.99053526, 'binary_f1_score': 0.71145034}
confusion matrix:
       0    1
0  17896  171
1    207  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.80513406, 'recall': 0.6687883, 'specificity': 0.6687883, 'f1': 0.715239, 'auroc': 0.9559841, 'binary_precision': 0.63829786, 'binary_recall': 0.34615386, 'binary_specificity': 0.99142283, 'binary_f1_score': 0.4488778}
confusion matrix:
      0   1
0  5895  51
1   170  90
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_27.png
early stop counter: 4
val acc:0.9798292517662048, best validation acc: 0.9862860441207886, corresponding to test acc:                         0.9614889025688171 / 0.9745407700538635
after epoch: 27,now: 2024-06-06 23:17:14.594471,epoch time: 0:25:29.148840,used: 11:32:31.096693,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9920421, 'precision': 0.9360664, 'recall': 0.93927884, 'specificity': 0.93927884, 'f1': 0.9376663, 'auroc': 0.99516815, 'binary_precision': 0.87611836, 'binary_recall': 0.88280165, 'binary_specificity': 0.9957561, 'binary_f1_score': 0.87944734}
confusion matrix:
       0     1
0  42234   180
1    169  1273
---- Validation: 
scalar performance:
{'acc': 0.98655283, 'precision': 0.91529024, 'recall': 0.88430536, 'specificity': 0.88430536, 'f1': 0.8991455, 'auroc': 0.98192453, 'binary_precision': 0.8389694, 'binary_recall': 0.7741456, 'binary_specificity': 0.99446505, 'binary_f1_score': 0.80525494}
confusion matrix:
       0    1
0  17967  100
1    152  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.8608034, 'recall': 0.6326813, 'specificity': 0.6326813, 'f1': 0.68946874, 'auroc': 0.9667208, 'binary_precision': 0.75268817, 'binary_recall': 0.26923078, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.39660054}
confusion matrix:
      0   1
0  5923  23
1   190  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_28.png
better model found
persisted
after epoch: 28,now: 2024-06-06 23:42:40.048939,epoch time: 0:25:25.454468,used: 11:57:56.551161,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99065125, 'precision': 0.96948373, 'recall': 0.8782684, 'specificity': 0.8782684, 'f1': 0.9186239, 'auroc': 0.9960606, 'binary_precision': 0.9471404, 'binary_recall': 0.75797504, 'binary_specificity': 0.9985618, 'binary_f1_score': 0.84206474}
confusion matrix:
       0     1
0  42353    61
1    349  1093
---- Validation: 
scalar performance:
{'acc': 0.9864995, 'precision': 0.9434002, 'recall': 0.8506601, 'specificity': 0.8506601, 'f1': 0.8911843, 'auroc': 0.9817977, 'binary_precision': 0.89772725, 'binary_recall': 0.70430905, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.7893422}
confusion matrix:
       0    1
0  18013   54
1    199  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.84080833, 'recall': 0.6133665, 'specificity': 0.6133665, 'f1': 0.6651379, 'auroc': 0.95497334, 'binary_precision': 0.71428573, 'binary_recall': 0.23076923, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.34883723}
confusion matrix:
      0   1
0  5922  24
1   200  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_29.png
early stop counter: 1
val acc:0.9864994883537292, best validation acc: 0.9865528345108032, corresponding to test acc:                         0.9656783938407898 / 0.9745407700538635
after epoch: 29,now: 2024-06-07 00:08:06.335260,epoch time: 0:25:26.286321,used: 12:23:22.837482,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9918369, 'precision': 0.93075013, 'recall': 0.94285727, 'specificity': 0.94285727, 'f1': 0.93671316, 'auroc': 0.9959598, 'binary_precision': 0.8652291, 'binary_recall': 0.89043, 'binary_specificity': 0.99528456, 'binary_f1_score': 0.8776487}
confusion matrix:
       0     1
0  42214   200
1    158  1284
---- Validation: 
scalar performance:
{'acc': 0.9866062, 'precision': 0.9071182, 'recall': 0.89720786, 'specificity': 0.89720786, 'f1': 0.9020965, 'auroc': 0.97782767, 'binary_precision': 0.82164633, 'binary_recall': 0.8008915, 'binary_specificity': 0.99352413, 'binary_f1_score': 0.8111362}
confusion matrix:
       0    1
0  17950  117
1    134  539
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.8553132, 'recall': 0.60985667, 'specificity': 0.60985667, 'f1': 0.6624043, 'auroc': 0.957744, 'binary_precision': 0.74358976, 'binary_recall': 0.22307692, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.34319526}
confusion matrix:
      0   1
0  5926  20
1   202  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127988_30.png
better model found
persisted
after epoch: 30,now: 2024-06-07 00:33:29.432133,epoch time: 0:25:23.096873,used: 12:48:45.934355,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_44_43_seed_1_21127988
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:48:45.934355 at 2024-06-07 00:33:29.432133
persisted model performance metric: 

scalar performance:
{'acc': 0.9656784, 'precision': 0.8756427, 'recall': 0.6234864, 'specificity': 0.6234864, 'f1': 0.6806801, 'auroc': 0.95486057, 'binary_precision': 0.78313255, 'binary_recall': 0.25, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.37900874}
confusion matrix:
      0   1
0  5928  18
1   195  65
oracle model performance metric: 

scalar performance:
{'acc': 0.9722849, 'precision': 0.8700216, 'recall': 0.7427902, 'specificity': 0.7427902, 'f1': 0.7918892, 'auroc': 0.953205, 'binary_precision': 0.7619048, 'binary_recall': 0.4923077, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.5981308}
confusion matrix:
      0    1
0  5906   40
1   132  128
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456207 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456207 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  13213 MiB |   2244 TiB |   2244 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   2217 TiB |   2217 TiB |
|       from small pool |  40676 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14486 MiB |  28078 MiB |  13604 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  27992 MiB |  13584 MiB |
|       from small pool |     66 MiB |     72 MiB |     86 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446961 KiB |   1251 MiB |   1605 TiB |   1605 TiB |
|       from large pool | 435388 KiB |   1244 MiB |   1578 TiB |   1578 TiB |
|       from small pool |  11572 KiB |     43 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    6487    |  395837 K  |  395833 K  |
|       from large pool |     187    |    1413    |  205461 K  |  205461 K  |
|       from small pool |    3277    |    6298    |  190375 K  |  190372 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    6487    |  395837 K  |  395833 K  |
|       from large pool |     187    |    1413    |  205461 K  |  205461 K  |
|       from small pool |    3277    |    6298    |  190375 K  |  190372 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     637    |    1208    |     574    |
|       from large pool |     601    |     601    |    1165    |     564    |
|       from small pool |      33    |      36    |      43    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      87    |    2810    |  248043 K  |  248043 K  |
|       from large pool |      40    |     604    |  149049 K  |  149049 K  |
|       from small pool |      47    |    2768    |   98993 K  |   98993 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2244 TiB |   2244 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2217 TiB |   2217 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14486 MiB |  28078 MiB |  27196 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     72 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1605 TiB |   1605 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   1578 TiB |   1578 TiB |
|       from small pool |      0 KiB |     43 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395837 K  |  395837 K  |
|       from large pool |       2    |    1413    |  205461 K  |  205461 K  |
|       from small pool |       0    |    6298    |  190375 K  |  190375 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395837 K  |  395837 K  |
|       from large pool |       2    |    1413    |  205461 K  |  205461 K  |
|       from small pool |       0    |    6298    |  190375 K  |  190375 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1208    |    1145    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      36    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2810    |  248044 K  |  248044 K  |
|       from large pool |       4    |     604    |  149049 K  |  149049 K  |
|       from small pool |       0    |    2768    |   98994 K  |   98994 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2244 TiB |   2244 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2217 TiB |   2217 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14486 MiB |  28078 MiB |  27196 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     72 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1605 TiB |   1605 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   1578 TiB |   1578 TiB |
|       from small pool |      0 KiB |     43 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395837 K  |  395837 K  |
|       from large pool |       2    |    1413    |  205461 K  |  205461 K  |
|       from small pool |       0    |    6298    |  190375 K  |  190375 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395837 K  |  395837 K  |
|       from large pool |       2    |    1413    |  205461 K  |  205461 K  |
|       from small pool |       0    |    6298    |  190375 K  |  190375 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1208    |    1145    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      36    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2810    |  248044 K  |  248044 K  |
|       from large pool |       4    |     604    |  149049 K  |  149049 K  |
|       from small pool |       0    |    2768    |   98994 K  |   98994 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


patient_073_node_1_0:   0%|          | 0/95 [00:00<?, ?it/s][A
patient_073_node_1_0:  21%|██        | 20/95 [00:00<00:00, 190.10it/s][A
patient_073_node_1_0:  42%|████▏     | 40/95 [00:00<00:00, 156.27it/s][A
                                                                      [A[Fri Jun  7 00:36:09 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/3.csv

RuleException:
FileNotFoundError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[Errno 2] No such file or directory: '/ictstr01/groups/aih/sina.wendrich/MA_code/output_CAMELYON17/patches/8/128/patient_073_node_1/patient_073_node_1_patch_0_1152_15488_/lustre/groups/shared/histology_data/CAMELYON17/slides/center3_0.png'
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 168, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 30, in __init__
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/tasks/zoo_tasks.py", line 36, in __call__
  File "/lustre/groups/aih/sina.wendrich/MA_code/MA_thesis/tasks/task_CAMELYON17.py", line 151, in get_task
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/tasks/patches_processing.py", line 424, in process_slides
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/_base.py", line 451, in result
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/tasks/patches_processing.py", line 463, in process_row_annotations
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/PIL/Image.py", line 2456, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
