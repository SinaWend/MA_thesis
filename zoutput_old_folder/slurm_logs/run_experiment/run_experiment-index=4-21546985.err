Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun 22 10:08:35 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985

 Experiment start at: 2024-06-22 10:16:31.382406
before training, model accuracy: 0.3101629912853241
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90494436, 'precision': 0.5615066, 'recall': 0.50070703, 'specificity': 0.50070703, 'f1': 0.47728628, 'auroc': 0.46862763, 'binary_precision': 0.2173913, 'binary_recall': 0.0022650056, 'binary_specificity': 0.999149, 'binary_f1_score': 0.0044833}
confusion matrix:
       0   1
0  42269  36
1   4405  10
---- Validation: 
scalar performance:
{'acc': 0.9627501, 'precision': 0.4828396, 'recall': 0.49842966, 'specificity': 0.49842966, 'f1': 0.4905108, 'auroc': 0.34930536, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18092  57
1    643   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9477469, 'precision': 0.48635134, 'recall': 0.4963296, 'specificity': 0.4963296, 'f1': 0.48962358, 'auroc': 0.34386975, 'binary_precision': 0.014705882, 'binary_recall': 0.0038314175, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.0060790274}
confusion matrix:
      0   1
0  5930  67
1   260   1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 10:26:37.483042,epoch time: 0:10:06.100636,used: 0:10:06.100636,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9055008, 'precision': 0.4527504, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520357, 'auroc': 0.5136591, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42305  0
1   4415  0
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.48289075, 'recall': 0.49997246, 'specificity': 0.49997246, 'f1': 0.4912832, 'auroc': 0.3308627, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18148  1
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.2800902, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-22 10:36:04.128262,epoch time: 0:09:26.645220,used: 0:19:32.745856,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9055865, 'precision': 0.45279324, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47522718, 'auroc': 0.51378715, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4411  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.33382702, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.2947604, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_3.png
better model found
persisted
after epoch: 3,now: 2024-06-22 10:45:31.325504,epoch time: 0:09:27.197242,used: 0:28:59.943098,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9056079, 'precision': 0.45280394, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47523305, 'auroc': 0.58008957, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42310  0
1   4410  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.348251, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.29197264, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_4.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-22 10:54:50.169615,epoch time: 0:09:18.844111,used: 0:38:18.787209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9055008, 'precision': 0.45276013, 'recall': 0.49998817, 'specificity': 0.49998817, 'f1': 0.4752036, 'auroc': 0.6457887, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42305  1
1   4414  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.35682338, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.332789, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_5.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 5,now: 2024-06-22 11:04:09.141209,epoch time: 0:09:18.971594,used: 0:47:37.758803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9055865, 'precision': 0.45279324, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47522718, 'auroc': 0.70037, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4411  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.37929147, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.3677132, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_6.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 6,now: 2024-06-22 11:13:28.160380,epoch time: 0:09:19.019171,used: 0:56:56.777974,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9055865, 'precision': 0.45279324, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47522718, 'auroc': 0.743013, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4411  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.35817656, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.2797205, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_7.png
early stop counter: 4
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 7,now: 2024-06-22 11:22:56.177571,epoch time: 0:09:28.017191,used: 1:06:24.795165,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.90543664, 'precision': 0.45277646, 'recall': 0.4999291, 'specificity': 0.4999291, 'f1': 0.47518593, 'auroc': 0.7833208, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42302  6
1   4412  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.39137325, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.40417224, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_8.png
early stop counter: 5
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 8,now: 2024-06-22 11:32:30.809352,epoch time: 0:09:34.631781,used: 1:15:59.426946,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9056507, 'precision': 0.45282534, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47524488, 'auroc': 0.8167287, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42312  0
1   4408  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.4216745, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.45004433, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_9.png
early stop counter: 6
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 9,now: 2024-06-22 11:41:56.310344,epoch time: 0:09:25.500992,used: 1:25:24.927938,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.905244, 'precision': 0.45274797, 'recall': 0.49984637, 'specificity': 0.49984637, 'f1': 0.47513285, 'auroc': 0.8416188, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99969274, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42293  13
1   4414   0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.4352666, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.47941276, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_10.png
early stop counter: 7
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 10,now: 2024-06-22 11:51:20.130524,epoch time: 0:09:23.820180,used: 1:34:48.748118,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9056507, 'precision': 0.45282534, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47524488, 'auroc': 0.8579253, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42312  0
1   4408  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.41142705, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.41768396, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_11.png
early stop counter: 8
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 11,now: 2024-06-22 12:00:55.369233,epoch time: 0:09:35.238709,used: 1:44:23.986827,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9056293, 'precision': 0.9528096, 'recall': 0.50056636, 'specificity': 0.50056636, 'f1': 0.47636768, 'auroc': 0.883181, 'binary_precision': 1.0, 'binary_recall': 0.0011327594, 'binary_specificity': 1.0, 'binary_f1_score': 0.0022629555}
confusion matrix:
       0  1
0  42306  0
1   4409  5
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.4439242, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.45371234, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_12.png
early stop counter: 9
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 12,now: 2024-06-22 12:10:18.156613,epoch time: 0:09:22.787380,used: 1:53:46.774207,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9055008, 'precision': 0.69094217, 'recall': 0.5010028, 'specificity': 0.5010028, 'f1': 0.47745278, 'auroc': 0.8954416, 'binary_precision': 0.47619048, 'binary_recall': 0.0022655188, 'binary_specificity': 0.99974, 'binary_f1_score': 0.0045095826}
confusion matrix:
       0   1
0  42295  11
1   4404  10
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.4598821, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.5275537, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_13.png
early stop counter: 10
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 13,now: 2024-06-22 12:19:42.659505,epoch time: 0:09:24.502892,used: 2:03:11.277099,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.90646404, 'precision': 0.9415717, 'recall': 0.504749, 'specificity': 0.504749, 'f1': 0.4848753, 'auroc': 0.90696216, 'binary_precision': 0.9767442, 'binary_recall': 0.00952165, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.018859452}
confusion matrix:
       0   1
0  42308   1
1   4369  42
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.48135325, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.54282, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_14.png
early stop counter: 11
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 14,now: 2024-06-22 12:29:10.472902,epoch time: 0:09:27.813397,used: 2:12:39.090496,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9072346, 'precision': 0.9473746, 'recall': 0.5090523, 'specificity': 0.5090523, 'f1': 0.49343842, 'auroc': 0.89909863, 'binary_precision': 0.9876543, 'binary_recall': 0.018128257, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.035603024}
confusion matrix:
       0   1
0  42306   1
1   4333  80
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.47209048, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.49647748, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_15.png
early stop counter: 12
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 15,now: 2024-06-22 12:39:30.482363,epoch time: 0:10:20.009461,used: 2:22:59.099957,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.909482, 'precision': 0.95456207, 'recall': 0.5208475, 'specificity': 0.5208475, 'f1': 0.5162257, 'auroc': 0.91879594, 'binary_precision': 1.0, 'binary_recall': 0.04169499, 'binary_specificity': 1.0, 'binary_f1_score': 0.080052204}
confusion matrix:
       0    1
0  42307    0
1   4229  184
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.51192653, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.55830294, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_16.png
early stop counter: 13
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 16,now: 2024-06-22 12:49:03.313599,epoch time: 0:09:32.831236,used: 2:32:31.931193,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9125214, 'precision': 0.95443416, 'recall': 0.5369329, 'specificity': 0.5369329, 'f1': 0.5457528, 'auroc': 0.91883934, 'binary_precision': 0.9969419, 'binary_recall': 0.07388939, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.13758177}
confusion matrix:
       0    1
0  42307    1
1   4086  326
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.48289382, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.525432, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_17.png
early stop counter: 14
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 17,now: 2024-06-22 12:58:24.801379,epoch time: 0:09:21.487780,used: 2:41:53.418973,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.914619, 'precision': 0.95006156, 'recall': 0.54844415, 'specificity': 0.54844415, 'f1': 0.565826, 'auroc': 0.9209312, 'binary_precision': 0.9861751, 'binary_recall': 0.097030155, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.176677}
confusion matrix:
       0    1
0  42303    6
1   3983  428
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.5016062, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.5537609, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_18.png
early stop counter: 15
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 18,now: 2024-06-22 13:07:57.949244,epoch time: 0:09:33.147865,used: 2:51:26.566838,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9182363, 'precision': 0.9552916, 'recall': 0.5673978, 'specificity': 0.5673978, 'f1': 0.5971635, 'auroc': 0.9211221, 'binary_precision': 0.9933222, 'binary_recall': 0.13489005, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.23752496}
confusion matrix:
       0    1
0  42305    4
1   3816  595
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.4964056, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.5457393, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_19.png
early stop counter: 16
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 19,now: 2024-06-22 13:17:20.242128,epoch time: 0:09:22.292884,used: 3:00:48.859722,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9236301, 'precision': 0.91121507, 'recall': 0.60670006, 'specificity': 0.60670006, 'f1': 0.65381515, 'auroc': 0.9437419, 'binary_precision': 0.8982092, 'binary_recall': 0.21595287, 'binary_specificity': 0.99744725, 'binary_f1_score': 0.34819144}
confusion matrix:
       0    1
0  42199  108
1   3460  953
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.48288438, 'recall': 0.4997796, 'specificity': 0.4997796, 'f1': 0.49118674, 'auroc': 0.5761128, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18141  8
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.4791367, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.48922622, 'auroc': 0.67299294, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_20.png
early stop counter: 17
val acc:0.9653576016426086, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 20,now: 2024-06-22 13:26:44.133141,epoch time: 0:09:23.891013,used: 3:10:12.750735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9278895, 'precision': 0.9589674, 'recall': 0.6192002, 'specificity': 0.6192002, 'f1': 0.67317915, 'auroc': 0.9352837, 'binary_precision': 0.9915254, 'binary_recall': 0.23861319, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.38465756}
confusion matrix:
       0     1
0  42298     9
1   3360  1053
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.5619211, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.63071, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_21.png
early stop counter: 18
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 21,now: 2024-06-22 13:36:03.155110,epoch time: 0:09:19.021969,used: 3:19:31.772704,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9380779, 'precision': 0.96361315, 'recall': 0.6737131, 'specificity': 0.6737131, 'f1': 0.74088496, 'auroc': 0.9476725, 'binary_precision': 0.9909619, 'binary_recall': 0.34775713, 'binary_specificity': 0.9996691, 'binary_f1_score': 0.5148415}
confusion matrix:
       0     1
0  42292    14
1   2879  1535
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.57966936, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.47914, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.48926792, 'auroc': 0.6602575, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_22.png
early stop counter: 19
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 22,now: 2024-06-22 13:45:33.868210,epoch time: 0:09:30.713100,used: 3:29:02.485804,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9378211, 'precision': 0.9465117, 'recall': 0.6782671, 'specificity': 0.6782671, 'f1': 0.7439659, 'auroc': 0.9496963, 'binary_precision': 0.95586455, 'binary_recall': 0.35825968, 'binary_specificity': 0.9982745, 'binary_f1_score': 0.52118015}
confusion matrix:
       0     1
0  42234    73
1   2832  1581
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.48288983, 'recall': 0.4999449, 'specificity': 0.4999449, 'f1': 0.49126938, 'auroc': 0.5749039, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18147  2
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.4791267, 'recall': 0.49949974, 'specificity': 0.49949974, 'f1': 0.48910117, 'auroc': 0.65989256, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5991  6
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_23.png
early stop counter: 20
val acc:0.9656769037246704, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 23,now: 2024-06-22 13:55:09.181404,epoch time: 0:09:35.313194,used: 3:38:37.798998,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_10_16_31_seed_0_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 23 with time: 3:38:37.798998 at 2024-06-22 13:55:09.181404
persisted model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.2947604, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.2800902, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204391 KiB | 755277 KiB | 546469 GiB | 546469 GiB |
|       from large pool | 167936 KiB | 683136 KiB | 546335 GiB | 546335 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    133 GiB |    133 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204391 KiB | 755277 KiB | 546469 GiB | 546469 GiB |
|       from large pool | 167936 KiB | 683136 KiB | 546335 GiB | 546335 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    133 GiB |    133 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 748328 KiB | 546379 GiB | 546379 GiB |
|       from large pool | 165120 KiB | 676736 KiB | 546251 GiB | 546251 GiB |
|       from small pool |  35968 KiB |  72872 KiB |    127 GiB |    127 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    930 MiB |    930 MiB |    930 MiB |      0 B   |
|       from large pool |    858 MiB |    858 MiB |    858 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 104856 KiB | 245592 KiB | 219087 GiB | 219087 GiB |
|       from large pool |  96256 KiB | 244616 KiB | 218953 GiB | 218953 GiB |
|       from small pool |   8600 KiB |  12473 KiB |    134 GiB |    134 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2076    |    3669    |   34076 K  |   34073 K  |
|       from large pool |      36    |      76    |   13994 K  |   13994 K  |
|       from small pool |    2040    |    3632    |   20081 K  |   20079 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2076    |    3669    |   34076 K  |   34073 K  |
|       from large pool |      36    |      76    |   13994 K  |   13994 K  |
|       from small pool |    2040    |    3632    |   20081 K  |   20079 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      15    |      15    |      15    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    1476    |   14743 K  |   14743 K  |
|       from large pool |       5    |      10    |    4425 K  |    4425 K  |
|       from small pool |      29    |    1471    |   10318 K  |   10318 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755277 KiB | 546469 GiB | 546469 GiB |
|       from large pool |  16640 KiB | 683136 KiB | 546335 GiB | 546335 GiB |
|       from small pool |      0 KiB |  73422 KiB |    133 GiB |    133 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755277 KiB | 546469 GiB | 546469 GiB |
|       from large pool |  16640 KiB | 683136 KiB | 546335 GiB | 546335 GiB |
|       from small pool |      0 KiB |  73422 KiB |    133 GiB |    133 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB | 546379 GiB | 546379 GiB |
|       from large pool |  16640 KiB | 676736 KiB | 546251 GiB | 546251 GiB |
|       from small pool |      0 KiB |  72872 KiB |    127 GiB |    127 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    930 MiB |    930 MiB | 643072 KiB |
|       from large pool | 264192 KiB |    858 MiB |    858 MiB | 614400 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 245592 KiB | 219087 GiB | 219087 GiB |
|       from large pool |  83712 KiB | 244616 KiB | 218953 GiB | 218953 GiB |
|       from small pool |      0 KiB |  16195 KiB |    134 GiB |    134 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   34076 K  |   34076 K  |
|       from large pool |       2    |      76    |   13994 K  |   13994 K  |
|       from small pool |       0    |    3632    |   20081 K  |   20081 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   34076 K  |   34076 K  |
|       from large pool |       2    |      76    |   13994 K  |   13994 K  |
|       from small pool |       0    |    3632    |   20081 K  |   20081 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   14744 K  |   14744 K  |
|       from large pool |       1    |      11    |    4425 K  |    4425 K  |
|       from small pool |       0    |    1471    |   10319 K  |   10319 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755277 KiB | 546469 GiB | 546469 GiB |
|       from large pool |  16640 KiB | 683136 KiB | 546335 GiB | 546335 GiB |
|       from small pool |      0 KiB |  73422 KiB |    133 GiB |    133 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755277 KiB | 546469 GiB | 546469 GiB |
|       from large pool |  16640 KiB | 683136 KiB | 546335 GiB | 546335 GiB |
|       from small pool |      0 KiB |  73422 KiB |    133 GiB |    133 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB | 546379 GiB | 546379 GiB |
|       from large pool |  16640 KiB | 676736 KiB | 546251 GiB | 546251 GiB |
|       from small pool |      0 KiB |  72872 KiB |    127 GiB |    127 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    930 MiB |    930 MiB | 643072 KiB |
|       from large pool | 264192 KiB |    858 MiB |    858 MiB | 614400 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 245592 KiB | 219087 GiB | 219087 GiB |
|       from large pool |  83712 KiB | 244616 KiB | 218953 GiB | 218953 GiB |
|       from small pool |      0 KiB |  16195 KiB |    134 GiB |    134 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   34076 K  |   34076 K  |
|       from large pool |       2    |      76    |   13994 K  |   13994 K  |
|       from small pool |       0    |    3632    |   20081 K  |   20081 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   34076 K  |   34076 K  |
|       from large pool |       2    |      76    |   13994 K  |   13994 K  |
|       from small pool |       0    |    3632    |   20081 K  |   20081 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   14744 K  |   14744 K  |
|       from large pool |       1    |      11    |    4425 K  |    4425 K  |
|       from small pool |       0    |    1471    |   10319 K  |   10319 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985

 Experiment start at: 2024-06-22 14:00:17.858028
before training, model accuracy: 0.14647115767002106
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.887714, 'precision': 0.4602852, 'recall': 0.49058008, 'specificity': 0.49058008, 'f1': 0.47290385, 'auroc': 0.3944519, 'binary_precision': 0.014736842, 'binary_recall': 0.003237743, 'binary_specificity': 0.97792244, 'binary_f1_score': 0.0053090635}
confusion matrix:
       0    1
0  41460  936
1   4310   14
---- Validation: 
scalar performance:
{'acc': 0.84519744, 'precision': 0.48137683, 'recall': 0.44334748, 'specificity': 0.44334748, 'f1': 0.46043697, 'auroc': 0.28978443, 'binary_precision': 0.0031222124, 'binary_recall': 0.010401188, 'binary_specificity': 0.8762938, 'binary_f1_score': 0.0048027444}
confusion matrix:
       0     1
0  15832  2235
1    666     7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8509507, 'precision': 0.48146152, 'recall': 0.45511398, 'specificity': 0.45511398, 'f1': 0.4660984, 'auroc': 0.21817107, 'binary_precision': 0.0088626295, 'binary_recall': 0.023076924, 'binary_specificity': 0.887151, 'binary_f1_score': 0.012806831}
confusion matrix:
      0    1
0  5275  671
1   254    6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 14:10:34.547548,epoch time: 0:10:16.689520,used: 0:10:16.689520,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90719175, 'precision': 0.453693, 'recall': 0.49988207, 'specificity': 0.49988207, 'f1': 0.47566888, 'auroc': 0.41034365, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99976414, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42384  10
1   4326   0
---- Validation: 
scalar performance:
{'acc': 0.96221983, 'precision': 0.48201016, 'recall': 0.4990314, 'specificity': 0.4990314, 'f1': 0.4903731, 'auroc': 0.2911731, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18032  35
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95665485, 'precision': 0.47902212, 'recall': 0.4992432, 'specificity': 0.4992432, 'f1': 0.48892367, 'auroc': 0.21682936, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5937  9
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-22 14:20:48.511724,epoch time: 0:10:13.964176,used: 0:20:30.653696,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90712756, 'precision': 0.45370945, 'recall': 0.4998231, 'specificity': 0.4998231, 'f1': 0.47565123, 'auroc': 0.51769227, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996462, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42381  15
1   4324   0
---- Validation: 
scalar performance:
{'acc': 0.963127, 'precision': 0.4820265, 'recall': 0.49950185, 'specificity': 0.49950185, 'f1': 0.4906086, 'auroc': 0.31122488, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18049  18
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.21196538, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-22 14:30:36.598374,epoch time: 0:09:48.086650,used: 0:30:18.740346,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.90742725, 'precision': 0.45371363, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4757336, 'auroc': 0.54793453, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42395  0
1   4325  0
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.4820428, 'recall': 0.4999723, 'specificity': 0.4999723, 'f1': 0.49084386, 'auroc': 0.32473412, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18066  1
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.24111894, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_4.png
better model found
persisted
after epoch: 4,now: 2024-06-22 14:40:23.093639,epoch time: 0:09:46.495265,used: 0:40:05.235611,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.90719175, 'precision': 0.45372215, 'recall': 0.4998467, 'specificity': 0.4998467, 'f1': 0.4756689, 'auroc': 0.61234224, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996934, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42384  13
1   4323   0
---- Validation: 
scalar performance:
{'acc': 0.9636606, 'precision': 0.48203608, 'recall': 0.4997786, 'specificity': 0.4997786, 'f1': 0.49074703, 'auroc': 0.3238297, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18059  8
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.22450903, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_5.png
early stop counter: 1
val acc:0.9636605978012085, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-22 14:49:53.395278,epoch time: 0:09:30.301639,used: 0:49:35.537250,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.90742725, 'precision': 0.4537233, 'recall': 0.4999882, 'specificity': 0.4999882, 'f1': 0.4757336, 'auroc': 0.6583365, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42395  1
1   4324  0
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.4820428, 'recall': 0.4999723, 'specificity': 0.4999723, 'f1': 0.49084386, 'auroc': 0.34838265, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18066  1
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.26599073, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_6.png
early stop counter: 2
val acc:0.9640341401100159, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 6,now: 2024-06-22 14:59:25.742870,epoch time: 0:09:32.347592,used: 0:59:07.884842,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9073202, 'precision': 0.4537378, 'recall': 0.49990565, 'specificity': 0.49990565, 'f1': 0.4757042, 'auroc': 0.6940044, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998113, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42390  8
1   4322  0
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.48204184, 'recall': 0.49994466, 'specificity': 0.49994466, 'f1': 0.49083003, 'auroc': 0.3527848, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18065  2
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.2535719, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_7.png
early stop counter: 3
val acc:0.9639807939529419, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 7,now: 2024-06-22 15:08:51.307300,epoch time: 0:09:25.564430,used: 1:08:33.449272,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.90742725, 'precision': 0.45371363, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4757336, 'auroc': 0.74418795, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42395  0
1   4325  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.37320143, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.29945016, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_8.png
better model found
persisted
after epoch: 8,now: 2024-06-22 15:18:22.320341,epoch time: 0:09:31.013041,used: 1:18:04.462313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.90710616, 'precision': 0.45368904, 'recall': 0.4998349, 'specificity': 0.4998349, 'f1': 0.47564533, 'auroc': 0.7772839, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42380  14
1   4326   0
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.48204088, 'recall': 0.49991697, 'specificity': 0.49991697, 'f1': 0.4908162, 'auroc': 0.3827511, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18064  3
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.322595, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_9.png
early stop counter: 1
val acc:0.9639274477958679, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 9,now: 2024-06-22 15:27:50.109866,epoch time: 0:09:27.789525,used: 1:27:32.251838,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9068921, 'precision': 0.4537374, 'recall': 0.49964622, 'specificity': 0.49964622, 'f1': 0.47558647, 'auroc': 0.816519, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99929243, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42370  30
1   4320   0
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.48203704, 'recall': 0.49980628, 'specificity': 0.49980628, 'f1': 0.49076086, 'auroc': 0.39359757, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18060  7
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.32892895, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_10.png
early stop counter: 2
val acc:0.9637140035629272, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 10,now: 2024-06-22 15:37:06.572625,epoch time: 0:09:16.462759,used: 1:36:48.714597,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9072774, 'precision': 0.4537164, 'recall': 0.49990565, 'specificity': 0.49990565, 'f1': 0.47569242, 'auroc': 0.83092564, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998113, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42388  8
1   4324  0
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.48204088, 'recall': 0.49991697, 'specificity': 0.49991697, 'f1': 0.4908162, 'auroc': 0.39646673, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18064  3
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.3547899, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_11.png
early stop counter: 3
val acc:0.9639274477958679, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 11,now: 2024-06-22 15:46:22.034986,epoch time: 0:09:15.462361,used: 1:46:04.176958,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9058219, 'precision': 0.45364892, 'recall': 0.4991037, 'specificity': 0.4991037, 'f1': 0.47529203, 'auroc': 0.855559, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9982074, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42320  76
1   4324   0
---- Validation: 
scalar performance:
{'acc': 0.96318036, 'precision': 0.48202744, 'recall': 0.49952954, 'specificity': 0.49952954, 'f1': 0.49062243, 'auroc': 0.41446954, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9990591, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18050  17
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.36739177, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_12.png
early stop counter: 4
val acc:0.9631803631782532, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 12,now: 2024-06-22 15:55:47.146194,epoch time: 0:09:25.111208,used: 1:55:29.288166,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9069563, 'precision': 0.5318605, 'recall': 0.5002596, 'specificity': 0.5002596, 'f1': 0.47674897, 'auroc': 0.87201834, 'binary_precision': 0.15625, 'binary_recall': 0.0011560693, 'binary_specificity': 0.9993631, 'binary_f1_score': 0.0022951572}
confusion matrix:
       0   1
0  42368  27
1   4320   5
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.48203993, 'recall': 0.4998893, 'specificity': 0.4998893, 'f1': 0.49080238, 'auroc': 0.42849064, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18063  4
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.42328584, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_13.png
early stop counter: 5
val acc:0.9638740420341492, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 13,now: 2024-06-22 16:05:04.476034,epoch time: 0:09:17.329840,used: 2:04:46.618006,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9056721, 'precision': 0.5665221, 'recall': 0.5025517, 'specificity': 0.5025517, 'f1': 0.4828296, 'auroc': 0.8865186, 'binary_precision': 0.22516556, 'binary_recall': 0.007863089, 'binary_specificity': 0.9972403, 'binary_f1_score': 0.01519553}
confusion matrix:
       0    1
0  42279  117
1   4290   34
---- Validation: 
scalar performance:
{'acc': 0.9624867, 'precision': 0.48201495, 'recall': 0.49916977, 'specificity': 0.49916977, 'f1': 0.4904424, 'auroc': 0.43322933, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99833953, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18037  30
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.421622, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_14.png
early stop counter: 6
val acc:0.9624866843223572, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 14,now: 2024-06-22 16:14:17.765359,epoch time: 0:09:13.289325,used: 2:13:59.907331,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9056079, 'precision': 0.5959388, 'recall': 0.50489444, 'specificity': 0.50489444, 'f1': 0.48780078, 'auroc': 0.895316, 'binary_precision': 0.2835821, 'binary_recall': 0.013185288, 'binary_specificity': 0.99660355, 'binary_f1_score': 0.025198938}
confusion matrix:
       0    1
0  42253  144
1   4266   57
---- Validation: 
scalar performance:
{'acc': 0.9624867, 'precision': 0.48201495, 'recall': 0.49916977, 'specificity': 0.49916977, 'f1': 0.4904424, 'auroc': 0.4607401, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99833953, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18037  30
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.45117033, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_15.png
early stop counter: 7
val acc:0.9624866843223572, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 15,now: 2024-06-22 16:23:34.003540,epoch time: 0:09:16.238181,used: 2:23:16.145512,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9083048, 'precision': 0.7291884, 'recall': 0.5247703, 'specificity': 0.5247703, 'f1': 0.52509034, 'auroc': 0.9091819, 'binary_precision': 0.54672897, 'binary_recall': 0.05411656, 'binary_specificity': 0.9954241, 'binary_f1_score': 0.09848485}
confusion matrix:
       0    1
0  42202  194
1   4090  234
---- Validation: 
scalar performance:
{'acc': 0.96152616, 'precision': 0.48199764, 'recall': 0.49867162, 'specificity': 0.49867162, 'f1': 0.4901929, 'auroc': 0.48220396, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99734324, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18019  48
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.48466828, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_16.png
early stop counter: 8
val acc:0.9615261554718018, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 16,now: 2024-06-22 16:32:45.027523,epoch time: 0:09:11.023983,used: 2:32:27.169495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9129709, 'precision': 0.80408025, 'recall': 0.5513284, 'specificity': 0.5513284, 'f1': 0.57008815, 'auroc': 0.9047271, 'binary_precision': 0.69196427, 'binary_recall': 0.10753932, 'binary_specificity': 0.9951175, 'binary_f1_score': 0.18614893}
confusion matrix:
       0    1
0  42189  207
1   3859  465
---- Validation: 
scalar performance:
{'acc': 0.96152616, 'precision': 0.48199764, 'recall': 0.49867162, 'specificity': 0.49867162, 'f1': 0.4901929, 'auroc': 0.46144265, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99734324, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18019  48
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.4242393, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_17.png
early stop counter: 9
val acc:0.9615261554718018, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 17,now: 2024-06-22 16:41:58.062463,epoch time: 0:09:13.034940,used: 2:41:40.204435,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9120505, 'precision': 0.7923453, 'recall': 0.54687566, 'specificity': 0.54687566, 'f1': 0.5628159, 'auroc': 0.90962505, 'binary_precision': 0.669279, 'binary_recall': 0.09872832, 'binary_specificity': 0.995023, 'binary_f1_score': 0.17207335}
confusion matrix:
       0    1
0  42184  211
1   3898  427
---- Validation: 
scalar performance:
{'acc': 0.96211314, 'precision': 0.48200825, 'recall': 0.49897602, 'specificity': 0.49897602, 'f1': 0.4903454, 'auroc': 0.47617307, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99795204, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18030  37
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.45777446, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_18.png
early stop counter: 10
val acc:0.9621131420135498, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 18,now: 2024-06-22 16:51:08.485513,epoch time: 0:09:10.423050,used: 2:50:50.627485,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.915518, 'precision': 0.8346069, 'recall': 0.5633167, 'specificity': 0.5633167, 'f1': 0.5892572, 'auroc': 0.914245, 'binary_precision': 0.7509934, 'binary_recall': 0.13106796, 'binary_specificity': 0.9955654, 'binary_f1_score': 0.2231844}
confusion matrix:
       0    1
0  42206  188
1   3759  567
---- Validation: 
scalar performance:
{'acc': 0.9615795, 'precision': 0.48199862, 'recall': 0.49869928, 'specificity': 0.49869928, 'f1': 0.49020675, 'auroc': 0.4794065, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99739856, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18020  47
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.49803603, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_19.png
early stop counter: 11
val acc:0.9615795016288757, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 19,now: 2024-06-22 17:00:23.264178,epoch time: 0:09:14.778665,used: 3:00:05.406150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.92208904, 'precision': 0.8660367, 'recall': 0.6015106, 'specificity': 0.6015106, 'f1': 0.64475936, 'auroc': 0.9193846, 'binary_precision': 0.80717486, 'binary_recall': 0.20809248, 'binary_specificity': 0.99492866, 'binary_f1_score': 0.33088234}
confusion matrix:
       0    1
0  42180  215
1   3425  900
---- Validation: 
scalar performance:
{'acc': 0.96125937, 'precision': 0.48199284, 'recall': 0.49853325, 'specificity': 0.49853325, 'f1': 0.4901235, 'auroc': 0.48524314, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9970665, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18014  53
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.4566664, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_20.png
early stop counter: 12
val acc:0.9612593650817871, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 20,now: 2024-06-22 17:09:39.777559,epoch time: 0:09:16.513381,used: 3:09:21.919531,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9213613, 'precision': 0.86719346, 'recall': 0.59601176, 'specificity': 0.59601176, 'f1': 0.6374363, 'auroc': 0.9234016, 'binary_precision': 0.8104762, 'binary_recall': 0.19671752, 'binary_specificity': 0.99530596, 'binary_f1_score': 0.31659225}
confusion matrix:
       0    1
0  42195  199
1   3475  851
---- Validation: 
scalar performance:
{'acc': 0.96163285, 'precision': 0.48199958, 'recall': 0.49872696, 'specificity': 0.49872696, 'f1': 0.49022064, 'auroc': 0.4882124, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9974539, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18021  46
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.52396345, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_21.png
early stop counter: 13
val acc:0.9616328477859497, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 21,now: 2024-06-22 17:19:02.296543,epoch time: 0:09:22.518984,used: 3:18:44.438515,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.925107, 'precision': 0.8734374, 'recall': 0.6195218, 'specificity': 0.6195218, 'f1': 0.66839296, 'auroc': 0.92568374, 'binary_precision': 0.81874514, 'binary_recall': 0.2445627, 'binary_specificity': 0.99448085, 'binary_f1_score': 0.37662566}
confusion matrix:
       0     1
0  42164   234
1   3265  1057
---- Validation: 
scalar performance:
{'acc': 0.96120596, 'precision': 0.48199186, 'recall': 0.49850556, 'specificity': 0.49850556, 'f1': 0.49010965, 'auroc': 0.5215958, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18013  54
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.4982252, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_22.png
early stop counter: 14
val acc:0.9612059593200684, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 22,now: 2024-06-22 17:28:31.357739,epoch time: 0:09:29.061196,used: 3:28:13.499711,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9301584, 'precision': 0.8887872, 'recall': 0.64734346, 'specificity': 0.64734346, 'f1': 0.702911, 'auroc': 0.942149, 'binary_precision': 0.8445023, 'binary_recall': 0.30032393, 'binary_specificity': 0.99436295, 'binary_f1_score': 0.44307902}
confusion matrix:
       0     1
0  42159   239
1   3024  1298
---- Validation: 
scalar performance:
{'acc': 0.9608324, 'precision': 0.48198512, 'recall': 0.49831185, 'specificity': 0.49831185, 'f1': 0.49001253, 'auroc': 0.5423791, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9966237, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18006  61
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.59457815, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_23.png
early stop counter: 15
val acc:0.960832417011261, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 23,now: 2024-06-22 17:37:54.033460,epoch time: 0:09:22.675721,used: 3:37:36.175432,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.931464, 'precision': 0.8978927, 'recall': 0.65196276, 'specificity': 0.65196276, 'f1': 0.7091596, 'auroc': 0.9334464, 'binary_precision': 0.8619355, 'binary_recall': 0.30897316, 'binary_specificity': 0.9949524, 'binary_f1_score': 0.4548859}
confusion matrix:
       0     1
0  42182   214
1   2988  1336
---- Validation: 
scalar performance:
{'acc': 0.96152616, 'precision': 0.48199764, 'recall': 0.49867162, 'specificity': 0.49867162, 'f1': 0.4901929, 'auroc': 0.5238304, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99734324, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18019  48
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5795156, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_24.png
early stop counter: 16
val acc:0.9615261554718018, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 24,now: 2024-06-22 17:47:23.892951,epoch time: 0:09:29.859491,used: 3:47:06.034923,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9368365, 'precision': 0.9081602, 'recall': 0.68209803, 'specificity': 0.68209803, 'f1': 0.74306136, 'auroc': 0.9350015, 'binary_precision': 0.87705815, 'binary_recall': 0.36947978, 'binary_specificity': 0.99471635, 'binary_f1_score': 0.51992846}
confusion matrix:
       0     1
0  42171   224
1   2727  1598
---- Validation: 
scalar performance:
{'acc': 0.96093917, 'precision': 0.4902086, 'recall': 0.49908245, 'specificity': 0.49908245, 'f1': 0.4914021, 'auroc': 0.53661597, 'binary_precision': 0.016393442, 'binary_recall': 0.0014858841, 'binary_specificity': 0.996679, 'binary_f1_score': 0.0027247956}
confusion matrix:
       0   1
0  18007  60
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5661736, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_25.png
early stop counter: 17
val acc:0.9609391689300537, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 25,now: 2024-06-22 17:56:51.171021,epoch time: 0:09:27.278070,used: 3:56:33.312993,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.93874145, 'precision': 0.90547323, 'recall': 0.6958815, 'specificity': 0.6958815, 'f1': 0.756507, 'auroc': 0.9410703, 'binary_precision': 0.86912584, 'binary_recall': 0.39787185, 'binary_specificity': 0.99389106, 'binary_f1_score': 0.54585844}
confusion matrix:
       0     1
0  42138   259
1   2603  1720
---- Validation: 
scalar performance:
{'acc': 0.9606724, 'precision': 0.4895828, 'recall': 0.49894407, 'specificity': 0.49894407, 'f1': 0.4913235, 'auroc': 0.5379468, 'binary_precision': 0.015151516, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.0027063598}
confusion matrix:
       0   1
0  18002  65
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.5566331, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_26.png
early stop counter: 18
val acc:0.9606723785400391, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 26,now: 2024-06-22 18:06:28.179135,epoch time: 0:09:37.008114,used: 4:06:10.321107,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9399401, 'precision': 0.9102068, 'recall': 0.70114493, 'specificity': 0.70114493, 'f1': 0.76245975, 'auroc': 0.94529533, 'binary_precision': 0.8776728, 'binary_recall': 0.4080925, 'binary_specificity': 0.9941974, 'binary_f1_score': 0.55713385}
confusion matrix:
       0     1
0  42149   246
1   2560  1765
---- Validation: 
scalar performance:
{'acc': 0.9610459, 'precision': 0.4904884, 'recall': 0.49913782, 'specificity': 0.49913782, 'f1': 0.49143362, 'auroc': 0.5810323, 'binary_precision': 0.016949153, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99678975, 'binary_f1_score': 0.0027322404}
confusion matrix:
       0   1
0  18009  58
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.47904915, 'recall': 0.4999159, 'specificity': 0.4999159, 'f1': 0.48926014, 'auroc': 0.65381646, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5945  1
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_27.png
early stop counter: 19
val acc:0.9610459208488464, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 27,now: 2024-06-22 18:15:56.646532,epoch time: 0:09:28.467397,used: 4:15:38.788504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9370933, 'precision': 0.9000789, 'recall': 0.68818945, 'specificity': 0.68818945, 'f1': 0.7479886, 'auroc': 0.9368114, 'binary_precision': 0.85974026, 'binary_recall': 0.38274744, 'binary_specificity': 0.9936315, 'binary_f1_score': 0.5296847}
confusion matrix:
       0     1
0  42126   270
1   2669  1655
---- Validation: 
scalar performance:
{'acc': 0.9601921, 'precision': 0.48197353, 'recall': 0.49797973, 'specificity': 0.49797973, 'f1': 0.4898459, 'auroc': 0.53920233, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  17994  73
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.56188, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_28.png
early stop counter: 20
val acc:0.960192084312439, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 28,now: 2024-06-22 18:25:23.514819,epoch time: 0:09:26.868287,used: 4:25:05.656791,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_14_00_17_seed_1_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 28 with time: 4:25:05.656791 at 2024-06-22 18:25:23.514819
persisted model performance metric: 

scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.29945016, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.21196538, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204385 KiB | 755911 KiB |   1181 TiB |   1181 TiB |
|       from large pool | 167936 KiB | 683776 KiB |   1181 TiB |   1181 TiB |
|       from small pool |  36449 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204385 KiB | 755911 KiB |   1181 TiB |   1181 TiB |
|       from large pool | 167936 KiB | 683776 KiB |   1181 TiB |   1181 TiB |
|       from small pool |  36449 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 748328 KiB |   1181 TiB |   1181 TiB |
|       from large pool | 165120 KiB | 676736 KiB |   1181 TiB |   1181 TiB |
|       from small pool |  35966 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    782 MiB |    930 MiB |   1410 MiB | 643072 KiB |
|       from large pool |    710 MiB |    858 MiB |   1310 MiB | 614400 KiB |
|       from small pool |     72 MiB |     72 MiB |    100 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 104862 KiB | 245592 KiB | 513763 GiB | 513763 GiB |
|       from large pool |  96256 KiB | 244616 KiB | 513466 GiB | 513466 GiB |
|       from small pool |   8606 KiB |  16195 KiB |    297 GiB |    297 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2064    |    3669    |   75452 K  |   75450 K  |
|       from large pool |      36    |      76    |   30984 K  |   30984 K  |
|       from small pool |    2028    |    3632    |   44468 K  |   44466 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2064    |    3669    |   75452 K  |   75450 K  |
|       from large pool |      36    |      76    |   30984 K  |   30984 K  |
|       from small pool |    2028    |    3632    |   44468 K  |   44466 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      51    |      69    |      20    |
|       from large pool |      13    |      15    |      19    |       6    |
|       from small pool |      36    |      36    |      50    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    1476    |   32976 K  |   32976 K  |
|       from large pool |       5    |      11    |   10128 K  |   10128 K  |
|       from small pool |      28    |    1471    |   22847 K  |   22847 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755911 KiB |   1181 TiB |   1181 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1181 TiB |   1181 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755911 KiB |   1181 TiB |   1181 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1181 TiB |   1181 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB |   1181 TiB |   1181 TiB |
|       from large pool |  16640 KiB | 676736 KiB |   1181 TiB |   1181 TiB |
|       from small pool |      0 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    930 MiB |   1410 MiB |   1108 MiB |
|       from large pool | 264192 KiB |    858 MiB |   1310 MiB |   1052 MiB |
|       from small pool |  45056 KiB |     72 MiB |    100 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 245592 KiB | 513763 GiB | 513763 GiB |
|       from large pool |  83712 KiB | 244616 KiB | 513466 GiB | 513466 GiB |
|       from small pool |      0 KiB |  16201 KiB |    297 GiB |    297 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   75452 K  |   75452 K  |
|       from large pool |       2    |      76    |   30984 K  |   30984 K  |
|       from small pool |       0    |    3632    |   44468 K  |   44468 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   75452 K  |   75452 K  |
|       from large pool |       2    |      76    |   30984 K  |   30984 K  |
|       from small pool |       0    |    3632    |   44468 K  |   44468 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      69    |      38    |
|       from large pool |       9    |      15    |      19    |      10    |
|       from small pool |      22    |      36    |      50    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   32976 K  |   32976 K  |
|       from large pool |       1    |      11    |   10128 K  |   10128 K  |
|       from small pool |       0    |    1471    |   22848 K  |   22848 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755911 KiB |   1181 TiB |   1181 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1181 TiB |   1181 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755911 KiB |   1181 TiB |   1181 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1181 TiB |   1181 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB |   1181 TiB |   1181 TiB |
|       from large pool |  16640 KiB | 676736 KiB |   1181 TiB |   1181 TiB |
|       from small pool |      0 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    930 MiB |   1410 MiB |   1108 MiB |
|       from large pool | 264192 KiB |    858 MiB |   1310 MiB |   1052 MiB |
|       from small pool |  45056 KiB |     72 MiB |    100 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 245592 KiB | 513763 GiB | 513763 GiB |
|       from large pool |  83712 KiB | 244616 KiB | 513466 GiB | 513466 GiB |
|       from small pool |      0 KiB |  16201 KiB |    297 GiB |    297 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   75452 K  |   75452 K  |
|       from large pool |       2    |      76    |   30984 K  |   30984 K  |
|       from small pool |       0    |    3632    |   44468 K  |   44468 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   75452 K  |   75452 K  |
|       from large pool |       2    |      76    |   30984 K  |   30984 K  |
|       from small pool |       0    |    3632    |   44468 K  |   44468 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      69    |      38    |
|       from large pool |       9    |      15    |      19    |      10    |
|       from small pool |      22    |      36    |      50    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   32976 K  |   32976 K  |
|       from large pool |       1    |      11    |   10128 K  |   10128 K  |
|       from small pool |       0    |    1471    |   22848 K  |   22848 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985

 Experiment start at: 2024-06-22 18:29:35.254182
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8964097, 'precision': 0.45897448, 'recall': 0.49676928, 'specificity': 0.49676928, 'f1': 0.4737129, 'auroc': 0.42646092, 'binary_precision': 0.015384615, 'binary_recall': 0.001101807, 'binary_specificity': 0.99243677, 'binary_f1_score': 0.0020563437}
confusion matrix:
       0    1
0  41990  320
1   4533    5
---- Validation: 
scalar performance:
{'acc': 0.95498854, 'precision': 0.51487166, 'recall': 0.50696534, 'specificity': 0.50696534, 'f1': 0.50781757, 'auroc': 0.37366647, 'binary_precision': 0.06137184, 'binary_recall': 0.028239202, 'binary_specificity': 0.9856915, 'binary_f1_score': 0.03868032}
confusion matrix:
       0    1
0  17911  260
1    585   17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9434204, 'precision': 0.48910064, 'recall': 0.49471086, 'specificity': 0.49471086, 'f1': 0.4910407, 'auroc': 0.36876857, 'binary_precision': 0.017391304, 'binary_recall': 0.008264462, 'binary_specificity': 0.98115724, 'binary_f1_score': 0.011204482}
confusion matrix:
      0    1
0  5884  113
1   240    2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 18:39:14.568380,epoch time: 0:09:39.314198,used: 0:09:39.314198,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9030055, 'precision': 0.45155093, 'recall': 0.4999409, 'specificity': 0.4999409, 'f1': 0.47451544, 'auroc': 0.50363934, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42304  5
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.3609098, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.32809794, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-22 18:48:42.053476,epoch time: 0:09:27.485096,used: 0:19:06.799294,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.50683594, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.35142416, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.29827446, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_3.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 3,now: 2024-06-22 18:58:01.161310,epoch time: 0:09:19.107834,used: 0:28:25.907128,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9031335, 'precision': 0.45156676, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47455078, 'auroc': 0.5664121, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42310  0
1   4538  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.373993, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.32445216, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_4.png
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 4,now: 2024-06-22 19:07:16.891483,epoch time: 0:09:15.730173,used: 0:37:41.637301,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.6335108, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.3914917, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.3735475, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_5.png
early stop counter: 3
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 5,now: 2024-06-22 19:16:31.961282,epoch time: 0:09:15.069799,used: 0:46:56.707100,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.6989188, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.39047492, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.33633345, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_6.png
early stop counter: 4
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 6,now: 2024-06-22 19:25:48.896762,epoch time: 0:09:16.935480,used: 0:56:13.642580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.72081506, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.4036333, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.35141432, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_7.png
early stop counter: 5
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 7,now: 2024-06-22 19:35:05.723661,epoch time: 0:09:16.826899,used: 1:05:30.469479,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9031335, 'precision': 0.45156676, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47455078, 'auroc': 0.773728, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42310  0
1   4538  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.42594144, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.39199764, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_8.png
early stop counter: 6
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 8,now: 2024-06-22 19:44:18.832841,epoch time: 0:09:13.109180,used: 1:14:43.578659,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9031335, 'precision': 0.45156676, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47455078, 'auroc': 0.8196728, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42310  0
1   4538  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.4345237, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.4389593, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_9.png
early stop counter: 7
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 9,now: 2024-06-22 19:53:34.400635,epoch time: 0:09:15.567794,used: 1:23:59.146453,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.84228396, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.43405935, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.3956758, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_10.png
early stop counter: 8
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 10,now: 2024-06-22 20:02:50.158504,epoch time: 0:09:15.757869,used: 1:33:14.904322,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9031122, 'precision': 0.4515561, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4745449, 'auroc': 0.8571192, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42309  0
1   4539  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.4664146, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.4832568, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_11.png
early stop counter: 9
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 11,now: 2024-06-22 20:12:05.715939,epoch time: 0:09:15.557435,used: 1:42:30.461757,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9032189, 'precision': 0.9516064, 'recall': 0.5003306, 'specificity': 0.5003306, 'f1': 0.47523347, 'auroc': 0.8777751, 'binary_precision': 1.0, 'binary_recall': 0.0006612299, 'binary_specificity': 1.0, 'binary_f1_score': 0.0013215858}
confusion matrix:
       0  1
0  42311  0
1   4534  3
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.47188318, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.5004033, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_12.png
early stop counter: 10
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 12,now: 2024-06-22 20:21:23.981094,epoch time: 0:09:18.265155,used: 1:51:48.726912,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.90356046, 'precision': 0.9517586, 'recall': 0.50231326, 'specificity': 0.50231326, 'f1': 0.47926193, 'auroc': 0.888875, 'binary_precision': 1.0, 'binary_recall': 0.00462657, 'binary_specificity': 1.0, 'binary_f1_score': 0.009210527}
confusion matrix:
       0   1
0  42309   0
1   4518  21
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.4907931, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.50525093, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_13.png
early stop counter: 11
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 13,now: 2024-06-22 20:30:43.157231,epoch time: 0:09:19.176137,used: 2:01:07.903049,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.90488386, 'precision': 0.95235753, 'recall': 0.509143, 'specificity': 0.509143, 'f1': 0.4929447, 'auroc': 0.8927686, 'binary_precision': 1.0, 'binary_recall': 0.018285966, 'binary_specificity': 1.0, 'binary_f1_score': 0.035915185}
confusion matrix:
       0   1
0  42309   0
1   4456  83
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.4955325, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.55056405, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_14.png
early stop counter: 12
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 14,now: 2024-06-22 20:40:02.721543,epoch time: 0:09:19.564312,used: 2:10:27.467361,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.90665555, 'precision': 0.95019436, 'recall': 0.5183843, 'specificity': 0.5183843, 'f1': 0.5109086, 'auroc': 0.9011489, 'binary_precision': 0.99404764, 'binary_recall': 0.036792245, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.070958145}
confusion matrix:
       0    1
0  42308    1
1   4372  167
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.49982965, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.54727435, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_15.png
early stop counter: 13
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 15,now: 2024-06-22 20:49:25.439445,epoch time: 0:09:22.717902,used: 2:19:50.185263,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9100495, 'precision': 0.9547106, 'recall': 0.5358008, 'specificity': 0.5358008, 'f1': 0.5430985, 'auroc': 0.9107269, 'binary_precision': 1.0, 'binary_recall': 0.071601674, 'binary_specificity': 1.0, 'binary_f1_score': 0.13363488}
confusion matrix:
       0    1
0  42309    0
1   4214  325
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.4839655, 'recall': 0.4999725, 'specificity': 0.4999725, 'f1': 0.4918388, 'auroc': 0.51745164, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18170  1
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.5465785, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_16.png
early stop counter: 14
val acc:0.9678794145584106, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 16,now: 2024-06-22 20:58:42.556706,epoch time: 0:09:17.117261,used: 2:29:07.302524,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9139131, 'precision': 0.95262456, 'recall': 0.5560347, 'specificity': 0.5560347, 'f1': 0.5780241, 'auroc': 0.918383, 'binary_precision': 0.99220276, 'binary_recall': 0.112163946, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.20154426}
confusion matrix:
       0    1
0  42306    4
1   4029  509
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.4839655, 'recall': 0.4999725, 'specificity': 0.4999725, 'f1': 0.4918388, 'auroc': 0.5289458, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18170  1
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.5817482, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_17.png
early stop counter: 15
val acc:0.9678794145584106, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 17,now: 2024-06-22 21:07:57.604730,epoch time: 0:09:15.048024,used: 2:38:22.350548,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.91340077, 'precision': 0.95522606, 'recall': 0.55319375, 'specificity': 0.55319375, 'f1': 0.5732815, 'auroc': 0.91236717, 'binary_precision': 0.99793386, 'binary_recall': 0.10641111, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.19231535}
confusion matrix:
       0    1
0  42308    1
1   4056  483
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.48396462, 'recall': 0.49994496, 'specificity': 0.49994496, 'f1': 0.49182498, 'auroc': 0.4959271, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18169  2
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.5132514, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_18.png
early stop counter: 16
val acc:0.9678261280059814, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 18,now: 2024-06-22 21:17:12.403389,epoch time: 0:09:14.798659,used: 2:47:37.149207,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9207864, 'precision': 0.95444345, 'recall': 0.59209454, 'specificity': 0.59209454, 'f1': 0.6344208, 'auroc': 0.93103516, 'binary_precision': 0.9893617, 'binary_recall': 0.18440185, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.31086352}
confusion matrix:
       0    1
0  42300    9
1   3702  837
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.48396292, 'recall': 0.49988994, 'specificity': 0.49988994, 'f1': 0.4917975, 'auroc': 0.56763667, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997799, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18167  4
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.48059964, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.49002782, 'auroc': 0.64447236, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_19.png
early stop counter: 17
val acc:0.9677196145057678, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 19,now: 2024-06-22 21:26:27.377905,epoch time: 0:09:14.974516,used: 2:56:52.123723,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.92287827, 'precision': 0.9596046, 'recall': 0.6022015, 'specificity': 0.6022015, 'f1': 0.64920807, 'auroc': 0.9273331, 'binary_precision': 0.99784946, 'binary_recall': 0.20445032, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.33936733}
confusion matrix:
       0    1
0  42307    2
1   3611  928
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.48396376, 'recall': 0.49991745, 'specificity': 0.49991745, 'f1': 0.49181125, 'auroc': 0.54064393, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18168  3
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.48059964, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.49002782, 'auroc': 0.59900403, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_20.png
early stop counter: 18
val acc:0.9677728414535522, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 20,now: 2024-06-22 21:35:47.571353,epoch time: 0:09:20.193448,used: 3:06:12.317171,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.92719007, 'precision': 0.95885134, 'recall': 0.6250589, 'specificity': 0.6250589, 'f1': 0.6805166, 'auroc': 0.9320563, 'binary_precision': 0.99213976, 'binary_recall': 0.25033054, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.39978886}
confusion matrix:
       0     1
0  42301     9
1   3402  1136
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.48396292, 'recall': 0.49988994, 'specificity': 0.49988994, 'f1': 0.4917975, 'auroc': 0.5591725, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997799, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18167  4
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.48059964, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.49002782, 'auroc': 0.61123985, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_21.png
early stop counter: 19
val acc:0.9677196145057678, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 21,now: 2024-06-22 21:45:08.272383,epoch time: 0:09:20.701030,used: 3:15:33.018201,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9319288, 'precision': 0.9586312, 'recall': 0.6504812, 'specificity': 0.6504812, 'f1': 0.7127195, 'auroc': 0.93233943, 'binary_precision': 0.987013, 'binary_recall': 0.30138797, 'binary_specificity': 0.99957454, 'binary_f1_score': 0.46177217}
confusion matrix:
       0     1
0  42291    18
1   3171  1368
---- Validation: 
scalar performance:
{'acc': 0.9675598, 'precision': 0.48396036, 'recall': 0.4998074, 'specificity': 0.4998074, 'f1': 0.49175623, 'auroc': 0.5628585, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996148, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18164  7
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.48059654, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.4899861, 'auroc': 0.61775315, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21546985_22.png
early stop counter: 20
val acc:0.967559814453125, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 22,now: 2024-06-22 21:54:25.913223,epoch time: 0:09:17.640840,used: 3:24:50.659041,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_18_29_35_seed_2_21546985
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 22 with time: 3:24:50.659041 at 2024-06-22 21:54:25.913223
persisted model performance metric: 

scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.32809794, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
oracle model performance metric: 

scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.32809794, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_resnet_differentlearningrates_bs32_classbalancing3/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204388 KiB | 755914 KiB |   1692 TiB |   1692 TiB |
|       from large pool | 167936 KiB | 683776 KiB |   1692 TiB |   1692 TiB |
|       from small pool |  36452 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204388 KiB | 755914 KiB |   1692 TiB |   1692 TiB |
|       from large pool | 167936 KiB | 683776 KiB |   1692 TiB |   1692 TiB |
|       from small pool |  36452 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB | 748328 KiB |   1692 TiB |   1692 TiB |
|       from large pool | 165120 KiB | 676736 KiB |   1692 TiB |   1692 TiB |
|       from small pool |  35967 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    782 MiB |    930 MiB |   1890 MiB |   1108 MiB |
|       from large pool |    710 MiB |    858 MiB |   1762 MiB |   1052 MiB |
|       from small pool |     72 MiB |     72 MiB |    128 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 102811 KiB | 245592 KiB | 746341 GiB | 746341 GiB |
|       from large pool |  96256 KiB | 244616 KiB | 745901 GiB | 745901 GiB |
|       from small pool |   6555 KiB |  16201 KiB |    439 GiB |    439 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2070    |    3677    |  108096 K  |  108094 K  |
|       from large pool |      36    |      76    |   44390 K  |   44390 K  |
|       from small pool |    2034    |    3640    |   63705 K  |   63703 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2070    |    3677    |  108096 K  |  108094 K  |
|       from large pool |      36    |      76    |   44390 K  |   44390 K  |
|       from small pool |    2034    |    3640    |   63705 K  |   63703 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      51    |      87    |      38    |
|       from large pool |      13    |      15    |      23    |      10    |
|       from small pool |      36    |      36    |      64    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    1476    |   47177 K  |   47176 K  |
|       from large pool |       5    |      11    |   14629 K  |   14629 K  |
|       from small pool |      28    |    1471    |   32547 K  |   32547 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755914 KiB |   1692 TiB |   1692 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1692 TiB |   1692 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755914 KiB |   1692 TiB |   1692 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1692 TiB |   1692 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB |   1692 TiB |   1692 TiB |
|       from large pool |  16640 KiB | 676736 KiB |   1692 TiB |   1692 TiB |
|       from small pool |      0 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 307200 KiB |    930 MiB |   1890 MiB |   1590 MiB |
|       from large pool | 264192 KiB |    858 MiB |   1762 MiB |   1504 MiB |
|       from small pool |  43008 KiB |     72 MiB |    128 MiB |     86 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 245592 KiB | 746341 GiB | 746341 GiB |
|       from large pool |  83712 KiB | 244616 KiB | 745901 GiB | 745901 GiB |
|       from small pool |      0 KiB |  16201 KiB |    439 GiB |    439 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3677    |  108096 K  |  108096 K  |
|       from large pool |       2    |      76    |   44390 K  |   44390 K  |
|       from small pool |       0    |    3640    |   63705 K  |   63705 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3677    |  108096 K  |  108096 K  |
|       from large pool |       2    |      76    |   44390 K  |   44390 K  |
|       from small pool |       0    |    3640    |   63705 K  |   63705 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      30    |      51    |      87    |      57    |
|       from large pool |       9    |      15    |      23    |      14    |
|       from small pool |      21    |      36    |      64    |      43    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   47177 K  |   47177 K  |
|       from large pool |       1    |      11    |   14629 K  |   14629 K  |
|       from small pool |       0    |    1471    |   32548 K  |   32548 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jun 22 21:55:08 2024]
Finished job 0.
1 of 1 steps (100%) done
