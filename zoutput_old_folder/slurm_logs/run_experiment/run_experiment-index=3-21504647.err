Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jun 18 19:43:11 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647

 Experiment start at: 2024-06-18 20:01:53.743626
before training, model accuracy: 0.31563422083854675
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9527837, 'precision': 0.97286534, 'recall': 0.7512862, 'specificity': 0.7512862, 'f1': 0.8213279, 'auroc': 0.95473164, 'binary_precision': 0.99506724, 'binary_recall': 0.50283253, 'binary_specificity': 0.9997399, 'binary_f1_score': 0.6680717}
confusion matrix:
       0     1
0  42276    11
1   2194  2219
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.69725084, 'recall': 0.5022226, 'specificity': 0.5022226, 'f1': 0.4958971, 'auroc': 0.56194985, 'binary_precision': 0.42857143, 'binary_recall': 0.00466563, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.009230768}
confusion matrix:
       0  1
0  18145  4
1    640  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88377583, 'precision': 0.442214, 'recall': 0.49958313, 'specificity': 0.49958313, 'f1': 0.4691513, 'auroc': 0.6122627, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5992  5
1   783  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-18 20:20:23.332937,epoch time: 0:18:29.589311,used: 0:18:29.589311,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97561026, 'precision': 0.9820286, 'recall': 0.87435937, 'specificity': 0.87435937, 'f1': 0.9198388, 'auroc': 0.98141235, 'binary_precision': 0.9895178, 'binary_recall': 0.7495463, 'binary_specificity': 0.99917245, 'binary_f1_score': 0.8529753}
confusion matrix:
       0     1
0  42257    35
1   1104  3304
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.76504576, 'recall': 0.5378058, 'specificity': 0.5378058, 'f1': 0.5597312, 'auroc': 0.70513463, 'binary_precision': 0.56179774, 'binary_recall': 0.077760495, 'binary_specificity': 0.99785113, 'binary_f1_score': 0.13661201}
confusion matrix:
       0   1
0  18110  39
1    593  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89247787, 'precision': 0.8376627, 'recall': 0.54614186, 'specificity': 0.54614186, 'f1': 0.5565804, 'auroc': 0.7447517, 'binary_precision': 0.78125, 'binary_recall': 0.09578544, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.17064846}
confusion matrix:
      0   1
0  5976  21
1   708  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-18 20:42:47.290114,epoch time: 0:22:23.957177,used: 0:40:53.546488,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98, 'precision': 0.9814044, 'recall': 0.90038884, 'specificity': 0.90038884, 'f1': 0.93627214, 'auroc': 0.9873185, 'binary_precision': 0.98306495, 'binary_recall': 0.8022202, 'binary_specificity': 0.99855745, 'binary_f1_score': 0.88348305}
confusion matrix:
       0     1
0  42225    61
1    873  3541
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.76124185, 'recall': 0.5551397, 'specificity': 0.5551397, 'f1': 0.58564943, 'auroc': 0.7302817, 'binary_precision': 0.5530303, 'binary_recall': 0.11353032, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.18838708}
confusion matrix:
       0   1
0  18090  59
1    570  73
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89749265, 'precision': 0.8711384, 'recall': 0.567298, 'specificity': 0.567298, 'f1': 0.5910785, 'auroc': 0.76559484, 'binary_precision': 0.84375, 'binary_recall': 0.13793103, 'binary_specificity': 0.996665, 'binary_f1_score': 0.23710209}
confusion matrix:
      0    1
0  5977   20
1   675  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-18 21:06:03.082764,epoch time: 0:23:15.792650,used: 1:04:09.339138,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98293364, 'precision': 0.9810548, 'recall': 0.9178168, 'specificity': 0.9178168, 'f1': 0.9466605, 'auroc': 0.9894886, 'binary_precision': 0.9788136, 'binary_recall': 0.8375255, 'binary_specificity': 0.99810815, 'binary_f1_score': 0.9026743}
confusion matrix:
       0     1
0  42207    80
1    717  3696
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.7701442, 'recall': 0.56130546, 'specificity': 0.56130546, 'f1': 0.59471977, 'auroc': 0.74534786, 'binary_precision': 0.57042253, 'binary_recall': 0.125972, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.2063694}
confusion matrix:
       0   1
0  18088  61
1    562  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9023599, 'precision': 0.89648205, 'recall': 0.5867052, 'specificity': 0.5867052, 'f1': 0.6208975, 'auroc': 0.7723725, 'binary_precision': 0.89032257, 'binary_recall': 0.17624521, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.29424307}
confusion matrix:
      0    1
0  5980   17
1   645  138
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-18 21:23:48.321917,epoch time: 0:17:45.239153,used: 1:21:54.578291,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98488224, 'precision': 0.9829016, 'recall': 0.9275389, 'specificity': 0.9275389, 'f1': 0.9531178, 'auroc': 0.99113536, 'binary_precision': 0.9805296, 'binary_recall': 0.85685116, 'binary_specificity': 0.99822664, 'binary_f1_score': 0.91452783}
confusion matrix:
       0     1
0  42217    75
1    631  3777
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.75830376, 'recall': 0.5867798, 'specificity': 0.5867798, 'f1': 0.62616605, 'auroc': 0.7598858, 'binary_precision': 0.5450237, 'binary_recall': 0.17884915, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.26932085}
confusion matrix:
       0    1
0  18053   96
1    528  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90530974, 'precision': 0.8840722, 'recall': 0.60502857, 'specificity': 0.60502857, 'f1': 0.6462665, 'auroc': 0.7658267, 'binary_precision': 0.86153847, 'binary_recall': 0.21455939, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.34355828}
confusion matrix:
      0    1
0  5970   27
1   615  168
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_5.png
new oracle model saved
early stop counter: 1
val acc:0.9667943716049194, best validation acc: 0.9668475985527039, corresponding to test acc:                         0.9023599028587341 / 0.9053097367286682
after epoch: 5,now: 2024-06-18 21:46:03.552546,epoch time: 0:22:15.230629,used: 1:44:09.808920,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98541754, 'precision': 0.9822565, 'recall': 0.9313657, 'specificity': 0.9313657, 'f1': 0.9550383, 'auroc': 0.9913062, 'binary_precision': 0.97846156, 'binary_recall': 0.8647179, 'binary_specificity': 0.99801356, 'binary_f1_score': 0.91808015}
confusion matrix:
       0     1
0  42203    84
1    597  3816
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7637005, 'recall': 0.59066784, 'specificity': 0.59066784, 'f1': 0.6312698, 'auroc': 0.78022003, 'binary_precision': 0.5555556, 'binary_recall': 0.1866252, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.27939466}
confusion matrix:
       0    1
0  18053   96
1    523  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90501475, 'precision': 0.8850408, 'recall': 0.6031962, 'specificity': 0.6031962, 'f1': 0.6438205, 'auroc': 0.7835578, 'binary_precision': 0.8638743, 'binary_recall': 0.21072797, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.33880904}
confusion matrix:
      0    1
0  5971   26
1   618  165
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_6.png
better model found
persisted
after epoch: 6,now: 2024-06-18 22:08:00.829129,epoch time: 0:21:57.276583,used: 2:06:07.085503,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9872805, 'precision': 0.98039055, 'recall': 0.94415355, 'specificity': 0.94415355, 'f1': 0.9613806, 'auroc': 0.99397004, 'binary_precision': 0.97205734, 'binary_recall': 0.8909792, 'binary_specificity': 0.99732786, 'binary_f1_score': 0.929754}
confusion matrix:
       0     1
0  42175   113
1    481  3931
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.7529014, 'recall': 0.5956978, 'specificity': 0.5956978, 'f1': 0.63561285, 'auroc': 0.7952109, 'binary_precision': 0.53361344, 'binary_recall': 0.19751166, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.28830874}
confusion matrix:
       0    1
0  18038  111
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9063422, 'precision': 0.8786239, 'recall': 0.6122745, 'specificity': 0.6122745, 'f1': 0.65563595, 'auroc': 0.7993959, 'binary_precision': 0.8490566, 'binary_recall': 0.22988506, 'binary_specificity': 0.994664, 'binary_f1_score': 0.36180902}
confusion matrix:
      0    1
0  5965   32
1   603  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_7.png
new oracle model saved
early stop counter: 1
val acc:0.9666347503662109, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9050147533416748 / 0.9063422083854675
after epoch: 7,now: 2024-06-18 22:28:12.490196,epoch time: 0:20:11.661067,used: 2:26:18.746570,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9884797, 'precision': 0.9834321, 'recall': 0.9483568, 'specificity': 0.9483568, 'f1': 0.96506613, 'auroc': 0.99445784, 'binary_precision': 0.9773232, 'binary_recall': 0.8988891, 'binary_specificity': 0.9978245, 'binary_f1_score': 0.9364667}
confusion matrix:
       0     1
0  42197    92
1    446  3965
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.7530992, 'recall': 0.6092539, 'specificity': 0.6092539, 'f1': 0.64994776, 'auroc': 0.7916988, 'binary_precision': 0.5330882, 'binary_recall': 0.22550544, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.31693986}
confusion matrix:
       0    1
0  18022  127
1    498  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90575224, 'precision': 0.8801658, 'recall': 0.60860986, 'specificity': 0.60860986, 'f1': 0.6508802, 'auroc': 0.792712, 'binary_precision': 0.85294116, 'binary_recall': 0.22222222, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.35258362}
confusion matrix:
      0    1
0  5967   30
1   609  174
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_8.png
early stop counter: 2
val acc:0.966741144657135, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9050147533416748 / 0.9063422083854675
after epoch: 8,now: 2024-06-18 22:51:43.225952,epoch time: 0:23:30.735756,used: 2:49:49.482326,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9880728, 'precision': 0.9825231, 'recall': 0.9468241, 'specificity': 0.9468241, 'f1': 0.9638131, 'auroc': 0.9934438, 'binary_precision': 0.97580844, 'binary_recall': 0.8959656, 'binary_specificity': 0.9976826, 'binary_f1_score': 0.93418413}
confusion matrix:
       0     1
0  42190    98
1    459  3953
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.7650691, 'recall': 0.5944732, 'specificity': 0.5944732, 'f1': 0.63577324, 'auroc': 0.7990322, 'binary_precision': 0.55803573, 'binary_recall': 0.19440125, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.28835064}
confusion matrix:
       0    1
0  18050   99
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9019174, 'precision': 0.869461, 'recall': 0.5914519, 'specificity': 0.5914519, 'f1': 0.6268979, 'auroc': 0.80114836, 'binary_precision': 0.83522725, 'binary_recall': 0.18773946, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.30656934}
confusion matrix:
      0    1
0  5968   29
1   636  147
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_9.png
better model found
persisted
after epoch: 9,now: 2024-06-18 23:14:40.186403,epoch time: 0:22:56.960451,used: 3:12:46.442777,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9890364, 'precision': 0.9843298, 'recall': 0.95077455, 'specificity': 0.95077455, 'f1': 0.96679676, 'auroc': 0.9954462, 'binary_precision': 0.97862935, 'binary_recall': 0.90360624, 'binary_specificity': 0.9979428, 'binary_f1_score': 0.93962264}
confusion matrix:
       0     1
0  42204    87
1    425  3984
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7549791, 'recall': 0.603281, 'specificity': 0.603281, 'f1': 0.6440567, 'auroc': 0.80285513, 'binary_precision': 0.5372549, 'binary_recall': 0.21306376, 'binary_specificity': 0.99349827, 'binary_f1_score': 0.3051225}
confusion matrix:
       0    1
0  18031  118
1    506  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90103245, 'precision': 0.8661431, 'recall': 0.58762044, 'specificity': 0.58762044, 'f1': 0.62134165, 'auroc': 0.80204284, 'binary_precision': 0.82941175, 'binary_recall': 0.18007663, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.29590768}
confusion matrix:
      0    1
0  5968   29
1   642  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_10.png
early stop counter: 1
val acc:0.9667943716049194, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9019173979759216 / 0.9063422083854675
after epoch: 10,now: 2024-06-18 23:33:34.591840,epoch time: 0:18:54.405437,used: 3:31:40.848214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98910064, 'precision': 0.98608947, 'recall': 0.9495232, 'specificity': 0.9495232, 'f1': 0.9669105, 'auroc': 0.99453044, 'binary_precision': 0.98244745, 'binary_recall': 0.9007253, 'binary_specificity': 0.99832106, 'binary_f1_score': 0.9398132}
confusion matrix:
       0     1
0  42217    71
1    438  3974
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.77295446, 'recall': 0.58783287, 'specificity': 0.58783287, 'f1': 0.62893546, 'auroc': 0.805011, 'binary_precision': 0.57425743, 'binary_recall': 0.18040435, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.27455622}
confusion matrix:
       0    1
0  18063   86
1    527  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89778763, 'precision': 0.8626821, 'recall': 0.57079595, 'specificity': 0.57079595, 'f1': 0.59636337, 'auroc': 0.78942806, 'binary_precision': 0.82608694, 'binary_recall': 0.14559387, 'binary_specificity': 0.995998, 'binary_f1_score': 0.247557}
confusion matrix:
      0    1
0  5973   24
1   669  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_11.png
better model found
persisted
after epoch: 11,now: 2024-06-18 23:57:01.038812,epoch time: 0:23:26.446972,used: 3:55:07.295186,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9900428, 'precision': 0.9839617, 'recall': 0.95713925, 'specificity': 0.95713925, 'f1': 0.97007006, 'auroc': 0.99468374, 'binary_precision': 0.97657007, 'binary_recall': 0.9165722, 'binary_specificity': 0.99770623, 'binary_f1_score': 0.9456205}
confusion matrix:
       0     1
0  42192    97
1    368  4043
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7478988, 'recall': 0.61436653, 'specificity': 0.61436653, 'f1': 0.6541461, 'auroc': 0.81586325, 'binary_precision': 0.5223368, 'binary_recall': 0.23639192, 'binary_specificity': 0.99234116, 'binary_f1_score': 0.3254818}
confusion matrix:
       0    1
0  18010  139
1    491  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90029496, 'precision': 0.8542576, 'recall': 0.58720356, 'specificity': 0.58720356, 'f1': 0.6203605, 'auroc': 0.79914975, 'binary_precision': 0.8057143, 'binary_recall': 0.18007663, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.29436323}
confusion matrix:
      0    1
0  5963   34
1   642  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_12.png
early stop counter: 1
val acc:0.9664750695228577, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.8977876305580139 / 0.9063422083854675
after epoch: 12,now: 2024-06-19 00:17:28.369900,epoch time: 0:20:27.331088,used: 4:15:34.626274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9909422, 'precision': 0.9880085, 'recall': 0.9585404, 'specificity': 0.9585404, 'f1': 0.9726987, 'auroc': 0.9964664, 'binary_precision': 0.9844471, 'binary_recall': 0.9185941, 'binary_specificity': 0.99848664, 'binary_f1_score': 0.9503813}
confusion matrix:
       0     1
0  42226    64
1    359  4051
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.76179254, 'recall': 0.5974183, 'specificity': 0.5974183, 'f1': 0.6386607, 'auroc': 0.82199574, 'binary_precision': 0.55128205, 'binary_recall': 0.20062208, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.2941847}
confusion matrix:
       0    1
0  18044  105
1    514  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8986726, 'precision': 0.8487375, 'recall': 0.5796241, 'specificity': 0.5796241, 'f1': 0.60927844, 'auroc': 0.81166893, 'binary_precision': 0.7962963, 'binary_recall': 0.16475096, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.2730159}
confusion matrix:
      0    1
0  5964   33
1   654  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_13.png
early stop counter: 2
val acc:0.9670604467391968, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.8977876305580139 / 0.9063422083854675
after epoch: 13,now: 2024-06-19 00:36:36.214259,epoch time: 0:19:07.844359,used: 4:34:42.470633,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99149895, 'precision': 0.9875242, 'recall': 0.96231735, 'specificity': 0.96231735, 'f1': 0.9745005, 'auroc': 0.99638385, 'binary_precision': 0.9826881, 'binary_recall': 0.92633724, 'binary_specificity': 0.9982974, 'binary_f1_score': 0.953681}
confusion matrix:
       0     1
0  42216    72
1    325  4087
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.76061887, 'recall': 0.5973908, 'specificity': 0.5973908, 'f1': 0.63847935, 'auroc': 0.8164568, 'binary_precision': 0.5489362, 'binary_recall': 0.20062208, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.29384968}
confusion matrix:
       0    1
0  18043  106
1    514  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8966077, 'precision': 0.84582615, 'recall': 0.5684634, 'specificity': 0.5684634, 'f1': 0.592524, 'auroc': 0.80457795, 'binary_precision': 0.79285717, 'binary_recall': 0.14176245, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.24052005}
confusion matrix:
      0    1
0  5968   29
1   672  111
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_14.png
early stop counter: 3
val acc:0.9670072197914124, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.8977876305580139 / 0.9063422083854675
after epoch: 14,now: 2024-06-19 01:00:08.080592,epoch time: 0:23:31.866333,used: 4:58:14.336966,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99100643, 'precision': 0.9877331, 'recall': 0.9591942, 'specificity': 0.9591942, 'f1': 0.97292376, 'auroc': 0.99572563, 'binary_precision': 0.98375756, 'binary_recall': 0.9199728, 'binary_specificity': 0.99841565, 'binary_f1_score': 0.9507966}
confusion matrix:
       0     1
0  42222    67
1    353  4058
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.7650691, 'recall': 0.5944732, 'specificity': 0.5944732, 'f1': 0.63577324, 'auroc': 0.8236225, 'binary_precision': 0.55803573, 'binary_recall': 0.19440125, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.28835064}
confusion matrix:
       0    1
0  18050   99
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89675516, 'precision': 0.842689, 'recall': 0.5702123, 'specificity': 0.5702123, 'f1': 0.5951374, 'auroc': 0.80698043, 'binary_precision': 0.7862069, 'binary_recall': 0.14559387, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.24568966}
confusion matrix:
      0    1
0  5966   31
1   669  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_15.png
early stop counter: 4
val acc:0.9671669006347656, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.8977876305580139 / 0.9063422083854675
after epoch: 15,now: 2024-06-19 01:22:26.840015,epoch time: 0:22:18.759423,used: 5:20:33.096389,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9916488, 'precision': 0.98628104, 'recall': 0.9644536, 'specificity': 0.9644536, 'f1': 0.9750521, 'auroc': 0.9964837, 'binary_precision': 0.97973776, 'binary_recall': 0.9309173, 'binary_specificity': 0.99798983, 'binary_f1_score': 0.9547038}
confusion matrix:
       0     1
0  42200    85
1    305  4110
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.74383175, 'recall': 0.60372806, 'specificity': 0.60372806, 'f1': 0.6428243, 'auroc': 0.83130217, 'binary_precision': 0.51492536, 'binary_recall': 0.21461898, 'binary_specificity': 0.9928371, 'binary_f1_score': 0.3029638}
confusion matrix:
       0    1
0  18019  130
1    505  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8980826, 'precision': 0.8391136, 'recall': 0.5792906, 'specificity': 0.5792906, 'f1': 0.6085358, 'auroc': 0.81898725, 'binary_precision': 0.77710843, 'binary_recall': 0.16475096, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.27186513}
confusion matrix:
      0    1
0  5960   37
1   654  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_16.png
early stop counter: 5
val acc:0.9662090539932251, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.8977876305580139 / 0.9063422083854675
after epoch: 16,now: 2024-06-19 01:47:13.819370,epoch time: 0:24:46.979355,used: 5:45:20.075744,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99152035, 'precision': 0.9865012, 'recall': 0.96345377, 'specificity': 0.96345377, 'f1': 0.97462595, 'auroc': 0.9953524, 'binary_precision': 0.98038745, 'binary_recall': 0.9288466, 'binary_specificity': 0.9980609, 'binary_f1_score': 0.9539214}
confusion matrix:
       0     1
0  42205    82
1    314  4099
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.7662835, 'recall': 0.6103621, 'specificity': 0.6103621, 'f1': 0.653162, 'auroc': 0.8247719, 'binary_precision': 0.55938697, 'binary_recall': 0.22706065, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.32300884}
confusion matrix:
       0    1
0  18034  115
1    497  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89749265, 'precision': 0.85048896, 'recall': 0.5722948, 'specificity': 0.5722948, 'f1': 0.5984302, 'auroc': 0.80774, 'binary_precision': 0.80136985, 'binary_recall': 0.14942528, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.25188375}
confusion matrix:
      0    1
0  5968   29
1   666  117
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_17.png
better model found
persisted
after epoch: 17,now: 2024-06-19 02:07:26.039934,epoch time: 0:20:12.220564,used: 6:05:32.296308,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99203426, 'precision': 0.98683524, 'recall': 0.96616554, 'specificity': 0.96616554, 'f1': 0.97621846, 'auroc': 0.99696136, 'binary_precision': 0.98049474, 'binary_recall': 0.93427014, 'binary_specificity': 0.99806094, 'binary_f1_score': 0.9568245}
confusion matrix:
       0     1
0  42206    82
1    290  4122
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7586351, 'recall': 0.6011135, 'specificity': 0.6011135, 'f1': 0.64226955, 'auroc': 0.83089733, 'binary_precision': 0.54471546, 'binary_recall': 0.20839813, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.30146232}
confusion matrix:
       0    1
0  18037  112
1    509  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8951327, 'precision': 0.83514524, 'recall': 0.56263286, 'specificity': 0.56263286, 'f1': 0.5833615, 'auroc': 0.8135188, 'binary_precision': 0.77272725, 'binary_recall': 0.1302682, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.22295083}
confusion matrix:
      0    1
0  5967   30
1   681  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_18.png
early stop counter: 1
val acc:0.9669540524482727, best validation acc: 0.967432975769043, corresponding to test acc:                         0.8974926471710205 / 0.9063422083854675
after epoch: 18,now: 2024-06-19 02:31:42.922482,epoch time: 0:24:16.882548,used: 6:29:49.178856,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9917559, 'precision': 0.9863399, 'recall': 0.96498144, 'specificity': 0.96498144, 'f1': 0.9753591, 'auroc': 0.99684477, 'binary_precision': 0.97973776, 'binary_recall': 0.9319728, 'binary_specificity': 0.9979901, 'binary_f1_score': 0.95525855}
confusion matrix:
       0     1
0  42205    85
1    300  4110
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.7633009, 'recall': 0.6050015, 'specificity': 0.6050015, 'f1': 0.6470863, 'auroc': 0.8294811, 'binary_precision': 0.55378485, 'binary_recall': 0.21617419, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.310962}
confusion matrix:
       0    1
0  18037  112
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89321536, 'precision': 0.81986594, 'recall': 0.55488664, 'specificity': 0.55488664, 'f1': 0.57095444, 'auroc': 0.8100022, 'binary_precision': 0.74380165, 'binary_recall': 0.11494253, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.19911504}
confusion matrix:
      0   1
0  5966  31
1   693  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_19.png
early stop counter: 2
val acc:0.9672200679779053, best validation acc: 0.967432975769043, corresponding to test acc:                         0.8974926471710205 / 0.9063422083854675
after epoch: 19,now: 2024-06-19 02:51:14.826869,epoch time: 0:19:31.904387,used: 6:49:21.083243,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99199146, 'precision': 0.987013, 'recall': 0.9657359, 'specificity': 0.9657359, 'f1': 0.97607565, 'auroc': 0.99673414, 'binary_precision': 0.9809433, 'binary_recall': 0.93336356, 'binary_specificity': 0.9981082, 'binary_f1_score': 0.95656216}
confusion matrix:
       0     1
0  42208    80
1    294  4118
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.75830114, 'recall': 0.5973357, 'specificity': 0.5973357, 'f1': 0.63811773, 'auroc': 0.8248271, 'binary_precision': 0.5443038, 'binary_recall': 0.20062208, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.29318184}
confusion matrix:
       0    1
0  18041  108
1    514  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89351034, 'precision': 0.8201593, 'recall': 0.556719, 'specificity': 0.556719, 'f1': 0.57388985, 'auroc': 0.7957833, 'binary_precision': 0.744, 'binary_recall': 0.118773945, 'binary_specificity': 0.994664, 'binary_f1_score': 0.20484582}
confusion matrix:
      0   1
0  5965  32
1   690  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_20.png
early stop counter: 3
val acc:0.9669008255004883, best validation acc: 0.967432975769043, corresponding to test acc:                         0.8974926471710205 / 0.9063422083854675
after epoch: 20,now: 2024-06-19 03:05:11.385485,epoch time: 0:13:56.558616,used: 7:03:17.641859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.991606, 'precision': 0.9854262, 'recall': 0.96501553, 'specificity': 0.96501553, 'f1': 0.97494507, 'auroc': 0.9967945, 'binary_precision': 0.9778887, 'binary_recall': 0.9322303, 'binary_specificity': 0.99780077, 'binary_f1_score': 0.9545137}
confusion matrix:
       0     1
0  42195    93
1    299  4113
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.7646109, 'recall': 0.5959733, 'specificity': 0.5959733, 'f1': 0.63740635, 'auroc': 0.8300395, 'binary_precision': 0.55701756, 'binary_recall': 0.19751166, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.29161882}
confusion matrix:
       0    1
0  18048  101
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89247787, 'precision': 0.8223921, 'recall': 0.54947305, 'specificity': 0.54947305, 'f1': 0.5621381, 'auroc': 0.80039555, 'binary_precision': 0.75, 'binary_recall': 0.10344828, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.18181819}
confusion matrix:
      0   1
0  5970  27
1   702  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_21.png
early stop counter: 4
val acc:0.9671669006347656, best validation acc: 0.967432975769043, corresponding to test acc:                         0.8974926471710205 / 0.9063422083854675
after epoch: 21,now: 2024-06-19 03:20:22.868833,epoch time: 0:15:11.483348,used: 7:18:29.125207,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9926338, 'precision': 0.9891839, 'recall': 0.96741015, 'specificity': 0.96741015, 'f1': 0.9779855, 'auroc': 0.9970045, 'binary_precision': 0.98497856, 'binary_recall': 0.93631005, 'binary_specificity': 0.99851024, 'binary_f1_score': 0.9600279}
confusion matrix:
       0     1
0  42225    63
1    281  4131
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7574737, 'recall': 0.60711396, 'specificity': 0.60711396, 'f1': 0.6484407, 'auroc': 0.83470637, 'binary_precision': 0.54198474, 'binary_recall': 0.22083981, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.31381217}
confusion matrix:
       0    1
0  18029  120
1    501  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8942478, 'precision': 0.81830055, 'recall': 0.5621326, 'specificity': 0.5621326, 'f1': 0.5823846, 'auroc': 0.81865007, 'binary_precision': 0.73913044, 'binary_recall': 0.1302682, 'binary_specificity': 0.993997, 'binary_f1_score': 0.22149837}
confusion matrix:
      0    1
0  5961   36
1   681  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_22.png
early stop counter: 5
val acc:0.9669540524482727, best validation acc: 0.967432975769043, corresponding to test acc:                         0.8974926471710205 / 0.9063422083854675
after epoch: 22,now: 2024-06-19 03:32:08.727282,epoch time: 0:11:45.858449,used: 7:30:14.983656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99312633, 'precision': 0.9903245, 'recall': 0.96920466, 'specificity': 0.96920466, 'f1': 0.9794724, 'auroc': 0.9971889, 'binary_precision': 0.9869079, 'binary_recall': 0.9397099, 'binary_specificity': 0.99869937, 'binary_f1_score': 0.96273077}
confusion matrix:
       0     1
0  42233    55
1    266  4146
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.76530516, 'recall': 0.5937231, 'specificity': 0.5937231, 'f1': 0.63495094, 'auroc': 0.8242432, 'binary_precision': 0.5585586, 'binary_recall': 0.19284603, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.2867052}
confusion matrix:
       0    1
0  18051   98
1    519  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89129794, 'precision': 0.80755115, 'recall': 0.5454749, 'specificity': 0.5454749, 'f1': 0.55547714, 'auroc': 0.80059236, 'binary_precision': 0.72115386, 'binary_recall': 0.09578544, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.16910936}
confusion matrix:
      0   1
0  5968  29
1   708  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_23.png
early stop counter: 6
val acc:0.9671669006347656, best validation acc: 0.967432975769043, corresponding to test acc:                         0.8974926471710205 / 0.9063422083854675
after epoch: 23,now: 2024-06-19 03:43:22.638251,epoch time: 0:11:13.910969,used: 7:41:28.894625,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9928051, 'precision': 0.98991805, 'recall': 0.9677149, 'specificity': 0.9677149, 'f1': 0.978493, 'auroc': 0.9971826, 'binary_precision': 0.9863994, 'binary_recall': 0.9367777, 'binary_specificity': 0.99865204, 'binary_f1_score': 0.9609484}
confusion matrix:
       0     1
0  42230    57
1    279  4134
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.77640605, 'recall': 0.5954712, 'specificity': 0.5954712, 'f1': 0.63823366, 'auroc': 0.8245281, 'binary_precision': 0.58064514, 'binary_recall': 0.19595645, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.29302323}
confusion matrix:
       0    1
0  18058   91
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8896755, 'precision': 0.79894567, 'recall': 0.5362298, 'specificity': 0.5362298, 'f1': 0.539657, 'auroc': 0.7935052, 'binary_precision': 0.7058824, 'binary_recall': 0.07662835, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.13824885}
confusion matrix:
      0   1
0  5972  25
1   723  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_24.png
better model found
persisted
after epoch: 24,now: 2024-06-19 03:54:31.974311,epoch time: 0:11:09.336060,used: 7:52:38.230685,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9927409, 'precision': 0.9871999, 'recall': 0.97001994, 'specificity': 0.97001994, 'f1': 0.97841585, 'auroc': 0.99725366, 'binary_precision': 0.9804292, 'binary_recall': 0.9420027, 'binary_specificity': 0.99803716, 'binary_f1_score': 0.9608319}
confusion matrix:
       0     1
0  42203    83
1    256  4158
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.75507504, 'recall': 0.609309, 'specificity': 0.609309, 'f1': 0.6503227, 'auroc': 0.83134985, 'binary_precision': 0.537037, 'binary_recall': 0.22550544, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.31763417}
confusion matrix:
       0    1
0  18024  125
1    498  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8918879, 'precision': 0.7899852, 'recall': 0.55580187, 'specificity': 0.55580187, 'f1': 0.572204, 'auroc': 0.8042888, 'binary_precision': 0.6838235, 'binary_recall': 0.118773945, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.2023939}
confusion matrix:
      0   1
0  5954  43
1   690  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_25.png
early stop counter: 1
val acc:0.9668475985527039, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.889675498008728 / 0.9063422083854675
after epoch: 25,now: 2024-06-19 04:05:26.415197,epoch time: 0:10:54.440886,used: 8:03:32.671571,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9925054, 'precision': 0.9917411, 'recall': 0.9641766, 'specificity': 0.9641766, 'f1': 0.97746027, 'auroc': 0.99679494, 'binary_precision': 0.99081236, 'binary_recall': 0.92925173, 'binary_specificity': 0.99910146, 'binary_f1_score': 0.9590452}
confusion matrix:
       0     1
0  42252    38
1    312  4098
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.77220637, 'recall': 0.58630526, 'specificity': 0.58630526, 'f1': 0.62703633, 'auroc': 0.8210387, 'binary_precision': 0.5728643, 'binary_recall': 0.17729394, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.27078384}
confusion matrix:
       0    1
0  18064   85
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8921829, 'precision': 0.8296749, 'recall': 0.5459751, 'specificity': 0.5459751, 'f1': 0.5563033, 'auroc': 0.79059577, 'binary_precision': 0.7653061, 'binary_recall': 0.09578544, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.17026107}
confusion matrix:
      0   1
0  5974  23
1   708  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_26.png
early stop counter: 2
val acc:0.9673265218734741, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.889675498008728 / 0.9063422083854675
after epoch: 26,now: 2024-06-19 04:19:13.674426,epoch time: 0:13:47.259229,used: 8:17:19.930800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9926338, 'precision': 0.98949647, 'recall': 0.9671056, 'specificity': 0.9671056, 'f1': 0.9779717, 'auroc': 0.9974917, 'binary_precision': 0.98567337, 'binary_recall': 0.9356301, 'binary_specificity': 0.9985812, 'binary_f1_score': 0.96}
confusion matrix:
       0     1
0  42228    60
1    284  4128
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.7783541, 'recall': 0.58869314, 'specificity': 0.58869314, 'f1': 0.6305023, 'auroc': 0.8281503, 'binary_precision': 0.585, 'binary_recall': 0.18195957, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.27758005}
confusion matrix:
       0    1
0  18066   83
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.890118, 'precision': 0.7915569, 'recall': 0.54147667, 'specificity': 0.54147667, 'f1': 0.5487588, 'auroc': 0.80193245, 'binary_precision': 0.69, 'binary_recall': 0.08812261, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.15628539}
confusion matrix:
      0   1
0  5966  31
1   714  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_27.png
early stop counter: 3
val acc:0.9675925970077515, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.889675498008728 / 0.9063422083854675
after epoch: 27,now: 2024-06-19 04:32:44.530401,epoch time: 0:13:30.855975,used: 8:30:50.786775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9926767, 'precision': 0.98900485, 'recall': 0.9678469, 'specificity': 0.9678469, 'f1': 0.9781317, 'auroc': 0.9970102, 'binary_precision': 0.98452747, 'binary_recall': 0.9372309, 'binary_specificity': 0.99846286, 'binary_f1_score': 0.96029717}
confusion matrix:
       0     1
0  42222    65
1    277  4136
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.7646109, 'recall': 0.5959733, 'specificity': 0.5959733, 'f1': 0.63740635, 'auroc': 0.83614737, 'binary_precision': 0.55701756, 'binary_recall': 0.19751166, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.29161882}
confusion matrix:
       0    1
0  18048  101
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89321536, 'precision': 0.81986594, 'recall': 0.55488664, 'specificity': 0.55488664, 'f1': 0.57095444, 'auroc': 0.81296337, 'binary_precision': 0.74380165, 'binary_recall': 0.11494253, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.19911504}
confusion matrix:
      0   1
0  5966  31
1   693  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_28.png
early stop counter: 4
val acc:0.9671669006347656, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.889675498008728 / 0.9063422083854675
after epoch: 28,now: 2024-06-19 04:44:15.752561,epoch time: 0:11:31.222160,used: 8:42:22.008935,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9927623, 'precision': 0.98740643, 'recall': 0.9698974, 'specificity': 0.9698974, 'f1': 0.9784504, 'auroc': 0.99751234, 'binary_precision': 0.98086464, 'binary_recall': 0.9417101, 'binary_specificity': 0.9980847, 'binary_f1_score': 0.9608887}
confusion matrix:
       0     1
0  42210    81
1    257  4152
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.75830114, 'recall': 0.5973357, 'specificity': 0.5973357, 'f1': 0.63811773, 'auroc': 0.83721244, 'binary_precision': 0.5443038, 'binary_recall': 0.20062208, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.29318184}
confusion matrix:
       0    1
0  18041  108
1    514  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8926254, 'precision': 0.81925905, 'recall': 0.55122197, 'specificity': 0.55122197, 'f1': 0.5650071, 'auroc': 0.81093854, 'binary_precision': 0.74336284, 'binary_recall': 0.107279696, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.18749999}
confusion matrix:
      0   1
0  5968  29
1   699  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_29.png
early stop counter: 5
val acc:0.9669008255004883, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.889675498008728 / 0.9063422083854675
after epoch: 29,now: 2024-06-19 04:55:25.731040,epoch time: 0:11:09.978479,used: 8:53:31.987414,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99293363, 'precision': 0.9905179, 'recall': 0.96787304, 'specificity': 0.96787304, 'f1': 0.9788593, 'auroc': 0.9973943, 'binary_precision': 0.9875747, 'binary_recall': 0.9369757, 'binary_specificity': 0.99877036, 'binary_f1_score': 0.96161}
confusion matrix:
       0     1
0  42237    52
1    278  4133
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.76628435, 'recall': 0.5869451, 'specificity': 0.5869451, 'f1': 0.6272018, 'auroc': 0.8327199, 'binary_precision': 0.5609756, 'binary_recall': 0.17884915, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.2712264}
confusion matrix:
       0    1
0  18059   90
1    528  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8914454, 'precision': 0.8049575, 'recall': 0.5472238, 'specificity': 0.5472238, 'f1': 0.5583944, 'auroc': 0.79948086, 'binary_precision': 0.7155963, 'binary_recall': 0.099616855, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.17488788}
confusion matrix:
      0   1
0  5966  31
1   705  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_30.png
early stop counter: 6
val acc:0.9671136736869812, best validation acc: 0.9676458239555359, corresponding to test acc:                         0.889675498008728 / 0.9063422083854675
after epoch: 30,now: 2024-06-19 05:06:57.850802,epoch time: 0:11:32.119762,used: 9:05:04.107176,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_20_01_53_seed_0_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:05:04.107176 at 2024-06-19 05:06:57.850802
persisted model performance metric: 

scalar performance:
{'acc': 0.8896755, 'precision': 0.79894567, 'recall': 0.5362298, 'specificity': 0.5362298, 'f1': 0.539657, 'auroc': 0.7935052, 'binary_precision': 0.7058824, 'binary_recall': 0.07662835, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.13824885}
confusion matrix:
      0   1
0  5972  25
1   723  60
oracle model performance metric: 

scalar performance:
{'acc': 0.9063422, 'precision': 0.8786239, 'recall': 0.6122745, 'specificity': 0.6122745, 'f1': 0.65563595, 'auroc': 0.7993959, 'binary_precision': 0.8490566, 'binary_recall': 0.22988506, 'binary_specificity': 0.994664, 'binary_f1_score': 0.36180902}
confusion matrix:
      0    1
0  5965   32
1   603  180
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204211 KiB |   1436 MiB | 428252 GiB | 428252 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 428173 GiB | 428173 GiB |
|       from small pool |  36275 KiB |     72 MiB |     78 GiB |     78 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204211 KiB |   1436 MiB | 428252 GiB | 428252 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 428173 GiB | 428173 GiB |
|       from small pool |  36275 KiB |     72 MiB |     78 GiB |     78 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201112 KiB |   1428 MiB | 428227 GiB | 428227 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 428151 GiB | 428151 GiB |
|       from small pool |  35992 KiB |     71 MiB |     75 GiB |     75 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320076 KiB | 628877 KiB | 319528 GiB | 319528 GiB |
|       from large pool | 311296 KiB | 627520 KiB | 319443 GiB | 319443 GiB |
|       from small pool |   8780 KiB |  12547 KiB |     85 GiB |     85 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1308    |    1965    |   14080 K  |   14079 K  |
|       from large pool |      36    |      76    |    5616 K  |    5616 K  |
|       from small pool |    1272    |    1894    |    8464 K  |    8462 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1308    |    1965    |   14080 K  |   14079 K  |
|       from large pool |      36    |      76    |    5616 K  |    5616 K  |
|       from small pool |    1272    |    1894    |    8464 K  |    8462 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |     479    |    7460 K  |    7460 K  |
|       from large pool |       5    |      10    |    2087 K  |    2087 K  |
|       from small pool |      26    |     474    |    5373 K  |    5373 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 428252 GiB | 428252 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 428173 GiB | 428173 GiB |
|       from small pool |      0 KiB |     72 MiB |     78 GiB |     78 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 428252 GiB | 428252 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 428173 GiB | 428173 GiB |
|       from small pool |      0 KiB |     72 MiB |     78 GiB |     78 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 428227 GiB | 428227 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 428151 GiB | 428151 GiB |
|       from small pool |      0 KiB |     71 MiB |     75 GiB |     75 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 628877 KiB | 319529 GiB | 319528 GiB |
|       from large pool | 298752 KiB | 627520 KiB | 319443 GiB | 319443 GiB |
|       from small pool |      0 KiB |  16375 KiB |     85 GiB |     85 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1965    |   14080 K  |   14080 K  |
|       from large pool |       2    |      76    |    5616 K  |    5616 K  |
|       from small pool |       0    |    1894    |    8464 K  |    8464 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1965    |   14080 K  |   14080 K  |
|       from large pool |       2    |      76    |    5616 K  |    5616 K  |
|       from small pool |       0    |    1894    |    8464 K  |    8464 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     479    |    7461 K  |    7461 K  |
|       from large pool |       1    |      11    |    2087 K  |    2087 K  |
|       from small pool |       0    |     474    |    5373 K  |    5373 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 428252 GiB | 428252 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 428173 GiB | 428173 GiB |
|       from small pool |      0 KiB |     72 MiB |     78 GiB |     78 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 428252 GiB | 428252 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 428173 GiB | 428173 GiB |
|       from small pool |      0 KiB |     72 MiB |     78 GiB |     78 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 428227 GiB | 428227 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 428151 GiB | 428151 GiB |
|       from small pool |      0 KiB |     71 MiB |     75 GiB |     75 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 628877 KiB | 319529 GiB | 319528 GiB |
|       from large pool | 298752 KiB | 627520 KiB | 319443 GiB | 319443 GiB |
|       from small pool |      0 KiB |  16375 KiB |     85 GiB |     85 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1965    |   14080 K  |   14080 K  |
|       from large pool |       2    |      76    |    5616 K  |    5616 K  |
|       from small pool |       0    |    1894    |    8464 K  |    8464 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1965    |   14080 K  |   14080 K  |
|       from large pool |       2    |      76    |    5616 K  |    5616 K  |
|       from small pool |       0    |    1894    |    8464 K  |    8464 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     479    |    7461 K  |    7461 K  |
|       from large pool |       1    |      11    |    2087 K  |    2087 K  |
|       from small pool |       0    |     474    |    5373 K  |    5373 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647

 Experiment start at: 2024-06-19 05:11:40.220741
before training, model accuracy: 0.2048765867948532
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9463169, 'precision': 0.9277071, 'recall': 0.7314772, 'specificity': 0.7314772, 'f1': 0.7942221, 'auroc': 0.9502492, 'binary_precision': 0.9071332, 'binary_recall': 0.46783897, 'binary_specificity': 0.9951154, 'binary_f1_score': 0.61731035}
confusion matrix:
       0     1
0  42171   207
1   2300  2022
---- Validation: 
scalar performance:
{'acc': 0.96350056, 'precision': 0.52051955, 'recall': 0.50041085, 'specificity': 0.50041085, 'f1': 0.49216273, 'auroc': 0.5629747, 'binary_precision': 0.07692308, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9993358, 'binary_f1_score': 0.002915452}
confusion matrix:
       0   1
0  18055  12
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88403213, 'precision': 0.44201607, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4692235, 'auroc': 0.60315335, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   780  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-19 05:23:17.105927,epoch time: 0:11:36.885186,used: 0:11:36.885186,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97226983, 'precision': 0.9807865, 'recall': 0.8531979, 'specificity': 0.8531979, 'f1': 0.905053, 'auroc': 0.9740428, 'binary_precision': 0.9905997, 'binary_recall': 0.70708007, 'binary_specificity': 0.9993157, 'binary_f1_score': 0.8251654}
confusion matrix:
       0     1
0  42349    29
1   1266  3056
---- Validation: 
scalar performance:
{'acc': 0.96542156, 'precision': 0.79935074, 'recall': 0.5436079, 'specificity': 0.5436079, 'f1': 0.5692995, 'auroc': 0.66845167, 'binary_precision': 0.6315789, 'binary_recall': 0.089153044, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.15624999}
confusion matrix:
       0   1
0  18032  35
1    613  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8874517, 'precision': 0.8278328, 'recall': 0.52031296, 'specificity': 0.52031296, 'f1': 0.5101265, 'auroc': 0.71073055, 'binary_precision': 0.76744187, 'binary_recall': 0.042307694, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.08019441}
confusion matrix:
      0   1
0  5936  10
1   747  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-19 05:35:59.211264,epoch time: 0:12:42.105337,used: 0:24:18.990523,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97995716, 'precision': 0.98067176, 'recall': 0.89846957, 'specificity': 0.89846957, 'f1': 0.9348211, 'auroc': 0.9840423, 'binary_precision': 0.9815131, 'binary_recall': 0.79847294, 'binary_specificity': 0.9984662, 'binary_f1_score': 0.88058174}
confusion matrix:
       0     1
0  42313    65
1    871  3451
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.7803315, 'recall': 0.5774469, 'specificity': 0.5774469, 'f1': 0.61655575, 'auroc': 0.7181579, 'binary_precision': 0.59116024, 'binary_recall': 0.1589896, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.25058547}
confusion matrix:
       0    1
0  17993   74
1    566  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8986024, 'precision': 0.8879764, 'recall': 0.57173145, 'specificity': 0.57173145, 'f1': 0.5980861, 'auroc': 0.7594678, 'binary_precision': 0.8769231, 'binary_recall': 0.14615385, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.2505495}
confusion matrix:
      0    1
0  5930   16
1   666  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-19 05:47:53.658912,epoch time: 0:11:54.447648,used: 0:36:13.438171,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98222697, 'precision': 0.9800997, 'recall': 0.9125185, 'specificity': 0.9125185, 'f1': 0.9431367, 'auroc': 0.986597, 'binary_precision': 0.97757727, 'binary_recall': 0.826972, 'binary_specificity': 0.998065, 'binary_f1_score': 0.89599}
confusion matrix:
       0     1
0  42295    82
1    748  3575
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.78435636, 'recall': 0.5927165, 'specificity': 0.5927165, 'f1': 0.6356848, 'auroc': 0.7548692, 'binary_precision': 0.5981308, 'binary_recall': 0.19019316, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.2886133}
confusion matrix:
       0    1
0  17981   86
1    545  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9046982, 'precision': 0.89059734, 'recall': 0.6019121, 'specificity': 0.6019121, 'f1': 0.64220893, 'auroc': 0.7779263, 'binary_precision': 0.8756757, 'binary_recall': 0.20769231, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.3357513}
confusion matrix:
      0    1
0  5923   23
1   618  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-19 06:00:46.845220,epoch time: 0:12:53.186308,used: 0:49:06.624479,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98359746, 'precision': 0.9810296, 'recall': 0.9199573, 'specificity': 0.9199573, 'f1': 0.9479232, 'auroc': 0.98820066, 'binary_precision': 0.9779748, 'binary_recall': 0.8418497, 'binary_specificity': 0.9980649, 'binary_f1_score': 0.90482104}
confusion matrix:
       0     1
0  42293    82
1    684  3641
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.7762636, 'recall': 0.5896618, 'specificity': 0.5896618, 'f1': 0.63123757, 'auroc': 0.7662421, 'binary_precision': 0.58215964, 'binary_recall': 0.18424962, 'binary_specificity': 0.9950739, 'binary_f1_score': 0.2799097}
confusion matrix:
       0    1
0  17978   89
1    549  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90752304, 'precision': 0.89956045, 'recall': 0.6135346, 'specificity': 0.6135346, 'f1': 0.6583595, 'auroc': 0.7941427, 'binary_precision': 0.8910891, 'binary_recall': 0.23076923, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.36659878}
confusion matrix:
      0    1
0  5924   22
1   600  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_5.png
new oracle model saved
early stop counter: 1
val acc:0.9659551978111267, best validation acc: 0.9663286805152893, corresponding to test acc:                         0.9046981930732727 / 0.9075230360031128
after epoch: 5,now: 2024-06-19 06:12:51.667180,epoch time: 0:12:04.821960,used: 1:01:11.446439,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9853105, 'precision': 0.98437214, 'recall': 0.9271836, 'specificity': 0.9271836, 'f1': 0.9535502, 'auroc': 0.99118197, 'binary_precision': 0.9832536, 'binary_recall': 0.8558538, 'binary_specificity': 0.9985134, 'binary_f1_score': 0.91514105}
confusion matrix:
       0     1
0  42315    63
1    623  3699
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.7896994, 'recall': 0.5848486, 'specificity': 0.5848486, 'f1': 0.6266434, 'auroc': 0.78608215, 'binary_precision': 0.609375, 'binary_recall': 0.17384844, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.2705202}
confusion matrix:
       0    1
0  17992   75
1    556  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90603626, 'precision': 0.9063071, 'recall': 0.6043397, 'specificity': 0.6043397, 'f1': 0.6462174, 'auroc': 0.8119925, 'binary_precision': 0.9065934, 'binary_recall': 0.21153846, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.34303534}
confusion matrix:
      0    1
0  5929   17
1   615  165
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_6.png
early stop counter: 2
val acc:0.9663286805152893, best validation acc: 0.9663286805152893, corresponding to test acc:                         0.9046981930732727 / 0.9075230360031128
after epoch: 6,now: 2024-06-19 06:24:40.093349,epoch time: 0:11:48.426169,used: 1:12:59.872608,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98734474, 'precision': 0.98186886, 'recall': 0.94170606, 'specificity': 0.94170606, 'f1': 0.96069854, 'auroc': 0.992761, 'binary_precision': 0.9752866, 'binary_recall': 0.88570106, 'binary_specificity': 0.99771106, 'binary_f1_score': 0.9283376}
confusion matrix:
       0     1
0  42281    97
1    494  3828
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.79727983, 'recall': 0.5951391, 'specificity': 0.5951391, 'f1': 0.6398736, 'auroc': 0.78403914, 'binary_precision': 0.6238095, 'binary_recall': 0.19465081, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.29671574}
confusion matrix:
       0    1
0  17988   79
1    542  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90767175, 'precision': 0.9017842, 'recall': 0.61361873, 'specificity': 0.61361873, 'f1': 0.65858847, 'auroc': 0.79738027, 'binary_precision': 0.8955224, 'binary_recall': 0.23076923, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.36697248}
confusion matrix:
      0    1
0  5925   21
1   600  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-19 06:36:15.381093,epoch time: 0:11:35.287744,used: 1:24:35.160352,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98713064, 'precision': 0.98216563, 'recall': 0.9401472, 'specificity': 0.9401472, 'f1': 0.95996344, 'auroc': 0.99246716, 'binary_precision': 0.97620267, 'binary_recall': 0.882489, 'binary_specificity': 0.9978054, 'binary_f1_score': 0.9269834}
confusion matrix:
       0     1
0  42284    93
1    508  3815
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.78455216, 'recall': 0.5970635, 'specificity': 0.5970635, 'f1': 0.64079, 'auroc': 0.8002567, 'binary_precision': 0.59821427, 'binary_recall': 0.19910847, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.29877368}
confusion matrix:
       0    1
0  17977   90
1    539  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90677965, 'precision': 0.8940916, 'recall': 0.6114434, 'specificity': 0.6114434, 'f1': 0.65528977, 'auroc': 0.81538403, 'binary_precision': 0.880597, 'binary_recall': 0.22692308, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.36085624}
confusion matrix:
      0    1
0  5922   24
1   603  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_8.png
early stop counter: 1
val acc:0.966435432434082, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9076717495918274 / 0.9076717495918274
after epoch: 8,now: 2024-06-19 06:47:50.062893,epoch time: 0:11:34.681800,used: 1:36:09.842152,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9880942, 'precision': 0.97928333, 'recall': 0.9487679, 'specificity': 0.9487679, 'f1': 0.96339834, 'auroc': 0.99510264, 'binary_precision': 0.9686411, 'binary_recall': 0.900509, 'binary_specificity': 0.99702674, 'binary_f1_score': 0.9333333}
confusion matrix:
       0     1
0  42252   126
1    430  3892
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.77596796, 'recall': 0.6127717, 'specificity': 0.6127717, 'f1': 0.656984, 'auroc': 0.8154754, 'binary_precision': 0.57992566, 'binary_recall': 0.23179792, 'binary_specificity': 0.9937455, 'binary_f1_score': 0.3312102}
confusion matrix:
       0    1
0  17954  113
1    517  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9103479, 'precision': 0.89255726, 'recall': 0.63016963, 'specificity': 0.63016963, 'f1': 0.67929375, 'auroc': 0.82195836, 'binary_precision': 0.87341774, 'binary_recall': 0.2653846, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.40707967}
confusion matrix:
      0    1
0  5916   30
1   573  207
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_9.png
new oracle model saved
early stop counter: 2
val acc:0.9663820862770081, best validation acc: 0.9668623208999634, corresponding to test acc:                         0.9076717495918274 / 0.9103478789329529
after epoch: 9,now: 2024-06-19 06:59:39.639368,epoch time: 0:11:49.576475,used: 1:47:59.418627,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98890793, 'precision': 0.984792, 'recall': 0.94842017, 'specificity': 0.94842017, 'f1': 0.96572185, 'auroc': 0.99450326, 'binary_precision': 0.9798336, 'binary_recall': 0.8987283, 'binary_specificity': 0.9981121, 'binary_f1_score': 0.9375301}
confusion matrix:
       0     1
0  42295    80
1    438  3887
---- Validation: 
scalar performance:
{'acc': 0.9671825, 'precision': 0.8045037, 'recall': 0.597451, 'specificity': 0.597451, 'f1': 0.64335304, 'auroc': 0.8012536, 'binary_precision': 0.63809526, 'binary_recall': 0.19910847, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.30351073}
confusion matrix:
       0    1
0  17991   76
1    539  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9000892, 'precision': 0.88050187, 'recall': 0.5809264, 'specificity': 0.5809264, 'f1': 0.6118769, 'auroc': 0.8029145, 'binary_precision': 0.86, 'binary_recall': 0.16538462, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.27741936}
confusion matrix:
      0    1
0  5925   21
1   651  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_10.png
better model found
persisted
after epoch: 10,now: 2024-06-19 07:11:30.908801,epoch time: 0:11:51.269433,used: 1:59:50.688060,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98929334, 'precision': 0.98396254, 'recall': 0.9515392, 'specificity': 0.9515392, 'f1': 0.96704924, 'auroc': 0.99540377, 'binary_precision': 0.9775281, 'binary_recall': 0.9052023, 'binary_specificity': 0.9978761, 'binary_f1_score': 0.939976}
confusion matrix:
       0     1
0  42285    90
1    410  3915
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.78455216, 'recall': 0.5970635, 'specificity': 0.5970635, 'f1': 0.64079, 'auroc': 0.81707764, 'binary_precision': 0.59821427, 'binary_recall': 0.19910847, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.29877368}
confusion matrix:
       0    1
0  17977   90
1    539  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90098125, 'precision': 0.87092376, 'recall': 0.5881142, 'specificity': 0.5881142, 'f1': 0.62210274, 'auroc': 0.8283033, 'binary_precision': 0.83928573, 'binary_recall': 0.18076923, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.29746836}
confusion matrix:
      0    1
0  5919   27
1   639  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_11.png
early stop counter: 1
val acc:0.966435432434082, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9000892043113708 / 0.9103478789329529
after epoch: 11,now: 2024-06-19 07:23:38.127516,epoch time: 0:12:07.218715,used: 2:11:57.906775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99029976, 'precision': 0.985479, 'recall': 0.9560828, 'specificity': 0.9560828, 'f1': 0.97020787, 'auroc': 0.9949871, 'binary_precision': 0.9796526, 'binary_recall': 0.91410047, 'binary_specificity': 0.9980652, 'binary_f1_score': 0.945742}
confusion matrix:
       0     1
0  42299    82
1    371  3948
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.80024815, 'recall': 0.59156275, 'specificity': 0.59156275, 'f1': 0.6358479, 'auroc': 0.81166923, 'binary_precision': 0.63, 'binary_recall': 0.1872214, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.28865978}
confusion matrix:
       0    1
0  17993   74
1    547  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89830506, 'precision': 0.86652994, 'recall': 0.5749049, 'specificity': 0.5749049, 'f1': 0.60257125, 'auroc': 0.8075814, 'binary_precision': 0.8333333, 'binary_recall': 0.15384616, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.2597403}
confusion matrix:
      0    1
0  5922   24
1   660  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_12.png
early stop counter: 2
val acc:0.9668623208999634, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9000892043113708 / 0.9103478789329529
after epoch: 12,now: 2024-06-19 07:37:39.713922,epoch time: 0:14:01.586406,used: 2:25:59.493181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9904925, 'precision': 0.98572063, 'recall': 0.95704985, 'specificity': 0.95704985, 'f1': 0.9708408, 'auroc': 0.99628675, 'binary_precision': 0.9799505, 'binary_recall': 0.9160111, 'binary_specificity': 0.99808866, 'binary_f1_score': 0.9469027}
confusion matrix:
       0     1
0  42297    81
1    363  3959
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.7925612, 'recall': 0.5914244, 'specificity': 0.5914244, 'f1': 0.6349565, 'auroc': 0.81624377, 'binary_precision': 0.61463416, 'binary_recall': 0.1872214, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.28701591}
confusion matrix:
       0    1
0  17988   79
1    547  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8962236, 'precision': 0.8520142, 'recall': 0.56704444, 'specificity': 0.56704444, 'f1': 0.59032655, 'auroc': 0.80885327, 'binary_precision': 0.80597013, 'binary_recall': 0.13846155, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.23632386}
confusion matrix:
      0    1
0  5920   26
1   672  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_13.png
early stop counter: 3
val acc:0.9665955305099487, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9000892043113708 / 0.9103478789329529
after epoch: 13,now: 2024-06-19 07:51:39.446914,epoch time: 0:13:59.732992,used: 2:39:59.226173,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9911349, 'precision': 0.9848802, 'recall': 0.96178424, 'specificity': 0.96178424, 'f1': 0.9729798, 'auroc': 0.9965894, 'binary_precision': 0.9772949, 'binary_recall': 0.9257632, 'binary_specificity': 0.99780536, 'binary_f1_score': 0.9508314}
confusion matrix:
       0     1
0  42283    93
1    321  4003
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.78732497, 'recall': 0.6014658, 'specificity': 0.6014658, 'f1': 0.646152, 'auroc': 0.8258064, 'binary_precision': 0.6034483, 'binary_recall': 0.20802377, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.30939224}
confusion matrix:
       0    1
0  17975   92
1    533  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8981564, 'precision': 0.8461093, 'recall': 0.57983327, 'specificity': 0.57983327, 'f1': 0.6094172, 'auroc': 0.8195731, 'binary_precision': 0.79141104, 'binary_recall': 0.16538462, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.2735949}
confusion matrix:
      0    1
0  5912   34
1   651  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_14.png
early stop counter: 4
val acc:0.9666488766670227, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9000892043113708 / 0.9103478789329529
after epoch: 14,now: 2024-06-19 08:04:27.440752,epoch time: 0:12:47.993838,used: 2:52:47.220011,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9907923, 'precision': 0.9868847, 'recall': 0.95773447, 'specificity': 0.95773447, 'f1': 0.971748, 'auroc': 0.9949744, 'binary_precision': 0.98216057, 'binary_recall': 0.91716796, 'binary_specificity': 0.998301, 'binary_f1_score': 0.9485523}
confusion matrix:
       0     1
0  42306    72
1    358  3964
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.80569744, 'recall': 0.58584064, 'specificity': 0.58584064, 'f1': 0.6292113, 'auroc': 0.8185235, 'binary_precision': 0.6413044, 'binary_recall': 0.17533432, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.2753792}
confusion matrix:
       0    1
0  18001   66
1    555  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8950342, 'precision': 0.8550242, 'recall': 0.5596885, 'specificity': 0.5596885, 'f1': 0.57878566, 'auroc': 0.804478, 'binary_precision': 0.8135593, 'binary_recall': 0.12307692, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.21380846}
confusion matrix:
      0   1
0  5924  22
1   684  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_15.png
early stop counter: 5
val acc:0.9668623208999634, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9000892043113708 / 0.9103478789329529
after epoch: 15,now: 2024-06-19 08:16:07.255389,epoch time: 0:11:39.814637,used: 3:04:27.034648,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99139184, 'precision': 0.9885693, 'recall': 0.9597453, 'specificity': 0.9597453, 'f1': 0.9736104, 'auroc': 0.9956969, 'binary_precision': 0.9851559, 'binary_recall': 0.92090654, 'binary_specificity': 0.9985841, 'binary_f1_score': 0.9519484}
confusion matrix:
       0     1
0  42316    60
1    342  3982
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.79496163, 'recall': 0.58638984, 'specificity': 0.58638984, 'f1': 0.6290102, 'auroc': 0.8267578, 'binary_precision': 0.6197917, 'binary_recall': 0.1768202, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.2751445}
confusion matrix:
       0    1
0  17994   73
1    554  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8942908, 'precision': 0.83844924, 'recall': 0.55926806, 'specificity': 0.55926806, 'f1': 0.5779834, 'auroc': 0.8207933, 'binary_precision': 0.7804878, 'binary_recall': 0.12307692, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.2126246}
confusion matrix:
      0   1
0  5919  27
1   684  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_16.png
early stop counter: 6
val acc:0.9665421843528748, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9000892043113708 / 0.9103478789329529
after epoch: 16,now: 2024-06-19 08:29:10.071142,epoch time: 0:13:02.815753,used: 3:17:29.850401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99254817, 'precision': 0.9887645, 'recall': 0.96651626, 'specificity': 0.96651626, 'f1': 0.9773165, 'auroc': 0.9971259, 'binary_precision': 0.98417336, 'binary_recall': 0.9345665, 'binary_specificity': 0.9984661, 'binary_f1_score': 0.9587287}
confusion matrix:
       0     1
0  42310    65
1    283  4042
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.80024815, 'recall': 0.59156275, 'specificity': 0.59156275, 'f1': 0.6358479, 'auroc': 0.8289622, 'binary_precision': 0.63, 'binary_recall': 0.1872214, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.28865978}
confusion matrix:
       0    1
0  17993   74
1    547  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8942908, 'precision': 0.8532512, 'recall': 0.5559264, 'specificity': 0.5559264, 'f1': 0.57270825, 'auroc': 0.80619943, 'binary_precision': 0.8108108, 'binary_recall': 0.115384616, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.2020202}
confusion matrix:
      0   1
0  5925  21
1   690  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_17.png
early stop counter: 7
val acc:0.9668623208999634, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9000892043113708 / 0.9103478789329529
after epoch: 17,now: 2024-06-19 08:42:22.029301,epoch time: 0:13:11.958159,used: 3:30:41.808560,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.991242, 'precision': 0.9857873, 'recall': 0.96150583, 'specificity': 0.96150583, 'f1': 0.9732575, 'auroc': 0.99583983, 'binary_precision': 0.9791769, 'binary_recall': 0.92501736, 'binary_specificity': 0.9979943, 'binary_f1_score': 0.9513269}
confusion matrix:
       0     1
0  42294    85
1    324  3997
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.79784966, 'recall': 0.59442383, 'specificity': 0.59442383, 'f1': 0.63907576, 'auroc': 0.8376397, 'binary_precision': 0.625, 'binary_recall': 0.19316493, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.29511917}
confusion matrix:
       0    1
0  17989   78
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8942908, 'precision': 0.8321066, 'recall': 0.56093884, 'specificity': 0.56093884, 'f1': 0.58056843, 'auroc': 0.8193033, 'binary_precision': 0.76744187, 'binary_recall': 0.12692308, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.21782179}
confusion matrix:
      0   1
0  5916  30
1   681  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_18.png
early stop counter: 8
val acc:0.9668623208999634, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9000892043113708 / 0.9103478789329529
after epoch: 18,now: 2024-06-19 08:55:11.799838,epoch time: 0:12:49.770537,used: 3:43:31.579097,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99156314, 'precision': 0.98474616, 'recall': 0.96449643, 'specificity': 0.96449643, 'f1': 0.974351, 'auroc': 0.9969201, 'binary_precision': 0.9764677, 'binary_recall': 0.9312818, 'binary_specificity': 0.99771106, 'binary_f1_score': 0.95333964}
confusion matrix:
       0     1
0  42281    97
1    297  4025
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.79600525, 'recall': 0.5987431, 'specificity': 0.5987431, 'f1': 0.6439936, 'auroc': 0.8330142, 'binary_precision': 0.6210046, 'binary_recall': 0.20208023, 'binary_specificity': 0.995406, 'binary_f1_score': 0.3049327}
confusion matrix:
       0    1
0  17984   83
1    537  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89339876, 'precision': 0.83241385, 'recall': 0.5554219, 'specificity': 0.5554219, 'f1': 0.5717801, 'auroc': 0.8069143, 'binary_precision': 0.7692308, 'binary_recall': 0.115384616, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.20066889}
confusion matrix:
      0   1
0  5919  27
1   690  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_19.png
early stop counter: 9
val acc:0.9669156670570374, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9000892043113708 / 0.9103478789329529
after epoch: 19,now: 2024-06-19 09:10:16.244194,epoch time: 0:15:04.444356,used: 3:58:36.023453,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99233407, 'precision': 0.98609346, 'recall': 0.9678229, 'specificity': 0.9678229, 'f1': 0.97673917, 'auroc': 0.99648654, 'binary_precision': 0.9785076, 'binary_recall': 0.93774587, 'binary_specificity': 0.9978999, 'binary_f1_score': 0.9576932}
confusion matrix:
       0     1
0  42290    89
1    269  4052
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.78907216, 'recall': 0.6029517, 'specificity': 0.6029517, 'f1': 0.64804286, 'auroc': 0.83269095, 'binary_precision': 0.60683763, 'binary_recall': 0.21099554, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.31312016}
confusion matrix:
       0    1
0  17975   92
1    531  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8954802, 'precision': 0.86565936, 'recall': 0.55994076, 'specificity': 0.55994076, 'f1': 0.57927024, 'auroc': 0.80915177, 'binary_precision': 0.8347826, 'binary_recall': 0.12307692, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.21452513}
confusion matrix:
      0   1
0  5927  19
1   684  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_20.png
early stop counter: 10
val acc:0.9667556285858154, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9000892043113708 / 0.9103478789329529
after epoch: 20,now: 2024-06-19 09:23:15.920521,epoch time: 0:12:59.676327,used: 4:11:35.699780,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9924411, 'precision': 0.9865858, 'recall': 0.9680001, 'specificity': 0.9680001, 'f1': 0.9770665, 'auroc': 0.9967003, 'binary_precision': 0.9794686, 'binary_recall': 0.93800604, 'binary_specificity': 0.9979942, 'binary_f1_score': 0.958289}
confusion matrix:
       0     1
0  42292    85
1    268  4055
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.7953737, 'recall': 0.58784807, 'specificity': 0.58784807, 'f1': 0.6308518, 'auroc': 0.8382884, 'binary_precision': 0.62051284, 'binary_recall': 0.17979197, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.27880183}
confusion matrix:
       0    1
0  17993   74
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89131725, 'precision': 0.8438496, 'recall': 0.5408782, 'specificity': 0.5408782, 'f1': 0.5474441, 'auroc': 0.8091055, 'binary_precision': 0.79518074, 'binary_recall': 0.08461539, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.1529548}
confusion matrix:
      0   1
0  5929  17
1   714  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_21.png
early stop counter: 11
val acc:0.9665955305099487, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9000892043113708 / 0.9103478789329529
after epoch: 21,now: 2024-06-19 09:43:20.700756,epoch time: 0:20:04.780235,used: 4:31:40.480015,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9920771, 'precision': 0.98541284, 'recall': 0.9669833, 'specificity': 0.9669833, 'f1': 0.97597486, 'auroc': 0.9965816, 'binary_precision': 0.97731113, 'binary_recall': 0.93618494, 'binary_specificity': 0.9977817, 'binary_f1_score': 0.95630616}
confusion matrix:
       0     1
0  42281    94
1    276  4049
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7909043, 'recall': 0.59791714, 'specificity': 0.59791714, 'f1': 0.6424788, 'auroc': 0.84461236, 'binary_precision': 0.61085975, 'binary_recall': 0.20059435, 'binary_specificity': 0.9952399, 'binary_f1_score': 0.3020134}
confusion matrix:
       0    1
0  17981   86
1    538  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89295274, 'precision': 0.81177104, 'recall': 0.55851126, 'specificity': 0.55851126, 'f1': 0.576555, 'auroc': 0.8238939, 'binary_precision': 0.72727275, 'binary_recall': 0.12307692, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.21052632}
confusion matrix:
      0   1
0  5910  36
1   684  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_22.png
early stop counter: 12
val acc:0.9667022228240967, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9000892043113708 / 0.9103478789329529
after epoch: 22,now: 2024-06-19 10:02:28.390932,epoch time: 0:19:07.690176,used: 4:50:48.170191,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99237686, 'precision': 0.98950696, 'recall': 0.96473706, 'specificity': 0.96473706, 'f1': 0.9767204, 'auroc': 0.9961164, 'binary_precision': 0.9860294, 'binary_recall': 0.9308191, 'binary_specificity': 0.99865496, 'binary_f1_score': 0.95762914}
confusion matrix:
       0     1
0  42321    57
1    299  4023
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7973524, 'recall': 0.58933395, 'specificity': 0.58933395, 'f1': 0.632857, 'auroc': 0.8410589, 'binary_precision': 0.6243655, 'binary_recall': 0.18276374, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.28275862}
confusion matrix:
       0    1
0  17993   74
1    550  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89295274, 'precision': 0.8291742, 'recall': 0.5534988, 'specificity': 0.5534988, 'f1': 0.56864846, 'auroc': 0.82353604, 'binary_precision': 0.7631579, 'binary_recall': 0.11153846, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.19463088}
confusion matrix:
      0   1
0  5919  27
1   693  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_23.png
early stop counter: 13
val acc:0.9667022228240967, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9000892043113708 / 0.9103478789329529
after epoch: 23,now: 2024-06-19 10:21:26.789151,epoch time: 0:18:58.398219,used: 5:09:46.568410,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99291223, 'precision': 0.99015886, 'recall': 0.96730274, 'specificity': 0.96730274, 'f1': 0.97839, 'auroc': 0.9977728, 'binary_precision': 0.9868196, 'binary_recall': 0.93587965, 'binary_specificity': 0.99872583, 'binary_f1_score': 0.9606749}
confusion matrix:
       0     1
0  42326    54
1    277  4043
---- Validation: 
scalar performance:
{'acc': 0.9671825, 'precision': 0.80645823, 'recall': 0.59530514, 'specificity': 0.59530514, 'f1': 0.6409719, 'auroc': 0.84440553, 'binary_precision': 0.64215684, 'binary_recall': 0.19465081, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.29874572}
confusion matrix:
       0    1
0  17994   73
1    542  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89414215, 'precision': 0.84208536, 'recall': 0.5575131, 'specificity': 0.5575131, 'f1': 0.575206, 'auroc': 0.8307402, 'binary_precision': 0.7881356, 'binary_recall': 0.11923077, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.20712696}
confusion matrix:
      0   1
0  5921  25
1   687  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_24.png
early stop counter: 14
val acc:0.9671825170516968, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9000892043113708 / 0.9103478789329529
after epoch: 24,now: 2024-06-19 10:39:54.254104,epoch time: 0:18:27.464953,used: 5:28:14.033363,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9926767, 'precision': 0.987056, 'recall': 0.9689677, 'specificity': 0.9689677, 'f1': 0.9777976, 'auroc': 0.9966234, 'binary_precision': 0.9802219, 'binary_recall': 0.9398705, 'binary_specificity': 0.99806494, 'binary_f1_score': 0.9596222}
confusion matrix:
       0     1
0  42294    82
1    260  4064
---- Validation: 
scalar performance:
{'acc': 0.9671291, 'precision': 0.79896665, 'recall': 0.60243016, 'specificity': 0.60243016, 'f1': 0.64859617, 'auroc': 0.8461951, 'binary_precision': 0.62666667, 'binary_recall': 0.20950966, 'binary_specificity': 0.99535066, 'binary_f1_score': 0.31403115}
confusion matrix:
       0    1
0  17983   84
1    532  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8911686, 'precision': 0.78858876, 'recall': 0.55416054, 'specificity': 0.55416054, 'f1': 0.5694976, 'auroc': 0.831318, 'binary_precision': 0.6818182, 'binary_recall': 0.115384616, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.19736841}
confusion matrix:
      0   1
0  5904  42
1   690  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_25.png
early stop counter: 15
val acc:0.967129111289978, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9000892043113708 / 0.9103478789329529
after epoch: 25,now: 2024-06-19 10:56:10.493345,epoch time: 0:16:16.239241,used: 5:44:30.272604,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9927623, 'precision': 0.98815286, 'recall': 0.9683706, 'specificity': 0.9683706, 'f1': 0.9780059, 'auroc': 0.99646294, 'binary_precision': 0.9825539, 'binary_recall': 0.9384402, 'binary_specificity': 0.998301, 'binary_f1_score': 0.95999056}
confusion matrix:
       0     1
0  42307    72
1    266  4055
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.7969177, 'recall': 0.59368086, 'specificity': 0.59368086, 'f1': 0.63809365, 'auroc': 0.84434974, 'binary_precision': 0.6231884, 'binary_recall': 0.19167905, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.2931818}
confusion matrix:
       0    1
0  17989   78
1    544  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8931014, 'precision': 0.82593393, 'recall': 0.5552537, 'specificity': 0.5552537, 'f1': 0.57147264, 'auroc': 0.8179068, 'binary_precision': 0.75630254, 'binary_recall': 0.115384616, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.20022246}
confusion matrix:
      0   1
0  5917  29
1   690  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_26.png
early stop counter: 16
val acc:0.9668089747428894, best validation acc: 0.9671825170516968, corresponding to test acc:                         0.9000892043113708 / 0.9103478789329529
after epoch: 26,now: 2024-06-19 11:16:29.996511,epoch time: 0:20:19.503166,used: 6:04:49.775770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9929764, 'precision': 0.98714435, 'recall': 0.9706774, 'specificity': 0.9706774, 'f1': 0.97873366, 'auroc': 0.9972857, 'binary_precision': 0.98004806, 'binary_recall': 0.9433133, 'binary_specificity': 0.99804145, 'binary_f1_score': 0.9613299}
confusion matrix:
       0     1
0  42295    83
1    245  4077
---- Validation: 
scalar performance:
{'acc': 0.9672892, 'precision': 0.8009548, 'recall': 0.6053742, 'specificity': 0.6053742, 'f1': 0.6521963, 'auroc': 0.850482, 'binary_precision': 0.6304348, 'binary_recall': 0.2154532, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.3211517}
confusion matrix:
       0    1
0  17982   85
1    528  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8931014, 'precision': 0.81455475, 'recall': 0.5585953, 'specificity': 0.5585953, 'f1': 0.5767127, 'auroc': 0.82587504, 'binary_precision': 0.73282444, 'binary_recall': 0.12307692, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.21075742}
confusion matrix:
      0   1
0  5911  35
1   684  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_27.png
better model found
persisted
after epoch: 27,now: 2024-06-19 11:38:35.949666,epoch time: 0:22:05.953155,used: 6:26:55.728925,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9928694, 'precision': 0.9887435, 'recall': 0.9684083, 'specificity': 0.9684083, 'f1': 0.9783058, 'auroc': 0.9975554, 'binary_precision': 0.9837339, 'binary_recall': 0.9383974, 'binary_specificity': 0.99841917, 'binary_f1_score': 0.96053094}
confusion matrix:
       0     1
0  42315    67
1    266  4052
---- Validation: 
scalar performance:
{'acc': 0.9671291, 'precision': 0.81296885, 'recall': 0.58740956, 'specificity': 0.58740956, 'f1': 0.6317771, 'auroc': 0.84071004, 'binary_precision': 0.6557377, 'binary_recall': 0.17830609, 'binary_specificity': 0.996513, 'binary_f1_score': 0.2803738}
confusion matrix:
       0    1
0  18004   63
1    553  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88834375, 'precision': 0.79452777, 'recall': 0.5308423, 'specificity': 0.5308423, 'f1': 0.5299851, 'auroc': 0.80575454, 'binary_precision': 0.69863015, 'binary_recall': 0.06538462, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.11957797}
confusion matrix:
      0   1
0  5924  22
1   729  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_28.png
early stop counter: 1
val acc:0.967129111289978, best validation acc: 0.9672892093658447, corresponding to test acc:                         0.8931013941764832 / 0.9103478789329529
after epoch: 28,now: 2024-06-19 12:03:56.146188,epoch time: 0:25:20.196522,used: 6:52:15.925447,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9927409, 'precision': 0.9879224, 'recall': 0.9684415, 'specificity': 0.9684415, 'f1': 0.97793376, 'auroc': 0.9970399, 'binary_precision': 0.9820693, 'binary_recall': 0.938629, 'binary_specificity': 0.998254, 'binary_f1_score': 0.9598579}
confusion matrix:
       0     1
0  42308    74
1    265  4053
---- Validation: 
scalar performance:
{'acc': 0.9666489, 'precision': 0.79759276, 'recall': 0.58716047, 'specificity': 0.58716047, 'f1': 0.63019353, 'auroc': 0.8468363, 'binary_precision': 0.625, 'binary_recall': 0.17830609, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.27745664}
confusion matrix:
       0    1
0  17995   72
1    553  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8898305, 'precision': 0.7948407, 'recall': 0.54170805, 'specificity': 0.54170805, 'f1': 0.54903036, 'auroc': 0.82275575, 'binary_precision': 0.6969697, 'binary_recall': 0.08846154, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.1569966}
confusion matrix:
      0   1
0  5916  30
1   711  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_29.png
early stop counter: 2
val acc:0.9666488766670227, best validation acc: 0.9672892093658447, corresponding to test acc:                         0.8931013941764832 / 0.9103478789329529
after epoch: 29,now: 2024-06-19 12:21:02.873928,epoch time: 0:17:06.727740,used: 7:09:22.653187,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9931692, 'precision': 0.9892604, 'recall': 0.9697515, 'specificity': 0.9697515, 'f1': 0.97925776, 'auroc': 0.99790335, 'binary_precision': 0.98451114, 'binary_recall': 0.94101316, 'binary_specificity': 0.99848974, 'binary_f1_score': 0.96227086}
confusion matrix:
       0     1
0  42313    64
1    255  4068
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.7953737, 'recall': 0.58784807, 'specificity': 0.58784807, 'f1': 0.6308518, 'auroc': 0.84102446, 'binary_precision': 0.62051284, 'binary_recall': 0.17979197, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.27880183}
confusion matrix:
       0    1
0  17993   74
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8884924, 'precision': 0.7848593, 'recall': 0.534268, 'specificity': 0.534268, 'f1': 0.5361819, 'auroc': 0.80598867, 'binary_precision': 0.6785714, 'binary_recall': 0.073076926, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.13194445}
confusion matrix:
      0   1
0  5919  27
1   723  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_30.png
early stop counter: 3
val acc:0.9665955305099487, best validation acc: 0.9672892093658447, corresponding to test acc:                         0.8931013941764832 / 0.9103478789329529
after epoch: 30,now: 2024-06-19 12:37:34.660966,epoch time: 0:16:31.787038,used: 7:25:54.440225,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_05_11_40_seed_1_21504647
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:25:54.440225 at 2024-06-19 12:37:34.660966
persisted model performance metric: 

scalar performance:
{'acc': 0.8931014, 'precision': 0.81455475, 'recall': 0.5585953, 'specificity': 0.5585953, 'f1': 0.5767127, 'auroc': 0.82587504, 'binary_precision': 0.73282444, 'binary_recall': 0.12307692, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.21075742}
confusion matrix:
      0   1
0  5911  35
1   684  96
oracle model performance metric: 

scalar performance:
{'acc': 0.9103479, 'precision': 0.89255726, 'recall': 0.63016963, 'specificity': 0.63016963, 'f1': 0.67929375, 'auroc': 0.82195836, 'binary_precision': 0.87341774, 'binary_recall': 0.2653846, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.40707967}
confusion matrix:
      0    1
0  5916   30
1   573  207
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204208 KiB |   1436 MiB |    835 TiB |    835 TiB |
|       from large pool | 167936 KiB |   1366 MiB |    835 TiB |    835 TiB |
|       from small pool |  36272 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204208 KiB |   1436 MiB |    835 TiB |    835 TiB |
|       from large pool | 167936 KiB |   1366 MiB |    835 TiB |    835 TiB |
|       from small pool |  36272 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201110 KiB |   1428 MiB |    835 TiB |    835 TiB |
|       from large pool | 165120 KiB |   1358 MiB |    835 TiB |    835 TiB |
|       from small pool |  35990 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   2478 MiB |   1012 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   2374 MiB |    982 MiB |
|       from small pool |     74 MiB |     74 MiB |    104 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320079 KiB | 628877 KiB | 653570 GiB | 653569 GiB |
|       from large pool | 311296 KiB | 627520 KiB | 653399 GiB | 653399 GiB |
|       from small pool |   8783 KiB |  16375 KiB |    170 GiB |    170 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1308    |    1965    |   28160 K  |   28159 K  |
|       from large pool |      36    |      76    |   11232 K  |   11232 K  |
|       from small pool |    1272    |    1894    |   16927 K  |   16926 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1308    |    1965    |   28160 K  |   28159 K  |
|       from large pool |      36    |      76    |   11232 K  |   11232 K  |
|       from small pool |    1272    |    1894    |   16927 K  |   16926 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      68    |      19    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      52    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |     482    |   15324 K  |   15324 K  |
|       from large pool |       5    |      11    |    4363 K  |    4363 K  |
|       from small pool |      31    |     477    |   10960 K  |   10960 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   1358 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 628877 KiB | 653570 GiB | 653570 GiB |
|       from large pool | 298752 KiB | 627520 KiB | 653399 GiB | 653399 GiB |
|       from small pool |      0 KiB |  16378 KiB |    170 GiB |    170 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1965    |   28160 K  |   28160 K  |
|       from large pool |       2    |      76    |   11232 K  |   11232 K  |
|       from small pool |       0    |    1894    |   16927 K  |   16927 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1965    |   28160 K  |   28160 K  |
|       from large pool |       2    |      76    |   11232 K  |   11232 K  |
|       from small pool |       0    |    1894    |   16927 K  |   16927 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     482    |   15324 K  |   15324 K  |
|       from large pool |       1    |      11    |    4363 K  |    4363 K  |
|       from small pool |       0    |     477    |   10960 K  |   10960 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |    835 TiB |    835 TiB |
|       from large pool |  16640 KiB |   1358 MiB |    835 TiB |    835 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 628877 KiB | 653570 GiB | 653570 GiB |
|       from large pool | 298752 KiB | 627520 KiB | 653399 GiB | 653399 GiB |
|       from small pool |      0 KiB |  16378 KiB |    170 GiB |    170 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1965    |   28160 K  |   28160 K  |
|       from large pool |       2    |      76    |   11232 K  |   11232 K  |
|       from small pool |       0    |    1894    |   16927 K  |   16927 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1965    |   28160 K  |   28160 K  |
|       from large pool |       2    |      76    |   11232 K  |   11232 K  |
|       from small pool |       0    |    1894    |   16927 K  |   16927 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     482    |   15324 K  |   15324 K  |
|       from large pool |       1    |      11    |    4363 K  |    4363 K  |
|       from small pool |       0    |     477    |   10960 K  |   10960 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_19_12_45_22_seed_2_21504647

 Experiment start at: 2024-06-19 12:45:22.203611
before training, model accuracy: 0.12167187035083771
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9531624, 'precision': 0.96939903, 'recall': 0.7610138, 'specificity': 0.7610138, 'f1': 0.82915604, 'auroc': 0.95366824, 'binary_precision': 0.9874896, 'binary_recall': 0.5227373, 'binary_specificity': 0.9992903, 'binary_f1_score': 0.6836028}
confusion matrix:
       0     1
0  42240    30
1   2162  2368
---- Validation: 
scalar performance:
{'acc': 0.9672402, 'precision': 0.56297743, 'recall': 0.5020514, 'specificity': 0.5020514, 'f1': 0.49650323, 'auroc': 0.5881039, 'binary_precision': 0.15789473, 'binary_recall': 0.004983389, 'binary_specificity': 0.99911946, 'binary_f1_score': 0.009661836}
confusion matrix:
       0   1
0  18155  16
1    599   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8915663, 'precision': 0.44598213, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.4713376, 'auroc': 0.6213389, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   726  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21504647_1.png
[Wed Jun 19 13:08:55 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_classbalancing/rule_results/3.csv

RuleException:
RuntimeError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[enforce fail at inline_container.cc:595] . unexpected pos 14460032 vs 14459864
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 49, in tr_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 70, in after_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 60, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/a_model_sel.py", line 63, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/c_msel_oracle.py", line 37, in base_update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model.py", line 159, in save
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_utils.py", line 89, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 627, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 475, in __exit__
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
