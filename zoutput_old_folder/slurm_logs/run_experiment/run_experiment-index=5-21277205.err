Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jun 10 23:41:00 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205

 Experiment start at: 2024-06-10 23:47:54.387398
before training, model accuracy: 0.8904129862785339
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9960844, 'precision': 0.986029, 'recall': 0.9912462, 'specificity': 0.9912462, 'f1': 0.98862, 'auroc': 0.99906564, 'binary_precision': 0.97359586, 'binary_recall': 0.9852808, 'binary_specificity': 0.9972117, 'binary_f1_score': 0.9794035}
confusion matrix:
       0     1
0  42202   118
1     65  4351
---- Validation: 
scalar performance:
{'acc': 0.971424, 'precision': 0.7980151, 'recall': 0.7144359, 'specificity': 0.7144359, 'f1': 0.7487712, 'auroc': 0.9373301, 'binary_precision': 0.6157205, 'binary_recall': 0.43856922, 'binary_specificity': 0.9903025, 'binary_f1_score': 0.5122616}
confusion matrix:
       0    1
0  17973  176
1    361  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99764013, 'precision': 0.99810207, 'recall': 0.9903381, 'specificity': 0.9903381, 'f1': 0.9941791, 'auroc': 0.9987214, 'binary_precision': 0.9986996, 'binary_recall': 0.9808429, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.9896907}
confusion matrix:
      0    1
0  5996    1
1    15  768
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-11 00:23:57.978470,epoch time: 0:36:03.591072,used: 0:36:03.591072,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9959132, 'precision': 0.9862863, 'recall': 0.9899329, 'specificity': 0.9899329, 'f1': 0.9881009, 'auroc': 0.9994682, 'binary_precision': 0.97439355, 'binary_recall': 0.98255944, 'binary_specificity': 0.9973063, 'binary_f1_score': 0.9784595}
confusion matrix:
       0     1
0  42207   114
1     77  4338
---- Validation: 
scalar performance:
{'acc': 0.969934, 'precision': 0.9263824, 'recall': 0.56965387, 'specificity': 0.56965387, 'f1': 0.6131368, 'auroc': 0.9223008, 'binary_precision': 0.88235295, 'binary_recall': 0.1399689, 'binary_specificity': 0.9993388, 'binary_f1_score': 0.24161075}
confusion matrix:
       0   1
0  18137  12
1    553  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9961652, 'precision': 0.9978416, 'recall': 0.9833972, 'specificity': 0.9833972, 'f1': 0.9904769, 'auroc': 0.99881417, 'binary_precision': 1.0, 'binary_recall': 0.9667944, 'binary_specificity': 1.0, 'binary_f1_score': 0.98311687}
confusion matrix:
      0    1
0  5997    0
1    26  757
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_2.png
early stop counter: 1
val acc:0.9699339866638184, best validation acc: 0.9714239835739136, corresponding to test acc:                         0.9976401329040527 / 0.9976401329040527
after epoch: 2,now: 2024-06-11 00:58:27.909200,epoch time: 0:34:29.930730,used: 1:10:33.521802,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9972612, 'precision': 0.99838746, 'recall': 0.9856087, 'specificity': 0.9856087, 'f1': 0.9918937, 'auroc': 0.99943036, 'binary_precision': 0.9997669, 'binary_recall': 0.97124094, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.98529744}
confusion matrix:
       0     1
0  42319     1
1    127  4289
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.9394914, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9960177, 'precision': 0.997759, 'recall': 0.98275864, 'specificity': 0.98275864, 'f1': 0.99010503, 'auroc': 0.99983454, 'binary_precision': 1.0, 'binary_recall': 0.9655172, 'binary_specificity': 1.0, 'binary_f1_score': 0.9824561}
confusion matrix:
      0    1
0  5997    0
1    27  756
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_3.png
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9714239835739136, corresponding to test acc:                         0.9976401329040527 / 0.9976401329040527
after epoch: 3,now: 2024-06-11 01:32:58.544544,epoch time: 0:34:30.635344,used: 1:45:04.157146,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9955281, 'precision': 0.98339415, 'recall': 0.9907346, 'specificity': 0.9907346, 'f1': 0.9870293, 'auroc': 0.9992356, 'binary_precision': 0.9683742, 'binary_recall': 0.9848245, 'binary_specificity': 0.9966447, 'binary_f1_score': 0.9765301}
confusion matrix:
       0     1
0  42179   142
1     67  4348
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.7399652, 'recall': 0.7406851, 'specificity': 0.7406851, 'f1': 0.7403245, 'auroc': 0.9417049, 'binary_precision': 0.4976744, 'binary_recall': 0.4992224, 'binary_specificity': 0.98214775, 'binary_f1_score': 0.49844718}
confusion matrix:
       0    1
0  17825  324
1    322  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9974926, 'precision': 0.99858665, 'recall': 0.9891443, 'specificity': 0.9891443, 'f1': 0.9938049, 'auroc': 0.99957645, 'binary_precision': 1.0, 'binary_recall': 0.97828865, 'binary_specificity': 1.0, 'binary_f1_score': 0.9890252}
confusion matrix:
      0    1
0  5997    0
1    17  766
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_4.png
early stop counter: 3
val acc:0.965623676776886, best validation acc: 0.9714239835739136, corresponding to test acc:                         0.9976401329040527 / 0.9976401329040527
after epoch: 4,now: 2024-06-11 02:07:26.083403,epoch time: 0:34:27.538859,used: 2:19:31.696005,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9986092, 'precision': 0.9985132, 'recall': 0.9933458, 'specificity': 0.9933458, 'f1': 0.9959126, 'auroc': 0.99922, 'binary_precision': 0.9983952, 'binary_recall': 0.986857, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.99259263}
confusion matrix:
       0     1
0  42316     7
1     58  4355
---- Validation: 
scalar performance:
{'acc': 0.9717965, 'precision': 0.87747645, 'recall': 0.6208718, 'specificity': 0.6208718, 'f1': 0.6788061, 'auroc': 0.9298955, 'binary_precision': 0.78109455, 'binary_recall': 0.24416797, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.37203792}
confusion matrix:
       0    1
0  18105   44
1    486  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985251, 'precision': 0.9991677, 'recall': 0.9936143, 'specificity': 0.9936143, 'f1': 0.9963701, 'auroc': 0.99919844, 'binary_precision': 1.0, 'binary_recall': 0.98722863, 'binary_specificity': 1.0, 'binary_f1_score': 0.99357325}
confusion matrix:
      0    1
0  5997    0
1    10  773
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-11 02:41:54.426714,epoch time: 0:34:28.343311,used: 2:54:00.039316,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99897295, 'precision': 0.9993309, 'recall': 0.99466664, 'specificity': 0.99466664, 'f1': 0.99698496, 'auroc': 0.99977016, 'binary_precision': 0.9997712, 'binary_recall': 0.9893569, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99453676}
confusion matrix:
       0     1
0  42319     1
1     47  4369
---- Validation: 
scalar performance:
{'acc': 0.96972114, 'precision': 0.95006764, 'recall': 0.56204313, 'specificity': 0.56204313, 'f1': 0.60201997, 'auroc': 0.9457555, 'binary_precision': 0.9302326, 'binary_recall': 0.1244168, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.21947874}
confusion matrix:
       0   1
0  18143   6
1    563  80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99837756, 'precision': 0.9990846, 'recall': 0.9929757, 'specificity': 0.9929757, 'f1': 0.9960049, 'auroc': 0.99995565, 'binary_precision': 1.0, 'binary_recall': 0.9859515, 'binary_specificity': 1.0, 'binary_f1_score': 0.99292606}
confusion matrix:
      0    1
0  5997    0
1    11  772
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_6.png
early stop counter: 1
val acc:0.9697211384773254, best validation acc: 0.9717965126037598, corresponding to test acc:                         0.998525083065033 / 0.998525083065033
after epoch: 6,now: 2024-06-11 03:16:19.976758,epoch time: 0:34:25.550044,used: 3:28:25.589360,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.997518, 'precision': 0.99863327, 'recall': 0.98686594, 'specificity': 0.98686594, 'f1': 0.99266124, 'auroc': 0.9998548, 'binary_precision': 1.0, 'binary_recall': 0.9737319, 'binary_specificity': 1.0, 'binary_f1_score': 0.9866911}
confusion matrix:
       0     1
0  42320     0
1    116  4300
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.7772601, 'recall': 0.5075832, 'specificity': 0.5075832, 'f1': 0.50648504, 'auroc': 0.9571482, 'binary_precision': 0.5882353, 'binary_recall': 0.0155521, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.03030303}
confusion matrix:
       0   1
0  18142   7
1    633  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9941003, 'precision': 0.99668705, 'recall': 0.9744572, 'specificity': 0.9744572, 'f1': 0.9852319, 'auroc': 0.9992286, 'binary_precision': 1.0, 'binary_recall': 0.9489144, 'binary_specificity': 1.0, 'binary_f1_score': 0.97378767}
confusion matrix:
      0    1
0  5997    0
1    40  743
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_7.png
early stop counter: 2
val acc:0.9659429788589478, best validation acc: 0.9717965126037598, corresponding to test acc:                         0.998525083065033 / 0.998525083065033
after epoch: 7,now: 2024-06-11 03:50:48.067398,epoch time: 0:34:28.090640,used: 4:02:53.680000,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9987162, 'precision': 0.99929214, 'recall': 0.99320495, 'specificity': 0.99320495, 'f1': 0.9962251, 'auroc': 0.9997728, 'binary_precision': 1.0, 'binary_recall': 0.98640996, 'binary_specificity': 1.0, 'binary_f1_score': 0.9931585}
confusion matrix:
       0     1
0  42321     0
1     60  4355
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.7329165, 'recall': 0.50075006, 'specificity': 0.50075006, 'f1': 0.49284685, 'auroc': 0.9562777, 'binary_precision': 0.5, 'binary_recall': 0.00155521, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0031007752}
confusion matrix:
       0  1
0  18148  1
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9980826, 'precision': 0.9989185, 'recall': 0.9916986, 'specificity': 0.9916986, 'f1': 0.9952732, 'auroc': 0.9995744, 'binary_precision': 1.0, 'binary_recall': 0.9833972, 'binary_specificity': 1.0, 'binary_f1_score': 0.99162906}
confusion matrix:
      0    1
0  5997    0
1    13  770
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_8.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9717965126037598, corresponding to test acc:                         0.998525083065033 / 0.998525083065033
after epoch: 8,now: 2024-06-11 04:24:51.687008,epoch time: 0:34:03.619610,used: 4:36:57.299610,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9986092, 'precision': 0.99902713, 'recall': 0.9928432, 'specificity': 0.9928432, 'f1': 0.9959109, 'auroc': 0.99987996, 'binary_precision': 0.99954075, 'binary_recall': 0.9857337, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99258924}
confusion matrix:
       0     1
0  42318     2
1     63  4353
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.6079376, 'recall': 0.5013899, 'specificity': 0.5013899, 'f1': 0.4943131, 'auroc': 0.94895, 'binary_precision': 0.25, 'binary_recall': 0.00311042, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.0061443937}
confusion matrix:
       0  1
0  18143  6
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99882007, 'precision': 0.99766266, 'recall': 0.996557, 'specificity': 0.996557, 'f1': 0.99710906, 'auroc': 0.99993783, 'binary_precision': 0.9961588, 'binary_recall': 0.9936143, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.99488497}
confusion matrix:
      0    1
0  5994    3
1     5  778
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_9.png
new oracle model saved
early stop counter: 4
val acc:0.9655704498291016, best validation acc: 0.9717965126037598, corresponding to test acc:                         0.998525083065033 / 0.9988200664520264
after epoch: 9,now: 2024-06-11 04:59:07.355022,epoch time: 0:34:15.668014,used: 5:11:12.967624,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9993581, 'precision': 0.99923754, 'recall': 0.9970069, 'specificity': 0.9970069, 'f1': 0.9981191, 'auroc': 0.9999491, 'binary_precision': 0.99908906, 'binary_recall': 0.9941083, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.99659246}
confusion matrix:
       0     1
0  42319     4
1     26  4387
---- Validation: 
scalar performance:
{'acc': 0.97381866, 'precision': 0.8958763, 'recall': 0.6504208, 'specificity': 0.6504208, 'f1': 0.7143858, 'auroc': 0.95826936, 'binary_precision': 0.8158996, 'binary_recall': 0.30326593, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.44217688}
confusion matrix:
       0    1
0  18105   44
1    448  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99867254, 'precision': 0.99925077, 'recall': 0.99425286, 'specificity': 0.99425286, 'f1': 0.9967349, 'auroc': 0.9999932, 'binary_precision': 1.0, 'binary_recall': 0.9885057, 'binary_specificity': 1.0, 'binary_f1_score': 0.99421966}
confusion matrix:
      0    1
0  5997    0
1     9  774
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_10.png
better model found
persisted
after epoch: 10,now: 2024-06-11 05:33:32.436974,epoch time: 0:34:25.081952,used: 5:45:38.049576,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9993581, 'precision': 0.99954367, 'recall': 0.9967047, 'specificity': 0.9967047, 'f1': 0.9981191, 'auroc': 0.99992496, 'binary_precision': 0.99977213, 'binary_recall': 0.993433, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9965925}
confusion matrix:
       0     1
0  42319     1
1     29  4387
---- Validation: 
scalar performance:
{'acc': 0.9686569, 'precision': 0.9453459, 'recall': 0.54574096, 'specificity': 0.54574096, 'f1': 0.5754652, 'auroc': 0.95933294, 'binary_precision': 0.921875, 'binary_recall': 0.09175739, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.1669024}
confusion matrix:
       0   1
0  18144   5
1    584  59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99837756, 'precision': 0.9990846, 'recall': 0.9929757, 'specificity': 0.9929757, 'f1': 0.9960049, 'auroc': 0.99989784, 'binary_precision': 1.0, 'binary_recall': 0.9859515, 'binary_specificity': 1.0, 'binary_f1_score': 0.99292606}
confusion matrix:
      0    1
0  5997    0
1    11  772
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_11.png
early stop counter: 1
val acc:0.9686568975448608, best validation acc: 0.9738186597824097, corresponding to test acc:                         0.9986725449562073 / 0.9988200664520264
after epoch: 11,now: 2024-06-11 06:07:56.947318,epoch time: 0:34:24.510344,used: 6:20:02.559920,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9959132, 'precision': 0.9814819, 'recall': 0.99520695, 'specificity': 0.99520695, 'f1': 0.98822206, 'auroc': 0.99971354, 'binary_precision': 0.9635565, 'binary_recall': 0.9943362, 'binary_specificity': 0.9960777, 'binary_f1_score': 0.97870445}
confusion matrix:
       0     1
0  42156   166
1     25  4389
---- Validation: 
scalar performance:
{'acc': 0.97381866, 'precision': 0.8250761, 'recall': 0.7284266, 'specificity': 0.7284266, 'f1': 0.7675711, 'auroc': 0.9587601, 'binary_precision': 0.6689038, 'binary_recall': 0.46500778, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.54862386}
confusion matrix:
       0    1
0  18001  148
1    344  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9964602, 'precision': 0.98714995, 'recall': 0.9957782, 'specificity': 0.9957782, 'f1': 0.9914128, 'auroc': 0.9990605, 'binary_precision': 0.97496873, 'binary_recall': 0.99489146, 'binary_specificity': 0.996665, 'binary_f1_score': 0.9848293}
confusion matrix:
      0    1
0  5977   20
1     4  779
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_12.png
early stop counter: 2
val acc:0.9738186597824097, best validation acc: 0.9738186597824097, corresponding to test acc:                         0.9986725449562073 / 0.9988200664520264
after epoch: 12,now: 2024-06-11 06:42:24.562996,epoch time: 0:34:27.615678,used: 6:54:30.175598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99901575, 'precision': 0.9994571, 'recall': 0.9947916, 'specificity': 0.9947916, 'f1': 0.9971106, 'auroc': 0.99995816, 'binary_precision': 1.0, 'binary_recall': 0.9895833, 'binary_specificity': 1.0, 'binary_f1_score': 0.99476445}
confusion matrix:
       0     1
0  42320     0
1     46  4370
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.9836638, 'recall': 0.5233281, 'specificity': 0.5233281, 'f1': 0.53627276, 'auroc': 0.96116525, 'binary_precision': 1.0, 'binary_recall': 0.0466563, 'binary_specificity': 1.0, 'binary_f1_score': 0.08915305}
confusion matrix:
       0   1
0  18149   0
1    613  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99734515, 'precision': 0.99850374, 'recall': 0.9885057, 'specificity': 0.9885057, 'f1': 0.9934368, 'auroc': 0.9999112, 'binary_precision': 1.0, 'binary_recall': 0.9770115, 'binary_specificity': 1.0, 'binary_f1_score': 0.98837215}
confusion matrix:
      0    1
0  5997    0
1    18  765
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_13.png
early stop counter: 3
val acc:0.9673797488212585, best validation acc: 0.9738186597824097, corresponding to test acc:                         0.9986725449562073 / 0.9988200664520264
after epoch: 13,now: 2024-06-11 07:16:52.176274,epoch time: 0:34:27.613278,used: 7:28:57.788876,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.997518, 'precision': 0.9976966, 'recall': 0.98777866, 'specificity': 0.98777866, 'f1': 0.9926748, 'auroc': 0.9990636, 'binary_precision': 0.9979157, 'binary_recall': 0.97576994, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.98671854}
confusion matrix:
       0     1
0  42311     9
1    107  4309
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.7784405, 'recall': 0.5508047, 'specificity': 0.5508047, 'f1': 0.5800488, 'auroc': 0.9332917, 'binary_precision': 0.5877193, 'binary_recall': 0.10419907, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.17701453}
confusion matrix:
       0   1
0  18102  47
1    576  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9961652, 'precision': 0.99612284, 'recall': 0.9850628, 'specificity': 0.9850628, 'f1': 0.99050915, 'auroc': 0.9983219, 'binary_precision': 0.9960682, 'binary_recall': 0.9706258, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.98318243}
confusion matrix:
      0    1
0  5994    3
1    23  760
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_14.png
early stop counter: 4
val acc:0.9668475985527039, best validation acc: 0.9738186597824097, corresponding to test acc:                         0.9986725449562073 / 0.9988200664520264
after epoch: 14,now: 2024-06-11 07:51:16.742509,epoch time: 0:34:24.566235,used: 8:03:22.355111,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99916553, 'precision': 0.9995396, 'recall': 0.99558425, 'specificity': 0.99558425, 'f1': 0.99755204, 'auroc': 0.9999606, 'binary_precision': 1.0, 'binary_recall': 0.9911685, 'binary_specificity': 1.0, 'binary_f1_score': 0.99556464}
confusion matrix:
       0     1
0  42320     0
1     39  4377
---- Validation: 
scalar performance:
{'acc': 0.9717433, 'precision': 0.97315085, 'recall': 0.58934194, 'specificity': 0.58934194, 'f1': 0.6439068, 'auroc': 0.9655081, 'binary_precision': 0.9745763, 'binary_recall': 0.17884915, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.3022339}
confusion matrix:
       0    1
0  18146    3
1    528  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99705017, 'precision': 0.99833804, 'recall': 0.98722863, 'specificity': 0.98722863, 'f1': 0.9926993, 'auroc': 0.9996345, 'binary_precision': 1.0, 'binary_recall': 0.9744572, 'binary_specificity': 1.0, 'binary_f1_score': 0.98706335}
confusion matrix:
      0    1
0  5997    0
1    20  763
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_15.png
early stop counter: 5
val acc:0.9717432856559753, best validation acc: 0.9738186597824097, corresponding to test acc:                         0.9986725449562073 / 0.9988200664520264
after epoch: 15,now: 2024-06-11 08:25:46.738228,epoch time: 0:34:29.995719,used: 8:37:52.350830,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99907994, 'precision': 0.9994925, 'recall': 0.9951291, 'specificity': 0.9951291, 'f1': 0.9972988, 'auroc': 0.9998316, 'binary_precision': 1.0, 'binary_recall': 0.9902583, 'binary_specificity': 1.0, 'binary_f1_score': 0.9951053}
confusion matrix:
       0     1
0  42322     0
1     43  4371
---- Validation: 
scalar performance:
{'acc': 0.97035974, 'precision': 0.9688828, 'recall': 0.5691242, 'specificity': 0.5691242, 'f1': 0.6135306, 'auroc': 0.9675709, 'binary_precision': 0.9673913, 'binary_recall': 0.13841368, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.24217686}
confusion matrix:
       0   1
0  18146   3
1    554  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985251, 'precision': 0.9991677, 'recall': 0.9936143, 'specificity': 0.9936143, 'f1': 0.9963701, 'auroc': 0.99967915, 'binary_precision': 1.0, 'binary_recall': 0.98722863, 'binary_specificity': 1.0, 'binary_f1_score': 0.99357325}
confusion matrix:
      0    1
0  5997    0
1    10  773
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_16.png
early stop counter: 6
val acc:0.970359742641449, best validation acc: 0.9738186597824097, corresponding to test acc:                         0.9986725449562073 / 0.9988200664520264
after epoch: 16,now: 2024-06-11 09:00:10.442245,epoch time: 0:34:23.704017,used: 9:12:16.054847,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9992939, 'precision': 0.9996104, 'recall': 0.9962627, 'specificity': 0.9962627, 'f1': 0.99792945, 'auroc': 0.9999578, 'binary_precision': 1.0, 'binary_recall': 0.99252546, 'binary_specificity': 1.0, 'binary_f1_score': 0.9962487}
confusion matrix:
       0     1
0  42321     0
1     33  4382
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.98314875, 'recall': 0.507776, 'specificity': 0.507776, 'f1': 0.5067439, 'auroc': 0.9671581, 'binary_precision': 1.0, 'binary_recall': 0.0155521, 'binary_specificity': 1.0, 'binary_f1_score': 0.030627873}
confusion matrix:
       0   1
0  18149   0
1    633  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99882007, 'precision': 0.99933386, 'recall': 0.9948914, 'specificity': 0.9948914, 'f1': 0.9970994, 'auroc': 0.9999913, 'binary_precision': 1.0, 'binary_recall': 0.98978287, 'binary_specificity': 1.0, 'binary_f1_score': 0.99486524}
confusion matrix:
      0    1
0  5997    0
1     8  775
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_17.png
early stop counter: 7
val acc:0.9663154482841492, best validation acc: 0.9738186597824097, corresponding to test acc:                         0.9986725449562073 / 0.9988200664520264
after epoch: 17,now: 2024-06-11 09:34:55.901866,epoch time: 0:34:45.459621,used: 9:47:01.514468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9935168, 'precision': 0.9691049, 'recall': 0.9948987, 'specificity': 0.9948987, 'f1': 0.9815615, 'auroc': 0.9998497, 'binary_precision': 0.93856657, 'binary_recall': 0.9966025, 'binary_specificity': 0.9931949, 'binary_f1_score': 0.9667143}
confusion matrix:
       0     1
0  42033   288
1     15  4400
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.96350825, 'recall': 0.518635, 'specificity': 0.518635, 'f1': 0.52753067, 'auroc': 0.95530736, 'binary_precision': 0.96, 'binary_recall': 0.03732504, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.07185629}
confusion matrix:
       0   1
0  18148   1
1    619  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99837756, 'precision': 0.9979619, 'recall': 0.99408615, 'specificity': 0.99408615, 'f1': 0.99601376, 'auroc': 0.99973977, 'binary_precision': 0.9974227, 'binary_recall': 0.9885057, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.9929442}
confusion matrix:
      0    1
0  5995    2
1     9  774
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_18.png
early stop counter: 8
val acc:0.9670072197914124, best validation acc: 0.9738186597824097, corresponding to test acc:                         0.9986725449562073 / 0.9988200664520264
after epoch: 18,now: 2024-06-11 10:10:01.897117,epoch time: 0:35:05.995251,used: 10:22:07.509719,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99893016, 'precision': 0.99941, 'recall': 0.99433875, 'specificity': 0.99433875, 'f1': 0.9968581, 'auroc': 0.99995214, 'binary_precision': 1.0, 'binary_recall': 0.98867756, 'binary_specificity': 1.0, 'binary_f1_score': 0.99430656}
confusion matrix:
       0     1
0  42320     0
1     50  4366
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.9841541, 'recall': 0.5381026, 'specificity': 0.5381026, 'f1': 0.56275874, 'auroc': 0.9697196, 'binary_precision': 1.0, 'binary_recall': 0.07620529, 'binary_specificity': 1.0, 'binary_f1_score': 0.1416185}
confusion matrix:
       0   1
0  18149   0
1    594  49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971976, 'precision': 0.99842083, 'recall': 0.9878672, 'specificity': 0.9878672, 'f1': 0.9930683, 'auroc': 0.9997976, 'binary_precision': 1.0, 'binary_recall': 0.97573435, 'binary_specificity': 1.0, 'binary_f1_score': 0.98771816}
confusion matrix:
      0    1
0  5997    0
1    19  764
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_19.png
early stop counter: 9
val acc:0.9683908224105835, best validation acc: 0.9738186597824097, corresponding to test acc:                         0.9986725449562073 / 0.9988200664520264
after epoch: 19,now: 2024-06-11 10:44:47.791177,epoch time: 0:34:45.894060,used: 10:56:53.403779,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99910134, 'precision': 0.9992993, 'recall': 0.9954454, 'specificity': 0.9954454, 'f1': 0.9973629, 'auroc': 0.99984103, 'binary_precision': 0.99954295, 'binary_recall': 0.99093795, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9952218}
confusion matrix:
       0     1
0  42320     2
1     40  4374
---- Validation: 
scalar performance:
{'acc': 0.9706258, 'precision': 0.86072135, 'recall': 0.6052646, 'specificity': 0.6052646, 'f1': 0.658351, 'auroc': 0.94025236, 'binary_precision': 0.74863386, 'binary_recall': 0.21306376, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.33171913}
confusion matrix:
       0    1
0  18103   46
1    506  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99705017, 'precision': 0.99833804, 'recall': 0.98722863, 'specificity': 0.98722863, 'f1': 0.9926993, 'auroc': 0.9997012, 'binary_precision': 1.0, 'binary_recall': 0.9744572, 'binary_specificity': 1.0, 'binary_f1_score': 0.98706335}
confusion matrix:
      0    1
0  5997    0
1    20  763
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_20.png
early stop counter: 10
val acc:0.9706258177757263, best validation acc: 0.9738186597824097, corresponding to test acc:                         0.9986725449562073 / 0.9988200664520264
after epoch: 20,now: 2024-06-11 11:19:25.438345,epoch time: 0:34:37.647168,used: 11:31:31.050947,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99843806, 'precision': 0.99831486, 'recall': 0.9925409, 'specificity': 0.9925409, 'f1': 0.99540675, 'auroc': 0.9995681, 'binary_precision': 0.99816346, 'binary_recall': 0.9852708, 'binary_specificity': 0.999811, 'binary_f1_score': 0.99167526}
confusion matrix:
       0     1
0  42315     8
1     65  4348
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.774032, 'recall': 0.57347167, 'specificity': 0.57347167, 'f1': 0.6112161, 'auroc': 0.8797803, 'binary_precision': 0.57738096, 'binary_recall': 0.15085536, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.23921084}
confusion matrix:
       0   1
0  18078  71
1    546  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99660766, 'precision': 0.9980897, 'recall': 0.98531294, 'specificity': 0.98531294, 'f1': 0.99159, 'auroc': 0.9999442, 'binary_precision': 1.0, 'binary_recall': 0.9706258, 'binary_specificity': 1.0, 'binary_f1_score': 0.98509395}
confusion matrix:
      0    1
0  5997    0
1    23  760
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_21.png
early stop counter: 11
val acc:0.9671669006347656, best validation acc: 0.9738186597824097, corresponding to test acc:                         0.9986725449562073 / 0.9988200664520264
after epoch: 21,now: 2024-06-11 11:54:00.121314,epoch time: 0:34:34.682969,used: 12:06:05.733916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9993581, 'precision': 0.9996458, 'recall': 0.99660015, 'specificity': 0.99660015, 'f1': 0.99811715, 'auroc': 0.99997437, 'binary_precision': 1.0, 'binary_recall': 0.99320036, 'binary_specificity': 1.0, 'binary_f1_score': 0.9965886}
confusion matrix:
       0     1
0  42324     0
1     30  4382
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.93769336, 'recall': 0.5077485, 'specificity': 0.5077485, 'f1': 0.5067067, 'auroc': 0.9618807, 'binary_precision': 0.90909094, 'binary_recall': 0.0155521, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.03058104}
confusion matrix:
       0   1
0  18148   1
1    633  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99867254, 'precision': 0.99925077, 'recall': 0.99425286, 'specificity': 0.99425286, 'f1': 0.9967349, 'auroc': 0.9999847, 'binary_precision': 1.0, 'binary_recall': 0.9885057, 'binary_specificity': 1.0, 'binary_f1_score': 0.99421966}
confusion matrix:
      0    1
0  5997    0
1     9  774
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_22.png
early stop counter: 12
val acc:0.9662622213363647, best validation acc: 0.9738186597824097, corresponding to test acc:                         0.9986725449562073 / 0.9988200664520264
after epoch: 22,now: 2024-06-11 12:28:49.651537,epoch time: 0:34:49.530223,used: 12:40:55.264139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99918693, 'precision': 0.9995515, 'recall': 0.9956955, 'specificity': 0.9956955, 'f1': 0.99761415, 'auroc': 0.9999691, 'binary_precision': 1.0, 'binary_recall': 0.991391, 'binary_specificity': 1.0, 'binary_f1_score': 0.99567693}
confusion matrix:
       0     1
0  42322     0
1     38  4376
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.8012498, 'recall': 0.505333, 'specificity': 0.505333, 'f1': 0.5020383, 'auroc': 0.95894676, 'binary_precision': 0.6363636, 'binary_recall': 0.01088647, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.021406727}
confusion matrix:
       0  1
0  18145  4
1    636  7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9989675, 'precision': 0.99941707, 'recall': 0.99553, 'specificity': 0.99553, 'f1': 0.99746335, 'auroc': 0.9999956, 'binary_precision': 1.0, 'binary_recall': 0.99106, 'binary_specificity': 1.0, 'binary_f1_score': 0.9955099}
confusion matrix:
      0    1
0  5997    0
1     7  776
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_23.png
new oracle model saved
early stop counter: 13
val acc:0.9659429788589478, best validation acc: 0.9738186597824097, corresponding to test acc:                         0.9986725449562073 / 0.9989675283432007
after epoch: 23,now: 2024-06-11 13:03:36.034367,epoch time: 0:34:46.382830,used: 13:15:41.646969,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9993581, 'precision': 0.9996458, 'recall': 0.9966017, 'specificity': 0.9966017, 'f1': 0.9981179, 'auroc': 0.99994147, 'binary_precision': 1.0, 'binary_recall': 0.99320346, 'binary_specificity': 1.0, 'binary_f1_score': 0.9965902}
confusion matrix:
       0     1
0  42322     0
1     30  4384
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.91207707, 'recall': 0.5185523, 'specificity': 0.5185523, 'f1': 0.5273287, 'auroc': 0.9674542, 'binary_precision': 0.85714287, 'binary_recall': 0.03732504, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.07153502}
confusion matrix:
       0   1
0  18145   4
1    619  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9979351, 'precision': 0.99883544, 'recall': 0.99106, 'specificity': 0.99106, 'f1': 0.9949068, 'auroc': 0.9998642, 'binary_precision': 1.0, 'binary_recall': 0.98212004, 'binary_specificity': 1.0, 'binary_f1_score': 0.9909794}
confusion matrix:
      0    1
0  5997    0
1    14  769
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_24.png
early stop counter: 14
val acc:0.9668475985527039, best validation acc: 0.9738186597824097, corresponding to test acc:                         0.9986725449562073 / 0.9989675283432007
after epoch: 24,now: 2024-06-11 13:38:47.373942,epoch time: 0:35:11.339575,used: 13:50:52.986544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9993581, 'precision': 0.99872994, 'recall': 0.99751544, 'specificity': 0.99751544, 'f1': 0.99812174, 'auroc': 0.99997926, 'binary_precision': 0.9979559, 'binary_recall': 0.9952435, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.9965979}
confusion matrix:
       0     1
0  42312     9
1     21  4394
---- Validation: 
scalar performance:
{'acc': 0.97153044, 'precision': 0.95717114, 'recall': 0.5892317, 'specificity': 0.5892317, 'f1': 0.6430615, 'auroc': 0.9711942, 'binary_precision': 0.94262296, 'binary_recall': 0.17884915, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.3006536}
confusion matrix:
       0    1
0  18142    7
1    528  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99882007, 'precision': 0.99933386, 'recall': 0.9948914, 'specificity': 0.9948914, 'f1': 0.9970994, 'auroc': 0.9999201, 'binary_precision': 1.0, 'binary_recall': 0.98978287, 'binary_specificity': 1.0, 'binary_f1_score': 0.99486524}
confusion matrix:
      0    1
0  5997    0
1     8  775
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_25.png
early stop counter: 15
val acc:0.9715304374694824, best validation acc: 0.9738186597824097, corresponding to test acc:                         0.9986725449562073 / 0.9989675283432007
after epoch: 25,now: 2024-06-11 14:13:36.313291,epoch time: 0:34:48.939349,used: 14:25:41.925893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99762493, 'precision': 0.9908633, 'recall': 0.99534035, 'specificity': 0.99534035, 'f1': 0.99308896, 'auroc': 0.99954355, 'binary_precision': 0.9825073, 'binary_recall': 0.9925238, 'binary_specificity': 0.99815696, 'binary_f1_score': 0.9874901}
confusion matrix:
       0     1
0  42244    78
1     33  4381
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.6832329, 'recall': 0.5103079, 'specificity': 0.5103079, 'f1': 0.51184285, 'auroc': 0.92373973, 'binary_precision': 0.4, 'binary_recall': 0.02177294, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.041297935}
confusion matrix:
       0   1
0  18128  21
1    629  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9982301, 'precision': 0.9967661, 'recall': 0.994558, 'specificity': 0.994558, 'f1': 0.9956587, 'auroc': 0.99985325, 'binary_precision': 0.99486524, 'binary_recall': 0.98978287, 'binary_specificity': 0.999333, 'binary_f1_score': 0.99231756}
confusion matrix:
      0    1
0  5993    4
1     8  775
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_26.png
early stop counter: 16
val acc:0.9654108285903931, best validation acc: 0.9738186597824097, corresponding to test acc:                         0.9986725449562073 / 0.9989675283432007
after epoch: 26,now: 2024-06-11 14:48:49.063789,epoch time: 0:35:12.750498,used: 15:00:54.676391,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9993367, 'precision': 0.999634, 'recall': 0.99649, 'specificity': 0.99649, 'f1': 0.9980558, 'auroc': 0.9999764, 'binary_precision': 1.0, 'binary_recall': 0.99298006, 'binary_specificity': 1.0, 'binary_f1_score': 0.9964777}
confusion matrix:
       0     1
0  42320     0
1     31  4385
---- Validation: 
scalar performance:
{'acc': 0.9698276, 'precision': 0.90800726, 'recall': 0.5718489, 'specificity': 0.5718489, 'f1': 0.61580867, 'auroc': 0.9642024, 'binary_precision': 0.8454546, 'binary_recall': 0.14463453, 'binary_specificity': 0.9990633, 'binary_f1_score': 0.24701196}
confusion matrix:
       0   1
0  18132  17
1    550  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9989675, 'precision': 0.99941707, 'recall': 0.99553, 'specificity': 0.99553, 'f1': 0.99746335, 'auroc': 0.99993485, 'binary_precision': 1.0, 'binary_recall': 0.99106, 'binary_specificity': 1.0, 'binary_f1_score': 0.9955099}
confusion matrix:
      0    1
0  5997    0
1     7  776
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_27.png
early stop counter: 17
val acc:0.9698275923728943, best validation acc: 0.9738186597824097, corresponding to test acc:                         0.9986725449562073 / 0.9989675283432007
after epoch: 27,now: 2024-06-11 15:23:16.210767,epoch time: 0:34:27.146978,used: 15:35:21.823369,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9993367, 'precision': 0.999634, 'recall': 0.99649, 'specificity': 0.99649, 'f1': 0.9980558, 'auroc': 0.999907, 'binary_precision': 1.0, 'binary_recall': 0.99298006, 'binary_specificity': 1.0, 'binary_f1_score': 0.9964777}
confusion matrix:
       0     1
0  42320     0
1     31  4385
---- Validation: 
scalar performance:
{'acc': 0.97126436, 'precision': 0.96763587, 'recall': 0.5830935, 'specificity': 0.5830935, 'f1': 0.6345788, 'auroc': 0.9578043, 'binary_precision': 0.963964, 'binary_recall': 0.16640747, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.28381965}
confusion matrix:
       0    1
0  18145    4
1    536  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9992625, 'precision': 0.9995835, 'recall': 0.99680716, 'specificity': 0.99680716, 'f1': 0.9981901, 'auroc': 0.999997, 'binary_precision': 1.0, 'binary_recall': 0.9936143, 'binary_specificity': 1.0, 'binary_f1_score': 0.9967969}
confusion matrix:
      0    1
0  5997    0
1     5  778
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_28.png
new oracle model saved
early stop counter: 18
val acc:0.9712643623352051, best validation acc: 0.9738186597824097, corresponding to test acc:                         0.9986725449562073 / 0.9992625117301941
after epoch: 28,now: 2024-06-11 16:00:25.839829,epoch time: 0:37:09.629062,used: 16:12:31.452431,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9994223, 'precision': 0.9995791, 'recall': 0.997043, 'specificity': 0.997043, 'f1': 0.998307, 'auroc': 0.9999429, 'binary_precision': 0.99977213, 'binary_recall': 0.99410963, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9969329}
confusion matrix:
       0     1
0  42321     1
1     26  4388
---- Validation: 
scalar performance:
{'acc': 0.97094506, 'precision': 0.94291425, 'recall': 0.58292824, 'specificity': 0.58292824, 'f1': 0.6333759, 'auroc': 0.959352, 'binary_precision': 0.9145299, 'binary_recall': 0.16640747, 'binary_specificity': 0.999449, 'binary_f1_score': 0.28157896}
confusion matrix:
       0    1
0  18139   10
1    536  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99837756, 'precision': 0.9990846, 'recall': 0.9929757, 'specificity': 0.9929757, 'f1': 0.9960049, 'auroc': 0.9995643, 'binary_precision': 1.0, 'binary_recall': 0.9859515, 'binary_specificity': 1.0, 'binary_f1_score': 0.99292606}
confusion matrix:
      0    1
0  5997    0
1    11  772
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_29.png
early stop counter: 19
val acc:0.9709450602531433, best validation acc: 0.9738186597824097, corresponding to test acc:                         0.9986725449562073 / 0.9992625117301941
after epoch: 29,now: 2024-06-11 16:36:47.360923,epoch time: 0:36:21.521094,used: 16:48:52.973525,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99955064, 'precision': 0.99934494, 'recall': 0.9980279, 'specificity': 0.9980279, 'f1': 0.99868536, 'auroc': 0.9998586, 'binary_precision': 0.9990915, 'binary_recall': 0.9961504, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9976188}
confusion matrix:
       0     1
0  42316     4
1     17  4399
---- Validation: 
scalar performance:
{'acc': 0.97153044, 'precision': 0.8899529, 'recall': 0.60948324, 'specificity': 0.60948324, 'f1': 0.6661062, 'auroc': 0.9574796, 'binary_precision': 0.8068182, 'binary_recall': 0.22083981, 'binary_specificity': 0.9981266, 'binary_f1_score': 0.34676436}
confusion matrix:
       0    1
0  18115   34
1    501  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99911505, 'precision': 0.9995003, 'recall': 0.9961686, 'specificity': 0.9961686, 'f1': 0.99782693, 'auroc': 0.9999627, 'binary_precision': 1.0, 'binary_recall': 0.99233717, 'binary_specificity': 1.0, 'binary_f1_score': 0.99615383}
confusion matrix:
      0    1
0  5997    0
1     6  777
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_30.png
early stop counter: 20
val acc:0.9715304374694824, best validation acc: 0.9738186597824097, corresponding to test acc:                         0.9986725449562073 / 0.9992625117301941
after epoch: 30,now: 2024-06-11 17:11:44.389423,epoch time: 0:34:57.028500,used: 17:23:50.002025,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_23_47_54_seed_0_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 17:23:50.002025 at 2024-06-11 17:11:44.389423
persisted model performance metric: 

scalar performance:
{'acc': 0.99837756, 'precision': 0.9990846, 'recall': 0.9929757, 'specificity': 0.9929757, 'f1': 0.9960049, 'auroc': 0.9999895, 'binary_precision': 1.0, 'binary_recall': 0.9859515, 'binary_specificity': 1.0, 'binary_f1_score': 0.99292606}
confusion matrix:
      0    1
0  5997    0
1    11  772
oracle model performance metric: 

scalar performance:
{'acc': 0.9985251, 'precision': 0.9991677, 'recall': 0.9936143, 'specificity': 0.9936143, 'f1': 0.9963701, 'auroc': 0.99998105, 'binary_precision': 1.0, 'binary_recall': 0.98722863, 'binary_specificity': 1.0, 'binary_f1_score': 0.99357325}
confusion matrix:
      0    1
0  5997    0
1    10  773
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |   1061 TiB |   1061 TiB |
|       from large pool |   1655 MiB |  15779 MiB |   1047 TiB |   1047 TiB |
|       from small pool |      6 MiB |     26 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |   1061 TiB |   1061 TiB |
|       from large pool |   1655 MiB |  15779 MiB |   1047 TiB |   1047 TiB |
|       from small pool |      6 MiB |     26 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |   1058 TiB |   1058 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   1045 TiB |   1045 TiB |
|       from small pool |      5 MiB |     25 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430142 KiB |    863 MiB | 443142 GiB | 443142 GiB |
|       from large pool | 410304 KiB |    862 MiB | 429396 GiB | 429396 GiB |
|       from small pool |  19838 KiB |     21 MiB |  13745 GiB |  13745 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3558    |    6725    |  162360 K  |  162356 K  |
|       from large pool |     247    |     989    |   66806 K  |   66806 K  |
|       from small pool |    3311    |    6476    |   95553 K  |   95550 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3558    |    6725    |  162360 K  |  162356 K  |
|       from large pool |     247    |     989    |   66806 K  |   66806 K  |
|       from small pool |    3311    |    6476    |   95553 K  |   95550 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     146    |    3056    |   96772 K  |   96772 K  |
|       from large pool |     112    |     516    |   50599 K  |   50599 K  |
|       from small pool |      34    |    2944    |   46173 K  |   46173 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |   1061 TiB |   1061 TiB |
|       from large pool |  16640 KiB |  15779 MiB |   1047 TiB |   1047 TiB |
|       from small pool |      0 KiB |     26 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |   1061 TiB |   1061 TiB |
|       from large pool |  16640 KiB |  15779 MiB |   1047 TiB |   1047 TiB |
|       from small pool |      0 KiB |     26 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1058 TiB |   1058 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1045 TiB |   1045 TiB |
|       from small pool |      0 KiB |     25 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 443143 GiB | 443143 GiB |
|       from large pool |  24320 KiB |    862 MiB | 429397 GiB | 429397 GiB |
|       from small pool |      0 KiB |     24 MiB |  13745 GiB |  13745 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6725    |  162360 K  |  162360 K  |
|       from large pool |       2    |     989    |   66806 K  |   66806 K  |
|       from small pool |       0    |    6476    |   95553 K  |   95553 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6725    |  162360 K  |  162360 K  |
|       from large pool |       2    |     989    |   66806 K  |   66806 K  |
|       from small pool |       0    |    6476    |   95553 K  |   95553 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3056    |   96774 K  |   96774 K  |
|       from large pool |       2    |     516    |   50599 K  |   50599 K  |
|       from small pool |       0    |    2944    |   46174 K  |   46174 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |   1061 TiB |   1061 TiB |
|       from large pool |  16640 KiB |  15779 MiB |   1047 TiB |   1047 TiB |
|       from small pool |      0 KiB |     26 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |   1061 TiB |   1061 TiB |
|       from large pool |  16640 KiB |  15779 MiB |   1047 TiB |   1047 TiB |
|       from small pool |      0 KiB |     26 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1058 TiB |   1058 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1045 TiB |   1045 TiB |
|       from small pool |      0 KiB |     25 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 443143 GiB | 443143 GiB |
|       from large pool |  24320 KiB |    862 MiB | 429397 GiB | 429397 GiB |
|       from small pool |      0 KiB |     24 MiB |  13745 GiB |  13745 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6725    |  162360 K  |  162360 K  |
|       from large pool |       2    |     989    |   66806 K  |   66806 K  |
|       from small pool |       0    |    6476    |   95553 K  |   95553 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6725    |  162360 K  |  162360 K  |
|       from large pool |       2    |     989    |   66806 K  |   66806 K  |
|       from small pool |       0    |    6476    |   95553 K  |   95553 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3056    |   96774 K  |   96774 K  |
|       from large pool |       2    |     516    |   50599 K  |   50599 K  |
|       from small pool |       0    |    2944    |   46174 K  |   46174 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205

 Experiment start at: 2024-06-11 17:17:48.714675
before training, model accuracy: 0.12533451616764069
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9967691, 'precision': 0.9958757, 'recall': 0.9848308, 'specificity': 0.9848308, 'f1': 0.99027544, 'auroc': 0.9992149, 'binary_precision': 0.9947855, 'binary_recall': 0.97018033, 'binary_specificity': 0.99948126, 'binary_f1_score': 0.9823289}
confusion matrix:
       0     1
0  42388    22
1    129  4197
---- Validation: 
scalar performance:
{'acc': 0.96334046, 'precision': 0.69408697, 'recall': 0.5267927, 'specificity': 0.5267927, 'f1': 0.54044807, 'auroc': 0.88772297, 'binary_precision': 0.42222223, 'binary_recall': 0.056463595, 'binary_specificity': 0.9971218, 'binary_f1_score': 0.09960681}
confusion matrix:
       0   1
0  18015  52
1    635  38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.995391, 'precision': 0.9974067, 'recall': 0.98012817, 'specificity': 0.98012817, 'f1': 0.9885627, 'auroc': 0.9991361, 'binary_precision': 1.0, 'binary_recall': 0.9602564, 'binary_specificity': 1.0, 'binary_f1_score': 0.97972536}
confusion matrix:
      0    1
0  5946    0
1    31  749
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-11 17:53:52.226513,epoch time: 0:36:03.511838,used: 0:36:03.511838,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99835247, 'precision': 0.9989879, 'recall': 0.99120414, 'specificity': 0.99120414, 'f1': 0.9950577, 'auroc': 0.9995688, 'binary_precision': 0.99976474, 'binary_recall': 0.9824318, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99102247}
confusion matrix:
       0     1
0  42409     1
1     76  4250
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.8260684, 'recall': 0.52556014, 'specificity': 0.52556014, 'f1': 0.539446, 'auroc': 0.9301406, 'binary_precision': 0.6862745, 'binary_recall': 0.052005943, 'binary_specificity': 0.9991144, 'binary_f1_score': 0.096685074}
confusion matrix:
       0   1
0  18051  16
1    638  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99717516, 'precision': 0.99840736, 'recall': 0.9878205, 'specificity': 0.9878205, 'f1': 0.9930376, 'auroc': 0.9995278, 'binary_precision': 1.0, 'binary_recall': 0.975641, 'binary_specificity': 1.0, 'binary_f1_score': 0.98767036}
confusion matrix:
      0    1
0  5946    0
1    19  761
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-11 18:28:38.869997,epoch time: 0:34:46.643484,used: 1:10:50.155322,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9982027, 'precision': 0.9955689, 'recall': 0.99371636, 'specificity': 0.99371636, 'f1': 0.99464047, 'auroc': 0.99977624, 'binary_precision': 0.99233985, 'binary_recall': 0.9882108, 'binary_specificity': 0.99922186, 'binary_f1_score': 0.99027103}
confusion matrix:
       0     1
0  42377    33
1     51  4275
---- Validation: 
scalar performance:
{'acc': 0.9654749, 'precision': 0.7557163, 'recall': 0.6323287, 'specificity': 0.6323287, 'f1': 0.67240924, 'auroc': 0.9260465, 'binary_precision': 0.53801167, 'binary_recall': 0.27340266, 'binary_specificity': 0.99125475, 'binary_f1_score': 0.36256152}
confusion matrix:
       0    1
0  17909  158
1    489  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99598575, 'precision': 0.9977398, 'recall': 0.9826923, 'specificity': 0.9826923, 'f1': 0.9900611, 'auroc': 0.9991248, 'binary_precision': 1.0, 'binary_recall': 0.9653846, 'binary_specificity': 1.0, 'binary_f1_score': 0.9823875}
confusion matrix:
      0    1
0  5946    0
1    27  753
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_3.png
better model found
persisted
after epoch: 3,now: 2024-06-11 19:03:10.414788,epoch time: 0:34:31.544791,used: 1:45:21.700113,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9980743, 'precision': 0.9922594, 'recall': 0.9963435, 'specificity': 0.9963435, 'f1': 0.9942908, 'auroc': 0.9996952, 'binary_precision': 0.9851088, 'binary_recall': 0.99421966, 'binary_specificity': 0.9984674, 'binary_f1_score': 0.9896433}
confusion matrix:
       0     1
0  42346    65
1     25  4300
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.83049023, 'recall': 0.5657578, 'specificity': 0.5657578, 'f1': 0.6035867, 'auroc': 0.94962966, 'binary_precision': 0.6923077, 'binary_recall': 0.13372956, 'binary_specificity': 0.99778605, 'binary_f1_score': 0.22415939}
confusion matrix:
       0   1
0  18027  40
1    583  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99791855, 'precision': 0.9988255, 'recall': 0.9910256, 'specificity': 0.9910256, 'f1': 0.99488425, 'auroc': 0.99990606, 'binary_precision': 1.0, 'binary_recall': 0.98205125, 'binary_specificity': 1.0, 'binary_f1_score': 0.9909444}
confusion matrix:
      0    1
0  5946    0
1    14  766
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-11 19:37:36.248499,epoch time: 0:34:25.833711,used: 2:19:47.533824,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9982883, 'precision': 0.9990586, 'recall': 0.9907536, 'specificity': 0.9907536, 'f1': 0.9948625, 'auroc': 0.9997711, 'binary_precision': 1.0, 'binary_recall': 0.9815072, 'binary_specificity': 1.0, 'binary_f1_score': 0.9906673}
confusion matrix:
       0     1
0  42410     0
1     80  4246
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.4820428, 'recall': 0.4999723, 'specificity': 0.4999723, 'f1': 0.49084386, 'auroc': 0.9193777, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18066  1
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9980672, 'precision': 0.99890924, 'recall': 0.9916667, 'specificity': 0.9916667, 'f1': 0.9952523, 'auroc': 0.999992, 'binary_precision': 1.0, 'binary_recall': 0.98333335, 'binary_specificity': 1.0, 'binary_f1_score': 0.99159664}
confusion matrix:
      0    1
0  5946    0
1    13  767
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_5.png
new oracle model saved
early stop counter: 1
val acc:0.9640341401100159, best validation acc: 0.9667556285858154, corresponding to test acc:                         0.9979185461997986 / 0.9980672001838684
after epoch: 5,now: 2024-06-11 20:12:15.929665,epoch time: 0:34:39.681166,used: 2:54:27.214990,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99920833, 'precision': 0.9991457, 'recall': 0.99613786, 'specificity': 0.99613786, 'f1': 0.9976361, 'auroc': 0.99971414, 'binary_precision': 0.9990689, 'binary_recall': 0.99236995, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.99570817}
confusion matrix:
       0     1
0  42407     4
1     33  4292
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.78557694, 'recall': 0.51449907, 'specificity': 0.51449907, 'f1': 0.5192733, 'auroc': 0.94220054, 'binary_precision': 0.6060606, 'binary_recall': 0.029717682, 'binary_specificity': 0.99928045, 'binary_f1_score': 0.056657225}
confusion matrix:
       0   1
0  18054  13
1    653  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9992566, 'precision': 0.9995799, 'recall': 0.9967949, 'specificity': 0.9967949, 'f1': 0.9981822, 'auroc': 0.99998486, 'binary_precision': 1.0, 'binary_recall': 0.99358976, 'binary_specificity': 1.0, 'binary_f1_score': 0.99678457}
confusion matrix:
      0    1
0  5946    0
1     5  775
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_6.png
new oracle model saved
early stop counter: 2
val acc:0.9644610285758972, best validation acc: 0.9667556285858154, corresponding to test acc:                         0.9979185461997986 / 0.9992566108703613
after epoch: 6,now: 2024-06-11 20:48:14.687078,epoch time: 0:35:58.757413,used: 3:30:25.972403,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99766773, 'precision': 0.99871826, 'recall': 0.98739594, 'specificity': 0.98739594, 'f1': 0.99297583, 'auroc': 0.99967724, 'binary_precision': 1.0, 'binary_recall': 0.9747919, 'binary_specificity': 1.0, 'binary_f1_score': 0.98723507}
confusion matrix:
       0     1
0  42412     0
1    109  4215
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.48203993, 'recall': 0.4998893, 'specificity': 0.4998893, 'f1': 0.49080238, 'auroc': 0.93984365, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18063  4
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9956884, 'precision': 0.99757326, 'recall': 0.98141026, 'specificity': 0.98141026, 'f1': 0.9893127, 'auroc': 0.99881107, 'binary_precision': 1.0, 'binary_recall': 0.96282053, 'binary_specificity': 1.0, 'binary_f1_score': 0.9810581}
confusion matrix:
      0    1
0  5946    0
1    29  751
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_7.png
early stop counter: 3
val acc:0.9638740420341492, best validation acc: 0.9667556285858154, corresponding to test acc:                         0.9979185461997986 / 0.9992566108703613
after epoch: 7,now: 2024-06-11 21:24:10.853340,epoch time: 0:35:56.166262,used: 4:06:22.138665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.998652, 'precision': 0.99831265, 'recall': 0.99365115, 'specificity': 0.99365115, 'f1': 0.9959682, 'auroc': 0.9998018, 'binary_precision': 0.9978972, 'binary_recall': 0.98751444, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.99267864}
confusion matrix:
       0     1
0  42402     9
1     54  4271
---- Validation: 
scalar performance:
{'acc': 0.9689434, 'precision': 0.8380848, 'recall': 0.61481535, 'specificity': 0.61481535, 'f1': 0.66726893, 'auroc': 0.94579387, 'binary_precision': 0.7040359, 'binary_recall': 0.2332838, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.35044643}
confusion matrix:
       0    1
0  18001   66
1    516  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99672914, 'precision': 0.99815685, 'recall': 0.9858974, 'specificity': 0.9858974, 'f1': 0.9919246, 'auroc': 0.9998047, 'binary_precision': 1.0, 'binary_recall': 0.97179484, 'binary_specificity': 1.0, 'binary_f1_score': 0.9856957}
confusion matrix:
      0    1
0  5946    0
1    22  758
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_8.png
better model found
persisted
after epoch: 8,now: 2024-06-11 22:00:20.468536,epoch time: 0:36:09.615196,used: 4:42:31.753861,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99880177, 'precision': 0.99798, 'recall': 0.99487567, 'specificity': 0.99487567, 'f1': 0.99642175, 'auroc': 0.99993896, 'binary_precision': 0.9969732, 'binary_recall': 0.9900578, 'binary_specificity': 0.99969345, 'binary_f1_score': 0.9935035}
confusion matrix:
       0     1
0  42398    13
1     43  4282
---- Validation: 
scalar performance:
{'acc': 0.9728922, 'precision': 0.850162, 'recall': 0.69625795, 'specificity': 0.69625795, 'f1': 0.7497339, 'auroc': 0.9421501, 'binary_precision': 0.722372, 'binary_recall': 0.39821693, 'binary_specificity': 0.994299, 'binary_f1_score': 0.51341}
confusion matrix:
       0    1
0  17964  103
1    405  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9980672, 'precision': 0.99890924, 'recall': 0.9916667, 'specificity': 0.9916667, 'f1': 0.9952523, 'auroc': 0.99986875, 'binary_precision': 1.0, 'binary_recall': 0.98333335, 'binary_specificity': 1.0, 'binary_f1_score': 0.99159664}
confusion matrix:
      0    1
0  5946    0
1    13  767
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_9.png
better model found
persisted
after epoch: 9,now: 2024-06-11 22:36:14.200128,epoch time: 0:35:53.731592,used: 5:18:25.485453,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99839526, 'precision': 0.9991174, 'recall': 0.9913295, 'specificity': 0.9913295, 'f1': 0.99518514, 'auroc': 0.99987066, 'binary_precision': 1.0, 'binary_recall': 0.982659, 'binary_specificity': 1.0, 'binary_f1_score': 0.9912537}
confusion matrix:
       0     1
0  42411     0
1     75  4250
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.9821467, 'recall': 0.50297177, 'specificity': 0.50297177, 'f1': 0.4968195, 'auroc': 0.95590127, 'binary_precision': 1.0, 'binary_recall': 0.0059435363, 'binary_specificity': 1.0, 'binary_f1_score': 0.011816839}
confusion matrix:
       0  1
0  18067  0
1    669  4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9976212, 'precision': 0.9986582, 'recall': 0.9897436, 'specificity': 0.9897436, 'f1': 0.9941468, 'auroc': 0.99995947, 'binary_precision': 1.0, 'binary_recall': 0.9794872, 'binary_specificity': 1.0, 'binary_f1_score': 0.9896373}
confusion matrix:
      0    1
0  5946    0
1    16  764
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_10.png
early stop counter: 1
val acc:0.9643009901046753, best validation acc: 0.9728922247886658, corresponding to test acc:                         0.9980672001838684 / 0.9992566108703613
after epoch: 10,now: 2024-06-11 23:12:18.545922,epoch time: 0:36:04.345794,used: 5:54:29.831247,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9992939, 'precision': 0.9991932, 'recall': 0.9966003, 'specificity': 0.9966003, 'f1': 0.9978925, 'auroc': 0.9999159, 'binary_precision': 0.99906975, 'binary_recall': 0.9932948, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.9961739}
confusion matrix:
       0     1
0  42407     4
1     29  4296
---- Validation: 
scalar performance:
{'acc': 0.9695304, 'precision': 0.92824197, 'recall': 0.5865091, 'specificity': 0.5865091, 'f1': 0.637557, 'auroc': 0.9502559, 'binary_precision': 0.8863636, 'binary_recall': 0.17384844, 'binary_specificity': 0.99916977, 'binary_f1_score': 0.2906832}
confusion matrix:
       0    1
0  18052   15
1    556  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9992566, 'precision': 0.9995799, 'recall': 0.9967949, 'specificity': 0.9967949, 'f1': 0.9981822, 'auroc': 0.999957, 'binary_precision': 1.0, 'binary_recall': 0.99358976, 'binary_specificity': 1.0, 'binary_f1_score': 0.99678457}
confusion matrix:
      0    1
0  5946    0
1     5  775
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_11.png
early stop counter: 2
val acc:0.9695304036140442, best validation acc: 0.9728922247886658, corresponding to test acc:                         0.9980672001838684 / 0.9992566108703613
after epoch: 11,now: 2024-06-11 23:48:11.575554,epoch time: 0:35:53.029632,used: 6:30:22.860879,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99916553, 'precision': 0.9992265, 'recall': 0.9958037, 'specificity': 0.9958037, 'f1': 0.99750775, 'auroc': 0.9997323, 'binary_precision': 0.9993012, 'binary_recall': 0.99167824, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9954752}
confusion matrix:
       0     1
0  42407     3
1     36  4290
---- Validation: 
scalar performance:
{'acc': 0.9660619, 'precision': 0.8900514, 'recall': 0.53535676, 'specificity': 0.53535676, 'f1': 0.55692023, 'auroc': 0.94883007, 'binary_precision': 0.8135593, 'binary_recall': 0.07132243, 'binary_specificity': 0.99939114, 'binary_f1_score': 0.13114753}
confusion matrix:
       0   1
0  18056  11
1    625  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985132, 'precision': 0.9991605, 'recall': 0.99358976, 'specificity': 0.99358976, 'f1': 0.99635404, 'auroc': 0.99997544, 'binary_precision': 1.0, 'binary_recall': 0.98717946, 'binary_specificity': 1.0, 'binary_f1_score': 0.99354833}
confusion matrix:
      0    1
0  5946    0
1    10  770
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_12.png
early stop counter: 3
val acc:0.9660618901252747, best validation acc: 0.9728922247886658, corresponding to test acc:                         0.9980672001838684 / 0.9992566108703613
after epoch: 12,now: 2024-06-12 00:24:27.256393,epoch time: 0:36:15.680839,used: 7:06:38.541718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9980101, 'precision': 0.9912278, 'recall': 0.99703443, 'specificity': 0.99703443, 'f1': 0.99410975, 'auroc': 0.9999187, 'binary_precision': 0.9828806, 'binary_recall': 0.9958372, 'binary_specificity': 0.99823165, 'binary_f1_score': 0.9893165}
confusion matrix:
       0     1
0  42337    75
1     18  4306
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.78502774, 'recall': 0.6079309, 'specificity': 0.6079309, 'f1': 0.6530708, 'auroc': 0.9562001, 'binary_precision': 0.59839356, 'binary_recall': 0.22139673, 'binary_specificity': 0.99446505, 'binary_f1_score': 0.32321042}
confusion matrix:
       0    1
0  17967  100
1    524  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9980672, 'precision': 0.9955604, 'recall': 0.99500823, 'specificity': 0.99500823, 'f1': 0.9952841, 'auroc': 0.99993896, 'binary_precision': 0.9922978, 'binary_recall': 0.9910256, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.9916613}
confusion matrix:
      0    1
0  5940    6
1     7  773
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_13.png
early stop counter: 4
val acc:0.9667022228240967, best validation acc: 0.9728922247886658, corresponding to test acc:                         0.9980672001838684 / 0.9992566108703613
after epoch: 13,now: 2024-06-12 01:00:25.543222,epoch time: 0:35:58.286829,used: 7:42:36.828547,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99907994, 'precision': 0.99917895, 'recall': 0.9953393, 'specificity': 0.9953393, 'f1': 0.99724984, 'auroc': 0.9997058, 'binary_precision': 0.9993002, 'binary_recall': 0.9907493, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9950064}
confusion matrix:
       0     1
0  42409     3
1     40  4284
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.95735455, 'recall': 0.5274335, 'specificity': 0.5274335, 'f1': 0.5432903, 'auroc': 0.9649508, 'binary_precision': 0.94871795, 'binary_recall': 0.05497771, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.10393259}
confusion matrix:
       0   1
0  18065   2
1    636  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985132, 'precision': 0.9991605, 'recall': 0.99358976, 'specificity': 0.99358976, 'f1': 0.99635404, 'auroc': 0.99997455, 'binary_precision': 1.0, 'binary_recall': 0.98717946, 'binary_specificity': 1.0, 'binary_f1_score': 0.99354833}
confusion matrix:
      0    1
0  5946    0
1    10  770
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_14.png
early stop counter: 5
val acc:0.9659551978111267, best validation acc: 0.9728922247886658, corresponding to test acc:                         0.9980672001838684 / 0.9992566108703613
after epoch: 14,now: 2024-06-12 01:36:33.484364,epoch time: 0:36:07.941142,used: 8:18:44.769689,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99952924, 'precision': 0.9988056, 'recall': 0.9983914, 'specificity': 0.9983914, 'f1': 0.99859834, 'auroc': 0.99998903, 'binary_precision': 0.99791765, 'binary_recall': 0.9969949, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.997456}
confusion matrix:
       0     1
0  42401     9
1     13  4313
---- Validation: 
scalar performance:
{'acc': 0.9751334, 'precision': 0.90836215, 'recall': 0.6888371, 'specificity': 0.6888371, 'f1': 0.7553755, 'auroc': 0.9555448, 'binary_precision': 0.83934426, 'binary_recall': 0.38038632, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.5235174}
confusion matrix:
       0    1
0  18018   49
1    417  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9988106, 'precision': 0.9993282, 'recall': 0.9948718, 'specificity': 0.9948718, 'f1': 0.9970865, 'auroc': 0.99940246, 'binary_precision': 1.0, 'binary_recall': 0.9897436, 'binary_specificity': 1.0, 'binary_f1_score': 0.9948454}
confusion matrix:
      0    1
0  5946    0
1     8  772
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_15.png
better model found
persisted
after epoch: 15,now: 2024-06-12 02:12:27.486746,epoch time: 0:35:54.002382,used: 8:54:38.772071,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99884456, 'precision': 0.99936414, 'recall': 0.9937587, 'specificity': 0.9937587, 'f1': 0.9965416, 'auroc': 0.999753, 'binary_precision': 1.0, 'binary_recall': 0.98751736, 'binary_specificity': 1.0, 'binary_f1_score': 0.99371946}
confusion matrix:
       0     1
0  42410     0
1     54  4272
---- Validation: 
scalar performance:
{'acc': 0.965635, 'precision': 0.9400084, 'recall': 0.5236911, 'specificity': 0.5236911, 'f1': 0.5364411, 'auroc': 0.9585345, 'binary_precision': 0.9142857, 'binary_recall': 0.04754829, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.09039548}
confusion matrix:
       0   1
0  18064   3
1    641  32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99747247, 'precision': 0.99857455, 'recall': 0.9891026, 'specificity': 0.9891026, 'f1': 0.9937775, 'auroc': 0.99946314, 'binary_precision': 1.0, 'binary_recall': 0.97820514, 'binary_specificity': 1.0, 'binary_f1_score': 0.9889825}
confusion matrix:
      0    1
0  5946    0
1    17  763
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_16.png
early stop counter: 1
val acc:0.9656350016593933, best validation acc: 0.9751334190368652, corresponding to test acc:                         0.9988105893135071 / 0.9992566108703613
after epoch: 16,now: 2024-06-12 02:48:19.594722,epoch time: 0:35:52.107976,used: 9:30:30.880047,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9982669, 'precision': 0.9990469, 'recall': 0.9906315, 'specificity': 0.9906315, 'f1': 0.9947945, 'auroc': 0.9999049, 'binary_precision': 1.0, 'binary_recall': 0.98126304, 'binary_specificity': 1.0, 'binary_f1_score': 0.99054295}
confusion matrix:
       0     1
0  42413     0
1     81  4242
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.85712, 'recall': 0.50220114, 'specificity': 0.50220114, 'f1': 0.4953152, 'auroc': 0.95947397, 'binary_precision': 0.75, 'binary_recall': 0.004457652, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.008862629}
confusion matrix:
       0  1
0  18066  1
1    670  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99643177, 'precision': 0.99798995, 'recall': 0.9846154, 'specificity': 0.9846154, 'f1': 0.9911804, 'auroc': 0.9998182, 'binary_precision': 1.0, 'binary_recall': 0.9692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.984375}
confusion matrix:
      0    1
0  5946    0
1    24  756
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_17.png
early stop counter: 2
val acc:0.9641942381858826, best validation acc: 0.9751334190368652, corresponding to test acc:                         0.9988105893135071 / 0.9992566108703613
after epoch: 17,now: 2024-06-12 03:24:17.424472,epoch time: 0:35:57.829750,used: 10:06:28.709797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99905854, 'precision': 0.9994818, 'recall': 0.9949133, 'specificity': 0.9949133, 'f1': 0.9971844, 'auroc': 0.9998425, 'binary_precision': 1.0, 'binary_recall': 0.98982656, 'binary_specificity': 1.0, 'binary_f1_score': 0.9948873}
confusion matrix:
       0     1
0  42411     0
1     44  4281
---- Validation: 
scalar performance:
{'acc': 0.96755606, 'precision': 0.8806951, 'recall': 0.5647424, 'specificity': 0.5647424, 'f1': 0.60396063, 'auroc': 0.94704974, 'binary_precision': 0.7927928, 'binary_recall': 0.1307578, 'binary_specificity': 0.99872696, 'binary_f1_score': 0.2244898}
confusion matrix:
       0   1
0  18044  23
1    585  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99776983, 'precision': 0.99874187, 'recall': 0.9903846, 'specificity': 0.9903846, 'f1': 0.9945158, 'auroc': 0.99984837, 'binary_precision': 1.0, 'binary_recall': 0.9807692, 'binary_specificity': 1.0, 'binary_f1_score': 0.9902913}
confusion matrix:
      0    1
0  5946    0
1    15  765
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_18.png
early stop counter: 3
val acc:0.9675560593605042, best validation acc: 0.9751334190368652, corresponding to test acc:                         0.9988105893135071 / 0.9992566108703613
after epoch: 18,now: 2024-06-12 04:00:13.901629,epoch time: 0:35:56.477157,used: 10:42:25.186954,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9982669, 'precision': 0.9934789, 'recall': 0.9962427, 'specificity': 0.9962427, 'f1': 0.99485594, 'auroc': 0.9998199, 'binary_precision': 0.9875948, 'binary_recall': 0.9937587, 'binary_specificity': 0.9987267, 'binary_f1_score': 0.9906671}
confusion matrix:
       0     1
0  42356    54
1     27  4299
---- Validation: 
scalar performance:
{'acc': 0.9624867, 'precision': 0.67464286, 'recall': 0.53421783, 'specificity': 0.53421783, 'f1': 0.55159044, 'auroc': 0.93263215, 'binary_precision': 0.3828125, 'binary_recall': 0.07280832, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.122347064}
confusion matrix:
       0   1
0  17988  79
1    624  49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866194, 'precision': 0.99868125, 'recall': 0.9947877, 'specificity': 0.9947877, 'f1': 0.99672425, 'auroc': 0.99983275, 'binary_precision': 0.99870634, 'binary_recall': 0.9897436, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.9942048}
confusion matrix:
      0    1
0  5945    1
1     8  772
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_19.png
early stop counter: 4
val acc:0.9624866843223572, best validation acc: 0.9751334190368652, corresponding to test acc:                         0.9988105893135071 / 0.9992566108703613
after epoch: 19,now: 2024-06-12 04:36:15.593691,epoch time: 0:36:01.692062,used: 11:18:26.879016,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9966407, 'precision': 0.9867182, 'recall': 0.9934772, 'specificity': 0.9934772, 'f1': 0.9900684, 'auroc': 0.999715, 'binary_precision': 0.9744991, 'binary_recall': 0.98959535, 'binary_specificity': 0.99735916, 'binary_f1_score': 0.9819892}
confusion matrix:
       0     1
0  42299   112
1     45  4280
---- Validation: 
scalar performance:
{'acc': 0.96766275, 'precision': 0.7680155, 'recall': 0.7464756, 'specificity': 0.7464756, 'f1': 0.7567438, 'auroc': 0.9560704, 'binary_precision': 0.554295, 'binary_recall': 0.50817233, 'binary_specificity': 0.9847789, 'binary_f1_score': 0.53023255}
confusion matrix:
       0    1
0  17792  275
1    331  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9992566, 'precision': 0.99902034, 'recall': 0.99735177, 'specificity': 0.99735177, 'f1': 0.9981842, 'auroc': 0.99996805, 'binary_precision': 0.998713, 'binary_recall': 0.9948718, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.9967887}
confusion matrix:
      0    1
0  5945    1
1     4  776
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_20.png
early stop counter: 5
val acc:0.9676627516746521, best validation acc: 0.9751334190368652, corresponding to test acc:                         0.9988105893135071 / 0.9992566108703613
after epoch: 20,now: 2024-06-12 05:12:15.264323,epoch time: 0:35:59.670632,used: 11:54:26.549648,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9992511, 'precision': 0.9995877, 'recall': 0.99595284, 'specificity': 0.99595284, 'f1': 0.99776196, 'auroc': 0.9997772, 'binary_precision': 1.0, 'binary_recall': 0.9919056, 'binary_specificity': 1.0, 'binary_f1_score': 0.99593633}
confusion matrix:
       0     1
0  42412     0
1     35  4289
---- Validation: 
scalar performance:
{'acc': 0.9710779, 'precision': 0.92746484, 'recall': 0.61163074, 'specificity': 0.61163074, 'f1': 0.67151284, 'auroc': 0.9619367, 'binary_precision': 0.88304096, 'binary_recall': 0.2243685, 'binary_specificity': 0.998893, 'binary_f1_score': 0.35781989}
confusion matrix:
       0    1
0  18047   20
1    522  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985132, 'precision': 0.9991605, 'recall': 0.99358976, 'specificity': 0.99358976, 'f1': 0.99635404, 'auroc': 0.99995816, 'binary_precision': 1.0, 'binary_recall': 0.98717946, 'binary_specificity': 1.0, 'binary_f1_score': 0.99354833}
confusion matrix:
      0    1
0  5946    0
1    10  770
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_21.png
early stop counter: 6
val acc:0.9710779190063477, best validation acc: 0.9751334190368652, corresponding to test acc:                         0.9988105893135071 / 0.9992566108703613
after epoch: 21,now: 2024-06-12 05:48:25.489613,epoch time: 0:36:10.225290,used: 12:30:36.774938,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99920833, 'precision': 0.9994594, 'recall': 0.9958273, 'specificity': 0.9958273, 'f1': 0.99763507, 'auroc': 0.9998892, 'binary_precision': 0.99976695, 'binary_recall': 0.99167824, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9957062}
confusion matrix:
       0     1
0  42409     1
1     36  4290
---- Validation: 
scalar performance:
{'acc': 0.96792954, 'precision': 0.87523174, 'recall': 0.5735193, 'specificity': 0.5735193, 'f1': 0.61665124, 'auroc': 0.9500254, 'binary_precision': 0.78125, 'binary_recall': 0.1485884, 'binary_specificity': 0.9984502, 'binary_f1_score': 0.24968787}
confusion matrix:
       0    1
0  18039   28
1    573  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99628305, 'precision': 0.99790657, 'recall': 0.98397434, 'specificity': 0.98397434, 'f1': 0.9908078, 'auroc': 0.9999403, 'binary_precision': 1.0, 'binary_recall': 0.96794873, 'binary_specificity': 1.0, 'binary_f1_score': 0.9837134}
confusion matrix:
      0    1
0  5946    0
1    25  755
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_22.png
early stop counter: 7
val acc:0.9679295420646667, best validation acc: 0.9751334190368652, corresponding to test acc:                         0.9988105893135071 / 0.9992566108703613
after epoch: 22,now: 2024-06-12 06:24:37.027293,epoch time: 0:36:11.537680,used: 13:06:48.312618,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9992297, 'precision': 0.9994712, 'recall': 0.9959429, 'specificity': 0.9959429, 'f1': 0.99769926, 'auroc': 0.9999638, 'binary_precision': 0.999767, 'binary_recall': 0.9919094, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9958227}
confusion matrix:
       0     1
0  42409     1
1     35  4291
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.98317826, 'recall': 0.53268945, 'specificity': 0.53268945, 'f1': 0.552812, 'auroc': 0.97093207, 'binary_precision': 1.0, 'binary_recall': 0.0653789, 'binary_specificity': 1.0, 'binary_f1_score': 0.12273361}
confusion matrix:
       0   1
0  18067   0
1    629  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99791855, 'precision': 0.9988255, 'recall': 0.9910256, 'specificity': 0.9910256, 'f1': 0.99488425, 'auroc': 0.99942803, 'binary_precision': 1.0, 'binary_recall': 0.98205125, 'binary_specificity': 1.0, 'binary_f1_score': 0.9909444}
confusion matrix:
      0    1
0  5946    0
1    14  766
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_23.png
early stop counter: 8
val acc:0.966435432434082, best validation acc: 0.9751334190368652, corresponding to test acc:                         0.9988105893135071 / 0.9992566108703613
after epoch: 23,now: 2024-06-12 07:00:58.663592,epoch time: 0:36:21.636299,used: 13:43:09.948917,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99841666, 'precision': 0.9972415, 'recall': 0.9933153, 'specificity': 0.9933153, 'f1': 0.99526864, 'auroc': 0.9997803, 'binary_precision': 0.9958022, 'binary_recall': 0.987055, 'binary_specificity': 0.99957556, 'binary_f1_score': 0.99140936}
confusion matrix:
       0     1
0  42392    18
1     56  4270
---- Validation: 
scalar performance:
{'acc': 0.96792954, 'precision': 0.8845059, 'recall': 0.5706582, 'specificity': 0.5706582, 'f1': 0.61286837, 'auroc': 0.9394041, 'binary_precision': 0.8, 'binary_recall': 0.14264487, 'binary_specificity': 0.9986716, 'binary_f1_score': 0.24211852}
confusion matrix:
       0   1
0  18043  24
1    577  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9968778, 'precision': 0.99824035, 'recall': 0.98653847, 'specificity': 0.98653847, 'f1': 0.992296, 'auroc': 0.999876, 'binary_precision': 1.0, 'binary_recall': 0.97307694, 'binary_specificity': 1.0, 'binary_f1_score': 0.98635477}
confusion matrix:
      0    1
0  5946    0
1    21  759
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_24.png
early stop counter: 9
val acc:0.9679295420646667, best validation acc: 0.9751334190368652, corresponding to test acc:                         0.9988105893135071 / 0.9992566108703613
after epoch: 24,now: 2024-06-12 07:37:13.884878,epoch time: 0:36:15.221286,used: 14:19:25.170203,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99845946, 'precision': 0.9954137, 'recall': 0.9954137, 'specificity': 0.9954137, 'f1': 0.9954137, 'auroc': 0.9998222, 'binary_precision': 0.9916763, 'binary_recall': 0.9916763, 'binary_specificity': 0.9991512, 'binary_f1_score': 0.9916763}
confusion matrix:
       0     1
0  42375    36
1     36  4289
---- Validation: 
scalar performance:
{'acc': 0.96990395, 'precision': 0.83469695, 'recall': 0.6417784, 'specificity': 0.6417784, 'f1': 0.6960614, 'auroc': 0.96007055, 'binary_precision': 0.6953405, 'binary_recall': 0.2882615, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.407563}
confusion matrix:
       0    1
0  17982   85
1    479  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985132, 'precision': 0.9991605, 'recall': 0.99358976, 'specificity': 0.99358976, 'f1': 0.99635404, 'auroc': 0.9999508, 'binary_precision': 1.0, 'binary_recall': 0.98717946, 'binary_specificity': 1.0, 'binary_f1_score': 0.99354833}
confusion matrix:
      0    1
0  5946    0
1    10  770
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_25.png
early stop counter: 10
val acc:0.9699039459228516, best validation acc: 0.9751334190368652, corresponding to test acc:                         0.9988105893135071 / 0.9992566108703613
after epoch: 25,now: 2024-06-12 08:13:32.209026,epoch time: 0:36:18.324148,used: 14:55:43.494351,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9985664, 'precision': 0.9992113, 'recall': 0.99225616, 'specificity': 0.99225616, 'f1': 0.9957032, 'auroc': 0.9999124, 'binary_precision': 1.0, 'binary_recall': 0.98451227, 'binary_specificity': 1.0, 'binary_f1_score': 0.99219567}
confusion matrix:
       0     1
0  42410     0
1     67  4259
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.98237836, 'recall': 0.5096582, 'specificity': 0.5096582, 'f1': 0.50998163, 'auroc': 0.9707365, 'binary_precision': 1.0, 'binary_recall': 0.019316493, 'binary_specificity': 1.0, 'binary_f1_score': 0.037900876}
confusion matrix:
       0   1
0  18067   0
1    660  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99776983, 'precision': 0.99874187, 'recall': 0.9903846, 'specificity': 0.9903846, 'f1': 0.9945158, 'auroc': 0.9997112, 'binary_precision': 1.0, 'binary_recall': 0.9807692, 'binary_specificity': 1.0, 'binary_f1_score': 0.9902913}
confusion matrix:
      0    1
0  5946    0
1    15  765
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_26.png
early stop counter: 11
val acc:0.9647812247276306, best validation acc: 0.9751334190368652, corresponding to test acc:                         0.9988105893135071 / 0.9992566108703613
after epoch: 26,now: 2024-06-12 08:50:00.127846,epoch time: 0:36:27.918820,used: 15:32:11.413171,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9992511, 'precision': 0.9993783, 'recall': 0.9961614, 'specificity': 0.9961614, 'f1': 0.9977634, 'auroc': 0.99992216, 'binary_precision': 0.99953425, 'binary_recall': 0.99236995, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9959392}
confusion matrix:
       0     1
0  42409     2
1     33  4292
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.81092465, 'recall': 0.5291365, 'specificity': 0.5291365, 'f1': 0.54559696, 'auroc': 0.9604027, 'binary_precision': 0.6557377, 'binary_recall': 0.059435364, 'binary_specificity': 0.99883765, 'binary_f1_score': 0.108991824}
confusion matrix:
       0   1
0  18046  21
1    633  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9992566, 'precision': 0.9995799, 'recall': 0.9967949, 'specificity': 0.9967949, 'f1': 0.9981822, 'auroc': 0.99991757, 'binary_precision': 1.0, 'binary_recall': 0.99358976, 'binary_specificity': 1.0, 'binary_f1_score': 0.99678457}
confusion matrix:
      0    1
0  5946    0
1     5  775
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_27.png
early stop counter: 12
val acc:0.9651013612747192, best validation acc: 0.9751334190368652, corresponding to test acc:                         0.9988105893135071 / 0.9992566108703613
after epoch: 27,now: 2024-06-12 09:27:40.821558,epoch time: 0:37:40.693712,used: 16:09:52.106883,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9987162, 'precision': 0.9992936, 'recall': 0.9930652, 'specificity': 0.9930652, 'f1': 0.99615496, 'auroc': 0.99974024, 'binary_precision': 1.0, 'binary_recall': 0.98613036, 'binary_specificity': 1.0, 'binary_f1_score': 0.9930168}
confusion matrix:
       0     1
0  42410     0
1     60  4266
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.9322744, 'recall': 0.5066588, 'specificity': 0.5066588, 'f1': 0.5041411, 'auroc': 0.9621285, 'binary_precision': 0.9, 'binary_recall': 0.013372957, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.026354318}
confusion matrix:
       0  1
0  18066  1
1    664  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99717516, 'precision': 0.99840736, 'recall': 0.9878205, 'specificity': 0.9878205, 'f1': 0.9930376, 'auroc': 0.99993044, 'binary_precision': 1.0, 'binary_recall': 0.975641, 'binary_specificity': 1.0, 'binary_f1_score': 0.98767036}
confusion matrix:
      0    1
0  5946    0
1    19  761
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_28.png
early stop counter: 13
val acc:0.964514434337616, best validation acc: 0.9751334190368652, corresponding to test acc:                         0.9988105893135071 / 0.9992566108703613
after epoch: 28,now: 2024-06-12 10:07:23.375551,epoch time: 0:39:42.553993,used: 16:49:34.660876,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99901575, 'precision': 0.9994583, 'recall': 0.9946821, 'specificity': 0.9946821, 'f1': 0.99705577, 'auroc': 0.99996006, 'binary_precision': 1.0, 'binary_recall': 0.98936415, 'binary_specificity': 1.0, 'binary_f1_score': 0.99465364}
confusion matrix:
       0     1
0  42411     0
1     46  4279
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.8393134, 'recall': 0.50365937, 'specificity': 0.50365937, 'f1': 0.49824968, 'auroc': 0.9587394, 'binary_precision': 0.71428573, 'binary_recall': 0.0074294205, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.014705882}
confusion matrix:
       0  1
0  18065  2
1    668  5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9976212, 'precision': 0.9986582, 'recall': 0.9897436, 'specificity': 0.9897436, 'f1': 0.9941468, 'auroc': 0.999903, 'binary_precision': 1.0, 'binary_recall': 0.9794872, 'binary_specificity': 1.0, 'binary_f1_score': 0.9896373}
confusion matrix:
      0    1
0  5946    0
1    16  764
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_29.png
early stop counter: 14
val acc:0.9642475843429565, best validation acc: 0.9751334190368652, corresponding to test acc:                         0.9988105893135071 / 0.9992566108703613
after epoch: 29,now: 2024-06-12 10:47:13.486774,epoch time: 0:39:50.111223,used: 17:29:24.772099,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9992511, 'precision': 0.999483, 'recall': 0.99605846, 'specificity': 0.99605846, 'f1': 0.99776334, 'auroc': 0.99983585, 'binary_precision': 0.99976707, 'binary_recall': 0.99214053, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9959392}
confusion matrix:
       0     1
0  42409     1
1     34  4292
---- Validation: 
scalar performance:
{'acc': 0.9705976, 'precision': 0.9194946, 'recall': 0.6063748, 'specificity': 0.6063748, 'f1': 0.66411406, 'auroc': 0.94940245, 'binary_precision': 0.8674699, 'binary_recall': 0.21396731, 'binary_specificity': 0.99878234, 'binary_f1_score': 0.3432658}
confusion matrix:
       0    1
0  18045   22
1    529  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9985132, 'precision': 0.9991605, 'recall': 0.99358976, 'specificity': 0.99358976, 'f1': 0.99635404, 'auroc': 0.99918944, 'binary_precision': 1.0, 'binary_recall': 0.98717946, 'binary_specificity': 1.0, 'binary_f1_score': 0.99354833}
confusion matrix:
      0    1
0  5946    0
1    10  770
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_30.png
early stop counter: 15
val acc:0.9705976247787476, best validation acc: 0.9751334190368652, corresponding to test acc:                         0.9988105893135071 / 0.9992566108703613
after epoch: 30,now: 2024-06-12 11:24:53.782678,epoch time: 0:37:40.295904,used: 18:07:05.068003,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_11_17_17_48_seed_1_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 18:07:05.068003 at 2024-06-12 11:24:53.782678
persisted model performance metric: 

scalar performance:
{'acc': 0.99910796, 'precision': 0.99893546, 'recall': 0.9967108, 'specificity': 0.9967108, 'f1': 0.9978198, 'auroc': 0.9999691, 'binary_precision': 0.99871135, 'binary_recall': 0.99358976, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.996144}
confusion matrix:
      0    1
0  5945    1
1     5  775
oracle model performance metric: 

scalar performance:
{'acc': 0.99791855, 'precision': 0.9988255, 'recall': 0.9910256, 'specificity': 0.9910256, 'f1': 0.99488425, 'auroc': 0.99985707, 'binary_precision': 1.0, 'binary_recall': 0.98205125, 'binary_specificity': 1.0, 'binary_f1_score': 0.9909444}
confusion matrix:
      0    1
0  5946    0
1    14  766
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_oversampling/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1664 MiB |  15807 MiB |   2123 TiB |   2123 TiB |
|       from large pool |   1657 MiB |  15782 MiB |   2096 TiB |   2096 TiB |
|       from small pool |      6 MiB |     26 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1664 MiB |  15807 MiB |   2123 TiB |   2123 TiB |
|       from large pool |   1657 MiB |  15782 MiB |   2096 TiB |   2096 TiB |
|       from small pool |      6 MiB |     26 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |   2117 TiB |   2117 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   2090 TiB |   2090 TiB |
|       from small pool |      5 MiB |     25 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16758 MiB |  16758 MiB |  31406 MiB |  14648 MiB |
|       from large pool |  16730 MiB |  16730 MiB |  31376 MiB |  14646 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 397079 KiB |    905 MiB |    865 TiB |    865 TiB |
|       from large pool | 377232 KiB |    904 MiB |    839 TiB |    839 TiB |
|       from small pool |  19847 KiB |     24 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3540    |    6725    |  324785 K  |  324782 K  |
|       from large pool |     247    |     989    |  133677 K  |  133676 K  |
|       from small pool |    3293    |    6476    |  191108 K  |  191105 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3540    |    6725    |  324785 K  |  324782 K  |
|       from large pool |     247    |     989    |  133677 K  |  133676 K  |
|       from small pool |    3293    |    6476    |  191108 K  |  191105 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |    1127    |     506    |
|       from large pool |     607    |     607    |    1112    |     505    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     139    |    3056    |  192187 K  |  192187 K  |
|       from large pool |     107    |     516    |  100167 K  |  100167 K  |
|       from small pool |      32    |    2944    |   92019 K  |   92019 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15807 MiB |   2123 TiB |   2123 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   2096 TiB |   2096 TiB |
|       from small pool |      0 KiB |     26 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15807 MiB |   2123 TiB |   2123 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   2096 TiB |   2096 TiB |
|       from small pool |      0 KiB |     26 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   2117 TiB |   2117 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   2090 TiB |   2090 TiB |
|       from small pool |      0 KiB |     25 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2052 MiB |  16758 MiB |  31406 MiB |  29354 MiB |
|       from large pool |   2026 MiB |  16730 MiB |  31376 MiB |  29350 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    905 MiB |    865 TiB |    865 TiB |
|       from large pool |  24320 KiB |    904 MiB |    839 TiB |    839 TiB |
|       from small pool |      0 KiB |     25 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6725    |  324785 K  |  324785 K  |
|       from large pool |       2    |     989    |  133677 K  |  133677 K  |
|       from small pool |       0    |    6476    |  191108 K  |  191108 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6725    |  324785 K  |  324785 K  |
|       from large pool |       2    |     989    |  133677 K  |  133677 K  |
|       from small pool |       0    |    6476    |  191108 K  |  191108 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     113    |     621    |    1127    |    1014    |
|       from large pool |     100    |     607    |    1112    |    1012    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3056    |  192189 K  |  192189 K  |
|       from large pool |       2    |     516    |  100167 K  |  100167 K  |
|       from small pool |       0    |    2944    |   92021 K  |   92021 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15807 MiB |   2123 TiB |   2123 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   2096 TiB |   2096 TiB |
|       from small pool |      0 KiB |     26 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15807 MiB |   2123 TiB |   2123 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   2096 TiB |   2096 TiB |
|       from small pool |      0 KiB |     26 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   2117 TiB |   2117 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   2090 TiB |   2090 TiB |
|       from small pool |      0 KiB |     25 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2052 MiB |  16758 MiB |  31406 MiB |  29354 MiB |
|       from large pool |   2026 MiB |  16730 MiB |  31376 MiB |  29350 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    905 MiB |    865 TiB |    865 TiB |
|       from large pool |  24320 KiB |    904 MiB |    839 TiB |    839 TiB |
|       from small pool |      0 KiB |     25 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6725    |  324785 K  |  324785 K  |
|       from large pool |       2    |     989    |  133677 K  |  133677 K  |
|       from small pool |       0    |    6476    |  191108 K  |  191108 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6725    |  324785 K  |  324785 K  |
|       from large pool |       2    |     989    |  133677 K  |  133677 K  |
|       from small pool |       0    |    6476    |  191108 K  |  191108 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     113    |     621    |    1127    |    1014    |
|       from large pool |     100    |     607    |    1112    |    1012    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3056    |  192189 K  |  192189 K  |
|       from large pool |       2    |     516    |  100167 K  |  100167 K  |
|       from small pool |       0    |    2944    |   92021 K  |   92021 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_11_35_36_seed_2_21277205

 Experiment start at: 2024-06-12 11:35:36.756741
before training, model accuracy: 0.1783429980278015
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99754524, 'precision': 0.99663913, 'recall': 0.9892988, 'specificity': 0.9892988, 'f1': 0.9929343, 'auroc': 0.9993381, 'binary_precision': 0.9955197, 'binary_recall': 0.9790703, 'binary_specificity': 0.9995273, 'binary_f1_score': 0.9872264}
confusion matrix:
       0     1
0  42289    20
1     95  4444
---- Validation: 
scalar performance:
{'acc': 0.9668673, 'precision': 0.65637445, 'recall': 0.5171167, 'specificity': 0.5171167, 'f1': 0.52460027, 'auroc': 0.92325693, 'binary_precision': 0.34375, 'binary_recall': 0.036544852, 'binary_specificity': 0.99768865, 'binary_f1_score': 0.066066064}
confusion matrix:
       0   1
0  18129  42
1    580  22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702513, 'precision': 0.99833804, 'recall': 0.9862259, 'specificity': 0.9862259, 'f1': 0.9921844, 'auroc': 0.99995565, 'binary_precision': 1.0, 'binary_recall': 0.9724518, 'binary_specificity': 1.0, 'binary_f1_score': 0.9860335}
confusion matrix:
      0    1
0  5997    0
1    20  706
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-12 12:23:21.364711,epoch time: 0:47:44.607970,used: 0:47:44.607970,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_11_35_36_seed_2_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9980789, 'precision': 0.997738, 'recall': 0.9912641, 'specificity': 0.9912641, 'f1': 0.9944742, 'auroc': 0.9994899, 'binary_precision': 0.99731666, 'binary_recall': 0.9828118, 'binary_specificity': 0.9997164, 'binary_f1_score': 0.9900111}
confusion matrix:
       0     1
0  42298    12
1     78  4460
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.7930793, 'recall': 0.54554856, 'specificity': 0.54554856, 'f1': 0.5729254, 'auroc': 0.9146621, 'binary_precision': 0.61538464, 'binary_recall': 0.093023255, 'binary_specificity': 0.9980739, 'binary_f1_score': 0.16161616}
confusion matrix:
       0   1
0  18136  35
1    546  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.995389, 'precision': 0.99742866, 'recall': 0.9786501, 'specificity': 0.9786501, 'f1': 0.9878032, 'auroc': 0.9985461, 'binary_precision': 1.0, 'binary_recall': 0.95730025, 'binary_specificity': 1.0, 'binary_f1_score': 0.9781844}
confusion matrix:
      0    1
0  5997    0
1    31  695
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_2.png
better model found
persisted
after epoch: 2,now: 2024-06-12 13:00:48.040729,epoch time: 0:37:26.676018,used: 1:25:11.283988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_11_35_36_seed_2_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9984631, 'precision': 0.99915063, 'recall': 0.99206525, 'specificity': 0.99206525, 'f1': 0.9955758, 'auroc': 0.9997739, 'binary_precision': 1.0, 'binary_recall': 0.9841305, 'binary_specificity': 1.0, 'binary_f1_score': 0.9920018}
confusion matrix:
       0     1
0  42311     0
1     72  4465
---- Validation: 
scalar performance:
{'acc': 0.9665477, 'precision': 0.4839441, 'recall': 0.49928457, 'specificity': 0.49928457, 'f1': 0.49149466, 'auroc': 0.9328526, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99856913, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18145  26
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9971739, 'precision': 0.99842083, 'recall': 0.98691463, 'specificity': 0.98691463, 'f1': 0.9925797, 'auroc': 0.9999795, 'binary_precision': 1.0, 'binary_recall': 0.9738292, 'binary_specificity': 1.0, 'binary_f1_score': 0.98674107}
confusion matrix:
      0    1
0  5997    0
1    19  707
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_3.png
new oracle model saved
early stop counter: 1
val acc:0.9665477275848389, best validation acc: 0.9690513014793396, corresponding to test acc:                         0.9953889846801758 / 0.9971739053726196
after epoch: 3,now: 2024-06-12 13:44:50.909221,epoch time: 0:44:02.868492,used: 2:09:14.152480,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_11_35_36_seed_2_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.998207, 'precision': 0.99900925, 'recall': 0.99074686, 'specificity': 0.99074686, 'f1': 0.9948344, 'auroc': 0.9997588, 'binary_precision': 1.0, 'binary_recall': 0.9814937, 'binary_specificity': 1.0, 'binary_f1_score': 0.9906604}
confusion matrix:
       0     1
0  42309     0
1     84  4455
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.48396376, 'recall': 0.49991745, 'specificity': 0.49991745, 'f1': 0.49181125, 'auroc': 0.9270044, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18168  3
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9977689, 'precision': 0.9987525, 'recall': 0.98966944, 'specificity': 0.98966944, 'f1': 0.99415624, 'auroc': 0.999908, 'binary_precision': 1.0, 'binary_recall': 0.9793388, 'binary_specificity': 1.0, 'binary_f1_score': 0.98956156}
confusion matrix:
      0    1
0  5997    0
1    15  711
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_4.png
new oracle model saved
early stop counter: 2
val acc:0.9677728414535522, best validation acc: 0.9690513014793396, corresponding to test acc:                         0.9953889846801758 / 0.9977688789367676
after epoch: 4,now: 2024-06-12 14:29:03.111665,epoch time: 0:44:12.202444,used: 2:53:26.354924,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_11_35_36_seed_2_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99824965, 'precision': 0.99903286, 'recall': 0.99096715, 'specificity': 0.99096715, 'f1': 0.9949584, 'auroc': 0.9995984, 'binary_precision': 1.0, 'binary_recall': 0.98193437, 'binary_specificity': 1.0, 'binary_f1_score': 0.9908849}
confusion matrix:
       0     1
0  42309     0
1     82  4457
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.48396292, 'recall': 0.49988994, 'specificity': 0.49988994, 'f1': 0.4917975, 'auroc': 0.92455655, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997799, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18167  4
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9974714, 'precision': 0.99858665, 'recall': 0.988292, 'specificity': 0.988292, 'f1': 0.993369, 'auroc': 0.9981838, 'binary_precision': 1.0, 'binary_recall': 0.976584, 'binary_specificity': 1.0, 'binary_f1_score': 0.98815334}
confusion matrix:
      0    1
0  5997    0
1    17  709
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_5.png
early stop counter: 3
val acc:0.9677196145057678, best validation acc: 0.9690513014793396, corresponding to test acc:                         0.9953889846801758 / 0.9977688789367676
after epoch: 5,now: 2024-06-12 15:08:04.500343,epoch time: 0:39:01.388678,used: 3:32:27.743602,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_11_35_36_seed_2_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9986125, 'precision': 0.9990332, 'recall': 0.9930365, 'specificity': 0.9930365, 'f1': 0.9960119, 'auroc': 0.9998503, 'binary_precision': 0.9995534, 'binary_recall': 0.9861203, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9927914}
confusion matrix:
       0     1
0  42307     2
1     63  4476
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.9839921, 'recall': 0.5008306, 'specificity': 0.5008306, 'f1': 0.49352425, 'auroc': 0.93014115, 'binary_precision': 1.0, 'binary_recall': 0.0016611295, 'binary_specificity': 1.0, 'binary_f1_score': 0.0033167494}
confusion matrix:
       0  1
0  18171  0
1    601  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9982151, 'precision': 0.9990015, 'recall': 0.9917356, 'specificity': 0.9917356, 'f1': 0.99533355, 'auroc': 0.99953306, 'binary_precision': 1.0, 'binary_recall': 0.9834711, 'binary_specificity': 1.0, 'binary_f1_score': 0.9916667}
confusion matrix:
      0    1
0  5997    0
1    12  714
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_6.png
new oracle model saved
early stop counter: 4
val acc:0.9679859280586243, best validation acc: 0.9690513014793396, corresponding to test acc:                         0.9953889846801758 / 0.9982150793075562
after epoch: 6,now: 2024-06-12 15:54:33.230027,epoch time: 0:46:28.729684,used: 4:18:56.473286,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_11_35_36_seed_2_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99801487, 'precision': 0.9968101, 'recall': 0.9918188, 'specificity': 0.9918188, 'f1': 0.99429846, 'auroc': 0.9997542, 'binary_precision': 0.9953198, 'binary_recall': 0.98413396, 'binary_specificity': 0.9995037, 'binary_f1_score': 0.98969525}
confusion matrix:
       0     1
0  42289    21
1     72  4466
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.48396376, 'recall': 0.49991745, 'specificity': 0.49991745, 'f1': 0.49181125, 'auroc': 0.91032135, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18168  3
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99836385, 'precision': 0.9990846, 'recall': 0.99242425, 'specificity': 0.99242425, 'f1': 0.99572504, 'auroc': 0.99976325, 'binary_precision': 1.0, 'binary_recall': 0.9848485, 'binary_specificity': 1.0, 'binary_f1_score': 0.99236643}
confusion matrix:
      0    1
0  5997    0
1    11  715
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_7.png
new oracle model saved
early stop counter: 5
val acc:0.9677728414535522, best validation acc: 0.9690513014793396, corresponding to test acc:                         0.9953889846801758 / 0.9983638525009155
after epoch: 7,now: 2024-06-12 16:46:19.100518,epoch time: 0:51:45.870491,used: 5:10:42.343777,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_11_35_36_seed_2_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9990395, 'precision': 0.99907166, 'recall': 0.9954363, 'specificity': 0.9954363, 'f1': 0.99724555, 'auroc': 0.99993247, 'binary_precision': 0.99911153, 'binary_recall': 0.99096715, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9950227}
confusion matrix:
       0     1
0  42305     4
1     41  4498
---- Validation: 
scalar performance:
{'acc': 0.9667075, 'precision': 0.50397164, 'recall': 0.5001702, 'specificity': 0.5001702, 'f1': 0.49313042, 'auroc': 0.945963, 'binary_precision': 0.04, 'binary_recall': 0.0016611295, 'binary_specificity': 0.9986792, 'binary_f1_score': 0.0031897926}
confusion matrix:
       0   1
0  18147  24
1    601   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866134, 'precision': 0.99925077, 'recall': 0.99380165, 'specificity': 0.99380165, 'f1': 0.9965066, 'auroc': 0.9999249, 'binary_precision': 1.0, 'binary_recall': 0.9876033, 'binary_specificity': 1.0, 'binary_f1_score': 0.99376297}
confusion matrix:
      0    1
0  5997    0
1     9  717
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_8.png
new oracle model saved
early stop counter: 6
val acc:0.9667075276374817, best validation acc: 0.9690513014793396, corresponding to test acc:                         0.9953889846801758 / 0.9986613392829895
after epoch: 8,now: 2024-06-12 17:44:12.761345,epoch time: 0:57:53.660827,used: 6:08:36.004604,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_11_35_36_seed_2_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99848443, 'precision': 0.9991623, 'recall': 0.9921789, 'specificity': 0.9921789, 'f1': 0.99563944, 'auroc': 0.9998392, 'binary_precision': 1.0, 'binary_recall': 0.9843578, 'binary_specificity': 1.0, 'binary_f1_score': 0.9921172}
confusion matrix:
       0     1
0  42309     0
1     71  4468
---- Validation: 
scalar performance:
{'acc': 0.9674, 'precision': 0.4839578, 'recall': 0.49972484, 'specificity': 0.49972484, 'f1': 0.49171495, 'auroc': 0.92218745, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18161  10
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9977689, 'precision': 0.9987525, 'recall': 0.98966944, 'specificity': 0.98966944, 'f1': 0.99415624, 'auroc': 0.99998236, 'binary_precision': 1.0, 'binary_recall': 0.9793388, 'binary_specificity': 1.0, 'binary_f1_score': 0.98956156}
confusion matrix:
      0    1
0  5997    0
1    15  711
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_9.png
early stop counter: 7
val acc:0.9674000144004822, best validation acc: 0.9690513014793396, corresponding to test acc:                         0.9953889846801758 / 0.9986613392829895
after epoch: 9,now: 2024-06-12 18:40:32.655280,epoch time: 0:56:19.893935,used: 7:04:55.898539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_11_35_36_seed_2_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9917392, 'precision': 0.96348447, 'recall': 0.9917872, 'specificity': 0.9917872, 'f1': 0.9770956, 'auroc': 0.99909985, 'binary_precision': 0.92784995, 'binary_recall': 0.9918466, 'binary_specificity': 0.9917277, 'binary_f1_score': 0.95878154}
confusion matrix:
       0     1
0  41960   350
1     37  4501
---- Validation: 
scalar performance:
{'acc': 0.9558408, 'precision': 0.6691489, 'recall': 0.7194104, 'specificity': 0.7194104, 'f1': 0.6905484, 'auroc': 0.9162227, 'binary_precision': 0.35614702, 'binary_recall': 0.4667774, 'binary_specificity': 0.9720434, 'binary_f1_score': 0.4040259}
confusion matrix:
       0    1
0  17663  508
1    321  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9931578, 'precision': 0.97368765, 'recall': 0.99192744, 'specificity': 0.99192744, 'f1': 0.9825786, 'auroc': 0.99914443, 'binary_precision': 0.9485488, 'binary_recall': 0.9903581, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.96900266}
confusion matrix:
      0    1
0  5958   39
1     7  719
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_10.png
early stop counter: 8
val acc:0.9558408260345459, best validation acc: 0.9690513014793396, corresponding to test acc:                         0.9953889846801758 / 0.9986613392829895
after epoch: 10,now: 2024-06-12 19:34:55.832425,epoch time: 0:54:23.177145,used: 7:59:19.075684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_11_35_36_seed_2_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99824965, 'precision': 0.99557734, 'recall': 0.99440676, 'specificity': 0.99440676, 'f1': 0.9949911, 'auroc': 0.99978936, 'binary_precision': 0.99226516, 'binary_recall': 0.9896407, 'binary_specificity': 0.9991728, 'binary_f1_score': 0.9909512}
confusion matrix:
       0     1
0  42276    35
1     47  4490
---- Validation: 
scalar performance:
{'acc': 0.9744846, 'precision': 0.8585243, 'recall': 0.6559637, 'specificity': 0.6559637, 'f1': 0.7146592, 'auroc': 0.95903766, 'binary_precision': 0.7392996, 'binary_recall': 0.3156146, 'binary_specificity': 0.9963128, 'binary_f1_score': 0.44237483}
confusion matrix:
       0    1
0  18104   67
1    412  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866134, 'precision': 0.99925077, 'recall': 0.99380165, 'specificity': 0.99380165, 'f1': 0.9965066, 'auroc': 0.9999527, 'binary_precision': 1.0, 'binary_recall': 0.9876033, 'binary_specificity': 1.0, 'binary_f1_score': 0.99376297}
confusion matrix:
      0    1
0  5997    0
1     9  717
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_11.png
better model found
persisted
after epoch: 11,now: 2024-06-12 20:29:14.526697,epoch time: 0:54:18.694272,used: 8:53:37.769956,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_11_35_36_seed_2_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99899673, 'precision': 0.9993457, 'recall': 0.99492097, 'specificity': 0.99492097, 'f1': 0.99712086, 'auroc': 0.9998614, 'binary_precision': 0.9997775, 'binary_recall': 0.9898656, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9947969}
confusion matrix:
       0     1
0  42308     1
1     46  4493
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.9410284, 'recall': 0.5173868, 'specificity': 0.5173868, 'f1': 0.52570474, 'auroc': 0.95292336, 'binary_precision': 0.9130435, 'binary_recall': 0.034883723, 'binary_specificity': 0.9998899, 'binary_f1_score': 0.067200005}
confusion matrix:
       0   1
0  18169   2
1    581  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99866134, 'precision': 0.99925077, 'recall': 0.99380165, 'specificity': 0.99380165, 'f1': 0.9965066, 'auroc': 0.99998784, 'binary_precision': 1.0, 'binary_recall': 0.9876033, 'binary_specificity': 1.0, 'binary_f1_score': 0.99376297}
confusion matrix:
      0    1
0  5997    0
1     9  717
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_12.png
early stop counter: 1
val acc:0.968944787979126, best validation acc: 0.9744846224784851, corresponding to test acc:                         0.9986613392829895 / 0.9986613392829895
after epoch: 12,now: 2024-06-12 21:23:19.094858,epoch time: 0:54:04.568161,used: 9:47:42.338117,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_11_35_36_seed_2_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9990395, 'precision': 0.9978898, 'recall': 0.99661636, 'specificity': 0.99661636, 'f1': 0.997252, 'auroc': 0.99994123, 'binary_precision': 0.99646485, 'binary_recall': 0.9936109, 'binary_specificity': 0.9996218, 'binary_f1_score': 0.9950358}
confusion matrix:
       0     1
0  42293    16
1     29  4510
---- Validation: 
scalar performance:
{'acc': 0.9720343, 'precision': 0.8565897, 'recall': 0.5976815, 'specificity': 0.5976815, 'f1': 0.64882684, 'auroc': 0.95408213, 'binary_precision': 0.73913044, 'binary_recall': 0.19767442, 'binary_specificity': 0.99768865, 'binary_f1_score': 0.3119266}
confusion matrix:
       0    1
0  18129   42
1    483  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9997025, 'precision': 0.99983335, 'recall': 0.9986226, 'specificity': 0.9986226, 'f1': 0.999227, 'auroc': 0.9999511, 'binary_precision': 1.0, 'binary_recall': 0.9972452, 'binary_specificity': 1.0, 'binary_f1_score': 0.9986207}
confusion matrix:
      0    1
0  5997    0
1     2  724
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_13.png
new oracle model saved
early stop counter: 2
val acc:0.9720342755317688, best validation acc: 0.9744846224784851, corresponding to test acc:                         0.9986613392829895 / 0.999702513217926
after epoch: 13,now: 2024-06-12 22:16:18.557056,epoch time: 0:52:59.462198,used: 10:40:41.800315,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_11_35_36_seed_2_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99844176, 'precision': 0.9987387, 'recall': 0.9923503, 'specificity': 0.9923503, 'f1': 0.99551845, 'auroc': 0.9998701, 'binary_precision': 0.99910575, 'binary_recall': 0.9847951, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.99189883}
confusion matrix:
       0     1
0  42306     4
1     69  4469
---- Validation: 
scalar performance:
{'acc': 0.9693709, 'precision': 0.89947295, 'recall': 0.5280466, 'specificity': 0.5280466, 'f1': 0.54508644, 'auroc': 0.95655775, 'binary_precision': 0.8292683, 'binary_recall': 0.056478404, 'binary_specificity': 0.9996148, 'binary_f1_score': 0.10575427}
confusion matrix:
       0   1
0  18164   7
1    568  34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.99702513, 'precision': 0.99833804, 'recall': 0.9862259, 'specificity': 0.9862259, 'f1': 0.9921844, 'auroc': 0.99987596, 'binary_precision': 1.0, 'binary_recall': 0.9724518, 'binary_specificity': 1.0, 'binary_f1_score': 0.9860335}
confusion matrix:
      0    1
0  5997    0
1    20  706
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21277205_14.png
early stop counter: 3
val acc:0.9693709015846252, best validation acc: 0.9744846224784851, corresponding to test acc:                         0.9986613392829895 / 0.999702513217926
after epoch: 14,now: 2024-06-12 23:04:20.264950,epoch time: 0:48:01.707894,used: 11:28:43.508209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_12_11_35_36_seed_2_21277205
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99884737, 'precision': 0.99827194, 'recall': 0.9951333, 'specificity': 0.9951333, 'f1': 0.99669623, 'auroc': 0.9998398, 'binary_precision': 0.99755937, 'binary_recall': 0.99052656, 'binary_specificity': 0.99974, 'binary_f1_score': 0.9940305}
confusion matrix:
       0     1
0  42298    11
1     43  4496
---- Validation: 
scalar performance:
{'acc': 0.968199, 'precision': 0.7665714, 'recall': 0.5178046, 'specificity': 0.5178046, 'f1': 0.5262331, 'auroc': 0.9501288, 'binary_precision': 0.5641026, 'binary_recall': 0.036544852, 'binary_specificity': 0.99906445, 'binary_f1_score': 0.06864274}
confusion matrix:
       0   1
0  18154  17
1    580  22
---- Test Domain (oracle): 
slurmstepd: error: *** JOB 21277205 ON gpusrv28 CANCELLED AT 2024-06-12T23:40:06 DUE TO TIME LIMIT ***
