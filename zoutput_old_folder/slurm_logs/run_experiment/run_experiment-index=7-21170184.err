Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jun  7 01:17:52 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184

 Experiment start at: 2024-06-07 01:25:00.103699
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9695606, 'precision': 0.764133, 'recall': 0.7933028, 'specificity': 0.7933028, 'f1': 0.7778701, 'auroc': 0.94853985, 'binary_precision': 0.5420732, 'binary_recall': 0.6043508, 'binary_specificity': 0.9822547, 'binary_f1_score': 0.5715204}
confusion matrix:
       0    1
0  41570  751
1    582  889
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.74325085, 'recall': 0.7596293, 'specificity': 0.7596293, 'f1': 0.75114185, 'auroc': 0.94699043, 'binary_precision': 0.502907, 'binary_recall': 0.5381026, 'binary_specificity': 0.981156, 'binary_f1_score': 0.5199098}
confusion matrix:
       0    1
0  17807  342
1    297  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97235537, 'precision': 0.917616, 'recall': 0.69973207, 'specificity': 0.69973207, 'f1': 0.76702213, 'auroc': 0.93848324, 'binary_precision': 0.8606557, 'binary_recall': 0.40229884, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.5483028}
confusion matrix:
      0    1
0  5980   17
1   156  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-07 02:06:28.453413,epoch time: 0:41:28.349714,used: 0:41:28.349714,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97501826, 'precision': 0.86577797, 'recall': 0.6890507, 'specificity': 0.6890507, 'f1': 0.7471957, 'auroc': 0.9639814, 'binary_precision': 0.7526738, 'binary_recall': 0.3824728, 'binary_specificity': 0.99562854, 'binary_f1_score': 0.5072072}
confusion matrix:
       0    1
0  42135  185
1    909  563
---- Validation: 
scalar performance:
{'acc': 0.9729672, 'precision': 0.8567228, 'recall': 0.6612308, 'specificity': 0.6612308, 'f1': 0.7193638, 'auroc': 0.9595399, 'binary_precision': 0.7368421, 'binary_recall': 0.32659408, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.4525862}
confusion matrix:
       0    1
0  18074   75
1    433  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.86248434, 'recall': 0.5245707, 'specificity': 0.5245707, 'f1': 0.53646684, 'auroc': 0.9330281, 'binary_precision': 0.7647059, 'binary_recall': 0.049808428, 'binary_specificity': 0.999333, 'binary_f1_score': 0.09352518}
confusion matrix:
      0   1
0  5993   4
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_2.png
better model found
persisted
after epoch: 2,now: 2024-06-07 02:46:26.768615,epoch time: 0:39:58.315202,used: 1:21:26.664916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9775073, 'precision': 0.8790134, 'recall': 0.73000944, 'specificity': 0.73000944, 'f1': 0.78491426, 'auroc': 0.9720067, 'binary_precision': 0.7763905, 'binary_recall': 0.4646739, 'binary_specificity': 0.995345, 'binary_f1_score': 0.58138543}
confusion matrix:
       0    1
0  42123  197
1    788  684
---- Validation: 
scalar performance:
{'acc': 0.97482973, 'precision': 0.9138409, 'recall': 0.6591948, 'specificity': 0.6591948, 'f1': 0.726324, 'auroc': 0.96624565, 'binary_precision': 0.8512397, 'binary_recall': 0.32037324, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.46553668}
confusion matrix:
       0    1
0  18113   36
1    437  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.9329806, 'recall': 0.5362317, 'specificity': 0.5362317, 'f1': 0.5574037, 'auroc': 0.9455911, 'binary_precision': 0.9047619, 'binary_recall': 0.07279693, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.13475177}
confusion matrix:
      0   1
0  5995   2
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_3.png
better model found
persisted
after epoch: 3,now: 2024-06-07 03:26:22.835032,epoch time: 0:39:56.066417,used: 2:01:22.731333,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9802704, 'precision': 0.905054, 'recall': 0.7589823, 'specificity': 0.7589823, 'f1': 0.8147786, 'auroc': 0.9769339, 'binary_precision': 0.82650864, 'binary_recall': 0.5217687, 'binary_specificity': 0.99619585, 'binary_f1_score': 0.63969976}
confusion matrix:
       0    1
0  42161  161
1    703  767
---- Validation: 
scalar performance:
{'acc': 0.9770647, 'precision': 0.91620266, 'recall': 0.6978547, 'specificity': 0.6978547, 'f1': 0.7655927, 'auroc': 0.97131526, 'binary_precision': 0.85333335, 'binary_recall': 0.39813375, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.54294807}
confusion matrix:
       0    1
0  18105   44
1    387  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.8366661, 'recall': 0.5094118, 'specificity': 0.5094118, 'f1': 0.50812435, 'auroc': 0.943048, 'binary_precision': 0.71428573, 'binary_recall': 0.019157087, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.037313428}
confusion matrix:
      0  1
0  5995  2
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_4.png
better model found
persisted
after epoch: 4,now: 2024-06-07 04:06:16.969160,epoch time: 0:39:54.134128,used: 2:41:16.865461,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98202866, 'precision': 0.9124182, 'recall': 0.78578985, 'specificity': 0.78578985, 'f1': 0.8367708, 'auroc': 0.980731, 'binary_precision': 0.839445, 'binary_recall': 0.5754076, 'binary_specificity': 0.996172, 'binary_f1_score': 0.6827892}
confusion matrix:
       0    1
0  42158  162
1    625  847
---- Validation: 
scalar performance:
{'acc': 0.9790868, 'precision': 0.92334473, 'recall': 0.7289038, 'specificity': 0.7289038, 'f1': 0.79513866, 'auroc': 0.9736142, 'binary_precision': 0.86549705, 'binary_recall': 0.46034214, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.60101527}
confusion matrix:
       0    1
0  18103   46
1    347  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8012492, 'recall': 0.5168245, 'specificity': 0.5168245, 'f1': 0.5222298, 'auroc': 0.9488485, 'binary_precision': 0.64285713, 'binary_recall': 0.03448276, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.06545454}
confusion matrix:
      0  1
0  5992  5
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_5.png
better model found
persisted
after epoch: 5,now: 2024-06-07 04:46:06.339062,epoch time: 0:39:49.369902,used: 3:21:06.235363,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9802932, 'precision': 0.8319372, 'recall': 0.8999705, 'specificity': 0.8999705, 'f1': 0.86248034, 'auroc': 0.9827081, 'binary_precision': 0.67039734, 'binary_recall': 0.8138587, 'binary_specificity': 0.98608226, 'binary_f1_score': 0.73519486}
confusion matrix:
       0     1
0  41731   589
1    274  1198
---- Validation: 
scalar performance:
{'acc': 0.98063004, 'precision': 0.8397714, 'recall': 0.89246476, 'specificity': 0.89246476, 'f1': 0.86403626, 'auroc': 0.97628975, 'binary_precision': 0.686747, 'binary_recall': 0.7978227, 'binary_specificity': 0.98710674, 'binary_f1_score': 0.73812944}
confusion matrix:
       0    1
0  17915  234
1    130  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.846119, 'recall': 0.6375122, 'specificity': 0.6375122, 'f1': 0.6927715, 'auroc': 0.9517541, 'binary_precision': 0.7227723, 'binary_recall': 0.27969348, 'binary_specificity': 0.995331, 'binary_f1_score': 0.40331492}
confusion matrix:
      0   1
0  5969  28
1   188  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_6.png
better model found
persisted
after epoch: 6,now: 2024-06-07 05:26:02.191916,epoch time: 0:39:55.852854,used: 4:01:02.088217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98394686, 'precision': 0.87330747, 'recall': 0.882845, 'specificity': 0.882845, 'f1': 0.8780108, 'auroc': 0.9848299, 'binary_precision': 0.75446725, 'binary_recall': 0.7744565, 'binary_specificity': 0.99123347, 'binary_f1_score': 0.7643312}
confusion matrix:
       0     1
0  41949   371
1    332  1140
---- Validation: 
scalar performance:
{'acc': 0.98334396, 'precision': 0.87307096, 'recall': 0.87586844, 'specificity': 0.87586844, 'f1': 0.87446404, 'auroc': 0.97667, 'binary_precision': 0.7546296, 'binary_recall': 0.7604977, 'binary_specificity': 0.9912392, 'binary_f1_score': 0.7575523}
confusion matrix:
       0    1
0  17990  159
1    154  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.82367504, 'recall': 0.58070797, 'specificity': 0.58070797, 'f1': 0.62295556, 'auroc': 0.9405532, 'binary_precision': 0.6825397, 'binary_recall': 0.16475096, 'binary_specificity': 0.996665, 'binary_f1_score': 0.26543212}
confusion matrix:
      0   1
0  5977  20
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_7.png
better model found
persisted
after epoch: 7,now: 2024-06-07 06:05:53.316368,epoch time: 0:39:51.124452,used: 4:40:53.212669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9856823, 'precision': 0.90566367, 'recall': 0.86421865, 'specificity': 0.86421865, 'f1': 0.88373566, 'auroc': 0.9860631, 'binary_precision': 0.8205323, 'binary_recall': 0.7340136, 'binary_specificity': 0.9944237, 'binary_f1_score': 0.7748653}
confusion matrix:
       0     1
0  42086   236
1    391  1079
---- Validation: 
scalar performance:
{'acc': 0.98408896, 'precision': 0.8993845, 'recall': 0.84700197, 'specificity': 0.84700197, 'f1': 0.8712039, 'auroc': 0.9772589, 'binary_precision': 0.8093525, 'binary_recall': 0.6998445, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.75062555}
confusion matrix:
       0    1
0  18043  106
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8557439, 'recall': 0.5887043, 'specificity': 0.5887043, 'f1': 0.6356293, 'auroc': 0.9385381, 'binary_precision': 0.74603176, 'binary_recall': 0.18007663, 'binary_specificity': 0.997332, 'binary_f1_score': 0.29012346}
confusion matrix:
      0   1
0  5981  16
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_8.png
better model found
persisted
after epoch: 8,now: 2024-06-07 06:45:43.984901,epoch time: 0:39:50.668533,used: 5:20:43.881202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98655003, 'precision': 0.92142856, 'recall': 0.86058605, 'specificity': 0.86058605, 'f1': 0.8884562, 'auroc': 0.98804426, 'binary_precision': 0.85235435, 'binary_recall': 0.7255435, 'binary_specificity': 0.99562854, 'binary_f1_score': 0.7838533}
confusion matrix:
       0     1
0  42135   185
1    404  1068
---- Validation: 
scalar performance:
{'acc': 0.98510003, 'precision': 0.9068006, 'recall': 0.8565261, 'specificity': 0.8565261, 'f1': 0.8798727, 'auroc': 0.9782726, 'binary_precision': 0.8235294, 'binary_recall': 0.718507, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.76744187}
confusion matrix:
       0    1
0  18050   99
1    181  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.9332044, 'recall': 0.57054776, 'specificity': 0.57054776, 'f1': 0.613183, 'auroc': 0.9355663, 'binary_precision': 0.902439, 'binary_recall': 0.14176245, 'binary_specificity': 0.999333, 'binary_f1_score': 0.2450331}
confusion matrix:
      0   1
0  5993   4
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_9.png
better model found
persisted
after epoch: 9,now: 2024-06-07 07:25:35.940210,epoch time: 0:39:51.955309,used: 6:00:35.836511,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98639023, 'precision': 0.921144, 'recall': 0.85778534, 'specificity': 0.85778534, 'f1': 0.88668776, 'auroc': 0.9901771, 'binary_precision': 0.85197103, 'binary_recall': 0.71991843, 'binary_specificity': 0.99565226, 'binary_f1_score': 0.780398}
confusion matrix:
       0     1
0  42137   184
1    412  1059
---- Validation: 
scalar performance:
{'acc': 0.9847807, 'precision': 0.9056839, 'recall': 0.85186046, 'specificity': 0.85186046, 'f1': 0.8767043, 'auroc': 0.9782584, 'binary_precision': 0.8216216, 'binary_recall': 0.70917577, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.7612688}
confusion matrix:
       0    1
0  18050   99
1    187  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.92481303, 'recall': 0.5304846, 'specificity': 0.5304846, 'f1': 0.54725534, 'auroc': 0.9269349, 'binary_precision': 0.8888889, 'binary_recall': 0.06130268, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.11469534}
confusion matrix:
      0   1
0  5995   2
1   245  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_10.png
early stop counter: 1
val acc:0.9847807288169861, best validation acc: 0.9851000308990479, corresponding to test acc:                         0.9635666608810425 / 0.9723553657531738
after epoch: 10,now: 2024-06-07 08:05:28.518208,epoch time: 0:39:52.577998,used: 6:40:28.414509,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9872808, 'precision': 0.906324, 'recall': 0.8953893, 'specificity': 0.8953893, 'f1': 0.9007759, 'auroc': 0.9905149, 'binary_precision': 0.8197065, 'binary_recall': 0.796875, 'binary_specificity': 0.9939036, 'binary_f1_score': 0.80812955}
confusion matrix:
       0     1
0  42062   258
1    299  1173
---- Validation: 
scalar performance:
{'acc': 0.9853129, 'precision': 0.8931984, 'recall': 0.88138807, 'specificity': 0.88138807, 'f1': 0.88719547, 'auroc': 0.97909045, 'binary_precision': 0.79454255, 'binary_recall': 0.7698289, 'binary_specificity': 0.9929473, 'binary_f1_score': 0.7819905}
confusion matrix:
       0    1
0  18021  128
1    148  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.93522215, 'recall': 0.53814745, 'specificity': 0.53814745, 'f1': 0.5607392, 'auroc': 0.93944865, 'binary_precision': 0.90909094, 'binary_recall': 0.07662835, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.14134276}
confusion matrix:
      0   1
0  5995   2
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_11.png
better model found
persisted
after epoch: 11,now: 2024-06-07 08:45:16.523583,epoch time: 0:39:48.005375,used: 7:20:16.419884,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9884682, 'precision': 0.95879126, 'recall': 0.8553491, 'specificity': 0.8553491, 'f1': 0.90002525, 'auroc': 0.99163544, 'binary_precision': 0.9274978, 'binary_recall': 0.7126359, 'binary_specificity': 0.9980624, 'binary_f1_score': 0.8059931}
confusion matrix:
       0     1
0  42238    82
1    423  1049
---- Validation: 
scalar performance:
{'acc': 0.9859515, 'precision': 0.9220089, 'recall': 0.85321665, 'specificity': 0.85321665, 'f1': 0.8843199, 'auroc': 0.9794282, 'binary_precision': 0.8542056, 'binary_recall': 0.71073097, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.7758913}
confusion matrix:
       0    1
0  18071   78
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8863846, 'recall': 0.5246541, 'specificity': 0.5246541, 'f1': 0.5366773, 'auroc': 0.8983753, 'binary_precision': 0.8125, 'binary_recall': 0.049808428, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.09386282}
confusion matrix:
      0   1
0  5994   3
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_12.png
better model found
persisted
after epoch: 12,now: 2024-06-07 09:25:10.684648,epoch time: 0:39:54.161065,used: 8:00:10.580949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9886281, 'precision': 0.92080426, 'recall': 0.90034854, 'specificity': 0.90034854, 'f1': 0.9103011, 'auroc': 0.99165094, 'binary_precision': 0.8483548, 'binary_recall': 0.8057065, 'binary_specificity': 0.9949905, 'binary_f1_score': 0.8264808}
confusion matrix:
       0     1
0  42108   212
1    286  1186
---- Validation: 
scalar performance:
{'acc': 0.98690933, 'precision': 0.90421146, 'recall': 0.8957156, 'specificity': 0.8957156, 'f1': 0.89991456, 'auroc': 0.9784273, 'binary_precision': 0.8155803, 'binary_recall': 0.7978227, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.8066037}
confusion matrix:
       0    1
0  18033  116
1    130  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8865026, 'recall': 0.5644671, 'specificity': 0.5644671, 'f1': 0.6025903, 'auroc': 0.86186194, 'binary_precision': 0.8095238, 'binary_recall': 0.1302682, 'binary_specificity': 0.998666, 'binary_f1_score': 0.22442244}
confusion matrix:
      0   1
0  5989   8
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_13.png
better model found
persisted
after epoch: 13,now: 2024-06-07 10:05:10.022385,epoch time: 0:39:59.337737,used: 8:40:09.918686,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98940444, 'precision': 0.92832536, 'recall': 0.90468454, 'specificity': 0.90468454, 'f1': 0.9161428, 'auroc': 0.9935875, 'binary_precision': 0.8631124, 'binary_recall': 0.8138587, 'binary_specificity': 0.9955104, 'binary_f1_score': 0.83776224}
confusion matrix:
       0     1
0  42130   190
1    274  1198
---- Validation: 
scalar performance:
{'acc': 0.9874415, 'precision': 0.9133649, 'recall': 0.89224076, 'specificity': 0.89224076, 'f1': 0.9025029, 'auroc': 0.97952485, 'binary_precision': 0.83415437, 'binary_recall': 0.79004663, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.81150156}
confusion matrix:
       0    1
0  18048  101
1    135  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.9423591, 'recall': 0.5667997, 'specificity': 0.5667997, 'f1': 0.6076847, 'auroc': 0.92464066, 'binary_precision': 0.92105263, 'binary_recall': 0.13409962, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.2341137}
confusion matrix:
      0   1
0  5994   3
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_14.png
better model found
persisted
after epoch: 14,now: 2024-06-07 10:44:59.759364,epoch time: 0:39:49.736979,used: 9:19:59.655665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98942727, 'precision': 0.9353726, 'recall': 0.8961028, 'specificity': 0.8961028, 'f1': 0.9147382, 'auroc': 0.9934075, 'binary_precision': 0.8778111, 'binary_recall': 0.7960571, 'binary_specificity': 0.99614847, 'binary_f1_score': 0.83493763}
confusion matrix:
       0     1
0  42158   163
1    300  1171
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.90155697, 'recall': 0.8671095, 'specificity': 0.8671095, 'f1': 0.8834971, 'auroc': 0.9801345, 'binary_precision': 0.8122867, 'binary_recall': 0.7402799, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.7746135}
confusion matrix:
       0    1
0  18039  110
1    167  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.8446002, 'recall': 0.54522663, 'specificity': 0.54522663, 'f1': 0.57156885, 'auroc': 0.93556356, 'binary_precision': 0.72727275, 'binary_recall': 0.09195402, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.1632653}
confusion matrix:
      0   1
0  5988   9
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_15.png
early stop counter: 1
val acc:0.9852597117424011, best validation acc: 0.9874414801597595, corresponding to test acc:                         0.9634068608283997 / 0.9723553657531738
after epoch: 15,now: 2024-06-07 11:24:46.066706,epoch time: 0:39:46.307342,used: 9:59:45.963007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98972416, 'precision': 0.9553038, 'recall': 0.8796048, 'specificity': 0.8796048, 'f1': 0.9137686, 'auroc': 0.9940989, 'binary_precision': 0.91885245, 'binary_recall': 0.76154894, 'binary_specificity': 0.9976607, 'binary_f1_score': 0.83283806}
confusion matrix:
       0     1
0  42221    99
1    351  1121
---- Validation: 
scalar performance:
{'acc': 0.9870157, 'precision': 0.9477473, 'recall': 0.844767, 'specificity': 0.844767, 'f1': 0.8890692, 'auroc': 0.981119, 'binary_precision': 0.90631366, 'binary_recall': 0.69206846, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.7848325}
confusion matrix:
       0    1
0  18103   46
1    198  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7298814, 'recall': 0.51832336, 'specificity': 0.51832336, 'f1': 0.52492106, 'auroc': 0.8848412, 'binary_precision': 0.5, 'binary_recall': 0.038314175, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.071174376}
confusion matrix:
      0   1
0  5987  10
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_16.png
early stop counter: 2
val acc:0.9870157241821289, best validation acc: 0.9874414801597595, corresponding to test acc:                         0.9634068608283997 / 0.9723553657531738
after epoch: 16,now: 2024-06-07 12:04:38.627450,epoch time: 0:39:52.560744,used: 10:39:38.523751,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99056906, 'precision': 0.9588901, 'recall': 0.89020556, 'specificity': 0.89020556, 'f1': 0.92156386, 'auroc': 0.9953091, 'binary_precision': 0.9253012, 'binary_recall': 0.7826087, 'binary_specificity': 0.99780244, 'binary_f1_score': 0.84799415}
confusion matrix:
       0     1
0  42227    93
1    320  1152
---- Validation: 
scalar performance:
{'acc': 0.9883993, 'precision': 0.93085766, 'recall': 0.8867363, 'specificity': 0.8867363, 'f1': 0.9075117, 'auroc': 0.9810698, 'binary_precision': 0.8695652, 'binary_recall': 0.777605, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.82101804}
confusion matrix:
       0    1
0  18074   75
1    143  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8961932, 'recall': 0.50949514, 'specificity': 0.50949514, 'f1': 0.50823593, 'auroc': 0.89772075, 'binary_precision': 0.8333333, 'binary_recall': 0.019157087, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.037453182}
confusion matrix:
      0  1
0  5996  1
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_17.png
better model found
persisted
after epoch: 17,now: 2024-06-07 12:44:46.960812,epoch time: 0:40:08.333362,used: 11:19:46.857113,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98915327, 'precision': 0.97098845, 'recall': 0.85583645, 'specificity': 0.85583645, 'f1': 0.9048298, 'auroc': 0.99530613, 'binary_precision': 0.9518619, 'binary_recall': 0.7129252, 'binary_specificity': 0.9987477, 'binary_f1_score': 0.815247}
confusion matrix:
       0     1
0  42269    53
1    422  1048
---- Validation: 
scalar performance:
{'acc': 0.9857918, 'precision': 0.95261914, 'recall': 0.82013154, 'specificity': 0.82013154, 'f1': 0.87420064, 'auroc': 0.98042226, 'binary_precision': 0.9177778, 'binary_recall': 0.64230174, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.7557182}
confusion matrix:
       0    1
0  18112   37
1    230  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.95560277, 'recall': 0.5363151, 'specificity': 0.5363151, 'f1': 0.55768514, 'auroc': 0.9025525, 'binary_precision': 0.95, 'binary_recall': 0.07279693, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.13523132}
confusion matrix:
      0   1
0  5996   1
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_18.png
early stop counter: 1
val acc:0.985791802406311, best validation acc: 0.9883993268013, corresponding to test acc:                         0.9589325785636902 / 0.9723553657531738
after epoch: 18,now: 2024-06-07 13:24:46.731473,epoch time: 0:39:59.770661,used: 11:59:46.627774,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99045485, 'precision': 0.9293186, 'recall': 0.9225536, 'specificity': 0.9225536, 'f1': 0.9259071, 'auroc': 0.9950731, 'binary_precision': 0.86385626, 'binary_recall': 0.8497621, 'binary_specificity': 0.9953451, 'binary_f1_score': 0.8567512}
confusion matrix:
       0     1
0  42124   197
1    221  1250
---- Validation: 
scalar performance:
{'acc': 0.9863772, 'precision': 0.90587604, 'recall': 0.8826891, 'specificity': 0.8826891, 'f1': 0.8939132, 'auroc': 0.98176765, 'binary_precision': 0.8198347, 'binary_recall': 0.7713841, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.7948718}
confusion matrix:
       0    1
0  18040  109
1    147  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.78634953, 'recall': 0.5409784, 'specificity': 0.5409784, 'f1': 0.56372136, 'auroc': 0.86878544, 'binary_precision': 0.6111111, 'binary_recall': 0.08429119, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.14814816}
confusion matrix:
      0   1
0  5983  14
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_19.png
early stop counter: 2
val acc:0.9863771796226501, best validation acc: 0.9883993268013, corresponding to test acc:                         0.9589325785636902 / 0.9723553657531738
after epoch: 19,now: 2024-06-07 14:04:57.975546,epoch time: 0:40:11.244073,used: 12:39:57.871847,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98990685, 'precision': 0.91438115, 'recall': 0.9344518, 'specificity': 0.9344518, 'f1': 0.92415935, 'auroc': 0.9961603, 'binary_precision': 0.8331177, 'binary_recall': 0.875, 'binary_specificity': 0.9939036, 'binary_f1_score': 0.8535454}
confusion matrix:
       0     1
0  42062   258
1    184  1288
---- Validation: 
scalar performance:
{'acc': 0.98781395, 'precision': 0.9021262, 'recall': 0.9171854, 'specificity': 0.9171854, 'f1': 0.9095055, 'auroc': 0.98078203, 'binary_precision': 0.80988026, 'binary_recall': 0.84136856, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.82532424}
confusion matrix:
       0    1
0  18022  127
1    102  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.92321265, 'recall': 0.5438112, 'specificity': 0.5438112, 'f1': 0.5702858, 'auroc': 0.9011022, 'binary_precision': 0.88461536, 'binary_recall': 0.08812261, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.16027875}
confusion matrix:
      0   1
0  5994   3
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_20.png
early stop counter: 3
val acc:0.9878139495849609, best validation acc: 0.9883993268013, corresponding to test acc:                         0.9589325785636902 / 0.9723553657531738
after epoch: 20,now: 2024-06-07 14:45:02.763499,epoch time: 0:40:04.787953,used: 13:20:02.659800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.991962, 'precision': 0.9328321, 'recall': 0.94531536, 'specificity': 0.94531536, 'f1': 0.93897784, 'auroc': 0.9960648, 'binary_precision': 0.8693069, 'binary_recall': 0.8953093, 'binary_specificity': 0.99532145, 'binary_f1_score': 0.88211656}
confusion matrix:
       0     1
0  42123   198
1    154  1317
---- Validation: 
scalar performance:
{'acc': 0.9877607, 'precision': 0.90417606, 'recall': 0.9126576, 'specificity': 0.9126576, 'f1': 0.90836906, 'auroc': 0.9839023, 'binary_precision': 0.81430745, 'binary_recall': 0.8320373, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.82307696}
confusion matrix:
       0    1
0  18027  122
1    108  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.85254705, 'recall': 0.5490581, 'specificity': 0.5490581, 'f1': 0.5778542, 'auroc': 0.89113057, 'binary_precision': 0.74285716, 'binary_recall': 0.099616855, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.17567569}
confusion matrix:
      0   1
0  5988   9
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_21.png
early stop counter: 4
val acc:0.9877607226371765, best validation acc: 0.9883993268013, corresponding to test acc:                         0.9589325785636902 / 0.9723553657531738
after epoch: 21,now: 2024-06-07 15:25:05.717192,epoch time: 0:40:02.953693,used: 14:00:05.613493,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9917793, 'precision': 0.9295979, 'recall': 0.94649863, 'specificity': 0.94649863, 'f1': 0.93787193, 'auroc': 0.996374, 'binary_precision': 0.8627451, 'binary_recall': 0.8979592, 'binary_specificity': 0.99503803, 'binary_f1_score': 0.88}
confusion matrix:
       0     1
0  42112   210
1    150  1320
---- Validation: 
scalar performance:
{'acc': 0.9871754, 'precision': 0.8945722, 'recall': 0.9176049, 'specificity': 0.9176049, 'f1': 0.90573335, 'auroc': 0.98298275, 'binary_precision': 0.7947214, 'binary_recall': 0.8429238, 'binary_specificity': 0.9922861, 'binary_f1_score': 0.81811327}
confusion matrix:
       0    1
0  18009  140
1    101  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.92748797, 'recall': 0.5476426, 'specificity': 0.5476426, 'f1': 0.57673174, 'auroc': 0.8941605, 'binary_precision': 0.89285713, 'binary_recall': 0.09578544, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.17301038}
confusion matrix:
      0   1
0  5994   3
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_22.png
early stop counter: 5
val acc:0.9871754050254822, best validation acc: 0.9883993268013, corresponding to test acc:                         0.9589325785636902 / 0.9723553657531738
after epoch: 22,now: 2024-06-07 16:05:11.557416,epoch time: 0:40:05.840224,used: 14:40:11.453717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9912769, 'precision': 0.9784932, 'recall': 0.88360804, 'specificity': 0.88360804, 'f1': 0.9254577, 'auroc': 0.99796027, 'binary_precision': 0.9649872, 'binary_recall': 0.7681849, 'binary_specificity': 0.9990312, 'binary_f1_score': 0.85541254}
confusion matrix:
       0     1
0  42280    41
1    341  1130
---- Validation: 
scalar performance:
{'acc': 0.987335, 'precision': 0.9593735, 'recall': 0.83968186, 'specificity': 0.83968186, 'f1': 0.88991475, 'auroc': 0.9827526, 'binary_precision': 0.9299363, 'binary_recall': 0.68118197, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.78635544}
confusion matrix:
       0    1
0  18116   33
1    205  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.9134711, 'recall': 0.5247375, 'specificity': 0.5247375, 'f1': 0.536889, 'auroc': 0.8064077, 'binary_precision': 0.8666667, 'binary_recall': 0.049808428, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.09420289}
confusion matrix:
      0   1
0  5995   2
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_23.png
early stop counter: 6
val acc:0.9873350262641907, best validation acc: 0.9883993268013, corresponding to test acc:                         0.9589325785636902 / 0.9723553657531738
after epoch: 23,now: 2024-06-07 16:45:53.718285,epoch time: 0:40:42.160869,used: 15:20:53.614586,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9928982, 'precision': 0.96288526, 'recall': 0.924802, 'specificity': 0.924802, 'f1': 0.942965, 'auroc': 0.99745345, 'binary_precision': 0.9309064, 'binary_recall': 0.8518015, 'binary_specificity': 0.9978025, 'binary_f1_score': 0.88959885}
confusion matrix:
       0     1
0  42228    93
1    218  1253
---- Validation: 
scalar performance:
{'acc': 0.9882929, 'precision': 0.9196118, 'recall': 0.89943206, 'specificity': 0.89943206, 'f1': 0.9092529, 'auroc': 0.98376405, 'binary_precision': 0.84615386, 'binary_recall': 0.80404353, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.82456136}
confusion matrix:
       0    1
0  18055   94
1    126  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8956452, 'recall': 0.5550553, 'specificity': 0.5550553, 'f1': 0.58823484, 'auroc': 0.912994, 'binary_precision': 0.82857144, 'binary_recall': 0.11111111, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.19594595}
confusion matrix:
      0   1
0  5991   6
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_24.png
early stop counter: 7
val acc:0.9882928729057312, best validation acc: 0.9883993268013, corresponding to test acc:                         0.9589325785636902 / 0.9723553657531738
after epoch: 24,now: 2024-06-07 17:26:21.236001,epoch time: 0:40:27.517716,used: 16:01:21.132302,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9898155, 'precision': 0.94280005, 'recall': 0.8944057, 'specificity': 0.8944057, 'f1': 0.91709685, 'auroc': 0.99648476, 'binary_precision': 0.8928025, 'binary_recall': 0.79211956, 'binary_specificity': 0.9966919, 'binary_f1_score': 0.83945286}
confusion matrix:
       0     1
0  42180   140
1    306  1166
---- Validation: 
scalar performance:
{'acc': 0.9841422, 'precision': 0.9033874, 'recall': 0.8425292, 'specificity': 0.8425292, 'f1': 0.87027395, 'auroc': 0.98223186, 'binary_precision': 0.8176796, 'binary_recall': 0.6905132, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.74873525}
confusion matrix:
       0    1
0  18050   99
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8286589, 'recall': 0.5638835, 'specificity': 0.5638835, 'f1': 0.5997643, 'auroc': 0.91244173, 'binary_precision': 0.6938776, 'binary_recall': 0.1302682, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.21935484}
confusion matrix:
      0   1
0  5982  15
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_25.png
early stop counter: 8
val acc:0.9841421842575073, best validation acc: 0.9883993268013, corresponding to test acc:                         0.9589325785636902 / 0.9723553657531738
after epoch: 25,now: 2024-06-07 18:06:40.344284,epoch time: 0:40:19.108283,used: 16:41:40.240585,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99251, 'precision': 0.97556794, 'recall': 0.90596354, 'specificity': 0.90596354, 'f1': 0.9378177, 'auroc': 0.9974271, 'binary_precision': 0.9576, 'binary_recall': 0.8131794, 'binary_specificity': 0.99874765, 'binary_f1_score': 0.8795004}
confusion matrix:
       0     1
0  42267    53
1    275  1197
---- Validation: 
scalar performance:
{'acc': 0.9880268, 'precision': 0.9492328, 'recall': 0.8602915, 'specificity': 0.8602915, 'f1': 0.8995092, 'auroc': 0.98170304, 'binary_precision': 0.9082031, 'binary_recall': 0.7231726, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.8051948}
confusion matrix:
       0    1
0  18102   47
1    178  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.8259777, 'recall': 0.5169079, 'specificity': 0.5169079, 'f1': 0.5223909, 'auroc': 0.8452684, 'binary_precision': 0.6923077, 'binary_recall': 0.03448276, 'binary_specificity': 0.999333, 'binary_f1_score': 0.06569343}
confusion matrix:
      0  1
0  5993  4
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_26.png
early stop counter: 9
val acc:0.9880267977714539, best validation acc: 0.9883993268013, corresponding to test acc:                         0.9589325785636902 / 0.9723553657531738
after epoch: 26,now: 2024-06-07 18:46:49.695741,epoch time: 0:40:09.351457,used: 17:21:49.592042,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9932636, 'precision': 0.94446355, 'recall': 0.95290935, 'specificity': 0.95290935, 'f1': 0.94864357, 'auroc': 0.99779797, 'binary_precision': 0.89207196, 'binary_recall': 0.90964675, 'binary_specificity': 0.996172, 'binary_f1_score': 0.90077364}
confusion matrix:
       0     1
0  42158   162
1    133  1339
---- Validation: 
scalar performance:
{'acc': 0.987335, 'precision': 0.9037255, 'recall': 0.9049367, 'specificity': 0.9049367, 'f1': 0.90433013, 'auroc': 0.9819057, 'binary_precision': 0.81395346, 'binary_recall': 0.8164852, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.81521744}
confusion matrix:
       0    1
0  18029  120
1    118  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.8761677, 'recall': 0.55680424, 'specificity': 0.55680424, 'f1': 0.590553, 'auroc': 0.895486, 'binary_precision': 0.7894737, 'binary_recall': 0.11494253, 'binary_specificity': 0.998666, 'binary_f1_score': 0.2006689}
confusion matrix:
      0   1
0  5989   8
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_27.png
early stop counter: 10
val acc:0.9873350262641907, best validation acc: 0.9883993268013, corresponding to test acc:                         0.9589325785636902 / 0.9723553657531738
after epoch: 27,now: 2024-06-07 19:27:08.857332,epoch time: 0:40:19.161591,used: 18:02:08.753633,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99417704, 'precision': 0.95719683, 'recall': 0.95269513, 'specificity': 0.95269513, 'f1': 0.954934, 'auroc': 0.99831593, 'binary_precision': 0.9175824, 'binary_recall': 0.9082257, 'binary_specificity': 0.99716455, 'binary_f1_score': 0.9128801}
confusion matrix:
       0     1
0  42201   120
1    135  1336
---- Validation: 
scalar performance:
{'acc': 0.9874947, 'precision': 0.90996635, 'recall': 0.8982688, 'specificity': 0.8982688, 'f1': 0.90402585, 'auroc': 0.98156285, 'binary_precision': 0.8269231, 'binary_recall': 0.8024883, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.81452245}
confusion matrix:
       0    1
0  18041  108
1    127  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.9182507, 'recall': 0.53997976, 'specificity': 0.53997976, 'f1': 0.5637504, 'auroc': 0.8598642, 'binary_precision': 0.875, 'binary_recall': 0.08045977, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.14736843}
confusion matrix:
      0   1
0  5994   3
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_28.png
early stop counter: 11
val acc:0.987494707107544, best validation acc: 0.9883993268013, corresponding to test acc:                         0.9589325785636902 / 0.9723553657531738
after epoch: 28,now: 2024-06-07 20:07:22.207594,epoch time: 0:40:13.350262,used: 18:42:22.103895,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9935605, 'precision': 0.94402266, 'recall': 0.9585831, 'specificity': 0.9585831, 'f1': 0.95117605, 'auroc': 0.9987085, 'binary_precision': 0.89078945, 'binary_recall': 0.92108846, 'binary_specificity': 0.9960777, 'binary_f1_score': 0.9056856}
confusion matrix:
       0     1
0  42156   166
1    116  1354
---- Validation: 
scalar performance:
{'acc': 0.988825, 'precision': 0.90836334, 'recall': 0.9267096, 'specificity': 0.9267096, 'f1': 0.9173176, 'auroc': 0.9845773, 'binary_precision': 0.8216939, 'binary_recall': 0.8600311, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.84042555}
confusion matrix:
       0    1
0  18029  120
1     90  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8716722, 'recall': 0.5473091, 'specificity': 0.5473091, 'f1': 0.5753839, 'auroc': 0.90529335, 'binary_precision': 0.78125, 'binary_recall': 0.09578544, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.17064846}
confusion matrix:
      0   1
0  5990   7
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_29.png
better model found
persisted
after epoch: 29,now: 2024-06-07 20:47:54.509628,epoch time: 0:40:32.302034,used: 19:22:54.405929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99406284, 'precision': 0.94960403, 'recall': 0.96020794, 'specificity': 0.96020794, 'f1': 0.9548392, 'auroc': 0.9986584, 'binary_precision': 0.9018568, 'binary_recall': 0.92391306, 'binary_specificity': 0.9965028, 'binary_f1_score': 0.9127516}
confusion matrix:
       0     1
0  42172   148
1    112  1360
---- Validation: 
scalar performance:
{'acc': 0.987335, 'precision': 0.9084771, 'recall': 0.8974361, 'specificity': 0.8974361, 'f1': 0.9028746, 'auroc': 0.98309696, 'binary_precision': 0.824, 'binary_recall': 0.8009331, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.8123029}
confusion matrix:
       0    1
0  18039  110
1    128  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8595511, 'recall': 0.5585532, 'specificity': 0.5585532, 'f1': 0.5928242, 'auroc': 0.8996304, 'binary_precision': 0.75609756, 'binary_recall': 0.118773945, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.205298}
confusion matrix:
      0   1
0  5987  10
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_30.png
early stop counter: 1
val acc:0.9873350262641907, best validation acc: 0.9888250231742859, corresponding to test acc:                         0.9611697196960449 / 0.9723553657531738
after epoch: 30,now: 2024-06-07 21:28:22.101322,epoch time: 0:40:27.591694,used: 20:03:21.997623,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_00_seed_0_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 20:03:21.997623 at 2024-06-07 21:28:22.101322
persisted model performance metric: 

scalar performance:
{'acc': 0.96212846, 'precision': 0.8981035, 'recall': 0.556971, 'specificity': 0.556971, 'f1': 0.5913121, 'auroc': 0.8921132, 'binary_precision': 0.8333333, 'binary_recall': 0.11494253, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.2020202}
confusion matrix:
      0   1
0  5991   6
1   231  30
oracle model performance metric: 

scalar performance:
{'acc': 0.97299457, 'precision': 0.92904043, 'recall': 0.70189786, 'specificity': 0.70189786, 'f1': 0.7712519, 'auroc': 0.937839, 'binary_precision': 0.8833333, 'binary_recall': 0.40613025, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.55643046}
confusion matrix:
      0    1
0  5983   14
1   155  106
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/7.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1661 MiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |   1655 MiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      6 MiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |   1647 MiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      5 MiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16730 MiB |  16730 MiB |  16730 MiB |      0 B   |
|       from large pool |  16702 MiB |  16702 MiB |  16702 MiB |      0 B   |
|       from small pool |     28 MiB |     28 MiB |     28 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 430238 KiB |    863 MiB | 413553 GiB | 413552 GiB |
|       from large pool | 410304 KiB |    862 MiB | 400662 GiB | 400662 GiB |
|       from small pool |  19934 KiB |     21 MiB |  12890 GiB |  12890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6357    |  152225 K  |  152221 K  |
|       from large pool |     247    |     989    |   62327 K  |   62327 K  |
|       from small pool |    3119    |    6108    |   89898 K  |   89894 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6357    |  152225 K  |  152221 K  |
|       from large pool |     247    |     989    |   62327 K  |   62327 K  |
|       from small pool |    3119    |    6108    |   89898 K  |   89894 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |     621    |       0    |
|       from large pool |     607    |     607    |     607    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     149    |    2873    |   90051 K  |   90051 K  |
|       from large pool |     112    |     516    |   47275 K  |   47275 K  |
|       from small pool |      37    |    2761    |   42776 K  |   42776 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413554 GiB | 413554 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400663 GiB | 400663 GiB |
|       from small pool |      0 KiB |     22 MiB |  12890 GiB |  12890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152225 K  |  152225 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89898 K  |   89898 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152225 K  |  152225 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89898 K  |   89898 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |   90053 K  |   90053 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2761    |   42777 K  |   42777 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15804 MiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB |  15779 MiB |    977 TiB |    977 TiB |
|       from small pool |      0 KiB |     26 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |    987 TiB |    987 TiB |
|       from large pool |  16640 KiB |  15745 MiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |     25 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2082 MiB |  16730 MiB |  16730 MiB |  14648 MiB |
|       from large pool |   2056 MiB |  16702 MiB |  16702 MiB |  14646 MiB |
|       from small pool |     26 MiB |     28 MiB |     28 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    863 MiB | 413554 GiB | 413554 GiB |
|       from large pool |  24320 KiB |    862 MiB | 400663 GiB | 400663 GiB |
|       from small pool |      0 KiB |     22 MiB |  12890 GiB |  12890 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6357    |  152225 K  |  152225 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89898 K  |   89898 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6357    |  152225 K  |  152225 K  |
|       from large pool |       2    |     989    |   62327 K  |   62327 K  |
|       from small pool |       0    |    6108    |   89898 K  |   89898 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     621    |     621    |     506    |
|       from large pool |     102    |     607    |     607    |     505    |
|       from small pool |      13    |      14    |      14    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |   90053 K  |   90053 K  |
|       from large pool |       2    |     516    |   47275 K  |   47275 K  |
|       from small pool |       0    |    2761    |   42777 K  |   42777 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184

 Experiment start at: 2024-06-07 21:39:04.268963
before training, model accuracy: 0.06445375829935074
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.970768, 'precision': 0.7847276, 'recall': 0.6760613, 'specificity': 0.6760613, 'f1': 0.7164381, 'auroc': 0.9432129, 'binary_precision': 0.59090906, 'binary_recall': 0.36061028, 'binary_specificity': 0.99151224, 'binary_f1_score': 0.44788975}
confusion matrix:
       0    1
0  42054  360
1    922  520
---- Validation: 
scalar performance:
{'acc': 0.96808964, 'precision': 0.7792966, 'recall': 0.69519776, 'specificity': 0.69519776, 'f1': 0.72903097, 'auroc': 0.9471884, 'binary_precision': 0.58064514, 'binary_recall': 0.4011887, 'binary_specificity': 0.98920685, 'binary_f1_score': 0.47451672}
confusion matrix:
       0    1
0  17872  195
1    403  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.7734337, 'recall': 0.5316832, 'specificity': 0.5316832, 'f1': 0.54830635, 'auroc': 0.9265895, 'binary_precision': 0.5862069, 'binary_recall': 0.06538462, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.11764707}
confusion matrix:
      0   1
0  5934  12
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-07 22:21:01.622211,epoch time: 0:41:57.353248,used: 0:41:57.353248,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9747811, 'precision': 0.8107152, 'recall': 0.76506436, 'specificity': 0.76506436, 'f1': 0.7859152, 'auroc': 0.9598376, 'binary_precision': 0.6369583, 'binary_recall': 0.5405968, 'binary_specificity': 0.989532, 'binary_f1_score': 0.5848348}
confusion matrix:
       0    1
0  41971  444
1    662  779
---- Validation: 
scalar performance:
{'acc': 0.973159, 'precision': 0.8221587, 'recall': 0.75290245, 'specificity': 0.75290245, 'f1': 0.7829598, 'auroc': 0.9622959, 'binary_precision': 0.66221374, 'binary_recall': 0.51560175, 'binary_specificity': 0.99020314, 'binary_f1_score': 0.5797828}
confusion matrix:
       0    1
0  17890  177
1    326  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.82585406, 'recall': 0.5866956, 'specificity': 0.5866956, 'f1': 0.63095, 'auroc': 0.9357514, 'binary_precision': 0.6865672, 'binary_recall': 0.17692308, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.28134558}
confusion matrix:
      0   1
0  5925  21
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-07 23:01:24.345569,epoch time: 0:40:22.723358,used: 1:22:20.076606,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97690165, 'precision': 0.82600474, 'recall': 0.793786, 'specificity': 0.793786, 'f1': 0.80898273, 'auroc': 0.96886194, 'binary_precision': 0.6656371, 'binary_recall': 0.5977809, 'binary_specificity': 0.9897911, 'binary_f1_score': 0.62988675}
confusion matrix:
       0    1
0  41981  433
1    580  862
---- Validation: 
scalar performance:
{'acc': 0.97502667, 'precision': 0.8395113, 'recall': 0.7660306, 'specificity': 0.7660306, 'f1': 0.7978987, 'auroc': 0.96907145, 'binary_precision': 0.6959847, 'binary_recall': 0.5408618, 'binary_specificity': 0.99119943, 'binary_f1_score': 0.6086956}
confusion matrix:
       0    1
0  17908  159
1    309  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.7951515, 'recall': 0.5318514, 'specificity': 0.5318514, 'f1': 0.54880047, 'auroc': 0.9449769, 'binary_precision': 0.6296296, 'binary_recall': 0.06538462, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.118466906}
confusion matrix:
      0   1
0  5936  10
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_3.png
better model found
persisted
after epoch: 3,now: 2024-06-07 23:41:40.545670,epoch time: 0:40:16.200101,used: 2:02:36.276707,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98052716, 'precision': 0.9055612, 'recall': 0.7558011, 'specificity': 0.7558011, 'f1': 0.8125197, 'auroc': 0.9738009, 'binary_precision': 0.8273942, 'binary_recall': 0.5152566, 'binary_specificity': 0.9963455, 'binary_f1_score': 0.6350427}
confusion matrix:
       0    1
0  42259  155
1    699  743
---- Validation: 
scalar performance:
{'acc': 0.9764141, 'precision': 0.91485894, 'recall': 0.7066677, 'specificity': 0.7066677, 'f1': 0.77338266, 'auroc': 0.9726676, 'binary_precision': 0.85106385, 'binary_recall': 0.41604754, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.55888224}
confusion matrix:
       0    1
0  18018   49
1    393  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.8280946, 'recall': 0.53018063, 'specificity': 0.53018063, 'f1': 0.54619, 'auroc': 0.94434303, 'binary_precision': 0.6956522, 'binary_recall': 0.06153846, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.11307421}
confusion matrix:
      0   1
0  5939   7
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_4.png
better model found
persisted
after epoch: 4,now: 2024-06-08 00:21:38.821561,epoch time: 0:39:58.275891,used: 2:42:34.552598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9805044, 'precision': 0.86634547, 'recall': 0.80536216, 'specificity': 0.80536216, 'f1': 0.832859, 'auroc': 0.97642446, 'binary_precision': 0.7456067, 'binary_recall': 0.6178918, 'binary_specificity': 0.99283254, 'binary_f1_score': 0.67576796}
confusion matrix:
       0    1
0  42110  304
1    551  891
---- Validation: 
scalar performance:
{'acc': 0.97732127, 'precision': 0.87070554, 'recall': 0.7672206, 'specificity': 0.7672206, 'f1': 0.80984855, 'auroc': 0.97532797, 'binary_precision': 0.7583333, 'binary_recall': 0.5408618, 'binary_specificity': 0.99357945, 'binary_f1_score': 0.63139635}
confusion matrix:
       0    1
0  17951  116
1    309  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.8431494, 'recall': 0.57373863, 'specificity': 0.57373863, 'f1': 0.6144501, 'auroc': 0.94969666, 'binary_precision': 0.7222222, 'binary_recall': 0.15, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.24840766}
confusion matrix:
      0   1
0  5931  15
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_5.png
better model found
persisted
after epoch: 5,now: 2024-06-08 01:01:51.630737,epoch time: 0:40:12.809176,used: 3:22:47.361774,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9819865, 'precision': 0.85528874, 'recall': 0.8657499, 'specificity': 0.8657499, 'f1': 0.8604367, 'auroc': 0.9801766, 'binary_precision': 0.7193809, 'binary_recall': 0.74133146, 'binary_specificity': 0.99016833, 'binary_f1_score': 0.73019123}
confusion matrix:
       0     1
0  41997   417
1    373  1069
---- Validation: 
scalar performance:
{'acc': 0.9796158, 'precision': 0.8558524, 'recall': 0.8456595, 'specificity': 0.8456595, 'f1': 0.85067487, 'auroc': 0.9745484, 'binary_precision': 0.7228178, 'binary_recall': 0.7013373, 'binary_specificity': 0.9899817, 'binary_f1_score': 0.71191555}
confusion matrix:
       0    1
0  17886  181
1    201  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.85135853, 'recall': 0.58519304, 'specificity': 0.58519304, 'f1': 0.63063437, 'auroc': 0.9508456, 'binary_precision': 0.73770493, 'binary_recall': 0.17307693, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.28037384}
confusion matrix:
      0   1
0  5930  16
1   215  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-08 01:41:58.777822,epoch time: 0:40:07.147085,used: 4:02:54.508859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9833546, 'precision': 0.8975227, 'recall': 0.8219086, 'specificity': 0.8219086, 'f1': 0.85543466, 'auroc': 0.98414874, 'binary_precision': 0.80689657, 'binary_recall': 0.64909846, 'binary_specificity': 0.99471873, 'binary_f1_score': 0.71944654}
confusion matrix:
       0    1
0  42190  224
1    506  936
---- Validation: 
scalar performance:
{'acc': 0.97758806, 'precision': 0.8700756, 'recall': 0.77379644, 'specificity': 0.77379644, 'f1': 0.8141142, 'auroc': 0.9738218, 'binary_precision': 0.7565923, 'binary_recall': 0.55423474, 'binary_specificity': 0.9933581, 'binary_f1_score': 0.6397942}
confusion matrix:
       0    1
0  17947  120
1    300  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.87242365, 'recall': 0.58736837, 'specificity': 0.58736837, 'f1': 0.63481504, 'auroc': 0.9457683, 'binary_precision': 0.779661, 'binary_recall': 0.17692308, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.28840125}
confusion matrix:
      0   1
0  5933  13
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_7.png
new oracle model saved
early stop counter: 1
val acc:0.9775880575180054, best validation acc: 0.9796158075332642, corresponding to test acc:                         0.9627779722213745 / 0.9634224772453308
after epoch: 7,now: 2024-06-08 02:22:06.539084,epoch time: 0:40:07.761262,used: 4:43:02.270121,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9854752, 'precision': 0.893235, 'recall': 0.87291276, 'specificity': 0.87291276, 'f1': 0.88278246, 'auroc': 0.985344, 'binary_precision': 0.7948718, 'binary_recall': 0.75242716, 'binary_specificity': 0.9933984, 'binary_f1_score': 0.77306736}
confusion matrix:
       0     1
0  42134   280
1    357  1085
---- Validation: 
scalar performance:
{'acc': 0.98121667, 'precision': 0.8732649, 'recall': 0.8464898, 'specificity': 0.8464898, 'f1': 0.8593335, 'auroc': 0.9792236, 'binary_precision': 0.7576244, 'binary_recall': 0.7013373, 'binary_specificity': 0.99164224, 'binary_f1_score': 0.72839504}
confusion matrix:
       0    1
0  17916  151
1    201  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.8883059, 'recall': 0.5742432, 'specificity': 0.5742432, 'f1': 0.6171224, 'auroc': 0.9494017, 'binary_precision': 0.8125, 'binary_recall': 0.15, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.25324675}
confusion matrix:
      0   1
0  5937   9
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_8.png
better model found
persisted
after epoch: 8,now: 2024-06-08 03:02:10.545388,epoch time: 0:40:04.006304,used: 5:23:06.276425,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98615927, 'precision': 0.8937919, 'recall': 0.8866645, 'specificity': 0.8866645, 'f1': 0.890193, 'auroc': 0.987184, 'binary_precision': 0.795053, 'binary_recall': 0.78016645, 'binary_specificity': 0.99316263, 'binary_f1_score': 0.78753936}
confusion matrix:
       0     1
0  42124   290
1    317  1125
---- Validation: 
scalar performance:
{'acc': 0.98297757, 'precision': 0.88674855, 'recall': 0.8595626, 'specificity': 0.8595626, 'f1': 0.87261575, 'auroc': 0.98020184, 'binary_precision': 0.78365386, 'binary_recall': 0.7265973, 'binary_specificity': 0.99252784, 'binary_f1_score': 0.7540478}
confusion matrix:
       0    1
0  17932  135
1    184  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.92238724, 'recall': 0.5707334, 'specificity': 0.5707334, 'f1': 0.61310285, 'auroc': 0.94611615, 'binary_precision': 0.88095236, 'binary_recall': 0.1423077, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.2450331}
confusion matrix:
      0   1
0  5941   5
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_9.png
better model found
persisted
after epoch: 9,now: 2024-06-08 03:42:15.412887,epoch time: 0:40:04.867499,used: 6:03:11.143924,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98506474, 'precision': 0.871541, 'recall': 0.9055259, 'specificity': 0.9055259, 'f1': 0.8877252, 'auroc': 0.98857546, 'binary_precision': 0.74920833, 'binary_recall': 0.8203884, 'binary_specificity': 0.99066347, 'binary_f1_score': 0.7831843}
confusion matrix:
       0     1
0  42018   396
1    259  1183
---- Validation: 
scalar performance:
{'acc': 0.97934896, 'precision': 0.84241176, 'recall': 0.8741318, 'specificity': 0.8741318, 'f1': 0.8574985, 'auroc': 0.979929, 'binary_precision': 0.69376695, 'binary_recall': 0.76077265, 'binary_specificity': 0.987491, 'binary_f1_score': 0.7257264}
confusion matrix:
       0    1
0  17841  226
1    161  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.86345804, 'recall': 0.6251572, 'specificity': 0.6251572, 'f1': 0.6812917, 'auroc': 0.95222163, 'binary_precision': 0.7586207, 'binary_recall': 0.25384617, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.38040346}
confusion matrix:
      0   1
0  5925  21
1   194  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_10.png
new oracle model saved
early stop counter: 1
val acc:0.9793489575386047, best validation acc: 0.982977569103241, corresponding to test acc:                         0.9632613658905029 / 0.9653561115264893
after epoch: 10,now: 2024-06-08 04:22:19.574882,epoch time: 0:40:04.161995,used: 6:43:15.305919,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98825705, 'precision': 0.9373025, 'recall': 0.8686568, 'specificity': 0.8686568, 'f1': 0.8998396, 'auroc': 0.9900106, 'binary_precision': 0.8833747, 'binary_recall': 0.740638, 'binary_specificity': 0.9966756, 'binary_f1_score': 0.8057337}
confusion matrix:
       0     1
0  42273   141
1    374  1068
---- Validation: 
scalar performance:
{'acc': 0.9823906, 'precision': 0.9050075, 'recall': 0.8220643, 'specificity': 0.8220643, 'f1': 0.85840833, 'auroc': 0.9803047, 'binary_precision': 0.8229755, 'binary_recall': 0.64933133, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.7259136}
confusion matrix:
       0    1
0  17973   94
1    236  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.9371946, 'recall': 0.54021645, 'specificity': 0.54021645, 'f1': 0.5642701, 'auroc': 0.9454973, 'binary_precision': 0.9130435, 'binary_recall': 0.08076923, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.1484099}
confusion matrix:
      0   1
0  5944   2
1   239  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_11.png
early stop counter: 2
val acc:0.9823905825614929, best validation acc: 0.982977569103241, corresponding to test acc:                         0.9632613658905029 / 0.9653561115264893
after epoch: 11,now: 2024-06-08 05:02:22.411297,epoch time: 0:40:02.836415,used: 7:23:18.142334,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98745894, 'precision': 0.89594954, 'recall': 0.9107832, 'specificity': 0.9107832, 'f1': 0.9032186, 'auroc': 0.989554, 'binary_precision': 0.7977303, 'binary_recall': 0.82871014, 'binary_specificity': 0.99285614, 'binary_f1_score': 0.81292516}
confusion matrix:
       0     1
0  42111   303
1    247  1195
---- Validation: 
scalar performance:
{'acc': 0.9847385, 'precision': 0.8935076, 'recall': 0.8833644, 'specificity': 0.8833644, 'f1': 0.8883638, 'auroc': 0.98097515, 'binary_precision': 0.7954199, 'binary_recall': 0.7741456, 'binary_specificity': 0.99258316, 'binary_f1_score': 0.7846386}
confusion matrix:
       0    1
0  17933  134
1    152  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.9328275, 'recall': 0.5535939, 'specificity': 0.5535939, 'f1': 0.58652604, 'auroc': 0.9457902, 'binary_precision': 0.9032258, 'binary_recall': 0.10769231, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.19243985}
confusion matrix:
      0   1
0  5943   3
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_12.png
better model found
persisted
after epoch: 12,now: 2024-06-08 05:42:36.475979,epoch time: 0:40:14.064682,used: 8:03:32.207016,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98862183, 'precision': 0.92825174, 'recall': 0.88592803, 'specificity': 0.88592803, 'f1': 0.9059056, 'auroc': 0.9918357, 'binary_precision': 0.86409265, 'binary_recall': 0.77600557, 'binary_specificity': 0.99585044, 'binary_f1_score': 0.8176836}
confusion matrix:
       0     1
0  42238   176
1    323  1119
---- Validation: 
scalar performance:
{'acc': 0.9838314, 'precision': 0.9171516, 'recall': 0.83354044, 'specificity': 0.83354044, 'f1': 0.87030554, 'auroc': 0.9805759, 'binary_precision': 0.8464419, 'binary_recall': 0.6716196, 'binary_specificity': 0.99546134, 'binary_f1_score': 0.74896437}
confusion matrix:
       0    1
0  17985   82
1    221  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.94665694, 'recall': 0.5517549, 'specificity': 0.5517549, 'f1': 0.5837333, 'auroc': 0.94569004, 'binary_precision': 0.9310345, 'binary_recall': 0.103846155, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.18685122}
confusion matrix:
      0   1
0  5944   2
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_13.png
early stop counter: 1
val acc:0.9838314056396484, best validation acc: 0.9847385287284851, corresponding to test acc:                         0.9621334075927734 / 0.9653561115264893
after epoch: 13,now: 2024-06-08 06:22:48.231387,epoch time: 0:40:11.755408,used: 8:43:43.962424,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9886674, 'precision': 0.9076382, 'recall': 0.9160973, 'specificity': 0.9160973, 'f1': 0.91182077, 'auroc': 0.99316704, 'binary_precision': 0.82077396, 'binary_recall': 0.83841884, 'binary_specificity': 0.99377567, 'binary_f1_score': 0.8295026}
confusion matrix:
       0     1
0  42150   264
1    233  1209
---- Validation: 
scalar performance:
{'acc': 0.9822839, 'precision': 0.8862788, 'recall': 0.846328, 'specificity': 0.846328, 'f1': 0.86511683, 'auroc': 0.9813477, 'binary_precision': 0.78369385, 'binary_recall': 0.6998514, 'binary_specificity': 0.9928046, 'binary_f1_score': 0.7394034}
confusion matrix:
       0    1
0  17937  130
1    202  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.92152053, 'recall': 0.5955652, 'specificity': 0.5955652, 'f1': 0.64875805, 'auroc': 0.94569504, 'binary_precision': 0.877193, 'binary_recall': 0.1923077, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.31545743}
confusion matrix:
      0   1
0  5939   7
1   210  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_14.png
early stop counter: 2
val acc:0.982283890247345, best validation acc: 0.9847385287284851, corresponding to test acc:                         0.9621334075927734 / 0.9653561115264893
after epoch: 14,now: 2024-06-08 07:03:03.503028,epoch time: 0:40:15.271641,used: 9:23:59.234065,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9883254, 'precision': 0.96371555, 'recall': 0.84457564, 'specificity': 0.84457564, 'f1': 0.8947592, 'auroc': 0.9932151, 'binary_precision': 0.9378531, 'binary_recall': 0.6907073, 'binary_specificity': 0.9984439, 'binary_f1_score': 0.79552716}
confusion matrix:
       0    1
0  42348   66
1    446  996
---- Validation: 
scalar performance:
{'acc': 0.982444, 'precision': 0.9468198, 'recall': 0.7827522, 'specificity': 0.7827522, 'f1': 0.84497595, 'auroc': 0.9823026, 'binary_precision': 0.9095238, 'binary_recall': 0.5676077, 'binary_specificity': 0.99789673, 'binary_f1_score': 0.69899356}
confusion matrix:
       0    1
0  18029   38
1    291  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.93289834, 'recall': 0.5363703, 'specificity': 0.5363703, 'f1': 0.5576, 'auroc': 0.95643127, 'binary_precision': 0.9047619, 'binary_recall': 0.073076926, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.13523133}
confusion matrix:
      0   1
0  5944   2
1   241  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_15.png
early stop counter: 3
val acc:0.9824439883232117, best validation acc: 0.9847385287284851, corresponding to test acc:                         0.9621334075927734 / 0.9653561115264893
after epoch: 15,now: 2024-06-08 07:43:23.614408,epoch time: 0:40:20.111380,used: 10:04:19.345445,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9887131, 'precision': 0.91887444, 'recall': 0.90004313, 'specificity': 0.90004313, 'f1': 0.9092252, 'auroc': 0.99342537, 'binary_precision': 0.84436363, 'binary_recall': 0.80513173, 'binary_specificity': 0.99495447, 'binary_f1_score': 0.8242811}
confusion matrix:
       0     1
0  42200   214
1    281  1161
---- Validation: 
scalar performance:
{'acc': 0.98249733, 'precision': 0.8926687, 'recall': 0.84071654, 'specificity': 0.84071654, 'f1': 0.8646914, 'auroc': 0.9801292, 'binary_precision': 0.7969019, 'binary_recall': 0.6879643, 'binary_specificity': 0.99346876, 'binary_f1_score': 0.738437}
confusion matrix:
       0    1
0  17949  118
1    210  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.9539078, 'recall': 0.5652164, 'specificity': 0.5652164, 'f1': 0.6054558, 'auroc': 0.9434712, 'binary_precision': 0.9444444, 'binary_recall': 0.13076924, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.22972973}
confusion matrix:
      0   1
0  5944   2
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_16.png
early stop counter: 4
val acc:0.9824973344802856, best validation acc: 0.9847385287284851, corresponding to test acc:                         0.9621334075927734 / 0.9653561115264893
after epoch: 16,now: 2024-06-08 08:23:33.444456,epoch time: 0:40:09.830048,used: 10:44:29.175493,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9890095, 'precision': 0.91857666, 'recall': 0.90622556, 'specificity': 0.90622556, 'f1': 0.9123013, 'auroc': 0.9939968, 'binary_precision': 0.84334767, 'binary_recall': 0.81761444, 'binary_specificity': 0.9948366, 'binary_f1_score': 0.83028173}
confusion matrix:
       0     1
0  42195   219
1    263  1179
---- Validation: 
scalar performance:
{'acc': 0.9848452, 'precision': 0.9105773, 'recall': 0.85981596, 'specificity': 0.85981596, 'f1': 0.88338107, 'auroc': 0.9807304, 'binary_precision': 0.8313458, 'binary_recall': 0.7251114, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.77460307}
confusion matrix:
       0    1
0  17968   99
1    185  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.9275475, 'recall': 0.5631252, 'specificity': 0.5631252, 'f1': 0.6015775, 'auroc': 0.94929576, 'binary_precision': 0.8918919, 'binary_recall': 0.12692308, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.22222222}
confusion matrix:
      0   1
0  5942   4
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_17.png
better model found
persisted
after epoch: 17,now: 2024-06-08 09:04:05.748783,epoch time: 0:40:32.304327,used: 11:25:01.479820,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9911985, 'precision': 0.94789267, 'recall': 0.90936697, 'specificity': 0.90936697, 'f1': 0.9276992, 'auroc': 0.99525833, 'binary_precision': 0.9018265, 'binary_recall': 0.8217753, 'binary_specificity': 0.99695855, 'binary_f1_score': 0.85994196}
confusion matrix:
       0     1
0  42285   129
1    257  1185
---- Validation: 
scalar performance:
{'acc': 0.9853255, 'precision': 0.9260724, 'recall': 0.84933597, 'specificity': 0.84933597, 'f1': 0.8835952, 'auroc': 0.97947913, 'binary_precision': 0.8631387, 'binary_recall': 0.70282316, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.77477473}
confusion matrix:
       0    1
0  17992   75
1    200  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.9265902, 'recall': 0.5765026, 'specificity': 0.5765026, 'f1': 0.6218554, 'auroc': 0.93827623, 'binary_precision': 0.8888889, 'binary_recall': 0.15384616, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.26229507}
confusion matrix:
      0   1
0  5941   5
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_18.png
better model found
persisted
after epoch: 18,now: 2024-06-08 09:45:07.122400,epoch time: 0:41:01.373617,used: 12:06:02.853437,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99069685, 'precision': 0.9259177, 'recall': 0.9281999, 'specificity': 0.9281999, 'f1': 0.9270555, 'auroc': 0.99545586, 'binary_precision': 0.8565517, 'binary_recall': 0.86130375, 'binary_specificity': 0.99509597, 'binary_f1_score': 0.8589212}
confusion matrix:
       0     1
0  42206   208
1    200  1242
---- Validation: 
scalar performance:
{'acc': 0.9851654, 'precision': 0.9049512, 'recall': 0.87357205, 'specificity': 0.87357205, 'f1': 0.88857377, 'auroc': 0.9805732, 'binary_precision': 0.819063, 'binary_recall': 0.7533432, 'binary_specificity': 0.9938009, 'binary_f1_score': 0.7848297}
confusion matrix:
       0    1
0  17955  112
1    166  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.9121407, 'recall': 0.57064927, 'specificity': 0.57064927, 'f1': 0.6126565, 'auroc': 0.9403546, 'binary_precision': 0.8604651, 'binary_recall': 0.1423077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.24422443}
confusion matrix:
      0   1
0  5940   6
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_19.png
early stop counter: 1
val acc:0.9851654171943665, best validation acc: 0.9853255152702332, corresponding to test acc:                         0.9637447595596313 / 0.9653561115264893
after epoch: 19,now: 2024-06-08 10:29:47.258473,epoch time: 0:44:40.136073,used: 12:50:42.989510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98976195, 'precision': 0.9696698, 'recall': 0.8634057, 'specificity': 0.8634057, 'f1': 0.9092902, 'auroc': 0.99609554, 'binary_precision': 0.9485095, 'binary_recall': 0.7281553, 'binary_specificity': 0.9986561, 'binary_f1_score': 0.82385254}
confusion matrix:
       0     1
0  42357    57
1    392  1050
---- Validation: 
scalar performance:
{'acc': 0.98217714, 'precision': 0.94614047, 'recall': 0.7790375, 'specificity': 0.7790375, 'f1': 0.84191847, 'auroc': 0.97908026, 'binary_precision': 0.90843374, 'binary_recall': 0.5601783, 'binary_specificity': 0.99789673, 'binary_f1_score': 0.69301474}
confusion matrix:
       0    1
0  18029   38
1    296  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.96090925, 'recall': 0.54606974, 'specificity': 0.54606974, 'f1': 0.5744389, 'auroc': 0.9401183, 'binary_precision': 0.96, 'binary_recall': 0.092307694, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.16842106}
confusion matrix:
      0   1
0  5945   1
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_20.png
early stop counter: 2
val acc:0.9821771383285522, best validation acc: 0.9853255152702332, corresponding to test acc:                         0.9637447595596313 / 0.9653561115264893
after epoch: 20,now: 2024-06-08 11:11:11.035665,epoch time: 0:41:23.777192,used: 13:32:06.766702,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99094766, 'precision': 0.96881866, 'recall': 0.8837809, 'specificity': 0.8837809, 'f1': 0.9217592, 'auroc': 0.995572, 'binary_precision': 0.94543904, 'binary_recall': 0.76907074, 'binary_specificity': 0.99849105, 'binary_f1_score': 0.8481836}
confusion matrix:
       0     1
0  42350    64
1    333  1109
---- Validation: 
scalar performance:
{'acc': 0.9842583, 'precision': 0.9370729, 'recall': 0.8201718, 'specificity': 0.8201718, 'f1': 0.86889315, 'auroc': 0.9788149, 'binary_precision': 0.88729507, 'binary_recall': 0.6433878, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.7459087}
confusion matrix:
       0    1
0  18012   55
1    240  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9304397, 'recall': 0.5344472, 'specificity': 0.5344472, 'f1': 0.5542297, 'auroc': 0.9302807, 'binary_precision': 0.9, 'binary_recall': 0.06923077, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.12857144}
confusion matrix:
      0   1
0  5944   2
1   242  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_21.png
early stop counter: 3
val acc:0.9842582941055298, best validation acc: 0.9853255152702332, corresponding to test acc:                         0.9637447595596313 / 0.9653561115264893
after epoch: 21,now: 2024-06-08 11:57:44.936154,epoch time: 0:46:33.900489,used: 14:18:40.667191,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9927946, 'precision': 0.9594451, 'recall': 0.92426014, 'specificity': 0.92426014, 'f1': 0.94110024, 'auroc': 0.99599856, 'binary_precision': 0.9239458, 'binary_recall': 0.85090154, 'binary_specificity': 0.99761873, 'binary_f1_score': 0.8859206}
confusion matrix:
       0     1
0  42313   101
1    215  1227
---- Validation: 
scalar performance:
{'acc': 0.98703307, 'precision': 0.9383959, 'recall': 0.8645269, 'specificity': 0.8645269, 'f1': 0.8977875, 'auroc': 0.9816283, 'binary_precision': 0.8866907, 'binary_recall': 0.73254085, 'binary_specificity': 0.996513, 'binary_f1_score': 0.80227834}
confusion matrix:
       0    1
0  18004   63
1    180  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.9617562, 'recall': 0.5479928, 'specificity': 0.5479928, 'f1': 0.5776814, 'auroc': 0.92764676, 'binary_precision': 0.96153843, 'binary_recall': 0.09615385, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.17482518}
confusion matrix:
      0   1
0  5945   1
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_22.png
better model found
persisted
after epoch: 22,now: 2024-06-08 12:37:11.112265,epoch time: 0:39:26.176111,used: 14:58:06.843302,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99142647, 'precision': 0.98386323, 'recall': 0.87866926, 'specificity': 0.87866926, 'f1': 0.92441195, 'auroc': 0.99669176, 'binary_precision': 0.97589284, 'binary_recall': 0.75797504, 'binary_specificity': 0.9993634, 'binary_f1_score': 0.85323966}
confusion matrix:
       0     1
0  42387    27
1    349  1093
---- Validation: 
scalar performance:
{'acc': 0.98457843, 'precision': 0.95541763, 'recall': 0.8096088, 'specificity': 0.8096088, 'f1': 0.8675809, 'auroc': 0.97901434, 'binary_precision': 0.92477876, 'binary_recall': 0.62109953, 'binary_specificity': 0.9981181, 'binary_f1_score': 0.74311113}
confusion matrix:
       0    1
0  18033   34
1    255  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.9652475, 'recall': 0.5576082, 'specificity': 0.5576082, 'f1': 0.59356385, 'auroc': 0.92493904, 'binary_precision': 0.9677419, 'binary_recall': 0.115384616, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5945   1
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_23.png
early stop counter: 1
val acc:0.9845784306526184, best validation acc: 0.9870330691337585, corresponding to test acc:                         0.9619722962379456 / 0.9653561115264893
after epoch: 23,now: 2024-06-08 13:16:03.271204,epoch time: 0:38:52.158939,used: 15:36:59.002241,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9929086, 'precision': 0.956925, 'recall': 0.92900836, 'specificity': 0.92900836, 'f1': 0.9424939, 'auroc': 0.9974483, 'binary_precision': 0.9185788, 'binary_recall': 0.86061025, 'binary_specificity': 0.99740654, 'binary_f1_score': 0.8886501}
confusion matrix:
       0     1
0  42304   110
1    201  1241
---- Validation: 
scalar performance:
{'acc': 0.98569906, 'precision': 0.93299896, 'recall': 0.8480992, 'specificity': 0.8480992, 'f1': 0.8855617, 'auroc': 0.97969794, 'binary_precision': 0.877095, 'binary_recall': 0.6998514, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.7785124}
confusion matrix:
       0    1
0  18001   66
1    202  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.9304757, 'recall': 0.56697136, 'specificity': 0.56697136, 'f1': 0.6076042, 'auroc': 0.9109888, 'binary_precision': 0.8974359, 'binary_recall': 0.13461539, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.23411371}
confusion matrix:
      0   1
0  5942   4
1   225  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_24.png
early stop counter: 2
val acc:0.9856990575790405, best validation acc: 0.9870330691337585, corresponding to test acc:                         0.9619722962379456 / 0.9653561115264893
after epoch: 24,now: 2024-06-08 13:54:40.733201,epoch time: 0:38:37.461997,used: 16:15:36.464238,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9921333, 'precision': 0.97565675, 'recall': 0.8971221, 'specificity': 0.8971221, 'f1': 0.9326067, 'auroc': 0.996712, 'binary_precision': 0.9582289, 'binary_recall': 0.79542303, 'binary_specificity': 0.99882114, 'binary_f1_score': 0.86926866}
confusion matrix:
       0     1
0  42364    50
1    295  1147
---- Validation: 
scalar performance:
{'acc': 0.9845251, 'precision': 0.9482461, 'recall': 0.814588, 'specificity': 0.814588, 'f1': 0.86881685, 'auroc': 0.97932833, 'binary_precision': 0.9100642, 'binary_recall': 0.6315007, 'binary_specificity': 0.9976753, 'binary_f1_score': 0.745614}
confusion matrix:
       0    1
0  18025   42
1    248  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.91762924, 'recall': 0.5267549, 'specificity': 0.5267549, 'f1': 0.54050714, 'auroc': 0.8859492, 'binary_precision': 0.875, 'binary_recall': 0.053846154, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.10144927}
confusion matrix:
      0   1
0  5944   2
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_25.png
early stop counter: 3
val acc:0.9845250844955444, best validation acc: 0.9870330691337585, corresponding to test acc:                         0.9619722962379456 / 0.9653561115264893
after epoch: 25,now: 2024-06-08 14:33:06.979679,epoch time: 0:38:26.246478,used: 16:54:02.710716,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99190533, 'precision': 0.936486, 'recall': 0.9361936, 'specificity': 0.9361936, 'f1': 0.93633974, 'auroc': 0.9973545, 'binary_precision': 0.87716866, 'binary_recall': 0.87656033, 'binary_specificity': 0.99582684, 'binary_f1_score': 0.87686443}
confusion matrix:
       0     1
0  42237   177
1    178  1264
---- Validation: 
scalar performance:
{'acc': 0.98671293, 'precision': 0.92111313, 'recall': 0.8793815, 'specificity': 0.8793815, 'f1': 0.8990669, 'auroc': 0.9803594, 'binary_precision': 0.8509934, 'binary_recall': 0.7637444, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.80501175}
confusion matrix:
       0    1
0  17977   90
1    159  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.9803684, 'recall': 0.5326923, 'specificity': 0.5326923, 'f1': 0.55135953, 'auroc': 0.9144263, 'binary_precision': 1.0, 'binary_recall': 0.06538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.12274369}
confusion matrix:
      0   1
0  5946   0
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_26.png
early stop counter: 4
val acc:0.9867129325866699, best validation acc: 0.9870330691337585, corresponding to test acc:                         0.9619722962379456 / 0.9653561115264893
after epoch: 26,now: 2024-06-08 15:11:47.933941,epoch time: 0:38:40.954262,used: 17:32:43.664978,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.993205, 'precision': 0.94423926, 'recall': 0.9495937, 'specificity': 0.9495937, 'f1': 0.9468992, 'auroc': 0.99766505, 'binary_precision': 0.8917808, 'binary_recall': 0.9029126, 'binary_specificity': 0.9962748, 'binary_f1_score': 0.89731216}
confusion matrix:
       0     1
0  42256   158
1    140  1302
---- Validation: 
scalar performance:
{'acc': 0.9870865, 'precision': 0.914312, 'recall': 0.8953111, 'specificity': 0.8953111, 'f1': 0.9045691, 'auroc': 0.979169, 'binary_precision': 0.83619344, 'binary_recall': 0.79643387, 'binary_specificity': 0.9941883, 'binary_f1_score': 0.8158295}
confusion matrix:
       0    1
0  17962  105
1    137  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.87498593, 'recall': 0.54941136, 'specificity': 0.54941136, 'f1': 0.5787941, 'auroc': 0.8888315, 'binary_precision': 0.7878788, 'binary_recall': 0.1, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.17747441}
confusion matrix:
      0   1
0  5939   7
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_27.png
better model found
persisted
after epoch: 27,now: 2024-06-08 15:51:53.626051,epoch time: 0:40:05.692110,used: 18:12:49.357088,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9940031, 'precision': 0.96120167, 'recall': 0.9429336, 'specificity': 0.9429336, 'f1': 0.95186925, 'auroc': 0.9981793, 'binary_precision': 0.9261939, 'binary_recall': 0.88827205, 'binary_specificity': 0.9975952, 'binary_f1_score': 0.9068366}
confusion matrix:
       0     1
0  42313   102
1    161  1280
---- Validation: 
scalar performance:
{'acc': 0.9875667, 'precision': 0.92738223, 'recall': 0.8862617, 'specificity': 0.8862617, 'f1': 0.9056951, 'auroc': 0.98038554, 'binary_precision': 0.8630363, 'binary_recall': 0.7771174, 'binary_specificity': 0.995406, 'binary_f1_score': 0.8178264}
confusion matrix:
       0    1
0  17984   83
1    150  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.8883059, 'recall': 0.5742432, 'specificity': 0.5742432, 'f1': 0.6171224, 'auroc': 0.9393246, 'binary_precision': 0.8125, 'binary_recall': 0.15, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.25324675}
confusion matrix:
      0   1
0  5937   9
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_28.png
better model found
persisted
after epoch: 28,now: 2024-06-08 16:30:38.547138,epoch time: 0:38:44.921087,used: 18:51:34.278175,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99352425, 'precision': 0.95833266, 'recall': 0.9380354, 'specificity': 0.9380354, 'f1': 0.947937, 'auroc': 0.99772465, 'binary_precision': 0.9207849, 'binary_recall': 0.8786408, 'binary_specificity': 0.9974301, 'binary_f1_score': 0.8992194}
confusion matrix:
       0     1
0  42305   109
1    175  1267
---- Validation: 
scalar performance:
{'acc': 0.9869797, 'precision': 0.9330675, 'recall': 0.8695061, 'specificity': 0.8695061, 'f1': 0.89856243, 'auroc': 0.97366023, 'binary_precision': 0.8756567, 'binary_recall': 0.74294204, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.8038585}
confusion matrix:
       0    1
0  17996   71
1    173  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.91201234, 'recall': 0.5477406, 'specificity': 0.5477406, 'f1': 0.5766479, 'auroc': 0.8519145, 'binary_precision': 0.86206895, 'binary_recall': 0.09615385, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.17301038}
confusion matrix:
      0   1
0  5942   4
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_29.png
early stop counter: 1
val acc:0.9869797229766846, best validation acc: 0.9875667095184326, corresponding to test acc:                         0.9629390835762024 / 0.9653561115264893
after epoch: 29,now: 2024-06-08 17:09:05.842703,epoch time: 0:38:27.295565,used: 19:30:01.573740,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9918825, 'precision': 0.96950567, 'recall': 0.89866716, 'specificity': 0.89866716, 'f1': 0.93098986, 'auroc': 0.99785393, 'binary_precision': 0.9458128, 'binary_recall': 0.7988904, 'binary_specificity': 0.9984439, 'binary_f1_score': 0.8661654}
confusion matrix:
       0     1
0  42348    66
1    290  1152
---- Validation: 
scalar performance:
{'acc': 0.98207045, 'precision': 0.9200594, 'recall': 0.79972494, 'specificity': 0.79972494, 'f1': 0.84903455, 'auroc': 0.9788623, 'binary_precision': 0.85473686, 'binary_recall': 0.6032689, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.7073171}
confusion matrix:
       0    1
0  17998   69
1    267  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.9371946, 'recall': 0.54021645, 'specificity': 0.54021645, 'f1': 0.5642701, 'auroc': 0.9041631, 'binary_precision': 0.9130435, 'binary_recall': 0.08076923, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.1484099}
confusion matrix:
      0   1
0  5944   2
1   239  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_30.png
early stop counter: 2
val acc:0.9820704460144043, best validation acc: 0.9875667095184326, corresponding to test acc:                         0.9629390835762024 / 0.9653561115264893
after epoch: 30,now: 2024-06-08 17:47:17.785944,epoch time: 0:38:11.943241,used: 20:08:13.516981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_21_39_04_seed_1_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 20:08:13.516981 at 2024-06-08 17:47:17.785944
persisted model performance metric: 

scalar performance:
{'acc': 0.9618111, 'precision': 0.8867638, 'recall': 0.5571037, 'specificity': 0.5571037, 'f1': 0.59122884, 'auroc': 0.93610346, 'binary_precision': 0.8108108, 'binary_recall': 0.115384616, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.2020202}
confusion matrix:
      0   1
0  5939   7
1   230  30
oracle model performance metric: 

scalar performance:
{'acc': 0.96825653, 'precision': 0.8828497, 'recall': 0.66161156, 'specificity': 0.66161156, 'f1': 0.72343, 'auroc': 0.9533099, 'binary_precision': 0.7943925, 'binary_recall': 0.32692307, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.46321526}
confusion matrix:
      0   1
0  5924  22
1   175  85
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1664 MiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |   1657 MiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1664 MiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |   1657 MiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      6 MiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |  15770 MiB |   1979 TiB |   1979 TiB |
|       from large pool |   1647 MiB |  15745 MiB |   1953 TiB |   1953 TiB |
|       from small pool |      5 MiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  16758 MiB |  16758 MiB |  31406 MiB |  14648 MiB |
|       from large pool |  16730 MiB |  16730 MiB |  31376 MiB |  14646 MiB |
|       from small pool |     28 MiB |     28 MiB |     30 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 397178 KiB |    905 MiB |    809 TiB |    809 TiB |
|       from large pool | 377232 KiB |    904 MiB |    784 TiB |    784 TiB |
|       from small pool |  19946 KiB |     22 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3342    |    6365    |  304915 K  |  304912 K  |
|       from large pool |     247    |     989    |  124920 K  |  124920 K  |
|       from small pool |    3095    |    6116    |  179994 K  |  179991 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3342    |    6365    |  304915 K  |  304912 K  |
|       from large pool |     247    |     989    |  124920 K  |  124920 K  |
|       from small pool |    3095    |    6116    |  179994 K  |  179991 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     621    |     621    |    1127    |     506    |
|       from large pool |     607    |     607    |    1112    |     505    |
|       from small pool |      14    |      14    |      15    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     145    |    2873    |  179947 K  |  179947 K  |
|       from large pool |     107    |     516    |   93732 K  |   93732 K  |
|       from small pool |      38    |    2765    |   86215 K  |   86215 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1979 TiB |   1979 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1953 TiB |   1953 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2052 MiB |  16758 MiB |  31406 MiB |  29354 MiB |
|       from large pool |   2026 MiB |  16730 MiB |  31376 MiB |  29350 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    905 MiB |    809 TiB |    809 TiB |
|       from large pool |  24320 KiB |    904 MiB |    784 TiB |    784 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304915 K  |  304915 K  |
|       from large pool |       2    |     989    |  124920 K  |  124920 K  |
|       from small pool |       0    |    6116    |  179994 K  |  179994 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304915 K  |  304915 K  |
|       from large pool |       2    |     989    |  124920 K  |  124920 K  |
|       from small pool |       0    |    6116    |  179994 K  |  179994 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     113    |     621    |    1127    |    1014    |
|       from large pool |     100    |     607    |    1112    |    1012    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |  179949 K  |  179949 K  |
|       from large pool |       2    |     516    |   93732 K  |   93732 K  |
|       from small pool |       0    |    2765    |   86217 K  |   86217 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  15807 MiB |   1984 TiB |   1984 TiB |
|       from large pool |  16640 KiB |  15782 MiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |     26 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  15770 MiB |   1979 TiB |   1979 TiB |
|       from large pool |  16640 KiB |  15745 MiB |   1953 TiB |   1953 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2052 MiB |  16758 MiB |  31406 MiB |  29354 MiB |
|       from large pool |   2026 MiB |  16730 MiB |  31376 MiB |  29350 MiB |
|       from small pool |     26 MiB |     28 MiB |     30 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    905 MiB |    809 TiB |    809 TiB |
|       from large pool |  24320 KiB |    904 MiB |    784 TiB |    784 TiB |
|       from small pool |      0 KiB |     25 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6365    |  304915 K  |  304915 K  |
|       from large pool |       2    |     989    |  124920 K  |  124920 K  |
|       from small pool |       0    |    6116    |  179994 K  |  179994 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6365    |  304915 K  |  304915 K  |
|       from large pool |       2    |     989    |  124920 K  |  124920 K  |
|       from small pool |       0    |    6116    |  179994 K  |  179994 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     113    |     621    |    1127    |    1014    |
|       from large pool |     100    |     607    |    1112    |    1012    |
|       from small pool |      13    |      14    |      15    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2873    |  179949 K  |  179949 K  |
|       from large pool |       2    |     516    |   93732 K  |   93732 K  |
|       from small pool |       0    |    2765    |   86217 K  |   86217 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_17_57_35_seed_2_21170184

 Experiment start at: 2024-06-08 17:57:35.935984
before training, model accuracy: 0.18945343792438507
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9680312, 'precision': 0.7750416, 'recall': 0.6377066, 'specificity': 0.6377066, 'f1': 0.68142885, 'auroc': 0.94356763, 'binary_precision': 0.5752688, 'binary_recall': 0.28288168, 'binary_specificity': 0.9925315, 'binary_f1_score': 0.3792645}
confusion matrix:
       0    1
0  41995  316
1   1085  428
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.7615329, 'recall': 0.5896887, 'specificity': 0.5896887, 'f1': 0.6301396, 'auroc': 0.9406321, 'binary_precision': 0.54950494, 'binary_recall': 0.18438539, 'binary_specificity': 0.994992, 'binary_f1_score': 0.27611944}
confusion matrix:
       0    1
0  18080   91
1    491  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96842444, 'precision': 0.9028424, 'recall': 0.6147853, 'specificity': 0.6147853, 'f1': 0.6731354, 'auroc': 0.92274463, 'binary_precision': 0.8358209, 'binary_recall': 0.23140496, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.36245954}
confusion matrix:
      0   1
0  5986  11
1   186  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-08 18:37:11.037125,epoch time: 0:39:35.101141,used: 0:39:35.101141,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_17_57_35_seed_2_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9727775, 'precision': 0.8040343, 'recall': 0.75902176, 'specificity': 0.75902176, 'f1': 0.7795534, 'auroc': 0.9595536, 'binary_precision': 0.624805, 'binary_recall': 0.5294118, 'binary_specificity': 0.9886318, 'binary_f1_score': 0.57316643}
confusion matrix:
       0    1
0  41830  481
1    712  801
---- Validation: 
scalar performance:
{'acc': 0.97315294, 'precision': 0.8097411, 'recall': 0.68257946, 'specificity': 0.68257946, 'f1': 0.72840774, 'auroc': 0.95581114, 'binary_precision': 0.64, 'binary_recall': 0.37209302, 'binary_specificity': 0.9930659, 'binary_f1_score': 0.4705882}
confusion matrix:
       0    1
0  18045  126
1    378  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.85824573, 'recall': 0.61411834, 'specificity': 0.61411834, 'f1': 0.66822755, 'auroc': 0.92890245, 'binary_precision': 0.74666667, 'binary_recall': 0.23140496, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.3533123}
confusion matrix:
      0   1
0  5978  19
1   186  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_2.png
better model found
persisted
after epoch: 2,now: 2024-06-08 19:15:20.129688,epoch time: 0:38:09.092563,used: 1:17:44.193704,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_17_57_35_seed_2_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.976611, 'precision': 0.8313525, 'recall': 0.80402505, 'specificity': 0.80402505, 'f1': 0.8170457, 'auroc': 0.96998656, 'binary_precision': 0.6763006, 'binary_recall': 0.61863846, 'binary_specificity': 0.9894117, 'binary_f1_score': 0.6461857}
confusion matrix:
       0    1
0  41863  448
1    577  936
---- Validation: 
scalar performance:
{'acc': 0.9765621, 'precision': 0.8315509, 'recall': 0.7509935, 'specificity': 0.7509935, 'f1': 0.7852426, 'auroc': 0.96350414, 'binary_precision': 0.6792035, 'binary_recall': 0.5099668, 'binary_specificity': 0.99202025, 'binary_f1_score': 0.58254266}
confusion matrix:
       0    1
0  18026  145
1    295  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.8373681, 'recall': 0.5690807, 'specificity': 0.5690807, 'f1': 0.60813403, 'auroc': 0.942587, 'binary_precision': 0.7083333, 'binary_recall': 0.14049587, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.23448277}
confusion matrix:
      0   1
0  5983  14
1   208  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_3.png
better model found
persisted
after epoch: 3,now: 2024-06-08 19:53:26.256443,epoch time: 0:38:06.126755,used: 1:55:50.320459,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_17_57_35_seed_2_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97875595, 'precision': 0.89080757, 'recall': 0.7547889, 'specificity': 0.7547889, 'f1': 0.8073606, 'auroc': 0.9746048, 'binary_precision': 0.798768, 'binary_recall': 0.51421016, 'binary_specificity': 0.99536765, 'binary_f1_score': 0.6256534}
confusion matrix:
       0    1
0  42115  196
1    735  778
---- Validation: 
scalar performance:
{'acc': 0.97746766, 'precision': 0.86494535, 'recall': 0.7217485, 'specificity': 0.7217485, 'f1': 0.77459246, 'auroc': 0.9690186, 'binary_precision': 0.7479224, 'binary_recall': 0.44850498, 'binary_specificity': 0.994992, 'binary_f1_score': 0.5607477}
confusion matrix:
       0    1
0  18080   91
1    332  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.7749875, 'recall': 0.5341235, 'specificity': 0.5341235, 'f1': 0.55302304, 'auroc': 0.9443876, 'binary_precision': 0.5862069, 'binary_recall': 0.07024793, 'binary_specificity': 0.997999, 'binary_f1_score': 0.12546125}
confusion matrix:
      0   1
0  5985  12
1   225  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_4.png
better model found
persisted
after epoch: 4,now: 2024-06-08 20:31:43.629635,epoch time: 0:38:17.373192,used: 2:34:07.693651,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_17_57_35_seed_2_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9816767, 'precision': 0.9119595, 'recall': 0.7884854, 'specificity': 0.7884854, 'f1': 0.8385066, 'auroc': 0.9805059, 'binary_precision': 0.83874047, 'binary_recall': 0.580965, 'binary_specificity': 0.9960058, 'binary_f1_score': 0.68645066}
confusion matrix:
       0    1
0  42142  169
1    634  879
---- Validation: 
scalar performance:
{'acc': 0.97965163, 'precision': 0.9097942, 'recall': 0.7252858, 'specificity': 0.7252858, 'f1': 0.78896505, 'auroc': 0.9710709, 'binary_precision': 0.8374233, 'binary_recall': 0.45348838, 'binary_specificity': 0.99708325, 'binary_f1_score': 0.5883621}
confusion matrix:
       0    1
0  18118   53
1    329  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.84607273, 'recall': 0.5488364, 'specificity': 0.5488364, 'f1': 0.5779717, 'auroc': 0.94149053, 'binary_precision': 0.72727275, 'binary_recall': 0.09917355, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.17454547}
confusion matrix:
      0   1
0  5988   9
1   218  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_5.png
better model found
persisted
after epoch: 5,now: 2024-06-08 21:09:48.516366,epoch time: 0:38:04.886731,used: 3:12:12.580382,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_17_57_35_seed_2_21170184
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98172235, 'precision': 0.8541815, 'recall': 0.8841046, 'specificity': 0.8841046, 'f1': 0.86847913, 'auroc': 0.9806129, 'binary_precision': 0.7162819, 'binary_recall': 0.7792465, 'binary_specificity': 0.9889627, 'binary_f1_score': 0.74643874}
confusion matrix:
       0     1
0  41844   467
1    334  1179
---- Validation: 
scalar performance:
{'acc': 0.9803441, 'precision': 0.83581424, 'recall': 0.85894954, 'specificity': 0.85894954, 'f1': 0.8469621, 'auroc': 0.9750156, 'binary_precision': 0.68062013, 'binary_recall': 0.7292359, 'binary_specificity': 0.98866326, 'binary_f1_score': 0.70408976}
confusion matrix:
       0    1
0  17965  206
1    163  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.8410817, 'recall': 0.63006365, 'specificity': 0.63006365, 'f1': 0.68437326, 'auroc': 0.9478822, 'binary_precision': 0.7111111, 'binary_recall': 0.2644628, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.38554218}
confusion matrix:
      0   1
0  5971  26
1   178  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170184_6.png
[Sat Jun  8 21:47:48 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/7.csv

RuleException:
RuntimeError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[enforce fail at inline_container.cc:595] . unexpected pos 324381888 vs 324381712
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_irm.py", line 51, in tr_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_irm.py", line 66, in after_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 60, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/a_model_sel.py", line 63, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/c_msel_oracle.py", line 37, in base_update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model.py", line 159, in save
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_utils.py", line 88, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 627, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 475, in __exit__
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
