Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jun 21 11:06:51 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820

 Experiment start at: 2024-06-21 11:23:15.173532
before training, model accuracy: 0.3101629912853241
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9813848, 'precision': 0.9612564, 'recall': 0.9274398, 'specificity': 0.9274398, 'f1': 0.94353676, 'auroc': 0.987488, 'binary_precision': 0.9368992, 'binary_recall': 0.86092865, 'binary_specificity': 0.993951, 'binary_f1_score': 0.8973088}
confusion matrix:
       0     1
0  42065   256
1    614  3801
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.7284088, 'recall': 0.6562932, 'specificity': 0.6562932, 'f1': 0.68483794, 'auroc': 0.77652097, 'binary_precision': 0.48045978, 'binary_recall': 0.32503888, 'binary_specificity': 0.9875475, 'binary_f1_score': 0.3877551}
confusion matrix:
       0    1
0  17923  226
1    434  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.7981726, 'recall': 0.67907226, 'specificity': 0.67907226, 'f1': 0.72211117, 'auroc': 0.80876136, 'binary_precision': 0.6233766, 'binary_recall': 0.3678161, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.4626506}
confusion matrix:
      0   1
0  5939  58
1   165  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 11:39:42.099484,epoch time: 0:16:26.925952,used: 0:16:26.925952,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9854074, 'precision': 0.97496337, 'recall': 0.938168, 'specificity': 0.938168, 'f1': 0.95563424, 'auroc': 0.9911822, 'binary_precision': 0.9623389, 'binary_recall': 0.8799275, 'binary_specificity': 0.99640846, 'binary_f1_score': 0.91928995}
confusion matrix:
       0     1
0  42170   152
1    530  3884
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.7397516, 'recall': 0.6455934, 'specificity': 0.6455934, 'f1': 0.6799623, 'auroc': 0.7990233, 'binary_precision': 0.5038961, 'binary_recall': 0.30171072, 'binary_specificity': 0.989476, 'binary_f1_score': 0.3774319}
confusion matrix:
       0    1
0  17958  191
1    449  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.79285175, 'recall': 0.67698985, 'specificity': 0.67698985, 'f1': 0.71902657, 'auroc': 0.8209249, 'binary_precision': 0.61290324, 'binary_recall': 0.36398467, 'binary_specificity': 0.989995, 'binary_f1_score': 0.45673075}
confusion matrix:
      0   1
0  5937  60
1   166  95
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_2.png
better model found
persisted
after epoch: 2,now: 2024-06-21 11:54:08.925590,epoch time: 0:14:26.826106,used: 0:30:53.752058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9873331, 'precision': 0.9747199, 'recall': 0.95008767, 'specificity': 0.95008767, 'f1': 0.9619905, 'auroc': 0.99254024, 'binary_precision': 0.959375, 'binary_recall': 0.90416855, 'binary_specificity': 0.9960068, 'binary_f1_score': 0.9309541}
confusion matrix:
       0     1
0  42153   169
1    423  3991
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.7496632, 'recall': 0.6384785, 'specificity': 0.6384785, 'f1': 0.67655635, 'auroc': 0.8033016, 'binary_precision': 0.52421653, 'binary_recall': 0.28615862, 'binary_specificity': 0.9907984, 'binary_f1_score': 0.37022132}
confusion matrix:
       0    1
0  17982  167
1    459  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8076912, 'recall': 0.62343526, 'specificity': 0.62343526, 'f1': 0.67231435, 'auroc': 0.8275989, 'binary_precision': 0.64705884, 'binary_recall': 0.25287357, 'binary_specificity': 0.993997, 'binary_f1_score': 0.36363637}
confusion matrix:
      0   1
0  5961  36
1   195  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_3.png
better model found
persisted
after epoch: 3,now: 2024-06-21 12:09:27.314226,epoch time: 0:15:18.388636,used: 0:46:12.140694,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9886383, 'precision': 0.9753349, 'recall': 0.95740336, 'specificity': 0.95740336, 'f1': 0.9661517, 'auroc': 0.99405414, 'binary_precision': 0.95909196, 'binary_recall': 0.9188944, 'binary_specificity': 0.9959123, 'binary_f1_score': 0.938563}
confusion matrix:
       0     1
0  42149   173
1    358  4056
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7508221, 'recall': 0.64378405, 'specificity': 0.64378405, 'f1': 0.68133116, 'auroc': 0.80022806, 'binary_precision': 0.5261708, 'binary_recall': 0.2970451, 'binary_specificity': 0.9905229, 'binary_f1_score': 0.37972167}
confusion matrix:
       0    1
0  17977  172
1    452  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.8109478, 'recall': 0.6403432, 'specificity': 0.6403432, 'f1': 0.69016004, 'auroc': 0.8345998, 'binary_precision': 0.65217394, 'binary_recall': 0.28735632, 'binary_specificity': 0.99333, 'binary_f1_score': 0.39893618}
confusion matrix:
      0   1
0  5957  40
1   186  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_4.png
better model found
persisted
after epoch: 4,now: 2024-06-21 12:22:58.337584,epoch time: 0:13:31.023358,used: 0:59:43.164052,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98836017, 'precision': 0.9740662, 'recall': 0.9570652, 'specificity': 0.9570652, 'f1': 0.96536976, 'auroc': 0.99433994, 'binary_precision': 0.95660377, 'binary_recall': 0.91847825, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.9371534}
confusion matrix:
       0     1
0  42136   184
1    360  4056
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.73795676, 'recall': 0.65001106, 'specificity': 0.65001106, 'f1': 0.6829562, 'auroc': 0.8118342, 'binary_precision': 0.5, 'binary_recall': 0.31104198, 'binary_specificity': 0.9889801, 'binary_f1_score': 0.38350913}
confusion matrix:
       0    1
0  17949  200
1    443  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.78880167, 'recall': 0.6303477, 'specificity': 0.6303477, 'f1': 0.67645025, 'auroc': 0.8199577, 'binary_precision': 0.6086956, 'binary_recall': 0.26819924, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.37234044}
confusion matrix:
      0   1
0  5952  45
1   191  70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_5.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9667943716049194, corresponding to test acc:                         0.9638862013816833 / 0.9643656015396118
after epoch: 5,now: 2024-06-21 12:36:39.230815,epoch time: 0:13:40.893231,used: 1:13:24.057283,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9896867, 'precision': 0.9780866, 'recall': 0.96094143, 'specificity': 0.96094143, 'f1': 0.9693166, 'auroc': 0.9952235, 'binary_precision': 0.9639151, 'binary_recall': 0.9254982, 'binary_specificity': 0.9963847, 'binary_f1_score': 0.9443161}
confusion matrix:
       0     1
0  42167   153
1    329  4087
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.74023247, 'recall': 0.63362, 'specificity': 0.63362, 'f1': 0.6701623, 'auroc': 0.8116258, 'binary_precision': 0.5056818, 'binary_recall': 0.27682737, 'binary_specificity': 0.9904127, 'binary_f1_score': 0.35778892}
confusion matrix:
       0    1
0  17975  174
1    465  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.76668906, 'recall': 0.62959737, 'specificity': 0.62959737, 'f1': 0.6717201, 'auroc': 0.83237135, 'binary_precision': 0.5645161, 'binary_recall': 0.26819924, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.36363634}
confusion matrix:
      0   1
0  5943  54
1   191  70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_6.png
early stop counter: 2
val acc:0.9659961462020874, best validation acc: 0.9667943716049194, corresponding to test acc:                         0.9638862013816833 / 0.9643656015396118
after epoch: 6,now: 2024-06-21 12:51:42.092805,epoch time: 0:15:02.861990,used: 1:28:26.919273,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99056405, 'precision': 0.9785327, 'recall': 0.9657646, 'specificity': 0.9657646, 'f1': 0.97203964, 'auroc': 0.99620175, 'binary_precision': 0.963802, 'binary_recall': 0.93519145, 'binary_specificity': 0.9963377, 'binary_f1_score': 0.94928116}
confusion matrix:
       0     1
0  42168   155
1    286  4127
---- Validation: 
scalar performance:
{'acc': 0.9649319, 'precision': 0.7293667, 'recall': 0.6608211, 'specificity': 0.6608211, 'f1': 0.68840015, 'auroc': 0.82707363, 'binary_precision': 0.4820628, 'binary_recall': 0.33437014, 'binary_specificity': 0.987272, 'binary_f1_score': 0.39485765}
confusion matrix:
       0    1
0  17918  231
1    428  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7547977, 'recall': 0.63650984, 'specificity': 0.63650984, 'f1': 0.6756145, 'auroc': 0.8419901, 'binary_precision': 0.540146, 'binary_recall': 0.2835249, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.3718593}
confusion matrix:
      0   1
0  5934  63
1   187  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_7.png
early stop counter: 3
val acc:0.9649319052696228, best validation acc: 0.9667943716049194, corresponding to test acc:                         0.9638862013816833 / 0.9643656015396118
after epoch: 7,now: 2024-06-21 13:08:14.207108,epoch time: 0:16:32.114303,used: 1:44:59.033576,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9907352, 'precision': 0.9806143, 'recall': 0.96464884, 'specificity': 0.96464884, 'f1': 0.9724616, 'auroc': 0.9962988, 'binary_precision': 0.96824276, 'binary_recall': 0.93248755, 'binary_specificity': 0.9968102, 'binary_f1_score': 0.9500288}
confusion matrix:
       0     1
0  42187   135
1    298  4116
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.7431153, 'recall': 0.63673043, 'specificity': 0.63673043, 'f1': 0.67350376, 'auroc': 0.8287101, 'binary_precision': 0.51123595, 'binary_recall': 0.2830482, 'binary_specificity': 0.9904127, 'binary_f1_score': 0.36436436}
confusion matrix:
       0    1
0  17975  174
1    461  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.7660768, 'recall': 0.5777918, 'specificity': 0.5777918, 'f1': 0.6150702, 'auroc': 0.8300854, 'binary_precision': 0.5675676, 'binary_recall': 0.16091955, 'binary_specificity': 0.994664, 'binary_f1_score': 0.25074628}
confusion matrix:
      0   1
0  5965  32
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_8.png
early stop counter: 4
val acc:0.9662090539932251, best validation acc: 0.9667943716049194, corresponding to test acc:                         0.9638862013816833 / 0.9643656015396118
after epoch: 8,now: 2024-06-21 13:26:28.580319,epoch time: 0:18:14.373211,used: 2:03:13.406787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99039286, 'precision': 0.9752728, 'recall': 0.9682206, 'specificity': 0.9682206, 'f1': 0.9717133, 'auroc': 0.99592704, 'binary_precision': 0.956702, 'binary_recall': 0.94088334, 'binary_specificity': 0.9955578, 'binary_f1_score': 0.9487267}
confusion matrix:
       0     1
0  42133   188
1    261  4154
---- Validation: 
scalar performance:
{'acc': 0.96514475, 'precision': 0.73194087, 'recall': 0.6661817, 'specificity': 0.6661817, 'f1': 0.6930255, 'auroc': 0.83302635, 'binary_precision': 0.4868421, 'binary_recall': 0.3452566, 'binary_specificity': 0.98710674, 'binary_f1_score': 0.4040036}
confusion matrix:
       0    1
0  17915  234
1    421  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.7174845, 'recall': 0.616519, 'specificity': 0.616519, 'f1': 0.64966357, 'auroc': 0.83425796, 'binary_precision': 0.46715328, 'binary_recall': 0.24521072, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.32160804}
confusion matrix:
      0   1
0  5924  73
1   197  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_9.png
early stop counter: 5
val acc:0.9651447534561157, best validation acc: 0.9667943716049194, corresponding to test acc:                         0.9638862013816833 / 0.9643656015396118
after epoch: 9,now: 2024-06-21 13:44:26.660081,epoch time: 0:17:58.079762,used: 2:21:11.486549,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99099195, 'precision': 0.98584723, 'recall': 0.9609437, 'specificity': 0.9609437, 'f1': 0.9729838, 'auroc': 0.9960745, 'binary_precision': 0.97958696, 'binary_recall': 0.92389584, 'binary_specificity': 0.99799156, 'binary_f1_score': 0.9509267}
confusion matrix:
       0     1
0  42236    85
1    336  4079
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.7676193, 'recall': 0.61719525, 'specificity': 0.61719525, 'f1': 0.6603567, 'auroc': 0.81964433, 'binary_precision': 0.5615942, 'binary_recall': 0.24105754, 'binary_specificity': 0.993333, 'binary_f1_score': 0.33732316}
confusion matrix:
       0    1
0  18028  121
1    488  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.75396514, 'recall': 0.5682966, 'specificity': 0.5682966, 'f1': 0.602, 'auroc': 0.818831, 'binary_precision': 0.5441176, 'binary_recall': 0.14176245, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.22492403}
confusion matrix:
      0   1
0  5966  31
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_10.png
better model found
persisted
after epoch: 10,now: 2024-06-21 14:02:23.903219,epoch time: 0:17:57.243138,used: 2:39:08.729687,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99107754, 'precision': 0.9784435, 'recall': 0.9690044, 'specificity': 0.9690044, 'f1': 0.9736645, 'auroc': 0.99630326, 'binary_precision': 0.9629458, 'binary_recall': 0.9417893, 'binary_specificity': 0.9962194, 'binary_f1_score': 0.9522501}
confusion matrix:
       0     1
0  42161   160
1    257  4158
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.7403605, 'recall': 0.6426207, 'specificity': 0.6426207, 'f1': 0.6777195, 'auroc': 0.83754724, 'binary_precision': 0.5053192, 'binary_recall': 0.29548988, 'binary_specificity': 0.9897515, 'binary_f1_score': 0.3729146}
confusion matrix:
       0    1
0  17963  186
1    453  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7321891, 'recall': 0.5751257, 'specificity': 0.5751257, 'f1': 0.60881305, 'auroc': 0.8274962, 'binary_precision': 0.5, 'binary_recall': 0.15708812, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.23906705}
confusion matrix:
      0   1
0  5956  41
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_11.png
early stop counter: 1
val acc:0.9659961462020874, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9592521786689758 / 0.9643656015396118
after epoch: 11,now: 2024-06-21 14:20:59.379886,epoch time: 0:18:35.476667,used: 2:57:44.206354,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99240416, 'precision': 0.98586196, 'recall': 0.96932447, 'specificity': 0.96932447, 'f1': 0.97741294, 'auroc': 0.99718606, 'binary_precision': 0.9778667, 'binary_recall': 0.94087, 'binary_specificity': 0.99777895, 'binary_f1_score': 0.9590117}
confusion matrix:
       0     1
0  42228    94
1    261  4153
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.73548305, 'recall': 0.63717747, 'specificity': 0.63717747, 'f1': 0.67199814, 'auroc': 0.8349493, 'binary_precision': 0.49593496, 'binary_recall': 0.28460342, 'binary_specificity': 0.9897515, 'binary_f1_score': 0.36166006}
confusion matrix:
       0    1
0  17963  186
1    460  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.7172426, 'recall': 0.5837871, 'specificity': 0.5837871, 'f1': 0.6171524, 'auroc': 0.82851064, 'binary_precision': 0.46938777, 'binary_recall': 0.17624521, 'binary_specificity': 0.991329, 'binary_f1_score': 0.25626743}
confusion matrix:
      0   1
0  5945  52
1   215  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_12.png
early stop counter: 2
val acc:0.965623676776886, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9592521786689758 / 0.9643656015396118
after epoch: 12,now: 2024-06-21 14:39:12.430939,epoch time: 0:18:13.051053,used: 3:15:57.257407,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99114174, 'precision': 0.98420644, 'recall': 0.9634688, 'specificity': 0.9634688, 'f1': 0.9735521, 'auroc': 0.99670935, 'binary_precision': 0.97574896, 'binary_recall': 0.9293478, 'binary_specificity': 0.99758977, 'binary_f1_score': 0.95198333}
confusion matrix:
       0     1
0  42218   102
1    312  4104
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.74747026, 'recall': 0.63764584, 'specificity': 0.63764584, 'f1': 0.67532414, 'auroc': 0.82799673, 'binary_precision': 0.5198864, 'binary_recall': 0.28460342, 'binary_specificity': 0.9906882, 'binary_f1_score': 0.3678392}
confusion matrix:
       0    1
0  17980  169
1    460  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95589644, 'precision': 0.6959643, 'recall': 0.57937205, 'specificity': 0.57937205, 'f1': 0.60952294, 'auroc': 0.82413125, 'binary_precision': 0.42718446, 'binary_recall': 0.16858238, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.24175823}
confusion matrix:
      0   1
0  5938  59
1   217  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_13.png
early stop counter: 3
val acc:0.9665282964706421, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9592521786689758 / 0.9643656015396118
after epoch: 13,now: 2024-06-21 14:58:08.707444,epoch time: 0:18:56.276505,used: 3:34:53.533912,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9921474, 'precision': 0.9774661, 'recall': 0.97659415, 'specificity': 0.97659415, 'f1': 0.9770297, 'auroc': 0.9971888, 'binary_precision': 0.9593736, 'binary_recall': 0.9574179, 'binary_specificity': 0.9957704, 'binary_f1_score': 0.95839477}
confusion matrix:
       0     1
0  42142   179
1    188  4227
---- Validation: 
scalar performance:
{'acc': 0.9642933, 'precision': 0.72428894, 'recall': 0.67099124, 'specificity': 0.67099124, 'f1': 0.69363123, 'auroc': 0.8402274, 'binary_precision': 0.4711934, 'binary_recall': 0.3561431, 'binary_specificity': 0.9858394, 'binary_f1_score': 0.40566874}
confusion matrix:
       0    1
0  17892  257
1    414  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95254076, 'precision': 0.67501193, 'recall': 0.6051062, 'specificity': 0.6051062, 'f1': 0.62989694, 'auroc': 0.83445716, 'binary_precision': 0.38311687, 'binary_recall': 0.22605364, 'binary_specificity': 0.98415875, 'binary_f1_score': 0.28433734}
confusion matrix:
      0   1
0  5902  95
1   202  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_14.png
early stop counter: 4
val acc:0.9642933011054993, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9592521786689758 / 0.9643656015396118
after epoch: 14,now: 2024-06-21 15:13:44.683651,epoch time: 0:15:35.976207,used: 3:50:29.510119,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9919976, 'precision': 0.98847383, 'recall': 0.96433914, 'specificity': 0.96433914, 'f1': 0.9760224, 'auroc': 0.9968071, 'binary_precision': 0.984184, 'binary_recall': 0.9302378, 'binary_specificity': 0.9984405, 'binary_f1_score': 0.9564509}
confusion matrix:
       0     1
0  42255    66
1    308  4107
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7631831, 'recall': 0.5966958, 'specificity': 0.5966958, 'f1': 0.6380358, 'auroc': 0.8381187, 'binary_precision': 0.55411255, 'binary_recall': 0.19906688, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.2929062}
confusion matrix:
       0    1
0  18046  103
1    515  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95589644, 'precision': 0.6783533, 'recall': 0.5500547, 'specificity': 0.5500547, 'f1': 0.573011, 'auroc': 0.82781225, 'binary_precision': 0.3943662, 'binary_recall': 0.107279696, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.16867469}
confusion matrix:
      0   1
0  5954  43
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_15.png
early stop counter: 5
val acc:0.9671136736869812, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9592521786689758 / 0.9643656015396118
after epoch: 15,now: 2024-06-21 15:26:32.416353,epoch time: 0:12:47.732702,used: 4:03:17.242821,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9918906, 'precision': 0.98330784, 'recall': 0.9688313, 'specificity': 0.9688313, 'f1': 0.9759308, 'auroc': 0.9955761, 'binary_precision': 0.97280824, 'binary_recall': 0.94040334, 'binary_specificity': 0.9972592, 'binary_f1_score': 0.9563314}
confusion matrix:
       0     1
0  42207   116
1    263  4150
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.7357057, 'recall': 0.6544012, 'specificity': 0.6544012, 'f1': 0.6856662, 'auroc': 0.83756125, 'binary_precision': 0.49519232, 'binary_recall': 0.32037324, 'binary_specificity': 0.9884291, 'binary_f1_score': 0.38904622}
confusion matrix:
       0    1
0  17939  210
1    437  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9546181, 'precision': 0.6876799, 'recall': 0.59336376, 'specificity': 0.59336376, 'f1': 0.6223122, 'auroc': 0.8283653, 'binary_precision': 0.40944883, 'binary_recall': 0.19923371, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.26804125}
confusion matrix:
      0   1
0  5922  75
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_16.png
early stop counter: 6
val acc:0.9655704498291016, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9592521786689758 / 0.9643656015396118
after epoch: 16,now: 2024-06-21 15:38:44.063051,epoch time: 0:12:11.646698,used: 4:15:28.889519,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99233997, 'precision': 0.98612493, 'recall': 0.96868706, 'specificity': 0.96868706, 'f1': 0.9772055, 'auroc': 0.9966927, 'binary_precision': 0.9785327, 'binary_recall': 0.93952435, 'binary_specificity': 0.99784976, 'binary_f1_score': 0.9586319}
confusion matrix:
       0     1
0  42230    91
1    267  4148
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.74518824, 'recall': 0.64131343, 'specificity': 0.64131343, 'f1': 0.67786837, 'auroc': 0.8365659, 'binary_precision': 0.5150685, 'binary_recall': 0.29237947, 'binary_specificity': 0.99024737, 'binary_f1_score': 0.37301588}
confusion matrix:
       0    1
0  17972  177
1    455  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95541704, 'precision': 0.6924117, 'recall': 0.5846189, 'specificity': 0.5846189, 'f1': 0.6145172, 'auroc': 0.82511514, 'binary_precision': 0.41964287, 'binary_recall': 0.18007663, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.2520107}
confusion matrix:
      0   1
0  5932  65
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_17.png
early stop counter: 7
val acc:0.9663686752319336, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9592521786689758 / 0.9643656015396118
after epoch: 17,now: 2024-06-21 15:53:14.126502,epoch time: 0:14:30.063451,used: 4:29:58.952970,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9920618, 'precision': 0.98098785, 'recall': 0.97228074, 'specificity': 0.97228074, 'f1': 0.9765841, 'auroc': 0.9971498, 'binary_precision': 0.9673988, 'binary_recall': 0.9478931, 'binary_specificity': 0.9966684, 'binary_f1_score': 0.9575466}
confusion matrix:
       0     1
0  42181   141
1    230  4184
---- Validation: 
scalar performance:
{'acc': 0.965198, 'precision': 0.7286858, 'recall': 0.62045586, 'specificity': 0.62045586, 'f1': 0.6560266, 'auroc': 0.8350189, 'binary_precision': 0.4834835, 'binary_recall': 0.2503888, 'binary_specificity': 0.9905229, 'binary_f1_score': 0.32991803}
confusion matrix:
       0    1
0  17977  172
1    482  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.751505, 'recall': 0.610607, 'specificity': 0.610607, 'f1': 0.6504404, 'auroc': 0.8307698, 'binary_precision': 0.53571427, 'binary_recall': 0.22988506, 'binary_specificity': 0.991329, 'binary_f1_score': 0.3217158}
confusion matrix:
      0   1
0  5945  52
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_18.png
early stop counter: 8
val acc:0.9651979804039001, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9592521786689758 / 0.9643656015396118
after epoch: 18,now: 2024-06-21 16:06:50.150416,epoch time: 0:13:36.023914,used: 4:43:34.976884,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99293905, 'precision': 0.98277783, 'recall': 0.97571266, 'specificity': 0.97571266, 'f1': 0.9792123, 'auroc': 0.99688315, 'binary_precision': 0.97029704, 'binary_recall': 0.9544734, 'binary_specificity': 0.9969519, 'binary_f1_score': 0.96232015}
confusion matrix:
       0     1
0  42192   129
1    201  4214
---- Validation: 
scalar performance:
{'acc': 0.9653044, 'precision': 0.7321824, 'recall': 0.6460128, 'specificity': 0.6460128, 'f1': 0.67821884, 'auroc': 0.84577405, 'binary_precision': 0.48872182, 'binary_recall': 0.30326593, 'binary_specificity': 0.9887597, 'binary_f1_score': 0.37428018}
confusion matrix:
       0    1
0  17945  204
1    448  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95637584, 'precision': 0.71428293, 'recall': 0.6254305, 'specificity': 0.6254305, 'f1': 0.65660685, 'auroc': 0.8399904, 'binary_precision': 0.46, 'binary_recall': 0.26436782, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.3357664}
confusion matrix:
      0   1
0  5916  81
1   192  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_19.png
early stop counter: 9
val acc:0.9653043746948242, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9592521786689758 / 0.9643656015396118
after epoch: 19,now: 2024-06-21 16:17:34.762978,epoch time: 0:10:44.612562,used: 4:54:19.589446,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9916766, 'precision': 0.978982, 'recall': 0.9720681, 'specificity': 0.9720681, 'f1': 0.97549325, 'auroc': 0.9968526, 'binary_precision': 0.96338934, 'binary_recall': 0.9478931, 'binary_specificity': 0.99624306, 'binary_f1_score': 0.9555784}
confusion matrix:
       0     1
0  42163   159
1    230  4184
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.73630536, 'recall': 0.6776253, 'specificity': 0.6776253, 'f1': 0.70234394, 'auroc': 0.8561541, 'binary_precision': 0.49478078, 'binary_recall': 0.36858475, 'binary_specificity': 0.9866659, 'binary_f1_score': 0.42245987}
confusion matrix:
       0    1
0  17907  242
1    406  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9536593, 'precision': 0.68100893, 'recall': 0.5983605, 'specificity': 0.5983605, 'f1': 0.6255323, 'auroc': 0.8294521, 'binary_precision': 0.39568347, 'binary_recall': 0.21072797, 'binary_specificity': 0.98599297, 'binary_f1_score': 0.275}
confusion matrix:
      0   1
0  5913  84
1   206  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_20.png
early stop counter: 10
val acc:0.9655172228813171, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9592521786689758 / 0.9643656015396118
after epoch: 20,now: 2024-06-21 16:28:43.156027,epoch time: 0:11:08.393049,used: 5:05:27.982495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9912273, 'precision': 0.978651, 'recall': 0.9696957, 'specificity': 0.9696957, 'f1': 0.9741199, 'auroc': 0.9958339, 'binary_precision': 0.96322, 'binary_recall': 0.9431484, 'binary_specificity': 0.996243, 'binary_f1_score': 0.9530785}
confusion matrix:
       0     1
0  42162   159
1    251  4164
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.7350304, 'recall': 0.6528735, 'specificity': 0.6528735, 'f1': 0.6843119, 'auroc': 0.8495362, 'binary_precision': 0.49394673, 'binary_recall': 0.31726283, 'binary_specificity': 0.9884842, 'binary_f1_score': 0.38636363}
confusion matrix:
       0    1
0  17940  209
1    439  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.7236583, 'recall': 0.6240984, 'specificity': 0.6240984, 'f1': 0.6577133, 'auroc': 0.8381715, 'binary_precision': 0.47887325, 'binary_recall': 0.2605364, 'binary_specificity': 0.98766047, 'binary_f1_score': 0.33746898}
confusion matrix:
      0   1
0  5923  74
1   193  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_21.png
early stop counter: 11
val acc:0.9655172228813171, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9592521786689758 / 0.9643656015396118
after epoch: 21,now: 2024-06-21 16:39:51.151410,epoch time: 0:11:07.995383,used: 5:16:35.977878,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9919548, 'precision': 0.9742092, 'recall': 0.97901547, 'specificity': 0.97901547, 'f1': 0.97659695, 'auroc': 0.99761105, 'binary_precision': 0.95227426, 'binary_recall': 0.96306366, 'binary_specificity': 0.9949673, 'binary_f1_score': 0.95763856}
confusion matrix:
       0     1
0  42110   213
1    163  4250
---- Validation: 
scalar performance:
{'acc': 0.96482545, 'precision': 0.73055977, 'recall': 0.6870179, 'specificity': 0.6870179, 'f1': 0.7062577, 'auroc': 0.8574704, 'binary_precision': 0.48262548, 'binary_recall': 0.3888025, 'binary_specificity': 0.98523337, 'binary_f1_score': 0.43066323}
confusion matrix:
       0    1
0  17881  268
1    393  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95605624, 'precision': 0.70699775, 'recall': 0.60694045, 'specificity': 0.60694045, 'f1': 0.6387851, 'auroc': 0.83324116, 'binary_precision': 0.4469697, 'binary_recall': 0.22605364, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.30025443}
confusion matrix:
      0   1
0  5924  73
1   202  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_22.png
early stop counter: 12
val acc:0.964825451374054, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9592521786689758 / 0.9643656015396118
after epoch: 22,now: 2024-06-21 16:51:03.047967,epoch time: 0:11:11.896557,used: 5:27:47.874435,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99304605, 'precision': 0.98304677, 'recall': 0.976076, 'specificity': 0.976076, 'f1': 0.9795294, 'auroc': 0.9971557, 'binary_precision': 0.9707643, 'binary_recall': 0.95515287, 'binary_specificity': 0.99699914, 'binary_f1_score': 0.9628953}
confusion matrix:
       0     1
0  42194   127
1    198  4217
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7540191, 'recall': 0.6326158, 'specificity': 0.6326158, 'f1': 0.6724028, 'auroc': 0.83235663, 'binary_precision': 0.53333336, 'binary_recall': 0.27371696, 'binary_specificity': 0.9915147, 'binary_f1_score': 0.36176774}
confusion matrix:
       0    1
0  17995  154
1    467  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9539789, 'precision': 0.6725275, 'recall': 0.5765392, 'specificity': 0.5765392, 'f1': 0.6031136, 'auroc': 0.8191375, 'binary_precision': 0.38053098, 'binary_recall': 0.16475096, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.22994652}
confusion matrix:
      0   1
0  5927  70
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_23.png
early stop counter: 13
val acc:0.9669540524482727, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9592521786689758 / 0.9643656015396118
after epoch: 23,now: 2024-06-21 17:01:55.625274,epoch time: 0:10:52.577307,used: 5:38:40.451742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99287486, 'precision': 0.98882115, 'recall': 0.96917856, 'specificity': 0.96917856, 'f1': 0.9787466, 'auroc': 0.99652, 'binary_precision': 0.9838748, 'binary_recall': 0.93996376, 'binary_specificity': 0.9983933, 'binary_f1_score': 0.96141815}
confusion matrix:
       0     1
0  42254    68
1    265  4149
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.75343895, 'recall': 0.62205994, 'specificity': 0.62205994, 'f1': 0.66256416, 'auroc': 0.843684, 'binary_precision': 0.53289473, 'binary_recall': 0.251944, 'binary_specificity': 0.9921759, 'binary_f1_score': 0.34213302}
confusion matrix:
       0    1
0  18007  142
1    481  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95653564, 'precision': 0.6968212, 'recall': 0.56138223, 'specificity': 0.56138223, 'f1': 0.58883053, 'auroc': 0.8220693, 'binary_precision': 0.43037975, 'binary_recall': 0.1302682, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.2}
confusion matrix:
      0   1
0  5952  45
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_24.png
early stop counter: 14
val acc:0.9668475985527039, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9592521786689758 / 0.9643656015396118
after epoch: 24,now: 2024-06-21 17:12:50.162818,epoch time: 0:10:54.537544,used: 5:49:34.989286,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9919334, 'precision': 0.9775766, 'recall': 0.97515225, 'specificity': 0.97515225, 'f1': 0.97636056, 'auroc': 0.9972776, 'binary_precision': 0.9598997, 'binary_recall': 0.95446306, 'binary_specificity': 0.9958414, 'binary_f1_score': 0.9571737}
confusion matrix:
       0     1
0  42146   176
1    201  4213
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.7374195, 'recall': 0.65223366, 'specificity': 0.65223366, 'f1': 0.68451965, 'auroc': 0.84698296, 'binary_precision': 0.4987715, 'binary_recall': 0.31570762, 'binary_specificity': 0.9887597, 'binary_f1_score': 0.3866667}
confusion matrix:
       0    1
0  17945  204
1    440  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9538191, 'precision': 0.67415285, 'recall': 0.5819528, 'specificity': 0.5819528, 'f1': 0.60882723, 'auroc': 0.8282962, 'binary_precision': 0.38333333, 'binary_recall': 0.17624521, 'binary_specificity': 0.98766047, 'binary_f1_score': 0.24146983}
confusion matrix:
      0   1
0  5923  74
1   215  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_25.png
early stop counter: 15
val acc:0.9657300710678101, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9592521786689758 / 0.9643656015396118
after epoch: 25,now: 2024-06-21 17:23:29.257796,epoch time: 0:10:39.094978,used: 6:00:14.084264,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99298185, 'precision': 0.9873587, 'recall': 0.97127306, 'specificity': 0.97127306, 'f1': 0.97914594, 'auroc': 0.99727905, 'binary_precision': 0.98048437, 'binary_recall': 0.94450736, 'binary_specificity': 0.9980388, 'binary_f1_score': 0.96215963}
confusion matrix:
       0     1
0  42238    83
1    245  4170
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.74827766, 'recall': 0.62189466, 'specificity': 0.62189466, 'f1': 0.6614039, 'auroc': 0.8434711, 'binary_precision': 0.5225806, 'binary_recall': 0.251944, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.339979}
confusion matrix:
       0    1
0  18001  148
1    481  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.71898615, 'recall': 0.55288756, 'specificity': 0.55288756, 'f1': 0.5792371, 'auroc': 0.822546, 'binary_precision': 0.47540984, 'binary_recall': 0.11111111, 'binary_specificity': 0.994664, 'binary_f1_score': 0.18012422}
confusion matrix:
      0   1
0  5965  32
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_26.png
early stop counter: 16
val acc:0.9665282964706421, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9592521786689758 / 0.9643656015396118
after epoch: 26,now: 2024-06-21 17:34:26.230618,epoch time: 0:10:56.972822,used: 6:11:11.057086,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99289626, 'precision': 0.98197746, 'recall': 0.9762976, 'specificity': 0.9762976, 'f1': 0.97911626, 'auroc': 0.99741435, 'binary_precision': 0.96855634, 'binary_recall': 0.95583236, 'binary_specificity': 0.9967628, 'binary_f1_score': 0.9621523}
confusion matrix:
       0     1
0  42184   137
1    195  4220
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.74168366, 'recall': 0.6359253, 'specificity': 0.6359253, 'f1': 0.6724754, 'auroc': 0.84230256, 'binary_precision': 0.50842696, 'binary_recall': 0.281493, 'binary_specificity': 0.9903576, 'binary_f1_score': 0.36236235}
confusion matrix:
       0    1
0  17974  175
1    462  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9550975, 'precision': 0.688725, 'recall': 0.5844522, 'specificity': 0.5844522, 'f1': 0.61376095, 'auroc': 0.82521224, 'binary_precision': 0.4122807, 'binary_recall': 0.18007663, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.25066668}
confusion matrix:
      0   1
0  5930  67
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_27.png
early stop counter: 17
val acc:0.9661026000976562, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9592521786689758 / 0.9643656015396118
after epoch: 27,now: 2024-06-21 17:45:24.452817,epoch time: 0:10:58.222199,used: 6:22:09.279285,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9933028, 'precision': 0.9866619, 'recall': 0.9738791, 'specificity': 0.9738791, 'f1': 0.98016334, 'auroc': 0.99796927, 'binary_precision': 0.97852975, 'binary_recall': 0.94993204, 'binary_specificity': 0.9978262, 'binary_f1_score': 0.9640188}
confusion matrix:
       0     1
0  42230    92
1    221  4193
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.7328435, 'recall': 0.62734413, 'specificity': 0.62734413, 'f1': 0.6630235, 'auroc': 0.84378064, 'binary_precision': 0.4913295, 'binary_recall': 0.2643857, 'binary_specificity': 0.9903025, 'binary_f1_score': 0.3437816}
confusion matrix:
       0    1
0  17973  176
1    473  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9547779, 'precision': 0.68135047, 'recall': 0.5769561, 'specificity': 0.5769561, 'f1': 0.6048822, 'auroc': 0.8285214, 'binary_precision': 0.39814815, 'binary_recall': 0.16475096, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.23306234}
confusion matrix:
      0   1
0  5932  65
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_28.png
early stop counter: 18
val acc:0.9654640555381775, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9592521786689758 / 0.9643656015396118
after epoch: 28,now: 2024-06-21 17:58:50.583662,epoch time: 0:13:26.130845,used: 6:35:35.410130,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9925967, 'precision': 0.9779062, 'recall': 0.9788752, 'specificity': 0.9788752, 'f1': 0.9783901, 'auroc': 0.99790734, 'binary_precision': 0.9597831, 'binary_recall': 0.9619565, 'binary_specificity': 0.99579394, 'binary_f1_score': 0.96086854}
confusion matrix:
       0     1
0  42142   178
1    168  4248
---- Validation: 
scalar performance:
{'acc': 0.9641869, 'precision': 0.7229617, 'recall': 0.66793597, 'specificity': 0.66793597, 'f1': 0.6911272, 'auroc': 0.8448541, 'binary_precision': 0.46875, 'binary_recall': 0.34992224, 'binary_specificity': 0.98594964, 'binary_f1_score': 0.40071237}
confusion matrix:
       0    1
0  17894  255
1    418  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9549377, 'precision': 0.6963363, 'recall': 0.60818917, 'specificity': 0.60818917, 'f1': 0.6376143, 'auroc': 0.8325727, 'binary_precision': 0.42553192, 'binary_recall': 0.22988506, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.29850748}
confusion matrix:
      0   1
0  5916  81
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_29.png
early stop counter: 19
val acc:0.9641869068145752, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9592521786689758 / 0.9643656015396118
after epoch: 29,now: 2024-06-21 18:09:54.657452,epoch time: 0:11:04.073790,used: 6:46:39.483920,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99306744, 'precision': 0.98286206, 'recall': 0.9763822, 'specificity': 0.9763822, 'f1': 0.97959447, 'auroc': 0.9976488, 'binary_precision': 0.97032434, 'binary_recall': 0.9558124, 'binary_specificity': 0.996952, 'binary_f1_score': 0.9630137}
confusion matrix:
       0     1
0  42194   129
1    195  4218
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.7462511, 'recall': 0.65561956, 'specificity': 0.65561956, 'f1': 0.6896552, 'auroc': 0.8545057, 'binary_precision': 0.5162095, 'binary_recall': 0.32192847, 'binary_specificity': 0.9893107, 'binary_f1_score': 0.39655173}
confusion matrix:
       0    1
0  17955  194
1    436  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.7122005, 'recall': 0.5908663, 'specificity': 0.5908663, 'f1': 0.6240204, 'auroc': 0.83332264, 'binary_precision': 0.4587156, 'binary_recall': 0.19157088, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.2702703}
confusion matrix:
      0   1
0  5938  59
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_30.png
early stop counter: 20
val acc:0.9664750695228577, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9592521786689758 / 0.9643656015396118
after epoch: 30,now: 2024-06-21 18:20:58.474091,epoch time: 0:11:03.816639,used: 6:57:43.300559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 30 with time: 6:57:43.300559 at 2024-06-21 18:20:58.474091
persisted model performance metric: 

scalar performance:
{'acc': 0.9592522, 'precision': 0.75396514, 'recall': 0.5682966, 'specificity': 0.5682966, 'f1': 0.602, 'auroc': 0.818831, 'binary_precision': 0.5441176, 'binary_recall': 0.14176245, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.22492403}
confusion matrix:
      0   1
0  5966  31
1   224  37
oracle model performance metric: 

scalar performance:
{'acc': 0.9643656, 'precision': 0.7981726, 'recall': 0.67907226, 'specificity': 0.67907226, 'f1': 0.72211117, 'auroc': 0.80876136, 'binary_precision': 0.6233766, 'binary_recall': 0.3678161, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.4626506}
confusion matrix:
      0   1
0  5939  58
1   165  96
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204979 KiB | 640729 KiB |    989 TiB |    989 TiB |
|       from large pool | 167936 KiB | 568000 KiB |    988 TiB |    988 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204979 KiB | 640729 KiB |    989 TiB |    989 TiB |
|       from large pool | 167936 KiB | 568000 KiB |    988 TiB |    988 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 632296 KiB |    986 TiB |    986 TiB |
|       from large pool | 165120 KiB | 560704 KiB |    986 TiB |    986 TiB |
|       from small pool |  35968 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB | 755712 KiB | 755712 KiB |      0 B   |
|       from large pool | 679936 KiB | 679936 KiB | 679936 KiB |      0 B   |
|       from small pool |  75776 KiB |  75776 KiB |  75776 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  79692 KiB | 215750 KiB | 399244 GiB | 399244 GiB |
|       from large pool |  67584 KiB | 213792 KiB | 398925 GiB | 398925 GiB |
|       from small pool |  12108 KiB |  13958 KiB |    319 GiB |    319 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3252    |    6591    |   87769 K  |   87766 K  |
|       from large pool |      36    |      76    |   35512 K  |   35512 K  |
|       from small pool |    3216    |    6554    |   52257 K  |   52253 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3252    |    6591    |   87769 K  |   87766 K  |
|       from large pool |      36    |      76    |   35512 K  |   35512 K  |
|       from small pool |    3216    |    6554    |   52257 K  |   52253 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      39    |    2938    |   39435 K  |   39435 K  |
|       from large pool |       7    |      11    |   12697 K  |   12697 K  |
|       from small pool |      32    |    2931    |   26738 K  |   26738 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    988 TiB |    988 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    988 TiB |    988 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |    986 TiB |    986 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    986 TiB |    986 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB | 755712 KiB | 471040 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 215750 KiB | 399245 GiB | 399244 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 398925 GiB | 398925 GiB |
|       from small pool |      0 KiB |  19703 KiB |    319 GiB |    319 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6591    |   87769 K  |   87769 K  |
|       from large pool |       2    |      76    |   35512 K  |   35512 K  |
|       from small pool |       0    |    6554    |   52257 K  |   52257 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6591    |   87769 K  |   87769 K  |
|       from large pool |       2    |      76    |   35512 K  |   35512 K  |
|       from small pool |       0    |    6554    |   52257 K  |   52257 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      51    |      17    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2938    |   39437 K  |   39437 K  |
|       from large pool |       3    |      13    |   12697 K  |   12697 K  |
|       from small pool |       0    |    2931    |   26739 K  |   26739 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    988 TiB |    988 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |    989 TiB |    989 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    988 TiB |    988 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |    986 TiB |    986 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    986 TiB |    986 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB | 755712 KiB | 471040 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 215750 KiB | 399245 GiB | 399244 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 398925 GiB | 398925 GiB |
|       from small pool |      0 KiB |  19703 KiB |    319 GiB |    319 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6591    |   87769 K  |   87769 K  |
|       from large pool |       2    |      76    |   35512 K  |   35512 K  |
|       from small pool |       0    |    6554    |   52257 K  |   52257 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6591    |   87769 K  |   87769 K  |
|       from large pool |       2    |      76    |   35512 K  |   35512 K  |
|       from small pool |       0    |    6554    |   52257 K  |   52257 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      51    |      17    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2938    |   39437 K  |   39437 K  |
|       from large pool |       3    |      13    |   12697 K  |   12697 K  |
|       from small pool |       0    |    2931    |   26739 K  |   26739 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820

 Experiment start at: 2024-06-21 18:25:38.720781
before training, model accuracy: 0.14647115767002106
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97978, 'precision': 0.9601892, 'recall': 0.9162054, 'specificity': 0.9162054, 'f1': 0.9368161, 'auroc': 0.98597527, 'binary_precision': 0.93670887, 'binary_recall': 0.8381877, 'binary_specificity': 0.99422306, 'binary_f1_score': 0.8847139}
confusion matrix:
       0     1
0  42165   245
1    700  3626
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.7460823, 'recall': 0.6262468, 'specificity': 0.6262468, 'f1': 0.664864, 'auroc': 0.76824224, 'binary_precision': 0.51917404, 'binary_recall': 0.2615156, 'binary_specificity': 0.990978, 'binary_f1_score': 0.3478261}
confusion matrix:
       0    1
0  17904  163
1    497  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.7861248, 'recall': 0.63074726, 'specificity': 0.63074726, 'f1': 0.6763663, 'auroc': 0.7936548, 'binary_precision': 0.6034483, 'binary_recall': 0.26923078, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.37234044}
confusion matrix:
      0   1
0  5900  46
1   190  70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 18:36:46.009712,epoch time: 0:11:07.288931,used: 0:11:07.288931,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98444456, 'precision': 0.96702635, 'recall': 0.9385995, 'specificity': 0.9385995, 'f1': 0.95225346, 'auroc': 0.99088675, 'binary_precision': 0.94597274, 'binary_recall': 0.88233936, 'binary_specificity': 0.9948597, 'binary_f1_score': 0.9130487}
confusion matrix:
       0     1
0  42192   218
1    509  3817
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.73524153, 'recall': 0.64297044, 'specificity': 0.64297044, 'f1': 0.6765889, 'auroc': 0.7960244, 'binary_precision': 0.49627793, 'binary_recall': 0.2971768, 'binary_specificity': 0.98876405, 'binary_f1_score': 0.3717472}
confusion matrix:
       0    1
0  17864  203
1    473  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96777314, 'precision': 0.84113467, 'recall': 0.69262207, 'specificity': 0.69262207, 'f1': 0.7441475, 'auroc': 0.8354155, 'binary_precision': 0.7083333, 'binary_recall': 0.3923077, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.50495046}
confusion matrix:
      0    1
0  5904   42
1   158  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_2.png
new oracle model saved
early stop counter: 1
val acc:0.9639274477958679, best validation acc: 0.9647812247276306, corresponding to test acc:                         0.9619722962379456 / 0.9677731394767761
after epoch: 2,now: 2024-06-21 18:49:41.682574,epoch time: 0:12:55.672862,used: 0:24:02.961793,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9862205, 'precision': 0.96842957, 'recall': 0.9482852, 'specificity': 0.9482852, 'f1': 0.95807946, 'auroc': 0.99217325, 'binary_precision': 0.94683176, 'binary_recall': 0.9017341, 'binary_specificity': 0.9948363, 'binary_f1_score': 0.9237329}
confusion matrix:
       0     1
0  42192   219
1    425  3900
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.7428733, 'recall': 0.641872, 'specificity': 0.641872, 'f1': 0.67767656, 'auroc': 0.8164772, 'binary_precision': 0.5116279, 'binary_recall': 0.29420504, 'binary_specificity': 0.98953897, 'binary_f1_score': 0.3735849}
confusion matrix:
       0    1
0  17878  189
1    475  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.8135808, 'recall': 0.6878509, 'specificity': 0.6878509, 'f1': 0.733255, 'auroc': 0.85205454, 'binary_precision': 0.6535948, 'binary_recall': 0.3846154, 'binary_specificity': 0.9910864, 'binary_f1_score': 0.48426154}
confusion matrix:
      0    1
0  5893   53
1   160  100
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_3.png
early stop counter: 2
val acc:0.9645677804946899, best validation acc: 0.9647812247276306, corresponding to test acc:                         0.9619722962379456 / 0.9677731394767761
after epoch: 3,now: 2024-06-21 19:01:26.109343,epoch time: 0:11:44.426769,used: 0:35:47.388562,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98681957, 'precision': 0.95825356, 'recall': 0.96376526, 'specificity': 0.96376526, 'f1': 0.9609886, 'auroc': 0.9944793, 'binary_precision': 0.92309445, 'binary_recall': 0.9354764, 'binary_specificity': 0.99205416, 'binary_f1_score': 0.9292442}
confusion matrix:
       0     1
0  42075   337
1    279  4045
---- Validation: 
scalar performance:
{'acc': 0.96286017, 'precision': 0.7273957, 'recall': 0.6781803, 'specificity': 0.6781803, 'f1': 0.6994391, 'auroc': 0.8334691, 'binary_precision': 0.47801146, 'binary_recall': 0.37147102, 'binary_specificity': 0.98488957, 'binary_f1_score': 0.4180602}
confusion matrix:
       0    1
0  17794  273
1    423  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.7893988, 'recall': 0.6942819, 'specificity': 0.6942819, 'f1': 0.7313918, 'auroc': 0.8543774, 'binary_precision': 0.60465115, 'binary_recall': 0.4, 'binary_specificity': 0.9885637, 'binary_f1_score': 0.48148146}
confusion matrix:
      0    1
0  5878   68
1   156  104
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_4.png
early stop counter: 3
val acc:0.9628601670265198, best validation acc: 0.9647812247276306, corresponding to test acc:                         0.9619722962379456 / 0.9677731394767761
after epoch: 4,now: 2024-06-21 19:13:28.382915,epoch time: 0:12:02.273572,used: 0:47:49.662134,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.989216, 'precision': 0.97825897, 'recall': 0.9566934, 'specificity': 0.9566934, 'f1': 0.9671646, 'auroc': 0.9936853, 'binary_precision': 0.9649635, 'binary_recall': 0.91678226, 'binary_specificity': 0.99660456, 'binary_f1_score': 0.94025606}
confusion matrix:
       0     1
0  42266   144
1    360  3966
---- Validation: 
scalar performance:
{'acc': 0.96600854, 'precision': 0.76342213, 'recall': 0.63475126, 'specificity': 0.63475126, 'f1': 0.6762319, 'auroc': 0.82472605, 'binary_precision': 0.5532544, 'binary_recall': 0.2778603, 'binary_specificity': 0.99164224, 'binary_f1_score': 0.3699307}
confusion matrix:
       0    1
0  17916  151
1    486  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.8303627, 'recall': 0.6432948, 'specificity': 0.6432948, 'f1': 0.6963538, 'auroc': 0.8450327, 'binary_precision': 0.6909091, 'binary_recall': 0.2923077, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.41081083}
confusion matrix:
      0   1
0  5912  34
1   184  76
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_5.png
better model found
persisted
after epoch: 5,now: 2024-06-21 19:24:46.128985,epoch time: 0:11:17.746070,used: 0:59:07.408204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9883174, 'precision': 0.9641625, 'recall': 0.96647346, 'specificity': 0.96647346, 'f1': 0.9653144, 'auroc': 0.99498177, 'binary_precision': 0.93448275, 'binary_recall': 0.9396671, 'binary_specificity': 0.9932799, 'binary_f1_score': 0.9370678}
confusion matrix:
       0     1
0  42125   285
1    261  4065
---- Validation: 
scalar performance:
{'acc': 0.96376735, 'precision': 0.7349754, 'recall': 0.67006755, 'specificity': 0.67006755, 'f1': 0.6967144, 'auroc': 0.82920384, 'binary_precision': 0.49377593, 'binary_recall': 0.3536404, 'binary_specificity': 0.9864947, 'binary_f1_score': 0.4121212}
confusion matrix:
       0    1
0  17823  244
1    435  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.7415328, 'recall': 0.65481126, 'specificity': 0.65481126, 'f1': 0.68743587, 'auroc': 0.83685994, 'binary_precision': 0.5121951, 'binary_recall': 0.32307693, 'binary_specificity': 0.98654556, 'binary_f1_score': 0.3962264}
confusion matrix:
      0   1
0  5866  80
1   176  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_6.png
early stop counter: 1
val acc:0.9637673497200012, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9648727178573608 / 0.9677731394767761
after epoch: 6,now: 2024-06-21 19:36:07.151005,epoch time: 0:11:21.022020,used: 1:10:28.430224,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9894514, 'precision': 0.9744681, 'recall': 0.96211636, 'specificity': 0.96211636, 'f1': 0.96818995, 'auroc': 0.99560475, 'binary_precision': 0.9562009, 'binary_recall': 0.9285714, 'binary_specificity': 0.9956614, 'binary_f1_score': 0.9421837}
confusion matrix:
       0     1
0  42226   184
1    309  4017
---- Validation: 
scalar performance:
{'acc': 0.9653148, 'precision': 0.75205743, 'recall': 0.6479816, 'specificity': 0.6479816, 'f1': 0.6850495, 'auroc': 0.8497474, 'binary_precision': 0.529563, 'binary_recall': 0.3060921, 'binary_specificity': 0.989871, 'binary_f1_score': 0.38794726}
confusion matrix:
       0    1
0  17884  183
1    467  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.7605201, 'recall': 0.60390824, 'specificity': 0.60390824, 'f1': 0.64479357, 'auroc': 0.8558861, 'binary_precision': 0.55445546, 'binary_recall': 0.21538462, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.31024933}
confusion matrix:
      0   1
0  5901  45
1   204  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_7.png
early stop counter: 2
val acc:0.9653148055076599, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9648727178573608 / 0.9677731394767761
after epoch: 7,now: 2024-06-21 19:48:51.045764,epoch time: 0:12:43.894759,used: 1:23:12.324983,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9901575, 'precision': 0.97885644, 'recall': 0.9618827, 'specificity': 0.9618827, 'f1': 0.97017753, 'auroc': 0.99602175, 'binary_precision': 0.96511066, 'binary_recall': 0.92718446, 'binary_specificity': 0.996581, 'binary_f1_score': 0.94576746}
confusion matrix:
       0     1
0  42265   145
1    315  4011
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.7604544, 'recall': 0.64327914, 'specificity': 0.64327914, 'f1': 0.6831326, 'auroc': 0.83572435, 'binary_precision': 0.5467033, 'binary_recall': 0.29569092, 'binary_specificity': 0.9908673, 'binary_f1_score': 0.3837994}
confusion matrix:
       0    1
0  17902  165
1    474  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.7677672, 'recall': 0.6078385, 'specificity': 0.6078385, 'f1': 0.65001357, 'auroc': 0.84474796, 'binary_precision': 0.5686275, 'binary_recall': 0.22307692, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.320442}
confusion matrix:
      0   1
0  5902  44
1   202  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_8.png
early stop counter: 3
val acc:0.965901792049408, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9648727178573608 / 0.9677731394767761
after epoch: 8,now: 2024-06-21 20:01:25.089508,epoch time: 0:12:34.043744,used: 1:35:46.368727,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99032867, 'precision': 0.9802942, 'recall': 0.9614581, 'specificity': 0.9614581, 'f1': 0.97064006, 'auroc': 0.99475706, 'binary_precision': 0.96810055, 'binary_recall': 0.92602867, 'binary_specificity': 0.9968875, 'binary_f1_score': 0.94659734}
confusion matrix:
       0     1
0  42278   132
1    320  4006
---- Validation: 
scalar performance:
{'acc': 0.96542156, 'precision': 0.7535441, 'recall': 0.6466064, 'specificity': 0.6466064, 'f1': 0.6842866, 'auroc': 0.8333554, 'binary_precision': 0.53263706, 'binary_recall': 0.30312034, 'binary_specificity': 0.99009246, 'binary_f1_score': 0.38636363}
confusion matrix:
       0    1
0  17888  179
1    469  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9545601, 'precision': 0.6935002, 'recall': 0.60481125, 'specificity': 0.60481125, 'f1': 0.6339923, 'auroc': 0.8419008, 'binary_precision': 0.42028984, 'binary_recall': 0.22307692, 'binary_specificity': 0.98654556, 'binary_f1_score': 0.2914573}
confusion matrix:
      0   1
0  5866  80
1   202  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_9.png
early stop counter: 4
val acc:0.9654215574264526, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9648727178573608 / 0.9677731394767761
after epoch: 9,now: 2024-06-21 20:12:42.640957,epoch time: 0:11:17.551449,used: 1:47:03.920176,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99109894, 'precision': 0.9756624, 'recall': 0.9711138, 'specificity': 0.9711138, 'f1': 0.97337437, 'auroc': 0.9968303, 'binary_precision': 0.9567656, 'binary_recall': 0.9465896, 'binary_specificity': 0.99563795, 'binary_f1_score': 0.9516504}
confusion matrix:
       0     1
0  42226   185
1    231  4094
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.7503437, 'recall': 0.65436363, 'specificity': 0.65436363, 'f1': 0.68974954, 'auroc': 0.8343718, 'binary_precision': 0.5256724, 'binary_recall': 0.31946507, 'binary_specificity': 0.98926216, 'binary_f1_score': 0.39741215}
confusion matrix:
       0    1
0  17873  194
1    458  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.74530053, 'recall': 0.6347506, 'specificity': 0.6347506, 'f1': 0.6719272, 'auroc': 0.8444326, 'binary_precision': 0.5214286, 'binary_recall': 0.28076923, 'binary_specificity': 0.9887319, 'binary_f1_score': 0.365}
confusion matrix:
      0   1
0  5879  67
1   187  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_10.png
early stop counter: 5
val acc:0.965208113193512, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9648727178573608 / 0.9677731394767761
after epoch: 10,now: 2024-06-21 20:24:17.488479,epoch time: 0:11:34.847522,used: 1:58:38.767698,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99047846, 'precision': 0.9733794, 'recall': 0.96974003, 'specificity': 0.96974003, 'f1': 0.9715508, 'auroc': 0.9963047, 'binary_precision': 0.95243645, 'binary_recall': 0.94429034, 'binary_specificity': 0.9951898, 'binary_f1_score': 0.94834584}
confusion matrix:
       0     1
0  42206   204
1    241  4085
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.7434422, 'recall': 0.6626424, 'specificity': 0.6626424, 'f1': 0.6941065, 'auroc': 0.84741765, 'binary_precision': 0.5112613, 'binary_recall': 0.33729568, 'binary_specificity': 0.9879891, 'binary_f1_score': 0.40644583}
confusion matrix:
       0    1
0  17850  217
1    446  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.73081267, 'recall': 0.6285609, 'specificity': 0.6285609, 'f1': 0.6632218, 'auroc': 0.85033137, 'binary_precision': 0.49295774, 'binary_recall': 0.26923078, 'binary_specificity': 0.987891, 'binary_f1_score': 0.3482587}
confusion matrix:
      0   1
0  5874  72
1   190  70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_11.png
early stop counter: 6
val acc:0.9646211266517639, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9648727178573608 / 0.9677731394767761
after epoch: 11,now: 2024-06-21 20:34:53.274189,epoch time: 0:10:35.785710,used: 2:09:14.553408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99086356, 'precision': 0.9762392, 'recall': 0.96900487, 'specificity': 0.96900487, 'f1': 0.9725872, 'auroc': 0.99669576, 'binary_precision': 0.95836276, 'binary_recall': 0.94218314, 'binary_specificity': 0.99582666, 'binary_f1_score': 0.9502041}
confusion matrix:
       0     1
0  42235   177
1    250  4074
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.7574691, 'recall': 0.67692435, 'specificity': 0.67692435, 'f1': 0.70892334, 'auroc': 0.86205536, 'binary_precision': 0.53829324, 'binary_recall': 0.36552748, 'binary_specificity': 0.98832124, 'binary_f1_score': 0.43539822}
confusion matrix:
       0    1
0  17856  211
1    427  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.7185371, 'recall': 0.60239464, 'specificity': 0.60239464, 'f1': 0.6366627, 'auroc': 0.8536188, 'binary_precision': 0.47058824, 'binary_recall': 0.21538462, 'binary_specificity': 0.9894046, 'binary_f1_score': 0.2955145}
confusion matrix:
      0   1
0  5883  63
1   204  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_12.png
early stop counter: 7
val acc:0.9659551978111267, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9648727178573608 / 0.9677731394767761
after epoch: 12,now: 2024-06-21 20:47:04.143459,epoch time: 0:12:10.869270,used: 2:21:25.422678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9913129, 'precision': 0.97545636, 'recall': 0.9726908, 'specificity': 0.9726908, 'f1': 0.9740685, 'auroc': 0.9971963, 'binary_precision': 0.9560261, 'binary_recall': 0.94983816, 'binary_specificity': 0.9955435, 'binary_f1_score': 0.95292205}
confusion matrix:
       0     1
0  42221   189
1    217  4109
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.73985827, 'recall': 0.6546084, 'specificity': 0.6546084, 'f1': 0.68699044, 'auroc': 0.8500757, 'binary_precision': 0.5046729, 'binary_recall': 0.32095096, 'binary_specificity': 0.9882659, 'binary_f1_score': 0.39237055}
confusion matrix:
       0    1
0  17855  212
1    457  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.7223023, 'recall': 0.6007238, 'specificity': 0.6007238, 'f1': 0.635659, 'auroc': 0.8447622, 'binary_precision': 0.47826087, 'binary_recall': 0.21153846, 'binary_specificity': 0.9899092, 'binary_f1_score': 0.29333335}
confusion matrix:
      0   1
0  5886  60
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_13.png
early stop counter: 8
val acc:0.9643009901046753, best validation acc: 0.9660085439682007, corresponding to test acc:                         0.9648727178573608 / 0.9677731394767761
after epoch: 13,now: 2024-06-21 20:58:02.105132,epoch time: 0:10:57.961673,used: 2:32:23.384351,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.991805, 'precision': 0.9816607, 'recall': 0.96912175, 'specificity': 0.96912175, 'f1': 0.97528756, 'auroc': 0.99616385, 'binary_precision': 0.969293, 'binary_recall': 0.94128525, 'binary_specificity': 0.99695826, 'binary_f1_score': 0.95508385}
confusion matrix:
       0     1
0  42281   129
1    254  4072
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.7769494, 'recall': 0.6330206, 'specificity': 0.6330206, 'f1': 0.6773357, 'auroc': 0.8347688, 'binary_precision': 0.58044165, 'binary_recall': 0.27340266, 'binary_specificity': 0.9926385, 'binary_f1_score': 0.37171718}
confusion matrix:
       0    1
0  17934  133
1    489  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95520467, 'precision': 0.68607247, 'recall': 0.57204586, 'specificity': 0.57204586, 'f1': 0.6002004, 'auroc': 0.83223516, 'binary_precision': 0.40816328, 'binary_recall': 0.15384616, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.22346368}
confusion matrix:
      0   1
0  5888  58
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_14.png
better model found
persisted
after epoch: 14,now: 2024-06-21 21:08:53.216242,epoch time: 0:10:51.111110,used: 2:43:14.495461,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99161243, 'precision': 0.9794311, 'recall': 0.9702483, 'specificity': 0.9702483, 'f1': 0.97478396, 'auroc': 0.9961345, 'binary_precision': 0.96455574, 'binary_recall': 0.9440333, 'binary_specificity': 0.99646324, 'binary_f1_score': 0.9541842}
confusion matrix:
       0     1
0  42262   150
1    242  4082
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.75659704, 'recall': 0.63164115, 'specificity': 0.63164115, 'f1': 0.671973, 'auroc': 0.8502254, 'binary_precision': 0.539823, 'binary_recall': 0.27191678, 'binary_specificity': 0.9913655, 'binary_f1_score': 0.36166006}
confusion matrix:
       0    1
0  17911  156
1    490  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95617145, 'precision': 0.694054, 'recall': 0.56151646, 'specificity': 0.56151646, 'f1': 0.58873427, 'auroc': 0.8364264, 'binary_precision': 0.425, 'binary_recall': 0.13076924, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.2}
confusion matrix:
      0   1
0  5900  46
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_15.png
early stop counter: 1
val acc:0.9655283093452454, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9552046656608582 / 0.9677731394767761
after epoch: 15,now: 2024-06-21 21:19:31.045025,epoch time: 0:10:37.828783,used: 2:53:52.324244,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9915269, 'precision': 0.97657174, 'recall': 0.9728087, 'specificity': 0.9728087, 'f1': 0.9746809, 'auroc': 0.9970181, 'binary_precision': 0.9582556, 'binary_recall': 0.94983816, 'binary_specificity': 0.9957793, 'binary_f1_score': 0.9540283}
confusion matrix:
       0     1
0  42231   179
1    217  4109
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.7422626, 'recall': 0.65829545, 'specificity': 0.65829545, 'f1': 0.6904973, 'auroc': 0.8599695, 'binary_precision': 0.5092166, 'binary_recall': 0.32838038, 'binary_specificity': 0.98821056, 'binary_f1_score': 0.39927733}
confusion matrix:
       0    1
0  17854  213
1    452  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9518208, 'precision': 0.63666046, 'recall': 0.5555681, 'specificity': 0.5555681, 'f1': 0.5757466, 'auroc': 0.8353183, 'binary_precision': 0.3106796, 'binary_recall': 0.12307692, 'binary_specificity': 0.9880592, 'binary_f1_score': 0.17630854}
confusion matrix:
      0   1
0  5875  71
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_16.png
early stop counter: 2
val acc:0.964514434337616, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9552046656608582 / 0.9677731394767761
after epoch: 16,now: 2024-06-21 21:30:10.798345,epoch time: 0:10:39.753320,used: 3:04:32.077564,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9922116, 'precision': 0.98027384, 'recall': 0.9730822, 'specificity': 0.9730822, 'f1': 0.97664404, 'auroc': 0.9972098, 'binary_precision': 0.96567935, 'binary_recall': 0.949607, 'binary_specificity': 0.9965574, 'binary_f1_score': 0.9575758}
confusion matrix:
       0     1
0  42264   146
1    218  4108
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.7477035, 'recall': 0.657114, 'specificity': 0.657114, 'f1': 0.69116837, 'auroc': 0.85831255, 'binary_precision': 0.52019, 'binary_recall': 0.3254086, 'binary_specificity': 0.9888194, 'binary_f1_score': 0.40036562}
confusion matrix:
       0    1
0  17865  202
1    454  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9542378, 'precision': 0.6787062, 'recall': 0.57889724, 'specificity': 0.57889724, 'f1': 0.6064856, 'auroc': 0.8340514, 'binary_precision': 0.39285713, 'binary_recall': 0.16923077, 'binary_specificity': 0.9885637, 'binary_f1_score': 0.23655915}
confusion matrix:
      0   1
0  5878  68
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_17.png
early stop counter: 3
val acc:0.9649946689605713, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9552046656608582 / 0.9677731394767761
after epoch: 17,now: 2024-06-21 21:40:47.067139,epoch time: 0:10:36.268794,used: 3:15:08.346358,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9919548, 'precision': 0.9782394, 'recall': 0.97366726, 'specificity': 0.97366726, 'f1': 0.9759395, 'auroc': 0.9972594, 'binary_precision': 0.9614486, 'binary_recall': 0.95122516, 'binary_specificity': 0.9961094, 'binary_f1_score': 0.9563096}
confusion matrix:
       0     1
0  42245   165
1    211  4115
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.7483746, 'recall': 0.6557111, 'specificity': 0.6557111, 'f1': 0.6902659, 'auroc': 0.85794103, 'binary_precision': 0.52163464, 'binary_recall': 0.32243684, 'binary_specificity': 0.9889854, 'binary_f1_score': 0.39853072}
confusion matrix:
       0    1
0  17868  199
1    456  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95601034, 'precision': 0.6914276, 'recall': 0.56143236, 'specificity': 0.56143236, 'f1': 0.58839864, 'auroc': 0.8312872, 'binary_precision': 0.41975307, 'binary_recall': 0.13076924, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.1994135}
confusion matrix:
      0   1
0  5899  47
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_18.png
early stop counter: 4
val acc:0.9650480151176453, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9552046656608582 / 0.9677731394767761
after epoch: 18,now: 2024-06-21 21:51:22.422380,epoch time: 0:10:35.355241,used: 3:25:43.701599,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99236137, 'precision': 0.9814645, 'recall': 0.9727496, 'specificity': 0.9727496, 'f1': 0.9770571, 'auroc': 0.99697447, 'binary_precision': 0.9681529, 'binary_recall': 0.94868237, 'binary_specificity': 0.9968168, 'binary_f1_score': 0.9583187}
confusion matrix:
       0     1
0  42275   135
1    222  4104
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.75154155, 'recall': 0.6357667, 'specificity': 0.6357667, 'f1': 0.67455137, 'auroc': 0.84611934, 'binary_precision': 0.5294118, 'binary_recall': 0.28083208, 'binary_specificity': 0.99070126, 'binary_f1_score': 0.3669903}
confusion matrix:
       0    1
0  17899  168
1    484  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9550435, 'precision': 0.67415273, 'recall': 0.5572499, 'specificity': 0.5572499, 'f1': 0.5817359, 'auroc': 0.83116186, 'binary_precision': 0.38554215, 'binary_recall': 0.12307692, 'binary_specificity': 0.99142283, 'binary_f1_score': 0.18658893}
confusion matrix:
      0   1
0  5895  51
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_19.png
early stop counter: 5
val acc:0.965208113193512, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9552046656608582 / 0.9677731394767761
after epoch: 19,now: 2024-06-21 22:01:54.457909,epoch time: 0:10:32.035529,used: 3:36:15.737128,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99233997, 'precision': 0.9799744, 'recall': 0.97418535, 'specificity': 0.97418535, 'f1': 0.9770578, 'auroc': 0.9971532, 'binary_precision': 0.9648465, 'binary_recall': 0.9519075, 'binary_specificity': 0.9964632, 'binary_f1_score': 0.9583333}
confusion matrix:
       0     1
0  42261   150
1    208  4117
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.7629103, 'recall': 0.64696616, 'specificity': 0.64696616, 'f1': 0.686876, 'auroc': 0.84510374, 'binary_precision': 0.55135137, 'binary_recall': 0.30312034, 'binary_specificity': 0.990812, 'binary_f1_score': 0.39117932}
confusion matrix:
       0    1
0  17901  166
1    469  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9531099, 'precision': 0.6564056, 'recall': 0.5635967, 'specificity': 0.5635967, 'f1': 0.5870979, 'auroc': 0.82950556, 'binary_precision': 0.34951457, 'binary_recall': 0.13846155, 'binary_specificity': 0.9887319, 'binary_f1_score': 0.1983471}
confusion matrix:
      0   1
0  5879  67
1   224  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_20.png
early stop counter: 6
val acc:0.9661152362823486, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9552046656608582 / 0.9677731394767761
after epoch: 20,now: 2024-06-21 22:12:24.673317,epoch time: 0:10:30.215408,used: 3:46:45.952536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99236137, 'precision': 0.98175776, 'recall': 0.97243226, 'specificity': 0.97243226, 'f1': 0.9770378, 'auroc': 0.9968331, 'binary_precision': 0.96880907, 'binary_recall': 0.9479769, 'binary_specificity': 0.9968876, 'binary_f1_score': 0.9582798}
confusion matrix:
       0     1
0  42279   132
1    225  4100
---- Validation: 
scalar performance:
{'acc': 0.9654749, 'precision': 0.75507295, 'recall': 0.63805085, 'specificity': 0.63805085, 'f1': 0.67735153, 'auroc': 0.84242284, 'binary_precision': 0.5363129, 'binary_recall': 0.28528973, 'binary_specificity': 0.990812, 'binary_f1_score': 0.37245393}
confusion matrix:
       0    1
0  17901  166
1    481  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9502095, 'precision': 0.63207674, 'recall': 0.5639221, 'specificity': 0.5639221, 'f1': 0.5837618, 'auroc': 0.81926084, 'binary_precision': 0.30081302, 'binary_recall': 0.1423077, 'binary_specificity': 0.9855365, 'binary_f1_score': 0.1932115}
confusion matrix:
      0   1
0  5860  86
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_21.png
early stop counter: 7
val acc:0.9654749035835266, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9552046656608582 / 0.9677731394767761
after epoch: 21,now: 2024-06-21 22:22:54.248671,epoch time: 0:10:29.575354,used: 3:57:15.527890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99246836, 'precision': 0.9788196, 'recall': 0.9762336, 'specificity': 0.9762336, 'f1': 0.97752225, 'auroc': 0.99711996, 'binary_precision': 0.962093, 'binary_recall': 0.9563107, 'binary_specificity': 0.9961566, 'binary_f1_score': 0.95919317}
confusion matrix:
       0     1
0  42247   163
1    189  4137
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.7481595, 'recall': 0.66214854, 'specificity': 0.66214854, 'f1': 0.69515145, 'auroc': 0.85872006, 'binary_precision': 0.52073735, 'binary_recall': 0.3358098, 'binary_specificity': 0.9884873, 'binary_f1_score': 0.40831077}
confusion matrix:
       0    1
0  17859  208
1    447  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95617145, 'precision': 0.7036186, 'recall': 0.5835843, 'specificity': 0.5835843, 'f1': 0.6150854, 'auroc': 0.84823734, 'binary_precision': 0.44230768, 'binary_recall': 0.17692308, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.25274727}
confusion matrix:
      0   1
0  5888  58
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_22.png
early stop counter: 8
val acc:0.9650480151176453, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9552046656608582 / 0.9677731394767761
after epoch: 22,now: 2024-06-21 22:33:21.474414,epoch time: 0:10:27.225743,used: 4:07:42.753633,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.992233, 'precision': 0.98097676, 'recall': 0.97247124, 'specificity': 0.97247124, 'f1': 0.97667634, 'auroc': 0.99730587, 'binary_precision': 0.9672247, 'binary_recall': 0.9482201, 'binary_specificity': 0.99672246, 'binary_f1_score': 0.95762813}
confusion matrix:
       0     1
0  42271   139
1    224  4102
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.7488619, 'recall': 0.64426684, 'specificity': 0.64426684, 'f1': 0.6811693, 'auroc': 0.86000985, 'binary_precision': 0.5234375, 'binary_recall': 0.2986627, 'binary_specificity': 0.989871, 'binary_f1_score': 0.38032168}
confusion matrix:
       0    1
0  17884  183
1    472  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9553658, 'precision': 0.6900666, 'recall': 0.5758079, 'specificity': 0.5758079, 'f1': 0.6048507, 'auroc': 0.8334737, 'binary_precision': 0.41584158, 'binary_recall': 0.16153847, 'binary_specificity': 0.9900774, 'binary_f1_score': 0.23268698}
confusion matrix:
      0   1
0  5887  59
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_23.png
early stop counter: 9
val acc:0.9650480151176453, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9552046656608582 / 0.9677731394767761
after epoch: 23,now: 2024-06-21 22:43:51.729327,epoch time: 0:10:30.254913,used: 4:18:13.008546,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99255395, 'precision': 0.9822961, 'recall': 0.9730633, 'specificity': 0.9730633, 'f1': 0.9776237, 'auroc': 0.9972191, 'binary_precision': 0.9697685, 'binary_recall': 0.9491447, 'binary_specificity': 0.99698186, 'binary_f1_score': 0.9593458}
confusion matrix:
       0     1
0  42282   128
1    220  4106
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.7501414, 'recall': 0.6242394, 'specificity': 0.6242394, 'f1': 0.66384935, 'auroc': 0.84935987, 'binary_precision': 0.527439, 'binary_recall': 0.25705793, 'binary_specificity': 0.9914208, 'binary_f1_score': 0.3456543}
confusion matrix:
       0    1
0  17912  155
1    500  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95601034, 'precision': 0.69705933, 'recall': 0.5724663, 'specificity': 0.5724663, 'f1': 0.6019951, 'auroc': 0.8356513, 'binary_precision': 0.43010753, 'binary_recall': 0.15384616, 'binary_specificity': 0.9910864, 'binary_f1_score': 0.22662891}
confusion matrix:
      0   1
0  5893  53
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_24.png
early stop counter: 10
val acc:0.9650480151176453, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9552046656608582 / 0.9677731394767761
after epoch: 24,now: 2024-06-21 22:54:15.793378,epoch time: 0:10:24.064051,used: 4:28:37.072597,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99244696, 'precision': 0.98848677, 'recall': 0.9661465, 'specificity': 0.9661465, 'f1': 0.97698987, 'auroc': 0.9962409, 'binary_precision': 0.9836824, 'binary_recall': 0.9338728, 'binary_specificity': 0.99842024, 'binary_f1_score': 0.95813066}
confusion matrix:
       0     1
0  42344    67
1    286  4039
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.77185845, 'recall': 0.609057, 'specificity': 0.609057, 'f1': 0.6524642, 'auroc': 0.8390899, 'binary_precision': 0.5719697, 'binary_recall': 0.2243685, 'binary_specificity': 0.9937455, 'binary_f1_score': 0.3223052}
confusion matrix:
       0    1
0  17954  113
1    522  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9555269, 'precision': 0.6639712, 'recall': 0.53911227, 'specificity': 0.53911227, 'f1': 0.5573375, 'auroc': 0.80274415, 'binary_precision': 0.36666667, 'binary_recall': 0.08461539, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.1375}
confusion matrix:
      0   1
0  5908  38
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_25.png
early stop counter: 11
val acc:0.9661152362823486, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9552046656608582 / 0.9677731394767761
after epoch: 25,now: 2024-06-21 23:04:35.538945,epoch time: 0:10:19.745567,used: 4:38:56.818164,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99251115, 'precision': 0.9828603, 'recall': 0.97220325, 'specificity': 0.97220325, 'f1': 0.9774572, 'auroc': 0.9968827, 'binary_precision': 0.9710832, 'binary_recall': 0.9472832, 'binary_specificity': 0.99712336, 'binary_f1_score': 0.9590356}
confusion matrix:
       0     1
0  42289   122
1    228  4097
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.74998266, 'recall': 0.61634374, 'specificity': 0.61634374, 'f1': 0.65631986, 'auroc': 0.84871376, 'binary_precision': 0.5276873, 'binary_recall': 0.24071322, 'binary_specificity': 0.9919743, 'binary_f1_score': 0.33061224}
confusion matrix:
       0    1
0  17922  145
1    511  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95568806, 'precision': 0.6885929, 'recall': 0.5649422, 'specificity': 0.5649422, 'f1': 0.5923498, 'auroc': 0.82465476, 'binary_precision': 0.41379312, 'binary_recall': 0.13846155, 'binary_specificity': 0.99142283, 'binary_f1_score': 0.2074928}
confusion matrix:
      0   1
0  5895  51
1   224  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_26.png
early stop counter: 12
val acc:0.9649946689605713, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9552046656608582 / 0.9677731394767761
after epoch: 26,now: 2024-06-21 23:14:52.218689,epoch time: 0:10:16.679744,used: 4:49:13.497908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9922544, 'precision': 0.9763776, 'recall': 0.97756416, 'specificity': 0.97756416, 'f1': 0.97696996, 'auroc': 0.99753433, 'binary_precision': 0.95688266, 'binary_recall': 0.95953757, 'binary_specificity': 0.99559075, 'binary_f1_score': 0.95820826}
confusion matrix:
       0     1
0  42224   187
1    175  4150
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.7495483, 'recall': 0.67367584, 'specificity': 0.67367584, 'f1': 0.7040583, 'auroc': 0.8601192, 'binary_precision': 0.5226782, 'binary_recall': 0.35958394, 'binary_specificity': 0.98776776, 'binary_f1_score': 0.42605636}
confusion matrix:
       0    1
0  17846  221
1    431  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9537544, 'precision': 0.67130566, 'recall': 0.574967, 'specificity': 0.574967, 'f1': 0.60128987, 'auroc': 0.8275693, 'binary_precision': 0.3783784, 'binary_recall': 0.16153847, 'binary_specificity': 0.9883956, 'binary_f1_score': 0.2264151}
confusion matrix:
      0   1
0  5877  69
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_27.png
early stop counter: 13
val acc:0.965208113193512, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9552046656608582 / 0.9677731394767761
after epoch: 27,now: 2024-06-21 23:25:13.966393,epoch time: 0:10:21.747704,used: 4:59:35.245612,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99255395, 'precision': 0.97830737, 'recall': 0.977314, 'specificity': 0.977314, 'f1': 0.97781, 'auroc': 0.99772334, 'binary_precision': 0.9608343, 'binary_recall': 0.95861274, 'binary_specificity': 0.9960152, 'binary_f1_score': 0.9597222}
confusion matrix:
       0     1
0  42242   169
1    179  4146
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.7393811, 'recall': 0.6274283, 'specificity': 0.6274283, 'f1': 0.66448283, 'auroc': 0.85124683, 'binary_precision': 0.5056818, 'binary_recall': 0.26448736, 'binary_specificity': 0.9903692, 'binary_f1_score': 0.34731707}
confusion matrix:
       0    1
0  17893  174
1    495  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.954399, 'precision': 0.6737433, 'recall': 0.56794745, 'specificity': 0.56794745, 'f1': 0.5941098, 'auroc': 0.814606, 'binary_precision': 0.3838384, 'binary_recall': 0.14615385, 'binary_specificity': 0.989741, 'binary_f1_score': 0.21169917}
confusion matrix:
      0   1
0  5885  61
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_28.png
early stop counter: 14
val acc:0.9643009901046753, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9552046656608582 / 0.9677731394767761
after epoch: 28,now: 2024-06-21 23:35:36.129684,epoch time: 0:10:22.163291,used: 5:09:57.408903,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9933884, 'precision': 0.98348284, 'recall': 0.97694814, 'specificity': 0.97694814, 'f1': 0.9801876, 'auroc': 0.9977683, 'binary_precision': 0.9713682, 'binary_recall': 0.956773, 'binary_specificity': 0.9971233, 'binary_f1_score': 0.9640154}
confusion matrix:
       0     1
0  42288   122
1    187  4139
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.7444204, 'recall': 0.63119835, 'specificity': 0.63119835, 'f1': 0.6689351, 'auroc': 0.8563436, 'binary_precision': 0.515493, 'binary_recall': 0.27191678, 'binary_specificity': 0.9904799, 'binary_f1_score': 0.3560311}
confusion matrix:
       0    1
0  17895  172
1    490  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95278764, 'precision': 0.6546155, 'recall': 0.56526756, 'specificity': 0.56526756, 'f1': 0.58865476, 'auroc': 0.8300943, 'binary_precision': 0.34579438, 'binary_recall': 0.1423077, 'binary_specificity': 0.98822737, 'binary_f1_score': 0.20163488}
confusion matrix:
      0   1
0  5876  70
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_29.png
early stop counter: 15
val acc:0.9646744728088379, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9552046656608582 / 0.9677731394767761
after epoch: 29,now: 2024-06-21 23:45:58.474610,epoch time: 0:10:22.344926,used: 5:20:19.753829,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99306744, 'precision': 0.9844532, 'recall': 0.97396326, 'specificity': 0.97396326, 'f1': 0.9791362, 'auroc': 0.99724734, 'binary_precision': 0.97393984, 'binary_recall': 0.9505202, 'binary_specificity': 0.9974063, 'binary_f1_score': 0.9620875}
confusion matrix:
       0     1
0  42301   110
1    214  4111
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.7495723, 'recall': 0.657197, 'specificity': 0.657197, 'f1': 0.6917608, 'auroc': 0.86095107, 'binary_precision': 0.52392346, 'binary_recall': 0.3254086, 'binary_specificity': 0.9889854, 'binary_f1_score': 0.40146655}
confusion matrix:
       0    1
0  17868  199
1    454  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9540767, 'precision': 0.6611387, 'recall': 0.55674535, 'specificity': 0.55674535, 'f1': 0.5798776, 'auroc': 0.8297187, 'binary_precision': 0.35955057, 'binary_recall': 0.12307692, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.1833811}
confusion matrix:
      0   1
0  5889  57
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_30.png
early stop counter: 16
val acc:0.965154767036438, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9552046656608582 / 0.9677731394767761
after epoch: 30,now: 2024-06-21 23:56:16.686334,epoch time: 0:10:18.211724,used: 5:30:37.965553,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_18_25_38_seed_1_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:30:37.965553 at 2024-06-21 23:56:16.686334
persisted model performance metric: 

scalar performance:
{'acc': 0.95520467, 'precision': 0.68607247, 'recall': 0.57204586, 'specificity': 0.57204586, 'f1': 0.6002004, 'auroc': 0.83223516, 'binary_precision': 0.40816328, 'binary_recall': 0.15384616, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.22346368}
confusion matrix:
      0   1
0  5888  58
1   220  40
oracle model performance metric: 

scalar performance:
{'acc': 0.96777314, 'precision': 0.84113467, 'recall': 0.69262207, 'specificity': 0.69262207, 'f1': 0.7441475, 'auroc': 0.8354155, 'binary_precision': 0.7083333, 'binary_recall': 0.3923077, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.50495046}
confusion matrix:
      0    1
0  5904   42
1   158  102
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204071 KiB | 640729 KiB |   1980 TiB |   1980 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   1980 TiB |   1980 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204071 KiB | 640729 KiB |   1980 TiB |   1980 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   1980 TiB |   1980 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 632296 KiB |   1972 TiB |   1972 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   1971 TiB |   1971 TiB |
|       from small pool |  35966 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 675840 KiB | 755712 KiB |   1120 MiB | 471040 KiB |
|       from large pool | 600064 KiB | 679936 KiB |   1020 MiB | 444416 KiB |
|       from small pool |  75776 KiB |  75776 KiB |    100 MiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  80600 KiB | 218089 KiB | 744163 GiB | 744163 GiB |
|       from large pool |  68480 KiB | 217080 KiB | 743525 GiB | 743525 GiB |
|       from small pool |  12120 KiB |  19703 KiB |    638 GiB |    638 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3228    |    6591    |  175422 K  |  175418 K  |
|       from large pool |      36    |      76    |   70976 K  |   70976 K  |
|       from small pool |    3192    |    6554    |  104445 K  |  104442 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3228    |    6591    |  175422 K  |  175418 K  |
|       from large pool |      36    |      76    |   70976 K  |   70976 K  |
|       from small pool |    3192    |    6554    |  104445 K  |  104442 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      68    |      17    |
|       from large pool |      14    |      14    |      18    |       4    |
|       from small pool |      37    |      37    |      50    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    2938    |   80004 K  |   80004 K  |
|       from large pool |       5    |      13    |   26553 K  |   26553 K  |
|       from small pool |      32    |    2931    |   53451 K  |   53451 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   1980 TiB |   1980 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1980 TiB |   1980 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   1980 TiB |   1980 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1980 TiB |   1980 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   1972 TiB |   1972 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1971 TiB |   1971 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1120 MiB |    842 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1020 MiB |    790 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB | 744164 GiB | 744164 GiB |
|       from large pool |  55040 KiB | 217080 KiB | 743525 GiB | 743525 GiB |
|       from small pool |      0 KiB |  19715 KiB |    638 GiB |    638 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6591    |  175422 K  |  175422 K  |
|       from large pool |       2    |      76    |   70976 K  |   70976 K  |
|       from small pool |       0    |    6554    |  104445 K  |  104445 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6591    |  175422 K  |  175422 K  |
|       from large pool |       2    |      76    |   70976 K  |   70976 K  |
|       from small pool |       0    |    6554    |  104445 K  |  104445 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      68    |      34    |
|       from large pool |      10    |      14    |      18    |       8    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2938    |   80005 K  |   80005 K  |
|       from large pool |       3    |      13    |   26553 K  |   26553 K  |
|       from small pool |       0    |    2931    |   53452 K  |   53452 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   1980 TiB |   1980 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1980 TiB |   1980 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   1980 TiB |   1980 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1980 TiB |   1980 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   1972 TiB |   1972 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1971 TiB |   1971 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1120 MiB |    842 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1020 MiB |    790 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB | 744164 GiB | 744164 GiB |
|       from large pool |  55040 KiB | 217080 KiB | 743525 GiB | 743525 GiB |
|       from small pool |      0 KiB |  19715 KiB |    638 GiB |    638 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6591    |  175422 K  |  175422 K  |
|       from large pool |       2    |      76    |   70976 K  |   70976 K  |
|       from small pool |       0    |    6554    |  104445 K  |  104445 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6591    |  175422 K  |  175422 K  |
|       from large pool |       2    |      76    |   70976 K  |   70976 K  |
|       from small pool |       0    |    6554    |  104445 K  |  104445 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      68    |      34    |
|       from large pool |      10    |      14    |      18    |       8    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2938    |   80005 K  |   80005 K  |
|       from large pool |       3    |      13    |   26553 K  |   26553 K  |
|       from small pool |       0    |    2931    |   53452 K  |   53452 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820

 Experiment start at: 2024-06-22 00:00:17.766050
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98002046, 'precision': 0.9744538, 'recall': 0.90906787, 'specificity': 0.90906787, 'f1': 0.93872, 'auroc': 0.986361, 'binary_precision': 0.9677922, 'binary_recall': 0.82106656, 'binary_specificity': 0.99706924, 'binary_f1_score': 0.88841206}
confusion matrix:
       0     1
0  42186   124
1    812  3726
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9684121, 'precision': 0.7458174, 'recall': 0.6126744, 'specificity': 0.6126744, 'f1': 0.6522816, 'auroc': 0.77719855, 'binary_precision': 0.51660514, 'binary_recall': 0.23255815, 'binary_specificity': 0.9927907, 'binary_f1_score': 0.3207331}
confusion matrix:
       0    1
0  18040  131
1    462  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.8188071, 'recall': 0.663937, 'specificity': 0.663937, 'f1': 0.71419, 'auroc': 0.7961765, 'binary_precision': 0.6639344, 'binary_recall': 0.33471075, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.44505492}
confusion matrix:
      0   1
0  5956  41
1   161  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 00:10:45.751672,epoch time: 0:10:27.985622,used: 0:10:27.985622,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9847379, 'precision': 0.9753027, 'recall': 0.9358906, 'specificity': 0.9358906, 'f1': 0.9545189, 'auroc': 0.9914417, 'binary_precision': 0.9638525, 'binary_recall': 0.8753029, 'binary_specificity': 0.9964783, 'binary_f1_score': 0.917446}
confusion matrix:
       0     1
0  42160   149
1    566  3973
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.7618058, 'recall': 0.6195666, 'specificity': 0.6195666, 'f1': 0.6618718, 'auroc': 0.79308593, 'binary_precision': 0.54814816, 'binary_recall': 0.24584718, 'binary_specificity': 0.993286, 'binary_f1_score': 0.33944955}
confusion matrix:
       0    1
0  18049  122
1    454  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9681039, 'precision': 0.84059775, 'recall': 0.6483252, 'specificity': 0.6483252, 'f1': 0.70339346, 'auroc': 0.7973604, 'binary_precision': 0.70873785, 'binary_recall': 0.30165288, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.4231884}
confusion matrix:
      0   1
0  5967  30
1   169  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-22 00:21:12.490852,epoch time: 0:10:26.739180,used: 0:20:54.724802,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98636013, 'precision': 0.96532464, 'recall': 0.9560542, 'specificity': 0.9560542, 'f1': 0.96062994, 'auroc': 0.9924557, 'binary_precision': 0.93937343, 'binary_recall': 0.91846627, 'binary_specificity': 0.99364215, 'binary_f1_score': 0.92880225}
confusion matrix:
       0     1
0  42041   269
1    370  4168
---- Validation: 
scalar performance:
{'acc': 0.96431047, 'precision': 0.70833844, 'recall': 0.68684524, 'specificity': 0.68684524, 'f1': 0.6969386, 'auroc': 0.83404124, 'binary_precision': 0.43680298, 'binary_recall': 0.39036545, 'binary_specificity': 0.98332506, 'binary_f1_score': 0.4122807}
confusion matrix:
       0    1
0  17868  303
1    367  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.78240293, 'recall': 0.70878965, 'specificity': 0.70878965, 'f1': 0.73946136, 'auroc': 0.8372823, 'binary_precision': 0.5875706, 'binary_recall': 0.42975205, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.49642006}
confusion matrix:
      0    1
0  5924   73
1   138  104
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_3.png
early stop counter: 1
val acc:0.9643104672431946, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 3,now: 2024-06-22 00:31:35.321203,epoch time: 0:10:22.830351,used: 0:31:17.555153,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9882599, 'precision': 0.9782959, 'recall': 0.95366323, 'specificity': 0.95366323, 'f1': 0.9655669, 'auroc': 0.99400145, 'binary_precision': 0.96610564, 'binary_recall': 0.9107536, 'binary_specificity': 0.9965729, 'binary_f1_score': 0.9376134}
confusion matrix:
       0     1
0  42165   145
1    405  4133
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.73796624, 'recall': 0.6477334, 'specificity': 0.6477334, 'f1': 0.68125206, 'auroc': 0.81259245, 'binary_precision': 0.49864498, 'binary_recall': 0.30564785, 'binary_specificity': 0.98981893, 'binary_f1_score': 0.37899074}
confusion matrix:
       0    1
0  17986  185
1    418  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.79744434, 'recall': 0.6431091, 'specificity': 0.6431091, 'f1': 0.69061124, 'auroc': 0.8179145, 'binary_precision': 0.622807, 'binary_recall': 0.29338843, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.3988764}
confusion matrix:
      0   1
0  5954  43
1   171  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_4.png
early stop counter: 2
val acc:0.9678794145584106, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 4,now: 2024-06-22 00:42:09.399046,epoch time: 0:10:34.077843,used: 0:41:51.632996,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9886228, 'precision': 0.9788449, 'recall': 0.95522237, 'specificity': 0.95522237, 'f1': 0.96665484, 'auroc': 0.99421763, 'binary_precision': 0.9668766, 'binary_recall': 0.9138007, 'binary_specificity': 0.99664396, 'binary_f1_score': 0.9395897}
confusion matrix:
       0     1
0  42170   142
1    391  4145
---- Validation: 
scalar performance:
{'acc': 0.96681404, 'precision': 0.7253246, 'recall': 0.64878917, 'specificity': 0.64878917, 'f1': 0.6784123, 'auroc': 0.82802486, 'binary_precision': 0.47328246, 'binary_recall': 0.3089701, 'binary_specificity': 0.98860824, 'binary_f1_score': 0.37386936}
confusion matrix:
       0    1
0  17964  207
1    416  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.78494716, 'recall': 0.6547554, 'specificity': 0.6547554, 'f1': 0.6985854, 'auroc': 0.8273305, 'binary_precision': 0.5968992, 'binary_recall': 0.3181818, 'binary_specificity': 0.991329, 'binary_f1_score': 0.41509432}
confusion matrix:
      0   1
0  5945  52
1   165  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_5.png
early stop counter: 3
val acc:0.9668140411376953, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 5,now: 2024-06-22 00:52:37.791279,epoch time: 0:10:28.392233,used: 0:52:20.025229,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9881745, 'precision': 0.9698627, 'recall': 0.9620829, 'specificity': 0.9620829, 'f1': 0.96593136, 'auroc': 0.99588716, 'binary_precision': 0.9472503, 'binary_recall': 0.9297202, 'binary_specificity': 0.9944456, 'binary_f1_score': 0.93840337}
confusion matrix:
       0     1
0  42074   235
1    319  4220
---- Validation: 
scalar performance:
{'acc': 0.96628135, 'precision': 0.7222204, 'recall': 0.6685902, 'specificity': 0.6685902, 'f1': 0.6913266, 'auroc': 0.8498356, 'binary_precision': 0.46578366, 'binary_recall': 0.35049835, 'binary_specificity': 0.98668206, 'binary_f1_score': 0.4}
confusion matrix:
       0    1
0  17929  242
1    391  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.80003077, 'recall': 0.68144816, 'specificity': 0.68144816, 'f1': 0.7246426, 'auroc': 0.84143686, 'binary_precision': 0.625, 'binary_recall': 0.37190083, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.46632126}
confusion matrix:
      0   1
0  5943  54
1   152  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_6.png
early stop counter: 4
val acc:0.9662813544273376, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 6,now: 2024-06-22 01:02:59.810643,epoch time: 0:10:22.019364,used: 1:02:42.044593,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9901597, 'precision': 0.9836736, 'recall': 0.9594451, 'specificity': 0.9594451, 'f1': 0.9711652, 'auroc': 0.9951331, 'binary_precision': 0.97573495, 'binary_recall': 0.92134833, 'binary_specificity': 0.9975419, 'binary_f1_score': 0.9477621}
confusion matrix:
       0     1
0  42205   104
1    357  4182
---- Validation: 
scalar performance:
{'acc': 0.9673467, 'precision': 0.7273938, 'recall': 0.6065028, 'specificity': 0.6065028, 'f1': 0.6429493, 'auroc': 0.8300539, 'binary_precision': 0.4801444, 'binary_recall': 0.22093023, 'binary_specificity': 0.99207526, 'binary_f1_score': 0.3026166}
confusion matrix:
       0    1
0  18027  144
1    469  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.76653653, 'recall': 0.6060858, 'specificity': 0.6060858, 'f1': 0.6482668, 'auroc': 0.8172282, 'binary_precision': 0.5638298, 'binary_recall': 0.21900827, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.31547618}
confusion matrix:
      0   1
0  5956  41
1   189  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_7.png
early stop counter: 5
val acc:0.967346727848053, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 7,now: 2024-06-22 01:13:20.568287,epoch time: 0:10:20.757644,used: 1:13:02.802237,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98922044, 'precision': 0.9766234, 'recall': 0.96108854, 'specificity': 0.96108854, 'f1': 0.9686924, 'auroc': 0.99542403, 'binary_precision': 0.96113396, 'binary_recall': 0.9261952, 'binary_specificity': 0.99598193, 'binary_f1_score': 0.9433412}
confusion matrix:
       0     1
0  42139   170
1    335  4204
---- Validation: 
scalar performance:
{'acc': 0.96564215, 'precision': 0.7143566, 'recall': 0.65701735, 'specificity': 0.65701735, 'f1': 0.68077147, 'auroc': 0.84728134, 'binary_precision': 0.45080093, 'binary_recall': 0.32724252, 'binary_specificity': 0.98679215, 'binary_f1_score': 0.37921077}
confusion matrix:
       0    1
0  17931  240
1    405  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9556019, 'precision': 0.6769413, 'recall': 0.6120808, 'specificity': 0.6120808, 'f1': 0.63612217, 'auroc': 0.83267874, 'binary_precision': 0.38410595, 'binary_recall': 0.23966943, 'binary_specificity': 0.98449224, 'binary_f1_score': 0.2951654}
confusion matrix:
      0   1
0  5904  93
1   184  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_8.png
early stop counter: 6
val acc:0.9656421542167664, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 8,now: 2024-06-22 01:23:41.806258,epoch time: 0:10:21.237971,used: 1:23:24.040208,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9905012, 'precision': 0.97879845, 'recall': 0.9664196, 'specificity': 0.9664196, 'f1': 0.9725059, 'auroc': 0.9954252, 'binary_precision': 0.96438295, 'binary_recall': 0.9365499, 'binary_specificity': 0.9962892, 'binary_f1_score': 0.9502627}
confusion matrix:
       0     1
0  42152   157
1    288  4251
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.74744856, 'recall': 0.66177046, 'specificity': 0.66177046, 'f1': 0.694769, 'auroc': 0.85835046, 'binary_precision': 0.5167095, 'binary_recall': 0.33388704, 'binary_specificity': 0.9896538, 'binary_f1_score': 0.40565085}
confusion matrix:
       0    1
0  17983  188
1    401  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.73692036, 'recall': 0.56551385, 'specificity': 0.56551385, 'f1': 0.5975913, 'auroc': 0.8147204, 'binary_precision': 0.50769234, 'binary_recall': 0.13636364, 'binary_specificity': 0.994664, 'binary_f1_score': 0.21498372}
confusion matrix:
      0   1
0  5965  32
1   209  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_9.png
early stop counter: 7
val acc:0.9686251282691956, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 9,now: 2024-06-22 01:33:59.124930,epoch time: 0:10:17.318672,used: 1:33:41.358880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9908641, 'precision': 0.9810474, 'recall': 0.9662271, 'specificity': 0.9662271, 'f1': 0.97349, 'auroc': 0.99659747, 'binary_precision': 0.968971, 'binary_recall': 0.93566865, 'binary_specificity': 0.9967856, 'binary_f1_score': 0.9520287}
confusion matrix:
       0     1
0  42173   136
1    292  4247
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.7361319, 'recall': 0.63723874, 'specificity': 0.63723874, 'f1': 0.6723049, 'auroc': 0.83751726, 'binary_precision': 0.49565217, 'binary_recall': 0.28405315, 'binary_specificity': 0.9904243, 'binary_f1_score': 0.36114046}
confusion matrix:
       0    1
0  17997  174
1    431  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.73436224, 'recall': 0.59913707, 'specificity': 0.59913707, 'f1': 0.63622856, 'auroc': 0.81917226, 'binary_precision': 0.5, 'binary_recall': 0.20661157, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.29239768}
confusion matrix:
      0   1
0  5947  50
1   192  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_10.png
early stop counter: 8
val acc:0.9677728414535522, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 10,now: 2024-06-22 01:44:24.708703,epoch time: 0:10:25.583773,used: 1:44:06.942653,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99069333, 'precision': 0.9795971, 'recall': 0.9667226, 'specificity': 0.9667226, 'f1': 0.9730485, 'auroc': 0.99542975, 'binary_precision': 0.9659323, 'binary_recall': 0.9369905, 'binary_specificity': 0.99645466, 'binary_f1_score': 0.9512413}
confusion matrix:
       0     1
0  42159   150
1    286  4253
---- Validation: 
scalar performance:
{'acc': 0.9675065, 'precision': 0.73315626, 'recall': 0.64513165, 'specificity': 0.64513165, 'f1': 0.67787474, 'auroc': 0.85128677, 'binary_precision': 0.48918918, 'binary_recall': 0.30066445, 'binary_specificity': 0.9895988, 'binary_f1_score': 0.37242797}
confusion matrix:
       0    1
0  17982  189
1    421  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96008974, 'precision': 0.71720135, 'recall': 0.5945879, 'specificity': 0.5945879, 'f1': 0.6288692, 'auroc': 0.82481635, 'binary_precision': 0.46601942, 'binary_recall': 0.1983471, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.27826086}
confusion matrix:
      0   1
0  5942  55
1   194  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_11.png
early stop counter: 9
val acc:0.9675065279006958, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 11,now: 2024-06-22 01:54:46.139149,epoch time: 0:10:21.430446,used: 1:54:28.373099,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99043715, 'precision': 0.9867805, 'recall': 0.95802534, 'specificity': 0.95802534, 'f1': 0.97184956, 'auroc': 0.99550235, 'binary_precision': 0.9823155, 'binary_recall': 0.9178233, 'binary_specificity': 0.9982273, 'binary_f1_score': 0.94897497}
confusion matrix:
       0     1
0  42234    75
1    373  4166
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.7447598, 'recall': 0.6158591, 'specificity': 0.6158591, 'f1': 0.6551647, 'auroc': 0.8523067, 'binary_precision': 0.51428574, 'binary_recall': 0.23920266, 'binary_specificity': 0.99251556, 'binary_f1_score': 0.3265306}
confusion matrix:
       0    1
0  18035  136
1    458  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.7452549, 'recall': 0.5935223, 'specificity': 0.5935223, 'f1': 0.6317688, 'auroc': 0.8354439, 'binary_precision': 0.5222222, 'binary_recall': 0.19421488, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.28313252}
confusion matrix:
      0   1
0  5954  43
1   195  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_12.png
early stop counter: 10
val acc:0.9683588147163391, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 12,now: 2024-06-22 02:05:04.640054,epoch time: 0:10:18.500905,used: 2:04:46.874004,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99126965, 'precision': 0.98200357, 'recall': 0.9676317, 'specificity': 0.9676317, 'f1': 0.9746795, 'auroc': 0.99648654, 'binary_precision': 0.9706016, 'binary_recall': 0.9383124, 'binary_specificity': 0.996951, 'binary_f1_score': 0.95418394}
confusion matrix:
       0     1
0  42180   129
1    280  4259
---- Validation: 
scalar performance:
{'acc': 0.96494967, 'precision': 0.7057719, 'recall': 0.6470231, 'specificity': 0.6470231, 'f1': 0.67095184, 'auroc': 0.858951, 'binary_precision': 0.4342723, 'binary_recall': 0.30730897, 'binary_specificity': 0.98673713, 'binary_f1_score': 0.35992217}
confusion matrix:
       0    1
0  17930  241
1    417  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9570444, 'precision': 0.68913597, 'recall': 0.6128312, 'specificity': 0.6128312, 'f1': 0.6399618, 'auroc': 0.8252706, 'binary_precision': 0.4084507, 'binary_recall': 0.23966943, 'binary_specificity': 0.98599297, 'binary_f1_score': 0.30208334}
confusion matrix:
      0   1
0  5913  84
1   184  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_13.png
early stop counter: 11
val acc:0.9649496674537659, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 13,now: 2024-06-22 02:15:25.905832,epoch time: 0:10:21.265778,used: 2:15:08.139782,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9902664, 'precision': 0.97575784, 'recall': 0.96825635, 'specificity': 0.96825635, 'f1': 0.9719691, 'auroc': 0.99568594, 'binary_precision': 0.95783806, 'binary_recall': 0.9409562, 'binary_specificity': 0.9955565, 'binary_f1_score': 0.9493221}
confusion matrix:
       0     1
0  42121   188
1    268  4271
---- Validation: 
scalar performance:
{'acc': 0.96697384, 'precision': 0.72780937, 'recall': 0.6552961, 'specificity': 0.6552961, 'f1': 0.683976, 'auroc': 0.8530539, 'binary_precision': 0.47783253, 'binary_recall': 0.32225913, 'binary_specificity': 0.98833305, 'binary_f1_score': 0.38492063}
confusion matrix:
       0    1
0  17959  212
1    408  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597692, 'precision': 0.71369714, 'recall': 0.59838665, 'specificity': 0.59838665, 'f1': 0.63210136, 'auroc': 0.8233428, 'binary_precision': 0.4587156, 'binary_recall': 0.20661157, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.28490028}
confusion matrix:
      0   1
0  5938  59
1   192  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_14.png
early stop counter: 12
val acc:0.9669738411903381, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 14,now: 2024-06-22 02:25:47.373710,epoch time: 0:10:21.467878,used: 2:25:29.607660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99201673, 'precision': 0.9804674, 'recall': 0.9736506, 'specificity': 0.9736506, 'f1': 0.977028, 'auroc': 0.9968102, 'binary_precision': 0.96619654, 'binary_recall': 0.9508702, 'binary_specificity': 0.996431, 'binary_f1_score': 0.9584721}
confusion matrix:
       0     1
0  42158   151
1    223  4316
---- Validation: 
scalar performance:
{'acc': 0.96558887, 'precision': 0.7145324, 'recall': 0.661005, 'specificity': 0.661005, 'f1': 0.6835307, 'auroc': 0.8631738, 'binary_precision': 0.45089287, 'binary_recall': 0.33554816, 'binary_specificity': 0.98646194, 'binary_f1_score': 0.3847619}
confusion matrix:
       0    1
0  17925  246
1    400  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95816636, 'precision': 0.68758625, 'recall': 0.58169097, 'specificity': 0.58169097, 'f1': 0.6109834, 'auroc': 0.8164949, 'binary_precision': 0.407767, 'binary_recall': 0.17355372, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.24347828}
confusion matrix:
      0   1
0  5936  61
1   200  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_15.png
early stop counter: 13
val acc:0.9655888676643372, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 15,now: 2024-06-22 02:36:07.289412,epoch time: 0:10:19.915702,used: 2:35:49.523362,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99158984, 'precision': 0.97877026, 'recall': 0.97292256, 'specificity': 0.97292256, 'f1': 0.9758235, 'auroc': 0.99639547, 'binary_precision': 0.9629216, 'binary_recall': 0.94976866, 'binary_specificity': 0.99607646, 'binary_f1_score': 0.95629996}
confusion matrix:
       0     1
0  42143   166
1    228  4311
---- Validation: 
scalar performance:
{'acc': 0.96681404, 'precision': 0.72587633, 'recall': 0.6536075, 'specificity': 0.6536075, 'f1': 0.68214023, 'auroc': 0.86726403, 'binary_precision': 0.47407407, 'binary_recall': 0.31893688, 'binary_specificity': 0.98827803, 'binary_f1_score': 0.38133067}
confusion matrix:
       0    1
0  17958  213
1    410  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9588075, 'precision': 0.6931626, 'recall': 0.57607627, 'specificity': 0.57607627, 'f1': 0.6058357, 'auroc': 0.81657803, 'binary_precision': 0.41935483, 'binary_recall': 0.16115703, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.2328358}
confusion matrix:
      0   1
0  5943  54
1   203  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_16.png
early stop counter: 14
val acc:0.9668140411376953, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 16,now: 2024-06-22 02:46:29.308185,epoch time: 0:10:22.018773,used: 2:46:11.542135,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9925717, 'precision': 0.986472, 'recall': 0.9707127, 'specificity': 0.9707127, 'f1': 0.9784278, 'auroc': 0.99686337, 'binary_precision': 0.9789714, 'binary_recall': 0.94359994, 'binary_specificity': 0.9978255, 'binary_f1_score': 0.96096027}
confusion matrix:
       0     1
0  42217    92
1    256  4283
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.7460072, 'recall': 0.6086592, 'specificity': 0.6086592, 'f1': 0.64834833, 'auroc': 0.84553516, 'binary_precision': 0.51724136, 'binary_recall': 0.22425249, 'binary_specificity': 0.9930659, 'binary_f1_score': 0.31286213}
confusion matrix:
       0    1
0  18045  126
1    467  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95928836, 'precision': 0.6885432, 'recall': 0.55451626, 'specificity': 0.55451626, 'f1': 0.57988536, 'auroc': 0.81032395, 'binary_precision': 0.4117647, 'binary_recall': 0.11570248, 'binary_specificity': 0.99333, 'binary_f1_score': 0.18064515}
confusion matrix:
      0   1
0  5957  40
1   214  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_17.png
early stop counter: 15
val acc:0.9684121012687683, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 17,now: 2024-06-22 02:56:56.976570,epoch time: 0:10:27.668385,used: 2:56:39.210520,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99118423, 'precision': 0.9791157, 'recall': 0.97014123, 'specificity': 0.97014123, 'f1': 0.97457445, 'auroc': 0.9967179, 'binary_precision': 0.9642214, 'binary_recall': 0.94404054, 'binary_specificity': 0.9962419, 'binary_f1_score': 0.95402426}
confusion matrix:
       0     1
0  42150   159
1    254  4285
---- Validation: 
scalar performance:
{'acc': 0.96638787, 'precision': 0.71939003, 'recall': 0.6405386, 'specificity': 0.6405386, 'f1': 0.6704148, 'auroc': 0.8493022, 'binary_precision': 0.46194226, 'binary_recall': 0.29235882, 'binary_specificity': 0.9887183, 'binary_f1_score': 0.35808748}
confusion matrix:
       0    1
0  17966  205
1    426  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9556019, 'precision': 0.66013074, 'recall': 0.580357, 'specificity': 0.580357, 'f1': 0.6049133, 'auroc': 0.8048949, 'binary_precision': 0.3529412, 'binary_recall': 0.17355372, 'binary_specificity': 0.98716027, 'binary_f1_score': 0.23268698}
confusion matrix:
      0   1
0  5920  77
1   200  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_18.png
early stop counter: 16
val acc:0.9663878679275513, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 18,now: 2024-06-22 03:07:23.391434,epoch time: 0:10:26.414864,used: 3:07:05.625384,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99188864, 'precision': 0.98282015, 'recall': 0.9704329, 'specificity': 0.9704329, 'f1': 0.97652423, 'auroc': 0.99676096, 'binary_precision': 0.9716489, 'binary_recall': 0.94382024, 'binary_specificity': 0.9970455, 'binary_f1_score': 0.95753235}
confusion matrix:
       0     1
0  42184   125
1    255  4284
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.7373359, 'recall': 0.6308694, 'specificity': 0.6308694, 'f1': 0.6672236, 'auroc': 0.8511796, 'binary_precision': 0.49847096, 'binary_recall': 0.2707641, 'binary_specificity': 0.9909746, 'binary_f1_score': 0.35091496}
confusion matrix:
       0    1
0  18007  164
1    439  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95944864, 'precision': 0.7009912, 'recall': 0.57244426, 'specificity': 0.57244426, 'f1': 0.6027392, 'auroc': 0.79897267, 'binary_precision': 0.43529412, 'binary_recall': 0.15289256, 'binary_specificity': 0.991996, 'binary_f1_score': 0.2262997}
confusion matrix:
      0   1
0  5949  48
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_19.png
early stop counter: 17
val acc:0.9678794145584106, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 19,now: 2024-06-22 03:17:47.297309,epoch time: 0:10:23.905875,used: 3:17:29.531259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99137634, 'precision': 0.9763417, 'recall': 0.9742795, 'specificity': 0.9742795, 'f1': 0.9753078, 'auroc': 0.99714553, 'binary_precision': 0.9577153, 'binary_recall': 0.9530734, 'binary_specificity': 0.9954856, 'binary_f1_score': 0.9553887}
confusion matrix:
       0     1
0  42118   191
1    213  4326
---- Validation: 
scalar performance:
{'acc': 0.96564215, 'precision': 0.71167994, 'recall': 0.64256245, 'specificity': 0.64256245, 'f1': 0.66963935, 'auroc': 0.85882306, 'binary_precision': 0.44638404, 'binary_recall': 0.29734218, 'binary_specificity': 0.9877827, 'binary_f1_score': 0.35692918}
confusion matrix:
       0    1
0  17949  222
1    423  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95512104, 'precision': 0.6632159, 'recall': 0.5920033, 'specificity': 0.5920033, 'f1': 0.61609125, 'auroc': 0.8182793, 'binary_precision': 0.35820895, 'binary_recall': 0.1983471, 'binary_specificity': 0.9856595, 'binary_f1_score': 0.25531918}
confusion matrix:
      0   1
0  5911  86
1   194  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_20.png
early stop counter: 18
val acc:0.9656421542167664, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 20,now: 2024-06-22 03:28:07.064027,epoch time: 0:10:19.766718,used: 3:27:49.297977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.991355, 'precision': 0.97951996, 'recall': 0.97072744, 'specificity': 0.97072744, 'f1': 0.9750719, 'auroc': 0.9969994, 'binary_precision': 0.9649123, 'binary_recall': 0.9451421, 'binary_specificity': 0.99631286, 'binary_f1_score': 0.9549248}
confusion matrix:
       0     1
0  42153   156
1    249  4290
---- Validation: 
scalar performance:
{'acc': 0.96638787, 'precision': 0.7176598, 'recall': 0.63009894, 'specificity': 0.63009894, 'f1': 0.6617011, 'auroc': 0.852662, 'binary_precision': 0.45915493, 'binary_recall': 0.2707641, 'binary_specificity': 0.9894337, 'binary_f1_score': 0.34064782}
confusion matrix:
       0    1
0  17979  192
1    439  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9580061, 'precision': 0.6846043, 'recall': 0.5796249, 'specificity': 0.5796249, 'f1': 0.6083899, 'auroc': 0.8038077, 'binary_precision': 0.4019608, 'binary_recall': 0.1694215, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.23837209}
confusion matrix:
      0   1
0  5936  61
1   201  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_21.png
early stop counter: 19
val acc:0.9663878679275513, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 21,now: 2024-06-22 03:38:30.818561,epoch time: 0:10:23.754534,used: 3:38:13.052511,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99248636, 'precision': 0.9825773, 'recall': 0.9742056, 'specificity': 0.9742056, 'f1': 0.9783449, 'auroc': 0.99729514, 'binary_precision': 0.97034377, 'binary_recall': 0.9515312, 'binary_specificity': 0.9968801, 'binary_f1_score': 0.9608454}
confusion matrix:
       0     1
0  42177   132
1    220  4319
---- Validation: 
scalar performance:
{'acc': 0.96585524, 'precision': 0.71253145, 'recall': 0.6354451, 'specificity': 0.6354451, 'f1': 0.66452736, 'auroc': 0.85378826, 'binary_precision': 0.44854882, 'binary_recall': 0.28239202, 'binary_specificity': 0.98849815, 'binary_f1_score': 0.34658512}
confusion matrix:
       0    1
0  17962  209
1    432  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95512104, 'precision': 0.6484493, 'recall': 0.5701932, 'specificity': 0.5701932, 'f1': 0.5929724, 'auroc': 0.81077313, 'binary_precision': 0.33035713, 'binary_recall': 0.15289256, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.20903954}
confusion matrix:
      0   1
0  5922  75
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520820_22.png
early stop counter: 20
val acc:0.9658552408218384, best validation acc: 0.969317615032196, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 22,now: 2024-06-22 03:48:54.706090,epoch time: 0:10:23.887529,used: 3:48:36.940040,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_00_00_17_seed_2_21520820
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 22 with time: 3:48:36.940040 at 2024-06-22 03:48:54.706090
persisted model performance metric: 

scalar performance:
{'acc': 0.9681039, 'precision': 0.84059775, 'recall': 0.6483252, 'specificity': 0.6483252, 'f1': 0.70339346, 'auroc': 0.7973604, 'binary_precision': 0.70873785, 'binary_recall': 0.30165288, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.4231884}
confusion matrix:
      0   1
0  5967  30
1   169  73
oracle model performance metric: 

scalar performance:
{'acc': 0.9681039, 'precision': 0.84059775, 'recall': 0.6483252, 'specificity': 0.6483252, 'f1': 0.70339346, 'auroc': 0.7973604, 'binary_precision': 0.70873785, 'binary_recall': 0.30165288, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.4231884}
confusion matrix:
      0   1
0  5967  30
1   169  73
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre4_classbalancing3/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204077 KiB | 640729 KiB |   2710 TiB |   2710 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   2710 TiB |   2710 TiB |
|       from small pool |  37037 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204077 KiB | 640729 KiB |   2710 TiB |   2710 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   2710 TiB |   2710 TiB |
|       from small pool |  37037 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB | 632296 KiB |   2698 TiB |   2698 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   2697 TiB |   2697 TiB |
|       from small pool |  35967 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 675840 KiB | 755712 KiB |   1502 MiB |    842 MiB |
|       from large pool | 600064 KiB | 679936 KiB |   1376 MiB |    790 MiB |
|       from small pool |  75776 KiB |  75776 KiB |    126 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  80594 KiB | 218089 KiB |    974 TiB |    974 TiB |
|       from large pool |  68480 KiB | 217080 KiB |    974 TiB |    974 TiB |
|       from small pool |  12114 KiB |  19715 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3240    |    6605    |  239972 K  |  239968 K  |
|       from large pool |      36    |      76    |   97097 K  |   97096 K  |
|       from small pool |    3204    |    6568    |  142875 K  |  142871 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3240    |    6605    |  239972 K  |  239968 K  |
|       from large pool |      36    |      76    |   97097 K  |   97096 K  |
|       from small pool |    3204    |    6568    |  142875 K  |  142871 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      85    |      34    |
|       from large pool |      14    |      14    |      22    |       8    |
|       from small pool |      37    |      37    |      63    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    2942    |  109890 K  |  109890 K  |
|       from large pool |       5    |      13    |   36758 K  |   36758 K  |
|       from small pool |      32    |    2937    |   73132 K  |   73132 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   2710 TiB |   2710 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2710 TiB |   2710 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   2710 TiB |   2710 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2710 TiB |   2710 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   2698 TiB |   2698 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   2697 TiB |   2697 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1502 MiB |   1224 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1376 MiB |   1146 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    126 MiB |     78 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB |    974 TiB |    974 TiB |
|       from large pool |  55040 KiB | 217080 KiB |    974 TiB |    974 TiB |
|       from small pool |      0 KiB |  19715 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6605    |  239972 K  |  239972 K  |
|       from large pool |       2    |      76    |   97097 K  |   97097 K  |
|       from small pool |       0    |    6568    |  142875 K  |  142875 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6605    |  239972 K  |  239972 K  |
|       from large pool |       2    |      76    |   97097 K  |   97097 K  |
|       from small pool |       0    |    6568    |  142875 K  |  142875 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      85    |      51    |
|       from large pool |      10    |      14    |      22    |      12    |
|       from small pool |      24    |      37    |      63    |      39    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2942    |  109892 K  |  109892 K  |
|       from large pool |       3    |      13    |   36758 K  |   36758 K  |
|       from small pool |       0    |    2937    |   73133 K  |   73133 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jun 22 03:49:43 2024]
Finished job 0.
1 of 1 steps (100%) done
