Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed May 29 13:26:15 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756

 Experiment start at: 2024-05-29 13:39:15.130790
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9707024, 'precision': 0.7880384, 'recall': 0.69218546, 'specificity': 0.69218546, 'f1': 0.7296635, 'auroc': 0.9452722, 'binary_precision': 0.5969072, 'binary_recall': 0.3936098, 'binary_specificity': 0.9907611, 'binary_f1_score': 0.47439572}
confusion matrix:
       0    1
0  41930  391
1    892  579
---- Validation: 
scalar performance:
{'acc': 0.96977437, 'precision': 0.79884875, 'recall': 0.6453268, 'specificity': 0.6453268, 'f1': 0.69330025, 'auroc': 0.9491192, 'binary_precision': 0.6221498, 'binary_recall': 0.2970451, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.40210527}
confusion matrix:
       0    1
0  18033  116
1    452  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8428831, 'recall': 0.624269, 'specificity': 0.624269, 'f1': 0.67788386, 'auroc': 0.9296609, 'binary_precision': 0.7173913, 'binary_recall': 0.25287357, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.37393767}
confusion matrix:
      0   1
0  5971  26
1   195  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-29 14:11:17.754194,epoch time: 0:32:02.623404,used: 0:32:02.623404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9755663, 'precision': 0.8484416, 'recall': 0.7234316, 'specificity': 0.7234316, 'f1': 0.7711735, 'auroc': 0.965044, 'binary_precision': 0.7156652, 'binary_recall': 0.453125, 'binary_specificity': 0.9937382, 'binary_f1_score': 0.5549085}
confusion matrix:
       0    1
0  42055  265
1    805  667
---- Validation: 
scalar performance:
{'acc': 0.97451043, 'precision': 0.82006055, 'recall': 0.7625371, 'specificity': 0.7625371, 'f1': 0.7881963, 'auroc': 0.9617071, 'binary_precision': 0.65648854, 'binary_recall': 0.5349922, 'binary_specificity': 0.9900821, 'binary_f1_score': 0.58954585}
confusion matrix:
       0    1
0  17969  180
1    299  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9741131, 'precision': 0.9490812, 'recall': 0.7061462, 'specificity': 0.7061462, 'f1': 0.77904105, 'auroc': 0.9471602, 'binary_precision': 0.9230769, 'binary_recall': 0.41379312, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.57142854}
confusion matrix:
      0    1
0  5988    9
1   153  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-29 14:43:40.251586,epoch time: 0:32:22.497392,used: 1:04:25.120796,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97643405, 'precision': 0.87172973, 'recall': 0.7141801, 'specificity': 0.7141801, 'f1': 0.7701851, 'auroc': 0.96802914, 'binary_precision': 0.76287425, 'binary_recall': 0.43303874, 'binary_specificity': 0.99532145, 'binary_f1_score': 0.5524718}
confusion matrix:
       0    1
0  42123  198
1    834  637
---- Validation: 
scalar performance:
{'acc': 0.9752022, 'precision': 0.8644239, 'recall': 0.704391, 'specificity': 0.704391, 'f1': 0.7601645, 'auroc': 0.96462643, 'binary_precision': 0.7492958, 'binary_recall': 0.41368586, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.53306615}
confusion matrix:
       0    1
0  18060   89
1    377  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97331417, 'precision': 0.9186119, 'recall': 0.71305865, 'specificity': 0.71305865, 'f1': 0.7795584, 'auroc': 0.9525819, 'binary_precision': 0.86153847, 'binary_recall': 0.42911878, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.57289004}
confusion matrix:
      0    1
0  5979   18
1   149  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 3,now: 2024-05-29 15:14:49.732309,epoch time: 0:31:09.480723,used: 1:35:34.601519,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97953963, 'precision': 0.8917818, 'recall': 0.7586011, 'specificity': 0.7586011, 'f1': 0.8105283, 'auroc': 0.9729263, 'binary_precision': 0.8, 'binary_recall': 0.5217391, 'binary_specificity': 0.99546313, 'binary_f1_score': 0.6315789}
confusion matrix:
       0    1
0  42128  192
1    704  768
---- Validation: 
scalar performance:
{'acc': 0.97765005, 'precision': 0.92735624, 'recall': 0.701158, 'specificity': 0.701158, 'f1': 0.77086496, 'auroc': 0.96816576, 'binary_precision': 0.87542087, 'binary_recall': 0.4043546, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.5531915}
confusion matrix:
       0    1
0  18112   37
1    383  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.937726, 'recall': 0.62968457, 'specificity': 0.62968457, 'f1': 0.6941708, 'auroc': 0.9449262, 'binary_precision': 0.9066667, 'binary_recall': 0.2605364, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.4047619}
confusion matrix:
      0   1
0  5990   7
1   193  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 4,now: 2024-05-29 15:46:13.531399,epoch time: 0:31:23.799090,used: 2:06:58.400609,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9782837, 'precision': 0.8168296, 'recall': 0.8956522, 'specificity': 0.8956522, 'f1': 0.85143507, 'auroc': 0.97386634, 'binary_precision': 0.6404313, 'binary_recall': 0.8070652, 'binary_specificity': 0.9842391, 'binary_f1_score': 0.7141569}
confusion matrix:
       0     1
0  41653   667
1    284  1188
---- Validation: 
scalar performance:
{'acc': 0.98094934, 'precision': 0.8516321, 'recall': 0.86637807, 'specificity': 0.86637807, 'f1': 0.8588396, 'auroc': 0.9721302, 'binary_precision': 0.7123696, 'binary_recall': 0.7433904, 'binary_specificity': 0.9893658, 'binary_f1_score': 0.7275495}
confusion matrix:
       0    1
0  17956  193
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.8184469, 'recall': 0.7714413, 'specificity': 0.7714413, 'f1': 0.79285246, 'auroc': 0.95281506, 'binary_precision': 0.6561086, 'binary_recall': 0.5555556, 'binary_specificity': 0.987327, 'binary_f1_score': 0.6016598}
confusion matrix:
      0    1
0  5921   76
1   116  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 5,now: 2024-05-29 16:17:31.886755,epoch time: 0:31:18.355356,used: 2:38:16.755965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9782609, 'precision': 0.9350041, 'recall': 0.70056415, 'specificity': 0.70056415, 'f1': 0.7717913, 'auroc': 0.97571206, 'binary_precision': 0.8903904, 'binary_recall': 0.40285325, 'binary_specificity': 0.99827504, 'binary_f1_score': 0.55472404}
confusion matrix:
       0    1
0  42247   73
1    879  593
---- Validation: 
scalar performance:
{'acc': 0.9731269, 'precision': 0.94715995, 'recall': 0.6170602, 'specificity': 0.6170602, 'f1': 0.68024707, 'auroc': 0.9715295, 'binary_precision': 0.9207317, 'binary_recall': 0.2348367, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.37422556}
confusion matrix:
       0    1
0  18136   13
1    492  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.932904, 'recall': 0.5533897, 'specificity': 0.5533897, 'f1': 0.58623725, 'auroc': 0.9512991, 'binary_precision': 0.9032258, 'binary_recall': 0.107279696, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.19178084}
confusion matrix:
      0   1
0  5994   3
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.9731268882751465, best validation acc: 0.980949342250824, corresponding to test acc:                         0.9693192839622498 / 0.9741131067276001
after epoch: 6,now: 2024-05-29 16:49:40.094158,epoch time: 0:32:08.207403,used: 3:10:24.963368,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.979631, 'precision': 0.95977455, 'recall': 0.7099285, 'specificity': 0.7099285, 'f1': 0.7853912, 'auroc': 0.9799076, 'binary_precision': 0.93930197, 'binary_recall': 0.42080218, 'binary_specificity': 0.99905485, 'binary_f1_score': 0.5812207}
confusion matrix:
       0    1
0  42281   40
1    852  619
---- Validation: 
scalar performance:
{'acc': 0.9755215, 'precision': 0.96326554, 'recall': 0.64980227, 'specificity': 0.64980227, 'f1': 0.72187185, 'auroc': 0.9710813, 'binary_precision': 0.9507389, 'binary_recall': 0.30015552, 'binary_specificity': 0.999449, 'binary_f1_score': 0.4562648}
confusion matrix:
       0    1
0  18139   10
1    450  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.9802979, 'recall': 0.52873564, 'specificity': 0.52873564, 'f1': 0.5442988, 'auroc': 0.9423293, 'binary_precision': 1.0, 'binary_recall': 0.057471264, 'binary_specificity': 1.0, 'binary_f1_score': 0.10869565}
confusion matrix:
      0   1
0  5997   0
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 2
val acc:0.9755215048789978, best validation acc: 0.980949342250824, corresponding to test acc:                         0.9693192839622498 / 0.9741131067276001
after epoch: 7,now: 2024-05-29 17:20:52.178671,epoch time: 0:31:12.084513,used: 3:41:37.047881,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98362714, 'precision': 0.92596143, 'recall': 0.8020262, 'specificity': 0.8020262, 'f1': 0.85267246, 'auroc': 0.98064315, 'binary_precision': 0.8654405, 'binary_recall': 0.60733694, 'binary_specificity': 0.9967155, 'binary_f1_score': 0.7137725}
confusion matrix:
       0    1
0  42181  139
1    578  894
---- Validation: 
scalar performance:
{'acc': 0.97993827, 'precision': 0.9267762, 'recall': 0.74134547, 'specificity': 0.74134547, 'f1': 0.8065357, 'auroc': 0.9764151, 'binary_precision': 0.87150836, 'binary_recall': 0.4852255, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.62337667}
confusion matrix:
       0    1
0  18103   46
1    331  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.9026443, 'recall': 0.5608024, 'specificity': 0.5608024, 'f1': 0.5974057, 'auroc': 0.9542704, 'binary_precision': 0.84210527, 'binary_recall': 0.12260536, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.21404682}
confusion matrix:
      0   1
0  5991   6
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 3
val acc:0.979938268661499, best validation acc: 0.980949342250824, corresponding to test acc:                         0.9693192839622498 / 0.9741131067276001
after epoch: 8,now: 2024-05-29 17:53:59.529821,epoch time: 0:33:07.351150,used: 4:14:44.399031,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98323894, 'precision': 0.9392979, 'recall': 0.78346527, 'specificity': 0.78346527, 'f1': 0.84340906, 'auroc': 0.9817146, 'binary_precision': 0.8933902, 'binary_recall': 0.5692935, 'binary_specificity': 0.99763703, 'binary_f1_score': 0.69543576}
confusion matrix:
       0    1
0  42220  100
1    634  838
---- Validation: 
scalar performance:
{'acc': 0.9790868, 'precision': 0.9511465, 'recall': 0.7116525, 'specificity': 0.7116525, 'f1': 0.78537256, 'auroc': 0.9763398, 'binary_precision': 0.9222973, 'binary_recall': 0.42457232, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.58146966}
confusion matrix:
       0    1
0  18126   23
1    370  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8973372, 'recall': 0.5379807, 'specificity': 0.5379807, 'f1': 0.5601599, 'auroc': 0.95004946, 'binary_precision': 0.8333333, 'binary_recall': 0.07662835, 'binary_specificity': 0.999333, 'binary_f1_score': 0.14035088}
confusion matrix:
      0   1
0  5993   4
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 4
val acc:0.9790868163108826, best validation acc: 0.980949342250824, corresponding to test acc:                         0.9693192839622498 / 0.9741131067276001
after epoch: 9,now: 2024-05-29 18:25:21.127499,epoch time: 0:31:21.597678,used: 4:46:05.996709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98419803, 'precision': 0.90379316, 'recall': 0.8377304, 'specificity': 0.8377304, 'f1': 0.8675857, 'auroc': 0.98375297, 'binary_precision': 0.8186275, 'binary_recall': 0.6807065, 'binary_specificity': 0.99475425, 'binary_f1_score': 0.7433234}
confusion matrix:
       0     1
0  42098   222
1    470  1002
---- Validation: 
scalar performance:
{'acc': 0.9828118, 'precision': 0.9304429, 'recall': 0.7885865, 'specificity': 0.7885865, 'f1': 0.8445014, 'auroc': 0.97800076, 'binary_precision': 0.87558687, 'binary_recall': 0.5800933, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.6978485}
confusion matrix:
       0    1
0  18096   53
1    270  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.93054783, 'recall': 0.5667163, 'specificity': 0.5667163, 'f1': 0.6072528, 'auroc': 0.9529817, 'binary_precision': 0.8974359, 'binary_recall': 0.13409962, 'binary_specificity': 0.999333, 'binary_f1_score': 0.23333333}
confusion matrix:
      0   1
0  5993   4
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 10,now: 2024-05-29 18:56:12.789547,epoch time: 0:30:51.662048,used: 5:16:57.658757,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98517996, 'precision': 0.90164906, 'recall': 0.860112, 'specificity': 0.860112, 'f1': 0.87965626, 'auroc': 0.98552173, 'binary_precision': 0.8127854, 'binary_recall': 0.7260367, 'binary_specificity': 0.9941873, 'binary_f1_score': 0.76696587}
confusion matrix:
       0     1
0  42075   246
1    403  1068
---- Validation: 
scalar performance:
{'acc': 0.98185396, 'precision': 0.89496493, 'recall': 0.8083421, 'specificity': 0.8083421, 'f1': 0.8458911, 'auroc': 0.9739945, 'binary_precision': 0.8032129, 'binary_recall': 0.62208396, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.7011394}
confusion matrix:
       0    1
0  18051   98
1    243  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.8870101, 'recall': 0.6402617, 'specificity': 0.6402617, 'f1': 0.70120454, 'auroc': 0.96092844, 'binary_precision': 0.8043478, 'binary_recall': 0.2835249, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.41926342}
confusion matrix:
      0   1
0  5979  18
1   187  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.9818539619445801, best validation acc: 0.9828118085861206, corresponding to test acc:                         0.9632470607757568 / 0.9741131067276001
after epoch: 11,now: 2024-05-29 19:27:09.354055,epoch time: 0:30:56.564508,used: 5:47:54.223265,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9859335, 'precision': 0.93403757, 'recall': 0.83523893, 'specificity': 0.83523893, 'f1': 0.8778232, 'auroc': 0.98534775, 'binary_precision': 0.8793256, 'binary_recall': 0.6736914, 'binary_specificity': 0.9967865, 'binary_f1_score': 0.7628946}
confusion matrix:
       0    1
0  42185  136
1    480  991
---- Validation: 
scalar performance:
{'acc': 0.9811622, 'precision': 0.9322424, 'recall': 0.7584803, 'specificity': 0.7584803, 'f1': 0.8219691, 'auroc': 0.9762797, 'binary_precision': 0.8812665, 'binary_recall': 0.5194401, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.65362036}
confusion matrix:
       0    1
0  18104   45
1    309  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.88781273, 'recall': 0.59670067, 'specificity': 0.59670067, 'f1': 0.6483031, 'auroc': 0.96104723, 'binary_precision': 0.8095238, 'binary_recall': 0.1954023, 'binary_specificity': 0.997999, 'binary_f1_score': 0.31481484}
confusion matrix:
      0   1
0  5985  12
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 2
val acc:0.9811621904373169, best validation acc: 0.9828118085861206, corresponding to test acc:                         0.9632470607757568 / 0.9741131067276001
after epoch: 12,now: 2024-05-29 19:57:39.881941,epoch time: 0:30:30.527886,used: 6:18:24.751151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98323894, 'precision': 0.84810656, 'recall': 0.9309596, 'specificity': 0.9309596, 'f1': 0.8847021, 'auroc': 0.9864582, 'binary_precision': 0.7005988, 'binary_recall': 0.874915, 'binary_specificity': 0.9870041, 'binary_f1_score': 0.7781136}
confusion matrix:
       0     1
0  41771   550
1    184  1287
---- Validation: 
scalar performance:
{'acc': 0.9830779, 'precision': 0.85796547, 'recall': 0.9049828, 'specificity': 0.9049828, 'f1': 0.8798884, 'auroc': 0.97851664, 'binary_precision': 0.7222982, 'binary_recall': 0.82115084, 'binary_specificity': 0.98881483, 'binary_f1_score': 0.768559}
confusion matrix:
       0    1
0  17946  203
1    115  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.8093895, 'recall': 0.60852647, 'specificity': 0.60852647, 'f1': 0.6560973, 'auroc': 0.9542829, 'binary_precision': 0.6516854, 'binary_recall': 0.22222222, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.33142856}
confusion matrix:
      0   1
0  5966  31
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 13,now: 2024-05-29 20:28:20.932421,epoch time: 0:30:41.050480,used: 6:49:05.801631,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9872808, 'precision': 0.94869816, 'recall': 0.8444663, 'specificity': 0.8444663, 'f1': 0.88923573, 'auroc': 0.9880065, 'binary_precision': 0.9080357, 'binary_recall': 0.69136643, 'binary_specificity': 0.9975662, 'binary_f1_score': 0.78502506}
confusion matrix:
       0     1
0  42218   103
1    454  1017
---- Validation: 
scalar performance:
{'acc': 0.98286504, 'precision': 0.9240391, 'recall': 0.7953646, 'specificity': 0.7953646, 'f1': 0.8473383, 'auroc': 0.9752312, 'binary_precision': 0.8623025, 'binary_recall': 0.5940902, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.7034991}
confusion matrix:
       0    1
0  18088   61
1    261  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.8259777, 'recall': 0.5169079, 'specificity': 0.5169079, 'f1': 0.5223909, 'auroc': 0.9474674, 'binary_precision': 0.6923077, 'binary_recall': 0.03448276, 'binary_specificity': 0.999333, 'binary_f1_score': 0.06569343}
confusion matrix:
      0  1
0  5993  4
1   252  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.982865035533905, best validation acc: 0.983077883720398, corresponding to test acc:                         0.9626078605651855 / 0.9741131067276001
after epoch: 14,now: 2024-05-29 20:58:45.519230,epoch time: 0:30:24.586809,used: 7:19:30.388440,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98732644, 'precision': 0.931795, 'recall': 0.8625349, 'specificity': 0.8625349, 'f1': 0.89391506, 'auroc': 0.98914087, 'binary_precision': 0.87296414, 'binary_recall': 0.72875595, 'binary_specificity': 0.99631387, 'binary_f1_score': 0.7943683}
confusion matrix:
       0     1
0  42165   156
1    399  1072
---- Validation: 
scalar performance:
{'acc': 0.98291826, 'precision': 0.921118, 'recall': 0.79914236, 'specificity': 0.79914236, 'f1': 0.8490261, 'auroc': 0.9756026, 'binary_precision': 0.8561947, 'binary_recall': 0.60186625, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.70684934}
confusion matrix:
       0    1
0  18084   65
1    256  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.852034, 'recall': 0.59053665, 'specificity': 0.59053665, 'f1': 0.63780534, 'auroc': 0.9557288, 'binary_precision': 0.73846155, 'binary_recall': 0.18390805, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.29447854}
confusion matrix:
      0   1
0  5980  17
1   213  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 2
val acc:0.9829182624816895, best validation acc: 0.983077883720398, corresponding to test acc:                         0.9626078605651855 / 0.9741131067276001
after epoch: 15,now: 2024-05-29 21:29:23.960914,epoch time: 0:30:38.441684,used: 7:50:08.830124,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98714375, 'precision': 0.9281164, 'recall': 0.86342466, 'specificity': 0.86342466, 'f1': 0.8929236, 'auroc': 0.98902917, 'binary_precision': 0.86553943, 'binary_recall': 0.7307954, 'binary_specificity': 0.996054, 'binary_f1_score': 0.79248065}
confusion matrix:
       0     1
0  42154   167
1    396  1075
---- Validation: 
scalar performance:
{'acc': 0.9835568, 'precision': 0.93448603, 'recall': 0.7979729, 'specificity': 0.7979729, 'f1': 0.8525796, 'auroc': 0.9741416, 'binary_precision': 0.8830275, 'binary_recall': 0.59875584, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.7136237}
confusion matrix:
       0    1
0  18098   51
1    258  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.88097304, 'recall': 0.54547673, 'specificity': 0.54547673, 'f1': 0.5725356, 'auroc': 0.9497001, 'binary_precision': 0.8, 'binary_recall': 0.09195402, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.16494845}
confusion matrix:
      0   1
0  5991   6
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 16,now: 2024-05-29 22:00:01.626202,epoch time: 0:30:37.665288,used: 8:20:46.495412,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9886052, 'precision': 0.91501284, 'recall': 0.90820533, 'specificity': 0.90820533, 'f1': 0.9115786, 'auroc': 0.9900885, 'binary_precision': 0.8362129, 'binary_recall': 0.8220109, 'binary_specificity': 0.9943998, 'binary_f1_score': 0.8290511}
confusion matrix:
       0     1
0  42083   237
1    262  1210
---- Validation: 
scalar performance:
{'acc': 0.9857918, 'precision': 0.92746305, 'recall': 0.84413326, 'specificity': 0.84413326, 'f1': 0.88095057, 'auroc': 0.9791626, 'binary_precision': 0.8657588, 'binary_recall': 0.69206846, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.76923084}
confusion matrix:
       0    1
0  18080   69
1    198  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9005033, 'recall': 0.5683819, 'specificity': 0.5683819, 'f1': 0.60892224, 'auroc': 0.955989, 'binary_precision': 0.8372093, 'binary_recall': 0.13793103, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.23684211}
confusion matrix:
      0   1
0  5990   7
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 17,now: 2024-05-29 22:30:30.460170,epoch time: 0:30:28.833968,used: 8:51:15.329380,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9872351, 'precision': 0.93609774, 'recall': 0.8563504, 'specificity': 0.8563504, 'f1': 0.8919092, 'auroc': 0.98998797, 'binary_precision': 0.8820084, 'binary_recall': 0.7160326, 'binary_specificity': 0.9966682, 'binary_f1_score': 0.7904012}
confusion matrix:
       0     1
0  42179   141
1    418  1054
---- Validation: 
scalar performance:
{'acc': 0.98440826, 'precision': 0.9465991, 'recall': 0.80216396, 'specificity': 0.80216396, 'f1': 0.8594544, 'auroc': 0.9797353, 'binary_precision': 0.90697676, 'binary_recall': 0.60653186, 'binary_specificity': 0.997796, 'binary_f1_score': 0.72693384}
confusion matrix:
       0    1
0  18109   40
1    253  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.9054425, 'recall': 0.5323169, 'specificity': 0.5323169, 'f1': 0.55040425, 'auroc': 0.939789, 'binary_precision': 0.85, 'binary_recall': 0.0651341, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.12099644}
confusion matrix:
      0   1
0  5994   3
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.9844082593917847, best validation acc: 0.985791802406311, corresponding to test acc:                         0.9629274606704712 / 0.9741131067276001
after epoch: 18,now: 2024-05-29 23:01:06.483002,epoch time: 0:30:36.022832,used: 9:21:51.352212,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9883312, 'precision': 0.9497282, 'recall': 0.86150753, 'specificity': 0.86150753, 'f1': 0.9004675, 'auroc': 0.9920256, 'binary_precision': 0.90893614, 'binary_recall': 0.7255435, 'binary_specificity': 0.99747163, 'binary_f1_score': 0.8069513}
confusion matrix:
       0     1
0  42213   107
1    404  1068
---- Validation: 
scalar performance:
{'acc': 0.9830779, 'precision': 0.93927705, 'recall': 0.78572404, 'specificity': 0.78572404, 'f1': 0.84507895, 'auroc': 0.98024875, 'binary_precision': 0.8934625, 'binary_recall': 0.57387245, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.6988636}
confusion matrix:
       0    1
0  18105   44
1    274  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.89589787, 'recall': 0.5816251, 'specificity': 0.5816251, 'f1': 0.6280792, 'auroc': 0.9484322, 'binary_precision': 0.8269231, 'binary_recall': 0.16475096, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.27476037}
confusion matrix:
      0   1
0  5988   9
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 2
val acc:0.983077883720398, best validation acc: 0.985791802406311, corresponding to test acc:                         0.9629274606704712 / 0.9741131067276001
after epoch: 19,now: 2024-05-29 23:31:33.026942,epoch time: 0:30:26.543940,used: 9:52:17.896152,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9897698, 'precision': 0.93467116, 'recall': 0.90323424, 'specificity': 0.90323424, 'f1': 0.9183167, 'auroc': 0.992563, 'binary_precision': 0.8759178, 'binary_recall': 0.81046194, 'binary_specificity': 0.9960066, 'binary_f1_score': 0.8419196}
confusion matrix:
       0     1
0  42151   169
1    279  1193
---- Validation: 
scalar performance:
{'acc': 0.98499364, 'precision': 0.92029107, 'recall': 0.83771956, 'specificity': 0.83771956, 'f1': 0.8741571, 'auroc': 0.98019505, 'binary_precision': 0.8518519, 'binary_recall': 0.67962676, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.7560554}
confusion matrix:
       0    1
0  18073   76
1    206  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8941233, 'recall': 0.5797094, 'specificity': 0.5797094, 'f1': 0.6252742, 'auroc': 0.9349589, 'binary_precision': 0.8235294, 'binary_recall': 0.16091955, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.26923078}
confusion matrix:
      0   1
0  5988   9
1   219  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 3
val acc:0.9849936366081238, best validation acc: 0.985791802406311, corresponding to test acc:                         0.9629274606704712 / 0.9741131067276001
after epoch: 20,now: 2024-05-30 00:02:15.079634,epoch time: 0:30:42.052692,used: 10:22:59.948844,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9893588, 'precision': 0.9432076, 'recall': 0.885973, 'specificity': 0.885973, 'f1': 0.9124646, 'auroc': 0.99226224, 'binary_precision': 0.8942006, 'binary_recall': 0.7751359, 'binary_specificity': 0.99681, 'binary_f1_score': 0.8304221}
confusion matrix:
       0     1
0  42185   135
1    331  1141
---- Validation: 
scalar performance:
{'acc': 0.9853129, 'precision': 0.9246491, 'recall': 0.83863497, 'specificity': 0.83863497, 'f1': 0.8764205, 'auroc': 0.978773, 'binary_precision': 0.8605108, 'binary_recall': 0.68118197, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.76041675}
confusion matrix:
       0    1
0  18078   71
1    205  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8541469, 'recall': 0.56604934, 'specificity': 0.56604934, 'f1': 0.6038887, 'auroc': 0.9468398, 'binary_precision': 0.7446808, 'binary_recall': 0.13409962, 'binary_specificity': 0.997999, 'binary_f1_score': 0.22727273}
confusion matrix:
      0   1
0  5985  12
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 4
val acc:0.9853128790855408, best validation acc: 0.985791802406311, corresponding to test acc:                         0.9629274606704712 / 0.9741131067276001
after epoch: 21,now: 2024-05-30 00:32:47.844235,epoch time: 0:30:32.764601,used: 10:53:32.713445,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9897698, 'precision': 0.96398866, 'recall': 0.87191486, 'specificity': 0.87191486, 'f1': 0.91251445, 'auroc': 0.9930172, 'binary_precision': 0.93675214, 'binary_recall': 0.7455782, 'binary_specificity': 0.9982515, 'binary_f1_score': 0.8303031}
confusion matrix:
       0     1
0  42248    74
1    374  1096
---- Validation: 
scalar performance:
{'acc': 0.9844615, 'precision': 0.93308693, 'recall': 0.8149425, 'specificity': 0.8149425, 'f1': 0.86399037, 'auroc': 0.98271024, 'binary_precision': 0.87904966, 'binary_recall': 0.63297045, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.7359855}
confusion matrix:
       0    1
0  18093   56
1    236  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8639338, 'recall': 0.5850397, 'specificity': 0.5850397, 'f1': 0.63119566, 'auroc': 0.953893, 'binary_precision': 0.7627119, 'binary_recall': 0.1724138, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.28125}
confusion matrix:
      0   1
0  5983  14
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 5
val acc:0.9844614863395691, best validation acc: 0.985791802406311, corresponding to test acc:                         0.9629274606704712 / 0.9741131067276001
after epoch: 22,now: 2024-05-30 01:03:20.690219,epoch time: 0:30:32.845984,used: 11:24:05.559429,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9900438, 'precision': 0.9498769, 'recall': 0.89058954, 'specificity': 0.89058954, 'f1': 0.91798437, 'auroc': 0.995005, 'binary_precision': 0.9072327, 'binary_recall': 0.7839674, 'binary_specificity': 0.9972117, 'binary_f1_score': 0.8411079}
confusion matrix:
       0     1
0  42202   118
1    318  1154
---- Validation: 
scalar performance:
{'acc': 0.9845147, 'precision': 0.93484026, 'recall': 0.81421995, 'specificity': 0.81421995, 'f1': 0.86409867, 'auroc': 0.9742456, 'binary_precision': 0.8826087, 'binary_recall': 0.63141525, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.73617405}
confusion matrix:
       0    1
0  18095   54
1    237  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.9226193, 'recall': 0.5571378, 'specificity': 0.5571378, 'f1': 0.59208035, 'auroc': 0.90731204, 'binary_precision': 0.88235295, 'binary_recall': 0.11494253, 'binary_specificity': 0.999333, 'binary_f1_score': 0.20338982}
confusion matrix:
      0   1
0  5993   4
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 6
val acc:0.9845147132873535, best validation acc: 0.985791802406311, corresponding to test acc:                         0.9629274606704712 / 0.9741131067276001
after epoch: 23,now: 2024-05-30 01:33:47.530741,epoch time: 0:30:26.840522,used: 11:54:32.399951,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99075174, 'precision': 0.9471613, 'recall': 0.90564644, 'specificity': 0.90564644, 'f1': 0.9253159, 'auroc': 0.9946643, 'binary_precision': 0.9007519, 'binary_recall': 0.81441194, 'binary_specificity': 0.996881, 'binary_f1_score': 0.8554088}
confusion matrix:
       0     1
0  42189   132
1    273  1198
---- Validation: 
scalar performance:
{'acc': 0.98621756, 'precision': 0.91386616, 'recall': 0.86835545, 'specificity': 0.86835545, 'f1': 0.8896794, 'auroc': 0.98077583, 'binary_precision': 0.8368421, 'binary_recall': 0.7418352, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.78647983}
confusion matrix:
       0    1
0  18056   93
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8782606, 'recall': 0.55114055, 'specificity': 0.55114055, 'f1': 0.58166534, 'auroc': 0.93446195, 'binary_precision': 0.7941176, 'binary_recall': 0.10344828, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.18305086}
confusion matrix:
      0   1
0  5990   7
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 24,now: 2024-05-30 02:04:21.681941,epoch time: 0:30:34.151200,used: 12:25:06.551151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99066037, 'precision': 0.95207083, 'recall': 0.8987772, 'specificity': 0.8987772, 'f1': 0.9236287, 'auroc': 0.99516577, 'binary_precision': 0.91105956, 'binary_recall': 0.80027175, 'binary_specificity': 0.9972826, 'binary_f1_score': 0.8520795}
confusion matrix:
       0     1
0  42205   115
1    294  1178
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.9350519, 'recall': 0.83432746, 'specificity': 0.83432746, 'f1': 0.87759876, 'auroc': 0.98185086, 'binary_precision': 0.8816326, 'binary_recall': 0.6718507, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.7625773}
confusion matrix:
       0    1
0  18091   58
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.9204087, 'recall': 0.5932861, 'specificity': 0.5932861, 'f1': 0.64559793, 'auroc': 0.92849624, 'binary_precision': 0.875, 'binary_recall': 0.18773946, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.30914825}
confusion matrix:
      0   1
0  5990   7
1   212  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.985685408115387, best validation acc: 0.9862175583839417, corresponding to test acc:                         0.9614893198013306 / 0.9741131067276001
after epoch: 25,now: 2024-05-30 02:34:59.341367,epoch time: 0:30:37.659426,used: 12:55:44.210577,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9888107, 'precision': 0.9080419, 'recall': 0.9230153, 'specificity': 0.9230153, 'f1': 0.9153824, 'auroc': 0.99342686, 'binary_precision': 0.8212181, 'binary_recall': 0.8524813, 'binary_specificity': 0.9935493, 'binary_f1_score': 0.8365577}
confusion matrix:
       0     1
0  42048   273
1    217  1254
---- Validation: 
scalar performance:
{'acc': 0.9850468, 'precision': 0.8917855, 'recall': 0.8782501, 'specificity': 0.8782501, 'f1': 0.88488865, 'auroc': 0.98081243, 'binary_precision': 0.7919355, 'binary_recall': 0.7636081, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.7775138}
confusion matrix:
       0    1
0  18020  129
1    152  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.89065933, 'recall': 0.6081115, 'specificity': 0.6081115, 'f1': 0.66330105, 'auroc': 0.9497992, 'binary_precision': 0.8142857, 'binary_recall': 0.21839081, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.3444109}
confusion matrix:
      0   1
0  5984  13
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 2
val acc:0.9850468039512634, best validation acc: 0.9862175583839417, corresponding to test acc:                         0.9614893198013306 / 0.9741131067276001
after epoch: 26,now: 2024-05-30 03:05:34.299498,epoch time: 0:30:34.958131,used: 13:26:19.168708,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9913683, 'precision': 0.93119514, 'recall': 0.9368472, 'specificity': 0.9368472, 'f1': 0.9340013, 'auroc': 0.99544895, 'binary_precision': 0.866622, 'binary_recall': 0.87839675, 'binary_specificity': 0.99529773, 'binary_f1_score': 0.8724696}
confusion matrix:
       0     1
0  42121   199
1    179  1293
---- Validation: 
scalar performance:
{'acc': 0.9853661, 'precision': 0.8989633, 'recall': 0.873165, 'specificity': 0.873165, 'f1': 0.88559693, 'auroc': 0.98307467, 'binary_precision': 0.8066667, 'binary_recall': 0.7527216, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.7787611}
confusion matrix:
       0    1
0  18033  116
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.85115063, 'recall': 0.63951135, 'specificity': 0.63951135, 'f1': 0.6956162, 'auroc': 0.9513109, 'binary_precision': 0.7326733, 'binary_recall': 0.2835249, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.4088398}
confusion matrix:
      0   1
0  5970  27
1   187  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 3
val acc:0.9853661060333252, best validation acc: 0.9862175583839417, corresponding to test acc:                         0.9614893198013306 / 0.9741131067276001
after epoch: 27,now: 2024-05-30 03:36:26.001971,epoch time: 0:30:51.702473,used: 13:57:10.871181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9910486, 'precision': 0.9556136, 'recall': 0.9016009, 'specificity': 0.9016009, 'f1': 0.92677754, 'auroc': 0.9947797, 'binary_precision': 0.91795665, 'binary_recall': 0.8057065, 'binary_specificity': 0.9974953, 'binary_f1_score': 0.8581766}
confusion matrix:
       0     1
0  42214   106
1    286  1186
---- Validation: 
scalar performance:
{'acc': 0.98499364, 'precision': 0.9346349, 'recall': 0.8227185, 'specificity': 0.8227185, 'f1': 0.86978954, 'auroc': 0.9745208, 'binary_precision': 0.88160676, 'binary_recall': 0.64852256, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.74731183}
confusion matrix:
       0    1
0  18093   56
1    226  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.79654384, 'recall': 0.5541382, 'specificity': 0.5541382, 'f1': 0.5842652, 'auroc': 0.8955739, 'binary_precision': 0.6304348, 'binary_recall': 0.11111111, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.18892507}
confusion matrix:
      0   1
0  5980  17
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 4
val acc:0.9849936366081238, best validation acc: 0.9862175583839417, corresponding to test acc:                         0.9614893198013306 / 0.9741131067276001
after epoch: 28,now: 2024-05-30 04:07:12.672977,epoch time: 0:30:46.671006,used: 14:27:57.542187,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9924187, 'precision': 0.95203006, 'recall': 0.9288664, 'specificity': 0.9288664, 'f1': 0.94012004, 'auroc': 0.9962176, 'binary_precision': 0.90889525, 'binary_recall': 0.8607337, 'binary_specificity': 0.996999, 'binary_f1_score': 0.884159}
confusion matrix:
       0     1
0  42193   127
1    205  1267
---- Validation: 
scalar performance:
{'acc': 0.9868029, 'precision': 0.9472544, 'recall': 0.8416565, 'specificity': 0.8416565, 'f1': 0.88686395, 'auroc': 0.97921073, 'binary_precision': 0.90554416, 'binary_recall': 0.6858476, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.7805309}
confusion matrix:
       0    1
0  18103   46
1    202  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.92092884, 'recall': 0.5685486, 'specificity': 0.5685486, 'f1': 0.60978985, 'auroc': 0.9524069, 'binary_precision': 0.8780488, 'binary_recall': 0.13793103, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.2384106}
confusion matrix:
      0   1
0  5992   5
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 29,now: 2024-05-30 04:38:14.000044,epoch time: 0:31:01.327067,used: 14:58:58.869254,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9927841, 'precision': 0.9538576, 'recall': 0.9329897, 'specificity': 0.9329897, 'f1': 0.94315916, 'auroc': 0.996459, 'binary_precision': 0.91226816, 'binary_recall': 0.8688859, 'binary_specificity': 0.99709356, 'binary_f1_score': 0.8900487}
confusion matrix:
       0     1
0  42197   123
1    193  1279
---- Validation: 
scalar performance:
{'acc': 0.98621756, 'precision': 0.9450489, 'recall': 0.8338529, 'specificity': 0.8338529, 'f1': 0.8809266, 'auroc': 0.9815829, 'binary_precision': 0.9016736, 'binary_recall': 0.6702955, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.7689563}
confusion matrix:
       0    1
0  18102   47
1    212  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.91387486, 'recall': 0.5722967, 'specificity': 0.5722967, 'f1': 0.61521333, 'auroc': 0.93410516, 'binary_precision': 0.8636364, 'binary_recall': 0.14559387, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.24918032}
confusion matrix:
      0   1
0  5991   6
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.9862175583839417, best validation acc: 0.986802875995636, corresponding to test acc:                         0.9632470607757568 / 0.9741131067276001
after epoch: 30,now: 2024-05-30 05:08:52.347015,epoch time: 0:30:38.346971,used: 15:29:37.216225,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_39_15_seed_0_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:29:37.216225 at 2024-05-30 05:08:52.347015
persisted model performance metric: 

scalar performance:
{'acc': 0.96276766, 'precision': 0.8984878, 'recall': 0.5664662, 'specificity': 0.5664662, 'f1': 0.6059725, 'auroc': 0.94179356, 'binary_precision': 0.8333333, 'binary_recall': 0.13409962, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.2310231}
confusion matrix:
      0   1
0  5990   7
1   226  35
oracle model performance metric: 

scalar performance:
{'acc': 0.97251517, 'precision': 0.9211745, 'recall': 0.6998154, 'specificity': 0.6998154, 'f1': 0.76778156, 'auroc': 0.9466325, 'binary_precision': 0.8677686, 'binary_recall': 0.40229884, 'binary_specificity': 0.997332, 'binary_f1_score': 0.54973817}
confusion matrix:
      0    1
0  5981   16
1   156  105
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456549 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456549 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB |   1113 TiB |   1113 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1100 TiB |   1100 TiB |
|       from small pool |  40679 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14476 MiB |  14476 MiB |      0 B   |
|       from large pool |  14404 MiB |  14404 MiB |  14404 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 473243 KiB |   1229 MiB |    791 TiB |    791 TiB |
|       from large pool | 461682 KiB |   1224 MiB |    778 TiB |    778 TiB |
|       from small pool |  11560 KiB |     17 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  197545 K  |  197542 K  |
|       from large pool |     187    |    1413    |  102630 K  |  102629 K  |
|       from small pool |    3301    |    6290    |   94915 K  |   94912 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  197545 K  |  197542 K  |
|       from large pool |     187    |    1413    |  102630 K  |  102629 K  |
|       from small pool |    3301    |    6290    |   94915 K  |   94912 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |     637    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |    2805    |  132672 K  |  132672 K  |
|       from large pool |      39    |     600    |   83826 K  |   83826 K  |
|       from small pool |      43    |    2765    |   48846 K  |   48846 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1113 TiB |   1113 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14476 MiB |  14476 MiB |  13568 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     52 MiB |     72 MiB |     72 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |    791 TiB |    791 TiB |
|       from large pool |  24320 KiB |   1224 MiB |    778 TiB |    778 TiB |
|       from small pool |      0 KiB |     41 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197545 K  |  197545 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94915 K  |   94915 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197545 K  |  197545 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94915 K  |   94915 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |     637    |     573    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      26    |      36    |      36    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2805    |  132674 K  |  132674 K  |
|       from large pool |       4    |     600    |   83826 K  |   83826 K  |
|       from small pool |       0    |    2765    |   48847 K  |   48847 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1121 TiB |   1121 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1107 TiB |   1107 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1113 TiB |   1113 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1100 TiB |   1100 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14476 MiB |  14476 MiB |  13568 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     52 MiB |     72 MiB |     72 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB |    791 TiB |    791 TiB |
|       from large pool |  24320 KiB |   1224 MiB |    778 TiB |    778 TiB |
|       from small pool |      0 KiB |     41 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197545 K  |  197545 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94915 K  |   94915 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197545 K  |  197545 K  |
|       from large pool |       2    |    1413    |  102630 K  |  102630 K  |
|       from small pool |       0    |    6290    |   94915 K  |   94915 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |     637    |     573    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      26    |      36    |      36    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2805    |  132674 K  |  132674 K  |
|       from large pool |       4    |     600    |   83826 K  |   83826 K  |
|       from small pool |       0    |    2765    |   48847 K  |   48847 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756

 Experiment start at: 2024-05-30 05:20:01.787517
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9700155, 'precision': 0.78563535, 'recall': 0.63413817, 'specificity': 0.63413817, 'f1': 0.68026435, 'auroc': 0.9491203, 'binary_precision': 0.5954887, 'binary_recall': 0.2746186, 'binary_specificity': 0.99365777, 'binary_f1_score': 0.3758899}
confusion matrix:
       0    1
0  42145  269
1   1046  396
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.8095217, 'recall': 0.5597035, 'specificity': 0.5597035, 'f1': 0.59397256, 'auroc': 0.9417898, 'binary_precision': 0.6507937, 'binary_recall': 0.121842496, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.20525657}
confusion matrix:
       0   1
0  18023  44
1    591  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96777314, 'precision': 0.9091408, 'recall': 0.6392914, 'specificity': 0.6392914, 'f1': 0.7026949, 'auroc': 0.9485857, 'binary_precision': 0.8488372, 'binary_recall': 0.28076923, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.4219653}
confusion matrix:
      0   1
0  5933  13
1   187  73
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-30 05:52:08.127217,epoch time: 0:32:06.339700,used: 0:32:06.339700,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97256935, 'precision': 0.78026974, 'recall': 0.81822217, 'specificity': 0.81822217, 'f1': 0.79791665, 'auroc': 0.9601719, 'binary_precision': 0.5723844, 'binary_recall': 0.6530187, 'binary_specificity': 0.9834257, 'binary_f1_score': 0.61004865}
confusion matrix:
       0    1
0  41712  703
1    500  941
---- Validation: 
scalar performance:
{'acc': 0.9717716, 'precision': 0.8108491, 'recall': 0.73859286, 'specificity': 0.73859286, 'f1': 0.76950574, 'auroc': 0.95779234, 'binary_precision': 0.640625, 'binary_recall': 0.48736998, 'binary_specificity': 0.9898157, 'binary_f1_score': 0.5535865}
confusion matrix:
       0    1
0  17883  184
1    345  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697067, 'precision': 0.8753773, 'recall': 0.69179213, 'specificity': 0.69179213, 'f1': 0.7511554, 'auroc': 0.9554068, 'binary_precision': 0.77692306, 'binary_recall': 0.38846153, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.51794875}
confusion matrix:
      0    1
0  5917   29
1   159  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-30 06:22:50.132501,epoch time: 0:30:42.005284,used: 1:02:48.344984,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97578436, 'precision': 0.82376826, 'recall': 0.76306266, 'specificity': 0.76306266, 'f1': 0.7900002, 'auroc': 0.96739215, 'binary_precision': 0.66323024, 'binary_recall': 0.53536755, 'binary_specificity': 0.99075776, 'binary_f1_score': 0.59247893}
confusion matrix:
       0    1
0  42022  392
1    670  772
---- Validation: 
scalar performance:
{'acc': 0.96974385, 'precision': 0.84344363, 'recall': 0.62953585, 'specificity': 0.62953585, 'f1': 0.6844278, 'auroc': 0.96175146, 'binary_precision': 0.71370965, 'binary_recall': 0.26300147, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.3843648}
confusion matrix:
       0    1
0  17996   71
1    496  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.7929077, 'recall': 0.59170806, 'specificity': 0.59170806, 'f1': 0.6345618, 'auroc': 0.9517393, 'binary_precision': 0.62025315, 'binary_recall': 0.18846154, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.28908554}
confusion matrix:
      0   1
0  5916  30
1   211  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.9697438478469849, best validation acc: 0.9717715978622437, corresponding to test acc:                         0.9697067141532898 / 0.9697067141532898
after epoch: 3,now: 2024-05-30 06:53:50.842718,epoch time: 0:31:00.710217,used: 1:33:49.055201,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9795695, 'precision': 0.88949335, 'recall': 0.7526263, 'specificity': 0.7526263, 'f1': 0.8054017, 'auroc': 0.97391987, 'binary_precision': 0.79545456, 'binary_recall': 0.50970876, 'binary_specificity': 0.9955439, 'binary_f1_score': 0.6213018}
confusion matrix:
       0    1
0  42225  189
1    707  735
---- Validation: 
scalar performance:
{'acc': 0.9739061, 'precision': 0.88590455, 'recall': 0.6824784, 'specificity': 0.6824784, 'f1': 0.74507713, 'auroc': 0.9642607, 'binary_precision': 0.7948718, 'binary_recall': 0.36849925, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.5035533}
confusion matrix:
       0    1
0  18003   64
1    425  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.6775079, 'recall': 0.5269121, 'specificity': 0.5269121, 'f1': 0.53927404, 'auroc': 0.9593465, 'binary_precision': 0.39473686, 'binary_recall': 0.057692308, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.10067114}
confusion matrix:
      0   1
0  5923  23
1   245  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 4,now: 2024-05-30 07:24:27.654065,epoch time: 0:30:36.811347,used: 2:04:25.866548,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9782926, 'precision': 0.840424, 'recall': 0.7991944, 'specificity': 0.7991944, 'f1': 0.818365, 'auroc': 0.97454214, 'binary_precision': 0.69413626, 'binary_recall': 0.6074896, 'binary_specificity': 0.9908992, 'binary_f1_score': 0.64792895}
confusion matrix:
       0    1
0  42028  386
1    566  876
---- Validation: 
scalar performance:
{'acc': 0.9782284, 'precision': 0.8784358, 'recall': 0.77555907, 'specificity': 0.77555907, 'f1': 0.81821775, 'auroc': 0.9680274, 'binary_precision': 0.77319586, 'binary_recall': 0.5572065, 'binary_specificity': 0.99391156, 'binary_f1_score': 0.64766836}
confusion matrix:
       0    1
0  17957  110
1    298  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.86217177, 'recall': 0.5663827, 'specificity': 0.5663827, 'f1': 0.60463184, 'auroc': 0.951262, 'binary_precision': 0.76086956, 'binary_recall': 0.13461539, 'binary_specificity': 0.99815, 'binary_f1_score': 0.22875819}
confusion matrix:
      0   1
0  5935  11
1   225  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 5,now: 2024-05-30 07:55:17.278734,epoch time: 0:30:49.624669,used: 2:35:15.491217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98018515, 'precision': 0.8796884, 'recall': 0.77773106, 'specificity': 0.77773106, 'f1': 0.82019323, 'auroc': 0.9764972, 'binary_precision': 0.77416265, 'binary_recall': 0.56102633, 'binary_specificity': 0.9944358, 'binary_f1_score': 0.650583}
confusion matrix:
       0    1
0  42178  236
1    633  809
---- Validation: 
scalar performance:
{'acc': 0.97732127, 'precision': 0.90678537, 'recall': 0.7285962, 'specificity': 0.7285962, 'f1': 0.7908184, 'auroc': 0.9700465, 'binary_precision': 0.8333333, 'binary_recall': 0.46062407, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.5933014}
confusion matrix:
       0    1
0  18005   62
1    363  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.75098526, 'recall': 0.6146899, 'specificity': 0.6146899, 'f1': 0.654425, 'auroc': 0.95127314, 'binary_precision': 0.5344828, 'binary_recall': 0.23846154, 'binary_specificity': 0.9909183, 'binary_f1_score': 0.32978722}
confusion matrix:
      0   1
0  5892  54
1   198  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.9773212671279907, best validation acc: 0.9782283902168274, corresponding to test acc:                         0.9619722962379456 / 0.9697067141532898
after epoch: 6,now: 2024-05-30 08:26:11.216618,epoch time: 0:30:53.937884,used: 3:06:09.429101,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98223734, 'precision': 0.8657308, 'recall': 0.848797, 'specificity': 0.848797, 'f1': 0.8570462, 'auroc': 0.97903013, 'binary_precision': 0.7414421, 'binary_recall': 0.7059639, 'binary_specificity': 0.99163014, 'binary_f1_score': 0.72326815}
confusion matrix:
       0     1
0  42059   355
1    424  1018
---- Validation: 
scalar performance:
{'acc': 0.98116326, 'precision': 0.8822416, 'recall': 0.8300109, 'specificity': 0.8300109, 'f1': 0.85404104, 'auroc': 0.9754757, 'binary_precision': 0.7768166, 'binary_recall': 0.66716194, 'binary_specificity': 0.9928599, 'binary_f1_score': 0.7178257}
confusion matrix:
       0    1
0  17938  129
1    224  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.8237355, 'recall': 0.54522884, 'specificity': 0.54522884, 'f1': 0.57116365, 'auroc': 0.9564704, 'binary_precision': 0.6857143, 'binary_recall': 0.092307694, 'binary_specificity': 0.99815, 'binary_f1_score': 0.16271187}
confusion matrix:
      0   1
0  5935  11
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 7,now: 2024-05-30 08:56:54.210279,epoch time: 0:30:42.993661,used: 3:36:52.422762,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98214614, 'precision': 0.9212116, 'recall': 0.77222395, 'specificity': 0.77222395, 'f1': 0.8295935, 'auroc': 0.9798774, 'binary_precision': 0.8576087, 'binary_recall': 0.54753643, 'binary_specificity': 0.99691147, 'binary_f1_score': 0.6683608}
confusion matrix:
       0    1
0  42284  131
1    652  789
---- Validation: 
scalar performance:
{'acc': 0.97812164, 'precision': 0.9305498, 'recall': 0.7247197, 'specificity': 0.7247197, 'f1': 0.7930024, 'auroc': 0.97523814, 'binary_precision': 0.8811594, 'binary_recall': 0.45170876, 'binary_specificity': 0.9977307, 'binary_f1_score': 0.59724945}
confusion matrix:
       0    1
0  18026   41
1    369  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.8051964, 'recall': 0.5450607, 'specificity': 0.5450607, 'f1': 0.57053155, 'auroc': 0.9509537, 'binary_precision': 0.6486486, 'binary_recall': 0.092307694, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.16161616}
confusion matrix:
      0   1
0  5933  13
1   236  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.9781216382980347, best validation acc: 0.9811632633209229, corresponding to test acc:                         0.9601998329162598 / 0.9697067141532898
after epoch: 8,now: 2024-05-30 09:27:40.231702,epoch time: 0:30:46.021423,used: 4:07:38.444185,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98276174, 'precision': 0.9161871, 'recall': 0.78877676, 'specificity': 0.78877676, 'f1': 0.8401399, 'auroc': 0.98113704, 'binary_precision': 0.84646463, 'binary_recall': 0.5811373, 'binary_specificity': 0.9964163, 'binary_f1_score': 0.68914473}
confusion matrix:
       0    1
0  42262  152
1    604  838
---- Validation: 
scalar performance:
{'acc': 0.97956246, 'precision': 0.9223078, 'recall': 0.75479287, 'specificity': 0.75479287, 'f1': 0.81626844, 'auroc': 0.9763159, 'binary_precision': 0.8625, 'binary_recall': 0.51263, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.64305687}
confusion matrix:
       0    1
0  18012   55
1    328  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.75451744, 'recall': 0.53151506, 'specificity': 0.53151506, 'f1': 0.5478178, 'auroc': 0.9326797, 'binary_precision': 0.5483871, 'binary_recall': 0.06538462, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.11683849}
confusion matrix:
      0   1
0  5932  14
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 2
val acc:0.9795624613761902, best validation acc: 0.9811632633209229, corresponding to test acc:                         0.9601998329162598 / 0.9697067141532898
after epoch: 9,now: 2024-05-30 09:58:15.409429,epoch time: 0:30:35.177727,used: 4:38:13.621912,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98378783, 'precision': 0.9203734, 'recall': 0.8040452, 'specificity': 0.8040452, 'f1': 0.8521929, 'auroc': 0.9855778, 'binary_precision': 0.85382384, 'binary_recall': 0.61165047, 'binary_specificity': 0.9964399, 'binary_f1_score': 0.71272725}
confusion matrix:
       0    1
0  42263  151
1    560  882
---- Validation: 
scalar performance:
{'acc': 0.98052293, 'precision': 0.9240574, 'recall': 0.76959634, 'specificity': 0.76959634, 'f1': 0.8283175, 'auroc': 0.9779481, 'binary_precision': 0.8649289, 'binary_recall': 0.54234767, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.66666657}
confusion matrix:
       0    1
0  18010   57
1    308  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.84115314, 'recall': 0.5245795, 'specificity': 0.5245795, 'f1': 0.53637856, 'auroc': 0.95960873, 'binary_precision': 0.7222222, 'binary_recall': 0.05, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.093525186}
confusion matrix:
      0   1
0  5941   5
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 3
val acc:0.9805229306221008, best validation acc: 0.9811632633209229, corresponding to test acc:                         0.9601998329162598 / 0.9697067141532898
after epoch: 10,now: 2024-05-30 10:29:12.734519,epoch time: 0:30:57.325090,used: 5:09:10.947002,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98408425, 'precision': 0.9254709, 'recall': 0.80453336, 'specificity': 0.80453336, 'f1': 0.85426646, 'auroc': 0.9859431, 'binary_precision': 0.86399215, 'binary_recall': 0.61234397, 'binary_specificity': 0.99672276, 'binary_f1_score': 0.71672076}
confusion matrix:
       0    1
0  42275  139
1    559  883
---- Validation: 
scalar performance:
{'acc': 0.9808431, 'precision': 0.9589152, 'recall': 0.74973494, 'specificity': 0.74973494, 'f1': 0.82130927, 'auroc': 0.977726, 'binary_precision': 0.9361111, 'binary_recall': 0.5007429, 'binary_specificity': 0.99872696, 'binary_f1_score': 0.6524685}
confusion matrix:
       0    1
0  18044   23
1    336  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.8345128, 'recall': 0.53210366, 'specificity': 0.53210366, 'f1': 0.54955244, 'auroc': 0.95617366, 'binary_precision': 0.7083333, 'binary_recall': 0.06538462, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.11971832}
confusion matrix:
      0   1
0  5939   7
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 4
val acc:0.9808431267738342, best validation acc: 0.9811632633209229, corresponding to test acc:                         0.9601998329162598 / 0.9697067141532898
after epoch: 11,now: 2024-05-30 10:59:44.266809,epoch time: 0:30:31.532290,used: 5:39:42.479292,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9867293, 'precision': 0.90597135, 'recall': 0.87925535, 'specificity': 0.87925535, 'f1': 0.8921226, 'auroc': 0.984731, 'binary_precision': 0.81994045, 'binary_recall': 0.76421636, 'binary_specificity': 0.99429435, 'binary_f1_score': 0.79109836}
confusion matrix:
       0     1
0  42172   242
1    340  1102
---- Validation: 
scalar performance:
{'acc': 0.98329777, 'precision': 0.9059587, 'recall': 0.8375553, 'specificity': 0.8375553, 'f1': 0.8683436, 'auroc': 0.9793129, 'binary_precision': 0.823741, 'binary_recall': 0.6805349, 'binary_specificity': 0.99457574, 'binary_f1_score': 0.74532133}
confusion matrix:
       0    1
0  17969   98
1    215  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.7784555, 'recall': 0.59697276, 'specificity': 0.59697276, 'f1': 0.63931257, 'auroc': 0.9523382, 'binary_precision': 0.59090906, 'binary_recall': 0.2, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.2988506}
confusion matrix:
      0   1
0  5910  36
1   208  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 12,now: 2024-05-30 11:30:40.750381,epoch time: 0:30:56.483572,used: 6:10:38.962864,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9855664, 'precision': 0.89137214, 'recall': 0.8779842, 'specificity': 0.8779842, 'f1': 0.8845521, 'auroc': 0.9859681, 'binary_precision': 0.790798, 'binary_recall': 0.7628294, 'binary_specificity': 0.993139, 'binary_f1_score': 0.776562}
confusion matrix:
       0     1
0  42123   291
1    342  1100
---- Validation: 
scalar performance:
{'acc': 0.9821238, 'precision': 0.88838655, 'recall': 0.8398075, 'specificity': 0.8398075, 'f1': 0.86233354, 'auroc': 0.97653246, 'binary_precision': 0.7883959, 'binary_recall': 0.68647844, 'binary_specificity': 0.99313664, 'binary_f1_score': 0.73391587}
confusion matrix:
       0    1
0  17943  124
1    211  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.7642614, 'recall': 0.66334444, 'specificity': 0.66334444, 'f1': 0.7004379, 'auroc': 0.95308274, 'binary_precision': 0.556962, 'binary_recall': 0.33846155, 'binary_specificity': 0.98822737, 'binary_f1_score': 0.42105263}
confusion matrix:
      0   1
0  5876  70
1   172  88
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.9821237921714783, best validation acc: 0.9832977652549744, corresponding to test acc:                         0.9606832265853882 / 0.9697067141532898
after epoch: 13,now: 2024-05-30 12:01:19.616899,epoch time: 0:30:38.866518,used: 6:41:17.829382,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98515594, 'precision': 0.9270178, 'recall': 0.82283986, 'specificity': 0.82283986, 'f1': 0.86716604, 'auroc': 0.9874305, 'binary_precision': 0.86586493, 'binary_recall': 0.64909846, 'binary_specificity': 0.9965813, 'binary_f1_score': 0.7419738}
confusion matrix:
       0    1
0  42269  145
1    506  936
---- Validation: 
scalar performance:
{'acc': 0.9836179, 'precision': 0.94966304, 'recall': 0.79909694, 'specificity': 0.79909694, 'f1': 0.8581107, 'auroc': 0.98012125, 'binary_precision': 0.91402715, 'binary_recall': 0.60029715, 'binary_specificity': 0.99789673, 'binary_f1_score': 0.7246636}
confusion matrix:
       0    1
0  18029   38
1    269  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.87498593, 'recall': 0.54941136, 'specificity': 0.54941136, 'f1': 0.5787941, 'auroc': 0.95052135, 'binary_precision': 0.7878788, 'binary_recall': 0.1, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.17747441}
confusion matrix:
      0   1
0  5939   7
1   234  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 14,now: 2024-05-30 12:32:11.767132,epoch time: 0:30:52.150233,used: 7:12:09.979615,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9831722, 'precision': 0.85317594, 'recall': 0.9035426, 'specificity': 0.9035426, 'f1': 0.87652993, 'auroc': 0.98734236, 'binary_precision': 0.7125604, 'binary_recall': 0.8183079, 'binary_specificity': 0.9887773, 'binary_f1_score': 0.7617818}
confusion matrix:
       0     1
0  41938   476
1    262  1180
---- Validation: 
scalar performance:
{'acc': 0.98207045, 'precision': 0.8646698, 'recall': 0.88341117, 'specificity': 0.88341117, 'f1': 0.8737831, 'auroc': 0.9796566, 'binary_precision': 0.7376587, 'binary_recall': 0.7771174, 'binary_specificity': 0.98970497, 'binary_f1_score': 0.75687414}
confusion matrix:
       0    1
0  17881  186
1    150  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.82432795, 'recall': 0.6243163, 'specificity': 0.6243163, 'f1': 0.67554176, 'auroc': 0.95616055, 'binary_precision': 0.68041235, 'binary_recall': 0.25384617, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.36974794}
confusion matrix:
      0   1
0  5915  31
1   194  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.9820704460144043, best validation acc: 0.983617901802063, corresponding to test acc:                         0.9611666202545166 / 0.9697067141532898
after epoch: 15,now: 2024-05-30 13:02:56.849652,epoch time: 0:30:45.082520,used: 7:42:55.062135,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9867065, 'precision': 0.8901576, 'recall': 0.9050349, 'specificity': 0.9050349, 'f1': 0.89744544, 'auroc': 0.9887956, 'binary_precision': 0.78652436, 'binary_recall': 0.81761444, 'binary_specificity': 0.9924553, 'binary_f1_score': 0.8017681}
confusion matrix:
       0     1
0  42094   320
1    263  1179
---- Validation: 
scalar performance:
{'acc': 0.98329777, 'precision': 0.88625973, 'recall': 0.86688125, 'specificity': 0.86688125, 'f1': 0.8762986, 'auroc': 0.9819994, 'binary_precision': 0.7821317, 'binary_recall': 0.74145615, 'binary_specificity': 0.9923064, 'binary_f1_score': 0.761251}
confusion matrix:
       0    1
0  17928  139
1    174  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.7618265, 'recall': 0.6095093, 'specificity': 0.6095093, 'f1': 0.65090835, 'auroc': 0.95500445, 'binary_precision': 0.5566038, 'binary_recall': 0.22692308, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.32240438}
confusion matrix:
      0   1
0  5899  47
1   201  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 2
val acc:0.9832977652549744, best validation acc: 0.983617901802063, corresponding to test acc:                         0.9611666202545166 / 0.9697067141532898
after epoch: 16,now: 2024-05-30 13:33:31.226235,epoch time: 0:30:34.376583,used: 8:13:29.438718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9882798, 'precision': 0.94303465, 'recall': 0.8629744, 'specificity': 0.8629744, 'f1': 0.8987383, 'auroc': 0.9907602, 'binary_precision': 0.89523, 'binary_recall': 0.7288488, 'binary_specificity': 0.9971, 'binary_f1_score': 0.80351686}
confusion matrix:
       0     1
0  42291   123
1    391  1051
---- Validation: 
scalar performance:
{'acc': 0.984365, 'precision': 0.9219705, 'recall': 0.8373935, 'specificity': 0.8373935, 'f1': 0.87458587, 'auroc': 0.98062253, 'binary_precision': 0.8558052, 'binary_recall': 0.679049, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.75724936}
confusion matrix:
       0    1
0  17990   77
1    216  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.92238724, 'recall': 0.5707334, 'specificity': 0.5707334, 'f1': 0.61310285, 'auroc': 0.9632262, 'binary_precision': 0.88095236, 'binary_recall': 0.1423077, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.2450331}
confusion matrix:
      0   1
0  5941   5
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 17,now: 2024-05-30 14:04:20.291436,epoch time: 0:30:49.065201,used: 8:44:18.503919,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98736775, 'precision': 0.8983067, 'recall': 0.90470684, 'specificity': 0.90470684, 'f1': 0.9014791, 'auroc': 0.990044, 'binary_precision': 0.8028649, 'binary_recall': 0.81622744, 'binary_specificity': 0.99318624, 'binary_f1_score': 0.809491}
confusion matrix:
       0     1
0  42125   289
1    265  1177
---- Validation: 
scalar performance:
{'acc': 0.98233724, 'precision': 0.88302445, 'recall': 0.8527931, 'specificity': 0.8527931, 'f1': 0.8672316, 'auroc': 0.98150337, 'binary_precision': 0.776699, 'binary_recall': 0.71322435, 'binary_specificity': 0.9923618, 'binary_f1_score': 0.74360955}
confusion matrix:
       0    1
0  17929  138
1    193  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.79869217, 'recall': 0.662935, 'specificity': 0.662935, 'f1': 0.7086803, 'auroc': 0.9523665, 'binary_precision': 0.62589926, 'binary_recall': 0.33461538, 'binary_specificity': 0.9912546, 'binary_f1_score': 0.4360902}
confusion matrix:
      0   1
0  5894  52
1   173  87
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.982337236404419, best validation acc: 0.9843649864196777, corresponding to test acc:                         0.9632613658905029 / 0.9697067141532898
after epoch: 18,now: 2024-05-30 14:34:59.257369,epoch time: 0:30:38.965933,used: 9:14:57.469852,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9887587, 'precision': 0.9035381, 'recall': 0.92485315, 'specificity': 0.92485315, 'f1': 0.9138987, 'auroc': 0.99091953, 'binary_precision': 0.8119658, 'binary_recall': 0.85644937, 'binary_specificity': 0.9932569, 'binary_f1_score': 0.8336146}
confusion matrix:
       0     1
0  42128   286
1    207  1235
---- Validation: 
scalar performance:
{'acc': 0.9850587, 'precision': 0.89941907, 'recall': 0.8799541, 'specificity': 0.8799541, 'f1': 0.8894219, 'auroc': 0.98246723, 'binary_precision': 0.80751175, 'binary_recall': 0.7667162, 'binary_specificity': 0.993192, 'binary_f1_score': 0.7865854}
confusion matrix:
       0    1
0  17944  123
1    157  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.81213987, 'recall': 0.59772956, 'specificity': 0.59772956, 'f1': 0.64365983, 'auroc': 0.95983434, 'binary_precision': 0.65822786, 'binary_recall': 0.2, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.30678466}
confusion matrix:
      0   1
0  5919  27
1   208  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 19,now: 2024-05-30 15:05:49.101710,epoch time: 0:30:49.844341,used: 9:45:47.314193,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9893287, 'precision': 0.9117799, 'recall': 0.92280316, 'specificity': 0.92280316, 'f1': 0.91721284, 'auroc': 0.9921979, 'binary_precision': 0.82861, 'binary_recall': 0.851595, 'binary_specificity': 0.9940114, 'binary_f1_score': 0.8399453}
confusion matrix:
       0     1
0  42160   254
1    214  1228
---- Validation: 
scalar performance:
{'acc': 0.98527217, 'precision': 0.9057865, 'recall': 0.8743427, 'specificity': 0.8743427, 'f1': 0.88937545, 'auroc': 0.9832952, 'binary_precision': 0.82067853, 'binary_recall': 0.7548291, 'binary_specificity': 0.9938562, 'binary_f1_score': 0.78637767}
confusion matrix:
       0    1
0  17956  111
1    165  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.8206909, 'recall': 0.6054219, 'specificity': 0.6054219, 'f1': 0.65369534, 'auroc': 0.94702, 'binary_precision': 0.67469877, 'binary_recall': 0.21538462, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.3265306}
confusion matrix:
      0   1
0  5919  27
1   204  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 20,now: 2024-05-30 15:36:24.304102,epoch time: 0:30:35.202392,used: 10:16:22.516585,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98967075, 'precision': 0.92801726, 'recall': 0.9058975, 'specificity': 0.9058975, 'f1': 0.9166412, 'auroc': 0.99204767, 'binary_precision': 0.8622711, 'binary_recall': 0.81622744, 'binary_specificity': 0.9955675, 'binary_f1_score': 0.83861774}
confusion matrix:
       0     1
0  42226   188
1    265  1177
---- Validation: 
scalar performance:
{'acc': 0.9855923, 'precision': 0.9007263, 'recall': 0.8880988, 'specificity': 0.8880988, 'f1': 0.8943024, 'auroc': 0.98027956, 'binary_precision': 0.8095238, 'binary_recall': 0.7830609, 'binary_specificity': 0.99313664, 'binary_f1_score': 0.79607254}
confusion matrix:
       0    1
0  17943  124
1    146  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.8640975, 'recall': 0.57967603, 'specificity': 0.57967603, 'f1': 0.6237855, 'auroc': 0.9567998, 'binary_precision': 0.76363635, 'binary_recall': 0.16153847, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.26666668}
confusion matrix:
      0   1
0  5933  13
1   218  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 21,now: 2024-05-30 16:07:08.969559,epoch time: 0:30:44.665457,used: 10:47:07.182042,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9904916, 'precision': 0.9265485, 'recall': 0.92340446, 'specificity': 0.92340446, 'f1': 0.92497015, 'auroc': 0.99312353, 'binary_precision': 0.8581412, 'binary_recall': 0.851595, 'binary_specificity': 0.99521387, 'binary_f1_score': 0.85485554}
confusion matrix:
       0     1
0  42211   203
1    214  1228
---- Validation: 
scalar performance:
{'acc': 0.9863394, 'precision': 0.9058329, 'recall': 0.8942084, 'specificity': 0.8942084, 'f1': 0.8999287, 'auroc': 0.98391646, 'binary_precision': 0.8192956, 'binary_recall': 0.794948, 'binary_specificity': 0.99346876, 'binary_f1_score': 0.80693823}
confusion matrix:
       0    1
0  17949  118
1    138  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.8635036, 'recall': 0.6308423, 'specificity': 0.6308423, 'f1': 0.6877511, 'auroc': 0.9499116, 'binary_precision': 0.7582418, 'binary_recall': 0.2653846, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.3931624}
confusion matrix:
      0   1
0  5924  22
1   191  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 22,now: 2024-05-30 16:37:59.396385,epoch time: 0:30:50.426826,used: 11:17:57.608868,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9881658, 'precision': 0.8894572, 'recall': 0.938575, 'specificity': 0.938575, 'f1': 0.912434, 'auroc': 0.99174076, 'binary_precision': 0.7828221, 'binary_recall': 0.8854962, 'binary_specificity': 0.9916539, 'binary_f1_score': 0.8309997}
confusion matrix:
       0     1
0  42061   354
1    165  1276
---- Validation: 
scalar performance:
{'acc': 0.9850053, 'precision': 0.87880313, 'recall': 0.91712034, 'specificity': 0.91712034, 'f1': 0.89695084, 'auroc': 0.98144794, 'binary_precision': 0.76344085, 'binary_recall': 0.84398216, 'binary_specificity': 0.99025846, 'binary_f1_score': 0.8016937}
confusion matrix:
       0    1
0  17891  176
1    105  568
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685788, 'precision': 0.84783584, 'recall': 0.70039845, 'specificity': 0.70039845, 'f1': 0.75232065, 'auroc': 0.9535932, 'binary_precision': 0.7210884, 'binary_recall': 0.4076923, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.5208845}
confusion matrix:
      0    1
0  5905   41
1   154  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.9850053191184998, best validation acc: 0.9863393902778625, corresponding to test acc:                         0.9656783938407898 / 0.9697067141532898
after epoch: 23,now: 2024-05-30 17:09:06.669547,epoch time: 0:31:07.273162,used: 11:49:04.882030,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98855346, 'precision': 0.9015287, 'recall': 0.92407715, 'specificity': 0.92407715, 'f1': 0.9124694, 'auroc': 0.99293256, 'binary_precision': 0.8079948, 'binary_recall': 0.8550624, 'binary_specificity': 0.9930919, 'binary_f1_score': 0.8308625}
confusion matrix:
       0     1
0  42121   293
1    209  1233
---- Validation: 
scalar performance:
{'acc': 0.9845251, 'precision': 0.8967076, 'recall': 0.87395525, 'specificity': 0.87395525, 'f1': 0.88496554, 'auroc': 0.9826243, 'binary_precision': 0.80252767, 'binary_recall': 0.7548291, 'binary_specificity': 0.99308133, 'binary_f1_score': 0.7779479}
confusion matrix:
       0    1
0  17942  125
1    165  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.7871063, 'recall': 0.56169564, 'specificity': 0.56169564, 'f1': 0.5948459, 'auroc': 0.92526233, 'binary_precision': 0.6111111, 'binary_recall': 0.12692308, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.21019109}
confusion matrix:
      0   1
0  5925  21
1   227  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 2
val acc:0.9845250844955444, best validation acc: 0.9863393902778625, corresponding to test acc:                         0.9656783938407898 / 0.9697067141532898
after epoch: 24,now: 2024-05-30 17:40:07.049840,epoch time: 0:31:00.380293,used: 12:20:05.262323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9913125, 'precision': 0.95802134, 'recall': 0.90038216, 'specificity': 0.90038216, 'f1': 0.92712516, 'auroc': 0.99426675, 'binary_precision': 0.92270917, 'binary_recall': 0.8030513, 'binary_specificity': 0.997713, 'binary_f1_score': 0.85873187}
confusion matrix:
       0     1
0  42317    97
1    284  1158
---- Validation: 
scalar performance:
{'acc': 0.9851654, 'precision': 0.92434776, 'recall': 0.8485377, 'specificity': 0.8485377, 'f1': 0.8824184, 'auroc': 0.9832866, 'binary_precision': 0.85974497, 'binary_recall': 0.7013373, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.7725041}
confusion matrix:
       0    1
0  17990   77
1    201  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.852351, 'recall': 0.626828, 'specificity': 0.626828, 'f1': 0.68188727, 'auroc': 0.9528407, 'binary_precision': 0.73626375, 'binary_recall': 0.2576923, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.38176638}
confusion matrix:
      0   1
0  5922  24
1   193  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 3
val acc:0.9851654171943665, best validation acc: 0.9863393902778625, corresponding to test acc:                         0.9656783938407898 / 0.9697067141532898
after epoch: 25,now: 2024-05-30 18:10:46.635770,epoch time: 0:30:39.585930,used: 12:50:44.848253,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9906056, 'precision': 0.9484089, 'recall': 0.89834195, 'specificity': 0.89834195, 'f1': 0.92178524, 'auroc': 0.9951688, 'binary_precision': 0.90360504, 'binary_recall': 0.7995839, 'binary_specificity': 0.9971, 'binary_f1_score': 0.848418}
confusion matrix:
       0     1
0  42291   123
1    289  1153
---- Validation: 
scalar performance:
{'acc': 0.9848986, 'precision': 0.9210773, 'recall': 0.847684, 'specificity': 0.847684, 'f1': 0.88058686, 'auroc': 0.9821373, 'binary_precision': 0.8532609, 'binary_recall': 0.6998514, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.7689796}
confusion matrix:
       0    1
0  17986   81
1    202  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.9226578, 'recall': 0.5974883, 'specificity': 0.5974883, 'f1': 0.6514473, 'auroc': 0.9561324, 'binary_precision': 0.87931037, 'binary_recall': 0.19615385, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.3207547}
confusion matrix:
      0   1
0  5939   7
1   209  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 4
val acc:0.9848986268043518, best validation acc: 0.9863393902778625, corresponding to test acc:                         0.9656783938407898 / 0.9697067141532898
after epoch: 26,now: 2024-05-30 18:41:39.762850,epoch time: 0:30:53.127080,used: 13:21:37.975333,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99085647, 'precision': 0.9202768, 'recall': 0.93967074, 'specificity': 0.93967074, 'f1': 0.92973745, 'auroc': 0.9954432, 'binary_precision': 0.84447384, 'binary_recall': 0.8848821, 'binary_specificity': 0.9944594, 'binary_f1_score': 0.8642059}
confusion matrix:
       0     1
0  42179   235
1    166  1276
---- Validation: 
scalar performance:
{'acc': 0.9861793, 'precision': 0.9035065, 'recall': 0.8948406, 'specificity': 0.8948406, 'f1': 0.89912236, 'auroc': 0.9825505, 'binary_precision': 0.8145897, 'binary_recall': 0.79643387, 'binary_specificity': 0.99324733, 'binary_f1_score': 0.8054095}
confusion matrix:
       0    1
0  17945  122
1    137  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.8769412, 'recall': 0.6121161, 'specificity': 0.6121161, 'f1': 0.66713536, 'auroc': 0.95364356, 'binary_precision': 0.7866667, 'binary_recall': 0.22692308, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.35223883}
confusion matrix:
      0   1
0  5930  16
1   201  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 5
val acc:0.9861792922019958, best validation acc: 0.9863393902778625, corresponding to test acc:                         0.9656783938407898 / 0.9697067141532898
after epoch: 27,now: 2024-05-30 19:12:57.882643,epoch time: 0:31:18.119793,used: 13:52:56.095126,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9905144, 'precision': 0.91050434, 'recall': 0.94887257, 'specificity': 0.94887257, 'f1': 0.9287608, 'auroc': 0.99463224, 'binary_precision': 0.82427305, 'binary_recall': 0.90429956, 'binary_specificity': 0.9934456, 'binary_f1_score': 0.86243385}
confusion matrix:
       0     1
0  42136   278
1    138  1304
---- Validation: 
scalar performance:
{'acc': 0.9842583, 'precision': 0.88092875, 'recall': 0.8967054, 'specificity': 0.8967054, 'f1': 0.88864195, 'auroc': 0.9839735, 'binary_precision': 0.7692308, 'binary_recall': 0.8023774, 'binary_specificity': 0.9910334, 'binary_f1_score': 0.7854545}
confusion matrix:
       0    1
0  17905  162
1    133  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.83530086, 'recall': 0.6415399, 'specificity': 0.6415399, 'f1': 0.69535184, 'auroc': 0.93220294, 'binary_precision': 0.7009346, 'binary_recall': 0.28846154, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.40871936}
confusion matrix:
      0   1
0  5914  32
1   185  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 6
val acc:0.9842582941055298, best validation acc: 0.9863393902778625, corresponding to test acc:                         0.9656783938407898 / 0.9697067141532898
after epoch: 28,now: 2024-05-30 19:43:53.449028,epoch time: 0:30:55.566385,used: 14:23:51.661511,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9916773, 'precision': 0.9296461, 'recall': 0.941435, 'specificity': 0.941435, 'f1': 0.9354544, 'auroc': 0.9962673, 'binary_precision': 0.8631153, 'binary_recall': 0.88765603, 'binary_specificity': 0.99521387, 'binary_f1_score': 0.87521374}
confusion matrix:
       0     1
0  42211   203
1    162  1280
---- Validation: 
scalar performance:
{'acc': 0.984952, 'precision': 0.90624, 'recall': 0.8677392, 'specificity': 0.8677392, 'f1': 0.8859487, 'auroc': 0.98464215, 'binary_precision': 0.8220758, 'binary_recall': 0.74145615, 'binary_specificity': 0.99402225, 'binary_f1_score': 0.7796875}
confusion matrix:
       0    1
0  17959  108
1    174  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.823226, 'recall': 0.58853465, 'specificity': 0.58853465, 'f1': 0.6331327, 'auroc': 0.9576979, 'binary_precision': 0.68115944, 'binary_recall': 0.18076923, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.28571427}
confusion matrix:
      0   1
0  5924  22
1   213  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 7
val acc:0.9849519729614258, best validation acc: 0.9863393902778625, corresponding to test acc:                         0.9656783938407898 / 0.9697067141532898
after epoch: 29,now: 2024-05-30 20:14:36.124357,epoch time: 0:30:42.675329,used: 14:54:34.336840,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9921333, 'precision': 0.9331356, 'recall': 0.9450202, 'specificity': 0.9450202, 'f1': 0.9389911, 'auroc': 0.9959808, 'binary_precision': 0.8698584, 'binary_recall': 0.89459085, 'binary_specificity': 0.9954496, 'binary_f1_score': 0.8820513}
confusion matrix:
       0     1
0  42221   193
1    152  1290
---- Validation: 
scalar performance:
{'acc': 0.9854856, 'precision': 0.9017378, 'recall': 0.8844671, 'specificity': 0.8844671, 'f1': 0.8928959, 'auroc': 0.9840334, 'binary_precision': 0.8118196, 'binary_recall': 0.7756315, 'binary_specificity': 0.9933027, 'binary_f1_score': 0.793313}
confusion matrix:
       0    1
0  17946  121
1    151  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.86170375, 'recall': 0.60049355, 'specificity': 0.60049355, 'f1': 0.6513361, 'auroc': 0.94832456, 'binary_precision': 0.75714284, 'binary_recall': 0.20384616, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.3212121}
confusion matrix:
      0   1
0  5929  17
1   207  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 8
val acc:0.9854856133460999, best validation acc: 0.9863393902778625, corresponding to test acc:                         0.9656783938407898 / 0.9697067141532898
after epoch: 30,now: 2024-05-30 20:45:35.527090,epoch time: 0:30:59.402733,used: 15:25:33.739573,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_05_20_01_seed_1_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:25:33.739573 at 2024-05-30 20:45:35.527090
persisted model performance metric: 

scalar performance:
{'acc': 0.9666452, 'precision': 0.86620045, 'recall': 0.6460588, 'specificity': 0.6460588, 'f1': 0.7047079, 'auroc': 0.9550638, 'binary_precision': 0.76237625, 'binary_recall': 0.29615384, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.4265928}
confusion matrix:
      0   1
0  5922  24
1   183  77
oracle model performance metric: 

scalar performance:
{'acc': 0.9709958, 'precision': 0.9035218, 'recall': 0.6906259, 'specificity': 0.6906259, 'f1': 0.7556779, 'auroc': 0.95566666, 'binary_precision': 0.8333333, 'binary_recall': 0.3846154, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.5263158}
confusion matrix:
      0    1
0  5926   20
1   160  100
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456479 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456479 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  13213 MiB |   2231 TiB |   2231 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   2205 TiB |   2205 TiB |
|       from small pool |  40676 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14478 MiB |  28046 MiB |  13568 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  27960 MiB |  13548 MiB |
|       from small pool |     66 MiB |     72 MiB |     86 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446689 KiB |   1238 MiB |   1572 TiB |   1572 TiB |
|       from large pool | 435116 KiB |   1229 MiB |   1546 TiB |   1546 TiB |
|       from small pool |  11572 KiB |     41 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    6487    |  395725 K  |  395722 K  |
|       from large pool |     187    |    1413    |  205679 K  |  205679 K  |
|       from small pool |    3277    |    6298    |  190046 K  |  190042 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    6487    |  395725 K  |  395722 K  |
|       from large pool |     187    |    1413    |  205679 K  |  205679 K  |
|       from small pool |    3277    |    6298    |  190046 K  |  190042 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    1208    |     573    |
|       from large pool |     602    |     602    |    1165    |     563    |
|       from small pool |      33    |      36    |      43    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      83    |    2806    |  260611 K  |  260611 K  |
|       from large pool |      38    |     605    |  162402 K  |  162402 K  |
|       from small pool |      45    |    2768    |   98208 K  |   98208 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2231 TiB |   2231 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2205 TiB |   2205 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  28046 MiB |  27164 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     52 MiB |     72 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1238 MiB |   1572 TiB |   1572 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   1546 TiB |   1546 TiB |
|       from small pool |      0 KiB |     46 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395725 K  |  395725 K  |
|       from large pool |       2    |    1413    |  205679 K  |  205679 K  |
|       from small pool |       0    |    6298    |  190046 K  |  190046 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395725 K  |  395725 K  |
|       from large pool |       2    |    1413    |  205679 K  |  205679 K  |
|       from small pool |       0    |    6298    |  190046 K  |  190046 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1208    |    1145    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      26    |      36    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2806    |  260612 K  |  260612 K  |
|       from large pool |       4    |     605    |  162402 K  |  162402 K  |
|       from small pool |       0    |    2768    |   98210 K  |   98210 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2240 TiB |   2240 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2213 TiB |   2213 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2231 TiB |   2231 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2205 TiB |   2205 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  28046 MiB |  27164 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     52 MiB |     72 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1238 MiB |   1572 TiB |   1572 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   1546 TiB |   1546 TiB |
|       from small pool |      0 KiB |     46 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395725 K  |  395725 K  |
|       from large pool |       2    |    1413    |  205679 K  |  205679 K  |
|       from small pool |       0    |    6298    |  190046 K  |  190046 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395725 K  |  395725 K  |
|       from large pool |       2    |    1413    |  205679 K  |  205679 K  |
|       from small pool |       0    |    6298    |  190046 K  |  190046 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1208    |    1145    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      26    |      36    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2806    |  260612 K  |  260612 K  |
|       from large pool |       4    |     605    |  162402 K  |  162402 K  |
|       from small pool |       0    |    2768    |   98210 K  |   98210 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756

 Experiment start at: 2024-05-30 20:56:52.960543
before training, model accuracy: 0.7679115533828735
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9661373, 'precision': 0.7480231, 'recall': 0.83747655, 'specificity': 0.83747655, 'f1': 0.78506064, 'auroc': 0.94958866, 'binary_precision': 0.50694776, 'binary_recall': 0.699273, 'binary_specificity': 0.9756801, 'binary_f1_score': 0.5877778}
confusion matrix:
       0     1
0  41282  1029
1    455  1058
---- Validation: 
scalar performance:
{'acc': 0.9694774, 'precision': 0.753773, 'recall': 0.79872894, 'specificity': 0.79872894, 'f1': 0.77422166, 'auroc': 0.9345602, 'binary_precision': 0.5203366, 'binary_recall': 0.61627907, 'binary_specificity': 0.9811788, 'binary_f1_score': 0.5642585}
confusion matrix:
       0    1
0  17829  342
1    231  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9775605, 'precision': 0.8642964, 'recall': 0.81781185, 'specificity': 0.81781185, 'f1': 0.8393121, 'auroc': 0.941084, 'binary_precision': 0.74285716, 'binary_recall': 0.6446281, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.6902655}
confusion matrix:
      0    1
0  5943   54
1    86  156
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-30 21:28:41.614997,epoch time: 0:31:48.654454,used: 0:31:48.654454,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97275466, 'precision': 0.7998654, 'recall': 0.7749426, 'specificity': 0.7749426, 'f1': 0.78680956, 'auroc': 0.9604217, 'binary_precision': 0.61532897, 'binary_recall': 0.5624587, 'binary_specificity': 0.98742646, 'binary_f1_score': 0.5877072}
confusion matrix:
       0    1
0  41779  532
1    662  851
---- Validation: 
scalar performance:
{'acc': 0.97128856, 'precision': 0.7922824, 'recall': 0.64467615, 'specificity': 0.64467615, 'f1': 0.6915296, 'auroc': 0.94850546, 'binary_precision': 0.60750854, 'binary_recall': 0.29568106, 'binary_specificity': 0.99367124, 'binary_f1_score': 0.39776537}
confusion matrix:
       0    1
0  18056  115
1    424  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9775605, 'precision': 0.9104746, 'recall': 0.75832963, 'specificity': 0.75832963, 'f1': 0.81563675, 'auroc': 0.94732285, 'binary_precision': 0.84, 'binary_recall': 0.5206612, 'binary_specificity': 0.995998, 'binary_f1_score': 0.64285713}
confusion matrix:
      0    1
0  5973   24
1   116  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 2,now: 2024-05-30 21:59:55.878520,epoch time: 0:31:14.263523,used: 1:03:02.917977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9747855, 'precision': 0.85811114, 'recall': 0.7071655, 'specificity': 0.7071655, 'f1': 0.76088923, 'auroc': 0.9691554, 'binary_precision': 0.73665893, 'binary_recall': 0.41969597, 'binary_specificity': 0.994635, 'binary_f1_score': 0.5347368}
confusion matrix:
       0    1
0  42084  227
1    878  635
---- Validation: 
scalar performance:
{'acc': 0.9751771, 'precision': 0.9248988, 'recall': 0.63142693, 'specificity': 0.63142693, 'f1': 0.69646806, 'auroc': 0.94815624, 'binary_precision': 0.87362635, 'binary_recall': 0.2641196, 'binary_specificity': 0.99873424, 'binary_f1_score': 0.40561223}
confusion matrix:
       0    1
0  18148   23
1    443  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.94399464, 'recall': 0.54942006, 'specificity': 0.54942006, 'f1': 0.5805432, 'auroc': 0.94036156, 'binary_precision': 0.9230769, 'binary_recall': 0.09917355, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.17910448}
confusion matrix:
      0   1
0  5995   2
1   218  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 3,now: 2024-05-30 22:30:52.244339,epoch time: 0:30:56.365819,used: 1:33:59.283796,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9774324, 'precision': 0.8335769, 'recall': 0.82229507, 'specificity': 0.82229507, 'f1': 0.8278297, 'auroc': 0.97478294, 'binary_precision': 0.67945206, 'binary_recall': 0.65565103, 'binary_specificity': 0.98893905, 'binary_f1_score': 0.66733944}
confusion matrix:
       0    1
0  41843  468
1    521  992
---- Validation: 
scalar performance:
{'acc': 0.974165, 'precision': 0.79460275, 'recall': 0.77705896, 'specificity': 0.77705896, 'f1': 0.7855363, 'auroc': 0.9608949, 'binary_precision': 0.6035398, 'binary_recall': 0.5664452, 'binary_specificity': 0.9876727, 'binary_f1_score': 0.5844044}
confusion matrix:
       0    1
0  17947  224
1    261  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.87953883, 'recall': 0.6001558, 'specificity': 0.6001558, 'f1': 0.65272355, 'auroc': 0.95175683, 'binary_precision': 0.7903226, 'binary_recall': 0.20247933, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.3223684}
confusion matrix:
      0   1
0  5984  13
1   193  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.9741650223731995, best validation acc: 0.9751771092414856, corresponding to test acc:                         0.9647379517555237 / 0.9775605201721191
after epoch: 4,now: 2024-05-30 23:02:01.837411,epoch time: 0:31:09.593072,used: 2:05:08.876868,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97928077, 'precision': 0.8377538, 'recall': 0.86395395, 'specificity': 0.86395395, 'f1': 0.8503171, 'auroc': 0.9760798, 'binary_precision': 0.6848225, 'binary_recall': 0.74007934, 'binary_specificity': 0.9878285, 'binary_f1_score': 0.7113795}
confusion matrix:
       0     1
0  41797   515
1    393  1119
---- Validation: 
scalar performance:
{'acc': 0.9805039, 'precision': 0.86673516, 'recall': 0.79318213, 'specificity': 0.79318213, 'f1': 0.8255372, 'auroc': 0.96482277, 'binary_precision': 0.74686193, 'binary_recall': 0.59302324, 'binary_specificity': 0.993341, 'binary_f1_score': 0.6611111}
confusion matrix:
       0    1
0  18050  121
1    245  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97371376, 'precision': 0.8783823, 'recall': 0.722622, 'specificity': 0.722622, 'f1': 0.77856123, 'auroc': 0.95621705, 'binary_precision': 0.7785714, 'binary_recall': 0.45041323, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.5706806}
confusion matrix:
      0    1
0  5966   31
1   133  109
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 5,now: 2024-05-30 23:33:09.872674,epoch time: 0:31:08.035263,used: 2:36:16.912131,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97953176, 'precision': 0.900679, 'recall': 0.7596518, 'specificity': 0.7596518, 'f1': 0.81395996, 'auroc': 0.9777445, 'binary_precision': 0.8181818, 'binary_recall': 0.5234633, 'binary_specificity': 0.9958403, 'binary_f1_score': 0.63845223}
confusion matrix:
       0    1
0  42135  176
1    721  792
---- Validation: 
scalar performance:
{'acc': 0.97794706, 'precision': 0.89904195, 'recall': 0.6995108, 'specificity': 0.6995108, 'f1': 0.76383936, 'auroc': 0.9618195, 'binary_precision': 0.8175676, 'binary_recall': 0.40199336, 'binary_specificity': 0.99702823, 'binary_f1_score': 0.5389755}
confusion matrix:
       0    1
0  18117   54
1    360  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.9054891, 'recall': 0.58817595, 'specificity': 0.58817595, 'f1': 0.6382636, 'auroc': 0.94443125, 'binary_precision': 0.84313726, 'binary_recall': 0.17768595, 'binary_specificity': 0.998666, 'binary_f1_score': 0.29351532}
confusion matrix:
      0   1
0  5989   8
1   199  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.9779470562934875, best validation acc: 0.9805039167404175, corresponding to test acc:                         0.973713755607605 / 0.9775605201721191
after epoch: 6,now: 2024-05-31 00:04:17.088554,epoch time: 0:31:07.215880,used: 3:07:24.128011,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9829774, 'precision': 0.8700373, 'recall': 0.8771069, 'specificity': 0.8771069, 'f1': 0.87353563, 'auroc': 0.9814445, 'binary_precision': 0.7485418, 'binary_recall': 0.763384, 'binary_specificity': 0.9908298, 'binary_f1_score': 0.75589}
confusion matrix:
       0     1
0  41923   388
1    358  1155
---- Validation: 
scalar performance:
{'acc': 0.9801843, 'precision': 0.8375955, 'recall': 0.8484274, 'specificity': 0.8484274, 'f1': 0.84291834, 'auroc': 0.9692757, 'binary_precision': 0.68488747, 'binary_recall': 0.7076412, 'binary_specificity': 0.9892136, 'binary_f1_score': 0.6960784}
confusion matrix:
       0    1
0  17975  196
1    176  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96842444, 'precision': 0.8455336, 'recall': 0.65047467, 'specificity': 0.65047467, 'f1': 0.7063744, 'auroc': 0.94874346, 'binary_precision': 0.7184466, 'binary_recall': 0.30578512, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.4289855}
confusion matrix:
      0   1
0  5968  29
1   168  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 2
val acc:0.9801843166351318, best validation acc: 0.9805039167404175, corresponding to test acc:                         0.973713755607605 / 0.9775605201721191
after epoch: 7,now: 2024-05-31 00:35:21.098952,epoch time: 0:31:04.010398,used: 3:38:28.138409,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9794633, 'precision': 0.833324, 'recall': 0.8848466, 'specificity': 0.8848466, 'f1': 0.8570522, 'auroc': 0.98028266, 'binary_precision': 0.6744451, 'binary_recall': 0.7832122, 'binary_specificity': 0.9864811, 'binary_f1_score': 0.7247706}
confusion matrix:
       0     1
0  41739   572
1    328  1185
---- Validation: 
scalar performance:
{'acc': 0.9808768, 'precision': 0.8403617, 'recall': 0.8616339, 'specificity': 0.8616339, 'f1': 0.8506468, 'auroc': 0.97053355, 'binary_precision': 0.6895476, 'binary_recall': 0.73421925, 'binary_specificity': 0.9890485, 'binary_f1_score': 0.7111826}
confusion matrix:
       0    1
0  17972  199
1    160  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97435486, 'precision': 0.85592914, 'recall': 0.764593, 'specificity': 0.764593, 'f1': 0.8028892, 'auroc': 0.94948334, 'binary_precision': 0.7303371, 'binary_recall': 0.5371901, 'binary_specificity': 0.991996, 'binary_f1_score': 0.61904764}
confusion matrix:
      0    1
0  5949   48
1   112  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 8,now: 2024-05-31 01:06:40.625374,epoch time: 0:31:19.526422,used: 4:09:47.664831,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9798056, 'precision': 0.83409333, 'recall': 0.8926715, 'specificity': 0.8926715, 'f1': 0.86078453, 'auroc': 0.98306775, 'binary_precision': 0.675419, 'binary_recall': 0.7990747, 'binary_specificity': 0.98626834, 'binary_f1_score': 0.73206174}
confusion matrix:
       0     1
0  41730   581
1    304  1209
---- Validation: 
scalar performance:
{'acc': 0.97794706, 'precision': 0.8105704, 'recall': 0.87296927, 'specificity': 0.87296927, 'f1': 0.8386452, 'auroc': 0.9715024, 'binary_precision': 0.6291209, 'binary_recall': 0.7607973, 'binary_specificity': 0.98514116, 'binary_f1_score': 0.68872184}
confusion matrix:
       0    1
0  17901  270
1    144  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.8275882, 'recall': 0.6358451, 'specificity': 0.6358451, 'f1': 0.68857306, 'auroc': 0.95529854, 'binary_precision': 0.68367344, 'binary_recall': 0.2768595, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.39411762}
confusion matrix:
      0   1
0  5966  31
1   175  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.9779470562934875, best validation acc: 0.9808768033981323, corresponding to test acc:                         0.9743548631668091 / 0.9775605201721191
after epoch: 9,now: 2024-05-31 01:37:57.019773,epoch time: 0:31:16.394399,used: 4:41:04.059230,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98395854, 'precision': 0.9213295, 'recall': 0.82025766, 'specificity': 0.82025766, 'f1': 0.8633729, 'auroc': 0.98333263, 'binary_precision': 0.8552632, 'binary_recall': 0.6444151, 'binary_specificity': 0.9961003, 'binary_f1_score': 0.73501694}
confusion matrix:
       0    1
0  42146  165
1    538  975
---- Validation: 
scalar performance:
{'acc': 0.980717, 'precision': 0.8654964, 'recall': 0.80051965, 'specificity': 0.80051965, 'f1': 0.8295867, 'auroc': 0.9585832, 'binary_precision': 0.74390244, 'binary_recall': 0.6079734, 'binary_specificity': 0.9930659, 'binary_f1_score': 0.6691042}
confusion matrix:
       0    1
0  18045  126
1    236  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.83536035, 'recall': 0.57717836, 'specificity': 0.57717836, 'f1': 0.61934865, 'auroc': 0.93902636, 'binary_precision': 0.7037037, 'binary_recall': 0.1570248, 'binary_specificity': 0.997332, 'binary_f1_score': 0.25675678}
confusion matrix:
      0   1
0  5981  16
1   204  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 2
val acc:0.9807170033454895, best validation acc: 0.9808768033981323, corresponding to test acc:                         0.9743548631668091 / 0.9775605201721191
after epoch: 10,now: 2024-05-31 02:09:12.471976,epoch time: 0:31:15.452203,used: 5:12:19.511433,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.985031, 'precision': 0.90200764, 'recall': 0.86446846, 'specificity': 0.86446846, 'f1': 0.8822417, 'auroc': 0.98496497, 'binary_precision': 0.8134601, 'binary_recall': 0.73496366, 'binary_specificity': 0.9939732, 'binary_f1_score': 0.7722222}
confusion matrix:
       0     1
0  42056   255
1    401  1112
---- Validation: 
scalar performance:
{'acc': 0.98343366, 'precision': 0.8718784, 'recall': 0.8557272, 'specificity': 0.8557272, 'f1': 0.86360884, 'auroc': 0.976261, 'binary_precision': 0.7530435, 'binary_recall': 0.7192691, 'binary_specificity': 0.99218535, 'binary_f1_score': 0.73576885}
confusion matrix:
       0    1
0  18029  142
1    169  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.7593645, 'recall': 0.6397923, 'specificity': 0.6397923, 'f1': 0.6796913, 'auroc': 0.93472993, 'binary_precision': 0.546875, 'binary_recall': 0.2892562, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.37837833}
confusion matrix:
      0   1
0  5939  58
1   172  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 11,now: 2024-05-31 02:40:29.112661,epoch time: 0:31:16.640685,used: 5:43:36.152118,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9845747, 'precision': 0.9399072, 'recall': 0.81292915, 'specificity': 0.81292915, 'f1': 0.8649174, 'auroc': 0.9864347, 'binary_precision': 0.89295775, 'binary_recall': 0.62855256, 'binary_specificity': 0.9973057, 'binary_f1_score': 0.7377812}
confusion matrix:
       0    1
0  42197  114
1    562  951
---- Validation: 
scalar performance:
{'acc': 0.9821552, 'precision': 0.89867115, 'recall': 0.7868077, 'specificity': 0.7868077, 'f1': 0.83294916, 'auroc': 0.97382724, 'binary_precision': 0.8111888, 'binary_recall': 0.5780731, 'binary_specificity': 0.99554235, 'binary_f1_score': 0.6750727}
confusion matrix:
       0    1
0  18090   81
1    254  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.8312546, 'recall': 0.60552037, 'specificity': 0.60552037, 'f1': 0.65528035, 'auroc': 0.9279753, 'binary_precision': 0.6933333, 'binary_recall': 0.21487603, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.3280757}
confusion matrix:
      0   1
0  5974  23
1   190  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.9821552038192749, best validation acc: 0.9834336638450623, corresponding to test acc:                         0.9631351232528687 / 0.9775605201721191
after epoch: 12,now: 2024-05-31 03:11:38.972401,epoch time: 0:31:09.859740,used: 6:14:46.011858,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9863773, 'precision': 0.9333756, 'recall': 0.850189, 'specificity': 0.850189, 'f1': 0.887024, 'auroc': 0.98629946, 'binary_precision': 0.8772652, 'binary_recall': 0.70389956, 'binary_specificity': 0.99647844, 'binary_f1_score': 0.7810781}
confusion matrix:
       0     1
0  42162   149
1    448  1065
---- Validation: 
scalar performance:
{'acc': 0.9837, 'precision': 0.91557825, 'recall': 0.7996514, 'specificity': 0.7996514, 'f1': 0.84755397, 'auroc': 0.9747886, 'binary_precision': 0.84418607, 'binary_recall': 0.60299003, 'binary_specificity': 0.9963128, 'binary_f1_score': 0.70348835}
confusion matrix:
       0    1
0  18104   67
1    239  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.8529088, 'recall': 0.5916412, 'specificity': 0.5916412, 'f1': 0.6397674, 'auroc': 0.94434977, 'binary_precision': 0.73770493, 'binary_recall': 0.18595041, 'binary_specificity': 0.997332, 'binary_f1_score': 0.29702973}
confusion matrix:
      0   1
0  5981  16
1   197  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 13,now: 2024-05-31 03:43:06.792122,epoch time: 0:31:27.819721,used: 6:46:13.831579,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9865142, 'precision': 0.91582143, 'recall': 0.87352145, 'specificity': 0.87352145, 'f1': 0.89344513, 'auroc': 0.9879595, 'binary_precision': 0.8404727, 'binary_recall': 0.75214803, 'binary_specificity': 0.9948949, 'binary_f1_score': 0.7938612}
confusion matrix:
       0     1
0  42095   216
1    375  1138
---- Validation: 
scalar performance:
{'acc': 0.9835402, 'precision': 0.888407, 'recall': 0.8300847, 'specificity': 0.8300847, 'f1': 0.85669565, 'auroc': 0.9677062, 'binary_precision': 0.78781927, 'binary_recall': 0.66611296, 'binary_specificity': 0.99405646, 'binary_f1_score': 0.7218722}
confusion matrix:
       0    1
0  18063  108
1    201  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.9062221, 'recall': 0.56768155, 'specificity': 0.56768155, 'f1': 0.60862404, 'auroc': 0.9354073, 'binary_precision': 0.84615386, 'binary_recall': 0.13636364, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.23487546}
confusion matrix:
      0   1
0  5991   6
1   209  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.9835401773452759, best validation acc: 0.9836999773979187, corresponding to test acc:                         0.9658598899841309 / 0.9775605201721191
after epoch: 14,now: 2024-05-31 04:14:20.903799,epoch time: 0:31:14.111677,used: 7:17:27.943256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98706186, 'precision': 0.9526582, 'recall': 0.84289587, 'specificity': 0.84289587, 'f1': 0.8896432, 'auroc': 0.99009943, 'binary_precision': 0.91637325, 'binary_recall': 0.68803704, 'binary_specificity': 0.9977547, 'binary_f1_score': 0.78595704}
confusion matrix:
       0     1
0  42216    95
1    472  1041
---- Validation: 
scalar performance:
{'acc': 0.9838598, 'precision': 0.9260105, 'recall': 0.7925066, 'specificity': 0.7925066, 'f1': 0.8460016, 'auroc': 0.97590226, 'binary_precision': 0.86552566, 'binary_recall': 0.5880399, 'binary_specificity': 0.9969732, 'binary_f1_score': 0.7002967}
confusion matrix:
       0    1
0  18116   55
1    248  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.8675186, 'recall': 0.5612331, 'specificity': 0.5612331, 'f1': 0.59770197, 'auroc': 0.9329704, 'binary_precision': 0.7692308, 'binary_recall': 0.12396694, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.21352312}
confusion matrix:
      0   1
0  5988   9
1   212  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 15,now: 2024-05-31 04:45:53.746607,epoch time: 0:31:32.842808,used: 7:49:00.786064,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98617196, 'precision': 0.8874173, 'recall': 0.9125384, 'specificity': 0.9125384, 'f1': 0.89954805, 'auroc': 0.9889627, 'binary_precision': 0.78080493, 'binary_recall': 0.83344346, 'binary_specificity': 0.99163336, 'binary_f1_score': 0.80626595}
confusion matrix:
       0     1
0  41957   354
1    252  1261
---- Validation: 
scalar performance:
{'acc': 0.9822618, 'precision': 0.84712416, 'recall': 0.88322854, 'specificity': 0.88322854, 'f1': 0.86420465, 'auroc': 0.9751204, 'binary_precision': 0.7016492, 'binary_recall': 0.77740866, 'binary_specificity': 0.9890485, 'binary_f1_score': 0.7375887}
confusion matrix:
       0    1
0  17972  199
1    134  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.83210486, 'recall': 0.59742266, 'specificity': 0.59742266, 'f1': 0.6455054, 'auroc': 0.95144767, 'binary_precision': 0.6956522, 'binary_recall': 0.1983471, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.30868167}
confusion matrix:
      0   1
0  5976  21
1   194  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.9822617769241333, best validation acc: 0.9838597774505615, corresponding to test acc:                         0.9645776748657227 / 0.9775605201721191
after epoch: 16,now: 2024-05-31 05:17:10.825057,epoch time: 0:31:17.078450,used: 8:20:17.864514,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98818, 'precision': 0.9033749, 'recall': 0.92441255, 'specificity': 0.92441255, 'f1': 0.91360307, 'auroc': 0.9921119, 'binary_precision': 0.81191224, 'binary_recall': 0.8559154, 'binary_specificity': 0.99290967, 'binary_f1_score': 0.83333343}
confusion matrix:
       0     1
0  42011   300
1    218  1295
---- Validation: 
scalar performance:
{'acc': 0.98433924, 'precision': 0.8746635, 'recall': 0.872256, 'specificity': 0.872256, 'f1': 0.8734555, 'auroc': 0.97101635, 'binary_precision': 0.7575251, 'binary_recall': 0.7524917, 'binary_specificity': 0.99202025, 'binary_f1_score': 0.755}
confusion matrix:
       0    1
0  18026  145
1    149  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.8427479, 'recall': 0.6321298, 'specificity': 0.6321298, 'f1': 0.6868378, 'auroc': 0.9464809, 'binary_precision': 0.71428573, 'binary_recall': 0.26859504, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.39039037}
confusion matrix:
      0   1
0  5971  26
1   177  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 17,now: 2024-05-31 05:48:31.345390,epoch time: 0:31:20.520333,used: 8:51:38.384847,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98836255, 'precision': 0.9484108, 'recall': 0.8684243, 'specificity': 0.8684243, 'f1': 0.90420175, 'auroc': 0.992784, 'binary_precision': 0.90607285, 'binary_recall': 0.7395902, 'binary_specificity': 0.9972584, 'binary_f1_score': 0.8144105}
confusion matrix:
       0     1
0  42195   116
1    394  1119
---- Validation: 
scalar performance:
{'acc': 0.98556435, 'precision': 0.91948265, 'recall': 0.8319334, 'specificity': 0.8319334, 'f1': 0.8702382, 'auroc': 0.97554916, 'binary_precision': 0.8498943, 'binary_recall': 0.6677741, 'binary_specificity': 0.9960927, 'binary_f1_score': 0.747907}
confusion matrix:
       0    1
0  18100   71
1    200  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96537906, 'precision': 0.8879796, 'recall': 0.5695809, 'specificity': 0.5695809, 'f1': 0.6108615, 'auroc': 0.9411047, 'binary_precision': 0.8095238, 'binary_recall': 0.14049587, 'binary_specificity': 0.998666, 'binary_f1_score': 0.23943661}
confusion matrix:
      0   1
0  5989   8
1   208  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 18,now: 2024-05-31 06:19:30.096516,epoch time: 0:30:58.751126,used: 9:22:37.135973,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98765516, 'precision': 0.9006274, 'recall': 0.9187236, 'specificity': 0.9187236, 'f1': 0.90945816, 'auroc': 0.99185604, 'binary_precision': 0.8068182, 'binary_recall': 0.8446794, 'binary_specificity': 0.9927678, 'binary_f1_score': 0.8253148}
confusion matrix:
       0     1
0  42005   306
1    235  1278
---- Validation: 
scalar performance:
{'acc': 0.98508495, 'precision': 0.8846432, 'recall': 0.8710351, 'specificity': 0.8710351, 'f1': 0.87770677, 'auroc': 0.9747583, 'binary_precision': 0.7775862, 'binary_recall': 0.7491694, 'binary_specificity': 0.9929008, 'binary_f1_score': 0.7631134}
confusion matrix:
       0    1
0  18042  129
1    151  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.85149795, 'recall': 0.6119689, 'specificity': 0.6119689, 'f1': 0.6649908, 'auroc': 0.9427622, 'binary_precision': 0.73333335, 'binary_recall': 0.22727273, 'binary_specificity': 0.996665, 'binary_f1_score': 0.34700316}
confusion matrix:
      0   1
0  5977  20
1   187  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.9850849509239197, best validation acc: 0.9855643510818481, corresponding to test acc:                         0.9653790593147278 / 0.9775605201721191
after epoch: 19,now: 2024-05-31 06:50:13.519285,epoch time: 0:30:43.422769,used: 9:53:20.558742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9888189, 'precision': 0.94510627, 'recall': 0.8794948, 'specificity': 0.8794948, 'f1': 0.9094874, 'auroc': 0.99202013, 'binary_precision': 0.89867496, 'binary_recall': 0.76206213, 'binary_specificity': 0.9969275, 'binary_f1_score': 0.82474965}
confusion matrix:
       0     1
0  42181   130
1    360  1153
---- Validation: 
scalar performance:
{'acc': 0.98407286, 'precision': 0.90762657, 'recall': 0.815905, 'specificity': 0.815905, 'f1': 0.85552645, 'auroc': 0.9734814, 'binary_precision': 0.8272138, 'binary_recall': 0.63621265, 'binary_specificity': 0.99559736, 'binary_f1_score': 0.7192489}
confusion matrix:
       0    1
0  18091   80
1    219  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.81311524, 'recall': 0.5667645, 'specificity': 0.5667645, 'f1': 0.60374075, 'auroc': 0.93416524, 'binary_precision': 0.66, 'binary_recall': 0.13636364, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.2260274}
confusion matrix:
      0   1
0  5980  17
1   209  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 2
val acc:0.9840728640556335, best validation acc: 0.9855643510818481, corresponding to test acc:                         0.9653790593147278 / 0.9775605201721191
after epoch: 20,now: 2024-05-31 07:20:54.987376,epoch time: 0:30:41.468091,used: 10:24:02.026833,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9896176, 'precision': 0.91490895, 'recall': 0.9331233, 'specificity': 0.9331233, 'f1': 0.9238037, 'auroc': 0.9937656, 'binary_precision': 0.8343868, 'binary_recall': 0.87243885, 'binary_specificity': 0.99380773, 'binary_f1_score': 0.8529886}
confusion matrix:
       0     1
0  42049   262
1    193  1320
---- Validation: 
scalar performance:
{'acc': 0.98492515, 'precision': 0.8759574, 'recall': 0.88380134, 'specificity': 0.88380134, 'f1': 0.87983555, 'auroc': 0.9739298, 'binary_precision': 0.7593496, 'binary_recall': 0.77574754, 'binary_specificity': 0.99185514, 'binary_f1_score': 0.767461}
confusion matrix:
       0    1
0  18023  148
1    135  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.8190011, 'recall': 0.6336123, 'specificity': 0.6336123, 'f1': 0.6849383, 'auroc': 0.9413438, 'binary_precision': 0.6666667, 'binary_recall': 0.27272728, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.38709676}
confusion matrix:
      0   1
0  5964  33
1   176  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 3
val acc:0.9849251508712769, best validation acc: 0.9855643510818481, corresponding to test acc:                         0.9653790593147278 / 0.9775605201721191
after epoch: 21,now: 2024-05-31 07:51:34.262166,epoch time: 0:30:39.274790,used: 10:54:41.301623,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98911554, 'precision': 0.92198896, 'recall': 0.9131069, 'specificity': 0.9131069, 'f1': 0.91749674, 'auroc': 0.99321115, 'binary_precision': 0.85, 'binary_recall': 0.83146065, 'binary_specificity': 0.9947531, 'binary_f1_score': 0.84062815}
confusion matrix:
       0     1
0  42089   222
1    255  1258
---- Validation: 
scalar performance:
{'acc': 0.98465884, 'precision': 0.87766784, 'recall': 0.87402713, 'specificity': 0.87402713, 'f1': 0.8758379, 'auroc': 0.9730011, 'binary_precision': 0.76342285, 'binary_recall': 0.75581396, 'binary_specificity': 0.99224037, 'binary_f1_score': 0.7595993}
confusion matrix:
       0    1
0  18030  141
1    147  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96537906, 'precision': 0.8326093, 'recall': 0.59337384, 'specificity': 0.59337384, 'f1': 0.6404764, 'auroc': 0.9372649, 'binary_precision': 0.6969697, 'binary_recall': 0.19008264, 'binary_specificity': 0.996665, 'binary_f1_score': 0.29870132}
confusion matrix:
      0   1
0  5977  20
1   196  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 4
val acc:0.9846588373184204, best validation acc: 0.9855643510818481, corresponding to test acc:                         0.9653790593147278 / 0.9775605201721191
after epoch: 22,now: 2024-05-31 08:22:15.446429,epoch time: 0:30:41.184263,used: 11:25:22.485886,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9913518, 'precision': 0.94822276, 'recall': 0.9187261, 'specificity': 0.9187261, 'f1': 0.9329327, 'auroc': 0.99436194, 'binary_precision': 0.9021277, 'binary_recall': 0.8407138, 'binary_specificity': 0.99673843, 'binary_f1_score': 0.8703387}
confusion matrix:
       0     1
0  42173   138
1    241  1272
---- Validation: 
scalar performance:
{'acc': 0.98513824, 'precision': 0.90178466, 'recall': 0.84536505, 'specificity': 0.84536505, 'f1': 0.8712826, 'auroc': 0.9755014, 'binary_precision': 0.81359226, 'binary_recall': 0.6960133, 'binary_specificity': 0.9947169, 'binary_f1_score': 0.7502238}
confusion matrix:
       0    1
0  18075   96
1    183  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.8254019, 'recall': 0.58312666, 'specificity': 0.58312666, 'f1': 0.6267274, 'auroc': 0.93157697, 'binary_precision': 0.68333334, 'binary_recall': 0.1694215, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.27152318}
confusion matrix:
      0   1
0  5978  19
1   201  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 5
val acc:0.9851382374763489, best validation acc: 0.9855643510818481, corresponding to test acc:                         0.9653790593147278 / 0.9775605201721191
after epoch: 23,now: 2024-05-31 08:52:49.524107,epoch time: 0:30:34.077678,used: 11:55:56.563564,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99107796, 'precision': 0.9678162, 'recall': 0.89372945, 'specificity': 0.89372945, 'f1': 0.9273474, 'auroc': 0.9935171, 'binary_precision': 0.943128, 'binary_recall': 0.7891606, 'binary_specificity': 0.9982983, 'binary_f1_score': 0.8593019}
confusion matrix:
       0     1
0  42239    72
1    319  1194
---- Validation: 
scalar performance:
{'acc': 0.98593724, 'precision': 0.9153019, 'recall': 0.84417176, 'specificity': 0.84417176, 'f1': 0.87615985, 'auroc': 0.97674614, 'binary_precision': 0.8407258, 'binary_recall': 0.692691, 'binary_specificity': 0.99565244, 'binary_f1_score': 0.75956285}
confusion matrix:
       0    1
0  18092   79
1    185  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.80552906, 'recall': 0.5767615, 'specificity': 0.5767615, 'f1': 0.61700714, 'auroc': 0.9448366, 'binary_precision': 0.6440678, 'binary_recall': 0.1570248, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.2524917}
confusion matrix:
      0   1
0  5976  21
1   204  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 24,now: 2024-05-31 09:22:02.292072,epoch time: 0:29:12.767965,used: 12:25:09.331529,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99009675, 'precision': 0.9201043, 'recall': 0.9340088, 'specificity': 0.9340088, 'f1': 0.92693377, 'auroc': 0.9951851, 'binary_precision': 0.8447284, 'binary_recall': 0.87376076, 'binary_specificity': 0.9942568, 'binary_f1_score': 0.8589993}
confusion matrix:
       0     1
0  42068   243
1    191  1322
---- Validation: 
scalar performance:
{'acc': 0.9853513, 'precision': 0.8818022, 'recall': 0.88241535, 'specificity': 0.88241535, 'f1': 0.88210845, 'auroc': 0.9751059, 'binary_precision': 0.7711443, 'binary_recall': 0.77242523, 'binary_specificity': 0.9924055, 'binary_f1_score': 0.7717842}
confusion matrix:
       0    1
0  18033  138
1    137  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.83654845, 'recall': 0.6015549, 'specificity': 0.6015549, 'f1': 0.6509898, 'auroc': 0.9405705, 'binary_precision': 0.70422536, 'binary_recall': 0.20661157, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.31948882}
confusion matrix:
      0   1
0  5976  21
1   192  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.9853513240814209, best validation acc: 0.985937237739563, corresponding to test acc:                         0.9639365077018738 / 0.9775605201721191
after epoch: 25,now: 2024-05-31 09:51:08.536138,epoch time: 0:29:06.244066,used: 12:54:15.575595,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9907585, 'precision': 0.9370233, 'recall': 0.9222427, 'specificity': 0.9222427, 'f1': 0.92949545, 'auroc': 0.9944331, 'binary_precision': 0.87945205, 'binary_recall': 0.8486451, 'binary_specificity': 0.9958403, 'binary_f1_score': 0.86377394}
confusion matrix:
       0     1
0  42135   176
1    229  1284
---- Validation: 
scalar performance:
{'acc': 0.9853513, 'precision': 0.90089184, 'recall': 0.8510965, 'specificity': 0.8510965, 'f1': 0.8742192, 'auroc': 0.9688794, 'binary_precision': 0.81142855, 'binary_recall': 0.7076412, 'binary_specificity': 0.9945518, 'binary_f1_score': 0.7559894}
confusion matrix:
       0    1
0  18072   99
1    176  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.969867, 'precision': 0.9005039, 'recall': 0.6393286, 'specificity': 0.6393286, 'f1': 0.7021425, 'auroc': 0.9418075, 'binary_precision': 0.8292683, 'binary_recall': 0.28099173, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.41975307}
confusion matrix:
      0   1
0  5983  14
1   174  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 2
val acc:0.9853513240814209, best validation acc: 0.985937237739563, corresponding to test acc:                         0.9639365077018738 / 0.9775605201721191
after epoch: 26,now: 2024-05-31 10:20:17.255671,epoch time: 0:29:08.719533,used: 13:23:24.295128,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9918081, 'precision': 0.95972055, 'recall': 0.91354537, 'specificity': 0.91354537, 'f1': 0.93531734, 'auroc': 0.9956342, 'binary_precision': 0.92551625, 'binary_recall': 0.82947785, 'binary_specificity': 0.9976129, 'binary_f1_score': 0.8748693}
confusion matrix:
       0     1
0  42210   101
1    258  1255
---- Validation: 
scalar performance:
{'acc': 0.9856709, 'precision': 0.8993567, 'recall': 0.86009514, 'specificity': 0.86009514, 'f1': 0.8786324, 'auroc': 0.97287035, 'binary_precision': 0.8077634, 'binary_recall': 0.72591364, 'binary_specificity': 0.9942766, 'binary_f1_score': 0.7646544}
confusion matrix:
       0    1
0  18067  104
1    165  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.84695697, 'recall': 0.59155786, 'specificity': 0.59155786, 'f1': 0.6392371, 'auroc': 0.9316559, 'binary_precision': 0.7258065, 'binary_recall': 0.18595041, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.29605266}
confusion matrix:
      0   1
0  5980  17
1   197  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 3
val acc:0.9856709241867065, best validation acc: 0.985937237739563, corresponding to test acc:                         0.9639365077018738 / 0.9775605201721191
after epoch: 27,now: 2024-05-31 10:49:35.012502,epoch time: 0:29:17.756831,used: 13:52:42.051959,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99196786, 'precision': 0.96846473, 'recall': 0.90725505, 'specificity': 0.90725505, 'f1': 0.9355581, 'auroc': 0.9958128, 'binary_precision': 0.9434683, 'binary_recall': 0.8162591, 'binary_specificity': 0.998251, 'binary_f1_score': 0.8752658}
confusion matrix:
       0     1
0  42237    74
1    278  1235
---- Validation: 
scalar performance:
{'acc': 0.9863634, 'precision': 0.92012286, 'recall': 0.846801, 'specificity': 0.846801, 'f1': 0.87969995, 'auroc': 0.9742222, 'binary_precision': 0.85020244, 'binary_recall': 0.6976744, 'binary_specificity': 0.9959276, 'binary_f1_score': 0.7664233}
confusion matrix:
       0    1
0  18097   74
1    182  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.8649476, 'recall': 0.553052, 'specificity': 0.553052, 'f1': 0.58502406, 'auroc': 0.9375063, 'binary_precision': 0.7647059, 'binary_recall': 0.10743801, 'binary_specificity': 0.998666, 'binary_f1_score': 0.1884058}
confusion matrix:
      0   1
0  5989   8
1   216  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 28,now: 2024-05-31 11:19:05.740412,epoch time: 0:29:30.727910,used: 14:22:12.779869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9900739, 'precision': 0.97239554, 'recall': 0.8737717, 'specificity': 0.8737717, 'f1': 0.91691387, 'auroc': 0.99579704, 'binary_precision': 0.9537037, 'binary_recall': 0.7488434, 'binary_specificity': 0.9987001, 'binary_f1_score': 0.83894855}
confusion matrix:
       0     1
0  42256    55
1    380  1133
---- Validation: 
scalar performance:
{'acc': 0.98641664, 'precision': 0.93043405, 'recall': 0.8363889, 'specificity': 0.8363889, 'f1': 0.87723434, 'auroc': 0.97407705, 'binary_precision': 0.87152034, 'binary_recall': 0.67607975, 'binary_specificity': 0.996698, 'binary_f1_score': 0.76145935}
confusion matrix:
       0    1
0  18111   60
1    195  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.8203435, 'recall': 0.5506524, 'specificity': 0.5506524, 'f1': 0.58021975, 'auroc': 0.8660241, 'binary_precision': 0.6756757, 'binary_recall': 0.10330579, 'binary_specificity': 0.997999, 'binary_f1_score': 0.17921148}
confusion matrix:
      0   1
0  5985  12
1   217  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
better model found
persisted
after epoch: 29,now: 2024-05-31 11:48:37.374750,epoch time: 0:29:31.634338,used: 14:51:44.414207,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9898001, 'precision': 0.91211045, 'recall': 0.94118416, 'specificity': 0.94118416, 'f1': 0.92610896, 'auroc': 0.9953584, 'binary_precision': 0.82820195, 'binary_recall': 0.8889623, 'binary_specificity': 0.993406, 'binary_f1_score': 0.85750717}
confusion matrix:
       0     1
0  42032   279
1    168  1345
---- Validation: 
scalar performance:
{'acc': 0.9833804, 'precision': 0.86613935, 'recall': 0.86613935, 'specificity': 0.86613935, 'f1': 0.8661393, 'auroc': 0.9669193, 'binary_precision': 0.7408638, 'binary_recall': 0.7408638, 'binary_specificity': 0.9914149, 'binary_f1_score': 0.74086374}
confusion matrix:
       0    1
0  18015  156
1    156  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.8479228, 'recall': 0.5976728, 'specificity': 0.5976728, 'f1': 0.64713424, 'auroc': 0.8861127, 'binary_precision': 0.72727275, 'binary_recall': 0.1983471, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.31168833}
confusion matrix:
      0   1
0  5979  18
1   194  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993756.png
early stop counter: 1
val acc:0.9833803772926331, best validation acc: 0.9864166378974915, corresponding to test acc:                         0.9632954001426697 / 0.9775605201721191
after epoch: 30,now: 2024-05-31 12:17:56.142370,epoch time: 0:29:18.767620,used: 15:21:03.181827,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_20_56_52_seed_2_20993756
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:21:03.181827 at 2024-05-31 12:17:56.142370
persisted model performance metric: 

scalar performance:
{'acc': 0.9623337, 'precision': 0.7821889, 'recall': 0.5422212, 'specificity': 0.5422212, 'f1': 0.5661819, 'auroc': 0.8889407, 'binary_precision': 0.6, 'binary_recall': 0.08677686, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.15162455}
confusion matrix:
      0   1
0  5983  14
1   221  21
oracle model performance metric: 

scalar performance:
{'acc': 0.97723997, 'precision': 0.8597685, 'recall': 0.81962776, 'specificity': 0.81962776, 'f1': 0.8383924, 'auroc': 0.93427086, 'binary_precision': 0.73364484, 'binary_recall': 0.6487603, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.6885965}
confusion matrix:
      0    1
0  5940   57
1    85  157
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456485 KiB |  13219 MiB |   3352 TiB |   3352 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   3313 TiB |   3313 TiB |
|       from small pool |  41681 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456485 KiB |  13219 MiB |   3352 TiB |   3352 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   3313 TiB |   3313 TiB |
|       from small pool |  41681 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447753 KiB |  13213 MiB |   3343 TiB |   3343 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   3303 TiB |   3303 TiB |
|       from small pool |  40678 KiB |     60 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14478 MiB |  41642 MiB |  27164 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  41542 MiB |  27130 MiB |
|       from small pool |     66 MiB |     72 MiB |    100 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446683 KiB |   1238 MiB |   2350 TiB |   2350 TiB |
|       from large pool | 435116 KiB |   1229 MiB |   2310 TiB |   2310 TiB |
|       from small pool |  11566 KiB |     46 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    6487    |  592983 K  |  592980 K  |
|       from large pool |     187    |    1413    |  308144 K  |  308144 K  |
|       from small pool |    3289    |    6298    |  284838 K  |  284835 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    6487    |  592983 K  |  592980 K  |
|       from large pool |     187    |    1413    |  308144 K  |  308144 K  |
|       from small pool |    3289    |    6298    |  284838 K  |  284835 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    1780    |    1145    |
|       from large pool |     602    |     602    |    1730    |    1128    |
|       from small pool |      33    |      36    |      50    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      83    |    2806    |  388254 K  |  388254 K  |
|       from large pool |      38    |     605    |  240391 K  |  240391 K  |
|       from small pool |      45    |    2768    |  147863 K  |  147863 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   3352 TiB |   3352 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3313 TiB |   3313 TiB |
|       from small pool |      0 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   3352 TiB |   3352 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3313 TiB |   3313 TiB |
|       from small pool |      0 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   3343 TiB |   3343 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   3303 TiB |   3303 TiB |
|       from small pool |      0 KiB |     60 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  41642 MiB |  40760 MiB |
|       from large pool |    830 MiB |  14412 MiB |  41542 MiB |  40712 MiB |
|       from small pool |     52 MiB |     72 MiB |    100 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1238 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  24320 KiB |   1229 MiB |   2310 TiB |   2310 TiB |
|       from small pool |      0 KiB |     46 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  592983 K  |  592983 K  |
|       from large pool |       2    |    1413    |  308144 K  |  308144 K  |
|       from small pool |       0    |    6298    |  284838 K  |  284838 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  592983 K  |  592983 K  |
|       from large pool |       2    |    1413    |  308144 K  |  308144 K  |
|       from small pool |       0    |    6298    |  284838 K  |  284838 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1780    |    1717    |
|       from large pool |      37    |     602    |    1730    |    1693    |
|       from small pool |      26    |      36    |      50    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2806    |  388255 K  |  388255 K  |
|       from large pool |       4    |     605    |  240391 K  |  240391 K  |
|       from small pool |       0    |    2768    |  147864 K  |  147864 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri May 31 12:20:41 2024]
Finished job 0.
1 of 1 steps (100%) done
