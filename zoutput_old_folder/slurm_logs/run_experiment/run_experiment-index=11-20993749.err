Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed May 29 13:26:13 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/11.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=11
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749

 Experiment start at: 2024-05-29 13:38:03.312167
before training, model accuracy: 0.2401725947856903
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.963692, 'precision': 0.56584424, 'recall': 0.5081138, 'specificity': 0.5081138, 'f1': 0.508346, 'auroc': 0.6212113, 'binary_precision': 0.16477273, 'binary_recall': 0.019701088, 'binary_specificity': 0.9965265, 'binary_f1_score': 0.035194177}
confusion matrix:
       0    1
0  42173  147
1   1443   29
---- Validation: 
scalar performance:
{'acc': 0.9635483, 'precision': 0.51417786, 'recall': 0.5010931, 'specificity': 0.5010931, 'f1': 0.4950579, 'auroc': 0.5449682, 'binary_precision': 0.0625, 'binary_recall': 0.00466563, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.008683069}
confusion matrix:
       0   1
0  18104  45
1    640   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9552573, 'precision': 0.5227084, 'recall': 0.50208056, 'specificity': 0.50208056, 'f1': 0.49559686, 'auroc': 0.54257536, 'binary_precision': 0.08695652, 'binary_recall': 0.007662835, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.014084507}
confusion matrix:
      0   1
0  5976  21
1   259   2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-29 14:04:42.063894,epoch time: 0:26:38.751727,used: 0:26:38.751727,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96611255, 'precision': 0.6681525, 'recall': 0.50543183, 'specificity': 0.50543183, 'f1': 0.50257766, 'auroc': 0.71249866, 'binary_precision': 0.36956522, 'binary_recall': 0.011548913, 'binary_specificity': 0.9993147, 'binary_f1_score': 0.022397893}
confusion matrix:
       0   1
0  42291  29
1   1455  17
---- Validation: 
scalar performance:
{'acc': 0.96514475, 'precision': 0.5662885, 'recall': 0.50191957, 'specificity': 0.50191957, 'f1': 0.49566877, 'auroc': 0.66442764, 'binary_precision': 0.16666667, 'binary_recall': 0.00466563, 'binary_specificity': 0.9991735, 'binary_f1_score': 0.009077156}
confusion matrix:
       0   1
0  18134  15
1    640   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.5701791, 'recall': 0.5030811, 'specificity': 0.5030811, 'f1': 0.49640882, 'auroc': 0.6307688, 'binary_precision': 0.18181819, 'binary_recall': 0.007662835, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.0147058815}
confusion matrix:
      0  1
0  5988  9
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-29 14:27:47.735913,epoch time: 0:23:05.672019,used: 0:49:44.423746,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96629524, 'precision': 0.6870237, 'recall': 0.50354993, 'specificity': 0.50354993, 'f1': 0.49877033, 'auroc': 0.8096601, 'binary_precision': 0.4074074, 'binary_recall': 0.007477906, 'binary_specificity': 0.9996219, 'binary_f1_score': 0.014686248}
confusion matrix:
       0   1
0  42305  16
1   1460  11
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.62579566, 'recall': 0.50141746, 'specificity': 0.50141746, 'f1': 0.4943316, 'auroc': 0.7895059, 'binary_precision': 0.2857143, 'binary_recall': 0.00311042, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.0061538466}
confusion matrix:
       0  1
0  18144  5
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.6042133, 'recall': 0.5016656, 'specificity': 0.5016656, 'f1': 0.49303976, 'auroc': 0.75403905, 'binary_precision': 0.25, 'binary_recall': 0.0038314175, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0075471695}
confusion matrix:
      0  1
0  5994  3
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-29 14:50:56.901336,epoch time: 0:23:09.165423,used: 1:12:53.589169,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9663637, 'precision': 0.6498919, 'recall': 0.5006325, 'specificity': 0.5006325, 'f1': 0.49280077, 'auroc': 0.8426926, 'binary_precision': 0.33333334, 'binary_recall': 0.0013596193, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.0027081924}
confusion matrix:
       0  1
0  42317  4
1   1469  2
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.48288983, 'recall': 0.4999449, 'specificity': 0.4999449, 'f1': 0.49126938, 'auroc': 0.8283894, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18147  2
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.56254, 'recall': 0.5014988, 'specificity': 0.5014988, 'f1': 0.4929281, 'auroc': 0.81173664, 'binary_precision': 0.16666667, 'binary_recall': 0.0038314175, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0074906363}
confusion matrix:
      0  1
0  5992  5
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
better model found
persisted
after epoch: 4,now: 2024-05-29 15:14:06.393511,epoch time: 0:23:09.492175,used: 1:36:03.081344,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9664322, 'precision': 0.78325796, 'recall': 0.5019908, 'specificity': 0.5019908, 'f1': 0.4955122, 'auroc': 0.8580915, 'binary_precision': 0.6, 'binary_recall': 0.004076087, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.008097166}
confusion matrix:
       0  1
0  42316  4
1   1466  6
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.48288983, 'recall': 0.4999449, 'specificity': 0.4999449, 'f1': 0.49126938, 'auroc': 0.8490426, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18147  2
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.77936995, 'recall': 0.50558037, 'specificity': 0.50558037, 'f1': 0.50066596, 'auroc': 0.84394324, 'binary_precision': 0.6, 'binary_recall': 0.011494253, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.02255639}
confusion matrix:
      0  1
0  5995  2
1   258  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 1
val acc:0.9656769037246704, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9576541781425476 / 0.9584531784057617
after epoch: 5,now: 2024-05-29 15:37:38.126859,epoch time: 0:23:31.733348,used: 1:59:34.814692,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96645504, 'precision': 0.76104754, 'recall': 0.50165343, 'specificity': 0.50165343, 'f1': 0.49485037, 'auroc': 0.87945867, 'binary_precision': 0.5555556, 'binary_recall': 0.0034013605, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.006761325}
confusion matrix:
       0  1
0  42318  4
1   1465  5
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.48288983, 'recall': 0.4999449, 'specificity': 0.4999449, 'f1': 0.49126938, 'auroc': 0.8637273, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18147  2
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.81262994, 'recall': 0.50374806, 'specificity': 0.50374806, 'f1': 0.49696523, 'auroc': 0.86143965, 'binary_precision': 0.6666667, 'binary_recall': 0.007662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5996  1
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 2
val acc:0.9656769037246704, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9576541781425476 / 0.9584531784057617
after epoch: 6,now: 2024-05-29 16:01:11.066205,epoch time: 0:23:32.939346,used: 2:23:07.754038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.7426021, 'recall': 0.50460184, 'specificity': 0.50460184, 'f1': 0.5007957, 'auroc': 0.8836391, 'binary_precision': 0.5185185, 'binary_recall': 0.009510869, 'binary_specificity': 0.9996928, 'binary_f1_score': 0.018679118}
confusion matrix:
       0   1
0  42307  13
1   1458  14
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.5662673, 'recall': 0.5012797, 'specificity': 0.5012797, 'f1': 0.4942392, 'auroc': 0.8768547, 'binary_precision': 0.16666667, 'binary_recall': 0.00311042, 'binary_specificity': 0.999449, 'binary_f1_score': 0.0061068702}
confusion matrix:
       0   1
0  18139  10
1    641   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.84338665, 'recall': 0.51507556, 'specificity': 0.51507556, 'f1': 0.5189576, 'auroc': 0.86601734, 'binary_precision': 0.72727275, 'binary_recall': 0.03065134, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.058823526}
confusion matrix:
      0  1
0  5994  3
1   253  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 3
val acc:0.9653576016426086, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9576541781425476 / 0.959092378616333
after epoch: 7,now: 2024-05-29 16:27:26.719464,epoch time: 0:26:15.653259,used: 2:49:23.407297,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96618104, 'precision': 0.6874847, 'recall': 0.50645083, 'specificity': 0.50645083, 'f1': 0.5045451, 'auroc': 0.88889205, 'binary_precision': 0.40816328, 'binary_recall': 0.013586956, 'binary_specificity': 0.9993147, 'binary_f1_score': 0.026298488}
confusion matrix:
       0   1
0  42291  29
1   1452  20
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.69008154, 'recall': 0.5088629, 'specificity': 0.5088629, 'f1': 0.5090795, 'auroc': 0.88894796, 'binary_precision': 0.41379312, 'binary_recall': 0.01866252, 'binary_specificity': 0.9990633, 'binary_f1_score': 0.035714287}
confusion matrix:
       0   1
0  18132  17
1    631  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8552821, 'recall': 0.52831876, 'specificity': 0.52831876, 'f1': 0.5431233, 'auroc': 0.8830373, 'binary_precision': 0.75, 'binary_recall': 0.057471264, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.10676157}
confusion matrix:
      0   1
0  5992   5
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 4
val acc:0.9655172228813171, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9576541781425476 / 0.9598913192749023
after epoch: 8,now: 2024-05-29 16:51:02.751967,epoch time: 0:23:36.032503,used: 3:12:59.439800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96629524, 'precision': 0.7205252, 'recall': 0.514705, 'specificity': 0.514705, 'f1': 0.520156, 'auroc': 0.8930571, 'binary_precision': 0.47368422, 'binary_recall': 0.030591434, 'binary_specificity': 0.9988186, 'binary_f1_score': 0.05747126}
confusion matrix:
       0   1
0  42271  50
1   1426  45
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.69614816, 'recall': 0.51480824, 'specificity': 0.51480824, 'f1': 0.52017653, 'auroc': 0.8973161, 'binary_precision': 0.42553192, 'binary_recall': 0.0311042, 'binary_specificity': 0.9985123, 'binary_f1_score': 0.057971016}
confusion matrix:
       0   1
0  18122  27
1    623  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.9026443, 'recall': 0.5608024, 'specificity': 0.5608024, 'f1': 0.5974057, 'auroc': 0.8874384, 'binary_precision': 0.84210527, 'binary_recall': 0.12260536, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.21404682}
confusion matrix:
      0   1
0  5991   6
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 5
val acc:0.9654108285903931, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9576541781425476 / 0.9624480605125427
after epoch: 9,now: 2024-05-29 17:14:18.838537,epoch time: 0:23:16.086570,used: 3:36:15.526370,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96627235, 'precision': 0.7274802, 'recall': 0.5297761, 'specificity': 0.5297761, 'f1': 0.5462576, 'auroc': 0.89869255, 'binary_precision': 0.486631, 'binary_recall': 0.061820652, 'binary_specificity': 0.99773157, 'binary_f1_score': 0.10970464}
confusion matrix:
       0   1
0  42224  96
1   1381  91
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.7284301, 'recall': 0.53294736, 'specificity': 0.53294736, 'f1': 0.55127585, 'auroc': 0.89440924, 'binary_precision': 0.4888889, 'binary_recall': 0.06842924, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.12005457}
confusion matrix:
       0   1
0  18103  46
1    599  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.88959944, 'recall': 0.5910369, 'specificity': 0.5910369, 'f1': 0.6408166, 'auroc': 0.88535714, 'binary_precision': 0.8135593, 'binary_recall': 0.18390805, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.3}
confusion matrix:
      0   1
0  5986  11
1   213  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 6
val acc:0.9656769037246704, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9576541781425476 / 0.964205801486969
after epoch: 10,now: 2024-05-29 17:38:03.593997,epoch time: 0:23:44.755460,used: 4:00:00.281830,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9664779, 'precision': 0.7381581, 'recall': 0.5498818, 'specificity': 0.5498818, 'f1': 0.5772252, 'auroc': 0.90594876, 'binary_precision': 0.50666666, 'binary_recall': 0.10326087, 'binary_specificity': 0.9965028, 'binary_f1_score': 0.17155755}
confusion matrix:
       0    1
0  42172  148
1   1320  152
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.7304486, 'recall': 0.5614219, 'specificity': 0.5614219, 'f1': 0.5924512, 'auroc': 0.8993763, 'binary_precision': 0.49101797, 'binary_recall': 0.12752722, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.20246916}
confusion matrix:
       0   1
0  18064  85
1    561  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.89520574, 'recall': 0.6062792, 'specificity': 0.6062792, 'f1': 0.66130984, 'auroc': 0.9000509, 'binary_precision': 0.8235294, 'binary_recall': 0.21455939, 'binary_specificity': 0.997999, 'binary_f1_score': 0.34042555}
confusion matrix:
      0   1
0  5985  12
1   205  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 7
val acc:0.965623676776886, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9576541781425476 / 0.9653244018554688
after epoch: 11,now: 2024-05-29 18:02:10.870065,epoch time: 0:24:07.276068,used: 4:24:07.557898,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9658613, 'precision': 0.7144132, 'recall': 0.5426778, 'specificity': 0.5426778, 'f1': 0.56584954, 'auroc': 0.90042984, 'binary_precision': 0.45964912, 'binary_recall': 0.08899456, 'binary_specificity': 0.9963611, 'binary_f1_score': 0.14911781}
confusion matrix:
       0    1
0  42166  154
1   1341  131
---- Validation: 
scalar performance:
{'acc': 0.9642401, 'precision': 0.68702877, 'recall': 0.5457045, 'specificity': 0.5457045, 'f1': 0.568756, 'auroc': 0.89867145, 'binary_precision': 0.40522876, 'binary_recall': 0.096423015, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.15577888}
confusion matrix:
       0   1
0  18058  91
1    581  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.9208853, 'recall': 0.65417194, 'specificity': 0.65417194, 'f1': 0.7209201, 'auroc': 0.89770305, 'binary_precision': 0.87096775, 'binary_recall': 0.31034482, 'binary_specificity': 0.997999, 'binary_f1_score': 0.45762712}
confusion matrix:
      0   1
0  5985  12
1   180  81
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 8
val acc:0.9642400741577148, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9576541781425476 / 0.9693192839622498
after epoch: 12,now: 2024-05-29 18:25:04.794098,epoch time: 0:22:53.924033,used: 4:47:01.481931,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9658842, 'precision': 0.71913004, 'recall': 0.5531811, 'specificity': 0.5531811, 'f1': 0.5808505, 'auroc': 0.9041569, 'binary_precision': 0.4683908, 'binary_recall': 0.110733695, 'binary_specificity': 0.99562854, 'binary_f1_score': 0.17912087}
confusion matrix:
       0    1
0  42135  185
1   1309  163
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.7295347, 'recall': 0.56589466, 'specificity': 0.56589466, 'f1': 0.5981258, 'auroc': 0.9056675, 'binary_precision': 0.4888889, 'binary_recall': 0.13685848, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.21385176}
confusion matrix:
       0   1
0  18057  92
1    555  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9717162, 'precision': 0.917928, 'recall': 0.69023687, 'specificity': 0.69023687, 'f1': 0.7579614, 'auroc': 0.8968564, 'binary_precision': 0.86206895, 'binary_recall': 0.38314176, 'binary_specificity': 0.997332, 'binary_f1_score': 0.530504}
confusion matrix:
      0    1
0  5981   16
1   161  100
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 9
val acc:0.9655704498291016, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9576541781425476 / 0.9717162251472473
after epoch: 13,now: 2024-05-29 18:48:02.572700,epoch time: 0:22:57.778602,used: 5:09:59.260533,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96663773, 'precision': 0.7402471, 'recall': 0.6104225, 'specificity': 0.6104225, 'f1': 0.64897585, 'auroc': 0.90860176, 'binary_precision': 0.50678736, 'binary_recall': 0.22857143, 'binary_specificity': 0.9922735, 'binary_f1_score': 0.31504923}
confusion matrix:
       0    1
0  41995  327
1   1134  336
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.7326899, 'recall': 0.62509394, 'specificity': 0.62509394, 'f1': 0.66102225, 'auroc': 0.90780497, 'binary_precision': 0.49117646, 'binary_recall': 0.25972006, 'binary_specificity': 0.9904678, 'binary_f1_score': 0.3397762}
confusion matrix:
       0    1
0  17976  173
1    476  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9752317, 'precision': 0.90714777, 'recall': 0.75070584, 'specificity': 0.75070584, 'f1': 0.8086293, 'auroc': 0.8927348, 'binary_precision': 0.835443, 'binary_recall': 0.50574714, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.63007164}
confusion matrix:
      0    1
0  5971   26
1   129  132
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 10
val acc:0.9654640555381775, best validation acc: 0.9656769037246704, corresponding to test acc:                         0.9576541781425476 / 0.9752317070960999
after epoch: 14,now: 2024-05-29 19:10:59.399268,epoch time: 0:22:56.826568,used: 5:32:56.087101,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9662495, 'precision': 0.73372215, 'recall': 0.59435254, 'specificity': 0.59435254, 'f1': 0.631574, 'auroc': 0.9154862, 'binary_precision': 0.49484536, 'binary_recall': 0.19565217, 'binary_specificity': 0.99305296, 'binary_f1_score': 0.28042844}
confusion matrix:
       0    1
0  42026  294
1   1184  288
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.73568213, 'recall': 0.60873044, 'specificity': 0.60873044, 'f1': 0.6464604, 'auroc': 0.9055389, 'binary_precision': 0.49828178, 'binary_recall': 0.22550544, 'binary_specificity': 0.99195546, 'binary_f1_score': 0.31049252}
confusion matrix:
       0    1
0  18003  146
1    498  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97315437, 'precision': 0.9102183, 'recall': 0.71663994, 'specificity': 0.71663994, 'f1': 0.78094804, 'auroc': 0.90710986, 'binary_precision': 0.84444445, 'binary_recall': 0.43678162, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.57575756}
confusion matrix:
      0    1
0  5976   21
1   147  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
better model found
persisted
after epoch: 15,now: 2024-05-29 19:33:53.349231,epoch time: 0:22:53.949963,used: 5:55:50.037064,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9668661, 'precision': 0.74637127, 'recall': 0.5871308, 'specificity': 0.5871308, 'f1': 0.62529564, 'auroc': 0.91484714, 'binary_precision': 0.5206287, 'binary_recall': 0.18002717, 'binary_specificity': 0.9942344, 'binary_f1_score': 0.26754165}
confusion matrix:
       0    1
0  42076  244
1   1207  265
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.7435466, 'recall': 0.61197865, 'specificity': 0.61197865, 'f1': 0.6510371, 'auroc': 0.9081019, 'binary_precision': 0.5137931, 'binary_recall': 0.23172629, 'binary_specificity': 0.99223095, 'binary_f1_score': 0.31939977}
confusion matrix:
       0    1
0  18008  141
1    494  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.8909558, 'recall': 0.6914856, 'specificity': 0.6914856, 'f1': 0.75407356, 'auroc': 0.9148656, 'binary_precision': 0.808, 'binary_recall': 0.38697317, 'binary_specificity': 0.995998, 'binary_f1_score': 0.5233161}
confusion matrix:
      0    1
0  5973   24
1   160  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
better model found
persisted
after epoch: 16,now: 2024-05-29 19:56:35.992789,epoch time: 0:22:42.643558,used: 6:18:32.680622,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96677476, 'precision': 0.74295986, 'recall': 0.6320002, 'specificity': 0.6320002, 'f1': 0.66942865, 'auroc': 0.9162488, 'binary_precision': 0.5108005, 'binary_recall': 0.2730978, 'binary_specificity': 0.99090266, 'binary_f1_score': 0.35590965}
confusion matrix:
       0    1
0  41935  385
1   1070  402
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.73383886, 'recall': 0.65281844, 'specificity': 0.65281844, 'f1': 0.6839189, 'auroc': 0.9132763, 'binary_precision': 0.49156627, 'binary_recall': 0.31726283, 'binary_specificity': 0.988374, 'binary_f1_score': 0.3856333}
confusion matrix:
       0    1
0  17938  211
1    439  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9742729, 'precision': 0.8993584, 'recall': 0.74287623, 'specificity': 0.74287623, 'f1': 0.800301, 'auroc': 0.9078984, 'binary_precision': 0.82051283, 'binary_recall': 0.49042144, 'binary_specificity': 0.995331, 'binary_f1_score': 0.6139089}
confusion matrix:
      0    1
0  5969   28
1   133  128
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 1
val acc:0.9654108285903931, best validation acc: 0.9662090539932251, corresponding to test acc:                         0.9705976247787476 / 0.9752317070960999
after epoch: 17,now: 2024-05-29 20:19:30.406006,epoch time: 0:22:54.413217,used: 6:41:27.093839,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.965359, 'precision': 0.7201225, 'recall': 0.60575783, 'specificity': 0.60575783, 'f1': 0.6407739, 'auroc': 0.9126229, 'binary_precision': 0.4668588, 'binary_recall': 0.22025833, 'binary_specificity': 0.9912573, 'binary_f1_score': 0.29930717}
confusion matrix:
       0    1
0  41951  370
1   1147  324
---- Validation: 
scalar performance:
{'acc': 0.9647722, 'precision': 0.7252567, 'recall': 0.6374867, 'specificity': 0.6374867, 'f1': 0.66958565, 'auroc': 0.9162457, 'binary_precision': 0.47545218, 'binary_recall': 0.28615862, 'binary_specificity': 0.98881483, 'binary_f1_score': 0.35728154}
confusion matrix:
       0    1
0  17946  203
1    459  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9750719, 'precision': 0.8934053, 'recall': 0.76161647, 'specificity': 0.76161647, 'f1': 0.81298965, 'auroc': 0.9121362, 'binary_precision': 0.80701756, 'binary_recall': 0.52873564, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.6388889}
confusion matrix:
      0    1
0  5964   33
1   123  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 2
val acc:0.9647722244262695, best validation acc: 0.9662090539932251, corresponding to test acc:                         0.9705976247787476 / 0.9752317070960999
after epoch: 18,now: 2024-05-29 20:42:25.607858,epoch time: 0:22:55.201852,used: 7:04:22.295691,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9659527, 'precision': 0.7240647, 'recall': 0.5656752, 'specificity': 0.5656752, 'f1': 0.5974808, 'auroc': 0.9186057, 'binary_precision': 0.47743466, 'binary_recall': 0.1365489, 'binary_specificity': 0.9948015, 'binary_f1_score': 0.21236134}
confusion matrix:
       0    1
0  42100  220
1   1271  201
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.72383934, 'recall': 0.60012174, 'specificity': 0.60012174, 'f1': 0.6359039, 'auroc': 0.91697526, 'binary_precision': 0.47517732, 'binary_recall': 0.20839813, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.28972974}
confusion matrix:
       0    1
0  18001  148
1    509  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97299457, 'precision': 0.8938669, 'recall': 0.72755057, 'specificity': 0.72755057, 'f1': 0.7864191, 'auroc': 0.908936, 'binary_precision': 0.8108108, 'binary_recall': 0.4597701, 'binary_specificity': 0.995331, 'binary_f1_score': 0.58679706}
confusion matrix:
      0    1
0  5969   28
1   141  120
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 3
val acc:0.9650382995605469, best validation acc: 0.9662090539932251, corresponding to test acc:                         0.9705976247787476 / 0.9752317070960999
after epoch: 19,now: 2024-05-29 21:05:16.060485,epoch time: 0:22:50.452627,used: 7:27:12.748318,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9658613, 'precision': 0.72959685, 'recall': 0.6203804, 'specificity': 0.6203804, 'f1': 0.6561907, 'auroc': 0.91876507, 'binary_precision': 0.4848485, 'binary_recall': 0.25, 'binary_specificity': 0.99076086, 'binary_f1_score': 0.3298969}
confusion matrix:
       0    1
0  41929  391
1   1104  368
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.7357057, 'recall': 0.6544012, 'specificity': 0.6544012, 'f1': 0.6856662, 'auroc': 0.91633356, 'binary_precision': 0.49519232, 'binary_recall': 0.32037324, 'binary_specificity': 0.9884291, 'binary_f1_score': 0.38904622}
confusion matrix:
       0    1
0  17939  210
1    437  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9741131, 'precision': 0.8860211, 'recall': 0.75378686, 'specificity': 0.75378686, 'f1': 0.8049259, 'auroc': 0.90879416, 'binary_precision': 0.7928994, 'binary_recall': 0.51341, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.6232558}
confusion matrix:
      0    1
0  5962   35
1   127  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 4
val acc:0.9655704498291016, best validation acc: 0.9662090539932251, corresponding to test acc:                         0.9705976247787476 / 0.9752317070960999
after epoch: 20,now: 2024-05-29 21:27:58.453728,epoch time: 0:22:42.393243,used: 7:49:55.141561,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9661354, 'precision': 0.73486006, 'recall': 0.64848316, 'specificity': 0.64848316, 'f1': 0.6809155, 'auroc': 0.92176545, 'binary_precision': 0.49346405, 'binary_recall': 0.30795377, 'binary_specificity': 0.98901254, 'binary_f1_score': 0.37923816}
confusion matrix:
       0    1
0  41856  465
1   1018  453
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.73489946, 'recall': 0.67081976, 'specificity': 0.67081976, 'f1': 0.6972388, 'auroc': 0.9162655, 'binary_precision': 0.4924406, 'binary_recall': 0.35458788, 'binary_specificity': 0.9870516, 'binary_f1_score': 0.4122966}
confusion matrix:
       0    1
0  17914  235
1    415  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97810805, 'precision': 0.9250821, 'recall': 0.7778592, 'specificity': 0.7778592, 'f1': 0.8346591, 'auroc': 0.91097015, 'binary_precision': 0.86904764, 'binary_recall': 0.55938697, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.6806527}
confusion matrix:
      0    1
0  5975   22
1   115  146
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 5
val acc:0.9654108285903931, best validation acc: 0.9662090539932251, corresponding to test acc:                         0.9705976247787476 / 0.9781080484390259
after epoch: 21,now: 2024-05-29 21:50:50.117256,epoch time: 0:22:51.663528,used: 8:12:46.805089,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96677476, 'precision': 0.7431482, 'recall': 0.6179023, 'specificity': 0.6179023, 'f1': 0.65669173, 'auroc': 0.9227017, 'binary_precision': 0.51212555, 'binary_recall': 0.24388587, 'binary_specificity': 0.99191874, 'binary_f1_score': 0.33041877}
confusion matrix:
       0    1
0  41978  342
1   1113  359
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.7330444, 'recall': 0.6303443, 'specificity': 0.6303443, 'f1': 0.6656543, 'auroc': 0.9138899, 'binary_precision': 0.4915254, 'binary_recall': 0.27060652, 'binary_specificity': 0.9900821, 'binary_f1_score': 0.34904715}
confusion matrix:
       0    1
0  17969  180
1    469  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97682965, 'precision': 0.910897, 'recall': 0.77169526, 'specificity': 0.77169526, 'f1': 0.82578737, 'auroc': 0.90629876, 'binary_precision': 0.84117645, 'binary_recall': 0.54789275, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.6635731}
confusion matrix:
      0    1
0  5970   27
1   118  143
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 6
val acc:0.9654640555381775, best validation acc: 0.9662090539932251, corresponding to test acc:                         0.9705976247787476 / 0.9781080484390259
after epoch: 22,now: 2024-05-29 22:13:44.169817,epoch time: 0:22:54.052561,used: 8:35:40.857650,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9669346, 'precision': 0.74483603, 'recall': 0.69208115, 'specificity': 0.69208115, 'f1': 0.71493196, 'auroc': 0.92037165, 'binary_precision': 0.5104712, 'binary_recall': 0.39741847, 'binary_specificity': 0.98674387, 'binary_f1_score': 0.44690603}
confusion matrix:
       0    1
0  41759  561
1    887  585
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.74015033, 'recall': 0.7130157, 'specificity': 0.7130157, 'f1': 0.72567797, 'auroc': 0.92073375, 'binary_precision': 0.5, 'binary_recall': 0.44167963, 'binary_specificity': 0.98435175, 'binary_f1_score': 0.46903387}
confusion matrix:
       0    1
0  17865  284
1    359  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9758709, 'precision': 0.8827651, 'recall': 0.787686, 'specificity': 0.787686, 'f1': 0.8278061, 'auroc': 0.9218671, 'binary_precision': 0.78350514, 'binary_recall': 0.58237547, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.6681319}
confusion matrix:
      0    1
0  5955   42
1   109  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 7
val acc:0.9657832980155945, best validation acc: 0.9662090539932251, corresponding to test acc:                         0.9705976247787476 / 0.9781080484390259
after epoch: 23,now: 2024-05-29 22:36:34.036648,epoch time: 0:22:49.866831,used: 8:58:30.724481,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9656787, 'precision': 0.73248076, 'recall': 0.68192345, 'specificity': 0.68192345, 'f1': 0.7037751, 'auroc': 0.92484224, 'binary_precision': 0.4864392, 'binary_recall': 0.3777174, 'binary_specificity': 0.98612946, 'binary_f1_score': 0.425239}
confusion matrix:
       0    1
0  41733  587
1    916  556
---- Validation: 
scalar performance:
{'acc': 0.965198, 'precision': 0.7357337, 'recall': 0.71871305, 'specificity': 0.71871305, 'f1': 0.72686744, 'auroc': 0.91844165, 'binary_precision': 0.4907563, 'binary_recall': 0.4541213, 'binary_specificity': 0.98330486, 'binary_f1_score': 0.47172856}
confusion matrix:
       0    1
0  17846  303
1    351  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9760307, 'precision': 0.873248, 'recall': 0.8042604, 'specificity': 0.8042604, 'f1': 0.8348745, 'auroc': 0.91414547, 'binary_precision': 0.76303315, 'binary_recall': 0.61685824, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.68220335}
confusion matrix:
      0    1
0  5947   50
1   100  161
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 8
val acc:0.9651979804039001, best validation acc: 0.9662090539932251, corresponding to test acc:                         0.9705976247787476 / 0.9781080484390259
after epoch: 24,now: 2024-05-29 22:59:21.638518,epoch time: 0:22:47.601870,used: 9:21:18.326351,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9664322, 'precision': 0.7375517, 'recall': 0.62140524, 'specificity': 0.62140524, 'f1': 0.6588116, 'auroc': 0.92230856, 'binary_precision': 0.5006766, 'binary_recall': 0.25152957, 'binary_specificity': 0.9912809, 'binary_f1_score': 0.3348416}
confusion matrix:
       0    1
0  41952  369
1   1101  370
---- Validation: 
scalar performance:
{'acc': 0.96525115, 'precision': 0.73179686, 'recall': 0.6489855, 'specificity': 0.6489855, 'f1': 0.68040633, 'auroc': 0.921123, 'binary_precision': 0.4877451, 'binary_recall': 0.30948678, 'binary_specificity': 0.9884842, 'binary_f1_score': 0.37868693}
confusion matrix:
       0    1
0  17940  209
1    444  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9742729, 'precision': 0.8936583, 'recall': 0.7483732, 'specificity': 0.7483732, 'f1': 0.8030359, 'auroc': 0.9180294, 'binary_precision': 0.80864197, 'binary_recall': 0.5019157, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.61938536}
confusion matrix:
      0    1
0  5966   31
1   130  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 9
val acc:0.9652511477470398, best validation acc: 0.9662090539932251, corresponding to test acc:                         0.9705976247787476 / 0.9781080484390259
after epoch: 25,now: 2024-05-29 23:22:14.192467,epoch time: 0:22:52.553949,used: 9:44:10.880300,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.73803085, 'recall': 0.6458973, 'specificity': 0.6458973, 'f1': 0.67976344, 'auroc': 0.92783064, 'binary_precision': 0.5, 'binary_recall': 0.30230978, 'binary_specificity': 0.9894849, 'binary_f1_score': 0.37679935}
confusion matrix:
       0    1
0  41875  445
1   1027  445
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.74645805, 'recall': 0.69014966, 'specificity': 0.69014966, 'f1': 0.714279, 'auroc': 0.9197348, 'binary_precision': 0.5142276, 'binary_recall': 0.3934681, 'binary_specificity': 0.98683125, 'binary_f1_score': 0.44581494}
confusion matrix:
       0    1
0  17910  239
1    390  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97651005, 'precision': 0.8956717, 'recall': 0.7825225, 'specificity': 0.7825225, 'f1': 0.8287425, 'auroc': 0.90723014, 'binary_precision': 0.8097826, 'binary_recall': 0.57088125, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.66966295}
confusion matrix:
      0    1
0  5962   35
1   112  149
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
better model found
persisted
after epoch: 26,now: 2024-05-29 23:45:05.555398,epoch time: 0:22:51.362931,used: 10:07:02.243231,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96666056, 'precision': 0.74191964, 'recall': 0.6781693, 'specificity': 0.6781693, 'f1': 0.70469135, 'auroc': 0.9313431, 'binary_precision': 0.50558656, 'binary_recall': 0.36888587, 'binary_specificity': 0.98745275, 'binary_f1_score': 0.42655143}
confusion matrix:
       0    1
0  41789  531
1    929  543
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.7435099, 'recall': 0.7004851, 'specificity': 0.7004851, 'f1': 0.7196814, 'auroc': 0.9225826, 'binary_precision': 0.50760454, 'binary_recall': 0.41524106, 'binary_specificity': 0.9857292, 'binary_f1_score': 0.4568007}
confusion matrix:
       0    1
0  17890  259
1    376  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9760307, 'precision': 0.8922566, 'recall': 0.7786077, 'specificity': 0.7786077, 'f1': 0.8248683, 'auroc': 0.9238489, 'binary_precision': 0.8032787, 'binary_recall': 0.5632184, 'binary_specificity': 0.993997, 'binary_f1_score': 0.6621622}
confusion matrix:
      0    1
0  5961   36
1   114  147
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 1
val acc:0.9662090539932251, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.9765100479125977 / 0.9781080484390259
after epoch: 27,now: 2024-05-30 00:07:54.007936,epoch time: 0:22:48.452538,used: 10:29:50.695769,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9655873, 'precision': 0.73172927, 'recall': 0.6831876, 'specificity': 0.6831876, 'f1': 0.7043017, 'auroc': 0.92742395, 'binary_precision': 0.4848485, 'binary_recall': 0.38043478, 'binary_specificity': 0.98594046, 'binary_f1_score': 0.42634186}
confusion matrix:
       0    1
0  41725  595
1    912  560
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.7332308, 'recall': 0.71779776, 'specificity': 0.71779776, 'f1': 0.72521913, 'auroc': 0.9270464, 'binary_precision': 0.48580968, 'binary_recall': 0.4525661, 'binary_specificity': 0.98302937, 'binary_f1_score': 0.46859902}
confusion matrix:
       0    1
0  17841  308
1    352  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97730905, 'precision': 0.9001962, 'recall': 0.7902687, 'specificity': 0.7902687, 'f1': 0.8356345, 'auroc': 0.9171463, 'binary_precision': 0.8181818, 'binary_recall': 0.5862069, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.68303573}
confusion matrix:
      0    1
0  5963   34
1   108  153
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 2
val acc:0.9648786783218384, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.9765100479125977 / 0.9781080484390259
after epoch: 28,now: 2024-05-30 00:30:39.882896,epoch time: 0:22:45.874960,used: 10:52:36.570729,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96714014, 'precision': 0.7468394, 'recall': 0.7108755, 'specificity': 0.7108755, 'f1': 0.7272908, 'auroc': 0.9310808, 'binary_precision': 0.51318944, 'binary_recall': 0.4361413, 'binary_specificity': 0.98560965, 'binary_f1_score': 0.47153875}
confusion matrix:
       0    1
0  41711  609
1    830  642
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.73807836, 'recall': 0.7330743, 'specificity': 0.7330743, 'f1': 0.7355466, 'auroc': 0.9237224, 'binary_precision': 0.4944356, 'binary_recall': 0.4836703, 'binary_specificity': 0.9824784, 'binary_f1_score': 0.4889937}
confusion matrix:
       0    1
0  17831  318
1    332  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97810805, 'precision': 0.896829, 'recall': 0.8071766, 'specificity': 0.8071766, 'f1': 0.8457277, 'auroc': 0.9123534, 'binary_precision': 0.81, 'binary_recall': 0.62068963, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.70282}
confusion matrix:
      0    1
0  5959   38
1    99  162
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 3
val acc:0.9654108285903931, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.9765100479125977 / 0.9781080484390259
after epoch: 29,now: 2024-05-30 00:53:45.103500,epoch time: 0:23:05.220604,used: 11:15:41.791333,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9659527, 'precision': 0.73347396, 'recall': 0.6595437, 'specificity': 0.6595437, 'f1': 0.6888076, 'auroc': 0.9295094, 'binary_precision': 0.48993963, 'binary_recall': 0.3310673, 'binary_specificity': 0.9880201, 'binary_f1_score': 0.39513186}
confusion matrix:
       0    1
0  41814  507
1    984  487
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.74486643, 'recall': 0.6803163, 'specificity': 0.6803163, 'f1': 0.70716316, 'auroc': 0.91956896, 'binary_precision': 0.5117271, 'binary_recall': 0.3732504, 'binary_specificity': 0.98738223, 'binary_f1_score': 0.4316547}
confusion matrix:
       0    1
0  17920  229
1    403  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9787472, 'precision': 0.9134791, 'recall': 0.7983484, 'specificity': 0.7983484, 'f1': 0.8457205, 'auroc': 0.9313227, 'binary_precision': 0.84408605, 'binary_recall': 0.6015326, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.7024609}
confusion matrix:
      0    1
0  5968   29
1   104  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 4
val acc:0.9663686752319336, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.9765100479125977 / 0.9787471890449524
after epoch: 30,now: 2024-05-30 01:17:08.532484,epoch time: 0:23:23.428984,used: 11:39:05.220317,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_29_13_38_03_seed_0_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:39:05.220317 at 2024-05-30 01:17:08.532484
persisted model performance metric: 

scalar performance:
{'acc': 0.97682965, 'precision': 0.9053186, 'recall': 0.77719223, 'specificity': 0.77719223, 'f1': 0.82809395, 'auroc': 0.9202571, 'binary_precision': 0.82954544, 'binary_recall': 0.55938697, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.6681922}
confusion matrix:
      0    1
0  5967   30
1   115  146
oracle model performance metric: 

scalar performance:
{'acc': 0.97651005, 'precision': 0.8925348, 'recall': 0.7861872, 'specificity': 0.7861872, 'f1': 0.83021194, 'auroc': 0.9212408, 'binary_precision': 0.8031915, 'binary_recall': 0.5785441, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.6726058}
confusion matrix:
      0    1
0  5960   37
1   110  151
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/11.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493147 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool | 403328 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |  89819 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 493147 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool | 403328 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |  89819 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  10880 MiB |    898 TiB |    898 TiB |
|       from large pool | 387840 KiB |  10808 MiB |    895 TiB |    895 TiB |
|       from small pool |  88733 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11482 MiB |  11482 MiB |  11482 MiB |      0 B   |
|       from large pool |  11356 MiB |  11356 MiB |  11356 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 752036 KiB |   1325 MiB | 384642 GiB | 384642 GiB |
|       from large pool | 741504 KiB |   1322 MiB | 381642 GiB | 381642 GiB |
|       from small pool |  10532 KiB |     11 MiB |   2999 GiB |   2999 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6720    |  139684 K  |  139680 K  |
|       from large pool |      87    |     908    |   56778 K  |   56778 K  |
|       from small pool |    3642    |    6631    |   82906 K  |   82902 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6720    |  139684 K  |  139680 K  |
|       from large pool |      87    |     908    |   56778 K  |   56778 K  |
|       from small pool |    3642    |    6631    |   82906 K  |   82902 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     404    |     404    |     404    |       0    |
|       from large pool |     341    |     341    |     341    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    2767    |   74813 K  |   74813 K  |
|       from large pool |      19    |     187    |   34810 K  |   34810 K  |
|       from small pool |      55    |    2747    |   40002 K  |   40002 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |    898 TiB |    898 TiB |
|       from large pool |  16640 KiB |  10808 MiB |    895 TiB |    895 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11482 MiB |  11482 MiB |  10266 MiB |
|       from large pool |   1118 MiB |  11356 MiB |  11356 MiB |  10238 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB | 384643 GiB | 384643 GiB |
|       from large pool |  50944 KiB |   1322 MiB | 381643 GiB | 381643 GiB |
|       from small pool |      0 KiB |     24 MiB |   2999 GiB |   2999 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  139684 K  |  139684 K  |
|       from large pool |       2    |     908    |   56778 K  |   56778 K  |
|       from small pool |       0    |    6631    |   82906 K  |   82906 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  139684 K  |  139684 K  |
|       from large pool |       2    |     908    |   56778 K  |   56778 K  |
|       from small pool |       0    |    6631    |   82906 K  |   82906 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     404    |     404    |     325    |
|       from large pool |      30    |     341    |     341    |     311    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2767    |   74814 K  |   74814 K  |
|       from large pool |       4    |     187    |   34810 K  |   34810 K  |
|       from small pool |       0    |    2747    |   40004 K  |   40004 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |    898 TiB |    898 TiB |
|       from large pool |  16640 KiB |  10808 MiB |    895 TiB |    895 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11482 MiB |  11482 MiB |  10266 MiB |
|       from large pool |   1118 MiB |  11356 MiB |  11356 MiB |  10238 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB | 384643 GiB | 384643 GiB |
|       from large pool |  50944 KiB |   1322 MiB | 381643 GiB | 381643 GiB |
|       from small pool |      0 KiB |     24 MiB |   2999 GiB |   2999 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  139684 K  |  139684 K  |
|       from large pool |       2    |     908    |   56778 K  |   56778 K  |
|       from small pool |       0    |    6631    |   82906 K  |   82906 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  139684 K  |  139684 K  |
|       from large pool |       2    |     908    |   56778 K  |   56778 K  |
|       from small pool |       0    |    6631    |   82906 K  |   82906 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     404    |     404    |     325    |
|       from large pool |      30    |     341    |     341    |     311    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2767    |   74814 K  |   74814 K  |
|       from large pool |       4    |     187    |   34810 K  |   34810 K  |
|       from small pool |       0    |    2747    |   40004 K  |   40004 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749

 Experiment start at: 2024-05-30 01:27:49.900306
before training, model accuracy: 0.09474702179431915
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9001961, 'precision': 0.4957221, 'recall': 0.4911919, 'specificity': 0.4911919, 'f1': 0.4906839, 'auroc': 0.49215057, 'binary_precision': 0.024927162, 'binary_recall': 0.053398058, 'binary_specificity': 0.9289857, 'binary_f1_score': 0.033988085}
confusion matrix:
       0     1
0  39402  3012
1   1365    77
---- Validation: 
scalar performance:
{'acc': 0.8172359, 'precision': 0.50322706, 'recall': 0.5125322, 'specificity': 0.5125322, 'f1': 0.4831047, 'auroc': 0.49284887, 'binary_precision': 0.041333333, 'binary_recall': 0.18424962, 'binary_specificity': 0.84081477, 'binary_f1_score': 0.06751974}
confusion matrix:
       0     1
0  15191  2876
1    549   124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91218174, 'precision': 0.4886084, 'recall': 0.48706824, 'specificity': 0.48706824, 'f1': 0.48778594, 'auroc': 0.37909454, 'binary_precision': 0.02020202, 'binary_recall': 0.023076924, 'binary_specificity': 0.9510595, 'binary_f1_score': 0.021543985}
confusion matrix:
      0    1
0  5655  291
1   254    6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-30 01:52:27.320667,epoch time: 0:24:37.420361,used: 0:24:37.420361,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96132797, 'precision': 0.5586294, 'recall': 0.5150931, 'specificity': 0.5150931, 'f1': 0.52006245, 'auroc': 0.6467228, 'binary_precision': 0.14917128, 'binary_recall': 0.03744799, 'binary_specificity': 0.99273825, 'binary_f1_score': 0.059866965}
confusion matrix:
       0    1
0  42106  308
1   1388   54
---- Validation: 
scalar performance:
{'acc': 0.9522412, 'precision': 0.5680859, 'recall': 0.5346264, 'specificity': 0.5346264, 'f1': 0.5442216, 'auroc': 0.6168226, 'binary_precision': 0.16964285, 'binary_recall': 0.08469539, 'binary_specificity': 0.9845575, 'binary_f1_score': 0.11298315}
confusion matrix:
       0    1
0  17788  279
1    616   57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95327103, 'precision': 0.49464995, 'recall': 0.49931628, 'specificity': 0.49931628, 'f1': 0.49146092, 'auroc': 0.56247795, 'binary_precision': 0.03125, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.006849315}
confusion matrix:
      0   1
0  5915  31
1   259   1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-30 02:16:02.386916,epoch time: 0:23:35.066249,used: 0:48:12.486610,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96709687, 'precision': 0.7143926, 'recall': 0.50199795, 'specificity': 0.50199795, 'f1': 0.49575916, 'auroc': 0.75995624, 'binary_precision': 0.46153846, 'binary_recall': 0.0041608876, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.008247422}
confusion matrix:
       0  1
0  42407  7
1   1436  6
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.6400805, 'recall': 0.5040979, 'specificity': 0.5040979, 'f1': 0.49942836, 'auroc': 0.75599694, 'binary_precision': 0.31578946, 'binary_recall': 0.008915304, 'binary_specificity': 0.99928045, 'binary_f1_score': 0.01734104}
confusion matrix:
       0   1
0  18054  13
1    667   6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.47904578, 'recall': 0.49983183, 'specificity': 0.49983183, 'f1': 0.4892181, 'auroc': 0.73921347, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5944  2
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-30 02:39:38.129323,epoch time: 0:23:35.742407,used: 1:11:48.229017,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96714246, 'precision': 0.73988163, 'recall': 0.5070458, 'specificity': 0.5070458, 'f1': 0.50580484, 'auroc': 0.81461215, 'binary_precision': 0.5121951, 'binary_recall': 0.014563107, 'binary_specificity': 0.99952847, 'binary_f1_score': 0.028320972}
confusion matrix:
       0   1
0  42394  20
1   1421  21
---- Validation: 
scalar performance:
{'acc': 0.96376735, 'precision': 0.6823357, 'recall': 0.5084171, 'specificity': 0.5084171, 'f1': 0.5078384, 'auroc': 0.8028021, 'binary_precision': 0.4, 'binary_recall': 0.017830608, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.034139402}
confusion matrix:
       0   1
0  18049  18
1    661  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.8542809, 'recall': 0.50568515, 'specificity': 0.50568515, 'f1': 0.5007446, 'auroc': 0.79880345, 'binary_precision': 0.75, 'binary_recall': 0.011538462, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.022727273}
confusion matrix:
      0  1
0  5945  1
1   257  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-05-30 03:03:12.966070,epoch time: 0:23:34.836747,used: 1:35:23.065764,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96714246, 'precision': 0.7613913, 'recall': 0.5016866, 'specificity': 0.5016866, 'f1': 0.49509335, 'auroc': 0.8431767, 'binary_precision': 0.5555556, 'binary_recall': 0.0034674064, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.006891799}
confusion matrix:
       0  1
0  42410  4
1   1437  5
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.66961616, 'recall': 0.50209045, 'specificity': 0.50209045, 'f1': 0.49523383, 'auroc': 0.83572346, 'binary_precision': 0.375, 'binary_recall': 0.004457652, 'binary_specificity': 0.99972326, 'binary_f1_score': 0.008810572}
confusion matrix:
       0  1
0  18062  5
1    670  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.97912973, 'recall': 0.5019231, 'specificity': 0.5019231, 'f1': 0.49317387, 'auroc': 0.8393972, 'binary_precision': 1.0, 'binary_recall': 0.0038461538, 'binary_specificity': 1.0, 'binary_f1_score': 0.007662835}
confusion matrix:
      0  1
0  5946  0
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
better model found
persisted
after epoch: 5,now: 2024-05-30 03:26:52.227598,epoch time: 0:23:39.261528,used: 1:59:02.327292,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96709687, 'precision': 0.7189388, 'recall': 0.50266784, 'specificity': 0.50266784, 'f1': 0.49711826, 'auroc': 0.8651537, 'binary_precision': 0.47058824, 'binary_recall': 0.0055478504, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.0109664155}
confusion matrix:
       0  1
0  42405  9
1   1434  8
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.7129607, 'recall': 0.50426394, 'specificity': 0.50426394, 'f1': 0.49958727, 'auroc': 0.8673521, 'binary_precision': 0.46153846, 'binary_recall': 0.008915304, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.017492712}
confusion matrix:
       0  1
0  18060  7
1    667  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.9792069, 'recall': 0.50384617, 'specificity': 0.50384617, 'f1': 0.4970163, 'auroc': 0.8553281, 'binary_precision': 1.0, 'binary_recall': 0.0076923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.015267175}
confusion matrix:
      0  1
0  5946  0
1   258  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
better model found
persisted
after epoch: 6,now: 2024-05-30 03:50:28.013036,epoch time: 0:23:35.785438,used: 2:22:38.112730,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96707404, 'precision': 0.7109384, 'recall': 0.50332594, 'specificity': 0.50332594, 'f1': 0.49845937, 'auroc': 0.86824906, 'binary_precision': 0.45454547, 'binary_recall': 0.0069348128, 'binary_specificity': 0.99971706, 'binary_f1_score': 0.013661202}
confusion matrix:
       0   1
0  42402  12
1   1432  10
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.71554965, 'recall': 0.5049792, 'specificity': 0.5049792, 'f1': 0.5010148, 'auroc': 0.88185066, 'binary_precision': 0.46666667, 'binary_recall': 0.010401188, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.020348836}
confusion matrix:
       0  1
0  18059  8
1    666  7
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.97936153, 'recall': 0.50769234, 'specificity': 0.50769234, 'f1': 0.5046148, 'auroc': 0.8710193, 'binary_precision': 1.0, 'binary_recall': 0.015384615, 'binary_specificity': 1.0, 'binary_f1_score': 0.03030303}
confusion matrix:
      0  1
0  5946  0
1   256  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 1
val acc:0.9640341401100159, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9584273099899292 / 0.9587495923042297
after epoch: 7,now: 2024-05-30 04:14:05.487199,epoch time: 0:23:37.474163,used: 2:46:15.586893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9669145, 'precision': 0.71295774, 'recall': 0.51798254, 'specificity': 0.51798254, 'f1': 0.52621657, 'auroc': 0.8833609, 'binary_precision': 0.45762712, 'binary_recall': 0.037473977, 'binary_specificity': 0.9984911, 'binary_f1_score': 0.06927518}
confusion matrix:
       0   1
0  42351  64
1   1387  54
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.76762724, 'recall': 0.5483657, 'specificity': 0.5483657, 'f1': 0.5757493, 'auroc': 0.89083236, 'binary_precision': 0.5677966, 'binary_recall': 0.09955423, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.1694058}
confusion matrix:
       0   1
0  18016  51
1    606  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.94896, 'recall': 0.52876204, 'specificity': 0.52876204, 'f1': 0.5442127, 'auroc': 0.876793, 'binary_precision': 0.9375, 'binary_recall': 0.057692308, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.108695656}
confusion matrix:
      0   1
0  5945   1
1   245  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-05-30 04:37:53.092301,epoch time: 0:23:47.605102,used: 3:10:03.191995,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96714246, 'precision': 0.73729897, 'recall': 0.51273996, 'specificity': 0.51273996, 'f1': 0.51669043, 'auroc': 0.8882984, 'binary_precision': 0.50666666, 'binary_recall': 0.026352288, 'binary_specificity': 0.9991276, 'binary_f1_score': 0.05009888}
confusion matrix:
       0   1
0  42377  37
1   1404  38
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.76389366, 'recall': 0.529575, 'specificity': 0.529575, 'f1': 0.54592186, 'auroc': 0.89362574, 'binary_precision': 0.56164384, 'binary_recall': 0.060921248, 'binary_specificity': 0.9982288, 'binary_f1_score': 0.10991957}
confusion matrix:
       0   1
0  18035  32
1    632  41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9123324, 'recall': 0.5362862, 'specificity': 0.5362862, 'f1': 0.5573182, 'auroc': 0.8770791, 'binary_precision': 0.8636364, 'binary_recall': 0.073076926, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.13475178}
confusion matrix:
      0   1
0  5943   3
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 1
val acc:0.9645677804946899, best validation acc: 0.9649413228034973, corresponding to test acc:                         0.9603609442710876 / 0.9606832265853882
after epoch: 9,now: 2024-05-30 05:01:21.937683,epoch time: 0:23:28.845382,used: 3:33:32.037377,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96718806, 'precision': 0.7432684, 'recall': 0.51410335, 'specificity': 0.51410335, 'f1': 0.51922923, 'auroc': 0.88751, 'binary_precision': 0.5185185, 'binary_recall': 0.029126214, 'binary_specificity': 0.9990805, 'binary_f1_score': 0.055154298}
confusion matrix:
       0   1
0  42375  39
1   1400  42
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.74756086, 'recall': 0.53304064, 'specificity': 0.53304064, 'f1': 0.55143046, 'auroc': 0.89490294, 'binary_precision': 0.52873564, 'binary_recall': 0.068350665, 'binary_specificity': 0.9977307, 'binary_f1_score': 0.12105262}
confusion matrix:
       0   1
0  18026  41
1    627  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.92773044, 'recall': 0.5325241, 'specificity': 0.5325241, 'f1': 0.5508355, 'auroc': 0.87196565, 'binary_precision': 0.8947368, 'binary_recall': 0.06538462, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.121863805}
confusion matrix:
      0   1
0  5944   2
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 2
val acc:0.9643543362617493, best validation acc: 0.9649413228034973, corresponding to test acc:                         0.9603609442710876 / 0.9606832265853882
after epoch: 10,now: 2024-05-30 05:24:49.958290,epoch time: 0:23:28.020607,used: 3:57:00.057984,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9673705, 'precision': 0.750106, 'recall': 0.5316152, 'specificity': 0.5316152, 'f1': 0.54974973, 'auroc': 0.8981613, 'binary_precision': 0.53107345, 'binary_recall': 0.06518724, 'binary_specificity': 0.9980431, 'binary_f1_score': 0.11612107}
confusion matrix:
       0   1
0  42331  83
1   1348  94
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.74098694, 'recall': 0.55160993, 'specificity': 0.55160993, 'f1': 0.5794382, 'auroc': 0.8995303, 'binary_precision': 0.51428574, 'binary_recall': 0.106983654, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.17712177}
confusion matrix:
       0   1
0  17999  68
1    601  72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.95303607, 'recall': 0.56329334, 'specificity': 0.56329334, 'f1': 0.6024149, 'auroc': 0.88805383, 'binary_precision': 0.94285715, 'binary_recall': 0.12692308, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.22372884}
confusion matrix:
      0   1
0  5944   2
1   227  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 3
val acc:0.9643009901046753, best validation acc: 0.9649413228034973, corresponding to test acc:                         0.9603609442710876 / 0.963100254535675
after epoch: 11,now: 2024-05-30 05:49:02.802134,epoch time: 0:24:12.843844,used: 4:21:12.901828,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96707404, 'precision': 0.731561, 'recall': 0.52844733, 'specificity': 0.52844733, 'f1': 0.5442784, 'auroc': 0.90238285, 'binary_precision': 0.49418604, 'binary_recall': 0.05894591, 'binary_specificity': 0.99794877, 'binary_f1_score': 0.10532838}
confusion matrix:
       0   1
0  42327  87
1   1357  85
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.74245477, 'recall': 0.56954694, 'specificity': 0.56954694, 'f1': 0.60355234, 'auroc': 0.90331805, 'binary_precision': 0.5159575, 'binary_recall': 0.14413075, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.22531939}
confusion matrix:
       0   1
0  17976  91
1    576  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.9025701, 'recall': 0.5610339, 'specificity': 0.5610339, 'f1': 0.5977243, 'auroc': 0.88909805, 'binary_precision': 0.84210527, 'binary_recall': 0.12307692, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.2147651}
confusion matrix:
      0   1
0  5940   6
1   228  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 4
val acc:0.9644076824188232, best validation acc: 0.9649413228034973, corresponding to test acc:                         0.9603609442710876 / 0.963100254535675
after epoch: 12,now: 2024-05-30 06:13:18.635744,epoch time: 0:24:15.833610,used: 4:45:28.735438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9673705, 'precision': 0.7431793, 'recall': 0.56243074, 'specificity': 0.56243074, 'f1': 0.5948328, 'auroc': 0.9055138, 'binary_precision': 0.5152355, 'binary_recall': 0.12898752, 'binary_specificity': 0.995874, 'binary_f1_score': 0.20632282}
confusion matrix:
       0    1
0  42239  175
1   1256  186
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.74956447, 'recall': 0.61130923, 'specificity': 0.61130923, 'f1': 0.6512928, 'auroc': 0.9073359, 'binary_precision': 0.5272109, 'binary_recall': 0.23031203, 'binary_specificity': 0.9923064, 'binary_f1_score': 0.3205791}
confusion matrix:
       0    1
0  17928  139
1    518  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9666452, 'precision': 0.91544616, 'recall': 0.6203129, 'specificity': 0.6203129, 'f1': 0.6806206, 'auroc': 0.88454956, 'binary_precision': 0.8630137, 'binary_recall': 0.2423077, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.37837836}
confusion matrix:
      0   1
0  5936  10
1   197  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 5
val acc:0.9649413228034973, best validation acc: 0.9649413228034973, corresponding to test acc:                         0.9603609442710876 / 0.9666451811790466
after epoch: 13,now: 2024-05-30 06:37:28.717435,epoch time: 0:24:10.081691,used: 5:09:38.817129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9666636, 'precision': 0.7253924, 'recall': 0.5754634, 'specificity': 0.5754634, 'f1': 0.6095573, 'auroc': 0.9050467, 'binary_precision': 0.47881356, 'binary_recall': 0.15672676, 'binary_specificity': 0.99420005, 'binary_f1_score': 0.23615465}
confusion matrix:
       0    1
0  42168  246
1   1216  226
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.7477137, 'recall': 0.6392046, 'specificity': 0.6392046, 'f1': 0.67662984, 'auroc': 0.91174614, 'binary_precision': 0.52150536, 'binary_recall': 0.2882615, 'binary_specificity': 0.99014777, 'binary_f1_score': 0.37129185}
confusion matrix:
       0    1
0  17889  178
1    479  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693845, 'precision': 0.9178072, 'recall': 0.6585222, 'specificity': 0.6585222, 'f1': 0.7252662, 'auroc': 0.8921376, 'binary_precision': 0.8645833, 'binary_recall': 0.31923077, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.46629214}
confusion matrix:
      0   1
0  5933  13
1   177  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 6
val acc:0.9649413228034973, best validation acc: 0.9649413228034973, corresponding to test acc:                         0.9603609442710876 / 0.969384491443634
after epoch: 14,now: 2024-05-30 07:01:35.857095,epoch time: 0:24:07.139660,used: 5:33:45.956789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9673705, 'precision': 0.74302816, 'recall': 0.5641055, 'specificity': 0.5641055, 'f1': 0.5970207, 'auroc': 0.91236985, 'binary_precision': 0.5148248, 'binary_recall': 0.13245492, 'binary_specificity': 0.9957561, 'binary_f1_score': 0.21070047}
confusion matrix:
       0    1
0  42234  180
1   1251  191
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.74806964, 'recall': 0.6191495, 'specificity': 0.6191495, 'f1': 0.6586606, 'auroc': 0.9109833, 'binary_precision': 0.5236593, 'binary_recall': 0.24665676, 'binary_specificity': 0.99164224, 'binary_f1_score': 0.33535352}
confusion matrix:
       0    1
0  17916  151
1    507  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687399, 'precision': 0.9268278, 'recall': 0.64531296, 'specificity': 0.64531296, 'f1': 0.711614, 'auroc': 0.90002525, 'binary_precision': 0.88372093, 'binary_recall': 0.2923077, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.43930635}
confusion matrix:
      0   1
0  5936  10
1   184  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 7
val acc:0.9648879170417786, best validation acc: 0.9649413228034973, corresponding to test acc:                         0.9603609442710876 / 0.969384491443634
after epoch: 15,now: 2024-05-30 07:25:43.917216,epoch time: 0:24:08.060121,used: 5:57:54.016910,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96816856, 'precision': 0.7664292, 'recall': 0.5712172, 'specificity': 0.5712172, 'f1': 0.6079353, 'auroc': 0.9113965, 'binary_precision': 0.5611702, 'binary_recall': 0.14632455, 'binary_specificity': 0.9961098, 'binary_f1_score': 0.23212321}
confusion matrix:
       0    1
0  42249  165
1   1231  211
---- Validation: 
scalar performance:
{'acc': 0.9654749, 'precision': 0.7559786, 'recall': 0.6301829, 'specificity': 0.6301829, 'f1': 0.6705155, 'auroc': 0.9097187, 'binary_precision': 0.53869045, 'binary_recall': 0.268945, 'binary_specificity': 0.9914208, 'binary_f1_score': 0.35877106}
confusion matrix:
       0    1
0  17912  155
1    492  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.8853162, 'recall': 0.62365454, 'specificity': 0.62365454, 'f1': 0.6818758, 'auroc': 0.88784266, 'binary_precision': 0.80246913, 'binary_recall': 0.25, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.38123167}
confusion matrix:
      0   1
0  5930  16
1   195  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
better model found
persisted
after epoch: 16,now: 2024-05-30 07:49:53.061640,epoch time: 0:24:09.144424,used: 6:22:03.161334,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96700567, 'precision': 0.7324623, 'recall': 0.56492174, 'specificity': 0.56492174, 'f1': 0.5972972, 'auroc': 0.9104297, 'binary_precision': 0.49363866, 'binary_recall': 0.13453537, 'binary_specificity': 0.99530816, 'binary_f1_score': 0.21144414}
confusion matrix:
       0    1
0  42215  199
1   1248  194
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.7453836, 'recall': 0.60687923, 'specificity': 0.60687923, 'f1': 0.6461448, 'auroc': 0.9097258, 'binary_precision': 0.5191638, 'binary_recall': 0.22139673, 'binary_specificity': 0.9923618, 'binary_f1_score': 0.31041667}
confusion matrix:
       0    1
0  17929  138
1    524  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.8665528, 'recall': 0.61763304, 'specificity': 0.61763304, 'f1': 0.67282975, 'auroc': 0.9060675, 'binary_precision': 0.7654321, 'binary_recall': 0.23846154, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.3636364}
confusion matrix:
      0   1
0  5927  19
1   198  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 1
val acc:0.9646744728088379, best validation acc: 0.9654749035835266, corresponding to test acc:                         0.9660006165504456 / 0.969384491443634
after epoch: 17,now: 2024-05-30 08:14:10.754419,epoch time: 0:24:17.692779,used: 6:46:20.854113,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9664584, 'precision': 0.72253907, 'recall': 0.58339614, 'specificity': 0.58339614, 'f1': 0.61826104, 'auroc': 0.9157648, 'binary_precision': 0.4725898, 'binary_recall': 0.17337032, 'binary_specificity': 0.993422, 'binary_f1_score': 0.25367835}
confusion matrix:
       0    1
0  42135  279
1   1192  250
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.743468, 'recall': 0.6504829, 'specificity': 0.6504829, 'f1': 0.6847979, 'auroc': 0.9147403, 'binary_precision': 0.5121951, 'binary_recall': 0.31203565, 'binary_specificity': 0.9889301, 'binary_f1_score': 0.3878116}
confusion matrix:
       0    1
0  17867  200
1    463  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9698679, 'precision': 0.9066241, 'recall': 0.6716474, 'specificity': 0.6716474, 'f1': 0.7374691, 'auroc': 0.91096276, 'binary_precision': 0.8411215, 'binary_recall': 0.34615386, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.4904632}
confusion matrix:
      0   1
0  5929  17
1   170  90
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 2
val acc:0.9646211266517639, best validation acc: 0.9654749035835266, corresponding to test acc:                         0.9660006165504456 / 0.9698678851127625
after epoch: 18,now: 2024-05-30 08:38:19.444069,epoch time: 0:24:08.689650,used: 7:10:29.543763,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96577436, 'precision': 0.7122877, 'recall': 0.5914163, 'specificity': 0.5914163, 'f1': 0.62531966, 'auroc': 0.91454554, 'binary_precision': 0.45155993, 'binary_recall': 0.19070736, 'binary_specificity': 0.9921252, 'binary_f1_score': 0.26816186}
confusion matrix:
       0    1
0  42080  334
1   1167  275
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.7386833, 'recall': 0.65455306, 'specificity': 0.65455306, 'f1': 0.6866067, 'auroc': 0.912675, 'binary_precision': 0.5023256, 'binary_recall': 0.32095096, 'binary_specificity': 0.9881552, 'binary_f1_score': 0.3916591}
confusion matrix:
       0    1
0  17853  214
1    457  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97067356, 'precision': 0.8992729, 'recall': 0.6886187, 'specificity': 0.6886187, 'f1': 0.7529631, 'auroc': 0.8966228, 'binary_precision': 0.825, 'binary_recall': 0.38076922, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.5210526}
confusion matrix:
      0   1
0  5925  21
1   161  99
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 3
val acc:0.9641942381858826, best validation acc: 0.9654749035835266, corresponding to test acc:                         0.9660006165504456 / 0.9706735610961914
after epoch: 19,now: 2024-05-30 09:02:36.808877,epoch time: 0:24:17.364808,used: 7:34:46.908571,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9663444, 'precision': 0.7240027, 'recall': 0.6041042, 'specificity': 0.6041042, 'f1': 0.6399511, 'auroc': 0.91719985, 'binary_precision': 0.47416413, 'binary_recall': 0.21636616, 'binary_specificity': 0.9918423, 'binary_f1_score': 0.29714286}
confusion matrix:
       0    1
0  42068  346
1   1130  312
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.743008, 'recall': 0.68049645, 'specificity': 0.68049645, 'f1': 0.70661044, 'auroc': 0.916973, 'binary_precision': 0.5090909, 'binary_recall': 0.3744428, 'binary_specificity': 0.9865501, 'binary_f1_score': 0.4315068}
confusion matrix:
       0    1
0  17824  243
1    421  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9732517, 'precision': 0.9084243, 'recall': 0.72122693, 'specificity': 0.72122693, 'f1': 0.7845487, 'auroc': 0.8975924, 'binary_precision': 0.8405797, 'binary_recall': 0.44615385, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.5829146}
confusion matrix:
      0    1
0  5924   22
1   144  116
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 4
val acc:0.9645677804946899, best validation acc: 0.9654749035835266, corresponding to test acc:                         0.9660006165504456 / 0.9732517004013062
after epoch: 20,now: 2024-05-30 09:26:52.463413,epoch time: 0:24:15.654536,used: 7:59:02.563107,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9668688, 'precision': 0.73213947, 'recall': 0.59834623, 'specificity': 0.59834623, 'f1': 0.63556695, 'auroc': 0.918285, 'binary_precision': 0.49081802, 'binary_recall': 0.2038835, 'binary_specificity': 0.992809, 'binary_f1_score': 0.28809404}
confusion matrix:
       0    1
0  42109  305
1   1148  294
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.738381, 'recall': 0.6631086, 'specificity': 0.6631086, 'f1': 0.6928847, 'auroc': 0.91404027, 'binary_precision': 0.50109893, 'binary_recall': 0.33878157, 'binary_specificity': 0.98743564, 'binary_f1_score': 0.40425533}
confusion matrix:
       0    1
0  17840  227
1    445  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97019017, 'precision': 0.89417386, 'recall': 0.68468845, 'specificity': 0.68468845, 'f1': 0.7482495, 'auroc': 0.9097378, 'binary_precision': 0.81512606, 'binary_recall': 0.37307692, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.51187336}
confusion matrix:
      0   1
0  5924  22
1   163  97
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 5
val acc:0.9641408920288086, best validation acc: 0.9654749035835266, corresponding to test acc:                         0.9660006165504456 / 0.9732517004013062
after epoch: 21,now: 2024-05-30 09:50:54.242878,epoch time: 0:24:01.779465,used: 8:23:04.342572,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9674617, 'precision': 0.74301505, 'recall': 0.6076964, 'specificity': 0.6076964, 'f1': 0.6468163, 'auroc': 0.9144187, 'binary_precision': 0.5119617, 'binary_recall': 0.2226075, 'binary_specificity': 0.9927854, 'binary_f1_score': 0.31029484}
confusion matrix:
       0    1
0  42108  306
1   1121  321
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.74033415, 'recall': 0.6753512, 'specificity': 0.6753512, 'f1': 0.70217955, 'auroc': 0.9184346, 'binary_precision': 0.5041152, 'binary_recall': 0.3640416, 'binary_specificity': 0.9866608, 'binary_f1_score': 0.42277828}
confusion matrix:
       0    1
0  17826  241
1    428  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9708347, 'precision': 0.9113207, 'recall': 0.6831859, 'specificity': 0.6831859, 'f1': 0.7498554, 'auroc': 0.9079881, 'binary_precision': 0.8495575, 'binary_recall': 0.36923078, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.51474535}
confusion matrix:
      0   1
0  5929  17
1   164  96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 6
val acc:0.9643009901046753, best validation acc: 0.9654749035835266, corresponding to test acc:                         0.9660006165504456 / 0.9732517004013062
after epoch: 22,now: 2024-05-30 10:15:01.419274,epoch time: 0:24:07.176396,used: 8:47:11.518968,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9672109, 'precision': 0.738686, 'recall': 0.6122561, 'specificity': 0.6122561, 'f1': 0.65051925, 'auroc': 0.91966546, 'binary_precision': 0.503003, 'binary_recall': 0.23231623, 'binary_specificity': 0.99219596, 'binary_f1_score': 0.3178368}
confusion matrix:
       0    1
0  42083  331
1   1107  335
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.7495034, 'recall': 0.6751064, 'specificity': 0.6751064, 'f1': 0.7050643, 'auroc': 0.9176377, 'binary_precision': 0.52248394, 'binary_recall': 0.3625557, 'binary_specificity': 0.98765707, 'binary_f1_score': 0.42807016}
confusion matrix:
       0    1
0  17844  223
1    429  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97164035, 'precision': 0.8942823, 'recall': 0.7075131, 'specificity': 0.7075131, 'f1': 0.76932734, 'auroc': 0.90702164, 'binary_precision': 0.8134328, 'binary_recall': 0.41923076, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.5532994}
confusion matrix:
      0    1
0  5921   25
1   151  109
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 7
val acc:0.965208113193512, best validation acc: 0.9654749035835266, corresponding to test acc:                         0.9660006165504456 / 0.9732517004013062
after epoch: 23,now: 2024-05-30 10:39:16.878202,epoch time: 0:24:15.458928,used: 9:11:26.977896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9674845, 'precision': 0.7429776, 'recall': 0.6485724, 'specificity': 0.6485724, 'f1': 0.6832601, 'auroc': 0.9217636, 'binary_precision': 0.5091954, 'binary_recall': 0.3072122, 'binary_specificity': 0.9899326, 'binary_f1_score': 0.383218}
confusion matrix:
       0    1
0  41987  427
1    999  443
---- Validation: 
scalar performance:
{'acc': 0.96558166, 'precision': 0.7524867, 'recall': 0.6974734, 'specificity': 0.6974734, 'f1': 0.7212376, 'auroc': 0.9207444, 'binary_precision': 0.52681994, 'binary_recall': 0.40861812, 'binary_specificity': 0.98632866, 'binary_f1_score': 0.46025106}
confusion matrix:
       0    1
0  17820  247
1    398  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9737351, 'precision': 0.903578, 'recall': 0.7325131, 'specificity': 0.7325131, 'f1': 0.79296553, 'auroc': 0.91422224, 'binary_precision': 0.829932, 'binary_recall': 0.46923077, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.59950864}
confusion matrix:
      0    1
0  5921   25
1   138  122
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-05-30 11:03:31.423982,epoch time: 0:24:14.545780,used: 9:35:41.523676,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9664812, 'precision': 0.7303697, 'recall': 0.64403427, 'specificity': 0.64403427, 'f1': 0.67621136, 'auroc': 0.9251983, 'binary_precision': 0.48426965, 'binary_recall': 0.29889044, 'binary_specificity': 0.9891781, 'binary_f1_score': 0.3696398}
confusion matrix:
       0    1
0  41955  459
1   1011  431
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.74560237, 'recall': 0.6985165, 'specificity': 0.6985165, 'f1': 0.71927404, 'auroc': 0.922314, 'binary_precision': 0.51296294, 'binary_recall': 0.4115899, 'binary_specificity': 0.98544306, 'binary_f1_score': 0.4567189}
confusion matrix:
       0    1
0  17804  263
1    396  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.973574, 'precision': 0.9007722, 'recall': 0.732429, 'specificity': 0.732429, 'f1': 0.7921885, 'auroc': 0.9115087, 'binary_precision': 0.8243243, 'binary_recall': 0.46923077, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.5980392}
confusion matrix:
      0    1
0  5920   26
1   138  122
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 1
val acc:0.9648345708847046, best validation acc: 0.9655816555023193, corresponding to test acc:                         0.9737350940704346 / 0.9737350940704346
after epoch: 25,now: 2024-05-30 11:27:41.085925,epoch time: 0:24:09.661943,used: 9:59:51.185619,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96714246, 'precision': 0.7392602, 'recall': 0.6674878, 'specificity': 0.6674878, 'f1': 0.69638455, 'auroc': 0.92778444, 'binary_precision': 0.5005005, 'binary_recall': 0.34674063, 'binary_specificity': 0.988235, 'binary_f1_score': 0.40966815}
confusion matrix:
       0    1
0  41915  499
1    942  500
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.74790156, 'recall': 0.7265503, 'specificity': 0.7265503, 'f1': 0.7366885, 'auroc': 0.9234436, 'binary_precision': 0.51549757, 'binary_recall': 0.46953937, 'binary_specificity': 0.9835612, 'binary_f1_score': 0.49144632}
confusion matrix:
       0    1
0  17770  297
1    357  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.973574, 'precision': 0.91460896, 'recall': 0.72139513, 'specificity': 0.72139513, 'f1': 0.78610504, 'auroc': 0.9151967, 'binary_precision': 0.85294116, 'binary_recall': 0.44615385, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.5858586}
confusion matrix:
      0    1
0  5926   20
1   144  116
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 2
val acc:0.9651013612747192, best validation acc: 0.9655816555023193, corresponding to test acc:                         0.9737350940704346 / 0.9737350940704346
after epoch: 26,now: 2024-05-30 11:51:40.994449,epoch time: 0:23:59.908524,used: 10:23:51.094143,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9665268, 'precision': 0.73385394, 'recall': 0.684922, 'specificity': 0.684922, 'f1': 0.70621943, 'auroc': 0.9255278, 'binary_precision': 0.4885159, 'binary_recall': 0.38349515, 'binary_specificity': 0.98634887, 'binary_f1_score': 0.42968142}
confusion matrix:
       0    1
0  41835  579
1    889  553
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.7449769, 'recall': 0.7256413, 'specificity': 0.7256413, 'f1': 0.7348643, 'auroc': 0.92429805, 'binary_precision': 0.50970876, 'binary_recall': 0.4680535, 'binary_specificity': 0.9832291, 'binary_f1_score': 0.4879938}
confusion matrix:
       0    1
0  17764  303
1    358  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9769578, 'precision': 0.89433, 'recall': 0.79304254, 'specificity': 0.79304254, 'f1': 0.8354857, 'auroc': 0.90852225, 'binary_precision': 0.8062827, 'binary_recall': 0.5923077, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.68292683}
confusion matrix:
      0    1
0  5909   37
1   106  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 3
val acc:0.9647278785705566, best validation acc: 0.9655816555023193, corresponding to test acc:                         0.9737350940704346 / 0.9769577980041504
after epoch: 27,now: 2024-05-30 12:15:55.658660,epoch time: 0:24:14.664211,used: 10:48:05.758354,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9669145, 'precision': 0.73694783, 'recall': 0.6710544, 'specificity': 0.6710544, 'f1': 0.69812024, 'auroc': 0.92290044, 'binary_precision': 0.4956353, 'binary_recall': 0.35436893, 'binary_specificity': 0.9877399, 'binary_f1_score': 0.41326326}
confusion matrix:
       0    1
0  41894  520
1    931  511
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.7483543, 'recall': 0.7144184, 'specificity': 0.7144184, 'f1': 0.7299967, 'auroc': 0.92246723, 'binary_precision': 0.517301, 'binary_recall': 0.44427934, 'binary_specificity': 0.9845575, 'binary_f1_score': 0.47801754}
confusion matrix:
       0    1
0  17788  279
1    374  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97437966, 'precision': 0.8890555, 'recall': 0.7567563, 'specificity': 0.7567563, 'f1': 0.80805093, 'auroc': 0.9087764, 'binary_precision': 0.79881656, 'binary_recall': 0.5192308, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.6293707}
confusion matrix:
      0    1
0  5912   34
1   125  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 4
val acc:0.965154767036438, best validation acc: 0.9655816555023193, corresponding to test acc:                         0.9737350940704346 / 0.9769577980041504
after epoch: 28,now: 2024-05-30 12:40:10.435416,epoch time: 0:24:14.776756,used: 11:12:20.535110,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96570593, 'precision': 0.7233987, 'recall': 0.6583713, 'specificity': 0.6583713, 'f1': 0.6847412, 'auroc': 0.92952394, 'binary_precision': 0.4693676, 'binary_recall': 0.3294036, 'binary_specificity': 0.9873391, 'binary_f1_score': 0.38712308}
confusion matrix:
       0    1
0  41877  537
1    967  475
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.7493154, 'recall': 0.7087516, 'specificity': 0.7087516, 'f1': 0.7270297, 'auroc': 0.9202142, 'binary_precision': 0.51964283, 'binary_recall': 0.43239227, 'binary_specificity': 0.985111, 'binary_f1_score': 0.47201946}
confusion matrix:
       0    1
0  17798  269
1    382  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97502416, 'precision': 0.896919, 'recall': 0.75893164, 'specificity': 0.75893164, 'f1': 0.8120347, 'auroc': 0.9177637, 'binary_precision': 0.8143712, 'binary_recall': 0.52307695, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.63700235}
confusion matrix:
      0    1
0  5915   31
1   124  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 5
val acc:0.9652614593505859, best validation acc: 0.9655816555023193, corresponding to test acc:                         0.9737350940704346 / 0.9769577980041504
after epoch: 29,now: 2024-05-30 13:04:24.598356,epoch time: 0:24:14.162940,used: 11:36:34.698050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9666864, 'precision': 0.73216975, 'recall': 0.6347617, 'specificity': 0.6347617, 'f1': 0.6692186, 'auroc': 0.92816293, 'binary_precision': 0.48848486, 'binary_recall': 0.27947295, 'binary_specificity': 0.99005044, 'binary_f1_score': 0.35553592}
confusion matrix:
       0    1
0  41992  422
1   1039  403
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.7555302, 'recall': 0.70839614, 'specificity': 0.70839614, 'f1': 0.7292981, 'auroc': 0.9253855, 'binary_precision': 0.5321101, 'binary_recall': 0.4309064, 'binary_specificity': 0.98588586, 'binary_f1_score': 0.47619045}
confusion matrix:
       0    1
0  17812  255
1    383  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9730905, 'precision': 0.90776205, 'recall': 0.71930385, 'specificity': 0.71930385, 'f1': 0.78272295, 'auroc': 0.9174448, 'binary_precision': 0.8394161, 'binary_recall': 0.44230768, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.5793451}
confusion matrix:
      0    1
0  5924   22
1   145  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
better model found
persisted
after epoch: 30,now: 2024-05-30 13:28:33.659794,epoch time: 0:24:09.061438,used: 12:00:43.759488,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_01_27_49_seed_1_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:00:43.759488 at 2024-05-30 13:28:33.659794
persisted model performance metric: 

scalar performance:
{'acc': 0.9737351, 'precision': 0.9057746, 'recall': 0.73067415, 'specificity': 0.73067415, 'f1': 0.7919777, 'auroc': 0.91540074, 'binary_precision': 0.8344827, 'binary_recall': 0.4653846, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.5975308}
confusion matrix:
      0    1
0  5922   24
1   139  121
oracle model performance metric: 

scalar performance:
{'acc': 0.9761521, 'precision': 0.90301275, 'recall': 0.7705542, 'specificity': 0.7705542, 'f1': 0.8225267, 'auroc': 0.9116161, 'binary_precision': 0.8255814, 'binary_recall': 0.54615384, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.6574074}
confusion matrix:
      0    1
0  5916   30
1   118  142
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493647 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool | 403840 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |  89807 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 493647 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool | 403840 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |  89807 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476570 KiB |  10880 MiB |   1799 TiB |   1799 TiB |
|       from large pool | 387840 KiB |  10808 MiB |   1794 TiB |   1794 TiB |
|       from small pool |  88730 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11460 MiB |  11482 MiB |  21726 MiB |  10266 MiB |
|       from large pool |  11336 MiB |  11356 MiB |  21574 MiB |  10238 MiB |
|       from small pool |    124 MiB |    126 MiB |    152 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 518064 KiB |   1325 MiB |    861 TiB |    861 TiB |
|       from large pool | 511616 KiB |   1322 MiB |    856 TiB |    856 TiB |
|       from small pool |   6448 KiB |     24 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3705    |    6728    |  279833 K  |  279829 K  |
|       from large pool |      87    |     908    |  113788 K  |  113788 K  |
|       from small pool |    3618    |    6639    |  166045 K  |  166041 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3705    |    6728    |  279833 K  |  279829 K  |
|       from large pool |      87    |     908    |  113788 K  |  113788 K  |
|       from small pool |    3618    |    6639    |  166045 K  |  166041 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     399    |     404    |     724    |     325    |
|       from large pool |     337    |     341    |     648    |     311    |
|       from small pool |      62    |      63    |      76    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    2772    |  150114 K  |  150114 K  |
|       from large pool |      20    |     187    |   69937 K  |   69937 K  |
|       from small pool |      51    |    2751    |   80176 K  |   80176 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |   1799 TiB |   1799 TiB |
|       from large pool |  16640 KiB |  10808 MiB |   1794 TiB |   1794 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    988 MiB |  11482 MiB |  21726 MiB |  20738 MiB |
|       from large pool |    894 MiB |  11356 MiB |  21574 MiB |  20680 MiB |
|       from small pool |     94 MiB |    126 MiB |    152 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB |    861 TiB |    861 TiB |
|       from large pool |  50944 KiB |   1322 MiB |    856 TiB |    856 TiB |
|       from small pool |      0 KiB |     24 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  279833 K  |  279833 K  |
|       from large pool |       2    |     908    |  113788 K  |  113788 K  |
|       from small pool |       0    |    6639    |  166045 K  |  166045 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  279833 K  |  279833 K  |
|       from large pool |       2    |     908    |  113788 K  |  113788 K  |
|       from small pool |       0    |    6639    |  166045 K  |  166045 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      80    |     404    |     724    |     644    |
|       from large pool |      33    |     341    |     648    |     615    |
|       from small pool |      47    |      63    |      76    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2772    |  150116 K  |  150116 K  |
|       from large pool |       4    |     187    |   69937 K  |   69937 K  |
|       from small pool |       0    |    2751    |   80178 K  |   80178 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |   1799 TiB |   1799 TiB |
|       from large pool |  16640 KiB |  10808 MiB |   1794 TiB |   1794 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    988 MiB |  11482 MiB |  21726 MiB |  20738 MiB |
|       from large pool |    894 MiB |  11356 MiB |  21574 MiB |  20680 MiB |
|       from small pool |     94 MiB |    126 MiB |    152 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB |    861 TiB |    861 TiB |
|       from large pool |  50944 KiB |   1322 MiB |    856 TiB |    856 TiB |
|       from small pool |      0 KiB |     24 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  279833 K  |  279833 K  |
|       from large pool |       2    |     908    |  113788 K  |  113788 K  |
|       from small pool |       0    |    6639    |  166045 K  |  166045 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  279833 K  |  279833 K  |
|       from large pool |       2    |     908    |  113788 K  |  113788 K  |
|       from small pool |       0    |    6639    |  166045 K  |  166045 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      80    |     404    |     724    |     644    |
|       from large pool |      33    |     341    |     648    |     615    |
|       from small pool |      47    |      63    |      76    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2772    |  150116 K  |  150116 K  |
|       from large pool |       4    |     187    |   69937 K  |   69937 K  |
|       from small pool |       0    |    2751    |   80178 K  |   80178 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749

 Experiment start at: 2024-05-30 13:39:53.162447
before training, model accuracy: 0.04888604208827019
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95235485, 'precision': 0.49426752, 'recall': 0.4976662, 'specificity': 0.4976662, 'f1': 0.4944103, 'auroc': 0.5091578, 'binary_precision': 0.023217248, 'binary_recall': 0.00925314, 'binary_specificity': 0.9860793, 'binary_f1_score': 0.013232515}
confusion matrix:
       0    1
0  41722  589
1   1499   14
---- Validation: 
scalar performance:
{'acc': 0.9389016, 'precision': 0.48442662, 'recall': 0.4858066, 'specificity': 0.4858066, 'f1': 0.48511353, 'auroc': 0.37661958, 'binary_precision': 0.0018281536, 'binary_recall': 0.0016611295, 'binary_specificity': 0.9699521, 'binary_f1_score': 0.001740644}
confusion matrix:
       0    1
0  17625  546
1    601    1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9471069, 'precision': 0.48595887, 'recall': 0.4946457, 'specificity': 0.4946457, 'f1': 0.48942736, 'auroc': 0.36787266, 'binary_precision': 0.011111111, 'binary_recall': 0.004132231, 'binary_specificity': 0.9851592, 'binary_f1_score': 0.0060240966}
confusion matrix:
      0   1
0  5908  89
1   241   1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-30 14:05:02.623520,epoch time: 0:25:09.461073,used: 0:25:09.461073,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96488225, 'precision': 0.5160821, 'recall': 0.50033003, 'specificity': 0.50033003, 'f1': 0.4923594, 'auroc': 0.6861192, 'binary_precision': 0.06666667, 'binary_recall': 0.0013218771, 'binary_specificity': 0.9993382, 'binary_f1_score': 0.002592353}
confusion matrix:
       0   1
0  42283  28
1   1511   2
---- Validation: 
scalar performance:
{'acc': 0.9672402, 'precision': 0.48395523, 'recall': 0.49964228, 'specificity': 0.49964228, 'f1': 0.49167365, 'auroc': 0.6508627, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99928457, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18158  13
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.61563766, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-05-30 14:29:03.523434,epoch time: 0:24:00.899914,used: 0:49:10.360987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.965293, 'precision': 0.53274524, 'recall': 0.5002241, 'specificity': 0.5002241, 'f1': 0.49182642, 'auroc': 0.7885469, 'binary_precision': 0.1, 'binary_recall': 0.00066093856, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.0013131978}
confusion matrix:
       0  1
0  42302  9
1   1512  1
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.7732935, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7306798, 'recall': 0.50198275, 'specificity': 0.50198275, 'f1': 0.4942079, 'auroc': 0.7230747, 'binary_precision': 0.5, 'binary_recall': 0.004132231, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.008196721}
confusion matrix:
      0  1
0  5996  1
1   241  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-05-30 14:53:08.288384,epoch time: 0:24:04.764950,used: 1:13:15.125937,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96545273, 'precision': 0.607759, 'recall': 0.5002952, 'specificity': 0.5002952, 'f1': 0.4918708, 'auroc': 0.83911407, 'binary_precision': 0.25, 'binary_recall': 0.00066137564, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.0013192612}
confusion matrix:
       0  1
0  42309  3
1   1511  1
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.83650786, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.81364113, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 4,now: 2024-05-30 15:17:14.360821,epoch time: 0:24:06.072437,used: 1:37:21.198374,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9654983, 'precision': 0.98274875, 'recall': 0.50033045, 'specificity': 0.50033045, 'f1': 0.4918835, 'auroc': 0.8560324, 'binary_precision': 1.0, 'binary_recall': 0.00066093856, 'binary_specificity': 1.0, 'binary_f1_score': 0.0013210041}
confusion matrix:
       0  1
0  42311  0
1   1512  1
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.85905826, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.831101, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 5,now: 2024-05-30 15:41:19.785432,epoch time: 0:24:05.424611,used: 2:01:26.622985,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9654983, 'precision': 0.98274875, 'recall': 0.50033045, 'specificity': 0.50033045, 'f1': 0.4918835, 'auroc': 0.8707781, 'binary_precision': 1.0, 'binary_recall': 0.00066093856, 'binary_specificity': 1.0, 'binary_f1_score': 0.0013210041}
confusion matrix:
       0  1
0  42311  0
1   1512  1
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.86284083, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.86542165, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 3
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 6,now: 2024-05-30 16:05:34.644417,epoch time: 0:24:14.858985,used: 2:25:41.481970,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9653614, 'precision': 0.4827358, 'recall': 0.4999409, 'specificity': 0.4999409, 'f1': 0.49118772, 'auroc': 0.88574535, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42306  5
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.7340411, 'recall': 0.50240916, 'specificity': 0.50240916, 'f1': 0.4967854, 'auroc': 0.88791955, 'binary_precision': 0.5, 'binary_recall': 0.004983389, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.009868422}
confusion matrix:
       0  1
0  18168  3
1    599  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.9806829, 'recall': 0.50206614, 'specificity': 0.50206614, 'f1': 0.49426642, 'auroc': 0.8712843, 'binary_precision': 1.0, 'binary_recall': 0.004132231, 'binary_specificity': 1.0, 'binary_f1_score': 0.008230452}
confusion matrix:
      0  1
0  5997  0
1   241  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 4
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9613720178604126
after epoch: 7,now: 2024-05-30 16:29:49.365897,epoch time: 0:24:14.721480,used: 2:49:56.203450,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.7327803, 'recall': 0.5012746, 'specificity': 0.5012746, 'f1': 0.49384633, 'auroc': 0.89048386, 'binary_precision': 0.5, 'binary_recall': 0.0026437542, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.005259698}
confusion matrix:
       0  1
0  42307  4
1   1509  4
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.6984, 'recall': 0.50476325, 'specificity': 0.50476325, 'f1': 0.50156265, 'auroc': 0.8899854, 'binary_precision': 0.42857143, 'binary_recall': 0.009966778, 'binary_specificity': 0.99955976, 'binary_f1_score': 0.019480519}
confusion matrix:
       0  1
0  18163  8
1    596  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.9813002, 'recall': 0.51859504, 'specificity': 0.51859504, 'f1': 0.52632844, 'auroc': 0.89138854, 'binary_precision': 1.0, 'binary_recall': 0.037190083, 'binary_specificity': 1.0, 'binary_f1_score': 0.07171315}
confusion matrix:
      0  1
0  5997  0
1   233  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 5
val acc:0.9678261280059814, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9626542925834656
after epoch: 8,now: 2024-05-30 16:54:06.655257,epoch time: 0:24:17.289360,used: 3:14:13.492810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96565807, 'precision': 0.8328897, 'recall': 0.50455564, 'specificity': 0.50455564, 'f1': 0.5003941, 'auroc': 0.89288175, 'binary_precision': 0.7, 'binary_recall': 0.00925314, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.018264841}
confusion matrix:
       0   1
0  42305   6
1   1499  14
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.6507053, 'recall': 0.5023266, 'specificity': 0.5023266, 'f1': 0.49671993, 'auroc': 0.8934182, 'binary_precision': 0.33333334, 'binary_recall': 0.004983389, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.009819968}
confusion matrix:
       0  1
0  18165  6
1    599  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.91864264, 'recall': 0.51437944, 'specificity': 0.51437944, 'f1': 0.51835, 'auroc': 0.8890989, 'binary_precision': 0.875, 'binary_recall': 0.02892562, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.055999998}
confusion matrix:
      0  1
0  5996  1
1   235  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 6
val acc:0.9677728414535522, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9626542925834656
after epoch: 9,now: 2024-05-30 17:18:17.021019,epoch time: 0:24:10.365762,used: 3:38:23.858572,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96538424, 'precision': 0.63276803, 'recall': 0.5009087, 'specificity': 0.5009087, 'f1': 0.4931628, 'auroc': 0.89412296, 'binary_precision': 0.3, 'binary_recall': 0.0019828156, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.0039395927}
confusion matrix:
       0  1
0  42304  7
1   1510  3
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73411596, 'recall': 0.50481826, 'specificity': 0.50481826, 'f1': 0.5016219, 'auroc': 0.8921246, 'binary_precision': 0.5, 'binary_recall': 0.009966778, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.019543974}
confusion matrix:
       0  1
0  18165  6
1    596  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.9096369, 'recall': 0.5123133, 'specificity': 0.5123133, 'f1': 0.5144063, 'auroc': 0.88882387, 'binary_precision': 0.85714287, 'binary_recall': 0.024793388, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.04819277}
confusion matrix:
      0  1
0  5996  1
1   236  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 7
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9626542925834656
after epoch: 10,now: 2024-05-30 17:41:48.452539,epoch time: 0:23:31.431520,used: 4:01:55.290092,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96552116, 'precision': 0.7372878, 'recall': 0.5210547, 'specificity': 0.5210547, 'f1': 0.531386, 'auroc': 0.90345436, 'binary_precision': 0.50769234, 'binary_recall': 0.043621942, 'binary_specificity': 0.9984874, 'binary_f1_score': 0.08034084}
confusion matrix:
       0   1
0  42247  64
1   1447  66
---- Validation: 
scalar performance:
{'acc': 0.9672402, 'precision': 0.6829931, 'recall': 0.5197185, 'specificity': 0.5197185, 'f1': 0.52925634, 'auroc': 0.9030368, 'binary_precision': 0.3968254, 'binary_recall': 0.04152824, 'binary_specificity': 0.9979088, 'binary_f1_score': 0.075187966}
confusion matrix:
       0   1
0  18133  38
1    577  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.96792936, 'recall': 0.5660323, 'specificity': 0.5660323, 'f1': 0.6077182, 'auroc': 0.8936087, 'binary_precision': 0.969697, 'binary_recall': 0.1322314, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.23272727}
confusion matrix:
      0   1
0  5996   1
1   210  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 8
val acc:0.9672402143478394, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9661805033683777
after epoch: 11,now: 2024-05-30 18:05:19.694590,epoch time: 0:23:31.242051,used: 4:25:26.532143,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9646769, 'precision': 0.6783534, 'recall': 0.5193428, 'specificity': 0.5193428, 'f1': 0.52807885, 'auroc': 0.90295583, 'binary_precision': 0.3899371, 'binary_recall': 0.04097819, 'binary_specificity': 0.9977074, 'binary_f1_score': 0.07416268}
confusion matrix:
       0   1
0  42214  97
1   1451  62
---- Validation: 
scalar performance:
{'acc': 0.9672402, 'precision': 0.7035296, 'recall': 0.5357795, 'specificity': 0.5357795, 'f1': 0.5554831, 'auroc': 0.90941, 'binary_precision': 0.4368932, 'binary_recall': 0.07475083, 'binary_specificity': 0.9968081, 'binary_f1_score': 0.12765959}
confusion matrix:
       0   1
0  18113  58
1    557  45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.9423424, 'recall': 0.5905756, 'specificity': 0.5905756, 'f1': 0.6434373, 'auroc': 0.8983624, 'binary_precision': 0.9166667, 'binary_recall': 0.18181819, 'binary_specificity': 0.999333, 'binary_f1_score': 0.3034483}
confusion matrix:
      0   1
0  5993   4
1   198  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 9
val acc:0.9672402143478394, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9676229953765869
after epoch: 12,now: 2024-05-30 18:29:15.234100,epoch time: 0:23:55.539510,used: 4:49:22.071653,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9646769, 'precision': 0.69484925, 'recall': 0.52985835, 'specificity': 0.52985835, 'f1': 0.5456511, 'auroc': 0.9083368, 'binary_precision': 0.42222223, 'binary_recall': 0.06278916, 'binary_specificity': 0.9969275, 'binary_f1_score': 0.10932105}
confusion matrix:
       0    1
0  42181  130
1   1418   95
---- Validation: 
scalar performance:
{'acc': 0.9671869, 'precision': 0.70934117, 'recall': 0.5477977, 'specificity': 0.5477977, 'f1': 0.57315445, 'auroc': 0.9127998, 'binary_precision': 0.4477612, 'binary_recall': 0.09966777, 'binary_specificity': 0.9959276, 'binary_f1_score': 0.16304348}
confusion matrix:
       0   1
0  18097  74
1    542  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96970665, 'precision': 0.95952773, 'recall': 0.61545235, 'specificity': 0.61545235, 'f1': 0.67828596, 'auroc': 0.8975817, 'binary_precision': 0.9491525, 'binary_recall': 0.23140496, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.37209302}
confusion matrix:
      0   1
0  5994   3
1   186  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 10
val acc:0.9671869277954102, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.969706654548645
after epoch: 13,now: 2024-05-30 18:53:23.644958,epoch time: 0:24:08.410858,used: 5:13:30.482511,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9647682, 'precision': 0.69584906, 'recall': 0.5273564, 'specificity': 0.5273564, 'f1': 0.5416562, 'auroc': 0.90691173, 'binary_precision': 0.42439026, 'binary_recall': 0.05750165, 'binary_specificity': 0.9972111, 'binary_f1_score': 0.101280555}
confusion matrix:
       0    1
0  42193  118
1   1426   87
---- Validation: 
scalar performance:
{'acc': 0.9672402, 'precision': 0.7110253, 'recall': 0.54782516, 'specificity': 0.54782516, 'f1': 0.5732792, 'auroc': 0.90818655, 'binary_precision': 0.45112783, 'binary_recall': 0.09966777, 'binary_specificity': 0.9959826, 'binary_f1_score': 0.1632653}
confusion matrix:
       0   1
0  18098  73
1    542  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9703478, 'precision': 0.90375364, 'recall': 0.645527, 'specificity': 0.645527, 'f1': 0.7095128, 'auroc': 0.8886392, 'binary_precision': 0.8352941, 'binary_recall': 0.29338843, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.43425074}
confusion matrix:
      0   1
0  5983  14
1   171  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 11
val acc:0.9672402143478394, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9703478217124939
after epoch: 14,now: 2024-05-30 19:17:31.875730,epoch time: 0:24:08.230772,used: 5:37:38.713283,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.7345036, 'recall': 0.55257756, 'specificity': 0.55257756, 'f1': 0.5807115, 'auroc': 0.91473687, 'binary_precision': 0.5, 'binary_recall': 0.109054856, 'binary_specificity': 0.9961003, 'binary_f1_score': 0.17905588}
confusion matrix:
       0    1
0  42146  165
1   1348  165
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.73313636, 'recall': 0.56740105, 'specificity': 0.56740105, 'f1': 0.60059595, 'auroc': 0.91089904, 'binary_precision': 0.49411765, 'binary_recall': 0.13953489, 'binary_specificity': 0.9952672, 'binary_f1_score': 0.21761657}
confusion matrix:
       0   1
0  18085  86
1    518  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9721109, 'precision': 0.9488614, 'recall': 0.65239227, 'specificity': 0.65239227, 'f1': 0.7226567, 'auroc': 0.90434337, 'binary_precision': 0.925, 'binary_recall': 0.30578512, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.45962733}
confusion matrix:
      0   1
0  5991   6
1   168  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 12
val acc:0.9678261280059814, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.97211092710495
after epoch: 15,now: 2024-05-30 19:41:41.039626,epoch time: 0:24:09.163896,used: 6:01:47.877179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9648138, 'precision': 0.7199018, 'recall': 0.57298577, 'specificity': 0.57298577, 'f1': 0.60588294, 'auroc': 0.9158478, 'binary_precision': 0.46938777, 'binary_recall': 0.1521164, 'binary_specificity': 0.9938552, 'binary_f1_score': 0.22977023}
confusion matrix:
       0    1
0  42052  260
1   1282  230
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.7401642, 'recall': 0.5956453, 'specificity': 0.5956453, 'f1': 0.6340157, 'auroc': 0.9149122, 'binary_precision': 0.506383, 'binary_recall': 0.19767442, 'binary_specificity': 0.9936162, 'binary_f1_score': 0.28434888}
confusion matrix:
       0    1
0  18055  116
1    483  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97195065, 'precision': 0.9029709, 'recall': 0.67213637, 'specificity': 0.67213637, 'f1': 0.7376874, 'auroc': 0.9086058, 'binary_precision': 0.83168316, 'binary_recall': 0.34710744, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.48979592}
confusion matrix:
      0   1
0  5980  17
1   158  84
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
better model found
persisted
after epoch: 16,now: 2024-05-30 20:05:53.677354,epoch time: 0:24:12.637728,used: 6:26:00.514907,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9655668, 'precision': 0.7373945, 'recall': 0.5711067, 'specificity': 0.5711067, 'f1': 0.6052618, 'auroc': 0.91702545, 'binary_precision': 0.5045249, 'binary_recall': 0.1473893, 'binary_specificity': 0.99482405, 'binary_f1_score': 0.22813298}
confusion matrix:
       0    1
0  42092  219
1   1290  223
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.73444104, 'recall': 0.5874772, 'specificity': 0.5874772, 'f1': 0.6243799, 'auroc': 0.9135753, 'binary_precision': 0.49545455, 'binary_recall': 0.18106312, 'binary_specificity': 0.99389136, 'binary_f1_score': 0.2652068}
confusion matrix:
       0    1
0  18060  111
1    493  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97259176, 'precision': 0.90341234, 'recall': 0.68238354, 'specificity': 0.68238354, 'f1': 0.7479651, 'auroc': 0.9029839, 'binary_precision': 0.8317757, 'binary_recall': 0.3677686, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.51002866}
confusion matrix:
      0   1
0  5979  18
1   153  89
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 1
val acc:0.9678261280059814, best validation acc: 0.9680925011634827, corresponding to test acc:                         0.9719506502151489 / 0.972591757774353
after epoch: 17,now: 2024-05-30 20:30:03.950926,epoch time: 0:24:10.273572,used: 6:50:10.788479,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9645856, 'precision': 0.71547425, 'recall': 0.5738242, 'specificity': 0.5738242, 'f1': 0.6063986, 'auroc': 0.9180678, 'binary_precision': 0.4604743, 'binary_recall': 0.15410052, 'binary_specificity': 0.9935479, 'binary_f1_score': 0.23092169}
confusion matrix:
       0    1
0  42039  273
1   1279  233
---- Validation: 
scalar performance:
{'acc': 0.9673467, 'precision': 0.729784, 'recall': 0.62898815, 'specificity': 0.62898815, 'f1': 0.6638207, 'auroc': 0.9180186, 'binary_precision': 0.4834835, 'binary_recall': 0.26744187, 'binary_specificity': 0.99053437, 'binary_f1_score': 0.34438503}
confusion matrix:
       0    1
0  17999  172
1    441  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97371376, 'precision': 0.884384, 'recall': 0.71667373, 'specificity': 0.71667373, 'f1': 0.77513915, 'auroc': 0.891731, 'binary_precision': 0.7910448, 'binary_recall': 0.43801653, 'binary_specificity': 0.995331, 'binary_f1_score': 0.5638298}
confusion matrix:
      0    1
0  5969   28
1   136  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 2
val acc:0.967346727848053, best validation acc: 0.9680925011634827, corresponding to test acc:                         0.9719506502151489 / 0.973713755607605
after epoch: 18,now: 2024-05-30 20:54:15.173963,epoch time: 0:24:11.223037,used: 7:14:22.011516,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96522456, 'precision': 0.7297776, 'recall': 0.5769838, 'specificity': 0.5769838, 'f1': 0.6116202, 'auroc': 0.916605, 'binary_precision': 0.4888889, 'binary_recall': 0.15994713, 'binary_specificity': 0.99402046, 'binary_f1_score': 0.24103586}
confusion matrix:
       0    1
0  42058  253
1   1271  242
---- Validation: 
scalar performance:
{'acc': 0.96745324, 'precision': 0.7273428, 'recall': 0.5912999, 'specificity': 0.5912999, 'f1': 0.6275534, 'auroc': 0.9160137, 'binary_precision': 0.48101267, 'binary_recall': 0.18936877, 'binary_specificity': 0.993231, 'binary_f1_score': 0.2717521}
confusion matrix:
       0    1
0  18048  123
1    488  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97547686, 'precision': 0.9226878, 'recall': 0.7156081, 'specificity': 0.7156081, 'f1': 0.7829417, 'auroc': 0.89605, 'binary_precision': 0.8677686, 'binary_recall': 0.4338843, 'binary_specificity': 0.997332, 'binary_f1_score': 0.5785124}
confusion matrix:
      0    1
0  5981   16
1   137  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 3
val acc:0.9674532413482666, best validation acc: 0.9680925011634827, corresponding to test acc:                         0.9719506502151489 / 0.975476861000061
after epoch: 19,now: 2024-05-30 21:18:28.231385,epoch time: 0:24:13.057422,used: 7:38:35.068938,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96522456, 'precision': 0.73475397, 'recall': 0.6461313, 'specificity': 0.6461313, 'f1': 0.6790176, 'auroc': 0.92195624, 'binary_precision': 0.49407965, 'binary_recall': 0.30337077, 'binary_specificity': 0.9888918, 'binary_f1_score': 0.37592134}
confusion matrix:
       0    1
0  41841  470
1   1054  459
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.73745155, 'recall': 0.69098794, 'specificity': 0.69098794, 'f1': 0.71143645, 'auroc': 0.92170453, 'binary_precision': 0.4948025, 'binary_recall': 0.39534885, 'binary_specificity': 0.98662704, 'binary_f1_score': 0.43951985}
confusion matrix:
       0    1
0  17928  243
1    364  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9770797, 'precision': 0.89636767, 'recall': 0.7640277, 'specificity': 0.7640277, 'f1': 0.8157754, 'auroc': 0.9085562, 'binary_precision': 0.8113208, 'binary_recall': 0.53305787, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.64339155}
confusion matrix:
      0    1
0  5967   30
1   113  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 4
val acc:0.9676663279533386, best validation acc: 0.9680925011634827, corresponding to test acc:                         0.9719506502151489 / 0.9770796895027161
after epoch: 20,now: 2024-05-30 21:42:50.383250,epoch time: 0:24:22.151865,used: 8:02:57.220803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9656125, 'precision': 0.73923886, 'recall': 0.65184164, 'specificity': 0.65184164, 'f1': 0.6847296, 'auroc': 0.92310715, 'binary_precision': 0.5026399, 'binary_recall': 0.3148148, 'binary_specificity': 0.9888684, 'binary_f1_score': 0.38714924}
confusion matrix:
       0    1
0  41841  471
1   1036  476
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.744167, 'recall': 0.6616329, 'specificity': 0.6616329, 'f1': 0.69368136, 'auroc': 0.9194647, 'binary_precision': 0.5101523, 'binary_recall': 0.33388704, 'binary_specificity': 0.9893787, 'binary_f1_score': 0.40361446}
confusion matrix:
       0    1
0  17978  193
1    401  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9765988, 'precision': 0.89820194, 'recall': 0.7538638, 'specificity': 0.7538638, 'f1': 0.80867976, 'auroc': 0.907318, 'binary_precision': 0.81578946, 'binary_recall': 0.5123967, 'binary_specificity': 0.995331, 'binary_f1_score': 0.6294416}
confusion matrix:
      0    1
0  5969   28
1   118  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
better model found
persisted
after epoch: 21,now: 2024-05-30 22:07:10.031390,epoch time: 0:24:19.648140,used: 8:27:16.868943,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96460843, 'precision': 0.7212373, 'recall': 0.5961025, 'specificity': 0.5961025, 'f1': 0.6314017, 'auroc': 0.9222475, 'binary_precision': 0.4704969, 'binary_recall': 0.20026438, 'binary_specificity': 0.9919406, 'binary_f1_score': 0.28094575}
confusion matrix:
       0    1
0  41970  341
1   1210  303
---- Validation: 
scalar performance:
{'acc': 0.96761304, 'precision': 0.7335259, 'recall': 0.6299287, 'specificity': 0.6299287, 'f1': 0.6655169, 'auroc': 0.9209337, 'binary_precision': 0.4909091, 'binary_recall': 0.269103, 'binary_specificity': 0.9907545, 'binary_f1_score': 0.3476395}
confusion matrix:
       0    1
0  18003  168
1    440  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97451514, 'precision': 0.88650393, 'recall': 0.7289871, 'specificity': 0.7289871, 'f1': 0.7858553, 'auroc': 0.90313685, 'binary_precision': 0.79432625, 'binary_recall': 0.46280992, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.58485645}
confusion matrix:
      0    1
0  5968   29
1   130  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 1
val acc:0.9676130414009094, best validation acc: 0.9683588147163391, corresponding to test acc:                         0.9765987992286682 / 0.9770796895027161
after epoch: 22,now: 2024-05-30 22:31:31.244228,epoch time: 0:24:21.212838,used: 8:51:38.081781,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96552116, 'precision': 0.7372415, 'recall': 0.61187047, 'specificity': 0.61187047, 'f1': 0.64976525, 'auroc': 0.92919433, 'binary_precision': 0.50142854, 'binary_recall': 0.23198943, 'binary_specificity': 0.99175155, 'binary_f1_score': 0.31721646}
confusion matrix:
       0    1
0  41962  349
1   1162  351
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.74353087, 'recall': 0.6383169, 'specificity': 0.6383169, 'f1': 0.67504674, 'auroc': 0.9209888, 'binary_precision': 0.51038575, 'binary_recall': 0.2857143, 'binary_specificity': 0.9909196, 'binary_f1_score': 0.3663472}
confusion matrix:
       0    1
0  18006  165
1    430  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9759577, 'precision': 0.908631, 'recall': 0.73370296, 'specificity': 0.73370296, 'f1': 0.79538894, 'auroc': 0.90191793, 'binary_precision': 0.8382353, 'binary_recall': 0.47107437, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.60317457}
confusion matrix:
      0    1
0  5975   22
1   128  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 2
val acc:0.9683055281639099, best validation acc: 0.9683588147163391, corresponding to test acc:                         0.9765987992286682 / 0.9770796895027161
after epoch: 23,now: 2024-05-30 22:55:52.004570,epoch time: 0:24:20.760342,used: 9:15:58.842123,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96545273, 'precision': 0.737748, 'recall': 0.6545344, 'specificity': 0.6545344, 'f1': 0.6863609, 'auroc': 0.9267607, 'binary_precision': 0.49948508, 'binary_recall': 0.32055518, 'binary_specificity': 0.98851365, 'binary_f1_score': 0.3904992}
confusion matrix:
       0    1
0  41825  486
1   1028  485
---- Validation: 
scalar performance:
{'acc': 0.9675598, 'precision': 0.73626006, 'recall': 0.6877207, 'specificity': 0.6877207, 'f1': 0.7089206, 'auroc': 0.9243996, 'binary_precision': 0.49263158, 'binary_recall': 0.38870433, 'binary_specificity': 0.98673713, 'binary_f1_score': 0.4345404}
confusion matrix:
       0    1
0  17930  241
1    368  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9782016, 'precision': 0.9046943, 'recall': 0.774525, 'specificity': 0.774525, 'f1': 0.82605124, 'auroc': 0.91216874, 'binary_precision': 0.8271605, 'binary_recall': 0.553719, 'binary_specificity': 0.995331, 'binary_f1_score': 0.6633663}
confusion matrix:
      0    1
0  5969   28
1   108  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 3
val acc:0.967559814453125, best validation acc: 0.9683588147163391, corresponding to test acc:                         0.9765987992286682 / 0.9782016277313232
after epoch: 24,now: 2024-05-30 23:19:49.493337,epoch time: 0:23:57.488767,used: 9:39:56.330890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96650237, 'precision': 0.749773, 'recall': 0.66463757, 'specificity': 0.66463757, 'f1': 0.6975449, 'auroc': 0.92783093, 'binary_precision': 0.52284265, 'binary_recall': 0.34038335, 'binary_specificity': 0.9888918, 'binary_f1_score': 0.41232988}
confusion matrix:
       0    1
0  41841  470
1    998  515
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.7465395, 'recall': 0.6866374, 'specificity': 0.6866374, 'f1': 0.7120299, 'auroc': 0.92500657, 'binary_precision': 0.5132743, 'binary_recall': 0.38538206, 'binary_specificity': 0.9878928, 'binary_f1_score': 0.44022772}
confusion matrix:
       0    1
0  17951  220
1    370  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97740024, 'precision': 0.9015383, 'recall': 0.7641944, 'specificity': 0.7641944, 'f1': 0.8174717, 'auroc': 0.9037577, 'binary_precision': 0.82165605, 'binary_recall': 0.53305787, 'binary_specificity': 0.995331, 'binary_f1_score': 0.6466166}
confusion matrix:
      0    1
0  5969   28
1   113  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
better model found
persisted
after epoch: 25,now: 2024-05-30 23:45:28.215602,epoch time: 0:25:38.722265,used: 10:05:35.053155,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.965544, 'precision': 0.73785365, 'recall': 0.6217605, 'specificity': 0.6217605, 'f1': 0.6591425, 'auroc': 0.9288107, 'binary_precision': 0.50197107, 'binary_recall': 0.2524785, 'binary_specificity': 0.9910425, 'binary_f1_score': 0.33597183}
confusion matrix:
       0    1
0  41932  379
1   1131  382
---- Validation: 
scalar performance:
{'acc': 0.9672402, 'precision': 0.7314993, 'recall': 0.6642672, 'specificity': 0.6642672, 'f1': 0.6915802, 'auroc': 0.9259206, 'binary_precision': 0.48463356, 'binary_recall': 0.34053156, 'binary_specificity': 0.98800284, 'binary_f1_score': 0.4}
confusion matrix:
       0    1
0  17953  218
1    397  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9770797, 'precision': 0.9042982, 'recall': 0.7560967, 'specificity': 0.7560967, 'f1': 0.81214976, 'auroc': 0.9186509, 'binary_precision': 0.8278146, 'binary_recall': 0.5165289, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.63613236}
confusion matrix:
      0    1
0  5971   26
1   117  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 1
val acc:0.9672402143478394, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9774002432823181 / 0.9782016277313232
after epoch: 26,now: 2024-05-31 00:11:22.488139,epoch time: 0:25:54.272537,used: 10:31:29.325692,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9663426, 'precision': 0.7479265, 'recall': 0.66455483, 'specificity': 0.66455483, 'f1': 0.69692695, 'auroc': 0.931976, 'binary_precision': 0.51915324, 'binary_recall': 0.34038335, 'binary_specificity': 0.9887263, 'binary_f1_score': 0.41117764}
confusion matrix:
       0    1
0  41834  477
1    998  515
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.7431741, 'recall': 0.6864723, 'specificity': 0.6864723, 'f1': 0.7107004, 'auroc': 0.92258525, 'binary_precision': 0.5065502, 'binary_recall': 0.38538206, 'binary_specificity': 0.9875626, 'binary_f1_score': 0.43773586}
confusion matrix:
       0    1
0  17945  226
1    370  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97916335, 'precision': 0.9299953, 'recall': 0.76709425, 'specificity': 0.76709425, 'f1': 0.8279561, 'auroc': 0.9173616, 'binary_precision': 0.8783784, 'binary_recall': 0.5371901, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.6666666}
confusion matrix:
      0    1
0  5979   18
1   112  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
new oracle model saved
early stop counter: 2
val acc:0.9682523012161255, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9774002432823181 / 0.9791633486747742
after epoch: 27,now: 2024-05-31 00:36:59.953130,epoch time: 0:25:37.464991,used: 10:57:06.790683,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96533865, 'precision': 0.7349333, 'recall': 0.6219728, 'specificity': 0.6219728, 'f1': 0.65871763, 'auroc': 0.9278742, 'binary_precision': 0.496114, 'binary_recall': 0.25313947, 'binary_specificity': 0.99080616, 'binary_f1_score': 0.33522978}
confusion matrix:
       0    1
0  41922  389
1   1130  383
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.740701, 'recall': 0.6478435, 'specificity': 0.6478435, 'f1': 0.6820915, 'auroc': 0.92649156, 'binary_precision': 0.50410956, 'binary_recall': 0.30564785, 'binary_specificity': 0.99003905, 'binary_f1_score': 0.38055843}
confusion matrix:
       0    1
0  17990  181
1    418  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9770797, 'precision': 0.89451313, 'recall': 0.7660104, 'specificity': 0.7660104, 'f1': 0.81665933, 'auroc': 0.92325366, 'binary_precision': 0.8074534, 'binary_recall': 0.5371901, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.6451613}
confusion matrix:
      0    1
0  5966   31
1   112  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 3
val acc:0.9680925011634827, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9774002432823181 / 0.9791633486747742
after epoch: 28,now: 2024-05-31 01:02:06.461253,epoch time: 0:25:06.508123,used: 11:22:13.298806,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96552116, 'precision': 0.74024916, 'recall': 0.7074661, 'specificity': 0.7074661, 'f1': 0.72252005, 'auroc': 0.9331023, 'binary_precision': 0.50076926, 'binary_recall': 0.430271, 'binary_specificity': 0.9846612, 'binary_f1_score': 0.46285105}
confusion matrix:
       0    1
0  41662  649
1    862  651
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.7422677, 'recall': 0.732136, 'specificity': 0.732136, 'f1': 0.73708206, 'auroc': 0.9300039, 'binary_precision': 0.5017361, 'binary_recall': 0.48006645, 'binary_specificity': 0.9842056, 'binary_f1_score': 0.49066213}
confusion matrix:
       0    1
0  17884  287
1    313  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97868246, 'precision': 0.8879559, 'recall': 0.8025335, 'specificity': 0.8025335, 'f1': 0.83946925, 'auroc': 0.91308534, 'binary_precision': 0.7914438, 'binary_recall': 0.61157024, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.6899767}
confusion matrix:
      0    1
0  5958   39
1    94  148
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 4
val acc:0.9680392146110535, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9774002432823181 / 0.9791633486747742
after epoch: 29,now: 2024-05-31 01:28:10.976722,epoch time: 0:26:04.515469,used: 11:48:17.814275,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96643394, 'precision': 0.7483038, 'recall': 0.696786, 'specificity': 0.696786, 'f1': 0.7192364, 'auroc': 0.93463564, 'binary_precision': 0.5176471, 'binary_recall': 0.40713814, 'binary_specificity': 0.9864338, 'binary_f1_score': 0.45578986}
confusion matrix:
       0    1
0  41737  574
1    897  616
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.7407372, 'recall': 0.7120048, 'specificity': 0.7120048, 'f1': 0.7253627, 'auroc': 0.927327, 'binary_precision': 0.5, 'binary_recall': 0.4385382, 'binary_specificity': 0.98547137, 'binary_f1_score': 0.46725664}
confusion matrix:
       0    1
0  17907  264
1    338  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97868246, 'precision': 0.8864939, 'recall': 0.8045162, 'specificity': 0.8045162, 'f1': 0.84018755, 'auroc': 0.9175152, 'binary_precision': 0.78835976, 'binary_recall': 0.61570245, 'binary_specificity': 0.99333, 'binary_f1_score': 0.69141525}
confusion matrix:
      0    1
0  5957   40
1    93  149
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_20993749.png
early stop counter: 5
val acc:0.9679326415061951, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9774002432823181 / 0.9791633486747742
after epoch: 30,now: 2024-05-31 01:54:06.774211,epoch time: 0:25:55.797489,used: 12:14:13.611764,model: dset_te_center0_erm_b44271c83_not_commited_2024md_05md_30_13_39_53_seed_2_20993749
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:14:13.611764 at 2024-05-31 01:54:06.774211
persisted model performance metric: 

scalar performance:
{'acc': 0.97691935, 'precision': 0.8920195, 'recall': 0.7659271, 'specificity': 0.7659271, 'f1': 0.8158189, 'auroc': 0.9124541, 'binary_precision': 0.80246913, 'binary_recall': 0.5371901, 'binary_specificity': 0.994664, 'binary_f1_score': 0.64356434}
confusion matrix:
      0    1
0  5965   32
1   112  130
oracle model performance metric: 

scalar performance:
{'acc': 0.97916335, 'precision': 0.902758, 'recall': 0.7928699, 'specificity': 0.7928699, 'f1': 0.83836126, 'auroc': 0.91433716, 'binary_precision': 0.8218391, 'binary_recall': 0.59090906, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.68750006}
confusion matrix:
      0    1
0  5966   31
1    99  143
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 491221 KiB |  10997 MiB |   2723 TiB |   2723 TiB |
|       from large pool | 401408 KiB |  10925 MiB |   2714 TiB |   2714 TiB |
|       from small pool |  89813 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 491221 KiB |  10997 MiB |   2723 TiB |   2723 TiB |
|       from large pool | 401408 KiB |  10925 MiB |   2714 TiB |   2714 TiB |
|       from small pool |  89813 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476572 KiB |  10880 MiB |   2696 TiB |   2696 TiB |
|       from large pool | 387840 KiB |  10808 MiB |   2688 TiB |   2688 TiB |
|       from small pool |  88732 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11504 MiB |  11504 MiB |  32242 MiB |  20738 MiB |
|       from large pool |  11380 MiB |  11380 MiB |  32060 MiB |  20680 MiB |
|       from small pool |    124 MiB |    126 MiB |    182 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 637226 KiB |   1325 MiB |   1285 TiB |   1285 TiB |
|       from large pool | 626688 KiB |   1322 MiB |   1276 TiB |   1276 TiB |
|       from small pool |  10538 KiB |     24 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3717    |    6728    |  419318 K  |  419315 K  |
|       from large pool |      87    |     908    |  170471 K  |  170471 K  |
|       from small pool |    3630    |    6639    |  248847 K  |  248843 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3717    |    6728    |  419318 K  |  419315 K  |
|       from large pool |      87    |     908    |  170471 K  |  170471 K  |
|       from small pool |    3630    |    6639    |  248847 K  |  248843 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     410    |     410    |    1054    |     644    |
|       from large pool |     348    |     348    |     963    |     615    |
|       from small pool |      62    |      63    |      91    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    2775    |  223070 K  |  223070 K  |
|       from large pool |      24    |     203    |  102914 K  |  102914 K  |
|       from small pool |      56    |    2751    |  120155 K  |  120155 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |   2723 TiB |   2723 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   2714 TiB |   2714 TiB |
|       from small pool |      0 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |   2723 TiB |   2723 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   2714 TiB |   2714 TiB |
|       from small pool |      0 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |   2696 TiB |   2696 TiB |
|       from large pool |  16640 KiB |  10808 MiB |   2688 TiB |   2688 TiB |
|       from small pool |      0 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1102 MiB |  11504 MiB |  32242 MiB |  31140 MiB |
|       from large pool |   1004 MiB |  11380 MiB |  32060 MiB |  31056 MiB |
|       from small pool |     98 MiB |    126 MiB |    182 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB |   1285 TiB |   1285 TiB |
|       from large pool |  50944 KiB |   1322 MiB |   1276 TiB |   1276 TiB |
|       from small pool |      0 KiB |     28 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  419318 K  |  419318 K  |
|       from large pool |       2    |     908    |  170471 K  |  170471 K  |
|       from small pool |       0    |    6639    |  248847 K  |  248847 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  419318 K  |  419318 K  |
|       from large pool |       2    |     908    |  170471 K  |  170471 K  |
|       from small pool |       0    |    6639    |  248847 K  |  248847 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      83    |     410    |    1054    |     971    |
|       from large pool |      34    |     348    |     963    |     929    |
|       from small pool |      49    |      63    |      91    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2775    |  223071 K  |  223071 K  |
|       from large pool |       4    |     203    |  102914 K  |  102914 K  |
|       from small pool |       0    |    2751    |  120156 K  |  120156 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri May 31 01:56:46 2024]
Finished job 0.
1 of 1 steps (100%) done
