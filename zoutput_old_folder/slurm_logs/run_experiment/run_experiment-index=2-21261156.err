Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun  8 23:39:20 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156

 Experiment start at: 2024-06-08 23:47:20.925686
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9669118, 'precision': 0.8889273, 'recall': 0.5101075, 'specificity': 0.5101075, 'f1': 0.51146364, 'auroc': 0.9501384, 'binary_precision': 0.8108108, 'binary_recall': 0.020380436, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.039761435}
confusion matrix:
       0   1
0  42313   7
1   1442  30
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9662622, 'precision': 0.7795389, 'recall': 0.52199954, 'specificity': 0.52199954, 'f1': 0.5333149, 'auroc': 0.9467521, 'binary_precision': 0.59183675, 'binary_recall': 0.045101088, 'binary_specificity': 0.998898, 'binary_f1_score': 0.08381502}
confusion matrix:
       0   1
0  18129  20
1    614  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.9329214, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-09 00:14:07.980958,epoch time: 0:26:47.055272,used: 0:26:47.055272,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9670031, 'precision': 0.8713639, 'recall': 0.5127776, 'specificity': 0.5127776, 'f1': 0.51658857, 'auroc': 0.96011853, 'binary_precision': 0.7755102, 'binary_recall': 0.025815217, 'binary_specificity': 0.99974006, 'binary_f1_score': 0.049967125}
confusion matrix:
       0   1
0  42309  11
1   1434  38
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.8549814, 'recall': 0.51996976, 'specificity': 0.51996976, 'f1': 0.5298671, 'auroc': 0.9564911, 'binary_precision': 0.74285716, 'binary_recall': 0.04043546, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.076696165}
confusion matrix:
       0   1
0  18140   9
1    617  26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.94608736, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_2.png
better model found
persisted
after epoch: 2,now: 2024-06-09 00:39:42.073693,epoch time: 0:25:34.092735,used: 0:52:21.148007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9764797, 'precision': 0.8634404, 'recall': 0.7252156, 'specificity': 0.7252156, 'f1': 0.7768399, 'auroc': 0.9666185, 'binary_precision': 0.7455556, 'binary_recall': 0.4558424, 'binary_specificity': 0.99458885, 'binary_f1_score': 0.5657673}
confusion matrix:
       0    1
0  42091  229
1    801  671
---- Validation: 
scalar performance:
{'acc': 0.975894, 'precision': 0.85338664, 'recall': 0.73475134, 'specificity': 0.73475134, 'f1': 0.7811217, 'auroc': 0.96495914, 'binary_precision': 0.72511846, 'binary_recall': 0.47589424, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.57464784}
confusion matrix:
       0    1
0  18033  116
1    337  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.903878, 'recall': 0.5912037, 'specificity': 0.5912037, 'f1': 0.64184356, 'auroc': 0.94568276, 'binary_precision': 0.84210527, 'binary_recall': 0.18390805, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.30188677}
confusion matrix:
      0   1
0  5988   9
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-09 01:05:18.666159,epoch time: 0:25:36.592466,used: 1:17:57.740473,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97995067, 'precision': 0.87416184, 'recall': 0.7894918, 'specificity': 0.7894918, 'f1': 0.8259882, 'auroc': 0.97176933, 'binary_precision': 0.76262176, 'binary_recall': 0.5853161, 'binary_specificity': 0.9936674, 'binary_f1_score': 0.6623077}
confusion matrix:
       0    1
0  42053  268
1    610  861
---- Validation: 
scalar performance:
{'acc': 0.9782354, 'precision': 0.8846247, 'recall': 0.7472144, 'specificity': 0.7472144, 'f1': 0.7998257, 'auroc': 0.97090834, 'binary_precision': 0.7867647, 'binary_recall': 0.4992224, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.6108468}
confusion matrix:
       0    1
0  18062   87
1    322  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.81830364, 'recall': 0.5731285, 'specificity': 0.5731285, 'f1': 0.6123776, 'auroc': 0.94355154, 'binary_precision': 0.67241377, 'binary_recall': 0.14942528, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.24451411}
confusion matrix:
      0   1
0  5978  19
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_4.png
better model found
persisted
after epoch: 4,now: 2024-06-09 01:30:59.393522,epoch time: 0:25:40.727363,used: 1:43:38.467836,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97953963, 'precision': 0.9185375, 'recall': 0.73365176, 'specificity': 0.73365176, 'f1': 0.7980846, 'auroc': 0.9746316, 'binary_precision': 0.855198, 'binary_recall': 0.47006804, 'binary_specificity': 0.9972355, 'binary_f1_score': 0.6066725}
confusion matrix:
       0    1
0  42205  117
1    779  691
---- Validation: 
scalar performance:
{'acc': 0.9765858, 'precision': 0.8958923, 'recall': 0.7036072, 'specificity': 0.7036072, 'f1': 0.766719, 'auroc': 0.97054094, 'binary_precision': 0.8123077, 'binary_recall': 0.41057542, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.54545456}
confusion matrix:
       0    1
0  18088   61
1    379  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.82936835, 'recall': 0.54322755, 'specificity': 0.54322755, 'f1': 0.5680857, 'auroc': 0.94432104, 'binary_precision': 0.6969697, 'binary_recall': 0.08812261, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.1564626}
confusion matrix:
      0   1
0  5987  10
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_5.png
early stop counter: 1
val acc:0.9765858054161072, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9614893198013306 / 0.9645254015922546
after epoch: 5,now: 2024-06-09 01:56:31.892837,epoch time: 0:25:32.499315,used: 2:09:10.967151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98193735, 'precision': 0.88827646, 'recall': 0.812627, 'specificity': 0.812627, 'f1': 0.8460419, 'auroc': 0.9792056, 'binary_precision': 0.78929484, 'binary_recall': 0.6311141, 'binary_specificity': 0.9941399, 'binary_f1_score': 0.70139676}
confusion matrix:
       0    1
0  42072  248
1    543  929
---- Validation: 
scalar performance:
{'acc': 0.97914004, 'precision': 0.8927704, 'recall': 0.75668335, 'specificity': 0.75668335, 'f1': 0.80937874, 'auroc': 0.97309697, 'binary_precision': 0.80240965, 'binary_recall': 0.5178849, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.62948954}
confusion matrix:
       0    1
0  18067   82
1    310  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.85649586, 'recall': 0.62643486, 'specificity': 0.62643486, 'f1': 0.68196416, 'auroc': 0.9561198, 'binary_precision': 0.74444443, 'binary_recall': 0.256705, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.38176638}
confusion matrix:
      0   1
0  5974  23
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-09 02:22:00.828444,epoch time: 0:25:28.935607,used: 2:34:39.902758,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9822342, 'precision': 0.85850704, 'recall': 0.8740082, 'specificity': 0.8740082, 'f1': 0.86607873, 'auroc': 0.9779962, 'binary_precision': 0.7254392, 'binary_recall': 0.75798774, 'binary_specificity': 0.9900286, 'binary_f1_score': 0.7413564}
confusion matrix:
       0     1
0  41899   422
1    356  1115
---- Validation: 
scalar performance:
{'acc': 0.9820668, 'precision': 0.8645032, 'recall': 0.8639564, 'specificity': 0.8639564, 'f1': 0.86422956, 'auroc': 0.97591126, 'binary_precision': 0.7383177, 'binary_recall': 0.7371695, 'binary_specificity': 0.9907433, 'binary_f1_score': 0.7377432}
confusion matrix:
       0    1
0  17981  168
1    169  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.8440778, 'recall': 0.66191626, 'specificity': 0.66191626, 'f1': 0.71711034, 'auroc': 0.952567, 'binary_precision': 0.71666664, 'binary_recall': 0.32950193, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.45144358}
confusion matrix:
      0   1
0  5963  34
1   175  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-09 02:47:43.518644,epoch time: 0:25:42.690200,used: 3:00:22.592958,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9820972, 'precision': 0.90888965, 'recall': 0.7907431, 'specificity': 0.7907431, 'f1': 0.8390925, 'auroc': 0.9793416, 'binary_precision': 0.83204633, 'binary_recall': 0.5855978, 'binary_specificity': 0.9958885, 'binary_f1_score': 0.68740034}
confusion matrix:
       0    1
0  42146  174
1    610  862
---- Validation: 
scalar performance:
{'acc': 0.9799915, 'precision': 0.8982644, 'recall': 0.767625, 'specificity': 0.767625, 'f1': 0.8191503, 'auroc': 0.9755685, 'binary_precision': 0.8126464, 'binary_recall': 0.53965783, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.64859813}
confusion matrix:
       0    1
0  18069   80
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.86743087, 'recall': 0.6700793, 'specificity': 0.6700793, 'f1': 0.72926897, 'auroc': 0.95419765, 'binary_precision': 0.7627119, 'binary_recall': 0.3448276, 'binary_specificity': 0.995331, 'binary_f1_score': 0.47493407}
confusion matrix:
      0   1
0  5969  28
1   171  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_8.png
new oracle model saved
early stop counter: 1
val acc:0.9799914956092834, best validation acc: 0.982066810131073, corresponding to test acc:                         0.9666027426719666 / 0.96820068359375
after epoch: 8,now: 2024-06-09 03:13:21.605342,epoch time: 0:25:38.086698,used: 3:26:00.679656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98186886, 'precision': 0.86421835, 'recall': 0.8522625, 'specificity': 0.8522625, 'f1': 0.8581319, 'auroc': 0.978667, 'binary_precision': 0.73839664, 'binary_recall': 0.7133152, 'binary_specificity': 0.9912098, 'binary_f1_score': 0.7256392}
confusion matrix:
       0     1
0  41948   372
1    422  1050
---- Validation: 
scalar performance:
{'acc': 0.98100257, 'precision': 0.87610674, 'recall': 0.81765205, 'specificity': 0.81765205, 'f1': 0.8442087, 'auroc': 0.9769967, 'binary_precision': 0.7648148, 'binary_recall': 0.64230174, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.69822484}
confusion matrix:
       0    1
0  18022  127
1    230  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8684677, 'recall': 0.5832073, 'specificity': 0.5832073, 'f1': 0.628937, 'auroc': 0.9493623, 'binary_precision': 0.7719298, 'binary_recall': 0.16858238, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.27672955}
confusion matrix:
      0   1
0  5984  13
1   217  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_9.png
early stop counter: 2
val acc:0.9810025691986084, best validation acc: 0.982066810131073, corresponding to test acc:                         0.9666027426719666 / 0.96820068359375
after epoch: 9,now: 2024-06-09 03:39:00.037815,epoch time: 0:25:38.432473,used: 3:51:39.112129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9830106, 'precision': 0.88522536, 'recall': 0.84006673, 'specificity': 0.84006673, 'f1': 0.8611239, 'auroc': 0.98320156, 'binary_precision': 0.7812983, 'binary_recall': 0.6868206, 'binary_specificity': 0.99331284, 'binary_f1_score': 0.73101956}
confusion matrix:
       0     1
0  42037   283
1    461  1011
---- Validation: 
scalar performance:
{'acc': 0.9808429, 'precision': 0.8713361, 'recall': 0.8220697, 'specificity': 0.8220697, 'f1': 0.8448026, 'auroc': 0.976934, 'binary_precision': 0.75495493, 'binary_recall': 0.65163296, 'binary_specificity': 0.99250644, 'binary_f1_score': 0.6994992}
confusion matrix:
       0    1
0  18013  136
1    224  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.8478465, 'recall': 0.6111926, 'specificity': 0.6111926, 'f1': 0.6633147, 'auroc': 0.95425665, 'binary_precision': 0.72839504, 'binary_recall': 0.22605364, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.34502923}
confusion matrix:
      0   1
0  5975  22
1   202  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_10.png
early stop counter: 3
val acc:0.9808428883552551, best validation acc: 0.982066810131073, corresponding to test acc:                         0.9666027426719666 / 0.96820068359375
after epoch: 10,now: 2024-06-09 04:04:28.936855,epoch time: 0:25:28.899040,used: 4:17:08.011169,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9836043, 'precision': 0.89954114, 'recall': 0.83152175, 'specificity': 0.83152175, 'f1': 0.8621154, 'auroc': 0.98391247, 'binary_precision': 0.81054366, 'binary_recall': 0.66847825, 'binary_specificity': 0.9945652, 'binary_f1_score': 0.73268795}
confusion matrix:
       0    1
0  42090  230
1    488  984
---- Validation: 
scalar performance:
{'acc': 0.9819072, 'precision': 0.8987701, 'recall': 0.80461943, 'specificity': 0.80461943, 'f1': 0.8448942, 'auroc': 0.9770615, 'binary_precision': 0.8110883, 'binary_recall': 0.61430794, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.6991151}
confusion matrix:
       0    1
0  18057   92
1    248  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.8161312, 'recall': 0.6292658, 'specificity': 0.6292658, 'f1': 0.6797003, 'auroc': 0.9436489, 'binary_precision': 0.66346157, 'binary_recall': 0.26436782, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.3780822}
confusion matrix:
      0   1
0  5962  35
1   192  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_11.png
early stop counter: 4
val acc:0.9819071888923645, best validation acc: 0.982066810131073, corresponding to test acc:                         0.9666027426719666 / 0.96820068359375
after epoch: 11,now: 2024-06-09 04:29:53.357532,epoch time: 0:25:24.420677,used: 4:42:32.431846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9856595, 'precision': 0.9169712, 'recall': 0.84930587, 'specificity': 0.84930587, 'f1': 0.87991846, 'auroc': 0.9853679, 'binary_precision': 0.84420884, 'binary_recall': 0.703125, 'binary_specificity': 0.9954868, 'binary_f1_score': 0.76723504}
confusion matrix:
       0     1
0  42129   191
1    437  1035
---- Validation: 
scalar performance:
{'acc': 0.9841422, 'precision': 0.90565544, 'recall': 0.839529, 'specificity': 0.839529, 'f1': 0.8694217, 'auroc': 0.97800714, 'binary_precision': 0.8224299, 'binary_recall': 0.6842924, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.7470289}
confusion matrix:
       0    1
0  18054   95
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.8410873, 'recall': 0.6355132, 'specificity': 0.6355132, 'f1': 0.6899268, 'auroc': 0.963333, 'binary_precision': 0.7128713, 'binary_recall': 0.27586207, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.39779004}
confusion matrix:
      0   1
0  5968  29
1   189  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_12.png
better model found
persisted
after epoch: 12,now: 2024-06-09 04:55:34.900908,epoch time: 0:25:41.543376,used: 5:08:13.975222,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98458624, 'precision': 0.86841875, 'recall': 0.9090767, 'specificity': 0.9090767, 'f1': 0.88758814, 'auroc': 0.98590577, 'binary_precision': 0.74283975, 'binary_recall': 0.828125, 'binary_specificity': 0.9900284, 'binary_f1_score': 0.7831673}
confusion matrix:
       0     1
0  41898   422
1    253  1219
---- Validation: 
scalar performance:
{'acc': 0.9831311, 'precision': 0.86502135, 'recall': 0.88850915, 'specificity': 0.88850915, 'f1': 0.87636554, 'auroc': 0.97867703, 'binary_precision': 0.7376093, 'binary_recall': 0.7869362, 'binary_specificity': 0.9900821, 'binary_f1_score': 0.7614748}
confusion matrix:
       0    1
0  17969  180
1    137  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.8258394, 'recall': 0.637012, 'specificity': 0.637012, 'f1': 0.68923223, 'auroc': 0.95813763, 'binary_precision': 0.682243, 'binary_recall': 0.27969348, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.39673913}
confusion matrix:
      0   1
0  5963  34
1   188  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_13.png
early stop counter: 1
val acc:0.9831311106681824, best validation acc: 0.9841421842575073, corresponding to test acc:                         0.9651646018028259 / 0.96820068359375
after epoch: 13,now: 2024-06-09 05:21:14.186491,epoch time: 0:25:39.285583,used: 5:33:53.260805,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9847232, 'precision': 0.9259248, 'recall': 0.821937, 'specificity': 0.821937, 'f1': 0.8661622, 'auroc': 0.986928, 'binary_precision': 0.86400723, 'binary_recall': 0.6474185, 'binary_specificity': 0.99645555, 'binary_f1_score': 0.7401942}
confusion matrix:
       0    1
0  42170  150
1    519  953
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.9291762, 'recall': 0.82719123, 'specificity': 0.82719123, 'f1': 0.8707863, 'auroc': 0.9805813, 'binary_precision': 0.8703704, 'binary_recall': 0.6578538, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.74933565}
confusion matrix:
       0    1
0  18086   63
1    220  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.82941055, 'recall': 0.6295993, 'specificity': 0.6295993, 'f1': 0.68196255, 'auroc': 0.9316579, 'binary_precision': 0.69, 'binary_recall': 0.26436782, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.3822715}
confusion matrix:
      0   1
0  5966  31
1   192  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_14.png
better model found
persisted
after epoch: 14,now: 2024-06-09 05:46:56.058941,epoch time: 0:25:41.872450,used: 5:59:35.133255,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98744065, 'precision': 0.92901707, 'recall': 0.86793184, 'specificity': 0.86793184, 'f1': 0.89595276, 'auroc': 0.98708636, 'binary_precision': 0.8670382, 'binary_recall': 0.7398098, 'binary_specificity': 0.9960539, 'binary_f1_score': 0.7983871}
confusion matrix:
       0     1
0  42153   167
1    383  1089
---- Validation: 
scalar performance:
{'acc': 0.98472756, 'precision': 0.91876644, 'recall': 0.8345816, 'specificity': 0.8345816, 'f1': 0.87160313, 'auroc': 0.9795183, 'binary_precision': 0.8490196, 'binary_recall': 0.6734059, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.75108415}
confusion matrix:
       0    1
0  18072   77
1    210  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.89470994, 'recall': 0.61385864, 'specificity': 0.61385864, 'f1': 0.6708573, 'auroc': 0.94986033, 'binary_precision': 0.82191783, 'binary_recall': 0.22988506, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.35928145}
confusion matrix:
      0   1
0  5984  13
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_15.png
early stop counter: 1
val acc:0.9847275614738464, best validation acc: 0.9849404096603394, corresponding to test acc:                         0.9643656015396118 / 0.96820068359375
after epoch: 15,now: 2024-06-09 06:12:27.079494,epoch time: 0:25:31.020553,used: 6:25:06.153808,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98696107, 'precision': 0.9375597, 'recall': 0.8499793, 'specificity': 0.8499793, 'f1': 0.8885359, 'auroc': 0.9888991, 'binary_precision': 0.8853721, 'binary_recall': 0.703125, 'binary_specificity': 0.9968336, 'binary_f1_score': 0.783794}
confusion matrix:
       0     1
0  42186   134
1    437  1035
---- Validation: 
scalar performance:
{'acc': 0.9813218, 'precision': 0.9377946, 'recall': 0.75706285, 'specificity': 0.75706285, 'f1': 0.8222944, 'auroc': 0.97835875, 'binary_precision': 0.8924731, 'binary_recall': 0.5163297, 'binary_specificity': 0.997796, 'binary_f1_score': 0.6541872}
confusion matrix:
       0    1
0  18109   40
1    311  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.8809951, 'recall': 0.6306832, 'specificity': 0.6306832, 'f1': 0.6896467, 'auroc': 0.9623374, 'binary_precision': 0.79310346, 'binary_recall': 0.26436782, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.39655173}
confusion matrix:
      0   1
0  5979  18
1   192  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_16.png
early stop counter: 2
val acc:0.9813218116760254, best validation acc: 0.9849404096603394, corresponding to test acc:                         0.9643656015396118 / 0.96820068359375
after epoch: 16,now: 2024-06-09 06:37:52.880934,epoch time: 0:25:25.801440,used: 6:50:31.955248,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98639023, 'precision': 0.9297794, 'recall': 0.84804463, 'specificity': 0.84804463, 'f1': 0.88429236, 'auroc': 0.99013835, 'binary_precision': 0.8699324, 'binary_recall': 0.69972825, 'binary_specificity': 0.9963611, 'binary_f1_score': 0.7756024}
confusion matrix:
       0     1
0  42166   154
1    442  1030
---- Validation: 
scalar performance:
{'acc': 0.9830247, 'precision': 0.9207326, 'recall': 0.80144763, 'specificity': 0.80144763, 'f1': 0.8504964, 'auroc': 0.97956365, 'binary_precision': 0.8552632, 'binary_recall': 0.60653186, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.70973605}
confusion matrix:
       0    1
0  18083   66
1    253  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.9336612, 'recall': 0.58770573, 'specificity': 0.58770573, 'f1': 0.6384225, 'auroc': 0.91591054, 'binary_precision': 0.9019608, 'binary_recall': 0.17624521, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.29487178}
confusion matrix:
      0   1
0  5992   5
1   215  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_17.png
early stop counter: 3
val acc:0.9830247163772583, best validation acc: 0.9849404096603394, corresponding to test acc:                         0.9643656015396118 / 0.96820068359375
after epoch: 17,now: 2024-06-09 07:03:28.912486,epoch time: 0:25:36.031552,used: 7:16:07.986800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98792017, 'precision': 0.9467468, 'recall': 0.8572646, 'specificity': 0.8572646, 'f1': 0.8966589, 'auroc': 0.990412, 'binary_precision': 0.90325344, 'binary_recall': 0.7171992, 'binary_specificity': 0.99732995, 'binary_f1_score': 0.79954535}
confusion matrix:
       0     1
0  42208   113
1    416  1055
---- Validation: 
scalar performance:
{'acc': 0.98440826, 'precision': 0.924613, 'recall': 0.8224155, 'specificity': 0.8224155, 'f1': 0.8659905, 'auroc': 0.9786403, 'binary_precision': 0.86157024, 'binary_recall': 0.64852256, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.7400178}
confusion matrix:
       0    1
0  18082   67
1    226  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.8649984, 'recall': 0.6209379, 'specificity': 0.6209379, 'f1': 0.67659265, 'auroc': 0.9603956, 'binary_precision': 0.7619048, 'binary_recall': 0.24521072, 'binary_specificity': 0.996665, 'binary_f1_score': 0.3710145}
confusion matrix:
      0   1
0  5977  20
1   197  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_18.png
early stop counter: 4
val acc:0.9844082593917847, best validation acc: 0.9849404096603394, corresponding to test acc:                         0.9643656015396118 / 0.96820068359375
after epoch: 18,now: 2024-06-09 07:29:08.091607,epoch time: 0:25:39.179121,used: 7:41:47.165921,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98887926, 'precision': 0.92869097, 'recall': 0.894577, 'specificity': 0.894577, 'f1': 0.9108714, 'auroc': 0.98964953, 'binary_precision': 0.8645448, 'binary_recall': 0.79347825, 'binary_specificity': 0.9956758, 'binary_f1_score': 0.8274884}
confusion matrix:
       0     1
0  42137   183
1    304  1168
---- Validation: 
scalar performance:
{'acc': 0.98589826, 'precision': 0.9312629, 'recall': 0.8419382, 'specificity': 0.8419382, 'f1': 0.8810457, 'auroc': 0.981611, 'binary_precision': 0.8735178, 'binary_recall': 0.6874028, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.76936466}
confusion matrix:
       0    1
0  18085   64
1    201  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.8468274, 'recall': 0.6243524, 'specificity': 0.6243524, 'f1': 0.6784569, 'auroc': 0.9603639, 'binary_precision': 0.72527474, 'binary_recall': 0.25287357, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.37499997}
confusion matrix:
      0   1
0  5972  25
1   195  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_19.png
better model found
persisted
after epoch: 19,now: 2024-06-09 07:54:45.841264,epoch time: 0:25:37.749657,used: 8:07:24.915578,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9880115, 'precision': 0.89853895, 'recall': 0.92330754, 'specificity': 0.92330754, 'f1': 0.91051805, 'auroc': 0.99152017, 'binary_precision': 0.80216974, 'binary_recall': 0.8539402, 'binary_specificity': 0.9926749, 'binary_f1_score': 0.82724583}
confusion matrix:
       0     1
0  42010   310
1    215  1257
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.90755165, 'recall': 0.87505084, 'specificity': 0.87505084, 'f1': 0.8905706, 'auroc': 0.9797695, 'binary_precision': 0.8237288, 'binary_recall': 0.755832, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.7883212}
confusion matrix:
       0    1
0  18045  104
1    157  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.82866466, 'recall': 0.6483395, 'specificity': 0.6483395, 'f1': 0.70112777, 'auroc': 0.9365908, 'binary_precision': 0.6869565, 'binary_recall': 0.30268198, 'binary_specificity': 0.993997, 'binary_f1_score': 0.42021275}
confusion matrix:
      0   1
0  5961  36
1   182  79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_20.png
better model found
persisted
after epoch: 20,now: 2024-06-09 08:20:24.762582,epoch time: 0:25:38.921318,used: 8:33:03.836896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9874635, 'precision': 0.931356, 'recall': 0.8656486, 'specificity': 0.8656486, 'f1': 0.8955862, 'auroc': 0.99188286, 'binary_precision': 0.8718775, 'binary_recall': 0.7350544, 'binary_specificity': 0.99624294, 'binary_f1_score': 0.797641}
confusion matrix:
       0     1
0  42161   159
1    390  1082
---- Validation: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.92487395, 'recall': 0.8316916, 'specificity': 0.8316916, 'f1': 0.8721032, 'auroc': 0.9773197, 'binary_precision': 0.8614458, 'binary_recall': 0.66718507, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.75197196}
confusion matrix:
       0    1
0  18080   69
1    214  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.8818928, 'recall': 0.56821513, 'specificity': 0.56821513, 'f1': 0.6080648, 'auroc': 0.90797174, 'binary_precision': 0.8, 'binary_recall': 0.13793103, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.2352941}
confusion matrix:
      0   1
0  5988   9
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_21.png
early stop counter: 1
val acc:0.9849404096603394, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9651646018028259 / 0.96820068359375
after epoch: 21,now: 2024-06-09 08:45:59.066217,epoch time: 0:25:34.303635,used: 8:58:38.140531,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98810285, 'precision': 0.965391, 'recall': 0.84368503, 'specificity': 0.84368503, 'f1': 0.89473957, 'auroc': 0.9926617, 'binary_precision': 0.9415042, 'binary_recall': 0.6888587, 'binary_specificity': 0.9985113, 'binary_f1_score': 0.7956061}
confusion matrix:
       0     1
0  42257    63
1    458  1014
---- Validation: 
scalar performance:
{'acc': 0.9856322, 'precision': 0.95226246, 'recall': 0.81779873, 'specificity': 0.81779873, 'f1': 0.8724475, 'auroc': 0.9814376, 'binary_precision': 0.91722596, 'binary_recall': 0.63763607, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.7522935}
confusion matrix:
       0    1
0  18112   37
1    233  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.84643674, 'recall': 0.59045327, 'specificity': 0.59045327, 'f1': 0.63731325, 'auroc': 0.9273046, 'binary_precision': 0.72727275, 'binary_recall': 0.18390805, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.29357797}
confusion matrix:
      0   1
0  5979  18
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_22.png
early stop counter: 2
val acc:0.9856321811676025, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9651646018028259 / 0.96820068359375
after epoch: 22,now: 2024-06-09 09:11:39.306094,epoch time: 0:25:40.239877,used: 9:24:18.380408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98942727, 'precision': 0.91396296, 'recall': 0.9256309, 'specificity': 0.9256309, 'f1': 0.91970915, 'auroc': 0.9915309, 'binary_precision': 0.832893, 'binary_recall': 0.85723996, 'binary_specificity': 0.9940219, 'binary_f1_score': 0.84489113}
confusion matrix:
       0     1
0  42068   253
1    210  1261
---- Validation: 
scalar performance:
{'acc': 0.9853129, 'precision': 0.9080839, 'recall': 0.8588864, 'specificity': 0.8588864, 'f1': 0.8817786, 'auroc': 0.98082054, 'binary_precision': 0.8259325, 'binary_recall': 0.7231726, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.7711443}
confusion matrix:
       0    1
0  18051   98
1    178  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.827038, 'recall': 0.65766793, 'specificity': 0.65766793, 'f1': 0.7098479, 'auroc': 0.94985723, 'binary_precision': 0.68292683, 'binary_recall': 0.3218391, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.4375}
confusion matrix:
      0   1
0  5958  39
1   177  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_23.png
early stop counter: 3
val acc:0.9853128790855408, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9651646018028259 / 0.96820068359375
after epoch: 23,now: 2024-06-09 09:37:24.788084,epoch time: 0:25:45.481990,used: 9:50:03.862398,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9878517, 'precision': 0.94399273, 'recall': 0.85896444, 'specificity': 0.85896444, 'f1': 0.89664197, 'auroc': 0.9935938, 'binary_precision': 0.8976311, 'binary_recall': 0.72078806, 'binary_specificity': 0.9971408, 'binary_f1_score': 0.79954785}
confusion matrix:
       0     1
0  42199   121
1    411  1061
---- Validation: 
scalar performance:
{'acc': 0.9837165, 'precision': 0.9029403, 'recall': 0.83480823, 'specificity': 0.83480823, 'f1': 0.8654741, 'auroc': 0.97887254, 'binary_precision': 0.8173258, 'binary_recall': 0.6749611, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.7393526}
confusion matrix:
       0    1
0  18052   97
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.84682333, 'recall': 0.58104146, 'specificity': 0.58104146, 'f1': 0.62478167, 'auroc': 0.934134, 'binary_precision': 0.7288136, 'binary_recall': 0.16475096, 'binary_specificity': 0.997332, 'binary_f1_score': 0.26874998}
confusion matrix:
      0   1
0  5981  16
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_24.png
early stop counter: 4
val acc:0.9837164878845215, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9651646018028259 / 0.96820068359375
after epoch: 24,now: 2024-06-09 10:02:49.104352,epoch time: 0:25:24.316268,used: 10:15:28.178666,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98876506, 'precision': 0.90371805, 'recall': 0.9295989, 'specificity': 0.9295989, 'f1': 0.91622233, 'auroc': 0.9935974, 'binary_precision': 0.8121019, 'binary_recall': 0.8661685, 'binary_specificity': 0.9930293, 'binary_f1_score': 0.8382643}
confusion matrix:
       0     1
0  42025   295
1    197  1275
---- Validation: 
scalar performance:
{'acc': 0.9838761, 'precision': 0.8891782, 'recall': 0.8581426, 'specificity': 0.8581426, 'f1': 0.8729613, 'auroc': 0.98339003, 'binary_precision': 0.7881356, 'binary_recall': 0.7231726, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.7542579}
confusion matrix:
       0    1
0  18024  125
1    178  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.83415693, 'recall': 0.73104656, 'specificity': 0.73104656, 'f1': 0.7721919, 'auroc': 0.9611033, 'binary_precision': 0.69101125, 'binary_recall': 0.47126436, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.5603645}
confusion matrix:
      0    1
0  5942   55
1   138  123
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_25.png
new oracle model saved
early stop counter: 5
val acc:0.98387610912323, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9651646018028259 / 0.9691594839096069
after epoch: 25,now: 2024-06-09 10:28:01.494266,epoch time: 0:25:12.389914,used: 10:40:40.568580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9904092, 'precision': 0.93930715, 'recall': 0.9086286, 'specificity': 0.9086286, 'f1': 0.92336965, 'auroc': 0.9942813, 'binary_precision': 0.8848129, 'binary_recall': 0.82096666, 'binary_specificity': 0.99629045, 'binary_f1_score': 0.8516949}
confusion matrix:
       0     1
0  42166   157
1    263  1206
---- Validation: 
scalar performance:
{'acc': 0.9845679, 'precision': 0.89656687, 'recall': 0.8607509, 'specificity': 0.8607509, 'f1': 0.8777411, 'auroc': 0.9809607, 'binary_precision': 0.80274445, 'binary_recall': 0.7278383, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.7634585}
confusion matrix:
       0    1
0  18034  115
1    175  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9701182, 'precision': 0.8713946, 'recall': 0.70039713, 'specificity': 0.70039713, 'f1': 0.7579477, 'auroc': 0.9623872, 'binary_precision': 0.76811594, 'binary_recall': 0.40613025, 'binary_specificity': 0.994664, 'binary_f1_score': 0.5313283}
confusion matrix:
      0    1
0  5965   32
1   155  106
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_26.png
new oracle model saved
early stop counter: 6
val acc:0.9845678806304932, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9651646018028259 / 0.9701182246208191
after epoch: 26,now: 2024-06-09 10:53:14.632356,epoch time: 0:25:13.138090,used: 11:05:53.706670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9912769, 'precision': 0.9608076, 'recall': 0.9000797, 'specificity': 0.9000797, 'f1': 0.92814225, 'auroc': 0.99476767, 'binary_precision': 0.9284591, 'binary_recall': 0.8023098, 'binary_specificity': 0.9978497, 'binary_f1_score': 0.86078715}
confusion matrix:
       0     1
0  42229    91
1    291  1181
---- Validation: 
scalar performance:
{'acc': 0.98557895, 'precision': 0.92345536, 'recall': 0.8447732, 'specificity': 0.8447732, 'f1': 0.87977064, 'auroc': 0.9815099, 'binary_precision': 0.8576923, 'binary_recall': 0.69362366, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.76698196}
confusion matrix:
       0    1
0  18075   74
1    197  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8654709, 'recall': 0.5982828, 'specificity': 0.5982828, 'f1': 0.64882356, 'auroc': 0.9614215, 'binary_precision': 0.7647059, 'binary_recall': 0.19923371, 'binary_specificity': 0.997332, 'binary_f1_score': 0.31610942}
confusion matrix:
      0   1
0  5981  16
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_27.png
early stop counter: 7
val acc:0.9855789542198181, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9651646018028259 / 0.9701182246208191
after epoch: 27,now: 2024-06-09 11:18:32.404402,epoch time: 0:25:17.772046,used: 11:31:11.478716,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99152815, 'precision': 0.9376323, 'recall': 0.9310285, 'specificity': 0.9310285, 'f1': 0.93430334, 'auroc': 0.9952656, 'binary_precision': 0.8799172, 'binary_recall': 0.8661685, 'binary_specificity': 0.9958885, 'binary_f1_score': 0.87298876}
confusion matrix:
       0     1
0  42146   174
1    197  1275
---- Validation: 
scalar performance:
{'acc': 0.9859515, 'precision': 0.9044508, 'recall': 0.8764683, 'specificity': 0.8764683, 'f1': 0.8899164, 'auroc': 0.981215, 'binary_precision': 0.8174204, 'binary_recall': 0.7589425, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.7870968}
confusion matrix:
       0    1
0  18040  109
1    155  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.83906543, 'recall': 0.6110258, 'specificity': 0.6110258, 'f1': 0.662228, 'auroc': 0.9439619, 'binary_precision': 0.7108434, 'binary_recall': 0.22605364, 'binary_specificity': 0.995998, 'binary_f1_score': 0.34302324}
confusion matrix:
      0   1
0  5973  24
1   202  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_28.png
early stop counter: 8
val acc:0.9859514832496643, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9651646018028259 / 0.9701182246208191
after epoch: 28,now: 2024-06-09 11:43:51.201449,epoch time: 0:25:18.797047,used: 11:56:30.275763,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9896557, 'precision': 0.9709562, 'recall': 0.86406803, 'specificity': 0.86406803, 'f1': 0.91018593, 'auroc': 0.9958889, 'binary_precision': 0.95124114, 'binary_recall': 0.72943574, 'binary_specificity': 0.9987004, 'binary_f1_score': 0.8257022}
confusion matrix:
       0     1
0  42266    55
1    398  1073
---- Validation: 
scalar performance:
{'acc': 0.98547256, 'precision': 0.9391154, 'recall': 0.82671666, 'specificity': 0.82671666, 'f1': 0.87405455, 'auroc': 0.97874105, 'binary_precision': 0.8902954, 'binary_recall': 0.6562986, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.7555954}
confusion matrix:
       0    1
0  18097   52
1    221  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8735924, 'recall': 0.5946182, 'specificity': 0.5946182, 'f1': 0.64461803, 'auroc': 0.936922, 'binary_precision': 0.78125, 'binary_recall': 0.19157088, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.3076923}
confusion matrix:
      0   1
0  5983  14
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_29.png
early stop counter: 9
val acc:0.985472559928894, best validation acc: 0.9861111044883728, corresponding to test acc:                         0.9651646018028259 / 0.9701182246208191
after epoch: 29,now: 2024-06-09 12:09:11.740704,epoch time: 0:25:20.539255,used: 12:21:50.815018,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9913683, 'precision': 0.95901, 'recall': 0.90334076, 'specificity': 0.90334076, 'f1': 0.92924404, 'auroc': 0.99563026, 'binary_precision': 0.92463094, 'binary_recall': 0.8089735, 'binary_specificity': 0.997708, 'binary_f1_score': 0.8629442}
confusion matrix:
       0     1
0  42224    97
1    281  1190
---- Validation: 
scalar performance:
{'acc': 0.98690933, 'precision': 0.94280064, 'recall': 0.84771204, 'specificity': 0.84771204, 'f1': 0.8891071, 'auroc': 0.97838366, 'binary_precision': 0.8962076, 'binary_recall': 0.6982893, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.784965}
confusion matrix:
       0    1
0  18097   52
1    194  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8582687, 'recall': 0.60194755, 'specificity': 0.60194755, 'f1': 0.652928, 'auroc': 0.926395, 'binary_precision': 0.75, 'binary_recall': 0.20689656, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.32432434}
confusion matrix:
      0   1
0  5979  18
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_30.png
better model found
persisted
after epoch: 30,now: 2024-06-09 12:34:24.042811,epoch time: 0:25:12.302107,used: 12:47:03.117125,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_08_23_47_20_seed_0_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:47:03.117125 at 2024-06-09 12:34:24.042811
persisted model performance metric: 

scalar performance:
{'acc': 0.964046, 'precision': 0.8582687, 'recall': 0.60194755, 'specificity': 0.60194755, 'f1': 0.652928, 'auroc': 0.940043, 'binary_precision': 0.75, 'binary_recall': 0.20689656, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.32432434}
confusion matrix:
      0   1
0  5979  18
1   207  54
oracle model performance metric: 

scalar performance:
{'acc': 0.96708214, 'precision': 0.841252, 'recall': 0.6749927, 'specificity': 0.6749927, 'f1': 0.72874933, 'auroc': 0.9620913, 'binary_precision': 0.7099237, 'binary_recall': 0.35632184, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.47448978}
confusion matrix:
      0   1
0  5959  38
1   168  93
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456549 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456549 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB |   1119 TiB |   1119 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1106 TiB |   1106 TiB |
|       from small pool |  40679 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14486 MiB |  14486 MiB |  14486 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446619 KiB |   1251 MiB |    802 TiB |    802 TiB |
|       from large pool | 435058 KiB |   1243 MiB |    789 TiB |    789 TiB |
|       from small pool |  11560 KiB |     17 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  197601 K  |  197598 K  |
|       from large pool |     187    |    1413    |  102521 K  |  102521 K  |
|       from small pool |    3301    |    6290    |   95080 K  |   95077 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  197601 K  |  197598 K  |
|       from large pool |     187    |    1413    |  102521 K  |  102521 K  |
|       from small pool |    3301    |    6290    |   95080 K  |   95077 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |     637    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    2803    |  126942 K  |  126942 K  |
|       from large pool |      37    |     600    |   76732 K  |   76732 K  |
|       from small pool |      43    |    2765    |   50209 K  |   50209 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1119 TiB |   1119 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1106 TiB |   1106 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14486 MiB |  14486 MiB |  13604 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     72 MiB |     72 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |    802 TiB |    802 TiB |
|       from large pool |  24320 KiB |   1243 MiB |    789 TiB |    789 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95080 K  |   95080 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95080 K  |   95080 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |     637    |     574    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      36    |      36    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2803    |  126943 K  |  126943 K  |
|       from large pool |       4    |     600    |   76732 K  |   76732 K  |
|       from small pool |       0    |    2765    |   50210 K  |   50210 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1119 TiB |   1119 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1106 TiB |   1106 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14486 MiB |  14486 MiB |  13604 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     72 MiB |     72 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |    802 TiB |    802 TiB |
|       from large pool |  24320 KiB |   1243 MiB |    789 TiB |    789 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95080 K  |   95080 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197601 K  |  197601 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95080 K  |   95080 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |     637    |     574    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      36    |      36    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2803    |  126943 K  |  126943 K  |
|       from large pool |       4    |     600    |   76732 K  |   76732 K  |
|       from small pool |       0    |    2765    |   50210 K  |   50210 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156

 Experiment start at: 2024-06-09 12:45:29.639727
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9685334, 'precision': 0.77092564, 'recall': 0.5861437, 'specificity': 0.5861437, 'f1': 0.62688076, 'auroc': 0.94661003, 'binary_precision': 0.5691964, 'binary_recall': 0.17683773, 'binary_specificity': 0.9954496, 'binary_f1_score': 0.26984125}
confusion matrix:
       0    1
0  42221  193
1   1187  255
---- Validation: 
scalar performance:
{'acc': 0.9672892, 'precision': 0.79381245, 'recall': 0.61610323, 'specificity': 0.61610323, 'f1': 0.66310334, 'auroc': 0.93987095, 'binary_precision': 0.61538464, 'binary_recall': 0.23774146, 'binary_specificity': 0.99446505, 'binary_f1_score': 0.34297964}
confusion matrix:
       0    1
0  17967  100
1    513  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96696746, 'precision': 0.9518939, 'recall': 0.6131252, 'specificity': 0.6131252, 'f1': 0.6741838, 'auroc': 0.93930924, 'binary_precision': 0.93650794, 'binary_recall': 0.22692308, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.36532506}
confusion matrix:
      0   1
0  5942   4
1   201  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-09 13:12:09.648356,epoch time: 0:26:40.008629,used: 0:26:40.008629,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97389185, 'precision': 0.7967249, 'recall': 0.7833755, 'specificity': 0.7833755, 'f1': 0.7898817, 'auroc': 0.9609927, 'binary_precision': 0.6077147, 'binary_recall': 0.5794587, 'binary_specificity': 0.98729223, 'binary_f1_score': 0.59325045}
confusion matrix:
       0    1
0  41876  539
1    606  835
---- Validation: 
scalar performance:
{'acc': 0.97129136, 'precision': 0.8025758, 'recall': 0.7476422, 'specificity': 0.7476422, 'f1': 0.77208954, 'auroc': 0.962758, 'binary_precision': 0.6234004, 'binary_recall': 0.50668645, 'binary_specificity': 0.988598, 'binary_f1_score': 0.55901635}
confusion matrix:
       0    1
0  17861  206
1    332  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693845, 'precision': 0.87996465, 'recall': 0.682429, 'specificity': 0.682429, 'f1': 0.74341196, 'auroc': 0.9486778, 'binary_precision': 0.78688526, 'binary_recall': 0.36923078, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.5026178}
confusion matrix:
      0   1
0  5920  26
1   164  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-09 13:37:29.330495,epoch time: 0:25:19.682139,used: 0:51:59.690768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97690165, 'precision': 0.82278645, 'recall': 0.8034996, 'specificity': 0.8034996, 'f1': 0.8128189, 'auroc': 0.9684919, 'binary_precision': 0.6585366, 'binary_recall': 0.6178918, 'binary_specificity': 0.9891074, 'binary_f1_score': 0.63756704}
confusion matrix:
       0    1
0  41952  462
1    551  891
---- Validation: 
scalar performance:
{'acc': 0.97379935, 'precision': 0.8280486, 'recall': 0.75752616, 'specificity': 0.75752616, 'f1': 0.7881376, 'auroc': 0.9663435, 'binary_precision': 0.6736641, 'binary_recall': 0.52451706, 'binary_specificity': 0.99053526, 'binary_f1_score': 0.5898078}
confusion matrix:
       0    1
0  17896  171
1    320  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.86500776, 'recall': 0.61571, 'specificity': 0.61571, 'f1': 0.67038256, 'auroc': 0.9579375, 'binary_precision': 0.7625, 'binary_recall': 0.23461539, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.3588235}
confusion matrix:
      0   1
0  5927  19
1   199  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_3.png
better model found
persisted
after epoch: 3,now: 2024-06-09 14:02:49.169441,epoch time: 0:25:19.838946,used: 1:17:19.529714,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97660524, 'precision': 0.8738683, 'recall': 0.70487046, 'specificity': 0.70487046, 'f1': 0.76291835, 'auroc': 0.97242737, 'binary_precision': 0.76735216, 'binary_recall': 0.41400832, 'binary_specificity': 0.99573255, 'binary_f1_score': 0.53783786}
confusion matrix:
       0    1
0  42233  181
1    845  597
---- Validation: 
scalar performance:
{'acc': 0.9734258, 'precision': 0.88449955, 'recall': 0.6743614, 'specificity': 0.6743614, 'f1': 0.7370067, 'auroc': 0.9676806, 'binary_precision': 0.7926421, 'binary_recall': 0.35215452, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.48765433}
confusion matrix:
       0    1
0  18005   62
1    436  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.800477, 'recall': 0.5562628, 'specificity': 0.5562628, 'f1': 0.5875175, 'auroc': 0.95758104, 'binary_precision': 0.63829786, 'binary_recall': 0.115384616, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.19543974}
confusion matrix:
      0   1
0  5929  17
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_4.png
early stop counter: 1
val acc:0.9734258055686951, best validation acc: 0.9737993478775024, corresponding to test acc:                         0.9648727178573608 / 0.969384491443634
after epoch: 4,now: 2024-06-09 14:28:11.606083,epoch time: 0:25:22.436642,used: 1:42:41.966356,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9792731, 'precision': 0.90303075, 'recall': 0.7333808, 'specificity': 0.7333808, 'f1': 0.7940186, 'auroc': 0.97490877, 'binary_precision': 0.8238153, 'binary_recall': 0.4701803, 'binary_specificity': 0.9965813, 'binary_f1_score': 0.59867543}
confusion matrix:
       0    1
0  42269  145
1    764  678
---- Validation: 
scalar performance:
{'acc': 0.9739061, 'precision': 0.91209155, 'recall': 0.66531205, 'specificity': 0.66531205, 'f1': 0.73237014, 'auroc': 0.96808994, 'binary_precision': 0.8484849, 'binary_recall': 0.33283803, 'binary_specificity': 0.99778605, 'binary_f1_score': 0.47812164}
confusion matrix:
       0    1
0  18027   40
1    449  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.7013053, 'recall': 0.547225, 'specificity': 0.547225, 'f1': 0.57046527, 'auroc': 0.9505421, 'binary_precision': 0.44067797, 'binary_recall': 0.1, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.1630094}
confusion matrix:
      0   1
0  5913  33
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_5.png
better model found
persisted
after epoch: 5,now: 2024-06-09 14:53:34.413081,epoch time: 0:25:22.806998,used: 2:08:04.773354,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98009396, 'precision': 0.8487644, 'recall': 0.83027136, 'specificity': 0.83027136, 'f1': 0.8392441, 'auroc': 0.97576946, 'binary_precision': 0.70873076, 'binary_recall': 0.6699029, 'binary_specificity': 0.99063987, 'binary_f1_score': 0.68877006}
confusion matrix:
       0    1
0  42017  397
1    476  966
---- Validation: 
scalar performance:
{'acc': 0.9780683, 'precision': 0.86298525, 'recall': 0.7955035, 'specificity': 0.7955035, 'f1': 0.8254752, 'auroc': 0.9702536, 'binary_precision': 0.74080884, 'binary_recall': 0.59881127, 'binary_specificity': 0.9921957, 'binary_f1_score': 0.6622843}
confusion matrix:
       0    1
0  17926  141
1    270  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.7793827, 'recall': 0.60817486, 'specificity': 0.60817486, 'f1': 0.651973, 'auroc': 0.95425105, 'binary_precision': 0.59183675, 'binary_recall': 0.22307692, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.32402235}
confusion matrix:
      0   1
0  5906  40
1   202  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_6.png
better model found
persisted
after epoch: 6,now: 2024-06-09 15:18:58.581011,epoch time: 0:25:24.167930,used: 2:33:28.941284,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9799571, 'precision': 0.8776223, 'recall': 0.7751146, 'specificity': 0.7751146, 'f1': 0.81769705, 'auroc': 0.9793212, 'binary_precision': 0.7701923, 'binary_recall': 0.555864, 'binary_specificity': 0.9943652, 'binary_f1_score': 0.64570737}
confusion matrix:
       0    1
0  42176  239
1    640  801
---- Validation: 
scalar performance:
{'acc': 0.97812164, 'precision': 0.91213787, 'recall': 0.7383098, 'specificity': 0.7383098, 'f1': 0.800243, 'auroc': 0.97464675, 'binary_precision': 0.84334207, 'binary_recall': 0.47994056, 'binary_specificity': 0.996679, 'binary_f1_score': 0.61174244}
confusion matrix:
       0    1
0  18007   60
1    350  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.831372, 'recall': 0.60375106, 'specificity': 0.60375106, 'f1': 0.65275794, 'auroc': 0.9567034, 'binary_precision': 0.6962025, 'binary_recall': 0.21153846, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.32448378}
confusion matrix:
      0   1
0  5922  24
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_7.png
better model found
persisted
after epoch: 7,now: 2024-06-09 15:44:14.765756,epoch time: 0:25:16.184745,used: 2:58:45.126029,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9815761, 'precision': 0.8774086, 'recall': 0.8122803, 'specificity': 0.8122803, 'f1': 0.84152263, 'auroc': 0.980443, 'binary_precision': 0.767285, 'binary_recall': 0.63106793, 'binary_specificity': 0.9934927, 'binary_f1_score': 0.69254184}
confusion matrix:
       0    1
0  42138  276
1    532  910
---- Validation: 
scalar performance:
{'acc': 0.9782284, 'precision': 0.8934761, 'recall': 0.7576773, 'specificity': 0.7576773, 'f1': 0.8102758, 'auroc': 0.97552687, 'binary_precision': 0.8045977, 'binary_recall': 0.5200594, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.63176894}
confusion matrix:
       0    1
0  17982   85
1    323  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.75144637, 'recall': 0.562946, 'specificity': 0.562946, 'f1': 0.59471637, 'auroc': 0.95848, 'binary_precision': 0.53968257, 'binary_recall': 0.13076924, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.21052633}
confusion matrix:
      0   1
0  5917  29
1   226  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_8.png
better model found
persisted
after epoch: 8,now: 2024-06-09 16:09:47.117804,epoch time: 0:25:32.352048,used: 3:24:17.478077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98476833, 'precision': 0.8845936, 'recall': 0.8722124, 'specificity': 0.8722124, 'f1': 0.87829334, 'auroc': 0.9831351, 'binary_precision': 0.77761835, 'binary_recall': 0.7517337, 'binary_specificity': 0.9926911, 'binary_f1_score': 0.764457}
confusion matrix:
       0     1
0  42104   310
1    358  1084
---- Validation: 
scalar performance:
{'acc': 0.9809498, 'precision': 0.8757405, 'recall': 0.8363376, 'specificity': 0.8363376, 'f1': 0.8548501, 'auroc': 0.97601324, 'binary_precision': 0.7633333, 'binary_recall': 0.6805349, 'binary_specificity': 0.99214035, 'binary_f1_score': 0.71956015}
confusion matrix:
       0    1
0  17925  142
1    215  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8080865, 'recall': 0.5807582, 'specificity': 0.5807582, 'f1': 0.621973, 'auroc': 0.95469564, 'binary_precision': 0.6515151, 'binary_recall': 0.16538462, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.26380366}
confusion matrix:
      0   1
0  5923  23
1   217  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_9.png
better model found
persisted
after epoch: 9,now: 2024-06-09 16:35:21.194370,epoch time: 0:25:34.076566,used: 3:49:51.554643,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98159885, 'precision': 0.8386358, 'recall': 0.9037341, 'specificity': 0.9037341, 'f1': 0.86806035, 'auroc': 0.9825274, 'binary_precision': 0.68342, 'binary_recall': 0.8203884, 'binary_specificity': 0.98707974, 'binary_f1_score': 0.7456666}
confusion matrix:
       0     1
0  41866   548
1    259  1183
---- Validation: 
scalar performance:
{'acc': 0.98159015, 'precision': 0.8550838, 'recall': 0.8960369, 'specificity': 0.8960369, 'f1': 0.8743324, 'auroc': 0.97726965, 'binary_precision': 0.71750665, 'binary_recall': 0.8038633, 'binary_specificity': 0.98821056, 'binary_f1_score': 0.7582341}
confusion matrix:
       0    1
0  17854  213
1    132  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.7579731, 'recall': 0.65749115, 'specificity': 0.65749115, 'f1': 0.69407356, 'auroc': 0.957022, 'binary_precision': 0.5448718, 'binary_recall': 0.32692307, 'binary_specificity': 0.9880592, 'binary_f1_score': 0.40865386}
confusion matrix:
      0   1
0  5875  71
1   175  85
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_10.png
better model found
persisted
after epoch: 10,now: 2024-06-09 17:00:57.142978,epoch time: 0:25:35.948608,used: 4:15:27.503251,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98620486, 'precision': 0.9325425, 'recall': 0.83644533, 'specificity': 0.83644533, 'f1': 0.8780525, 'auroc': 0.9859868, 'binary_precision': 0.8760108, 'binary_recall': 0.67614424, 'binary_specificity': 0.99674636, 'binary_f1_score': 0.7632094}
confusion matrix:
       0    1
0  42276  138
1    467  975
---- Validation: 
scalar performance:
{'acc': 0.9835112, 'precision': 0.91996396, 'recall': 0.8247912, 'specificity': 0.8247912, 'f1': 0.8658016, 'auroc': 0.9779613, 'binary_precision': 0.85271317, 'binary_recall': 0.653789, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.7401177}
confusion matrix:
       0    1
0  17991   76
1    233  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.8570442, 'recall': 0.57390684, 'specificity': 0.57390684, 'f1': 0.6153306, 'auroc': 0.9611458, 'binary_precision': 0.75, 'binary_recall': 0.15, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.25000003}
confusion matrix:
      0   1
0  5933  13
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_11.png
better model found
persisted
after epoch: 11,now: 2024-06-09 17:26:34.230903,epoch time: 0:25:37.087925,used: 4:41:04.591176,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98497355, 'precision': 0.9017262, 'recall': 0.8495418, 'specificity': 0.8495418, 'f1': 0.8736793, 'auroc': 0.9847109, 'binary_precision': 0.81345075, 'binary_recall': 0.70457697, 'binary_specificity': 0.99450654, 'binary_f1_score': 0.75510955}
confusion matrix:
       0     1
0  42181   233
1    426  1016
---- Validation: 
scalar performance:
{'acc': 0.9813767, 'precision': 0.89607567, 'recall': 0.8143858, 'specificity': 0.8143858, 'f1': 0.85013574, 'auroc': 0.97791314, 'binary_precision': 0.80566037, 'binary_recall': 0.6344725, 'binary_specificity': 0.994299, 'binary_f1_score': 0.70989186}
confusion matrix:
       0    1
0  17964  103
1    246  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.8136265, 'recall': 0.58836645, 'specificity': 0.58836645, 'f1': 0.6321852, 'auroc': 0.9549967, 'binary_precision': 0.6619718, 'binary_recall': 0.18076923, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.28398794}
confusion matrix:
      0   1
0  5922  24
1   213  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_12.png
early stop counter: 1
val acc:0.9813767075538635, best validation acc: 0.983511209487915, corresponding to test acc:                         0.9622945785522461 / 0.969384491443634
after epoch: 12,now: 2024-06-09 17:52:09.308418,epoch time: 0:25:35.077515,used: 5:06:39.668691,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98595405, 'precision': 0.9375677, 'recall': 0.82693696, 'specificity': 0.82693696, 'f1': 0.8736759, 'auroc': 0.9858227, 'binary_precision': 0.88670415, 'binary_recall': 0.6567268, 'binary_specificity': 0.99714714, 'binary_f1_score': 0.7545817}
confusion matrix:
       0    1
0  42293  121
1    495  947
---- Validation: 
scalar performance:
{'acc': 0.98175025, 'precision': 0.9331608, 'recall': 0.78239244, 'specificity': 0.78239244, 'f1': 0.84068763, 'auroc': 0.97487617, 'binary_precision': 0.8822171, 'binary_recall': 0.5676077, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.69077754}
confusion matrix:
       0    1
0  18016   51
1    291  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.90300554, 'recall': 0.55150265, 'specificity': 0.55150265, 'f1': 0.58264726, 'auroc': 0.9624859, 'binary_precision': 0.84375, 'binary_recall': 0.103846155, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.1849315}
confusion matrix:
      0   1
0  5941   5
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_13.png
early stop counter: 2
val acc:0.9817502498626709, best validation acc: 0.983511209487915, corresponding to test acc:                         0.9622945785522461 / 0.969384491443634
after epoch: 13,now: 2024-06-09 18:17:43.066628,epoch time: 0:25:33.758210,used: 5:32:13.426901,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9855436, 'precision': 0.87114567, 'recall': 0.9181667, 'specificity': 0.9181667, 'f1': 0.8931317, 'auroc': 0.9881637, 'binary_precision': 0.747549, 'binary_recall': 0.84604716, 'binary_specificity': 0.99028623, 'binary_f1_score': 0.79375404}
confusion matrix:
       0     1
0  42002   412
1    222  1220
---- Validation: 
scalar performance:
{'acc': 0.9851121, 'precision': 0.8956312, 'recall': 0.88713443, 'specificity': 0.88713443, 'f1': 0.8913325, 'auroc': 0.97908676, 'binary_precision': 0.7993921, 'binary_recall': 0.781575, 'binary_specificity': 0.99269384, 'binary_f1_score': 0.7903831}
confusion matrix:
       0    1
0  17935  132
1    147  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.7808639, 'recall': 0.6864214, 'specificity': 0.6864214, 'f1': 0.7229605, 'auroc': 0.9617518, 'binary_precision': 0.5882353, 'binary_recall': 0.3846154, 'binary_specificity': 0.98822737, 'binary_f1_score': 0.46511632}
confusion matrix:
      0    1
0  5876   70
1   160  100
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_14.png
better model found
persisted
after epoch: 14,now: 2024-06-09 18:43:19.023211,epoch time: 0:25:35.956583,used: 5:57:49.383484,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9875274, 'precision': 0.92182744, 'recall': 0.8733039, 'specificity': 0.8733039, 'f1': 0.8959714, 'auroc': 0.98800206, 'binary_precision': 0.852085, 'binary_recall': 0.7510402, 'binary_specificity': 0.9955675, 'binary_f1_score': 0.79837817}
confusion matrix:
       0     1
0  42226   188
1    359  1083
---- Validation: 
scalar performance:
{'acc': 0.98356456, 'precision': 0.92696893, 'recall': 0.8183815, 'specificity': 0.8183815, 'f1': 0.8641348, 'auroc': 0.97876143, 'binary_precision': 0.86720324, 'binary_recall': 0.640416, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.73675215}
confusion matrix:
       0    1
0  18001   66
1    242  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.76687086, 'recall': 0.57623935, 'specificity': 0.57623935, 'f1': 0.6131463, 'auroc': 0.95151293, 'binary_precision': 0.5694444, 'binary_recall': 0.15769231, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.24698795}
confusion matrix:
      0   1
0  5915  31
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_15.png
early stop counter: 1
val acc:0.983564555644989, best validation acc: 0.9851120710372925, corresponding to test acc:                         0.9629390835762024 / 0.969384491443634
after epoch: 15,now: 2024-06-09 19:09:02.034847,epoch time: 0:25:43.011636,used: 6:23:32.395120,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98761857, 'precision': 0.90654874, 'recall': 0.8964627, 'specificity': 0.8964627, 'f1': 0.9014373, 'auroc': 0.98859304, 'binary_precision': 0.8199288, 'binary_recall': 0.7988904, 'binary_specificity': 0.994035, 'binary_f1_score': 0.80927294}
confusion matrix:
       0     1
0  42161   253
1    290  1152
---- Validation: 
scalar performance:
{'acc': 0.98612595, 'precision': 0.92112935, 'recall': 0.8690633, 'specificity': 0.8690633, 'f1': 0.89323616, 'auroc': 0.97896606, 'binary_precision': 0.85178876, 'binary_recall': 0.74294204, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.79365075}
confusion matrix:
       0    1
0  17980   87
1    173  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.8111334, 'recall': 0.58644336, 'specificity': 0.58644336, 'f1': 0.6295446, 'auroc': 0.9644397, 'binary_precision': 0.6571429, 'binary_recall': 0.17692308, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.27878788}
confusion matrix:
      0   1
0  5922  24
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_16.png
better model found
persisted
after epoch: 16,now: 2024-06-09 19:35:22.583366,epoch time: 0:26:20.548519,used: 6:49:52.943639,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9868889, 'precision': 0.89527035, 'recall': 0.89976996, 'specificity': 0.89976996, 'f1': 0.89750636, 'auroc': 0.9890864, 'binary_precision': 0.7971213, 'binary_recall': 0.80651873, 'binary_specificity': 0.9930212, 'binary_f1_score': 0.80179244}
confusion matrix:
       0     1
0  42118   296
1    279  1163
---- Validation: 
scalar performance:
{'acc': 0.9839381, 'precision': 0.8853794, 'recall': 0.8815187, 'specificity': 0.8815187, 'f1': 0.88343835, 'auroc': 0.98077345, 'binary_precision': 0.7792793, 'binary_recall': 0.77117383, 'binary_specificity': 0.9918636, 'binary_f1_score': 0.7752053}
confusion matrix:
       0    1
0  17920  147
1    154  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.7966847, 'recall': 0.58242905, 'specificity': 0.58242905, 'f1': 0.62331843, 'auroc': 0.95796704, 'binary_precision': 0.62857145, 'binary_recall': 0.16923077, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.26666668}
confusion matrix:
      0   1
0  5920  26
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_17.png
early stop counter: 1
val acc:0.9839380979537964, best validation acc: 0.9861259460449219, corresponding to test acc:                         0.961650013923645 / 0.969384491443634
after epoch: 17,now: 2024-06-09 20:01:11.577348,epoch time: 0:25:48.993982,used: 7:15:41.937621,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9874818, 'precision': 0.9064623, 'recall': 0.89364076, 'specificity': 0.89364076, 'f1': 0.8999405, 'auroc': 0.98995376, 'binary_precision': 0.8199426, 'binary_recall': 0.7931992, 'binary_specificity': 0.9940823, 'binary_f1_score': 0.8063492}
confusion matrix:
       0     1
0  42164   251
1    298  1143
---- Validation: 
scalar performance:
{'acc': 0.9842049, 'precision': 0.9123927, 'recall': 0.84589374, 'specificity': 0.84589374, 'f1': 0.87598157, 'auroc': 0.97764885, 'binary_precision': 0.8360071, 'binary_recall': 0.6968796, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.76012963}
confusion matrix:
       0    1
0  17975   92
1    204  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96777314, 'precision': 0.86518884, 'recall': 0.66687626, 'specificity': 0.66687626, 'f1': 0.7257341, 'auroc': 0.96446836, 'binary_precision': 0.7586207, 'binary_recall': 0.33846155, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.4680851}
confusion matrix:
      0   1
0  5918  28
1   172  88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_18.png
early stop counter: 2
val acc:0.984204888343811, best validation acc: 0.9861259460449219, corresponding to test acc:                         0.961650013923645 / 0.969384491443634
after epoch: 18,now: 2024-06-09 20:27:40.294143,epoch time: 0:26:28.716795,used: 7:42:10.654416,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98839384, 'precision': 0.9249402, 'recall': 0.88581014, 'specificity': 0.88581014, 'f1': 0.9043581, 'auroc': 0.99039054, 'binary_precision': 0.8574713, 'binary_recall': 0.77600557, 'binary_specificity': 0.99561465, 'binary_f1_score': 0.8147069}
confusion matrix:
       0     1
0  42228   186
1    323  1119
---- Validation: 
scalar performance:
{'acc': 0.984365, 'precision': 0.91011053, 'recall': 0.8516989, 'specificity': 0.8516989, 'f1': 0.8784748, 'auroc': 0.9782107, 'binary_precision': 0.83101046, 'binary_recall': 0.7087667, 'binary_specificity': 0.9946311, 'binary_f1_score': 0.76503605}
confusion matrix:
       0    1
0  17970   97
1    196  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.9318359, 'recall': 0.56889445, 'specificity': 0.56889445, 'f1': 0.61058784, 'auroc': 0.9603803, 'binary_precision': 0.9, 'binary_recall': 0.13846155, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.24}
confusion matrix:
      0   1
0  5942   4
1   224  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_19.png
early stop counter: 3
val acc:0.9843649864196777, best validation acc: 0.9861259460449219, corresponding to test acc:                         0.961650013923645 / 0.969384491443634
after epoch: 19,now: 2024-06-09 20:54:11.076233,epoch time: 0:26:30.782090,used: 8:08:41.436506,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9891007, 'precision': 0.925166, 'recall': 0.8989037, 'specificity': 0.8989037, 'f1': 0.9115839, 'auroc': 0.9897796, 'binary_precision': 0.857037, 'binary_recall': 0.80235785, 'binary_specificity': 0.9954496, 'binary_f1_score': 0.82879657}
confusion matrix:
       0     1
0  42221   193
1    285  1157
---- Validation: 
scalar performance:
{'acc': 0.9845251, 'precision': 0.9230945, 'recall': 0.8389071, 'specificity': 0.8389071, 'f1': 0.8759693, 'auroc': 0.97912955, 'binary_precision': 0.85794395, 'binary_recall': 0.6820208, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.75993377}
confusion matrix:
       0    1
0  17991   76
1    214  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.9050498, 'recall': 0.61253655, 'specificity': 0.61253655, 'f1': 0.6700145, 'auroc': 0.96302843, 'binary_precision': 0.8428571, 'binary_recall': 0.22692308, 'binary_specificity': 0.99815, 'binary_f1_score': 0.35757574}
confusion matrix:
      0   1
0  5935  11
1   201  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_20.png
early stop counter: 4
val acc:0.9845250844955444, best validation acc: 0.9861259460449219, corresponding to test acc:                         0.961650013923645 / 0.969384491443634
after epoch: 20,now: 2024-06-09 21:20:03.864368,epoch time: 0:25:52.788135,used: 8:34:34.224641,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9873906, 'precision': 0.8853671, 'recall': 0.92984, 'specificity': 0.92984, 'f1': 0.90628564, 'auroc': 0.99117005, 'binary_precision': 0.7752322, 'binary_recall': 0.86823857, 'binary_specificity': 0.9914415, 'binary_f1_score': 0.81910366}
confusion matrix:
       0     1
0  42051   363
1    190  1252
---- Validation: 
scalar performance:
{'acc': 0.984952, 'precision': 0.8870454, 'recall': 0.89921093, 'specificity': 0.89921093, 'f1': 0.8930253, 'auroc': 0.9802481, 'binary_precision': 0.78129494, 'binary_recall': 0.80683506, 'binary_specificity': 0.99158686, 'binary_f1_score': 0.79385966}
confusion matrix:
       0    1
0  17915  152
1    130  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.8467734, 'recall': 0.63426805, 'specificity': 0.63426805, 'f1': 0.6893643, 'auroc': 0.9635561, 'binary_precision': 0.7244898, 'binary_recall': 0.27307692, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.39664808}
confusion matrix:
      0   1
0  5919  27
1   189  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_21.png
early stop counter: 5
val acc:0.9849519729614258, best validation acc: 0.9861259460449219, corresponding to test acc:                         0.961650013923645 / 0.969384491443634
after epoch: 21,now: 2024-06-09 21:46:05.976377,epoch time: 0:26:02.112009,used: 9:00:36.336650,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9891691, 'precision': 0.96915257, 'recall': 0.8540555, 'specificity': 0.8540555, 'f1': 0.90300345, 'auroc': 0.9924985, 'binary_precision': 0.9481001, 'binary_recall': 0.70943135, 'binary_specificity': 0.9986797, 'binary_f1_score': 0.8115827}
confusion matrix:
       0     1
0  42358    56
1    419  1023
---- Validation: 
scalar performance:
{'acc': 0.98537886, 'precision': 0.95792246, 'recall': 0.8200377, 'specificity': 0.8200377, 'f1': 0.8758436, 'auroc': 0.97909486, 'binary_precision': 0.92903227, 'binary_recall': 0.6419019, 'binary_specificity': 0.9981735, 'binary_f1_score': 0.7592267}
confusion matrix:
       0    1
0  18034   33
1    241  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.8406795, 'recall': 0.58126277, 'specificity': 0.58126277, 'f1': 0.6246992, 'auroc': 0.9590848, 'binary_precision': 0.71666664, 'binary_recall': 0.16538462, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.26875}
confusion matrix:
      0   1
0  5929  17
1   217  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_22.png
early stop counter: 6
val acc:0.9853788614273071, best validation acc: 0.9861259460449219, corresponding to test acc:                         0.961650013923645 / 0.969384491443634
after epoch: 22,now: 2024-06-09 22:11:59.680805,epoch time: 0:25:53.704428,used: 9:26:30.041078,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9896479, 'precision': 0.93734497, 'recall': 0.89382744, 'specificity': 0.89382744, 'f1': 0.91436076, 'auroc': 0.9917317, 'binary_precision': 0.88176197, 'binary_recall': 0.79126215, 'binary_specificity': 0.9963927, 'binary_f1_score': 0.8340643}
confusion matrix:
       0     1
0  42261   153
1    301  1141
---- Validation: 
scalar performance:
{'acc': 0.98329777, 'precision': 0.91113305, 'recall': 0.8311179, 'specificity': 0.8311179, 'f1': 0.86645293, 'auroc': 0.98012763, 'binary_precision': 0.8345725, 'binary_recall': 0.66716194, 'binary_specificity': 0.9950739, 'binary_f1_score': 0.7415359}
confusion matrix:
       0    1
0  17978   89
1    224  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.79414284, 'recall': 0.6309995, 'specificity': 0.6309995, 'f1': 0.6779907, 'auroc': 0.94345033, 'binary_precision': 0.61946905, 'binary_recall': 0.26923078, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.37533513}
confusion matrix:
      0   1
0  5903  43
1   190  70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_23.png
early stop counter: 7
val acc:0.9832977652549744, best validation acc: 0.9861259460449219, corresponding to test acc:                         0.961650013923645 / 0.969384491443634
after epoch: 23,now: 2024-06-09 22:38:28.050863,epoch time: 0:26:28.370058,used: 9:52:58.411136,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98971635, 'precision': 0.91747034, 'recall': 0.9216638, 'specificity': 0.9216638, 'f1': 0.9195558, 'auroc': 0.99268, 'binary_precision': 0.84008235, 'binary_recall': 0.8488211, 'binary_specificity': 0.99450654, 'binary_f1_score': 0.84442914}
confusion matrix:
       0     1
0  42181   233
1    218  1224
---- Validation: 
scalar performance:
{'acc': 0.984365, 'precision': 0.88613176, 'recall': 0.88889277, 'specificity': 0.88889277, 'f1': 0.88750696, 'auroc': 0.9813697, 'binary_precision': 0.780236, 'binary_recall': 0.7860327, 'binary_specificity': 0.9917529, 'binary_f1_score': 0.7831237}
confusion matrix:
       0    1
0  17918  149
1    144  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.8024758, 'recall': 0.6892694, 'specificity': 0.6892694, 'f1': 0.7313868, 'auroc': 0.96361375, 'binary_precision': 0.63125, 'binary_recall': 0.38846153, 'binary_specificity': 0.9900774, 'binary_f1_score': 0.4809524}
confusion matrix:
      0    1
0  5887   59
1   159  101
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_24.png
early stop counter: 8
val acc:0.9843649864196777, best validation acc: 0.9861259460449219, corresponding to test acc:                         0.961650013923645 / 0.969384491443634
after epoch: 24,now: 2024-06-09 23:04:47.544111,epoch time: 0:26:19.493248,used: 10:19:17.904384,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98855346, 'precision': 0.9669417, 'recall': 0.84569836, 'specificity': 0.84569836, 'f1': 0.89665437, 'auroc': 0.993163, 'binary_precision': 0.94423443, 'binary_recall': 0.69278777, 'binary_specificity': 0.99860895, 'binary_f1_score': 0.79919994}
confusion matrix:
       0    1
0  42355   59
1    443  999
---- Validation: 
scalar performance:
{'acc': 0.98345786, 'precision': 0.94223154, 'recall': 0.80259025, 'specificity': 0.80259025, 'f1': 0.85832477, 'auroc': 0.97751766, 'binary_precision': 0.8989011, 'binary_recall': 0.6077266, 'binary_specificity': 0.9974539, 'binary_f1_score': 0.7251773}
confusion matrix:
       0    1
0  18021   46
1    264  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.84994835, 'recall': 0.6040874, 'specificity': 0.6040874, 'f1': 0.6548639, 'auroc': 0.95414567, 'binary_precision': 0.73333335, 'binary_recall': 0.21153846, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.32835823}
confusion matrix:
      0   1
0  5926  20
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_25.png
early stop counter: 9
val acc:0.9834578633308411, best validation acc: 0.9861259460449219, corresponding to test acc:                         0.961650013923645 / 0.969384491443634
after epoch: 25,now: 2024-06-09 23:31:23.516553,epoch time: 0:26:35.972442,used: 10:45:53.876826,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99065125, 'precision': 0.96470743, 'recall': 0.88262284, 'specificity': 0.88262284, 'f1': 0.9194062, 'auroc': 0.9936042, 'binary_precision': 0.93728817, 'binary_recall': 0.7669903, 'binary_specificity': 0.9982553, 'binary_f1_score': 0.8436308}
confusion matrix:
       0     1
0  42340    74
1    336  1106
---- Validation: 
scalar performance:
{'acc': 0.9857524, 'precision': 0.94935465, 'recall': 0.8331062, 'specificity': 0.8331062, 'f1': 0.8819277, 'auroc': 0.98066574, 'binary_precision': 0.91093117, 'binary_recall': 0.6686478, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.7712082}
confusion matrix:
       0    1
0  18023   44
1    223  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8244684, 'recall': 0.5697243, 'specificity': 0.5697243, 'f1': 0.6079154, 'auroc': 0.9470958, 'binary_precision': 0.6851852, 'binary_recall': 0.1423077, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.2356688}
confusion matrix:
      0   1
0  5929  17
1   223  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_26.png
early stop counter: 10
val acc:0.9857524037361145, best validation acc: 0.9861259460449219, corresponding to test acc:                         0.961650013923645 / 0.969384491443634
after epoch: 26,now: 2024-06-09 23:57:24.309883,epoch time: 0:26:00.793330,used: 11:11:54.670156,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99083364, 'precision': 0.95011955, 'recall': 0.90046954, 'specificity': 0.90046954, 'f1': 0.923738, 'auroc': 0.99272025, 'binary_precision': 0.90688574, 'binary_recall': 0.8037448, 'binary_specificity': 0.99719435, 'binary_f1_score': 0.8522058}
confusion matrix:
       0     1
0  42295   119
1    283  1159
---- Validation: 
scalar performance:
{'acc': 0.9866595, 'precision': 0.93614364, 'recall': 0.8607569, 'specificity': 0.8607569, 'f1': 0.89459455, 'auroc': 0.97809684, 'binary_precision': 0.88245934, 'binary_recall': 0.7251114, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.7960849}
confusion matrix:
       0    1
0  18002   65
1    185  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.84826654, 'recall': 0.5775848, 'specificity': 0.5775848, 'f1': 0.6200742, 'auroc': 0.9386581, 'binary_precision': 0.73214287, 'binary_recall': 0.15769231, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.25949368}
confusion matrix:
      0   1
0  5931  15
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_27.png
better model found
persisted
after epoch: 27,now: 2024-06-10 00:23:42.692558,epoch time: 0:26:18.382675,used: 11:38:13.052831,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9911073, 'precision': 0.9240428, 'recall': 0.93879557, 'specificity': 0.93879557, 'f1': 0.9312829, 'auroc': 0.9945066, 'binary_precision': 0.852075, 'binary_recall': 0.88280165, 'binary_specificity': 0.9947895, 'binary_f1_score': 0.86716616}
confusion matrix:
       0     1
0  42193   221
1    169  1273
---- Validation: 
scalar performance:
{'acc': 0.98569906, 'precision': 0.9081319, 'recall': 0.87885565, 'specificity': 0.87885565, 'f1': 0.8929016, 'auroc': 0.983184, 'binary_precision': 0.8250401, 'binary_recall': 0.7637444, 'binary_specificity': 0.9939669, 'binary_f1_score': 0.79320985}
confusion matrix:
       0    1
0  17958  109
1    159  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.83267736, 'recall': 0.6942088, 'specificity': 0.6942088, 'f1': 0.7433775, 'auroc': 0.9638828, 'binary_precision': 0.6912752, 'binary_recall': 0.39615384, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.5036675}
confusion matrix:
      0    1
0  5900   46
1   157  103
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_28.png
early stop counter: 1
val acc:0.9856990575790405, best validation acc: 0.9866595268249512, corresponding to test acc:                         0.9622945785522461 / 0.969384491443634
after epoch: 28,now: 2024-06-10 00:51:03.814084,epoch time: 0:27:21.121526,used: 12:05:34.174357,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9913809, 'precision': 0.9254446, 'recall': 0.9419516, 'specificity': 0.9419516, 'f1': 0.9335284, 'auroc': 0.9945702, 'binary_precision': 0.85466665, 'binary_recall': 0.889043, 'binary_specificity': 0.9948602, 'binary_f1_score': 0.871516}
confusion matrix:
       0     1
0  42196   218
1    160  1282
---- Validation: 
scalar performance:
{'acc': 0.98441833, 'precision': 0.8833097, 'recall': 0.89535785, 'specificity': 0.89535785, 'f1': 0.8892319, 'auroc': 0.9812931, 'binary_precision': 0.7741007, 'binary_recall': 0.79940563, 'binary_specificity': 0.9913101, 'binary_f1_score': 0.7865497}
confusion matrix:
       0    1
0  17910  157
1    135  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.8242128, 'recall': 0.6356025, 'specificity': 0.6356025, 'f1': 0.6875066, 'auroc': 0.95110404, 'binary_precision': 0.6792453, 'binary_recall': 0.2769231, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.3934426}
confusion matrix:
      0   1
0  5912  34
1   188  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_29.png
early stop counter: 2
val acc:0.9844183325767517, best validation acc: 0.9866595268249512, corresponding to test acc:                         0.9622945785522461 / 0.969384491443634
after epoch: 29,now: 2024-06-10 01:18:35.953088,epoch time: 0:27:32.139004,used: 12:33:06.313361,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9916317, 'precision': 0.93165743, 'recall': 0.93772686, 'specificity': 0.93772686, 'f1': 0.9346693, 'auroc': 0.9942029, 'binary_precision': 0.86739576, 'binary_recall': 0.8800277, 'binary_specificity': 0.99542606, 'binary_f1_score': 0.8736661}
confusion matrix:
       0     1
0  42220   194
1    173  1269
---- Validation: 
scalar performance:
{'acc': 0.98521876, 'precision': 0.90225524, 'recall': 0.87860656, 'specificity': 0.87860656, 'f1': 0.8900411, 'auroc': 0.97941685, 'binary_precision': 0.81329113, 'binary_recall': 0.7637444, 'binary_specificity': 0.99346876, 'binary_f1_score': 0.78773946}
confusion matrix:
       0    1
0  17949  118
1    159  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.7738968, 'recall': 0.57824653, 'specificity': 0.57824653, 'f1': 0.6162411, 'auroc': 0.94621825, 'binary_precision': 0.5833333, 'binary_recall': 0.16153847, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.25301206}
confusion matrix:
      0   1
0  5916  30
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_30.png
early stop counter: 3
val acc:0.9852187633514404, best validation acc: 0.9866595268249512, corresponding to test acc:                         0.9622945785522461 / 0.969384491443634
after epoch: 30,now: 2024-06-10 01:45:16.431434,epoch time: 0:26:40.478346,used: 12:59:46.791707,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_09_12_45_29_seed_1_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:59:46.791707 at 2024-06-10 01:45:16.431434
persisted model performance metric: 

scalar performance:
{'acc': 0.9639059, 'precision': 0.86170375, 'recall': 0.60049355, 'specificity': 0.60049355, 'f1': 0.6513361, 'auroc': 0.943957, 'binary_precision': 0.75714284, 'binary_recall': 0.20384616, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.3212121}
confusion matrix:
      0   1
0  5929  17
1   207  53
oracle model performance metric: 

scalar performance:
{'acc': 0.96793425, 'precision': 0.8684895, 'recall': 0.66696036, 'specificity': 0.66696036, 'f1': 0.7264005, 'auroc': 0.9515363, 'binary_precision': 0.76521736, 'binary_recall': 0.33846155, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.46933335}
confusion matrix:
      0   1
0  5919  27
1   172  88
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456207 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456207 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  13213 MiB |   2244 TiB |   2244 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   2217 TiB |   2217 TiB |
|       from small pool |  40676 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14486 MiB |  28078 MiB |  13604 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  27992 MiB |  13584 MiB |
|       from small pool |     66 MiB |     72 MiB |     86 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 444913 KiB |   1251 MiB |   1605 TiB |   1605 TiB |
|       from large pool | 435388 KiB |   1244 MiB |   1578 TiB |   1578 TiB |
|       from small pool |   9524 KiB |     43 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    6487    |  395837 K  |  395833 K  |
|       from large pool |     187    |    1413    |  205461 K  |  205461 K  |
|       from small pool |    3277    |    6298    |  190375 K  |  190372 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    6487    |  395837 K  |  395833 K  |
|       from large pool |     187    |    1413    |  205461 K  |  205461 K  |
|       from small pool |    3277    |    6298    |  190375 K  |  190372 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     637    |    1208    |     574    |
|       from large pool |     601    |     601    |    1165    |     564    |
|       from small pool |      33    |      36    |      43    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    2810    |  249150 K  |  249150 K  |
|       from large pool |      40    |     604    |  149049 K  |  149049 K  |
|       from small pool |      40    |    2768    |  100101 K  |  100101 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2244 TiB |   2244 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2217 TiB |   2217 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14486 MiB |  28078 MiB |  27198 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     50 MiB |     72 MiB |     86 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1605 TiB |   1605 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   1578 TiB |   1578 TiB |
|       from small pool |      0 KiB |     43 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395837 K  |  395837 K  |
|       from large pool |       2    |    1413    |  205461 K  |  205461 K  |
|       from small pool |       0    |    6298    |  190375 K  |  190375 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395837 K  |  395837 K  |
|       from large pool |       2    |    1413    |  205461 K  |  205461 K  |
|       from small pool |       0    |    6298    |  190375 K  |  190375 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    1208    |    1146    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      25    |      36    |      43    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2810    |  249151 K  |  249151 K  |
|       from large pool |       4    |     604    |  149049 K  |  149049 K  |
|       from small pool |       0    |    2768    |  100102 K  |  100102 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2244 TiB |   2244 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2217 TiB |   2217 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14486 MiB |  28078 MiB |  27198 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     50 MiB |     72 MiB |     86 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1605 TiB |   1605 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   1578 TiB |   1578 TiB |
|       from small pool |      0 KiB |     43 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395837 K  |  395837 K  |
|       from large pool |       2    |    1413    |  205461 K  |  205461 K  |
|       from small pool |       0    |    6298    |  190375 K  |  190375 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395837 K  |  395837 K  |
|       from large pool |       2    |    1413    |  205461 K  |  205461 K  |
|       from small pool |       0    |    6298    |  190375 K  |  190375 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    1208    |    1146    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      25    |      36    |      43    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2810    |  249151 K  |  249151 K  |
|       from large pool |       4    |     604    |  149049 K  |  149049 K  |
|       from small pool |       0    |    2768    |  100102 K  |  100102 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156

 Experiment start at: 2024-06-10 01:59:01.497528
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7679115533828735
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9706553, 'precision': 0.78212976, 'recall': 0.76302123, 'specificity': 0.76302123, 'f1': 0.77220553, 'auroc': 0.9521127, 'binary_precision': 0.5806681, 'binary_recall': 0.5399868, 'binary_specificity': 0.9860556, 'binary_f1_score': 0.5595891}
confusion matrix:
       0    1
0  41721  590
1    696  817
---- Validation: 
scalar performance:
{'acc': 0.9691046, 'precision': 0.75115186, 'recall': 0.78247535, 'specificity': 0.78247535, 'f1': 0.76579404, 'auroc': 0.94046485, 'binary_precision': 0.51617646, 'binary_recall': 0.58305645, 'binary_specificity': 0.98189425, 'binary_f1_score': 0.54758185}
confusion matrix:
       0    1
0  17842  329
1    251  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9711492, 'precision': 0.8506814, 'recall': 0.7034433, 'specificity': 0.7034433, 'f1': 0.75571865, 'auroc': 0.92354715, 'binary_precision': 0.7246377, 'binary_recall': 0.41322315, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.52631587}
confusion matrix:
      0    1
0  5959   38
1   142  100
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-10 02:30:25.577460,epoch time: 0:31:24.079932,used: 0:31:24.079932,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97067815, 'precision': 0.77990973, 'recall': 0.7815149, 'specificity': 0.7815149, 'f1': 0.78070974, 'auroc': 0.9611844, 'binary_precision': 0.57490146, 'binary_recall': 0.5783212, 'binary_specificity': 0.9847085, 'binary_f1_score': 0.5766063}
confusion matrix:
       0    1
0  41664  647
1    638  875
---- Validation: 
scalar performance:
{'acc': 0.9698503, 'precision': 0.7613933, 'recall': 0.68247956, 'specificity': 0.68247956, 'f1': 0.71425647, 'auroc': 0.94328463, 'binary_precision': 0.5432692, 'binary_recall': 0.3754153, 'binary_specificity': 0.9895438, 'binary_f1_score': 0.44400787}
confusion matrix:
       0    1
0  17981  190
1    376  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9735535, 'precision': 0.9399363, 'recall': 0.67693555, 'specificity': 0.67693555, 'f1': 0.7483977, 'auroc': 0.9454605, 'binary_precision': 0.9052632, 'binary_recall': 0.3553719, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.51038575}
confusion matrix:
      0   1
0  5988   9
1   156  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-10 03:03:18.465334,epoch time: 0:32:52.887874,used: 1:04:16.967806,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9753103, 'precision': 0.8599777, 'recall': 0.7169968, 'specificity': 0.7169968, 'f1': 0.7693577, 'auroc': 0.9697499, 'binary_precision': 0.7397108, 'binary_recall': 0.4395241, 'binary_specificity': 0.9944695, 'binary_f1_score': 0.5514096}
confusion matrix:
       0    1
0  42077  234
1    848  665
---- Validation: 
scalar performance:
{'acc': 0.9745912, 'precision': 0.8967593, 'recall': 0.63273036, 'specificity': 0.63273036, 'f1': 0.69501156, 'auroc': 0.9574268, 'binary_precision': 0.8172589, 'binary_recall': 0.26744187, 'binary_specificity': 0.9980188, 'binary_f1_score': 0.40300375}
confusion matrix:
       0    1
0  18135   36
1    441  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97371376, 'precision': 0.940509, 'recall': 0.6790017, 'specificity': 0.6790017, 'f1': 0.75064194, 'auroc': 0.9428075, 'binary_precision': 0.90625, 'binary_recall': 0.35950413, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.5147929}
confusion matrix:
      0   1
0  5988   9
1   155  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-10 03:36:29.873269,epoch time: 0:33:11.407935,used: 1:37:28.375741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97448885, 'precision': 0.79659534, 'recall': 0.87812793, 'specificity': 0.87812793, 'f1': 0.8318926, 'auroc': 0.97358334, 'binary_precision': 0.60133404, 'binary_recall': 0.77461994, 'binary_specificity': 0.981636, 'binary_f1_score': 0.6770653}
confusion matrix:
       0     1
0  41534   777
1    341  1172
---- Validation: 
scalar performance:
{'acc': 0.9757631, 'precision': 0.8017491, 'recall': 0.8196429, 'specificity': 0.8196429, 'f1': 0.8104137, 'auroc': 0.9623612, 'binary_precision': 0.6150235, 'binary_recall': 0.6528239, 'binary_specificity': 0.98646194, 'binary_f1_score': 0.6333602}
confusion matrix:
       0    1
0  17925  246
1    209  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9777208, 'precision': 0.8683177, 'recall': 0.8139297, 'specificity': 0.8139297, 'f1': 0.83874226, 'auroc': 0.94912887, 'binary_precision': 0.7512195, 'binary_recall': 0.6363636, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.68903804}
confusion matrix:
      0    1
0  5946   51
1    88  154
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-10 04:09:40.639286,epoch time: 0:33:10.766017,used: 2:10:39.141758,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9781855, 'precision': 0.85078263, 'recall': 0.80133533, 'specificity': 0.80133533, 'f1': 0.8240167, 'auroc': 0.97266376, 'binary_precision': 0.71539056, 'binary_recall': 0.6113681, 'binary_specificity': 0.9913025, 'binary_f1_score': 0.6593015}
confusion matrix:
       0    1
0  41943  368
1    588  925
---- Validation: 
scalar performance:
{'acc': 0.97816014, 'precision': 0.83623135, 'recall': 0.7895623, 'specificity': 0.7895623, 'f1': 0.8110093, 'auroc': 0.9595244, 'binary_precision': 0.68604654, 'binary_recall': 0.5880399, 'binary_specificity': 0.9910847, 'binary_f1_score': 0.63327366}
confusion matrix:
       0    1
0  18009  162
1    248  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.76963097, 'recall': 0.66416883, 'specificity': 0.66416883, 'f1': 0.7026646, 'auroc': 0.93874484, 'binary_precision': 0.56551725, 'binary_recall': 0.338843, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.42377263}
confusion matrix:
      0   1
0  5934  63
1   160  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_5.png
better model found
persisted
after epoch: 5,now: 2024-06-10 04:41:00.151328,epoch time: 0:31:19.512042,used: 2:41:58.653800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9801935, 'precision': 0.84486264, 'recall': 0.8689735, 'specificity': 0.8689735, 'f1': 0.8564718, 'auroc': 0.9798124, 'binary_precision': 0.6987061, 'binary_recall': 0.74950427, 'binary_specificity': 0.9884427, 'binary_f1_score': 0.72321427}
confusion matrix:
       0     1
0  41822   489
1    379  1134
---- Validation: 
scalar performance:
{'acc': 0.9811964, 'precision': 0.8593879, 'recall': 0.8240557, 'specificity': 0.8240557, 'f1': 0.8407333, 'auroc': 0.96312654, 'binary_precision': 0.73012936, 'binary_recall': 0.65614617, 'binary_specificity': 0.99196523, 'binary_f1_score': 0.6911636}
confusion matrix:
       0    1
0  18025  146
1    207  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9730726, 'precision': 0.85672843, 'recall': 0.73616767, 'specificity': 0.73616767, 'f1': 0.7830452, 'auroc': 0.94705653, 'binary_precision': 0.73417723, 'binary_recall': 0.47933885, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.58}
confusion matrix:
      0    1
0  5955   42
1   126  116
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_6.png
better model found
persisted
after epoch: 6,now: 2024-06-10 05:10:55.540283,epoch time: 0:29:55.388955,used: 3:11:54.042755,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9805814, 'precision': 0.92818916, 'recall': 0.7544597, 'specificity': 0.7544597, 'f1': 0.81764317, 'auroc': 0.9817213, 'binary_precision': 0.87358916, 'binary_recall': 0.5115664, 'binary_specificity': 0.99735296, 'binary_f1_score': 0.6452688}
confusion matrix:
       0    1
0  42199  112
1    739  774
---- Validation: 
scalar performance:
{'acc': 0.97805357, 'precision': 0.9514061, 'recall': 0.67145914, 'specificity': 0.67145914, 'f1': 0.7449953, 'auroc': 0.9674989, 'binary_precision': 0.92410713, 'binary_recall': 0.34385383, 'binary_specificity': 0.99906445, 'binary_f1_score': 0.50121063}
confusion matrix:
       0    1
0  18154   17
1    395  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96842444, 'precision': 0.9390215, 'recall': 0.60288894, 'specificity': 0.60288894, 'f1': 0.6602638, 'auroc': 0.9503836, 'binary_precision': 0.90909094, 'binary_recall': 0.20661157, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.33670035}
confusion matrix:
      0   1
0  5992   5
1   192  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_7.png
early stop counter: 1
val acc:0.9780535697937012, best validation acc: 0.981196403503418, corresponding to test acc:                         0.9730725884437561 / 0.9777207970619202
after epoch: 7,now: 2024-06-10 05:43:59.581026,epoch time: 0:33:04.040743,used: 3:44:58.083498,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9819505, 'precision': 0.9360779, 'recall': 0.77173865, 'specificity': 0.77173865, 'f1': 0.8334671, 'auroc': 0.98232, 'binary_precision': 0.88817203, 'binary_recall': 0.5459352, 'binary_specificity': 0.997542, 'binary_f1_score': 0.67621773}
confusion matrix:
       0    1
0  42207  104
1    687  826
---- Validation: 
scalar performance:
{'acc': 0.98093003, 'precision': 0.9252213, 'recall': 0.7379919, 'specificity': 0.7379919, 'f1': 0.80346215, 'auroc': 0.9644182, 'binary_precision': 0.8674699, 'binary_recall': 0.47840533, 'binary_specificity': 0.99757856, 'binary_f1_score': 0.6167024}
confusion matrix:
       0    1
0  18127   44
1    314  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.8609921, 'recall': 0.5754458, 'specificity': 0.5754458, 'f1': 0.6182448, 'auroc': 0.9377685, 'binary_precision': 0.75510204, 'binary_recall': 0.15289256, 'binary_specificity': 0.997999, 'binary_f1_score': 0.25429553}
confusion matrix:
      0   1
0  5985  12
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_8.png
early stop counter: 2
val acc:0.9809300303459167, best validation acc: 0.981196403503418, corresponding to test acc:                         0.9730725884437561 / 0.9777207970619202
after epoch: 8,now: 2024-06-10 06:16:42.233870,epoch time: 0:32:42.652844,used: 4:17:40.736342,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.983274, 'precision': 0.86284053, 'recall': 0.90084076, 'specificity': 0.90084076, 'f1': 0.8808062, 'auroc': 0.98274803, 'binary_precision': 0.73241955, 'binary_recall': 0.81229347, 'binary_specificity': 0.9893881, 'binary_f1_score': 0.7702914}
confusion matrix:
       0     1
0  41862   449
1    284  1229
---- Validation: 
scalar performance:
{'acc': 0.9828477, 'precision': 0.8712767, 'recall': 0.8425758, 'specificity': 0.8425758, 'f1': 0.8563024, 'auroc': 0.9704741, 'binary_precision': 0.7527076, 'binary_recall': 0.692691, 'binary_specificity': 0.9924605, 'binary_f1_score': 0.7214533}
confusion matrix:
       0    1
0  18034  137
1    185  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.8300357, 'recall': 0.62171584, 'specificity': 0.62171584, 'f1': 0.6737693, 'auroc': 0.9425663, 'binary_precision': 0.6896552, 'binary_recall': 0.24793388, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.36474165}
confusion matrix:
      0   1
0  5970  27
1   182  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_9.png
better model found
persisted
after epoch: 9,now: 2024-06-10 06:46:51.216287,epoch time: 0:30:08.982417,used: 4:47:49.718759,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9847344, 'precision': 0.88125455, 'recall': 0.89363074, 'specificity': 0.89363074, 'f1': 0.88733494, 'auroc': 0.9859636, 'binary_precision': 0.769821, 'binary_recall': 0.79577, 'binary_specificity': 0.99149156, 'binary_f1_score': 0.78258044}
confusion matrix:
       0     1
0  41951   360
1    309  1204
---- Validation: 
scalar performance:
{'acc': 0.9833271, 'precision': 0.8896544, 'recall': 0.8235502, 'specificity': 0.8235502, 'f1': 0.8533039, 'auroc': 0.97425604, 'binary_precision': 0.7907445, 'binary_recall': 0.6528239, 'binary_specificity': 0.9942766, 'binary_f1_score': 0.71519566}
confusion matrix:
       0    1
0  18067  104
1    209  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.73936665, 'recall': 0.61714846, 'specificity': 0.61714846, 'f1': 0.6549035, 'auroc': 0.9376064, 'binary_precision': 0.5086207, 'binary_recall': 0.24380165, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.32960895}
confusion matrix:
      0   1
0  5940  57
1   183  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_10.png
better model found
persisted
after epoch: 10,now: 2024-06-10 07:14:29.189538,epoch time: 0:27:37.973251,used: 5:15:27.692010,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98466593, 'precision': 0.92753243, 'recall': 0.82635975, 'specificity': 0.82635975, 'f1': 0.8696358, 'auroc': 0.98622024, 'binary_precision': 0.8672489, 'binary_recall': 0.656312, 'binary_specificity': 0.99640757, 'binary_f1_score': 0.7471784}
confusion matrix:
       0    1
0  42159  152
1    520  993
---- Validation: 
scalar performance:
{'acc': 0.9816758, 'precision': 0.91929406, 'recall': 0.75684726, 'specificity': 0.75684726, 'f1': 0.8172441, 'auroc': 0.9689935, 'binary_precision': 0.8543956, 'binary_recall': 0.5166113, 'binary_specificity': 0.99708325, 'binary_f1_score': 0.6438923}
confusion matrix:
       0    1
0  18118   53
1    291  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.8567495, 'recall': 0.53057486, 'specificity': 0.53057486, 'f1': 0.5477562, 'auroc': 0.91762185, 'binary_precision': 0.75, 'binary_recall': 0.06198347, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.114503816}
confusion matrix:
      0   1
0  5992   5
1   227  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_11.png
early stop counter: 1
val acc:0.9816758036613464, best validation acc: 0.9833270907402039, corresponding to test acc:                         0.9615322947502136 / 0.9777207970619202
after epoch: 11,now: 2024-06-10 07:42:56.188207,epoch time: 0:28:26.998669,used: 5:43:54.690679,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9856928, 'precision': 0.90050346, 'recall': 0.8797878, 'specificity': 0.8797878, 'f1': 0.8898472, 'auroc': 0.9872471, 'binary_precision': 0.8093575, 'binary_recall': 0.76602775, 'binary_specificity': 0.9935478, 'binary_f1_score': 0.78709674}
confusion matrix:
       0     1
0  42038   273
1    354  1159
---- Validation: 
scalar performance:
{'acc': 0.98423266, 'precision': 0.9207314, 'recall': 0.80474484, 'specificity': 0.80474484, 'f1': 0.8528131, 'auroc': 0.9692669, 'binary_precision': 0.8541667, 'binary_recall': 0.6129568, 'binary_specificity': 0.9965329, 'binary_f1_score': 0.71373314}
confusion matrix:
       0    1
0  18108   63
1    233  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.7896869, 'recall': 0.582543, 'specificity': 0.582543, 'f1': 0.62335914, 'auroc': 0.9437055, 'binary_precision': 0.6119403, 'binary_recall': 0.1694215, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.2653722}
confusion matrix:
      0   1
0  5971  26
1   201  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_12.png
better model found
persisted
after epoch: 12,now: 2024-06-10 08:08:51.823661,epoch time: 0:25:55.635454,used: 6:09:50.326133,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98589814, 'precision': 0.91364145, 'recall': 0.8649175, 'specificity': 0.8649175, 'f1': 0.88763016, 'auroc': 0.9884671, 'binary_precision': 0.83671933, 'binary_recall': 0.73496366, 'binary_specificity': 0.9948713, 'binary_f1_score': 0.78254753}
confusion matrix:
       0     1
0  42094   217
1    401  1112
---- Validation: 
scalar performance:
{'acc': 0.9833804, 'precision': 0.9068777, 'recall': 0.8026985, 'specificity': 0.8026985, 'f1': 0.84658647, 'auroc': 0.9738409, 'binary_precision': 0.8265766, 'binary_recall': 0.6096346, 'binary_specificity': 0.99576247, 'binary_f1_score': 0.70172083}
confusion matrix:
       0    1
0  18094   77
1    235  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.7382692, 'recall': 0.5417209, 'specificity': 0.5417209, 'f1': 0.56432384, 'auroc': 0.9370786, 'binary_precision': 0.5121951, 'binary_recall': 0.08677686, 'binary_specificity': 0.996665, 'binary_f1_score': 0.1484099}
confusion matrix:
      0   1
0  5977  20
1   221  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_13.png
early stop counter: 1
val acc:0.9833803772926331, best validation acc: 0.9842326641082764, corresponding to test acc:                         0.9636159539222717 / 0.9777207970619202
after epoch: 13,now: 2024-06-10 08:39:37.282372,epoch time: 0:30:45.458711,used: 6:40:35.784844,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9863089, 'precision': 0.8878937, 'recall': 0.9145212, 'specificity': 0.9145212, 'f1': 0.90072596, 'auroc': 0.99065703, 'binary_precision': 0.7816163, 'binary_recall': 0.83740914, 'binary_specificity': 0.99163336, 'binary_f1_score': 0.8085514}
confusion matrix:
       0     1
0  41957   354
1    246  1267
---- Validation: 
scalar performance:
{'acc': 0.98481864, 'precision': 0.8800248, 'recall': 0.87330663, 'specificity': 0.87330663, 'f1': 0.87663335, 'auroc': 0.97566664, 'binary_precision': 0.7681895, 'binary_recall': 0.75415283, 'binary_specificity': 0.9924605, 'binary_f1_score': 0.7611065}
confusion matrix:
       0    1
0  18034  137
1    148  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663408, 'precision': 0.8052468, 'recall': 0.6493908, 'specificity': 0.6493908, 'f1': 0.69804054, 'auroc': 0.9441961, 'binary_precision': 0.63793105, 'binary_recall': 0.30578512, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.4134078}
confusion matrix:
      0   1
0  5955  42
1   168  74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_14.png
better model found
persisted
after epoch: 14,now: 2024-06-10 09:06:39.714591,epoch time: 0:27:02.432219,used: 7:07:38.217063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9857384, 'precision': 0.885242, 'recall': 0.9075341, 'specificity': 0.9075341, 'f1': 0.89604646, 'auroc': 0.98934984, 'binary_precision': 0.77680796, 'binary_recall': 0.8235294, 'binary_specificity': 0.9915388, 'binary_f1_score': 0.79948664}
confusion matrix:
       0     1
0  41953   358
1    267  1246
---- Validation: 
scalar performance:
{'acc': 0.98359346, 'precision': 0.87178093, 'recall': 0.859825, 'specificity': 0.859825, 'f1': 0.86569726, 'auroc': 0.9758208, 'binary_precision': 0.7525773, 'binary_recall': 0.72757477, 'binary_specificity': 0.99207526, 'binary_f1_score': 0.7398649}
confusion matrix:
       0    1
0  18027  144
1    164  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.7737648, 'recall': 0.62831277, 'specificity': 0.62831277, 'f1': 0.6720247, 'auroc': 0.9354793, 'binary_precision': 0.5765766, 'binary_recall': 0.2644628, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.36260623}
confusion matrix:
      0   1
0  5950  47
1   178  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_15.png
early stop counter: 1
val acc:0.9835934638977051, best validation acc: 0.9848186373710632, corresponding to test acc:                         0.9663407802581787 / 0.9777207970619202
after epoch: 15,now: 2024-06-10 09:36:04.252599,epoch time: 0:29:24.538008,used: 7:37:02.755071,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9880659, 'precision': 0.9264833, 'recall': 0.8880271, 'specificity': 0.8880271, 'f1': 0.9062737, 'auroc': 0.9916373, 'binary_precision': 0.86078715, 'binary_recall': 0.7805684, 'binary_specificity': 0.9954858, 'binary_f1_score': 0.81871754}
confusion matrix:
       0     1
0  42120   191
1    332  1181
---- Validation: 
scalar performance:
{'acc': 0.98396635, 'precision': 0.90719783, 'recall': 0.81424385, 'specificity': 0.81424385, 'f1': 0.8542943, 'auroc': 0.9753166, 'binary_precision': 0.82646424, 'binary_recall': 0.63289034, 'binary_specificity': 0.99559736, 'binary_f1_score': 0.7168391}
confusion matrix:
       0    1
0  18091   80
1    221  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.7949146, 'recall': 0.5927068, 'specificity': 0.5927068, 'f1': 0.6363606, 'auroc': 0.92204714, 'binary_precision': 0.6216216, 'binary_recall': 0.19008264, 'binary_specificity': 0.995331, 'binary_f1_score': 0.29113922}
confusion matrix:
      0   1
0  5969  28
1   196  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_16.png
early stop counter: 2
val acc:0.9839663505554199, best validation acc: 0.9848186373710632, corresponding to test acc:                         0.9663407802581787 / 0.9777207970619202
after epoch: 16,now: 2024-06-10 10:11:17.489082,epoch time: 0:35:13.236483,used: 8:12:15.991554,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9885907, 'precision': 0.93016845, 'recall': 0.89276004, 'specificity': 0.89276004, 'f1': 0.91054523, 'auroc': 0.9912055, 'binary_precision': 0.8678286, 'binary_recall': 0.78982157, 'binary_specificity': 0.9956985, 'binary_f1_score': 0.8269896}
confusion matrix:
       0     1
0  42129   182
1    318  1195
---- Validation: 
scalar performance:
{'acc': 0.9841794, 'precision': 0.8967501, 'recall': 0.832021, 'specificity': 0.832021, 'f1': 0.86129236, 'auroc': 0.9721055, 'binary_precision': 0.8043912, 'binary_recall': 0.6694352, 'binary_specificity': 0.9946068, 'binary_f1_score': 0.73073435}
confusion matrix:
       0    1
0  18073   98
1    199  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.8085903, 'recall': 0.5970058, 'specificity': 0.5970058, 'f1': 0.6428542, 'auroc': 0.9266973, 'binary_precision': 0.6486486, 'binary_recall': 0.1983471, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.30379748}
confusion matrix:
      0   1
0  5971  26
1   194  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_17.png
early stop counter: 3
val acc:0.9841793775558472, best validation acc: 0.9848186373710632, corresponding to test acc:                         0.9663407802581787 / 0.9777207970619202
after epoch: 17,now: 2024-06-10 10:40:24.008121,epoch time: 0:29:06.519039,used: 8:41:22.510593,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9875639, 'precision': 0.939154, 'recall': 0.8645055, 'specificity': 0.8645055, 'f1': 0.8980937, 'auroc': 0.9912081, 'binary_precision': 0.88782054, 'binary_recall': 0.7323199, 'binary_specificity': 0.99669117, 'binary_f1_score': 0.8026078}
confusion matrix:
       0     1
0  42171   140
1    405  1108
---- Validation: 
scalar performance:
{'acc': 0.9825281, 'precision': 0.9054017, 'recall': 0.7870003, 'specificity': 0.7870003, 'f1': 0.8353533, 'auroc': 0.9700412, 'binary_precision': 0.82464457, 'binary_recall': 0.5780731, 'binary_specificity': 0.9959276, 'binary_f1_score': 0.67968756}
confusion matrix:
       0    1
0  18097   74
1    254  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.82805234, 'recall': 0.5588335, 'specificity': 0.5588335, 'f1': 0.5928458, 'auroc': 0.9280728, 'binary_precision': 0.6904762, 'binary_recall': 0.11983471, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.20422536}
confusion matrix:
      0   1
0  5984  13
1   213  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_18.png
early stop counter: 4
val acc:0.9825280904769897, best validation acc: 0.9848186373710632, corresponding to test acc:                         0.9663407802581787 / 0.9777207970619202
after epoch: 18,now: 2024-06-10 11:08:44.639801,epoch time: 0:28:20.631680,used: 9:09:43.142273,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9889102, 'precision': 0.93952835, 'recall': 0.88718975, 'specificity': 0.88718975, 'f1': 0.9115714, 'auroc': 0.99320513, 'binary_precision': 0.88696307, 'binary_recall': 0.77792466, 'binary_specificity': 0.99645483, 'binary_f1_score': 0.8288733}
confusion matrix:
       0     1
0  42161   150
1    336  1177
---- Validation: 
scalar performance:
{'acc': 0.98492515, 'precision': 0.8969727, 'recall': 0.8476641, 'specificity': 0.8476641, 'f1': 0.87056005, 'auroc': 0.97333133, 'binary_precision': 0.8038095, 'binary_recall': 0.7009967, 'binary_specificity': 0.9943316, 'binary_f1_score': 0.7488908}
confusion matrix:
       0    1
0  18068  103
1    180  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.8788035, 'recall': 0.59197474, 'specificity': 0.59197474, 'f1': 0.64192134, 'auroc': 0.94384396, 'binary_precision': 0.7894737, 'binary_recall': 0.18595041, 'binary_specificity': 0.997999, 'binary_f1_score': 0.30100334}
confusion matrix:
      0   1
0  5985  12
1   197  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_19.png
better model found
persisted
after epoch: 19,now: 2024-06-10 11:40:24.322635,epoch time: 0:31:39.682834,used: 9:41:22.825107,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98763233, 'precision': 0.90448856, 'recall': 0.91170144, 'specificity': 0.91170144, 'f1': 0.90806043, 'auroc': 0.9923899, 'binary_precision': 0.81505513, 'binary_recall': 0.8301388, 'binary_specificity': 0.99326414, 'binary_f1_score': 0.8225279}
confusion matrix:
       0     1
0  42026   285
1    257  1256
---- Validation: 
scalar performance:
{'acc': 0.98364675, 'precision': 0.88321424, 'recall': 0.8405794, 'specificity': 0.8405794, 'f1': 0.86054194, 'auroc': 0.97032696, 'binary_precision': 0.7767355, 'binary_recall': 0.68770766, 'binary_specificity': 0.9934511, 'binary_f1_score': 0.7295154}
confusion matrix:
       0    1
0  18052  119
1    188  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.81980985, 'recall': 0.5708967, 'specificity': 0.5708967, 'f1': 0.60985523, 'auroc': 0.914907, 'binary_precision': 0.6730769, 'binary_recall': 0.1446281, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.23809522}
confusion matrix:
      0   1
0  5980  17
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_20.png
early stop counter: 1
val acc:0.9836467504501343, best validation acc: 0.9849251508712769, corresponding to test acc:                         0.9665010571479797 / 0.9777207970619202
after epoch: 20,now: 2024-06-10 12:11:03.537225,epoch time: 0:30:39.214590,used: 10:12:02.039697,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9890927, 'precision': 0.91463363, 'recall': 0.9236106, 'specificity': 0.9236106, 'f1': 0.91906995, 'auroc': 0.9922013, 'binary_precision': 0.83451843, 'binary_recall': 0.85327166, 'binary_specificity': 0.9939496, 'binary_f1_score': 0.8437908}
confusion matrix:
       0     1
0  42055   256
1    222  1291
---- Validation: 
scalar performance:
{'acc': 0.98529804, 'precision': 0.8962915, 'recall': 0.8566903, 'specificity': 0.8566903, 'f1': 0.8753686, 'auroc': 0.97426987, 'binary_precision': 0.80185187, 'binary_recall': 0.7192691, 'binary_specificity': 0.9941115, 'binary_f1_score': 0.7583187}
confusion matrix:
       0    1
0  18064  107
1    169  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.82740545, 'recall': 0.59329045, 'specificity': 0.59329045, 'f1': 0.6399512, 'auroc': 0.908545, 'binary_precision': 0.6865672, 'binary_recall': 0.19008264, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.29773462}
confusion matrix:
      0   1
0  5976  21
1   196  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_21.png
better model found
persisted
after epoch: 21,now: 2024-06-10 12:40:10.913368,epoch time: 0:29:07.376143,used: 10:41:09.415840,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9887733, 'precision': 0.9142783, 'recall': 0.9179759, 'specificity': 0.9179759, 'f1': 0.9161182, 'auroc': 0.9937155, 'binary_precision': 0.83420706, 'binary_recall': 0.8419312, 'binary_specificity': 0.9940206, 'binary_f1_score': 0.8380513}
confusion matrix:
       0     1
0  42059   253
1    239  1273
---- Validation: 
scalar performance:
{'acc': 0.98460555, 'precision': 0.8883345, 'recall': 0.85392344, 'specificity': 0.85392344, 'f1': 0.8702684, 'auroc': 0.9716478, 'binary_precision': 0.78610605, 'binary_recall': 0.71428573, 'binary_specificity': 0.99356115, 'binary_f1_score': 0.74847704}
confusion matrix:
       0    1
0  18054  117
1    172  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9681039, 'precision': 0.8538996, 'recall': 0.6364288, 'specificity': 0.6364288, 'f1': 0.69300854, 'auroc': 0.94071484, 'binary_precision': 0.73626375, 'binary_recall': 0.2768595, 'binary_specificity': 0.995998, 'binary_f1_score': 0.4024024}
confusion matrix:
      0   1
0  5973  24
1   175  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_22.png
early stop counter: 1
val acc:0.9846055507659912, best validation acc: 0.9852980375289917, corresponding to test acc:                         0.9652187824249268 / 0.9777207970619202
after epoch: 22,now: 2024-06-10 13:08:37.520104,epoch time: 0:28:26.606736,used: 11:09:36.022576,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9872444, 'precision': 0.88007534, 'recall': 0.9519694, 'specificity': 0.9519694, 'f1': 0.9126252, 'auroc': 0.99378633, 'binary_precision': 0.76324505, 'binary_recall': 0.914078, 'binary_specificity': 0.9898608, 'binary_f1_score': 0.8318797}
confusion matrix:
       0     1
0  41882   429
1    130  1383
---- Validation: 
scalar performance:
{'acc': 0.9831673, 'precision': 0.84808254, 'recall': 0.9069847, 'specificity': 0.9069847, 'f1': 0.87502897, 'auroc': 0.9725596, 'binary_precision': 0.7019774, 'binary_recall': 0.8255814, 'binary_specificity': 0.98838806, 'binary_f1_score': 0.7587785}
confusion matrix:
       0    1
0  17960  211
1    105  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.7929155, 'recall': 0.6469912, 'specificity': 0.6469912, 'f1': 0.69334424, 'auroc': 0.94023454, 'binary_precision': 0.6134454, 'binary_recall': 0.30165288, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.4044321}
confusion matrix:
      0   1
0  5951  46
1   169  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_23.png
early stop counter: 2
val acc:0.983167290687561, best validation acc: 0.9852980375289917, corresponding to test acc:                         0.9652187824249268 / 0.9777207970619202
after epoch: 23,now: 2024-06-10 13:38:02.138123,epoch time: 0:29:24.618019,used: 11:39:00.640595,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9898229, 'precision': 0.91729647, 'recall': 0.9332297, 'specificity': 0.9332297, 'f1': 0.92510104, 'auroc': 0.99389696, 'binary_precision': 0.83916086, 'binary_recall': 0.87243885, 'binary_specificity': 0.99402046, 'binary_f1_score': 0.8554763}
confusion matrix:
       0     1
0  42058   253
1    193  1320
---- Validation: 
scalar performance:
{'acc': 0.98380655, 'precision': 0.86586326, 'recall': 0.87760216, 'specificity': 0.87760216, 'f1': 0.8716322, 'auroc': 0.97239685, 'binary_precision': 0.7395498, 'binary_recall': 0.7641196, 'binary_specificity': 0.9910847, 'binary_f1_score': 0.751634}
confusion matrix:
       0    1
0  18009  162
1    142  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96906555, 'precision': 0.8651128, 'recall': 0.6468427, 'specificity': 0.6468427, 'f1': 0.7057016, 'auroc': 0.92754215, 'binary_precision': 0.75789475, 'binary_recall': 0.29752067, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.4272997}
confusion matrix:
      0   1
0  5974  23
1   170  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_24.png
early stop counter: 3
val acc:0.9838065505027771, best validation acc: 0.9852980375289917, corresponding to test acc:                         0.9652187824249268 / 0.9777207970619202
after epoch: 24,now: 2024-06-10 14:06:04.391000,epoch time: 0:28:02.252877,used: 12:07:02.893472,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99059874, 'precision': 0.92767894, 'recall': 0.9320382, 'specificity': 0.9320382, 'f1': 0.9298465, 'auroc': 0.9951863, 'binary_precision': 0.86003923, 'binary_recall': 0.8691342, 'binary_specificity': 0.9949422, 'binary_f1_score': 0.8645628}
confusion matrix:
       0     1
0  42097   214
1    198  1315
---- Validation: 
scalar performance:
{'acc': 0.98513824, 'precision': 0.88858163, 'recall': 0.8654413, 'specificity': 0.8654413, 'f1': 0.8766281, 'auroc': 0.9719124, 'binary_precision': 0.7858407, 'binary_recall': 0.73754156, 'binary_specificity': 0.993341, 'binary_f1_score': 0.7609255}
confusion matrix:
       0    1
0  18050  121
1    158  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.8082658, 'recall': 0.6252644, 'specificity': 0.6252644, 'f1': 0.6746181, 'auroc': 0.93825185, 'binary_precision': 0.6458333, 'binary_recall': 0.25619835, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.36686388}
confusion matrix:
      0   1
0  5963  34
1   180  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_25.png
early stop counter: 4
val acc:0.9851382374763489, best validation acc: 0.9852980375289917, corresponding to test acc:                         0.9652187824249268 / 0.9777207970619202
after epoch: 25,now: 2024-06-10 14:35:45.956193,epoch time: 0:29:41.565193,used: 12:36:44.458665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9910095, 'precision': 0.9687362, 'recall': 0.8917821, 'specificity': 0.8917821, 'f1': 0.9265599, 'auroc': 0.9953108, 'binary_precision': 0.9451074, 'binary_recall': 0.785195, 'binary_specificity': 0.9983692, 'binary_f1_score': 0.8577618}
confusion matrix:
       0     1
0  42242    69
1    325  1188
---- Validation: 
scalar performance:
{'acc': 0.9855111, 'precision': 0.91788125, 'recall': 0.8327089, 'specificity': 0.8327089, 'f1': 0.8701111, 'auroc': 0.9741419, 'binary_precision': 0.8466387, 'binary_recall': 0.6694352, 'binary_specificity': 0.9959826, 'binary_f1_score': 0.74768084}
confusion matrix:
       0    1
0  18098   73
1    199  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.8579005, 'recall': 0.5611497, 'specificity': 0.5611497, 'f1': 0.59728163, 'auroc': 0.91641307, 'binary_precision': 0.75, 'binary_recall': 0.12396694, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.21276596}
confusion matrix:
      0   1
0  5987  10
1   212  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_26.png
better model found
persisted
after epoch: 26,now: 2024-06-10 15:08:24.166728,epoch time: 0:32:38.210535,used: 13:09:22.669200,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9905075, 'precision': 0.9161885, 'recall': 0.94792354, 'specificity': 0.94792354, 'f1': 0.9314228, 'auroc': 0.99536276, 'binary_precision': 0.83588487, 'binary_recall': 0.9021811, 'binary_specificity': 0.99366593, 'binary_f1_score': 0.8677686}
confusion matrix:
       0     1
0  42043   268
1    148  1365
---- Validation: 
scalar performance:
{'acc': 0.98481864, 'precision': 0.8695308, 'recall': 0.89498895, 'specificity': 0.89498895, 'f1': 0.8818, 'auroc': 0.9743513, 'binary_precision': 0.7457364, 'binary_recall': 0.7990033, 'binary_specificity': 0.9909746, 'binary_f1_score': 0.7714515}
confusion matrix:
       0    1
0  18007  164
1    121  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9677833, 'precision': 0.85077834, 'recall': 0.63229656, 'specificity': 0.63229656, 'f1': 0.688101, 'auroc': 0.9242821, 'binary_precision': 0.7303371, 'binary_recall': 0.26859504, 'binary_specificity': 0.995998, 'binary_f1_score': 0.39274925}
confusion matrix:
      0   1
0  5973  24
1   177  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_27.png
early stop counter: 1
val acc:0.9848186373710632, best validation acc: 0.9855111241340637, corresponding to test acc:                         0.9644173979759216 / 0.9777207970619202
after epoch: 27,now: 2024-06-10 15:42:21.724977,epoch time: 0:33:57.558249,used: 13:43:20.227449,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9916256, 'precision': 0.93243486, 'recall': 0.94372284, 'specificity': 0.94372284, 'f1': 0.9380001, 'auroc': 0.99530005, 'binary_precision': 0.8687259, 'binary_recall': 0.89226705, 'binary_specificity': 0.9951786, 'binary_f1_score': 0.88033915}
confusion matrix:
       0     1
0  42107   204
1    163  1350
---- Validation: 
scalar performance:
{'acc': 0.9864699, 'precision': 0.8862273, 'recall': 0.8998572, 'specificity': 0.8998572, 'f1': 0.8929144, 'auroc': 0.977417, 'binary_precision': 0.77884614, 'binary_recall': 0.807309, 'binary_specificity': 0.9924055, 'binary_f1_score': 0.7928221}
confusion matrix:
       0    1
0  18033  138
1    116  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.74249196, 'recall': 0.5914562, 'specificity': 0.5914562, 'f1': 0.62913495, 'auroc': 0.9171449, 'binary_precision': 0.5168539, 'binary_recall': 0.19008264, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.2779456}
confusion matrix:
      0   1
0  5954  43
1   196  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_28.png
better model found
persisted
after epoch: 28,now: 2024-06-10 16:18:32.715714,epoch time: 0:36:10.990737,used: 14:19:31.218186,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9899142, 'precision': 0.91673756, 'recall': 0.9358262, 'specificity': 0.9358262, 'f1': 0.9260498, 'auroc': 0.9953147, 'binary_precision': 0.83785486, 'binary_recall': 0.8777264, 'binary_specificity': 0.9939259, 'binary_f1_score': 0.8573273}
confusion matrix:
       0     1
0  42054   257
1    185  1328
---- Validation: 
scalar performance:
{'acc': 0.9838598, 'precision': 0.8626392, 'recall': 0.88646317, 'specificity': 0.88646317, 'f1': 0.8741398, 'auroc': 0.9654771, 'binary_precision': 0.7325039, 'binary_recall': 0.782392, 'binary_specificity': 0.99053437, 'binary_f1_score': 0.75662655}
confusion matrix:
       0    1
0  17999  172
1    131  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.782022, 'recall': 0.600471, 'specificity': 0.600471, 'f1': 0.64407533, 'auroc': 0.8888072, 'binary_precision': 0.5952381, 'binary_recall': 0.20661157, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.30674845}
confusion matrix:
      0   1
0  5963  34
1   192  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_29.png
early stop counter: 1
val acc:0.9838597774505615, best validation acc: 0.9864699244499207, corresponding to test acc:                         0.9616925716400146 / 0.9777207970619202
after epoch: 29,now: 2024-06-10 16:46:33.328907,epoch time: 0:28:00.613193,used: 14:47:31.831379,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98995984, 'precision': 0.90655386, 'recall': 0.95401293, 'specificity': 0.95401293, 'f1': 0.92885876, 'auroc': 0.99621844, 'binary_precision': 0.81614614, 'binary_recall': 0.91539985, 'binary_specificity': 0.992626, 'binary_f1_score': 0.8629284}
confusion matrix:
       0     1
0  41999   312
1    128  1385
---- Validation: 
scalar performance:
{'acc': 0.9851915, 'precision': 0.87003654, 'recall': 0.9032121, 'specificity': 0.9032121, 'f1': 0.88585186, 'auroc': 0.97419584, 'binary_precision': 0.7462006, 'binary_recall': 0.81561464, 'binary_specificity': 0.99080956, 'binary_f1_score': 0.7793651}
confusion matrix:
       0    1
0  18004  167
1    111  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.7368071, 'recall': 0.59128946, 'specificity': 0.59128946, 'f1': 0.6282164, 'auroc': 0.92466205, 'binary_precision': 0.50549453, 'binary_recall': 0.19008264, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.2762763}
confusion matrix:
      0   1
0  5952  45
1   196  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21261156_30.png
early stop counter: 2
val acc:0.9851915240287781, best validation acc: 0.9864699244499207, corresponding to test acc:                         0.9616925716400146 / 0.9777207970619202
after epoch: 30,now: 2024-06-10 17:18:02.212983,epoch time: 0:31:28.884076,used: 15:19:00.715455,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_10_01_59_01_seed_2_21261156
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:19:00.715455 at 2024-06-10 17:18:02.212983
persisted model performance metric: 

scalar performance:
{'acc': 0.962494, 'precision': 0.76140034, 'recall': 0.5799766, 'specificity': 0.5799766, 'f1': 0.61776996, 'auroc': 0.92038697, 'binary_precision': 0.5555556, 'binary_recall': 0.16528925, 'binary_specificity': 0.994664, 'binary_f1_score': 0.25477707}
confusion matrix:
      0   1
0  5965  32
1   202  40
oracle model performance metric: 

scalar performance:
{'acc': 0.9767591, 'precision': 0.8714174, 'recall': 0.78963655, 'specificity': 0.78963655, 'f1': 0.8249852, 'auroc': 0.9529687, 'binary_precision': 0.7593583, 'binary_recall': 0.58677685, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.66200465}
confusion matrix:
      0    1
0  5952   45
1   100  142
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_new_new/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456213 KiB |  13219 MiB |   3370 TiB |   3370 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   3331 TiB |   3331 TiB |
|       from small pool |  41681 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456213 KiB |  13219 MiB |   3370 TiB |   3370 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   3331 TiB |   3331 TiB |
|       from small pool |  41681 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447753 KiB |  13213 MiB |   3362 TiB |   3362 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   3322 TiB |   3322 TiB |
|       from small pool |  40678 KiB |     60 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14486 MiB |  41672 MiB |  27198 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  41570 MiB |  27162 MiB |
|       from small pool |     66 MiB |     72 MiB |    102 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446955 KiB |   1252 MiB |   2404 TiB |   2404 TiB |
|       from large pool | 435388 KiB |   1244 MiB |   2364 TiB |   2364 TiB |
|       from small pool |  11566 KiB |     43 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    6487    |  593150 K  |  593147 K  |
|       from large pool |     187    |    1413    |  307818 K  |  307818 K  |
|       from small pool |    3289    |    6298    |  285331 K  |  285328 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    6487    |  593150 K  |  593147 K  |
|       from large pool |     187    |    1413    |  307818 K  |  307818 K  |
|       from small pool |    3289    |    6298    |  285331 K  |  285328 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     637    |    1780    |    1146    |
|       from large pool |     601    |     601    |    1729    |    1128    |
|       from small pool |      33    |      36    |      51    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      84    |    2810    |  370633 K  |  370633 K  |
|       from large pool |      40    |     604    |  220912 K  |  220912 K  |
|       from small pool |      44    |    2768    |  149720 K  |  149720 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   3370 TiB |   3370 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3331 TiB |   3331 TiB |
|       from small pool |      0 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   3370 TiB |   3370 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   3331 TiB |   3331 TiB |
|       from small pool |      0 KiB |     61 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   3362 TiB |   3362 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   3322 TiB |   3322 TiB |
|       from small pool |      0 KiB |     60 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14486 MiB |  41672 MiB |  40790 MiB |
|       from large pool |    830 MiB |  14414 MiB |  41570 MiB |  40740 MiB |
|       from small pool |     52 MiB |     72 MiB |    102 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB |   2404 TiB |   2404 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   2364 TiB |   2364 TiB |
|       from small pool |      0 KiB |     46 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  593150 K  |  593150 K  |
|       from large pool |       2    |    1413    |  307818 K  |  307818 K  |
|       from small pool |       0    |    6298    |  285331 K  |  285331 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  593150 K  |  593150 K  |
|       from large pool |       2    |    1413    |  307818 K  |  307818 K  |
|       from small pool |       0    |    6298    |  285331 K  |  285331 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    1780    |    1717    |
|       from large pool |      37    |     601    |    1729    |    1692    |
|       from small pool |      26    |      36    |      51    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2810    |  370634 K  |  370634 K  |
|       from large pool |       4    |     604    |  220912 K  |  220912 K  |
|       from small pool |       0    |    2768    |  149721 K  |  149721 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jun 10 17:21:52 2024]
Finished job 0.
1 of 1 steps (100%) done
