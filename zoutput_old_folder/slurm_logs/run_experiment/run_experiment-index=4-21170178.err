Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jun  7 01:17:50 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178

 Experiment start at: 2024-06-07 01:25:50.792929
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.955097496509552
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9741962, 'precision': 0.8458868, 'recall': 0.69190395, 'specificity': 0.69190395, 'f1': 0.7451345, 'auroc': 0.96498525, 'binary_precision': 0.71268654, 'binary_recall': 0.3892663, 'binary_specificity': 0.9945416, 'binary_f1_score': 0.503515}
confusion matrix:
       0    1
0  42089  231
1    899  573
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.97264796, 'precision': 0.8379674, 'recall': 0.67381644, 'specificity': 0.67381644, 'f1': 0.72748536, 'auroc': 0.9607235, 'binary_precision': 0.69846153, 'binary_recall': 0.35303265, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.46900827}
confusion matrix:
       0    1
0  18051   98
1    416  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.9808371, 'recall': 0.5421456, 'specificity': 0.5421456, 'f1': 0.56796986, 'auroc': 0.94998586, 'binary_precision': 1.0, 'binary_recall': 0.08429119, 'binary_specificity': 1.0, 'binary_f1_score': 0.15547703}
confusion matrix:
      0   1
0  5997   0
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-07 01:58:18.611680,epoch time: 0:32:27.818751,used: 0:32:27.818751,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98001915, 'precision': 0.8894375, 'recall': 0.7708261, 'specificity': 0.7708261, 'f1': 0.81866086, 'auroc': 0.97843814, 'binary_precision': 0.7944664, 'binary_recall': 0.54656696, 'binary_specificity': 0.9950852, 'binary_f1_score': 0.6476037}
confusion matrix:
       0    1
0  42113  208
1    667  804
---- Validation: 
scalar performance:
{'acc': 0.9784483, 'precision': 0.8928727, 'recall': 0.74282426, 'specificity': 0.74282426, 'f1': 0.7988074, 'auroc': 0.97520196, 'binary_precision': 0.8035714, 'binary_recall': 0.48989114, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.6086957}
confusion matrix:
       0    1
0  18072   77
1    328  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.66686, 'recall': 0.50533026, 'specificity': 0.50533026, 'f1': 0.5004151, 'auroc': 0.95692873, 'binary_precision': 0.375, 'binary_recall': 0.011494253, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.022304833}
confusion matrix:
      0  1
0  5992  5
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_2.png
better model found
persisted
after epoch: 2,now: 2024-06-07 02:29:24.635054,epoch time: 0:31:06.023374,used: 1:03:33.842125,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9824625, 'precision': 0.92964983, 'recall': 0.77781785, 'specificity': 0.77781785, 'f1': 0.8362875, 'auroc': 0.9837486, 'binary_precision': 0.8744681, 'binary_recall': 0.55842394, 'binary_specificity': 0.9972117, 'binary_f1_score': 0.681592}
confusion matrix:
       0    1
0  42202  118
1    650  822
---- Validation: 
scalar performance:
{'acc': 0.97812897, 'precision': 0.9590374, 'recall': 0.6924052, 'specificity': 0.6924052, 'f1': 0.7678259, 'auroc': 0.9770813, 'binary_precision': 0.93939394, 'binary_recall': 0.38569206, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.5468578}
confusion matrix:
       0    1
0  18133   16
1    395  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.8543732, 'recall': 0.50566375, 'specificity': 0.50566375, 'f1': 0.5007502, 'auroc': 0.9574213, 'binary_precision': 0.75, 'binary_recall': 0.011494253, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.022641508}
confusion matrix:
      0  1
0  5996  1
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_3.png
early stop counter: 1
val acc:0.978128969669342, best validation acc: 0.9784482717514038, corresponding to test acc:                         0.9579737782478333 / 0.9618088603019714
after epoch: 3,now: 2024-06-07 03:00:35.093799,epoch time: 0:31:10.458745,used: 1:34:44.300870,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.984061, 'precision': 0.8723697, 'recall': 0.88701904, 'specificity': 0.88701904, 'f1': 0.87954056, 'auroc': 0.98729557, 'binary_precision': 0.75228757, 'binary_recall': 0.7829932, 'binary_specificity': 0.9910448, 'binary_f1_score': 0.7673333}
confusion matrix:
       0     1
0  41943   379
1    319  1151
---- Validation: 
scalar performance:
{'acc': 0.9838761, 'precision': 0.8878087, 'recall': 0.8603928, 'specificity': 0.8603928, 'f1': 0.87355554, 'auroc': 0.9802705, 'binary_precision': 0.7852349, 'binary_recall': 0.7278383, 'binary_specificity': 0.9929473, 'binary_f1_score': 0.7554479}
confusion matrix:
       0    1
0  18021  128
1    175  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.91932696, 'recall': 0.5666329, 'specificity': 0.5666329, 'f1': 0.6068235, 'auroc': 0.96264625, 'binary_precision': 0.875, 'binary_recall': 0.13409962, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.23255815}
confusion matrix:
      0   1
0  5992   5
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-07 03:31:43.314173,epoch time: 0:31:08.220374,used: 2:05:52.521244,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98479176, 'precision': 0.8971805, 'recall': 0.8590206, 'specificity': 0.8590206, 'f1': 0.87705886, 'auroc': 0.98851895, 'binary_precision': 0.8039216, 'binary_recall': 0.7241848, 'binary_specificity': 0.9938563, 'binary_f1_score': 0.7619728}
confusion matrix:
       0     1
0  42060   260
1    406  1066
---- Validation: 
scalar performance:
{'acc': 0.98286504, 'precision': 0.8968353, 'recall': 0.8261168, 'specificity': 0.8261168, 'f1': 0.85773647, 'auroc': 0.9804343, 'binary_precision': 0.8057143, 'binary_recall': 0.6578538, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.7243151}
confusion matrix:
       0    1
0  18047  102
1    220  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8669131, 'recall': 0.55105716, 'specificity': 0.55105716, 'f1': 0.58131444, 'auroc': 0.93997097, 'binary_precision': 0.7714286, 'binary_recall': 0.10344828, 'binary_specificity': 0.998666, 'binary_f1_score': 0.18243244}
confusion matrix:
      0   1
0  5989   8
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_5.png
early stop counter: 1
val acc:0.982865035533905, best validation acc: 0.98387610912323, corresponding to test acc:                         0.963087260723114 / 0.963087260723114
after epoch: 5,now: 2024-06-07 04:02:55.475217,epoch time: 0:31:12.161044,used: 2:37:04.682288,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9871894, 'precision': 0.9543584, 'recall': 0.8379667, 'specificity': 0.8379667, 'f1': 0.8870022, 'auroc': 0.992735, 'binary_precision': 0.91981566, 'binary_recall': 0.6779891, 'binary_specificity': 0.99794424, 'binary_f1_score': 0.7806023}
confusion matrix:
       0    1
0  42233   87
1    474  998
---- Validation: 
scalar performance:
{'acc': 0.9827054, 'precision': 0.92590773, 'recall': 0.7907816, 'specificity': 0.7907816, 'f1': 0.8446667, 'auroc': 0.98169243, 'binary_precision': 0.8663595, 'binary_recall': 0.58475894, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.69823587}
confusion matrix:
       0    1
0  18091   58
1    267  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.9803749, 'recall': 0.53065133, 'specificity': 0.53065133, 'f1': 0.54775274, 'auroc': 0.95626646, 'binary_precision': 1.0, 'binary_recall': 0.06130268, 'binary_specificity': 1.0, 'binary_f1_score': 0.115523465}
confusion matrix:
      0   1
0  5997   0
1   245  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_6.png
early stop counter: 2
val acc:0.9827054142951965, best validation acc: 0.98387610912323, corresponding to test acc:                         0.963087260723114 / 0.963087260723114
after epoch: 6,now: 2024-06-07 04:34:20.449742,epoch time: 0:31:24.974525,used: 3:08:29.656813,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9844264, 'precision': 0.86513174, 'recall': 0.91325617, 'specificity': 0.91325617, 'f1': 0.8875699, 'auroc': 0.99152267, 'binary_precision': 0.7359618, 'binary_recall': 0.8369565, 'binary_specificity': 0.9895558, 'binary_f1_score': 0.7832168}
confusion matrix:
       0     1
0  41878   442
1    240  1232
---- Validation: 
scalar performance:
{'acc': 0.9815879, 'precision': 0.84953356, 'recall': 0.88921034, 'specificity': 0.88921034, 'f1': 0.8682048, 'auroc': 0.9809352, 'binary_precision': 0.7065368, 'binary_recall': 0.79004663, 'binary_specificity': 0.988374, 'binary_f1_score': 0.7459618}
confusion matrix:
       0    1
0  17938  211
1    135  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.8803623, 'recall': 0.53031784, 'specificity': 0.53031784, 'f1': 0.5467638, 'auroc': 0.9422479, 'binary_precision': 0.8, 'binary_recall': 0.06130268, 'binary_specificity': 0.999333, 'binary_f1_score': 0.11387901}
confusion matrix:
      0   1
0  5993   4
1   245  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_7.png
early stop counter: 3
val acc:0.9815878868103027, best validation acc: 0.98387610912323, corresponding to test acc:                         0.963087260723114 / 0.963087260723114
after epoch: 7,now: 2024-06-07 05:06:18.532319,epoch time: 0:31:58.082577,used: 3:40:27.739390,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98639023, 'precision': 0.8962158, 'recall': 0.8936171, 'specificity': 0.8936171, 'f1': 0.89491177, 'auroc': 0.9925028, 'binary_precision': 0.7995896, 'binary_recall': 0.7941576, 'binary_specificity': 0.99307656, 'binary_f1_score': 0.7968644}
confusion matrix:
       0     1
0  42027   293
1    303  1169
---- Validation: 
scalar performance:
{'acc': 0.9837697, 'precision': 0.8826089, 'recall': 0.8670882, 'specificity': 0.8670882, 'f1': 0.87467396, 'auroc': 0.9847559, 'binary_precision': 0.77435064, 'binary_recall': 0.7418352, 'binary_specificity': 0.99234116, 'binary_f1_score': 0.75774425}
confusion matrix:
       0    1
0  18010  139
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.7989384, 'recall': 0.5616343, 'specificity': 0.5616343, 'f1': 0.59531087, 'auroc': 0.9152668, 'binary_precision': 0.63461536, 'binary_recall': 0.12643678, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.21086262}
confusion matrix:
      0   1
0  5978  19
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_8.png
early stop counter: 4
val acc:0.9837697148323059, best validation acc: 0.98387610912323, corresponding to test acc:                         0.963087260723114 / 0.963087260723114
after epoch: 8,now: 2024-06-07 05:37:44.479613,epoch time: 0:31:25.947294,used: 4:11:53.686684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9909801, 'precision': 0.95362604, 'recall': 0.902549, 'specificity': 0.902549, 'f1': 0.9264488, 'auroc': 0.99640834, 'binary_precision': 0.91391236, 'binary_recall': 0.80774456, 'binary_specificity': 0.9973535, 'binary_f1_score': 0.85755503}
confusion matrix:
       0     1
0  42208   112
1    283  1189
---- Validation: 
scalar performance:
{'acc': 0.9868561, 'precision': 0.9339225, 'recall': 0.8559351, 'specificity': 0.8559351, 'f1': 0.89078176, 'auroc': 0.9849046, 'binary_precision': 0.8778626, 'binary_recall': 0.7153966, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.7883462}
confusion matrix:
       0    1
0  18085   64
1    183  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.92983353, 'recall': 0.517158, 'specificity': 0.517158, 'f1': 0.5228796, 'auroc': 0.90455973, 'binary_precision': 0.9, 'binary_recall': 0.03448276, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.06642067}
confusion matrix:
      0  1
0  5996  1
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_9.png
better model found
persisted
after epoch: 9,now: 2024-06-07 06:09:01.263629,epoch time: 0:31:16.784016,used: 4:43:10.470700,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9907746, 'precision': 0.96393764, 'recall': 0.8885976, 'specificity': 0.8885976, 'f1': 0.92269456, 'auroc': 0.9962122, 'binary_precision': 0.9355102, 'binary_recall': 0.77906185, 'binary_specificity': 0.9981333, 'binary_f1_score': 0.8501484}
confusion matrix:
       0     1
0  42242    79
1    325  1146
---- Validation: 
scalar performance:
{'acc': 0.98499364, 'precision': 0.93385816, 'recall': 0.82346857, 'specificity': 0.82346857, 'f1': 0.8700153, 'auroc': 0.98401153, 'binary_precision': 0.88, 'binary_recall': 0.65007776, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.74776393}
confusion matrix:
       0    1
0  18092   57
1    225  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.8259777, 'recall': 0.5169079, 'specificity': 0.5169079, 'f1': 0.5223909, 'auroc': 0.9139458, 'binary_precision': 0.6923077, 'binary_recall': 0.03448276, 'binary_specificity': 0.999333, 'binary_f1_score': 0.06569343}
confusion matrix:
      0  1
0  5993  4
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_10.png
early stop counter: 1
val acc:0.9849936366081238, best validation acc: 0.9868561029434204, corresponding to test acc:                         0.9595717191696167 / 0.963087260723114
after epoch: 10,now: 2024-06-07 06:40:23.372819,epoch time: 0:31:22.109190,used: 5:14:32.579890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9913683, 'precision': 0.94190466, 'recall': 0.9227493, 'specificity': 0.9227493, 'f1': 0.93209815, 'auroc': 0.99694145, 'binary_precision': 0.88904697, 'binary_recall': 0.8491848, 'binary_specificity': 0.9963138, 'binary_f1_score': 0.86865884}
confusion matrix:
       0     1
0  42164   156
1    222  1250
---- Validation: 
scalar performance:
{'acc': 0.98690933, 'precision': 0.9248701, 'recall': 0.8672135, 'specificity': 0.8672135, 'f1': 0.893777, 'auroc': 0.98414224, 'binary_precision': 0.85895115, 'binary_recall': 0.7387247, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.7943144}
confusion matrix:
       0    1
0  18071   78
1    168  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.90308285, 'recall': 0.55130726, 'specificity': 0.55130726, 'f1': 0.5823735, 'auroc': 0.92040706, 'binary_precision': 0.84375, 'binary_recall': 0.10344828, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.18430035}
confusion matrix:
      0   1
0  5992   5
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_11.png
better model found
persisted
after epoch: 11,now: 2024-06-07 07:11:31.815342,epoch time: 0:31:08.442523,used: 5:45:41.022413,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99180216, 'precision': 0.9563819, 'recall': 0.9134079, 'specificity': 0.9134079, 'f1': 0.93375283, 'auroc': 0.9968573, 'binary_precision': 0.9186747, 'binary_recall': 0.82936776, 'binary_specificity': 0.9974481, 'binary_f1_score': 0.8717399}
confusion matrix:
       0     1
0  42213   108
1    251  1220
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.94624346, 'recall': 0.8238267, 'specificity': 0.8238267, 'f1': 0.8745935, 'auroc': 0.9837123, 'binary_precision': 0.9047619, 'binary_recall': 0.65007776, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.7565611}
confusion matrix:
       0    1
0  18105   44
1    225  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8003188, 'recall': 0.54297745, 'specificity': 0.54297745, 'f1': 0.5671702, 'auroc': 0.9066581, 'binary_precision': 0.6388889, 'binary_recall': 0.08812261, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.15488216}
confusion matrix:
      0   1
0  5984  13
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_12.png
early stop counter: 1
val acc:0.985685408115387, best validation acc: 0.9869093298912048, corresponding to test acc:                         0.9618088603019714 / 0.963087260723114
after epoch: 12,now: 2024-06-07 07:42:59.299380,epoch time: 0:31:27.484038,used: 6:17:08.506451,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9935148, 'precision': 0.97611904, 'recall': 0.9215649, 'specificity': 0.9215649, 'f1': 0.94706225, 'auroc': 0.99855494, 'binary_precision': 0.9576271, 'binary_recall': 0.8444294, 'binary_specificity': 0.9987004, 'binary_f1_score': 0.8974729}
confusion matrix:
       0     1
0  42265    55
1    229  1243
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.93809366, 'recall': 0.8460191, 'specificity': 0.8460191, 'f1': 0.8862406, 'auroc': 0.9852276, 'binary_precision': 0.8869048, 'binary_recall': 0.69517887, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.7794246}
confusion matrix:
       0    1
0  18092   57
1    196  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.9030609, 'recall': 0.52090603, 'specificity': 0.52090603, 'f1': 0.5298535, 'auroc': 0.8656075, 'binary_precision': 0.84615386, 'binary_recall': 0.042145595, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.08029197}
confusion matrix:
      0   1
0  5995   2
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_13.png
early stop counter: 2
val acc:0.9865368008613586, best validation acc: 0.9869093298912048, corresponding to test acc:                         0.9618088603019714 / 0.963087260723114
after epoch: 13,now: 2024-06-07 08:14:32.524963,epoch time: 0:31:33.225583,used: 6:48:41.732034,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9929668, 'precision': 0.93474174, 'recall': 0.96092737, 'specificity': 0.96092737, 'f1': 0.9474205, 'auroc': 0.99832696, 'binary_precision': 0.8720409, 'binary_recall': 0.92658055, 'binary_specificity': 0.9952742, 'binary_f1_score': 0.8984839}
confusion matrix:
       0     1
0  42121   200
1    108  1363
---- Validation: 
scalar performance:
{'acc': 0.9880268, 'precision': 0.9136025, 'recall': 0.90304464, 'specificity': 0.90304464, 'f1': 0.9082496, 'auroc': 0.9854723, 'binary_precision': 0.8338658, 'binary_recall': 0.8118196, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.822695}
confusion matrix:
       0    1
0  18045  104
1    121  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.83742183, 'recall': 0.5282354, 'specificity': 0.5282354, 'f1': 0.54289234, 'auroc': 0.92881453, 'binary_precision': 0.71428573, 'binary_recall': 0.057471264, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.10638297}
confusion matrix:
      0   1
0  5991   6
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_14.png
better model found
persisted
after epoch: 14,now: 2024-06-07 08:46:09.130894,epoch time: 0:31:36.605931,used: 7:20:18.337965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99367464, 'precision': 0.9426005, 'recall': 0.96260595, 'specificity': 0.96260595, 'f1': 0.9523643, 'auroc': 0.99854815, 'binary_precision': 0.88766235, 'binary_recall': 0.9292998, 'binary_specificity': 0.9959122, 'binary_f1_score': 0.908004}
confusion matrix:
       0     1
0  42148   173
1    104  1367
---- Validation: 
scalar performance:
{'acc': 0.98770756, 'precision': 0.92124236, 'recall': 0.8863781, 'specificity': 0.8863781, 'f1': 0.90299666, 'auroc': 0.9840547, 'binary_precision': 0.8503401, 'binary_recall': 0.777605, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.81234765}
confusion matrix:
       0    1
0  18061   88
1    143  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.9124147, 'recall': 0.5361483, 'specificity': 0.5361483, 'f1': 0.5571239, 'auroc': 0.8970438, 'binary_precision': 0.8636364, 'binary_recall': 0.07279693, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.13427562}
confusion matrix:
      0   1
0  5994   3
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_15.png
early stop counter: 1
val acc:0.9877075552940369, best validation acc: 0.9880267977714539, corresponding to test acc:                         0.9597315192222595 / 0.963087260723114
after epoch: 15,now: 2024-06-07 09:17:48.343099,epoch time: 0:31:39.212205,used: 7:51:57.550170,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9947936, 'precision': 0.95328367, 'recall': 0.9681268, 'specificity': 0.9681268, 'f1': 0.9605762, 'auroc': 0.9985316, 'binary_precision': 0.9086728, 'binary_recall': 0.93953806, 'binary_specificity': 0.9967155, 'binary_f1_score': 0.92384773}
confusion matrix:
       0     1
0  42181   139
1     89  1383
---- Validation: 
scalar performance:
{'acc': 0.9889847, 'precision': 0.93057764, 'recall': 0.8975401, 'specificity': 0.8975401, 'f1': 0.913347, 'auroc': 0.98494315, 'binary_precision': 0.8682432, 'binary_recall': 0.7993779, 'binary_specificity': 0.99570227, 'binary_f1_score': 0.8323887}
confusion matrix:
       0    1
0  18071   78
1    129  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8596515, 'recall': 0.55288947, 'specificity': 0.55288947, 'f1': 0.5840563, 'auroc': 0.9211189, 'binary_precision': 0.7567568, 'binary_recall': 0.107279696, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.18791947}
confusion matrix:
      0   1
0  5988   9
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_16.png
better model found
persisted
after epoch: 16,now: 2024-06-07 09:49:13.953399,epoch time: 0:31:25.610300,used: 8:23:23.160470,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9949762, 'precision': 0.9676298, 'recall': 0.9541234, 'specificity': 0.9541234, 'f1': 0.96077, 'auroc': 0.9989039, 'binary_precision': 0.93837535, 'binary_recall': 0.91032606, 'binary_specificity': 0.99792063, 'binary_f1_score': 0.9241379}
confusion matrix:
       0     1
0  42232    88
1    132  1340
---- Validation: 
scalar performance:
{'acc': 0.98813325, 'precision': 0.9295324, 'recall': 0.88359827, 'specificity': 0.88359827, 'f1': 0.90516466, 'auroc': 0.9864994, 'binary_precision': 0.86713284, 'binary_recall': 0.7713841, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.8164609}
confusion matrix:
       0    1
0  18073   76
1    147  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7299551, 'recall': 0.52015567, 'specificity': 0.52015567, 'f1': 0.5282014, 'auroc': 0.9145924, 'binary_precision': 0.5, 'binary_recall': 0.042145595, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.077738516}
confusion matrix:
      0   1
0  5986  11
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_17.png
early stop counter: 1
val acc:0.9881332516670227, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.9613295197486877 / 0.963087260723114
after epoch: 17,now: 2024-06-07 10:20:30.184756,epoch time: 0:31:16.231357,used: 8:54:39.391827,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99463373, 'precision': 0.9540266, 'recall': 0.9644376, 'specificity': 0.9644376, 'f1': 0.95916843, 'auroc': 0.9990594, 'binary_precision': 0.91041803, 'binary_recall': 0.9320652, 'binary_specificity': 0.99681, 'binary_f1_score': 0.92111444}
confusion matrix:
       0     1
0  42185   135
1    100  1372
---- Validation: 
scalar performance:
{'acc': 0.9880268, 'precision': 0.9204837, 'recall': 0.89329386, 'specificity': 0.89329386, 'f1': 0.90639746, 'auroc': 0.9866421, 'binary_precision': 0.84833336, 'binary_recall': 0.79160184, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.8189863}
confusion matrix:
       0    1
0  18058   91
1    134  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7708108, 'recall': 0.53339887, 'specificity': 0.53339887, 'f1': 0.5511726, 'auroc': 0.86708677, 'binary_precision': 0.58064514, 'binary_recall': 0.06896552, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.12328768}
confusion matrix:
      0   1
0  5984  13
1   243  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_18.png
early stop counter: 2
val acc:0.9880267977714539, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.9613295197486877 / 0.963087260723114
after epoch: 18,now: 2024-06-07 10:52:20.168795,epoch time: 0:31:49.984039,used: 9:26:29.375866,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99547863, 'precision': 0.98437935, 'recall': 0.94487536, 'specificity': 0.94487536, 'f1': 0.9637257, 'auroc': 0.9994145, 'binary_precision': 0.97255194, 'binary_recall': 0.890625, 'binary_specificity': 0.9991257, 'binary_f1_score': 0.9297872}
confusion matrix:
       0     1
0  42283    37
1    161  1311
---- Validation: 
scalar performance:
{'acc': 0.9882929, 'precision': 0.94680274, 'recall': 0.86717975, 'specificity': 0.86717975, 'f1': 0.9028013, 'auroc': 0.9841797, 'binary_precision': 0.9028571, 'binary_recall': 0.7371695, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.8116439}
confusion matrix:
       0    1
0  18098   51
1    169  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.927814, 'recall': 0.5324003, 'specificity': 0.5324003, 'f1': 0.550662, 'auroc': 0.8757618, 'binary_precision': 0.8947368, 'binary_recall': 0.0651341, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.12142857}
confusion matrix:
      0   1
0  5995   2
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_19.png
early stop counter: 3
val acc:0.9882928729057312, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.9613295197486877 / 0.963087260723114
after epoch: 19,now: 2024-06-07 11:23:50.855808,epoch time: 0:31:30.687013,used: 9:58:00.062879,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9958212, 'precision': 0.97177064, 'recall': 0.9634127, 'specificity': 0.9634127, 'f1': 0.96755147, 'auroc': 0.99941087, 'binary_precision': 0.9460208, 'binary_recall': 0.9286685, 'binary_specificity': 0.9981569, 'binary_f1_score': 0.93726426}
confusion matrix:
       0     1
0  42242    78
1    105  1367
---- Validation: 
scalar performance:
{'acc': 0.9879204, 'precision': 0.9321022, 'recall': 0.8767376, 'specificity': 0.8767376, 'f1': 0.9023758, 'auroc': 0.98455966, 'binary_precision': 0.8727599, 'binary_recall': 0.7573872, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.8109908}
confusion matrix:
       0    1
0  18078   71
1    156  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.739439, 'recall': 0.52573603, 'specificity': 0.52573603, 'f1': 0.5379798, 'auroc': 0.8995329, 'binary_precision': 0.5185185, 'binary_recall': 0.053639848, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.097222224}
confusion matrix:
      0   1
0  5984  13
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_20.png
early stop counter: 4
val acc:0.9879204034805298, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.9613295197486877 / 0.963087260723114
after epoch: 20,now: 2024-06-07 11:55:15.446504,epoch time: 0:31:24.590696,used: 10:29:24.653575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9935833, 'precision': 0.9542371, 'recall': 0.94618976, 'specificity': 0.94618976, 'f1': 0.9501746, 'auroc': 0.99834013, 'binary_precision': 0.91211075, 'binary_recall': 0.89538044, 'binary_specificity': 0.996999, 'binary_f1_score': 0.90366817}
confusion matrix:
       0     1
0  42193   127
1    154  1318
---- Validation: 
scalar performance:
{'acc': 0.98515326, 'precision': 0.90481985, 'recall': 0.8603039, 'specificity': 0.8603039, 'f1': 0.8811604, 'auroc': 0.9836939, 'binary_precision': 0.81929827, 'binary_recall': 0.7262831, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.76999176}
confusion matrix:
       0    1
0  18046  103
1    176  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.8015387, 'recall': 0.5467255, 'specificity': 0.5467255, 'f1': 0.57310086, 'auroc': 0.8763238, 'binary_precision': 0.64102566, 'binary_recall': 0.09578544, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.16666666}
confusion matrix:
      0   1
0  5983  14
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_21.png
early stop counter: 5
val acc:0.9851532578468323, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.9613295197486877 / 0.963087260723114
after epoch: 21,now: 2024-06-07 12:26:59.601943,epoch time: 0:31:44.155439,used: 11:01:08.809014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9966204, 'precision': 0.98513114, 'recall': 0.96218693, 'specificity': 0.96218693, 'f1': 0.9733604, 'auroc': 0.9995611, 'binary_precision': 0.9728571, 'binary_recall': 0.92527175, 'binary_specificity': 0.99910206, 'binary_f1_score': 0.94846797}
confusion matrix:
       0     1
0  42282    38
1    110  1362
---- Validation: 
scalar performance:
{'acc': 0.9883993, 'precision': 0.95080674, 'recall': 0.86498463, 'specificity': 0.86498463, 'f1': 0.90304196, 'auroc': 0.9843638, 'binary_precision': 0.91102517, 'binary_recall': 0.7325039, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.812069}
confusion matrix:
       0    1
0  18103   46
1    172  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.8863846, 'recall': 0.5246541, 'specificity': 0.5246541, 'f1': 0.5366773, 'auroc': 0.92101574, 'binary_precision': 0.8125, 'binary_recall': 0.049808428, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.09386282}
confusion matrix:
      0   1
0  5994   3
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_22.png
early stop counter: 6
val acc:0.9883993268013, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.9613295197486877 / 0.963087260723114
after epoch: 22,now: 2024-06-07 12:58:38.734462,epoch time: 0:31:39.132519,used: 11:32:47.941533,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9948164, 'precision': 0.97101796, 'recall': 0.94781137, 'specificity': 0.94781137, 'f1': 0.9590994, 'auroc': 0.99887997, 'binary_precision': 0.9455977, 'binary_recall': 0.8974185, 'binary_specificity': 0.9982042, 'binary_f1_score': 0.9208784}
confusion matrix:
       0     1
0  42244    76
1    151  1321
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.93589807, 'recall': 0.8482692, 'specificity': 0.8482692, 'f1': 0.8868139, 'auroc': 0.98134243, 'binary_precision': 0.88235295, 'binary_recall': 0.6998445, 'binary_specificity': 0.996694, 'binary_f1_score': 0.7805724}
confusion matrix:
       0    1
0  18089   60
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.7016589, 'recall': 0.50724596, 'specificity': 0.50724596, 'f1': 0.5041174, 'auroc': 0.87627274, 'binary_precision': 0.44444445, 'binary_recall': 0.01532567, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.02962963}
confusion matrix:
      0  1
0  5992  5
1   257  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_23.png
early stop counter: 7
val acc:0.9865368008613586, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.9613295197486877 / 0.963087260723114
after epoch: 23,now: 2024-06-07 13:30:20.188603,epoch time: 0:31:41.454141,used: 12:04:29.395674,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9963007, 'precision': 0.9790585, 'recall': 0.96333295, 'specificity': 0.96333295, 'f1': 0.9710547, 'auroc': 0.99944884, 'binary_precision': 0.96061885, 'binary_recall': 0.9279891, 'binary_specificity': 0.9986768, 'binary_f1_score': 0.9440221}
confusion matrix:
       0     1
0  42264    56
1    106  1366
---- Validation: 
scalar performance:
{'acc': 0.98770756, 'precision': 0.9321808, 'recall': 0.8728771, 'specificity': 0.8728771, 'f1': 0.90017325, 'auroc': 0.97900534, 'binary_precision': 0.8731884, 'binary_recall': 0.7496112, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.80669457}
confusion matrix:
       0    1
0  18079   70
1    161  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.9030609, 'recall': 0.52090603, 'specificity': 0.52090603, 'f1': 0.5298535, 'auroc': 0.90566254, 'binary_precision': 0.84615386, 'binary_recall': 0.042145595, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.08029197}
confusion matrix:
      0   1
0  5995   2
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_24.png
early stop counter: 8
val acc:0.9877075552940369, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.9613295197486877 / 0.963087260723114
after epoch: 24,now: 2024-06-07 14:02:28.884912,epoch time: 0:32:08.696309,used: 12:36:38.091983,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9975338, 'precision': 0.98038965, 'recall': 0.9816513, 'specificity': 0.9816513, 'f1': 0.9810196, 'auroc': 0.9997922, 'binary_precision': 0.9620081, 'binary_recall': 0.96462584, 'binary_specificity': 0.99867684, 'binary_f1_score': 0.9633152}
confusion matrix:
       0     1
0  42266    56
1     52  1418
---- Validation: 
scalar performance:
{'acc': 0.9882397, 'precision': 0.92505026, 'recall': 0.89115393, 'specificity': 0.89115393, 'f1': 0.90734136, 'auroc': 0.9863313, 'binary_precision': 0.8576271, 'binary_recall': 0.7869362, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.8207624}
confusion matrix:
       0    1
0  18065   84
1    137  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7494137, 'recall': 0.5258194, 'specificity': 0.5258194, 'f1': 0.5381909, 'auroc': 0.901441, 'binary_precision': 0.53846157, 'binary_recall': 0.053639848, 'binary_specificity': 0.997999, 'binary_f1_score': 0.09756098}
confusion matrix:
      0   1
0  5985  12
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_25.png
early stop counter: 9
val acc:0.9882397055625916, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.9613295197486877 / 0.963087260723114
after epoch: 25,now: 2024-06-07 14:34:23.916404,epoch time: 0:31:55.031492,used: 13:08:33.123475,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9964377, 'precision': 0.95619756, 'recall': 0.9925833, 'specificity': 0.9925833, 'f1': 0.97363675, 'auroc': 0.99979043, 'binary_precision': 0.912798, 'binary_recall': 0.98845106, 'binary_specificity': 0.9967155, 'binary_f1_score': 0.9491193}
confusion matrix:
       0     1
0  42181   139
1     17  1455
---- Validation: 
scalar performance:
{'acc': 0.9879204, 'precision': 0.9020301, 'recall': 0.91949075, 'specificity': 0.91949075, 'f1': 0.91055876, 'auroc': 0.9858071, 'binary_precision': 0.8095238, 'binary_recall': 0.8460342, 'binary_specificity': 0.9929473, 'binary_f1_score': 0.82737637}
confusion matrix:
       0    1
0  18021  128
1     99  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.78094244, 'recall': 0.544643, 'specificity': 0.544643, 'f1': 0.5693781, 'auroc': 0.9189247, 'binary_precision': 0.6, 'binary_recall': 0.09195402, 'binary_specificity': 0.997332, 'binary_f1_score': 0.15946846}
confusion matrix:
      0   1
0  5981  16
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_26.png
early stop counter: 10
val acc:0.9879204034805298, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.9613295197486877 / 0.963087260723114
after epoch: 26,now: 2024-06-07 15:05:54.058830,epoch time: 0:31:30.142426,used: 13:40:03.265901,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9963692, 'precision': 0.9654337, 'recall': 0.97976136, 'specificity': 0.97976136, 'f1': 0.9724804, 'auroc': 0.9995078, 'binary_precision': 0.9321922, 'binary_recall': 0.9619565, 'binary_specificity': 0.99756616, 'binary_f1_score': 0.94684047}
confusion matrix:
       0     1
0  42217   103
1     56  1416
---- Validation: 
scalar performance:
{'acc': 0.98813325, 'precision': 0.92360115, 'recall': 0.89109886, 'specificity': 0.89109886, 'f1': 0.9066491, 'auroc': 0.98700345, 'binary_precision': 0.8547297, 'binary_recall': 0.7869362, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.8194332}
confusion matrix:
       0    1
0  18063   86
1    137  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.78803575, 'recall': 0.5298176, 'specificity': 0.5298176, 'f1': 0.54532313, 'auroc': 0.91776145, 'binary_precision': 0.61538464, 'binary_recall': 0.06130268, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.11149827}
confusion matrix:
      0   1
0  5987  10
1   245  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_27.png
early stop counter: 11
val acc:0.9881332516670227, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.9613295197486877 / 0.963087260723114
after epoch: 27,now: 2024-06-07 15:37:42.736643,epoch time: 0:31:48.677813,used: 14:11:51.943714,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9964834, 'precision': 0.9726255, 'recall': 0.97324574, 'specificity': 0.97324574, 'f1': 0.97293544, 'auroc': 0.99953103, 'binary_precision': 0.9470468, 'binary_recall': 0.94833446, 'binary_specificity': 0.99815696, 'binary_f1_score': 0.94769025}
confusion matrix:
       0     1
0  42243    78
1     76  1395
---- Validation: 
scalar performance:
{'acc': 0.98808, 'precision': 0.92696214, 'recall': 0.8858209, 'specificity': 0.8858209, 'f1': 0.9052669, 'auroc': 0.98438597, 'binary_precision': 0.8618308, 'binary_recall': 0.7760498, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.81669396}
confusion matrix:
       0    1
0  18069   80
1    144  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.84547263, 'recall': 0.5847895, 'specificity': 0.5847895, 'f1': 0.6297642, 'auroc': 0.9466294, 'binary_precision': 0.7258065, 'binary_recall': 0.1724138, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.27863777}
confusion matrix:
      0   1
0  5980  17
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_28.png
early stop counter: 12
val acc:0.9880800247192383, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.9613295197486877 / 0.963087260723114
after epoch: 28,now: 2024-06-07 16:09:30.688631,epoch time: 0:31:47.951988,used: 14:43:39.895702,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99463373, 'precision': 0.93519807, 'recall': 0.9906572, 'specificity': 0.9906572, 'f1': 0.9611286, 'auroc': 0.9996735, 'binary_precision': 0.8708709, 'binary_recall': 0.9863946, 'binary_specificity': 0.9949199, 'binary_f1_score': 0.9250399}
confusion matrix:
       0     1
0  42107   215
1     20  1450
---- Validation: 
scalar performance:
{'acc': 0.9852597, 'precision': 0.8794322, 'recall': 0.9061124, 'specificity': 0.9061124, 'f1': 0.89227843, 'auroc': 0.98385674, 'binary_precision': 0.76521736, 'binary_recall': 0.82115084, 'binary_specificity': 0.9910739, 'binary_f1_score': 0.79219806}
confusion matrix:
       0    1
0  17987  162
1    115  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8122984, 'recall': 0.56929713, 'specificity': 0.56929713, 'f1': 0.6067594, 'auroc': 0.92848307, 'binary_precision': 0.66071427, 'binary_recall': 0.14176245, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.23343849}
confusion matrix:
      0   1
0  5978  19
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_29.png
early stop counter: 13
val acc:0.9852597117424011, best validation acc: 0.9889847040176392, corresponding to test acc:                         0.9613295197486877 / 0.963087260723114
after epoch: 29,now: 2024-06-07 16:41:43.583018,epoch time: 0:32:12.894387,used: 15:15:52.790089,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9981047, 'precision': 0.99424237, 'recall': 0.9763812, 'specificity': 0.9763812, 'f1': 0.98513526, 'auroc': 0.9998989, 'binary_precision': 0.990113, 'binary_recall': 0.9530931, 'binary_specificity': 0.9996692, 'binary_f1_score': 0.9712505}
confusion matrix:
       0     1
0  42307    14
1     69  1402
---- Validation: 
scalar performance:
{'acc': 0.9891443, 'precision': 0.9444331, 'recall': 0.8841217, 'specificity': 0.8841217, 'f1': 0.9119126, 'auroc': 0.9850265, 'binary_precision': 0.89692587, 'binary_recall': 0.7713841, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.8294315}
confusion matrix:
       0    1
0  18092   57
1    147  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.837801, 'recall': 0.5376472, 'specificity': 0.5376472, 'f1': 0.55902183, 'auroc': 0.93176746, 'binary_precision': 0.71428573, 'binary_recall': 0.07662835, 'binary_specificity': 0.998666, 'binary_f1_score': 0.1384083}
confusion matrix:
      0   1
0  5989   8
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_30.png
better model found
persisted
after epoch: 30,now: 2024-06-07 17:13:25.345252,epoch time: 0:31:41.762234,used: 15:47:34.552323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_01_25_50_seed_0_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:47:34.552323 at 2024-06-07 17:13:25.345252
persisted model performance metric: 

scalar performance:
{'acc': 0.9606903, 'precision': 0.8518574, 'recall': 0.5433943, 'specificity': 0.5433943, 'f1': 0.56870496, 'auroc': 0.9374944, 'binary_precision': 0.7419355, 'binary_recall': 0.08812261, 'binary_specificity': 0.998666, 'binary_f1_score': 0.15753424}
confusion matrix:
      0   1
0  5989   8
1   238  23
oracle model performance metric: 

scalar performance:
{'acc': 0.9637264, 'precision': 0.91699445, 'recall': 0.57612807, 'specificity': 0.57612807, 'f1': 0.6209967, 'auroc': 0.9595213, 'binary_precision': 0.8695652, 'binary_recall': 0.1532567, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.2605863}
confusion matrix:
      0   1
0  5991   6
1   221  40
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1669 MiB |   3199 MiB |    873 TiB |    873 TiB |
|       from large pool |   1662 MiB |   3192 MiB |    862 TiB |    862 TiB |
|       from small pool |      6 MiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1669 MiB |   3199 MiB |    873 TiB |    873 TiB |
|       from large pool |   1662 MiB |   3192 MiB |    862 TiB |    862 TiB |
|       from small pool |      6 MiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |   3184 MiB |    872 TiB |    872 TiB |
|       from large pool |   1647 MiB |   3177 MiB |    860 TiB |    860 TiB |
|       from small pool |      5 MiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3476 MiB |   3476 MiB |   3476 MiB |      0 B   |
|       from large pool |   3464 MiB |   3464 MiB |   3464 MiB |      0 B   |
|       from small pool |     12 MiB |     12 MiB |     12 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 275054 KiB | 312915 KiB | 507549 GiB | 507549 GiB |
|       from large pool | 271504 KiB | 309392 KiB | 496046 GiB | 496046 GiB |
|       from small pool |   3550 KiB |   3881 KiB |  11503 GiB |  11503 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3366    |    6337    |  140836 K  |  140832 K  |
|       from large pool |     247    |     352    |   54216 K  |   54215 K  |
|       from small pool |    3119    |    6089    |   86619 K  |   86616 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3366    |    6337    |  140836 K  |  140832 K  |
|       from large pool |     247    |     352    |   54216 K  |   54215 K  |
|       from small pool |    3119    |    6089    |   86619 K  |   86616 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     137    |     137    |     137    |       0    |
|       from large pool |     131    |     131    |     131    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      99    |    2827    |   79395 K  |   79395 K  |
|       from large pool |      81    |     117    |   41501 K  |   41501 K  |
|       from small pool |      18    |    2746    |   37894 K  |   37893 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3199 MiB |    873 TiB |    873 TiB |
|       from large pool |  16640 KiB |   3192 MiB |    862 TiB |    862 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3199 MiB |    873 TiB |    873 TiB |
|       from large pool |  16640 KiB |   3192 MiB |    862 TiB |    862 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |    872 TiB |    872 TiB |
|       from large pool |  16640 KiB |   3177 MiB |    860 TiB |    860 TiB |
|       from small pool |      0 KiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1938 MiB |   3476 MiB |   3476 MiB |   1538 MiB |
|       from large pool |   1928 MiB |   3464 MiB |   3464 MiB |   1536 MiB |
|       from small pool |     10 MiB |     12 MiB |     12 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 319776 KiB | 507551 GiB | 507551 GiB |
|       from large pool |  24320 KiB | 315536 KiB | 496047 GiB | 496047 GiB |
|       from small pool |      0 KiB |   9141 KiB |  11503 GiB |  11503 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6337    |  140836 K  |  140836 K  |
|       from large pool |       2    |     352    |   54216 K  |   54216 K  |
|       from small pool |       0    |    6089    |   86619 K  |   86619 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6337    |  140836 K  |  140836 K  |
|       from large pool |       2    |     352    |   54216 K  |   54216 K  |
|       from small pool |       0    |    6089    |   86619 K  |   86619 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     137    |     137    |      44    |
|       from large pool |      88    |     131    |     131    |      43    |
|       from small pool |       5    |       6    |       6    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2827    |   79396 K  |   79396 K  |
|       from large pool |       3    |     117    |   41501 K  |   41501 K  |
|       from small pool |       0    |    2746    |   37895 K  |   37895 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3199 MiB |    873 TiB |    873 TiB |
|       from large pool |  16640 KiB |   3192 MiB |    862 TiB |    862 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3199 MiB |    873 TiB |    873 TiB |
|       from large pool |  16640 KiB |   3192 MiB |    862 TiB |    862 TiB |
|       from small pool |      0 KiB |     11 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |    872 TiB |    872 TiB |
|       from large pool |  16640 KiB |   3177 MiB |    860 TiB |    860 TiB |
|       from small pool |      0 KiB |      9 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1938 MiB |   3476 MiB |   3476 MiB |   1538 MiB |
|       from large pool |   1928 MiB |   3464 MiB |   3464 MiB |   1536 MiB |
|       from small pool |     10 MiB |     12 MiB |     12 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 319776 KiB | 507551 GiB | 507551 GiB |
|       from large pool |  24320 KiB | 315536 KiB | 496047 GiB | 496047 GiB |
|       from small pool |      0 KiB |   9141 KiB |  11503 GiB |  11503 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6337    |  140836 K  |  140836 K  |
|       from large pool |       2    |     352    |   54216 K  |   54216 K  |
|       from small pool |       0    |    6089    |   86619 K  |   86619 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6337    |  140836 K  |  140836 K  |
|       from large pool |       2    |     352    |   54216 K  |   54216 K  |
|       from small pool |       0    |    6089    |   86619 K  |   86619 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      93    |     137    |     137    |      44    |
|       from large pool |      88    |     131    |     131    |      43    |
|       from small pool |       5    |       6    |       6    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2827    |   79396 K  |   79396 K  |
|       from large pool |       3    |     117    |   41501 K  |   41501 K  |
|       from small pool |       0    |    2746    |   37895 K  |   37895 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178

 Experiment start at: 2024-06-07 17:24:53.557029
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.06461489200592041
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97202206, 'precision': 0.85640454, 'recall': 0.6140736, 'specificity': 0.6140736, 'f1': 0.6687625, 'auroc': 0.9637625, 'binary_precision': 0.7383592, 'binary_recall': 0.23092927, 'binary_specificity': 0.9972179, 'binary_f1_score': 0.35182253}
confusion matrix:
       0    1
0  42296  118
1   1109  333
---- Validation: 
scalar performance:
{'acc': 0.9683031, 'precision': 0.8285005, 'recall': 0.6066153, 'specificity': 0.6066153, 'f1': 0.6566695, 'auroc': 0.96580744, 'binary_precision': 0.685446, 'binary_recall': 0.21693908, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.3295711}
confusion matrix:
       0    1
0  18000   67
1    527  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.9170902, 'recall': 0.5133774, 'specificity': 0.5133774, 'f1': 0.51566154, 'auroc': 0.94407165, 'binary_precision': 0.875, 'binary_recall': 0.026923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5945  1
1   253  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-07 17:57:45.316256,epoch time: 0:32:51.759227,used: 0:32:51.759227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.978247, 'precision': 0.89742243, 'recall': 0.7177775, 'specificity': 0.7177775, 'f1': 0.7795557, 'auroc': 0.976791, 'binary_precision': 0.8136247, 'binary_recall': 0.43897364, 'binary_specificity': 0.9965813, 'binary_f1_score': 0.5702703}
confusion matrix:
       0    1
0  42269  145
1    809  633
---- Validation: 
scalar performance:
{'acc': 0.97241193, 'precision': 0.8638694, 'recall': 0.67097455, 'specificity': 0.67097455, 'f1': 0.72994673, 'auroc': 0.9705315, 'binary_precision': 0.7516129, 'binary_recall': 0.346211, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.47405902}
confusion matrix:
       0    1
0  17990   77
1    440  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.85450953, 'recall': 0.5113703, 'specificity': 0.5113703, 'f1': 0.51184785, 'auroc': 0.9459787, 'binary_precision': 0.75, 'binary_recall': 0.023076924, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.04477612}
confusion matrix:
      0  1
0  5944  2
1   254  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_2.png
better model found
persisted
after epoch: 2,now: 2024-06-07 18:29:21.333722,epoch time: 0:31:36.017466,used: 1:04:27.776693,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98219174, 'precision': 0.9146011, 'recall': 0.7794384, 'specificity': 0.7794384, 'f1': 0.83291733, 'auroc': 0.9839737, 'binary_precision': 0.8439126, 'binary_recall': 0.56241333, 'binary_specificity': 0.9964634, 'binary_f1_score': 0.67498964}
confusion matrix:
       0    1
0  42264  150
1    631  811
---- Validation: 
scalar performance:
{'acc': 0.9783885, 'precision': 0.9273586, 'recall': 0.7312955, 'specificity': 0.7312955, 'f1': 0.798033, 'auroc': 0.9763408, 'binary_precision': 0.8743017, 'binary_recall': 0.46508172, 'binary_specificity': 0.9975093, 'binary_f1_score': 0.6071775}
confusion matrix:
       0    1
0  18022   45
1    360  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.97951615, 'recall': 0.51153845, 'specificity': 0.51153845, 'f1': 0.5121002, 'auroc': 0.9511452, 'binary_precision': 1.0, 'binary_recall': 0.023076924, 'binary_specificity': 1.0, 'binary_f1_score': 0.045112785}
confusion matrix:
      0  1
0  5946  0
1   254  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_3.png
better model found
persisted
after epoch: 3,now: 2024-06-07 19:01:16.186369,epoch time: 0:31:54.852647,used: 1:36:22.629340,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9856804, 'precision': 0.9079885, 'recall': 0.85526645, 'specificity': 0.85526645, 'f1': 0.87966484, 'auroc': 0.98665774, 'binary_precision': 0.8256, 'binary_recall': 0.7156727, 'binary_specificity': 0.9948602, 'binary_f1_score': 0.7667162}
confusion matrix:
       0     1
0  42196   218
1    410  1032
---- Validation: 
scalar performance:
{'acc': 0.98121667, 'precision': 0.917835, 'recall': 0.78712255, 'specificity': 0.78712255, 'f1': 0.83940595, 'auroc': 0.9784081, 'binary_precision': 0.8512035, 'binary_recall': 0.5780089, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.6884956}
confusion matrix:
       0    1
0  17999   68
1    284  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.83657503, 'recall': 0.5094472, 'specificity': 0.5094472, 'f1': 0.5081461, 'auroc': 0.95093894, 'binary_precision': 0.71428573, 'binary_recall': 0.01923077, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.037453186}
confusion matrix:
      0  1
0  5944  2
1   255  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_4.png
better model found
persisted
after epoch: 4,now: 2024-06-07 19:33:19.607586,epoch time: 0:32:03.421217,used: 2:08:26.050557,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98009396, 'precision': 0.89897525, 'recall': 0.75356734, 'specificity': 0.75356734, 'f1': 0.8089045, 'auroc': 0.98448, 'binary_precision': 0.8143646, 'binary_recall': 0.5110957, 'binary_specificity': 0.99603903, 'binary_f1_score': 0.6280358}
confusion matrix:
       0    1
0  42246  168
1    705  737
---- Validation: 
scalar performance:
{'acc': 0.9767343, 'precision': 0.8764047, 'recall': 0.747604, 'specificity': 0.747604, 'f1': 0.7976097, 'auroc': 0.97134936, 'binary_precision': 0.77116704, 'binary_recall': 0.5007429, 'binary_specificity': 0.99446505, 'binary_f1_score': 0.6072072}
confusion matrix:
       0    1
0  17967  100
1    336  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.94394696, 'recall': 0.5479087, 'specificity': 0.5479087, 'f1': 0.5773349, 'auroc': 0.9505961, 'binary_precision': 0.9259259, 'binary_recall': 0.09615385, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.17421603}
confusion matrix:
      0   1
0  5944   2
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_5.png
new oracle model saved
early stop counter: 1
val acc:0.9767342805862427, best validation acc: 0.9812166690826416, corresponding to test acc:                         0.9585884809494019 / 0.9618111252784729
after epoch: 5,now: 2024-06-07 20:05:02.463755,epoch time: 0:31:42.856169,used: 2:40:08.906726,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9878694, 'precision': 0.93353784, 'recall': 0.8657768, 'specificity': 0.8657768, 'f1': 0.89657116, 'auroc': 0.9918288, 'binary_precision': 0.87603307, 'binary_recall': 0.73509014, 'binary_specificity': 0.9964634, 'binary_f1_score': 0.7993967}
confusion matrix:
       0     1
0  42264   150
1    382  1060
---- Validation: 
scalar performance:
{'acc': 0.9842583, 'precision': 0.9333179, 'recall': 0.8237481, 'specificity': 0.8237481, 'f1': 0.869977, 'auroc': 0.9818497, 'binary_precision': 0.8795181, 'binary_recall': 0.6508172, 'binary_specificity': 0.996679, 'binary_f1_score': 0.7480786}
confusion matrix:
       0    1
0  18007   60
1    235  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.8888326, 'recall': 0.5171395, 'specificity': 0.5171395, 'f1': 0.5227911, 'auroc': 0.9476814, 'binary_precision': 0.8181818, 'binary_recall': 0.034615386, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.06642067}
confusion matrix:
      0  1
0  5944  2
1   251  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_6.png
better model found
persisted
after epoch: 6,now: 2024-06-07 20:36:12.880233,epoch time: 0:31:10.416478,used: 3:11:19.323204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9874818, 'precision': 0.8849041, 'recall': 0.93290174, 'specificity': 0.93290174, 'f1': 0.90737236, 'auroc': 0.99246144, 'binary_precision': 0.7740945, 'binary_recall': 0.8744799, 'binary_specificity': 0.9913236, 'binary_f1_score': 0.8212309}
confusion matrix:
       0     1
0  42046   368
1    181  1261
---- Validation: 
scalar performance:
{'acc': 0.984952, 'precision': 0.8816358, 'recall': 0.90994, 'specificity': 0.90994, 'f1': 0.89523387, 'auroc': 0.98090917, 'binary_precision': 0.76965517, 'binary_recall': 0.8291233, 'binary_specificity': 0.99075663, 'binary_f1_score': 0.7982833}
confusion matrix:
       0    1
0  17900  167
1    115  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.96090925, 'recall': 0.54606974, 'specificity': 0.54606974, 'f1': 0.5744389, 'auroc': 0.9603281, 'binary_precision': 0.96, 'binary_recall': 0.092307694, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.16842106}
confusion matrix:
      0   1
0  5945   1
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_7.png
better model found
persisted
after epoch: 7,now: 2024-06-07 21:07:25.961435,epoch time: 0:31:13.081202,used: 3:42:32.404406,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9896023, 'precision': 0.9212426, 'recall': 0.913901, 'specificity': 0.913901, 'f1': 0.917537, 'auroc': 0.99322194, 'binary_precision': 0.84816384, 'binary_recall': 0.832871, 'binary_specificity': 0.9949309, 'binary_f1_score': 0.8404479}
confusion matrix:
       0     1
0  42199   215
1    241  1201
---- Validation: 
scalar performance:
{'acc': 0.9851654, 'precision': 0.9035009, 'recall': 0.8757179, 'specificity': 0.8757179, 'f1': 0.8890705, 'auroc': 0.98157454, 'binary_precision': 0.816, 'binary_recall': 0.7578009, 'binary_specificity': 0.9936348, 'binary_f1_score': 0.78582436}
confusion matrix:
       0    1
0  17952  115
1    163  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.95901453, 'recall': 0.5422236, 'specificity': 0.5422236, 'f1': 0.5678861, 'auroc': 0.94955, 'binary_precision': 0.95652175, 'binary_recall': 0.08461539, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.15547705}
confusion matrix:
      0   1
0  5945   1
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_8.png
better model found
persisted
after epoch: 8,now: 2024-06-07 21:39:03.301880,epoch time: 0:31:37.340445,used: 4:14:09.744851,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9908108, 'precision': 0.9380049, 'recall': 0.91419077, 'specificity': 0.91419077, 'f1': 0.9257396, 'auroc': 0.99555767, 'binary_precision': 0.8817046, 'binary_recall': 0.8321775, 'binary_specificity': 0.9962041, 'binary_f1_score': 0.85622543}
confusion matrix:
       0     1
0  42253   161
1    242  1200
---- Validation: 
scalar performance:
{'acc': 0.98527217, 'precision': 0.91192937, 'recall': 0.8657595, 'specificity': 0.8657595, 'f1': 0.8873563, 'auroc': 0.9811389, 'binary_precision': 0.83361346, 'binary_recall': 0.7369985, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.7823343}
confusion matrix:
       0    1
0  17968   99
1    177  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.84115314, 'recall': 0.5245795, 'specificity': 0.5245795, 'f1': 0.53637856, 'auroc': 0.9264058, 'binary_precision': 0.7222222, 'binary_recall': 0.05, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.093525186}
confusion matrix:
      0   1
0  5941   5
1   247  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_9.png
better model found
persisted
after epoch: 9,now: 2024-06-07 22:10:48.726433,epoch time: 0:31:45.424553,used: 4:45:55.169404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9917001, 'precision': 0.94387466, 'recall': 0.92302436, 'specificity': 0.92302436, 'f1': 0.9331796, 'auroc': 0.9966257, 'binary_precision': 0.89285713, 'binary_recall': 0.84951454, 'binary_specificity': 0.99653417, 'binary_f1_score': 0.8706467}
confusion matrix:
       0     1
0  42267   147
1    217  1225
---- Validation: 
scalar performance:
{'acc': 0.9864461, 'precision': 0.91979975, 'recall': 0.876382, 'specificity': 0.876382, 'f1': 0.89680624, 'auroc': 0.983161, 'binary_precision': 0.84858567, 'binary_recall': 0.7578009, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.8006279}
confusion matrix:
       0    1
0  17976   91
1    163  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.98005813, 'recall': 0.525, 'specificity': 0.525, 'f1': 0.53744525, 'auroc': 0.9465334, 'binary_precision': 1.0, 'binary_recall': 0.05, 'binary_specificity': 1.0, 'binary_f1_score': 0.095238104}
confusion matrix:
      0   1
0  5946   0
1   247  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_10.png
better model found
persisted
after epoch: 10,now: 2024-06-07 22:42:30.596702,epoch time: 0:31:41.870269,used: 5:17:37.039673,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9918369, 'precision': 0.9542957, 'recall': 0.91338146, 'specificity': 0.91338146, 'f1': 0.93280226, 'auroc': 0.9966254, 'binary_precision': 0.9143731, 'binary_recall': 0.8294036, 'binary_specificity': 0.99735934, 'binary_f1_score': 0.8698182}
confusion matrix:
       0     1
0  42302   112
1    246  1196
---- Validation: 
scalar performance:
{'acc': 0.9854856, 'precision': 0.9297552, 'recall': 0.8479885, 'specificity': 0.8479885, 'f1': 0.8842236, 'auroc': 0.98105395, 'binary_precision': 0.87061, 'binary_recall': 0.6998514, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.7759473}
confusion matrix:
       0    1
0  17997   70
1    202  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.9796709, 'recall': 0.5153846, 'specificity': 0.5153846, 'f1': 0.5194752, 'auroc': 0.9305739, 'binary_precision': 1.0, 'binary_recall': 0.03076923, 'binary_specificity': 1.0, 'binary_f1_score': 0.05970149}
confusion matrix:
      0  1
0  5946  0
1   252  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_11.png
early stop counter: 1
val acc:0.9854856133460999, best validation acc: 0.9864460825920105, corresponding to test acc:                         0.9601998329162598 / 0.9618111252784729
after epoch: 11,now: 2024-06-07 23:13:53.807015,epoch time: 0:31:23.210313,used: 5:49:00.249986,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.992179, 'precision': 0.9552592, 'recall': 0.91824764, 'specificity': 0.91824764, 'f1': 0.93591094, 'auroc': 0.9973593, 'binary_precision': 0.91597277, 'binary_recall': 0.83911234, 'binary_specificity': 0.99738294, 'binary_f1_score': 0.87585956}
confusion matrix:
       0     1
0  42303   111
1    232  1210
---- Validation: 
scalar performance:
{'acc': 0.98457843, 'precision': 0.9219811, 'recall': 0.84108055, 'specificity': 0.84108055, 'f1': 0.8768895, 'auroc': 0.9808922, 'binary_precision': 0.85555553, 'binary_recall': 0.68647844, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.7617478}
confusion matrix:
       0    1
0  17989   78
1    211  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.9371946, 'recall': 0.54021645, 'specificity': 0.54021645, 'f1': 0.5642701, 'auroc': 0.9401988, 'binary_precision': 0.9130435, 'binary_recall': 0.08076923, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.1484099}
confusion matrix:
      0   1
0  5944   2
1   239  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_12.png
early stop counter: 2
val acc:0.9845784306526184, best validation acc: 0.9864460825920105, corresponding to test acc:                         0.9601998329162598 / 0.9618111252784729
after epoch: 12,now: 2024-06-07 23:45:21.173302,epoch time: 0:31:27.366287,used: 6:20:27.616273,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9937979, 'precision': 0.9663991, 'recall': 0.9338225, 'specificity': 0.9338225, 'f1': 0.9494779, 'auroc': 0.9977827, 'binary_precision': 0.93721974, 'binary_recall': 0.8696255, 'binary_specificity': 0.9980195, 'binary_f1_score': 0.9021583}
confusion matrix:
       0     1
0  42330    84
1    188  1254
---- Validation: 
scalar performance:
{'acc': 0.98671293, 'precision': 0.9356156, 'recall': 0.86221504, 'specificity': 0.86221504, 'f1': 0.8952638, 'auroc': 0.98148584, 'binary_precision': 0.88129497, 'binary_recall': 0.7280832, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.79739624}
confusion matrix:
       0    1
0  18001   66
1    183  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.924112, 'recall': 0.5153005, 'specificity': 0.5153005, 'f1': 0.5193222, 'auroc': 0.90979874, 'binary_precision': 0.8888889, 'binary_recall': 0.03076923, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.059479553}
confusion matrix:
      0  1
0  5945  1
1   252  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_13.png
better model found
persisted
after epoch: 13,now: 2024-06-08 00:17:05.024378,epoch time: 0:31:43.851076,used: 6:52:11.467349,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99425393, 'precision': 0.97122014, 'recall': 0.9364029, 'specificity': 0.9364029, 'f1': 0.9530948, 'auroc': 0.9987149, 'binary_precision': 0.9466967, 'binary_recall': 0.8744799, 'binary_specificity': 0.998326, 'binary_f1_score': 0.90915644}
confusion matrix:
       0     1
0  42343    71
1    181  1261
---- Validation: 
scalar performance:
{'acc': 0.9874066, 'precision': 0.93863106, 'recall': 0.87044275, 'specificity': 0.87044275, 'f1': 0.90142906, 'auroc': 0.9781023, 'binary_precision': 0.88672566, 'binary_recall': 0.7444279, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.8093699}
confusion matrix:
       0    1
0  18003   64
1    172  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.92773044, 'recall': 0.5325241, 'specificity': 0.5325241, 'f1': 0.5508355, 'auroc': 0.90728235, 'binary_precision': 0.8947368, 'binary_recall': 0.06538462, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.121863805}
confusion matrix:
      0   1
0  5944   2
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_14.png
better model found
persisted
after epoch: 14,now: 2024-06-08 00:48:49.206972,epoch time: 0:31:44.182594,used: 7:23:55.649943,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98855346, 'precision': 0.9895518, 'recall': 0.82883215, 'specificity': 0.82883215, 'f1': 0.8923874, 'auroc': 0.99822223, 'binary_precision': 0.99059564, 'binary_recall': 0.6578765, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.79065895}
confusion matrix:
       0    1
0  42406    9
1    493  948
---- Validation: 
scalar performance:
{'acc': 0.98041624, 'precision': 0.96292514, 'recall': 0.7409303, 'specificity': 0.7409303, 'f1': 0.81453484, 'auroc': 0.97944653, 'binary_precision': 0.9447674, 'binary_recall': 0.48291233, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.6391347}
confusion matrix:
       0    1
0  18048   19
1    348  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.9792842, 'recall': 0.50576925, 'specificity': 0.50576925, 'f1': 0.5008299, 'auroc': 0.8834144, 'binary_precision': 1.0, 'binary_recall': 0.011538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.022813687}
confusion matrix:
      0  1
0  5946  0
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_15.png
early stop counter: 1
val acc:0.9804162383079529, best validation acc: 0.9874066114425659, corresponding to test acc:                         0.9605220556259155 / 0.9618111252784729
after epoch: 15,now: 2024-06-08 01:20:18.944967,epoch time: 0:31:29.737995,used: 7:55:25.387938,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9940487, 'precision': 0.97905576, 'recall': 0.92524344, 'specificity': 0.92524344, 'f1': 0.9504337, 'auroc': 0.9986664, 'binary_precision': 0.96313727, 'binary_recall': 0.851595, 'binary_specificity': 0.9988919, 'binary_f1_score': 0.9039382}
confusion matrix:
       0     1
0  42367    47
1    214  1228
---- Validation: 
scalar performance:
{'acc': 0.9867663, 'precision': 0.94187737, 'recall': 0.8565206, 'specificity': 0.8565206, 'f1': 0.8942708, 'auroc': 0.9821187, 'binary_precision': 0.8942486, 'binary_recall': 0.7161961, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.7953795}
confusion matrix:
       0    1
0  18010   57
1    191  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.75720334, 'recall': 0.509279, 'specificity': 0.509279, 'f1': 0.50792277, 'auroc': 0.92050946, 'binary_precision': 0.5555556, 'binary_recall': 0.01923077, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.037174724}
confusion matrix:
      0  1
0  5942  4
1   255  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_16.png
early stop counter: 2
val acc:0.9867662787437439, best validation acc: 0.9874066114425659, corresponding to test acc:                         0.9605220556259155 / 0.9618111252784729
after epoch: 16,now: 2024-06-08 01:51:39.762813,epoch time: 0:31:20.817846,used: 8:26:46.205784,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9953712, 'precision': 0.97818804, 'recall': 0.9476632, 'specificity': 0.9476632, 'f1': 0.9623857, 'auroc': 0.99873567, 'binary_precision': 0.9598811, 'binary_recall': 0.8965996, 'binary_specificity': 0.99872684, 'binary_f1_score': 0.9271618}
confusion matrix:
       0     1
0  42361    54
1    149  1292
---- Validation: 
scalar performance:
{'acc': 0.9867663, 'precision': 0.94258463, 'recall': 0.85580534, 'specificity': 0.85580534, 'f1': 0.89410186, 'auroc': 0.9823477, 'binary_precision': 0.89571697, 'binary_recall': 0.71471024, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.7950413}
confusion matrix:
       0    1
0  18011   56
1    192  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.88450956, 'recall': 0.53996414, 'specificity': 0.53996414, 'f1': 0.5633656, 'auroc': 0.9393568, 'binary_precision': 0.8076923, 'binary_recall': 0.08076923, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.14685315}
confusion matrix:
      0   1
0  5941   5
1   239  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_17.png
early stop counter: 3
val acc:0.9867662787437439, best validation acc: 0.9874066114425659, corresponding to test acc:                         0.9605220556259155 / 0.9618111252784729
after epoch: 17,now: 2024-06-08 02:23:01.172584,epoch time: 0:31:21.409771,used: 8:58:07.615555,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99585, 'precision': 0.97875684, 'recall': 0.9549806, 'specificity': 0.9549806, 'f1': 0.96654385, 'auroc': 0.99915063, 'binary_precision': 0.9605263, 'binary_recall': 0.9112344, 'binary_specificity': 0.99872684, 'binary_f1_score': 0.9352313}
confusion matrix:
       0     1
0  42360    54
1    128  1314
---- Validation: 
scalar performance:
{'acc': 0.98751336, 'precision': 0.9449889, 'recall': 0.8654913, 'specificity': 0.8654913, 'f1': 0.9010284, 'auroc': 0.97550106, 'binary_precision': 0.8998178, 'binary_recall': 0.73402673, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.8085106}
confusion matrix:
       0    1
0  18012   55
1    179  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.8684758, 'recall': 0.5132934, 'specificity': 0.5132934, 'f1': 0.5155224, 'auroc': 0.806718, 'binary_precision': 0.7777778, 'binary_recall': 0.026923077, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.05204461}
confusion matrix:
      0  1
0  5944  2
1   253  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_18.png
better model found
persisted
after epoch: 18,now: 2024-06-08 02:54:26.229092,epoch time: 0:31:25.056508,used: 9:29:32.672063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9953484, 'precision': 0.95950615, 'recall': 0.9681194, 'specificity': 0.9681194, 'f1': 0.9637697, 'auroc': 0.9989785, 'binary_precision': 0.92108846, 'binary_recall': 0.93897367, 'binary_specificity': 0.99726504, 'binary_f1_score': 0.9299451}
confusion matrix:
       0     1
0  42298   116
1     88  1354
---- Validation: 
scalar performance:
{'acc': 0.98703307, 'precision': 0.9236793, 'recall': 0.88169336, 'specificity': 0.88169336, 'f1': 0.90149903, 'auroc': 0.9837004, 'binary_precision': 0.85596025, 'binary_recall': 0.76820207, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.80971026}
confusion matrix:
       0    1
0  17980   87
1    156  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7693509, 'recall': 0.5204811, 'specificity': 0.5204811, 'f1': 0.5288356, 'auroc': 0.9155407, 'binary_precision': 0.57894737, 'binary_recall': 0.042307694, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.07885305}
confusion matrix:
      0   1
0  5938   8
1   249  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_19.png
early stop counter: 1
val acc:0.9870330691337585, best validation acc: 0.9875133633613586, corresponding to test acc:                         0.9589107036590576 / 0.9618111252784729
after epoch: 19,now: 2024-06-08 03:25:49.499386,epoch time: 0:31:23.270294,used: 10:00:55.942357,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99464154, 'precision': 0.98430645, 'recall': 0.92990434, 'specificity': 0.92990434, 'f1': 0.9553714, 'auroc': 0.99893486, 'binary_precision': 0.97333336, 'binary_recall': 0.86061025, 'binary_specificity': 0.9991984, 'binary_f1_score': 0.9135076}
confusion matrix:
       0     1
0  42380    34
1    201  1241
---- Validation: 
scalar performance:
{'acc': 0.9864461, 'precision': 0.94928503, 'recall': 0.844195, 'specificity': 0.844195, 'f1': 0.88923746, 'auroc': 0.9755883, 'binary_precision': 0.9099804, 'binary_recall': 0.6909361, 'binary_specificity': 0.9974539, 'binary_f1_score': 0.7854729}
confusion matrix:
       0    1
0  18021   46
1    208  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.81253695, 'recall': 0.50376207, 'specificity': 0.50376207, 'f1': 0.49694523, 'auroc': 0.73029006, 'binary_precision': 0.6666667, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5945  1
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_20.png
early stop counter: 2
val acc:0.9864460825920105, best validation acc: 0.9875133633613586, corresponding to test acc:                         0.9589107036590576 / 0.9618111252784729
after epoch: 20,now: 2024-06-08 03:57:11.396262,epoch time: 0:31:21.896876,used: 10:32:17.839233,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99600965, 'precision': 0.95980394, 'recall': 0.97917974, 'specificity': 0.97917974, 'f1': 0.96927655, 'auroc': 0.99936247, 'binary_precision': 0.9209302, 'binary_recall': 0.9611651, 'binary_specificity': 0.99719435, 'binary_f1_score': 0.9406175}
confusion matrix:
       0     1
0  42295   119
1     56  1386
---- Validation: 
scalar performance:
{'acc': 0.9878335, 'precision': 0.9220502, 'recall': 0.8978443, 'specificity': 0.8978443, 'f1': 0.90955913, 'auroc': 0.9820231, 'binary_precision': 0.8515008, 'binary_recall': 0.8008915, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.8254211}
confusion matrix:
       0    1
0  17973   94
1    134  539
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.93514055, 'recall': 0.53829336, 'specificity': 0.53829336, 'f1': 0.5609467, 'auroc': 0.9212458, 'binary_precision': 0.90909094, 'binary_recall': 0.07692308, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.14184397}
confusion matrix:
      0   1
0  5944   2
1   240  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_21.png
better model found
persisted
after epoch: 21,now: 2024-06-08 04:28:54.692996,epoch time: 0:31:43.296734,used: 11:04:01.135967,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9960325, 'precision': 0.9884118, 'recall': 0.9483759, 'specificity': 0.9483759, 'f1': 0.96747696, 'auroc': 0.9994813, 'binary_precision': 0.98030305, 'binary_recall': 0.8973648, 'binary_specificity': 0.99938697, 'binary_f1_score': 0.9370022}
confusion matrix:
       0     1
0  42388    26
1    148  1294
---- Validation: 
scalar performance:
{'acc': 0.9863394, 'precision': 0.94302654, 'recall': 0.8484312, 'specificity': 0.8484312, 'f1': 0.88962734, 'auroc': 0.97930664, 'binary_precision': 0.8971428, 'binary_recall': 0.6998514, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.78631055}
confusion matrix:
       0    1
0  18013   54
1    202  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.89610213, 'recall': 0.50953126, 'specificity': 0.50953126, 'f1': 0.5082585, 'auroc': 0.91325563, 'binary_precision': 0.8333333, 'binary_recall': 0.01923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.037593987}
confusion matrix:
      0  1
0  5945  1
1   255  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_22.png
early stop counter: 1
val acc:0.9863393902778625, best validation acc: 0.9878334999084473, corresponding to test acc:                         0.961005449295044 / 0.9618111252784729
after epoch: 22,now: 2024-06-08 05:00:58.509032,epoch time: 0:32:03.816036,used: 11:36:04.952003,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99664813, 'precision': 0.9865352, 'recall': 0.96008253, 'specificity': 0.96008253, 'f1': 0.97291243, 'auroc': 0.99938023, 'binary_precision': 0.9757531, 'binary_recall': 0.92094314, 'binary_specificity': 0.999222, 'binary_f1_score': 0.9475562}
confusion matrix:
       0     1
0  42381    33
1    114  1328
---- Validation: 
scalar performance:
{'acc': 0.98596585, 'precision': 0.92849433, 'recall': 0.857536, 'specificity': 0.857536, 'f1': 0.8895486, 'auroc': 0.9805666, 'binary_precision': 0.86738354, 'binary_recall': 0.7191679, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.7863526}
confusion matrix:
       0    1
0  17993   74
1    189  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.9343679, 'recall': 0.5191467, 'specificity': 0.5191467, 'f1': 0.52656347, 'auroc': 0.8837997, 'binary_precision': 0.90909094, 'binary_recall': 0.03846154, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.07380074}
confusion matrix:
      0   1
0  5945   1
1   250  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_23.png
early stop counter: 2
val acc:0.9859658479690552, best validation acc: 0.9878334999084473, corresponding to test acc:                         0.961005449295044 / 0.9618111252784729
after epoch: 23,now: 2024-06-08 05:33:11.910353,epoch time: 0:32:13.401321,used: 12:08:18.353324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99714977, 'precision': 0.9886617, 'recall': 0.9660361, 'specificity': 0.9660361, 'f1': 0.9770614, 'auroc': 0.9995367, 'binary_precision': 0.9796067, 'binary_recall': 0.93273234, 'binary_specificity': 0.9993398, 'binary_f1_score': 0.9555951}
confusion matrix:
       0     1
0  42386    28
1     97  1345
---- Validation: 
scalar performance:
{'acc': 0.9870865, 'precision': 0.93919504, 'recall': 0.8645546, 'specificity': 0.8645546, 'f1': 0.89812803, 'auroc': 0.98114645, 'binary_precision': 0.88828826, 'binary_recall': 0.73254085, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.80293155}
confusion matrix:
       0    1
0  18005   62
1    180  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.69355655, 'recall': 0.5054329, 'specificity': 0.5054329, 'f1': 0.5004908, 'auroc': 0.85841966, 'binary_precision': 0.42857143, 'binary_recall': 0.011538462, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.02247191}
confusion matrix:
      0  1
0  5942  4
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_24.png
early stop counter: 3
val acc:0.9870864748954773, best validation acc: 0.9878334999084473, corresponding to test acc:                         0.961005449295044 / 0.9618111252784729
after epoch: 24,now: 2024-06-08 06:05:23.325671,epoch time: 0:32:11.415318,used: 12:40:29.768642,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9969217, 'precision': 0.9787132, 'recall': 0.97261727, 'specificity': 0.97261727, 'f1': 0.97564423, 'auroc': 0.99954873, 'binary_precision': 0.95924103, 'binary_recall': 0.9466019, 'binary_specificity': 0.99863255, 'binary_f1_score': 0.95287955}
confusion matrix:
       0     1
0  42356    58
1     77  1365
---- Validation: 
scalar performance:
{'acc': 0.98703307, 'precision': 0.92200994, 'recall': 0.88383913, 'specificity': 0.88383913, 'f1': 0.90194345, 'auroc': 0.98019576, 'binary_precision': 0.852459, 'binary_recall': 0.7726597, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.81060016}
confusion matrix:
       0    1
0  17977   90
1    153  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.93908393, 'recall': 0.54213953, 'specificity': 0.54213953, 'f1': 0.5675703, 'auroc': 0.8824492, 'binary_precision': 0.9166667, 'binary_recall': 0.08461539, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.15492958}
confusion matrix:
      0   1
0  5944   2
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_25.png
early stop counter: 4
val acc:0.9870330691337585, best validation acc: 0.9878334999084473, corresponding to test acc:                         0.961005449295044 / 0.9618111252784729
after epoch: 25,now: 2024-06-08 06:37:31.348053,epoch time: 0:32:08.022382,used: 13:12:37.791024,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9974918, 'precision': 0.99268305, 'recall': 0.9675527, 'specificity': 0.9675527, 'f1': 0.9797653, 'auroc': 0.999827, 'binary_precision': 0.9875549, 'binary_recall': 0.9355062, 'binary_specificity': 0.9995992, 'binary_f1_score': 0.9608262}
confusion matrix:
       0     1
0  42397    17
1     93  1349
---- Validation: 
scalar performance:
{'acc': 0.98788685, 'precision': 0.9451183, 'recall': 0.87140715, 'specificity': 0.87140715, 'f1': 0.9046674, 'auroc': 0.9795116, 'binary_precision': 0.8996416, 'binary_recall': 0.7459138, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.81559706}
confusion matrix:
       0    1
0  18011   56
1    171  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.8727505, 'recall': 0.52090156, 'specificity': 0.52090156, 'f1': 0.52976537, 'auroc': 0.8317615, 'binary_precision': 0.78571427, 'binary_recall': 0.042307694, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.08029198}
confusion matrix:
      0   1
0  5943   3
1   249  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_26.png
better model found
persisted
after epoch: 26,now: 2024-06-08 07:09:44.760661,epoch time: 0:32:13.412608,used: 13:44:51.203632,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9974234, 'precision': 0.9792824, 'recall': 0.98024553, 'specificity': 0.98024553, 'f1': 0.9797635, 'auroc': 0.9996455, 'binary_precision': 0.9598616, 'binary_recall': 0.9618585, 'binary_specificity': 0.99863255, 'binary_f1_score': 0.96085906}
confusion matrix:
       0     1
0  42356    58
1     55  1387
---- Validation: 
scalar performance:
{'acc': 0.9886873, 'precision': 0.9397019, 'recall': 0.8904192, 'specificity': 0.8904192, 'f1': 0.9134766, 'auroc': 0.98048025, 'binary_precision': 0.88739496, 'binary_recall': 0.7845468, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.83280754}
confusion matrix:
       0    1
0  18000   67
1    145  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.85450953, 'recall': 0.5113703, 'specificity': 0.5113703, 'f1': 0.51184785, 'auroc': 0.84284407, 'binary_precision': 0.75, 'binary_recall': 0.023076924, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.04477612}
confusion matrix:
      0  1
0  5944  2
1   254  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_27.png
better model found
persisted
after epoch: 27,now: 2024-06-08 07:41:57.294130,epoch time: 0:32:12.533469,used: 14:17:03.737101,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.997811, 'precision': 0.9898766, 'recall': 0.97542167, 'specificity': 0.97542167, 'f1': 0.98253304, 'auroc': 0.9996705, 'binary_precision': 0.981402, 'binary_recall': 0.9514563, 'binary_specificity': 0.99938697, 'binary_f1_score': 0.9661972}
confusion matrix:
       0     1
0  42388    26
1     70  1372
---- Validation: 
scalar performance:
{'acc': 0.9876734, 'precision': 0.92939234, 'recall': 0.88560176, 'specificity': 0.88560176, 'f1': 0.9062215, 'auroc': 0.98132336, 'binary_precision': 0.86710966, 'binary_recall': 0.7756315, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.81882346}
confusion matrix:
       0    1
0  17987   80
1    151  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.91762924, 'recall': 0.5267549, 'specificity': 0.5267549, 'f1': 0.54050714, 'auroc': 0.84393907, 'binary_precision': 0.875, 'binary_recall': 0.053846154, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.10144927}
confusion matrix:
      0   1
0  5944   2
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_28.png
early stop counter: 1
val acc:0.9876734018325806, best validation acc: 0.98868727684021, corresponding to test acc:                         0.9587495923042297 / 0.9618111252784729
after epoch: 28,now: 2024-06-08 08:13:55.924568,epoch time: 0:31:58.630438,used: 14:49:02.367539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9971726, 'precision': 0.9684373, 'recall': 0.9884896, 'specificity': 0.9884896, 'f1': 0.9782374, 'auroc': 0.9997642, 'binary_precision': 0.937583, 'binary_recall': 0.97919554, 'binary_specificity': 0.9977838, 'binary_f1_score': 0.9579376}
confusion matrix:
       0     1
0  42320    94
1     30  1412
---- Validation: 
scalar performance:
{'acc': 0.98719317, 'precision': 0.9126617, 'recall': 0.899658, 'specificity': 0.899658, 'f1': 0.9060466, 'auroc': 0.9828684, 'binary_precision': 0.8325653, 'binary_recall': 0.8053492, 'binary_specificity': 0.9939669, 'binary_f1_score': 0.8187311}
confusion matrix:
       0    1
0  17958  109
1    131  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.8439081, 'recall': 0.5302647, 'specificity': 0.5302647, 'f1': 0.54643255, 'auroc': 0.86701787, 'binary_precision': 0.72727275, 'binary_recall': 0.06153846, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.11347518}
confusion matrix:
      0   1
0  5940   6
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_29.png
early stop counter: 2
val acc:0.9871931672096252, best validation acc: 0.98868727684021, corresponding to test acc:                         0.9587495923042297 / 0.9618111252784729
after epoch: 29,now: 2024-06-08 08:45:53.185172,epoch time: 0:31:57.260604,used: 15:20:59.628143,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9941855, 'precision': 0.98682094, 'recall': 0.9202899, 'specificity': 0.9202899, 'f1': 0.95094365, 'auroc': 0.9994569, 'binary_precision': 0.97901535, 'binary_recall': 0.8411928, 'binary_specificity': 0.99938697, 'binary_f1_score': 0.90488625}
confusion matrix:
       0     1
0  42388    26
1    229  1213
---- Validation: 
scalar performance:
{'acc': 0.9847385, 'precision': 0.94063556, 'recall': 0.82471246, 'specificity': 0.82471246, 'f1': 0.8732101, 'auroc': 0.98195386, 'binary_precision': 0.8940937, 'binary_recall': 0.6523031, 'binary_specificity': 0.9971218, 'binary_f1_score': 0.7542955}
confusion matrix:
       0    1
0  18015   52
1    234  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.8862985, 'recall': 0.5247477, 'specificity': 0.5247477, 'f1': 0.5368015, 'auroc': 0.90737534, 'binary_precision': 0.8125, 'binary_recall': 0.05, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.094202906}
confusion matrix:
      0   1
0  5943   3
1   247  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21170178_30.png
early stop counter: 3
val acc:0.9847385287284851, best validation acc: 0.98868727684021, corresponding to test acc:                         0.9587495923042297 / 0.9618111252784729
after epoch: 30,now: 2024-06-08 09:19:46.616049,epoch time: 0:33:53.430877,used: 15:54:53.059020,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_17_24_53_seed_1_21170178
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:54:53.059020 at 2024-06-08 09:19:46.616049
persisted model performance metric: 

scalar performance:
{'acc': 0.9585885, 'precision': 0.81283957, 'recall': 0.5112862, 'specificity': 0.5112862, 'f1': 0.51172256, 'auroc': 0.8400984, 'binary_precision': 0.6666667, 'binary_recall': 0.023076924, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.044609666}
confusion matrix:
      0  1
0  5943  3
1   254  6
oracle model performance metric: 

scalar performance:
{'acc': 0.9624557, 'precision': 0.93591595, 'recall': 0.55744004, 'specificity': 0.55744004, 'f1': 0.59277606, 'auroc': 0.95627505, 'binary_precision': 0.90909094, 'binary_recall': 0.115384616, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.20477815}
confusion matrix:
      0   1
0  5943   3
1   230  30
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1669 MiB |   3199 MiB |   1748 TiB |   1748 TiB |
|       from large pool |   1662 MiB |   3192 MiB |   1725 TiB |   1725 TiB |
|       from small pool |      6 MiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   1669 MiB |   3199 MiB |   1748 TiB |   1748 TiB |
|       from large pool |   1662 MiB |   3192 MiB |   1725 TiB |   1725 TiB |
|       from small pool |      6 MiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1653 MiB |   3184 MiB |   1744 TiB |   1744 TiB |
|       from large pool |   1647 MiB |   3177 MiB |   1722 TiB |   1722 TiB |
|       from small pool |      5 MiB |      9 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3478 MiB |   3478 MiB |   5016 MiB |   1538 MiB |
|       from large pool |   3466 MiB |   3466 MiB |   5002 MiB |   1536 MiB |
|       from small pool |     12 MiB |     12 MiB |     14 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 217722 KiB | 319776 KiB |    992 TiB |    992 TiB |
|       from large pool | 214160 KiB | 315536 KiB |    970 TiB |    970 TiB |
|       from small pool |   3562 KiB |   9141 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3342    |    6345    |  281698 K  |  281695 K  |
|       from large pool |     247    |     352    |  108458 K  |  108457 K  |
|       from small pool |    3095    |    6097    |  173240 K  |  173237 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3342    |    6345    |  281698 K  |  281695 K  |
|       from large pool |     247    |     352    |  108458 K  |  108457 K  |
|       from small pool |    3095    |    6097    |  173240 K  |  173237 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     138    |     138    |     182    |      44    |
|       from large pool |     132    |     132    |     175    |      43    |
|       from small pool |       6    |       6    |       7    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      93    |    2827    |  152332 K  |  152332 K  |
|       from large pool |      77    |     117    |   75590 K  |   75590 K  |
|       from small pool |      16    |    2750    |   76741 K  |   76741 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3199 MiB |   1748 TiB |   1748 TiB |
|       from large pool |  16640 KiB |   3192 MiB |   1725 TiB |   1725 TiB |
|       from small pool |      0 KiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3199 MiB |   1748 TiB |   1748 TiB |
|       from large pool |  16640 KiB |   3192 MiB |   1725 TiB |   1725 TiB |
|       from small pool |      0 KiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |   1744 TiB |   1744 TiB |
|       from large pool |  16640 KiB |   3177 MiB |   1722 TiB |   1722 TiB |
|       from small pool |      0 KiB |      9 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1882 MiB |   3478 MiB |   5016 MiB |   3134 MiB |
|       from large pool |   1872 MiB |   3466 MiB |   5002 MiB |   3130 MiB |
|       from small pool |     10 MiB |     12 MiB |     14 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 319776 KiB |    992 TiB |    992 TiB |
|       from large pool |  24320 KiB | 315536 KiB |    970 TiB |    970 TiB |
|       from small pool |      0 KiB |   9372 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6345    |  281698 K  |  281698 K  |
|       from large pool |       2    |     352    |  108458 K  |  108458 K  |
|       from small pool |       0    |    6097    |  173240 K  |  173240 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6345    |  281698 K  |  281698 K  |
|       from large pool |       2    |     352    |  108458 K  |  108458 K  |
|       from small pool |       0    |    6097    |  173240 K  |  173240 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      92    |     138    |     182    |      90    |
|       from large pool |      87    |     132    |     175    |      88    |
|       from small pool |       5    |       6    |       7    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2827    |  152333 K  |  152333 K  |
|       from large pool |       3    |     117    |   75590 K  |   75590 K  |
|       from small pool |       0    |    2750    |   76743 K  |   76743 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3199 MiB |   1748 TiB |   1748 TiB |
|       from large pool |  16640 KiB |   3192 MiB |   1725 TiB |   1725 TiB |
|       from small pool |      0 KiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3199 MiB |   1748 TiB |   1748 TiB |
|       from large pool |  16640 KiB |   3192 MiB |   1725 TiB |   1725 TiB |
|       from small pool |      0 KiB |     11 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3184 MiB |   1744 TiB |   1744 TiB |
|       from large pool |  16640 KiB |   3177 MiB |   1722 TiB |   1722 TiB |
|       from small pool |      0 KiB |      9 MiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1882 MiB |   3478 MiB |   5016 MiB |   3134 MiB |
|       from large pool |   1872 MiB |   3466 MiB |   5002 MiB |   3130 MiB |
|       from small pool |     10 MiB |     12 MiB |     14 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 319776 KiB |    992 TiB |    992 TiB |
|       from large pool |  24320 KiB | 315536 KiB |    970 TiB |    970 TiB |
|       from small pool |      0 KiB |   9372 KiB |     22 TiB |     22 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6345    |  281698 K  |  281698 K  |
|       from large pool |       2    |     352    |  108458 K  |  108458 K  |
|       from small pool |       0    |    6097    |  173240 K  |  173240 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6345    |  281698 K  |  281698 K  |
|       from large pool |       2    |     352    |  108458 K  |  108458 K  |
|       from small pool |       0    |    6097    |  173240 K  |  173240 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      92    |     138    |     182    |      90    |
|       from large pool |      87    |     132    |     175    |      88    |
|       from small pool |       5    |       6    |       7    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2827    |  152333 K  |  152333 K  |
|       from large pool |       3    |     117    |   75590 K  |   75590 K  |
|       from small pool |       0    |    2750    |   76743 K  |   76743 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jun  8 09:22:54 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6_ohneresnet/rule_results/4.csv

RuleException:
ValueError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
too many values to unpack (expected 2)
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 168, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 30, in __init__
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/tasks/zoo_tasks.py", line 36, in __call__
  File "/lustre/groups/aih/sina.wendrich/MA_code/MA_thesis/tasks/task_CAMELYON17.py", line 185, in get_task
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
