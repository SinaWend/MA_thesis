Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jun 16 13:35:10 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388

 Experiment start at: 2024-06-16 13:46:55.151370
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.7340903, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.68806136, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.70643556, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-16 14:11:44.236354,epoch time: 0:24:49.084984,used: 0:24:49.084984,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9665525, 'precision': 0.7741631, 'recall': 0.5082792, 'specificity': 0.5082792, 'f1': 0.50799257, 'auroc': 0.8603717, 'binary_precision': 0.5813953, 'binary_recall': 0.016983695, 'binary_specificity': 0.9995747, 'binary_f1_score': 0.0330033}
confusion matrix:
       0   1
0  42310  18
1   1447  25
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.84158367, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8331803, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-16 14:35:47.575643,epoch time: 0:24:03.339289,used: 0:48:52.424273,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9662557, 'precision': 0.72786057, 'recall': 0.5415851, 'specificity': 0.5415851, 'f1': 0.5647194, 'auroc': 0.8910222, 'binary_precision': 0.48659003, 'binary_recall': 0.08633582, 'binary_specificity': 0.99683434, 'binary_f1_score': 0.14665127}
confusion matrix:
       0    1
0  42195  134
1   1344  127
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.7118577, 'recall': 0.51191825, 'specificity': 0.51191825, 'f1': 0.5148468, 'auroc': 0.88308454, 'binary_precision': 0.45714286, 'binary_recall': 0.02488336, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.04719764}
confusion matrix:
       0   1
0  18130  19
1    627  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.98022103, 'recall': 0.52681994, 'specificity': 0.52681994, 'f1': 0.54082, 'auroc': 0.8683181, 'binary_precision': 1.0, 'binary_recall': 0.053639848, 'binary_specificity': 1.0, 'binary_f1_score': 0.10181818}
confusion matrix:
      0   1
0  5997   0
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_3.png
new oracle model saved
early stop counter: 2
val acc:0.965623676776886, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9605305194854736
after epoch: 3,now: 2024-06-16 15:00:02.142101,epoch time: 0:24:14.566458,used: 1:13:06.990731,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9670548, 'precision': 0.7505331, 'recall': 0.58722585, 'specificity': 0.58722585, 'f1': 0.62588716, 'auroc': 0.9024083, 'binary_precision': 0.5289421, 'binary_recall': 0.18002717, 'binary_specificity': 0.9944245, 'binary_f1_score': 0.26862645}
confusion matrix:
       0    1
0  42092  236
1   1207  265
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7795037, 'recall': 0.55233234, 'specificity': 0.55233234, 'f1': 0.5823439, 'auroc': 0.8980251, 'binary_precision': 0.5897436, 'binary_recall': 0.10730949, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.18157896}
confusion matrix:
       0   1
0  18101  48
1    574  69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.9821515, 'recall': 0.57471263, 'specificity': 0.57471263, 'f1': 0.6209135, 'auroc': 0.8784592, 'binary_precision': 1.0, 'binary_recall': 0.14942528, 'binary_specificity': 1.0, 'binary_f1_score': 0.26}
confusion matrix:
      0   1
0  5997   0
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-16 15:24:29.756312,epoch time: 0:24:27.614211,used: 1:37:34.604942,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9663242, 'precision': 0.7352356, 'recall': 0.5993066, 'specificity': 0.5993066, 'f1': 0.6369793, 'auroc': 0.9106531, 'binary_precision': 0.49753696, 'binary_recall': 0.20584239, 'binary_specificity': 0.99277073, 'binary_f1_score': 0.29120615}
confusion matrix:
       0    1
0  42022  306
1   1169  303
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.78804034, 'recall': 0.55622035, 'specificity': 0.55622035, 'f1': 0.5883532, 'auroc': 0.90614426, 'binary_precision': 0.60655737, 'binary_recall': 0.115085535, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.19346406}
confusion matrix:
       0   1
0  18101  48
1    569  74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.981919, 'recall': 0.5689655, 'specificity': 0.5689655, 'f1': 0.6120051, 'auroc': 0.87973297, 'binary_precision': 1.0, 'binary_recall': 0.13793103, 'binary_specificity': 1.0, 'binary_f1_score': 0.24242425}
confusion matrix:
      0   1
0  5997   0
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_5.png
better model found
persisted
after epoch: 5,now: 2024-06-16 15:48:13.779970,epoch time: 0:23:44.023658,used: 2:01:18.628600,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9676712, 'precision': 0.755769, 'recall': 0.6370518, 'specificity': 0.6370518, 'f1': 0.6767583, 'auroc': 0.9212446, 'binary_precision': 0.53608245, 'binary_recall': 0.2826087, 'binary_specificity': 0.991495, 'binary_f1_score': 0.37010673}
confusion matrix:
       0    1
0  41968  360
1   1056  416
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.76697284, 'recall': 0.5741115, 'specificity': 0.5741115, 'f1': 0.611506, 'auroc': 0.9149819, 'binary_precision': 0.5632184, 'binary_recall': 0.15241058, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.23990211}
confusion matrix:
       0   1
0  18073  76
1    545  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.9737248, 'recall': 0.59953344, 'specificity': 0.59953344, 'f1': 0.6569999, 'auroc': 0.887432, 'binary_precision': 0.9811321, 'binary_recall': 0.19923371, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.33121017}
confusion matrix:
      0   1
0  5996   1
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_6.png
new oracle model saved
early stop counter: 1
val acc:0.9669540524482727, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9640460014343262 / 0.9664429426193237
after epoch: 6,now: 2024-06-16 16:12:17.703972,epoch time: 0:24:03.924002,used: 2:25:22.552602,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9672146, 'precision': 0.75060904, 'recall': 0.614521, 'specificity': 0.614521, 'f1': 0.6548262, 'auroc': 0.9220936, 'binary_precision': 0.5272727, 'binary_recall': 0.23641305, 'binary_specificity': 0.992629, 'binary_f1_score': 0.326454}
confusion matrix:
       0    1
0  42016  312
1   1124  348
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7745226, 'recall': 0.5696938, 'specificity': 0.5696938, 'f1': 0.6063124, 'auroc': 0.9161356, 'binary_precision': 0.5786164, 'binary_recall': 0.14307931, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.22942644}
confusion matrix:
       0   1
0  18082  67
1    551  92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.98285025, 'recall': 0.591954, 'specificity': 0.591954, 'f1': 0.64661527, 'auroc': 0.88871384, 'binary_precision': 1.0, 'binary_recall': 0.18390805, 'binary_specificity': 1.0, 'binary_f1_score': 0.3106796}
confusion matrix:
      0   1
0  5997   0
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_7.png
early stop counter: 2
val acc:0.9671136736869812, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9640460014343262 / 0.9664429426193237
after epoch: 7,now: 2024-06-16 16:37:20.891302,epoch time: 0:25:03.187330,used: 2:50:25.739932,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96762556, 'precision': 0.75603527, 'recall': 0.6285038, 'specificity': 0.6285038, 'f1': 0.6691321, 'auroc': 0.922799, 'binary_precision': 0.5371901, 'binary_recall': 0.26494566, 'binary_specificity': 0.992062, 'binary_f1_score': 0.35486808}
confusion matrix:
       0    1
0  41992  336
1   1082  390
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7799262, 'recall': 0.5621933, 'specificity': 0.5621933, 'f1': 0.596463, 'auroc': 0.91841894, 'binary_precision': 0.58992803, 'binary_recall': 0.12752722, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.20971866}
confusion matrix:
       0   1
0  18092  57
1    561  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.9816867, 'recall': 0.5632184, 'specificity': 0.5632184, 'f1': 0.60291743, 'auroc': 0.88457096, 'binary_precision': 1.0, 'binary_recall': 0.12643678, 'binary_specificity': 1.0, 'binary_f1_score': 0.2244898}
confusion matrix:
      0   1
0  5997   0
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_8.png
early stop counter: 3
val acc:0.9671136736869812, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9640460014343262 / 0.9664429426193237
after epoch: 8,now: 2024-06-16 17:02:25.280301,epoch time: 0:25:04.388999,used: 3:15:30.128931,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9681735, 'precision': 0.7639481, 'recall': 0.63534456, 'specificity': 0.63534456, 'f1': 0.6770223, 'auroc': 0.923193, 'binary_precision': 0.5525606, 'binary_recall': 0.2785326, 'binary_specificity': 0.9921565, 'binary_f1_score': 0.3703704}
confusion matrix:
       0    1
0  41996  332
1   1062  410
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.7768566, 'recall': 0.56897134, 'specificity': 0.56897134, 'f1': 0.60550576, 'auroc': 0.92461526, 'binary_precision': 0.5833333, 'binary_recall': 0.1415241, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.22778472}
confusion matrix:
       0   1
0  18084  65
1    552  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.9816867, 'recall': 0.5632184, 'specificity': 0.5632184, 'f1': 0.60291743, 'auroc': 0.89069754, 'binary_precision': 1.0, 'binary_recall': 0.12643678, 'binary_specificity': 1.0, 'binary_f1_score': 0.2244898}
confusion matrix:
      0   1
0  5997   0
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_9.png
early stop counter: 4
val acc:0.9671669006347656, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9640460014343262 / 0.9664429426193237
after epoch: 9,now: 2024-06-16 17:27:46.078966,epoch time: 0:25:20.798665,used: 3:40:50.927596,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9666438, 'precision': 0.74099874, 'recall': 0.6270123, 'specificity': 0.6270123, 'f1': 0.664597, 'auroc': 0.9243108, 'binary_precision': 0.5072084, 'binary_recall': 0.2629076, 'binary_specificity': 0.991117, 'binary_f1_score': 0.34630874}
confusion matrix:
       0    1
0  41952  376
1   1085  387
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.7791027, 'recall': 0.58188754, 'specificity': 0.58188754, 'f1': 0.6222812, 'auroc': 0.92772794, 'binary_precision': 0.5869565, 'binary_recall': 0.16796267, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.261185}
confusion matrix:
       0    1
0  18073   76
1    535  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.98207396, 'recall': 0.57279694, 'specificity': 0.57279694, 'f1': 0.6179637, 'auroc': 0.8932904, 'binary_precision': 1.0, 'binary_recall': 0.14559387, 'binary_specificity': 1.0, 'binary_f1_score': 0.25418058}
confusion matrix:
      0   1
0  5997   0
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_10.png
better model found
persisted
after epoch: 10,now: 2024-06-16 17:52:26.513381,epoch time: 0:24:40.434415,used: 4:05:31.362011,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96812785, 'precision': 0.7591945, 'recall': 0.6651563, 'specificity': 0.6651563, 'f1': 0.7007318, 'auroc': 0.9303445, 'binary_precision': 0.5410367, 'binary_recall': 0.34035325, 'binary_specificity': 0.98995936, 'binary_f1_score': 0.4178482}
confusion matrix:
       0    1
0  41903  425
1    971  501
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.76665264, 'recall': 0.6050842, 'specificity': 0.6050842, 'f1': 0.64765143, 'auroc': 0.9325913, 'binary_precision': 0.5604839, 'binary_recall': 0.21617419, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.31200898}
confusion matrix:
       0    1
0  18040  109
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.9729253, 'recall': 0.59378636, 'specificity': 0.59378636, 'f1': 0.64883035, 'auroc': 0.8943268, 'binary_precision': 0.98, 'binary_recall': 0.18773946, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.31511253}
confusion matrix:
      0   1
0  5996   1
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_11.png
early stop counter: 1
val acc:0.9673797488212585, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.9643656015396118 / 0.9664429426193237
after epoch: 11,now: 2024-06-16 18:17:55.984187,epoch time: 0:25:29.470806,used: 4:31:00.832817,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9691096, 'precision': 0.77804875, 'recall': 0.6423861, 'specificity': 0.6423861, 'f1': 0.6863836, 'auroc': 0.93399704, 'binary_precision': 0.5802969, 'binary_recall': 0.29211956, 'binary_specificity': 0.9926526, 'binary_f1_score': 0.38861275}
confusion matrix:
       0    1
0  42017  311
1   1042  430
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.7792832, 'recall': 0.5735543, 'specificity': 0.5735543, 'f1': 0.61170167, 'auroc': 0.93078005, 'binary_precision': 0.58787876, 'binary_recall': 0.15085536, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.240099}
confusion matrix:
       0   1
0  18081  68
1    546  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.9816867, 'recall': 0.5632184, 'specificity': 0.5632184, 'f1': 0.60291743, 'auroc': 0.89139223, 'binary_precision': 1.0, 'binary_recall': 0.12643678, 'binary_specificity': 1.0, 'binary_f1_score': 0.2244898}
confusion matrix:
      0   1
0  5997   0
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_12.png
early stop counter: 2
val acc:0.9673265218734741, best validation acc: 0.9674861431121826, corresponding to test acc:                         0.9643656015396118 / 0.9664429426193237
after epoch: 12,now: 2024-06-16 18:42:49.487386,epoch time: 0:24:53.503199,used: 4:55:54.336016,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.968105, 'precision': 0.760432, 'recall': 0.64917195, 'specificity': 0.64917195, 'f1': 0.6882475, 'auroc': 0.93204886, 'binary_precision': 0.5445783, 'binary_recall': 0.30727395, 'binary_specificity': 0.99107, 'binary_f1_score': 0.39287266}
confusion matrix:
       0    1
0  41951  378
1   1019  452
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.7823293, 'recall': 0.5819427, 'specificity': 0.5819427, 'f1': 0.6226254, 'auroc': 0.93305314, 'binary_precision': 0.5934066, 'binary_recall': 0.16796267, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.26181817}
confusion matrix:
       0    1
0  18075   74
1    535  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.9816867, 'recall': 0.5632184, 'specificity': 0.5632184, 'f1': 0.60291743, 'auroc': 0.8932986, 'binary_precision': 1.0, 'binary_recall': 0.12643678, 'binary_specificity': 1.0, 'binary_f1_score': 0.2244898}
confusion matrix:
      0   1
0  5997   0
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_13.png
better model found
persisted
after epoch: 13,now: 2024-06-16 19:07:20.057841,epoch time: 0:24:30.570455,used: 5:20:24.906471,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9693379, 'precision': 0.7785597, 'recall': 0.65276265, 'specificity': 0.65276265, 'f1': 0.69566303, 'auroc': 0.93318784, 'binary_precision': 0.58060455, 'binary_recall': 0.31339225, 'binary_specificity': 0.9921331, 'binary_f1_score': 0.407064}
confusion matrix:
       0    1
0  41996  333
1   1010  461
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.7736821, 'recall': 0.5893606, 'specificity': 0.5893606, 'f1': 0.6308212, 'auroc': 0.9361245, 'binary_precision': 0.57560974, 'binary_recall': 0.18351477, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.2783019}
confusion matrix:
       0    1
0  18062   87
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.98184156, 'recall': 0.5670498, 'specificity': 0.5670498, 'f1': 0.60899615, 'auroc': 0.8958627, 'binary_precision': 1.0, 'binary_recall': 0.13409962, 'binary_specificity': 1.0, 'binary_f1_score': 0.2364865}
confusion matrix:
      0   1
0  5997   0
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_14.png
early stop counter: 1
val acc:0.967432975769043, best validation acc: 0.9675925970077515, corresponding to test acc:                         0.9635666608810425 / 0.9664429426193237
after epoch: 14,now: 2024-06-16 19:32:11.137546,epoch time: 0:24:51.079705,used: 5:45:15.986176,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96892697, 'precision': 0.7665827, 'recall': 0.6850312, 'specificity': 0.6850312, 'f1': 0.71772075, 'auroc': 0.9358798, 'binary_precision': 0.55445546, 'binary_recall': 0.3806934, 'binary_specificity': 0.989369, 'binary_f1_score': 0.45143092}
confusion matrix:
       0    1
0  41879  450
1    911  560
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.7739967, 'recall': 0.61055493, 'specificity': 0.61055493, 'f1': 0.6545194, 'auroc': 0.9377576, 'binary_precision': 0.5748032, 'binary_recall': 0.22706065, 'binary_specificity': 0.99404925, 'binary_f1_score': 0.32552955}
confusion matrix:
       0    1
0  18041  108
1    497  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.983629, 'recall': 0.6111111, 'specificity': 0.6111111, 'f1': 0.6734965, 'auroc': 0.8958608, 'binary_precision': 1.0, 'binary_recall': 0.22222222, 'binary_specificity': 1.0, 'binary_f1_score': 0.36363637}
confusion matrix:
      0   1
0  5997   0
1   203  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_15.png
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-06-16 19:56:59.551147,epoch time: 0:24:48.413601,used: 6:10:04.399777,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9696347, 'precision': 0.7824384, 'recall': 0.6570837, 'specificity': 0.6570837, 'f1': 0.7002833, 'auroc': 0.9348978, 'binary_precision': 0.58808935, 'binary_recall': 0.32201087, 'binary_specificity': 0.9921565, 'binary_f1_score': 0.41615453}
confusion matrix:
       0    1
0  41996  332
1    998  474
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.7878629, 'recall': 0.5812752, 'specificity': 0.5812752, 'f1': 0.622246, 'auroc': 0.93688464, 'binary_precision': 0.6045198, 'binary_recall': 0.16640747, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.26097563}
confusion matrix:
       0    1
0  18079   70
1    536  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.98160934, 'recall': 0.56130266, 'specificity': 0.56130266, 'f1': 0.59984744, 'auroc': 0.89592093, 'binary_precision': 1.0, 'binary_recall': 0.12260536, 'binary_specificity': 1.0, 'binary_f1_score': 0.21843004}
confusion matrix:
      0   1
0  5997   0
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_16.png
early stop counter: 1
val acc:0.96775221824646, best validation acc: 0.9678054451942444, corresponding to test acc:                         0.9675615429878235 / 0.9675615429878235
after epoch: 16,now: 2024-06-16 20:21:51.267178,epoch time: 0:24:51.716031,used: 6:34:56.115808,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96949774, 'precision': 0.77671564, 'recall': 0.66990614, 'specificity': 0.66990614, 'f1': 0.70935196, 'auroc': 0.93698144, 'binary_precision': 0.57575756, 'binary_recall': 0.34874237, 'binary_specificity': 0.99107, 'binary_f1_score': 0.43437767}
confusion matrix:
       0    1
0  41951  378
1    958  513
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.79322314, 'recall': 0.60035723, 'specificity': 0.60035723, 'f1': 0.6457593, 'auroc': 0.93837404, 'binary_precision': 0.6139535, 'binary_recall': 0.20528771, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.30769232}
confusion matrix:
       0    1
0  18066   83
1    511  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.98176414, 'recall': 0.5651341, 'specificity': 0.5651341, 'f1': 0.6059669, 'auroc': 0.8975053, 'binary_precision': 1.0, 'binary_recall': 0.1302682, 'binary_specificity': 1.0, 'binary_f1_score': 0.23050848}
confusion matrix:
      0   1
0  5997   0
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_17.png
better model found
persisted
after epoch: 17,now: 2024-06-16 20:46:47.453753,epoch time: 0:24:56.186575,used: 6:59:52.302383,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9699543, 'precision': 0.78338456, 'recall': 0.67101926, 'specificity': 0.67101926, 'f1': 0.7120432, 'auroc': 0.9358345, 'binary_precision': 0.5890411, 'binary_recall': 0.35054347, 'binary_specificity': 0.991495, 'binary_f1_score': 0.43952298}
confusion matrix:
       0    1
0  41968  360
1    956  516
---- Validation: 
scalar performance:
{'acc': 0.968444, 'precision': 0.7973946, 'recall': 0.5966345, 'specificity': 0.5966345, 'f1': 0.6418701, 'auroc': 0.9386787, 'binary_precision': 0.622549, 'binary_recall': 0.19751166, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.29988194}
confusion matrix:
       0    1
0  18072   77
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.98145473, 'recall': 0.5574713, 'specificity': 0.5574713, 'f1': 0.5936449, 'auroc': 0.8945464, 'binary_precision': 1.0, 'binary_recall': 0.11494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5997   0
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_18.png
better model found
persisted
after epoch: 18,now: 2024-06-16 21:12:25.083479,epoch time: 0:25:37.629726,used: 7:25:29.932109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9692922, 'precision': 0.7787504, 'recall': 0.64823735, 'specificity': 0.64823735, 'f1': 0.69176435, 'auroc': 0.9366745, 'binary_precision': 0.5812744, 'binary_recall': 0.30408162, 'binary_specificity': 0.9923931, 'binary_f1_score': 0.3992854}
confusion matrix:
       0    1
0  42008  322
1   1023  447
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.7982005, 'recall': 0.5936067, 'specificity': 0.5936067, 'f1': 0.6383456, 'auroc': 0.9412885, 'binary_precision': 0.6243655, 'binary_recall': 0.19129083, 'binary_specificity': 0.9959226, 'binary_f1_score': 0.29285714}
confusion matrix:
       0    1
0  18075   74
1    520  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.98076, 'recall': 0.5402299, 'specificity': 0.5402299, 'f1': 0.56465936, 'auroc': 0.8947563, 'binary_precision': 1.0, 'binary_recall': 0.08045977, 'binary_specificity': 1.0, 'binary_f1_score': 0.14893617}
confusion matrix:
      0   1
0  5997   0
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_19.png
early stop counter: 1
val acc:0.9683908224105835, best validation acc: 0.9684439897537231, corresponding to test acc:                         0.963087260723114 / 0.9675615429878235
after epoch: 19,now: 2024-06-16 21:37:06.711348,epoch time: 0:24:41.627869,used: 7:50:11.559978,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97041094, 'precision': 0.7874267, 'recall': 0.6804356, 'specificity': 0.6804356, 'f1': 0.7205837, 'auroc': 0.9372455, 'binary_precision': 0.5964912, 'binary_recall': 0.36956522, 'binary_specificity': 0.991306, 'binary_f1_score': 0.45637584}
confusion matrix:
       0    1
0  41960  368
1    928  544
---- Validation: 
scalar performance:
{'acc': 0.96855044, 'precision': 0.7992792, 'recall': 0.5981897, 'specificity': 0.5981897, 'f1': 0.6438994, 'auroc': 0.9411025, 'binary_precision': 0.6262136, 'binary_recall': 0.20062208, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.30388692}
confusion matrix:
       0    1
0  18072   77
1    514  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.9810685, 'recall': 0.5478927, 'specificity': 0.5478927, 'f1': 0.57776415, 'auroc': 0.89282894, 'binary_precision': 1.0, 'binary_recall': 0.09578544, 'binary_specificity': 1.0, 'binary_f1_score': 0.17482518}
confusion matrix:
      0   1
0  5997   0
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_20.png
better model found
persisted
after epoch: 20,now: 2024-06-16 22:02:21.960135,epoch time: 0:25:15.248787,used: 8:15:26.808765,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97034246, 'precision': 0.7840656, 'recall': 0.6883883, 'specificity': 0.6883883, 'f1': 0.7256385, 'auroc': 0.93865174, 'binary_precision': 0.58921164, 'binary_recall': 0.38613188, 'binary_specificity': 0.9906447, 'binary_f1_score': 0.4665298}
confusion matrix:
       0    1
0  41933  396
1    903  568
---- Validation: 
scalar performance:
{'acc': 0.96961474, 'precision': 0.80392504, 'recall': 0.63024306, 'specificity': 0.63024306, 'f1': 0.67950916, 'auroc': 0.94460344, 'binary_precision': 0.6333333, 'binary_recall': 0.2659409, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.37458926}
confusion matrix:
       0    1
0  18050   99
1    472  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.9819965, 'recall': 0.57088125, 'specificity': 0.57088125, 'f1': 0.6149943, 'auroc': 0.89872396, 'binary_precision': 1.0, 'binary_recall': 0.14176245, 'binary_specificity': 1.0, 'binary_f1_score': 0.24832213}
confusion matrix:
      0   1
0  5997   0
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_21.png
better model found
persisted
after epoch: 21,now: 2024-06-16 22:27:25.827396,epoch time: 0:25:03.867261,used: 8:40:30.676026,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97, 'precision': 0.78189206, 'recall': 0.6792394, 'specificity': 0.6792394, 'f1': 0.7180821, 'auroc': 0.9386611, 'binary_precision': 0.58549786, 'binary_recall': 0.3675272, 'binary_specificity': 0.9909516, 'binary_f1_score': 0.451586}
confusion matrix:
       0    1
0  41945  383
1    931  541
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.79736656, 'recall': 0.6232446, 'specificity': 0.6232446, 'f1': 0.6712973, 'auroc': 0.9434712, 'binary_precision': 0.62068963, 'binary_recall': 0.251944, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.35840705}
confusion matrix:
       0    1
0  18050   99
1    481  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.981919, 'recall': 0.5689655, 'specificity': 0.5689655, 'f1': 0.6120051, 'auroc': 0.8976898, 'binary_precision': 1.0, 'binary_recall': 0.13793103, 'binary_specificity': 1.0, 'binary_f1_score': 0.24242425}
confusion matrix:
      0   1
0  5997   0
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_22.png
early stop counter: 1
val acc:0.9691358208656311, best validation acc: 0.9696147441864014, corresponding to test acc:                         0.964205801486969 / 0.9675615429878235
after epoch: 22,now: 2024-06-16 22:52:31.864653,epoch time: 0:25:06.037257,used: 9:05:36.713283,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.969726, 'precision': 0.7768266, 'recall': 0.685327, 'specificity': 0.685327, 'f1': 0.7211593, 'auroc': 0.94015706, 'binary_precision': 0.57494867, 'binary_recall': 0.38043478, 'binary_specificity': 0.99021924, 'binary_f1_score': 0.45789042}
confusion matrix:
       0    1
0  41914  414
1    912  560
---- Validation: 
scalar performance:
{'acc': 0.9692422, 'precision': 0.8058655, 'recall': 0.61429906, 'specificity': 0.61429906, 'f1': 0.6629694, 'auroc': 0.9424797, 'binary_precision': 0.63829786, 'binary_recall': 0.2332815, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.34168562}
confusion matrix:
       0    1
0  18064   85
1    493  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.981919, 'recall': 0.5689655, 'specificity': 0.5689655, 'f1': 0.6120051, 'auroc': 0.8974724, 'binary_precision': 1.0, 'binary_recall': 0.13793103, 'binary_specificity': 1.0, 'binary_f1_score': 0.24242425}
confusion matrix:
      0   1
0  5997   0
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_23.png
early stop counter: 2
val acc:0.9692422151565552, best validation acc: 0.9696147441864014, corresponding to test acc:                         0.964205801486969 / 0.9675615429878235
after epoch: 23,now: 2024-06-16 23:17:47.896026,epoch time: 0:25:16.031373,used: 9:30:52.744656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97009134, 'precision': 0.78733224, 'recall': 0.6648607, 'specificity': 0.6648607, 'f1': 0.70803267, 'auroc': 0.9415761, 'binary_precision': 0.5973558, 'binary_recall': 0.33763587, 'binary_specificity': 0.99208564, 'binary_f1_score': 0.4314236}
confusion matrix:
       0    1
0  41993  335
1    975  497
---- Validation: 
scalar performance:
{'acc': 0.969189, 'precision': 0.8086095, 'recall': 0.60902107, 'specificity': 0.60902107, 'f1': 0.65743375, 'auroc': 0.94389784, 'binary_precision': 0.6441441, 'binary_recall': 0.22239502, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.33063585}
confusion matrix:
       0    1
0  18070   79
1    500  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.9813002, 'recall': 0.5536398, 'specificity': 0.5536398, 'f1': 0.5873577, 'auroc': 0.8953364, 'binary_precision': 1.0, 'binary_recall': 0.107279696, 'binary_specificity': 1.0, 'binary_f1_score': 0.19377163}
confusion matrix:
      0   1
0  5997   0
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_24.png
early stop counter: 3
val acc:0.9691889882087708, best validation acc: 0.9696147441864014, corresponding to test acc:                         0.964205801486969 / 0.9675615429878235
after epoch: 24,now: 2024-06-16 23:44:19.375805,epoch time: 0:26:31.479779,used: 9:57:24.224435,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9703653, 'precision': 0.78989166, 'recall': 0.67024827, 'specificity': 0.67024827, 'f1': 0.7131295, 'auroc': 0.94183207, 'binary_precision': 0.60211265, 'binary_recall': 0.34850544, 'binary_specificity': 0.9919911, 'binary_f1_score': 0.44148022}
confusion matrix:
       0    1
0  41989  339
1    959  513
---- Validation: 
scalar performance:
{'acc': 0.96929544, 'precision': 0.80394363, 'recall': 0.6188269, 'specificity': 0.6188269, 'f1': 0.667616, 'auroc': 0.94459724, 'binary_precision': 0.63414633, 'binary_recall': 0.24261275, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.35095614}
confusion matrix:
       0    1
0  18059   90
1    487  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.981919, 'recall': 0.5689655, 'specificity': 0.5689655, 'f1': 0.6120051, 'auroc': 0.8978482, 'binary_precision': 1.0, 'binary_recall': 0.13793103, 'binary_specificity': 1.0, 'binary_f1_score': 0.24242425}
confusion matrix:
      0   1
0  5997   0
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_25.png
early stop counter: 4
val acc:0.9692954421043396, best validation acc: 0.9696147441864014, corresponding to test acc:                         0.964205801486969 / 0.9675615429878235
after epoch: 25,now: 2024-06-17 00:09:14.428318,epoch time: 0:24:55.052513,used: 10:22:19.276948,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.97077626, 'precision': 0.7863786, 'recall': 0.7032471, 'specificity': 0.7032471, 'f1': 0.73709184, 'auroc': 0.94213414, 'binary_precision': 0.59284335, 'binary_recall': 0.41644022, 'binary_specificity': 0.9900539, 'binary_f1_score': 0.48922586}
confusion matrix:
       0    1
0  41907  421
1    859  613
---- Validation: 
scalar performance:
{'acc': 0.969934, 'precision': 0.8003788, 'recall': 0.6484096, 'specificity': 0.6484096, 'f1': 0.696476, 'auroc': 0.94477284, 'binary_precision': 0.625, 'binary_recall': 0.30326593, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.40837696}
confusion matrix:
       0    1
0  18032  117
1    448  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.9825394, 'recall': 0.5842912, 'specificity': 0.5842912, 'f1': 0.6353768, 'auroc': 0.9000428, 'binary_precision': 1.0, 'binary_recall': 0.16858238, 'binary_specificity': 1.0, 'binary_f1_score': 0.28852457}
confusion matrix:
      0   1
0  5997   0
1   217  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_26.png
better model found
persisted
after epoch: 26,now: 2024-06-17 00:34:13.619234,epoch time: 0:24:59.190916,used: 10:47:18.467864,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97061646, 'precision': 0.78833187, 'recall': 0.68656147, 'specificity': 0.68656147, 'f1': 0.72554445, 'auroc': 0.9446529, 'binary_precision': 0.5978723, 'binary_recall': 0.38205302, 'binary_specificity': 0.99107, 'binary_f1_score': 0.46619657}
confusion matrix:
       0    1
0  41951  378
1    909  562
---- Validation: 
scalar performance:
{'acc': 0.96934867, 'precision': 0.8098111, 'recall': 0.612854, 'specificity': 0.612854, 'f1': 0.6618799, 'auroc': 0.9442071, 'binary_precision': 0.6462882, 'binary_recall': 0.23017107, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.33944952}
confusion matrix:
       0    1
0  18068   81
1    495  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.98114574, 'recall': 0.54980844, 'specificity': 0.54980844, 'f1': 0.580984, 'auroc': 0.89654946, 'binary_precision': 1.0, 'binary_recall': 0.099616855, 'binary_specificity': 1.0, 'binary_f1_score': 0.18118466}
confusion matrix:
      0   1
0  5997   0
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_27.png
early stop counter: 1
val acc:0.969348669052124, best validation acc: 0.9699339866638184, corresponding to test acc:                         0.9653244018554688 / 0.9675615429878235
after epoch: 27,now: 2024-06-17 00:58:41.264297,epoch time: 0:24:27.645063,used: 11:11:46.112927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9703196, 'precision': 0.78558326, 'recall': 0.6823555, 'specificity': 0.6823555, 'f1': 0.72153753, 'auroc': 0.9444362, 'binary_precision': 0.5926724, 'binary_recall': 0.3736413, 'binary_specificity': 0.99106973, 'binary_f1_score': 0.45833334}
confusion matrix:
       0    1
0  41950  378
1    922  550
---- Validation: 
scalar performance:
{'acc': 0.9694019, 'precision': 0.8093938, 'recall': 0.61513174, 'specificity': 0.61513174, 'f1': 0.6643456, 'auroc': 0.9439156, 'binary_precision': 0.64529914, 'binary_recall': 0.2348367, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.34435576}
confusion matrix:
       0    1
0  18066   83
1    492  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9813774, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.59051204, 'auroc': 0.8978423, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5997   0
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_28.png
early stop counter: 2
val acc:0.9694018959999084, best validation acc: 0.9699339866638184, corresponding to test acc:                         0.9653244018554688 / 0.9675615429878235
after epoch: 28,now: 2024-06-17 01:23:15.367694,epoch time: 0:24:34.103397,used: 11:36:20.216324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97159815, 'precision': 0.79445106, 'recall': 0.71252453, 'specificity': 0.71252453, 'f1': 0.7462547, 'auroc': 0.9440268, 'binary_precision': 0.608365, 'binary_recall': 0.4347826, 'binary_specificity': 0.9902665, 'binary_f1_score': 0.5071316}
confusion matrix:
       0    1
0  41916  412
1    832  640
---- Validation: 
scalar performance:
{'acc': 0.9703065, 'precision': 0.81268895, 'recall': 0.6403519, 'specificity': 0.6403519, 'f1': 0.6910932, 'auroc': 0.9472253, 'binary_precision': 0.6501767, 'binary_recall': 0.28615862, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.3974082}
confusion matrix:
       0    1
0  18050   99
1    459  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.96331465, 'recall': 0.593703, 'specificity': 0.593703, 'f1': 0.64828366, 'auroc': 0.8989854, 'binary_precision': 0.9607843, 'binary_recall': 0.18773946, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.31410256}
confusion matrix:
      0   1
0  5995   2
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_29.png
better model found
persisted
after epoch: 29,now: 2024-06-17 01:48:06.728661,epoch time: 0:24:51.360967,used: 12:01:11.577291,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9707078, 'precision': 0.7872927, 'recall': 0.69599867, 'specificity': 0.69599867, 'f1': 0.7322215, 'auroc': 0.94316125, 'binary_precision': 0.59516615, 'binary_recall': 0.40149456, 'binary_specificity': 0.9905027, 'binary_f1_score': 0.47951317}
confusion matrix:
       0    1
0  41926  402
1    881  591
---- Validation: 
scalar performance:
{'acc': 0.97020006, 'precision': 0.82047135, 'recall': 0.6267958, 'specificity': 0.6267958, 'f1': 0.6784676, 'auroc': 0.9457946, 'binary_precision': 0.6666667, 'binary_recall': 0.25816485, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.3721973}
confusion matrix:
       0    1
0  18066   83
1    477  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.9810685, 'recall': 0.5478927, 'specificity': 0.5478927, 'f1': 0.57776415, 'auroc': 0.8945996, 'binary_precision': 1.0, 'binary_recall': 0.09578544, 'binary_specificity': 1.0, 'binary_f1_score': 0.17482518}
confusion matrix:
      0   1
0  5997   0
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_30.png
early stop counter: 1
val acc:0.9702000617980957, best validation acc: 0.9703065156936646, corresponding to test acc:                         0.9658037424087524 / 0.9675615429878235
after epoch: 30,now: 2024-06-17 02:12:57.991615,epoch time: 0:24:51.262954,used: 12:26:02.840245,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_16_13_46_55_seed_0_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:26:02.840245 at 2024-06-17 02:12:57.991615
persisted model performance metric: 

scalar performance:
{'acc': 0.96580374, 'precision': 0.96331465, 'recall': 0.593703, 'specificity': 0.593703, 'f1': 0.64828366, 'auroc': 0.8989854, 'binary_precision': 0.9607843, 'binary_recall': 0.18773946, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.31410256}
confusion matrix:
      0   1
0  5995   2
1   212  49
oracle model performance metric: 

scalar performance:
{'acc': 0.96756154, 'precision': 0.983629, 'recall': 0.6111111, 'specificity': 0.6111111, 'f1': 0.6734965, 'auroc': 0.8958608, 'binary_precision': 1.0, 'binary_recall': 0.22222222, 'binary_specificity': 1.0, 'binary_f1_score': 0.36363637}
confusion matrix:
      0   1
0  5997   0
1   203  58
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |  36242 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |  36242 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1428 MiB | 395270 GiB | 395270 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |  35968 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 284057 GiB | 284057 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 283918 GiB | 283918 GiB |
|       from small pool |   8813 KiB |  12610 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   13819 K  |   13817 K  |
|       from large pool |      36    |      76    |    4630 K  |    4630 K  |
|       from small pool |    1242    |    1864    |    9189 K  |    9187 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   13819 K  |   13817 K  |
|       from large pool |      36    |      76    |    4630 K  |    4630 K  |
|       from small pool |    1242    |    1864    |    9189 K  |    9187 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     452    |    7386 K  |    7386 K  |
|       from large pool |       5    |      10    |    1938 K  |    1938 K  |
|       from small pool |      30    |     447    |    5447 K  |    5447 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 395270 GiB | 395270 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |      0 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 284057 GiB | 284057 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 283918 GiB | 283918 GiB |
|       from small pool |      0 KiB |  16408 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13819 K  |   13819 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9189 K  |    9189 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13819 K  |   13819 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9189 K  |    9189 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    7386 K  |    7386 K  |
|       from large pool |       1    |      11    |    1938 K  |    1938 K  |
|       from small pool |       0    |     447    |    5448 K  |    5448 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 395270 GiB | 395270 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |      0 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 284057 GiB | 284057 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 283918 GiB | 283918 GiB |
|       from small pool |      0 KiB |  16408 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13819 K  |   13819 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9189 K  |    9189 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13819 K  |   13819 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9189 K  |    9189 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    7386 K  |    7386 K  |
|       from large pool |       1    |      11    |    1938 K  |    1938 K  |
|       from small pool |       0    |     447    |    5448 K  |    5448 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388

 Experiment start at: 2024-06-17 02:25:23.325571
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.48356164, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49164346, 'auroc': 0.67758113, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42360  0
1   1440  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.6121378, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.6273979, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-17 02:50:49.447361,epoch time: 0:25:26.121790,used: 0:25:26.121790,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.7058376, 'recall': 0.50133085, 'specificity': 0.50133085, 'f1': 0.49440512, 'auroc': 0.8486729, 'binary_precision': 0.44444445, 'binary_recall': 0.0027797082, 'binary_specificity': 0.999882, 'binary_f1_score': 0.005524862}
confusion matrix:
       0  1
0  42356  5
1   1435  4
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.8166227, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8120754, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_2.png
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 2,now: 2024-06-17 03:15:26.461549,epoch time: 0:24:37.014188,used: 0:50:03.135978,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9678539, 'precision': 0.7747867, 'recall': 0.53563744, 'specificity': 0.53563744, 'f1': 0.5567072, 'auroc': 0.887384, 'binary_precision': 0.5801105, 'binary_recall': 0.073068894, 'binary_specificity': 0.99820596, 'binary_f1_score': 0.12978986}
confusion matrix:
       0    1
0  42287   76
1   1332  105
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.77406144, 'recall': 0.51012444, 'specificity': 0.51012444, 'f1': 0.5109922, 'auroc': 0.8680114, 'binary_precision': 0.5833333, 'binary_recall': 0.020802377, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.040172167}
confusion matrix:
       0   1
0  18057  10
1    659  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.9795935, 'recall': 0.51346153, 'specificity': 0.51346153, 'f1': 0.5158014, 'auroc': 0.84633094, 'binary_precision': 1.0, 'binary_recall': 0.026923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.05243446}
confusion matrix:
      0  1
0  5946  0
1   253  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-17 03:40:17.877165,epoch time: 0:24:51.415616,used: 1:14:54.551594,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9672603, 'precision': 0.7413426, 'recall': 0.5577035, 'specificity': 0.5577035, 'f1': 0.58838344, 'auroc': 0.8946613, 'binary_precision': 0.5119048, 'binary_recall': 0.11927878, 'binary_specificity': 0.99612826, 'binary_f1_score': 0.19347581}
confusion matrix:
       0    1
0  42194  164
1   1270  172
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.74950933, 'recall': 0.5229992, 'specificity': 0.5229992, 'f1': 0.53455347, 'auroc': 0.88347155, 'binary_precision': 0.53333336, 'binary_recall': 0.04754829, 'binary_specificity': 0.9984502, 'binary_f1_score': 0.087312415}
confusion matrix:
       0   1
0  18039  28
1    641  32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.85647285, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_4.png
new oracle model saved
early stop counter: 1
val acc:0.9643009901046753, best validation acc: 0.9643009901046753, corresponding to test acc:                         0.9592329859733582 / 0.9603609442710876
after epoch: 4,now: 2024-06-17 04:05:07.822904,epoch time: 0:24:49.945739,used: 1:39:44.497333,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9670548, 'precision': 0.7346131, 'recall': 0.5808005, 'specificity': 0.5808005, 'f1': 0.6167734, 'auroc': 0.9111314, 'binary_precision': 0.4969072, 'binary_recall': 0.16736111, 'binary_specificity': 0.99423987, 'binary_f1_score': 0.2503896}
confusion matrix:
       0    1
0  42116  244
1   1199  241
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.7791368, 'recall': 0.5470459, 'specificity': 0.5470459, 'f1': 0.5741169, 'auroc': 0.8984321, 'binary_precision': 0.59090906, 'binary_recall': 0.096582465, 'binary_specificity': 0.9975093, 'binary_f1_score': 0.1660281}
confusion matrix:
       0   1
0  18022  45
1    608  65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.9805237, 'recall': 0.5365385, 'specificity': 0.5365385, 'f1': 0.55816877, 'auroc': 0.8640379, 'binary_precision': 1.0, 'binary_recall': 0.073076926, 'binary_specificity': 1.0, 'binary_f1_score': 0.13620071}
confusion matrix:
      0   1
0  5946   0
1   241  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-17 04:30:25.716150,epoch time: 0:25:17.893246,used: 2:05:02.390579,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9673288, 'precision': 0.74155456, 'recall': 0.5949169, 'specificity': 0.5949169, 'f1': 0.6333542, 'auroc': 0.91127956, 'binary_precision': 0.5099099, 'binary_recall': 0.1962552, 'binary_specificity': 0.99357855, 'binary_f1_score': 0.28342515}
confusion matrix:
       0    1
0  42086  272
1   1159  283
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.7712971, 'recall': 0.5556291, 'specificity': 0.5556291, 'f1': 0.5865121, 'auroc': 0.9078915, 'binary_precision': 0.57462686, 'binary_recall': 0.114413075, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.19083023}
confusion matrix:
       0   1
0  18010  57
1    596  77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.98075676, 'recall': 0.5423077, 'specificity': 0.5423077, 'f1': 0.5682038, 'auroc': 0.87001735, 'binary_precision': 1.0, 'binary_recall': 0.08461539, 'binary_specificity': 1.0, 'binary_f1_score': 0.15602838}
confusion matrix:
      0   1
0  5946   0
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_6.png
new oracle model saved
early stop counter: 1
val acc:0.965154767036438, best validation acc: 0.965154767036438, corresponding to test acc:                         0.9611666202545166 / 0.961650013923645
after epoch: 6,now: 2024-06-17 04:55:16.626218,epoch time: 0:24:50.910068,used: 2:29:53.300647,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9676484, 'precision': 0.74552524, 'recall': 0.6267243, 'specificity': 0.6267243, 'f1': 0.66535926, 'auroc': 0.9183205, 'binary_precision': 0.5157319, 'binary_recall': 0.26180556, 'binary_specificity': 0.9916431, 'binary_f1_score': 0.3473054}
confusion matrix:
       0    1
0  42006  354
1   1063  377
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.78919315, 'recall': 0.5833904, 'specificity': 0.5833904, 'f1': 0.624781, 'auroc': 0.91543293, 'binary_precision': 0.6084656, 'binary_recall': 0.17087667, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.26682132}
confusion matrix:
       0    1
0  17993   74
1    558  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.98114586, 'recall': 0.5519231, 'specificity': 0.5519231, 'f1': 0.58446836, 'auroc': 0.8791358, 'binary_precision': 1.0, 'binary_recall': 0.103846155, 'binary_specificity': 1.0, 'binary_f1_score': 0.18815331}
confusion matrix:
      0   1
0  5946   0
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-17 05:19:56.460881,epoch time: 0:24:39.834663,used: 2:54:33.135310,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9681507, 'precision': 0.75367, 'recall': 0.6256423, 'specificity': 0.6256423, 'f1': 0.66605586, 'auroc': 0.923532, 'binary_precision': 0.532097, 'binary_recall': 0.25902778, 'binary_specificity': 0.9922568, 'binary_f1_score': 0.3484353}
confusion matrix:
       0    1
0  42032  328
1   1067  373
---- Validation: 
scalar performance:
{'acc': 0.96558166, 'precision': 0.7776538, 'recall': 0.5687253, 'specificity': 0.5687253, 'f1': 0.6049718, 'auroc': 0.9176805, 'binary_precision': 0.58641976, 'binary_recall': 0.14115898, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.22754489}
confusion matrix:
       0   1
0  18000  67
1    578  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.9812237, 'recall': 0.5538462, 'specificity': 0.5538462, 'f1': 0.5876544, 'auroc': 0.87688625, 'binary_precision': 1.0, 'binary_recall': 0.10769231, 'binary_specificity': 1.0, 'binary_f1_score': 0.19444443}
confusion matrix:
      0   1
0  5946   0
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_8.png
new oracle model saved
early stop counter: 1
val acc:0.9655816555023193, best validation acc: 0.9662753343582153, corresponding to test acc:                         0.962455689907074 / 0.9626168012619019
after epoch: 8,now: 2024-06-17 05:44:27.208059,epoch time: 0:24:30.747178,used: 3:19:03.882488,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96812785, 'precision': 0.7517984, 'recall': 0.6437431, 'specificity': 0.6437431, 'f1': 0.6815997, 'auroc': 0.92833257, 'binary_precision': 0.52716047, 'binary_recall': 0.29652777, 'binary_specificity': 0.99095845, 'binary_f1_score': 0.37955555}
confusion matrix:
       0    1
0  41977  383
1   1013  427
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.78907216, 'recall': 0.6029517, 'specificity': 0.6029517, 'f1': 0.64804286, 'auroc': 0.9228992, 'binary_precision': 0.60683763, 'binary_recall': 0.21099554, 'binary_specificity': 0.99490786, 'binary_f1_score': 0.31312016}
confusion matrix:
       0    1
0  17975   92
1    531  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.98153543, 'recall': 0.56153846, 'specificity': 0.56153846, 'f1': 0.6001831, 'auroc': 0.88178027, 'binary_precision': 1.0, 'binary_recall': 0.12307692, 'binary_specificity': 1.0, 'binary_f1_score': 0.21917808}
confusion matrix:
      0   1
0  5946   0
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_9.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-06-17 06:09:16.459718,epoch time: 0:24:49.251659,used: 3:43:53.134147,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96762556, 'precision': 0.74457026, 'recall': 0.6402182, 'specificity': 0.6402182, 'f1': 0.6768616, 'auroc': 0.9292195, 'binary_precision': 0.51291513, 'binary_recall': 0.28978458, 'binary_specificity': 0.9906518, 'binary_f1_score': 0.3703375}
confusion matrix:
       0    1
0  41965  396
1   1022  417
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.7931937, 'recall': 0.59868777, 'specificity': 0.59868777, 'f1': 0.6436248, 'auroc': 0.92386854, 'binary_precision': 0.61538464, 'binary_recall': 0.20208023, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.30425057}
confusion matrix:
       0    1
0  17982   85
1    537  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.98114586, 'recall': 0.5519231, 'specificity': 0.5519231, 'f1': 0.58446836, 'auroc': 0.8837612, 'binary_precision': 1.0, 'binary_recall': 0.103846155, 'binary_specificity': 1.0, 'binary_f1_score': 0.18815331}
confusion matrix:
      0   1
0  5946   0
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_10.png
better model found
persisted
after epoch: 10,now: 2024-06-17 06:34:08.008974,epoch time: 0:24:51.549256,used: 4:08:44.683403,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9692009, 'precision': 0.76962507, 'recall': 0.6385087, 'specificity': 0.6385087, 'f1': 0.68113196, 'auroc': 0.92545134, 'binary_precision': 0.5631868, 'binary_recall': 0.28452465, 'binary_specificity': 0.99249274, 'binary_f1_score': 0.3780544}
confusion matrix:
       0    1
0  42041  318
1   1031  410
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7979648, 'recall': 0.58861864, 'specificity': 0.58861864, 'f1': 0.6320312, 'auroc': 0.92422885, 'binary_precision': 0.62564105, 'binary_recall': 0.18127786, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.281106}
confusion matrix:
       0    1
0  17994   73
1    551  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.98106796, 'recall': 0.55, 'specificity': 0.55, 'f1': 0.58126044, 'auroc': 0.8862865, 'binary_precision': 1.0, 'binary_recall': 0.1, 'binary_specificity': 1.0, 'binary_f1_score': 0.18181819}
confusion matrix:
      0   1
0  5946   0
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_11.png
early stop counter: 1
val acc:0.9667022228240967, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.962455689907074 / 0.9632613658905029
after epoch: 11,now: 2024-06-17 06:59:27.409228,epoch time: 0:25:19.400254,used: 4:34:04.083657,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9688356, 'precision': 0.7609074, 'recall': 0.6541716, 'specificity': 0.6541716, 'f1': 0.69252735, 'auroc': 0.93260515, 'binary_precision': 0.5446961, 'binary_recall': 0.31736112, 'binary_specificity': 0.99098206, 'binary_f1_score': 0.4010531}
confusion matrix:
       0    1
0  41978  382
1    983  457
---- Validation: 
scalar performance:
{'acc': 0.96782285, 'precision': 0.7994354, 'recall': 0.62639374, 'specificity': 0.62639374, 'f1': 0.6747116, 'auroc': 0.9282048, 'binary_precision': 0.62589926, 'binary_recall': 0.25854382, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.3659306}
confusion matrix:
       0    1
0  17963  104
1    499  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.982082, 'recall': 0.575, 'specificity': 0.575, 'f1': 0.6213124, 'auroc': 0.89045787, 'binary_precision': 1.0, 'binary_recall': 0.15, 'binary_specificity': 1.0, 'binary_f1_score': 0.2608696}
confusion matrix:
      0   1
0  5946   0
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_12.png
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-06-17 07:24:37.524250,epoch time: 0:25:10.115022,used: 4:59:14.198679,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96878994, 'precision': 0.7633255, 'recall': 0.63335204, 'specificity': 0.63335204, 'f1': 0.6751252, 'auroc': 0.93310285, 'binary_precision': 0.55090654, 'binary_recall': 0.27430555, 'binary_specificity': 0.9923985, 'binary_f1_score': 0.3662494}
confusion matrix:
       0    1
0  42038  322
1   1045  395
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.8092207, 'recall': 0.57934785, 'specificity': 0.57934785, 'f1': 0.6211058, 'auroc': 0.9266444, 'binary_precision': 0.64880955, 'binary_recall': 0.16196136, 'binary_specificity': 0.9967344, 'binary_f1_score': 0.2592152}
confusion matrix:
       0    1
0  18008   59
1    564  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.98083454, 'recall': 0.54423076, 'specificity': 0.54423076, 'f1': 0.5715021, 'auroc': 0.8877083, 'binary_precision': 1.0, 'binary_recall': 0.08846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.16254418}
confusion matrix:
      0   1
0  5946   0
1   237  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_13.png
early stop counter: 1
val acc:0.9667556285858154, best validation acc: 0.9678228497505188, corresponding to test acc:                         0.9643893241882324 / 0.9643893241882324
after epoch: 13,now: 2024-06-17 07:49:48.025135,epoch time: 0:25:10.500885,used: 5:24:24.699564,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9679909, 'precision': 0.7492136, 'recall': 0.66637313, 'specificity': 0.66637313, 'f1': 0.6987129, 'auroc': 0.9343014, 'binary_precision': 0.5205047, 'binary_recall': 0.34351146, 'binary_specificity': 0.98923486, 'binary_f1_score': 0.4138796}
confusion matrix:
       0    1
0  41903  456
1    946  495
---- Validation: 
scalar performance:
{'acc': 0.9680363, 'precision': 0.8035433, 'recall': 0.6272197, 'specificity': 0.6272197, 'f1': 0.6762061, 'auroc': 0.93110645, 'binary_precision': 0.634058, 'binary_recall': 0.2600297, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.36880928}
confusion matrix:
       0    1
0  17966  101
1    498  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.98184764, 'recall': 0.5692308, 'specificity': 0.5692308, 'f1': 0.61237764, 'auroc': 0.8926416, 'binary_precision': 1.0, 'binary_recall': 0.13846155, 'binary_specificity': 1.0, 'binary_f1_score': 0.24324325}
confusion matrix:
      0   1
0  5946   0
1   224  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_14.png
better model found
persisted
after epoch: 14,now: 2024-06-17 08:14:35.327706,epoch time: 0:24:47.302571,used: 5:49:12.002135,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9691781, 'precision': 0.7671677, 'recall': 0.64346117, 'specificity': 0.64346117, 'f1': 0.6849988, 'auroc': 0.93485695, 'binary_precision': 0.55789477, 'binary_recall': 0.29485396, 'binary_specificity': 0.99206835, 'binary_f1_score': 0.38580528}
confusion matrix:
       0    1
0  42026  336
1   1014  424
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.7945931, 'recall': 0.5987154, 'specificity': 0.5987154, 'f1': 0.643809, 'auroc': 0.92950505, 'binary_precision': 0.6181818, 'binary_recall': 0.20208023, 'binary_specificity': 0.99535066, 'binary_f1_score': 0.30459127}
confusion matrix:
       0    1
0  17983   84
1    537  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.9813016, 'recall': 0.5557692, 'specificity': 0.5557692, 'f1': 0.59081864, 'auroc': 0.88908976, 'binary_precision': 1.0, 'binary_recall': 0.11153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.20069206}
confusion matrix:
      0   1
0  5946   0
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_15.png
early stop counter: 1
val acc:0.9668623208999634, best validation acc: 0.9680362939834595, corresponding to test acc:                         0.9639058709144592 / 0.9643893241882324
after epoch: 15,now: 2024-06-17 08:39:25.908609,epoch time: 0:24:50.580903,used: 6:14:02.583038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96906394, 'precision': 0.7623532, 'recall': 0.67027974, 'specificity': 0.67027974, 'f1': 0.7055821, 'auroc': 0.94047934, 'binary_precision': 0.5465368, 'binary_recall': 0.35045108, 'binary_specificity': 0.9901084, 'binary_f1_score': 0.42706132}
confusion matrix:
       0    1
0  41940  419
1    936  505
---- Validation: 
scalar performance:
{'acc': 0.968143, 'precision': 0.8152478, 'recall': 0.6151155, 'specificity': 0.6151155, 'f1': 0.6648928, 'auroc': 0.93189144, 'binary_precision': 0.65833336, 'binary_recall': 0.23476969, 'binary_specificity': 0.99546134, 'binary_f1_score': 0.3461117}
confusion matrix:
       0    1
0  17985   82
1    515  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.98106796, 'recall': 0.55, 'specificity': 0.55, 'f1': 0.58126044, 'auroc': 0.89133334, 'binary_precision': 1.0, 'binary_recall': 0.1, 'binary_specificity': 1.0, 'binary_f1_score': 0.18181819}
confusion matrix:
      0   1
0  5946   0
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_16.png
better model found
persisted
after epoch: 16,now: 2024-06-17 09:04:17.109780,epoch time: 0:24:51.201171,used: 6:38:53.784209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9701598, 'precision': 0.781579, 'recall': 0.6556643, 'specificity': 0.6556643, 'f1': 0.6989013, 'auroc': 0.93474084, 'binary_precision': 0.58598727, 'binary_recall': 0.31900138, 'binary_specificity': 0.99232733, 'binary_f1_score': 0.4131118}
confusion matrix:
       0    1
0  42033  325
1    982  460
---- Validation: 
scalar performance:
{'acc': 0.96750265, 'precision': 0.8117274, 'recall': 0.5997628, 'specificity': 0.5997628, 'f1': 0.6468325, 'auroc': 0.9330703, 'binary_precision': 0.65238094, 'binary_recall': 0.20356612, 'binary_specificity': 0.99595946, 'binary_f1_score': 0.31030574}
confusion matrix:
       0    1
0  17994   73
1    536  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.9803684, 'recall': 0.5326923, 'specificity': 0.5326923, 'f1': 0.55135953, 'auroc': 0.88855714, 'binary_precision': 1.0, 'binary_recall': 0.06538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.12274369}
confusion matrix:
      0   1
0  5946   0
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_17.png
early stop counter: 1
val acc:0.9675026535987854, best validation acc: 0.9681429862976074, corresponding to test acc:                         0.9622945785522461 / 0.9643893241882324
after epoch: 17,now: 2024-06-17 09:29:15.401354,epoch time: 0:24:58.291574,used: 7:03:52.075783,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9700457, 'precision': 0.77770865, 'recall': 0.66207266, 'specificity': 0.66207266, 'f1': 0.7033254, 'auroc': 0.93772554, 'binary_precision': 0.57780457, 'binary_recall': 0.33240804, 'binary_specificity': 0.9917373, 'binary_f1_score': 0.4220264}
confusion matrix:
       0    1
0  42009  350
1    962  479
---- Validation: 
scalar performance:
{'acc': 0.96782285, 'precision': 0.8181905, 'recall': 0.60278994, 'specificity': 0.60278994, 'f1': 0.65108323, 'auroc': 0.93320924, 'binary_precision': 0.6650943, 'binary_recall': 0.20950966, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.31864405}
confusion matrix:
       0    1
0  17996   71
1    532  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.9805237, 'recall': 0.5365385, 'specificity': 0.5365385, 'f1': 0.55816877, 'auroc': 0.889397, 'binary_precision': 1.0, 'binary_recall': 0.073076926, 'binary_specificity': 1.0, 'binary_f1_score': 0.13620071}
confusion matrix:
      0   1
0  5946   0
1   241  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_18.png
early stop counter: 2
val acc:0.9678228497505188, best validation acc: 0.9681429862976074, corresponding to test acc:                         0.9622945785522461 / 0.9643893241882324
after epoch: 18,now: 2024-06-17 09:54:22.550488,epoch time: 0:25:07.149134,used: 7:28:59.224917,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9697032, 'precision': 0.7775999, 'recall': 0.6414498, 'specificity': 0.6414498, 'f1': 0.6854842, 'auroc': 0.9435627, 'binary_precision': 0.57894737, 'binary_recall': 0.29007635, 'binary_specificity': 0.99282324, 'binary_f1_score': 0.38650024}
confusion matrix:
       0    1
0  42055  304
1   1023  418
---- Validation: 
scalar performance:
{'acc': 0.9674493, 'precision': 0.8231189, 'recall': 0.58829087, 'specificity': 0.58829087, 'f1': 0.63369185, 'auroc': 0.9331378, 'binary_precision': 0.67597765, 'binary_recall': 0.17979197, 'binary_specificity': 0.99678975, 'binary_f1_score': 0.28403756}
confusion matrix:
       0    1
0  18009   58
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.98005813, 'recall': 0.525, 'specificity': 0.525, 'f1': 0.53744525, 'auroc': 0.89078957, 'binary_precision': 1.0, 'binary_recall': 0.05, 'binary_specificity': 1.0, 'binary_f1_score': 0.095238104}
confusion matrix:
      0   1
0  5946   0
1   247  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_19.png
early stop counter: 3
val acc:0.9674493074417114, best validation acc: 0.9681429862976074, corresponding to test acc:                         0.9622945785522461 / 0.9643893241882324
after epoch: 19,now: 2024-06-17 10:20:21.541701,epoch time: 0:25:58.991213,used: 7:54:58.216130,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9705251, 'precision': 0.7799659, 'recall': 0.682096, 'specificity': 0.682096, 'f1': 0.7197186, 'auroc': 0.9407054, 'binary_precision': 0.58099353, 'binary_recall': 0.37335184, 'binary_specificity': 0.9908402, 'binary_f1_score': 0.45458388}
confusion matrix:
       0    1
0  41971  388
1    903  538
---- Validation: 
scalar performance:
{'acc': 0.9691035, 'precision': 0.8159266, 'recall': 0.64279383, 'specificity': 0.64279383, 'f1': 0.69392425, 'auroc': 0.935499, 'binary_precision': 0.6577181, 'binary_recall': 0.29123327, 'binary_specificity': 0.99435437, 'binary_f1_score': 0.40370753}
confusion matrix:
       0    1
0  17965  102
1    477  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.98106796, 'recall': 0.55, 'specificity': 0.55, 'f1': 0.58126044, 'auroc': 0.89177954, 'binary_precision': 1.0, 'binary_recall': 0.1, 'binary_specificity': 1.0, 'binary_f1_score': 0.18181819}
confusion matrix:
      0   1
0  5946   0
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_20.png
better model found
persisted
after epoch: 20,now: 2024-06-17 10:46:22.202324,epoch time: 0:26:00.660623,used: 8:20:58.876753,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.970274, 'precision': 0.7834505, 'recall': 0.65141755, 'specificity': 0.65141755, 'f1': 0.6956592, 'auroc': 0.9399904, 'binary_precision': 0.5899471, 'binary_recall': 0.31015298, 'binary_specificity': 0.9926821, 'binary_f1_score': 0.4065633}
confusion matrix:
       0    1
0  42052  310
1    992  446
---- Validation: 
scalar performance:
{'acc': 0.96755606, 'precision': 0.80921984, 'recall': 0.60408205, 'specificity': 0.60408205, 'f1': 0.6516461, 'auroc': 0.9355055, 'binary_precision': 0.64705884, 'binary_recall': 0.21248142, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.3199105}
confusion matrix:
       0    1
0  17989   78
1    530  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.89033496, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_21.png
early stop counter: 1
val acc:0.9675560593605042, best validation acc: 0.9691035151481628, corresponding to test acc:                         0.9622945785522461 / 0.9643893241882324
after epoch: 21,now: 2024-06-17 11:10:54.451715,epoch time: 0:24:32.249391,used: 8:45:31.126144,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97061646, 'precision': 0.78105843, 'recall': 0.68403506, 'specificity': 0.68403506, 'f1': 0.72150207, 'auroc': 0.94409233, 'binary_precision': 0.5830654, 'binary_recall': 0.3772538, 'binary_specificity': 0.99081635, 'binary_f1_score': 0.4581053}
confusion matrix:
       0    1
0  41969  389
1    898  544
---- Validation: 
scalar performance:
{'acc': 0.96873, 'precision': 0.82437587, 'recall': 0.62185735, 'specificity': 0.62185735, 'f1': 0.6735076, 'auroc': 0.93634963, 'binary_precision': 0.67611337, 'binary_recall': 0.24814264, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.3630435}
confusion matrix:
       0    1
0  17987   80
1    506  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9802908, 'recall': 0.5307692, 'specificity': 0.5307692, 'f1': 0.5479183, 'auroc': 0.8926077, 'binary_precision': 1.0, 'binary_recall': 0.06153846, 'binary_specificity': 1.0, 'binary_f1_score': 0.11594203}
confusion matrix:
      0   1
0  5946   0
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_22.png
early stop counter: 2
val acc:0.9687299728393555, best validation acc: 0.9691035151481628, corresponding to test acc:                         0.9622945785522461 / 0.9643893241882324
after epoch: 22,now: 2024-06-17 11:35:59.610841,epoch time: 0:25:05.159126,used: 9:10:36.285270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97059363, 'precision': 0.7867261, 'recall': 0.6601117, 'specificity': 0.6601117, 'f1': 0.7039257, 'auroc': 0.9406986, 'binary_precision': 0.5959596, 'binary_recall': 0.32777777, 'binary_specificity': 0.9924457, 'binary_f1_score': 0.42293906}
confusion matrix:
       0    1
0  42040  320
1    968  472
---- Validation: 
scalar performance:
{'acc': 0.9688367, 'precision': 0.83246225, 'recall': 0.6169058, 'specificity': 0.6169058, 'f1': 0.6690078, 'auroc': 0.935907, 'binary_precision': 0.6926407, 'binary_recall': 0.23774146, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.3539823}
confusion matrix:
       0    1
0  17996   71
1    513  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.9799806, 'recall': 0.52307695, 'specificity': 0.52307695, 'f1': 0.5339035, 'auroc': 0.8913704, 'binary_precision': 1.0, 'binary_recall': 0.046153847, 'binary_specificity': 1.0, 'binary_f1_score': 0.08823529}
confusion matrix:
      0   1
0  5946   0
1   248  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_23.png
early stop counter: 3
val acc:0.9688367247581482, best validation acc: 0.9691035151481628, corresponding to test acc:                         0.9622945785522461 / 0.9643893241882324
after epoch: 23,now: 2024-06-17 12:00:36.125832,epoch time: 0:24:36.514991,used: 9:35:12.800261,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9703653, 'precision': 0.78462267, 'recall': 0.65371835, 'specificity': 0.65371835, 'f1': 0.69793546, 'auroc': 0.94001555, 'binary_precision': 0.5921569, 'binary_recall': 0.31480193, 'binary_specificity': 0.9926347, 'binary_f1_score': 0.41107076}
confusion matrix:
       0    1
0  42049  312
1    986  453
---- Validation: 
scalar performance:
{'acc': 0.9681964, 'precision': 0.8261261, 'recall': 0.6058447, 'specificity': 0.6058447, 'f1': 0.6555135, 'auroc': 0.936513, 'binary_precision': 0.68075114, 'binary_recall': 0.2154532, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.32731378}
confusion matrix:
       0    1
0  17999   68
1    528  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.97990316, 'recall': 0.52115387, 'specificity': 0.52115387, 'f1': 0.5303359, 'auroc': 0.891698, 'binary_precision': 1.0, 'binary_recall': 0.042307694, 'binary_specificity': 1.0, 'binary_f1_score': 0.08118081}
confusion matrix:
      0   1
0  5946   0
1   249  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_24.png
early stop counter: 4
val acc:0.9681963920593262, best validation acc: 0.9691035151481628, corresponding to test acc:                         0.9622945785522461 / 0.9643893241882324
after epoch: 24,now: 2024-06-17 12:25:31.147406,epoch time: 0:24:55.021574,used: 10:00:07.821835,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9710959, 'precision': 0.79393667, 'recall': 0.6628232, 'specificity': 0.6628232, 'f1': 0.70796347, 'auroc': 0.9424218, 'binary_precision': 0.6101911, 'binary_recall': 0.33287004, 'binary_specificity': 0.9927764, 'binary_f1_score': 0.4307554}
confusion matrix:
       0    1
0  42055  306
1    960  479
---- Validation: 
scalar performance:
{'acc': 0.96824974, 'precision': 0.82371646, 'recall': 0.60944873, 'specificity': 0.60944873, 'f1': 0.659466, 'auroc': 0.93612003, 'binary_precision': 0.6756757, 'binary_recall': 0.22288261, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.33519554}
confusion matrix:
       0    1
0  17995   72
1    523  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.97990316, 'recall': 0.52115387, 'specificity': 0.52115387, 'f1': 0.5303359, 'auroc': 0.8897895, 'binary_precision': 1.0, 'binary_recall': 0.042307694, 'binary_specificity': 1.0, 'binary_f1_score': 0.08118081}
confusion matrix:
      0   1
0  5946   0
1   249  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_25.png
early stop counter: 5
val acc:0.9682497382164001, best validation acc: 0.9691035151481628, corresponding to test acc:                         0.9622945785522461 / 0.9643893241882324
after epoch: 25,now: 2024-06-17 12:50:31.272629,epoch time: 0:25:00.125223,used: 10:25:07.947058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9708904, 'precision': 0.7850311, 'recall': 0.6813966, 'specificity': 0.6813966, 'f1': 0.7206674, 'auroc': 0.9450927, 'binary_precision': 0.59116024, 'binary_recall': 0.3715278, 'binary_specificity': 0.99126536, 'binary_f1_score': 0.45629}
confusion matrix:
       0    1
0  41990  370
1    905  535
---- Validation: 
scalar performance:
{'acc': 0.96958375, 'precision': 0.836858, 'recall': 0.6315986, 'specificity': 0.6315986, 'f1': 0.68575084, 'auroc': 0.93867475, 'binary_precision': 0.7003891, 'binary_recall': 0.26745912, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.38709676}
confusion matrix:
       0    1
0  17990   77
1    493  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.89438486, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_26.png
better model found
persisted
after epoch: 26,now: 2024-06-17 13:15:30.842992,epoch time: 0:24:59.570363,used: 10:50:07.517421,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9707306, 'precision': 0.78587115, 'recall': 0.6699097, 'specificity': 0.6699097, 'f1': 0.7118387, 'auroc': 0.94430465, 'binary_precision': 0.5936019, 'binary_recall': 0.34791666, 'binary_specificity': 0.9919027, 'binary_f1_score': 0.438704}
confusion matrix:
       0    1
0  42017  343
1    939  501
---- Validation: 
scalar performance:
{'acc': 0.9689968, 'precision': 0.8291415, 'recall': 0.6241415, 'specificity': 0.6241415, 'f1': 0.67663586, 'auroc': 0.93826854, 'binary_precision': 0.6854839, 'binary_recall': 0.25260028, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.36916393}
confusion matrix:
       0    1
0  17989   78
1    503  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.97990316, 'recall': 0.52115387, 'specificity': 0.52115387, 'f1': 0.5303359, 'auroc': 0.89308393, 'binary_precision': 1.0, 'binary_recall': 0.042307694, 'binary_specificity': 1.0, 'binary_f1_score': 0.08118081}
confusion matrix:
      0   1
0  5946   0
1   249  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_27.png
early stop counter: 1
val acc:0.9689968228340149, best validation acc: 0.9695837497711182, corresponding to test acc:                         0.9603609442710876 / 0.9643893241882324
after epoch: 27,now: 2024-06-17 13:40:37.847588,epoch time: 0:25:07.004596,used: 11:15:14.522017,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9706621, 'precision': 0.7878874, 'recall': 0.6610507, 'specificity': 0.6610507, 'f1': 0.7050015, 'auroc': 0.94321203, 'binary_precision': 0.5982368, 'binary_recall': 0.3296322, 'binary_specificity': 0.99246913, 'binary_f1_score': 0.42505595}
confusion matrix:
       0    1
0  42040  319
1    966  475
---- Validation: 
scalar performance:
{'acc': 0.96905017, 'precision': 0.83202815, 'recall': 0.62273866, 'specificity': 0.62273866, 'f1': 0.67547476, 'auroc': 0.9382583, 'binary_precision': 0.69135803, 'binary_recall': 0.24962853, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.36681223}
confusion matrix:
       0    1
0  17992   75
1    505  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.97982574, 'recall': 0.5192308, 'specificity': 0.5192308, 'f1': 0.52674216, 'auroc': 0.8935852, 'binary_precision': 1.0, 'binary_recall': 0.03846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.074074075}
confusion matrix:
      0   1
0  5946   0
1   250  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_28.png
early stop counter: 2
val acc:0.9690501689910889, best validation acc: 0.9695837497711182, corresponding to test acc:                         0.9603609442710876 / 0.9643893241882324
after epoch: 28,now: 2024-06-17 14:06:04.277720,epoch time: 0:25:26.430132,used: 11:40:40.952149,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97150683, 'precision': 0.79425836, 'recall': 0.6787065, 'specificity': 0.6787065, 'f1': 0.7211443, 'auroc': 0.94687843, 'binary_precision': 0.6097561, 'binary_recall': 0.36534446, 'binary_specificity': 0.9920685, 'binary_f1_score': 0.45691904}
confusion matrix:
       0    1
0  42027  336
1    912  525
---- Validation: 
scalar performance:
{'acc': 0.96947706, 'precision': 0.8327208, 'recall': 0.6329738, 'specificity': 0.6329738, 'f1': 0.68661827, 'auroc': 0.9390836, 'binary_precision': 0.69201523, 'binary_recall': 0.2704309, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.3888889}
confusion matrix:
       0    1
0  17986   81
1    491  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.9801357, 'recall': 0.52692306, 'specificity': 0.52692306, 'f1': 0.54096144, 'auroc': 0.8914542, 'binary_precision': 1.0, 'binary_recall': 0.053846154, 'binary_specificity': 1.0, 'binary_f1_score': 0.10218979}
confusion matrix:
      0   1
0  5946   0
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_29.png
early stop counter: 3
val acc:0.9694770574569702, best validation acc: 0.9695837497711182, corresponding to test acc:                         0.9603609442710876 / 0.9643893241882324
after epoch: 29,now: 2024-06-17 14:29:23.378533,epoch time: 0:23:19.100813,used: 12:04:00.052962,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.97121006, 'precision': 0.79073477, 'recall': 0.67909837, 'specificity': 0.67909837, 'f1': 0.7204879, 'auroc': 0.9482596, 'binary_precision': 0.60273975, 'binary_recall': 0.36641222, 'binary_specificity': 0.9917845, 'binary_f1_score': 0.4557618}
confusion matrix:
       0    1
0  42011  348
1    913  528
---- Validation: 
scalar performance:
{'acc': 0.9696905, 'precision': 0.83105856, 'recall': 0.64023715, 'specificity': 0.64023715, 'f1': 0.69390583, 'auroc': 0.9384738, 'binary_precision': 0.68817204, 'binary_recall': 0.28528973, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.40336135}
confusion matrix:
       0    1
0  17980   87
1    481  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.9802132, 'recall': 0.52884614, 'specificity': 0.52884614, 'f1': 0.54445237, 'auroc': 0.895393, 'binary_precision': 1.0, 'binary_recall': 0.057692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.10909091}
confusion matrix:
      0   1
0  5946   0
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_30.png
better model found
persisted
after epoch: 30,now: 2024-06-17 14:55:28.701818,epoch time: 0:26:05.323285,used: 12:30:05.376247,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_02_25_23_seed_1_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:30:05.376247 at 2024-06-17 14:55:28.701818
persisted model performance metric: 

scalar performance:
{'acc': 0.96052206, 'precision': 0.9802132, 'recall': 0.52884614, 'specificity': 0.52884614, 'f1': 0.54445237, 'auroc': 0.895393, 'binary_precision': 1.0, 'binary_recall': 0.057692308, 'binary_specificity': 1.0, 'binary_f1_score': 0.10909091}
confusion matrix:
      0   1
0  5946   0
1   245  15
oracle model performance metric: 

scalar performance:
{'acc': 0.9643893, 'precision': 0.982082, 'recall': 0.575, 'specificity': 0.575, 'f1': 0.6213124, 'auroc': 0.89045787, 'binary_precision': 1.0, 'binary_recall': 0.15, 'binary_specificity': 1.0, 'binary_f1_score': 0.2608696}
confusion matrix:
      0   1
0  5946   0
1   221  39
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool | 167936 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool | 167936 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |  36242 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB |   1428 MiB |    771 TiB |    771 TiB |
|       from large pool | 165120 KiB |   1358 MiB |    771 TiB |    771 TiB |
|       from small pool |  35966 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1466 MiB |   1524 MiB |   2478 MiB |   1012 MiB |
|       from large pool |   1392 MiB |   1450 MiB |   2374 MiB |    982 MiB |
|       from small pool |     74 MiB |     74 MiB |    104 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 568690 GiB | 568689 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 568413 GiB | 568413 GiB |
|       from small pool |   8813 KiB |  16408 KiB |    276 GiB |    276 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   27640 K  |   27639 K  |
|       from large pool |      36    |      76    |    9260 K  |    9260 K  |
|       from small pool |    1242    |    1864    |   18380 K  |   18379 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   27640 K  |   27639 K  |
|       from large pool |      36    |      76    |    9260 K  |    9260 K  |
|       from small pool |    1242    |    1864    |   18380 K  |   18379 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      50    |      68    |      19    |
|       from large pool |      12    |      13    |      16    |       4    |
|       from small pool |      37    |      37    |      52    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |     453    |   15732 K  |   15732 K  |
|       from large pool |       5    |      11    |    4128 K  |    4128 K  |
|       from small pool |      31    |     448    |   11604 K  |   11604 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1358 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 568690 GiB | 568690 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 568413 GiB | 568413 GiB |
|       from small pool |      0 KiB |  16408 KiB |    276 GiB |    276 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   27640 K  |   27640 K  |
|       from large pool |       2    |      76    |    9260 K  |    9260 K  |
|       from small pool |       0    |    1864    |   18380 K  |   18380 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   27640 K  |   27640 K  |
|       from large pool |       2    |      76    |    9260 K  |    9260 K  |
|       from small pool |       0    |    1864    |   18380 K  |   18380 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   15733 K  |   15733 K  |
|       from large pool |       1    |      11    |    4128 K  |    4128 K  |
|       from small pool |       0    |     448    |   11604 K  |   11604 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1366 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     72 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB |    771 TiB |    771 TiB |
|       from large pool |  16640 KiB |   1358 MiB |    771 TiB |    771 TiB |
|       from small pool |      0 KiB |     71 MiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   2478 MiB |   1966 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   2374 MiB |   1906 MiB |
|       from small pool |  45056 KiB |     74 MiB |    104 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 568690 GiB | 568690 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 568413 GiB | 568413 GiB |
|       from small pool |      0 KiB |  16408 KiB |    276 GiB |    276 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   27640 K  |   27640 K  |
|       from large pool |       2    |      76    |    9260 K  |    9260 K  |
|       from small pool |       0    |    1864    |   18380 K  |   18380 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   27640 K  |   27640 K  |
|       from large pool |       2    |      76    |    9260 K  |    9260 K  |
|       from small pool |       0    |    1864    |   18380 K  |   18380 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      68    |      37    |
|       from large pool |       9    |      13    |      16    |       7    |
|       from small pool |      22    |      37    |      52    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     453    |   15733 K  |   15733 K  |
|       from large pool |       1    |      11    |    4128 K  |    4128 K  |
|       from small pool |       0    |     448    |   11604 K  |   11604 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388

 Experiment start at: 2024-06-17 15:07:16.238796
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9654566, 'precision': 0.4827283, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49121237, 'auroc': 0.7071956, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42287  0
1   1513  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.66678274, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.65861094, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-17 15:32:17.509361,epoch time: 0:25:01.270565,used: 0:25:01.270565,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96568495, 'precision': 0.8578819, 'recall': 0.5039236, 'specificity': 0.5039236, 'f1': 0.49912757, 'auroc': 0.8440701, 'binary_precision': 0.75, 'binary_recall': 0.00794176, 'binary_specificity': 0.9999054, 'binary_f1_score': 0.015717091}
confusion matrix:
       0   1
0  42285   4
1   1499  12
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.83568144, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.815314, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_2.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-17 15:57:02.273863,epoch time: 0:24:44.764502,used: 0:49:46.035067,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96575344, 'precision': 0.7533558, 'recall': 0.52628875, 'specificity': 0.52628875, 'f1': 0.5405514, 'auroc': 0.8871646, 'binary_precision': 0.5394737, 'binary_recall': 0.054232806, 'binary_specificity': 0.99834466, 'binary_f1_score': 0.098557696}
confusion matrix:
       0   1
0  42218  70
1   1430  82
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.7488976, 'recall': 0.50725496, 'specificity': 0.50725496, 'f1': 0.5064019, 'auroc': 0.8757927, 'binary_precision': 0.5294118, 'binary_recall': 0.014950166, 'binary_specificity': 0.99955976, 'binary_f1_score': 0.029079162}
confusion matrix:
       0  1
0  18163  8
1    593  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.98114574, 'recall': 0.5144628, 'specificity': 0.5144628, 'f1': 0.51850414, 'auroc': 0.85063934, 'binary_precision': 1.0, 'binary_recall': 0.02892562, 'binary_specificity': 1.0, 'binary_f1_score': 0.056224898}
confusion matrix:
      0  1
0  5997  0
1   235  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-17 16:20:35.760690,epoch time: 0:23:33.486827,used: 1:13:19.521894,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.7560465, 'recall': 0.5871563, 'specificity': 0.5871563, 'f1': 0.62632084, 'auroc': 0.90197253, 'binary_precision': 0.54075545, 'binary_recall': 0.17977528, 'binary_specificity': 0.99453735, 'binary_f1_score': 0.26984125}
confusion matrix:
       0    1
0  42056  231
1   1241  272
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.7610381, 'recall': 0.538794, 'specificity': 0.538794, 'f1': 0.5616216, 'auroc': 0.89247584, 'binary_precision': 0.55172414, 'binary_recall': 0.07973422, 'binary_specificity': 0.9978537, 'binary_f1_score': 0.13933237}
confusion matrix:
       0   1
0  18132  39
1    554  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.98300576, 'recall': 0.5640496, 'specificity': 0.5640496, 'f1': 0.6049091, 'auroc': 0.86245465, 'binary_precision': 1.0, 'binary_recall': 0.12809917, 'binary_specificity': 1.0, 'binary_f1_score': 0.22710621}
confusion matrix:
      0   1
0  5997   0
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-17 16:44:55.408527,epoch time: 0:24:19.647837,used: 1:37:39.169731,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96634704, 'precision': 0.7520017, 'recall': 0.60561407, 'specificity': 0.60561407, 'f1': 0.6460159, 'auroc': 0.9123017, 'binary_precision': 0.531401, 'binary_recall': 0.21810971, 'binary_specificity': 0.99311846, 'binary_f1_score': 0.30927834}
confusion matrix:
       0    1
0  41996  291
1   1183  330
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.7501173, 'recall': 0.5596457, 'specificity': 0.5596457, 'f1': 0.5916607, 'auroc': 0.9038137, 'binary_precision': 0.5285714, 'binary_recall': 0.12292359, 'binary_specificity': 0.9963678, 'binary_f1_score': 0.19946091}
confusion matrix:
       0   1
0  18105  66
1    528  74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.983551, 'recall': 0.57851243, 'specificity': 0.57851243, 'f1': 0.62735224, 'auroc': 0.87169737, 'binary_precision': 1.0, 'binary_recall': 0.1570248, 'binary_specificity': 1.0, 'binary_f1_score': 0.27142856}
confusion matrix:
      0   1
0  5997   0
1   204  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_5.png
new oracle model saved
early stop counter: 1
val acc:0.9683588147163391, best validation acc: 0.9684121012687683, corresponding to test acc:                         0.9661805033683777 / 0.9673024415969849
after epoch: 5,now: 2024-06-17 17:08:50.122133,epoch time: 0:23:54.713606,used: 2:01:33.883337,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96609586, 'precision': 0.7461339, 'recall': 0.6277892, 'specificity': 0.6277892, 'f1': 0.6663517, 'auroc': 0.91724694, 'binary_precision': 0.5181347, 'binary_recall': 0.26437542, 'binary_specificity': 0.99120295, 'binary_f1_score': 0.3501094}
confusion matrix:
       0    1
0  41915  372
1   1113  400
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.75124824, 'recall': 0.5709434, 'specificity': 0.5709434, 'f1': 0.606535, 'auroc': 0.9077463, 'binary_precision': 0.5301205, 'binary_recall': 0.14617941, 'binary_specificity': 0.99570745, 'binary_f1_score': 0.22916666}
confusion matrix:
       0   1
0  18093  78
1    514  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9681039, 'precision': 0.98394126, 'recall': 0.588843, 'specificity': 0.588843, 'f1': 0.64271677, 'auroc': 0.87555814, 'binary_precision': 1.0, 'binary_recall': 0.17768595, 'binary_specificity': 1.0, 'binary_f1_score': 0.3017544}
confusion matrix:
      0   1
0  5997   0
1   199  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-17 17:33:14.804640,epoch time: 0:24:24.682507,used: 2:25:58.565844,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96712327, 'precision': 0.76741046, 'recall': 0.6044822, 'specificity': 0.6044822, 'f1': 0.6470823, 'auroc': 0.9210749, 'binary_precision': 0.56228375, 'binary_recall': 0.21494709, 'binary_specificity': 0.99401724, 'binary_f1_score': 0.3110048}
confusion matrix:
       0    1
0  42035  253
1   1187  325
---- Validation: 
scalar performance:
{'acc': 0.9687849, 'precision': 0.76703703, 'recall': 0.5582597, 'specificity': 0.5582597, 'f1': 0.59067166, 'auroc': 0.9102254, 'binary_precision': 0.5625, 'binary_recall': 0.11960133, 'binary_specificity': 0.99691814, 'binary_f1_score': 0.19726028}
confusion matrix:
       0   1
0  18115  56
1    530  72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.98331726, 'recall': 0.572314, 'specificity': 0.572314, 'f1': 0.61787087, 'auroc': 0.87754536, 'binary_precision': 1.0, 'binary_recall': 0.1446281, 'binary_specificity': 1.0, 'binary_f1_score': 0.25270757}
confusion matrix:
      0   1
0  5997   0
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_7.png
better model found
persisted
after epoch: 7,now: 2024-06-17 17:57:09.751942,epoch time: 0:23:54.947302,used: 2:49:53.513146,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9667352, 'precision': 0.75554264, 'recall': 0.628196, 'specificity': 0.628196, 'f1': 0.66869026, 'auroc': 0.92454875, 'binary_precision': 0.53691274, 'binary_recall': 0.26455027, 'binary_specificity': 0.9918417, 'binary_f1_score': 0.35445282}
confusion matrix:
       0    1
0  41943  345
1   1112  400
---- Validation: 
scalar performance:
{'acc': 0.9687849, 'precision': 0.7630673, 'recall': 0.5662902, 'specificity': 0.5662902, 'f1': 0.60137045, 'auroc': 0.9131495, 'binary_precision': 0.5540541, 'binary_recall': 0.13621262, 'binary_specificity': 0.9963678, 'binary_f1_score': 0.21866666}
confusion matrix:
       0   1
0  18105  66
1    520  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.983551, 'recall': 0.57851243, 'specificity': 0.57851243, 'f1': 0.62735224, 'auroc': 0.88211596, 'binary_precision': 1.0, 'binary_recall': 0.1570248, 'binary_specificity': 1.0, 'binary_f1_score': 0.27142856}
confusion matrix:
      0   1
0  5997   0
1   204  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_8.png
early stop counter: 1
val acc:0.9687849283218384, best validation acc: 0.9687849283218384, corresponding to test acc:                         0.9668216109275818 / 0.9681038856506348
after epoch: 8,now: 2024-06-17 18:20:16.754655,epoch time: 0:23:07.002713,used: 3:13:00.515859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9672146, 'precision': 0.76333785, 'recall': 0.63028044, 'specificity': 0.63028044, 'f1': 0.67219275, 'auroc': 0.926474, 'binary_precision': 0.552381, 'binary_recall': 0.26834103, 'binary_specificity': 0.9922198, 'binary_f1_score': 0.36121}
confusion matrix:
       0    1
0  41958  329
1   1107  406
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.75105965, 'recall': 0.56368846, 'specificity': 0.56368846, 'f1': 0.59713495, 'auroc': 0.9163447, 'binary_precision': 0.5302013, 'binary_recall': 0.13122924, 'binary_specificity': 0.9961477, 'binary_f1_score': 0.21038617}
confusion matrix:
       0   1
0  18101  70
1    523  79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.98347306, 'recall': 0.5764463, 'specificity': 0.5764463, 'f1': 0.6242141, 'auroc': 0.88090193, 'binary_precision': 1.0, 'binary_recall': 0.15289256, 'binary_specificity': 1.0, 'binary_f1_score': 0.26523295}
confusion matrix:
      0   1
0  5997   0
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_9.png
early stop counter: 2
val acc:0.9684121012687683, best validation acc: 0.9687849283218384, corresponding to test acc:                         0.9668216109275818 / 0.9681038856506348
after epoch: 9,now: 2024-06-17 18:48:05.724090,epoch time: 0:27:48.969435,used: 3:40:49.485294,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9678311, 'precision': 0.7714783, 'recall': 0.6368164, 'specificity': 0.6368164, 'f1': 0.6798812, 'auroc': 0.9284542, 'binary_precision': 0.5681818, 'binary_recall': 0.28127068, 'binary_specificity': 0.9923621, 'binary_f1_score': 0.37627268}
confusion matrix:
       0    1
0  41966  323
1   1086  425
---- Validation: 
scalar performance:
{'acc': 0.9686251, 'precision': 0.75454986, 'recall': 0.57745034, 'specificity': 0.57745034, 'f1': 0.614909, 'auroc': 0.9200915, 'binary_precision': 0.5363129, 'binary_recall': 0.15946844, 'binary_specificity': 0.99543226, 'binary_f1_score': 0.24583866}
confusion matrix:
       0   1
0  18088  83
1    506  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9679436, 'precision': 0.9838631, 'recall': 0.58677685, 'specificity': 0.58677685, 'f1': 0.6396866, 'auroc': 0.8851869, 'binary_precision': 1.0, 'binary_recall': 0.17355372, 'binary_specificity': 1.0, 'binary_f1_score': 0.29577464}
confusion matrix:
      0   1
0  5997   0
1   200  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_10.png
early stop counter: 3
val acc:0.9686251282691956, best validation acc: 0.9687849283218384, corresponding to test acc:                         0.9668216109275818 / 0.9681038856506348
after epoch: 10,now: 2024-06-17 19:15:52.953311,epoch time: 0:27:47.229221,used: 4:08:36.714515,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96753424, 'precision': 0.7630584, 'recall': 0.6595396, 'specificity': 0.6595396, 'f1': 0.6973653, 'auroc': 0.9340426, 'binary_precision': 0.54977876, 'binary_recall': 0.3287037, 'binary_specificity': 0.9903755, 'binary_f1_score': 0.41142383}
confusion matrix:
       0    1
0  41881  407
1   1015  497
---- Validation: 
scalar performance:
{'acc': 0.9688915, 'precision': 0.75639296, 'recall': 0.6016794, 'specificity': 0.6016794, 'f1': 0.64276344, 'auroc': 0.9246159, 'binary_precision': 0.53846157, 'binary_recall': 0.20930232, 'binary_specificity': 0.99405646, 'binary_f1_score': 0.3014354}
confusion matrix:
       0    1
0  18063  108
1    476  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97002727, 'precision': 0.9680832, 'recall': 0.6176019, 'specificity': 0.6176019, 'f1': 0.68169034, 'auroc': 0.88819015, 'binary_precision': 0.9661017, 'binary_recall': 0.23553719, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.3787375}
confusion matrix:
      0   1
0  5995   2
1   185  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_11.png
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-06-17 19:43:04.034704,epoch time: 0:27:11.081393,used: 4:35:47.795908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9685845, 'precision': 0.78427255, 'recall': 0.63609135, 'specificity': 0.63609135, 'f1': 0.68175274, 'auroc': 0.9331645, 'binary_precision': 0.59379405, 'binary_recall': 0.2789927, 'binary_specificity': 0.99319005, 'binary_f1_score': 0.37962127}
confusion matrix:
       0    1
0  42003  288
1   1088  421
---- Validation: 
scalar performance:
{'acc': 0.9691046, 'precision': 0.7691127, 'recall': 0.57689494, 'specificity': 0.57689494, 'f1': 0.61549103, 'auroc': 0.9227333, 'binary_precision': 0.5654762, 'binary_recall': 0.1578073, 'binary_specificity': 0.9959826, 'binary_f1_score': 0.24675325}
confusion matrix:
       0   1
0  18098  73
1    507  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.97072786, 'recall': 0.578429, 'specificity': 0.578429, 'f1': 0.6268276, 'auroc': 0.8841193, 'binary_precision': 0.974359, 'binary_recall': 0.1570248, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.27046263}
confusion matrix:
      0   1
0  5996   1
1   204  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_12.png
better model found
persisted
after epoch: 12,now: 2024-06-17 20:09:31.344302,epoch time: 0:26:27.309598,used: 5:02:15.105506,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9679452, 'precision': 0.76602536, 'recall': 0.67633337, 'specificity': 0.67633337, 'f1': 0.71117514, 'auroc': 0.9359918, 'binary_precision': 0.55454546, 'binary_recall': 0.36309522, 'binary_specificity': 0.9895715, 'binary_f1_score': 0.4388489}
confusion matrix:
       0    1
0  41847  441
1    963  549
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.75638247, 'recall': 0.6226412, 'specificity': 0.6226412, 'f1': 0.6638275, 'auroc': 0.92738354, 'binary_precision': 0.53710246, 'binary_recall': 0.25249168, 'binary_specificity': 0.9927907, 'binary_f1_score': 0.3435028}
confusion matrix:
       0    1
0  18040  131
1    450  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97018754, 'precision': 0.96844417, 'recall': 0.61966795, 'specificity': 0.61966795, 'f1': 0.684415, 'auroc': 0.89053756, 'binary_precision': 0.96666664, 'binary_recall': 0.23966943, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.38410598}
confusion matrix:
      0   1
0  5995   2
1   184  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_13.png
new oracle model saved
early stop counter: 1
val acc:0.9690513014793396, best validation acc: 0.9691045880317688, corresponding to test acc:                         0.9671421647071838 / 0.9701875448226929
after epoch: 13,now: 2024-06-17 20:36:24.150345,epoch time: 0:26:52.806043,used: 5:29:07.911549,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.968379, 'precision': 0.7778129, 'recall': 0.6469917, 'specificity': 0.6469917, 'f1': 0.6904017, 'auroc': 0.9374716, 'binary_precision': 0.5801527, 'binary_recall': 0.3017869, 'binary_specificity': 0.99219656, 'binary_f1_score': 0.39703962}
confusion matrix:
       0    1
0  41959  330
1   1055  456
---- Validation: 
scalar performance:
{'acc': 0.9687849, 'precision': 0.75587624, 'recall': 0.59118474, 'specificity': 0.59118474, 'f1': 0.63118625, 'auroc': 0.9259825, 'binary_precision': 0.53809524, 'binary_recall': 0.18770765, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.27832514}
confusion matrix:
       0    1
0  18074   97
1    489  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9677833, 'precision': 0.9837851, 'recall': 0.5847107, 'specificity': 0.5847107, 'f1': 0.63663524, 'auroc': 0.8841223, 'binary_precision': 1.0, 'binary_recall': 0.1694215, 'binary_specificity': 1.0, 'binary_f1_score': 0.28975266}
confusion matrix:
      0   1
0  5997   0
1   201  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_14.png
early stop counter: 2
val acc:0.9687849283218384, best validation acc: 0.9691045880317688, corresponding to test acc:                         0.9671421647071838 / 0.9701875448226929
after epoch: 14,now: 2024-06-17 21:00:05.397293,epoch time: 0:23:41.246948,used: 5:52:49.158497,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9681735, 'precision': 0.7719672, 'recall': 0.6607297, 'specificity': 0.6607297, 'f1': 0.7006753, 'auroc': 0.93751884, 'binary_precision': 0.5675369, 'binary_recall': 0.33046928, 'binary_specificity': 0.99099016, 'binary_f1_score': 0.41771096}
confusion matrix:
       0    1
0  41906  381
1   1013  500
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.7656036, 'recall': 0.5986598, 'specificity': 0.5986598, 'f1': 0.6407436, 'auroc': 0.9280827, 'binary_precision': 0.55707765, 'binary_recall': 0.2026578, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.29719853}
confusion matrix:
       0    1
0  18074   97
1    480  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9681039, 'precision': 0.97290564, 'recall': 0.5908257, 'specificity': 0.5908257, 'f1': 0.64514834, 'auroc': 0.88978773, 'binary_precision': 0.9777778, 'binary_recall': 0.18181819, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.3066202}
confusion matrix:
      0   1
0  5996   1
1   198  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_15.png
better model found
persisted
after epoch: 15,now: 2024-06-17 21:21:49.891779,epoch time: 0:21:44.494486,used: 6:14:33.652983,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96840185, 'precision': 0.77152157, 'recall': 0.6793294, 'specificity': 0.6793294, 'f1': 0.7150684, 'auroc': 0.93951815, 'binary_precision': 0.5653495, 'binary_recall': 0.3688037, 'binary_specificity': 0.98985505, 'binary_f1_score': 0.4464}
confusion matrix:
       0    1
0  41858  429
1    955  558
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.7663959, 'recall': 0.6002934, 'specificity': 0.6002934, 'f1': 0.64264274, 'auroc': 0.9307, 'binary_precision': 0.5585586, 'binary_recall': 0.20598006, 'binary_specificity': 0.9946068, 'binary_f1_score': 0.30097088}
confusion matrix:
       0    1
0  18073   98
1    478  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9677833, 'precision': 0.97223264, 'recall': 0.58669347, 'specificity': 0.58669347, 'f1': 0.63912594, 'auroc': 0.8901002, 'binary_precision': 0.9767442, 'binary_recall': 0.17355372, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.29473686}
confusion matrix:
      0   1
0  5996   1
1   200  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_16.png
better model found
persisted
after epoch: 16,now: 2024-06-17 21:45:38.325497,epoch time: 0:23:48.433718,used: 6:38:22.086701,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96805936, 'precision': 0.774399, 'recall': 0.64282644, 'specificity': 0.64282644, 'f1': 0.6859416, 'auroc': 0.9394367, 'binary_precision': 0.5736434, 'binary_recall': 0.2934567, 'binary_specificity': 0.9921962, 'binary_f1_score': 0.38828155}
confusion matrix:
       0    1
0  41957  330
1   1069  444
---- Validation: 
scalar performance:
{'acc': 0.9694774, 'precision': 0.7855218, 'recall': 0.57146627, 'specificity': 0.57146627, 'f1': 0.6097041, 'auroc': 0.9297092, 'binary_precision': 0.5986394, 'binary_recall': 0.14617941, 'binary_specificity': 0.9967531, 'binary_f1_score': 0.23498}
confusion matrix:
       0   1
0  18112  59
1    514  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.9819965, 'recall': 0.5371901, 'specificity': 0.5371901, 'f1': 0.56006396, 'auroc': 0.8860439, 'binary_precision': 1.0, 'binary_recall': 0.07438017, 'binary_specificity': 1.0, 'binary_f1_score': 0.13846155}
confusion matrix:
      0   1
0  5997   0
1   224  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_17.png
better model found
persisted
after epoch: 17,now: 2024-06-17 22:08:53.631687,epoch time: 0:23:15.306190,used: 7:01:37.392891,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96856165, 'precision': 0.7763275, 'recall': 0.66602904, 'specificity': 0.66602904, 'f1': 0.7061149, 'auroc': 0.93978775, 'binary_precision': 0.57589287, 'binary_recall': 0.34104428, 'binary_specificity': 0.99101377, 'binary_f1_score': 0.42839354}
confusion matrix:
       0    1
0  41907  380
1    997  516
---- Validation: 
scalar performance:
{'acc': 0.9692111, 'precision': 0.7630796, 'recall': 0.6034506, 'specificity': 0.6034506, 'f1': 0.64560515, 'auroc': 0.93175787, 'binary_precision': 0.55172414, 'binary_recall': 0.21262458, 'binary_specificity': 0.9942766, 'binary_f1_score': 0.3069544}
confusion matrix:
       0    1
0  18067  104
1    474  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.983551, 'recall': 0.57851243, 'specificity': 0.57851243, 'f1': 0.62735224, 'auroc': 0.8892766, 'binary_precision': 1.0, 'binary_recall': 0.1570248, 'binary_specificity': 1.0, 'binary_f1_score': 0.27142856}
confusion matrix:
      0   1
0  5997   0
1   204  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_18.png
early stop counter: 1
val acc:0.9692111015319824, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9640967845916748 / 0.9701875448226929
after epoch: 18,now: 2024-06-17 22:33:58.011429,epoch time: 0:25:04.379742,used: 7:26:41.772633,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9688584, 'precision': 0.7785876, 'recall': 0.67414886, 'specificity': 0.67414886, 'f1': 0.7131684, 'auroc': 0.94305503, 'binary_precision': 0.57984996, 'binary_recall': 0.35756776, 'binary_specificity': 0.99073, 'binary_f1_score': 0.44235486}
confusion matrix:
       0    1
0  41895  392
1    972  541
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.76470006, 'recall': 0.601872, 'specificity': 0.601872, 'f1': 0.644133, 'auroc': 0.9331521, 'binary_precision': 0.5550661, 'binary_recall': 0.20930232, 'binary_specificity': 0.9944417, 'binary_f1_score': 0.3039807}
confusion matrix:
       0    1
0  18070  101
1    476  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96666133, 'precision': 0.9832393, 'recall': 0.57024795, 'specificity': 0.57024795, 'f1': 0.6146652, 'auroc': 0.89044106, 'binary_precision': 1.0, 'binary_recall': 0.14049587, 'binary_specificity': 1.0, 'binary_f1_score': 0.2463768}
confusion matrix:
      0   1
0  5997   0
1   208  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_19.png
early stop counter: 2
val acc:0.9692643880844116, best validation acc: 0.9694774150848389, corresponding to test acc:                         0.9640967845916748 / 0.9701875448226929
after epoch: 19,now: 2024-06-17 22:57:59.370416,epoch time: 0:24:01.358987,used: 7:50:43.131620,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96940637, 'precision': 0.78485423, 'recall': 0.6763492, 'specificity': 0.6763492, 'f1': 0.71663976, 'auroc': 0.94118243, 'binary_precision': 0.59219086, 'binary_recall': 0.3615894, 'binary_specificity': 0.991109, 'binary_f1_score': 0.44901314}
confusion matrix:
       0    1
0  41914  376
1    964  546
---- Validation: 
scalar performance:
{'acc': 0.9699036, 'precision': 0.78345346, 'recall': 0.5957778, 'specificity': 0.5957778, 'f1': 0.63962775, 'auroc': 0.9308362, 'binary_precision': 0.5929648, 'binary_recall': 0.19601329, 'binary_specificity': 0.99554235, 'binary_f1_score': 0.29463172}
confusion matrix:
       0    1
0  18090   81
1    484  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.9825394, 'recall': 0.5516529, 'specificity': 0.5516529, 'f1': 0.5847475, 'auroc': 0.88666135, 'binary_precision': 1.0, 'binary_recall': 0.10330579, 'binary_specificity': 1.0, 'binary_f1_score': 0.18726592}
confusion matrix:
      0   1
0  5997   0
1   217  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_20.png
better model found
persisted
after epoch: 20,now: 2024-06-17 23:23:53.274472,epoch time: 0:25:53.904056,used: 8:16:37.035676,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96915525, 'precision': 0.785051, 'recall': 0.6639861, 'specificity': 0.6639861, 'f1': 0.70669234, 'auroc': 0.94243085, 'binary_precision': 0.59345794, 'binary_recall': 0.3362012, 'binary_specificity': 0.9917709, 'binary_f1_score': 0.4292353}
confusion matrix:
       0    1
0  41941  348
1   1003  508
---- Validation: 
scalar performance:
{'acc': 0.9697971, 'precision': 0.78358257, 'recall': 0.5901014, 'specificity': 0.5901014, 'f1': 0.6329716, 'auroc': 0.9335026, 'binary_precision': 0.59358287, 'binary_recall': 0.18438539, 'binary_specificity': 0.9958175, 'binary_f1_score': 0.28136882}
confusion matrix:
       0    1
0  18095   76
1    491  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.98277247, 'recall': 0.55785125, 'specificity': 0.55785125, 'f1': 0.59493893, 'auroc': 0.88868403, 'binary_precision': 1.0, 'binary_recall': 0.11570248, 'binary_specificity': 1.0, 'binary_f1_score': 0.2074074}
confusion matrix:
      0   1
0  5997   0
1   214  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_21.png
early stop counter: 1
val acc:0.9697970747947693, best validation acc: 0.9699035882949829, corresponding to test acc:                         0.9652187824249268 / 0.9701875448226929
after epoch: 21,now: 2024-06-17 23:49:26.243365,epoch time: 0:25:32.968893,used: 8:42:10.004569,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_17_15_07_16_seed_2_21328388
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
--- Logging error ---
Traceback (most recent call last):
confusion matrix:
       0    1
0  41878  409
1    960  553
---- Validation: 
scalar performance:
{'acc': 0.9700101, 'precision': 0.776508, 'recall': 0.61751515, 'specificity': 0.61751515, 'f1': 0.66231656, 'auroc': 0.93401396, 'binary_precision': 0.57768923, 'binary_recall': 0.24086379, 'binary_specificity': 0.99416655, 'binary_f1_score': 0.33997655}
confusion matrix:
       0    1
0  18065  106
1    457  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.98316145, 'recall': 0.5681818, 'specificity': 0.5681818, 'f1': 0.61143655, 'auroc': 0.88900614, 'binary_precision': 1.0, 'binary_recall': 0.13636364, 'binary_specificity': 1.0, 'binary_f1_score': 0.24000001}
confusion matrix:
      0   1
0  5997   0
1   209  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21328388_22.png
[Tue Jun 18 00:15:57 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4/rule_results/4.csv

RuleException:
RuntimeError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[enforce fail at inline_container.cc:595] . unexpected pos 77771200 vs 77771032
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 172, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 77, in execute
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 49, in tr_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/trainers/train_basic.py", line 70, in after_epoch
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/observers/b_obvisitor.py", line 60, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/a_model_sel.py", line 63, in update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/algos/msels/c_msel_oracle.py", line 37, in base_update
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/models/a_model.py", line 159, in save
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_utils.py", line 89, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 627, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 475, in __exit__
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
