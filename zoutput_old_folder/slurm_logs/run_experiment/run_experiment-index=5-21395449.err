Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jun 18 03:05:29 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449

 Experiment start at: 2024-06-18 03:17:06.818654
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96643835, 'precision': 0.48321918, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4914664, 'auroc': 0.7310451, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42330  0
1   1470  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.68917865, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.7050129, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-18 03:40:43.090172,epoch time: 0:23:36.271518,used: 0:23:36.271518,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9665525, 'precision': 0.83626807, 'recall': 0.504017, 'specificity': 0.504017, 'f1': 0.49955264, 'auroc': 0.86051565, 'binary_precision': 0.7058824, 'binary_recall': 0.008152174, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.0161182}
confusion matrix:
       0   1
0  42323   5
1   1460  12
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.84477246, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8412035, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-18 04:03:07.692804,epoch time: 0:22:24.602632,used: 0:46:00.874150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96687216, 'precision': 0.75846124, 'recall': 0.53959143, 'specificity': 0.53959143, 'f1': 0.56251895, 'auroc': 0.8905457, 'binary_precision': 0.5479452, 'binary_recall': 0.08152174, 'binary_specificity': 0.9976611, 'binary_f1_score': 0.14192785}
confusion matrix:
       0    1
0  42229   99
1   1352  120
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.72658104, 'recall': 0.51347345, 'specificity': 0.51347345, 'f1': 0.51774526, 'auroc': 0.8835831, 'binary_precision': 0.4864865, 'binary_recall': 0.02799378, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.052941177}
confusion matrix:
       0   1
0  18130  19
1    625  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.9803749, 'recall': 0.53065133, 'specificity': 0.53065133, 'f1': 0.54775274, 'auroc': 0.8707243, 'binary_precision': 1.0, 'binary_recall': 0.06130268, 'binary_specificity': 1.0, 'binary_f1_score': 0.115523465}
confusion matrix:
      0   1
0  5997   0
1   245  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_3.png
new oracle model saved
early stop counter: 2
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9608501195907593
after epoch: 3,now: 2024-06-18 04:23:42.872617,epoch time: 0:20:35.179813,used: 1:06:36.053963,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9665525, 'precision': 0.73980093, 'recall': 0.565655, 'specificity': 0.565655, 'f1': 0.59869486, 'auroc': 0.904021, 'binary_precision': 0.5089058, 'binary_recall': 0.13586956, 'binary_specificity': 0.99544036, 'binary_f1_score': 0.21447721}
confusion matrix:
       0    1
0  42135  193
1   1272  200
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.7696103, 'recall': 0.5302777, 'specificity': 0.5302777, 'f1': 0.547517, 'auroc': 0.89427584, 'binary_precision': 0.5714286, 'binary_recall': 0.0622084, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.11220197}
confusion matrix:
       0   1
0  18119  30
1    603  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9813774, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.59051204, 'auroc': 0.8778386, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5997   0
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-18 04:45:52.750236,epoch time: 0:22:09.877619,used: 1:28:45.931582,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.966895, 'precision': 0.7456151, 'recall': 0.60419196, 'specificity': 0.60419196, 'f1': 0.64363337, 'auroc': 0.9119477, 'binary_precision': 0.51797384, 'binary_recall': 0.21535327, 'binary_specificity': 0.9930306, 'binary_f1_score': 0.30422264}
confusion matrix:
       0    1
0  42033  295
1   1155  317
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.7650565, 'recall': 0.55594486, 'specificity': 0.55594486, 'f1': 0.58696693, 'auroc': 0.90773565, 'binary_precision': 0.56060606, 'binary_recall': 0.115085535, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.19096774}
confusion matrix:
       0   1
0  18091  58
1    569  74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.98285025, 'recall': 0.591954, 'specificity': 0.591954, 'f1': 0.64661527, 'auroc': 0.8835574, 'binary_precision': 1.0, 'binary_recall': 0.18390805, 'binary_specificity': 1.0, 'binary_f1_score': 0.3106796}
confusion matrix:
      0   1
0  5997   0
1   213  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-18 05:08:57.622934,epoch time: 0:23:04.872698,used: 1:51:50.804280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9665525, 'precision': 0.7393832, 'recall': 0.59614605, 'specificity': 0.59614605, 'f1': 0.63429475, 'auroc': 0.916052, 'binary_precision': 0.5060449, 'binary_recall': 0.1990489, 'binary_specificity': 0.9932432, 'binary_f1_score': 0.28571427}
confusion matrix:
       0    1
0  42042  286
1   1179  293
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.77520335, 'recall': 0.5515272, 'specificity': 0.5515272, 'f1': 0.5810009, 'auroc': 0.9114686, 'binary_precision': 0.5811966, 'binary_recall': 0.10575428, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.17894737}
confusion matrix:
       0   1
0  18100  49
1    575  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.982229, 'recall': 0.5766283, 'specificity': 0.5766283, 'f1': 0.62384415, 'auroc': 0.88524735, 'binary_precision': 1.0, 'binary_recall': 0.1532567, 'binary_specificity': 1.0, 'binary_f1_score': 0.26578075}
confusion matrix:
      0   1
0  5997   0
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_6.png
better model found
persisted
after epoch: 6,now: 2024-06-18 05:29:50.025738,epoch time: 0:20:52.402804,used: 2:12:43.207084,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9677169, 'precision': 0.76107776, 'recall': 0.6078958, 'specificity': 0.6078958, 'f1': 0.6498579, 'auroc': 0.9208343, 'binary_precision': 0.5486577, 'binary_recall': 0.22214673, 'binary_specificity': 0.9936449, 'binary_f1_score': 0.31624758}
confusion matrix:
       0    1
0  42059  269
1   1145  327
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.7774776, 'recall': 0.559888, 'specificity': 0.559888, 'f1': 0.59311986, 'auroc': 0.9159579, 'binary_precision': 0.58518517, 'binary_recall': 0.12286159, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.20308483}
confusion matrix:
       0   1
0  18093  56
1    564  79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.9816867, 'recall': 0.5632184, 'specificity': 0.5632184, 'f1': 0.60291743, 'auroc': 0.8909006, 'binary_precision': 1.0, 'binary_recall': 0.12643678, 'binary_specificity': 1.0, 'binary_f1_score': 0.2244898}
confusion matrix:
      0   1
0  5997   0
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_7.png
better model found
persisted
after epoch: 7,now: 2024-06-18 05:51:04.070880,epoch time: 0:21:14.045142,used: 2:33:57.252226,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9673973, 'precision': 0.7514802, 'recall': 0.635354, 'specificity': 0.635354, 'f1': 0.67430115, 'auroc': 0.9231701, 'binary_precision': 0.5275995, 'binary_recall': 0.27940178, 'binary_specificity': 0.9913062, 'binary_f1_score': 0.36533335}
confusion matrix:
       0    1
0  41961  368
1   1060  411
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.77330035, 'recall': 0.58708286, 'specificity': 0.58708286, 'f1': 0.62807536, 'auroc': 0.92115617, 'binary_precision': 0.575, 'binary_recall': 0.17884915, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.2728351}
confusion matrix:
       0    1
0  18064   85
1    528  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.9734655, 'recall': 0.59761775, 'specificity': 0.59761775, 'f1': 0.6542939, 'auroc': 0.8892256, 'binary_precision': 0.9807692, 'binary_recall': 0.1954023, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.32587856}
confusion matrix:
      0   1
0  5996   1
1   210  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-06-18 06:14:38.065623,epoch time: 0:23:33.994743,used: 2:57:31.246969,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9677169, 'precision': 0.75822985, 'recall': 0.62363315, 'specificity': 0.62363315, 'f1': 0.665015, 'auroc': 0.92773587, 'binary_precision': 0.5419075, 'binary_recall': 0.25475544, 'binary_specificity': 0.99251086, 'binary_f1_score': 0.34658042}
confusion matrix:
       0    1
0  42011  317
1   1097  375
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7745863, 'recall': 0.56666607, 'specificity': 0.56666607, 'f1': 0.602279, 'auroc': 0.9239244, 'binary_precision': 0.57894737, 'binary_recall': 0.13685848, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.22138366}
confusion matrix:
       0   1
0  18085  64
1    555  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.98153204, 'recall': 0.55938697, 'specificity': 0.55938697, 'f1': 0.59675664, 'auroc': 0.88879323, 'binary_precision': 1.0, 'binary_recall': 0.118773945, 'binary_specificity': 1.0, 'binary_f1_score': 0.21232876}
confusion matrix:
      0   1
0  5997   0
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_9.png
early stop counter: 1
val acc:0.9670604467391968, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9662831425666809 / 0.9662831425666809
after epoch: 9,now: 2024-06-18 06:38:16.170602,epoch time: 0:23:38.104979,used: 3:21:09.351948,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9681507, 'precision': 0.76340157, 'recall': 0.6363163, 'specificity': 0.6363163, 'f1': 0.6777828, 'auroc': 0.92723155, 'binary_precision': 0.55140185, 'binary_recall': 0.28057066, 'binary_specificity': 0.992062, 'binary_f1_score': 0.37190455}
confusion matrix:
       0    1
0  41992  336
1   1059  413
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.78076816, 'recall': 0.5766096, 'specificity': 0.5766096, 'f1': 0.61575663, 'auroc': 0.9266103, 'binary_precision': 0.5906433, 'binary_recall': 0.15707621, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.24815725}
confusion matrix:
       0    1
0  18079   70
1    542  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.981919, 'recall': 0.5689655, 'specificity': 0.5689655, 'f1': 0.6120051, 'auroc': 0.89285064, 'binary_precision': 1.0, 'binary_recall': 0.13793103, 'binary_specificity': 1.0, 'binary_f1_score': 0.24242425}
confusion matrix:
      0   1
0  5997   0
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_10.png
better model found
persisted
after epoch: 10,now: 2024-06-18 06:58:17.265425,epoch time: 0:20:01.094823,used: 3:41:10.446771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96847034, 'precision': 0.76343715, 'recall': 0.6669728, 'specificity': 0.6669728, 'f1': 0.70334625, 'auroc': 0.92771566, 'binary_precision': 0.54940283, 'binary_recall': 0.34375, 'binary_specificity': 0.99019563, 'binary_f1_score': 0.42290014}
confusion matrix:
       0    1
0  41913  415
1    966  506
---- Validation: 
scalar performance:
{'acc': 0.9679119, 'precision': 0.77944505, 'recall': 0.6031095, 'specificity': 0.6031095, 'f1': 0.6472153, 'auroc': 0.93111956, 'binary_precision': 0.5862069, 'binary_recall': 0.21150856, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.31085715}
confusion matrix:
       0    1
0  18053   96
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.98316145, 'recall': 0.5996169, 'specificity': 0.5996169, 'f1': 0.6575707, 'auroc': 0.8965896, 'binary_precision': 1.0, 'binary_recall': 0.19923371, 'binary_specificity': 1.0, 'binary_f1_score': 0.33226836}
confusion matrix:
      0   1
0  5997   0
1   209  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_11.png
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-06-18 07:21:06.582438,epoch time: 0:22:49.317013,used: 4:03:59.763784,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96776253, 'precision': 0.75529045, 'recall': 0.65578717, 'specificity': 0.65578717, 'f1': 0.6923114, 'auroc': 0.9317684, 'binary_precision': 0.53386, 'binary_recall': 0.32133153, 'binary_specificity': 0.99024284, 'binary_f1_score': 0.40118742}
confusion matrix:
       0    1
0  41915  413
1    999  473
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.77759355, 'recall': 0.6015543, 'specificity': 0.6015543, 'f1': 0.64525366, 'auroc': 0.9328469, 'binary_precision': 0.5826087, 'binary_recall': 0.20839813, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.3069874}
confusion matrix:
       0    1
0  18053   96
1    509  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.9731991, 'recall': 0.59570205, 'specificity': 0.59570205, 'f1': 0.6515707, 'auroc': 0.8946288, 'binary_precision': 0.98039216, 'binary_recall': 0.19157088, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.32051283}
confusion matrix:
      0   1
0  5996   1
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_12.png
early stop counter: 1
val acc:0.9678054451942444, best validation acc: 0.9679118990898132, corresponding to test acc:                         0.9666027426719666 / 0.9666027426719666
after epoch: 12,now: 2024-06-18 07:44:25.862239,epoch time: 0:23:19.279801,used: 4:27:19.043585,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96803653, 'precision': 0.7607298, 'recall': 0.6418309, 'specificity': 0.6418309, 'f1': 0.68206304, 'auroc': 0.9339576, 'binary_precision': 0.5456853, 'binary_recall': 0.29211956, 'binary_specificity': 0.9915422, 'binary_f1_score': 0.38053098}
confusion matrix:
       0    1
0  41970  358
1   1042  430
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.7884322, 'recall': 0.58280295, 'specificity': 0.58280295, 'f1': 0.62421346, 'auroc': 0.93377036, 'binary_precision': 0.60555553, 'binary_recall': 0.16951789, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.2648846}
confusion matrix:
       0    1
0  18078   71
1    534  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.96794975, 'recall': 0.5669664, 'specificity': 0.5669664, 'f1': 0.6085563, 'auroc': 0.89608264, 'binary_precision': 0.9722222, 'binary_recall': 0.13409962, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.23569024}
confusion matrix:
      0   1
0  5996   1
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_13.png
early stop counter: 2
val acc:0.9678054451942444, best validation acc: 0.9679118990898132, corresponding to test acc:                         0.9666027426719666 / 0.9666027426719666
after epoch: 13,now: 2024-06-18 08:03:37.178756,epoch time: 0:19:11.316517,used: 4:46:30.360102,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9691096, 'precision': 0.77264297, 'recall': 0.6643528, 'specificity': 0.6643528, 'f1': 0.7038245, 'auroc': 0.9325497, 'binary_precision': 0.568, 'binary_recall': 0.33763587, 'binary_specificity': 0.99106973, 'binary_f1_score': 0.4235194}
confusion matrix:
       0    1
0  41950  378
1    975  497
---- Validation: 
scalar performance:
{'acc': 0.9678587, 'precision': 0.78186107, 'recall': 0.5955814, 'specificity': 0.5955814, 'f1': 0.63897365, 'auroc': 0.9344245, 'binary_precision': 0.5915493, 'binary_recall': 0.19595645, 'binary_specificity': 0.99520636, 'binary_f1_score': 0.29439253}
confusion matrix:
       0    1
0  18062   87
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.97039896, 'recall': 0.5784607, 'specificity': 0.5784607, 'f1': 0.62626576, 'auroc': 0.8978038, 'binary_precision': 0.97619045, 'binary_recall': 0.15708812, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.27062705}
confusion matrix:
      0   1
0  5996   1
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_14.png
early stop counter: 3
val acc:0.9678586721420288, best validation acc: 0.9679118990898132, corresponding to test acc:                         0.9666027426719666 / 0.9666027426719666
after epoch: 14,now: 2024-06-18 08:26:38.394959,epoch time: 0:23:01.216203,used: 5:09:31.576305,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96805936, 'precision': 0.75847816, 'recall': 0.6634816, 'specificity': 0.6634816, 'f1': 0.6992354, 'auroc': 0.93611157, 'binary_precision': 0.5397171, 'binary_recall': 0.33695653, 'binary_specificity': 0.9900066, 'binary_f1_score': 0.4148892}
confusion matrix:
       0    1
0  41905  423
1    976  496
---- Validation: 
scalar performance:
{'acc': 0.96796507, 'precision': 0.77743393, 'recall': 0.6106376, 'specificity': 0.6106376, 'f1': 0.6551071, 'auroc': 0.9375148, 'binary_precision': 0.5816733, 'binary_recall': 0.22706065, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.32662192}
confusion matrix:
       0    1
0  18044  105
1    497  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.9669571, 'recall': 0.6109444, 'specificity': 0.6109444, 'f1': 0.67228025, 'auroc': 0.90065, 'binary_precision': 0.96666664, 'binary_recall': 0.22222222, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.3613707}
confusion matrix:
      0   1
0  5995   2
1   203  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_15.png
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-06-18 08:49:45.008062,epoch time: 0:23:06.613103,used: 5:32:38.189408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96924657, 'precision': 0.77370536, 'recall': 0.6686859, 'specificity': 0.6686859, 'f1': 0.7075608, 'auroc': 0.93687356, 'binary_precision': 0.5698324, 'binary_recall': 0.3464674, 'binary_specificity': 0.9909044, 'binary_f1_score': 0.43092522}
confusion matrix:
       0    1
0  41943  385
1    962  510
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.7903639, 'recall': 0.60485756, 'specificity': 0.60485756, 'f1': 0.6505312, 'auroc': 0.93932116, 'binary_precision': 0.6079295, 'binary_recall': 0.21461898, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.31724137}
confusion matrix:
       0    1
0  18060   89
1    505  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.9717448, 'recall': 0.5861235, 'specificity': 0.5861235, 'f1': 0.6376929, 'auroc': 0.89986265, 'binary_precision': 0.9782609, 'binary_recall': 0.1724138, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.2931596}
confusion matrix:
      0   1
0  5996   1
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_16.png
better model found
persisted
after epoch: 16,now: 2024-06-18 09:12:09.975665,epoch time: 0:22:24.967603,used: 5:55:03.157011,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9692922, 'precision': 0.77641153, 'recall': 0.6595294, 'specificity': 0.6595294, 'f1': 0.70086354, 'auroc': 0.93828166, 'binary_precision': 0.57586616, 'binary_recall': 0.32744566, 'binary_specificity': 0.9916131, 'binary_f1_score': 0.4174967}
confusion matrix:
       0    1
0  41973  355
1    990  482
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.781499, 'recall': 0.591026, 'specificity': 0.591026, 'f1': 0.6335964, 'auroc': 0.9367124, 'binary_precision': 0.591133, 'binary_recall': 0.1866252, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.28368795}
confusion matrix:
       0    1
0  18066   83
1    523  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.98176414, 'recall': 0.5651341, 'specificity': 0.5651341, 'f1': 0.6059669, 'auroc': 0.8964639, 'binary_precision': 1.0, 'binary_recall': 0.1302682, 'binary_specificity': 1.0, 'binary_f1_score': 0.23050848}
confusion matrix:
      0   1
0  5997   0
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_17.png
early stop counter: 1
val acc:0.96775221824646, best validation acc: 0.9683908224105835, corresponding to test acc:                         0.9653244018554688 / 0.9672419428825378
after epoch: 17,now: 2024-06-18 09:37:50.724700,epoch time: 0:25:40.749035,used: 6:20:43.906046,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9695662, 'precision': 0.777537, 'recall': 0.6705978, 'specificity': 0.6705978, 'f1': 0.7101239, 'auroc': 0.9363481, 'binary_precision': 0.57735425, 'binary_recall': 0.35010198, 'binary_specificity': 0.9910936, 'binary_f1_score': 0.43588656}
confusion matrix:
       0    1
0  41952  377
1    956  515
---- Validation: 
scalar performance:
{'acc': 0.96812475, 'precision': 0.78711784, 'recall': 0.59871936, 'specificity': 0.59871936, 'f1': 0.6431835, 'auroc': 0.9382911, 'binary_precision': 0.6018519, 'binary_recall': 0.2021773, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.30267754}
confusion matrix:
       0    1
0  18063   86
1    513  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.98145473, 'recall': 0.5574713, 'specificity': 0.5574713, 'f1': 0.5936449, 'auroc': 0.8960853, 'binary_precision': 1.0, 'binary_recall': 0.11494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.20618556}
confusion matrix:
      0   1
0  5997   0
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_18.png
early stop counter: 2
val acc:0.9681247472763062, best validation acc: 0.9683908224105835, corresponding to test acc:                         0.9653244018554688 / 0.9672419428825378
after epoch: 18,now: 2024-06-18 10:01:42.138555,epoch time: 0:23:51.413855,used: 6:44:35.319901,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96940637, 'precision': 0.77507937, 'recall': 0.6714994, 'specificity': 0.6714994, 'f1': 0.7101518, 'auroc': 0.9379368, 'binary_precision': 0.5723757, 'binary_recall': 0.3521414, 'binary_specificity': 0.9908573, 'binary_f1_score': 0.43602693}
confusion matrix:
       0    1
0  41942  387
1    953  518
---- Validation: 
scalar performance:
{'acc': 0.9683376, 'precision': 0.79331225, 'recall': 0.5980795, 'specificity': 0.5980795, 'f1': 0.6431315, 'auroc': 0.93933237, 'binary_precision': 0.6142857, 'binary_recall': 0.20062208, 'binary_specificity': 0.9955369, 'binary_f1_score': 0.3024619}
confusion matrix:
       0    1
0  18068   81
1    514  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.98184156, 'recall': 0.5670498, 'specificity': 0.5670498, 'f1': 0.60899615, 'auroc': 0.8967426, 'binary_precision': 1.0, 'binary_recall': 0.13409962, 'binary_specificity': 1.0, 'binary_f1_score': 0.2364865}
confusion matrix:
      0   1
0  5997   0
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_19.png
early stop counter: 3
val acc:0.9683375954627991, best validation acc: 0.9683908224105835, corresponding to test acc:                         0.9653244018554688 / 0.9672419428825378
after epoch: 19,now: 2024-06-18 10:23:44.998911,epoch time: 0:22:02.860356,used: 7:06:38.180257,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9693607, 'precision': 0.77812153, 'recall': 0.6569419, 'specificity': 0.6569419, 'f1': 0.6991215, 'auroc': 0.9356642, 'binary_precision': 0.5794621, 'binary_recall': 0.32201087, 'binary_specificity': 0.99187297, 'binary_f1_score': 0.4139738}
confusion matrix:
       0    1
0  41984  344
1    998  474
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.79881287, 'recall': 0.5928567, 'specificity': 0.5928567, 'f1': 0.63750225, 'auroc': 0.9391432, 'binary_precision': 0.62564105, 'binary_recall': 0.18973562, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.29116946}
confusion matrix:
       0    1
0  18076   73
1    521  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.98153204, 'recall': 0.55938697, 'specificity': 0.55938697, 'f1': 0.59675664, 'auroc': 0.89643836, 'binary_precision': 1.0, 'binary_recall': 0.118773945, 'binary_specificity': 1.0, 'binary_f1_score': 0.21232876}
confusion matrix:
      0   1
0  5997   0
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_20.png
early stop counter: 4
val acc:0.9683908224105835, best validation acc: 0.9683908224105835, corresponding to test acc:                         0.9653244018554688 / 0.9672419428825378
after epoch: 20,now: 2024-06-18 10:44:21.892075,epoch time: 0:20:36.893164,used: 7:27:15.073421,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.970548, 'precision': 0.786277, 'recall': 0.6916538, 'specificity': 0.6916538, 'f1': 0.72872967, 'auroc': 0.9350276, 'binary_precision': 0.59342915, 'binary_recall': 0.39266303, 'binary_specificity': 0.9906445, 'binary_f1_score': 0.4726083}
confusion matrix:
       0    1
0  41932  396
1    894  578
---- Validation: 
scalar performance:
{'acc': 0.968923, 'precision': 0.79791564, 'recall': 0.6141337, 'specificity': 0.6141337, 'f1': 0.6617269, 'auroc': 0.94094807, 'binary_precision': 0.62240666, 'binary_recall': 0.2332815, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.33936653}
confusion matrix:
       0    1
0  18058   91
1    493  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.98184156, 'recall': 0.5670498, 'specificity': 0.5670498, 'f1': 0.60899615, 'auroc': 0.89343745, 'binary_precision': 1.0, 'binary_recall': 0.13409962, 'binary_specificity': 1.0, 'binary_f1_score': 0.2364865}
confusion matrix:
      0   1
0  5997   0
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_21.png
better model found
persisted
after epoch: 21,now: 2024-06-18 11:07:29.877003,epoch time: 0:23:07.984928,used: 7:50:23.058349,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97025114, 'precision': 0.78251755, 'recall': 0.6908445, 'specificity': 0.6908445, 'f1': 0.72697157, 'auroc': 0.9408776, 'binary_precision': 0.58596134, 'binary_recall': 0.39130434, 'binary_specificity': 0.99038464, 'binary_f1_score': 0.46924642}
confusion matrix:
       0    1
0  41921  407
1    896  576
---- Validation: 
scalar performance:
{'acc': 0.96886975, 'precision': 0.7939514, 'recall': 0.6186065, 'specificity': 0.6186065, 'f1': 0.66594017, 'auroc': 0.94352555, 'binary_precision': 0.61417323, 'binary_recall': 0.24261275, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.3478261}
confusion matrix:
       0    1
0  18051   98
1    487  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.97039896, 'recall': 0.5784607, 'specificity': 0.5784607, 'f1': 0.62626576, 'auroc': 0.8989437, 'binary_precision': 0.97619045, 'binary_recall': 0.15708812, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.27062705}
confusion matrix:
      0   1
0  5996   1
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_22.png
early stop counter: 1
val acc:0.9688697457313538, best validation acc: 0.9689229726791382, corresponding to test acc:                         0.9638862013816833 / 0.9672419428825378
after epoch: 22,now: 2024-06-18 11:32:25.281060,epoch time: 0:24:55.404057,used: 8:15:18.462406,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97121006, 'precision': 0.79896295, 'recall': 0.6818326, 'specificity': 0.6818326, 'f1': 0.7248754, 'auroc': 0.94236195, 'binary_precision': 0.61947906, 'binary_recall': 0.37160325, 'binary_specificity': 0.992062, 'binary_f1_score': 0.46454352}
confusion matrix:
       0    1
0  41992  336
1    925  547
---- Validation: 
scalar performance:
{'acc': 0.96945506, 'precision': 0.8089973, 'recall': 0.61740947, 'specificity': 0.61740947, 'f1': 0.66678345, 'auroc': 0.9425752, 'binary_precision': 0.6443515, 'binary_recall': 0.23950233, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.34920636}
confusion matrix:
       0    1
0  18064   85
1    489  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9813774, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.59051204, 'auroc': 0.89940214, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5997   0
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_23.png
better model found
persisted
after epoch: 23,now: 2024-06-18 11:58:25.150877,epoch time: 0:25:59.869817,used: 8:41:18.332223,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9708904, 'precision': 0.78891504, 'recall': 0.69904387, 'specificity': 0.69904387, 'f1': 0.7349353, 'auroc': 0.94240636, 'binary_precision': 0.5982054, 'binary_recall': 0.4076087, 'binary_specificity': 0.9904791, 'binary_f1_score': 0.48484847}
confusion matrix:
       0    1
0  41925  403
1    872  600
---- Validation: 
scalar performance:
{'acc': 0.96977437, 'precision': 0.80649984, 'recall': 0.6318258, 'specificity': 0.6318258, 'f1': 0.68153316, 'auroc': 0.9435077, 'binary_precision': 0.63837636, 'binary_recall': 0.2690513, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.3785558}
confusion matrix:
       0    1
0  18051   98
1    470  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.9823842, 'recall': 0.5804598, 'specificity': 0.5804598, 'f1': 0.629648, 'auroc': 0.8972045, 'binary_precision': 1.0, 'binary_recall': 0.16091955, 'binary_specificity': 1.0, 'binary_f1_score': 0.27722773}
confusion matrix:
      0   1
0  5997   0
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_24.png
better model found
persisted
after epoch: 24,now: 2024-06-18 12:22:54.930059,epoch time: 0:24:29.779182,used: 9:05:48.111405,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9703196, 'precision': 0.7905086, 'recall': 0.6662903, 'specificity': 0.6662903, 'f1': 0.7100165, 'auroc': 0.9410227, 'binary_precision': 0.60361445, 'binary_recall': 0.34035325, 'binary_specificity': 0.9922274, 'binary_f1_score': 0.43527368}
confusion matrix:
       0    1
0  41999  329
1    971  501
---- Validation: 
scalar performance:
{'acc': 0.9686037, 'precision': 0.809073, 'recall': 0.5892166, 'specificity': 0.5892166, 'f1': 0.63396525, 'auroc': 0.9403829, 'binary_precision': 0.64640886, 'binary_recall': 0.18195957, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.28398058}
confusion matrix:
       0    1
0  18085   64
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.9812229, 'recall': 0.55172414, 'specificity': 0.55172414, 'f1': 0.5841818, 'auroc': 0.8933236, 'binary_precision': 1.0, 'binary_recall': 0.10344828, 'binary_specificity': 1.0, 'binary_f1_score': 0.1875}
confusion matrix:
      0   1
0  5997   0
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_25.png
early stop counter: 1
val acc:0.9686036705970764, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.9650048017501831 / 0.9672419428825378
after epoch: 25,now: 2024-06-18 12:44:13.711929,epoch time: 0:21:18.781870,used: 9:27:06.893275,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.97050226, 'precision': 0.78400147, 'recall': 0.69851524, 'specificity': 0.69851524, 'f1': 0.7329721, 'auroc': 0.94312763, 'binary_precision': 0.58840865, 'binary_recall': 0.40692934, 'binary_specificity': 0.9901011, 'binary_f1_score': 0.4811245}
confusion matrix:
       0    1
0  41909  419
1    873  599
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.80160654, 'recall': 0.6164941, 'specificity': 0.6164941, 'f1': 0.6647839, 'auroc': 0.9422014, 'binary_precision': 0.6296296, 'binary_recall': 0.23794712, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.34537247}
confusion matrix:
       0    1
0  18059   90
1    490  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.96925056, 'recall': 0.57271355, 'specificity': 0.57271355, 'f1': 0.61749834, 'auroc': 0.89717305, 'binary_precision': 0.974359, 'binary_recall': 0.14559387, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.25333333}
confusion matrix:
      0   1
0  5996   1
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_26.png
early stop counter: 2
val acc:0.9691358208656311, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.9650048017501831 / 0.9672419428825378
after epoch: 26,now: 2024-06-18 13:08:47.650802,epoch time: 0:24:33.938873,used: 9:51:40.832148,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.971484, 'precision': 0.79935634, 'recall': 0.69127554, 'specificity': 0.69127554, 'f1': 0.73235345, 'auroc': 0.9417367, 'binary_precision': 0.6196121, 'binary_recall': 0.39089054, 'binary_specificity': 0.99166054, 'binary_f1_score': 0.47936642}
confusion matrix:
       0    1
0  41976  353
1    896  575
---- Validation: 
scalar performance:
{'acc': 0.9695083, 'precision': 0.81280714, 'recall': 0.61443675, 'specificity': 0.61443675, 'f1': 0.6640171, 'auroc': 0.94362795, 'binary_precision': 0.65217394, 'binary_recall': 0.2332815, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.34364262}
confusion matrix:
       0    1
0  18069   80
1    493  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.96532273, 'recall': 0.5573879, 'specificity': 0.5573879, 'f1': 0.5932502, 'auroc': 0.8966432, 'binary_precision': 0.9677419, 'binary_recall': 0.11494253, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.20547946}
confusion matrix:
      0   1
0  5996   1
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_27.png
early stop counter: 3
val acc:0.9695082902908325, best validation acc: 0.9697743654251099, corresponding to test acc:                         0.9650048017501831 / 0.9672419428825378
after epoch: 27,now: 2024-06-18 13:32:04.961127,epoch time: 0:23:17.310325,used: 10:14:58.142473,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9710502, 'precision': 0.7947147, 'recall': 0.68699574, 'specificity': 0.68699574, 'f1': 0.7277305, 'auroc': 0.9420929, 'binary_precision': 0.6106291, 'binary_recall': 0.3824728, 'binary_specificity': 0.9915186, 'binary_f1_score': 0.47034252}
confusion matrix:
       0    1
0  41969  359
1    909  563
---- Validation: 
scalar performance:
{'acc': 0.9698276, 'precision': 0.8081823, 'recall': 0.6311033, 'specificity': 0.6311033, 'f1': 0.681073, 'auroc': 0.94385886, 'binary_precision': 0.64179105, 'binary_recall': 0.2674961, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.37760702}
confusion matrix:
       0    1
0  18053   96
1    471  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.96590406, 'recall': 0.5593036, 'specificity': 0.5593036, 'f1': 0.59635264, 'auroc': 0.8980886, 'binary_precision': 0.96875, 'binary_recall': 0.118773945, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.21160409}
confusion matrix:
      0   1
0  5996   1
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_28.png
better model found
persisted
after epoch: 28,now: 2024-06-18 13:55:18.901825,epoch time: 0:23:13.940698,used: 10:38:12.083171,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9710274, 'precision': 0.80050755, 'recall': 0.6705909, 'specificity': 0.6705909, 'f1': 0.71609145, 'auroc': 0.9391476, 'binary_precision': 0.6233293, 'binary_recall': 0.34850544, 'binary_specificity': 0.99267626, 'binary_f1_score': 0.44705883}
confusion matrix:
       0    1
0  42018  310
1    959  513
---- Validation: 
scalar performance:
{'acc': 0.968923, 'precision': 0.8056044, 'recall': 0.6036329, 'specificity': 0.6036329, 'f1': 0.65092814, 'auroc': 0.94591796, 'binary_precision': 0.63849765, 'binary_recall': 0.21150856, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.317757}
confusion matrix:
       0    1
0  18072   77
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.96183467, 'recall': 0.54780936, 'specificity': 0.54780936, 'f1': 0.5774179, 'auroc': 0.8966874, 'binary_precision': 0.96153843, 'binary_recall': 0.09578544, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.17421602}
confusion matrix:
      0   1
0  5996   1
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_29.png
early stop counter: 1
val acc:0.9689229726791382, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.963087260723114 / 0.9672419428825378
after epoch: 29,now: 2024-06-18 14:21:22.193464,epoch time: 0:26:03.291639,used: 11:04:15.374810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9706393, 'precision': 0.7865235, 'recall': 0.6944475, 'specificity': 0.6944475, 'f1': 0.73085314, 'auroc': 0.94579935, 'binary_precision': 0.59371835, 'binary_recall': 0.39836845, 'binary_specificity': 0.9905266, 'binary_f1_score': 0.47681043}
confusion matrix:
       0    1
0  41928  401
1    885  586
---- Validation: 
scalar performance:
{'acc': 0.97004044, 'precision': 0.8075017, 'recall': 0.6394641, 'specificity': 0.6394641, 'f1': 0.6893063, 'auroc': 0.9455185, 'binary_precision': 0.63986015, 'binary_recall': 0.28460342, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.393972}
confusion matrix:
       0    1
0  18046  103
1    460  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.9664549, 'recall': 0.5612193, 'specificity': 0.5612193, 'f1': 0.59943426, 'auroc': 0.89771944, 'binary_precision': 0.969697, 'binary_recall': 0.12260536, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.21768707}
confusion matrix:
      0   1
0  5996   1
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395449_30.png
better model found
persisted
after epoch: 30,now: 2024-06-18 14:45:58.318198,epoch time: 0:24:36.124734,used: 11:28:51.499544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395449
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:28:51.499544 at 2024-06-18 14:45:58.318198
persisted model performance metric: 

scalar performance:
{'acc': 0.96324706, 'precision': 0.9664549, 'recall': 0.5612193, 'specificity': 0.5612193, 'f1': 0.59943426, 'auroc': 0.89771944, 'binary_precision': 0.969697, 'binary_recall': 0.12260536, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.21768707}
confusion matrix:
      0   1
0  5996   1
1   229  32
oracle model performance metric: 

scalar performance:
{'acc': 0.96724194, 'precision': 0.9669571, 'recall': 0.6109444, 'specificity': 0.6109444, 'f1': 0.67228025, 'auroc': 0.90065, 'binary_precision': 0.96666664, 'binary_recall': 0.22222222, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.3613707}
confusion matrix:
      0   1
0  5995   2
1   203  58
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 395294 GiB | 395293 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 395173 GiB | 395172 GiB |
|       from small pool |  36242 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 395294 GiB | 395293 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 395173 GiB | 395172 GiB |
|       from small pool |  36242 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1428 MiB | 395271 GiB | 395270 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |  35968 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 284058 GiB | 284057 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 283919 GiB | 283918 GiB |
|       from small pool |   8813 KiB |  12610 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   13822 K  |   13821 K  |
|       from large pool |      36    |      76    |    4630 K  |    4630 K  |
|       from small pool |    1242    |    1864    |    9192 K  |    9190 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   13822 K  |   13821 K  |
|       from large pool |      36    |      76    |    4630 K  |    4630 K  |
|       from small pool |    1242    |    1864    |    9192 K  |    9190 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     452    |    7386 K  |    7386 K  |
|       from large pool |       5    |      10    |    1938 K  |    1938 K  |
|       from small pool |      30    |     447    |    5448 K  |    5448 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 395294 GiB | 395294 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395173 GiB | 395173 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 395294 GiB | 395294 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395173 GiB | 395173 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 395271 GiB | 395271 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |      0 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 284058 GiB | 284057 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 283919 GiB | 283918 GiB |
|       from small pool |      0 KiB |  16408 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13822 K  |   13822 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9192 K  |    9192 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13822 K  |   13822 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9192 K  |    9192 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    7386 K  |    7386 K  |
|       from large pool |       1    |      11    |    1938 K  |    1938 K  |
|       from small pool |       0    |     447    |    5448 K  |    5448 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jun 18 14:46:59 2024]
Finished job 0.
1 of 1 steps (100%) done
