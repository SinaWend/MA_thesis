Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jun  5 22:36:38 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987

 Experiment start at: 2024-06-05 22:53:07.466598
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9692866, 'precision': 0.82333905, 'recall': 0.581826, 'specificity': 0.581826, 'f1': 0.62567234, 'auroc': 0.9480692, 'binary_precision': 0.6749311, 'binary_recall': 0.16644022, 'binary_specificity': 0.9972117, 'binary_f1_score': 0.26702997}
confusion matrix:
       0    1
0  42202  118
1   1227  245
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.96695405, 'precision': 0.83570814, 'recall': 0.52910817, 'specificity': 0.52910817, 'f1': 0.5461018, 'auroc': 0.94836676, 'binary_precision': 0.7037037, 'binary_recall': 0.05909798, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.10903874}
confusion matrix:
       0   1
0  18133  16
1    605  38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.86963034, 'recall': 0.5397296, 'specificity': 0.5397296, 'f1': 0.5628578, 'auroc': 0.93984735, 'binary_precision': 0.7777778, 'binary_recall': 0.08045977, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.14583334}
confusion matrix:
      0   1
0  5991   6
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-05 23:19:33.035756,epoch time: 0:26:25.569158,used: 0:26:25.569158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97508675, 'precision': 0.8202455, 'recall': 0.7667887, 'specificity': 0.7667887, 'f1': 0.7908615, 'auroc': 0.96114683, 'binary_precision': 0.65627563, 'binary_recall': 0.54347825, 'binary_specificity': 0.99009925, 'binary_f1_score': 0.5945745}
confusion matrix:
       0    1
0  41901  419
1    672  800
---- Validation: 
scalar performance:
{'acc': 0.9729672, 'precision': 0.8513584, 'recall': 0.6664812, 'specificity': 0.6664812, 'f1': 0.72342896, 'auroc': 0.9595642, 'binary_precision': 0.72575253, 'binary_recall': 0.33748055, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.46072185}
confusion matrix:
       0    1
0  18067   82
1    426  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971876, 'precision': 0.9351857, 'recall': 0.6829909, 'specificity': 0.6829909, 'f1': 0.7536256, 'auroc': 0.95148534, 'binary_precision': 0.89719623, 'binary_recall': 0.3678161, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.5217391}
confusion matrix:
      0   1
0  5986  11
1   165  96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-05 23:44:49.282034,epoch time: 0:25:16.246278,used: 0:51:41.815436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9749041, 'precision': 0.87291634, 'recall': 0.67981154, 'specificity': 0.67981154, 'f1': 0.7402241, 'auroc': 0.9639907, 'binary_precision': 0.7675753, 'binary_recall': 0.3634511, 'binary_specificity': 0.996172, 'binary_f1_score': 0.4933149}
confusion matrix:
       0    1
0  42158  162
1    937  535
---- Validation: 
scalar performance:
{'acc': 0.97227544, 'precision': 0.89911854, 'recall': 0.6196196, 'specificity': 0.6196196, 'f1': 0.6794344, 'auroc': 0.9603253, 'binary_precision': 0.8244681, 'binary_recall': 0.24105754, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.37304452}
confusion matrix:
       0    1
0  18116   33
1    488  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.94733673, 'recall': 0.5763782, 'specificity': 0.5763782, 'f1': 0.6224076, 'auroc': 0.9480751, 'binary_precision': 0.9302326, 'binary_recall': 0.1532567, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.26315787}
confusion matrix:
      0   1
0  5994   3
1   221  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_3.png
early stop counter: 1
val acc:0.97227543592453, best validation acc: 0.9729672074317932, corresponding to test acc:                         0.9718760251998901 / 0.9718760251998901
after epoch: 3,now: 2024-06-06 00:10:01.487132,epoch time: 0:25:12.205098,used: 1:16:54.020534,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9795853, 'precision': 0.8522892, 'recall': 0.81981516, 'specificity': 0.81981516, 'f1': 0.83519876, 'auroc': 0.9721299, 'binary_precision': 0.7167543, 'binary_recall': 0.6485384, 'binary_specificity': 0.9910919, 'binary_f1_score': 0.6809422}
confusion matrix:
       0    1
0  41944  377
1    517  954
---- Validation: 
scalar performance:
{'acc': 0.97945935, 'precision': 0.8612587, 'recall': 0.8078524, 'specificity': 0.8078524, 'f1': 0.8322393, 'auroc': 0.9690168, 'binary_precision': 0.7357798, 'binary_recall': 0.62363917, 'binary_specificity': 0.99206567, 'binary_f1_score': 0.6750842}
confusion matrix:
       0    1
0  18005  144
1    242  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685203, 'precision': 0.8954661, 'recall': 0.6555874, 'specificity': 0.6555874, 'f1': 0.71904314, 'auroc': 0.9519415, 'binary_precision': 0.82, 'binary_recall': 0.31417623, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.4542936}
confusion matrix:
      0   1
0  5979  18
1   179  82
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_4.png
better model found
persisted
after epoch: 4,now: 2024-06-06 00:35:14.971503,epoch time: 0:25:13.484371,used: 1:42:07.504905,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9780097, 'precision': 0.8850686, 'recall': 0.7342037, 'specificity': 0.7342037, 'f1': 0.7898919, 'auroc': 0.9734419, 'binary_precision': 0.78822196, 'binary_recall': 0.4728261, 'binary_specificity': 0.99558127, 'binary_f1_score': 0.59108275}
confusion matrix:
       0    1
0  42133  187
1    776  696
---- Validation: 
scalar performance:
{'acc': 0.9747765, 'precision': 0.9209668, 'recall': 0.65466696, 'specificity': 0.65466696, 'f1': 0.72237694, 'auroc': 0.97051334, 'binary_precision': 0.86580086, 'binary_recall': 0.31104198, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.4576659}
confusion matrix:
       0    1
0  18118   31
1    443  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.8797137, 'recall': 0.62876743, 'specificity': 0.62876743, 'f1': 0.6872958, 'auroc': 0.9601371, 'binary_precision': 0.7906977, 'binary_recall': 0.2605364, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.39193082}
confusion matrix:
      0   1
0  5979  18
1   193  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_5.png
early stop counter: 1
val acc:0.9747765064239502, best validation acc: 0.9794593453407288, corresponding to test acc:                         0.9685202836990356 / 0.9718760251998901
after epoch: 5,now: 2024-06-06 01:00:32.256991,epoch time: 0:25:17.285488,used: 2:07:24.790393,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98006487, 'precision': 0.9118235, 'recall': 0.749365, 'specificity': 0.749365, 'f1': 0.80921304, 'auroc': 0.97770643, 'binary_precision': 0.8407281, 'binary_recall': 0.50203806, 'binary_specificity': 0.9966919, 'binary_f1_score': 0.62866867}
confusion matrix:
       0    1
0  42180  140
1    733  739
---- Validation: 
scalar performance:
{'acc': 0.9746169, 'precision': 0.95592237, 'recall': 0.6380831, 'specificity': 0.6380831, 'f1': 0.7071959, 'auroc': 0.9707142, 'binary_precision': 0.9368421, 'binary_recall': 0.27682737, 'binary_specificity': 0.9993388, 'binary_f1_score': 0.42737097}
confusion matrix:
       0    1
0  18137   12
1    465  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.91988164, 'recall': 0.604697, 'specificity': 0.604697, 'f1': 0.6609769, 'auroc': 0.95487213, 'binary_precision': 0.8730159, 'binary_recall': 0.21072797, 'binary_specificity': 0.998666, 'binary_f1_score': 0.3395062}
confusion matrix:
      0   1
0  5989   8
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_6.png
early stop counter: 2
val acc:0.9746168851852417, best validation acc: 0.9794593453407288, corresponding to test acc:                         0.9685202836990356 / 0.9718760251998901
after epoch: 6,now: 2024-06-06 01:25:36.072498,epoch time: 0:25:03.815507,used: 2:32:28.605900,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9833303, 'precision': 0.8666825, 'recall': 0.882526, 'specificity': 0.882526, 'f1': 0.8744217, 'auroc': 0.9802177, 'binary_precision': 0.7412224, 'binary_recall': 0.7744565, 'binary_specificity': 0.99059546, 'binary_f1_score': 0.757475}
confusion matrix:
       0     1
0  41922   398
1    332  1140
---- Validation: 
scalar performance:
{'acc': 0.9835568, 'precision': 0.9052595, 'recall': 0.82872516, 'specificity': 0.82872516, 'f1': 0.86268324, 'auroc': 0.9768617, 'binary_precision': 0.82239383, 'binary_recall': 0.66251945, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.7338501}
confusion matrix:
       0    1
0  18057   92
1    217  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.8540168, 'recall': 0.6584183, 'specificity': 0.6584183, 'f1': 0.71547514, 'auroc': 0.9512731, 'binary_precision': 0.7368421, 'binary_recall': 0.3218391, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.44799998}
confusion matrix:
      0   1
0  5967  30
1   177  84
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_7.png
better model found
persisted
after epoch: 7,now: 2024-06-06 01:50:44.259514,epoch time: 0:25:08.187016,used: 2:57:36.792916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9838783, 'precision': 0.89120805, 'recall': 0.84893966, 'specificity': 0.84893966, 'f1': 0.86876774, 'auroc': 0.98108757, 'binary_precision': 0.79265493, 'binary_recall': 0.7042828, 'binary_specificity': 0.99359655, 'binary_f1_score': 0.74586034}
confusion matrix:
       0     1
0  42050   271
1    435  1036
---- Validation: 
scalar performance:
{'acc': 0.98169434, 'precision': 0.91059214, 'recall': 0.7872579, 'specificity': 0.7872579, 'f1': 0.837199, 'auroc': 0.97510535, 'binary_precision': 0.8359551, 'binary_recall': 0.5785381, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.6838235}
confusion matrix:
       0    1
0  18076   73
1    271  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.9137914, 'recall': 0.6274353, 'specificity': 0.6274353, 'f1': 0.68922263, 'auroc': 0.9551405, 'binary_precision': 0.85897434, 'binary_recall': 0.256705, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.39528027}
confusion matrix:
      0   1
0  5986  11
1   194  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_8.png
early stop counter: 1
val acc:0.9816943407058716, best validation acc: 0.9835568070411682, corresponding to test acc:                         0.9669223427772522 / 0.9718760251998901
after epoch: 8,now: 2024-06-06 02:16:01.702957,epoch time: 0:25:17.443443,used: 3:22:54.236359,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9822799, 'precision': 0.84233034, 'recall': 0.92254126, 'specificity': 0.92254126, 'f1': 0.87782073, 'auroc': 0.9815364, 'binary_precision': 0.6896175, 'binary_recall': 0.8585034, 'binary_specificity': 0.98657906, 'binary_f1_score': 0.7648485}
confusion matrix:
       0     1
0  41754   568
1    208  1262
---- Validation: 
scalar performance:
{'acc': 0.9837165, 'precision': 0.873847, 'recall': 0.8828118, 'specificity': 0.8828118, 'f1': 0.87827146, 'auroc': 0.9787629, 'binary_precision': 0.75569046, 'binary_recall': 0.7744945, 'binary_specificity': 0.991129, 'binary_f1_score': 0.7649769}
confusion matrix:
       0    1
0  17988  161
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.8108219, 'recall': 0.6795726, 'specificity': 0.6795726, 'f1': 0.7257571, 'auroc': 0.95197856, 'binary_precision': 0.6486486, 'binary_recall': 0.3678161, 'binary_specificity': 0.991329, 'binary_f1_score': 0.46943766}
confusion matrix:
      0   1
0  5945  52
1   165  96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_9.png
better model found
persisted
after epoch: 9,now: 2024-06-06 02:41:09.018827,epoch time: 0:25:07.315870,used: 3:48:01.552229,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98390114, 'precision': 0.92256606, 'recall': 0.8103645, 'specificity': 0.8103645, 'f1': 0.8572391, 'auroc': 0.9827286, 'binary_precision': 0.8580766, 'binary_recall': 0.6243206, 'binary_specificity': 0.99640834, 'binary_f1_score': 0.7227684}
confusion matrix:
       0    1
0  42168  152
1    553  919
---- Validation: 
scalar performance:
{'acc': 0.9819604, 'precision': 0.941826, 'recall': 0.764894, 'specificity': 0.764894, 'f1': 0.8296747, 'auroc': 0.9755647, 'binary_precision': 0.9, 'binary_recall': 0.5318818, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.66862166}
confusion matrix:
       0    1
0  18111   38
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.98176414, 'recall': 0.5651341, 'specificity': 0.5651341, 'f1': 0.6059669, 'auroc': 0.9681033, 'binary_precision': 1.0, 'binary_recall': 0.1302682, 'binary_specificity': 1.0, 'binary_f1_score': 0.23050848}
confusion matrix:
      0   1
0  5997   0
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_10.png
early stop counter: 1
val acc:0.9819604158401489, best validation acc: 0.9837164878845215, corresponding to test acc:                         0.9653244018554688 / 0.9718760251998901
after epoch: 10,now: 2024-06-06 03:06:13.649307,epoch time: 0:25:04.630480,used: 4:13:06.182709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9856595, 'precision': 0.8939891, 'recall': 0.8820918, 'specificity': 0.8820918, 'f1': 0.8879416, 'auroc': 0.9862833, 'binary_precision': 0.79593265, 'binary_recall': 0.7710598, 'binary_specificity': 0.9931238, 'binary_f1_score': 0.7832988}
confusion matrix:
       0     1
0  42029   291
1    337  1135
---- Validation: 
scalar performance:
{'acc': 0.98318434, 'precision': 0.87779164, 'recall': 0.86303484, 'specificity': 0.86303484, 'f1': 0.87025344, 'auroc': 0.977273, 'binary_precision': 0.7649919, 'binary_recall': 0.7340591, 'binary_specificity': 0.9920106, 'binary_f1_score': 0.74920636}
confusion matrix:
       0    1
0  18004  145
1    171  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8046179, 'recall': 0.58787054, 'specificity': 0.58787054, 'f1': 0.63086796, 'auroc': 0.9467256, 'binary_precision': 0.6438356, 'binary_recall': 0.18007663, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.2814371}
confusion matrix:
      0   1
0  5971  26
1   214  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_11.png
early stop counter: 2
val acc:0.9831843376159668, best validation acc: 0.9837164878845215, corresponding to test acc:                         0.9653244018554688 / 0.9718760251998901
after epoch: 11,now: 2024-06-06 03:31:23.226355,epoch time: 0:25:09.577048,used: 4:38:15.759757,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98355865, 'precision': 0.95457995, 'recall': 0.7774013, 'specificity': 0.7774013, 'f1': 0.8431042, 'auroc': 0.98578286, 'binary_precision': 0.9243792, 'binary_recall': 0.5563859, 'binary_specificity': 0.99841684, 'binary_f1_score': 0.6946565}
confusion matrix:
       0    1
0  42253   67
1    653  819
---- Validation: 
scalar performance:
{'acc': 0.9794061, 'precision': 0.9428705, 'recall': 0.7215685, 'specificity': 0.7215685, 'f1': 0.7929441, 'auroc': 0.9769369, 'binary_precision': 0.9050633, 'binary_recall': 0.44479004, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.5964546}
confusion matrix:
       0    1
0  18119   30
1    357  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.9602339, 'recall': 0.58220875, 'specificity': 0.58220875, 'f1': 0.63151383, 'auroc': 0.9587984, 'binary_precision': 0.95555556, 'binary_recall': 0.16475096, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.28104576}
confusion matrix:
      0   1
0  5995   2
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_12.png
early stop counter: 3
val acc:0.9794061183929443, best validation acc: 0.9837164878845215, corresponding to test acc:                         0.9653244018554688 / 0.9718760251998901
after epoch: 12,now: 2024-06-06 03:56:39.266961,epoch time: 0:25:16.040606,used: 5:03:31.800363,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9850429, 'precision': 0.87505364, 'recall': 0.9047229, 'specificity': 0.9047229, 'f1': 0.88927364, 'auroc': 0.98722833, 'binary_precision': 0.7564344, 'binary_recall': 0.8186141, 'binary_specificity': 0.99083173, 'binary_f1_score': 0.78629696}
confusion matrix:
       0     1
0  41932   388
1    267  1205
---- Validation: 
scalar performance:
{'acc': 0.98440826, 'precision': 0.878397, 'recall': 0.88917035, 'specificity': 0.88917035, 'f1': 0.8837013, 'auroc': 0.97659534, 'binary_precision': 0.7643505, 'binary_recall': 0.7869362, 'binary_specificity': 0.9914045, 'binary_f1_score': 0.77547896}
confusion matrix:
       0    1
0  17993  156
1    137  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.87514126, 'recall': 0.64759105, 'specificity': 0.64759105, 'f1': 0.70763373, 'auroc': 0.9602671, 'binary_precision': 0.78, 'binary_recall': 0.29885057, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.43213296}
confusion matrix:
      0   1
0  5975  22
1   183  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_13.png
better model found
persisted
after epoch: 13,now: 2024-06-06 04:21:54.048015,epoch time: 0:25:14.781054,used: 5:28:46.581417,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98584217, 'precision': 0.9065869, 'recall': 0.86644906, 'specificity': 0.86644906, 'f1': 0.88539183, 'auroc': 0.9882447, 'binary_precision': 0.82223904, 'binary_recall': 0.73845106, 'binary_specificity': 0.99444705, 'binary_f1_score': 0.77809584}
confusion matrix:
       0     1
0  42085   235
1    385  1087
---- Validation: 
scalar performance:
{'acc': 0.9841422, 'precision': 0.9022795, 'recall': 0.8440293, 'specificity': 0.8440293, 'f1': 0.8706958, 'auroc': 0.97693384, 'binary_precision': 0.8153565, 'binary_recall': 0.69362366, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.74957985}
confusion matrix:
       0    1
0  18048  101
1    197  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.87934446, 'recall': 0.6079448, 'specificity': 0.6079448, 'f1': 0.6621832, 'auroc': 0.9482858, 'binary_precision': 0.7916667, 'binary_recall': 0.21839081, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.34234235}
confusion matrix:
      0   1
0  5982  15
1   204  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_14.png
early stop counter: 1
val acc:0.9841421842575073, best validation acc: 0.9844082593917847, corresponding to test acc:                         0.9672419428825378 / 0.9718760251998901
after epoch: 14,now: 2024-06-06 04:47:03.399368,epoch time: 0:25:09.351353,used: 5:53:55.932770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9860705, 'precision': 0.9542647, 'recall': 0.8193555, 'specificity': 0.8193555, 'f1': 0.87421995, 'auroc': 0.9872695, 'binary_precision': 0.92089844, 'binary_recall': 0.640625, 'binary_specificity': 0.99808604, 'binary_f1_score': 0.755609}
confusion matrix:
       0    1
0  42239   81
1    529  943
---- Validation: 
scalar performance:
{'acc': 0.98472756, 'precision': 0.94382846, 'recall': 0.80982983, 'specificity': 0.80982983, 'f1': 0.8640535, 'auroc': 0.9780666, 'binary_precision': 0.9009009, 'binary_recall': 0.62208396, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.73597056}
confusion matrix:
       0    1
0  18105   44
1    243  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.93121386, 'recall': 0.55147403, 'specificity': 0.55147403, 'f1': 0.58309025, 'auroc': 0.9478494, 'binary_precision': 0.9, 'binary_recall': 0.10344828, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.185567}
confusion matrix:
      0   1
0  5994   3
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_15.png
better model found
persisted
after epoch: 15,now: 2024-06-06 05:12:14.667075,epoch time: 0:25:11.267707,used: 6:19:07.200477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9863217, 'precision': 0.9471942, 'recall': 0.8296491, 'specificity': 0.8296491, 'f1': 0.8788887, 'auroc': 0.9877962, 'binary_precision': 0.9060465, 'binary_recall': 0.6616848, 'binary_specificity': 0.99761343, 'binary_f1_score': 0.76482135}
confusion matrix:
       0    1
0  42219  101
1    498  974
---- Validation: 
scalar performance:
{'acc': 0.9844615, 'precision': 0.93308693, 'recall': 0.8149425, 'specificity': 0.8149425, 'f1': 0.86399037, 'auroc': 0.9781555, 'binary_precision': 0.87904966, 'binary_recall': 0.63297045, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.7359855}
confusion matrix:
       0    1
0  18093   56
1    236  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.84521025, 'recall': 0.5603022, 'specificity': 0.5603022, 'f1': 0.59504986, 'auroc': 0.90984637, 'binary_precision': 0.72727275, 'binary_recall': 0.12260536, 'binary_specificity': 0.997999, 'binary_f1_score': 0.20983605}
confusion matrix:
      0   1
0  5985  12
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_16.png
early stop counter: 1
val acc:0.9844614863395691, best validation acc: 0.9847275614738464, corresponding to test acc:                         0.9621284604072571 / 0.9718760251998901
after epoch: 16,now: 2024-06-06 05:37:25.395106,epoch time: 0:25:10.728031,used: 6:44:17.928508,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98707527, 'precision': 0.9521707, 'recall': 0.8376886, 'specificity': 0.8376886, 'f1': 0.8860383, 'auroc': 0.98981285, 'binary_precision': 0.91544116, 'binary_recall': 0.67755103, 'binary_specificity': 0.9978262, 'binary_f1_score': 0.7787334}
confusion matrix:
       0    1
0  42230   92
1    474  996
---- Validation: 
scalar performance:
{'acc': 0.9838761, 'precision': 0.9281548, 'recall': 0.809389, 'specificity': 0.809389, 'f1': 0.8584944, 'auroc': 0.978295, 'binary_precision': 0.8695652, 'binary_recall': 0.62208396, 'binary_specificity': 0.996694, 'binary_f1_score': 0.7252946}
confusion matrix:
       0    1
0  18089   60
1    243  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.92146814, 'recall': 0.52856886, 'specificity': 0.52856886, 'f1': 0.5438245, 'auroc': 0.94031215, 'binary_precision': 0.88235295, 'binary_recall': 0.057471264, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.10791367}
confusion matrix:
      0   1
0  5995   2
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_17.png
early stop counter: 2
val acc:0.98387610912323, best validation acc: 0.9847275614738464, corresponding to test acc:                         0.9621284604072571 / 0.9718760251998901
after epoch: 17,now: 2024-06-06 06:02:32.980610,epoch time: 0:25:07.585504,used: 7:09:25.514012,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9886052, 'precision': 0.9103087, 'recall': 0.91541827, 'specificity': 0.91541827, 'f1': 0.9128463, 'auroc': 0.99040985, 'binary_precision': 0.8262911, 'binary_recall': 0.8369565, 'binary_specificity': 0.99388, 'binary_f1_score': 0.8315896}
confusion matrix:
       0     1
0  42061   259
1    240  1232
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.90612245, 'recall': 0.86883, 'specificity': 0.86883, 'f1': 0.8865048, 'auroc': 0.977761, 'binary_precision': 0.8213059, 'binary_recall': 0.7433904, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.78040814}
confusion matrix:
       0    1
0  18045  104
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.85312897, 'recall': 0.60186416, 'specificity': 0.60186416, 'f1': 0.6524007, 'auroc': 0.9475745, 'binary_precision': 0.739726, 'binary_recall': 0.20689656, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.32335332}
confusion matrix:
      0   1
0  5978  19
1   207  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_18.png
better model found
persisted
after epoch: 18,now: 2024-06-06 06:27:42.312008,epoch time: 0:25:09.331398,used: 7:34:34.845410,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9843807, 'precision': 0.8581003, 'recall': 0.93126476, 'specificity': 0.93126476, 'f1': 0.8909719, 'auroc': 0.98997164, 'binary_precision': 0.7206047, 'binary_recall': 0.8743206, 'binary_specificity': 0.9882089, 'binary_f1_score': 0.7900552}
confusion matrix:
       0     1
0  41821   499
1    185  1287
---- Validation: 
scalar performance:
{'acc': 0.98323756, 'precision': 0.8603083, 'recall': 0.90281534, 'specificity': 0.90281534, 'f1': 0.88026685, 'auroc': 0.979414, 'binary_precision': 0.7271468, 'binary_recall': 0.8164852, 'binary_specificity': 0.9891454, 'binary_f1_score': 0.7692308}
confusion matrix:
       0    1
0  17952  197
1    118  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.8603541, 'recall': 0.61519074, 'specificity': 0.61519074, 'f1': 0.6693269, 'auroc': 0.94804984, 'binary_precision': 0.75308645, 'binary_recall': 0.23371647, 'binary_specificity': 0.996665, 'binary_f1_score': 0.35672513}
confusion matrix:
      0   1
0  5977  20
1   200  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_19.png
early stop counter: 1
val acc:0.9832375645637512, best validation acc: 0.985685408115387, corresponding to test acc:                         0.9638862013816833 / 0.9718760251998901
after epoch: 19,now: 2024-06-06 06:52:59.770586,epoch time: 0:25:17.458578,used: 7:59:52.303988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9889021, 'precision': 0.92018473, 'recall': 0.9063918, 'specificity': 0.9063918, 'f1': 0.9131639, 'auroc': 0.9915787, 'binary_precision': 0.84669477, 'binary_recall': 0.8179348, 'binary_specificity': 0.9948488, 'binary_f1_score': 0.83206636}
confusion matrix:
       0     1
0  42102   218
1    268  1204
---- Validation: 
scalar performance:
{'acc': 0.98435503, 'precision': 0.8988046, 'recall': 0.8531402, 'specificity': 0.8531402, 'f1': 0.87447107, 'auroc': 0.97946596, 'binary_precision': 0.8077601, 'binary_recall': 0.7122862, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.7570248}
confusion matrix:
       0    1
0  18040  109
1    185  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9701182, 'precision': 0.8836975, 'recall': 0.6894031, 'specificity': 0.6894031, 'f1': 0.75068915, 'auroc': 0.9541388, 'binary_precision': 0.7936508, 'binary_recall': 0.38314176, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.5167958}
confusion matrix:
      0    1
0  5971   26
1   161  100
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_20.png
early stop counter: 2
val acc:0.9843550324440002, best validation acc: 0.985685408115387, corresponding to test acc:                         0.9638862013816833 / 0.9718760251998901
after epoch: 20,now: 2024-06-06 07:18:08.953575,epoch time: 0:25:09.182989,used: 8:25:01.486977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98922175, 'precision': 0.9265897, 'recall': 0.9036064, 'specificity': 0.9036064, 'f1': 0.91475457, 'auroc': 0.99232864, 'binary_precision': 0.85971224, 'binary_recall': 0.8118206, 'binary_specificity': 0.99539226, 'binary_f1_score': 0.8350803}
confusion matrix:
       0     1
0  42125   195
1    277  1195
---- Validation: 
scalar performance:
{'acc': 0.9850468, 'precision': 0.9088506, 'recall': 0.8527483, 'specificity': 0.8527483, 'f1': 0.8785657, 'auroc': 0.9783288, 'binary_precision': 0.82789856, 'binary_recall': 0.71073097, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.76485354}
confusion matrix:
       0    1
0  18054   95
1    186  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.872489, 'recall': 0.58703876, 'specificity': 0.58703876, 'f1': 0.63440263, 'auroc': 0.93573034, 'binary_precision': 0.779661, 'binary_recall': 0.17624521, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.2875}
confusion matrix:
      0   1
0  5984  13
1   215  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_21.png
early stop counter: 3
val acc:0.9850468039512634, best validation acc: 0.985685408115387, corresponding to test acc:                         0.9638862013816833 / 0.9718760251998901
after epoch: 21,now: 2024-06-06 07:43:09.271567,epoch time: 0:25:00.317992,used: 8:50:01.804969,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99024934, 'precision': 0.95406276, 'recall': 0.88971233, 'specificity': 0.88971233, 'f1': 0.91925025, 'auroc': 0.99281263, 'binary_precision': 0.91567224, 'binary_recall': 0.7819294, 'binary_specificity': 0.9974953, 'binary_f1_score': 0.8435325}
confusion matrix:
       0     1
0  42214   106
1    321  1151
---- Validation: 
scalar performance:
{'acc': 0.9856854, 'precision': 0.9313691, 'recall': 0.8380778, 'specificity': 0.8380778, 'f1': 0.87863636, 'auroc': 0.98104143, 'binary_precision': 0.874, 'binary_recall': 0.67962676, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.7646544}
confusion matrix:
       0    1
0  18086   63
1    206  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.95904505, 'recall': 0.5783773, 'specificity': 0.5783773, 'f1': 0.62577903, 'auroc': 0.94678533, 'binary_precision': 0.95348835, 'binary_recall': 0.15708812, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.26973683}
confusion matrix:
      0   1
0  5995   2
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_22.png
early stop counter: 4
val acc:0.985685408115387, best validation acc: 0.985685408115387, corresponding to test acc:                         0.9638862013816833 / 0.9718760251998901
after epoch: 22,now: 2024-06-06 08:08:09.719133,epoch time: 0:25:00.447566,used: 9:15:02.252535,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98449486, 'precision': 0.8898066, 'recall': 0.86444056, 'specificity': 0.86444056, 'f1': 0.8766614, 'auroc': 0.98965013, 'binary_precision': 0.78878367, 'binary_recall': 0.7357337, 'binary_specificity': 0.99314743, 'binary_f1_score': 0.76133573}
confusion matrix:
       0     1
0  42030   290
1    389  1083
---- Validation: 
scalar performance:
{'acc': 0.9815879, 'precision': 0.8734489, 'recall': 0.8352064, 'specificity': 0.8352064, 'f1': 0.85320663, 'auroc': 0.9782915, 'binary_precision': 0.75826085, 'binary_recall': 0.67807156, 'binary_specificity': 0.99234116, 'binary_f1_score': 0.71592766}
confusion matrix:
       0    1
0  18010  139
1    207  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.8467598, 'recall': 0.6751594, 'specificity': 0.6751594, 'f1': 0.73004985, 'auroc': 0.9463279, 'binary_precision': 0.7209302, 'binary_recall': 0.35632184, 'binary_specificity': 0.993997, 'binary_f1_score': 0.47692308}
confusion matrix:
      0   1
0  5961  36
1   168  93
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_23.png
early stop counter: 5
val acc:0.9815878868103027, best validation acc: 0.985685408115387, corresponding to test acc:                         0.9638862013816833 / 0.9718760251998901
after epoch: 23,now: 2024-06-06 08:33:08.556031,epoch time: 0:24:58.836898,used: 9:40:01.089433,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98901623, 'precision': 0.91557556, 'recall': 0.91530305, 'specificity': 0.91530305, 'f1': 0.91543925, 'auroc': 0.99275166, 'binary_precision': 0.8368457, 'binary_recall': 0.8362772, 'binary_specificity': 0.9943289, 'binary_f1_score': 0.8365613}
confusion matrix:
       0     1
0  42080   240
1    241  1231
---- Validation: 
scalar performance:
{'acc': 0.98541933, 'precision': 0.90521216, 'recall': 0.86494195, 'specificity': 0.86494195, 'f1': 0.8839375, 'auroc': 0.98144156, 'binary_precision': 0.81975734, 'binary_recall': 0.7356143, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.7754098}
confusion matrix:
       0    1
0  18045  104
1    170  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.777477, 'recall': 0.5854546, 'specificity': 0.5854546, 'f1': 0.6255511, 'auroc': 0.9305122, 'binary_precision': 0.5897436, 'binary_recall': 0.17624521, 'binary_specificity': 0.994664, 'binary_f1_score': 0.27138644}
confusion matrix:
      0   1
0  5965  32
1   215  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_24.png
early stop counter: 6
val acc:0.9854193329811096, best validation acc: 0.985685408115387, corresponding to test acc:                         0.9638862013816833 / 0.9718760251998901
after epoch: 24,now: 2024-06-06 08:58:29.400324,epoch time: 0:25:20.844293,used: 10:05:21.933726,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99113995, 'precision': 0.94628155, 'recall': 0.9133934, 'specificity': 0.9133934, 'f1': 0.9291598, 'auroc': 0.99407375, 'binary_precision': 0.8984547, 'binary_recall': 0.8300476, 'binary_specificity': 0.9967392, 'binary_f1_score': 0.8628976}
confusion matrix:
       0     1
0  42183   138
1    250  1221
---- Validation: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.923151, 'recall': 0.86252034, 'specificity': 0.86252034, 'f1': 0.89031076, 'auroc': 0.98151267, 'binary_precision': 0.85583943, 'binary_recall': 0.7293935, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.7875734}
confusion matrix:
       0    1
0  18070   79
1    174  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.8813356, 'recall': 0.6174399, 'specificity': 0.6174399, 'f1': 0.6740627, 'auroc': 0.9321165, 'binary_precision': 0.7948718, 'binary_recall': 0.23754789, 'binary_specificity': 0.997332, 'binary_f1_score': 0.36578172}
confusion matrix:
      0   1
0  5981  16
1   199  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_25.png
better model found
persisted
after epoch: 25,now: 2024-06-06 09:23:32.457621,epoch time: 0:25:03.057297,used: 10:30:24.991023,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9899525, 'precision': 0.96763265, 'recall': 0.8718543, 'specificity': 0.8718543, 'f1': 0.9138871, 'auroc': 0.9944355, 'binary_precision': 0.94406193, 'binary_recall': 0.74524456, 'binary_specificity': 0.9984641, 'binary_f1_score': 0.83295363}
confusion matrix:
       0     1
0  42255    65
1    375  1097
---- Validation: 
scalar performance:
{'acc': 0.98541933, 'precision': 0.931327, 'recall': 0.83343965, 'specificity': 0.83343965, 'f1': 0.8756426, 'auroc': 0.9818399, 'binary_precision': 0.8742393, 'binary_recall': 0.6702955, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.7588028}
confusion matrix:
       0    1
0  18087   62
1    212  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.9013542, 'recall': 0.6063626, 'specificity': 0.6063626, 'f1': 0.66187054, 'auroc': 0.9245386, 'binary_precision': 0.8358209, 'binary_recall': 0.21455939, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.34146342}
confusion matrix:
      0   1
0  5986  11
1   205  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_26.png
early stop counter: 1
val acc:0.9854193329811096, best validation acc: 0.9865368008613586, corresponding to test acc:                         0.9656440019607544 / 0.9718760251998901
after epoch: 26,now: 2024-06-06 09:48:38.185012,epoch time: 0:25:05.727391,used: 10:55:30.718414,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9906147, 'precision': 0.9457488, 'recall': 0.9049829, 'specificity': 0.9049829, 'f1': 0.924314, 'auroc': 0.9946428, 'binary_precision': 0.8979745, 'binary_recall': 0.8131794, 'binary_specificity': 0.9967864, 'binary_f1_score': 0.853476}
confusion matrix:
       0     1
0  42184   136
1    275  1197
---- Validation: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.9332939, 'recall': 0.84354854, 'specificity': 0.84354854, 'f1': 0.8828412, 'auroc': 0.9806079, 'binary_precision': 0.8774704, 'binary_recall': 0.6905132, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.7728459}
confusion matrix:
       0    1
0  18087   62
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.90644526, 'recall': 0.6045302, 'specificity': 0.6045302, 'f1': 0.65985197, 'auroc': 0.95053273, 'binary_precision': 0.84615386, 'binary_recall': 0.21072797, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.33742335}
confusion matrix:
      0   1
0  5987  10
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_27.png
early stop counter: 2
val acc:0.9861111044883728, best validation acc: 0.9865368008613586, corresponding to test acc:                         0.9656440019607544 / 0.9718760251998901
after epoch: 27,now: 2024-06-06 10:13:50.437333,epoch time: 0:25:12.252321,used: 11:20:42.970735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9905462, 'precision': 0.94559866, 'recall': 0.90396386, 'specificity': 0.90396386, 'f1': 0.92368263, 'auroc': 0.99463606, 'binary_precision': 0.89774436, 'binary_recall': 0.8111413, 'binary_specificity': 0.9967864, 'binary_f1_score': 0.8522484}
confusion matrix:
       0     1
0  42184   136
1    278  1194
---- Validation: 
scalar performance:
{'acc': 0.98557895, 'precision': 0.9393998, 'recall': 0.8282719, 'specificity': 0.8282719, 'f1': 0.87519383, 'auroc': 0.9808603, 'binary_precision': 0.8907563, 'binary_recall': 0.65940905, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.7578195}
confusion matrix:
       0    1
0  18097   52
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.9191945, 'recall': 0.5913704, 'specificity': 0.5913704, 'f1': 0.64288235, 'auroc': 0.9398952, 'binary_precision': 0.8727273, 'binary_recall': 0.18390805, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.30379745}
confusion matrix:
      0   1
0  5990   7
1   213  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_28.png
early stop counter: 3
val acc:0.9855789542198181, best validation acc: 0.9865368008613586, corresponding to test acc:                         0.9656440019607544 / 0.9718760251998901
after epoch: 28,now: 2024-06-06 10:39:00.097358,epoch time: 0:25:09.660025,used: 11:45:52.630760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9914596, 'precision': 0.96781063, 'recall': 0.89624, 'specificity': 0.89624, 'f1': 0.92884386, 'auroc': 0.995116, 'binary_precision': 0.94274193, 'binary_recall': 0.7941576, 'binary_specificity': 0.9983223, 'binary_f1_score': 0.8620944}
confusion matrix:
       0     1
0  42249    71
1    303  1169
---- Validation: 
scalar performance:
{'acc': 0.9853661, 'precision': 0.9319087, 'recall': 0.83191204, 'specificity': 0.83191204, 'f1': 0.87486863, 'auroc': 0.9805578, 'binary_precision': 0.8755102, 'binary_recall': 0.66718507, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.7572816}
confusion matrix:
       0    1
0  18088   61
1    214  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.77959347, 'recall': 0.5111608, 'specificity': 0.5111608, 'f1': 0.5115645, 'auroc': 0.91682523, 'binary_precision': 0.6, 'binary_recall': 0.022988506, 'binary_specificity': 0.999333, 'binary_f1_score': 0.044280443}
confusion matrix:
      0  1
0  5993  4
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_29.png
early stop counter: 4
val acc:0.9853661060333252, best validation acc: 0.9865368008613586, corresponding to test acc:                         0.9656440019607544 / 0.9718760251998901
after epoch: 29,now: 2024-06-06 11:04:04.743415,epoch time: 0:25:04.646057,used: 12:10:57.276817,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.991825, 'precision': 0.95922285, 'recall': 0.9108548, 'specificity': 0.9108548, 'f1': 0.93359315, 'auroc': 0.99608165, 'binary_precision': 0.92454267, 'binary_recall': 0.82404894, 'binary_specificity': 0.9976607, 'binary_f1_score': 0.87140805}
confusion matrix:
       0     1
0  42221    99
1    259  1213
---- Validation: 
scalar performance:
{'acc': 0.9855257, 'precision': 0.9266684, 'recall': 0.84024525, 'specificity': 0.84024525, 'f1': 0.8782115, 'auroc': 0.9797966, 'binary_precision': 0.8644401, 'binary_recall': 0.6842924, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.7638889}
confusion matrix:
       0    1
0  18080   69
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8873775, 'recall': 0.5493082, 'specificity': 0.5493082, 'f1': 0.57887876, 'auroc': 0.925472, 'binary_precision': 0.8125, 'binary_recall': 0.099616855, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.1774744}
confusion matrix:
      0   1
0  5991   6
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_30.png
early stop counter: 5
val acc:0.9855257272720337, best validation acc: 0.9865368008613586, corresponding to test acc:                         0.9656440019607544 / 0.9718760251998901
after epoch: 30,now: 2024-06-06 11:29:25.776369,epoch time: 0:25:21.032954,used: 12:36:18.309771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_53_07_seed_0_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:36:18.309771 at 2024-06-06 11:29:25.776369
persisted model performance metric: 

scalar performance:
{'acc': 0.96692234, 'precision': 0.9117791, 'recall': 0.62360394, 'specificity': 0.62360394, 'f1': 0.6843801, 'auroc': 0.9429166, 'binary_precision': 0.8552632, 'binary_recall': 0.24904214, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.3857567}
confusion matrix:
      0   1
0  5986  11
1   196  65
oracle model performance metric: 

scalar performance:
{'acc': 0.97283477, 'precision': 0.9195265, 'recall': 0.7054792, 'specificity': 0.7054792, 'f1': 0.7727853, 'auroc': 0.95573443, 'binary_precision': 0.864, 'binary_recall': 0.41379312, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.5595855}
confusion matrix:
      0    1
0  5980   17
1   153  108
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456549 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456549 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB |   1119 TiB |   1119 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1106 TiB |   1106 TiB |
|       from small pool |  40679 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14484 MiB |  14484 MiB |  14484 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446619 KiB |   1251 MiB |    802 TiB |    802 TiB |
|       from large pool | 435058 KiB |   1243 MiB |    789 TiB |    789 TiB |
|       from small pool |  11560 KiB |     17 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  197599 K  |  197595 K  |
|       from large pool |     187    |    1413    |  102521 K  |  102521 K  |
|       from small pool |    3301    |    6290    |   95078 K  |   95074 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  197599 K  |  197595 K  |
|       from large pool |     187    |    1413    |  102521 K  |  102521 K  |
|       from small pool |    3301    |    6290    |   95078 K  |   95074 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     636    |     636    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    2802    |  127505 K  |  127505 K  |
|       from large pool |      37    |     600    |   76732 K  |   76732 K  |
|       from small pool |      43    |    2764    |   50772 K  |   50772 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1119 TiB |   1119 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1106 TiB |   1106 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  14484 MiB |  13602 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |    802 TiB |    802 TiB |
|       from large pool |  24320 KiB |   1243 MiB |    789 TiB |    789 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197599 K  |  197599 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95078 K  |   95078 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197599 K  |  197599 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95078 K  |   95078 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |     636    |     573    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2802    |  127506 K  |  127506 K  |
|       from large pool |       4    |     600    |   76732 K  |   76732 K  |
|       from small pool |       0    |    2764    |   50773 K  |   50773 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1127 TiB |   1127 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1119 TiB |   1119 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1106 TiB |   1106 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  14484 MiB |  13602 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |    802 TiB |    802 TiB |
|       from large pool |  24320 KiB |   1243 MiB |    789 TiB |    789 TiB |
|       from small pool |      0 KiB |     43 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197599 K  |  197599 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95078 K  |   95078 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197599 K  |  197599 K  |
|       from large pool |       2    |    1413    |  102521 K  |  102521 K  |
|       from small pool |       0    |    6290    |   95078 K  |   95078 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |     636    |     573    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2802    |  127506 K  |  127506 K  |
|       from large pool |       4    |     600    |   76732 K  |   76732 K  |
|       from small pool |       0    |    2764    |   50773 K  |   50773 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987

 Experiment start at: 2024-06-06 11:41:05.681493
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.181115061044693
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97040313, 'precision': 0.7825581, 'recall': 0.66381437, 'specificity': 0.66381437, 'f1': 0.70599675, 'auroc': 0.95108795, 'binary_precision': 0.5873786, 'binary_recall': 0.33564493, 'binary_specificity': 0.9919838, 'binary_f1_score': 0.42718446}
confusion matrix:
       0    1
0  42074  340
1    958  484
---- Validation: 
scalar performance:
{'acc': 0.96707577, 'precision': 0.80090046, 'recall': 0.59811085, 'specificity': 0.59811085, 'f1': 0.64376783, 'auroc': 0.94778204, 'binary_precision': 0.63084114, 'binary_recall': 0.20059435, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.30439684}
confusion matrix:
       0    1
0  17988   79
1    538  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9690622, 'precision': 0.8992039, 'recall': 0.663871, 'specificity': 0.663871, 'f1': 0.7282956, 'auroc': 0.9438331, 'binary_precision': 0.8269231, 'binary_recall': 0.33076924, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.47252747}
confusion matrix:
      0   1
0  5928  18
1   174  86
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-06 12:07:58.315510,epoch time: 0:26:52.634017,used: 0:26:52.634017,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97177124, 'precision': 0.77390975, 'recall': 0.82529867, 'specificity': 0.82529867, 'f1': 0.7971637, 'auroc': 0.9617967, 'binary_precision': 0.55916476, 'binary_recall': 0.6685159, 'binary_specificity': 0.9820814, 'binary_f1_score': 0.60897034}
confusion matrix:
       0    1
0  41654  760
1    478  964
---- Validation: 
scalar performance:
{'acc': 0.9708645, 'precision': 0.7873184, 'recall': 0.80535746, 'specificity': 0.80535746, 'f1': 0.79603267, 'auroc': 0.9617908, 'binary_precision': 0.58856344, 'binary_recall': 0.62704307, 'binary_specificity': 0.9836719, 'binary_f1_score': 0.60719424}
confusion matrix:
       0    1
0  17772  295
1    251  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9738962, 'precision': 0.8960596, 'recall': 0.74179214, 'specificity': 0.74179214, 'f1': 0.7985362, 'auroc': 0.9483175, 'binary_precision': 0.8141026, 'binary_recall': 0.48846152, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.61057687}
confusion matrix:
      0    1
0  5917   29
1   133  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-06 12:33:01.202155,epoch time: 0:25:02.886645,used: 0:51:55.520662,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.971224, 'precision': 0.76795524, 'recall': 0.8786081, 'specificity': 0.8786081, 'f1': 0.81273407, 'auroc': 0.9668385, 'binary_precision': 0.54352033, 'binary_recall': 0.77947295, 'binary_specificity': 0.9777432, 'binary_f1_score': 0.64045584}
confusion matrix:
       0     1
0  41470   944
1    318  1124
---- Validation: 
scalar performance:
{'acc': 0.9710779, 'precision': 0.78358835, 'recall': 0.8526758, 'specificity': 0.8526758, 'f1': 0.8139399, 'auroc': 0.96477437, 'binary_precision': 0.57751477, 'binary_recall': 0.7251114, 'binary_specificity': 0.9802402, 'binary_f1_score': 0.64295125}
confusion matrix:
       0    1
0  17710  357
1    185  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709958, 'precision': 0.8577856, 'recall': 0.7347616, 'specificity': 0.7347616, 'f1': 0.78220963, 'auroc': 0.9523293, 'binary_precision': 0.7380952, 'binary_recall': 0.47692308, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.5794393}
confusion matrix:
      0    1
0  5902   44
1   136  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_3.png
better model found
persisted
after epoch: 3,now: 2024-06-06 12:58:06.218952,epoch time: 0:25:05.016797,used: 1:17:00.537459,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9774717, 'precision': 0.83781564, 'recall': 0.7813525, 'specificity': 0.7813525, 'f1': 0.80678827, 'auroc': 0.968295, 'binary_precision': 0.69011724, 'binary_recall': 0.5714286, 'binary_specificity': 0.99127644, 'binary_f1_score': 0.62518966}
confusion matrix:
       0    1
0  42044  370
1    618  824
---- Validation: 
scalar performance:
{'acc': 0.97545356, 'precision': 0.86971426, 'recall': 0.72905815, 'specificity': 0.72905815, 'f1': 0.7815035, 'auroc': 0.96447885, 'binary_precision': 0.7591241, 'binary_recall': 0.46359584, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.57564574}
confusion matrix:
       0    1
0  17968   99
1    361  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.78018117, 'recall': 0.52800524, 'specificity': 0.52800524, 'f1': 0.54211783, 'auroc': 0.94804555, 'binary_precision': 0.6, 'binary_recall': 0.057692308, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.10526316}
confusion matrix:
      0   1
0  5936  10
1   245  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_4.png
better model found
persisted
after epoch: 4,now: 2024-06-06 13:23:15.272612,epoch time: 0:25:09.053660,used: 1:42:09.591119,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97984314, 'precision': 0.87326777, 'recall': 0.77889407, 'specificity': 0.77889407, 'f1': 0.8187167, 'auroc': 0.97371846, 'binary_precision': 0.76123595, 'binary_recall': 0.5638003, 'binary_specificity': 0.99398786, 'binary_f1_score': 0.64780873}
confusion matrix:
       0    1
0  42159  255
1    629  813
---- Validation: 
scalar performance:
{'acc': 0.9765742, 'precision': 0.91356593, 'recall': 0.7103271, 'specificity': 0.7103271, 'f1': 0.7764394, 'auroc': 0.96581644, 'binary_precision': 0.84821427, 'binary_recall': 0.42347696, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.5649158}
confusion matrix:
       0    1
0  18016   51
1    388  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.803909, 'recall': 0.5844362, 'specificity': 0.5844362, 'f1': 0.6264315, 'auroc': 0.9502759, 'binary_precision': 0.64285713, 'binary_recall': 0.17307693, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.27272728}
confusion matrix:
      0   1
0  5921  25
1   215  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_5.png
better model found
persisted
after epoch: 5,now: 2024-06-06 13:48:23.545073,epoch time: 0:25:08.272461,used: 2:07:17.863580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97920465, 'precision': 0.8304379, 'recall': 0.855603, 'specificity': 0.855603, 'f1': 0.8425158, 'auroc': 0.97778946, 'binary_precision': 0.6703085, 'binary_recall': 0.723301, 'binary_specificity': 0.98790497, 'binary_f1_score': 0.6957972}
confusion matrix:
       0     1
0  41901   513
1    399  1043
---- Validation: 
scalar performance:
{'acc': 0.97769475, 'precision': 0.86773217, 'recall': 0.7795739, 'specificity': 0.7795739, 'f1': 0.8171238, 'auroc': 0.9753045, 'binary_precision': 0.75147927, 'binary_recall': 0.5661218, 'binary_specificity': 0.99302596, 'binary_f1_score': 0.6457627}
confusion matrix:
       0    1
0  17941  126
1    292  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95633256, 'precision': 0.71672344, 'recall': 0.63148206, 'specificity': 0.63148206, 'f1': 0.6621995, 'auroc': 0.94591063, 'binary_precision': 0.46451613, 'binary_recall': 0.2769231, 'binary_specificity': 0.986041, 'binary_f1_score': 0.34698796}
confusion matrix:
      0   1
0  5863  83
1   188  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_6.png
better model found
persisted
after epoch: 6,now: 2024-06-06 14:13:50.838000,epoch time: 0:25:27.292927,used: 2:32:45.156507,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98267055, 'precision': 0.90807474, 'recall': 0.7954287, 'specificity': 0.7954287, 'f1': 0.84206843, 'auroc': 0.98012495, 'binary_precision': 0.82978725, 'binary_recall': 0.59500694, 'binary_specificity': 0.99585044, 'binary_f1_score': 0.6930533}
confusion matrix:
       0    1
0  42238  176
1    584  858
---- Validation: 
scalar performance:
{'acc': 0.9767876, 'precision': 0.9116087, 'recall': 0.7154446, 'specificity': 0.7154446, 'f1': 0.7805902, 'auroc': 0.9717614, 'binary_precision': 0.84393066, 'binary_recall': 0.43387815, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.5731109}
confusion matrix:
       0    1
0  18013   54
1    381  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.850472, 'recall': 0.55869037, 'specificity': 0.55869037, 'f1': 0.5927398, 'auroc': 0.95417035, 'binary_precision': 0.7380952, 'binary_recall': 0.11923077, 'binary_specificity': 0.99815, 'binary_f1_score': 0.20529802}
confusion matrix:
      0   1
0  5935  11
1   229  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_7.png
early stop counter: 1
val acc:0.9767876267433167, best validation acc: 0.9776947498321533, corresponding to test acc:                         0.9563325643539429 / 0.9738962054252625
after epoch: 7,now: 2024-06-06 14:39:13.031278,epoch time: 0:25:22.193278,used: 2:58:07.349785,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9836739, 'precision': 0.8883443, 'recall': 0.84183586, 'specificity': 0.84183586, 'f1': 0.8634899, 'auroc': 0.9829794, 'binary_precision': 0.7871835, 'binary_recall': 0.6900139, 'binary_specificity': 0.99365777, 'binary_f1_score': 0.7354028}
confusion matrix:
       0    1
0  42145  269
1    447  995
---- Validation: 
scalar performance:
{'acc': 0.97934896, 'precision': 0.90918577, 'recall': 0.7625501, 'specificity': 0.7625501, 'f1': 0.8186121, 'auroc': 0.9753439, 'binary_precision': 0.8356807, 'binary_recall': 0.5289747, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.64786166}
confusion matrix:
       0    1
0  17997   70
1    317  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.77160865, 'recall': 0.6209637, 'specificity': 0.6209637, 'f1': 0.6641705, 'auroc': 0.95933497, 'binary_precision': 0.57522124, 'binary_recall': 0.25, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.34852546}
confusion matrix:
      0   1
0  5898  48
1   195  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_8.png
better model found
persisted
after epoch: 8,now: 2024-06-06 15:04:28.245483,epoch time: 0:25:15.214205,used: 3:23:22.563990,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9841983, 'precision': 0.88536036, 'recall': 0.8581847, 'specificity': 0.8581847, 'f1': 0.8712352, 'auroc': 0.9826642, 'binary_precision': 0.7801047, 'binary_recall': 0.723301, 'binary_specificity': 0.99306834, 'binary_f1_score': 0.7506298}
confusion matrix:
       0     1
0  42120   294
1    399  1043
---- Validation: 
scalar performance:
{'acc': 0.98207045, 'precision': 0.90742695, 'recall': 0.813315, 'specificity': 0.813315, 'f1': 0.8537185, 'auroc': 0.9745359, 'binary_precision': 0.82846004, 'binary_recall': 0.6315007, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.7166948}
confusion matrix:
       0    1
0  17979   88
1    248  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.7881334, 'recall': 0.5766598, 'specificity': 0.5766598, 'f1': 0.6152457, 'auroc': 0.95444727, 'binary_precision': 0.6119403, 'binary_recall': 0.15769231, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.25076455}
confusion matrix:
      0   1
0  5920  26
1   219  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_9.png
better model found
persisted
after epoch: 9,now: 2024-06-06 15:29:42.382036,epoch time: 0:25:14.136553,used: 3:48:36.700543,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98506474, 'precision': 0.92804396, 'recall': 0.8201131, 'specificity': 0.8201131, 'f1': 0.86573005, 'auroc': 0.98454773, 'binary_precision': 0.868101, 'binary_recall': 0.64355063, 'binary_specificity': 0.9966756, 'binary_f1_score': 0.7391477}
confusion matrix:
       0    1
0  42273  141
1    514  928
---- Validation: 
scalar performance:
{'acc': 0.980683, 'precision': 0.9494343, 'recall': 0.75322825, 'specificity': 0.75322825, 'f1': 0.8219919, 'auroc': 0.97558594, 'binary_precision': 0.9168901, 'binary_recall': 0.50817233, 'binary_specificity': 0.99828416, 'binary_f1_score': 0.6539197}
confusion matrix:
       0    1
0  18036   31
1    331  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.8042488, 'recall': 0.5412986, 'specificity': 0.5412986, 'f1': 0.5645147, 'auroc': 0.948668, 'binary_precision': 0.64705884, 'binary_recall': 0.08461539, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.14965987}
confusion matrix:
      0   1
0  5934  12
1   238  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_10.png
early stop counter: 1
val acc:0.9806830286979675, best validation acc: 0.9820704460144043, corresponding to test acc:                         0.9605220556259155 / 0.9738962054252625
after epoch: 10,now: 2024-06-06 15:55:06.797903,epoch time: 0:25:24.415867,used: 4:14:01.116410,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9855208, 'precision': 0.89506376, 'recall': 0.8709266, 'specificity': 0.8709266, 'f1': 0.8825841, 'auroc': 0.9857277, 'binary_precision': 0.79866767, 'binary_recall': 0.7482663, 'binary_specificity': 0.993587, 'binary_f1_score': 0.7726459}
confusion matrix:
       0     1
0  42142   272
1    363  1079
---- Validation: 
scalar performance:
{'acc': 0.98036283, 'precision': 0.87041366, 'recall': 0.83317214, 'specificity': 0.83317214, 'f1': 0.85071707, 'auroc': 0.97484845, 'binary_precision': 0.75290215, 'binary_recall': 0.67459136, 'binary_specificity': 0.9917529, 'binary_f1_score': 0.71159875}
confusion matrix:
       0    1
0  17918  149
1    219  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.84376824, 'recall': 0.5548442, 'specificity': 0.5548442, 'f1': 0.5866766, 'auroc': 0.95735824, 'binary_precision': 0.725, 'binary_recall': 0.11153846, 'binary_specificity': 0.99815, 'binary_f1_score': 0.19333334}
confusion matrix:
      0   1
0  5935  11
1   231  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_11.png
early stop counter: 2
val acc:0.9803628325462341, best validation acc: 0.9820704460144043, corresponding to test acc:                         0.9605220556259155 / 0.9738962054252625
after epoch: 11,now: 2024-06-06 16:20:33.343984,epoch time: 0:25:26.546081,used: 4:39:27.662491,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9865469, 'precision': 0.8952073, 'recall': 0.8925591, 'specificity': 0.8925591, 'f1': 0.8938784, 'auroc': 0.9861825, 'binary_precision': 0.797486, 'binary_recall': 0.7919556, 'binary_specificity': 0.99316263, 'binary_f1_score': 0.79471123}
confusion matrix:
       0     1
0  42124   290
1    300  1142
---- Validation: 
scalar performance:
{'acc': 0.98297757, 'precision': 0.9071021, 'recall': 0.8302366, 'specificity': 0.8302366, 'f1': 0.8643261, 'auroc': 0.9772518, 'binary_precision': 0.82656825, 'binary_recall': 0.66567606, 'binary_specificity': 0.99479717, 'binary_f1_score': 0.7374486}
confusion matrix:
       0    1
0  17973   94
1    225  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.8599994, 'recall': 0.6042556, 'specificity': 0.6042556, 'f1': 0.6559343, 'auroc': 0.95455086, 'binary_precision': 0.75342464, 'binary_recall': 0.21153846, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.33033034}
confusion matrix:
      0   1
0  5928  18
1   205  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_12.png
better model found
persisted
after epoch: 12,now: 2024-06-06 16:46:01.869121,epoch time: 0:25:28.525137,used: 5:04:56.187628,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9865469, 'precision': 0.9046608, 'recall': 0.8774863, 'specificity': 0.8774863, 'f1': 0.89056385, 'auroc': 0.9873961, 'binary_precision': 0.81743664, 'binary_recall': 0.760749, 'binary_specificity': 0.9942236, 'binary_f1_score': 0.78807473}
confusion matrix:
       0     1
0  42169   245
1    345  1097
---- Validation: 
scalar performance:
{'acc': 0.98249733, 'precision': 0.89980924, 'recall': 0.8307028, 'specificity': 0.8307028, 'f1': 0.861708, 'auroc': 0.9768262, 'binary_precision': 0.8119349, 'binary_recall': 0.66716194, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.7324633}
confusion matrix:
       0    1
0  17963  104
1    224  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.81903565, 'recall': 0.54330575, 'specificity': 0.54330575, 'f1': 0.5679986, 'auroc': 0.9526674, 'binary_precision': 0.6764706, 'binary_recall': 0.08846154, 'binary_specificity': 0.99815, 'binary_f1_score': 0.1564626}
confusion matrix:
      0   1
0  5935  11
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_13.png
early stop counter: 1
val acc:0.9824973344802856, best validation acc: 0.982977569103241, corresponding to test acc:                         0.9640670418739319 / 0.9738962054252625
after epoch: 13,now: 2024-06-06 17:11:26.556926,epoch time: 0:25:24.687805,used: 5:30:20.875433,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9873449, 'precision': 0.92233884, 'recall': 0.8691901, 'specificity': 0.8691901, 'f1': 0.8938438, 'auroc': 0.98976576, 'binary_precision': 0.85338646, 'binary_recall': 0.74271846, 'binary_specificity': 0.9956618, 'binary_f1_score': 0.79421586}
confusion matrix:
       0     1
0  42230   184
1    371  1071
---- Validation: 
scalar performance:
{'acc': 0.98217714, 'precision': 0.9141965, 'recall': 0.8076482, 'specificity': 0.8076482, 'f1': 0.8524215, 'auroc': 0.9774573, 'binary_precision': 0.8424242, 'binary_recall': 0.61961365, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.7140411}
confusion matrix:
       0    1
0  17989   78
1    256  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.7380605, 'recall': 0.58476156, 'specificity': 0.58476156, 'f1': 0.62073386, 'auroc': 0.96101594, 'binary_precision': 0.51111114, 'binary_recall': 0.17692308, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.26285717}
confusion matrix:
      0   1
0  5902  44
1   214  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_14.png
early stop counter: 2
val acc:0.9821771383285522, best validation acc: 0.982977569103241, corresponding to test acc:                         0.9640670418739319 / 0.9738962054252625
after epoch: 14,now: 2024-06-06 17:37:31.224360,epoch time: 0:26:04.667434,used: 5:56:25.542867,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9872993, 'precision': 0.8982648, 'recall': 0.90333164, 'specificity': 0.90333164, 'f1': 0.9007809, 'auroc': 0.9888153, 'binary_precision': 0.80287474, 'binary_recall': 0.81345356, 'binary_specificity': 0.9932098, 'binary_f1_score': 0.80812955}
confusion matrix:
       0     1
0  42126   288
1    269  1173
---- Validation: 
scalar performance:
{'acc': 0.9842583, 'precision': 0.897155, 'recall': 0.8680947, 'specificity': 0.8680947, 'f1': 0.88202405, 'auroc': 0.97880864, 'binary_precision': 0.8038585, 'binary_recall': 0.74294204, 'binary_specificity': 0.99324733, 'binary_f1_score': 0.77220076}
confusion matrix:
       0    1
0  17945  122
1    173  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.80378354, 'recall': 0.6294128, 'specificity': 0.6294128, 'f1': 0.6779517, 'auroc': 0.95812136, 'binary_precision': 0.6388889, 'binary_recall': 0.2653846, 'binary_specificity': 0.993441, 'binary_f1_score': 0.375}
confusion matrix:
      0   1
0  5907  39
1   191  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_15.png
better model found
persisted
after epoch: 15,now: 2024-06-06 18:03:02.115648,epoch time: 0:25:30.891288,used: 6:21:56.434155,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9862732, 'precision': 0.9593677, 'recall': 0.8137039, 'specificity': 0.8137039, 'f1': 0.871885, 'auroc': 0.9903707, 'binary_precision': 0.9312115, 'binary_recall': 0.6289875, 'binary_specificity': 0.99842036, 'binary_f1_score': 0.7508277}
confusion matrix:
       0    1
0  42347   67
1    535  907
---- Validation: 
scalar performance:
{'acc': 0.9827641, 'precision': 0.9495121, 'recall': 0.78577936, 'specificity': 0.78577936, 'f1': 0.84807277, 'auroc': 0.97610164, 'binary_precision': 0.9146919, 'binary_recall': 0.57355124, 'binary_specificity': 0.9980074, 'binary_f1_score': 0.7050228}
confusion matrix:
       0    1
0  18031   36
1    287  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.8381022, 'recall': 0.547236, 'specificity': 0.547236, 'f1': 0.57463604, 'auroc': 0.96198547, 'binary_precision': 0.71428573, 'binary_recall': 0.09615385, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.16949153}
confusion matrix:
      0   1
0  5936  10
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_16.png
early stop counter: 1
val acc:0.9827641248703003, best validation acc: 0.9842582941055298, corresponding to test acc:                         0.9629390835762024 / 0.9738962054252625
after epoch: 16,now: 2024-06-06 18:28:44.767101,epoch time: 0:25:42.651453,used: 6:47:39.085608,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9879606, 'precision': 0.9362102, 'recall': 0.8644842, 'specificity': 0.8644842, 'f1': 0.8968968, 'auroc': 0.9903095, 'binary_precision': 0.88146913, 'binary_recall': 0.73231626, 'binary_specificity': 0.99665207, 'binary_f1_score': 0.8000001}
confusion matrix:
       0     1
0  42272   142
1    386  1056
---- Validation: 
scalar performance:
{'acc': 0.983191, 'precision': 0.9357201, 'recall': 0.8038824, 'specificity': 0.8038824, 'f1': 0.8571438, 'auroc': 0.98047817, 'binary_precision': 0.88577586, 'binary_recall': 0.61069834, 'binary_specificity': 0.9970665, 'binary_f1_score': 0.72295505}
confusion matrix:
       0    1
0  18014   53
1    262  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.7540311, 'recall': 0.55559003, 'specificity': 0.55559003, 'f1': 0.5846983, 'auroc': 0.9474162, 'binary_precision': 0.54545456, 'binary_recall': 0.115384616, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.1904762}
confusion matrix:
      0   1
0  5921  25
1   230  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_17.png
early stop counter: 2
val acc:0.9831910133361816, best validation acc: 0.9842582941055298, corresponding to test acc:                         0.9629390835762024 / 0.9738962054252625
after epoch: 17,now: 2024-06-06 18:54:33.901322,epoch time: 0:25:49.134221,used: 7:13:28.219829,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98228294, 'precision': 0.9326066, 'recall': 0.7654176, 'specificity': 0.7654176, 'f1': 0.82763207, 'auroc': 0.98804474, 'binary_precision': 0.8808706, 'binary_recall': 0.5332871, 'binary_specificity': 0.997548, 'binary_f1_score': 0.6643629}
confusion matrix:
       0    1
0  42310  104
1    673  769
---- Validation: 
scalar performance:
{'acc': 0.97801495, 'precision': 0.90578675, 'recall': 0.74183077, 'specificity': 0.74183077, 'f1': 0.8014586, 'auroc': 0.9736023, 'binary_precision': 0.8303797, 'binary_recall': 0.48736998, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.6142322}
confusion matrix:
       0    1
0  18000   67
1    345  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697067, 'precision': 0.8624629, 'recall': 0.70466506, 'specificity': 0.70466506, 'f1': 0.7594986, 'auroc': 0.95869845, 'binary_precision': 0.75, 'binary_recall': 0.41538462, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.5346534}
confusion matrix:
      0    1
0  5910   36
1   152  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_18.png
early stop counter: 3
val acc:0.9780149459838867, best validation acc: 0.9842582941055298, corresponding to test acc:                         0.9629390835762024 / 0.9738962054252625
after epoch: 18,now: 2024-06-06 19:19:56.229323,epoch time: 0:25:22.328001,used: 7:38:50.547830,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98757297, 'precision': 0.8934211, 'recall': 0.91787606, 'specificity': 0.91787606, 'f1': 0.905249, 'auroc': 0.9907141, 'binary_precision': 0.7921824, 'binary_recall': 0.8432732, 'binary_specificity': 0.9924789, 'binary_f1_score': 0.8169298}
confusion matrix:
       0     1
0  42095   319
1    226  1216
---- Validation: 
scalar performance:
{'acc': 0.982444, 'precision': 0.8723591, 'recall': 0.8750217, 'specificity': 0.8750217, 'f1': 0.87368524, 'auroc': 0.97968256, 'binary_precision': 0.7536873, 'binary_recall': 0.75928676, 'binary_specificity': 0.99075663, 'binary_f1_score': 0.7564767}
confusion matrix:
       0    1
0  17900  167
1    162  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.77400315, 'recall': 0.66936594, 'specificity': 0.66936594, 'f1': 0.7078651, 'auroc': 0.9606888, 'binary_precision': 0.5759494, 'binary_recall': 0.35, 'binary_specificity': 0.9887319, 'binary_f1_score': 0.4354067}
confusion matrix:
      0   1
0  5879  67
1   169  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_19.png
early stop counter: 4
val acc:0.9824439883232117, best validation acc: 0.9842582941055298, corresponding to test acc:                         0.9629390835762024 / 0.9738962054252625
after epoch: 19,now: 2024-06-06 19:45:50.814622,epoch time: 0:25:54.585299,used: 8:04:45.133129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98873585, 'precision': 0.9344152, 'recall': 0.8806277, 'specificity': 0.8806277, 'f1': 0.90561306, 'auroc': 0.99192274, 'binary_precision': 0.87678856, 'binary_recall': 0.76490986, 'binary_specificity': 0.9963455, 'binary_f1_score': 0.81703705}
confusion matrix:
       0     1
0  42259   155
1    339  1103
---- Validation: 
scalar performance:
{'acc': 0.9846852, 'precision': 0.9074155, 'recall': 0.8611634, 'specificity': 0.8611634, 'f1': 0.8827777, 'auroc': 0.97969484, 'binary_precision': 0.8249158, 'binary_recall': 0.7280832, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.77348065}
confusion matrix:
       0    1
0  17963  104
1    183  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.82432795, 'recall': 0.6243163, 'specificity': 0.6243163, 'f1': 0.67554176, 'auroc': 0.9578162, 'binary_precision': 0.68041235, 'binary_recall': 0.25384617, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.36974794}
confusion matrix:
      0   1
0  5915  31
1   194  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_20.png
better model found
persisted
after epoch: 20,now: 2024-06-06 20:11:55.866988,epoch time: 0:26:05.052366,used: 8:30:50.185495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9893971, 'precision': 0.92450553, 'recall': 0.9054211, 'specificity': 0.9054211, 'f1': 0.91472673, 'auroc': 0.99222016, 'binary_precision': 0.8552727, 'binary_recall': 0.815534, 'binary_specificity': 0.99530816, 'binary_f1_score': 0.83493084}
confusion matrix:
       0     1
0  42215   199
1    266  1176
---- Validation: 
scalar performance:
{'acc': 0.9854322, 'precision': 0.9098134, 'recall': 0.8715646, 'specificity': 0.8715646, 'f1': 0.8896718, 'auroc': 0.9845399, 'binary_precision': 0.82894737, 'binary_recall': 0.7488856, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.78688526}
confusion matrix:
       0    1
0  17963  104
1    169  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.8241348, 'recall': 0.5734864, 'specificity': 0.5734864, 'f1': 0.6131483, 'auroc': 0.951643, 'binary_precision': 0.68421054, 'binary_recall': 0.15, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.2460568}
confusion matrix:
      0   1
0  5928  18
1   221  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_21.png
better model found
persisted
after epoch: 21,now: 2024-06-06 20:37:24.849158,epoch time: 0:25:28.982170,used: 8:56:19.167665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98962516, 'precision': 0.9358809, 'recall': 0.89515543, 'specificity': 0.89515543, 'f1': 0.91444457, 'auroc': 0.99272364, 'binary_precision': 0.8787414, 'binary_recall': 0.7940361, 'binary_specificity': 0.9962748, 'binary_f1_score': 0.83424413}
confusion matrix:
       0     1
0  42256   158
1    297  1145
---- Validation: 
scalar performance:
{'acc': 0.9846852, 'precision': 0.9038638, 'recall': 0.8661703, 'specificity': 0.8661703, 'f1': 0.88401395, 'auroc': 0.98108137, 'binary_precision': 0.8174342, 'binary_recall': 0.7384844, 'binary_specificity': 0.9938562, 'binary_f1_score': 0.7759563}
confusion matrix:
       0    1
0  17956  111
1    176  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.8322649, 'recall': 0.5792556, 'specificity': 0.5792556, 'f1': 0.62149143, 'auroc': 0.954916, 'binary_precision': 0.7, 'binary_recall': 0.16153847, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.2625}
confusion matrix:
      0   1
0  5928  18
1   218  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_22.png
early stop counter: 1
val acc:0.9846851825714111, best validation acc: 0.9854322075843811, corresponding to test acc:                         0.9614889025688171 / 0.9738962054252625
after epoch: 22,now: 2024-06-06 21:02:48.357193,epoch time: 0:25:23.508035,used: 9:21:42.675700,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98996717, 'precision': 0.9258467, 'recall': 0.91442454, 'specificity': 0.91442454, 'f1': 0.9200519, 'auroc': 0.99122655, 'binary_precision': 0.85734665, 'binary_recall': 0.8335645, 'binary_specificity': 0.99528456, 'binary_f1_score': 0.84528834}
confusion matrix:
       0     1
0  42214   200
1    240  1202
---- Validation: 
scalar performance:
{'acc': 0.9853255, 'precision': 0.913713, 'recall': 0.8643566, 'specificity': 0.8643566, 'f1': 0.88733566, 'auroc': 0.9826272, 'binary_precision': 0.83728814, 'binary_recall': 0.73402673, 'binary_specificity': 0.9946864, 'binary_f1_score': 0.7822645}
confusion matrix:
       0    1
0  17971   96
1    179  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.7690149, 'recall': 0.60416055, 'specificity': 0.60416055, 'f1': 0.6462205, 'auroc': 0.95286953, 'binary_precision': 0.5714286, 'binary_recall': 0.21538462, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.31284916}
confusion matrix:
      0   1
0  5904  42
1   204  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_23.png
early stop counter: 2
val acc:0.9853255152702332, best validation acc: 0.9854322075843811, corresponding to test acc:                         0.9614889025688171 / 0.9738962054252625
after epoch: 23,now: 2024-06-06 21:28:08.003601,epoch time: 0:25:19.646408,used: 9:47:02.322108,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9903776, 'precision': 0.95359874, 'recall': 0.88884544, 'specificity': 0.88884544, 'f1': 0.91855174, 'auroc': 0.9934237, 'binary_precision': 0.91463417, 'binary_recall': 0.78016645, 'binary_specificity': 0.9975244, 'binary_f1_score': 0.8420659}
confusion matrix:
       0     1
0  42309   105
1    317  1125
---- Validation: 
scalar performance:
{'acc': 0.9848986, 'precision': 0.92046654, 'recall': 0.8483993, 'specificity': 0.8483993, 'f1': 0.880775, 'auroc': 0.9775398, 'binary_precision': 0.8519856, 'binary_recall': 0.7013373, 'binary_specificity': 0.99546134, 'binary_f1_score': 0.7693562}
confusion matrix:
       0    1
0  17985   82
1    201  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.8594415, 'recall': 0.5701448, 'specificity': 0.5701448, 'f1': 0.61003274, 'auroc': 0.93831015, 'binary_precision': 0.75510204, 'binary_recall': 0.1423077, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.23948221}
confusion matrix:
      0   1
0  5934  12
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_24.png
early stop counter: 3
val acc:0.9848986268043518, best validation acc: 0.9854322075843811, corresponding to test acc:                         0.9614889025688171 / 0.9738962054252625
after epoch: 24,now: 2024-06-06 21:53:27.037313,epoch time: 0:25:19.033712,used: 10:12:21.355820,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9881658, 'precision': 0.9512855, 'recall': 0.8528669, 'specificity': 0.8528669, 'f1': 0.8956249, 'auroc': 0.9925425, 'binary_precision': 0.9124218, 'binary_recall': 0.7080444, 'binary_specificity': 0.9976894, 'binary_f1_score': 0.79734486}
confusion matrix:
       0     1
0  42316    98
1    421  1021
---- Validation: 
scalar performance:
{'acc': 0.984365, 'precision': 0.9470223, 'recall': 0.81307447, 'specificity': 0.81307447, 'f1': 0.8673471, 'auroc': 0.97629315, 'binary_precision': 0.90772533, 'binary_recall': 0.62852895, 'binary_specificity': 0.99762, 'binary_f1_score': 0.7427568}
confusion matrix:
       0    1
0  18024   43
1    250  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.87725437, 'recall': 0.5855294, 'specificity': 0.5855294, 'f1': 0.6325718, 'auroc': 0.9361243, 'binary_precision': 0.7894737, 'binary_recall': 0.17307693, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.28391168}
confusion matrix:
      0   1
0  5934  12
1   215  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_25.png
early stop counter: 4
val acc:0.9843649864196777, best validation acc: 0.9854322075843811, corresponding to test acc:                         0.9614889025688171 / 0.9738962054252625
after epoch: 25,now: 2024-06-06 22:18:35.415044,epoch time: 0:25:08.377731,used: 10:37:29.733551,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99142647, 'precision': 0.93583816, 'recall': 0.9282421, 'specificity': 0.9282421, 'f1': 0.9320042, 'auroc': 0.9935481, 'binary_precision': 0.87641245, 'binary_recall': 0.86061025, 'binary_specificity': 0.995874, 'binary_f1_score': 0.8684395}
confusion matrix:
       0     1
0  42239   175
1    201  1241
---- Validation: 
scalar performance:
{'acc': 0.98596585, 'precision': 0.9206668, 'recall': 0.8668345, 'specificity': 0.8668345, 'f1': 0.8917556, 'auroc': 0.9810097, 'binary_precision': 0.85102737, 'binary_recall': 0.7384844, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.79077166}
confusion matrix:
       0    1
0  17980   87
1    176  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692233, 'precision': 0.9032204, 'recall': 0.6639551, 'specificity': 0.6639551, 'f1': 0.7289887, 'auroc': 0.9538808, 'binary_precision': 0.83495146, 'binary_recall': 0.33076924, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.47382924}
confusion matrix:
      0   1
0  5929  17
1   174  86
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_26.png
better model found
persisted
after epoch: 26,now: 2024-06-06 22:43:50.130796,epoch time: 0:25:14.715752,used: 11:02:44.449303,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99142647, 'precision': 0.93210864, 'recall': 0.9332664, 'specificity': 0.9332664, 'f1': 0.9326867, 'auroc': 0.9948013, 'binary_precision': 0.86860305, 'binary_recall': 0.8710125, 'binary_specificity': 0.99552035, 'binary_f1_score': 0.8698061}
confusion matrix:
       0     1
0  42224   190
1    186  1256
---- Validation: 
scalar performance:
{'acc': 0.98521876, 'precision': 0.9091377, 'recall': 0.86859286, 'specificity': 0.86859286, 'f1': 0.887717, 'auroc': 0.98050404, 'binary_precision': 0.8278146, 'binary_recall': 0.74294204, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.78308535}
confusion matrix:
       0    1
0  17963  104
1    173  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.7990719, 'recall': 0.62740564, 'specificity': 0.62740564, 'f1': 0.6751513, 'auroc': 0.9501651, 'binary_precision': 0.6296296, 'binary_recall': 0.26153848, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.36956522}
confusion matrix:
      0   1
0  5906  40
1   192  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_27.png
early stop counter: 1
val acc:0.9852187633514404, best validation acc: 0.9859658479690552, corresponding to test acc:                         0.9692233204841614 / 0.9738962054252625
after epoch: 27,now: 2024-06-06 23:09:07.465350,epoch time: 0:25:17.334554,used: 11:28:01.783857,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9891235, 'precision': 0.8894603, 'recall': 0.96021175, 'specificity': 0.96021175, 'f1': 0.92163295, 'auroc': 0.9951847, 'binary_precision': 0.78134114, 'binary_recall': 0.9292649, 'binary_specificity': 0.9911586, 'binary_f1_score': 0.8489072}
confusion matrix:
       0     1
0  42039   375
1    102  1340
---- Validation: 
scalar performance:
{'acc': 0.983191, 'precision': 0.8610549, 'recall': 0.91904044, 'specificity': 0.91904044, 'f1': 0.8876769, 'auroc': 0.9843158, 'binary_precision': 0.72773534, 'binary_recall': 0.8499257, 'binary_specificity': 0.9881552, 'binary_f1_score': 0.7840987}
confusion matrix:
       0    1
0  17853  214
1    101  572
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.8495245, 'recall': 0.6135346, 'specificity': 0.6135346, 'f1': 0.66624224, 'auroc': 0.94955224, 'binary_precision': 0.73170733, 'binary_recall': 0.23076923, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.3508772}
confusion matrix:
      0   1
0  5924  22
1   200  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_28.png
early stop counter: 2
val acc:0.9831910133361816, best validation acc: 0.9859658479690552, corresponding to test acc:                         0.9692233204841614 / 0.9738962054252625
after epoch: 28,now: 2024-06-06 23:34:32.717722,epoch time: 0:25:25.252372,used: 11:53:27.036229,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9920421, 'precision': 0.96799374, 'recall': 0.9027691, 'specificity': 0.9027691, 'f1': 0.932763, 'auroc': 0.9960217, 'binary_precision': 0.9425101, 'binary_recall': 0.80721223, 'binary_specificity': 0.998326, 'binary_f1_score': 0.8696302}
confusion matrix:
       0     1
0  42343    71
1    278  1164
---- Validation: 
scalar performance:
{'acc': 0.98537886, 'precision': 0.9294609, 'recall': 0.84650254, 'specificity': 0.84650254, 'f1': 0.8831863, 'auroc': 0.9852672, 'binary_precision': 0.8701299, 'binary_recall': 0.6968796, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.77392745}
confusion matrix:
       0    1
0  17997   70
1    204  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.9229444, 'recall': 0.6108657, 'specificity': 0.6108657, 'f1': 0.6692264, 'auroc': 0.9612412, 'binary_precision': 0.8787879, 'binary_recall': 0.22307692, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.3558282}
confusion matrix:
      0   1
0  5938   8
1   202  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_29.png
early stop counter: 3
val acc:0.9853788614273071, best validation acc: 0.9859658479690552, corresponding to test acc:                         0.9692233204841614 / 0.9738962054252625
after epoch: 29,now: 2024-06-06 23:59:56.670413,epoch time: 0:25:23.952691,used: 12:18:50.988920,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9915177, 'precision': 0.9462688, 'recall': 0.9169009, 'specificity': 0.9169009, 'f1': 0.93104744, 'auroc': 0.99523914, 'binary_precision': 0.89806545, 'binary_recall': 0.8370319, 'binary_specificity': 0.9967699, 'binary_f1_score': 0.86647516}
confusion matrix:
       0     1
0  42277   137
1    235  1207
---- Validation: 
scalar performance:
{'acc': 0.9816969, 'precision': 0.8895696, 'recall': 0.82957244, 'specificity': 0.82957244, 'f1': 0.8568498, 'auroc': 0.97973335, 'binary_precision': 0.79151946, 'binary_recall': 0.66567606, 'binary_specificity': 0.99346876, 'binary_f1_score': 0.7231639}
confusion matrix:
       0    1
0  17949  118
1    225  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.84778935, 'recall': 0.61161155, 'specificity': 0.61161155, 'f1': 0.6637835, 'auroc': 0.9491627, 'binary_precision': 0.72839504, 'binary_recall': 0.22692308, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.34604105}
confusion matrix:
      0   1
0  5924  22
1   201  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127987_30.png
early stop counter: 4
val acc:0.9816969037055969, best validation acc: 0.9859658479690552, corresponding to test acc:                         0.9692233204841614 / 0.9738962054252625
after epoch: 30,now: 2024-06-07 00:25:22.356432,epoch time: 0:25:25.686019,used: 12:44:16.674939,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_11_41_05_seed_1_21127987
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:44:16.674939 at 2024-06-07 00:25:22.356432
persisted model performance metric: 

scalar performance:
{'acc': 0.970029, 'precision': 0.90440226, 'recall': 0.67540944, 'specificity': 0.67540944, 'f1': 0.74092567, 'auroc': 0.9493808, 'binary_precision': 0.8363636, 'binary_recall': 0.35384616, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.49729732}
confusion matrix:
      0   1
0  5928  18
1   168  92
oracle model performance metric: 

scalar performance:
{'acc': 0.9751853, 'precision': 0.9228928, 'recall': 0.73878694, 'specificity': 0.73878694, 'f1': 0.80299354, 'auroc': 0.95344543, 'binary_precision': 0.8680556, 'binary_recall': 0.48076922, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.6188119}
confusion matrix:
      0    1
0  5927   19
1   135  125
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456207 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456207 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |  41675 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  13213 MiB |   2244 TiB |   2244 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   2217 TiB |   2217 TiB |
|       from small pool |  40676 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14484 MiB |  28076 MiB |  13602 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  27992 MiB |  13584 MiB |
|       from small pool |     66 MiB |     70 MiB |     84 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446961 KiB |   1251 MiB |   1605 TiB |   1605 TiB |
|       from large pool | 435388 KiB |   1244 MiB |   1578 TiB |   1578 TiB |
|       from small pool |  11572 KiB |     43 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    6487    |  395834 K  |  395831 K  |
|       from large pool |     187    |    1413    |  205461 K  |  205461 K  |
|       from small pool |    3277    |    6298    |  190373 K  |  190369 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    6487    |  395834 K  |  395831 K  |
|       from large pool |     187    |    1413    |  205461 K  |  205461 K  |
|       from small pool |    3277    |    6298    |  190373 K  |  190369 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    1207    |     573    |
|       from large pool |     601    |     601    |    1165    |     564    |
|       from small pool |      33    |      35    |      42    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      83    |    2810    |  249526 K  |  249526 K  |
|       from large pool |      40    |     604    |  149049 K  |  149049 K  |
|       from small pool |      43    |    2768    |  100477 K  |  100477 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2244 TiB |   2244 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2217 TiB |   2217 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  28076 MiB |  27194 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     70 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1605 TiB |   1605 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   1578 TiB |   1578 TiB |
|       from small pool |      0 KiB |     43 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395834 K  |  395834 K  |
|       from large pool |       2    |    1413    |  205461 K  |  205461 K  |
|       from small pool |       0    |    6298    |  190373 K  |  190373 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395834 K  |  395834 K  |
|       from large pool |       2    |    1413    |  205461 K  |  205461 K  |
|       from small pool |       0    |    6298    |  190373 K  |  190373 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1207    |    1144    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      35    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2810    |  249527 K  |  249527 K  |
|       from large pool |       4    |     604    |  149049 K  |  149049 K  |
|       from small pool |       0    |    2768    |  100478 K  |  100478 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2252 TiB |   2252 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2225 TiB |   2225 TiB |
|       from small pool |      0 KiB |     61 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2244 TiB |   2244 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2217 TiB |   2217 TiB |
|       from small pool |      0 KiB |     60 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  28076 MiB |  27194 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     70 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1605 TiB |   1605 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   1578 TiB |   1578 TiB |
|       from small pool |      0 KiB |     43 MiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6487    |  395834 K  |  395834 K  |
|       from large pool |       2    |    1413    |  205461 K  |  205461 K  |
|       from small pool |       0    |    6298    |  190373 K  |  190373 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6487    |  395834 K  |  395834 K  |
|       from large pool |       2    |    1413    |  205461 K  |  205461 K  |
|       from small pool |       0    |    6298    |  190373 K  |  190373 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1207    |    1144    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      35    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2810    |  249527 K  |  249527 K  |
|       from large pool |       4    |     604    |  149049 K  |  149049 K  |
|       from small pool |       0    |    2768    |  100478 K  |  100478 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


patient_073_node_1_0:   0%|          | 0/95 [00:00<?, ?it/s][A
patient_073_node_1_0:  11%|         | 10/95 [00:00<00:00, 99.83it/s][A
patient_073_node_1_0:  23%|       | 22/95 [00:00<00:00, 93.34it/s][A
patient_073_node_1_0:  34%|      | 32/95 [00:00<00:00, 86.84it/s][A
                                                                     [A[Fri Jun  7 00:28:33 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/1.csv

RuleException:
FileNotFoundError in file /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk, line 161:
[Errno 2] No such file or directory: '/ictstr01/groups/aih/sina.wendrich/MA_code/output_CAMELYON17/patches/8/128/patient_073_node_1/patient_073_node_1_patch_0_2944_9600_/lustre/groups/shared/histology_data/CAMELYON17/slides/center3_0.png'
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/benchmark.smk", line 161, in __rule_run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp_protocol/run_experiment.py", line 168, in run_experiment
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/exp/exp_main.py", line 30, in __init__
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/tasks/zoo_tasks.py", line 36, in __call__
  File "/lustre/groups/aih/sina.wendrich/MA_code/MA_thesis/tasks/task_CAMELYON17.py", line 151, in get_task
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/tasks/patches_processing.py", line 424, in process_slides
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/_base.py", line 451, in result
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
  File "/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/tasks/patches_processing.py", line 463, in process_row_annotations
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/PIL/Image.py", line 2456, in save
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/concurrent/futures/thread.py", line 58, in run
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
