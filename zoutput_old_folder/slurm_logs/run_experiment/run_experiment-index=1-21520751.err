Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jun 21 11:04:54 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751

 Experiment start at: 2024-06-21 11:23:15.184432
before training, model accuracy: 0.3101629912853241
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9055008, 'precision': 0.4527504, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47520357, 'auroc': 0.7818831, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42305  0
1   4415  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.3920583, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.36792707, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 11:39:43.279052,epoch time: 0:16:28.094620,used: 0:16:28.094620,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.91213614, 'precision': 0.9296981, 'recall': 0.53661865, 'specificity': 0.53661865, 'f1': 0.5452054, 'auroc': 0.9182125, 'binary_precision': 0.94752187, 'binary_recall': 0.073662736, 'binary_specificity': 0.99957454, 'binary_f1_score': 0.13669822}
confusion matrix:
       0    1
0  42290   18
1   4087  325
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.505412, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.5515831, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-21 11:54:13.479648,epoch time: 0:14:30.200596,used: 0:30:58.295216,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9411387, 'precision': 0.95839906, 'recall': 0.6924799, 'specificity': 0.6924799, 'f1': 0.7608875, 'auroc': 0.9454851, 'binary_precision': 0.9770511, 'binary_recall': 0.38590527, 'binary_specificity': 0.99905455, 'binary_f1_score': 0.55328137}
confusion matrix:
       0     1
0  42267    40
1   2710  1703
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.6495822, 'recall': 0.5007225, 'specificity': 0.5007225, 'f1': 0.4928307, 'auroc': 0.5929439, 'binary_precision': 0.33333334, 'binary_recall': 0.00155521, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.0030959754}
confusion matrix:
       0  1
0  18147  2
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.4791267, 'recall': 0.49949974, 'specificity': 0.49949974, 'f1': 0.48910117, 'auroc': 0.6630397, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5991  6
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_3.png
early stop counter: 2
val acc:0.9657300710678101, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-21 12:09:25.196379,epoch time: 0:15:11.716731,used: 0:46:10.011947,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9599315, 'precision': 0.9731804, 'recall': 0.79104537, 'specificity': 0.79104537, 'f1': 0.85576034, 'auroc': 0.9641839, 'binary_precision': 0.9880907, 'binary_recall': 0.58282346, 'binary_specificity': 0.9992673, 'binary_f1_score': 0.7331813}
confusion matrix:
       0     1
0  42276    31
1   1841  2572
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.73304045, 'recall': 0.5045003, 'specificity': 0.5045003, 'f1': 0.50045437, 'auroc': 0.61423427, 'binary_precision': 0.5, 'binary_recall': 0.00933126, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.01832061}
confusion matrix:
       0  1
0  18143  6
1    637  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.6795771, 'recall': 0.5107439, 'specificity': 0.5107439, 'f1': 0.5109548, 'auroc': 0.6811535, 'binary_precision': 0.4, 'binary_recall': 0.022988506, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.04347826}
confusion matrix:
      0  1
0  5988  9
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_4.png
early stop counter: 3
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-21 12:23:20.704762,epoch time: 0:13:55.508383,used: 1:00:05.520330,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9635702, 'precision': 0.96246994, 'recall': 0.81872976, 'specificity': 0.81872976, 'f1': 0.874364, 'auroc': 0.9696207, 'binary_precision': 0.9612113, 'binary_recall': 0.64015406, 'binary_specificity': 0.9973054, 'binary_f1_score': 0.7684984}
confusion matrix:
       0     1
0  42193   114
1   1588  2825
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.7611698, 'recall': 0.51511127, 'specificity': 0.51511127, 'f1': 0.52079767, 'auroc': 0.65237, 'binary_precision': 0.5555556, 'binary_recall': 0.0311042, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.05891016}
confusion matrix:
       0   1
0  18133  16
1    623  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.68000966, 'recall': 0.5214878, 'specificity': 0.5214878, 'f1': 0.5303168, 'auroc': 0.7127178, 'binary_precision': 0.4, 'binary_recall': 0.04597701, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.082474224}
confusion matrix:
      0   1
0  5979  18
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_5.png
better model found
persisted
after epoch: 5,now: 2024-06-21 12:37:17.996476,epoch time: 0:13:57.291714,used: 1:14:02.812044,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9705265, 'precision': 0.9656576, 'recall': 0.8573475, 'specificity': 0.8573475, 'f1': 0.9026809, 'auroc': 0.9778932, 'binary_precision': 0.9599879, 'binary_recall': 0.71781504, 'binary_specificity': 0.99688, 'binary_f1_score': 0.82142395}
confusion matrix:
       0     1
0  42176   132
1   1245  3167
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.72492504, 'recall': 0.5388927, 'specificity': 0.5388927, 'f1': 0.56045806, 'auroc': 0.71458346, 'binary_precision': 0.4814815, 'binary_recall': 0.08087092, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.13848203}
confusion matrix:
       0   1
0  18093  56
1    591  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.7477301, 'recall': 0.56080055, 'specificity': 0.56080055, 'f1': 0.5916283, 'auroc': 0.76254153, 'binary_precision': 0.5322581, 'binary_recall': 0.12643678, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.20433438}
confusion matrix:
      0   1
0  5968  29
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_6.png
new oracle model saved
early stop counter: 1
val acc:0.9655704498291016, best validation acc: 0.9659961462020874, corresponding to test acc:                         0.9573346376419067 / 0.9589325785636902
after epoch: 6,now: 2024-06-21 12:51:45.115494,epoch time: 0:14:27.119018,used: 1:28:29.931062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97386557, 'precision': 0.96955156, 'recall': 0.8740397, 'specificity': 0.8740397, 'f1': 0.91508657, 'auroc': 0.98087823, 'binary_precision': 0.9644936, 'binary_recall': 0.7509631, 'binary_specificity': 0.9971163, 'binary_f1_score': 0.84443873}
confusion matrix:
       0     1
0  42185   122
1   1099  3314
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.7550946, 'recall': 0.55505705, 'specificity': 0.55505705, 'f1': 0.5852448, 'auroc': 0.7112441, 'binary_precision': 0.5407407, 'binary_recall': 0.11353032, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.18766066}
confusion matrix:
       0   1
0  18087  62
1    570  73
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.7871803, 'recall': 0.5614675, 'specificity': 0.5614675, 'f1': 0.5945578, 'auroc': 0.75994766, 'binary_precision': 0.6111111, 'binary_recall': 0.12643678, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.20952383}
confusion matrix:
      0   1
0  5976  21
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-21 13:08:17.297935,epoch time: 0:16:32.182441,used: 1:45:02.113503,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9769478, 'precision': 0.976282, 'recall': 0.88675255, 'specificity': 0.88675255, 'f1': 0.92575336, 'auroc': 0.97976184, 'binary_precision': 0.97549856, 'binary_recall': 0.77553797, 'binary_specificity': 0.9979671, 'binary_f1_score': 0.864101}
confusion matrix:
       0     1
0  42219    86
1    991  3424
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.74700904, 'recall': 0.556447, 'specificity': 0.556447, 'f1': 0.5867781, 'auroc': 0.7228501, 'binary_precision': 0.5244755, 'binary_recall': 0.11664075, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.1908397}
confusion matrix:
       0   1
0  18081  68
1    568  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7418629, 'recall': 0.5735435, 'specificity': 0.5735435, 'f1': 0.6077503, 'auroc': 0.77188146, 'binary_precision': 0.5194805, 'binary_recall': 0.1532567, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.23668638}
confusion matrix:
      0   1
0  5960  37
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_8.png
early stop counter: 1
val acc:0.9661558270454407, best validation acc: 0.9663686752319336, corresponding to test acc:                         0.960210919380188 / 0.960210919380188
after epoch: 8,now: 2024-06-21 13:26:26.412272,epoch time: 0:18:09.114337,used: 2:03:11.227840,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97880995, 'precision': 0.9811394, 'recall': 0.89361596, 'specificity': 0.89361596, 'f1': 0.9319457, 'auroc': 0.98283434, 'binary_precision': 0.98388463, 'binary_recall': 0.7885792, 'binary_specificity': 0.9986527, 'binary_f1_score': 0.8754717}
confusion matrix:
       0     1
0  42250    57
1    933  3480
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.77051544, 'recall': 0.58022213, 'specificity': 0.58022213, 'f1': 0.6194715, 'auroc': 0.7084703, 'binary_precision': 0.56989247, 'binary_recall': 0.16485226, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.2557298}
confusion matrix:
       0    1
0  18069   80
1    537  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.8183398, 'recall': 0.5806246, 'specificity': 0.5806246, 'f1': 0.6225054, 'auroc': 0.7596935, 'binary_precision': 0.671875, 'binary_recall': 0.16475096, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.26461542}
confusion matrix:
      0   1
0  5976  21
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_9.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-06-21 13:44:29.553205,epoch time: 0:18:03.140933,used: 2:21:14.368773,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9805437, 'precision': 0.9775615, 'recall': 0.9067304, 'specificity': 0.9067304, 'f1': 0.93861115, 'auroc': 0.9859919, 'binary_precision': 0.97401893, 'binary_recall': 0.81572986, 'binary_specificity': 0.9977309, 'binary_f1_score': 0.8878747}
confusion matrix:
       0     1
0  42212    96
1    813  3599
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.74866235, 'recall': 0.6046158, 'specificity': 0.6046158, 'f1': 0.644495, 'auroc': 0.7755697, 'binary_precision': 0.5245283, 'binary_recall': 0.21617419, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.30616742}
confusion matrix:
       0    1
0  18023  126
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.7827753, 'recall': 0.61343986, 'specificity': 0.61343986, 'f1': 0.65812886, 'auroc': 0.80037653, 'binary_precision': 0.5980392, 'binary_recall': 0.23371647, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.33608812}
confusion matrix:
      0   1
0  5956  41
1   200  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_10.png
early stop counter: 1
val acc:0.9664750695228577, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9618088603019714 / 0.9618088603019714
after epoch: 10,now: 2024-06-21 14:02:25.999855,epoch time: 0:17:56.446650,used: 2:39:10.815423,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98065066, 'precision': 0.9754392, 'recall': 0.9092257, 'specificity': 0.9092257, 'f1': 0.93924034, 'auroc': 0.988044, 'binary_precision': 0.9692349, 'binary_recall': 0.82116956, 'binary_specificity': 0.99728185, 'binary_f1_score': 0.88907975}
confusion matrix:
       0     1
0  42193   115
1    789  3623
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.75757, 'recall': 0.6123919, 'specificity': 0.6123919, 'f1': 0.65385467, 'auroc': 0.778425, 'binary_precision': 0.5418182, 'binary_recall': 0.23172629, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.32461873}
confusion matrix:
       0    1
0  18023  126
1    494  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.81190187, 'recall': 0.63476276, 'specificity': 0.63476276, 'f1': 0.6847247, 'auroc': 0.8090118, 'binary_precision': 0.6545454, 'binary_recall': 0.27586207, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.38814014}
confusion matrix:
      0   1
0  5959  38
1   189  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_11.png
new oracle model saved
early stop counter: 2
val acc:0.9670072197914124, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9618088603019714 / 0.9637264013290405
after epoch: 11,now: 2024-06-21 14:21:02.477936,epoch time: 0:18:36.478081,used: 2:57:47.293504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98238444, 'precision': 0.976804, 'recall': 0.91830367, 'specificity': 0.91830367, 'f1': 0.9451647, 'auroc': 0.98897964, 'binary_precision': 0.9701336, 'binary_recall': 0.8393019, 'binary_specificity': 0.99730545, 'binary_f1_score': 0.8999878}
confusion matrix:
       0     1
0  42194   114
1    709  3703
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.75329506, 'recall': 0.6077538, 'specificity': 0.6077538, 'f1': 0.6484491, 'auroc': 0.7658336, 'binary_precision': 0.5335821, 'binary_recall': 0.22239502, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.31394073}
confusion matrix:
       0    1
0  18024  125
1    500  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8136451, 'recall': 0.616106, 'specificity': 0.616106, 'f1': 0.6651503, 'auroc': 0.80591893, 'binary_precision': 0.65957445, 'binary_recall': 0.23754789, 'binary_specificity': 0.994664, 'binary_f1_score': 0.3492958}
confusion matrix:
      0   1
0  5965  32
1   199  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_12.png
early stop counter: 3
val acc:0.966741144657135, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9618088603019714 / 0.9637264013290405
after epoch: 12,now: 2024-06-21 14:39:17.505354,epoch time: 0:18:15.027418,used: 3:16:02.320922,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9812286, 'precision': 0.9763204, 'recall': 0.91191876, 'specificity': 0.91191876, 'f1': 0.941205, 'auroc': 0.98663646, 'binary_precision': 0.97047085, 'binary_recall': 0.82646126, 'binary_specificity': 0.99737626, 'binary_f1_score': 0.8926954}
confusion matrix:
       0     1
0  42195   111
1    766  3648
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.75057614, 'recall': 0.60542095, 'specificity': 0.60542095, 'f1': 0.64562356, 'auroc': 0.7628768, 'binary_precision': 0.5283019, 'binary_recall': 0.21772939, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.30837002}
confusion matrix:
       0    1
0  18024  125
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.79772484, 'recall': 0.6194371, 'specificity': 0.6194371, 'f1': 0.66664016, 'auroc': 0.794601, 'binary_precision': 0.627451, 'binary_recall': 0.24521072, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.35261708}
confusion matrix:
      0   1
0  5959  38
1   197  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_13.png
early stop counter: 4
val acc:0.9665815234184265, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9618088603019714 / 0.9637264013290405
after epoch: 13,now: 2024-06-21 14:58:10.891791,epoch time: 0:18:53.386437,used: 3:34:55.707359,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9823416, 'precision': 0.9768742, 'recall': 0.9179207, 'specificity': 0.9179207, 'f1': 0.944971, 'auroc': 0.9863498, 'binary_precision': 0.9703412, 'binary_recall': 0.8385121, 'binary_specificity': 0.9973293, 'binary_f1_score': 0.8996228}
confusion matrix:
       0     1
0  42198   113
1    712  3697
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.7585702, 'recall': 0.62372535, 'specificity': 0.62372535, 'f1': 0.665125, 'auroc': 0.7696825, 'binary_precision': 0.54304636, 'binary_recall': 0.25505444, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.34708995}
confusion matrix:
       0    1
0  18011  138
1    479  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.8105984, 'recall': 0.63659513, 'specificity': 0.63659513, 'f1': 0.6863635, 'auroc': 0.80109084, 'binary_precision': 0.65178573, 'binary_recall': 0.27969348, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.39142093}
confusion matrix:
      0   1
0  5958  39
1   188  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_14.png
early stop counter: 5
val acc:0.9671669006347656, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9618088603019714 / 0.9637264013290405
after epoch: 14,now: 2024-06-21 15:13:50.687250,epoch time: 0:15:39.795459,used: 3:50:35.502818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9833262, 'precision': 0.9762825, 'recall': 0.92445695, 'specificity': 0.92445695, 'f1': 0.948503, 'auroc': 0.98895586, 'binary_precision': 0.9678332, 'binary_recall': 0.8518686, 'binary_specificity': 0.9970453, 'binary_f1_score': 0.9061558}
confusion matrix:
       0     1
0  42180   125
1    654  3761
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.74593294, 'recall': 0.6180617, 'specificity': 0.6180617, 'f1': 0.657337, 'auroc': 0.7643148, 'binary_precision': 0.5181518, 'binary_recall': 0.24416797, 'binary_specificity': 0.99195546, 'binary_f1_score': 0.33192387}
confusion matrix:
       0    1
0  18003  146
1    486  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.7870066, 'recall': 0.62843204, 'specificity': 0.62843204, 'f1': 0.6742397, 'auroc': 0.77776647, 'binary_precision': 0.6052632, 'binary_recall': 0.26436782, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.36800003}
confusion matrix:
      0   1
0  5952  45
1   192  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_15.png
early stop counter: 6
val acc:0.9663686752319336, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9618088603019714 / 0.9637264013290405
after epoch: 15,now: 2024-06-21 15:29:03.932490,epoch time: 0:15:13.245240,used: 4:05:48.748058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9840325, 'precision': 0.9793071, 'recall': 0.92581177, 'specificity': 0.92581177, 'f1': 0.9505825, 'auroc': 0.9912001, 'binary_precision': 0.9736434, 'binary_recall': 0.8540344, 'binary_specificity': 0.9975891, 'binary_f1_score': 0.90992516}
confusion matrix:
       0     1
0  42206   102
1    644  3768
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.75055134, 'recall': 0.61519927, 'specificity': 0.61519927, 'f1': 0.6554335, 'auroc': 0.7767811, 'binary_precision': 0.5275862, 'binary_recall': 0.23794712, 'binary_specificity': 0.99245137, 'binary_f1_score': 0.32797426}
confusion matrix:
       0    1
0  18012  137
1    490  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.8242618, 'recall': 0.6350963, 'specificity': 0.6350963, 'f1': 0.6870076, 'auroc': 0.79059756, 'binary_precision': 0.6792453, 'binary_recall': 0.27586207, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.39237058}
confusion matrix:
      0   1
0  5963  34
1   189  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_16.png
new oracle model saved
early stop counter: 7
val acc:0.9666347503662109, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9618088603019714 / 0.9643656015396118
after epoch: 16,now: 2024-06-21 15:53:23.477490,epoch time: 0:24:19.545000,used: 4:30:08.293058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98306936, 'precision': 0.977949, 'recall': 0.921251, 'specificity': 0.921251, 'f1': 0.9473662, 'auroc': 0.986842, 'binary_precision': 0.97182363, 'binary_recall': 0.84505445, 'binary_specificity': 0.99744755, 'binary_f1_score': 0.9040165}
confusion matrix:
       0     1
0  42204   108
1    683  3725
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.75349367, 'recall': 0.6137818, 'specificity': 0.6137818, 'f1': 0.65455586, 'auroc': 0.78134656, 'binary_precision': 0.5335689, 'binary_recall': 0.2348367, 'binary_specificity': 0.99272686, 'binary_f1_score': 0.32613394}
confusion matrix:
       0    1
0  18017  132
1    492  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8185891, 'recall': 0.6499217, 'specificity': 0.6499217, 'f1': 0.7008679, 'auroc': 0.80796015, 'binary_precision': 0.6666667, 'binary_recall': 0.3065134, 'binary_specificity': 0.99333, 'binary_f1_score': 0.41994753}
confusion matrix:
      0   1
0  5957  40
1   181  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_17.png
new oracle model saved
early stop counter: 8
val acc:0.9667943716049194, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9618088603019714 / 0.9646852016448975
after epoch: 17,now: 2024-06-21 16:11:40.268718,epoch time: 0:18:16.791228,used: 4:48:25.084286,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9836258, 'precision': 0.97245514, 'recall': 0.92988145, 'specificity': 0.92988145, 'f1': 0.9499073, 'auroc': 0.98924136, 'binary_precision': 0.95899373, 'binary_recall': 0.86361575, 'binary_specificity': 0.9961471, 'binary_f1_score': 0.9088092}
confusion matrix:
       0     1
0  42143   163
1    602  3812
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.732872, 'recall': 0.6378173, 'specificity': 0.6378173, 'f1': 0.67185855, 'auroc': 0.7942705, 'binary_precision': 0.49066666, 'binary_recall': 0.28615862, 'binary_specificity': 0.989476, 'binary_f1_score': 0.3614931}
confusion matrix:
       0    1
0  17958  191
1    459  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.79060936, 'recall': 0.65458494, 'specificity': 0.65458494, 'f1': 0.6995375, 'auroc': 0.8194097, 'binary_precision': 0.6102941, 'binary_recall': 0.31800765, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.418136}
confusion matrix:
      0   1
0  5944  53
1   178  83
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_18.png
early stop counter: 9
val acc:0.9654108285903931, best validation acc: 0.9671669006347656, corresponding to test acc:                         0.9618088603019714 / 0.9646852016448975
after epoch: 18,now: 2024-06-21 16:28:46.252111,epoch time: 0:17:05.983393,used: 5:05:31.067679,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9847603, 'precision': 0.9807032, 'recall': 0.9288845, 'specificity': 0.9288845, 'f1': 0.95294756, 'auroc': 0.9901478, 'binary_precision': 0.9758355, 'binary_recall': 0.85999095, 'binary_specificity': 0.9977781, 'binary_f1_score': 0.9142582}
confusion matrix:
       0     1
0  42212    94
1    618  3796
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.7645298, 'recall': 0.6088069, 'specificity': 0.6088069, 'f1': 0.651276, 'auroc': 0.7942349, 'binary_precision': 0.55598456, 'binary_recall': 0.22395024, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.3192905}
confusion matrix:
       0    1
0  18034  115
1    499  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8226408, 'recall': 0.62943256, 'specificity': 0.62943256, 'f1': 0.6808257, 'auroc': 0.8138217, 'binary_precision': 0.6764706, 'binary_recall': 0.26436782, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.38016528}
confusion matrix:
      0   1
0  5964  33
1   192  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_19.png
better model found
persisted
after epoch: 19,now: 2024-06-21 16:43:57.337694,epoch time: 0:15:11.085583,used: 5:20:42.153262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9849743, 'precision': 0.97875494, 'recall': 0.9318846, 'specificity': 0.9318846, 'f1': 0.95380914, 'auroc': 0.99234277, 'binary_precision': 0.97127604, 'binary_recall': 0.86643994, 'binary_specificity': 0.99732924, 'binary_f1_score': 0.91586775}
confusion matrix:
       0     1
0  42197   113
1    589  3821
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.7469594, 'recall': 0.61508906, 'specificity': 0.61508906, 'f1': 0.6546779, 'auroc': 0.78035015, 'binary_precision': 0.52040815, 'binary_recall': 0.23794712, 'binary_specificity': 0.99223095, 'binary_f1_score': 0.32657418}
confusion matrix:
       0    1
0  18008  141
1    490  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.8169177, 'recall': 0.64425796, 'specificity': 0.64425796, 'f1': 0.69505876, 'auroc': 0.8078656, 'binary_precision': 0.6637931, 'binary_recall': 0.29501915, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.40848807}
confusion matrix:
      0   1
0  5958  39
1   184  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_20.png
early stop counter: 1
val acc:0.966421902179718, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9640460014343262 / 0.9646852016448975
after epoch: 20,now: 2024-06-21 17:01:43.851769,epoch time: 0:17:46.514075,used: 5:38:28.667337,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98572344, 'precision': 0.97478974, 'recall': 0.9402592, 'specificity': 0.9402592, 'f1': 0.95670545, 'auroc': 0.99203116, 'binary_precision': 0.9615574, 'binary_recall': 0.88420576, 'binary_specificity': 0.9963127, 'binary_f1_score': 0.9212608}
confusion matrix:
       0     1
0  42151   156
1    511  3902
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.7424111, 'recall': 0.63295263, 'specificity': 0.63295263, 'f1': 0.67009795, 'auroc': 0.7862699, 'binary_precision': 0.5100865, 'binary_recall': 0.27527216, 'binary_specificity': 0.9906331, 'binary_f1_score': 0.35757577}
confusion matrix:
       0    1
0  17979  170
1    466  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.7923039, 'recall': 0.6341792, 'specificity': 0.6341792, 'f1': 0.68083704, 'auroc': 0.7976134, 'binary_precision': 0.61538464, 'binary_recall': 0.27586207, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.38095242}
confusion matrix:
      0   1
0  5952  45
1   189  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_21.png
early stop counter: 2
val acc:0.9661558270454407, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9640460014343262 / 0.9646852016448975
after epoch: 21,now: 2024-06-21 17:18:49.193719,epoch time: 0:17:05.341950,used: 5:55:34.009287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9865582, 'precision': 0.9761321, 'recall': 0.9439553, 'specificity': 0.9439553, 'f1': 0.9593363, 'auroc': 0.9913264, 'binary_precision': 0.9634983, 'binary_recall': 0.89143246, 'binary_specificity': 0.9964782, 'binary_f1_score': 0.92606544}
confusion matrix:
       0     1
0  42159   149
1    479  3933
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.7331223, 'recall': 0.6415676, 'specificity': 0.6415676, 'f1': 0.6749617, 'auroc': 0.7903296, 'binary_precision': 0.4909091, 'binary_recall': 0.29393467, 'binary_specificity': 0.98920053, 'binary_f1_score': 0.36770424}
confusion matrix:
       0    1
0  17953  196
1    454  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.82424366, 'recall': 0.6500884, 'specificity': 0.6500884, 'f1': 0.70205975, 'auroc': 0.8064871, 'binary_precision': 0.6779661, 'binary_recall': 0.3065134, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.42216355}
confusion matrix:
      0   1
0  5959  38
1   181  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_22.png
new oracle model saved
early stop counter: 3
val acc:0.9654108285903931, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9640460014343262 / 0.9650048017501831
after epoch: 22,now: 2024-06-21 17:34:38.659075,epoch time: 0:15:49.465356,used: 6:11:23.474643,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9855308, 'precision': 0.975157, 'recall': 0.9387321, 'specificity': 0.9387321, 'f1': 0.95603245, 'auroc': 0.99022603, 'binary_precision': 0.96261454, 'binary_recall': 0.8810333, 'binary_specificity': 0.9964309, 'binary_f1_score': 0.920019}
confusion matrix:
       0     1
0  42156   151
1    525  3888
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.73573804, 'recall': 0.64242786, 'specificity': 0.64242786, 'f1': 0.6763499, 'auroc': 0.79275143, 'binary_precision': 0.49608356, 'binary_recall': 0.29548988, 'binary_specificity': 0.9893658, 'binary_f1_score': 0.3703704}
confusion matrix:
       0    1
0  17956  193
1    453  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.796181, 'recall': 0.647339, 'specificity': 0.647339, 'f1': 0.694126, 'auroc': 0.8167174, 'binary_precision': 0.62204725, 'binary_recall': 0.30268198, 'binary_specificity': 0.991996, 'binary_f1_score': 0.4072165}
confusion matrix:
      0   1
0  5949  48
1   182  79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_23.png
early stop counter: 4
val acc:0.965623676776886, best validation acc: 0.9673265218734741, corresponding to test acc:                         0.9640460014343262 / 0.9650048017501831
after epoch: 23,now: 2024-06-21 17:47:39.191998,epoch time: 0:13:00.532923,used: 6:24:24.007566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9857877, 'precision': 0.97901976, 'recall': 0.93653977, 'specificity': 0.93653977, 'f1': 0.95654416, 'auroc': 0.9927053, 'binary_precision': 0.9708616, 'binary_recall': 0.8758214, 'binary_specificity': 0.9972581, 'binary_f1_score': 0.9208959}
confusion matrix:
       0     1
0  42191   116
1    548  3865
---- Validation: 
scalar performance:
{'acc': 0.967699, 'precision': 0.77010584, 'recall': 0.61575025, 'specificity': 0.61575025, 'f1': 0.65930307, 'auroc': 0.7801477, 'binary_precision': 0.56666666, 'binary_recall': 0.23794712, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.33515882}
confusion matrix:
       0    1
0  18032  117
1    490  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.8283128, 'recall': 0.61643946, 'specificity': 0.61643946, 'f1': 0.6673081, 'auroc': 0.806522, 'binary_precision': 0.6888889, 'binary_recall': 0.23754789, 'binary_specificity': 0.995331, 'binary_f1_score': 0.35327634}
confusion matrix:
      0   1
0  5969  28
1   199  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_24.png
better model found
persisted
after epoch: 24,now: 2024-06-21 18:04:36.026968,epoch time: 0:16:56.834970,used: 6:41:20.842536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98660105, 'precision': 0.9703516, 'recall': 0.95020306, 'specificity': 0.95020306, 'f1': 0.95999897, 'auroc': 0.9934093, 'binary_precision': 0.95053506, 'binary_recall': 0.9053228, 'binary_specificity': 0.99508333, 'binary_f1_score': 0.9273782}
confusion matrix:
       0     1
0  42097   208
1    418  3997
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.73546875, 'recall': 0.6611241, 'specificity': 0.6611241, 'f1': 0.69056815, 'auroc': 0.8200958, 'binary_precision': 0.49425286, 'binary_recall': 0.33437014, 'binary_specificity': 0.98787814, 'binary_f1_score': 0.39888683}
confusion matrix:
       0    1
0  17929  220
1    428  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.7949617, 'recall': 0.66591245, 'specificity': 0.66591245, 'f1': 0.7103815, 'auroc': 0.8337029, 'binary_precision': 0.6180556, 'binary_recall': 0.34099618, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.4395062}
confusion matrix:
      0   1
0  5942  55
1   172  89
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_25.png
early stop counter: 1
val acc:0.9655172228813171, best validation acc: 0.9676989912986755, corresponding to test acc:                         0.9637264013290405 / 0.9650048017501831
after epoch: 25,now: 2024-06-21 18:17:00.758340,epoch time: 0:12:24.731372,used: 6:53:45.573908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9865368, 'precision': 0.97724605, 'recall': 0.9427254, 'specificity': 0.9427254, 'f1': 0.959172, 'auroc': 0.9906739, 'binary_precision': 0.96600145, 'binary_recall': 0.8887126, 'binary_specificity': 0.9967382, 'binary_f1_score': 0.9257466}
confusion matrix:
       0     1
0  42170   138
1    491  3921
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.76236206, 'recall': 0.6230855, 'specificity': 0.6230855, 'f1': 0.6652249, 'auroc': 0.7777714, 'binary_precision': 0.5506757, 'binary_recall': 0.2534992, 'binary_specificity': 0.9926718, 'binary_f1_score': 0.34717783}
confusion matrix:
       0    1
0  18016  133
1    480  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.7839103, 'recall': 0.6171879, 'specificity': 0.6171879, 'f1': 0.6622546, 'auroc': 0.7917496, 'binary_precision': 0.6, 'binary_recall': 0.2413793, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.3442623}
confusion matrix:
      0   1
0  5955  42
1   198  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_26.png
early stop counter: 2
val acc:0.9673797488212585, best validation acc: 0.9676989912986755, corresponding to test acc:                         0.9637264013290405 / 0.9650048017501831
after epoch: 26,now: 2024-06-21 18:30:03.362965,epoch time: 0:13:02.604625,used: 7:06:48.178533,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9864512, 'precision': 0.97555554, 'recall': 0.943933, 'specificity': 0.943933, 'f1': 0.9590602, 'auroc': 0.99274814, 'binary_precision': 0.9623472, 'binary_recall': 0.89150625, 'binary_specificity': 0.99635977, 'binary_f1_score': 0.92557317}
confusion matrix:
       0     1
0  42151   154
1    479  3936
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.74721867, 'recall': 0.6443963, 'specificity': 0.6443963, 'f1': 0.68093634, 'auroc': 0.80523026, 'binary_precision': 0.51891893, 'binary_recall': 0.29860032, 'binary_specificity': 0.9901923, 'binary_f1_score': 0.37907207}
confusion matrix:
       0    1
0  17971  178
1    451  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.79649395, 'recall': 0.6622478, 'specificity': 0.6622478, 'f1': 0.7075891, 'auroc': 0.82523, 'binary_precision': 0.62142855, 'binary_recall': 0.33333334, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.43391523}
confusion matrix:
      0   1
0  5944  53
1   174  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_27.png
early stop counter: 3
val acc:0.9665282964706421, best validation acc: 0.9676989912986755, corresponding to test acc:                         0.9637264013290405 / 0.9650048017501831
after epoch: 27,now: 2024-06-21 18:43:19.698333,epoch time: 0:13:16.335368,used: 7:20:04.513901,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98741436, 'precision': 0.97468054, 'recall': 0.9506308, 'specificity': 0.9506308, 'f1': 0.96226186, 'auroc': 0.9927393, 'binary_precision': 0.9591837, 'binary_recall': 0.9052799, 'binary_specificity': 0.99598175, 'binary_f1_score': 0.9314526}
confusion matrix:
       0     1
0  42137   170
1    418  3995
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.7372165, 'recall': 0.64698327, 'specificity': 0.64698327, 'f1': 0.6803788, 'auroc': 0.8106074, 'binary_precision': 0.49872774, 'binary_recall': 0.30482116, 'binary_specificity': 0.9891454, 'binary_f1_score': 0.37837836}
confusion matrix:
       0    1
0  17952  197
1    447  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.8074045, 'recall': 0.64584017, 'specificity': 0.64584017, 'f1': 0.69487584, 'auroc': 0.82112, 'binary_precision': 0.6446281, 'binary_recall': 0.29885057, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.40837693}
confusion matrix:
      0   1
0  5954  43
1   183  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_28.png
early stop counter: 4
val acc:0.9657300710678101, best validation acc: 0.9676989912986755, corresponding to test acc:                         0.9637264013290405 / 0.9650048017501831
after epoch: 28,now: 2024-06-21 18:58:46.472307,epoch time: 0:15:26.773974,used: 7:35:31.287875,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9874572, 'precision': 0.9789543, 'recall': 0.9465951, 'specificity': 0.9465951, 'f1': 0.96206385, 'auroc': 0.99275184, 'binary_precision': 0.9686505, 'binary_recall': 0.89621574, 'binary_specificity': 0.99697447, 'binary_f1_score': 0.9310264}
confusion matrix:
       0     1
0  42179   128
1    458  3955
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7528122, 'recall': 0.6370886, 'specificity': 0.6370886, 'f1': 0.6760864, 'auroc': 0.7966283, 'binary_precision': 0.53061223, 'binary_recall': 0.2830482, 'binary_specificity': 0.991129, 'binary_f1_score': 0.36916837}
confusion matrix:
       0    1
0  17988  161
1    461  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8243293, 'recall': 0.6276002, 'specificity': 0.6276002, 'f1': 0.6791102, 'auroc': 0.81605875, 'binary_precision': 0.68, 'binary_recall': 0.2605364, 'binary_specificity': 0.994664, 'binary_f1_score': 0.3767313}
confusion matrix:
      0   1
0  5965  32
1   193  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_29.png
early stop counter: 5
val acc:0.9669008255004883, best validation acc: 0.9676989912986755, corresponding to test acc:                         0.9637264013290405 / 0.9650048017501831
after epoch: 29,now: 2024-06-21 19:14:22.606558,epoch time: 0:15:36.134251,used: 7:51:07.422126,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98816353, 'precision': 0.9838679, 'recall': 0.9460837, 'specificity': 0.9460837, 'f1': 0.9640132, 'auroc': 0.9927347, 'binary_precision': 0.9786759, 'binary_recall': 0.89420027, 'binary_specificity': 0.9979672, 'binary_f1_score': 0.93453294}
confusion matrix:
       0     1
0  42220    86
1    467  3947
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.7698141, 'recall': 0.624056, 'specificity': 0.624056, 'f1': 0.66752356, 'auroc': 0.7931758, 'binary_precision': 0.56551725, 'binary_recall': 0.25505444, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.35155413}
confusion matrix:
       0    1
0  18023  126
1    479  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.81551534, 'recall': 0.61802167, 'specificity': 0.61802167, 'f1': 0.6675091, 'auroc': 0.81476414, 'binary_precision': 0.6631579, 'binary_recall': 0.2413793, 'binary_specificity': 0.994664, 'binary_f1_score': 0.3539326}
confusion matrix:
      0   1
0  5965  32
1   198  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_30.png
better model found
persisted
after epoch: 30,now: 2024-06-21 19:29:55.235082,epoch time: 0:15:32.628524,used: 8:06:40.050650,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_11_23_14_seed_0_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:06:40.050650 at 2024-06-21 19:29:55.235082
persisted model performance metric: 

scalar performance:
{'acc': 0.96324706, 'precision': 0.81551534, 'recall': 0.61802167, 'specificity': 0.61802167, 'f1': 0.6675091, 'auroc': 0.81476414, 'binary_precision': 0.6631579, 'binary_recall': 0.2413793, 'binary_specificity': 0.994664, 'binary_f1_score': 0.3539326}
confusion matrix:
      0   1
0  5965  32
1   198  63
oracle model performance metric: 

scalar performance:
{'acc': 0.9650048, 'precision': 0.82424366, 'recall': 0.6500884, 'specificity': 0.6500884, 'f1': 0.70205975, 'auroc': 0.8064871, 'binary_precision': 0.6779661, 'binary_recall': 0.3065134, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.42216355}
confusion matrix:
      0   1
0  5959  38
1   181  80
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204391 KiB | 755277 KiB | 711704 GiB | 711704 GiB |
|       from large pool | 167936 KiB | 683136 KiB | 711530 GiB | 711530 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    173 GiB |    173 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204391 KiB | 755277 KiB | 711704 GiB | 711704 GiB |
|       from large pool | 167936 KiB | 683136 KiB | 711530 GiB | 711530 GiB |
|       from small pool |  36455 KiB |  73422 KiB |    173 GiB |    173 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 748328 KiB | 711587 GiB | 711587 GiB |
|       from large pool | 165120 KiB | 676736 KiB | 711421 GiB | 711421 GiB |
|       from small pool |  35968 KiB |  72872 KiB |    166 GiB |    166 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    930 MiB |    930 MiB |    930 MiB |      0 B   |
|       from large pool |    858 MiB |    858 MiB |    858 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 104856 KiB | 245592 KiB | 285291 GiB | 285291 GiB |
|       from large pool |  96256 KiB | 244616 KiB | 285117 GiB | 285117 GiB |
|       from small pool |   8600 KiB |  12473 KiB |    174 GiB |    174 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2076    |    3669    |   44387 K  |   44385 K  |
|       from large pool |      36    |      76    |   18226 K  |   18226 K  |
|       from small pool |    2040    |    3632    |   26161 K  |   26159 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2076    |    3669    |   44387 K  |   44385 K  |
|       from large pool |      36    |      76    |   18226 K  |   18226 K  |
|       from small pool |    2040    |    3632    |   26161 K  |   26159 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      15    |      15    |      15    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    1476    |   19206 K  |   19206 K  |
|       from large pool |       5    |      10    |    5763 K  |    5763 K  |
|       from small pool |      29    |    1471    |   13443 K  |   13443 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755277 KiB | 711704 GiB | 711704 GiB |
|       from large pool |  16640 KiB | 683136 KiB | 711530 GiB | 711530 GiB |
|       from small pool |      0 KiB |  73422 KiB |    173 GiB |    173 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755277 KiB | 711704 GiB | 711704 GiB |
|       from large pool |  16640 KiB | 683136 KiB | 711530 GiB | 711530 GiB |
|       from small pool |      0 KiB |  73422 KiB |    173 GiB |    173 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB | 711587 GiB | 711587 GiB |
|       from large pool |  16640 KiB | 676736 KiB | 711421 GiB | 711421 GiB |
|       from small pool |      0 KiB |  72872 KiB |    166 GiB |    166 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    930 MiB |    930 MiB | 643072 KiB |
|       from large pool | 264192 KiB |    858 MiB |    858 MiB | 614400 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 245592 KiB | 285291 GiB | 285291 GiB |
|       from large pool |  83712 KiB | 244616 KiB | 285117 GiB | 285117 GiB |
|       from small pool |      0 KiB |  16195 KiB |    174 GiB |    174 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   44387 K  |   44387 K  |
|       from large pool |       2    |      76    |   18226 K  |   18226 K  |
|       from small pool |       0    |    3632    |   26161 K  |   26161 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   44387 K  |   44387 K  |
|       from large pool |       2    |      76    |   18226 K  |   18226 K  |
|       from small pool |       0    |    3632    |   26161 K  |   26161 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   19207 K  |   19207 K  |
|       from large pool |       1    |      11    |    5763 K  |    5763 K  |
|       from small pool |       0    |    1471    |   13444 K  |   13444 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755277 KiB | 711704 GiB | 711704 GiB |
|       from large pool |  16640 KiB | 683136 KiB | 711530 GiB | 711530 GiB |
|       from small pool |      0 KiB |  73422 KiB |    173 GiB |    173 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755277 KiB | 711704 GiB | 711704 GiB |
|       from large pool |  16640 KiB | 683136 KiB | 711530 GiB | 711530 GiB |
|       from small pool |      0 KiB |  73422 KiB |    173 GiB |    173 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB | 711587 GiB | 711587 GiB |
|       from large pool |  16640 KiB | 676736 KiB | 711421 GiB | 711421 GiB |
|       from small pool |      0 KiB |  72872 KiB |    166 GiB |    166 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    930 MiB |    930 MiB | 643072 KiB |
|       from large pool | 264192 KiB |    858 MiB |    858 MiB | 614400 KiB |
|       from small pool |  45056 KiB |     72 MiB |     72 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 245592 KiB | 285291 GiB | 285291 GiB |
|       from large pool |  83712 KiB | 244616 KiB | 285117 GiB | 285117 GiB |
|       from small pool |      0 KiB |  16195 KiB |    174 GiB |    174 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   44387 K  |   44387 K  |
|       from large pool |       2    |      76    |   18226 K  |   18226 K  |
|       from small pool |       0    |    3632    |   26161 K  |   26161 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   44387 K  |   44387 K  |
|       from large pool |       2    |      76    |   18226 K  |   18226 K  |
|       from small pool |       0    |    3632    |   26161 K  |   26161 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      51    |      20    |
|       from large pool |       9    |      15    |      15    |       6    |
|       from small pool |      22    |      36    |      36    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   19207 K  |   19207 K  |
|       from large pool |       1    |      11    |    5763 K  |    5763 K  |
|       from small pool |       0    |    1471    |   13444 K  |   13444 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751

 Experiment start at: 2024-06-21 19:36:20.934792
before training, model accuracy: 0.14647115767002106
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90742725, 'precision': 0.45371363, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4757336, 'auroc': 0.7140485, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42395  0
1   4325  0
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.48204374, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49085772, 'auroc': 0.3501228, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18067  0
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.26320797, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-21 19:49:54.751080,epoch time: 0:13:33.816288,used: 0:13:33.816288,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.91128, 'precision': 0.78976274, 'recall': 0.53886366, 'specificity': 0.53886366, 'f1': 0.54954946, 'auroc': 0.9028497, 'binary_precision': 0.66541356, 'binary_recall': 0.08192548, 'binary_specificity': 0.9958018, 'binary_f1_score': 0.14588915}
confusion matrix:
       0    1
0  42221  178
1   3967  354
---- Validation: 
scalar performance:
{'acc': 0.9618997, 'precision': 0.48200437, 'recall': 0.49886534, 'specificity': 0.49886534, 'f1': 0.49028993, 'auroc': 0.45774883, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9977307, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18026  41
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.41438526, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_2.png
early stop counter: 1
val acc:0.9618996977806091, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 2,now: 2024-06-21 20:03:44.927104,epoch time: 0:13:50.176024,used: 0:27:23.992312,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93525255, 'precision': 0.89921033, 'recall': 0.6763017, 'specificity': 0.6763017, 'f1': 0.7357389, 'auroc': 0.9326587, 'binary_precision': 0.8601554, 'binary_recall': 0.3585473, 'binary_specificity': 0.99405617, 'binary_f1_score': 0.5061224}
confusion matrix:
       0     1
0  42145   252
1   2773  1550
---- Validation: 
scalar performance:
{'acc': 0.9605656, 'precision': 0.4819803, 'recall': 0.49817348, 'specificity': 0.49817348, 'f1': 0.48994312, 'auroc': 0.51879907, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18001  66
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.51709354, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_3.png
early stop counter: 2
val acc:0.9605656266212463, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 3,now: 2024-06-21 20:18:36.571656,epoch time: 0:14:51.644552,used: 0:42:15.636864,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9499358, 'precision': 0.92745066, 'recall': 0.7545583, 'specificity': 0.7545583, 'f1': 0.8142897, 'auroc': 0.9540082, 'binary_precision': 0.9023105, 'binary_recall': 0.5148011, 'binary_specificity': 0.9943155, 'binary_f1_score': 0.6555735}
confusion matrix:
       0     1
0  42155   241
1   2098  2226
---- Validation: 
scalar performance:
{'acc': 0.9630736, 'precision': 0.5561988, 'recall': 0.50233525, 'specificity': 0.50233525, 'f1': 0.49630702, 'auroc': 0.6048988, 'binary_precision': 0.14814815, 'binary_recall': 0.0059435363, 'binary_specificity': 0.99872696, 'binary_f1_score': 0.011428571}
confusion matrix:
       0   1
0  18044  23
1    669   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.47904915, 'recall': 0.4999159, 'specificity': 0.4999159, 'f1': 0.48926014, 'auroc': 0.64313173, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5945  1
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_4.png
early stop counter: 3
val acc:0.9630736112594604, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 4,now: 2024-06-21 20:32:04.375172,epoch time: 0:13:27.803516,used: 0:55:43.440380,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9620077, 'precision': 0.9377364, 'recall': 0.82400906, 'specificity': 0.82400906, 'f1': 0.8703767, 'auroc': 0.96689796, 'binary_precision': 0.90973336, 'binary_recall': 0.65464634, 'binary_specificity': 0.9933717, 'binary_f1_score': 0.7613927}
confusion matrix:
       0     1
0  42113   281
1   1494  2832
---- Validation: 
scalar performance:
{'acc': 0.96334046, 'precision': 0.6827263, 'recall': 0.51964, 'specificity': 0.51964, 'f1': 0.5283348, 'auroc': 0.6605018, 'binary_precision': 0.4, 'binary_recall': 0.041604754, 'binary_specificity': 0.9976753, 'binary_f1_score': 0.07537012}
confusion matrix:
       0   1
0  18025  42
1    645  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.5416062, 'recall': 0.5013344, 'specificity': 0.5013344, 'f1': 0.49277943, 'auroc': 0.73302734, 'binary_precision': 0.125, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.0074626864}
confusion matrix:
      0  1
0  5939  7
1   259  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_5.png
early stop counter: 4
val acc:0.9633404612541199, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-21 20:47:10.384052,epoch time: 0:15:06.008880,used: 1:10:49.449260,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9659889, 'precision': 0.9519113, 'recall': 0.8372338, 'specificity': 0.8372338, 'f1': 0.8843006, 'auroc': 0.97004485, 'binary_precision': 0.9356483, 'binary_recall': 0.6792322, 'binary_specificity': 0.9952354, 'binary_f1_score': 0.7870829}
confusion matrix:
       0     1
0  42194   202
1   1387  2937
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.74930906, 'recall': 0.5172494, 'specificity': 0.5172494, 'f1': 0.5243135, 'auroc': 0.6695117, 'binary_precision': 0.53333336, 'binary_recall': 0.035661217, 'binary_specificity': 0.99883765, 'binary_f1_score': 0.06685237}
confusion matrix:
       0   1
0  18046  21
1    649  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.60418683, 'recall': 0.5033416, 'specificity': 0.5033416, 'f1': 0.49659312, 'auroc': 0.7403904, 'binary_precision': 0.25, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.014925373}
confusion matrix:
      0  1
0  5940  6
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_6.png
better model found
persisted
after epoch: 6,now: 2024-06-21 21:00:40.204712,epoch time: 0:13:29.820660,used: 1:24:19.269920,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9716396, 'precision': 0.9611222, 'recall': 0.86460364, 'specificity': 0.86460364, 'f1': 0.9058892, 'auroc': 0.97496545, 'binary_precision': 0.94884837, 'binary_recall': 0.73324084, 'binary_specificity': 0.99596643, 'binary_f1_score': 0.8272265}
confusion matrix:
       0     1
0  42223   171
1   1154  3172
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.7777259, 'recall': 0.5737875, 'specificity': 0.5737875, 'f1': 0.6116488, 'auroc': 0.71296227, 'binary_precision': 0.5862069, 'binary_recall': 0.15156017, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.24085005}
confusion matrix:
       0    1
0  17995   72
1    571  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.7636152, 'recall': 0.5483182, 'specificity': 0.5483182, 'f1': 0.57447666, 'auroc': 0.7785279, 'binary_precision': 0.5652174, 'binary_recall': 0.1, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.16993465}
confusion matrix:
      0   1
0  5926  20
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-21 21:15:43.271134,epoch time: 0:15:03.066422,used: 1:39:22.336342,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.975, 'precision': 0.9735688, 'recall': 0.8747295, 'specificity': 0.8747295, 'f1': 0.9170503, 'auroc': 0.98103434, 'binary_precision': 0.9718984, 'binary_recall': 0.7516763, 'binary_specificity': 0.99778277, 'binary_f1_score': 0.8477184}
confusion matrix:
       0     1
0  42301    94
1   1074  3251
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.7836869, 'recall': 0.5659196, 'specificity': 0.5659196, 'f1': 0.6015321, 'auroc': 0.72083235, 'binary_precision': 0.5986842, 'binary_recall': 0.13521545, 'binary_specificity': 0.9966237, 'binary_f1_score': 0.22060604}
confusion matrix:
       0   1
0  18006  61
1    582  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.77776575, 'recall': 0.5596885, 'specificity': 0.5596885, 'f1': 0.59157854, 'auroc': 0.78824425, 'binary_precision': 0.5925926, 'binary_recall': 0.12307692, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.20382166}
confusion matrix:
      0   1
0  5924  22
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_8.png
new oracle model saved
early stop counter: 1
val acc:0.9656883478164673, best validation acc: 0.9656883478164673, corresponding to test acc:                         0.9590718746185303 / 0.9597163796424866
after epoch: 8,now: 2024-06-21 21:29:58.698732,epoch time: 0:14:15.427598,used: 1:53:37.763940,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97673374, 'precision': 0.96629834, 'recall': 0.8913113, 'specificity': 0.8913113, 'f1': 0.92473626, 'auroc': 0.9799484, 'binary_precision': 0.95398426, 'binary_recall': 0.78649086, 'binary_specificity': 0.9961318, 'binary_f1_score': 0.8621782}
confusion matrix:
       0     1
0  42233   164
1    923  3400
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.77280486, 'recall': 0.5823707, 'specificity': 0.5823707, 'f1': 0.6221021, 'auroc': 0.73600024, 'binary_precision': 0.57575756, 'binary_recall': 0.16939078, 'binary_specificity': 0.99535066, 'binary_f1_score': 0.26176807}
confusion matrix:
       0    1
0  17983   84
1    559  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.81282294, 'recall': 0.57708025, 'specificity': 0.57708025, 'f1': 0.6174036, 'auroc': 0.7839446, 'binary_precision': 0.66129035, 'binary_recall': 0.15769231, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.2546584}
confusion matrix:
      0   1
0  5925  21
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_9.png
new oracle model saved
early stop counter: 2
val acc:0.9656883478164673, best validation acc: 0.9656883478164673, corresponding to test acc:                         0.9590718746185303 / 0.9613277316093445
after epoch: 9,now: 2024-06-21 21:43:50.480693,epoch time: 0:13:51.781961,used: 2:07:29.545901,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98026544, 'precision': 0.97469044, 'recall': 0.9054527, 'specificity': 0.9054527, 'f1': 0.93669236, 'auroc': 0.9827241, 'binary_precision': 0.96808803, 'binary_recall': 0.8136416, 'binary_specificity': 0.99726385, 'binary_f1_score': 0.88417083}
confusion matrix:
       0     1
0  42279   116
1    806  3519
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.7511965, 'recall': 0.5970039, 'specificity': 0.5970039, 'f1': 0.6366441, 'auroc': 0.7270533, 'binary_precision': 0.53149605, 'binary_recall': 0.20059435, 'binary_specificity': 0.9934134, 'binary_f1_score': 0.29126212}
confusion matrix:
       0    1
0  17948  119
1    538  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.8067838, 'recall': 0.6032465, 'specificity': 0.6032465, 'f1': 0.649683, 'auroc': 0.76753473, 'binary_precision': 0.64705884, 'binary_recall': 0.21153846, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.3188406}
confusion matrix:
      0   1
0  5916  30
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_10.png
new oracle model saved
early stop counter: 3
val acc:0.9649413228034973, best validation acc: 0.9656883478164673, corresponding to test acc:                         0.9590718746185303 / 0.9621334075927734
after epoch: 10,now: 2024-06-21 21:57:52.592062,epoch time: 0:14:02.111369,used: 2:21:31.657270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9796875, 'precision': 0.974027, 'recall': 0.90253896, 'specificity': 0.90253896, 'f1': 0.9346672, 'auroc': 0.9855721, 'binary_precision': 0.9673311, 'binary_recall': 0.80786127, 'binary_specificity': 0.99721664, 'binary_f1_score': 0.88043344}
confusion matrix:
       0     1
0  42277   118
1    831  3494
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.7622643, 'recall': 0.6008846, 'specificity': 0.6008846, 'f1': 0.6423516, 'auroc': 0.7746123, 'binary_precision': 0.5533597, 'binary_recall': 0.20802377, 'binary_specificity': 0.9937455, 'binary_f1_score': 0.3023758}
confusion matrix:
       0    1
0  17954  113
1    533  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.83334965, 'recall': 0.60567415, 'specificity': 0.60567415, 'f1': 0.6552626, 'auroc': 0.8105087, 'binary_precision': 0.7, 'binary_recall': 0.21538462, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.32941177}
confusion matrix:
      0   1
0  5922  24
1   204  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_11.png
new oracle model saved
early stop counter: 4
val acc:0.9655283093452454, best validation acc: 0.9656883478164673, corresponding to test acc:                         0.9590718746185303 / 0.9632613658905029
after epoch: 11,now: 2024-06-21 22:11:19.265895,epoch time: 0:13:26.673833,used: 2:34:58.331103,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9825342, 'precision': 0.97375405, 'recall': 0.9200586, 'specificity': 0.9200586, 'f1': 0.944898, 'auroc': 0.987749, 'binary_precision': 0.9632761, 'binary_recall': 0.84339577, 'binary_specificity': 0.99672145, 'binary_f1_score': 0.8993587}
confusion matrix:
       0     1
0  42258   139
1    677  3646
---- Validation: 
scalar performance:
{'acc': 0.9653682, 'precision': 0.75533664, 'recall': 0.6222596, 'specificity': 0.6222596, 'f1': 0.6629982, 'auroc': 0.7668296, 'binary_precision': 0.53797466, 'binary_recall': 0.25260028, 'binary_specificity': 0.991919, 'binary_f1_score': 0.3437816}
confusion matrix:
       0    1
0  17921  146
1    503  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.81976044, 'recall': 0.6448815, 'specificity': 0.6448815, 'f1': 0.6961533, 'auroc': 0.7992207, 'binary_precision': 0.6695652, 'binary_recall': 0.29615384, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.41066667}
confusion matrix:
      0   1
0  5908  38
1   183  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_12.png
new oracle model saved
early stop counter: 5
val acc:0.9653682112693787, best validation acc: 0.9656883478164673, corresponding to test acc:                         0.9590718746185303 / 0.9643893241882324
after epoch: 12,now: 2024-06-21 22:24:27.783630,epoch time: 0:13:08.517735,used: 2:48:06.848838,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9822346, 'precision': 0.97715974, 'recall': 0.9150963, 'specificity': 0.9150963, 'f1': 0.9434471, 'auroc': 0.9877515, 'binary_precision': 0.9711279, 'binary_recall': 0.83271635, 'binary_specificity': 0.9974763, 'binary_f1_score': 0.8966119}
confusion matrix:
       0     1
0  42291   107
1    723  3599
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.7690902, 'recall': 0.6075434, 'specificity': 0.6075434, 'f1': 0.6504588, 'auroc': 0.7921587, 'binary_precision': 0.56653994, 'binary_recall': 0.22139673, 'binary_specificity': 0.99369013, 'binary_f1_score': 0.31837606}
confusion matrix:
       0    1
0  17953  114
1    524  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.86500776, 'recall': 0.61571, 'specificity': 0.61571, 'f1': 0.67038256, 'auroc': 0.8306096, 'binary_precision': 0.7625, 'binary_recall': 0.23461539, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.3588235}
confusion matrix:
      0   1
0  5927  19
1   199  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_13.png
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-06-21 22:37:44.314711,epoch time: 0:13:16.531081,used: 3:01:23.379919,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9832834, 'precision': 0.96764266, 'recall': 0.9306658, 'specificity': 0.9306658, 'f1': 0.9482019, 'auroc': 0.98864865, 'binary_precision': 0.9488219, 'binary_recall': 0.8660962, 'binary_specificity': 0.9952354, 'binary_f1_score': 0.9055737}
confusion matrix:
       0     1
0  42194   202
1    579  3745
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.7476244, 'recall': 0.6263022, 'specificity': 0.6263022, 'f1': 0.66523635, 'auroc': 0.7803608, 'binary_precision': 0.5222552, 'binary_recall': 0.2615156, 'binary_specificity': 0.99108875, 'binary_f1_score': 0.34851483}
confusion matrix:
       0    1
0  17906  161
1    497  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.819527, 'recall': 0.63735735, 'specificity': 0.63735735, 'f1': 0.6885735, 'auroc': 0.8120146, 'binary_precision': 0.66972476, 'binary_recall': 0.28076923, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.39566398}
confusion matrix:
      0   1
0  5910  36
1   187  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_14.png
early stop counter: 1
val acc:0.9648879170417786, best validation acc: 0.9659551978111267, corresponding to test acc:                         0.9648727178573608 / 0.9648727178573608
after epoch: 14,now: 2024-06-21 22:50:33.797904,epoch time: 0:12:49.483193,used: 3:14:12.863112,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98202056, 'precision': 0.97876227, 'recall': 0.912361, 'specificity': 0.912361, 'f1': 0.942493, 'auroc': 0.98852634, 'binary_precision': 0.9748977, 'binary_recall': 0.8268919, 'binary_specificity': 0.99783015, 'binary_f1_score': 0.8948159}
confusion matrix:
       0     1
0  42307    92
1    748  3573
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.77849495, 'recall': 0.5933211, 'specificity': 0.5933211, 'f1': 0.6357789, 'auroc': 0.7734234, 'binary_precision': 0.5863636, 'binary_recall': 0.19167905, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.28891376}
confusion matrix:
       0    1
0  17976   91
1    544  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.84699416, 'recall': 0.6059264, 'specificity': 0.6059264, 'f1': 0.65685534, 'auroc': 0.8111671, 'binary_precision': 0.72727275, 'binary_recall': 0.21538462, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.33234423}
confusion matrix:
      0   1
0  5925  21
1   204  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_15.png
better model found
persisted
after epoch: 15,now: 2024-06-21 23:03:08.547258,epoch time: 0:12:34.749354,used: 3:26:47.612466,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9833476, 'precision': 0.973943, 'recall': 0.9249031, 'specificity': 0.9249031, 'f1': 0.94775546, 'auroc': 0.98848486, 'binary_precision': 0.9626924, 'binary_recall': 0.8531792, 'binary_specificity': 0.996627, 'binary_f1_score': 0.9046335}
confusion matrix:
       0     1
0  42252   143
1    635  3690
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.75082445, 'recall': 0.6256976, 'specificity': 0.6256976, 'f1': 0.665338, 'auroc': 0.7843429, 'binary_precision': 0.5287009, 'binary_recall': 0.2600297, 'binary_specificity': 0.9913655, 'binary_f1_score': 0.34860554}
confusion matrix:
       0    1
0  17911  156
1    498  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.83883417, 'recall': 0.65483326, 'specificity': 0.65483326, 'f1': 0.7092782, 'auroc': 0.8230226, 'binary_precision': 0.70689654, 'binary_recall': 0.31538463, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.43617022}
confusion matrix:
      0   1
0  5912  34
1   178  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_16.png
new oracle model saved
early stop counter: 1
val acc:0.9651013612747192, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9637447595596313 / 0.9658395051956177
after epoch: 16,now: 2024-06-21 23:15:52.411930,epoch time: 0:12:43.864672,used: 3:39:31.477138,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9848887, 'precision': 0.9793881, 'recall': 0.92914593, 'specificity': 0.92914593, 'f1': 0.9525378, 'auroc': 0.9890127, 'binary_precision': 0.97281045, 'binary_recall': 0.86074483, 'binary_specificity': 0.997547, 'binary_f1_score': 0.91335297}
confusion matrix:
       0     1
0  42293   104
1    602  3721
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.76190007, 'recall': 0.6023152, 'specificity': 0.6023152, 'f1': 0.643851, 'auroc': 0.7871909, 'binary_precision': 0.55252916, 'binary_recall': 0.21099554, 'binary_specificity': 0.9936348, 'binary_f1_score': 0.30537632}
confusion matrix:
       0    1
0  17952  115
1    531  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.8593801, 'recall': 0.6307582, 'specificity': 0.6307582, 'f1': 0.68715036, 'auroc': 0.8173504, 'binary_precision': 0.75, 'binary_recall': 0.2653846, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.39204544}
confusion matrix:
      0   1
0  5923  23
1   191  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_17.png
early stop counter: 2
val acc:0.9655283093452454, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9637447595596313 / 0.9658395051956177
after epoch: 17,now: 2024-06-21 23:28:05.247547,epoch time: 0:12:12.835617,used: 3:51:44.312755,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9839683, 'precision': 0.97322506, 'recall': 0.9293817, 'specificity': 0.9293817, 'f1': 0.9499744, 'auroc': 0.9905443, 'binary_precision': 0.96033996, 'binary_recall': 0.86239594, 'binary_specificity': 0.9963676, 'binary_f1_score': 0.90873647}
confusion matrix:
       0     1
0  42242   154
1    595  3729
---- Validation: 
scalar performance:
{'acc': 0.9660619, 'precision': 0.7665405, 'recall': 0.62404996, 'specificity': 0.62404996, 'f1': 0.6667979, 'auroc': 0.78900135, 'binary_precision': 0.5602606, 'binary_recall': 0.25557205, 'binary_specificity': 0.99252784, 'binary_f1_score': 0.3510204}
confusion matrix:
       0    1
0  17932  135
1    501  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.8361037, 'recall': 0.6509871, 'specificity': 0.6509871, 'f1': 0.70501524, 'auroc': 0.82658935, 'binary_precision': 0.7017544, 'binary_recall': 0.30769232, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.4278075}
confusion matrix:
      0   1
0  5912  34
1   180  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_18.png
early stop counter: 3
val acc:0.9660618901252747, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9637447595596313 / 0.9658395051956177
after epoch: 18,now: 2024-06-21 23:41:04.705035,epoch time: 0:12:59.457488,used: 4:04:43.770243,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98448205, 'precision': 0.9797784, 'recall': 0.9263084, 'specificity': 0.9263084, 'f1': 0.95108116, 'auroc': 0.9906539, 'binary_precision': 0.97416294, 'binary_recall': 0.85492826, 'binary_specificity': 0.9976886, 'binary_f1_score': 0.91065925}
confusion matrix:
       0     1
0  42300    98
1    627  3695
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.781482, 'recall': 0.60278565, 'specificity': 0.60278565, 'f1': 0.6469306, 'auroc': 0.7888831, 'binary_precision': 0.59166664, 'binary_recall': 0.21099554, 'binary_specificity': 0.99457574, 'binary_f1_score': 0.31106243}
confusion matrix:
       0    1
0  17969   98
1    531  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.8433453, 'recall': 0.61152744, 'specificity': 0.61152744, 'f1': 0.6632354, 'auroc': 0.8234351, 'binary_precision': 0.7195122, 'binary_recall': 0.22692308, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.34502923}
confusion matrix:
      0   1
0  5923  23
1   201  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_19.png
better model found
persisted
after epoch: 19,now: 2024-06-21 23:53:53.633518,epoch time: 0:12:48.928483,used: 4:17:32.698726,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98563784, 'precision': 0.9724277, 'recall': 0.9404515, 'specificity': 0.9404515, 'f1': 0.9557388, 'auroc': 0.9905002, 'binary_precision': 0.95648915, 'binary_recall': 0.88500696, 'binary_specificity': 0.99589604, 'binary_f1_score': 0.9193607}
confusion matrix:
       0     1
0  42224   174
1    497  3825
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.7563279, 'recall': 0.6337869, 'specificity': 0.6337869, 'f1': 0.6738527, 'auroc': 0.79750955, 'binary_precision': 0.53913045, 'binary_recall': 0.27637443, 'binary_specificity': 0.99119943, 'binary_f1_score': 0.36542237}
confusion matrix:
       0    1
0  17908  159
1    487  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.82561755, 'recall': 0.6563359, 'specificity': 0.6563359, 'f1': 0.7082999, 'auroc': 0.824522, 'binary_precision': 0.6803279, 'binary_recall': 0.31923077, 'binary_specificity': 0.993441, 'binary_f1_score': 0.43455496}
confusion matrix:
      0   1
0  5907  39
1   177  83
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_20.png
early stop counter: 1
val acc:0.9655283093452454, best validation acc: 0.966435432434082, corresponding to test acc:                         0.9639058709144592 / 0.9658395051956177
after epoch: 20,now: 2024-06-22 00:06:06.486171,epoch time: 0:12:12.852653,used: 4:29:45.551379,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98632276, 'precision': 0.9708621, 'recall': 0.9463471, 'specificity': 0.9463471, 'f1': 0.9581938, 'auroc': 0.9914986, 'binary_precision': 0.9521355, 'binary_recall': 0.89729357, 'binary_specificity': 0.9954006, 'binary_f1_score': 0.9239014}
confusion matrix:
       0     1
0  42202   195
1    444  3879
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.7453996, 'recall': 0.6484201, 'specificity': 0.6484201, 'f1': 0.683673, 'auroc': 0.8127222, 'binary_precision': 0.5162095, 'binary_recall': 0.307578, 'binary_specificity': 0.98926216, 'binary_f1_score': 0.38547486}
confusion matrix:
       0    1
0  17873  194
1    466  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.812997, 'recall': 0.6803268, 'specificity': 0.6803268, 'f1': 0.7269176, 'auroc': 0.8341743, 'binary_precision': 0.6530612, 'binary_recall': 0.36923078, 'binary_specificity': 0.99142283, 'binary_f1_score': 0.47174445}
confusion matrix:
      0   1
0  5895  51
1   164  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_21.png
early stop counter: 2
val acc:0.9647812247276306, best validation acc: 0.966435432434082, corresponding to test acc:                         0.9639058709144592 / 0.9658395051956177
after epoch: 21,now: 2024-06-22 00:18:41.980465,epoch time: 0:12:35.494294,used: 4:42:21.045673,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98557365, 'precision': 0.97627795, 'recall': 0.9363176, 'specificity': 0.9363176, 'f1': 0.95520544, 'auroc': 0.9907456, 'binary_precision': 0.96510446, 'binary_recall': 0.87586683, 'binary_specificity': 0.9967684, 'binary_f1_score': 0.91832286}
confusion matrix:
       0     1
0  42257   137
1    537  3789
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.76763535, 'recall': 0.62336236, 'specificity': 0.62336236, 'f1': 0.66632766, 'auroc': 0.8110849, 'binary_precision': 0.5625, 'binary_recall': 0.25408617, 'binary_specificity': 0.9926385, 'binary_f1_score': 0.3500512}
confusion matrix:
       0    1
0  17934  133
1    502  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.8445221, 'recall': 0.65876347, 'specificity': 0.65876347, 'f1': 0.7141287, 'auroc': 0.83714, 'binary_precision': 0.71794873, 'binary_recall': 0.32307693, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.44562337}
confusion matrix:
      0   1
0  5913  33
1   176  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_22.png
new oracle model saved
early stop counter: 3
val acc:0.9661152362823486, best validation acc: 0.966435432434082, corresponding to test acc:                         0.9639058709144592 / 0.9663228988647461
after epoch: 22,now: 2024-06-22 00:31:18.227471,epoch time: 0:12:36.247006,used: 4:54:57.292679,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9859161, 'precision': 0.9732803, 'recall': 0.9413712, 'specificity': 0.9413712, 'f1': 0.9566292, 'auroc': 0.99051905, 'binary_precision': 0.9580315, 'binary_recall': 0.8867052, 'binary_specificity': 0.99603724, 'binary_f1_score': 0.92098945}
confusion matrix:
       0     1
0  42227   168
1    490  3835
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.76282233, 'recall': 0.6289738, 'specificity': 0.6289738, 'f1': 0.67078114, 'auroc': 0.79849845, 'binary_precision': 0.55246913, 'binary_recall': 0.26597324, 'binary_specificity': 0.9919743, 'binary_f1_score': 0.35907722}
confusion matrix:
       0    1
0  17922  145
1    494  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.8112416, 'recall': 0.64462924, 'specificity': 0.64462924, 'f1': 0.69439673, 'auroc': 0.8198277, 'binary_precision': 0.65254235, 'binary_recall': 0.29615384, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.4074074}
confusion matrix:
      0   1
0  5905  41
1   183  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_23.png
early stop counter: 4
val acc:0.965901792049408, best validation acc: 0.966435432434082, corresponding to test acc:                         0.9639058709144592 / 0.9663228988647461
after epoch: 23,now: 2024-06-22 00:43:35.843267,epoch time: 0:12:17.615796,used: 5:07:14.908475,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98630136, 'precision': 0.97085035, 'recall': 0.9462433, 'specificity': 0.9462433, 'f1': 0.95813286, 'auroc': 0.99258155, 'binary_precision': 0.9521355, 'binary_recall': 0.897086, 'binary_specificity': 0.9954005, 'binary_f1_score': 0.9237914}
confusion matrix:
       0     1
0  42201   195
1    445  3879
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.77085924, 'recall': 0.6321116, 'specificity': 0.6321116, 'f1': 0.6752996, 'auroc': 0.7969608, 'binary_precision': 0.56832296, 'binary_recall': 0.27191678, 'binary_specificity': 0.9923064, 'binary_f1_score': 0.36783916}
confusion matrix:
       0    1
0  17928  139
1    490  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.8316357, 'recall': 0.6489799, 'specificity': 0.6489799, 'f1': 0.70225835, 'auroc': 0.8256501, 'binary_precision': 0.69298244, 'binary_recall': 0.30384615, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.42245987}
confusion matrix:
      0   1
0  5911  35
1   181  79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_24.png
early stop counter: 5
val acc:0.966435432434082, best validation acc: 0.966435432434082, corresponding to test acc:                         0.9639058709144592 / 0.9663228988647461
after epoch: 24,now: 2024-06-22 00:55:46.736041,epoch time: 0:12:10.892774,used: 5:19:25.801249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98623717, 'precision': 0.9747621, 'recall': 0.9418336, 'specificity': 0.9418336, 'f1': 0.95755816, 'auroc': 0.9922972, 'binary_precision': 0.9609218, 'binary_recall': 0.88734674, 'binary_specificity': 0.9963205, 'binary_f1_score': 0.9226699}
confusion matrix:
       0     1
0  42241   156
1    487  3836
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.76100224, 'recall': 0.6296337, 'specificity': 0.6296337, 'f1': 0.67103434, 'auroc': 0.81687254, 'binary_precision': 0.5487805, 'binary_recall': 0.26745912, 'binary_specificity': 0.9918083, 'binary_f1_score': 0.35964036}
confusion matrix:
       0    1
0  17919  148
1    493  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96761197, 'precision': 0.8541865, 'recall': 0.6741481, 'specificity': 0.6741481, 'f1': 0.7306048, 'auroc': 0.8453632, 'binary_precision': 0.736, 'binary_recall': 0.35384616, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.4779221}
confusion matrix:
      0   1
0  5913  33
1   168  92
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_25.png
new oracle model saved
early stop counter: 6
val acc:0.96579509973526, best validation acc: 0.966435432434082, corresponding to test acc:                         0.9639058709144592 / 0.9676119685173035
after epoch: 25,now: 2024-06-22 01:07:42.617659,epoch time: 0:11:55.881618,used: 5:31:21.682867,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98769265, 'precision': 0.9771161, 'recall': 0.94846356, 'specificity': 0.94846356, 'f1': 0.962235, 'auroc': 0.9924245, 'binary_precision': 0.96432996, 'binary_recall': 0.90032375, 'binary_specificity': 0.9966034, 'binary_f1_score': 0.93122834}
confusion matrix:
       0     1
0  42252   144
1    431  3893
---- Validation: 
scalar performance:
{'acc': 0.9653148, 'precision': 0.75351906, 'recall': 0.63081515, 'specificity': 0.63081515, 'f1': 0.6705748, 'auroc': 0.8156332, 'binary_precision': 0.53372437, 'binary_recall': 0.2704309, 'binary_specificity': 0.99119943, 'binary_f1_score': 0.35897437}
confusion matrix:
       0    1
0  17908  159
1    491  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96696746, 'precision': 0.846022, 'recall': 0.67013377, 'specificity': 0.67013377, 'f1': 0.72524375, 'auroc': 0.84369457, 'binary_precision': 0.72, 'binary_recall': 0.34615386, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.4675325}
confusion matrix:
      0   1
0  5911  35
1   170  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_26.png
early stop counter: 7
val acc:0.9653148055076599, best validation acc: 0.966435432434082, corresponding to test acc:                         0.9639058709144592 / 0.9676119685173035
after epoch: 26,now: 2024-06-22 01:19:09.476011,epoch time: 0:11:26.858352,used: 5:42:48.541219,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9875, 'precision': 0.98143494, 'recall': 0.9430616, 'specificity': 0.9430616, 'f1': 0.9612548, 'auroc': 0.99202013, 'binary_precision': 0.9741379, 'binary_recall': 0.8885291, 'binary_specificity': 0.9975941, 'binary_f1_score': 0.92936623}
confusion matrix:
       0     1
0  42294   102
1    482  3842
---- Validation: 
scalar performance:
{'acc': 0.9664888, 'precision': 0.7733783, 'recall': 0.62641716, 'specificity': 0.62641716, 'f1': 0.67033434, 'auroc': 0.80552125, 'binary_precision': 0.57377046, 'binary_recall': 0.2600297, 'binary_specificity': 0.9928046, 'binary_f1_score': 0.3578732}
confusion matrix:
       0    1
0  17937  130
1    498  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.83581084, 'recall': 0.65474916, 'specificity': 0.65474916, 'f1': 0.70865744, 'auroc': 0.8296025, 'binary_precision': 0.7008547, 'binary_recall': 0.31538463, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.43501326}
confusion matrix:
      0   1
0  5911  35
1   178  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_27.png
better model found
persisted
after epoch: 27,now: 2024-06-22 01:31:46.614172,epoch time: 0:12:37.138161,used: 5:55:25.679380,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98732877, 'precision': 0.97926307, 'recall': 0.9440969, 'specificity': 0.9440969, 'f1': 0.9608437, 'auroc': 0.9928313, 'binary_precision': 0.9695444, 'binary_recall': 0.8910479, 'binary_specificity': 0.997146, 'binary_f1_score': 0.92864025}
confusion matrix:
       0     1
0  42276   121
1    471  3852
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.7645695, 'recall': 0.62470984, 'specificity': 0.62470984, 'f1': 0.6670723, 'auroc': 0.8067334, 'binary_precision': 0.5562701, 'binary_recall': 0.25705793, 'binary_specificity': 0.9923618, 'binary_f1_score': 0.351626}
confusion matrix:
       0    1
0  17929  138
1    500  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.8501807, 'recall': 0.6532465, 'specificity': 0.6532465, 'f1': 0.70965016, 'auroc': 0.83711386, 'binary_precision': 0.7297297, 'binary_recall': 0.31153846, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.4366577}
confusion matrix:
      0   1
0  5916  30
1   179  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_28.png
early stop counter: 1
val acc:0.9659551978111267, best validation acc: 0.966488778591156, corresponding to test acc:                         0.9656783938407898 / 0.9676119685173035
after epoch: 28,now: 2024-06-22 01:44:53.541381,epoch time: 0:13:06.927209,used: 6:08:32.606589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98636556, 'precision': 0.9773875, 'recall': 0.94003475, 'specificity': 0.94003475, 'f1': 0.9577615, 'auroc': 0.99231064, 'binary_precision': 0.9665823, 'binary_recall': 0.883183, 'binary_specificity': 0.99688655, 'binary_f1_score': 0.92300254}
confusion matrix:
       0     1
0  42265   132
1    505  3818
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.7715079, 'recall': 0.6263618, 'specificity': 0.6263618, 'f1': 0.6699413, 'auroc': 0.80986273, 'binary_precision': 0.5700326, 'binary_recall': 0.2600297, 'binary_specificity': 0.99269384, 'binary_f1_score': 0.35714287}
confusion matrix:
       0    1
0  17935  132
1    498  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.8392112, 'recall': 0.6510712, 'specificity': 0.6510712, 'f1': 0.705631, 'auroc': 0.84388924, 'binary_precision': 0.7079646, 'binary_recall': 0.30769232, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.42895442}
confusion matrix:
      0   1
0  5913  33
1   180  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_29.png
early stop counter: 2
val acc:0.9663820862770081, best validation acc: 0.966488778591156, corresponding to test acc:                         0.9656783938407898 / 0.9676119685173035
after epoch: 29,now: 2024-06-22 01:57:32.484109,epoch time: 0:12:38.942728,used: 6:21:11.549317,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9871361, 'precision': 0.97923887, 'recall': 0.9429778, 'specificity': 0.9429778, 'f1': 0.9602181, 'auroc': 0.9915035, 'binary_precision': 0.9697276, 'binary_recall': 0.88878614, 'binary_specificity': 0.9971695, 'binary_f1_score': 0.9274943}
confusion matrix:
       0     1
0  42275   120
1    481  3844
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7819409, 'recall': 0.61436826, 'specificity': 0.61436826, 'f1': 0.6595465, 'auroc': 0.80279046, 'binary_precision': 0.5917603, 'binary_recall': 0.23476969, 'binary_specificity': 0.9939669, 'binary_f1_score': 0.3361702}
confusion matrix:
       0    1
0  17958  109
1    515  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.83530086, 'recall': 0.6415399, 'specificity': 0.6415399, 'f1': 0.69535184, 'auroc': 0.82919043, 'binary_precision': 0.7009346, 'binary_recall': 0.28846154, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.40871936}
confusion matrix:
      0   1
0  5914  32
1   185  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_30.png
better model found
persisted
after epoch: 30,now: 2024-06-22 02:09:40.204192,epoch time: 0:12:07.720083,used: 6:33:19.269400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_21_19_36_20_seed_1_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 6:33:19.269400 at 2024-06-22 02:09:40.204192
persisted model performance metric: 

scalar performance:
{'acc': 0.9650338, 'precision': 0.83530086, 'recall': 0.6415399, 'specificity': 0.6415399, 'f1': 0.69535184, 'auroc': 0.82919043, 'binary_precision': 0.7009346, 'binary_recall': 0.28846154, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.40871936}
confusion matrix:
      0   1
0  5914  32
1   185  75
oracle model performance metric: 

scalar performance:
{'acc': 0.96761197, 'precision': 0.8541865, 'recall': 0.6741481, 'specificity': 0.6741481, 'f1': 0.7306048, 'auroc': 0.8453632, 'binary_precision': 0.736, 'binary_recall': 0.35384616, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.4779221}
confusion matrix:
      0   1
0  5913  33
1   168  92
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204385 KiB | 755911 KiB |   1388 TiB |   1388 TiB |
|       from large pool | 167936 KiB | 683776 KiB |   1388 TiB |   1388 TiB |
|       from small pool |  36449 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204385 KiB | 755911 KiB |   1388 TiB |   1388 TiB |
|       from large pool | 167936 KiB | 683776 KiB |   1388 TiB |   1388 TiB |
|       from small pool |  36449 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 748328 KiB |   1388 TiB |   1388 TiB |
|       from large pool | 165120 KiB | 676736 KiB |   1388 TiB |   1388 TiB |
|       from small pool |  35966 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    782 MiB |    930 MiB |   1410 MiB | 643072 KiB |
|       from large pool |    710 MiB |    858 MiB |   1310 MiB | 614400 KiB |
|       from small pool |     72 MiB |     72 MiB |    100 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 104862 KiB | 245592 KiB | 600893 GiB | 600893 GiB |
|       from large pool |  96256 KiB | 244616 KiB | 600544 GiB | 600543 GiB |
|       from small pool |   8606 KiB |  16195 KiB |    349 GiB |    349 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2064    |    3669    |   88710 K  |   88708 K  |
|       from large pool |      36    |      76    |   36423 K  |   36423 K  |
|       from small pool |    2028    |    3632    |   52287 K  |   52285 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2064    |    3669    |   88710 K  |   88708 K  |
|       from large pool |      36    |      76    |   36423 K  |   36423 K  |
|       from small pool |    2028    |    3632    |   52287 K  |   52285 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      51    |      69    |      20    |
|       from large pool |      13    |      15    |      19    |       6    |
|       from small pool |      36    |      36    |      50    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    1476    |   38745 K  |   38745 K  |
|       from large pool |       5    |      11    |   11871 K  |   11871 K  |
|       from small pool |      28    |    1471    |   26874 K  |   26874 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755911 KiB |   1388 TiB |   1388 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1388 TiB |   1388 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755911 KiB |   1388 TiB |   1388 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1388 TiB |   1388 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB |   1388 TiB |   1388 TiB |
|       from large pool |  16640 KiB | 676736 KiB |   1388 TiB |   1388 TiB |
|       from small pool |      0 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    930 MiB |   1410 MiB |   1108 MiB |
|       from large pool | 264192 KiB |    858 MiB |   1310 MiB |   1052 MiB |
|       from small pool |  45056 KiB |     72 MiB |    100 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 245592 KiB | 600893 GiB | 600893 GiB |
|       from large pool |  83712 KiB | 244616 KiB | 600544 GiB | 600544 GiB |
|       from small pool |      0 KiB |  16201 KiB |    349 GiB |    349 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   88710 K  |   88710 K  |
|       from large pool |       2    |      76    |   36423 K  |   36423 K  |
|       from small pool |       0    |    3632    |   52287 K  |   52287 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   88710 K  |   88710 K  |
|       from large pool |       2    |      76    |   36423 K  |   36423 K  |
|       from small pool |       0    |    3632    |   52287 K  |   52287 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      69    |      38    |
|       from large pool |       9    |      15    |      19    |      10    |
|       from small pool |      22    |      36    |      50    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   38746 K  |   38746 K  |
|       from large pool |       1    |      11    |   11871 K  |   11871 K  |
|       from small pool |       0    |    1471    |   26875 K  |   26875 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755911 KiB |   1388 TiB |   1388 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1388 TiB |   1388 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755911 KiB |   1388 TiB |   1388 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   1388 TiB |   1388 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB |   1388 TiB |   1388 TiB |
|       from large pool |  16640 KiB | 676736 KiB |   1388 TiB |   1388 TiB |
|       from small pool |      0 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    930 MiB |   1410 MiB |   1108 MiB |
|       from large pool | 264192 KiB |    858 MiB |   1310 MiB |   1052 MiB |
|       from small pool |  45056 KiB |     72 MiB |    100 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 245592 KiB | 600893 GiB | 600893 GiB |
|       from large pool |  83712 KiB | 244616 KiB | 600544 GiB | 600544 GiB |
|       from small pool |      0 KiB |  16201 KiB |    349 GiB |    349 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3669    |   88710 K  |   88710 K  |
|       from large pool |       2    |      76    |   36423 K  |   36423 K  |
|       from small pool |       0    |    3632    |   52287 K  |   52287 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3669    |   88710 K  |   88710 K  |
|       from large pool |       2    |      76    |   36423 K  |   36423 K  |
|       from small pool |       0    |    3632    |   52287 K  |   52287 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      69    |      38    |
|       from large pool |       9    |      15    |      19    |      10    |
|       from small pool |      22    |      36    |      50    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1476    |   38746 K  |   38746 K  |
|       from large pool |       1    |      11    |   11871 K  |   11871 K  |
|       from small pool |       0    |    1471    |   26875 K  |   26875 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751

 Experiment start at: 2024-06-22 02:14:09.364266
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9031335, 'precision': 0.45156676, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.47455078, 'auroc': 0.7655412, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42310  0
1   4538  0
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.40415686, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.36478364, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-22 02:26:31.853419,epoch time: 0:12:22.489153,used: 0:12:22.489153,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9128458, 'precision': 0.95171976, 'recall': 0.55062467, 'specificity': 0.55062467, 'f1': 0.5689272, 'auroc': 0.90882826, 'binary_precision': 0.9913793, 'binary_recall': 0.10134391, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.18388966}
confusion matrix:
       0    1
0  42305    4
1   4079  460
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.4839655, 'recall': 0.4999725, 'specificity': 0.4999725, 'f1': 0.4918388, 'auroc': 0.5126065, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999945, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18170  1
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.5544599, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_2.png
early stop counter: 1
val acc:0.9678794145584106, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-22 02:38:30.067602,epoch time: 0:11:58.214183,used: 0:24:20.703336,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94603825, 'precision': 0.9593834, 'recall': 0.72687316, 'specificity': 0.72687316, 'f1': 0.7956308, 'auroc': 0.9554484, 'binary_precision': 0.9740566, 'binary_recall': 0.45504627, 'binary_specificity': 0.9987001, 'binary_f1_score': 0.6203064}
confusion matrix:
       0     1
0  42255    55
1   2473  2065
---- Validation: 
scalar performance:
{'acc': 0.96697384, 'precision': 0.5294554, 'recall': 0.5011108, 'specificity': 0.5011108, 'f1': 0.49480906, 'auroc': 0.619932, 'binary_precision': 0.09090909, 'binary_recall': 0.003322259, 'binary_specificity': 0.99889934, 'binary_f1_score': 0.006410256}
confusion matrix:
       0   1
0  18151  20
1    600   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.4805934, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.48994443, 'auroc': 0.6764424, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_3.png
early stop counter: 2
val acc:0.9669738411903381, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 3,now: 2024-06-22 02:50:30.777391,epoch time: 0:12:00.709789,used: 0:36:21.413125,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9592085, 'precision': 0.9651921, 'recall': 0.79716146, 'specificity': 0.79716146, 'f1': 0.85845816, 'auroc': 0.9588195, 'binary_precision': 0.9719828, 'binary_recall': 0.59616655, 'binary_specificity': 0.9981564, 'binary_f1_score': 0.7390413}
confusion matrix:
       0     1
0  42231    78
1   1833  2706
---- Validation: 
scalar performance:
{'acc': 0.9670271, 'precision': 0.60536367, 'recall': 0.50595665, 'specificity': 0.50595665, 'f1': 0.5042134, 'auroc': 0.6534201, 'binary_precision': 0.24242425, 'binary_recall': 0.013289036, 'binary_specificity': 0.9986242, 'binary_f1_score': 0.02519685}
confusion matrix:
       0   1
0  18146  25
1    594   8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.5918495, 'recall': 0.5035486, 'specificity': 0.5035486, 'f1': 0.49786752, 'auroc': 0.69651026, 'binary_precision': 0.22222222, 'binary_recall': 0.008264462, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.015936254}
confusion matrix:
      0  1
0  5990  7
1   240  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_4.png
early stop counter: 3
val acc:0.9670271277427673, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 4,now: 2024-06-22 03:02:23.897664,epoch time: 0:11:53.120273,used: 0:48:14.533398,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96497184, 'precision': 0.97025716, 'recall': 0.8263137, 'specificity': 0.8263137, 'f1': 0.8822409, 'auroc': 0.9688288, 'binary_precision': 0.97633135, 'binary_recall': 0.6543291, 'binary_specificity': 0.9982982, 'binary_f1_score': 0.78353775}
confusion matrix:
       0     1
0  42237    72
1   1569  2970
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.71185976, 'recall': 0.51993865, 'specificity': 0.51993865, 'f1': 0.5298243, 'auroc': 0.6394838, 'binary_precision': 0.45454547, 'binary_recall': 0.04152824, 'binary_specificity': 0.998349, 'binary_f1_score': 0.07610349}
confusion matrix:
       0   1
0  18141  30
1    577  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96008974, 'precision': 0.6280135, 'recall': 0.5093301, 'specificity': 0.5093301, 'f1': 0.509116, 'auroc': 0.6883717, 'binary_precision': 0.29411766, 'binary_recall': 0.020661157, 'binary_specificity': 0.997999, 'binary_f1_score': 0.038610037}
confusion matrix:
      0   1
0  5985  12
1   237   5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_5.png
early stop counter: 4
val acc:0.9676663279533386, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 5,now: 2024-06-22 03:14:11.230924,epoch time: 0:11:47.333260,used: 1:00:01.866658,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96680754, 'precision': 0.9708241, 'recall': 0.8362788, 'specificity': 0.8362788, 'f1': 0.8896848, 'auroc': 0.9697666, 'binary_precision': 0.9754621, 'binary_recall': 0.6743776, 'binary_specificity': 0.99818003, 'binary_f1_score': 0.79744697}
confusion matrix:
       0     1
0  42232    77
1   1478  3061
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.7318804, 'recall': 0.5320944, 'specificity': 0.5320944, 'f1': 0.55038625, 'auroc': 0.6901349, 'binary_precision': 0.49382716, 'binary_recall': 0.06644518, 'binary_specificity': 0.99774367, 'binary_f1_score': 0.11713031}
confusion matrix:
       0   1
0  18130  41
1    562  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.7115904, 'recall': 0.53345644, 'specificity': 0.53345644, 'f1': 0.5508901, 'auroc': 0.73690283, 'binary_precision': 0.45945945, 'binary_recall': 0.07024793, 'binary_specificity': 0.996665, 'binary_f1_score': 0.1218638}
confusion matrix:
      0   1
0  5977  20
1   225  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_6.png
early stop counter: 5
val acc:0.9678794145584106, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 6,now: 2024-06-22 03:26:15.716970,epoch time: 0:12:04.486046,used: 1:12:06.352704,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97587943, 'precision': 0.97592753, 'recall': 0.8839804, 'specificity': 0.8839804, 'f1': 0.9238164, 'auroc': 0.98238564, 'binary_precision': 0.97598433, 'binary_recall': 0.76999336, 'binary_specificity': 0.99796736, 'binary_f1_score': 0.8608374}
confusion matrix:
       0     1
0  42223    86
1   1044  3495
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.7588167, 'recall': 0.5678413, 'specificity': 0.5678413, 'f1': 0.6031198, 'auroc': 0.71445477, 'binary_precision': 0.54545456, 'binary_recall': 0.13953489, 'binary_specificity': 0.9961477, 'binary_f1_score': 0.22222224}
confusion matrix:
       0   1
0  18101  70
1    518  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.77348554, 'recall': 0.5802268, 'specificity': 0.5802268, 'f1': 0.6191245, 'auroc': 0.7449069, 'binary_precision': 0.5797101, 'binary_recall': 0.16528925, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.25723472}
confusion matrix:
      0   1
0  5968  29
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-22 03:38:43.214763,epoch time: 0:12:27.497793,used: 1:24:33.850497,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97664785, 'precision': 0.97803414, 'recall': 0.8866676, 'specificity': 0.8866676, 'f1': 0.92632556, 'auroc': 0.98302376, 'binary_precision': 0.9796714, 'binary_recall': 0.7750606, 'binary_specificity': 0.9982746, 'binary_f1_score': 0.8654367}
confusion matrix:
       0     1
0  42236    73
1   1021  3518
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.7542871, 'recall': 0.5718015, 'specificity': 0.5718015, 'f1': 0.6078643, 'auroc': 0.7217938, 'binary_precision': 0.53614455, 'binary_recall': 0.14784053, 'binary_specificity': 0.99576247, 'binary_f1_score': 0.23177083}
confusion matrix:
       0   1
0  18094  77
1    513  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.78378993, 'recall': 0.5844424, 'specificity': 0.5844424, 'f1': 0.625245, 'auroc': 0.7459949, 'binary_precision': 0.6, 'binary_recall': 0.17355372, 'binary_specificity': 0.995331, 'binary_f1_score': 0.26923078}
confusion matrix:
      0   1
0  5969  28
1   200  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_8.png
new oracle model saved
early stop counter: 1
val acc:0.9685719013214111, best validation acc: 0.9686784148216248, corresponding to test acc:                         0.9629748463630676 / 0.9634556770324707
after epoch: 8,now: 2024-06-22 03:51:39.120388,epoch time: 0:12:55.905625,used: 1:37:29.756122,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9783982, 'precision': 0.9770547, 'recall': 0.8974482, 'specificity': 0.8974482, 'f1': 0.9327153, 'auroc': 0.9817066, 'binary_precision': 0.97545844, 'binary_recall': 0.79704714, 'binary_specificity': 0.9978492, 'binary_f1_score': 0.87727386}
confusion matrix:
       0     1
0  42219    91
1    921  3617
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.74926925, 'recall': 0.57332504, 'specificity': 0.57332504, 'f1': 0.6093559, 'auroc': 0.75481576, 'binary_precision': 0.5260116, 'binary_recall': 0.15116279, 'binary_specificity': 0.99548733, 'binary_f1_score': 0.23483871}
confusion matrix:
       0   1
0  18089  82
1    511  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.81142235, 'recall': 0.6031208, 'specificity': 0.6031208, 'f1': 0.6504097, 'auroc': 0.78144974, 'binary_precision': 0.65384614, 'binary_recall': 0.2107438, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.31875}
confusion matrix:
      0   1
0  5970  27
1   191  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_9.png
new oracle model saved
early stop counter: 2
val acc:0.9684121012687683, best validation acc: 0.9686784148216248, corresponding to test acc:                         0.9629748463630676 / 0.9650585055351257
after epoch: 9,now: 2024-06-22 04:03:57.716384,epoch time: 0:12:18.595996,used: 1:49:48.352118,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97957224, 'precision': 0.97717243, 'recall': 0.90411913, 'specificity': 0.90411913, 'f1': 0.9368491, 'auroc': 0.98502934, 'binary_precision': 0.9743114, 'binary_recall': 0.81053096, 'binary_specificity': 0.99770737, 'binary_f1_score': 0.88490677}
confusion matrix:
       0     1
0  42212    97
1    860  3679
---- Validation: 
scalar performance:
{'acc': 0.968199, 'precision': 0.74247694, 'recall': 0.59088206, 'specificity': 0.59088206, 'f1': 0.6291741, 'auroc': 0.7554999, 'binary_precision': 0.51131225, 'binary_recall': 0.18770765, 'binary_specificity': 0.99405646, 'binary_f1_score': 0.2746051}
confusion matrix:
       0    1
0  18063  108
1    489  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.7930654, 'recall': 0.634928, 'specificity': 0.634928, 'f1': 0.6819362, 'auroc': 0.76630133, 'binary_precision': 0.6146789, 'binary_recall': 0.2768595, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.38176638}
confusion matrix:
      0   1
0  5955  42
1   175  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_10.png
new oracle model saved
early stop counter: 3
val acc:0.9681990146636963, best validation acc: 0.9686784148216248, corresponding to test acc:                         0.9629748463630676 / 0.9652187824249268
after epoch: 10,now: 2024-06-22 04:18:01.139450,epoch time: 0:14:03.423066,used: 2:03:51.775184,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9788678, 'precision': 0.9766841, 'recall': 0.90048397, 'specificity': 0.90048397, 'f1': 0.93443656, 'auroc': 0.9850998, 'binary_precision': 0.974085, 'binary_recall': 0.8032606, 'binary_specificity': 0.99770737, 'binary_f1_score': 0.88046366}
confusion matrix:
       0     1
0  42212    97
1    893  3646
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.7390357, 'recall': 0.58839035, 'specificity': 0.58839035, 'f1': 0.62597775, 'auroc': 0.7533619, 'binary_precision': 0.5045872, 'binary_recall': 0.18272425, 'binary_specificity': 0.99405646, 'binary_f1_score': 0.2682927}
confusion matrix:
       0    1
0  18063  108
1    492  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.8399429, 'recall': 0.6239487, 'specificity': 0.6239487, 'f1': 0.6774982, 'auroc': 0.7682238, 'binary_precision': 0.7093023, 'binary_recall': 0.2520661, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.3719512}
confusion matrix:
      0   1
0  5972  25
1   181  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_11.png
new oracle model saved
early stop counter: 4
val acc:0.9680392146110535, best validation acc: 0.9686784148216248, corresponding to test acc:                         0.9629748463630676 / 0.9669818878173828
after epoch: 11,now: 2024-06-22 04:31:26.270293,epoch time: 0:13:25.130843,used: 2:17:16.906027,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9803193, 'precision': 0.97779924, 'recall': 0.9078562, 'specificity': 0.9078562, 'f1': 0.9393627, 'auroc': 0.9868574, 'binary_precision': 0.9747899, 'binary_recall': 0.8179815, 'binary_specificity': 0.99773103, 'binary_f1_score': 0.889528}
confusion matrix:
       0     1
0  42214    96
1    826  3712
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.7359239, 'recall': 0.5955352, 'specificity': 0.5955352, 'f1': 0.6332841, 'auroc': 0.7687305, 'binary_precision': 0.49790794, 'binary_recall': 0.19767442, 'binary_specificity': 0.99339604, 'binary_f1_score': 0.28299645}
confusion matrix:
       0    1
0  18051  120
1    483  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.8309097, 'recall': 0.63997734, 'specificity': 0.63997734, 'f1': 0.6933496, 'auroc': 0.7825178, 'binary_precision': 0.69, 'binary_recall': 0.28512397, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.40350878}
confusion matrix:
      0   1
0  5966  31
1   173  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_12.png
new oracle model saved
early stop counter: 5
val acc:0.9678794145584106, best validation acc: 0.9686784148216248, corresponding to test acc:                         0.9629748463630676 / 0.9673024415969849
after epoch: 12,now: 2024-06-22 04:45:19.651914,epoch time: 0:13:53.381621,used: 2:31:10.287648,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98288083, 'precision': 0.975475, 'recall': 0.9248319, 'specificity': 0.9248319, 'f1': 0.9483572, 'auroc': 0.98934484, 'binary_precision': 0.9665418, 'binary_recall': 0.852831, 'binary_specificity': 0.99683285, 'binary_f1_score': 0.90613294}
confusion matrix:
       0     1
0  42175   134
1    668  3871
---- Validation: 
scalar performance:
{'acc': 0.9673467, 'precision': 0.7289984, 'recall': 0.6209576, 'specificity': 0.6209576, 'f1': 0.6566601, 'auroc': 0.790246, 'binary_precision': 0.4824281, 'binary_recall': 0.25083056, 'binary_specificity': 0.9910847, 'binary_f1_score': 0.33005464}
confusion matrix:
       0    1
0  18009  162
1    451  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.79790664, 'recall': 0.65318954, 'specificity': 0.65318954, 'f1': 0.700041, 'auroc': 0.8029752, 'binary_precision': 0.6229508, 'binary_recall': 0.3140496, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.41758242}
confusion matrix:
      0   1
0  5951  46
1   166  76
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_13.png
early stop counter: 6
val acc:0.967346727848053, best validation acc: 0.9686784148216248, corresponding to test acc:                         0.9629748463630676 / 0.9673024415969849
after epoch: 13,now: 2024-06-22 04:58:06.439776,epoch time: 0:12:46.787862,used: 2:43:57.075510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9824112, 'precision': 0.9735563, 'recall': 0.92388356, 'specificity': 0.92388356, 'f1': 0.94698524, 'auroc': 0.98835313, 'binary_precision': 0.96287066, 'binary_recall': 0.85128886, 'binary_specificity': 0.9964783, 'binary_f1_score': 0.90364826}
confusion matrix:
       0     1
0  42160   149
1    675  3864
---- Validation: 
scalar performance:
{'acc': 0.96649444, 'precision': 0.71813387, 'recall': 0.62533563, 'specificity': 0.62533563, 'f1': 0.6578977, 'auroc': 0.7904596, 'binary_precision': 0.46041057, 'binary_recall': 0.26079735, 'binary_specificity': 0.98987395, 'binary_f1_score': 0.33297986}
confusion matrix:
       0    1
0  17987  184
1    445  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.7959808, 'recall': 0.6631866, 'specificity': 0.6631866, 'f1': 0.70844275, 'auroc': 0.7991688, 'binary_precision': 0.6183206, 'binary_recall': 0.33471075, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.43431637}
confusion matrix:
      0   1
0  5947  50
1   161  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_14.png
early stop counter: 7
val acc:0.9664944410324097, best validation acc: 0.9686784148216248, corresponding to test acc:                         0.9629748463630676 / 0.9673024415969849
after epoch: 14,now: 2024-06-22 05:11:11.048296,epoch time: 0:13:04.608520,used: 2:57:01.684030,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9827741, 'precision': 0.9779587, 'recall': 0.921921, 'specificity': 0.921921, 'f1': 0.9477434, 'auroc': 0.9880717, 'binary_precision': 0.972166, 'binary_recall': 0.8464419, 'binary_specificity': 0.9974001, 'binary_f1_score': 0.9049582}
confusion matrix:
       0     1
0  42199   110
1    697  3842
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.7346768, 'recall': 0.60913205, 'specificity': 0.60913205, 'f1': 0.64682466, 'auroc': 0.7835995, 'binary_precision': 0.49454546, 'binary_recall': 0.22591361, 'binary_specificity': 0.99235046, 'binary_f1_score': 0.3101482}
confusion matrix:
       0    1
0  18032  139
1    466  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.81946933, 'recall': 0.6457588, 'specificity': 0.6457588, 'f1': 0.6972215, 'auroc': 0.79039603, 'binary_precision': 0.6666667, 'binary_recall': 0.29752067, 'binary_specificity': 0.993997, 'binary_f1_score': 0.41142857}
confusion matrix:
      0   1
0  5961  36
1   170  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_15.png
early stop counter: 8
val acc:0.9677728414535522, best validation acc: 0.9686784148216248, corresponding to test acc:                         0.9629748463630676 / 0.9673024415969849
after epoch: 15,now: 2024-06-22 05:25:07.074241,epoch time: 0:13:56.025945,used: 3:10:57.709975,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9839267, 'precision': 0.97749513, 'recall': 0.9290495, 'specificity': 0.9290495, 'f1': 0.9516398, 'auroc': 0.9895033, 'binary_precision': 0.96972704, 'binary_recall': 0.8609826, 'binary_specificity': 0.99711645, 'binary_f1_score': 0.91212505}
confusion matrix:
       0     1
0  42187   122
1    631  3908
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.75073963, 'recall': 0.62327915, 'specificity': 0.62327915, 'f1': 0.6633251, 'auroc': 0.7894627, 'binary_precision': 0.52577317, 'binary_recall': 0.25415283, 'binary_specificity': 0.9924055, 'binary_f1_score': 0.3426652}
confusion matrix:
       0    1
0  18033  138
1    449  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96842444, 'precision': 0.8362536, 'recall': 0.6603884, 'specificity': 0.6603884, 'f1': 0.7144102, 'auroc': 0.8019583, 'binary_precision': 0.69911504, 'binary_recall': 0.3264463, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.44507045}
confusion matrix:
      0   1
0  5963  34
1   163  79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_16.png
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-06-22 05:42:59.034279,epoch time: 0:17:51.960038,used: 3:28:49.670013,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98377734, 'precision': 0.9748873, 'recall': 0.9306237, 'specificity': 0.9306237, 'f1': 0.9513891, 'auroc': 0.99025255, 'binary_precision': 0.9641278, 'binary_recall': 0.8646981, 'binary_specificity': 0.9965493, 'binary_f1_score': 0.91171}
confusion matrix:
       0     1
0  42164   146
1    614  3924
---- Validation: 
scalar performance:
{'acc': 0.9665477, 'precision': 0.7197485, 'recall': 0.63098454, 'specificity': 0.63098454, 'f1': 0.66296655, 'auroc': 0.80590886, 'binary_precision': 0.46327683, 'binary_recall': 0.27242523, 'binary_specificity': 0.9895438, 'binary_f1_score': 0.34309626}
confusion matrix:
       0    1
0  17981  190
1    438  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.77345216, 'recall': 0.6743327, 'specificity': 0.6743327, 'f1': 0.7117092, 'auroc': 0.8162175, 'binary_precision': 0.57236844, 'binary_recall': 0.35950413, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.44162437}
confusion matrix:
      0   1
0  5932  65
1   155  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_17.png
early stop counter: 1
val acc:0.9665477275848389, best validation acc: 0.968731701374054, corresponding to test acc:                         0.9684244394302368 / 0.9684244394302368
after epoch: 17,now: 2024-06-22 05:59:17.140720,epoch time: 0:16:18.106441,used: 3:45:07.776454,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9846098, 'precision': 0.97017586, 'recall': 0.9402324, 'specificity': 0.9402324, 'f1': 0.9545794, 'auroc': 0.9915993, 'binary_precision': 0.95257294, 'binary_recall': 0.88519174, 'binary_specificity': 0.995273, 'binary_f1_score': 0.91764706}
confusion matrix:
       0     1
0  42110   200
1    521  4017
---- Validation: 
scalar performance:
{'acc': 0.96633464, 'precision': 0.71978164, 'recall': 0.64693546, 'specificity': 0.64693546, 'f1': 0.6753534, 'auroc': 0.8104958, 'binary_precision': 0.46231157, 'binary_recall': 0.30564785, 'binary_specificity': 0.988223, 'binary_f1_score': 0.368}
confusion matrix:
       0    1
0  17957  214
1    418  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96666133, 'precision': 0.7950371, 'recall': 0.68326414, 'specificity': 0.68326414, 'f1': 0.7247298, 'auroc': 0.8181582, 'binary_precision': 0.6148649, 'binary_recall': 0.37603307, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.4666667}
confusion matrix:
      0   1
0  5940  57
1   151  91
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_18.png
early stop counter: 2
val acc:0.9663346409797668, best validation acc: 0.968731701374054, corresponding to test acc:                         0.9684244394302368 / 0.9684244394302368
after epoch: 18,now: 2024-06-22 06:19:26.960433,epoch time: 0:20:09.819713,used: 4:05:17.596167,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9846952, 'precision': 0.9766983, 'recall': 0.93429357, 'specificity': 0.93429357, 'f1': 0.95424926, 'auroc': 0.9901968, 'binary_precision': 0.96700877, 'binary_recall': 0.87177795, 'binary_specificity': 0.9968092, 'binary_f1_score': 0.91692734}
confusion matrix:
       0     1
0  42174   135
1    582  3957
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.74027616, 'recall': 0.61893374, 'specificity': 0.61893374, 'f1': 0.65719146, 'auroc': 0.79188883, 'binary_precision': 0.50511944, 'binary_recall': 0.24584718, 'binary_specificity': 0.99202025, 'binary_f1_score': 0.33072627}
confusion matrix:
       0    1
0  18026  145
1    454  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9677833, 'precision': 0.8304151, 'recall': 0.6521239, 'specificity': 0.6521239, 'f1': 0.7053879, 'auroc': 0.7913258, 'binary_precision': 0.6880734, 'binary_recall': 0.30991736, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.42735043}
confusion matrix:
      0   1
0  5963  34
1   167  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_19.png
early stop counter: 3
val acc:0.9680925011634827, best validation acc: 0.968731701374054, corresponding to test acc:                         0.9684244394302368 / 0.9684244394302368
after epoch: 19,now: 2024-06-22 06:46:18.354189,epoch time: 0:26:51.393756,used: 4:32:08.989923,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98448175, 'precision': 0.97360194, 'recall': 0.9360438, 'specificity': 0.9360438, 'f1': 0.9538417, 'auroc': 0.99131703, 'binary_precision': 0.96038646, 'binary_recall': 0.87596387, 'binary_specificity': 0.99612373, 'binary_f1_score': 0.91623455}
confusion matrix:
       0     1
0  42145   164
1    563  3976
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.738101, 'recall': 0.6308969, 'specificity': 0.6308969, 'f1': 0.6674266, 'auroc': 0.80811584, 'binary_precision': 0.5, 'binary_recall': 0.2707641, 'binary_specificity': 0.9910297, 'binary_f1_score': 0.3512931}
confusion matrix:
       0    1
0  18008  163
1    439  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.80891097, 'recall': 0.6575719, 'specificity': 0.6575719, 'f1': 0.7063329, 'auroc': 0.8064356, 'binary_precision': 0.6446281, 'binary_recall': 0.32231405, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.42975205}
confusion matrix:
      0   1
0  5954  43
1   164  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_20.png
early stop counter: 4
val acc:0.9679326415061951, best validation acc: 0.968731701374054, corresponding to test acc:                         0.9684244394302368 / 0.9684244394302368
after epoch: 20,now: 2024-06-22 07:17:50.405969,epoch time: 0:31:32.051780,used: 5:03:41.041703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9850154, 'precision': 0.97682935, 'recall': 0.9360442, 'specificity': 0.9360442, 'f1': 0.95528543, 'auroc': 0.99074197, 'binary_precision': 0.9669019, 'binary_recall': 0.8753029, 'binary_specificity': 0.9967856, 'binary_f1_score': 0.91882515}
confusion matrix:
       0     1
0  42173   136
1    566  3973
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.750013, 'recall': 0.6208425, 'specificity': 0.6208425, 'f1': 0.66089886, 'auroc': 0.78819937, 'binary_precision': 0.5244755, 'binary_recall': 0.24916944, 'binary_specificity': 0.99251556, 'binary_f1_score': 0.33783787}
confusion matrix:
       0    1
0  18035  136
1    452  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96970665, 'precision': 0.8629039, 'recall': 0.6610554, 'specificity': 0.6610554, 'f1': 0.71987575, 'auroc': 0.8007594, 'binary_precision': 0.75238097, 'binary_recall': 0.3264463, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.45533144}
confusion matrix:
      0   1
0  5971  26
1   163  79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_21.png
new oracle model saved
early stop counter: 5
val acc:0.9686784148216248, best validation acc: 0.968731701374054, corresponding to test acc:                         0.9684244394302368 / 0.969706654548645
after epoch: 21,now: 2024-06-22 07:50:33.991656,epoch time: 0:32:43.585687,used: 5:36:24.627390,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98612535, 'precision': 0.9778392, 'recall': 0.9415757, 'specificity': 0.9415757, 'f1': 0.95880294, 'auroc': 0.99253416, 'binary_precision': 0.9677652, 'binary_recall': 0.88631856, 'binary_specificity': 0.99683285, 'binary_f1_score': 0.925253}
confusion matrix:
       0     1
0  42175   134
1    516  4023
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.737152, 'recall': 0.62605107, 'specificity': 0.62605107, 'f1': 0.6629793, 'auroc': 0.817011, 'binary_precision': 0.4984127, 'binary_recall': 0.26079735, 'binary_specificity': 0.9913048, 'binary_f1_score': 0.34242094}
confusion matrix:
       0    1
0  18013  158
1    445  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9679436, 'precision': 0.8336029, 'recall': 0.6522073, 'specificity': 0.6522073, 'f1': 0.7060403, 'auroc': 0.8211387, 'binary_precision': 0.6944444, 'binary_recall': 0.30991736, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.42857143}
confusion matrix:
      0   1
0  5964  33
1   167  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_22.png
early stop counter: 6
val acc:0.9678794145584106, best validation acc: 0.968731701374054, corresponding to test acc:                         0.9684244394302368 / 0.969706654548645
after epoch: 22,now: 2024-06-22 08:22:31.793514,epoch time: 0:31:57.801858,used: 6:08:22.429248,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98589057, 'precision': 0.97756785, 'recall': 0.94046235, 'specificity': 0.94046235, 'f1': 0.9580668, 'auroc': 0.9917015, 'binary_precision': 0.9674542, 'binary_recall': 0.88411546, 'binary_specificity': 0.9968092, 'binary_f1_score': 0.9239093}
confusion matrix:
       0     1
0  42174   135
1    526  4013
---- Validation: 
scalar performance:
{'acc': 0.9671869, 'precision': 0.72822124, 'recall': 0.6345269, 'specificity': 0.6345269, 'f1': 0.6680539, 'auroc': 0.82171404, 'binary_precision': 0.48, 'binary_recall': 0.27906978, 'binary_specificity': 0.98998404, 'binary_f1_score': 0.3529412}
confusion matrix:
       0    1
0  17989  182
1    434  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.82281476, 'recall': 0.6579888, 'specificity': 0.6579888, 'f1': 0.7095437, 'auroc': 0.821543, 'binary_precision': 0.67241377, 'binary_recall': 0.32231405, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.43575418}
confusion matrix:
      0   1
0  5959  38
1   164  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_23.png
early stop counter: 7
val acc:0.9671869277954102, best validation acc: 0.968731701374054, corresponding to test acc:                         0.9684244394302368 / 0.969706654548645
after epoch: 23,now: 2024-06-22 08:55:13.487697,epoch time: 0:32:41.694183,used: 6:41:04.123431,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9852715, 'precision': 0.9743042, 'recall': 0.9400213, 'specificity': 0.9400213, 'f1': 0.95634884, 'auroc': 0.99269515, 'binary_precision': 0.96095806, 'binary_recall': 0.88389516, 'binary_specificity': 0.9961474, 'binary_f1_score': 0.9208171}
confusion matrix:
       0     1
0  42146   163
1    527  4012
---- Validation: 
scalar performance:
{'acc': 0.96649444, 'precision': 0.71987236, 'recall': 0.6357753, 'specificity': 0.6357753, 'f1': 0.6668403, 'auroc': 0.8174105, 'binary_precision': 0.46321526, 'binary_recall': 0.28239202, 'binary_specificity': 0.9891586, 'binary_f1_score': 0.3508772}
confusion matrix:
       0    1
0  17974  197
1    432  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.80481744, 'recall': 0.6755833, 'specificity': 0.6755833, 'f1': 0.7210797, 'auroc': 0.82093835, 'binary_precision': 0.63503647, 'binary_recall': 0.35950413, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.4591029}
confusion matrix:
      0   1
0  5947  50
1   155  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_24.png
early stop counter: 8
val acc:0.9664944410324097, best validation acc: 0.968731701374054, corresponding to test acc:                         0.9684244394302368 / 0.969706654548645
after epoch: 24,now: 2024-06-22 09:30:45.608332,epoch time: 0:35:32.120635,used: 7:16:36.244066,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98580515, 'precision': 0.9746026, 'recall': 0.9428493, 'specificity': 0.9428493, 'f1': 0.95802975, 'auroc': 0.9918226, 'binary_precision': 0.9609524, 'binary_recall': 0.8895746, 'binary_specificity': 0.9961239, 'binary_f1_score': 0.9238869}
confusion matrix:
       0     1
0  42147   164
1    501  4036
---- Validation: 
scalar performance:
{'acc': 0.9673467, 'precision': 0.7294775, 'recall': 0.62577593, 'specificity': 0.62577593, 'f1': 0.6609936, 'auroc': 0.80847347, 'binary_precision': 0.48307693, 'binary_recall': 0.26079735, 'binary_specificity': 0.9907545, 'binary_f1_score': 0.3387271}
confusion matrix:
       0    1
0  18003  168
1    445  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.8081191, 'recall': 0.67368394, 'specificity': 0.67368394, 'f1': 0.720295, 'auroc': 0.8063467, 'binary_precision': 0.64179105, 'binary_recall': 0.3553719, 'binary_specificity': 0.991996, 'binary_f1_score': 0.45744678}
confusion matrix:
      0   1
0  5949  48
1   156  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_25.png
early stop counter: 9
val acc:0.967346727848053, best validation acc: 0.968731701374054, corresponding to test acc:                         0.9684244394302368 / 0.969706654548645
after epoch: 25,now: 2024-06-22 10:14:03.129786,epoch time: 0:43:17.521454,used: 7:59:53.765520,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.986723, 'precision': 0.9831106, 'recall': 0.9400382, 'specificity': 0.9400382, 'f1': 0.96030694, 'auroc': 0.9928094, 'binary_precision': 0.9787338, 'binary_recall': 0.88213265, 'binary_specificity': 0.9979437, 'binary_f1_score': 0.9279259}
confusion matrix:
       0     1
0  42222    87
1    535  4004
---- Validation: 
scalar performance:
{'acc': 0.9687849, 'precision': 0.7538787, 'recall': 0.6032305, 'specificity': 0.6032305, 'f1': 0.64403623, 'auroc': 0.8070013, 'binary_precision': 0.53333336, 'binary_recall': 0.21262458, 'binary_specificity': 0.99383634, 'binary_f1_score': 0.304038}
confusion matrix:
       0    1
0  18059  112
1    474  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9681039, 'precision': 0.84907913, 'recall': 0.6403942, 'specificity': 0.6403942, 'f1': 0.6965524, 'auroc': 0.8076607, 'binary_precision': 0.7263158, 'binary_recall': 0.28512397, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.40949556}
confusion matrix:
      0   1
0  5971  26
1   173  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_26.png
better model found
persisted
after epoch: 26,now: 2024-06-22 10:30:48.898058,epoch time: 0:16:45.768272,used: 8:16:39.533792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98744875, 'precision': 0.978592, 'recall': 0.9485911, 'specificity': 0.9485911, 'f1': 0.962977, 'auroc': 0.9937116, 'binary_precision': 0.9677878, 'binary_recall': 0.90039665, 'binary_specificity': 0.99678564, 'binary_f1_score': 0.93287677}
confusion matrix:
       0     1
0  42174   136
1    452  4086
---- Validation: 
scalar performance:
{'acc': 0.9681457, 'precision': 0.74126065, 'recall': 0.63662827, 'specificity': 0.63662827, 'f1': 0.67306906, 'auroc': 0.813506, 'binary_precision': 0.50595236, 'binary_recall': 0.28239202, 'binary_specificity': 0.9908646, 'binary_f1_score': 0.36247334}
confusion matrix:
       0    1
0  18005  166
1    432  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.82728535, 'recall': 0.65204054, 'specificity': 0.65204054, 'f1': 0.704739, 'auroc': 0.8128513, 'binary_precision': 0.6818182, 'binary_recall': 0.30991736, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.42613634}
confusion matrix:
      0   1
0  5962  35
1   167  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_27.png
early stop counter: 1
val acc:0.9681457281112671, best validation acc: 0.9687849283218384, corresponding to test acc:                         0.9681038856506348 / 0.969706654548645
after epoch: 27,now: 2024-06-22 10:44:06.462648,epoch time: 0:13:17.564590,used: 8:29:57.098382,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98674434, 'precision': 0.9725489, 'recall': 0.95057225, 'specificity': 0.95057225, 'f1': 0.9612282, 'auroc': 0.993276, 'binary_precision': 0.955158, 'binary_recall': 0.9057061, 'binary_specificity': 0.99543834, 'binary_f1_score': 0.92977494}
confusion matrix:
       0     1
0  42116   193
1    428  4111
---- Validation: 
scalar performance:
{'acc': 0.9671869, 'precision': 0.72894335, 'recall': 0.6417543, 'specificity': 0.6417543, 'f1': 0.67405343, 'auroc': 0.8158107, 'binary_precision': 0.48097825, 'binary_recall': 0.29401994, 'binary_specificity': 0.9894887, 'binary_f1_score': 0.36494845}
confusion matrix:
       0    1
0  17980  191
1    425  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.81462705, 'recall': 0.6617875, 'specificity': 0.6617875, 'f1': 0.7113602, 'auroc': 0.814632, 'binary_precision': 0.6557377, 'binary_recall': 0.3305785, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.43956044}
confusion matrix:
      0   1
0  5955  42
1   162  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_28.png
early stop counter: 2
val acc:0.9671869277954102, best validation acc: 0.9687849283218384, corresponding to test acc:                         0.9681038856506348 / 0.969706654548645
after epoch: 28,now: 2024-06-22 10:56:36.967941,epoch time: 0:12:30.505293,used: 8:42:27.603675,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9869151, 'precision': 0.97008276, 'recall': 0.9541975, 'specificity': 0.9541975, 'f1': 0.9619664, 'auroc': 0.99314576, 'binary_precision': 0.94939315, 'binary_recall': 0.9136183, 'binary_specificity': 0.99477667, 'binary_f1_score': 0.9311623}
confusion matrix:
       0     1
0  42089   221
1    392  4146
---- Validation: 
scalar performance:
{'acc': 0.9665477, 'precision': 0.7227744, 'recall': 0.65186375, 'specificity': 0.65186375, 'f1': 0.67989826, 'auroc': 0.81366885, 'binary_precision': 0.4679803, 'binary_recall': 0.3156146, 'binary_specificity': 0.9881129, 'binary_f1_score': 0.37698412}
confusion matrix:
       0    1
0  17955  216
1    412  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.7959808, 'recall': 0.6631866, 'specificity': 0.6631866, 'f1': 0.70844275, 'auroc': 0.8137822, 'binary_precision': 0.6183206, 'binary_recall': 0.33471075, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.43431637}
confusion matrix:
      0   1
0  5947  50
1   161  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_29.png
early stop counter: 3
val acc:0.9665477275848389, best validation acc: 0.9687849283218384, corresponding to test acc:                         0.9681038856506348 / 0.969706654548645
after epoch: 29,now: 2024-06-22 11:09:05.078573,epoch time: 0:12:28.110632,used: 8:54:55.714307,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98721397, 'precision': 0.979226, 'recall': 0.94660366, 'specificity': 0.94660366, 'f1': 0.9621875, 'auroc': 0.99222416, 'binary_precision': 0.96949476, 'binary_recall': 0.89623266, 'binary_specificity': 0.99697465, 'binary_f1_score': 0.9314253}
confusion matrix:
       0     1
0  42181   128
1    471  4068
---- Validation: 
scalar performance:
{'acc': 0.9675065, 'precision': 0.7324706, 'recall': 0.63549507, 'specificity': 0.63549507, 'f1': 0.6699363, 'auroc': 0.8146497, 'binary_precision': 0.4884393, 'binary_recall': 0.2807309, 'binary_specificity': 0.99025923, 'binary_f1_score': 0.3565401}
confusion matrix:
       0    1
0  17994  177
1    433  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.80722135, 'recall': 0.66558623, 'specificity': 0.66558623, 'f1': 0.71311486, 'auroc': 0.82280725, 'binary_precision': 0.640625, 'binary_recall': 0.338843, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.44324327}
confusion matrix:
      0   1
0  5951  46
1   160  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21520751_30.png
early stop counter: 4
val acc:0.9675065279006958, best validation acc: 0.9687849283218384, corresponding to test acc:                         0.9681038856506348 / 0.969706654548645
after epoch: 30,now: 2024-06-22 11:21:21.629981,epoch time: 0:12:16.551408,used: 9:07:12.265715,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_22_02_14_09_seed_2_21520751
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:07:12.265715 at 2024-06-22 11:21:21.629981
persisted model performance metric: 

scalar performance:
{'acc': 0.9681039, 'precision': 0.84907913, 'recall': 0.6403942, 'specificity': 0.6403942, 'f1': 0.6965524, 'auroc': 0.8076607, 'binary_precision': 0.7263158, 'binary_recall': 0.28512397, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.40949556}
confusion matrix:
      0   1
0  5971  26
1   173  69
oracle model performance metric: 

scalar performance:
{'acc': 0.96970665, 'precision': 0.8629039, 'recall': 0.6610554, 'specificity': 0.6610554, 'f1': 0.71987575, 'auroc': 0.8007594, 'binary_precision': 0.75238097, 'binary_recall': 0.3264463, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.45533144}
confusion matrix:
      0   1
0  5971  26
1   163  79
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_differentbatchsizes_lre5_classbalancing3/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204388 KiB | 755914 KiB |   2084 TiB |   2084 TiB |
|       from large pool | 167936 KiB | 683776 KiB |   2084 TiB |   2084 TiB |
|       from small pool |  36452 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204388 KiB | 755914 KiB |   2084 TiB |   2084 TiB |
|       from large pool | 167936 KiB | 683776 KiB |   2084 TiB |   2084 TiB |
|       from small pool |  36452 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB | 748328 KiB |   2084 TiB |   2084 TiB |
|       from large pool | 165120 KiB | 676736 KiB |   2084 TiB |   2084 TiB |
|       from small pool |  35967 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    782 MiB |    930 MiB |   1890 MiB |   1108 MiB |
|       from large pool |    710 MiB |    858 MiB |   1762 MiB |   1052 MiB |
|       from small pool |     72 MiB |     72 MiB |    128 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 104859 KiB | 245592 KiB |    895 TiB |    895 TiB |
|       from large pool |  96256 KiB | 244616 KiB |    895 TiB |    895 TiB |
|       from small pool |   8603 KiB |  16201 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2070    |    3677    |  133152 K  |  133150 K  |
|       from large pool |      36    |      76    |   54671 K  |   54671 K  |
|       from small pool |    2034    |    3640    |   78480 K  |   78478 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2070    |    3677    |  133152 K  |  133150 K  |
|       from large pool |      36    |      76    |   54671 K  |   54671 K  |
|       from small pool |    2034    |    3640    |   78480 K  |   78478 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |      51    |      87    |      38    |
|       from large pool |      13    |      15    |      23    |      10    |
|       from small pool |      36    |      36    |      64    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    1480    |   58337 K  |   58337 K  |
|       from large pool |       5    |      11    |   17996 K  |   17996 K  |
|       from small pool |      28    |    1475    |   40340 K  |   40340 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 755914 KiB |   2084 TiB |   2084 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   2084 TiB |   2084 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 755914 KiB |   2084 TiB |   2084 TiB |
|       from large pool |  16640 KiB | 683776 KiB |   2084 TiB |   2084 TiB |
|       from small pool |      0 KiB |  73422 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 748328 KiB |   2084 TiB |   2084 TiB |
|       from large pool |  16640 KiB | 676736 KiB |   2084 TiB |   2084 TiB |
|       from small pool |      0 KiB |  72872 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 309248 KiB |    930 MiB |   1890 MiB |   1588 MiB |
|       from large pool | 264192 KiB |    858 MiB |   1762 MiB |   1504 MiB |
|       from small pool |  45056 KiB |     72 MiB |    128 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83712 KiB | 245592 KiB |    895 TiB |    895 TiB |
|       from large pool |  83712 KiB | 244616 KiB |    895 TiB |    895 TiB |
|       from small pool |      0 KiB |  16201 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3677    |  133152 K  |  133152 K  |
|       from large pool |       2    |      76    |   54671 K  |   54671 K  |
|       from small pool |       0    |    3640    |   78480 K  |   78480 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3677    |  133152 K  |  133152 K  |
|       from large pool |       2    |      76    |   54671 K  |   54671 K  |
|       from small pool |       0    |    3640    |   78480 K  |   78480 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      51    |      87    |      56    |
|       from large pool |       9    |      15    |      23    |      14    |
|       from small pool |      22    |      36    |      64    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1480    |   58338 K  |   58338 K  |
|       from large pool |       1    |      11    |   17996 K  |   17996 K  |
|       from small pool |       0    |    1475    |   40341 K  |   40341 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jun 22 11:22:14 2024]
Finished job 0.
1 of 1 steps (100%) done
