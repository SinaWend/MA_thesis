Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jun 18 03:05:29 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446

 Experiment start at: 2024-06-18 03:17:06.823374
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9663927, 'precision': 0.48319635, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49145457, 'auroc': 0.7322801, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42328  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.6899246, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.7072711, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-18 03:40:47.121273,epoch time: 0:23:40.297899,used: 0:23:40.297899,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96666664, 'precision': 0.8583927, 'recall': 0.50604326, 'specificity': 0.50604326, 'f1': 0.5035539, 'auroc': 0.85720795, 'binary_precision': 0.75, 'binary_recall': 0.012228261, 'binary_specificity': 0.99985826, 'binary_f1_score': 0.02406417}
confusion matrix:
       0   1
0  42322   6
1   1454  18
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.8437344, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.8411428, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_2.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-18 04:03:25.474313,epoch time: 0:22:38.353040,used: 0:46:18.650939,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9663242, 'precision': 0.7305704, 'recall': 0.5327507, 'specificity': 0.5327507, 'f1': 0.55111843, 'auroc': 0.88850176, 'binary_precision': 0.49261084, 'binary_recall': 0.06793478, 'binary_specificity': 0.99756664, 'binary_f1_score': 0.11940299}
confusion matrix:
       0    1
0  42225  103
1   1372  100
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.7332143, 'recall': 0.5097507, 'specificity': 0.5097507, 'f1': 0.5107228, 'auroc': 0.88255537, 'binary_precision': 0.5, 'binary_recall': 0.02021773, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.03886398}
confusion matrix:
       0   1
0  18136  13
1    630  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.97983676, 'recall': 0.51724136, 'specificity': 0.51724136, 'f1': 0.5230443, 'auroc': 0.8666562, 'binary_precision': 1.0, 'binary_recall': 0.03448276, 'binary_specificity': 1.0, 'binary_f1_score': 0.06666667}
confusion matrix:
      0  1
0  5997  0
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_3.png
new oracle model saved
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9657832980155945, corresponding to test acc:                         0.9582933783531189 / 0.9597315192222595
after epoch: 3,now: 2024-06-18 04:25:43.036065,epoch time: 0:22:17.561752,used: 1:08:36.212691,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9668493, 'precision': 0.7491329, 'recall': 0.5625299, 'specificity': 0.5625299, 'f1': 0.59524715, 'auroc': 0.9008832, 'binary_precision': 0.5277778, 'binary_recall': 0.1290761, 'binary_specificity': 0.9959837, 'binary_f1_score': 0.20742358}
confusion matrix:
       0    1
0  42158  170
1   1282  190
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.7839494, 'recall': 0.531888, 'specificity': 0.531888, 'f1': 0.5503763, 'auroc': 0.89369375, 'binary_precision': 0.6, 'binary_recall': 0.065318815, 'binary_specificity': 0.9984572, 'binary_f1_score': 0.11781206}
confusion matrix:
       0   1
0  18121  28
1    601  42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.98076, 'recall': 0.5402299, 'specificity': 0.5402299, 'f1': 0.56465936, 'auroc': 0.87690717, 'binary_precision': 1.0, 'binary_recall': 0.08045977, 'binary_specificity': 1.0, 'binary_f1_score': 0.14893617}
confusion matrix:
      0   1
0  5997   0
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-18 04:47:06.945692,epoch time: 0:21:23.909627,used: 1:30:00.122318,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.966895, 'precision': 0.74658555, 'recall': 0.59042174, 'specificity': 0.59042174, 'f1': 0.6290304, 'auroc': 0.91037595, 'binary_precision': 0.5208333, 'binary_recall': 0.18682066, 'binary_specificity': 0.99402285, 'binary_f1_score': 0.275}
confusion matrix:
       0    1
0  42075  253
1   1197  275
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7909163, 'recall': 0.5516925, 'specificity': 0.5516925, 'f1': 0.5817958, 'auroc': 0.90583485, 'binary_precision': 0.6126126, 'binary_recall': 0.10575428, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.18037136}
confusion matrix:
       0   1
0  18106  43
1    575  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.981919, 'recall': 0.5689655, 'specificity': 0.5689655, 'f1': 0.6120051, 'auroc': 0.8813493, 'binary_precision': 1.0, 'binary_recall': 0.13793103, 'binary_specificity': 1.0, 'binary_f1_score': 0.24242425}
confusion matrix:
      0   1
0  5997   0
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-18 05:09:00.096639,epoch time: 0:21:53.150947,used: 1:51:53.273265,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9662329, 'precision': 0.7353314, 'recall': 0.63040614, 'specificity': 0.63040614, 'f1': 0.66627824, 'auroc': 0.91628003, 'binary_precision': 0.49564135, 'binary_recall': 0.27038044, 'binary_specificity': 0.99043185, 'binary_f1_score': 0.3498901}
confusion matrix:
       0    1
0  41923  405
1   1074  398
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7695067, 'recall': 0.5756667, 'specificity': 0.5756667, 'f1': 0.6136818, 'auroc': 0.91450274, 'binary_precision': 0.5681818, 'binary_recall': 0.15552099, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.24420024}
confusion matrix:
       0    1
0  18073   76
1    543  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.9734655, 'recall': 0.59761775, 'specificity': 0.59761775, 'f1': 0.6542939, 'auroc': 0.8904163, 'binary_precision': 0.9807692, 'binary_recall': 0.1954023, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.32587856}
confusion matrix:
      0   1
0  5996   1
1   210  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_6.png
new oracle model saved
early stop counter: 1
val acc:0.9670604467391968, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9640460014343262 / 0.9662831425666809
after epoch: 6,now: 2024-06-18 05:29:50.985069,epoch time: 0:20:50.888430,used: 2:12:44.161695,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9672146, 'precision': 0.7512336, 'recall': 0.6082916, 'specificity': 0.6082916, 'f1': 0.6487185, 'auroc': 0.91857034, 'binary_precision': 0.5289389, 'binary_recall': 0.22350544, 'binary_specificity': 0.9930779, 'binary_f1_score': 0.31423113}
confusion matrix:
       0    1
0  42035  293
1   1143  329
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.77172726, 'recall': 0.5651108, 'specificity': 0.5651108, 'f1': 0.6000094, 'auroc': 0.9155222, 'binary_precision': 0.5733333, 'binary_recall': 0.13374805, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.21689786}
confusion matrix:
       0   1
0  18085  64
1    557  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.9826171, 'recall': 0.5862069, 'specificity': 0.5862069, 'f1': 0.63821363, 'auroc': 0.8893155, 'binary_precision': 1.0, 'binary_recall': 0.1724138, 'binary_specificity': 1.0, 'binary_f1_score': 0.29411763}
confusion matrix:
      0   1
0  5997   0
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_7.png
early stop counter: 2
val acc:0.9669540524482727, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9640460014343262 / 0.9662831425666809
after epoch: 7,now: 2024-06-18 05:51:05.038053,epoch time: 0:21:14.052984,used: 2:33:58.214679,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9678311, 'precision': 0.75572586, 'recall': 0.66139627, 'specificity': 0.66139627, 'f1': 0.69683903, 'auroc': 0.9230475, 'binary_precision': 0.53435117, 'binary_recall': 0.33288044, 'binary_specificity': 0.9899121, 'binary_f1_score': 0.4102135}
confusion matrix:
       0    1
0  41901  427
1    982  490
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7618114, 'recall': 0.5838347, 'specificity': 0.5838347, 'f1': 0.6230517, 'auroc': 0.92205983, 'binary_precision': 0.5522388, 'binary_recall': 0.1726283, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.26303318}
confusion matrix:
       0    1
0  18059   90
1    532  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.9830836, 'recall': 0.59770113, 'specificity': 0.59770113, 'f1': 0.65485775, 'auroc': 0.8926344, 'binary_precision': 1.0, 'binary_recall': 0.1954023, 'binary_specificity': 1.0, 'binary_f1_score': 0.32692307}
confusion matrix:
      0   1
0  5997   0
1   210  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_8.png
new oracle model saved
early stop counter: 3
val acc:0.9669008255004883, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9640460014343262 / 0.9664429426193237
after epoch: 8,now: 2024-06-18 06:14:38.969853,epoch time: 0:23:33.931800,used: 2:57:32.146479,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9681735, 'precision': 0.7629845, 'recall': 0.6409182, 'specificity': 0.6409182, 'f1': 0.68178046, 'auroc': 0.9262457, 'binary_precision': 0.55025774, 'binary_recall': 0.29008153, 'binary_specificity': 0.9917549, 'binary_f1_score': 0.37989324}
confusion matrix:
       0    1
0  41979  349
1   1045  427
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7745226, 'recall': 0.5696938, 'specificity': 0.5696938, 'f1': 0.6063124, 'auroc': 0.9272269, 'binary_precision': 0.5786164, 'binary_recall': 0.14307931, 'binary_specificity': 0.9963083, 'binary_f1_score': 0.22942644}
confusion matrix:
       0   1
0  18082  67
1    551  92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.9824618, 'recall': 0.58237547, 'specificity': 0.58237547, 'f1': 0.6325217, 'auroc': 0.8917764, 'binary_precision': 1.0, 'binary_recall': 0.16475096, 'binary_specificity': 1.0, 'binary_f1_score': 0.28289476}
confusion matrix:
      0   1
0  5997   0
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_9.png
early stop counter: 4
val acc:0.9671136736869812, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9640460014343262 / 0.9664429426193237
after epoch: 9,now: 2024-06-18 06:38:18.622420,epoch time: 0:23:39.652567,used: 3:21:11.799046,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96687216, 'precision': 0.74378407, 'recall': 0.6485341, 'specificity': 0.6485341, 'f1': 0.6834213, 'auroc': 0.9242027, 'binary_precision': 0.51131225, 'binary_recall': 0.30727395, 'binary_specificity': 0.98979425, 'binary_f1_score': 0.3838641}
confusion matrix:
       0    1
0  41897  432
1   1019  452
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.77511585, 'recall': 0.58636034, 'specificity': 0.58636034, 'f1': 0.6273864, 'auroc': 0.9289323, 'binary_precision': 0.5786802, 'binary_recall': 0.17729394, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.27142859}
confusion matrix:
       0    1
0  18066   83
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.9710953, 'recall': 0.5822921, 'specificity': 0.5822921, 'f1': 0.6320163, 'auroc': 0.8957389, 'binary_precision': 0.97727275, 'binary_recall': 0.16475096, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.28196722}
confusion matrix:
      0   1
0  5996   1
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_10.png
better model found
persisted
after epoch: 10,now: 2024-06-18 06:59:13.465249,epoch time: 0:20:54.842829,used: 3:42:06.641875,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9676712, 'precision': 0.75287294, 'recall': 0.6757395, 'specificity': 0.6757395, 'f1': 0.70665777, 'auroc': 0.927719, 'binary_precision': 0.527668, 'binary_recall': 0.36277175, 'binary_specificity': 0.98870724, 'binary_f1_score': 0.4299517}
confusion matrix:
       0    1
0  41850  478
1    938  534
---- Validation: 
scalar performance:
{'acc': 0.9679119, 'precision': 0.7748922, 'recall': 0.61436033, 'specificity': 0.61436033, 'f1': 0.65863085, 'auroc': 0.9321182, 'binary_precision': 0.5763359, 'binary_recall': 0.2348367, 'binary_specificity': 0.99388397, 'binary_f1_score': 0.33370164}
confusion matrix:
       0    1
0  18038  111
1    492  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.9717448, 'recall': 0.5861235, 'specificity': 0.5861235, 'f1': 0.6376929, 'auroc': 0.89814436, 'binary_precision': 0.9782609, 'binary_recall': 0.1724138, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.2931596}
confusion matrix:
      0   1
0  5996   1
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_11.png
better model found
persisted
after epoch: 11,now: 2024-06-18 07:21:03.731025,epoch time: 0:21:50.265776,used: 4:03:56.907651,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9685388, 'precision': 0.765744, 'recall': 0.6556302, 'specificity': 0.6556302, 'f1': 0.69493794, 'auroc': 0.92793, 'binary_precision': 0.5547703, 'binary_recall': 0.32019034, 'binary_specificity': 0.99107, 'binary_f1_score': 0.40603447}
confusion matrix:
       0    1
0  41951  378
1   1000  471
---- Validation: 
scalar performance:
{'acc': 0.9678587, 'precision': 0.7799356, 'recall': 0.5993317, 'specificity': 0.5993317, 'f1': 0.64304537, 'auroc': 0.93358886, 'binary_precision': 0.58744395, 'binary_recall': 0.2037325, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.30254042}
confusion matrix:
       0    1
0  18057   92
1    512  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.98269475, 'recall': 0.5881226, 'specificity': 0.5881226, 'f1': 0.64103216, 'auroc': 0.89485294, 'binary_precision': 1.0, 'binary_recall': 0.17624521, 'binary_specificity': 1.0, 'binary_f1_score': 0.29967427}
confusion matrix:
      0   1
0  5997   0
1   215  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_12.png
early stop counter: 1
val acc:0.9678586721420288, best validation acc: 0.9679118990898132, corresponding to test acc:                         0.9653244018554688 / 0.9664429426193237
after epoch: 12,now: 2024-06-18 07:44:28.972101,epoch time: 0:23:25.241076,used: 4:27:22.148727,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96931505, 'precision': 0.77322316, 'recall': 0.67593426, 'specificity': 0.67593426, 'f1': 0.7130422, 'auroc': 0.9374501, 'binary_precision': 0.56837606, 'binary_recall': 0.36141303, 'binary_specificity': 0.9904555, 'binary_f1_score': 0.44186047}
confusion matrix:
       0    1
0  41924  404
1    940  532
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.7717515, 'recall': 0.61730546, 'specificity': 0.61730546, 'f1': 0.66114944, 'auroc': 0.93707955, 'binary_precision': 0.56985295, 'binary_recall': 0.24105754, 'binary_specificity': 0.99355334, 'binary_f1_score': 0.33879784}
confusion matrix:
       0    1
0  18032  117
1    488  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.9742236, 'recall': 0.6033649, 'specificity': 0.6033649, 'f1': 0.66236144, 'auroc': 0.8986746, 'binary_precision': 0.9818182, 'binary_recall': 0.20689656, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.34177217}
confusion matrix:
      0   1
0  5996   1
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_13.png
new oracle model saved
early stop counter: 2
val acc:0.9678054451942444, best validation acc: 0.9679118990898132, corresponding to test acc:                         0.9653244018554688 / 0.9667625427246094
after epoch: 13,now: 2024-06-18 08:04:57.884300,epoch time: 0:20:28.912199,used: 4:47:51.060926,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96888125, 'precision': 0.7702188, 'recall': 0.6599725, 'specificity': 0.6599725, 'f1': 0.6996439, 'auroc': 0.93427485, 'binary_precision': 0.56344587, 'binary_recall': 0.32880434, 'binary_specificity': 0.9911406, 'binary_f1_score': 0.41527244}
confusion matrix:
       0    1
0  41953  375
1    988  484
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.77444565, 'recall': 0.59997153, 'specificity': 0.59997153, 'f1': 0.64309543, 'auroc': 0.93581045, 'binary_precision': 0.57641923, 'binary_recall': 0.20528771, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.3027523}
confusion matrix:
       0    1
0  18052   97
1    511  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.9696486, 'recall': 0.57462925, 'specificity': 0.57462925, 'f1': 0.62044, 'auroc': 0.8963026, 'binary_precision': 0.975, 'binary_recall': 0.14942528, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.2591362}
confusion matrix:
      0   1
0  5996   1
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_14.png
early stop counter: 3
val acc:0.9676458239555359, best validation acc: 0.9679118990898132, corresponding to test acc:                         0.9653244018554688 / 0.9667625427246094
after epoch: 14,now: 2024-06-18 08:26:41.067830,epoch time: 0:21:43.183530,used: 5:09:34.244456,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96890414, 'precision': 0.7790681, 'recall': 0.627526, 'specificity': 0.627526, 'f1': 0.6726137, 'auroc': 0.93417037, 'binary_precision': 0.5833333, 'binary_recall': 0.2615489, 'binary_specificity': 0.9935031, 'binary_f1_score': 0.3611632}
confusion matrix:
       0    1
0  42053  275
1   1087  385
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.7955167, 'recall': 0.5684692, 'specificity': 0.5684692, 'f1': 0.6059514, 'auroc': 0.9353901, 'binary_precision': 0.62068963, 'binary_recall': 0.1399689, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.22842643}
confusion matrix:
       0   1
0  18094  55
1    553  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.9806829, 'recall': 0.53831416, 'specificity': 0.53831416, 'f1': 0.56132555, 'auroc': 0.8936099, 'binary_precision': 1.0, 'binary_recall': 0.07662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.14234875}
confusion matrix:
      0   1
0  5997   0
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_15.png
early stop counter: 4
val acc:0.9676458239555359, best validation acc: 0.9679118990898132, corresponding to test acc:                         0.9653244018554688 / 0.9667625427246094
after epoch: 15,now: 2024-06-18 08:49:47.520749,epoch time: 0:23:06.452919,used: 5:32:40.697375,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96924657, 'precision': 0.7734406, 'recall': 0.66999733, 'specificity': 0.66999733, 'f1': 0.7085185, 'auroc': 0.9398433, 'binary_precision': 0.56921375, 'binary_recall': 0.34918478, 'binary_specificity': 0.99080986, 'binary_f1_score': 0.43284214}
confusion matrix:
       0    1
0  41939  389
1    958  514
---- Validation: 
scalar performance:
{'acc': 0.9679119, 'precision': 0.77599216, 'recall': 0.61136013, 'specificity': 0.61136013, 'f1': 0.6556614, 'auroc': 0.9395425, 'binary_precision': 0.5787402, 'binary_recall': 0.22861587, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.32775918}
confusion matrix:
       0    1
0  18042  107
1    496  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.9731991, 'recall': 0.59570205, 'specificity': 0.59570205, 'f1': 0.6515707, 'auroc': 0.8961245, 'binary_precision': 0.98039216, 'binary_recall': 0.19157088, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.32051283}
confusion matrix:
      0   1
0  5996   1
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_16.png
early stop counter: 5
val acc:0.9679118990898132, best validation acc: 0.9679118990898132, corresponding to test acc:                         0.9653244018554688 / 0.9667625427246094
after epoch: 16,now: 2024-06-18 09:12:13.402903,epoch time: 0:22:25.882154,used: 5:55:06.579529,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9700457, 'precision': 0.7842722, 'recall': 0.67270577, 'specificity': 0.67270577, 'f1': 0.71363, 'auroc': 0.9386935, 'binary_precision': 0.59070295, 'binary_recall': 0.35394022, 'binary_specificity': 0.99147135, 'binary_f1_score': 0.44265082}
confusion matrix:
       0    1
0  41967  361
1    951  521
---- Validation: 
scalar performance:
{'acc': 0.96812475, 'precision': 0.7845901, 'recall': 0.6032197, 'specificity': 0.6032197, 'f1': 0.6479845, 'auroc': 0.9396236, 'binary_precision': 0.5964912, 'binary_recall': 0.21150856, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.3122847}
confusion matrix:
       0    1
0  18057   92
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.9821515, 'recall': 0.57471263, 'specificity': 0.57471263, 'f1': 0.6209135, 'auroc': 0.8970678, 'binary_precision': 1.0, 'binary_recall': 0.14942528, 'binary_specificity': 1.0, 'binary_f1_score': 0.26}
confusion matrix:
      0   1
0  5997   0
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_17.png
better model found
persisted
after epoch: 17,now: 2024-06-18 09:37:49.167839,epoch time: 0:25:35.764936,used: 6:20:42.344465,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9692009, 'precision': 0.77333355, 'recall': 0.66735077, 'specificity': 0.66735077, 'f1': 0.7064029, 'auroc': 0.93514276, 'binary_precision': 0.5691789, 'binary_recall': 0.34375, 'binary_specificity': 0.9909516, 'binary_f1_score': 0.42863196}
confusion matrix:
       0    1
0  41945  383
1    966  506
---- Validation: 
scalar performance:
{'acc': 0.96855044, 'precision': 0.7954413, 'recall': 0.6034401, 'specificity': 0.6034401, 'f1': 0.6495426, 'auroc': 0.9403132, 'binary_precision': 0.6181818, 'binary_recall': 0.21150856, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.31517962}
confusion matrix:
       0    1
0  18065   84
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.98176414, 'recall': 0.5651341, 'specificity': 0.5651341, 'f1': 0.6059669, 'auroc': 0.8939909, 'binary_precision': 1.0, 'binary_recall': 0.1302682, 'binary_specificity': 1.0, 'binary_f1_score': 0.23050848}
confusion matrix:
      0   1
0  5997   0
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_18.png
better model found
persisted
after epoch: 18,now: 2024-06-18 10:01:45.639464,epoch time: 0:23:56.471625,used: 6:44:38.816090,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.969863, 'precision': 0.78581125, 'recall': 0.65818536, 'specificity': 0.65818536, 'f1': 0.7020275, 'auroc': 0.93895346, 'binary_precision': 0.5947631, 'binary_recall': 0.3240489, 'binary_specificity': 0.99232185, 'binary_f1_score': 0.41952506}
confusion matrix:
       0    1
0  42003  325
1    995  477
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.81694984, 'recall': 0.59849274, 'specificity': 0.59849274, 'f1': 0.6460459, 'auroc': 0.9413935, 'binary_precision': 0.6615385, 'binary_recall': 0.20062208, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.3078759}
confusion matrix:
       0    1
0  18083   66
1    514  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.9808371, 'recall': 0.5421456, 'specificity': 0.5421456, 'f1': 0.56796986, 'auroc': 0.89484847, 'binary_precision': 1.0, 'binary_recall': 0.08429119, 'binary_specificity': 1.0, 'binary_f1_score': 0.15547703}
confusion matrix:
      0   1
0  5997   0
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_19.png
better model found
persisted
after epoch: 19,now: 2024-06-18 10:23:47.975387,epoch time: 0:22:02.335923,used: 7:06:41.152013,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9702055, 'precision': 0.78162545, 'recall': 0.6921323, 'specificity': 0.6921323, 'f1': 0.7276298, 'auroc': 0.9401823, 'binary_precision': 0.5840886, 'binary_recall': 0.39402175, 'binary_specificity': 0.99024284, 'binary_f1_score': 0.47058824}
confusion matrix:
       0    1
0  41915  413
1    892  580
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.801103, 'recall': 0.6172441, 'specificity': 0.6172441, 'f1': 0.6655206, 'auroc': 0.9429056, 'binary_precision': 0.62857145, 'binary_recall': 0.23950233, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.34684685}
confusion matrix:
       0    1
0  18058   91
1    489  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.96883565, 'recall': 0.57079786, 'specificity': 0.57079786, 'f1': 0.61453736, 'auroc': 0.8954422, 'binary_precision': 0.9736842, 'binary_recall': 0.14176245, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.24749163}
confusion matrix:
      0   1
0  5996   1
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_20.png
early stop counter: 1
val acc:0.9691358208656311, best validation acc: 0.9691358208656311, corresponding to test acc:                         0.9618088603019714 / 0.9667625427246094
after epoch: 20,now: 2024-06-18 10:44:33.417822,epoch time: 0:20:45.442435,used: 7:27:26.594448,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97118723, 'precision': 0.7987358, 'recall': 0.6814929, 'specificity': 0.6814929, 'f1': 0.7245435, 'auroc': 0.938061, 'binary_precision': 0.61904764, 'binary_recall': 0.3709239, 'binary_specificity': 0.992062, 'binary_f1_score': 0.46389124}
confusion matrix:
       0    1
0  41992  336
1    926  546
---- Validation: 
scalar performance:
{'acc': 0.96897614, 'precision': 0.8012662, 'recall': 0.61116105, 'specificity': 0.61116105, 'f1': 0.6589163, 'auroc': 0.9409666, 'binary_precision': 0.62931037, 'binary_recall': 0.22706065, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.33371428}
confusion matrix:
       0    1
0  18063   86
1    497  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.98184156, 'recall': 0.5670498, 'specificity': 0.5670498, 'f1': 0.60899615, 'auroc': 0.8910996, 'binary_precision': 1.0, 'binary_recall': 0.13409962, 'binary_specificity': 1.0, 'binary_f1_score': 0.2364865}
confusion matrix:
      0   1
0  5997   0
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_21.png
early stop counter: 2
val acc:0.9689761400222778, best validation acc: 0.9691358208656311, corresponding to test acc:                         0.9618088603019714 / 0.9667625427246094
after epoch: 21,now: 2024-06-18 11:07:30.511864,epoch time: 0:22:57.094042,used: 7:50:23.688490,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9698858, 'precision': 0.7850876, 'recall': 0.66059226, 'specificity': 0.66059226, 'f1': 0.70390064, 'auroc': 0.9387703, 'binary_precision': 0.59313726, 'binary_recall': 0.32902786, 'binary_specificity': 0.9921567, 'binary_f1_score': 0.4232619}
confusion matrix:
       0    1
0  41997  332
1    987  484
---- Validation: 
scalar performance:
{'acc': 0.969189, 'precision': 0.80620456, 'recall': 0.6120213, 'specificity': 0.6120213, 'f1': 0.660499, 'auroc': 0.9440602, 'binary_precision': 0.6391304, 'binary_recall': 0.22861587, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.33676973}
confusion matrix:
       0    1
0  18066   83
1    496  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.9813002, 'recall': 0.5536398, 'specificity': 0.5536398, 'f1': 0.5873577, 'auroc': 0.8950997, 'binary_precision': 1.0, 'binary_recall': 0.107279696, 'binary_specificity': 1.0, 'binary_f1_score': 0.19377163}
confusion matrix:
      0   1
0  5997   0
1   233  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_22.png
better model found
persisted
after epoch: 22,now: 2024-06-18 11:32:26.291976,epoch time: 0:24:55.780112,used: 8:15:19.468602,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.970274, 'precision': 0.78880095, 'recall': 0.66921747, 'specificity': 0.66921747, 'f1': 0.7120044, 'auroc': 0.9412809, 'binary_precision': 0.6, 'binary_recall': 0.3464674, 'binary_specificity': 0.9919675, 'binary_f1_score': 0.43927652}
confusion matrix:
       0    1
0  41988  340
1    962  510
---- Validation: 
scalar performance:
{'acc': 0.96929544, 'precision': 0.800511, 'recall': 0.6240773, 'specificity': 0.6240773, 'f1': 0.6726443, 'auroc': 0.94348884, 'binary_precision': 0.6269231, 'binary_recall': 0.2534992, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.3610188}
confusion matrix:
       0    1
0  18052   97
1    480  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9813774, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.59051204, 'auroc': 0.8974938, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5997   0
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_23.png
better model found
persisted
after epoch: 23,now: 2024-06-18 11:58:26.121026,epoch time: 0:25:59.829050,used: 8:41:19.297652,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9703196, 'precision': 0.7819184, 'recall': 0.69743717, 'specificity': 0.69743717, 'f1': 0.731528, 'auroc': 0.94420755, 'binary_precision': 0.58431375, 'binary_recall': 0.4048913, 'binary_specificity': 0.98998296, 'binary_f1_score': 0.47833067}
confusion matrix:
       0    1
0  41904  424
1    876  596
---- Validation: 
scalar performance:
{'acc': 0.9695615, 'precision': 0.8001324, 'recall': 0.6347158, 'specificity': 0.6347158, 'f1': 0.6833429, 'auroc': 0.9456241, 'binary_precision': 0.6254417, 'binary_recall': 0.27527216, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.3822894}
confusion matrix:
       0    1
0  18043  106
1    466  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.96883565, 'recall': 0.57079786, 'specificity': 0.57079786, 'f1': 0.61453736, 'auroc': 0.89811766, 'binary_precision': 0.9736842, 'binary_recall': 0.14176245, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.24749163}
confusion matrix:
      0   1
0  5996   1
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_24.png
better model found
persisted
after epoch: 24,now: 2024-06-18 12:23:01.506264,epoch time: 0:24:35.385238,used: 9:05:54.682890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9691096, 'precision': 0.7701328, 'recall': 0.678123, 'specificity': 0.678123, 'f1': 0.71377635, 'auroc': 0.94132596, 'binary_precision': 0.5620438, 'binary_recall': 0.36616847, 'binary_specificity': 0.9900775, 'binary_f1_score': 0.4434389}
confusion matrix:
       0    1
0  41908  420
1    933  539
---- Validation: 
scalar performance:
{'acc': 0.9695615, 'precision': 0.8071854, 'recall': 0.62346494, 'specificity': 0.62346494, 'f1': 0.6730081, 'auroc': 0.94250524, 'binary_precision': 0.6403162, 'binary_recall': 0.251944, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.36160713}
confusion matrix:
       0    1
0  18058   91
1    481  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9813774, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.59051204, 'auroc': 0.89417696, 'binary_precision': 1.0, 'binary_recall': 0.11111111, 'binary_specificity': 1.0, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5997   0
1   232  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_25.png
early stop counter: 1
val acc:0.9695615172386169, best validation acc: 0.9695615172386169, corresponding to test acc:                         0.9640460014343262 / 0.9667625427246094
after epoch: 25,now: 2024-06-18 12:44:47.677576,epoch time: 0:21:46.171312,used: 9:27:40.854202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9711416, 'precision': 0.7981572, 'recall': 0.6811415, 'specificity': 0.6811415, 'f1': 0.72410697, 'auroc': 0.9402065, 'binary_precision': 0.61791384, 'binary_recall': 0.37024456, 'binary_specificity': 0.99203837, 'binary_f1_score': 0.46304163}
confusion matrix:
       0    1
0  41991  337
1    927  545
---- Validation: 
scalar performance:
{'acc': 0.96945506, 'precision': 0.8205347, 'recall': 0.6046585, 'specificity': 0.6046585, 'f1': 0.6537441, 'auroc': 0.94322413, 'binary_precision': 0.6682927, 'binary_recall': 0.21306376, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.3231132}
confusion matrix:
       0    1
0  18081   68
1    506  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.9810685, 'recall': 0.5478927, 'specificity': 0.5478927, 'f1': 0.57776415, 'auroc': 0.89669037, 'binary_precision': 1.0, 'binary_recall': 0.09578544, 'binary_specificity': 1.0, 'binary_f1_score': 0.17482518}
confusion matrix:
      0   1
0  5997   0
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_26.png
early stop counter: 2
val acc:0.9694550633430481, best validation acc: 0.9695615172386169, corresponding to test acc:                         0.9640460014343262 / 0.9667625427246094
after epoch: 26,now: 2024-06-18 13:08:49.443874,epoch time: 0:24:01.766298,used: 9:51:42.620500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9708904, 'precision': 0.7952658, 'recall': 0.67838866, 'specificity': 0.67838866, 'f1': 0.72113, 'auroc': 0.94143915, 'binary_precision': 0.6123147, 'binary_recall': 0.36480978, 'binary_specificity': 0.9919675, 'binary_f1_score': 0.45721585}
confusion matrix:
       0    1
0  41988  340
1    935  537
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.8185905, 'recall': 0.5969926, 'specificity': 0.5969926, 'f1': 0.644387, 'auroc': 0.9447088, 'binary_precision': 0.66492146, 'binary_recall': 0.19751166, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.30455634}
confusion matrix:
       0    1
0  18085   64
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.98022103, 'recall': 0.52681994, 'specificity': 0.52681994, 'f1': 0.54082, 'auroc': 0.89315826, 'binary_precision': 1.0, 'binary_recall': 0.053639848, 'binary_specificity': 1.0, 'binary_f1_score': 0.10181818}
confusion matrix:
      0   1
0  5997   0
1   247  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_27.png
early stop counter: 3
val acc:0.9691358208656311, best validation acc: 0.9695615172386169, corresponding to test acc:                         0.9640460014343262 / 0.9667625427246094
after epoch: 27,now: 2024-06-18 13:32:06.290218,epoch time: 0:23:16.846344,used: 10:14:59.466844,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97127855, 'precision': 0.79593074, 'recall': 0.6933432, 'specificity': 0.6933432, 'f1': 0.7329128, 'auroc': 0.9440167, 'binary_precision': 0.61263156, 'binary_recall': 0.39538044, 'binary_specificity': 0.991306, 'binary_f1_score': 0.48059452}
confusion matrix:
       0    1
0  41960  368
1    890  582
---- Validation: 
scalar performance:
{'acc': 0.969934, 'precision': 0.8139062, 'recall': 0.626658, 'specificity': 0.626658, 'f1': 0.677361, 'auroc': 0.9454054, 'binary_precision': 0.6535433, 'binary_recall': 0.25816485, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.37012264}
confusion matrix:
       0    1
0  18061   88
1    477  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.98099136, 'recall': 0.545977, 'specificity': 0.545977, 'f1': 0.574522, 'auroc': 0.8962487, 'binary_precision': 1.0, 'binary_recall': 0.09195402, 'binary_specificity': 1.0, 'binary_f1_score': 0.16842106}
confusion matrix:
      0   1
0  5997   0
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_28.png
better model found
persisted
after epoch: 28,now: 2024-06-18 13:55:20.114688,epoch time: 0:23:13.824470,used: 10:38:13.291314,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9708904, 'precision': 0.78857136, 'recall': 0.70035535, 'specificity': 0.70035535, 'f1': 0.73576444, 'auroc': 0.94414055, 'binary_precision': 0.59742826, 'binary_recall': 0.4103261, 'binary_specificity': 0.99038464, 'binary_f1_score': 0.48650825}
confusion matrix:
       0    1
0  41921  407
1    868  604
---- Validation: 
scalar performance:
{'acc': 0.969934, 'precision': 0.8105964, 'recall': 0.63115835, 'specificity': 0.63115835, 'f1': 0.6815161, 'auroc': 0.9466129, 'binary_precision': 0.6466165, 'binary_recall': 0.2674961, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.37843785}
confusion matrix:
       0    1
0  18055   94
1    471  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.981919, 'recall': 0.5689655, 'specificity': 0.5689655, 'f1': 0.6120051, 'auroc': 0.8952061, 'binary_precision': 1.0, 'binary_recall': 0.13793103, 'binary_specificity': 1.0, 'binary_f1_score': 0.24242425}
confusion matrix:
      0   1
0  5997   0
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_29.png
early stop counter: 1
val acc:0.9699339866638184, best validation acc: 0.9699339866638184, corresponding to test acc:                         0.9621284604072571 / 0.9667625427246094
after epoch: 29,now: 2024-06-18 14:21:22.193554,epoch time: 0:26:02.078866,used: 11:04:15.370180,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9710502, 'precision': 0.79738796, 'recall': 0.6785836, 'specificity': 0.6785836, 'f1': 0.7218549, 'auroc': 0.9441103, 'binary_precision': 0.61653274, 'binary_recall': 0.3650578, 'binary_specificity': 0.9921094, 'binary_f1_score': 0.45858246}
confusion matrix:
       0    1
0  41995  334
1    934  537
---- Validation: 
scalar performance:
{'acc': 0.9698808, 'precision': 0.8238038, 'recall': 0.61387956, 'specificity': 0.61387956, 'f1': 0.66474676, 'auroc': 0.9461518, 'binary_precision': 0.67420816, 'binary_recall': 0.23172629, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.34490743}
confusion matrix:
       0    1
0  18077   72
1    494  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.9804518, 'recall': 0.532567, 'specificity': 0.532567, 'f1': 0.55118215, 'auroc': 0.8949001, 'binary_precision': 1.0, 'binary_recall': 0.0651341, 'binary_specificity': 1.0, 'binary_f1_score': 0.12230217}
confusion matrix:
      0   1
0  5997   0
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21395446_30.png
early stop counter: 2
val acc:0.9698808193206787, best validation acc: 0.9699339866638184, corresponding to test acc:                         0.9621284604072571 / 0.9667625427246094
after epoch: 30,now: 2024-06-18 14:45:59.987270,epoch time: 0:24:37.793716,used: 11:28:53.163896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_18_03_17_06_seed_0_21395446
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:28:53.163896 at 2024-06-18 14:45:59.987270
persisted model performance metric: 

scalar performance:
{'acc': 0.96212846, 'precision': 0.98099136, 'recall': 0.545977, 'specificity': 0.545977, 'f1': 0.574522, 'auroc': 0.8962487, 'binary_precision': 1.0, 'binary_recall': 0.09195402, 'binary_specificity': 1.0, 'binary_f1_score': 0.16842106}
confusion matrix:
      0   1
0  5997   0
1   237  24
oracle model performance metric: 

scalar performance:
{'acc': 0.96676254, 'precision': 0.9742236, 'recall': 0.6033649, 'specificity': 0.6033649, 'f1': 0.66236144, 'auroc': 0.8986746, 'binary_precision': 0.9818182, 'binary_recall': 0.20689656, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.34177217}
confusion matrix:
      0   1
0  5996   1
1   207  54
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_resnet_different_batchsizes_lre4_rest/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204178 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |  36242 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204178 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool | 167936 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |  36242 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB |   1428 MiB | 395270 GiB | 395270 GiB |
|       from large pool | 165120 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |  35968 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1524 MiB |   1524 MiB |   1524 MiB |      0 B   |
|       from large pool |   1450 MiB |   1450 MiB |   1450 MiB |      0 B   |
|       from small pool |     74 MiB |     74 MiB |     74 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 320109 KiB | 749313 KiB | 284057 GiB | 284057 GiB |
|       from large pool | 311296 KiB | 748328 KiB | 283918 GiB | 283918 GiB |
|       from small pool |   8813 KiB |  12610 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1278    |    1935    |   13820 K  |   13819 K  |
|       from large pool |      36    |      76    |    4630 K  |    4630 K  |
|       from small pool |    1242    |    1864    |    9190 K  |    9189 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1278    |    1935    |   13820 K  |   13819 K  |
|       from large pool |      36    |      76    |    4630 K  |    4630 K  |
|       from small pool |    1242    |    1864    |    9190 K  |    9189 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |      50    |      50    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |     452    |    7386 K  |    7386 K  |
|       from large pool |       5    |      10    |    1938 K  |    1938 K  |
|       from small pool |      30    |     447    |    5447 K  |    5447 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1436 MiB | 395293 GiB | 395293 GiB |
|       from large pool |  16640 KiB |   1366 MiB | 395172 GiB | 395172 GiB |
|       from small pool |      0 KiB |     72 MiB |    120 GiB |    120 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1428 MiB | 395270 GiB | 395270 GiB |
|       from large pool |  16640 KiB |   1358 MiB | 395152 GiB | 395152 GiB |
|       from small pool |      0 KiB |     71 MiB |    118 GiB |    118 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 524288 KiB |   1524 MiB |   1524 MiB |   1012 MiB |
|       from large pool | 479232 KiB |   1450 MiB |   1450 MiB |    982 MiB |
|       from small pool |  45056 KiB |     74 MiB |     74 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 298752 KiB | 749313 KiB | 284057 GiB | 284057 GiB |
|       from large pool | 298752 KiB | 748328 KiB | 283918 GiB | 283918 GiB |
|       from small pool |      0 KiB |  16408 KiB |    138 GiB |    138 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1935    |   13820 K  |   13820 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9190 K  |    9190 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1935    |   13820 K  |   13820 K  |
|       from large pool |       2    |      76    |    4630 K  |    4630 K  |
|       from small pool |       0    |    1864    |    9190 K  |    9190 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      31    |      50    |      50    |      19    |
|       from large pool |       9    |      13    |      13    |       4    |
|       from small pool |      22    |      37    |      37    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |     452    |    7386 K  |    7386 K  |
|       from large pool |       1    |      11    |    1938 K  |    1938 K  |
|       from small pool |       0    |     447    |    5448 K  |    5448 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jun 18 14:47:02 2024]
Finished job 0.
1 of 1 steps (100%) done
