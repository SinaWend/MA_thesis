Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jun  7 11:06:45 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597

 Experiment start at: 2024-06-07 11:13:03.282581
before training, model accuracy: 0.6388623118400574
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96638656, 'precision': 0.48319328, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.491453, 'auroc': 0.953774, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  42320  0
1   1472  0
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.48289165, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49129692, 'auroc': 0.95351845, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18149  0
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.93673116, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-07 11:29:00.679232,epoch time: 0:15:57.396651,used: 0:15:57.396651,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96988034, 'precision': 0.8105068, 'recall': 0.61137795, 'specificity': 0.61137795, 'f1': 0.6603879, 'auroc': 0.9487072, 'binary_precision': 0.64728683, 'binary_recall': 0.22705643, 'binary_specificity': 0.9956995, 'binary_f1_score': 0.3361852}
confusion matrix:
       0    1
0  42139  182
1   1137  334
---- Validation: 
scalar performance:
{'acc': 0.97041297, 'precision': 0.9153179, 'recall': 0.58040255, 'specificity': 0.58040255, 'f1': 0.62857544, 'auroc': 0.95645005, 'binary_precision': 0.8595041, 'binary_recall': 0.16174184, 'binary_specificity': 0.9990633, 'binary_f1_score': 0.2722513}
confusion matrix:
       0    1
0  18132   17
1    539  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.97945315, 'recall': 0.50766283, 'specificity': 0.50766283, 'f1': 0.5046054, 'auroc': 0.93368125, 'binary_precision': 1.0, 'binary_recall': 0.01532567, 'binary_specificity': 1.0, 'binary_f1_score': 0.030188678}
confusion matrix:
      0  1
0  5997  0
1   257  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-07 11:44:04.258399,epoch time: 0:15:03.579167,used: 0:31:00.975818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9670944, 'precision': 0.7488526, 'recall': 0.85117555, 'specificity': 0.85117555, 'f1': 0.79022205, 'auroc': 0.96518445, 'binary_precision': 0.50734943, 'binary_recall': 0.7269022, 'binary_specificity': 0.97544897, 'binary_f1_score': 0.5975984}
confusion matrix:
       0     1
0  41281  1039
1    402  1070
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.7450569, 'recall': 0.85699874, 'specificity': 0.85699874, 'f1': 0.7892982, 'auroc': 0.9640782, 'binary_precision': 0.49947533, 'binary_recall': 0.7402799, 'binary_specificity': 0.9737176, 'binary_f1_score': 0.59649116}
confusion matrix:
       0    1
0  17672  477
1    167  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9800256, 'precision': 0.8878406, 'recall': 0.85215306, 'specificity': 0.85215306, 'f1': 0.8690454, 'auroc': 0.9486759, 'binary_precision': 0.7881356, 'binary_recall': 0.7126437, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.748491}
confusion matrix:
      0    1
0  5947   50
1    75  186
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_3.png
new oracle model saved
early stop counter: 1
val acc:0.9657300710678101, best validation acc: 0.9704129695892334, corresponding to test acc:                         0.9589325785636902 / 0.980025589466095
after epoch: 3,now: 2024-06-07 11:59:10.841865,epoch time: 0:15:06.583466,used: 0:46:07.559284,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9659755, 'precision': 0.7442715, 'recall': 0.87912035, 'specificity': 0.87912035, 'f1': 0.79526114, 'auroc': 0.96882313, 'binary_precision': 0.49614066, 'binary_recall': 0.78600544, 'binary_specificity': 0.9722353, 'binary_f1_score': 0.60830706}
confusion matrix:
       0     1
0  41145  1175
1    315  1157
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.7427674, 'recall': 0.87989235, 'specificity': 0.87989235, 'f1': 0.794264, 'auroc': 0.9687233, 'binary_precision': 0.49319068, 'binary_recall': 0.7884914, 'binary_specificity': 0.9712932, 'binary_f1_score': 0.60682225}
confusion matrix:
       0    1
0  17628  521
1    136  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97762865, 'precision': 0.8708276, 'recall': 0.8380761, 'specificity': 0.8380761, 'f1': 0.85361314, 'auroc': 0.9524135, 'binary_precision': 0.75527424, 'binary_recall': 0.68582374, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.71887547}
confusion matrix:
      0    1
0  5939   58
1    82  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_4.png
early stop counter: 2
val acc:0.9650382995605469, best validation acc: 0.9704129695892334, corresponding to test acc:                         0.9589325785636902 / 0.980025589466095
after epoch: 4,now: 2024-06-07 12:14:23.258627,epoch time: 0:15:12.416762,used: 1:01:19.976046,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97481275, 'precision': 0.8915701, 'recall': 0.6636992, 'specificity': 0.6636992, 'f1': 0.7277672, 'auroc': 0.97466123, 'binary_precision': 0.80597013, 'binary_recall': 0.33016303, 'binary_specificity': 0.99723536, 'binary_f1_score': 0.4684337}
confusion matrix:
       0    1
0  42203  117
1    986  486
---- Validation: 
scalar performance:
{'acc': 0.972914, 'precision': 0.8844864, 'recall': 0.6394516, 'specificity': 0.6394516, 'f1': 0.7008749, 'auroc': 0.9723419, 'binary_precision': 0.79385966, 'binary_recall': 0.281493, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.41561425}
confusion matrix:
       0    1
0  18102   47
1    462  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970278, 'precision': 0.96116674, 'recall': 0.65100753, 'specificity': 0.65100753, 'f1': 0.7220107, 'auroc': 0.9465178, 'binary_precision': 0.9518072, 'binary_recall': 0.30268198, 'binary_specificity': 0.999333, 'binary_f1_score': 0.4593023}
confusion matrix:
      0   1
0  5993   4
1   182  79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_5.png
better model found
persisted
after epoch: 5,now: 2024-06-07 12:29:30.823787,epoch time: 0:15:07.565160,used: 1:16:27.541206,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96618104, 'precision': 0.74623674, 'recall': 0.90512764, 'specificity': 0.90512764, 'f1': 0.80381954, 'auroc': 0.9701657, 'binary_precision': 0.4981862, 'binary_recall': 0.83967394, 'binary_specificity': 0.9705813, 'binary_f1_score': 0.62534785}
confusion matrix:
       0     1
0  41075  1245
1    236  1236
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.7474973, 'recall': 0.89686185, 'specificity': 0.89686185, 'f1': 0.8026259, 'auroc': 0.97003776, 'binary_precision': 0.5014218, 'binary_recall': 0.82270604, 'binary_specificity': 0.97101766, 'binary_f1_score': 0.623086}
confusion matrix:
       0    1
0  17623  526
1    114  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9701182, 'precision': 0.8054565, 'recall': 0.84881616, 'specificity': 0.84881616, 'f1': 0.8255123, 'auroc': 0.94058466, 'binary_precision': 0.62333333, 'binary_recall': 0.71647507, 'binary_specificity': 0.98115724, 'binary_f1_score': 0.6666666}
confusion matrix:
      0    1
0  5884  113
1    74  187
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_6.png
early stop counter: 1
val acc:0.9659429788589478, best validation acc: 0.9729139804840088, corresponding to test acc:                         0.9702780246734619 / 0.980025589466095
after epoch: 6,now: 2024-06-07 12:44:22.803524,epoch time: 0:14:51.979737,used: 1:31:19.520943,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9781467, 'precision': 0.9069352, 'recall': 0.7172259, 'specificity': 0.7172259, 'f1': 0.7812526, 'auroc': 0.976642, 'binary_precision': 0.8331177, 'binary_recall': 0.4375, 'binary_specificity': 0.9969518, 'binary_f1_score': 0.5737194}
confusion matrix:
       0    1
0  42191  129
1    828  644
---- Validation: 
scalar performance:
{'acc': 0.9762665, 'precision': 0.9119463, 'recall': 0.6861906, 'specificity': 0.6861906, 'f1': 0.75361466, 'auroc': 0.9705093, 'binary_precision': 0.845614, 'binary_recall': 0.3748056, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.51939654}
confusion matrix:
       0    1
0  18105   44
1    402  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8550545, 'recall': 0.522655, 'specificity': 0.522655, 'f1': 0.5329855, 'auroc': 0.95483005, 'binary_precision': 0.75, 'binary_recall': 0.04597701, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0866426}
confusion matrix:
      0   1
0  5993   4
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_7.png
better model found
persisted
after epoch: 7,now: 2024-06-07 12:59:22.132431,epoch time: 0:14:59.328907,used: 1:46:18.849850,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9754293, 'precision': 0.8436531, 'recall': 0.72729504, 'specificity': 0.72729504, 'f1': 0.7726464, 'auroc': 0.9753256, 'binary_precision': 0.7058212, 'binary_recall': 0.4612772, 'binary_specificity': 0.99331284, 'binary_f1_score': 0.55792934}
confusion matrix:
       0    1
0  42037  283
1    793  679
---- Validation: 
scalar performance:
{'acc': 0.972914, 'precision': 0.8208787, 'recall': 0.7092068, 'specificity': 0.7092068, 'f1': 0.75225675, 'auroc': 0.97353923, 'binary_precision': 0.66183573, 'binary_recall': 0.42612752, 'binary_specificity': 0.9922861, 'binary_f1_score': 0.5184484}
confusion matrix:
       0    1
0  18009  140
1    369  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971876, 'precision': 0.8593675, 'recall': 0.7471226, 'specificity': 0.7471226, 'f1': 0.79180074, 'auroc': 0.9617951, 'binary_precision': 0.740113, 'binary_recall': 0.5019157, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.5981735}
confusion matrix:
      0    1
0  5951   46
1   130  131
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_8.png
early stop counter: 1
val acc:0.9729139804840088, best validation acc: 0.9762665033340454, corresponding to test acc:                         0.9595717191696167 / 0.980025589466095
after epoch: 8,now: 2024-06-07 13:14:33.569699,epoch time: 0:15:11.437268,used: 2:01:30.287118,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9778042, 'precision': 0.8184452, 'recall': 0.8695032, 'specificity': 0.8695032, 'f1': 0.8418902, 'auroc': 0.97810876, 'binary_precision': 0.64551806, 'binary_recall': 0.75339675, 'binary_specificity': 0.98560965, 'binary_f1_score': 0.69529784}
confusion matrix:
       0     1
0  41711   609
1    363  1109
---- Validation: 
scalar performance:
{'acc': 0.9766922, 'precision': 0.822585, 'recall': 0.8274214, 'specificity': 0.8274214, 'f1': 0.8249835, 'auroc': 0.97530067, 'binary_precision': 0.6569678, 'binary_recall': 0.66718507, 'binary_specificity': 0.9876577, 'binary_f1_score': 0.662037}
confusion matrix:
       0    1
0  17925  224
1    214  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.92392004, 'recall': 0.57238007, 'specificity': 0.57238007, 'f1': 0.61566496, 'auroc': 0.95574355, 'binary_precision': 0.88372093, 'binary_recall': 0.14559387, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.25}
confusion matrix:
      0   1
0  5992   5
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_9.png
better model found
persisted
after epoch: 9,now: 2024-06-07 13:29:42.078859,epoch time: 0:15:08.509160,used: 2:16:38.796278,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9793341, 'precision': 0.94017994, 'recall': 0.71568054, 'specificity': 0.71568054, 'f1': 0.7870376, 'auroc': 0.9807916, 'binary_precision': 0.8997175, 'binary_recall': 0.43303874, 'binary_specificity': 0.99832237, 'binary_f1_score': 0.58467185}
confusion matrix:
       0    1
0  42250   71
1    834  637
---- Validation: 
scalar performance:
{'acc': 0.9781822, 'precision': 0.95596135, 'recall': 0.69468296, 'specificity': 0.69468296, 'f1': 0.7696292, 'auroc': 0.9842929, 'binary_precision': 0.9330855, 'binary_recall': 0.3903577, 'binary_specificity': 0.99900824, 'binary_f1_score': 0.5504386}
confusion matrix:
       0    1
0  18131   18
1    392  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.8366661, 'recall': 0.5094118, 'specificity': 0.5094118, 'f1': 0.50812435, 'auroc': 0.95443827, 'binary_precision': 0.71428573, 'binary_recall': 0.019157087, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.037313428}
confusion matrix:
      0  1
0  5995  2
1   256  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_10.png
better model found
persisted
after epoch: 10,now: 2024-06-07 13:44:57.036290,epoch time: 0:15:14.957431,used: 2:31:53.753709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.978375, 'precision': 0.8568539, 'recall': 0.78014624, 'specificity': 0.78014624, 'f1': 0.8134949, 'auroc': 0.97969294, 'binary_precision': 0.7286213, 'binary_recall': 0.5676411, 'binary_specificity': 0.9926514, 'binary_f1_score': 0.63813525}
confusion matrix:
       0    1
0  42010  311
1    636  835
---- Validation: 
scalar performance:
{'acc': 0.97605366, 'precision': 0.84519684, 'recall': 0.75208527, 'specificity': 0.75208527, 'f1': 0.79076296, 'auroc': 0.9777242, 'binary_precision': 0.70752686, 'binary_recall': 0.5116641, 'binary_specificity': 0.99250644, 'binary_f1_score': 0.59386283}
confusion matrix:
       0    1
0  18013  136
1    314  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.81197757, 'recall': 0.5655491, 'specificity': 0.5655491, 'f1': 0.6014666, 'auroc': 0.96117985, 'binary_precision': 0.6603774, 'binary_recall': 0.13409962, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.22292995}
confusion matrix:
      0   1
0  5979  18
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_11.png
early stop counter: 1
val acc:0.9760536551475525, best validation acc: 0.9781821966171265, corresponding to test acc:                         0.9587727785110474 / 0.980025589466095
after epoch: 11,now: 2024-06-07 13:59:53.916966,epoch time: 0:14:56.880676,used: 2:46:50.634385,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9824854, 'precision': 0.92189133, 'recall': 0.78489757, 'specificity': 0.78489757, 'f1': 0.83915603, 'auroc': 0.98274577, 'binary_precision': 0.85845214, 'binary_recall': 0.5730795, 'binary_specificity': 0.9967156, 'binary_f1_score': 0.68732166}
confusion matrix:
       0    1
0  42182  139
1    628  843
---- Validation: 
scalar performance:
{'acc': 0.9787676, 'precision': 0.9296955, 'recall': 0.71898776, 'specificity': 0.71898776, 'f1': 0.7878163, 'auroc': 0.9791668, 'binary_precision': 0.878882, 'binary_recall': 0.44012442, 'binary_specificity': 0.99785113, 'binary_f1_score': 0.5865285}
confusion matrix:
       0    1
0  18110   39
1    360  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.81163657, 'recall': 0.561801, 'specificity': 0.561801, 'f1': 0.59607244, 'auroc': 0.9493888, 'binary_precision': 0.66, 'binary_recall': 0.12643678, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.21221867}
confusion matrix:
      0   1
0  5980  17
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_12.png
better model found
persisted
after epoch: 12,now: 2024-06-07 14:14:40.292391,epoch time: 0:14:46.375425,used: 3:01:37.009810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98164046, 'precision': 0.8567462, 'recall': 0.8632916, 'specificity': 0.8632916, 'f1': 0.8599864, 'auroc': 0.98127985, 'binary_precision': 0.7226667, 'binary_recall': 0.73641306, 'binary_specificity': 0.9901701, 'binary_f1_score': 0.72947514}
confusion matrix:
       0     1
0  41904   416
1    388  1084
---- Validation: 
scalar performance:
{'acc': 0.9819604, 'precision': 0.87425506, 'recall': 0.84214973, 'specificity': 0.84214973, 'f1': 0.8574207, 'auroc': 0.97850204, 'binary_precision': 0.75938565, 'binary_recall': 0.69206846, 'binary_specificity': 0.99223095, 'binary_f1_score': 0.724166}
confusion matrix:
       0    1
0  18008  141
1    198  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.85688406, 'recall': 0.56796503, 'specificity': 0.56796503, 'f1': 0.6067973, 'auroc': 0.9407087, 'binary_precision': 0.75, 'binary_recall': 0.13793103, 'binary_specificity': 0.997999, 'binary_f1_score': 0.2330097}
confusion matrix:
      0   1
0  5985  12
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_13.png
better model found
persisted
after epoch: 13,now: 2024-06-07 14:29:50.367868,epoch time: 0:15:10.075477,used: 3:16:47.085287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9826452, 'precision': 0.86958027, 'recall': 0.8598771, 'specificity': 0.8598771, 'f1': 0.8646586, 'auroc': 0.98176587, 'binary_precision': 0.74860334, 'binary_recall': 0.7282609, 'binary_specificity': 0.9914934, 'binary_f1_score': 0.73829204}
confusion matrix:
       0     1
0  41960   360
1    400  1072
---- Validation: 
scalar performance:
{'acc': 0.9814815, 'precision': 0.8692943, 'recall': 0.84040165, 'specificity': 0.84040165, 'f1': 0.85420835, 'auroc': 0.9806466, 'binary_precision': 0.749577, 'binary_recall': 0.688958, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.7179902}
confusion matrix:
       0    1
0  18001  148
1    200  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.80466473, 'recall': 0.600947, 'specificity': 0.600947, 'f1': 0.6467855, 'auroc': 0.9599298, 'binary_precision': 0.64285713, 'binary_recall': 0.20689656, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.3130435}
confusion matrix:
      0   1
0  5967  30
1   207  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_14.png
early stop counter: 1
val acc:0.9814814925193787, best validation acc: 0.9819604158401489, corresponding to test acc:                         0.9621284604072571 / 0.980025589466095
after epoch: 14,now: 2024-06-07 14:44:58.219785,epoch time: 0:15:07.851917,used: 3:31:54.937204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9834673, 'precision': 0.8920206, 'recall': 0.83931947, 'specificity': 0.83931947, 'f1': 0.8636166, 'auroc': 0.98702943, 'binary_precision': 0.7949527, 'binary_recall': 0.6847826, 'binary_specificity': 0.9938563, 'binary_f1_score': 0.7357665}
confusion matrix:
       0     1
0  42060   260
1    464  1008
---- Validation: 
scalar performance:
{'acc': 0.98259896, 'precision': 0.92311895, 'recall': 0.79147655, 'specificity': 0.79147655, 'f1': 0.844272, 'auroc': 0.98067904, 'binary_precision': 0.8607306, 'binary_recall': 0.58631414, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.6975023}
confusion matrix:
       0    1
0  18088   61
1    266  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8245397, 'recall': 0.56946385, 'specificity': 0.56946385, 'f1': 0.60758406, 'auroc': 0.9544456, 'binary_precision': 0.6851852, 'binary_recall': 0.14176245, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.23492064}
confusion matrix:
      0   1
0  5980  17
1   224  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_15.png
better model found
persisted
after epoch: 15,now: 2024-06-07 15:00:12.285480,epoch time: 0:15:14.065695,used: 3:47:09.002899,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9849287, 'precision': 0.8783984, 'recall': 0.89475965, 'specificity': 0.89475965, 'f1': 0.8863907, 'auroc': 0.98722756, 'binary_precision': 0.76382565, 'binary_recall': 0.79809654, 'binary_specificity': 0.9914227, 'binary_f1_score': 0.7805851}
confusion matrix:
       0     1
0  41958   363
1    297  1174
---- Validation: 
scalar performance:
{'acc': 0.98185396, 'precision': 0.87016517, 'recall': 0.847345, 'specificity': 0.847345, 'f1': 0.8583603, 'auroc': 0.98173404, 'binary_precision': 0.7508306, 'binary_recall': 0.7029549, 'binary_specificity': 0.9917351, 'binary_f1_score': 0.72610444}
confusion matrix:
       0    1
0  17999  150
1    191  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.8208686, 'recall': 0.58628833, 'specificity': 0.58628833, 'f1': 0.6300942, 'auroc': 0.9617119, 'binary_precision': 0.6764706, 'binary_recall': 0.17624521, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.27963525}
confusion matrix:
      0   1
0  5975  22
1   215  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_16.png
early stop counter: 1
val acc:0.9818539619445801, best validation acc: 0.9825989603996277, corresponding to test acc:                         0.9614893198013306 / 0.980025589466095
after epoch: 16,now: 2024-06-07 15:15:21.930262,epoch time: 0:15:09.644782,used: 4:02:18.647681,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9836043, 'precision': 0.8786495, 'recall': 0.8642181, 'specificity': 0.8642181, 'f1': 0.8712816, 'auroc': 0.9865051, 'binary_precision': 0.76645434, 'binary_recall': 0.73623383, 'binary_specificity': 0.99220246, 'binary_f1_score': 0.7510402}
confusion matrix:
       0     1
0  41991   330
1    388  1083
---- Validation: 
scalar performance:
{'acc': 0.98212004, 'precision': 0.91371197, 'recall': 0.79197866, 'specificity': 0.79197866, 'f1': 0.8415501, 'auroc': 0.9790761, 'binary_precision': 0.84187084, 'binary_recall': 0.58786935, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.6923077}
confusion matrix:
       0    1
0  18078   71
1    265  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7740087, 'recall': 0.51857346, 'specificity': 0.51857346, 'f1': 0.5254303, 'auroc': 0.94684255, 'binary_precision': 0.5882353, 'binary_recall': 0.038314175, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.07194245}
confusion matrix:
      0   1
0  5990   7
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_17.png
early stop counter: 2
val acc:0.9821200370788574, best validation acc: 0.9825989603996277, corresponding to test acc:                         0.9614893198013306 / 0.980025589466095
after epoch: 17,now: 2024-06-07 15:30:27.268626,epoch time: 0:15:05.338364,used: 4:17:23.986045,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98513424, 'precision': 0.9040913, 'recall': 0.8559192, 'specificity': 0.8559192, 'f1': 0.87835574, 'auroc': 0.98881894, 'binary_precision': 0.8179706, 'binary_recall': 0.7173913, 'binary_specificity': 0.99444705, 'binary_f1_score': 0.76438653}
confusion matrix:
       0     1
0  42085   235
1    416  1056
---- Validation: 
scalar performance:
{'acc': 0.9845679, 'precision': 0.93029743, 'recall': 0.8194979, 'specificity': 0.8194979, 'f1': 0.8660956, 'auroc': 0.9855879, 'binary_precision': 0.8731501, 'binary_recall': 0.64230174, 'binary_specificity': 0.996694, 'binary_f1_score': 0.74014336}
confusion matrix:
       0    1
0  18089   60
1    230  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7573465, 'recall': 0.5702123, 'specificity': 0.5702123, 'f1': 0.6047297, 'auroc': 0.93926704, 'binary_precision': 0.5507246, 'binary_recall': 0.14559387, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.23030302}
confusion matrix:
      0   1
0  5966  31
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_18.png
better model found
persisted
after epoch: 18,now: 2024-06-07 15:45:26.497580,epoch time: 0:14:59.228954,used: 4:32:23.214999,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9798822, 'precision': 0.96501815, 'recall': 0.7113708, 'specificity': 0.7113708, 'f1': 0.78774613, 'auroc': 0.98983705, 'binary_precision': 0.9496951, 'binary_recall': 0.4235214, 'binary_specificity': 0.99922025, 'binary_f1_score': 0.5858016}
confusion matrix:
       0    1
0  42288   33
1    848  623
---- Validation: 
scalar performance:
{'acc': 0.97722435, 'precision': 0.9655564, 'recall': 0.67543566, 'specificity': 0.67543566, 'f1': 0.75098777, 'auroc': 0.98298174, 'binary_precision': 0.9535865, 'binary_recall': 0.35147744, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.51363635}
confusion matrix:
       0    1
0  18138   11
1    417  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8557384, 'recall': 0.53964627, 'specificity': 0.53964627, 'f1': 0.5625638, 'auroc': 0.9582858, 'binary_precision': 0.75, 'binary_recall': 0.08045977, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.14532873}
confusion matrix:
      0   1
0  5990   7
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_19.png
early stop counter: 1
val acc:0.9772243499755859, best validation acc: 0.9845678806304932, corresponding to test acc:                         0.9594119787216187 / 0.980025589466095
after epoch: 19,now: 2024-06-07 16:00:39.595831,epoch time: 0:15:13.098251,used: 4:47:36.313250,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98020184, 'precision': 0.8353151, 'recall': 0.88451385, 'specificity': 0.88451385, 'f1': 0.85807073, 'auroc': 0.9836284, 'binary_precision': 0.67825574, 'binary_recall': 0.7819294, 'binary_specificity': 0.9870983, 'binary_f1_score': 0.7264121}
confusion matrix:
       0     1
0  41774   546
1    321  1151
---- Validation: 
scalar performance:
{'acc': 0.9819604, 'precision': 0.85495853, 'recall': 0.88415277, 'specificity': 0.88415277, 'f1': 0.868925, 'auroc': 0.97741866, 'binary_precision': 0.71776503, 'binary_recall': 0.7791602, 'binary_specificity': 0.9891454, 'binary_f1_score': 0.7472035}
confusion matrix:
       0    1
0  17952  197
1    142  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.8228314, 'recall': 0.6031962, 'specificity': 0.6031962, 'f1': 0.65129024, 'auroc': 0.93502665, 'binary_precision': 0.67901236, 'binary_recall': 0.21072797, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.32163742}
confusion matrix:
      0   1
0  5971  26
1   206  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_20.png
early stop counter: 2
val acc:0.9819604158401489, best validation acc: 0.9845678806304932, corresponding to test acc:                         0.9594119787216187 / 0.980025589466095
after epoch: 20,now: 2024-06-07 16:15:51.081766,epoch time: 0:15:11.485935,used: 5:02:47.799185,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9854768, 'precision': 0.91209173, 'recall': 0.85173523, 'specificity': 0.85173523, 'f1': 0.879341, 'auroc': 0.98820007, 'binary_precision': 0.83426744, 'binary_recall': 0.7083617, 'binary_specificity': 0.9951088, 'binary_f1_score': 0.76617646}
confusion matrix:
       0     1
0  42114   207
1    429  1042
---- Validation: 
scalar performance:
{'acc': 0.9838229, 'precision': 0.9098888, 'recall': 0.82811284, 'specificity': 0.82811284, 'f1': 0.8641119, 'auroc': 0.9762325, 'binary_precision': 0.83170253, 'binary_recall': 0.66096425, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.7365685}
confusion matrix:
       0    1
0  18063   86
1    218  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8865026, 'recall': 0.5644671, 'specificity': 0.5644671, 'f1': 0.6025903, 'auroc': 0.9516016, 'binary_precision': 0.8095238, 'binary_recall': 0.1302682, 'binary_specificity': 0.998666, 'binary_f1_score': 0.22442244}
confusion matrix:
      0   1
0  5989   8
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_21.png
early stop counter: 3
val acc:0.9838228821754456, best validation acc: 0.9845678806304932, corresponding to test acc:                         0.9594119787216187 / 0.980025589466095
after epoch: 21,now: 2024-06-07 16:31:13.870821,epoch time: 0:15:22.789055,used: 5:18:10.588240,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98182315, 'precision': 0.94329023, 'recall': 0.75601107, 'specificity': 0.75601107, 'f1': 0.8228891, 'auroc': 0.9866667, 'binary_precision': 0.9032258, 'binary_recall': 0.5139361, 'binary_specificity': 0.99808604, 'binary_f1_score': 0.6551126}
confusion matrix:
       0    1
0  42240   81
1    715  756
---- Validation: 
scalar performance:
{'acc': 0.9769583, 'precision': 0.9307785, 'recall': 0.68729883, 'specificity': 0.68729883, 'f1': 0.75799954, 'auroc': 0.97791797, 'binary_precision': 0.8832117, 'binary_recall': 0.3763608, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.52780807}
confusion matrix:
       0    1
0  18117   32
1    401  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7426802, 'recall': 0.5404781, 'specificity': 0.5404781, 'f1': 0.5620038, 'auroc': 0.9548416, 'binary_precision': 0.52380955, 'binary_recall': 0.08429119, 'binary_specificity': 0.996665, 'binary_f1_score': 0.14521453}
confusion matrix:
      0   1
0  5977  20
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_22.png
early stop counter: 4
val acc:0.9769582748413086, best validation acc: 0.9845678806304932, corresponding to test acc:                         0.9594119787216187 / 0.980025589466095
after epoch: 22,now: 2024-06-07 16:46:51.736328,epoch time: 0:15:37.865507,used: 5:33:48.453747,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9874178, 'precision': 0.927284, 'recall': 0.8695593, 'specificity': 0.8695593, 'f1': 0.89616877, 'auroc': 0.99200886, 'binary_precision': 0.86345696, 'binary_recall': 0.7432065, 'binary_specificity': 0.9959121, 'binary_f1_score': 0.7988317}
confusion matrix:
       0     1
0  42147   173
1    378  1094
---- Validation: 
scalar performance:
{'acc': 0.9843018, 'precision': 0.92004716, 'recall': 0.82536054, 'specificity': 0.82536054, 'f1': 0.8662257, 'auroc': 0.9838181, 'binary_precision': 0.85222673, 'binary_recall': 0.6547434, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.7405453}
confusion matrix:
       0    1
0  18076   73
1    222  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.7897019, 'recall': 0.62293506, 'specificity': 0.62293506, 'f1': 0.6691063, 'auroc': 0.9587519, 'binary_precision': 0.6111111, 'binary_recall': 0.25287357, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.35772356}
confusion matrix:
      0   1
0  5955  42
1   195  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_23.png
early stop counter: 5
val acc:0.9843018054962158, best validation acc: 0.9845678806304932, corresponding to test acc:                         0.9594119787216187 / 0.980025589466095
after epoch: 23,now: 2024-06-07 17:02:24.656010,epoch time: 0:15:32.919682,used: 5:49:21.373429,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9847689, 'precision': 0.94677156, 'recall': 0.80360055, 'specificity': 0.80360055, 'f1': 0.86056817, 'auroc': 0.9888747, 'binary_precision': 0.90697676, 'binary_recall': 0.609375, 'binary_specificity': 0.9978261, 'binary_f1_score': 0.72897196}
confusion matrix:
       0    1
0  42228   92
1    575  897
---- Validation: 
scalar performance:
{'acc': 0.9807365, 'precision': 0.9023129, 'recall': 0.77776134, 'specificity': 0.77776134, 'f1': 0.82775855, 'auroc': 0.9813489, 'binary_precision': 0.82004553, 'binary_recall': 0.5598756, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.66543436}
confusion matrix:
       0    1
0  18070   79
1    283  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.6638547, 'recall': 0.51240945, 'specificity': 0.51240945, 'f1': 0.5141305, 'auroc': 0.9366425, 'binary_precision': 0.36842105, 'binary_recall': 0.026819924, 'binary_specificity': 0.997999, 'binary_f1_score': 0.05}
confusion matrix:
      0   1
0  5985  12
1   254   7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_24.png
early stop counter: 6
val acc:0.980736494064331, best validation acc: 0.9845678806304932, corresponding to test acc:                         0.9594119787216187 / 0.980025589466095
after epoch: 24,now: 2024-06-07 17:18:32.988070,epoch time: 0:16:08.332060,used: 6:05:29.705489,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98887926, 'precision': 0.93287945, 'recall': 0.88925743, 'specificity': 0.88925743, 'f1': 0.9098211, 'auroc': 0.99205923, 'binary_precision': 0.87329286, 'binary_recall': 0.7824609, 'binary_specificity': 0.996054, 'binary_f1_score': 0.8253854}
confusion matrix:
       0     1
0  42154   167
1    320  1151
---- Validation: 
scalar performance:
{'acc': 0.98499364, 'precision': 0.92029107, 'recall': 0.83771956, 'specificity': 0.83771956, 'f1': 0.8741571, 'auroc': 0.97972095, 'binary_precision': 0.8518519, 'binary_recall': 0.67962676, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.7560554}
confusion matrix:
       0    1
0  18073   76
1    206  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.83394945, 'recall': 0.61843854, 'specificity': 0.61843854, 'f1': 0.6702394, 'auroc': 0.94829965, 'binary_precision': 0.7, 'binary_recall': 0.2413793, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.35897437}
confusion matrix:
      0   1
0  5970  27
1   198  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_25.png
better model found
persisted
after epoch: 25,now: 2024-06-07 17:34:36.042327,epoch time: 0:16:03.054257,used: 6:21:32.759746,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9822342, 'precision': 0.83973646, 'recall': 0.9314656, 'specificity': 0.9314656, 'f1': 0.87960756, 'auroc': 0.99095535, 'binary_precision': 0.68379235, 'binary_recall': 0.87703806, 'binary_specificity': 0.9858932, 'binary_f1_score': 0.76845235}
confusion matrix:
       0     1
0  41723   597
1    181  1291
---- Validation: 
scalar performance:
{'acc': 0.98249257, 'precision': 0.8539182, 'recall': 0.9009295, 'specificity': 0.9009295, 'f1': 0.8758206, 'auroc': 0.9821456, 'binary_precision': 0.7144809, 'binary_recall': 0.8133748, 'binary_specificity': 0.9884842, 'binary_f1_score': 0.7607273}
confusion matrix:
       0    1
0  17940  209
1    120  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.7877302, 'recall': 0.6098586, 'specificity': 0.6098586, 'f1': 0.6549344, 'auroc': 0.9453606, 'binary_precision': 0.6082474, 'binary_recall': 0.22605364, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.32960895}
confusion matrix:
      0   1
0  5959  38
1   202  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_26.png
early stop counter: 1
val acc:0.9824925661087036, best validation acc: 0.9849936366081238, corresponding to test acc:                         0.9640460014343262 / 0.980025589466095
after epoch: 26,now: 2024-06-07 17:50:17.541487,epoch time: 0:15:41.499160,used: 6:37:14.258906,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9856823, 'precision': 0.86616385, 'recall': 0.9417383, 'specificity': 0.9417383, 'f1': 0.90008706, 'auroc': 0.9920876, 'binary_precision': 0.7360179, 'binary_recall': 0.8946295, 'binary_specificity': 0.98884714, 'binary_f1_score': 0.8076097}
confusion matrix:
       0     1
0  41849   472
1    155  1316
---- Validation: 
scalar performance:
{'acc': 0.9828118, 'precision': 0.8541908, 'recall': 0.9085954, 'specificity': 0.9085954, 'f1': 0.87926733, 'auroc': 0.9826108, 'binary_precision': 0.71447724, 'binary_recall': 0.8289269, 'binary_specificity': 0.98826385, 'binary_f1_score': 0.7674586}
confusion matrix:
       0    1
0  17936  213
1    110  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.83614737, 'recall': 0.650422, 'specificity': 0.650422, 'f1': 0.70447904, 'auroc': 0.95084405, 'binary_precision': 0.7017544, 'binary_recall': 0.3065134, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.42666668}
confusion matrix:
      0   1
0  5963  34
1   181  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_27.png
early stop counter: 2
val acc:0.9828118085861206, best validation acc: 0.9849936366081238, corresponding to test acc:                         0.9640460014343262 / 0.980025589466095
after epoch: 27,now: 2024-06-07 18:06:08.076955,epoch time: 0:15:50.535468,used: 6:53:04.794374,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98894775, 'precision': 0.95442665, 'recall': 0.86740017, 'specificity': 0.86740017, 'f1': 0.9059675, 'auroc': 0.9936873, 'binary_precision': 0.9179357, 'binary_recall': 0.7370924, 'binary_specificity': 0.99770796, 'binary_f1_score': 0.81763375}
confusion matrix:
       0     1
0  42223    97
1    387  1085
---- Validation: 
scalar performance:
{'acc': 0.9832908, 'precision': 0.92240286, 'recall': 0.80458564, 'specificity': 0.80458564, 'f1': 0.85322833, 'auroc': 0.9837212, 'binary_precision': 0.8583878, 'binary_recall': 0.61275274, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.7150636}
confusion matrix:
       0    1
0  18084   65
1    249  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.80055285, 'recall': 0.5560539, 'specificity': 0.5560539, 'f1': 0.58724535, 'auroc': 0.9412949, 'binary_precision': 0.63829786, 'binary_recall': 0.11494253, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.19480518}
confusion matrix:
      0   1
0  5980  17
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_28.png
early stop counter: 3
val acc:0.9832907915115356, best validation acc: 0.9849936366081238, corresponding to test acc:                         0.9640460014343262 / 0.980025589466095
after epoch: 28,now: 2024-06-07 18:21:45.796399,epoch time: 0:15:37.719444,used: 7:08:42.513818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98771465, 'precision': 0.9367542, 'recall': 0.8641393, 'specificity': 0.8641393, 'f1': 0.89690554, 'auroc': 0.99318266, 'binary_precision': 0.88278687, 'binary_recall': 0.7316576, 'binary_specificity': 0.996621, 'binary_f1_score': 0.8001486}
confusion matrix:
       0     1
0  42177   143
1    395  1077
---- Validation: 
scalar performance:
{'acc': 0.98361003, 'precision': 0.91910636, 'recall': 0.8137516, 'specificity': 0.8137516, 'f1': 0.85827667, 'auroc': 0.97913873, 'binary_precision': 0.851153, 'binary_recall': 0.63141525, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.725}
confusion matrix:
       0    1
0  18078   71
1    237  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.76440483, 'recall': 0.5555536, 'specificity': 0.5555536, 'f1': 0.58513325, 'auroc': 0.9473959, 'binary_precision': 0.5660377, 'binary_recall': 0.11494253, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.1910828}
confusion matrix:
      0   1
0  5974  23
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_29.png
early stop counter: 4
val acc:0.9836100339889526, best validation acc: 0.9849936366081238, corresponding to test acc:                         0.9640460014343262 / 0.980025589466095
after epoch: 29,now: 2024-06-07 18:37:00.902638,epoch time: 0:15:15.106239,used: 7:23:57.620057,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.990158, 'precision': 0.93119884, 'recall': 0.91446924, 'specificity': 0.91446924, 'f1': 0.92265534, 'auroc': 0.9947667, 'binary_precision': 0.8681786, 'binary_recall': 0.8333333, 'binary_specificity': 0.9956051, 'binary_f1_score': 0.85039914}
confusion matrix:
       0     1
0  42136   186
1    245  1225
---- Validation: 
scalar performance:
{'acc': 0.9835568, 'precision': 0.8957857, 'recall': 0.8414761, 'specificity': 0.8414761, 'f1': 0.86646557, 'auroc': 0.9814816, 'binary_precision': 0.80253625, 'binary_recall': 0.688958, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.74142265}
confusion matrix:
       0    1
0  18040  109
1    200  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.73924565, 'recall': 0.5624661, 'specificity': 0.5624661, 'f1': 0.5933512, 'auroc': 0.9388995, 'binary_precision': 0.5151515, 'binary_recall': 0.1302682, 'binary_specificity': 0.994664, 'binary_f1_score': 0.20795105}
confusion matrix:
      0   1
0  5965  32
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21202597_30.png
early stop counter: 5
val acc:0.9835568070411682, best validation acc: 0.9849936366081238, corresponding to test acc:                         0.9640460014343262 / 0.980025589466095
after epoch: 30,now: 2024-06-07 18:52:09.480174,epoch time: 0:15:08.577536,used: 7:39:06.197593,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_07_11_13_03_seed_0_21202597
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:39:06.197593 at 2024-06-07 18:52:09.480174
persisted model performance metric: 

scalar performance:
{'acc': 0.96292746, 'precision': 0.82075024, 'recall': 0.60502857, 'specificity': 0.60502857, 'f1': 0.65326065, 'auroc': 0.9438324, 'binary_precision': 0.67469877, 'binary_recall': 0.21455939, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.3255814}
confusion matrix:
      0   1
0  5970  27
1   205  56
oracle model performance metric: 

scalar performance:
{'acc': 0.9792266, 'precision': 0.8776033, 'recall': 0.8554009, 'specificity': 0.8554009, 'f1': 0.86612934, 'auroc': 0.9575741, 'binary_precision': 0.7673469, 'binary_recall': 0.7203065, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.74308294}
confusion matrix:
      0    1
0  5940   57
1    73  188
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_new/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 502701 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool | 461013 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 502701 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool | 461013 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |  41687 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 496650 KiB |  13261 MiB |   1125 TiB |   1125 TiB |
|       from large pool | 455971 KiB |  13223 MiB |   1112 TiB |   1112 TiB |
|       from small pool |  40679 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14520 MiB |  14520 MiB |  14520 MiB |      0 B   |
|       from large pool |  14450 MiB |  14450 MiB |  14450 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 537683 KiB |   1244 MiB |    799 TiB |    799 TiB |
|       from large pool | 526122 KiB |   1235 MiB |    785 TiB |    785 TiB |
|       from small pool |  11560 KiB |     17 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    6479    |  197600 K  |  197597 K  |
|       from large pool |     187    |    1413    |  102880 K  |  102880 K  |
|       from small pool |    3301    |    6290    |   94719 K  |   94716 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    6479    |  197600 K  |  197597 K  |
|       from large pool |     187    |    1413    |  102880 K  |  102880 K  |
|       from small pool |    3301    |    6290    |   94719 K  |   94716 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     638    |     638    |     638    |       0    |
|       from large pool |     603    |     603    |     603    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      93    |    2814    |  110555 K  |  110555 K  |
|       from large pool |      46    |     600    |   60597 K  |   60596 K  |
|       from small pool |      47    |    2767    |   49958 K  |   49958 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13264 MiB |   1126 TiB |   1126 TiB |
|       from large pool |  65536 KiB |  13226 MiB |   1113 TiB |   1113 TiB |
|       from small pool |      0 KiB |     61 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13261 MiB |   1125 TiB |   1125 TiB |
|       from large pool |  65536 KiB |  13223 MiB |   1112 TiB |   1112 TiB |
|       from small pool |      0 KiB |     60 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1016 MiB |  14520 MiB |  14520 MiB |  13504 MiB |
|       from large pool |    964 MiB |  14450 MiB |  14450 MiB |  13486 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |   1244 MiB |    799 TiB |    799 TiB |
|       from large pool |      0 B   |   1235 MiB |    785 TiB |    785 TiB |
|       from small pool |      0 B   |     44 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6479    |  197600 K  |  197600 K  |
|       from large pool |       2    |    1413    |  102880 K  |  102880 K  |
|       from small pool |       0    |    6290    |   94719 K  |   94719 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6479    |  197600 K  |  197600 K  |
|       from large pool |       2    |    1413    |  102880 K  |  102880 K  |
|       from small pool |       0    |    6290    |   94719 K  |   94719 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     638    |     638    |     569    |
|       from large pool |      43    |     603    |     603    |     560    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    2814    |  110557 K  |  110557 K  |
|       from large pool |       0    |     600    |   60597 K  |   60597 K  |
|       from small pool |       0    |    2767    |   49960 K  |   49960 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jun  7 18:53:48 2024]
Finished job 0.
1 of 1 steps (100%) done
