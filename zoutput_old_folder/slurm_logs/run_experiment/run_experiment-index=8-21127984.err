Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jun  5 22:36:38 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984

 Experiment start at: 2024-06-05 22:52:07.463955
before training, model accuracy: 0.24001279473304749
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96620387, 'precision': 0.6899145, 'recall': 0.5061348, 'specificity': 0.5061348, 'f1': 0.50391847, 'auroc': 0.85035264, 'binary_precision': 0.41304347, 'binary_recall': 0.012907608, 'binary_specificity': 0.999362, 'binary_f1_score': 0.02503294}
confusion matrix:
       0   1
0  42293  27
1   1453  19
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.65950656, 'recall': 0.5043626, 'specificity': 0.5043626, 'f1': 0.50031614, 'auroc': 0.83696854, 'binary_precision': 0.3529412, 'binary_recall': 0.00933126, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.01818182}
confusion matrix:
       0   1
0  18138  11
1    637   6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.82471186, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-05 23:12:37.481900,epoch time: 0:20:30.017945,used: 0:20:30.017945,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96675193, 'precision': 0.75235164, 'recall': 0.53692335, 'specificity': 0.53692335, 'f1': 0.55819213, 'auroc': 0.90169895, 'binary_precision': 0.53588516, 'binary_recall': 0.07613868, 'binary_specificity': 0.997708, 'binary_f1_score': 0.13333333}
confusion matrix:
       0    1
0  42224   97
1   1359  112
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.7522348, 'recall': 0.5391957, 'specificity': 0.5391957, 'f1': 0.56163925, 'auroc': 0.8938185, 'binary_precision': 0.53608245, 'binary_recall': 0.08087092, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.14054054}
confusion matrix:
       0   1
0  18104  45
1    591  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.87148046, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-05 23:27:50.776098,epoch time: 0:15:13.294198,used: 0:35:43.312143,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96704876, 'precision': 0.7526356, 'recall': 0.5750945, 'specificity': 0.5750945, 'f1': 0.61164284, 'auroc': 0.91144145, 'binary_precision': 0.53395784, 'binary_recall': 0.1548913, 'binary_specificity': 0.99529773, 'binary_f1_score': 0.24012637}
confusion matrix:
       0    1
0  42121  199
1   1244  228
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.75351065, 'recall': 0.5851695, 'specificity': 0.5851695, 'f1': 0.62376964, 'auroc': 0.9090432, 'binary_precision': 0.53554505, 'binary_recall': 0.17573872, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.264637}
confusion matrix:
       0    1
0  18051   98
1    530  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.97945315, 'recall': 0.50766283, 'specificity': 0.50766283, 'f1': 0.5046054, 'auroc': 0.88102895, 'binary_precision': 1.0, 'binary_recall': 0.01532567, 'binary_specificity': 1.0, 'binary_f1_score': 0.030188678}
confusion matrix:
      0  1
0  5997  0
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-05 23:43:24.502464,epoch time: 0:15:33.726366,used: 0:51:17.038509,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9669118, 'precision': 0.74428296, 'recall': 0.6325618, 'specificity': 0.6325618, 'f1': 0.6702233, 'auroc': 0.9237076, 'binary_precision': 0.5133758, 'binary_recall': 0.27414966, 'binary_specificity': 0.99097395, 'binary_f1_score': 0.35742795}
confusion matrix:
       0    1
0  41940  382
1   1067  403
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.740154, 'recall': 0.62686956, 'specificity': 0.62686956, 'f1': 0.6642507, 'auroc': 0.92243296, 'binary_precision': 0.505988, 'binary_recall': 0.2628305, 'binary_specificity': 0.99090856, 'binary_f1_score': 0.345957}
confusion matrix:
       0    1
0  17984  165
1    474  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.9294125, 'recall': 0.5495583, 'specificity': 0.5495583, 'f1': 0.57992184, 'auroc': 0.89898336, 'binary_precision': 0.8965517, 'binary_recall': 0.099616855, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.17931034}
confusion matrix:
      0   1
0  5994   3
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_4.png
new oracle model saved
early stop counter: 1
val acc:0.9659961462020874, best validation acc: 0.9665815234184265, corresponding to test acc:                         0.9589325785636902 / 0.9619686603546143
after epoch: 4,now: 2024-06-05 23:59:10.137216,epoch time: 0:15:45.634752,used: 1:07:02.673261,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9669118, 'precision': 0.74477446, 'recall': 0.70846236, 'specificity': 0.70846236, 'f1': 0.7250047, 'auroc': 0.9296652, 'binary_precision': 0.50922215, 'binary_recall': 0.43138587, 'binary_specificity': 0.9855388, 'binary_f1_score': 0.4670835}
confusion matrix:
       0    1
0  41708  612
1    837  635
---- Validation: 
scalar performance:
{'acc': 0.96466583, 'precision': 0.73058987, 'recall': 0.70418656, 'specificity': 0.70418656, 'f1': 0.7164925, 'auroc': 0.9315258, 'binary_precision': 0.4814815, 'binary_recall': 0.42457232, 'binary_specificity': 0.98380077, 'binary_f1_score': 0.45123968}
confusion matrix:
       0    1
0  17855  294
1    370  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9686801, 'precision': 0.92179215, 'recall': 0.64467674, 'specificity': 0.64467674, 'f1': 0.71033686, 'auroc': 0.8932445, 'binary_precision': 0.87356323, 'binary_recall': 0.29118773, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.43678162}
confusion matrix:
      0   1
0  5986  11
1   185  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_5.png
new oracle model saved
early stop counter: 2
val acc:0.9646658301353455, best validation acc: 0.9665815234184265, corresponding to test acc:                         0.9589325785636902 / 0.9686800837516785
after epoch: 5,now: 2024-06-06 00:15:03.686084,epoch time: 0:15:53.548868,used: 1:22:56.222129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9666834, 'precision': 0.74303675, 'recall': 0.72113067, 'specificity': 0.72113067, 'f1': 0.7315091, 'auroc': 0.9346509, 'binary_precision': 0.5048689, 'binary_recall': 0.45788044, 'binary_specificity': 0.9843809, 'binary_f1_score': 0.48022804}
confusion matrix:
       0    1
0  41659  661
1    798  674
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.74136806, 'recall': 0.736295, 'specificity': 0.736295, 'f1': 0.7388015, 'auroc': 0.93811023, 'binary_precision': 0.5007949, 'binary_recall': 0.48989114, 'binary_specificity': 0.9826988, 'binary_f1_score': 0.495283}
confusion matrix:
       0    1
0  17835  314
1    328  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97235537, 'precision': 0.9299616, 'recall': 0.6924027, 'specificity': 0.6924027, 'f1': 0.7622087, 'auroc': 0.9127103, 'binary_precision': 0.88596493, 'binary_recall': 0.38697317, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.53866667}
confusion matrix:
      0    1
0  5984   13
1   160  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_6.png
new oracle model saved
early stop counter: 3
val acc:0.9658365249633789, best validation acc: 0.9665815234184265, corresponding to test acc:                         0.9589325785636902 / 0.9723553657531738
after epoch: 6,now: 2024-06-06 00:30:32.072380,epoch time: 0:15:28.386296,used: 1:38:24.608425,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96716297, 'precision': 0.7471312, 'recall': 0.7308867, 'specificity': 0.7308867, 'f1': 0.7387023, 'auroc': 0.9390185, 'binary_precision': 0.5123907, 'binary_recall': 0.47758153, 'binary_specificity': 0.9841919, 'binary_f1_score': 0.49437413}
confusion matrix:
       0    1
0  41651  669
1    769  703
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.7401841, 'recall': 0.7257391, 'specificity': 0.7257391, 'f1': 0.7327118, 'auroc': 0.9391897, 'binary_precision': 0.4991708, 'binary_recall': 0.4681182, 'binary_specificity': 0.98336, 'binary_f1_score': 0.48314607}
confusion matrix:
       0    1
0  17847  302
1    342  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97203577, 'precision': 0.9254943, 'recall': 0.69040364, 'specificity': 0.69040364, 'f1': 0.7594597, 'auroc': 0.9161806, 'binary_precision': 0.877193, 'binary_recall': 0.38314176, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.5333333}
confusion matrix:
      0    1
0  5983   14
1   161  100
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_7.png
early stop counter: 4
val acc:0.9657300710678101, best validation acc: 0.9665815234184265, corresponding to test acc:                         0.9589325785636902 / 0.9723553657531738
after epoch: 7,now: 2024-06-06 00:45:58.589399,epoch time: 0:15:26.517019,used: 1:53:51.125444,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9675968, 'precision': 0.7506703, 'recall': 0.7389798, 'specificity': 0.7389798, 'f1': 0.74467003, 'auroc': 0.9435648, 'binary_precision': 0.51891506, 'binary_recall': 0.49388587, 'binary_specificity': 0.9840737, 'binary_f1_score': 0.5060912}
confusion matrix:
       0    1
0  41646  674
1    745  727
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.75041497, 'recall': 0.74515164, 'specificity': 0.74515164, 'f1': 0.7477522, 'auroc': 0.9422673, 'binary_precision': 0.518283, 'binary_recall': 0.5069984, 'binary_specificity': 0.98330486, 'binary_f1_score': 0.5125786}
confusion matrix:
       0    1
0  17846  303
1    317  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9747523, 'precision': 0.9291451, 'recall': 0.72663534, 'specificity': 0.72663534, 'f1': 0.7939869, 'auroc': 0.9247165, 'binary_precision': 0.88148147, 'binary_recall': 0.4559387, 'binary_specificity': 0.997332, 'binary_f1_score': 0.6010101}
confusion matrix:
      0    1
0  5981   16
1   142  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-06-06 01:01:17.743707,epoch time: 0:15:19.154308,used: 2:09:10.279752,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96677476, 'precision': 0.74431074, 'recall': 0.74511164, 'specificity': 0.74511164, 'f1': 0.74471045, 'auroc': 0.9436492, 'binary_precision': 0.5057549, 'binary_recall': 0.5074728, 'binary_specificity': 0.9827505, 'binary_f1_score': 0.5066124}
confusion matrix:
       0    1
0  41590  730
1    725  747
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.74523234, 'recall': 0.7657675, 'specificity': 0.7657675, 'f1': 0.7550386, 'auroc': 0.94493496, 'binary_precision': 0.5064378, 'binary_recall': 0.5505443, 'binary_specificity': 0.9809907, 'binary_f1_score': 0.5275708}
confusion matrix:
       0    1
0  17804  345
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97315437, 'precision': 0.9153216, 'recall': 0.71297526, 'specificity': 0.71297526, 'f1': 0.77878594, 'auroc': 0.92274296, 'binary_precision': 0.8549618, 'binary_recall': 0.42911878, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.5714286}
confusion matrix:
      0    1
0  5978   19
1   149  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_9.png
early stop counter: 1
val acc:0.9662622213363647, best validation acc: 0.9670072197914124, corresponding to test acc:                         0.9747523069381714 / 0.9747523069381714
after epoch: 9,now: 2024-06-06 01:16:44.071047,epoch time: 0:15:26.327340,used: 2:24:36.607092,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9678252, 'precision': 0.7523656, 'recall': 0.75352377, 'specificity': 0.75352377, 'f1': 0.75294316, 'auroc': 0.9478215, 'binary_precision': 0.52129817, 'binary_recall': 0.5237772, 'binary_specificity': 0.98327035, 'binary_f1_score': 0.52253467}
confusion matrix:
       0    1
0  41612  708
1    701  771
---- Validation: 
scalar performance:
{'acc': 0.9660494, 'precision': 0.7429726, 'recall': 0.73640513, 'specificity': 0.73640513, 'f1': 0.7396387, 'auroc': 0.9449985, 'binary_precision': 0.504, 'binary_recall': 0.48989114, 'binary_specificity': 0.98291916, 'binary_f1_score': 0.49684542}
confusion matrix:
       0    1
0  17839  310
1    328  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97379357, 'precision': 0.95190847, 'recall': 0.7004824, 'specificity': 0.7004824, 'f1': 0.7739952, 'auroc': 0.9178021, 'binary_precision': 0.9292035, 'binary_recall': 0.40229884, 'binary_specificity': 0.998666, 'binary_f1_score': 0.56149733}
confusion matrix:
      0    1
0  5989    8
1   156  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_10.png
early stop counter: 2
val acc:0.9660493731498718, best validation acc: 0.9670072197914124, corresponding to test acc:                         0.9747523069381714 / 0.9747523069381714
after epoch: 10,now: 2024-06-06 01:32:16.061700,epoch time: 0:15:31.990653,used: 2:40:08.597745,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9666834, 'precision': 0.7443556, 'recall': 0.77737814, 'specificity': 0.77737814, 'f1': 0.75969934, 'auroc': 0.9488138, 'binary_precision': 0.5035757, 'binary_recall': 0.57443917, 'binary_specificity': 0.9803171, 'binary_f1_score': 0.5366783}
confusion matrix:
       0    1
0  41488  833
1    626  845
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.7428291, 'recall': 0.7790481, 'specificity': 0.7790481, 'f1': 0.7595304, 'auroc': 0.94727707, 'binary_precision': 0.50067294, 'binary_recall': 0.5785381, 'binary_specificity': 0.9795581, 'binary_f1_score': 0.53679657}
confusion matrix:
       0    1
0  17778  371
1    271  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97619045, 'precision': 0.9417875, 'recall': 0.7383797, 'specificity': 0.7383797, 'f1': 0.8071348, 'auroc': 0.92839503, 'binary_precision': 0.9057971, 'binary_recall': 0.4789272, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.6265664}
confusion matrix:
      0    1
0  5984   13
1   136  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_11.png
new oracle model saved
early stop counter: 3
val acc:0.9658365249633789, best validation acc: 0.9670072197914124, corresponding to test acc:                         0.9747523069381714 / 0.976190447807312
after epoch: 11,now: 2024-06-06 01:47:46.236761,epoch time: 0:15:30.175061,used: 2:55:38.772806,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9679622, 'precision': 0.7530449, 'recall': 0.78164876, 'specificity': 0.78164876, 'f1': 0.7664945, 'auroc': 0.9497299, 'binary_precision': 0.52068126, 'binary_recall': 0.58191705, 'binary_specificity': 0.9813804, 'binary_f1_score': 0.5495987}
confusion matrix:
       0    1
0  41533  788
1    615  856
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.75228095, 'recall': 0.7790419, 'specificity': 0.7790419, 'f1': 0.7649091, 'auroc': 0.9489064, 'binary_precision': 0.51960784, 'binary_recall': 0.5769829, 'binary_specificity': 0.9811009, 'binary_f1_score': 0.5467944}
confusion matrix:
       0    1
0  17806  343
1    272  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.94090664, 'recall': 0.7631172, 'specificity': 0.7631172, 'f1': 0.8276318, 'auroc': 0.9309687, 'binary_precision': 0.9019608, 'binary_recall': 0.52873564, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.6666666}
confusion matrix:
      0    1
0  5982   15
1   123  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_12.png
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-06-06 02:03:13.431160,epoch time: 0:15:27.194399,used: 3:11:05.967205,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96885276, 'precision': 0.75977576, 'recall': 0.7740548, 'specificity': 0.7740548, 'f1': 0.76670325, 'auroc': 0.9529247, 'binary_precision': 0.5347044, 'binary_recall': 0.5652174, 'binary_specificity': 0.9828923, 'binary_f1_score': 0.5495377}
confusion matrix:
       0    1
0  41596  724
1    640  832
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.751173, 'recall': 0.76995856, 'specificity': 0.76995856, 'f1': 0.760188, 'auroc': 0.95097107, 'binary_precision': 0.5180375, 'binary_recall': 0.55832034, 'binary_specificity': 0.98159677, 'binary_f1_score': 0.53742516}
confusion matrix:
       0    1
0  17815  334
1    284  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9753915, 'precision': 0.9426104, 'recall': 0.7269689, 'specificity': 0.7269689, 'f1': 0.79722035, 'auroc': 0.92822516, 'binary_precision': 0.90839696, 'binary_recall': 0.4559387, 'binary_specificity': 0.997999, 'binary_f1_score': 0.60714287}
confusion matrix:
      0    1
0  5985   12
1   142  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_13.png
early stop counter: 1
val acc:0.9671136736869812, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9779482483863831 / 0.9779482483863831
after epoch: 13,now: 2024-06-06 02:18:26.900109,epoch time: 0:15:13.468949,used: 3:26:19.436154,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9680992, 'precision': 0.75405645, 'recall': 0.80218863, 'specificity': 0.80218863, 'f1': 0.7757993, 'auroc': 0.95474374, 'binary_precision': 0.5212706, 'binary_recall': 0.6243206, 'binary_specificity': 0.9800567, 'binary_f1_score': 0.5681607}
confusion matrix:
       0    1
0  41476  844
1    553  919
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7502037, 'recall': 0.78937733, 'specificity': 0.78937733, 'f1': 0.7682003, 'auroc': 0.95187294, 'binary_precision': 0.5147059, 'binary_recall': 0.59875584, 'binary_specificity': 0.9799989, 'binary_f1_score': 0.5535586}
confusion matrix:
       0    1
0  17786  363
1    258  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97810805, 'precision': 0.93636644, 'recall': 0.76869756, 'specificity': 0.76869756, 'f1': 0.830853, 'auroc': 0.9278394, 'binary_precision': 0.8924051, 'binary_recall': 0.54022986, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.67303103}
confusion matrix:
      0    1
0  5980   17
1   120  141
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_14.png
new oracle model saved
early stop counter: 2
val acc:0.9669540524482727, best validation acc: 0.9672732949256897, corresponding to test acc:                         0.9779482483863831 / 0.9781080484390259
after epoch: 14,now: 2024-06-06 02:33:42.128132,epoch time: 0:15:15.228023,used: 3:41:34.664177,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9686929, 'precision': 0.75783646, 'recall': 0.8113481, 'specificity': 0.8113481, 'f1': 0.78178763, 'auroc': 0.95558095, 'binary_precision': 0.5281965, 'binary_recall': 0.64266306, 'binary_specificity': 0.9800331, 'binary_f1_score': 0.5798345}
confusion matrix:
       0    1
0  41475  845
1    526  946
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.75441384, 'recall': 0.7882079, 'specificity': 0.7882079, 'f1': 0.770136, 'auroc': 0.9539099, 'binary_precision': 0.52322406, 'binary_recall': 0.5956454, 'binary_specificity': 0.9807703, 'binary_f1_score': 0.55709094}
confusion matrix:
       0    1
0  17800  349
1    260  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97762865, 'precision': 0.9258207, 'recall': 0.77027977, 'specificity': 0.77027977, 'f1': 0.8291167, 'auroc': 0.93722415, 'binary_precision': 0.87116563, 'binary_recall': 0.5440613, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.6698113}
confusion matrix:
      0    1
0  5976   21
1   119  142
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_15.png
better model found
persisted
after epoch: 15,now: 2024-06-06 02:48:43.982993,epoch time: 0:15:01.854861,used: 3:56:36.519038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9695835, 'precision': 0.764467, 'recall': 0.79279304, 'specificity': 0.79279304, 'f1': 0.7778304, 'auroc': 0.9534037, 'binary_precision': 0.5427873, 'binary_recall': 0.6032609, 'binary_specificity': 0.98232514, 'binary_f1_score': 0.5714286}
confusion matrix:
       0    1
0  41572  748
1    584  888
---- Validation: 
scalar performance:
{'acc': 0.9686569, 'precision': 0.7623302, 'recall': 0.77450776, 'specificity': 0.77450776, 'f1': 0.76826537, 'auroc': 0.9551484, 'binary_precision': 0.5400593, 'binary_recall': 0.5660964, 'binary_specificity': 0.98291916, 'binary_f1_score': 0.55277145}
confusion matrix:
       0    1
0  17839  310
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97682965, 'precision': 0.9379953, 'recall': 0.7497072, 'specificity': 0.7497072, 'f1': 0.81588006, 'auroc': 0.92926013, 'binary_precision': 0.89726025, 'binary_recall': 0.5019157, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.64373463}
confusion matrix:
      0    1
0  5982   15
1   130  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_16.png
better model found
persisted
after epoch: 16,now: 2024-06-06 03:03:40.769362,epoch time: 0:14:56.786369,used: 4:11:33.305407,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97045124, 'precision': 0.7699642, 'recall': 0.80105126, 'specificity': 0.80105126, 'f1': 0.78456914, 'auroc': 0.95775306, 'binary_precision': 0.5531915, 'binary_recall': 0.61946905, 'binary_specificity': 0.98263353, 'binary_f1_score': 0.5844573}
confusion matrix:
       0    1
0  41588  735
1    559  910
---- Validation: 
scalar performance:
{'acc': 0.9686037, 'precision': 0.7617769, 'recall': 0.77823055, 'specificity': 0.77823055, 'f1': 0.76972485, 'auroc': 0.9564662, 'binary_precision': 0.53868616, 'binary_recall': 0.57387245, 'binary_specificity': 0.9825886, 'binary_f1_score': 0.5557229}
confusion matrix:
       0    1
0  17833  316
1    274  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97698945, 'precision': 0.9284688, 'recall': 0.75895226, 'specificity': 0.75895226, 'f1': 0.8209727, 'auroc': 0.9225334, 'binary_precision': 0.87741935, 'binary_recall': 0.5210728, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.6538462}
confusion matrix:
      0    1
0  5978   19
1   125  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_17.png
early stop counter: 1
val acc:0.9686036705970764, best validation acc: 0.9686568975448608, corresponding to test acc:                         0.9768296480178833 / 0.9781080484390259
after epoch: 17,now: 2024-06-06 03:18:35.366268,epoch time: 0:14:54.596906,used: 4:26:27.902313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96976614, 'precision': 0.7647429, 'recall': 0.81407875, 'specificity': 0.81407875, 'f1': 0.78707176, 'auroc': 0.9553995, 'binary_precision': 0.5418327, 'binary_recall': 0.64717877, 'binary_specificity': 0.9809787, 'binary_f1_score': 0.5898389}
confusion matrix:
       0    1
0  41516  805
1    519  952
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.75948226, 'recall': 0.8058724, 'specificity': 0.8058724, 'f1': 0.780553, 'auroc': 0.9571711, 'binary_precision': 0.5321101, 'binary_recall': 0.63141525, 'binary_specificity': 0.9803295, 'binary_f1_score': 0.5775249}
confusion matrix:
       0    1
0  17792  357
1    237  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9760307, 'precision': 0.91419876, 'recall': 0.7566197, 'specificity': 0.7566197, 'f1': 0.81522816, 'auroc': 0.93117297, 'binary_precision': 0.8490566, 'binary_recall': 0.51724136, 'binary_specificity': 0.995998, 'binary_f1_score': 0.64285713}
confusion matrix:
      0    1
0  5973   24
1   126  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_18.png
early stop counter: 2
val acc:0.9683908224105835, best validation acc: 0.9686568975448608, corresponding to test acc:                         0.9768296480178833 / 0.9781080484390259
after epoch: 18,now: 2024-06-06 03:33:20.116803,epoch time: 0:14:44.750535,used: 4:41:12.652848,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97131896, 'precision': 0.7766474, 'recall': 0.8048381, 'specificity': 0.8048381, 'f1': 0.789986, 'auroc': 0.96272945, 'binary_precision': 0.5663391, 'binary_recall': 0.6263587, 'binary_specificity': 0.98331755, 'binary_f1_score': 0.59483874}
confusion matrix:
       0    1
0  41614  706
1    550  922
---- Validation: 
scalar performance:
{'acc': 0.9699872, 'precision': 0.7717407, 'recall': 0.7871974, 'specificity': 0.7871974, 'f1': 0.7792319, 'auroc': 0.9572247, 'binary_precision': 0.55800295, 'binary_recall': 0.59097975, 'binary_specificity': 0.98341507, 'binary_f1_score': 0.5740181}
confusion matrix:
       0    1
0  17848  301
1    263  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9787472, 'precision': 0.950618, 'recall': 0.76719874, 'specificity': 0.76719874, 'f1': 0.8334886, 'auroc': 0.94429576, 'binary_precision': 0.92105263, 'binary_recall': 0.5363985, 'binary_specificity': 0.997999, 'binary_f1_score': 0.6779661}
confusion matrix:
      0    1
0  5985   12
1   121  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_19.png
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-06-06 03:48:11.388369,epoch time: 0:14:51.271566,used: 4:56:03.924414,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97035986, 'precision': 0.76832485, 'recall': 0.8214892, 'specificity': 0.8214892, 'f1': 0.79224336, 'auroc': 0.95901823, 'binary_precision': 0.548478, 'binary_recall': 0.66190475, 'binary_specificity': 0.9810737, 'binary_f1_score': 0.5998767}
confusion matrix:
       0    1
0  41521  801
1    497  973
---- Validation: 
scalar performance:
{'acc': 0.9680715, 'precision': 0.75740427, 'recall': 0.8057071, 'specificity': 0.8057071, 'f1': 0.7792417, 'auroc': 0.95727533, 'binary_precision': 0.5279584, 'binary_recall': 0.63141525, 'binary_specificity': 0.9799989, 'binary_f1_score': 0.5750708}
confusion matrix:
       0    1
0  17786  363
1    237  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97730905, 'precision': 0.9367038, 'recall': 0.75728667, 'specificity': 0.75728667, 'f1': 0.82180405, 'auroc': 0.930682, 'binary_precision': 0.89403975, 'binary_recall': 0.51724136, 'binary_specificity': 0.997332, 'binary_f1_score': 0.6553398}
confusion matrix:
      0    1
0  5981   16
1   126  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_20.png
early stop counter: 1
val acc:0.9680715203285217, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 20,now: 2024-06-06 04:03:04.274005,epoch time: 0:14:52.885636,used: 5:10:56.810050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9695378, 'precision': 0.76326644, 'recall': 0.81637526, 'specificity': 0.81637526, 'f1': 0.7871121, 'auroc': 0.95868814, 'binary_precision': 0.53872055, 'binary_recall': 0.65217394, 'binary_specificity': 0.9805766, 'binary_f1_score': 0.590043}
confusion matrix:
       0    1
0  41498  822
1    512  960
---- Validation: 
scalar performance:
{'acc': 0.968178, 'precision': 0.75807124, 'recall': 0.8072623, 'specificity': 0.8072623, 'f1': 0.78027666, 'auroc': 0.957374, 'binary_precision': 0.52918285, 'binary_recall': 0.63452566, 'binary_specificity': 0.9799989, 'binary_f1_score': 0.57708627}
confusion matrix:
       0    1
0  17786  363
1    235  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97810805, 'precision': 0.94651604, 'recall': 0.7613682, 'specificity': 0.7613682, 'f1': 0.8276745, 'auroc': 0.9335904, 'binary_precision': 0.91333336, 'binary_recall': 0.5249042, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.6666666}
confusion matrix:
      0    1
0  5984   13
1   124  137
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_21.png
early stop counter: 2
val acc:0.9681779742240906, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 21,now: 2024-06-06 04:18:08.227275,epoch time: 0:15:03.953270,used: 5:26:00.763320,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9698575, 'precision': 0.7649151, 'recall': 0.8303107, 'specificity': 0.8303107, 'f1': 0.7936111, 'auroc': 0.9580059, 'binary_precision': 0.5410367, 'binary_recall': 0.6807065, 'binary_specificity': 0.97991496, 'binary_f1_score': 0.60288805}
confusion matrix:
       0     1
0  41470   850
1    470  1002
---- Validation: 
scalar performance:
{'acc': 0.9686569, 'precision': 0.7609832, 'recall': 0.8165109, 'specificity': 0.8165109, 'f1': 0.78576636, 'auroc': 0.95861197, 'binary_precision': 0.53435117, 'binary_recall': 0.65318817, 'binary_specificity': 0.9798336, 'binary_f1_score': 0.5878237}
confusion matrix:
       0    1
0  17783  366
1    223  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9784276, 'precision': 0.9420903, 'recall': 0.7688643, 'specificity': 0.7688643, 'f1': 0.8325505, 'auroc': 0.9258237, 'binary_precision': 0.90384614, 'binary_recall': 0.54022986, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.6762589}
confusion matrix:
      0    1
0  5982   15
1   120  141
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_22.png
early stop counter: 3
val acc:0.9686568975448608, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 22,now: 2024-06-06 04:33:22.538573,epoch time: 0:15:14.311298,used: 5:41:15.074618,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97093076, 'precision': 0.7718164, 'recall': 0.83348894, 'specificity': 0.83348894, 'f1': 0.79916, 'auroc': 0.9634937, 'binary_precision': 0.5546403, 'binary_recall': 0.6861413, 'binary_specificity': 0.9808365, 'binary_f1_score': 0.61342245}
confusion matrix:
       0     1
0  41509   811
1    462  1010
---- Validation: 
scalar performance:
{'acc': 0.96934867, 'precision': 0.76562965, 'recall': 0.81311876, 'specificity': 0.81311876, 'f1': 0.78720295, 'auroc': 0.95994174, 'binary_precision': 0.5439056, 'binary_recall': 0.64541215, 'binary_specificity': 0.98082536, 'binary_f1_score': 0.5903272}
confusion matrix:
       0    1
0  17801  348
1    228  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9787472, 'precision': 0.9404067, 'recall': 0.774528, 'specificity': 0.774528, 'f1': 0.83654463, 'auroc': 0.9354334, 'binary_precision': 0.9, 'binary_recall': 0.55172414, 'binary_specificity': 0.997332, 'binary_f1_score': 0.68408555}
confusion matrix:
      0    1
0  5981   16
1   117  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_23.png
early stop counter: 4
val acc:0.969348669052124, best validation acc: 0.9699872136116028, corresponding to test acc:                         0.9787471890449524 / 0.9787471890449524
after epoch: 23,now: 2024-06-06 04:48:31.324636,epoch time: 0:15:08.786063,used: 5:56:23.860681,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9716387, 'precision': 0.77752364, 'recall': 0.82238007, 'specificity': 0.82238007, 'f1': 0.7980926, 'auroc': 0.96331286, 'binary_precision': 0.56686044, 'binary_recall': 0.6623641, 'binary_specificity': 0.982396, 'binary_f1_score': 0.61090225}
confusion matrix:
       0    1
0  41575  745
1    497  975
---- Validation: 
scalar performance:
{'acc': 0.97009367, 'precision': 0.7716507, 'recall': 0.7992534, 'specificity': 0.7992534, 'f1': 0.78471076, 'auroc': 0.9604007, 'binary_precision': 0.556962, 'binary_recall': 0.61586314, 'binary_specificity': 0.98264366, 'binary_f1_score': 0.5849335}
confusion matrix:
       0    1
0  17834  315
1    247  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.93839204, 'recall': 0.7649495, 'specificity': 0.7649495, 'f1': 0.8284321, 'auroc': 0.9387045, 'binary_precision': 0.8967742, 'binary_recall': 0.532567, 'binary_specificity': 0.997332, 'binary_f1_score': 0.6682692}
confusion matrix:
      0    1
0  5981   16
1   122  139
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_24.png
better model found
persisted
after epoch: 24,now: 2024-06-06 05:03:39.415366,epoch time: 0:15:08.090730,used: 6:11:31.951411,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9727119, 'precision': 0.7864785, 'recall': 0.81473887, 'specificity': 0.81473887, 'f1': 0.7998748, 'auroc': 0.96789336, 'binary_precision': 0.5853358, 'binary_recall': 0.64538044, 'binary_specificity': 0.98409736, 'binary_f1_score': 0.61389333}
confusion matrix:
       0    1
0  41647  673
1    522  950
---- Validation: 
scalar performance:
{'acc': 0.97259474, 'precision': 0.7919829, 'recall': 0.796798, 'specificity': 0.796798, 'f1': 0.79436874, 'auroc': 0.96269774, 'binary_precision': 0.5978593, 'binary_recall': 0.60808706, 'binary_specificity': 0.98550886, 'binary_f1_score': 0.6029298}
confusion matrix:
       0    1
0  17886  263
1    252  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9757111, 'precision': 0.9174576, 'recall': 0.7491236, 'specificity': 0.7491236, 'f1': 0.81014514, 'auroc': 0.9331492, 'binary_precision': 0.85620916, 'binary_recall': 0.5019157, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.6328502}
confusion matrix:
      0    1
0  5975   22
1   130  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_25.png
better model found
persisted
after epoch: 25,now: 2024-06-06 05:18:44.178018,epoch time: 0:15:04.762652,used: 6:26:36.714063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9716615, 'precision': 0.77656424, 'recall': 0.83681774, 'specificity': 0.83681774, 'f1': 0.8034053, 'auroc': 0.9653074, 'binary_precision': 0.5639181, 'binary_recall': 0.69225544, 'binary_specificity': 0.98138, 'binary_f1_score': 0.62153095}
confusion matrix:
       0     1
0  41532   788
1    453  1019
---- Validation: 
scalar performance:
{'acc': 0.9703065, 'precision': 0.7723066, 'recall': 0.8121146, 'specificity': 0.8121146, 'f1': 0.7907032, 'auroc': 0.96235394, 'binary_precision': 0.5573549, 'binary_recall': 0.64230174, 'binary_specificity': 0.9819274, 'binary_f1_score': 0.5968208}
confusion matrix:
       0    1
0  17821  328
1    230  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9793864, 'precision': 0.9329055, 'recall': 0.78952026, 'specificity': 0.78952026, 'f1': 0.8457012, 'auroc': 0.9444398, 'binary_precision': 0.88372093, 'binary_recall': 0.58237547, 'binary_specificity': 0.996665, 'binary_f1_score': 0.7020785}
confusion matrix:
      0    1
0  5977   20
1   109  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_26.png
new oracle model saved
early stop counter: 1
val acc:0.9703065156936646, best validation acc: 0.9725947380065918, corresponding to test acc:                         0.9757111072540283 / 0.9793863892555237
after epoch: 26,now: 2024-06-06 05:34:05.417400,epoch time: 0:15:21.239382,used: 6:41:57.953445,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9709079, 'precision': 0.77117693, 'recall': 0.8402605, 'specificity': 0.8402605, 'f1': 0.8013774, 'auroc': 0.96668303, 'binary_precision': 0.5528717, 'binary_recall': 0.70020396, 'binary_specificity': 0.9803171, 'binary_f1_score': 0.61787647}
confusion matrix:
       0     1
0  41488   833
1    441  1030
---- Validation: 
scalar performance:
{'acc': 0.97094506, 'precision': 0.77587533, 'recall': 0.8251961, 'specificity': 0.8251961, 'f1': 0.7982861, 'auroc': 0.96188855, 'binary_precision': 0.5635649, 'binary_recall': 0.6687403, 'binary_specificity': 0.9816519, 'binary_f1_score': 0.6116643}
confusion matrix:
       0    1
0  17816  333
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9792266, 'precision': 0.9303499, 'recall': 0.7894368, 'specificity': 0.7894368, 'f1': 0.8448505, 'auroc': 0.9389399, 'binary_precision': 0.8786127, 'binary_recall': 0.58237547, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.7004608}
confusion matrix:
      0    1
0  5976   21
1   109  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_27.png
early stop counter: 2
val acc:0.9709450602531433, best validation acc: 0.9725947380065918, corresponding to test acc:                         0.9757111072540283 / 0.9793863892555237
after epoch: 27,now: 2024-06-06 05:49:00.235569,epoch time: 0:14:54.818169,used: 6:56:52.771614,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97188985, 'precision': 0.7802195, 'recall': 0.81332994, 'specificity': 0.81332994, 'f1': 0.7957524, 'auroc': 0.96683943, 'binary_precision': 0.57289773, 'binary_recall': 0.6433424, 'binary_specificity': 0.98331755, 'binary_f1_score': 0.60607994}
confusion matrix:
       0    1
0  41614  706
1    525  947
---- Validation: 
scalar performance:
{'acc': 0.97270113, 'precision': 0.7921607, 'recall': 0.8013534, 'specificity': 0.8013534, 'f1': 0.7966784, 'auroc': 0.9623943, 'binary_precision': 0.59789157, 'binary_recall': 0.61741835, 'binary_specificity': 0.98528844, 'binary_f1_score': 0.6074981}
confusion matrix:
       0    1
0  17882  267
1    246  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9760307, 'precision': 0.9504072, 'recall': 0.73096704, 'specificity': 0.73096704, 'f1': 0.8024874, 'auroc': 0.9395761, 'binary_precision': 0.9236641, 'binary_recall': 0.46360153, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.6173469}
confusion matrix:
      0    1
0  5987   10
1   140  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_28.png
better model found
persisted
after epoch: 28,now: 2024-06-06 06:03:51.681730,epoch time: 0:14:51.446161,used: 7:11:44.217775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9737395, 'precision': 0.79587066, 'recall': 0.80904126, 'specificity': 0.80904126, 'f1': 0.80229795, 'auroc': 0.9690885, 'binary_precision': 0.6045455, 'binary_recall': 0.6324728, 'binary_specificity': 0.98560965, 'binary_f1_score': 0.61819386}
confusion matrix:
       0    1
0  41711  609
1    541  931
---- Validation: 
scalar performance:
{'acc': 0.9747765, 'precision': 0.81300163, 'recall': 0.79417723, 'specificity': 0.79417723, 'f1': 0.80326927, 'auroc': 0.9641129, 'binary_precision': 0.64013267, 'binary_recall': 0.60031104, 'binary_specificity': 0.9880434, 'binary_f1_score': 0.61958265}
confusion matrix:
       0    1
0  17932  217
1    257  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97619045, 'precision': 0.9507761, 'recall': 0.73288274, 'specificity': 0.73288274, 'f1': 0.80428725, 'auroc': 0.94171, 'binary_precision': 0.92424244, 'binary_recall': 0.46743295, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.62086517}
confusion matrix:
      0    1
0  5987   10
1   139  122
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_29.png
better model found
persisted
after epoch: 29,now: 2024-06-06 06:19:06.375594,epoch time: 0:15:14.693864,used: 7:26:58.911639,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9731458, 'precision': 0.78762054, 'recall': 0.8319037, 'specificity': 0.8319037, 'f1': 0.80801165, 'auroc': 0.9695476, 'binary_precision': 0.5864089, 'binary_recall': 0.6804895, 'binary_specificity': 0.983318, 'binary_f1_score': 0.629956}
confusion matrix:
       0     1
0  41615   706
1    470  1001
---- Validation: 
scalar performance:
{'acc': 0.9753619, 'precision': 0.81203246, 'recall': 0.8199822, 'specificity': 0.8199822, 'f1': 0.8159523, 'auroc': 0.96676487, 'binary_precision': 0.6363636, 'binary_recall': 0.65318817, 'binary_specificity': 0.9867761, 'binary_f1_score': 0.64466614}
confusion matrix:
       0    1
0  17909  240
1    223  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9785874, 'precision': 0.9244052, 'recall': 0.78543866, 'specificity': 0.78543866, 'f1': 0.8400767, 'auroc': 0.94019634, 'binary_precision': 0.867052, 'binary_recall': 0.57471263, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.69124424}
confusion matrix:
      0    1
0  5974   23
1   111  150
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_30.png
better model found
persisted
after epoch: 30,now: 2024-06-06 06:34:03.846999,epoch time: 0:14:57.471405,used: 7:41:56.383044,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_05_22_52_07_seed_0_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:41:56.383044 at 2024-06-06 06:34:03.846999
persisted model performance metric: 

scalar performance:
{'acc': 0.9795462, 'precision': 0.93120503, 'recall': 0.79326826, 'specificity': 0.79326826, 'f1': 0.84791297, 'auroc': 0.94130325, 'binary_precision': 0.88, 'binary_recall': 0.5900383, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.70642203}
confusion matrix:
      0    1
0  5976   21
1   107  154
oracle model performance metric: 

scalar performance:
{'acc': 0.97698945, 'precision': 0.9095435, 'recall': 0.7754433, 'specificity': 0.7754433, 'f1': 0.82814205, 'auroc': 0.9436407, 'binary_precision': 0.83815026, 'binary_recall': 0.5555556, 'binary_specificity': 0.995331, 'binary_f1_score': 0.66820276}
confusion matrix:
      0    1
0  5969   28
1   116  145
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 537051 KiB |   1857 MiB |   1140 TiB |   1140 TiB |
|       from large pool | 447232 KiB |   1786 MiB |   1137 TiB |   1137 TiB |
|       from small pool |  89819 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 537051 KiB |   1857 MiB |   1140 TiB |   1140 TiB |
|       from large pool | 447232 KiB |   1786 MiB |   1137 TiB |   1137 TiB |
|       from small pool |  89819 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 525469 KiB |   1842 MiB |   1133 TiB |   1133 TiB |
|       from large pool | 436736 KiB |   1772 MiB |   1130 TiB |   1130 TiB |
|       from small pool |  88733 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2048 MiB |   2048 MiB |   2048 MiB |      0 B   |
|       from large pool |   1922 MiB |   1922 MiB |   1922 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 656932 KiB | 678485 KiB | 613062 GiB | 613061 GiB |
|       from large pool | 650496 KiB | 674880 KiB | 609765 GiB | 609764 GiB |
|       from small pool |   6436 KiB |  16720 KiB |   3297 GiB |   3297 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6700    |  128056 K  |  128052 K  |
|       from large pool |      87    |     178    |   54999 K  |   54999 K  |
|       from small pool |    3642    |    6612    |   73056 K  |   73052 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6700    |  128056 K  |  128052 K  |
|       from large pool |      87    |     178    |   54999 K  |   54999 K  |
|       from small pool |    3642    |    6612    |   73056 K  |   73052 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      96    |      96    |      96    |       0    |
|       from large pool |      33    |      33    |      33    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      46    |    2760    |   54813 K  |   54813 K  |
|       from large pool |      14    |      22    |   21118 K  |   21118 K  |
|       from small pool |      32    |    2746    |   33695 K  |   33695 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   1857 MiB |   1140 TiB |   1140 TiB |
|       from large pool |  65536 KiB |   1786 MiB |   1137 TiB |   1137 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   1857 MiB |   1140 TiB |   1140 TiB |
|       from large pool |  65536 KiB |   1786 MiB |   1137 TiB |   1137 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   1842 MiB |   1133 TiB |   1133 TiB |
|       from large pool |  65536 KiB |   1772 MiB |   1130 TiB |   1130 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1166 MiB |   2048 MiB |   2048 MiB |    882 MiB |
|       from large pool |   1072 MiB |   1922 MiB |   1922 MiB |    850 MiB |
|       from small pool |     94 MiB |    126 MiB |    126 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |    797 MiB | 613062 GiB | 613062 GiB |
|       from large pool | 116736 KiB |    781 MiB | 609765 GiB | 609765 GiB |
|       from small pool |      0 KiB |     28 MiB |   3297 GiB |   3297 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6700    |  128056 K  |  128056 K  |
|       from large pool |       2    |     178    |   54999 K  |   54999 K  |
|       from small pool |       0    |    6612    |   73056 K  |   73056 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6700    |  128056 K  |  128056 K  |
|       from large pool |       2    |     178    |   54999 K  |   54999 K  |
|       from small pool |       0    |    6612    |   73056 K  |   73056 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      67    |      96    |      96    |      29    |
|       from large pool |      20    |      33    |      33    |      13    |
|       from small pool |      47    |      63    |      63    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2760    |   54815 K  |   54815 K  |
|       from large pool |       3    |      22    |   21118 K  |   21118 K  |
|       from small pool |       0    |    2746    |   33697 K  |   33697 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   1857 MiB |   1140 TiB |   1140 TiB |
|       from large pool |  65536 KiB |   1786 MiB |   1137 TiB |   1137 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   1857 MiB |   1140 TiB |   1140 TiB |
|       from large pool |  65536 KiB |   1786 MiB |   1137 TiB |   1137 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   1842 MiB |   1133 TiB |   1133 TiB |
|       from large pool |  65536 KiB |   1772 MiB |   1130 TiB |   1130 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1166 MiB |   2048 MiB |   2048 MiB |    882 MiB |
|       from large pool |   1072 MiB |   1922 MiB |   1922 MiB |    850 MiB |
|       from small pool |     94 MiB |    126 MiB |    126 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |    797 MiB | 613062 GiB | 613062 GiB |
|       from large pool | 116736 KiB |    781 MiB | 609765 GiB | 609765 GiB |
|       from small pool |      0 KiB |     28 MiB |   3297 GiB |   3297 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6700    |  128056 K  |  128056 K  |
|       from large pool |       2    |     178    |   54999 K  |   54999 K  |
|       from small pool |       0    |    6612    |   73056 K  |   73056 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6700    |  128056 K  |  128056 K  |
|       from large pool |       2    |     178    |   54999 K  |   54999 K  |
|       from small pool |       0    |    6612    |   73056 K  |   73056 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      67    |      96    |      96    |      29    |
|       from large pool |      20    |      33    |      33    |      13    |
|       from small pool |      47    |      63    |      63    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2760    |   54815 K  |   54815 K  |
|       from large pool |       3    |      22    |   21118 K  |   21118 K  |
|       from small pool |       0    |    2746    |   33697 K  |   33697 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984

 Experiment start at: 2024-06-06 06:41:08.162557
before training, model accuracy: 0.09474702179431915
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96727926, 'precision': 0.7985585, 'recall': 0.5057767, 'specificity': 0.5057767, 'f1': 0.503253, 'auroc': 0.82174397, 'binary_precision': 0.6296296, 'binary_recall': 0.011789181, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.023144994}
confusion matrix:
       0   1
0  42404  10
1   1425  17
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.7946695, 'recall': 0.50363165, 'specificity': 0.50363165, 'f1': 0.498225, 'auroc': 0.80854654, 'binary_precision': 0.625, 'binary_recall': 0.0074294205, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.014684287}
confusion matrix:
       0  1
0  18064  3
1    668  5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.78907406, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-06 06:56:41.314150,epoch time: 0:15:33.151593,used: 0:15:33.151593,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96700567, 'precision': 0.72347224, 'recall': 0.5186984, 'specificity': 0.5186984, 'f1': 0.5275226, 'auroc': 0.889789, 'binary_precision': 0.47863248, 'binary_recall': 0.03883495, 'binary_specificity': 0.9985618, 'binary_f1_score': 0.07184093}
confusion matrix:
       0   1
0  42353  61
1   1386  56
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.7740555, 'recall': 0.5441018, 'specificity': 0.5441018, 'f1': 0.56946933, 'auroc': 0.89093083, 'binary_precision': 0.5809524, 'binary_recall': 0.09063893, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.15681234}
confusion matrix:
       0   1
0  18023  44
1    612  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.9792069, 'recall': 0.50384617, 'specificity': 0.50384617, 'f1': 0.4970163, 'auroc': 0.86529016, 'binary_precision': 1.0, 'binary_recall': 0.0076923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.015267175}
confusion matrix:
      0  1
0  5946  0
1   258  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-06 07:11:25.889002,epoch time: 0:14:44.574852,used: 0:30:17.726445,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96705127, 'precision': 0.7345733, 'recall': 0.58001816, 'specificity': 0.58001816, 'f1': 0.61586314, 'auroc': 0.9106091, 'binary_precision': 0.49688148, 'binary_recall': 0.16574202, 'binary_specificity': 0.99429435, 'binary_f1_score': 0.24856994}
confusion matrix:
       0    1
0  42172  242
1   1203  239
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.7501912, 'recall': 0.6450375, 'specificity': 0.6450375, 'f1': 0.6821428, 'auroc': 0.9107926, 'binary_precision': 0.5260417, 'binary_recall': 0.30014858, 'binary_specificity': 0.9899264, 'binary_f1_score': 0.38221383}
confusion matrix:
       0    1
0  17885  182
1    471  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.9617562, 'recall': 0.5479928, 'specificity': 0.5479928, 'f1': 0.5776814, 'auroc': 0.8850914, 'binary_precision': 0.96153843, 'binary_recall': 0.09615385, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.17482518}
confusion matrix:
      0   1
0  5945   1
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-06 07:26:02.245047,epoch time: 0:14:36.356045,used: 0:44:54.082490,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9667776, 'precision': 0.7305418, 'recall': 0.598634, 'specificity': 0.598634, 'f1': 0.63560927, 'auroc': 0.9173753, 'binary_precision': 0.4876033, 'binary_recall': 0.20457697, 'binary_specificity': 0.9926911, 'binary_f1_score': 0.28822666}
confusion matrix:
       0    1
0  42104  310
1   1147  295
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.7473073, 'recall': 0.67356515, 'specificity': 0.67356515, 'f1': 0.7032548, 'auroc': 0.9203732, 'binary_precision': 0.5182013, 'binary_recall': 0.35958394, 'binary_specificity': 0.9875464, 'binary_f1_score': 0.4245614}
confusion matrix:
       0    1
0  17842  225
1    431  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.92787623, 'recall': 0.5784257, 'specificity': 0.5784257, 'f1': 0.62473536, 'auroc': 0.89660794, 'binary_precision': 0.8913044, 'binary_recall': 0.15769231, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.26797387}
confusion matrix:
      0   1
0  5941   5
1   219  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_4.png
new oracle model saved
early stop counter: 1
val acc:0.9649946689605713, best validation acc: 0.965154767036438, corresponding to test acc:                         0.9619722962379456 / 0.9639058709144592
after epoch: 4,now: 2024-06-06 07:40:35.881435,epoch time: 0:14:33.636388,used: 0:59:27.718878,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96723366, 'precision': 0.7394241, 'recall': 0.6316951, 'specificity': 0.6316951, 'f1': 0.66838354, 'auroc': 0.92786014, 'binary_precision': 0.503201, 'binary_recall': 0.27253816, 'binary_specificity': 0.99085206, 'binary_f1_score': 0.35357627}
confusion matrix:
       0    1
0  42026  388
1   1049  393
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.7440533, 'recall': 0.6826976, 'specificity': 0.6826976, 'f1': 0.70846033, 'auroc': 0.9263103, 'binary_precision': 0.51102203, 'binary_recall': 0.37890044, 'binary_specificity': 0.9864947, 'binary_f1_score': 0.43515357}
confusion matrix:
       0    1
0  17823  244
1    418  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.9226578, 'recall': 0.5974883, 'specificity': 0.5974883, 'f1': 0.6514473, 'auroc': 0.9070388, 'binary_precision': 0.87931037, 'binary_recall': 0.19615385, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.3207547}
confusion matrix:
      0   1
0  5939   7
1   209  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_5.png
new oracle model saved
early stop counter: 2
val acc:0.9646744728088379, best validation acc: 0.965154767036438, corresponding to test acc:                         0.9619722962379456 / 0.9651950001716614
after epoch: 5,now: 2024-06-06 07:55:13.494929,epoch time: 0:14:37.613494,used: 1:14:05.332372,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9673021, 'precision': 0.7408301, 'recall': 0.6578567, 'specificity': 0.6578567, 'f1': 0.6898302, 'auroc': 0.93208325, 'binary_precision': 0.50428265, 'binary_recall': 0.32662967, 'binary_specificity': 0.98908377, 'binary_f1_score': 0.39646465}
confusion matrix:
       0    1
0  41951  463
1    971  471
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.7389125, 'recall': 0.70453876, 'specificity': 0.70453876, 'f1': 0.7202338, 'auroc': 0.9290223, 'binary_precision': 0.4991274, 'binary_recall': 0.42496285, 'binary_specificity': 0.9841147, 'binary_f1_score': 0.45906898}
confusion matrix:
       0    1
0  17780  287
1    387  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96696746, 'precision': 0.93901604, 'recall': 0.61680317, 'specificity': 0.61680317, 'f1': 0.6780628, 'auroc': 0.9098418, 'binary_precision': 0.9104478, 'binary_recall': 0.23461539, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.3730887}
confusion matrix:
      0   1
0  5940   6
1   199  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_6.png
new oracle model saved
early stop counter: 3
val acc:0.9640341401100159, best validation acc: 0.965154767036438, corresponding to test acc:                         0.9619722962379456 / 0.9669674634933472
after epoch: 6,now: 2024-06-06 08:09:56.857293,epoch time: 0:14:43.362364,used: 1:28:48.694736,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9673705, 'precision': 0.74225926, 'recall': 0.6923922, 'specificity': 0.6923922, 'f1': 0.71416235, 'auroc': 0.93744755, 'binary_precision': 0.5048373, 'binary_recall': 0.39805827, 'binary_specificity': 0.9867261, 'binary_f1_score': 0.44513375}
confusion matrix:
       0    1
0  41851  563
1    868  574
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.74182254, 'recall': 0.7147186, 'specificity': 0.7147186, 'f1': 0.7273696, 'auroc': 0.93052995, 'binary_precision': 0.5042017, 'binary_recall': 0.44576523, 'binary_specificity': 0.9836719, 'binary_f1_score': 0.47318614}
confusion matrix:
       0    1
0  17772  295
1    373  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9703513, 'precision': 0.9336777, 'recall': 0.66454375, 'specificity': 0.66454375, 'f1': 0.733942, 'auroc': 0.9058727, 'binary_precision': 0.8958333, 'binary_recall': 0.33076924, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.48314604}
confusion matrix:
      0   1
0  5936  10
1   174  86
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_7.png
new oracle model saved
early stop counter: 4
val acc:0.9643543362617493, best validation acc: 0.965154767036438, corresponding to test acc:                         0.9619722962379456 / 0.9703512787818909
after epoch: 7,now: 2024-06-06 08:24:52.514646,epoch time: 0:14:55.657353,used: 1:43:44.352089,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96670926, 'precision': 0.73730934, 'recall': 0.71817654, 'specificity': 0.71817654, 'f1': 0.7272965, 'auroc': 0.940729, 'binary_precision': 0.49319214, 'binary_recall': 0.45214978, 'binary_specificity': 0.98420334, 'binary_f1_score': 0.47178}
confusion matrix:
       0    1
0  41744  670
1    790  652
---- Validation: 
scalar performance:
{'acc': 0.9628068, 'precision': 0.73269874, 'recall': 0.7489641, 'specificity': 0.7489641, 'f1': 0.74052143, 'auroc': 0.9355336, 'binary_precision': 0.4833795, 'binary_recall': 0.5185735, 'binary_specificity': 0.9793546, 'binary_f1_score': 0.5003584}
confusion matrix:
       0    1
0  17694  373
1    324  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9732517, 'precision': 0.9545555, 'recall': 0.69364214, 'specificity': 0.69364214, 'f1': 0.76756513, 'auroc': 0.9098599, 'binary_precision': 0.9351852, 'binary_recall': 0.38846153, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.54891306}
confusion matrix:
      0    1
0  5939    7
1   159  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_8.png
new oracle model saved
early stop counter: 5
val acc:0.9628068208694458, best validation acc: 0.965154767036438, corresponding to test acc:                         0.9619722962379456 / 0.9732517004013062
after epoch: 8,now: 2024-06-06 08:40:04.551846,epoch time: 0:15:12.037200,used: 1:58:56.389289,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9676441, 'precision': 0.7451897, 'recall': 0.71698517, 'specificity': 0.71698517, 'f1': 0.73013425, 'auroc': 0.9424638, 'binary_precision': 0.509048, 'binary_recall': 0.4486824, 'binary_specificity': 0.9852879, 'binary_f1_score': 0.47696277}
confusion matrix:
       0    1
0  41790  624
1    795  647
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.74489695, 'recall': 0.7434953, 'specificity': 0.7434953, 'f1': 0.7441939, 'auroc': 0.9396888, 'binary_precision': 0.5082212, 'binary_recall': 0.50520056, 'binary_specificity': 0.98179, 'binary_f1_score': 0.5067064}
confusion matrix:
       0    1
0  17738  329
1    333  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97454077, 'precision': 0.9403744, 'recall': 0.71822166, 'specificity': 0.71822166, 'f1': 0.7887677, 'auroc': 0.91824126, 'binary_precision': 0.9047619, 'binary_recall': 0.43846154, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.59067357}
confusion matrix:
      0    1
0  5934   12
1   146  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_9.png
new oracle model saved
early stop counter: 6
val acc:0.9646744728088379, best validation acc: 0.965154767036438, corresponding to test acc:                         0.9619722962379456 / 0.9745407700538635
after epoch: 9,now: 2024-06-06 08:55:14.574936,epoch time: 0:15:10.023090,used: 2:14:06.412379,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96778095, 'precision': 0.7462349, 'recall': 0.72055185, 'specificity': 0.72055185, 'f1': 0.7326109, 'auroc': 0.94128525, 'binary_precision': 0.5108865, 'binary_recall': 0.4559334, 'binary_specificity': 0.98517036, 'binary_f1_score': 0.4818482}
confusion matrix:
       0    1
0  41786  629
1    784  657
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.7388712, 'recall': 0.7565872, 'specificity': 0.7565872, 'f1': 0.74737245, 'auroc': 0.9409662, 'binary_precision': 0.4951724, 'binary_recall': 0.53343236, 'binary_specificity': 0.97974205, 'binary_f1_score': 0.5135909}
confusion matrix:
       0    1
0  17701  366
1    314  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97486305, 'precision': 0.9476748, 'recall': 0.71838987, 'specificity': 0.71838987, 'f1': 0.79039013, 'auroc': 0.9291854, 'binary_precision': 0.91935486, 'binary_recall': 0.43846154, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.59375}
confusion matrix:
      0    1
0  5936   10
1   146  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_10.png
new oracle model saved
early stop counter: 7
val acc:0.9637140035629272, best validation acc: 0.965154767036438, corresponding to test acc:                         0.9619722962379456 / 0.9748630523681641
after epoch: 10,now: 2024-06-06 09:10:20.863571,epoch time: 0:15:06.288635,used: 2:29:12.701014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9676669, 'precision': 0.74574196, 'recall': 0.74211836, 'specificity': 0.74211836, 'f1': 0.7439152, 'auroc': 0.9483291, 'binary_precision': 0.5084507, 'binary_recall': 0.5006935, 'binary_specificity': 0.98354316, 'binary_f1_score': 0.5045423}
confusion matrix:
       0    1
0  41716  698
1    720  722
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.74675024, 'recall': 0.76434875, 'specificity': 0.76434875, 'f1': 0.7552091, 'auroc': 0.94144464, 'binary_precision': 0.5103735, 'binary_recall': 0.5482912, 'binary_specificity': 0.9804063, 'binary_f1_score': 0.5286533}
confusion matrix:
       0    1
0  17713  354
1    304  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9737351, 'precision': 0.9556711, 'recall': 0.6994114, 'specificity': 0.6994114, 'f1': 0.7735549, 'auroc': 0.928654, 'binary_precision': 0.9369369, 'binary_recall': 0.4, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.5606469}
confusion matrix:
      0    1
0  5939    7
1   156  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_11.png
early stop counter: 8
val acc:0.9648879170417786, best validation acc: 0.965154767036438, corresponding to test acc:                         0.9619722962379456 / 0.9748630523681641
after epoch: 11,now: 2024-06-06 09:25:12.167972,epoch time: 0:14:51.304401,used: 2:44:04.005415,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9679861, 'precision': 0.74839175, 'recall': 0.7583611, 'specificity': 0.7583611, 'f1': 0.75326747, 'auroc': 0.9507787, 'binary_precision': 0.5126498, 'binary_recall': 0.5339806, 'binary_specificity': 0.98274153, 'binary_f1_score': 0.5230978}
confusion matrix:
       0    1
0  41682  732
1    672  770
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.7439092, 'recall': 0.7741134, 'specificity': 0.7741134, 'f1': 0.7580197, 'auroc': 0.94438833, 'binary_precision': 0.5039474, 'binary_recall': 0.5690936, 'binary_specificity': 0.97913325, 'binary_f1_score': 0.5345429}
confusion matrix:
       0    1
0  17690  377
1    290  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9737351, 'precision': 0.9447013, 'recall': 0.70492834, 'specificity': 0.70492834, 'f1': 0.7770477, 'auroc': 0.92756844, 'binary_precision': 0.9145299, 'binary_recall': 0.41153845, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.56763923}
confusion matrix:
      0    1
0  5936   10
1   153  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_12.png
early stop counter: 9
val acc:0.9644076824188232, best validation acc: 0.965154767036438, corresponding to test acc:                         0.9619722962379456 / 0.9748630523681641
after epoch: 12,now: 2024-06-06 09:39:59.911413,epoch time: 0:14:47.743441,used: 2:58:51.748856,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96787214, 'precision': 0.74750376, 'recall': 0.7552875, 'specificity': 0.7552875, 'f1': 0.7513287, 'auroc': 0.95186436, 'binary_precision': 0.5110813, 'binary_recall': 0.5277392, 'binary_specificity': 0.9828358, 'binary_f1_score': 0.5192767}
confusion matrix:
       0    1
0  41686  728
1    681  761
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.7466668, 'recall': 0.7779111, 'specificity': 0.7779111, 'f1': 0.7612419, 'auroc': 0.9465517, 'binary_precision': 0.5091863, 'binary_recall': 0.576523, 'binary_specificity': 0.97929925, 'binary_f1_score': 0.54076654}
confusion matrix:
       0    1
0  17693  374
1    285  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97550756, 'precision': 0.94608927, 'recall': 0.7279211, 'specificity': 0.7279211, 'f1': 0.7988064, 'auroc': 0.9324136, 'binary_precision': 0.9153846, 'binary_recall': 0.4576923, 'binary_specificity': 0.99815, 'binary_f1_score': 0.6102564}
confusion matrix:
      0    1
0  5935   11
1   141  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_13.png
new oracle model saved
early stop counter: 10
val acc:0.9648345708847046, best validation acc: 0.965154767036438, corresponding to test acc:                         0.9619722962379456 / 0.9755075573921204
after epoch: 13,now: 2024-06-06 09:54:45.721568,epoch time: 0:14:45.810155,used: 3:13:37.559011,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9689666, 'precision': 0.7557491, 'recall': 0.7689165, 'specificity': 0.7689165, 'f1': 0.7621496, 'auroc': 0.95248556, 'binary_precision': 0.5266623, 'binary_recall': 0.554785, 'binary_specificity': 0.983048, 'binary_f1_score': 0.54035795}
confusion matrix:
       0    1
0  41695  719
1    642  800
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.7473109, 'recall': 0.79295945, 'specificity': 0.79295945, 'f1': 0.76796234, 'auroc': 0.9481473, 'binary_precision': 0.50934, 'binary_recall': 0.6077266, 'binary_specificity': 0.97819227, 'binary_f1_score': 0.5542005}
confusion matrix:
       0    1
0  17673  394
1    264  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9751853, 'precision': 0.94216084, 'recall': 0.725914, 'specificity': 0.725914, 'f1': 0.79615915, 'auroc': 0.9315351, 'binary_precision': 0.9076923, 'binary_recall': 0.45384616, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.6051282}
confusion matrix:
      0    1
0  5934   12
1   142  118
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_14.png
early stop counter: 11
val acc:0.9648879170417786, best validation acc: 0.965154767036438, corresponding to test acc:                         0.9619722962379456 / 0.9755075573921204
after epoch: 14,now: 2024-06-06 10:09:32.748422,epoch time: 0:14:47.026854,used: 3:28:24.585865,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96946824, 'precision': 0.7594357, 'recall': 0.77487004, 'specificity': 0.77487004, 'f1': 0.76690584, 'auroc': 0.9548764, 'binary_precision': 0.5336381, 'binary_recall': 0.5665742, 'binary_specificity': 0.9831659, 'binary_f1_score': 0.5496132}
confusion matrix:
       0    1
0  41700  714
1    625  817
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.75321496, 'recall': 0.77271485, 'specificity': 0.77271485, 'f1': 0.7625594, 'auroc': 0.94943225, 'binary_precision': 0.522696, 'binary_recall': 0.56463593, 'binary_specificity': 0.9807937, 'binary_f1_score': 0.5428571}
confusion matrix:
       0    1
0  17720  347
1    293  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97582984, 'precision': 0.96001816, 'recall': 0.72441137, 'specificity': 0.72441137, 'f1': 0.798452, 'auroc': 0.9325565, 'binary_precision': 0.9435484, 'binary_recall': 0.45, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.609375}
confusion matrix:
      0    1
0  5939    7
1   143  117
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_15.png
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-06-06 10:24:21.849045,epoch time: 0:14:49.100623,used: 3:43:13.686488,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9692174, 'precision': 0.75705785, 'recall': 0.80086666, 'specificity': 0.80086666, 'f1': 0.7770505, 'auroc': 0.9578255, 'binary_precision': 0.52709067, 'binary_recall': 0.6206657, 'binary_specificity': 0.9810676, 'binary_f1_score': 0.5700637}
confusion matrix:
       0    1
0  41611  803
1    547  895
---- Validation: 
scalar performance:
{'acc': 0.96574175, 'precision': 0.7524854, 'recall': 0.78911066, 'specificity': 0.78911066, 'f1': 0.7694062, 'auroc': 0.9512612, 'binary_precision': 0.52, 'binary_recall': 0.59881127, 'binary_specificity': 0.97941, 'binary_f1_score': 0.55662984}
confusion matrix:
       0    1
0  17695  372
1    270  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9774412, 'precision': 0.956597, 'recall': 0.7473201, 'specificity': 0.7473201, 'f1': 0.81829405, 'auroc': 0.92903435, 'binary_precision': 0.9347826, 'binary_recall': 0.49615383, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.6482412}
confusion matrix:
      0    1
0  5937    9
1   131  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_16.png
new oracle model saved
early stop counter: 1
val acc:0.965741753578186, best validation acc: 0.965848445892334, corresponding to test acc:                         0.9758298397064209 / 0.9774411916732788
after epoch: 16,now: 2024-06-06 10:39:10.113439,epoch time: 0:14:48.264394,used: 3:58:01.950882,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96962786, 'precision': 0.7601925, 'recall': 0.7893555, 'specificity': 0.7893555, 'f1': 0.77391565, 'auroc': 0.9603833, 'binary_precision': 0.5341615, 'binary_recall': 0.5963939, 'binary_specificity': 0.98231715, 'binary_f1_score': 0.56356484}
confusion matrix:
       0    1
0  41664  750
1    582  860
---- Validation: 
scalar performance:
{'acc': 0.96616864, 'precision': 0.7551569, 'recall': 0.7950542, 'specificity': 0.7950542, 'f1': 0.77348053, 'auroc': 0.9537412, 'binary_precision': 0.5249042, 'binary_recall': 0.61069834, 'binary_specificity': 0.97941, 'binary_f1_score': 0.5645605}
confusion matrix:
       0    1
0  17695  372
1    262  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9756687, 'precision': 0.9562421, 'recall': 0.72432727, 'specificity': 0.72432727, 'f1': 0.79761857, 'auroc': 0.93212503, 'binary_precision': 0.936, 'binary_recall': 0.45, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.6077922}
confusion matrix:
      0    1
0  5938    8
1   143  117
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_17.png
better model found
persisted
after epoch: 17,now: 2024-06-06 10:53:58.967979,epoch time: 0:14:48.854540,used: 4:12:50.805422,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9695595, 'precision': 0.7593379, 'recall': 0.804393, 'specificity': 0.804393, 'f1': 0.77986515, 'auroc': 0.95754266, 'binary_precision': 0.53141516, 'binary_recall': 0.62760055, 'binary_specificity': 0.98118544, 'binary_f1_score': 0.5755167}
confusion matrix:
       0    1
0  41616  798
1    537  905
---- Validation: 
scalar performance:
{'acc': 0.9660619, 'precision': 0.7544627, 'recall': 0.803582, 'specificity': 0.803582, 'f1': 0.77659124, 'auroc': 0.9532534, 'binary_precision': 0.52286774, 'binary_recall': 0.62852895, 'binary_specificity': 0.9786351, 'binary_f1_score': 0.57085013}
confusion matrix:
       0    1
0  17681  386
1    250  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97502416, 'precision': 0.9386944, 'recall': 0.7258299, 'specificity': 0.7258299, 'f1': 0.79534316, 'auroc': 0.93922484, 'binary_precision': 0.90076333, 'binary_recall': 0.45384616, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.60358053}
confusion matrix:
      0    1
0  5933   13
1   142  118
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_18.png
early stop counter: 1
val acc:0.9660618901252747, best validation acc: 0.9661686420440674, corresponding to test acc:                         0.975668728351593 / 0.9774411916732788
after epoch: 18,now: 2024-06-06 11:08:52.298771,epoch time: 0:14:53.330792,used: 4:27:44.136214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9696507, 'precision': 0.760003, 'recall': 0.80276537, 'specificity': 0.80276537, 'f1': 0.7795799, 'auroc': 0.9592669, 'binary_precision': 0.5328597, 'binary_recall': 0.62413317, 'binary_specificity': 0.9813976, 'binary_f1_score': 0.5748962}
confusion matrix:
       0    1
0  41625  789
1    542  900
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.75873744, 'recall': 0.8039418, 'specificity': 0.8039418, 'f1': 0.7793009, 'auroc': 0.95570433, 'binary_precision': 0.53140706, 'binary_recall': 0.62852895, 'binary_specificity': 0.9793546, 'binary_f1_score': 0.57590204}
confusion matrix:
       0    1
0  17694  373
1    250  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97599095, 'precision': 0.97128266, 'recall': 0.7208175, 'specificity': 0.7208175, 'f1': 0.7972388, 'auroc': 0.93746865, 'binary_precision': 0.96638656, 'binary_recall': 0.44230768, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.60686016}
confusion matrix:
      0    1
0  5942    4
1   145  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_19.png
better model found
persisted
after epoch: 19,now: 2024-06-06 11:23:46.892724,epoch time: 0:14:54.593953,used: 4:42:38.730167,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9690578, 'precision': 0.7558414, 'recall': 0.8238958, 'specificity': 0.8238958, 'f1': 0.78541857, 'auroc': 0.9606466, 'binary_precision': 0.5230602, 'binary_recall': 0.6685159, 'binary_specificity': 0.9792757, 'binary_f1_score': 0.5869102}
confusion matrix:
       0    1
0  41535  879
1    478  964
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.75909835, 'recall': 0.82330936, 'specificity': 0.82330936, 'f1': 0.78722316, 'auroc': 0.9558091, 'binary_precision': 0.5306604, 'binary_recall': 0.6686478, 'binary_specificity': 0.9779709, 'binary_f1_score': 0.59171605}
confusion matrix:
       0    1
0  17669  398
1    223  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9771189, 'precision': 0.93375516, 'recall': 0.75818586, 'specificity': 0.75818586, 'f1': 0.82175326, 'auroc': 0.93459225, 'binary_precision': 0.8881579, 'binary_recall': 0.5192308, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.65533984}
confusion matrix:
      0    1
0  5929   17
1   125  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_20.png
better model found
persisted
after epoch: 20,now: 2024-06-06 11:40:42.705334,epoch time: 0:16:55.812610,used: 4:59:34.542777,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9697875, 'precision': 0.7606426, 'recall': 0.81556433, 'specificity': 0.81556433, 'f1': 0.7851942, 'auroc': 0.96317333, 'binary_precision': 0.53325754, 'binary_recall': 0.65048546, 'binary_specificity': 0.9806432, 'binary_f1_score': 0.58606684}
confusion matrix:
       0    1
0  41593  821
1    504  938
---- Validation: 
scalar performance:
{'acc': 0.9672892, 'precision': 0.7619384, 'recall': 0.81065595, 'specificity': 0.81065595, 'f1': 0.78397155, 'auroc': 0.95508933, 'binary_precision': 0.53731346, 'binary_recall': 0.6419019, 'binary_specificity': 0.97941, 'binary_f1_score': 0.5849695}
confusion matrix:
       0    1
0  17695  372
1    241  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9777635, 'precision': 0.95423466, 'recall': 0.75300527, 'specificity': 0.75300527, 'f1': 0.822613, 'auroc': 0.94380337, 'binary_precision': 0.92957747, 'binary_recall': 0.50769234, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.65671647}
confusion matrix:
      0    1
0  5936   10
1   128  132
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_21.png
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-06-06 11:56:23.338460,epoch time: 0:15:40.633126,used: 5:15:15.175903,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9703803, 'precision': 0.76465875, 'recall': 0.8155359, 'specificity': 0.8155359, 'f1': 0.7876213, 'auroc': 0.96215004, 'binary_precision': 0.5413056, 'binary_recall': 0.64979196, 'binary_specificity': 0.9812798, 'binary_f1_score': 0.5906083}
confusion matrix:
       0    1
0  41620  794
1    505  937
---- Validation: 
scalar performance:
{'acc': 0.9680363, 'precision': 0.76697206, 'recall': 0.8053212, 'specificity': 0.8053212, 'f1': 0.78470826, 'auroc': 0.9570245, 'binary_precision': 0.54780364, 'binary_recall': 0.63001484, 'binary_specificity': 0.98062766, 'binary_f1_score': 0.5860401}
confusion matrix:
       0    1
0  17717  350
1    249  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97599095, 'precision': 0.97519064, 'recall': 0.7189785, 'specificity': 0.7189785, 'f1': 0.796197, 'auroc': 0.9294646, 'binary_precision': 0.974359, 'binary_recall': 0.43846154, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.60477453}
confusion matrix:
      0    1
0  5943    3
1   146  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_22.png
better model found
persisted
after epoch: 22,now: 2024-06-06 12:11:25.301482,epoch time: 0:15:01.963022,used: 5:30:17.138925,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9724325, 'precision': 0.7818996, 'recall': 0.794155, 'specificity': 0.794155, 'f1': 0.7878836, 'auroc': 0.963557, 'binary_precision': 0.5773059, 'binary_recall': 0.6033287, 'binary_specificity': 0.98498136, 'binary_f1_score': 0.5900305}
confusion matrix:
       0    1
0  41777  637
1    572  870
---- Validation: 
scalar performance:
{'acc': 0.96979725, 'precision': 0.7802229, 'recall': 0.7962208, 'specificity': 0.7962208, 'f1': 0.78797466, 'auroc': 0.9584048, 'binary_precision': 0.57503504, 'binary_recall': 0.60921246, 'binary_specificity': 0.9832291, 'binary_f1_score': 0.5916306}
confusion matrix:
       0    1
0  17764  303
1    263  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.973574, 'precision': 0.96765876, 'recall': 0.69197136, 'specificity': 0.69197136, 'f1': 0.7679192, 'auroc': 0.93853706, 'binary_precision': 0.96153843, 'binary_recall': 0.3846154, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.5494505}
confusion matrix:
      0    1
0  5942    4
1   160  100
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_23.png
better model found
persisted
after epoch: 23,now: 2024-06-06 12:26:27.192146,epoch time: 0:15:01.890664,used: 5:45:19.029589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97197646, 'precision': 0.77637804, 'recall': 0.81267655, 'specificity': 0.81267655, 'f1': 0.7932908, 'auroc': 0.96465826, 'binary_precision': 0.56497866, 'binary_recall': 0.64216363, 'binary_specificity': 0.9831895, 'binary_f1_score': 0.6011035}
confusion matrix:
       0    1
0  41701  713
1    516  926
---- Validation: 
scalar performance:
{'acc': 0.9686766, 'precision': 0.7711052, 'recall': 0.8085144, 'specificity': 0.8085144, 'f1': 0.7884599, 'auroc': 0.9584402, 'binary_precision': 0.5558441, 'binary_recall': 0.6359584, 'binary_specificity': 0.98107046, 'binary_f1_score': 0.59320855}
confusion matrix:
       0    1
0  17725  342
1    245  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97582984, 'precision': 0.9635755, 'recall': 0.7225724, 'specificity': 0.7225724, 'f1': 0.7974305, 'auroc': 0.93716896, 'binary_precision': 0.9508197, 'binary_recall': 0.44615385, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.60732985}
confusion matrix:
      0    1
0  5940    6
1   144  116
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_24.png
early stop counter: 1
val acc:0.9686766266822815, best validation acc: 0.9697972536087036, corresponding to test acc:                         0.9735739827156067 / 0.9777634739875793
after epoch: 24,now: 2024-06-06 12:41:09.155822,epoch time: 0:14:41.963676,used: 6:00:00.993265,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.97179407, 'precision': 0.77409506, 'recall': 0.8249755, 'specificity': 0.8249755, 'f1': 0.7971425, 'auroc': 0.96446055, 'binary_precision': 0.5595584, 'binary_recall': 0.6678225, 'binary_specificity': 0.98212856, 'binary_f1_score': 0.60891557}
confusion matrix:
       0    1
0  41656  758
1    479  963
---- Validation: 
scalar performance:
{'acc': 0.9693703, 'precision': 0.77643603, 'recall': 0.80243677, 'specificity': 0.80243677, 'f1': 0.788785, 'auroc': 0.9586395, 'binary_precision': 0.5669824, 'binary_recall': 0.6225854, 'binary_specificity': 0.9822881, 'binary_f1_score': 0.5934844}
confusion matrix:
       0    1
0  17747  320
1    254  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97599095, 'precision': 0.97128266, 'recall': 0.7208175, 'specificity': 0.7208175, 'f1': 0.7972388, 'auroc': 0.9338563, 'binary_precision': 0.96638656, 'binary_recall': 0.44230768, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.60686016}
confusion matrix:
      0    1
0  5942    4
1   145  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_25.png
early stop counter: 2
val acc:0.9693703055381775, best validation acc: 0.9697972536087036, corresponding to test acc:                         0.9735739827156067 / 0.9777634739875793
after epoch: 25,now: 2024-06-06 12:55:49.264537,epoch time: 0:14:40.108715,used: 6:14:41.101980,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9719537, 'precision': 0.775905, 'recall': 0.81634927, 'specificity': 0.81634927, 'f1': 0.7945998, 'auroc': 0.9668428, 'binary_precision': 0.5637786, 'binary_recall': 0.64979196, 'binary_specificity': 0.9829066, 'binary_f1_score': 0.6037371}
confusion matrix:
       0    1
0  41689  725
1    505  937
---- Validation: 
scalar performance:
{'acc': 0.9698506, 'precision': 0.7791498, 'recall': 0.8105538, 'specificity': 0.8105538, 'f1': 0.7939191, 'auroc': 0.9597785, 'binary_precision': 0.5718085, 'binary_recall': 0.63893014, 'binary_specificity': 0.98217744, 'binary_f1_score': 0.6035088}
confusion matrix:
       0    1
0  17745  322
1    243  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9747019, 'precision': 0.95414734, 'recall': 0.7127888, 'specificity': 0.7127888, 'f1': 0.7863523, 'auroc': 0.9358017, 'binary_precision': 0.9327731, 'binary_recall': 0.42692307, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.585752}
confusion matrix:
      0    1
0  5938    8
1   149  111
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_26.png
better model found
persisted
after epoch: 26,now: 2024-06-06 13:10:15.029075,epoch time: 0:14:25.764538,used: 6:29:06.866518,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.971224, 'precision': 0.76996195, 'recall': 0.8270255, 'specificity': 0.8270255, 'f1': 0.79546905, 'auroc': 0.96791494, 'binary_precision': 0.5511364, 'binary_recall': 0.67267686, 'binary_specificity': 0.9813741, 'binary_f1_score': 0.6058713}
confusion matrix:
       0    1
0  41624  790
1    472  970
---- Validation: 
scalar performance:
{'acc': 0.9709178, 'precision': 0.7869688, 'recall': 0.8111073, 'specificity': 0.8111073, 'f1': 0.7984961, 'auroc': 0.9600782, 'binary_precision': 0.58743167, 'binary_recall': 0.63893014, 'binary_specificity': 0.9832844, 'binary_f1_score': 0.61209965}
confusion matrix:
       0    1
0  17765  302
1    243  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97550756, 'precision': 0.9264475, 'recall': 0.74079406, 'specificity': 0.74079406, 'f1': 0.8055521, 'auroc': 0.9387293, 'binary_precision': 0.875, 'binary_recall': 0.4846154, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.6237624}
confusion matrix:
      0    1
0  5928   18
1   134  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_27.png
better model found
persisted
after epoch: 27,now: 2024-06-06 13:24:56.303548,epoch time: 0:14:41.274473,used: 6:43:48.140991,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9711328, 'precision': 0.76840746, 'recall': 0.8480803, 'specificity': 0.8480803, 'f1': 0.8025222, 'auroc': 0.9690355, 'binary_precision': 0.5465608, 'binary_recall': 0.7163662, 'binary_specificity': 0.9797944, 'binary_f1_score': 0.620048}
confusion matrix:
       0     1
0  41557   857
1    409  1033
---- Validation: 
scalar performance:
{'acc': 0.97097117, 'precision': 0.7844647, 'recall': 0.83616936, 'specificity': 0.83616936, 'f1': 0.8079138, 'auroc': 0.96112573, 'binary_precision': 0.5805243, 'binary_recall': 0.6909361, 'binary_specificity': 0.9814026, 'binary_f1_score': 0.6309362}
confusion matrix:
       0    1
0  17731  336
1    208  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9769578, 'precision': 0.94108236, 'recall': 0.75074583, 'specificity': 0.75074583, 'f1': 0.8175019, 'auroc': 0.9481827, 'binary_precision': 0.9034483, 'binary_recall': 0.50384617, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.6469135}
confusion matrix:
      0    1
0  5932   14
1   129  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_28.png
better model found
persisted
after epoch: 28,now: 2024-06-06 13:39:39.894529,epoch time: 0:14:43.590981,used: 6:58:31.731972,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9725921, 'precision': 0.78139424, 'recall': 0.81031525, 'specificity': 0.81031525, 'f1': 0.79507464, 'auroc': 0.9676903, 'binary_precision': 0.575188, 'binary_recall': 0.6366158, 'binary_specificity': 0.9840147, 'binary_f1_score': 0.60434496}
confusion matrix:
       0    1
0  41736  678
1    524  918
---- Validation: 
scalar performance:
{'acc': 0.96979725, 'precision': 0.7795417, 'recall': 0.8026582, 'specificity': 0.8026582, 'f1': 0.7905885, 'auroc': 0.9603866, 'binary_precision': 0.5731874, 'binary_recall': 0.6225854, 'binary_specificity': 0.9827309, 'binary_f1_score': 0.5968661}
confusion matrix:
       0    1
0  17755  312
1    254  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9738962, 'precision': 0.95993197, 'recall': 0.69949543, 'specificity': 0.69949543, 'f1': 0.7743546, 'auroc': 0.94575006, 'binary_precision': 0.94545454, 'binary_recall': 0.4, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.56216216}
confusion matrix:
      0    1
0  5940    6
1   156  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_29.png
early stop counter: 1
val acc:0.9697972536087036, best validation acc: 0.9709711670875549, corresponding to test acc:                         0.9769577980041504 / 0.9777634739875793
after epoch: 29,now: 2024-06-06 13:54:28.383649,epoch time: 0:14:48.489120,used: 7:13:20.221092,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.97286576, 'precision': 0.7792753, 'recall': 0.85668015, 'specificity': 0.85668015, 'f1': 0.81275725, 'auroc': 0.9699819, 'binary_precision': 0.56774193, 'binary_recall': 0.73231626, 'binary_specificity': 0.981044, 'binary_f1_score': 0.63961244}
confusion matrix:
       0     1
0  41610   804
1    386  1056
---- Validation: 
scalar performance:
{'acc': 0.97113127, 'precision': 0.78525543, 'recall': 0.8391134, 'specificity': 0.8391134, 'f1': 0.8095925, 'auroc': 0.9627855, 'binary_precision': 0.5818859, 'binary_recall': 0.6968796, 'binary_specificity': 0.9813472, 'binary_f1_score': 0.6342123}
confusion matrix:
       0    1
0  17730  337
1    204  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9793748, 'precision': 0.94935346, 'recall': 0.777753, 'specificity': 0.777753, 'f1': 0.8415539, 'auroc': 0.95328563, 'binary_precision': 0.9177215, 'binary_recall': 0.5576923, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.6937799}
confusion matrix:
      0    1
0  5933   13
1   115  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_30.png
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-06-06 14:09:34.842421,epoch time: 0:15:06.458772,used: 7:28:26.679864,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_06_41_08_seed_1_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:28:26.679864 at 2024-06-06 14:09:34.842421
persisted model performance metric: 

scalar performance:
{'acc': 0.9780857, 'precision': 0.94130206, 'recall': 0.76604635, 'specificity': 0.76604635, 'f1': 0.83008116, 'auroc': 0.9463868, 'binary_precision': 0.9025974, 'binary_recall': 0.5346154, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.6714976}
confusion matrix:
      0    1
0  5931   15
1   121  139
oracle model performance metric: 

scalar performance:
{'acc': 0.97873026, 'precision': 0.94537616, 'recall': 0.7718997, 'specificity': 0.7718997, 'f1': 0.83584434, 'auroc': 0.9407263, 'binary_precision': 0.9102564, 'binary_recall': 0.54615384, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.68269235}
confusion matrix:
      0    1
0  5932   14
1   118  142
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 534095 KiB |   1857 MiB |   2280 TiB |   2280 TiB |
|       from large pool | 444288 KiB |   1786 MiB |   2274 TiB |   2274 TiB |
|       from small pool |  89807 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 534095 KiB |   1857 MiB |   2280 TiB |   2280 TiB |
|       from large pool | 444288 KiB |   1786 MiB |   2274 TiB |   2274 TiB |
|       from small pool |  89807 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 525466 KiB |   1842 MiB |   2267 TiB |   2267 TiB |
|       from large pool | 436736 KiB |   1772 MiB |   2261 TiB |   2261 TiB |
|       from small pool |  88730 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2018 MiB |   2048 MiB |   2900 MiB |    882 MiB |
|       from large pool |   1894 MiB |   1922 MiB |   2744 MiB |    850 MiB |
|       from small pool |    124 MiB |    126 MiB |    156 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    772 MiB |    928 MiB |   1273 TiB |   1273 TiB |
|       from large pool |    766 MiB |    926 MiB |   1266 TiB |   1266 TiB |
|       from small pool |      6 MiB |     28 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3705    |    6708    |  256153 K  |  256149 K  |
|       from large pool |      87    |     178    |  110020 K  |  110020 K  |
|       from small pool |    3618    |    6620    |  146133 K  |  146129 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3705    |    6708    |  256153 K  |  256149 K  |
|       from large pool |      87    |     178    |  110020 K  |  110020 K  |
|       from small pool |    3618    |    6620    |  146133 K  |  146129 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      89    |      96    |     118    |      29    |
|       from large pool |      27    |      33    |      40    |      13    |
|       from small pool |      62    |      63    |      78    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      54    |    2770    |  111567 K  |  111567 K  |
|       from large pool |      20    |      23    |   43907 K  |   43907 K  |
|       from small pool |      34    |    2750    |   67660 K  |   67660 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   1857 MiB |   2280 TiB |   2280 TiB |
|       from large pool |  65536 KiB |   1786 MiB |   2274 TiB |   2274 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   1857 MiB |   2280 TiB |   2280 TiB |
|       from large pool |  65536 KiB |   1786 MiB |   2274 TiB |   2274 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   1842 MiB |   2267 TiB |   2267 TiB |
|       from large pool |  65536 KiB |   1772 MiB |   2261 TiB |   2261 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1294 MiB |   2048 MiB |   2900 MiB |   1606 MiB |
|       from large pool |   1200 MiB |   1922 MiB |   2744 MiB |   1544 MiB |
|       from small pool |     94 MiB |    126 MiB |    156 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |    928 MiB |   1273 TiB |   1273 TiB |
|       from large pool | 116736 KiB |    926 MiB |   1266 TiB |   1266 TiB |
|       from small pool |      0 KiB |     30 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6708    |  256153 K  |  256153 K  |
|       from large pool |       2    |     178    |  110020 K  |  110020 K  |
|       from small pool |       0    |    6620    |  146133 K  |  146133 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6708    |  256153 K  |  256153 K  |
|       from large pool |       2    |     178    |  110020 K  |  110020 K  |
|       from small pool |       0    |    6620    |  146133 K  |  146133 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |      96    |     118    |      50    |
|       from large pool |      21    |      33    |      40    |      19    |
|       from small pool |      47    |      63    |      78    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2770    |  111569 K  |  111569 K  |
|       from large pool |       3    |      25    |   43907 K  |   43907 K  |
|       from small pool |       0    |    2750    |   67661 K  |   67661 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   1857 MiB |   2280 TiB |   2280 TiB |
|       from large pool |  65536 KiB |   1786 MiB |   2274 TiB |   2274 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   1857 MiB |   2280 TiB |   2280 TiB |
|       from large pool |  65536 KiB |   1786 MiB |   2274 TiB |   2274 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   1842 MiB |   2267 TiB |   2267 TiB |
|       from large pool |  65536 KiB |   1772 MiB |   2261 TiB |   2261 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1294 MiB |   2048 MiB |   2900 MiB |   1606 MiB |
|       from large pool |   1200 MiB |   1922 MiB |   2744 MiB |   1544 MiB |
|       from small pool |     94 MiB |    126 MiB |    156 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |    928 MiB |   1273 TiB |   1273 TiB |
|       from large pool | 116736 KiB |    926 MiB |   1266 TiB |   1266 TiB |
|       from small pool |      0 KiB |     30 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6708    |  256153 K  |  256153 K  |
|       from large pool |       2    |     178    |  110020 K  |  110020 K  |
|       from small pool |       0    |    6620    |  146133 K  |  146133 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6708    |  256153 K  |  256153 K  |
|       from large pool |       2    |     178    |  110020 K  |  110020 K  |
|       from small pool |       0    |    6620    |  146133 K  |  146133 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |      96    |     118    |      50    |
|       from large pool |      21    |      33    |      40    |      19    |
|       from small pool |      47    |      63    |      78    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2770    |  111569 K  |  111569 K  |
|       from large pool |       3    |      25    |   43907 K  |   43907 K  |
|       from small pool |       0    |    2750    |   67661 K  |   67661 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984

 Experiment start at: 2024-06-06 14:16:50.959207
before training, model accuracy: 0.04888604208827019
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96547556, 'precision': 0.732759, 'recall': 0.5006373, 'specificity': 0.5006373, 'f1': 0.49253526, 'auroc': 0.835052, 'binary_precision': 0.5, 'binary_recall': 0.0013218771, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.0026367833}
confusion matrix:
       0  1
0  42309  2
1   1511  2
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.48396632, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49185252, 'auroc': 0.83614755, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18171  0
1    602  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.79621786, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-06 14:32:48.204400,epoch time: 0:15:57.245193,used: 0:15:57.245193,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9654071, 'precision': 0.7155074, 'recall': 0.5063376, 'specificity': 0.5063376, 'f1': 0.5040489, 'auroc': 0.8975587, 'binary_precision': 0.4651163, 'binary_recall': 0.013218771, 'binary_specificity': 0.9994564, 'binary_f1_score': 0.025706941}
confusion matrix:
       0   1
0  42288  23
1   1493  20
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73411596, 'recall': 0.50481826, 'specificity': 0.50481826, 'f1': 0.5016219, 'auroc': 0.9001558, 'binary_precision': 0.5, 'binary_recall': 0.009966778, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.019543974}
confusion matrix:
       0  1
0  18165  6
1    596  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.9806829, 'recall': 0.50206614, 'specificity': 0.50206614, 'f1': 0.49426642, 'auroc': 0.8607381, 'binary_precision': 1.0, 'binary_recall': 0.004132231, 'binary_specificity': 1.0, 'binary_f1_score': 0.008230452}
confusion matrix:
      0  1
0  5997  0
1   241  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_2.png
new oracle model saved
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9679326415061951, corresponding to test acc:                         0.9612117409706116 / 0.9613720178604126
after epoch: 2,now: 2024-06-06 14:47:52.363126,epoch time: 0:15:04.158726,used: 0:31:01.403919,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9663198, 'precision': 0.7652908, 'recall': 0.5542894, 'specificity': 0.5542894, 'f1': 0.58456624, 'auroc': 0.91150093, 'binary_precision': 0.5614618, 'binary_recall': 0.11169861, 'binary_specificity': 0.99688023, 'binary_f1_score': 0.18632855}
confusion matrix:
       0    1
0  42179  132
1   1344  169
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.80267, 'recall': 0.54806775, 'specificity': 0.54806775, 'f1': 0.57706326, 'auroc': 0.91349095, 'binary_precision': 0.6344086, 'binary_recall': 0.09800664, 'binary_specificity': 0.9981289, 'binary_f1_score': 0.16978417}
confusion matrix:
       0   1
0  18137  34
1    543  59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.98076, 'recall': 0.5041322, 'specificity': 0.5041322, 'f1': 0.498388, 'auroc': 0.8845731, 'binary_precision': 1.0, 'binary_recall': 0.008264462, 'binary_specificity': 1.0, 'binary_f1_score': 0.016393442}
confusion matrix:
      0  1
0  5997  0
1   240  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-06 15:02:58.910605,epoch time: 0:15:06.547479,used: 0:46:07.951398,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9658178, 'precision': 0.7432918, 'recall': 0.57792836, 'specificity': 0.57792836, 'f1': 0.6141164, 'auroc': 0.9230355, 'binary_precision': 0.51585627, 'binary_recall': 0.16126901, 'binary_specificity': 0.9945877, 'binary_f1_score': 0.24572004}
confusion matrix:
       0    1
0  42082  229
1   1269  244
---- Validation: 
scalar performance:
{'acc': 0.9692111, 'precision': 0.7645614, 'recall': 0.5978292, 'specificity': 0.5978292, 'f1': 0.6396919, 'auroc': 0.9198177, 'binary_precision': 0.55504584, 'binary_recall': 0.20099668, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.29512194}
confusion matrix:
       0    1
0  18074   97
1    481  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.9149368, 'recall': 0.52669275, 'specificity': 0.52669275, 'f1': 0.5411327, 'auroc': 0.88934463, 'binary_precision': 0.8666667, 'binary_recall': 0.053719006, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.101167314}
confusion matrix:
      0   1
0  5995   2
1   229  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_4.png
new oracle model saved
early stop counter: 1
val acc:0.9692111015319824, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9615322947502136 / 0.9629748463630676
after epoch: 4,now: 2024-06-06 15:18:03.519984,epoch time: 0:15:04.609379,used: 1:01:12.560777,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9654983, 'precision': 0.7387003, 'recall': 0.66762275, 'specificity': 0.66762275, 'f1': 0.69626284, 'auroc': 0.9316074, 'binary_precision': 0.50047576, 'binary_recall': 0.34765366, 'binary_specificity': 0.98759186, 'binary_f1_score': 0.41029644}
confusion matrix:
       0    1
0  41786  525
1    987  526
---- Validation: 
scalar performance:
{'acc': 0.9671869, 'precision': 0.7338133, 'recall': 0.7043921, 'specificity': 0.7043921, 'f1': 0.7180085, 'auroc': 0.9311239, 'binary_precision': 0.48664123, 'binary_recall': 0.42358804, 'binary_specificity': 0.9851962, 'binary_f1_score': 0.45293075}
confusion matrix:
       0    1
0  17902  269
1    347  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.968745, 'precision': 0.9274077, 'recall': 0.61098665, 'specificity': 0.61098665, 'f1': 0.67020965, 'auroc': 0.9096771, 'binary_precision': 0.8852459, 'binary_recall': 0.2231405, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.35643563}
confusion matrix:
      0   1
0  5990   7
1   188  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_5.png
new oracle model saved
early stop counter: 2
val acc:0.9671869277954102, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9615322947502136 / 0.9687449932098389
after epoch: 5,now: 2024-06-06 15:33:06.962001,epoch time: 0:15:03.442017,used: 1:16:16.002794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9658863, 'precision': 0.7429043, 'recall': 0.67642725, 'specificity': 0.67642725, 'f1': 0.7038213, 'auroc': 0.9372499, 'binary_precision': 0.50827205, 'binary_recall': 0.36549902, 'binary_specificity': 0.98735553, 'binary_f1_score': 0.4252211}
confusion matrix:
       0    1
0  41776  535
1    960  553
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.7526433, 'recall': 0.6949706, 'specificity': 0.6949706, 'f1': 0.7197224, 'auroc': 0.92953986, 'binary_precision': 0.5249458, 'binary_recall': 0.40199336, 'binary_specificity': 0.9879478, 'binary_f1_score': 0.45531517}
confusion matrix:
       0    1
0  17952  219
1    360  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97195065, 'precision': 0.93824327, 'recall': 0.6542917, 'specificity': 0.6542917, 'f1': 0.72356933, 'auroc': 0.9073111, 'binary_precision': 0.90361446, 'binary_recall': 0.30991736, 'binary_specificity': 0.998666, 'binary_f1_score': 0.46153846}
confusion matrix:
      0   1
0  5989   8
1   167  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_6.png
new oracle model saved
early stop counter: 3
val acc:0.9691578149795532, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9615322947502136 / 0.9719506502151489
after epoch: 6,now: 2024-06-06 15:47:50.714430,epoch time: 0:14:43.752429,used: 1:30:59.755223,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9662514, 'precision': 0.74665916, 'recall': 0.68075883, 'specificity': 0.68075883, 'f1': 0.708079, 'auroc': 0.9426564, 'binary_precision': 0.5154827, 'binary_recall': 0.3740912, 'binary_specificity': 0.98742646, 'binary_f1_score': 0.43355036}
confusion matrix:
       0    1
0  41779  532
1    947  566
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.7415085, 'recall': 0.7216689, 'specificity': 0.7216689, 'f1': 0.73111844, 'auroc': 0.9343046, 'binary_precision': 0.5009074, 'binary_recall': 0.45847178, 'binary_specificity': 0.984866, 'binary_f1_score': 0.4787511}
confusion matrix:
       0    1
0  17896  275
1    326  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97275203, 'precision': 0.9460567, 'recall': 0.6626395, 'specificity': 0.6626395, 'f1': 0.7338578, 'auroc': 0.91046345, 'binary_precision': 0.9186047, 'binary_recall': 0.3264463, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.48170733}
confusion matrix:
      0   1
0  5990   7
1   163  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_7.png
new oracle model saved
early stop counter: 4
val acc:0.9679859280586243, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9615322947502136 / 0.972752034664154
after epoch: 7,now: 2024-06-06 16:02:39.764524,epoch time: 0:14:49.050094,used: 1:45:48.805317,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9670272, 'precision': 0.75274813, 'recall': 0.74839616, 'specificity': 0.74839616, 'f1': 0.7505511, 'auroc': 0.94346774, 'binary_precision': 0.5228802, 'binary_recall': 0.51354927, 'binary_specificity': 0.9832431, 'binary_f1_score': 0.51817274}
confusion matrix:
       0    1
0  41602  709
1    736  777
---- Validation: 
scalar performance:
{'acc': 0.9670271, 'precision': 0.7367438, 'recall': 0.7741748, 'specificity': 0.7741748, 'f1': 0.75393164, 'auroc': 0.9398738, 'binary_precision': 0.48787448, 'binary_recall': 0.5681063, 'binary_specificity': 0.98024327, 'binary_f1_score': 0.5249424}
confusion matrix:
       0    1
0  17812  359
1    260  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97611797, 'precision': 0.9280695, 'recall': 0.72188985, 'specificity': 0.72188985, 'f1': 0.78973997, 'auroc': 0.9190596, 'binary_precision': 0.8780488, 'binary_recall': 0.446281, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.5917808}
confusion matrix:
      0    1
0  5982   15
1   134  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_8.png
new oracle model saved
early stop counter: 5
val acc:0.9670271277427673, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9615322947502136 / 0.9761179685592651
after epoch: 8,now: 2024-06-06 16:17:31.541582,epoch time: 0:14:51.777058,used: 2:00:40.582375,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96611446, 'precision': 0.74615824, 'recall': 0.7629001, 'specificity': 0.7629001, 'f1': 0.7542213, 'auroc': 0.9449804, 'binary_precision': 0.50864196, 'binary_recall': 0.54461336, 'binary_specificity': 0.9811869, 'binary_f1_score': 0.52601343}
confusion matrix:
       0    1
0  41515  796
1    689  824
---- Validation: 
scalar performance:
{'acc': 0.9675065, 'precision': 0.73974335, 'recall': 0.7704072, 'specificity': 0.7704072, 'f1': 0.7540501, 'auroc': 0.94130516, 'binary_precision': 0.4941349, 'binary_recall': 0.5598007, 'binary_specificity': 0.9810137, 'binary_f1_score': 0.52492213}
confusion matrix:
       0    1
0  17826  345
1    265  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9777208, 'precision': 0.9334551, 'recall': 0.742551, 'specificity': 0.742551, 'f1': 0.8089243, 'auroc': 0.9313267, 'binary_precision': 0.88721806, 'binary_recall': 0.4876033, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.6293333}
confusion matrix:
      0    1
0  5982   15
1   124  118
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_9.png
new oracle model saved
early stop counter: 6
val acc:0.9675065279006958, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9615322947502136 / 0.9777207970619202
after epoch: 9,now: 2024-06-06 16:32:22.628964,epoch time: 0:14:51.087382,used: 2:15:31.669757,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9666621, 'precision': 0.7499648, 'recall': 0.743746, 'specificity': 0.743746, 'f1': 0.74681175, 'auroc': 0.94913405, 'binary_precision': 0.5176391, 'binary_recall': 0.5042961, 'binary_specificity': 0.98319584, 'binary_f1_score': 0.51088053}
confusion matrix:
       0    1
0  41600  711
1    750  763
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.74156094, 'recall': 0.7601327, 'specificity': 0.7601327, 'f1': 0.75046504, 'auroc': 0.94305813, 'binary_precision': 0.49846154, 'binary_recall': 0.538206, 'binary_specificity': 0.9820593, 'binary_f1_score': 0.51757187}
confusion matrix:
       0    1
0  17845  326
1    278  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97563714, 'precision': 0.9466713, 'recall': 0.7037951, 'specificity': 0.7037951, 'f1': 0.77659065, 'auroc': 0.933788, 'binary_precision': 0.9166667, 'binary_recall': 0.4090909, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.56571424}
confusion matrix:
      0   1
0  5988   9
1   143  99
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_10.png
early stop counter: 7
val acc:0.9678261280059814, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9615322947502136 / 0.9777207970619202
after epoch: 10,now: 2024-06-06 16:47:25.463149,epoch time: 0:15:02.834185,used: 2:30:34.503942,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9672326, 'precision': 0.7541767, 'recall': 0.7580621, 'specificity': 0.7580621, 'f1': 0.75610304, 'auroc': 0.9507418, 'binary_precision': 0.5250488, 'binary_recall': 0.5333774, 'binary_specificity': 0.9827468, 'binary_f1_score': 0.5291804}
confusion matrix:
       0    1
0  41581  730
1    706  807
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.7409328, 'recall': 0.7728989, 'specificity': 0.7728989, 'f1': 0.75580996, 'auroc': 0.94621086, 'binary_precision': 0.49635038, 'binary_recall': 0.56478405, 'binary_specificity': 0.9810137, 'binary_f1_score': 0.52836055}
confusion matrix:
       0    1
0  17826  345
1    262  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97563714, 'precision': 0.9466713, 'recall': 0.7037951, 'specificity': 0.7037951, 'f1': 0.77659065, 'auroc': 0.924059, 'binary_precision': 0.9166667, 'binary_recall': 0.4090909, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.56571424}
confusion matrix:
      0   1
0  5988   9
1   143  99
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_11.png
early stop counter: 8
val acc:0.9676663279533386, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9615322947502136 / 0.9777207970619202
after epoch: 11,now: 2024-06-06 17:02:28.693857,epoch time: 0:15:03.230708,used: 2:45:37.734650,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9676661, 'precision': 0.7566947, 'recall': 0.7958876, 'specificity': 0.7958876, 'f1': 0.77473795, 'auroc': 0.9554342, 'binary_precision': 0.52736604, 'binary_recall': 0.6113681, 'binary_specificity': 0.980407, 'binary_f1_score': 0.5662688}
confusion matrix:
       0    1
0  41482  829
1    588  925
---- Validation: 
scalar performance:
{'acc': 0.9683055, 'precision': 0.74606025, 'recall': 0.8013358, 'specificity': 0.8013358, 'f1': 0.77059245, 'auroc': 0.9454807, 'binary_precision': 0.5047106, 'binary_recall': 0.6229236, 'binary_specificity': 0.97974795, 'binary_f1_score': 0.5576208}
confusion matrix:
       0    1
0  17803  368
1    227  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9783619, 'precision': 0.9274665, 'recall': 0.7567637, 'specificity': 0.7567637, 'f1': 0.8190936, 'auroc': 0.9337727, 'binary_precision': 0.8741259, 'binary_recall': 0.5165289, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.64935064}
confusion matrix:
      0    1
0  5979   18
1   117  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_12.png
new oracle model saved
early stop counter: 9
val acc:0.9683055281639099, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9615322947502136 / 0.9783619046211243
after epoch: 12,now: 2024-06-06 17:17:43.946551,epoch time: 0:15:15.252694,used: 3:00:52.987344,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96705, 'precision': 0.75275534, 'recall': 0.81118244, 'specificity': 0.81118244, 'f1': 0.7785771, 'auroc': 0.9542684, 'binary_precision': 0.51836085, 'binary_recall': 0.6437541, 'binary_specificity': 0.97861075, 'binary_f1_score': 0.5742925}
confusion matrix:
       0    1
0  41406  905
1    539  974
---- Validation: 
scalar performance:
{'acc': 0.96697384, 'precision': 0.73891425, 'recall': 0.8215271, 'specificity': 0.8215271, 'f1': 0.7734156, 'auroc': 0.94950503, 'binary_precision': 0.4890244, 'binary_recall': 0.66611296, 'binary_specificity': 0.9769413, 'binary_f1_score': 0.5639944}
confusion matrix:
       0    1
0  17752  419
1    201  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98108673, 'precision': 0.94033396, 'recall': 0.78792214, 'specificity': 0.78792214, 'f1': 0.8468747, 'auroc': 0.9216735, 'binary_precision': 0.8974359, 'binary_recall': 0.5785124, 'binary_specificity': 0.997332, 'binary_f1_score': 0.70351756}
confusion matrix:
      0    1
0  5981   16
1   102  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_13.png
new oracle model saved
early stop counter: 10
val acc:0.9669738411903381, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9615322947502136 / 0.9810867309570312
after epoch: 13,now: 2024-06-06 17:33:54.171671,epoch time: 0:16:10.225120,used: 3:17:03.212464,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.967552, 'precision': 0.7559117, 'recall': 0.79933363, 'specificity': 0.79933363, 'f1': 0.7757242, 'auroc': 0.9544609, 'binary_precision': 0.52554744, 'binary_recall': 0.61863846, 'binary_specificity': 0.9800288, 'binary_f1_score': 0.56830597}
confusion matrix:
       0    1
0  41466  845
1    577  936
---- Validation: 
scalar performance:
{'acc': 0.9677196, 'precision': 0.742832, 'recall': 0.8130788, 'specificity': 0.8130788, 'f1': 0.77300584, 'auroc': 0.95093435, 'binary_precision': 0.49744898, 'binary_recall': 0.64784056, 'binary_specificity': 0.9783171, 'binary_f1_score': 0.56277055}
confusion matrix:
       0    1
0  17777  394
1    212  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97884274, 'precision': 0.91517055, 'recall': 0.7748585, 'specificity': 0.7748585, 'f1': 0.8295355, 'auroc': 0.92301214, 'binary_precision': 0.84810126, 'binary_recall': 0.553719, 'binary_specificity': 0.995998, 'binary_f1_score': 0.67}
confusion matrix:
      0    1
0  5973   24
1   108  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_14.png
early stop counter: 11
val acc:0.9677196145057678, best validation acc: 0.9692643880844116, corresponding to test acc:                         0.9615322947502136 / 0.9810867309570312
after epoch: 14,now: 2024-06-06 17:49:03.227999,epoch time: 0:15:09.056328,used: 3:32:12.268792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96816814, 'precision': 0.76067007, 'recall': 0.77575386, 'specificity': 0.77575386, 'f1': 0.7679757, 'auroc': 0.9578552, 'binary_precision': 0.53678304, 'binary_recall': 0.5690681, 'binary_specificity': 0.9824396, 'binary_f1_score': 0.55245423}
confusion matrix:
       0    1
0  41568  743
1    652  861
---- Validation: 
scalar performance:
{'acc': 0.9694242, 'precision': 0.7534156, 'recall': 0.7930801, 'specificity': 0.7930801, 'f1': 0.77165127, 'auroc': 0.951076, 'binary_precision': 0.52, 'binary_recall': 0.60465115, 'binary_specificity': 0.981509, 'binary_f1_score': 0.5591397}
confusion matrix:
       0    1
0  17835  336
1    238  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97611797, 'precision': 0.9444071, 'recall': 0.7119762, 'specificity': 0.7119762, 'f1': 0.7839955, 'auroc': 0.92313445, 'binary_precision': 0.91150445, 'binary_recall': 0.42561984, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.5802817}
confusion matrix:
      0    1
0  5987   10
1   139  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_15.png
better model found
persisted
after epoch: 15,now: 2024-06-06 18:04:26.846317,epoch time: 0:15:23.618318,used: 3:47:35.887110,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9682822, 'precision': 0.7602913, 'recall': 0.81883097, 'specificity': 0.81883097, 'f1': 0.7862526, 'auroc': 0.96048373, 'binary_precision': 0.5329053, 'binary_recall': 0.6582948, 'binary_specificity': 0.9793671, 'binary_f1_score': 0.5890006}
confusion matrix:
       0    1
0  41438  873
1    517  996
---- Validation: 
scalar performance:
{'acc': 0.968199, 'precision': 0.74593115, 'recall': 0.8205539, 'specificity': 0.8205539, 'f1': 0.77776444, 'auroc': 0.95136595, 'binary_precision': 0.5031526, 'binary_recall': 0.6627907, 'binary_specificity': 0.9783171, 'binary_f1_score': 0.572043}
confusion matrix:
       0    1
0  17777  394
1    203  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9814073, 'precision': 0.9411447, 'recall': 0.7920544, 'specificity': 0.7920544, 'f1': 0.8501978, 'auroc': 0.93899584, 'binary_precision': 0.89873415, 'binary_recall': 0.58677685, 'binary_specificity': 0.997332, 'binary_f1_score': 0.7099999}
confusion matrix:
      0    1
0  5981   16
1   100  142
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_16.png
new oracle model saved
early stop counter: 1
val acc:0.9681990146636963, best validation acc: 0.9694241881370544, corresponding to test acc:                         0.9761179685592651 / 0.9814072847366333
after epoch: 16,now: 2024-06-06 18:19:56.146512,epoch time: 0:15:29.300195,used: 4:03:05.187305,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96823657, 'precision': 0.7600005, 'recall': 0.8191259, 'specificity': 0.8191259, 'f1': 0.78618777, 'auroc': 0.95948076, 'binary_precision': 0.5323011, 'binary_recall': 0.6589557, 'binary_specificity': 0.97929615, 'binary_f1_score': 0.58889544}
confusion matrix:
       0    1
0  41435  876
1    516  997
---- Validation: 
scalar performance:
{'acc': 0.9678794, 'precision': 0.7439002, 'recall': 0.8163736, 'specificity': 0.8163736, 'f1': 0.77491033, 'auroc': 0.9538145, 'binary_precision': 0.49936628, 'binary_recall': 0.65448505, 'binary_specificity': 0.97826207, 'binary_f1_score': 0.56649894}
confusion matrix:
       0    1
0  17776  395
1    208  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9796442, 'precision': 0.9314453, 'recall': 0.77329266, 'specificity': 0.77329266, 'f1': 0.8331679, 'auroc': 0.937656, 'binary_precision': 0.8807947, 'binary_recall': 0.5495868, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.6768448}
confusion matrix:
      0    1
0  5979   18
1   109  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_17.png
early stop counter: 2
val acc:0.9678794145584106, best validation acc: 0.9694241881370544, corresponding to test acc:                         0.9761179685592651 / 0.9814072847366333
after epoch: 17,now: 2024-06-06 18:35:02.585958,epoch time: 0:15:06.439446,used: 4:18:11.626751,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9676889, 'precision': 0.7566298, 'recall': 0.8188423, 'specificity': 0.8188423, 'f1': 0.7839706, 'auroc': 0.959684, 'binary_precision': 0.5255667, 'binary_recall': 0.6589557, 'binary_specificity': 0.97872895, 'binary_f1_score': 0.5847507}
confusion matrix:
       0    1
0  41411  900
1    516  997
---- Validation: 
scalar performance:
{'acc': 0.96638787, 'precision': 0.7363406, 'recall': 0.8324671, 'specificity': 0.8324671, 'f1': 0.7753087, 'auroc': 0.95430183, 'binary_precision': 0.4831199, 'binary_recall': 0.6893688, 'binary_specificity': 0.97556543, 'binary_f1_score': 0.568104}
confusion matrix:
       0    1
0  17727  444
1    187  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.980125, 'precision': 0.94037664, 'recall': 0.77354276, 'specificity': 0.77354276, 'f1': 0.8358966, 'auroc': 0.938884, 'binary_precision': 0.8986486, 'binary_recall': 0.5495868, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.6820513}
confusion matrix:
      0    1
0  5982   15
1   109  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_18.png
early stop counter: 3
val acc:0.9663878679275513, best validation acc: 0.9694241881370544, corresponding to test acc:                         0.9761179685592651 / 0.9814072847366333
after epoch: 18,now: 2024-06-06 18:49:31.829344,epoch time: 0:14:29.243386,used: 4:32:40.870137,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97029024, 'precision': 0.77346975, 'recall': 0.8198708, 'specificity': 0.8198708, 'f1': 0.7946505, 'auroc': 0.9624957, 'binary_precision': 0.5592364, 'binary_recall': 0.6582948, 'binary_specificity': 0.9814469, 'binary_f1_score': 0.6047359}
confusion matrix:
       0    1
0  41526  785
1    517  996
---- Validation: 
scalar performance:
{'acc': 0.9691578, 'precision': 0.7517487, 'recall': 0.817837, 'specificity': 0.817837, 'f1': 0.78052944, 'auroc': 0.9562926, 'binary_precision': 0.5149935, 'binary_recall': 0.65614617, 'binary_specificity': 0.97952783, 'binary_f1_score': 0.5770635}
confusion matrix:
       0    1
0  17799  372
1    207  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9793236, 'precision': 0.9355562, 'recall': 0.7651949, 'specificity': 0.7651949, 'f1': 0.8279988, 'auroc': 0.931965, 'binary_precision': 0.8896552, 'binary_recall': 0.53305787, 'binary_specificity': 0.997332, 'binary_f1_score': 0.6666667}
confusion matrix:
      0    1
0  5981   16
1   113  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_19.png
early stop counter: 4
val acc:0.9691578149795532, best validation acc: 0.9694241881370544, corresponding to test acc:                         0.9761179685592651 / 0.9814072847366333
after epoch: 19,now: 2024-06-06 19:04:45.415535,epoch time: 0:15:13.586191,used: 4:47:54.456328,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9694232, 'precision': 0.7674804, 'recall': 0.82260835, 'specificity': 0.82260835, 'f1': 0.7921712, 'auroc': 0.96485436, 'binary_precision': 0.5470364, 'binary_recall': 0.6649042, 'binary_specificity': 0.98031247, 'binary_f1_score': 0.6002387}
confusion matrix:
       0     1
0  41478   833
1    507  1006
---- Validation: 
scalar performance:
{'acc': 0.968998, 'precision': 0.7507652, 'recall': 0.8193605, 'specificity': 0.8193605, 'f1': 0.7804721, 'auroc': 0.95817006, 'binary_precision': 0.5129199, 'binary_recall': 0.6594684, 'binary_specificity': 0.97925264, 'binary_f1_score': 0.5770349}
confusion matrix:
       0    1
0  17794  377
1    205  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9783619, 'precision': 0.9249652, 'recall': 0.7587465, 'specificity': 0.7587465, 'f1': 0.81999874, 'auroc': 0.93219805, 'binary_precision': 0.8689655, 'binary_recall': 0.5206612, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.65116274}
confusion matrix:
      0    1
0  5978   19
1   116  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_20.png
early stop counter: 5
val acc:0.9689980149269104, best validation acc: 0.9694241881370544, corresponding to test acc:                         0.9761179685592651 / 0.9814072847366333
after epoch: 20,now: 2024-06-06 19:19:34.795439,epoch time: 0:14:49.379904,used: 5:02:43.836232,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97211576, 'precision': 0.786788, 'recall': 0.81954163, 'specificity': 0.81954163, 'f1': 0.8021841, 'auroc': 0.96562135, 'binary_precision': 0.5859421, 'binary_recall': 0.65565103, 'binary_specificity': 0.98343223, 'binary_f1_score': 0.6188397}
confusion matrix:
       0    1
0  41610  701
1    521  992
---- Validation: 
scalar performance:
{'acc': 0.9728866, 'precision': 0.7782727, 'recall': 0.8125357, 'specificity': 0.8125357, 'f1': 0.79430926, 'auroc': 0.9581415, 'binary_precision': 0.56848305, 'binary_recall': 0.641196, 'binary_specificity': 0.9838754, 'binary_f1_score': 0.60265416}
confusion matrix:
       0    1
0  17878  293
1    216  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.980125, 'precision': 0.9377982, 'recall': 0.77552545, 'specificity': 0.77552545, 'f1': 0.8367068, 'auroc': 0.9378895, 'binary_precision': 0.8933333, 'binary_recall': 0.553719, 'binary_specificity': 0.997332, 'binary_f1_score': 0.68367344}
confusion matrix:
      0    1
0  5981   16
1   108  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_21.png
better model found
persisted
after epoch: 21,now: 2024-06-06 19:34:12.573301,epoch time: 0:14:37.777862,used: 5:17:21.614094,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9718191, 'precision': 0.78605473, 'recall': 0.8069606, 'specificity': 0.8069606, 'f1': 0.7960994, 'auroc': 0.9655105, 'binary_precision': 0.58538085, 'binary_recall': 0.6298744, 'binary_specificity': 0.9840467, 'binary_f1_score': 0.60681313}
confusion matrix:
       0    1
0  41636  675
1    560  953
---- Validation: 
scalar performance:
{'acc': 0.97331274, 'precision': 0.7820105, 'recall': 0.8095436, 'specificity': 0.8095436, 'f1': 0.79507184, 'auroc': 0.9587324, 'binary_precision': 0.57616895, 'binary_recall': 0.63455147, 'binary_specificity': 0.9845358, 'binary_f1_score': 0.6039525}
confusion matrix:
       0    1
0  17890  281
1    220  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9794839, 'precision': 0.95302236, 'recall': 0.7553646, 'specificity': 0.7553646, 'f1': 0.82449883, 'auroc': 0.93200266, 'binary_precision': 0.92537314, 'binary_recall': 0.5123967, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.65957445}
confusion matrix:
      0    1
0  5987   10
1   118  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_22.png
better model found
persisted
after epoch: 22,now: 2024-06-06 19:48:51.784824,epoch time: 0:14:39.211523,used: 5:32:00.825617,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9714996, 'precision': 0.7800479, 'recall': 0.84079206, 'specificity': 0.84079206, 'f1': 0.8071135, 'auroc': 0.967757, 'binary_precision': 0.5708895, 'binary_recall': 0.70039684, 'binary_specificity': 0.98118734, 'binary_f1_score': 0.6290466}
confusion matrix:
       0     1
0  41516   796
1    453  1059
---- Validation: 
scalar performance:
{'acc': 0.9707559, 'precision': 0.7619083, 'recall': 0.8323143, 'specificity': 0.8323143, 'f1': 0.7924843, 'auroc': 0.9592174, 'binary_precision': 0.53437096, 'binary_recall': 0.68438536, 'binary_specificity': 0.98024327, 'binary_f1_score': 0.60014564}
confusion matrix:
       0    1
0  17812  359
1    190  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98044556, 'precision': 0.9268752, 'recall': 0.7895714, 'specificity': 0.7895714, 'f1': 0.84395766, 'auroc': 0.93647873, 'binary_precision': 0.8703704, 'binary_recall': 0.58264464, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.69801974}
confusion matrix:
      0    1
0  5976   21
1   101  141
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_23.png
early stop counter: 1
val acc:0.9707558751106262, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9794839024543762 / 0.9814072847366333
after epoch: 23,now: 2024-06-06 20:04:08.266493,epoch time: 0:15:16.481669,used: 5:47:17.307286,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9700164, 'precision': 0.7702123, 'recall': 0.8461771, 'specificity': 0.8461771, 'f1': 0.80296683, 'auroc': 0.96544504, 'binary_precision': 0.5507912, 'binary_recall': 0.71315265, 'binary_specificity': 0.9792016, 'binary_f1_score': 0.62154377}
confusion matrix:
       0     1
0  41431   880
1    434  1079
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.75082445, 'recall': 0.84422755, 'specificity': 0.84422755, 'f1': 0.7893555, 'auroc': 0.95949113, 'binary_precision': 0.51135004, 'binary_recall': 0.7109634, 'binary_specificity': 0.9774916, 'binary_f1_score': 0.5948575}
confusion matrix:
       0    1
0  17762  409
1    174  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98044556, 'precision': 0.9314044, 'recall': 0.78560597, 'specificity': 0.78560597, 'f1': 0.8424495, 'auroc': 0.93699944, 'binary_precision': 0.87974685, 'binary_recall': 0.57438016, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.695}
confusion matrix:
      0    1
0  5978   19
1   103  139
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_24.png
early stop counter: 2
val acc:0.968944787979126, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9794839024543762 / 0.9814072847366333
after epoch: 24,now: 2024-06-06 20:19:06.017363,epoch time: 0:14:57.750870,used: 6:02:15.058156,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9712943, 'precision': 0.77888477, 'recall': 0.8395099, 'specificity': 0.8395099, 'f1': 0.8058897, 'auroc': 0.9683675, 'binary_precision': 0.5686591, 'binary_recall': 0.6979511, 'binary_specificity': 0.98106873, 'binary_f1_score': 0.62670624}
confusion matrix:
       0     1
0  41510   801
1    457  1056
---- Validation: 
scalar performance:
{'acc': 0.97128856, 'precision': 0.76536834, 'recall': 0.8341956, 'specificity': 0.8341956, 'f1': 0.79540384, 'auroc': 0.9609928, 'binary_precision': 0.5411765, 'binary_recall': 0.68770766, 'binary_specificity': 0.9806835, 'binary_f1_score': 0.6057059}
confusion matrix:
       0    1
0  17820  351
1    188  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98108673, 'precision': 0.9507581, 'recall': 0.77999127, 'specificity': 0.77999127, 'f1': 0.843837, 'auroc': 0.9398563, 'binary_precision': 0.9189189, 'binary_recall': 0.56198347, 'binary_specificity': 0.997999, 'binary_f1_score': 0.6974358}
confusion matrix:
      0    1
0  5985   12
1   106  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_25.png
early stop counter: 3
val acc:0.9712885618209839, best validation acc: 0.9733127355575562, corresponding to test acc:                         0.9794839024543762 / 0.9814072847366333
after epoch: 25,now: 2024-06-06 20:33:54.020469,epoch time: 0:14:48.003106,used: 6:17:03.061262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9732338, 'precision': 0.795222, 'recall': 0.8220326, 'specificity': 0.8220326, 'f1': 0.8079833, 'auroc': 0.96925825, 'binary_precision': 0.602657, 'binary_recall': 0.65961665, 'binary_specificity': 0.9844485, 'binary_f1_score': 0.6298517}
confusion matrix:
       0    1
0  41653  658
1    515  998
---- Validation: 
scalar performance:
{'acc': 0.974964, 'precision': 0.7993051, 'recall': 0.7935326, 'specificity': 0.7935326, 'f1': 0.79638815, 'auroc': 0.96171266, 'binary_precision': 0.6118644, 'binary_recall': 0.5996678, 'binary_specificity': 0.9873975, 'binary_f1_score': 0.6057047}
confusion matrix:
       0    1
0  17942  229
1    241  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97884274, 'precision': 0.9424566, 'recall': 0.75304836, 'specificity': 0.75304836, 'f1': 0.81994224, 'auroc': 0.9411319, 'binary_precision': 0.9044118, 'binary_recall': 0.5082645, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.6507936}
confusion matrix:
      0    1
0  5984   13
1   119  123
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_26.png
better model found
persisted
after epoch: 26,now: 2024-06-06 20:49:13.045470,epoch time: 0:15:19.025001,used: 6:32:22.086263,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97339356, 'precision': 0.79393923, 'recall': 0.83900386, 'specificity': 0.83900386, 'f1': 0.81469417, 'auroc': 0.96796083, 'binary_precision': 0.5988604, 'binary_recall': 0.6946464, 'binary_specificity': 0.9833613, 'binary_f1_score': 0.64320683}
confusion matrix:
       0     1
0  41607   704
1    462  1051
---- Validation: 
scalar performance:
{'acc': 0.97331274, 'precision': 0.78116494, 'recall': 0.81757414, 'specificity': 0.81757414, 'f1': 0.7981501, 'auroc': 0.9617306, 'binary_precision': 0.5739385, 'binary_recall': 0.6511628, 'binary_specificity': 0.9839855, 'binary_f1_score': 0.6101167}
confusion matrix:
       0    1
0  17880  291
1    210  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98108673, 'precision': 0.937898, 'recall': 0.78990495, 'specificity': 0.78990495, 'f1': 0.84761506, 'auroc': 0.943504, 'binary_precision': 0.8924051, 'binary_recall': 0.58264464, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.705}
confusion matrix:
      0    1
0  5980   17
1   101  141
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_27.png
early stop counter: 1
val acc:0.9733127355575562, best validation acc: 0.9749640226364136, corresponding to test acc:                         0.9788427352905273 / 0.9814072847366333
after epoch: 27,now: 2024-06-06 21:03:46.902595,epoch time: 0:14:33.857125,used: 6:46:55.943388,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97254926, 'precision': 0.78608084, 'recall': 0.8541806, 'specificity': 0.8541806, 'f1': 0.8161043, 'auroc': 0.96840155, 'binary_precision': 0.58201057, 'binary_recall': 0.72703236, 'binary_specificity': 0.9813287, 'binary_f1_score': 0.64648837}
confusion matrix:
       0     1
0  41521   790
1    413  1100
---- Validation: 
scalar performance:
{'acc': 0.97293985, 'precision': 0.7764534, 'recall': 0.8398669, 'specificity': 0.8398669, 'f1': 0.8045557, 'auroc': 0.9620149, 'binary_precision': 0.5630027, 'binary_recall': 0.6976744, 'binary_specificity': 0.9820593, 'binary_f1_score': 0.6231454}
confusion matrix:
       0    1
0  17845  326
1    182  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97804135, 'precision': 0.9144784, 'recall': 0.76254517, 'specificity': 0.76254517, 'f1': 0.8200316, 'auroc': 0.9337572, 'binary_precision': 0.8476821, 'binary_recall': 0.5289256, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.6513995}
confusion matrix:
      0    1
0  5974   23
1   114  128
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_28.png
early stop counter: 2
val acc:0.9729398488998413, best validation acc: 0.9749640226364136, corresponding to test acc:                         0.9788427352905273 / 0.9814072847366333
after epoch: 28,now: 2024-06-06 21:18:17.705879,epoch time: 0:14:30.803284,used: 7:01:26.746672,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97339356, 'precision': 0.7950505, 'recall': 0.83135617, 'specificity': 0.83135617, 'f1': 0.8120388, 'auroc': 0.9702437, 'binary_precision': 0.6016403, 'binary_recall': 0.6787839, 'binary_specificity': 0.9839285, 'binary_f1_score': 0.6378882}
confusion matrix:
       0     1
0  41631   680
1    486  1027
---- Validation: 
scalar performance:
{'acc': 0.9748042, 'precision': 0.7941985, 'recall': 0.8135263, 'specificity': 0.8135263, 'f1': 0.8035252, 'auroc': 0.96328044, 'binary_precision': 0.60031104, 'binary_recall': 0.641196, 'binary_specificity': 0.9858566, 'binary_f1_score': 0.62008035}
confusion matrix:
       0    1
0  17914  257
1    216  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9796442, 'precision': 0.94178057, 'recall': 0.76536167, 'specificity': 0.76536167, 'f1': 0.82981396, 'auroc': 0.93594146, 'binary_precision': 0.9020979, 'binary_recall': 0.53305787, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.6701299}
confusion matrix:
      0    1
0  5983   14
1   113  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_29.png
early stop counter: 3
val acc:0.9748042225837708, best validation acc: 0.9749640226364136, corresponding to test acc:                         0.9788427352905273 / 0.9814072847366333
after epoch: 29,now: 2024-06-06 21:32:46.595060,epoch time: 0:14:28.889181,used: 7:15:55.635853,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.974466, 'precision': 0.80525684, 'recall': 0.823308, 'specificity': 0.823308, 'f1': 0.81399655, 'auroc': 0.971889, 'binary_precision': 0.622665, 'binary_recall': 0.66093856, 'binary_specificity': 0.9856775, 'binary_f1_score': 0.6412312}
confusion matrix:
       0     1
0  41705   606
1    513  1000
---- Validation: 
scalar performance:
{'acc': 0.97709477, 'precision': 0.8200603, 'recall': 0.7994516, 'specificity': 0.7994516, 'f1': 0.80938256, 'auroc': 0.9646126, 'binary_precision': 0.6530249, 'binary_recall': 0.6096346, 'binary_specificity': 0.9892686, 'binary_f1_score': 0.6305842}
confusion matrix:
       0    1
0  17976  195
1    235  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97884274, 'precision': 0.9341491, 'recall': 0.7589966, 'specificity': 0.7589966, 'f1': 0.8226677, 'auroc': 0.9336644, 'binary_precision': 0.8873239, 'binary_recall': 0.5206612, 'binary_specificity': 0.997332, 'binary_f1_score': 0.65625}
confusion matrix:
      0    1
0  5981   16
1   116  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21127984_30.png
better model found
persisted
after epoch: 30,now: 2024-06-06 21:47:18.955149,epoch time: 0:14:32.360089,used: 7:30:27.995942,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_06_14_16_50_seed_2_21127984
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:30:27.995942 at 2024-06-06 21:47:18.955149
persisted model performance metric: 

scalar performance:
{'acc': 0.9785222, 'precision': 0.9305459, 'recall': 0.7568471, 'specificity': 0.7568471, 'f1': 0.8199809, 'auroc': 0.94403106, 'binary_precision': 0.8802817, 'binary_recall': 0.5165289, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.6510417}
confusion matrix:
      0    1
0  5980   17
1   117  125
oracle model performance metric: 

scalar performance:
{'acc': 0.9796442, 'precision': 0.9339218, 'recall': 0.7713099, 'specificity': 0.7713099, 'f1': 0.8323423, 'auroc': 0.92488015, 'binary_precision': 0.88590604, 'binary_recall': 0.54545456, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.6751918}
confusion matrix:
      0    1
0  5980   17
1   110  132
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-6/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 532501 KiB |   1857 MiB |   3418 TiB |   3418 TiB |
|       from large pool | 442688 KiB |   1786 MiB |   3409 TiB |   3409 TiB |
|       from small pool |  89813 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 532501 KiB |   1857 MiB |   3418 TiB |   3418 TiB |
|       from large pool | 442688 KiB |   1786 MiB |   3409 TiB |   3409 TiB |
|       from small pool |  89813 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 525468 KiB |   1842 MiB |   3401 TiB |   3401 TiB |
|       from large pool | 436736 KiB |   1772 MiB |   3393 TiB |   3393 TiB |
|       from small pool |  88732 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2038 MiB |   2048 MiB |   3644 MiB |   1606 MiB |
|       from large pool |   1914 MiB |   1922 MiB |   3458 MiB |   1544 MiB |
|       from small pool |    124 MiB |    126 MiB |    186 MiB |     62 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    805 MiB |    929 MiB |   2000 TiB |   2000 TiB |
|       from large pool |    799 MiB |    927 MiB |   1990 TiB |   1990 TiB |
|       from small pool |      6 MiB |     30 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3717    |    6708    |  384230 K  |  384227 K  |
|       from large pool |      87    |     178    |  165033 K  |  165033 K  |
|       from small pool |    3630    |    6620    |  219197 K  |  219194 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3717    |    6708    |  384230 K  |  384227 K  |
|       from large pool |      87    |     178    |  165033 K  |  165033 K  |
|       from small pool |    3630    |    6620    |  219197 K  |  219194 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      90    |      96    |     140    |      50    |
|       from large pool |      28    |      33    |      47    |      19    |
|       from small pool |      62    |      63    |      93    |      31    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      53    |    2770    |  167363 K  |  167363 K  |
|       from large pool |      18    |      25    |   66083 K  |   66083 K  |
|       from small pool |      35    |    2750    |  101279 K  |  101279 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   1857 MiB |   3418 TiB |   3418 TiB |
|       from large pool |  65536 KiB |   1786 MiB |   3409 TiB |   3409 TiB |
|       from small pool |      0 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   1857 MiB |   3418 TiB |   3418 TiB |
|       from large pool |  65536 KiB |   1786 MiB |   3409 TiB |   3409 TiB |
|       from small pool |      0 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   1842 MiB |   3401 TiB |   3401 TiB |
|       from large pool |  65536 KiB |   1772 MiB |   3393 TiB |   3393 TiB |
|       from small pool |      0 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1326 MiB |   2048 MiB |   3644 MiB |   2318 MiB |
|       from large pool |   1232 MiB |   1922 MiB |   3458 MiB |   2226 MiB |
|       from small pool |     94 MiB |    126 MiB |    186 MiB |     92 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116736 KiB |    931 MiB |   2000 TiB |   2000 TiB |
|       from large pool | 116736 KiB |    927 MiB |   1990 TiB |   1990 TiB |
|       from small pool |      0 KiB |     30 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6708    |  384230 K  |  384230 K  |
|       from large pool |       2    |     178    |  165033 K  |  165033 K  |
|       from small pool |       0    |    6620    |  219197 K  |  219197 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6708    |  384230 K  |  384230 K  |
|       from large pool |       2    |     178    |  165033 K  |  165033 K  |
|       from small pool |       0    |    6620    |  219197 K  |  219197 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |      96    |     140    |      71    |
|       from large pool |      22    |      33    |      47    |      25    |
|       from small pool |      47    |      63    |      93    |      46    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2770    |  167364 K  |  167364 K  |
|       from large pool |       3    |      25    |   66083 K  |   66083 K  |
|       from small pool |       0    |    2750    |  101281 K  |  101281 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Jun  6 21:48:47 2024]
Finished job 0.
1 of 1 steps (100%) done
