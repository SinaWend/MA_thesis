Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jun  2 00:30:26 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/rule_results/9.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=9
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734

 Experiment start at: 2024-06-02 00:39:47.012665
before training, model accuracy: 0.2401725947856903
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9665921, 'precision': 0.75375956, 'recall': 0.5201057, 'specificity': 0.5201057, 'f1': 0.5299799, 'auroc': 0.8969618, 'binary_precision': 0.539823, 'binary_recall': 0.04144022, 'binary_specificity': 0.99877125, 'binary_f1_score': 0.07697161}
confusion matrix:
       0   1
0  42268  52
1   1411  61
---- Validation: 
scalar performance:
{'acc': 0.96482545, 'precision': 0.6743864, 'recall': 0.5212557, 'specificity': 0.5212557, 'f1': 0.5313686, 'auroc': 0.8865613, 'binary_precision': 0.38157895, 'binary_recall': 0.045101088, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.08066759}
confusion matrix:
       0   1
0  18102  47
1    614  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.89502543, 'recall': 0.58920455, 'specificity': 0.58920455, 'f1': 0.6386169, 'auroc': 0.8957602, 'binary_precision': 0.8245614, 'binary_recall': 0.18007663, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.2955975}
confusion matrix:
      0   1
0  5987  10
1   214  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-02 01:06:02.581081,epoch time: 0:26:15.568416,used: 0:26:15.568416,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96551883, 'precision': 0.7195201, 'recall': 0.5874173, 'specificity': 0.5874173, 'f1': 0.6221608, 'auroc': 0.9198904, 'binary_precision': 0.46689895, 'binary_recall': 0.18206522, 'binary_specificity': 0.99276936, 'binary_f1_score': 0.26197457}
confusion matrix:
       0    1
0  42014  306
1   1204  268
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.7416781, 'recall': 0.6276747, 'specificity': 0.6276747, 'f1': 0.6653015, 'auroc': 0.9236415, 'binary_precision': 0.50898206, 'binary_recall': 0.2643857, 'binary_specificity': 0.9909637, 'binary_f1_score': 0.3480041}
confusion matrix:
       0    1
0  17985  164
1    473  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9752317, 'precision': 0.8940468, 'recall': 0.76353216, 'specificity': 0.76353216, 'f1': 0.8146022, 'auroc': 0.9031457, 'binary_precision': 0.80813956, 'binary_recall': 0.532567, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.6420323}
confusion matrix:
      0    1
0  5964   33
1   122  139
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-02 01:31:32.985069,epoch time: 0:25:30.403988,used: 0:51:45.972404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.7406906, 'recall': 0.72342956, 'specificity': 0.72342956, 'f1': 0.73170286, 'auroc': 0.9269334, 'binary_precision': 0.5, 'binary_recall': 0.46295038, 'binary_specificity': 0.9839087, 'binary_f1_score': 0.48076245}
confusion matrix:
       0    1
0  41640  681
1    790  681
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.74079573, 'recall': 0.7422403, 'specificity': 0.7422403, 'f1': 0.74151564, 'auroc': 0.9256353, 'binary_precision': 0.4992272, 'binary_recall': 0.5023328, 'binary_specificity': 0.98214775, 'binary_f1_score': 0.5007752}
confusion matrix:
       0    1
0  17825  324
1    320  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.978907, 'precision': 0.8939643, 'recall': 0.82408446, 'specificity': 0.82408446, 'f1': 0.8552787, 'auroc': 0.9228542, 'binary_precision': 0.8028169, 'binary_recall': 0.6551724, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.721519}
confusion matrix:
      0    1
0  5955   42
1    90  171
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_3.png
new oracle model saved
early stop counter: 1
val acc:0.9657300710678101, best validation acc: 0.9661026000976562, corresponding to test acc:                         0.9752317070960999 / 0.9789069890975952
after epoch: 3,now: 2024-06-02 01:55:25.228290,epoch time: 0:23:52.243221,used: 1:15:38.215625,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9669803, 'precision': 0.7449306, 'recall': 0.7015449, 'specificity': 0.7015449, 'f1': 0.7209015, 'auroc': 0.9320656, 'binary_precision': 0.50998336, 'binary_recall': 0.4170068, 'binary_specificity': 0.9860829, 'binary_f1_score': 0.45883232}
confusion matrix:
       0    1
0  41733  589
1    857  613
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.75048655, 'recall': 0.7324007, 'specificity': 0.7324007, 'f1': 0.74106705, 'auroc': 0.92164946, 'binary_precision': 0.51932776, 'binary_recall': 0.4805599, 'binary_specificity': 0.98424155, 'binary_f1_score': 0.49919227}
confusion matrix:
       0    1
0  17863  286
1    334  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9760307, 'precision': 0.879392, 'recall': 0.79509866, 'specificity': 0.79509866, 'f1': 0.8314403, 'auroc': 0.9212015, 'binary_precision': 0.7761194, 'binary_recall': 0.59770113, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.6753247}
confusion matrix:
      0    1
0  5952   45
1   105  156
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_4.png
better model found
persisted
after epoch: 4,now: 2024-06-02 02:19:15.207945,epoch time: 0:23:49.979655,used: 1:39:28.195280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96885276, 'precision': 0.76330495, 'recall': 0.710778, 'specificity': 0.710778, 'f1': 0.7338332, 'auroc': 0.9333589, 'binary_precision': 0.54615384, 'binary_recall': 0.43410325, 'binary_specificity': 0.98745275, 'binary_f1_score': 0.48372445}
confusion matrix:
       0    1
0  41789  531
1    833  639
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.7567224, 'recall': 0.7335365, 'specificity': 0.7335365, 'f1': 0.744521, 'auroc': 0.92126393, 'binary_precision': 0.53173244, 'binary_recall': 0.4821151, 'binary_specificity': 0.9849579, 'binary_f1_score': 0.50570965}
confusion matrix:
       0    1
0  17876  273
1    333  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97762865, 'precision': 0.8922426, 'recall': 0.8050941, 'specificity': 0.8050941, 'f1': 0.84267765, 'auroc': 0.922858, 'binary_precision': 0.80099505, 'binary_recall': 0.61685824, 'binary_specificity': 0.99333, 'binary_f1_score': 0.6969697}
confusion matrix:
      0    1
0  5957   40
1   100  161
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_5.png
better model found
persisted
after epoch: 5,now: 2024-06-02 02:43:16.934232,epoch time: 0:24:01.726287,used: 2:03:29.921567,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9695606, 'precision': 0.76804185, 'recall': 0.7357337, 'specificity': 0.7357337, 'f1': 0.7507444, 'auroc': 0.94287443, 'binary_precision': 0.55391777, 'binary_recall': 0.48505434, 'binary_specificity': 0.98641306, 'binary_f1_score': 0.51720387}
confusion matrix:
       0    1
0  41745  575
1    758  714
---- Validation: 
scalar performance:
{'acc': 0.96812475, 'precision': 0.7599569, 'recall': 0.7337293, 'specificity': 0.7337293, 'f1': 0.74607086, 'auroc': 0.93535334, 'binary_precision': 0.5381944, 'binary_recall': 0.4821151, 'binary_specificity': 0.9853435, 'binary_f1_score': 0.50861365}
confusion matrix:
       0    1
0  17883  266
1    333  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97682965, 'precision': 0.8878838, 'recall': 0.7973479, 'specificity': 0.7973479, 'f1': 0.8360348, 'auroc': 0.9294834, 'binary_precision': 0.7929293, 'binary_recall': 0.6015326, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.68409586}
confusion matrix:
      0    1
0  5956   41
1   104  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_6.png
better model found
persisted
after epoch: 6,now: 2024-06-02 03:06:56.417570,epoch time: 0:23:39.483338,used: 2:27:09.404905,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96768814, 'precision': 0.7512022, 'recall': 0.74377656, 'specificity': 0.74377656, 'f1': 0.74742746, 'auroc': 0.9448159, 'binary_precision': 0.5196353, 'binary_recall': 0.50373894, 'binary_specificity': 0.9838142, 'binary_f1_score': 0.5115636}
confusion matrix:
       0    1
0  41636  685
1    730  741
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.74127567, 'recall': 0.7647144, 'specificity': 0.7647144, 'f1': 0.7523873, 'auroc': 0.9377773, 'binary_precision': 0.49858758, 'binary_recall': 0.5489891, 'binary_specificity': 0.9804397, 'binary_f1_score': 0.5225759}
confusion matrix:
       0    1
0  17794  355
1    290  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97714925, 'precision': 0.882457, 'recall': 0.810341, 'specificity': 0.810341, 'f1': 0.8422592, 'auroc': 0.9351815, 'binary_precision': 0.7809524, 'binary_recall': 0.62835246, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.6963906}
confusion matrix:
      0    1
0  5951   46
1    97  164
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_7.png
early stop counter: 1
val acc:0.9656769037246704, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.9768296480178833 / 0.9789069890975952
after epoch: 7,now: 2024-06-02 03:30:43.814399,epoch time: 0:23:47.396829,used: 2:50:56.801734,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9693323, 'precision': 0.763177, 'recall': 0.77987653, 'specificity': 0.77987653, 'f1': 0.7712418, 'auroc': 0.94655174, 'binary_precision': 0.54110897, 'binary_recall': 0.5767663, 'binary_specificity': 0.98298675, 'binary_f1_score': 0.5583689}
confusion matrix:
       0    1
0  41600  720
1    623  849
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.7550508, 'recall': 0.76498365, 'specificity': 0.76498365, 'f1': 0.75991154, 'auroc': 0.936695, 'binary_precision': 0.52615845, 'binary_recall': 0.5474339, 'binary_specificity': 0.98253345, 'binary_f1_score': 0.53658533}
confusion matrix:
       0    1
0  17832  317
1    291  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97762865, 'precision': 0.87183315, 'recall': 0.8362438, 'specificity': 0.8362438, 'f1': 0.8530474, 'auroc': 0.9314797, 'binary_precision': 0.7574468, 'binary_recall': 0.68199235, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.71774197}
confusion matrix:
      0    1
0  5940   57
1    83  178
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_8.png
early stop counter: 2
val acc:0.9676458239555359, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.9768296480178833 / 0.9789069890975952
after epoch: 8,now: 2024-06-02 03:54:37.427124,epoch time: 0:23:53.612725,used: 3:14:50.414459,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96789366, 'precision': 0.7528822, 'recall': 0.8273275, 'specificity': 0.8273275, 'f1': 0.784763, 'auroc': 0.9524733, 'binary_precision': 0.51713395, 'binary_recall': 0.67663044, 'binary_specificity': 0.9780246, 'binary_f1_score': 0.5862271}
confusion matrix:
       0    1
0  41390  930
1    476  996
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.74643433, 'recall': 0.8010477, 'specificity': 0.8010477, 'f1': 0.7706871, 'auroc': 0.9444734, 'binary_precision': 0.50631315, 'binary_recall': 0.62363917, 'binary_specificity': 0.97845614, 'binary_f1_score': 0.55888504}
confusion matrix:
       0    1
0  17758  391
1    242  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.8720155, 'recall': 0.8419075, 'specificity': 0.8419075, 'f1': 0.8562577, 'auroc': 0.9397234, 'binary_precision': 0.7573222, 'binary_recall': 0.6934866, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.72400004}
confusion matrix:
      0    1
0  5939   58
1    80  181
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_9.png
early stop counter: 3
val acc:0.9663154482841492, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.9768296480178833 / 0.9789069890975952
after epoch: 9,now: 2024-06-02 04:18:27.091161,epoch time: 0:23:49.664037,used: 3:38:40.078496,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9663181, 'precision': 0.7428691, 'recall': 0.7976607, 'specificity': 0.7976607, 'f1': 0.7671547, 'auroc': 0.9512911, 'binary_precision': 0.49917537, 'binary_recall': 0.6168478, 'binary_specificity': 0.97847354, 'binary_f1_score': 0.55180794}
confusion matrix:
       0    1
0  41409  911
1    564  908
---- Validation: 
scalar performance:
{'acc': 0.96392083, 'precision': 0.73301435, 'recall': 0.80280817, 'specificity': 0.80280817, 'f1': 0.7627858, 'auroc': 0.94535416, 'binary_precision': 0.47928995, 'binary_recall': 0.62986004, 'binary_specificity': 0.9757562, 'binary_f1_score': 0.54435486}
confusion matrix:
       0    1
0  17709  440
1    238  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97651005, 'precision': 0.8566017, 'recall': 0.8448218, 'specificity': 0.8448218, 'f1': 0.8506017, 'auroc': 0.9344648, 'binary_precision': 0.72619045, 'binary_recall': 0.7011494, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.7134503}
confusion matrix:
      0    1
0  5928   69
1    78  183
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_10.png
early stop counter: 4
val acc:0.9639208316802979, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.9768296480178833 / 0.9789069890975952
after epoch: 10,now: 2024-06-02 04:42:09.654929,epoch time: 0:23:42.563768,used: 4:02:22.642264,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96750546, 'precision': 0.749918, 'recall': 0.744834, 'specificity': 0.744834, 'f1': 0.747347, 'auroc': 0.9551412, 'binary_precision': 0.5170021, 'binary_recall': 0.5061141, 'binary_specificity': 0.9835539, 'binary_f1_score': 0.5115002}
confusion matrix:
       0    1
0  41624  696
1    727  745
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.7424667, 'recall': 0.7685473, 'specificity': 0.7685473, 'f1': 0.75476193, 'auroc': 0.94524705, 'binary_precision': 0.5006993, 'binary_recall': 0.55676514, 'binary_specificity': 0.9803295, 'binary_f1_score': 0.52724594}
confusion matrix:
       0    1
0  17792  357
1    285  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97331417, 'precision': 0.8689991, 'recall': 0.76069933, 'specificity': 0.76069933, 'f1': 0.8045962, 'auroc': 0.9403508, 'binary_precision': 0.7582418, 'binary_recall': 0.52873564, 'binary_specificity': 0.992663, 'binary_f1_score': 0.6230248}
confusion matrix:
      0    1
0  5953   44
1   123  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_11.png
early stop counter: 5
val acc:0.9658365249633789, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.9768296480178833 / 0.9789069890975952
after epoch: 11,now: 2024-06-02 05:05:47.756092,epoch time: 0:23:38.101163,used: 4:26:00.743427,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9667976, 'precision': 0.74647236, 'recall': 0.8269788, 'specificity': 0.8269788, 'f1': 0.78039014, 'auroc': 0.95536995, 'binary_precision': 0.5043038, 'binary_recall': 0.6770904, 'binary_specificity': 0.97686726, 'binary_f1_score': 0.5780615}
confusion matrix:
       0    1
0  41342  979
1    475  996
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.74342465, 'recall': 0.82844156, 'specificity': 0.82844156, 'f1': 0.7788224, 'auroc': 0.95014143, 'binary_precision': 0.49829352, 'binary_recall': 0.68118197, 'binary_specificity': 0.97570115, 'binary_f1_score': 0.5755585}
confusion matrix:
       0    1
0  17708  441
1    205  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97267497, 'precision': 0.8394485, 'recall': 0.8006772, 'specificity': 0.8006772, 'f1': 0.8187554, 'auroc': 0.94146675, 'binary_precision': 0.6956522, 'binary_recall': 0.6130268, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.6517312}
confusion matrix:
      0    1
0  5927   70
1   101  160
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_12.png
early stop counter: 6
val acc:0.965623676776886, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.9768296480178833 / 0.9789069890975952
after epoch: 12,now: 2024-06-02 05:29:24.767687,epoch time: 0:23:37.011595,used: 4:49:37.755022,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9664322, 'precision': 0.74279666, 'recall': 0.78367007, 'specificity': 0.78367007, 'f1': 0.7614589, 'auroc': 0.95518696, 'binary_precision': 0.5, 'binary_recall': 0.5877551, 'binary_specificity': 0.9795851, 'binary_f1_score': 0.5403377}
confusion matrix:
       0    1
0  41458  864
1    606  864
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.7381578, 'recall': 0.80180395, 'specificity': 0.80180395, 'f1': 0.765761, 'auroc': 0.9501287, 'binary_precision': 0.48967195, 'binary_recall': 0.62674963, 'binary_specificity': 0.97685826, 'binary_f1_score': 0.5497954}
confusion matrix:
       0    1
0  17729  420
1    240  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9683605, 'precision': 0.8163386, 'recall': 0.75078535, 'specificity': 0.75078535, 'f1': 0.7793379, 'auroc': 0.93181634, 'binary_precision': 0.6536585, 'binary_recall': 0.51341, 'binary_specificity': 0.9881607, 'binary_f1_score': 0.5751073}
confusion matrix:
      0    1
0  5926   71
1   127  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_13.png
early stop counter: 7
val acc:0.9648786783218384, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.9768296480178833 / 0.9789069890975952
after epoch: 13,now: 2024-06-02 05:52:55.418781,epoch time: 0:23:30.651094,used: 5:13:08.406116,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96618104, 'precision': 0.74211586, 'recall': 0.805866, 'specificity': 0.805866, 'f1': 0.7698344, 'auroc': 0.95831025, 'binary_precision': 0.49706668, 'binary_recall': 0.6340136, 'binary_specificity': 0.9777185, 'binary_f1_score': 0.55724967}
confusion matrix:
       0    1
0  41379  943
1    538  932
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.74269325, 'recall': 0.8096902, 'specificity': 0.8096902, 'f1': 0.77162623, 'auroc': 0.9525408, 'binary_precision': 0.49819058, 'binary_recall': 0.64230174, 'binary_specificity': 0.9770786, 'binary_f1_score': 0.5611413}
confusion matrix:
       0    1
0  17733  416
1    230  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.77561426, 'recall': 0.6780718, 'specificity': 0.6780718, 'f1': 0.71510476, 'auroc': 0.93412673, 'binary_precision': 0.57831323, 'binary_recall': 0.3678161, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.4496487}
confusion matrix:
      0   1
0  5927  70
1   165  96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_14.png
early stop counter: 8
val acc:0.965623676776886, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.9768296480178833 / 0.9789069890975952
after epoch: 14,now: 2024-06-02 06:16:10.556586,epoch time: 0:23:15.137805,used: 5:36:23.543921,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9669118, 'precision': 0.746521, 'recall': 0.81433356, 'specificity': 0.81433356, 'f1': 0.77583694, 'auroc': 0.95520604, 'binary_precision': 0.50528544, 'binary_recall': 0.6507828, 'binary_specificity': 0.97788435, 'binary_f1_score': 0.5688783}
confusion matrix:
       0    1
0  41387  936
1    513  956
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.7419511, 'recall': 0.81335783, 'specificity': 0.81335783, 'f1': 0.7724923, 'auroc': 0.9486182, 'binary_precision': 0.49643704, 'binary_recall': 0.65007776, 'binary_specificity': 0.97663784, 'binary_f1_score': 0.56296295}
confusion matrix:
       0    1
0  17725  424
1    225  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.792649, 'recall': 0.7494514, 'specificity': 0.7494514, 'f1': 0.7691169, 'auroc': 0.93131626, 'binary_precision': 0.60633487, 'binary_recall': 0.51341, 'binary_specificity': 0.98549277, 'binary_f1_score': 0.5560166}
confusion matrix:
      0    1
0  5910   87
1   127  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_15.png
early stop counter: 9
val acc:0.9654640555381775, best validation acc: 0.9681247472763062, corresponding to test acc:                         0.9768296480178833 / 0.9789069890975952
after epoch: 15,now: 2024-06-02 06:39:24.731248,epoch time: 0:23:14.174662,used: 5:59:37.718583,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96981186, 'precision': 0.7655901, 'recall': 0.80438626, 'specificity': 0.80438626, 'f1': 0.7835207, 'auroc': 0.9623133, 'binary_precision': 0.5442217, 'binary_recall': 0.62703806, 'binary_specificity': 0.9817344, 'binary_f1_score': 0.582702}
confusion matrix:
       0    1
0  41547  773
1    549  923
---- Validation: 
scalar performance:
{'acc': 0.9698276, 'precision': 0.77035475, 'recall': 0.78936493, 'specificity': 0.78936493, 'f1': 0.7795013, 'auroc': 0.9513701, 'binary_precision': 0.5550725, 'binary_recall': 0.5956454, 'binary_specificity': 0.98308444, 'binary_f1_score': 0.5746437}
confusion matrix:
       0    1
0  17842  307
1    260  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.8403318, 'recall': 0.6862368, 'specificity': 0.6862368, 'f1': 0.7385047, 'auroc': 0.9345188, 'binary_precision': 0.70714283, 'binary_recall': 0.37931034, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.49376556}
confusion matrix:
      0   1
0  5956  41
1   162  99
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_16.png
better model found
persisted
after epoch: 16,now: 2024-06-02 07:03:02.000292,epoch time: 0:23:37.269044,used: 6:23:14.987627,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96999454, 'precision': 0.7677754, 'recall': 0.785653, 'specificity': 0.785653, 'f1': 0.7763941, 'auroc': 0.9604161, 'binary_precision': 0.54990464, 'binary_recall': 0.58803535, 'binary_specificity': 0.9832707, 'binary_f1_score': 0.5683312}
confusion matrix:
       0    1
0  41613  708
1    606  865
---- Validation: 
scalar performance:
{'acc': 0.96972114, 'precision': 0.77007943, 'recall': 0.78180933, 'specificity': 0.78180933, 'f1': 0.77580607, 'auroc': 0.9488304, 'binary_precision': 0.55505955, 'binary_recall': 0.5800933, 'binary_specificity': 0.9835253, 'binary_f1_score': 0.56730044}
confusion matrix:
       0    1
0  17850  299
1    270  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8129693, 'recall': 0.6291824, 'specificity': 0.6291824, 'f1': 0.6791419, 'auroc': 0.93773496, 'binary_precision': 0.6571429, 'binary_recall': 0.26436782, 'binary_specificity': 0.993997, 'binary_f1_score': 0.37704918}
confusion matrix:
      0   1
0  5961  36
1   192  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_17.png
early stop counter: 1
val acc:0.9697211384773254, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.9675615429878235 / 0.9789069890975952
after epoch: 17,now: 2024-06-02 07:26:27.216470,epoch time: 0:23:25.216178,used: 6:46:40.203805,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96857876, 'precision': 0.75693965, 'recall': 0.83751774, 'specificity': 0.83751774, 'f1': 0.7911246, 'auroc': 0.964766, 'binary_precision': 0.5245399, 'binary_recall': 0.6970109, 'binary_specificity': 0.9780246, 'binary_f1_score': 0.5985998}
confusion matrix:
       0     1
0  41390   930
1    446  1026
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.7485709, 'recall': 0.8259372, 'specificity': 0.8259372, 'f1': 0.78140604, 'auroc': 0.953601, 'binary_precision': 0.5087925, 'binary_recall': 0.6749611, 'binary_specificity': 0.97691333, 'binary_f1_score': 0.5802139}
confusion matrix:
       0    1
0  17730  419
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.8263179, 'recall': 0.71946895, 'specificity': 0.71946895, 'f1': 0.76130843, 'auroc': 0.9420269, 'binary_precision': 0.6763006, 'binary_recall': 0.44827586, 'binary_specificity': 0.990662, 'binary_f1_score': 0.5391705}
confusion matrix:
      0    1
0  5941   56
1   144  117
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_18.png
early stop counter: 2
val acc:0.9665815234184265, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.9675615429878235 / 0.9789069890975952
after epoch: 18,now: 2024-06-02 07:49:37.162160,epoch time: 0:23:09.945690,used: 7:09:50.149495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96789366, 'precision': 0.7527692, 'recall': 0.81093454, 'specificity': 0.81093454, 'f1': 0.77849984, 'auroc': 0.9621861, 'binary_precision': 0.5180723, 'binary_recall': 0.64266306, 'binary_specificity': 0.979206, 'binary_f1_score': 0.57368106}
confusion matrix:
       0    1
0  41440  880
1    526  946
---- Validation: 
scalar performance:
{'acc': 0.9686037, 'precision': 0.7609639, 'recall': 0.80298233, 'specificity': 0.80298233, 'f1': 0.78022736, 'auroc': 0.95241034, 'binary_precision': 0.5352863, 'binary_recall': 0.62519443, 'binary_specificity': 0.9807703, 'binary_f1_score': 0.57675755}
confusion matrix:
       0    1
0  17800  349
1    241  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.818278, 'recall': 0.6424256, 'specificity': 0.6424256, 'f1': 0.6934829, 'auroc': 0.9407753, 'binary_precision': 0.6666667, 'binary_recall': 0.29118773, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.40533334}
confusion matrix:
      0   1
0  5959  38
1   185  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_19.png
early stop counter: 3
val acc:0.9686036705970764, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.9675615429878235 / 0.9789069890975952
after epoch: 19,now: 2024-06-02 08:12:56.346249,epoch time: 0:23:19.184089,used: 7:33:09.333584,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96853304, 'precision': 0.7567876, 'recall': 0.81356037, 'specificity': 0.81356037, 'f1': 0.7820217, 'auroc': 0.959098, 'binary_precision': 0.5259382, 'binary_recall': 0.6474185, 'binary_specificity': 0.9797023, 'binary_f1_score': 0.5803898}
confusion matrix:
       0    1
0  41461  859
1    519  953
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7495943, 'recall': 0.8162967, 'specificity': 0.8162967, 'f1': 0.77853763, 'auroc': 0.9539245, 'binary_precision': 0.51154315, 'binary_recall': 0.6547434, 'binary_specificity': 0.97785, 'binary_f1_score': 0.574352}
confusion matrix:
       0    1
0  17747  402
1    222  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.7729798, 'recall': 0.6483376, 'specificity': 0.6483376, 'f1': 0.6900957, 'auroc': 0.9298476, 'binary_precision': 0.5755396, 'binary_recall': 0.3065134, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.4}
confusion matrix:
      0   1
0  5938  59
1   181  80
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_20.png
early stop counter: 4
val acc:0.9667943716049194, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.9675615429878235 / 0.9789069890975952
after epoch: 20,now: 2024-06-02 08:36:19.340776,epoch time: 0:23:22.994527,used: 7:56:32.328111,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96864724, 'precision': 0.7573687, 'recall': 0.8319795, 'specificity': 0.8319795, 'f1': 0.78939843, 'auroc': 0.9642614, 'binary_precision': 0.5257947, 'binary_recall': 0.68546194, 'binary_specificity': 0.97849715, 'binary_f1_score': 0.5951047}
confusion matrix:
       0     1
0  41410   910
1    463  1009
---- Validation: 
scalar performance:
{'acc': 0.9660494, 'precision': 0.74554837, 'recall': 0.8234116, 'specificity': 0.8234116, 'f1': 0.77849287, 'auroc': 0.9535563, 'binary_precision': 0.5029172, 'binary_recall': 0.6702955, 'binary_specificity': 0.97652763, 'binary_f1_score': 0.5746667}
confusion matrix:
       0    1
0  17723  426
1    212  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.82423544, 'recall': 0.6463404, 'specificity': 0.6463404, 'f1': 0.6983859, 'auroc': 0.94211924, 'binary_precision': 0.67826086, 'binary_recall': 0.29885057, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.4148936}
confusion matrix:
      0   1
0  5960  37
1   183  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_21.png
early stop counter: 5
val acc:0.9660493731498718, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.9675615429878235 / 0.9789069890975952
after epoch: 21,now: 2024-06-02 08:59:33.024644,epoch time: 0:23:13.683868,used: 8:19:46.011979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97006303, 'precision': 0.76641124, 'recall': 0.825827, 'specificity': 0.825827, 'f1': 0.7928019, 'auroc': 0.9658196, 'binary_precision': 0.5443526, 'binary_recall': 0.6711956, 'binary_specificity': 0.98045844, 'binary_f1_score': 0.601156}
confusion matrix:
       0    1
0  41493  827
1    484  988
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.755628, 'recall': 0.82657087, 'specificity': 0.82657087, 'f1': 0.7862599, 'auroc': 0.9565141, 'binary_precision': 0.5228916, 'binary_recall': 0.6749611, 'binary_specificity': 0.9781806, 'binary_f1_score': 0.58927363}
confusion matrix:
       0    1
0  17753  396
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.8406451, 'recall': 0.6993966, 'specificity': 0.6993966, 'f1': 0.7496878, 'auroc': 0.9374933, 'binary_precision': 0.70666665, 'binary_recall': 0.40613025, 'binary_specificity': 0.992663, 'binary_f1_score': 0.5158151}
confusion matrix:
      0    1
0  5953   44
1   155  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_22.png
early stop counter: 6
val acc:0.9678054451942444, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.9675615429878235 / 0.9789069890975952
after epoch: 22,now: 2024-06-02 09:22:26.066798,epoch time: 0:22:53.042154,used: 8:42:39.054133,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96526766, 'precision': 0.73945576, 'recall': 0.8501378, 'specificity': 0.8501378, 'f1': 0.78309464, 'auroc': 0.966378, 'binary_precision': 0.48857403, 'binary_recall': 0.7267165, 'binary_specificity': 0.9735592, 'binary_f1_score': 0.5843127}
confusion matrix:
       0     1
0  41202  1119
1    402  1069
---- Validation: 
scalar performance:
{'acc': 0.963708, 'precision': 0.7353281, 'recall': 0.8537017, 'specificity': 0.8537017, 'f1': 0.78105676, 'auroc': 0.955167, 'binary_precision': 0.48020303, 'binary_recall': 0.7356143, 'binary_specificity': 0.97178906, 'binary_f1_score': 0.5810811}
confusion matrix:
       0    1
0  17637  512
1    170  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.7848966, 'recall': 0.68406904, 'specificity': 0.68406904, 'f1': 0.72237873, 'auroc': 0.93403006, 'binary_precision': 0.59638554, 'binary_recall': 0.37931034, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.46370023}
confusion matrix:
      0   1
0  5930  67
1   162  99
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_23.png
early stop counter: 7
val acc:0.9637079834938049, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.9675615429878235 / 0.9789069890975952
after epoch: 23,now: 2024-06-02 09:45:09.593356,epoch time: 0:22:43.526558,used: 9:05:22.580691,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9685102, 'precision': 0.7566582, 'recall': 0.8115814, 'specificity': 0.8115814, 'f1': 0.781159, 'auroc': 0.9625888, 'binary_precision': 0.525819, 'binary_recall': 0.6433424, 'binary_specificity': 0.97982043, 'binary_f1_score': 0.5786741}
confusion matrix:
       0    1
0  41466  854
1    525  947
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.7490777, 'recall': 0.82149196, 'specificity': 0.82149196, 'f1': 0.7801291, 'auroc': 0.9567827, 'binary_precision': 0.5101311, 'binary_recall': 0.66562986, 'binary_specificity': 0.9773541, 'binary_f1_score': 0.57759786}
confusion matrix:
       0    1
0  17738  411
1    215  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.7870323, 'recall': 0.6581662, 'specificity': 0.6581662, 'f1': 0.70186704, 'auroc': 0.93044263, 'binary_precision': 0.6028369, 'binary_recall': 0.3256705, 'binary_specificity': 0.990662, 'binary_f1_score': 0.42288557}
confusion matrix:
      0   1
0  5941  56
1   176  85
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_24.png
early stop counter: 8
val acc:0.9666879773139954, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.9675615429878235 / 0.9789069890975952
after epoch: 24,now: 2024-06-02 10:07:57.177533,epoch time: 0:22:47.584177,used: 9:28:10.164868,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9686016, 'precision': 0.7570758, 'recall': 0.86408615, 'specificity': 0.86408615, 'f1': 0.80025744, 'auroc': 0.9676267, 'binary_precision': 0.52290976, 'binary_recall': 0.75203806, 'binary_specificity': 0.97613424, 'binary_f1_score': 0.6168849}
confusion matrix:
       0     1
0  41310  1010
1    365  1107
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.7476011, 'recall': 0.87072015, 'specificity': 0.87072015, 'f1': 0.79534405, 'auroc': 0.96177506, 'binary_precision': 0.5035678, 'binary_recall': 0.7682737, 'binary_specificity': 0.9731666, 'binary_f1_score': 0.6083744}
confusion matrix:
       0    1
0  17662  487
1    149  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.8314593, 'recall': 0.6990631, 'specificity': 0.6990631, 'f1': 0.74703395, 'auroc': 0.9389156, 'binary_precision': 0.6883117, 'binary_recall': 0.40613025, 'binary_specificity': 0.991996, 'binary_f1_score': 0.5108434}
confusion matrix:
      0    1
0  5949   48
1   155  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_25.png
early stop counter: 9
val acc:0.9661558270454407, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.9675615429878235 / 0.9789069890975952
after epoch: 25,now: 2024-06-02 10:30:52.249002,epoch time: 0:22:55.071469,used: 9:51:05.236337,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96666056, 'precision': 0.7454902, 'recall': 0.81587017, 'specificity': 0.81587017, 'f1': 0.77573633, 'auroc': 0.9602463, 'binary_precision': 0.5031348, 'binary_recall': 0.65421194, 'binary_specificity': 0.97752833, 'binary_f1_score': 0.5688127}
confusion matrix:
       0    1
0  41369  951
1    509  963
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.74416107, 'recall': 0.83299696, 'specificity': 0.83299696, 'f1': 0.7808857, 'auroc': 0.9599637, 'binary_precision': 0.49943757, 'binary_recall': 0.6905132, 'binary_specificity': 0.97548074, 'binary_f1_score': 0.5796345}
confusion matrix:
       0    1
0  17704  445
1    199  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.76678705, 'recall': 0.60186225, 'specificity': 0.60186225, 'f1': 0.64343226, 'auroc': 0.8991581, 'binary_precision': 0.5670103, 'binary_recall': 0.21072797, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.30726257}
confusion matrix:
      0   1
0  5955  42
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_26.png
early stop counter: 10
val acc:0.9657300710678101, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.9675615429878235 / 0.9789069890975952
after epoch: 26,now: 2024-06-02 10:53:43.648095,epoch time: 0:22:51.399093,used: 10:13:56.635430,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9682362, 'precision': 0.7550795, 'recall': 0.8599628, 'specificity': 0.8599628, 'f1': 0.797501, 'auroc': 0.9681141, 'binary_precision': 0.5192034, 'binary_recall': 0.7438859, 'binary_specificity': 0.9760397, 'binary_f1_score': 0.611561}
confusion matrix:
       0     1
0  41306  1014
1    377  1095
---- Validation: 
scalar performance:
{'acc': 0.9650915, 'precision': 0.74266803, 'recall': 0.8724193, 'specificity': 0.8724193, 'f1': 0.79208434, 'auroc': 0.962572, 'binary_precision': 0.49354517, 'binary_recall': 0.7729393, 'binary_specificity': 0.9718993, 'binary_f1_score': 0.60242426}
confusion matrix:
       0    1
0  17639  510
1    146  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.8302792, 'recall': 0.7121396, 'specificity': 0.7121396, 'f1': 0.756987, 'auroc': 0.9416768, 'binary_precision': 0.6848485, 'binary_recall': 0.4329502, 'binary_specificity': 0.991329, 'binary_f1_score': 0.53051645}
confusion matrix:
      0    1
0  5945   52
1   148  113
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_27.png
early stop counter: 11
val acc:0.9650915265083313, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.9675615429878235 / 0.9789069890975952
after epoch: 27,now: 2024-06-02 11:16:33.079271,epoch time: 0:22:49.431176,used: 10:36:46.066606,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9691725, 'precision': 0.76038283, 'recall': 0.8357536, 'specificity': 0.8357536, 'f1': 0.7927504, 'auroc': 0.970958, 'binary_precision': 0.5315597, 'binary_recall': 0.692726, 'binary_specificity': 0.9787812, 'binary_f1_score': 0.60153484}
confusion matrix:
       0     1
0  41423   898
1    452  1019
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.7456366, 'recall': 0.858554, 'specificity': 0.858554, 'f1': 0.7902038, 'auroc': 0.96231353, 'binary_precision': 0.50052357, 'binary_recall': 0.7433904, 'binary_specificity': 0.9737176, 'binary_f1_score': 0.5982479}
confusion matrix:
       0    1
0  17672  477
1    165  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.7790549, 'recall': 0.58920264, 'specificity': 0.58920264, 'f1': 0.63024735, 'auroc': 0.92699146, 'binary_precision': 0.5925926, 'binary_recall': 0.18390805, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.28070176}
confusion matrix:
      0   1
0  5964  33
1   213  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_28.png
early stop counter: 12
val acc:0.9658365249633789, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.9675615429878235 / 0.9789069890975952
after epoch: 28,now: 2024-06-02 11:39:42.340422,epoch time: 0:23:09.261151,used: 10:59:55.327757,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96768814, 'precision': 0.75225735, 'recall': 0.8655807, 'specificity': 0.8655807, 'f1': 0.79725695, 'auroc': 0.969874, 'binary_precision': 0.5131397, 'binary_recall': 0.7561141, 'binary_specificity': 0.97504723, 'binary_f1_score': 0.61137056}
confusion matrix:
       0     1
0  41264  1056
1    359  1113
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.74465823, 'recall': 0.8666668, 'specificity': 0.8666668, 'f1': 0.79192674, 'auroc': 0.960075, 'binary_precision': 0.49796334, 'binary_recall': 0.7604977, 'binary_specificity': 0.97283596, 'binary_f1_score': 0.60184616}
confusion matrix:
       0    1
0  17656  493
1    154  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.78211486, 'recall': 0.69506305, 'specificity': 0.69506305, 'f1': 0.72969913, 'auroc': 0.92963773, 'binary_precision': 0.5898876, 'binary_recall': 0.40229884, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.4783599}
confusion matrix:
      0    1
0  5924   73
1   156  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_29.png
early stop counter: 13
val acc:0.9655704498291016, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.9675615429878235 / 0.9789069890975952
after epoch: 29,now: 2024-06-02 12:02:42.551490,epoch time: 0:23:00.211068,used: 11:22:55.538825,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9687843, 'precision': 0.75810826, 'recall': 0.84582055, 'specificity': 0.84582055, 'f1': 0.79484344, 'auroc': 0.9716151, 'binary_precision': 0.52628946, 'binary_recall': 0.71399456, 'binary_specificity': 0.9776465, 'binary_f1_score': 0.6059384}
confusion matrix:
       0     1
0  41374   946
1    421  1051
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.7467382, 'recall': 0.8519412, 'specificity': 0.8519412, 'f1': 0.7889328, 'auroc': 0.9625908, 'binary_precision': 0.5032189, 'binary_recall': 0.7293935, 'binary_specificity': 0.974489, 'binary_f1_score': 0.59555554}
confusion matrix:
       0    1
0  17686  463
1    174  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.82323104, 'recall': 0.67440903, 'specificity': 0.67440903, 'f1': 0.7242935, 'auroc': 0.93160355, 'binary_precision': 0.67391306, 'binary_recall': 0.35632184, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.46616542}
confusion matrix:
      0   1
0  5952  45
1   168  93
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_30.png
early stop counter: 14
val acc:0.9661026000976562, best validation acc: 0.9698275923728943, corresponding to test acc:                         0.9675615429878235 / 0.9789069890975952
after epoch: 30,now: 2024-06-02 12:25:46.647959,epoch time: 0:23:04.096469,used: 11:45:59.635294,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_00_39_46_seed_0_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:45:59.635294 at 2024-06-02 12:25:46.647959
persisted model performance metric: 

scalar performance:
{'acc': 0.9696389, 'precision': 0.8510101, 'recall': 0.71480566, 'specificity': 0.71480566, 'f1': 0.7648747, 'auroc': 0.9410862, 'binary_precision': 0.72611463, 'binary_recall': 0.43678162, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.5454545}
confusion matrix:
      0    1
0  5954   43
1   147  114
oracle model performance metric: 

scalar performance:
{'acc': 0.978907, 'precision': 0.8926361, 'recall': 0.82591677, 'specificity': 0.82591677, 'f1': 0.8558628, 'auroc': 0.9195894, 'binary_precision': 0.8, 'binary_recall': 0.65900385, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.72268903}
confusion matrix:
      0    1
0  5954   43
1    89  172
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/rule_results/9.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493147 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool | 403328 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |  89819 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 493147 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool | 403328 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |  89819 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476573 KiB |  10880 MiB |    898 TiB |    898 TiB |
|       from large pool | 387840 KiB |  10808 MiB |    895 TiB |    895 TiB |
|       from small pool |  88733 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11482 MiB |  11482 MiB |  11482 MiB |      0 B   |
|       from large pool |  11356 MiB |  11356 MiB |  11356 MiB |      0 B   |
|       from small pool |    126 MiB |    126 MiB |    126 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 752036 KiB |   1325 MiB | 384643 GiB | 384643 GiB |
|       from large pool | 741504 KiB |   1322 MiB | 381642 GiB | 381641 GiB |
|       from small pool |  10532 KiB |     11 MiB |   3001 GiB |   3001 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3729    |    6720    |  139731 K  |  139727 K  |
|       from large pool |      87    |     908    |   56777 K  |   56777 K  |
|       from small pool |    3642    |    6631    |   82953 K  |   82949 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3729    |    6720    |  139731 K  |  139727 K  |
|       from large pool |      87    |     908    |   56777 K  |   56777 K  |
|       from small pool |    3642    |    6631    |   82953 K  |   82949 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     404    |     404    |     404    |       0    |
|       from large pool |     341    |     341    |     341    |       0    |
|       from small pool |      63    |      63    |      63    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |    2767    |   74907 K  |   74907 K  |
|       from large pool |      19    |     187    |   34810 K  |   34810 K  |
|       from small pool |      56    |    2747    |   40097 K  |   40097 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |    898 TiB |    898 TiB |
|       from large pool |  16640 KiB |  10808 MiB |    895 TiB |    895 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11482 MiB |  11482 MiB |  10266 MiB |
|       from large pool |   1118 MiB |  11356 MiB |  11356 MiB |  10238 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB | 384644 GiB | 384644 GiB |
|       from large pool |  50944 KiB |   1322 MiB | 381642 GiB | 381642 GiB |
|       from small pool |      0 KiB |     24 MiB |   3001 GiB |   3001 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  139731 K  |  139731 K  |
|       from large pool |       2    |     908    |   56777 K  |   56777 K  |
|       from small pool |       0    |    6631    |   82953 K  |   82953 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  139731 K  |  139731 K  |
|       from large pool |       2    |     908    |   56777 K  |   56777 K  |
|       from small pool |       0    |    6631    |   82953 K  |   82953 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     404    |     404    |     325    |
|       from large pool |      30    |     341    |     341    |     311    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2767    |   74909 K  |   74909 K  |
|       from large pool |       4    |     187    |   34810 K  |   34810 K  |
|       from small pool |       0    |    2747    |   40098 K  |   40098 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |    907 TiB |    907 TiB |
|       from large pool |  16640 KiB |  10925 MiB |    904 TiB |    904 TiB |
|       from small pool |      0 KiB |    125 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |    898 TiB |    898 TiB |
|       from large pool |  16640 KiB |  10808 MiB |    895 TiB |    895 TiB |
|       from small pool |      0 KiB |    124 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1216 MiB |  11482 MiB |  11482 MiB |  10266 MiB |
|       from large pool |   1118 MiB |  11356 MiB |  11356 MiB |  10238 MiB |
|       from small pool |     98 MiB |    126 MiB |    126 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB | 384644 GiB | 384644 GiB |
|       from large pool |  50944 KiB |   1322 MiB | 381642 GiB | 381642 GiB |
|       from small pool |      0 KiB |     24 MiB |   3001 GiB |   3001 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6720    |  139731 K  |  139731 K  |
|       from large pool |       2    |     908    |   56777 K  |   56777 K  |
|       from small pool |       0    |    6631    |   82953 K  |   82953 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6720    |  139731 K  |  139731 K  |
|       from large pool |       2    |     908    |   56777 K  |   56777 K  |
|       from small pool |       0    |    6631    |   82953 K  |   82953 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |     404    |     404    |     325    |
|       from large pool |      30    |     341    |     341    |     311    |
|       from small pool |      49    |      63    |      63    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2767    |   74909 K  |   74909 K  |
|       from large pool |       4    |     187    |   34810 K  |   34810 K  |
|       from small pool |       0    |    2747    |   40098 K  |   40098 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734

 Experiment start at: 2024-06-02 12:36:40.274453
before training, model accuracy: 0.09474702179431915
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9674389, 'precision': 0.7528962, 'recall': 0.5346651, 'specificity': 0.5346651, 'f1': 0.5547407, 'auroc': 0.89056945, 'binary_precision': 0.5364583, 'binary_recall': 0.071428575, 'binary_specificity': 0.9979016, 'binary_f1_score': 0.12607099}
confusion matrix:
       0    1
0  42325   89
1   1339  103
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.72276354, 'recall': 0.5534513, 'specificity': 0.5534513, 'f1': 0.5810845, 'auroc': 0.8940667, 'binary_precision': 0.477707, 'binary_recall': 0.11144131, 'binary_specificity': 0.99546134, 'binary_f1_score': 0.18072289}
confusion matrix:
       0   1
0  17985  82
1    598  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.88872266, 'recall': 0.56663495, 'specificity': 0.56663495, 'f1': 0.60589063, 'auroc': 0.883528, 'binary_precision': 0.81395346, 'binary_recall': 0.13461539, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.23102313}
confusion matrix:
      0   1
0  5938   8
1   225  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-02 13:01:06.675888,epoch time: 0:24:26.401435,used: 0:24:26.401435,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9660936, 'precision': 0.7198538, 'recall': 0.6026348, 'specificity': 0.6026348, 'f1': 0.63777256, 'auroc': 0.91516614, 'binary_precision': 0.46596065, 'binary_recall': 0.21359223, 'binary_specificity': 0.9916773, 'binary_f1_score': 0.29291487}
confusion matrix:
       0    1
0  42061  353
1   1134  308
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.7445855, 'recall': 0.6877321, 'specificity': 0.6877321, 'f1': 0.7119911, 'auroc': 0.91316116, 'binary_precision': 0.51171875, 'binary_recall': 0.38930163, 'binary_specificity': 0.9861626, 'binary_f1_score': 0.44219407}
confusion matrix:
       0    1
0  17817  250
1    411  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97019017, 'precision': 0.89417386, 'recall': 0.68468845, 'specificity': 0.68468845, 'f1': 0.7482495, 'auroc': 0.9010037, 'binary_precision': 0.81512606, 'binary_recall': 0.37307692, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.51187336}
confusion matrix:
      0   1
0  5924  22
1   163  97
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-02 13:24:07.220236,epoch time: 0:23:00.544348,used: 0:47:26.945783,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96581995, 'precision': 0.7299923, 'recall': 0.71470225, 'specificity': 0.71470225, 'f1': 0.7220545, 'auroc': 0.9290234, 'binary_precision': 0.47877884, 'binary_recall': 0.44590846, 'binary_specificity': 0.983496, 'binary_f1_score': 0.46175942}
confusion matrix:
       0    1
0  41714  700
1    799  643
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.74541044, 'recall': 0.76709914, 'specificity': 0.76709914, 'f1': 0.7557387, 'auroc': 0.92560697, 'binary_precision': 0.507483, 'binary_recall': 0.55423474, 'binary_specificity': 0.9799635, 'binary_f1_score': 0.52982956}
confusion matrix:
       0    1
0  17705  362
1    300  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9740574, 'precision': 0.87131304, 'recall': 0.773139, 'specificity': 0.773139, 'f1': 0.8139837, 'auroc': 0.9243467, 'binary_precision': 0.7619048, 'binary_recall': 0.5538462, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.64142543}
confusion matrix:
      0    1
0  5901   45
1   116  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_3.png
new oracle model saved
early stop counter: 1
val acc:0.9646744728088379, best validation acc: 0.9647278785705566, corresponding to test acc:                         0.970190167427063 / 0.9740573763847351
after epoch: 3,now: 2024-06-02 13:47:13.873028,epoch time: 0:23:06.652792,used: 1:10:33.598575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96693724, 'precision': 0.7381911, 'recall': 0.6941779, 'specificity': 0.6941779, 'f1': 0.71370304, 'auroc': 0.9352141, 'binary_precision': 0.49657536, 'binary_recall': 0.40221915, 'binary_specificity': 0.9861367, 'binary_f1_score': 0.44444442}
confusion matrix:
       0    1
0  41826  588
1    862  580
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.7537222, 'recall': 0.75843716, 'specificity': 0.75843716, 'f1': 0.75605536, 'auroc': 0.93120384, 'binary_precision': 0.52478135, 'binary_recall': 0.53491825, 'binary_specificity': 0.98195606, 'binary_f1_score': 0.5298013}
confusion matrix:
       0    1
0  17741  326
1    313  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97550756, 'precision': 0.8724846, 'recall': 0.7978027, 'specificity': 0.7978027, 'f1': 0.8305479, 'auroc': 0.9282316, 'binary_precision': 0.7621359, 'binary_recall': 0.60384613, 'binary_specificity': 0.9917592, 'binary_f1_score': 0.6738197}
confusion matrix:
      0    1
0  5897   49
1   103  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-02 14:10:26.782889,epoch time: 0:23:12.909861,used: 1:33:46.508436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9675301, 'precision': 0.74469906, 'recall': 0.7433874, 'specificity': 0.7433874, 'f1': 0.74404126, 'auroc': 0.94188786, 'binary_precision': 0.50627613, 'binary_recall': 0.5034674, 'binary_specificity': 0.9833074, 'binary_f1_score': 0.50486785}
confusion matrix:
       0    1
0  41706  708
1    716  726
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.7491994, 'recall': 0.7909797, 'specificity': 0.7909797, 'f1': 0.76827085, 'auroc': 0.9375923, 'binary_precision': 0.5132743, 'binary_recall': 0.6032689, 'binary_specificity': 0.97869045, 'binary_f1_score': 0.55464476}
confusion matrix:
       0    1
0  17682  385
1    267  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9747019, 'precision': 0.86031497, 'recall': 0.8028992, 'specificity': 0.8028992, 'f1': 0.8288525, 'auroc': 0.92353034, 'binary_precision': 0.7373272, 'binary_recall': 0.61538464, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.6708596}
confusion matrix:
      0    1
0  5889   57
1   100  160
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_5.png
early stop counter: 1
val acc:0.965208113193512, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9755075573921204 / 0.9755075573921204
after epoch: 5,now: 2024-06-02 14:33:47.737505,epoch time: 0:23:20.954616,used: 1:57:07.463052,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96782655, 'precision': 0.74751097, 'recall': 0.7783757, 'specificity': 0.7783757, 'f1': 0.7619351, 'auroc': 0.94390213, 'binary_precision': 0.50951505, 'binary_recall': 0.5755895, 'binary_specificity': 0.9811619, 'binary_f1_score': 0.5405406}
confusion matrix:
       0    1
0  41615  799
1    612  830
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.74484265, 'recall': 0.8212657, 'specificity': 0.8212657, 'f1': 0.7772206, 'auroc': 0.942444, 'binary_precision': 0.50223714, 'binary_recall': 0.66716194, 'binary_specificity': 0.97536945, 'binary_f1_score': 0.5730696}
confusion matrix:
       0    1
0  17622  445
1    224  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9730905, 'precision': 0.84747887, 'recall': 0.7947023, 'specificity': 0.7947023, 'f1': 0.8186811, 'auroc': 0.93032503, 'binary_precision': 0.7123288, 'binary_recall': 0.6, 'binary_specificity': 0.9894046, 'binary_f1_score': 0.651357}
confusion matrix:
      0    1
0  5883   63
1   104  156
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_6.png
early stop counter: 2
val acc:0.9643009901046753, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9755075573921204 / 0.9755075573921204
after epoch: 6,now: 2024-06-02 14:57:02.270680,epoch time: 0:23:14.533175,used: 2:20:21.996227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9674845, 'precision': 0.74467945, 'recall': 0.7577667, 'specificity': 0.7577667, 'f1': 0.75103354, 'auroc': 0.9483801, 'binary_precision': 0.50525624, 'binary_recall': 0.5332871, 'binary_specificity': 0.9822464, 'binary_f1_score': 0.5188934}
confusion matrix:
       0    1
0  41661  753
1    673  769
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.7458814, 'recall': 0.7864113, 'specificity': 0.7864113, 'f1': 0.764408, 'auroc': 0.9415379, 'binary_precision': 0.5069708, 'binary_recall': 0.5943536, 'binary_specificity': 0.978469, 'binary_f1_score': 0.54719555}
confusion matrix:
       0    1
0  17678  389
1    273  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.973574, 'precision': 0.85338783, 'recall': 0.7931156, 'specificity': 0.7931156, 'f1': 0.8201354, 'auroc': 0.93502676, 'binary_precision': 0.7242991, 'binary_recall': 0.59615386, 'binary_specificity': 0.9900774, 'binary_f1_score': 0.65400845}
confusion matrix:
      0    1
0  5887   59
1   105  155
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_7.png
early stop counter: 3
val acc:0.9646744728088379, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9755075573921204 / 0.9755075573921204
after epoch: 7,now: 2024-06-02 15:20:12.522605,epoch time: 0:23:10.251925,used: 2:43:32.248152,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96707404, 'precision': 0.7415809, 'recall': 0.75353515, 'specificity': 0.75353515, 'f1': 0.74739736, 'auroc': 0.95084715, 'binary_precision': 0.49934036, 'binary_recall': 0.52496535, 'binary_specificity': 0.98210496, 'binary_f1_score': 0.5118323}
confusion matrix:
       0    1
0  41655  759
1    685  757
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.74761426, 'recall': 0.79227185, 'specificity': 0.79227185, 'f1': 0.76786244, 'auroc': 0.9430662, 'binary_precision': 0.51, 'binary_recall': 0.6062407, 'binary_specificity': 0.97830296, 'binary_f1_score': 0.5539714}
confusion matrix:
       0    1
0  17675  392
1    265  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97534645, 'precision': 0.8730278, 'recall': 0.79404056, 'specificity': 0.79404056, 'f1': 0.828371, 'auroc': 0.9367552, 'binary_precision': 0.7635468, 'binary_recall': 0.59615386, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.6695464}
confusion matrix:
      0    1
0  5898   48
1   105  155
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_8.png
early stop counter: 4
val acc:0.9649413228034973, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9755075573921204 / 0.9755075573921204
after epoch: 8,now: 2024-06-02 15:43:14.879260,epoch time: 0:23:02.356655,used: 3:06:34.604807,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9673933, 'precision': 0.7456479, 'recall': 0.8156663, 'specificity': 0.8156663, 'f1': 0.77577686, 'auroc': 0.95588565, 'binary_precision': 0.5032051, 'binary_recall': 0.65325934, 'binary_specificity': 0.9780733, 'binary_f1_score': 0.56849724}
confusion matrix:
       0    1
0  41484  930
1    500  942
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.7497233, 'recall': 0.83601385, 'specificity': 0.83601385, 'f1': 0.78568566, 'auroc': 0.95084345, 'binary_precision': 0.5108932, 'binary_recall': 0.6968796, 'binary_specificity': 0.9751481, 'binary_f1_score': 0.5895663}
confusion matrix:
       0    1
0  17618  449
1    204  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9729294, 'precision': 0.83261687, 'recall': 0.82772, 'specificity': 0.82772, 'f1': 0.8301481, 'auroc': 0.92840517, 'binary_precision': 0.6796875, 'binary_recall': 0.66923076, 'binary_specificity': 0.9862092, 'binary_f1_score': 0.6744186}
confusion matrix:
      0    1
0  5864   82
1    86  174
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_9.png
early stop counter: 5
val acc:0.965154767036438, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9755075573921204 / 0.9755075573921204
after epoch: 9,now: 2024-06-02 16:06:38.440934,epoch time: 0:23:23.561674,used: 3:29:58.166481,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96812296, 'precision': 0.7496569, 'recall': 0.7879076, 'specificity': 0.7879076, 'f1': 0.7672673, 'auroc': 0.95644623, 'binary_precision': 0.5131579, 'binary_recall': 0.59500694, 'binary_specificity': 0.9808082, 'binary_f1_score': 0.5510598}
confusion matrix:
       0    1
0  41600  814
1    584  858
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.7471926, 'recall': 0.801515, 'specificity': 0.801515, 'f1': 0.77132154, 'auroc': 0.9473312, 'binary_precision': 0.5084541, 'binary_recall': 0.6255572, 'binary_specificity': 0.9774727, 'binary_f1_score': 0.56095934}
confusion matrix:
       0    1
0  17660  407
1    252  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97260714, 'precision': 0.8452351, 'recall': 0.78893304, 'specificity': 0.78893304, 'f1': 0.8143072, 'auroc': 0.94824386, 'binary_precision': 0.7083333, 'binary_recall': 0.5884615, 'binary_specificity': 0.9894046, 'binary_f1_score': 0.6428571}
confusion matrix:
      0    1
0  5883   63
1   107  153
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_10.png
early stop counter: 6
val acc:0.9648345708847046, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9755075573921204 / 0.9755075573921204
after epoch: 10,now: 2024-06-02 16:30:24.520370,epoch time: 0:23:46.079436,used: 3:53:44.245917,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96684605, 'precision': 0.7427385, 'recall': 0.8224174, 'specificity': 0.8224174, 'f1': 0.7762906, 'auroc': 0.96145964, 'binary_precision': 0.49690402, 'binary_recall': 0.6678225, 'binary_specificity': 0.97701234, 'binary_f1_score': 0.5698225}
confusion matrix:
       0    1
0  41439  975
1    479  963
---- Validation: 
scalar performance:
{'acc': 0.9630736, 'precision': 0.73822546, 'recall': 0.8149071, 'specificity': 0.8149071, 'f1': 0.77054155, 'auroc': 0.94991446, 'binary_precision': 0.48945615, 'binary_recall': 0.65527487, 'binary_specificity': 0.9745392, 'binary_f1_score': 0.5603557}
confusion matrix:
       0    1
0  17607  460
1    232  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9734128, 'precision': 0.84083605, 'recall': 0.81693834, 'specificity': 0.81693834, 'f1': 0.828403, 'auroc': 0.9592197, 'binary_precision': 0.69709545, 'binary_recall': 0.64615387, 'binary_specificity': 0.9877228, 'binary_f1_score': 0.6706587}
confusion matrix:
      0    1
0  5873   73
1    92  168
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_11.png
early stop counter: 7
val acc:0.9630736112594604, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9755075573921204 / 0.9755075573921204
after epoch: 11,now: 2024-06-02 16:54:18.800695,epoch time: 0:23:54.280325,used: 4:17:38.526242,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96962786, 'precision': 0.7619951, 'recall': 0.74581176, 'specificity': 0.74581176, 'f1': 0.75361866, 'auroc': 0.96098495, 'binary_precision': 0.5407407, 'binary_recall': 0.5062413, 'binary_specificity': 0.9853822, 'binary_f1_score': 0.52292264}
confusion matrix:
       0    1
0  41794  620
1    712  730
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.74072313, 'recall': 0.7759825, 'specificity': 0.7759825, 'f1': 0.7569959, 'auroc': 0.94971853, 'binary_precision': 0.4974227, 'binary_recall': 0.57355124, 'binary_specificity': 0.9784137, 'binary_f1_score': 0.53278124}
confusion matrix:
       0    1
0  17677  390
1    287  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9708347, 'precision': 0.88800615, 'recall': 0.6997367, 'specificity': 0.6997367, 'f1': 0.76101375, 'auroc': 0.93348646, 'binary_precision': 0.8015267, 'binary_recall': 0.40384614, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.5370844}
confusion matrix:
      0    1
0  5920   26
1   155  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_12.png
early stop counter: 8
val acc:0.9638740420341492, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9755075573921204 / 0.9755075573921204
after epoch: 12,now: 2024-06-02 17:17:54.747286,epoch time: 0:23:35.946591,used: 4:41:14.472833,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9684194, 'precision': 0.7515311, 'recall': 0.78959644, 'specificity': 0.78959644, 'f1': 0.76907426, 'auroc': 0.9615197, 'binary_precision': 0.5167866, 'binary_recall': 0.5981957, 'binary_specificity': 0.98099726, 'binary_f1_score': 0.5545191}
confusion matrix:
       0    1
0  41609  806
1    579  862
---- Validation: 
scalar performance:
{'acc': 0.9635539, 'precision': 0.73995376, 'recall': 0.79942024, 'specificity': 0.79942024, 'f1': 0.76597977, 'auroc': 0.9526873, 'binary_precision': 0.49410376, 'binary_recall': 0.6225854, 'binary_specificity': 0.97625506, 'binary_f1_score': 0.5509533}
confusion matrix:
       0    1
0  17638  429
1    254  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705124, 'precision': 0.83483255, 'recall': 0.76393306, 'specificity': 0.76393306, 'f1': 0.79471827, 'auroc': 0.9490208, 'binary_precision': 0.6896552, 'binary_recall': 0.53846157, 'binary_specificity': 0.9894046, 'binary_f1_score': 0.60475165}
confusion matrix:
      0    1
0  5883   63
1   120  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_13.png
early stop counter: 9
val acc:0.9635539054870605, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9755075573921204 / 0.9755075573921204
after epoch: 13,now: 2024-06-02 17:41:25.777497,epoch time: 0:23:31.030211,used: 5:04:45.503044,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96946824, 'precision': 0.7590937, 'recall': 0.7869283, 'specificity': 0.7869283, 'f1': 0.77222395, 'auroc': 0.96131074, 'binary_precision': 0.53212726, 'binary_recall': 0.5915395, 'binary_specificity': 0.98231715, 'binary_f1_score': 0.56026274}
confusion matrix:
       0    1
0  41664  750
1    589  853
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.74238694, 'recall': 0.76828057, 'specificity': 0.76828057, 'f1': 0.75459445, 'auroc': 0.9509827, 'binary_precision': 0.5013369, 'binary_recall': 0.5572065, 'binary_specificity': 0.9793546, 'binary_f1_score': 0.5277973}
confusion matrix:
       0    1
0  17694  373
1    298  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97454077, 'precision': 0.8638432, 'recall': 0.7936201, 'specificity': 0.7936201, 'f1': 0.82458234, 'auroc': 0.93836594, 'binary_precision': 0.7451923, 'binary_recall': 0.59615386, 'binary_specificity': 0.9910864, 'binary_f1_score': 0.66239315}
confusion matrix:
      0    1
0  5893   53
1   105  155
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_14.png
early stop counter: 10
val acc:0.9641942381858826, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9755075573921204 / 0.9755075573921204
after epoch: 14,now: 2024-06-02 18:05:10.275392,epoch time: 0:23:44.497895,used: 5:28:30.000939,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9684194, 'precision': 0.7516651, 'recall': 0.786721, 'specificity': 0.786721, 'f1': 0.7679236, 'auroc': 0.9646339, 'binary_precision': 0.5172623, 'binary_recall': 0.592233, 'binary_specificity': 0.98120904, 'binary_f1_score': 0.5522147}
confusion matrix:
       0    1
0  41617  797
1    588  854
---- Validation: 
scalar performance:
{'acc': 0.9630736, 'precision': 0.73707366, 'recall': 0.7941643, 'specificity': 0.7941643, 'f1': 0.76214707, 'auroc': 0.95383686, 'binary_precision': 0.48873073, 'binary_recall': 0.6121842, 'binary_specificity': 0.9761444, 'binary_f1_score': 0.5435356}
confusion matrix:
       0    1
0  17636  431
1    261  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693845, 'precision': 0.83406585, 'recall': 0.73943764, 'specificity': 0.73943764, 'f1': 0.7780982, 'auroc': 0.9527958, 'binary_precision': 0.6902174, 'binary_recall': 0.48846152, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.5720721}
confusion matrix:
      0    1
0  5889   57
1   133  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_15.png
early stop counter: 11
val acc:0.9630736112594604, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9755075573921204 / 0.9755075573921204
after epoch: 15,now: 2024-06-02 18:28:48.044295,epoch time: 0:23:37.768903,used: 5:52:07.769842,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96810013, 'precision': 0.7494587, 'recall': 0.7838764, 'specificity': 0.7838764, 'f1': 0.7654316, 'auroc': 0.9616714, 'binary_precision': 0.5130382, 'binary_recall': 0.5866852, 'binary_specificity': 0.9810676, 'binary_f1_score': 0.5473957}
confusion matrix:
       0    1
0  41611  803
1    596  846
---- Validation: 
scalar performance:
{'acc': 0.96574175, 'precision': 0.752488, 'recall': 0.7905412, 'specificity': 0.7905412, 'f1': 0.77001584, 'auroc': 0.95497036, 'binary_precision': 0.5198973, 'binary_recall': 0.60178304, 'binary_specificity': 0.97929925, 'binary_f1_score': 0.55785125}
confusion matrix:
       0    1
0  17693  374
1    268  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970029, 'precision': 0.8417423, 'recall': 0.739774, 'specificity': 0.739774, 'f1': 0.7808683, 'auroc': 0.94972026, 'binary_precision': 0.70555556, 'binary_recall': 0.48846152, 'binary_specificity': 0.9910864, 'binary_f1_score': 0.5772727}
confusion matrix:
      0    1
0  5893   53
1   133  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_16.png
early stop counter: 12
val acc:0.965741753578186, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9755075573921204 / 0.9755075573921204
after epoch: 16,now: 2024-06-02 18:52:10.736825,epoch time: 0:23:22.692530,used: 6:15:30.462372,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9693543, 'precision': 0.7576045, 'recall': 0.83778214, 'specificity': 0.83778214, 'f1': 0.79167616, 'auroc': 0.967831, 'binary_precision': 0.5256276, 'binary_recall': 0.6969487, 'binary_specificity': 0.9786155, 'binary_f1_score': 0.5992844}
confusion matrix:
       0     1
0  41507   907
1    437  1005
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.74494207, 'recall': 0.8241268, 'specificity': 0.8241268, 'f1': 0.7783028, 'auroc': 0.9589107, 'binary_precision': 0.5022173, 'binary_recall': 0.6731055, 'binary_specificity': 0.9751481, 'binary_f1_score': 0.5752381}
confusion matrix:
       0    1
0  17618  449
1    220  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97164035, 'precision': 0.85484344, 'recall': 0.7516488, 'specificity': 0.7516488, 'f1': 0.79355323, 'auroc': 0.9549623, 'binary_precision': 0.7307692, 'binary_recall': 0.51153845, 'binary_specificity': 0.9917592, 'binary_f1_score': 0.6018099}
confusion matrix:
      0    1
0  5897   49
1   127  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_17.png
early stop counter: 13
val acc:0.9643009901046753, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9755075573921204 / 0.9755075573921204
after epoch: 17,now: 2024-06-02 19:15:42.394965,epoch time: 0:23:31.658140,used: 6:39:02.120512,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96727926, 'precision': 0.7451261, 'recall': 0.8202967, 'specificity': 0.8202967, 'f1': 0.77712417, 'auroc': 0.96492255, 'binary_precision': 0.50183725, 'binary_recall': 0.6629681, 'binary_specificity': 0.9776253, 'binary_f1_score': 0.5712578}
confusion matrix:
       0    1
0  41465  949
1    486  956
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.740446, 'recall': 0.80373955, 'specificity': 0.80373955, 'f1': 0.76792926, 'auroc': 0.95306003, 'binary_precision': 0.49476135, 'binary_recall': 0.6315007, 'binary_specificity': 0.9759783, 'binary_f1_score': 0.5548303}
confusion matrix:
       0    1
0  17633  434
1    248  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97196263, 'precision': 0.8601694, 'recall': 0.74997807, 'specificity': 0.74997807, 'f1': 0.79410416, 'auroc': 0.95652413, 'binary_precision': 0.74157304, 'binary_recall': 0.50769234, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.60273975}
confusion matrix:
      0    1
0  5900   46
1   128  132
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_18.png
early stop counter: 14
val acc:0.9636072516441345, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9755075573921204 / 0.9755075573921204
after epoch: 18,now: 2024-06-02 19:39:16.503116,epoch time: 0:23:34.108151,used: 7:02:36.228663,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96810013, 'precision': 0.7502429, 'recall': 0.8367988, 'specificity': 0.8367988, 'f1': 0.7863902, 'auroc': 0.96824217, 'binary_precision': 0.5109415, 'binary_recall': 0.6962552, 'binary_specificity': 0.97734237, 'binary_f1_score': 0.58937484}
confusion matrix:
       0     1
0  41453   961
1    438  1004
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.7494823, 'recall': 0.8245696, 'specificity': 0.8245696, 'f1': 0.78148144, 'auroc': 0.9552275, 'binary_precision': 0.5112867, 'binary_recall': 0.6731055, 'binary_specificity': 0.9760336, 'binary_f1_score': 0.5811417}
confusion matrix:
       0    1
0  17634  433
1    220  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96809536, 'precision': 0.8393374, 'recall': 0.7019852, 'specificity': 0.7019852, 'f1': 0.75145876, 'auroc': 0.93926233, 'binary_precision': 0.70394737, 'binary_recall': 0.41153845, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.51941746}
confusion matrix:
      0    1
0  5901   45
1   153  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_19.png
early stop counter: 15
val acc:0.965154767036438, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9755075573921204 / 0.9755075573921204
after epoch: 19,now: 2024-06-02 20:02:42.119808,epoch time: 0:23:25.616692,used: 7:26:01.845355,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9685334, 'precision': 0.75303936, 'recall': 0.8614743, 'specificity': 0.8614743, 'f1': 0.7965569, 'auroc': 0.9666071, 'binary_precision': 0.5148184, 'binary_recall': 0.74687934, 'binary_specificity': 0.9760692, 'binary_f1_score': 0.6095076}
confusion matrix:
       0     1
0  41399  1015
1    365  1077
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.74477965, 'recall': 0.84192544, 'specificity': 0.84192544, 'f1': 0.78424, 'auroc': 0.9549825, 'binary_precision': 0.50052357, 'binary_recall': 0.7102526, 'binary_specificity': 0.9735983, 'binary_f1_score': 0.58722365}
confusion matrix:
       0    1
0  17590  477
1    195  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.972446, 'precision': 0.85011065, 'recall': 0.77597606, 'specificity': 0.77597606, 'f1': 0.8081794, 'auroc': 0.9511603, 'binary_precision': 0.7192118, 'binary_recall': 0.56153846, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.63066953}
confusion matrix:
      0    1
0  5889   57
1   114  146
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_20.png
early stop counter: 16
val acc:0.9641408920288086, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9755075573921204 / 0.9755075573921204
after epoch: 20,now: 2024-06-02 20:26:06.876895,epoch time: 0:23:24.757087,used: 7:49:26.602442,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9676897, 'precision': 0.7480588, 'recall': 0.8419458, 'specificity': 0.8419458, 'f1': 0.78664446, 'auroc': 0.96637666, 'binary_precision': 0.5062035, 'binary_recall': 0.7073509, 'binary_specificity': 0.97654074, 'binary_f1_score': 0.590107}
confusion matrix:
       0     1
0  41419   995
1    422  1020
---- Validation: 
scalar performance:
{'acc': 0.9632337, 'precision': 0.7401809, 'recall': 0.8371633, 'specificity': 0.8371633, 'f1': 0.7794283, 'auroc': 0.9549153, 'binary_precision': 0.49166667, 'binary_recall': 0.7013373, 'binary_specificity': 0.97298944, 'binary_f1_score': 0.5780772}
confusion matrix:
       0    1
0  17579  488
1    201  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9734128, 'precision': 0.8610726, 'recall': 0.7764807, 'specificity': 0.7764807, 'f1': 0.81257397, 'auroc': 0.9503697, 'binary_precision': 0.74111676, 'binary_recall': 0.56153846, 'binary_specificity': 0.99142283, 'binary_f1_score': 0.6389497}
confusion matrix:
      0    1
0  5895   51
1   114  146
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_21.png
early stop counter: 17
val acc:0.9632337093353271, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9755075573921204 / 0.9755075573921204
after epoch: 21,now: 2024-06-02 20:49:20.083032,epoch time: 0:23:13.206137,used: 8:12:39.808579,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97065395, 'precision': 0.76693594, 'recall': 0.80730355, 'specificity': 0.80730355, 'f1': 0.785547, 'auroc': 0.9654417, 'binary_precision': 0.546435, 'binary_recall': 0.63245493, 'binary_specificity': 0.9821521, 'binary_f1_score': 0.58630663}
confusion matrix:
       0    1
0  41657  757
1    530  912
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.7496029, 'recall': 0.79672945, 'specificity': 0.79672945, 'f1': 0.7708774, 'auroc': 0.9534813, 'binary_precision': 0.5136476, 'binary_recall': 0.615156, 'binary_specificity': 0.97830296, 'binary_f1_score': 0.5598377}
confusion matrix:
       0    1
0  17675  392
1    259  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687399, 'precision': 0.8635919, 'recall': 0.68577063, 'specificity': 0.68577063, 'f1': 0.74321353, 'auroc': 0.94450426, 'binary_precision': 0.75384617, 'binary_recall': 0.37692308, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.50256413}
confusion matrix:
      0   1
0  5914  32
1   162  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_22.png
early stop counter: 18
val acc:0.9652614593505859, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9755075573921204 / 0.9755075573921204
after epoch: 22,now: 2024-06-02 21:12:35.729641,epoch time: 0:23:15.646609,used: 8:35:55.455188,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9676213, 'precision': 0.74833727, 'recall': 0.8656921, 'specificity': 0.8656921, 'f1': 0.794446, 'auroc': 0.97157013, 'binary_precision': 0.5050926, 'binary_recall': 0.7565881, 'binary_specificity': 0.97479606, 'binary_f1_score': 0.6057746}
confusion matrix:
       0     1
0  41345  1069
1    351  1091
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.7428857, 'recall': 0.84599566, 'specificity': 0.84599566, 'f1': 0.78420067, 'auroc': 0.9582024, 'binary_precision': 0.49641025, 'binary_recall': 0.7191679, 'binary_specificity': 0.9728234, 'binary_f1_score': 0.5873787}
confusion matrix:
       0    1
0  17576  491
1    189  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692233, 'precision': 0.8286515, 'recall': 0.74670947, 'specificity': 0.74670947, 'f1': 0.7811976, 'auroc': 0.95151365, 'binary_precision': 0.6787565, 'binary_recall': 0.50384617, 'binary_specificity': 0.9895728, 'binary_f1_score': 0.57836646}
confusion matrix:
      0    1
0  5884   62
1   129  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_23.png
early stop counter: 19
val acc:0.9637140035629272, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9755075573921204 / 0.9755075573921204
after epoch: 23,now: 2024-06-02 21:36:15.686734,epoch time: 0:23:39.957093,used: 8:59:35.412281,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9678037, 'precision': 0.74931973, 'recall': 0.86746114, 'specificity': 0.86746114, 'f1': 0.7957126, 'auroc': 0.97098255, 'binary_precision': 0.50693804, 'binary_recall': 0.7600555, 'binary_specificity': 0.9748668, 'binary_f1_score': 0.60821307}
confusion matrix:
       0     1
0  41348  1066
1    346  1096
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.7459574, 'recall': 0.84561247, 'specificity': 0.84561247, 'f1': 0.786276, 'auroc': 0.9586313, 'binary_precision': 0.50260144, 'binary_recall': 0.717682, 'binary_specificity': 0.9735429, 'binary_f1_score': 0.5911872}
confusion matrix:
       0    1
0  17589  478
1    190  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9666452, 'precision': 0.80855525, 'recall': 0.7269741, 'specificity': 0.7269741, 'f1': 0.76083606, 'auroc': 0.95103395, 'binary_precision': 0.64021164, 'binary_recall': 0.4653846, 'binary_specificity': 0.9885637, 'binary_f1_score': 0.5389755}
confusion matrix:
      0    1
0  5878   68
1   139  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_24.png
early stop counter: 20
val acc:0.9643543362617493, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9755075573921204 / 0.9755075573921204
after epoch: 24,now: 2024-06-02 22:00:10.925164,epoch time: 0:23:55.238430,used: 9:23:30.650711,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.968465, 'precision': 0.75293934, 'recall': 0.8781865, 'specificity': 0.8781865, 'f1': 0.801646, 'auroc': 0.97247726, 'binary_precision': 0.51343966, 'binary_recall': 0.7815534, 'binary_specificity': 0.97481966, 'binary_f1_score': 0.61974156}
confusion matrix:
       0     1
0  41346  1068
1    315  1127
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.7449559, 'recall': 0.8775504, 'specificity': 0.8775504, 'f1': 0.79520464, 'auroc': 0.9590372, 'binary_precision': 0.49811321, 'binary_recall': 0.7845468, 'binary_specificity': 0.97055405, 'binary_f1_score': 0.60934794}
confusion matrix:
       0    1
0  17535  532
1    145  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.801032, 'recall': 0.69294745, 'specificity': 0.69294745, 'f1': 0.73383206, 'auroc': 0.93884706, 'binary_precision': 0.6280488, 'binary_recall': 0.39615384, 'binary_specificity': 0.989741, 'binary_f1_score': 0.48584905}
confusion matrix:
      0    1
0  5885   61
1   157  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_25.png
early stop counter: 21
val acc:0.9638740420341492, best validation acc: 0.965901792049408, corresponding to test acc:                         0.9755075573921204 / 0.9755075573921204
after epoch: 25,now: 2024-06-02 22:24:14.362334,epoch time: 0:24:03.437170,used: 9:47:34.087881,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.97206765, 'precision': 0.77613986, 'recall': 0.82232034, 'specificity': 0.82232034, 'f1': 0.79725873, 'auroc': 0.9695871, 'binary_precision': 0.5638298, 'binary_recall': 0.66204023, 'binary_specificity': 0.9826005, 'binary_f1_score': 0.6090009}
confusion matrix:
       0    1
0  41677  738
1    487  954
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7582798, 'recall': 0.8124973, 'specificity': 0.8124973, 'f1': 0.78249466, 'auroc': 0.9572618, 'binary_precision': 0.52984166, 'binary_recall': 0.64635956, 'binary_specificity': 0.9786351, 'binary_f1_score': 0.58232933}
confusion matrix:
       0    1
0  17681  386
1    238  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.83632886, 'recall': 0.6679584, 'specificity': 0.6679584, 'f1': 0.7212839, 'auroc': 0.93438053, 'binary_precision': 0.7007874, 'binary_recall': 0.3423077, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.45994833}
confusion matrix:
      0   1
0  5908  38
1   171  89
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_26.png
better model found
persisted
after epoch: 26,now: 2024-06-02 22:48:24.879647,epoch time: 0:24:10.517313,used: 10:11:44.605194,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96803176, 'precision': 0.7504539, 'recall': 0.86556935, 'specificity': 0.86556935, 'f1': 0.7959669, 'auroc': 0.9698489, 'binary_precision': 0.50934577, 'binary_recall': 0.7558946, 'binary_specificity': 0.97524405, 'binary_f1_score': 0.6085985}
confusion matrix:
       0     1
0  41364  1050
1    352  1090
---- Validation: 
scalar performance:
{'acc': 0.9624867, 'precision': 0.7373712, 'recall': 0.8489355, 'specificity': 0.8489355, 'f1': 0.78107953, 'auroc': 0.9589532, 'binary_precision': 0.48511904, 'binary_recall': 0.7265973, 'binary_specificity': 0.9712736, 'binary_f1_score': 0.5817965}
confusion matrix:
       0    1
0  17548  519
1    184  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668063, 'precision': 0.83299303, 'recall': 0.6829226, 'specificity': 0.6829226, 'f1': 0.7339252, 'auroc': 0.93729705, 'binary_precision': 0.69285715, 'binary_recall': 0.37307692, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.485}
confusion matrix:
      0   1
0  5903  43
1   163  97
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_27.png
early stop counter: 1
val acc:0.9624866843223572, best validation acc: 0.9667022228240967, corresponding to test acc:                         0.9663228988647461 / 0.9755075573921204
after epoch: 27,now: 2024-06-02 23:12:42.792706,epoch time: 0:24:17.913059,used: 10:36:02.518253,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9697875, 'precision': 0.7603781, 'recall': 0.82929736, 'specificity': 0.82929736, 'f1': 0.79035604, 'auroc': 0.9696944, 'binary_precision': 0.5317762, 'binary_recall': 0.6789182, 'binary_specificity': 0.97967654, 'binary_f1_score': 0.59640574}
confusion matrix:
       0    1
0  41552  862
1    463  979
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.7470346, 'recall': 0.81862605, 'specificity': 0.81862605, 'f1': 0.77771294, 'auroc': 0.9584626, 'binary_precision': 0.50683373, 'binary_recall': 0.6612184, 'binary_specificity': 0.9760336, 'binary_f1_score': 0.57382333}
confusion matrix:
       0    1
0  17634  433
1    228  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.7968865, 'recall': 0.59179217, 'specificity': 0.59179217, 'f1': 0.6350317, 'auroc': 0.93444335, 'binary_precision': 0.6282051, 'binary_recall': 0.18846154, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.28994083}
confusion matrix:
      0   1
0  5917  29
1   211  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_28.png
early stop counter: 2
val acc:0.9647278785705566, best validation acc: 0.9667022228240967, corresponding to test acc:                         0.9663228988647461 / 0.9755075573921204
after epoch: 28,now: 2024-06-02 23:37:03.095497,epoch time: 0:24:20.302791,used: 11:00:22.821044,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9687614, 'precision': 0.7543086, 'recall': 0.86460674, 'specificity': 0.86460674, 'f1': 0.7984682, 'auroc': 0.9729035, 'binary_precision': 0.51714283, 'binary_recall': 0.75312066, 'binary_specificity': 0.9760928, 'binary_f1_score': 0.6132129}
confusion matrix:
       0     1
0  41400  1014
1    356  1086
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.74714506, 'recall': 0.8500148, 'specificity': 0.8500148, 'f1': 0.7885437, 'auroc': 0.9606061, 'binary_precision': 0.504644, 'binary_recall': 0.7265973, 'binary_specificity': 0.97343224, 'binary_f1_score': 0.59561515}
confusion matrix:
       0    1
0  17587  480
1    184  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.7829972, 'recall': 0.61946106, 'specificity': 0.61946106, 'f1': 0.6644658, 'auroc': 0.94086754, 'binary_precision': 0.5981308, 'binary_recall': 0.24615385, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.34877384}
confusion matrix:
      0   1
0  5903  43
1   196  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_29.png
early stop counter: 3
val acc:0.9645677804946899, best validation acc: 0.9667022228240967, corresponding to test acc:                         0.9663228988647461 / 0.9755075573921204
after epoch: 29,now: 2024-06-03 00:01:04.964874,epoch time: 0:24:01.869377,used: 11:24:24.690421,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9688754, 'precision': 0.75481236, 'recall': 0.8499278, 'specificity': 0.8499278, 'f1': 0.7940169, 'auroc': 0.9720714, 'binary_precision': 0.51918286, 'binary_recall': 0.7226075, 'binary_specificity': 0.9772481, 'binary_f1_score': 0.60423315}
confusion matrix:
       0     1
0  41449   965
1    400  1042
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.74362344, 'recall': 0.83254397, 'specificity': 0.83254397, 'f1': 0.78031194, 'auroc': 0.95807695, 'binary_precision': 0.49892703, 'binary_recall': 0.6909361, 'binary_specificity': 0.9741518, 'binary_f1_score': 0.5794392}
confusion matrix:
       0    1
0  17600  467
1    208  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.7969109, 'recall': 0.6310836, 'specificity': 0.6310836, 'f1': 0.67853755, 'auroc': 0.93525803, 'binary_precision': 0.625, 'binary_recall': 0.26923078, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.3763441}
confusion matrix:
      0   1
0  5904  42
1   190  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_30.png
early stop counter: 4
val acc:0.9639807939529419, best validation acc: 0.9667022228240967, corresponding to test acc:                         0.9663228988647461 / 0.9755075573921204
after epoch: 30,now: 2024-06-03 00:25:37.869060,epoch time: 0:24:32.904186,used: 11:48:57.594607,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_02_12_36_40_seed_1_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:48:57.594607 at 2024-06-03 00:25:37.869060
persisted model performance metric: 

scalar performance:
{'acc': 0.96455044, 'precision': 0.8114342, 'recall': 0.6615165, 'specificity': 0.6615165, 'f1': 0.7102363, 'auroc': 0.94278955, 'binary_precision': 0.6515151, 'binary_recall': 0.33076924, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.4387755}
confusion matrix:
      0   1
0  5900  46
1   174  86
oracle model performance metric: 

scalar performance:
{'acc': 0.9772801, 'precision': 0.8869567, 'recall': 0.8079226, 'specificity': 0.8079226, 'f1': 0.842486, 'auroc': 0.927297, 'binary_precision': 0.7902439, 'binary_recall': 0.6230769, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.6967742}
confusion matrix:
      0    1
0  5903   43
1    98  162
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 493647 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool | 403840 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |  89807 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 493647 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool | 403840 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |  89807 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476570 KiB |  10880 MiB |   1799 TiB |   1799 TiB |
|       from large pool | 387840 KiB |  10808 MiB |   1794 TiB |   1794 TiB |
|       from small pool |  88730 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11460 MiB |  11482 MiB |  21726 MiB |  10266 MiB |
|       from large pool |  11336 MiB |  11356 MiB |  21574 MiB |  10238 MiB |
|       from small pool |    124 MiB |    126 MiB |    152 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 522160 KiB |   1325 MiB |    861 TiB |    861 TiB |
|       from large pool | 511616 KiB |   1322 MiB |    856 TiB |    856 TiB |
|       from small pool |  10544 KiB |     24 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3705    |    6728    |  279923 K  |  279920 K  |
|       from large pool |      87    |     908    |  113787 K  |  113787 K  |
|       from small pool |    3618    |    6639    |  166136 K  |  166132 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3705    |    6728    |  279923 K  |  279920 K  |
|       from large pool |      87    |     908    |  113787 K  |  113787 K  |
|       from small pool |    3618    |    6639    |  166136 K  |  166132 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     399    |     404    |     724    |     325    |
|       from large pool |     337    |     341    |     648    |     311    |
|       from small pool |      62    |      63    |      76    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    2772    |  150142 K  |  150142 K  |
|       from large pool |      20    |     187    |   69937 K  |   69937 K  |
|       from small pool |      53    |    2751    |   80204 K  |   80204 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |   1799 TiB |   1799 TiB |
|       from large pool |  16640 KiB |  10808 MiB |   1794 TiB |   1794 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    992 MiB |  11482 MiB |  21726 MiB |  20734 MiB |
|       from large pool |    894 MiB |  11356 MiB |  21574 MiB |  20680 MiB |
|       from small pool |     98 MiB |    126 MiB |    152 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB |    861 TiB |    861 TiB |
|       from large pool |  50944 KiB |   1322 MiB |    856 TiB |    856 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  279923 K  |  279923 K  |
|       from large pool |       2    |     908    |  113787 K  |  113787 K  |
|       from small pool |       0    |    6639    |  166136 K  |  166136 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  279923 K  |  279923 K  |
|       from large pool |       2    |     908    |  113787 K  |  113787 K  |
|       from small pool |       0    |    6639    |  166136 K  |  166136 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     404    |     724    |     642    |
|       from large pool |      33    |     341    |     648    |     615    |
|       from small pool |      49    |      63    |      76    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2772    |  150143 K  |  150143 K  |
|       from large pool |       4    |     187    |   69937 K  |   69937 K  |
|       from small pool |       0    |    2751    |   80206 K  |   80206 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |   1816 TiB |   1816 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   1810 TiB |   1810 TiB |
|       from small pool |      0 KiB |    125 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |   1799 TiB |   1799 TiB |
|       from large pool |  16640 KiB |  10808 MiB |   1794 TiB |   1794 TiB |
|       from small pool |      0 KiB |    124 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    992 MiB |  11482 MiB |  21726 MiB |  20734 MiB |
|       from large pool |    894 MiB |  11356 MiB |  21574 MiB |  20680 MiB |
|       from small pool |     98 MiB |    126 MiB |    152 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB |    861 TiB |    861 TiB |
|       from large pool |  50944 KiB |   1322 MiB |    856 TiB |    856 TiB |
|       from small pool |      0 KiB |     26 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6728    |  279923 K  |  279923 K  |
|       from large pool |       2    |     908    |  113787 K  |  113787 K  |
|       from small pool |       0    |    6639    |  166136 K  |  166136 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6728    |  279923 K  |  279923 K  |
|       from large pool |       2    |     908    |  113787 K  |  113787 K  |
|       from small pool |       0    |    6639    |  166136 K  |  166136 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     404    |     724    |     642    |
|       from large pool |      33    |     341    |     648    |     615    |
|       from small pool |      49    |      63    |      76    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2772    |  150143 K  |  150143 K  |
|       from large pool |       4    |     187    |   69937 K  |   69937 K  |
|       from small pool |       0    |    2751    |   80206 K  |   80206 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734

 Experiment start at: 2024-06-03 00:32:23.469622
before training, model accuracy: 0.1738806962966919
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9605106, 'precision': 0.86033857, 'recall': 0.9564042, 'specificity': 0.9564042, 'f1': 0.90067065, 'auroc': 0.9872873, 'binary_precision': 0.72608036, 'binary_recall': 0.9513109, 'binary_specificity': 0.96149755, 'binary_f1_score': 0.82357424}
confusion matrix:
       0     1
0  40680  1629
1    221  4318
---- Validation: 
scalar performance:
{'acc': 0.9035317, 'precision': 0.5731617, 'recall': 0.70443505, 'specificity': 0.70443505, 'f1': 0.5974132, 'auroc': 0.77704185, 'binary_precision': 0.16435313, 'binary_recall': 0.49169436, 'binary_specificity': 0.9171757, 'binary_f1_score': 0.24635872}
confusion matrix:
       0     1
0  16666  1505
1    306   296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9863156, 'precision': 0.95382833, 'recall': 0.97780156, 'specificity': 0.97780156, 'f1': 0.96540195, 'auroc': 0.9922303, 'binary_precision': 0.9116883, 'binary_recall': 0.96694213, 'binary_specificity': 0.988661, 'binary_f1_score': 0.93850267}
confusion matrix:
      0    1
0  5929   68
1    24  702
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-03 00:50:36.971118,epoch time: 0:18:13.501496,used: 0:18:13.501496,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93195015, 'precision': 0.79357374, 'recall': 0.94767237, 'specificity': 0.94767237, 'f1': 0.8473078, 'auroc': 0.9876653, 'binary_precision': 0.5909274, 'binary_recall': 0.9671734, 'binary_specificity': 0.92817134, 'binary_f1_score': 0.73362297}
confusion matrix:
       0     1
0  39270  3039
1    149  4390
---- Validation: 
scalar performance:
{'acc': 0.86837476, 'precision': 0.5404615, 'recall': 0.64290965, 'specificity': 0.64290965, 'f1': 0.54617774, 'auroc': 0.6749053, 'binary_precision': 0.10284743, 'binary_recall': 0.40199336, 'binary_specificity': 0.8838259, 'binary_f1_score': 0.16379018}
confusion matrix:
       0     1
0  16060  2111
1    360   242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634092, 'precision': 0.8746538, 'recall': 0.9752524, 'specificity': 0.9752524, 'f1': 0.91650224, 'auroc': 0.995786, 'binary_precision': 0.7505219, 'binary_recall': 0.9903581, 'binary_specificity': 0.9601467, 'binary_f1_score': 0.85391927}
confusion matrix:
      0    1
0  5758  239
1     7  719
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_2.png
early stop counter: 1
val acc:0.868374764919281, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 2,now: 2024-06-03 01:07:56.615218,epoch time: 0:17:19.644100,used: 0:35:33.145596,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8077399, 'precision': 0.6644834, 'recall': 0.882543, 'specificity': 0.882543, 'f1': 0.688473, 'auroc': 0.97629, 'binary_precision': 0.33230746, 'binary_recall': 0.975325, 'binary_specificity': 0.78976107, 'binary_f1_score': 0.49571693}
confusion matrix:
       0     1
0  33414  8895
1    112  4427
---- Validation: 
scalar performance:
{'acc': 0.68603843, 'precision': 0.5076771, 'recall': 0.5527363, 'specificity': 0.5527363, 'f1': 0.44408378, 'auroc': 0.5538449, 'binary_precision': 0.04268925, 'binary_recall': 0.410299, 'binary_specificity': 0.6951736, 'binary_f1_score': 0.07733249}
confusion matrix:
       0     1
0  12632  5539
1    355   247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8448609, 'precision': 0.7044424, 'recall': 0.9100132, 'specificity': 0.9100132, 'f1': 0.742563, 'auroc': 0.98857164, 'binary_precision': 0.409892, 'binary_recall': 0.9931129, 'binary_specificity': 0.8269135, 'binary_f1_score': 0.5802817}
confusion matrix:
      0     1
0  4959  1038
1     5   721
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_3.png
early stop counter: 2
val acc:0.6860384345054626, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 3,now: 2024-06-03 01:25:21.965817,epoch time: 0:17:25.350599,used: 0:52:58.496195,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.868575, 'precision': 0.70957464, 'recall': 0.91514075, 'specificity': 0.91514075, 'f1': 0.7554762, 'auroc': 0.9834702, 'binary_precision': 0.42252848, 'binary_recall': 0.97289556, 'binary_specificity': 0.85738593, 'binary_f1_score': 0.5891773}
confusion matrix:
       0     1
0  36276  6034
1    123  4415
---- Validation: 
scalar performance:
{'acc': 0.767645, 'precision': 0.51694274, 'recall': 0.5956944, 'specificity': 0.5956944, 'f1': 0.4843281, 'auroc': 0.60573983, 'binary_precision': 0.058270678, 'binary_recall': 0.41196012, 'binary_specificity': 0.7794288, 'binary_f1_score': 0.10209963}
confusion matrix:
       0     1
0  14163  4008
1    354   248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.930537, 'precision': 0.8042824, 'recall': 0.9580372, 'specificity': 0.9580372, 'f1': 0.8574455, 'auroc': 0.99702764, 'binary_precision': 0.60946745, 'binary_recall': 0.9931129, 'binary_specificity': 0.9229615, 'binary_f1_score': 0.7553693}
confusion matrix:
      0    1
0  5535  462
1     5  721
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_4.png
early stop counter: 3
val acc:0.767645001411438, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 4,now: 2024-06-03 01:42:39.210596,epoch time: 0:17:17.244779,used: 1:10:15.740974,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.6964011, 'precision': 0.61938417, 'recall': 0.82699823, 'specificity': 0.82699823, 'f1': 0.5926035, 'auroc': 0.9467106, 'binary_precision': 0.24054228, 'binary_recall': 0.98898435, 'binary_specificity': 0.6650122, 'binary_f1_score': 0.38696608}
confusion matrix:
       0      1
0  28136  14173
1     50   4489
---- Validation: 
scalar performance:
{'acc': 0.49198318, 'precision': 0.49779055, 'recall': 0.48220697, 'specificity': 0.48220697, 'f1': 0.3543321, 'auroc': 0.5459398, 'binary_precision': 0.0298853, 'binary_recall': 0.4717608, 'binary_specificity': 0.49265313, 'binary_f1_score': 0.0562098}
confusion matrix:
      0     1
0  8952  9219
1   318   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73940206, 'precision': 0.645885, 'recall': 0.852111, 'specificity': 0.852111, 'f1': 0.64059865, 'auroc': 0.97164977, 'binary_precision': 0.29247573, 'binary_recall': 0.9958678, 'binary_specificity': 0.7083542, 'binary_f1_score': 0.4521576}
confusion matrix:
      0     1
0  4248  1749
1     3   723
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_5.png
early stop counter: 4
val acc:0.49198317527770996, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 5,now: 2024-06-03 02:00:10.529315,epoch time: 0:17:31.318719,used: 1:27:47.059693,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.7487406, 'precision': 0.6368745, 'recall': 0.8535185, 'specificity': 0.8535185, 'f1': 0.6350107, 'auroc': 0.9639332, 'binary_precision': 0.27619284, 'binary_recall': 0.9834729, 'binary_specificity': 0.72356415, 'binary_f1_score': 0.43127024}
confusion matrix:
       0      1
0  30614  11696
1     75   4463
---- Validation: 
scalar performance:
{'acc': 0.56810313, 'precision': 0.50181186, 'recall': 0.5143004, 'specificity': 0.5143004, 'f1': 0.39142746, 'auroc': 0.56217444, 'binary_precision': 0.03413605, 'binary_recall': 0.45681062, 'binary_specificity': 0.5717902, 'binary_f1_score': 0.063525066}
confusion matrix:
       0     1
0  10390  7781
1    327   275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70712477, 'precision': 0.6342745, 'recall': 0.83462393, 'specificity': 0.83462393, 'f1': 0.6137165, 'auroc': 0.97240996, 'binary_precision': 0.26904497, 'binary_recall': 0.9972452, 'binary_specificity': 0.6720027, 'binary_f1_score': 0.42376354}
confusion matrix:
      0     1
0  4030  1967
1     2   724
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_6.png
early stop counter: 5
val acc:0.5681031346321106, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 6,now: 2024-06-03 02:17:38.086022,epoch time: 0:17:27.556707,used: 1:45:14.616400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.7852416, 'precision': 0.65313464, 'recall': 0.87313557, 'specificity': 0.87313557, 'f1': 0.6675904, 'auroc': 0.9810653, 'binary_precision': 0.30876854, 'binary_recall': 0.98215467, 'binary_specificity': 0.7641164, 'binary_f1_score': 0.46983188}
confusion matrix:
       0     1
0  32329  9980
1     81  4458
---- Validation: 
scalar performance:
{'acc': 0.60901296, 'precision': 0.50368947, 'recall': 0.5282056, 'specificity': 0.5282056, 'f1': 0.41011336, 'auroc': 0.55289197, 'binary_precision': 0.03658872, 'binary_recall': 0.44186047, 'binary_specificity': 0.61455065, 'binary_f1_score': 0.0675813}
confusion matrix:
       0     1
0  11167  7004
1    336   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.805444, 'precision': 0.6775806, 'recall': 0.88791883, 'specificity': 0.88791883, 'f1': 0.70103747, 'auroc': 0.9947763, 'binary_precision': 0.35622528, 'binary_recall': 0.9931129, 'binary_specificity': 0.7827247, 'binary_f1_score': 0.52436364}
confusion matrix:
      0     1
0  4694  1303
1     5   721
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_7.png
early stop counter: 6
val acc:0.6090129613876343, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 7,now: 2024-06-03 02:35:00.170694,epoch time: 0:17:22.084672,used: 2:02:36.701072,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.73290217, 'precision': 0.63108706, 'recall': 0.8457335, 'specificity': 0.8457335, 'f1': 0.62183326, 'auroc': 0.9692258, 'binary_precision': 0.2643461, 'binary_recall': 0.9856765, 'binary_specificity': 0.7057906, 'binary_f1_score': 0.41688803}
confusion matrix:
       0      1
0  29862  12448
1     65   4473
---- Validation: 
scalar performance:
{'acc': 0.6428381, 'precision': 0.5063126, 'recall': 0.5464815, 'specificity': 0.5464815, 'f1': 0.42626554, 'auroc': 0.55945504, 'binary_precision': 0.04022902, 'binary_recall': 0.4435216, 'binary_specificity': 0.6494414, 'binary_f1_score': 0.073767096}
confusion matrix:
       0     1
0  11801  6370
1    335   267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7437156, 'precision': 0.6478235, 'recall': 0.8551342, 'specificity': 0.8551342, 'f1': 0.64447486, 'auroc': 0.9843823, 'binary_precision': 0.29611453, 'binary_recall': 0.9972452, 'binary_specificity': 0.7130232, 'binary_f1_score': 0.45663828}
confusion matrix:
      0     1
0  4276  1721
1     2   724
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_8.png
early stop counter: 7
val acc:0.6428381204605103, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 8,now: 2024-06-03 02:52:27.381844,epoch time: 0:17:27.211150,used: 2:20:03.912222,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.76611596, 'precision': 0.6442841, 'recall': 0.8632351, 'specificity': 0.8632351, 'f1': 0.6502932, 'auroc': 0.97699857, 'binary_precision': 0.2909174, 'binary_recall': 0.9836969, 'binary_specificity': 0.7427734, 'binary_f1_score': 0.44903705}
confusion matrix:
       0      1
0  31426  10883
1     74   4465
---- Validation: 
scalar performance:
{'acc': 0.6442764, 'precision': 0.506317, 'recall': 0.5464214, 'specificity': 0.5464214, 'f1': 0.42682594, 'auroc': 0.55535185, 'binary_precision': 0.04025424, 'binary_recall': 0.44186047, 'binary_specificity': 0.6509823, 'binary_f1_score': 0.07378641}
confusion matrix:
       0     1
0  11829  6342
1    336   266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7698944, 'precision': 0.659509, 'recall': 0.87041354, 'specificity': 0.87041354, 'f1': 0.6678823, 'auroc': 0.9902656, 'binary_precision': 0.31924263, 'binary_recall': 0.9986226, 'binary_specificity': 0.7422044, 'binary_f1_score': 0.48381713}
confusion matrix:
      0     1
0  4451  1546
1     1   725
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_9.png
early stop counter: 8
val acc:0.6442763805389404, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 9,now: 2024-06-03 03:09:55.659689,epoch time: 0:17:28.277845,used: 2:37:32.190067,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.71358436, 'precision': 0.6244262, 'recall': 0.8352332, 'specificity': 0.8352332, 'f1': 0.6060284, 'auroc': 0.9542344, 'binary_precision': 0.2510235, 'binary_recall': 0.9861203, 'binary_specificity': 0.68434614, 'binary_f1_score': 0.40017882}
confusion matrix:
       0      1
0  28954  13355
1     63   4476
---- Validation: 
scalar performance:
{'acc': 0.5726309, 'precision': 0.50191015, 'recall': 0.51503325, 'specificity': 0.51503325, 'f1': 0.39342165, 'auroc': 0.54661083, 'binary_precision': 0.03426635, 'binary_recall': 0.45348838, 'binary_specificity': 0.5765781, 'binary_f1_score': 0.06371805}
confusion matrix:
       0     1
0  10477  7694
1    329   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7355347, 'precision': 0.6447656, 'recall': 0.85115385, 'specificity': 0.85115385, 'f1': 0.6375939, 'auroc': 0.98257923, 'binary_precision': 0.2897682, 'binary_recall': 0.9986226, 'binary_specificity': 0.70368516, 'binary_f1_score': 0.44919455}
confusion matrix:
      0     1
0  4220  1777
1     1   725
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_10.png
early stop counter: 9
val acc:0.5726308822631836, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 10,now: 2024-06-03 03:27:26.588690,epoch time: 0:17:30.929001,used: 2:55:03.119068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.7122609, 'precision': 0.6235941, 'recall': 0.83332235, 'specificity': 0.83332235, 'f1': 0.6046443, 'auroc': 0.9728373, 'binary_precision': 0.24977614, 'binary_recall': 0.9834729, 'binary_specificity': 0.6831718, 'binary_f1_score': 0.39837542}
confusion matrix:
       0      1
0  28905  13405
1     75   4463
---- Validation: 
scalar performance:
{'acc': 0.6215842, 'precision': 0.50565434, 'recall': 0.5427299, 'specificity': 0.5427299, 'f1': 0.4172144, 'auroc': 0.5447556, 'binary_precision': 0.039126735, 'binary_recall': 0.45847178, 'binary_specificity': 0.62698805, 'binary_f1_score': 0.07210031}
confusion matrix:
       0     1
0  11393  6778
1    326   276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71203333, 'precision': 0.63594663, 'recall': 0.8373753, 'specificity': 0.8373753, 'f1': 0.61774445, 'auroc': 0.99225074, 'binary_precision': 0.27238524, 'binary_recall': 0.9972452, 'binary_specificity': 0.67750543, 'binary_f1_score': 0.42789596}
confusion matrix:
      0     1
0  4063  1934
1     2   724
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_11.png
early stop counter: 10
val acc:0.6215841770172119, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 11,now: 2024-06-03 03:45:01.566616,epoch time: 0:17:34.977926,used: 3:12:38.096994,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.70741546, 'precision': 0.62217367, 'recall': 0.8311316, 'specificity': 0.8311316, 'f1': 0.6008675, 'auroc': 0.96480536, 'binary_precision': 0.24678266, 'binary_recall': 0.9845747, 'binary_specificity': 0.6776885, 'binary_f1_score': 0.39464736}
confusion matrix:
       0      1
0  28673  13637
1     70   4468
---- Validation: 
scalar performance:
{'acc': 0.52330476, 'precision': 0.49909937, 'recall': 0.49276525, 'specificity': 0.49276525, 'f1': 0.36959016, 'auroc': 0.5159172, 'binary_precision': 0.0311201, 'binary_recall': 0.4601329, 'binary_specificity': 0.5253976, 'binary_f1_score': 0.05829738}
confusion matrix:
      0     1
0  9547  8624
1   325   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72601515, 'precision': 0.64135516, 'recall': 0.8464232, 'specificity': 0.8464232, 'f1': 0.6296797, 'auroc': 0.98199165, 'binary_precision': 0.28271028, 'binary_recall': 1.0, 'binary_specificity': 0.6928464, 'binary_f1_score': 0.44080144}
confusion matrix:
      0     1
0  4155  1842
1     0   726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_12.png
early stop counter: 11
val acc:0.5233047604560852, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 12,now: 2024-06-03 04:02:36.364436,epoch time: 0:17:34.797820,used: 3:30:12.894814,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.69490695, 'precision': 0.6177939, 'recall': 0.8226308, 'specificity': 0.8226308, 'f1': 0.59057486, 'auroc': 0.9577013, 'binary_precision': 0.2386388, 'binary_recall': 0.9810531, 'binary_specificity': 0.66420853, 'binary_f1_score': 0.38389587}
confusion matrix:
       0      1
0  28102  14207
1     86   4453
---- Validation: 
scalar performance:
{'acc': 0.48628348, 'precision': 0.49672577, 'recall': 0.4736414, 'specificity': 0.4736414, 'f1': 0.35084218, 'auroc': 0.50813466, 'binary_precision': 0.028866194, 'binary_recall': 0.4601329, 'binary_specificity': 0.48714986, 'binary_f1_score': 0.054324377}
confusion matrix:
      0     1
0  8852  9319
1   325   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70950466, 'precision': 0.6350801, 'recall': 0.83595794, 'specificity': 0.83595794, 'f1': 0.61566603, 'auroc': 0.98052245, 'binary_precision': 0.2706542, 'binary_recall': 0.9972452, 'binary_specificity': 0.6746707, 'binary_f1_score': 0.42575714}
confusion matrix:
      0     1
0  4046  1951
1     2   724
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_13.png
early stop counter: 12
val acc:0.48628348112106323, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 13,now: 2024-06-03 04:20:05.421422,epoch time: 0:17:29.056986,used: 3:47:41.951800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.68752134, 'precision': 0.61615556, 'recall': 0.8203144, 'specificity': 0.8203144, 'f1': 0.58518565, 'auroc': 0.9778478, 'binary_precision': 0.23475657, 'binary_recall': 0.98501545, 'binary_specificity': 0.6556133, 'binary_f1_score': 0.37915096}
confusion matrix:
       0      1
0  27739  14571
1     68   4470
---- Validation: 
scalar performance:
{'acc': 0.54359984, 'precision': 0.5006079, 'recall': 0.50485504, 'specificity': 0.50485504, 'f1': 0.37983307, 'auroc': 0.5450385, 'binary_precision': 0.032731112, 'binary_recall': 0.46345514, 'binary_specificity': 0.546255, 'binary_f1_score': 0.061143987}
confusion matrix:
      0     1
0  9926  8245
1   323   279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6025584, 'precision': 0.60659295, 'recall': 0.7766166, 'specificity': 0.7766166, 'f1': 0.53259933, 'auroc': 0.9929946, 'binary_precision': 0.21348645, 'binary_recall': 0.9986226, 'binary_specificity': 0.5546106, 'binary_f1_score': 0.35177097}
confusion matrix:
      0     1
0  3326  2671
1     1   725
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_14.png
early stop counter: 13
val acc:0.5435998439788818, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 14,now: 2024-06-03 04:37:32.413750,epoch time: 0:17:26.992328,used: 4:05:08.944128,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.6884392, 'precision': 0.6156164, 'recall': 0.8182633, 'specificity': 0.8182633, 'f1': 0.58531636, 'auroc': 0.9682752, 'binary_precision': 0.23460178, 'binary_recall': 0.9792906, 'binary_specificity': 0.65723604, 'binary_f1_score': 0.37852338}
confusion matrix:
       0      1
0  27807  14502
1     94   4445
---- Validation: 
scalar performance:
{'acc': 0.58014166, 'precision': 0.50282425, 'recall': 0.52212524, 'specificity': 0.52212524, 'f1': 0.3974524, 'auroc': 0.54499197, 'binary_precision': 0.035358693, 'binary_recall': 0.4601329, 'binary_specificity': 0.58411753, 'binary_f1_score': 0.06567094}
confusion matrix:
       0     1
0  10614  7557
1    325   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70474494, 'precision': 0.63326806, 'recall': 0.83268464, 'specificity': 0.83268464, 'f1': 0.61162436, 'auroc': 0.9911553, 'binary_precision': 0.2672828, 'binary_recall': 0.9958678, 'binary_specificity': 0.6695014, 'binary_f1_score': 0.42145148}
confusion matrix:
      0     1
0  4015  1982
1     3   723
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_15.png
early stop counter: 14
val acc:0.5801416635513306, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 15,now: 2024-06-03 04:54:52.760200,epoch time: 0:17:20.346450,used: 4:22:29.290578,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.62497866, 'precision': 0.6012137, 'recall': 0.78814423, 'specificity': 0.78814423, 'f1': 0.5384224, 'auroc': 0.94144845, 'binary_precision': 0.20415948, 'binary_recall': 0.99052656, 'binary_specificity': 0.5857619, 'binary_f1_score': 0.33854148}
confusion matrix:
       0      1
0  24783  17526
1     43   4496
---- Validation: 
scalar performance:
{'acc': 0.4318436, 'precision': 0.49372402, 'recall': 0.45033795, 'specificity': 0.45033795, 'f1': 0.3225281, 'auroc': 0.5303623, 'binary_precision': 0.026622767, 'binary_recall': 0.47009966, 'binary_specificity': 0.4305762, 'binary_f1_score': 0.050391737}
confusion matrix:
      0      1
0  7824  10347
1   319    283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62591106, 'precision': 0.6117737, 'recall': 0.78970647, 'specificity': 0.78970647, 'f1': 0.55021626, 'auroc': 0.9602909, 'binary_precision': 0.22383451, 'binary_recall': 0.9986226, 'binary_specificity': 0.5807904, 'binary_f1_score': 0.36569986}
confusion matrix:
      0     1
0  3483  2514
1     1   725
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_16.png
early stop counter: 15
val acc:0.4318436086177826, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 16,now: 2024-06-03 05:12:13.343978,epoch time: 0:17:20.583778,used: 4:39:49.874356,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.65913165, 'precision': 0.6084307, 'recall': 0.8045971, 'specificity': 0.8045971, 'f1': 0.5633775, 'auroc': 0.95485187, 'binary_precision': 0.21942958, 'binary_recall': 0.98501545, 'binary_specificity': 0.6241787, 'binary_f1_score': 0.35890642}
confusion matrix:
       0      1
0  26409  15901
1     68   4470
---- Validation: 
scalar performance:
{'acc': 0.43338838, 'precision': 0.49382994, 'recall': 0.4511359, 'specificity': 0.4511359, 'f1': 0.32336685, 'auroc': 0.51699245, 'binary_precision': 0.026695594, 'binary_recall': 0.47009966, 'binary_specificity': 0.43217215, 'binary_f1_score': 0.050522182}
confusion matrix:
      0      1
0  7853  10318
1   319    283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6568496, 'precision': 0.6196835, 'recall': 0.8076538, 'specificity': 0.8076538, 'f1': 0.57405937, 'auroc': 0.9762056, 'binary_precision': 0.23936696, 'binary_recall': 1.0, 'binary_specificity': 0.6153076, 'binary_f1_score': 0.38627294}
confusion matrix:
      0     1
0  3690  2307
1     0   726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_17.png
early stop counter: 16
val acc:0.4333883821964264, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 17,now: 2024-06-03 05:29:37.982032,epoch time: 0:17:24.638054,used: 4:57:14.512410,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.6035263, 'precision': 0.59685785, 'recall': 0.7767675, 'specificity': 0.7767675, 'f1': 0.5227245, 'auroc': 0.9406727, 'binary_precision': 0.19531149, 'binary_recall': 0.9916244, 'binary_specificity': 0.5619106, 'binary_f1_score': 0.32634556}
confusion matrix:
       0      1
0  23775  18536
1     38   4499
---- Validation: 
scalar performance:
{'acc': 0.44159165, 'precision': 0.49479064, 'recall': 0.45858562, 'specificity': 0.45858562, 'f1': 0.32808185, 'auroc': 0.50871927, 'binary_precision': 0.02745098, 'binary_recall': 0.47674417, 'binary_specificity': 0.44042706, 'binary_f1_score': 0.051912814}
confusion matrix:
      0      1
0  8003  10168
1   315    287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6236799, 'precision': 0.6114865, 'recall': 0.7890612, 'specificity': 0.7890612, 'f1': 0.548656, 'auroc': 0.9599969, 'binary_precision': 0.22297297, 'binary_recall': 1.0, 'binary_specificity': 0.5781224, 'binary_f1_score': 0.3646409}
confusion matrix:
      0     1
0  3467  2530
1     0   726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_18.png
early stop counter: 17
val acc:0.44159165024757385, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 18,now: 2024-06-03 05:46:59.797597,epoch time: 0:17:21.815565,used: 5:14:36.327975,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.72022283, 'precision': 0.6249417, 'recall': 0.8335007, 'specificity': 0.8335007, 'f1': 0.610055, 'auroc': 0.9669333, 'binary_precision': 0.25389168, 'binary_recall': 0.97399735, 'binary_specificity': 0.693004, 'binary_f1_score': 0.40278855}
confusion matrix:
       0      1
0  29321  12989
1    118   4420
---- Validation: 
scalar performance:
{'acc': 0.6321313, 'precision': 0.50580966, 'recall': 0.5433599, 'specificity': 0.5433599, 'f1': 0.42154348, 'auroc': 0.5229276, 'binary_precision': 0.039450612, 'binary_recall': 0.44850498, 'binary_specificity': 0.63821477, 'binary_f1_score': 0.072522156}
confusion matrix:
       0     1
0  11597  6574
1    332   270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7588874, 'precision': 0.6546655, 'recall': 0.8648491, 'specificity': 0.8648491, 'f1': 0.6581157, 'auroc': 0.99430484, 'binary_precision': 0.30933106, 'binary_recall': 1.0, 'binary_specificity': 0.7296982, 'binary_f1_score': 0.47250244}
confusion matrix:
      0     1
0  4376  1621
1     0   726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_19.png
early stop counter: 18
val acc:0.6321312785148621, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 19,now: 2024-06-03 06:04:18.142600,epoch time: 0:17:18.345003,used: 5:31:54.672978,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.60621583, 'precision': 0.5962589, 'recall': 0.77490795, 'specificity': 0.77490795, 'f1': 0.52402014, 'auroc': 0.93692315, 'binary_precision': 0.19551703, 'binary_recall': 0.98413396, 'binary_specificity': 0.5656819, 'binary_f1_score': 0.32622352}
confusion matrix:
       0      1
0  23934  18376
1     72   4466
---- Validation: 
scalar performance:
{'acc': 0.4232142, 'precision': 0.49302506, 'recall': 0.44507724, 'specificity': 0.44507724, 'f1': 0.31774956, 'auroc': 0.49702868, 'binary_precision': 0.02613531, 'binary_recall': 0.46843854, 'binary_specificity': 0.42171592, 'binary_f1_score': 0.04950843}
confusion matrix:
      0      1
0  7663  10508
1   320    282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5275918, 'precision': 0.5927716, 'recall': 0.7345956, 'specificity': 0.7345956, 'f1': 0.47667754, 'auroc': 0.930508, 'binary_precision': 0.18589744, 'binary_recall': 0.9986226, 'binary_specificity': 0.47056863, 'binary_f1_score': 0.31344575}
confusion matrix:
      0     1
0  2822  3175
1     1   725
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_20.png
early stop counter: 19
val acc:0.4232141971588135, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 20,now: 2024-06-03 06:21:22.667588,epoch time: 0:17:04.524988,used: 5:48:59.197966,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.57022715, 'precision': 0.59000623, 'recall': 0.7565531, 'specificity': 0.7565531, 'f1': 0.49820936, 'auroc': 0.9282511, 'binary_precision': 0.18252514, 'binary_recall': 0.9876625, 'binary_specificity': 0.52544373, 'binary_f1_score': 0.30810997}
confusion matrix:
       0      1
0  22231  20078
1     56   4483
---- Validation: 
scalar performance:
{'acc': 0.3747936, 'precision': 0.48974925, 'recall': 0.422474, 'specificity': 0.422474, 'f1': 0.2906404, 'auroc': 0.47638804, 'binary_precision': 0.024348568, 'binary_recall': 0.47342193, 'binary_specificity': 0.37152606, 'binary_f1_score': 0.046315104}
confusion matrix:
      0      1
0  6751  11420
1   317    285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5412762, 'precision': 0.5952756, 'recall': 0.7428714, 'specificity': 0.7428714, 'f1': 0.48698896, 'auroc': 0.93283296, 'binary_precision': 0.19055118, 'binary_recall': 1.0, 'binary_specificity': 0.48574287, 'binary_f1_score': 0.32010582}
confusion matrix:
      0     1
0  2913  3084
1     0   726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_21.png
early stop counter: 20
val acc:0.3747935891151428, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 21,now: 2024-06-03 06:38:25.997636,epoch time: 0:17:03.330048,used: 6:06:02.528014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.6385758, 'precision': 0.6044748, 'recall': 0.7962622, 'specificity': 0.7962622, 'f1': 0.5486402, 'auroc': 0.9654955, 'binary_precision': 0.21040332, 'binary_recall': 0.9918484, 'binary_specificity': 0.600676, 'binary_f1_score': 0.34716225}
confusion matrix:
       0      1
0  25414  16895
1     37   4502
---- Validation: 
scalar performance:
{'acc': 0.4609812, 'precision': 0.4953788, 'recall': 0.46298024, 'specificity': 0.46298024, 'f1': 0.33790317, 'auroc': 0.5106585, 'binary_precision': 0.027786048, 'binary_recall': 0.4651163, 'binary_specificity': 0.4608442, 'binary_f1_score': 0.05243937}
confusion matrix:
      0     1
0  8374  9797
1   322   280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5802469, 'precision': 0.60207045, 'recall': 0.7641103, 'specificity': 0.7641103, 'f1': 0.5159055, 'auroc': 0.96236575, 'binary_precision': 0.20445572, 'binary_recall': 0.9986226, 'binary_specificity': 0.5295981, 'binary_f1_score': 0.33941948}
confusion matrix:
      0     1
0  3176  2821
1     1   725
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_22.png
early stop counter: 21
val acc:0.46098119020462036, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 22,now: 2024-06-03 06:55:43.209921,epoch time: 0:17:17.212285,used: 6:23:19.740299,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.61347336, 'precision': 0.59872186, 'recall': 0.78167605, 'specificity': 0.78167605, 'f1': 0.52992934, 'auroc': 0.9653455, 'binary_precision': 0.19925529, 'binary_recall': 0.99030626, 'binary_specificity': 0.5730459, 'binary_f1_score': 0.33175877}
confusion matrix:
       0      1
0  24245  18064
1     44   4495
---- Validation: 
scalar performance:
{'acc': 0.44611943, 'precision': 0.49479294, 'recall': 0.45851538, 'specificity': 0.45851538, 'f1': 0.33030003, 'auroc': 0.50113904, 'binary_precision': 0.027402548, 'binary_recall': 0.4717608, 'binary_specificity': 0.44526994, 'binary_f1_score': 0.051796462}
confusion matrix:
      0      1
0  8091  10080
1   318    284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57994944, 'precision': 0.60201275, 'recall': 0.7639436, 'specificity': 0.7639436, 'f1': 0.51568353, 'auroc': 0.9703573, 'binary_precision': 0.20434047, 'binary_recall': 0.9986226, 'binary_specificity': 0.5292646, 'binary_f1_score': 0.33926064}
confusion matrix:
      0     1
0  3174  2823
1     1   725
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_23.png
early stop counter: 22
val acc:0.44611942768096924, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 23,now: 2024-06-03 07:12:57.662240,epoch time: 0:17:14.452319,used: 6:40:34.192618,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.59522283, 'precision': 0.5954294, 'recall': 0.7726536, 'specificity': 0.7726536, 'f1': 0.51680344, 'auroc': 0.9639876, 'binary_precision': 0.19226831, 'binary_recall': 0.99272966, 'binary_specificity': 0.5525775, 'binary_f1_score': 0.32214478}
confusion matrix:
       0      1
0  23379  18930
1     33   4506
---- Validation: 
scalar performance:
{'acc': 0.33329782, 'precision': 0.48753083, 'recall': 0.41067532, 'specificity': 0.41067532, 'f1': 0.2665569, 'auroc': 0.46644652, 'binary_precision': 0.023744803, 'binary_recall': 0.49335548, 'binary_specificity': 0.32799515, 'binary_f1_score': 0.045308925}
confusion matrix:
      0      1
0  5960  12211
1   305    297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5629927, 'precision': 0.59907204, 'recall': 0.7550442, 'specificity': 0.7550442, 'f1': 0.503163, 'auroc': 0.96354663, 'binary_precision': 0.19814411, 'binary_recall': 1.0, 'binary_specificity': 0.5100884, 'binary_f1_score': 0.33075172}
confusion matrix:
      0     1
0  3059  2938
1     0   726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_24.png
early stop counter: 23
val acc:0.33329781889915466, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 24,now: 2024-06-03 07:30:12.495654,epoch time: 0:17:14.833414,used: 6:57:49.026032,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.631916, 'precision': 0.6031203, 'recall': 0.79306674, 'specificity': 0.79306674, 'f1': 0.5437921, 'auroc': 0.9721335, 'binary_precision': 0.20751415, 'binary_recall': 0.99294996, 'binary_specificity': 0.59318346, 'binary_f1_score': 0.34328586}
confusion matrix:
       0      1
0  25097  17212
1     32   4507
---- Validation: 
scalar performance:
{'acc': 0.49278218, 'precision': 0.4983404, 'recall': 0.48663497, 'specificity': 0.48663497, 'f1': 0.35514596, 'auroc': 0.5330421, 'binary_precision': 0.030427458, 'binary_recall': 0.48006645, 'binary_specificity': 0.49320346, 'binary_f1_score': 0.057227716}
confusion matrix:
      0     1
0  8962  9209
1   313   289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5693887, 'precision': 0.6002486, 'recall': 0.7586293, 'specificity': 0.7586293, 'f1': 0.5079283, 'auroc': 0.97890294, 'binary_precision': 0.2004971, 'binary_recall': 1.0, 'binary_specificity': 0.51725864, 'binary_f1_score': 0.33402345}
confusion matrix:
      0     1
0  3102  2895
1     0   726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_25.png
early stop counter: 24
val acc:0.4927821755409241, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 25,now: 2024-06-03 07:47:32.158302,epoch time: 0:17:19.662648,used: 7:15:08.688680,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.5791923, 'precision': 0.5922113, 'recall': 0.76318836, 'specificity': 0.76318836, 'f1': 0.5050298, 'auroc': 0.958984, 'binary_precision': 0.18614271, 'binary_recall': 0.9914078, 'binary_specificity': 0.5349689, 'binary_f1_score': 0.31343594}
confusion matrix:
       0      1
0  22634  19675
1     39   4500
---- Validation: 
scalar performance:
{'acc': 0.3965802, 'precision': 0.49141675, 'recall': 0.4337282, 'specificity': 0.4337282, 'f1': 0.30311766, 'auroc': 0.48403734, 'binary_precision': 0.02523017, 'binary_recall': 0.47342193, 'binary_specificity': 0.39403445, 'binary_f1_score': 0.04790721}
confusion matrix:
      0      1
0  7160  11011
1   317    285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5191135, 'precision': 0.59116846, 'recall': 0.7292379, 'specificity': 0.7292379, 'f1': 0.4702411, 'auroc': 0.96174276, 'binary_precision': 0.18305942, 'binary_recall': 0.9972452, 'binary_specificity': 0.4612306, 'binary_f1_score': 0.3093356}
confusion matrix:
      0     1
0  2766  3231
1     2   724
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_26.png
early stop counter: 25
val acc:0.39658018946647644, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 26,now: 2024-06-03 08:04:51.086436,epoch time: 0:17:18.928134,used: 7:32:27.616814,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.6390881, 'precision': 0.6042956, 'recall': 0.79566073, 'specificity': 0.79566073, 'f1': 0.5488285, 'auroc': 0.97010297, 'binary_precision': 0.2103957, 'binary_recall': 0.9898656, 'binary_specificity': 0.6014559, 'binary_f1_score': 0.3470302}
confusion matrix:
       0      1
0  25447  16862
1     46   4493
---- Validation: 
scalar performance:
{'acc': 0.5275129, 'precision': 0.50057, 'recall': 0.5045756, 'specificity': 0.5045756, 'f1': 0.37274805, 'auroc': 0.51936984, 'binary_precision': 0.032670133, 'binary_recall': 0.48006645, 'binary_specificity': 0.5290848, 'binary_f1_score': 0.061176974}
confusion matrix:
      0     1
0  9614  8557
1   313   289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6500074, 'precision': 0.6176724, 'recall': 0.80321324, 'specificity': 0.80321324, 'f1': 0.5686333, 'auroc': 0.9814253, 'binary_precision': 0.23561911, 'binary_recall': 0.9986226, 'binary_specificity': 0.6078039, 'binary_f1_score': 0.38127792}
confusion matrix:
      0     1
0  3645  2352
1     1   725
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_27.png
early stop counter: 26
val acc:0.5275129079818726, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 27,now: 2024-06-03 08:21:56.909425,epoch time: 0:17:05.822989,used: 7:49:33.439803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.52981985, 'precision': 0.58457756, 'recall': 0.7374272, 'specificity': 0.7374272, 'f1': 0.4695701, 'auroc': 0.9529532, 'binary_precision': 0.17028658, 'binary_recall': 0.99493283, 'binary_specificity': 0.47992152, 'binary_f1_score': 0.29080138}
confusion matrix:
       0      1
0  20305  22004
1     23   4516
---- Validation: 
scalar performance:
{'acc': 0.28988442, 'precision': 0.4821105, 'recall': 0.38102204, 'specificity': 0.38102204, 'f1': 0.23873855, 'auroc': 0.3952754, 'binary_precision': 0.021645999, 'binary_recall': 0.47840533, 'binary_specificity': 0.28363878, 'binary_f1_score': 0.041417994}
confusion matrix:
      0      1
0  5154  13017
1   314    288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.47136694, 'precision': 0.58481306, 'recall': 0.70368516, 'specificity': 0.70368516, 'f1': 0.43448097, 'auroc': 0.95355314, 'binary_precision': 0.16962616, 'binary_recall': 1.0, 'binary_specificity': 0.40737036, 'binary_f1_score': 0.29005194}
confusion matrix:
      0     1
0  2443  3554
1     0   726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_28.png
early stop counter: 27
val acc:0.28988441824913025, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 28,now: 2024-06-03 08:39:17.175093,epoch time: 0:17:20.265668,used: 8:06:53.705471,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.6197276, 'precision': 0.59896713, 'recall': 0.78199184, 'specificity': 0.78199184, 'f1': 0.53386015, 'auroc': 0.9631536, 'binary_precision': 0.20101793, 'binary_recall': 0.9832562, 'binary_specificity': 0.5807275, 'binary_f1_score': 0.33379453}
confusion matrix:
       0      1
0  24570  17739
1     76   4463
---- Validation: 
scalar performance:
{'acc': 0.44888937, 'precision': 0.49477735, 'recall': 0.4583401, 'specificity': 0.4583401, 'f1': 0.33163702, 'auroc': 0.5039188, 'binary_precision': 0.027357392, 'binary_recall': 0.46843854, 'binary_specificity': 0.4482417, 'binary_f1_score': 0.05169569}
confusion matrix:
      0      1
0  8145  10026
1   320    282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55689424, 'precision': 0.59797573, 'recall': 0.7516258, 'specificity': 0.7516258, 'f1': 0.49862102, 'auroc': 0.978076, 'binary_precision': 0.19595142, 'binary_recall': 1.0, 'binary_specificity': 0.5032516, 'binary_f1_score': 0.32769126}
confusion matrix:
      0     1
0  3018  2979
1     0   726
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_29.png
early stop counter: 28
val acc:0.4488893747329712, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 29,now: 2024-06-03 08:56:29.941440,epoch time: 0:17:12.766347,used: 8:24:06.471818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.61588544, 'precision': 0.59889, 'recall': 0.7820281, 'specificity': 0.7820281, 'f1': 0.5314944, 'auroc': 0.9681455, 'binary_precision': 0.19999108, 'binary_recall': 0.9881031, 'binary_specificity': 0.5759531, 'binary_f1_score': 0.33265346}
confusion matrix:
       0      1
0  24368  17941
1     54   4485
---- Validation: 
scalar performance:
{'acc': 0.46108773, 'precision': 0.49548587, 'recall': 0.46383834, 'specificity': 0.46383834, 'f1': 0.33803403, 'auroc': 0.50049585, 'binary_precision': 0.027885282, 'binary_recall': 0.4667774, 'binary_specificity': 0.46089923, 'binary_f1_score': 0.05262665}
confusion matrix:
      0     1
0  8375  9796
1   321   281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5377064, 'precision': 0.59417135, 'recall': 0.7396598, 'specificity': 0.7396598, 'f1': 0.48410818, 'auroc': 0.9744363, 'binary_precision': 0.18903394, 'binary_recall': 0.9972452, 'binary_specificity': 0.48207438, 'binary_f1_score': 0.31782264}
confusion matrix:
      0     1
0  2891  3106
1     2   724
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21054734_30.png
early stop counter: 29
val acc:0.46108773350715637, best validation acc: 0.9035316705703735, corresponding to test acc:                         0.9863156080245972 / 0.9863156080245972
after epoch: 30,now: 2024-06-03 09:13:28.616041,epoch time: 0:16:58.674601,used: 8:41:05.146419,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_03_00_32_23_seed_2_21054734
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:41:05.146419 at 2024-06-03 09:13:28.616041
persisted model performance metric: 

scalar performance:
{'acc': 0.9866131, 'precision': 0.95411015, 'recall': 0.979179, 'specificity': 0.979179, 'f1': 0.9661936, 'auroc': 0.9936173, 'binary_precision': 0.9119171, 'binary_recall': 0.969697, 'binary_specificity': 0.988661, 'binary_f1_score': 0.9399199}
confusion matrix:
      0    1
0  5929   68
1    22  704
oracle model performance metric: 

scalar performance:
{'acc': 0.98542315, 'precision': 0.9525267, 'recall': 0.97427464, 'specificity': 0.97427464, 'f1': 0.9630591, 'auroc': 0.9925133, 'binary_precision': 0.90992165, 'binary_recall': 0.9600551, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.93431634}
confusion matrix:
      0    1
0  5928   69
1    29  697
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_vit_resnet_dinov2_bs16_lr1e-5_patchsize256/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 491314 KiB |  10997 MiB |   2788 TiB |   2788 TiB |
|       from large pool | 401408 KiB |  10925 MiB |   2779 TiB |   2779 TiB |
|       from small pool |  89906 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 491314 KiB |  10997 MiB |   2788 TiB |   2788 TiB |
|       from large pool | 401408 KiB |  10925 MiB |   2779 TiB |   2779 TiB |
|       from small pool |  89906 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 476595 KiB |  10880 MiB |   2761 TiB |   2761 TiB |
|       from large pool | 387840 KiB |  10808 MiB |   2752 TiB |   2752 TiB |
|       from small pool |  88755 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  11506 MiB |  11506 MiB |  32240 MiB |  20734 MiB |
|       from large pool |  11380 MiB |  11380 MiB |  32060 MiB |  20680 MiB |
|       from small pool |    126 MiB |    126 MiB |    180 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 635085 KiB |   1325 MiB |   1316 TiB |   1316 TiB |
|       from large pool | 626688 KiB |   1322 MiB |   1307 TiB |   1307 TiB |
|       from small pool |   8397 KiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3903    |    7102    |  428901 K  |  428897 K  |
|       from large pool |      87    |     908    |  174519 K  |  174519 K  |
|       from small pool |    3816    |    7013    |  254381 K  |  254377 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3903    |    7102    |  428901 K  |  428897 K  |
|       from large pool |      87    |     908    |  174519 K  |  174519 K  |
|       from small pool |    3816    |    7013    |  254381 K  |  254377 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     411    |     411    |    1053    |     642    |
|       from large pool |     348    |     348    |     963    |     615    |
|       from small pool |      63    |      63    |      90    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |    2963    |  227889 K  |  227889 K  |
|       from large pool |      24    |     203    |  105271 K  |  105271 K  |
|       from small pool |      53    |    2937    |  122618 K  |  122618 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  10997 MiB |   2788 TiB |   2788 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   2779 TiB |   2779 TiB |
|       from small pool |      0 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  10997 MiB |   2788 TiB |   2788 TiB |
|       from large pool |  16640 KiB |  10925 MiB |   2779 TiB |   2779 TiB |
|       from small pool |      0 KiB |    125 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  10880 MiB |   2761 TiB |   2761 TiB |
|       from large pool |  16640 KiB |  10808 MiB |   2752 TiB |   2752 TiB |
|       from small pool |      0 KiB |    124 MiB |      8 TiB |      8 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1100 MiB |  11506 MiB |  32240 MiB |  31140 MiB |
|       from large pool |   1004 MiB |  11380 MiB |  32060 MiB |  31056 MiB |
|       from small pool |     96 MiB |    126 MiB |    180 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50944 KiB |   1325 MiB |   1316 TiB |   1316 TiB |
|       from large pool |  50944 KiB |   1322 MiB |   1307 TiB |   1307 TiB |
|       from small pool |      0 KiB |     26 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7102    |  428901 K  |  428901 K  |
|       from large pool |       2    |     908    |  174519 K  |  174519 K  |
|       from small pool |       0    |    7013    |  254381 K  |  254381 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7102    |  428901 K  |  428901 K  |
|       from large pool |       2    |     908    |  174519 K  |  174519 K  |
|       from small pool |       0    |    7013    |  254381 K  |  254381 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      82    |     411    |    1053    |     971    |
|       from large pool |      34    |     348    |     963    |     929    |
|       from small pool |      48    |      63    |      90    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2963    |  227891 K  |  227891 K  |
|       from large pool |       4    |     203    |  105271 K  |  105271 K  |
|       from small pool |       0    |    2937    |  122619 K  |  122619 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jun  3 09:15:04 2024]
Finished job 0.
1 of 1 steps (100%) done
