Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Jun 13 16:39:50 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520

 Experiment start at: 2024-06-13 16:52:51.597401
before training, model accuracy: 0.9563758969306946
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9662495, 'precision': 0.5903879, 'recall': 0.50089043, 'specificity': 0.50089043, 'f1': 0.49343848, 'auroc': 0.869964, 'binary_precision': 0.21428572, 'binary_recall': 0.0020408162, 'binary_specificity': 0.99974006, 'binary_f1_score': 0.0040431265}
confusion matrix:
       0   1
0  42311  11
1   1467   3
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.5829137, 'recall': 0.5006674, 'specificity': 0.5006674, 'f1': 0.49279836, 'auroc': 0.8611543, 'binary_precision': 0.2, 'binary_recall': 0.00155521, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.00308642}
confusion matrix:
       0  1
0  18145  4
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.8559831, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-13 17:17:11.411503,epoch time: 0:24:19.814102,used: 0:24:19.814102,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9664094, 'precision': 0.7356123, 'recall': 0.5265684, 'specificity': 0.5265684, 'f1': 0.5410448, 'auroc': 0.905262, 'binary_precision': 0.5031056, 'binary_recall': 0.055027176, 'binary_specificity': 0.99810964, 'binary_f1_score': 0.09920392}
confusion matrix:
       0   1
0  42240  80
1   1391  81
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.66038465, 'recall': 0.5123652, 'specificity': 0.5123652, 'f1': 0.5156979, 'auroc': 0.9009385, 'binary_precision': 0.35416666, 'binary_recall': 0.02643857, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.04920405}
confusion matrix:
       0   1
0  18118  31
1    626  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.88958865, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_2.png
new oracle model saved
early stop counter: 1
val acc:0.9650382995605469, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9581335783004761 / 0.9582933783531189
after epoch: 2,now: 2024-06-13 17:40:35.214317,epoch time: 0:23:23.802814,used: 0:47:43.616916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9668889, 'precision': 0.75068057, 'recall': 0.5622253, 'specificity': 0.5622253, 'f1': 0.5949375, 'auroc': 0.9186929, 'binary_precision': 0.53089887, 'binary_recall': 0.12839673, 'binary_specificity': 0.9960539, 'binary_f1_score': 0.20678337}
confusion matrix:
       0    1
0  42153  167
1   1283  189
---- Validation: 
scalar performance:
{'acc': 0.96514475, 'precision': 0.71049345, 'recall': 0.54242253, 'specificity': 0.54242253, 'f1': 0.5652264, 'auroc': 0.91142505, 'binary_precision': 0.45238096, 'binary_recall': 0.08864697, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.14824449}
confusion matrix:
       0   1
0  18080  69
1    586  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.8543732, 'recall': 0.50566375, 'specificity': 0.50566375, 'f1': 0.5007502, 'auroc': 0.89803284, 'binary_precision': 0.75, 'binary_recall': 0.011494253, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.022641508}
confusion matrix:
      0  1
0  5996  1
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_3.png
new oracle model saved
early stop counter: 2
val acc:0.9651447534561157, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9581335783004761 / 0.9586129784584045
after epoch: 3,now: 2024-06-13 18:04:20.400406,epoch time: 0:23:45.186089,used: 1:11:28.803005,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9668661, 'precision': 0.7457908, 'recall': 0.5943437, 'specificity': 0.5943437, 'f1': 0.63324887, 'auroc': 0.9225586, 'binary_precision': 0.51898736, 'binary_recall': 0.19497283, 'binary_specificity': 0.9937146, 'binary_f1_score': 0.2834568}
confusion matrix:
       0    1
0  42054  266
1   1185  287
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.72005135, 'recall': 0.57912016, 'specificity': 0.57912016, 'f1': 0.61303204, 'auroc': 0.9169136, 'binary_precision': 0.46902654, 'binary_recall': 0.16485226, 'binary_specificity': 0.99338806, 'binary_f1_score': 0.24395856}
confusion matrix:
       0    1
0  18029  120
1    537  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.87975353, 'recall': 0.51515895, 'specificity': 0.51515895, 'f1': 0.5191079, 'auroc': 0.90303886, 'binary_precision': 0.8, 'binary_recall': 0.03065134, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.05904059}
confusion matrix:
      0  1
0  5995  2
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_4.png
new oracle model saved
early stop counter: 3
val acc:0.9650382995605469, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9581335783004761 / 0.9592521786689758
after epoch: 4,now: 2024-06-13 18:27:41.708757,epoch time: 0:23:21.308351,used: 1:34:50.111356,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9672086, 'precision': 0.75042856, 'recall': 0.6122923, 'specificity': 0.6122923, 'f1': 0.65259993, 'auroc': 0.9259102, 'binary_precision': 0.52704793, 'binary_recall': 0.23181508, 'binary_specificity': 0.99276954, 'binary_f1_score': 0.32200187}
confusion matrix:
       0    1
0  42015  306
1   1130  341
---- Validation: 
scalar performance:
{'acc': 0.9647722, 'precision': 0.71721166, 'recall': 0.5879831, 'specificity': 0.5879831, 'f1': 0.6223806, 'auroc': 0.9201799, 'binary_precision': 0.4627451, 'binary_recall': 0.18351477, 'binary_specificity': 0.99245137, 'binary_f1_score': 0.26280624}
confusion matrix:
       0    1
0  18012  137
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.88892126, 'recall': 0.51707464, 'specificity': 0.51707464, 'f1': 0.5227158, 'auroc': 0.9062196, 'binary_precision': 0.8181818, 'binary_recall': 0.03448276, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.06617647}
confusion matrix:
      0  1
0  5995  2
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_5.png
new oracle model saved
early stop counter: 4
val acc:0.9647722244262695, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9581335783004761 / 0.9594119787216187
after epoch: 5,now: 2024-06-13 18:51:05.991184,epoch time: 0:23:24.282427,used: 1:58:14.393783,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96734565, 'precision': 0.7541758, 'recall': 0.605739, 'specificity': 0.605739, 'f1': 0.6465614, 'auroc': 0.927936, 'binary_precision': 0.535, 'binary_recall': 0.21807066, 'binary_specificity': 0.99340737, 'binary_f1_score': 0.30984557}
confusion matrix:
       0    1
0  42041  279
1   1151  321
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.7300158, 'recall': 0.5816183, 'specificity': 0.5816183, 'f1': 0.61704206, 'auroc': 0.9221742, 'binary_precision': 0.48878923, 'binary_recall': 0.16951789, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.2517321}
confusion matrix:
       0    1
0  18035  114
1    534  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8965738, 'recall': 0.51899034, 'specificity': 0.51899034, 'f1': 0.5262976, 'auroc': 0.9079062, 'binary_precision': 0.8333333, 'binary_recall': 0.038314175, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.07326008}
confusion matrix:
      0   1
0  5995   2
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_6.png
new oracle model saved
early stop counter: 5
val acc:0.9655172228813171, best validation acc: 0.965623676776886, corresponding to test acc:                         0.9581335783004761 / 0.9595717191696167
after epoch: 6,now: 2024-06-13 19:14:37.082207,epoch time: 0:23:31.091023,used: 2:21:45.484806,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9673228, 'precision': 0.75478184, 'recall': 0.59884214, 'specificity': 0.59884214, 'f1': 0.63934726, 'auroc': 0.93114823, 'binary_precision': 0.53667265, 'binary_recall': 0.20380434, 'binary_specificity': 0.99388, 'binary_f1_score': 0.29542097}
confusion matrix:
       0    1
0  42061  259
1   1172  300
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.73909724, 'recall': 0.58408886, 'specificity': 0.58408886, 'f1': 0.62091506, 'auroc': 0.9243216, 'binary_precision': 0.50678736, 'binary_recall': 0.17418352, 'binary_specificity': 0.9939942, 'binary_f1_score': 0.25925925}
confusion matrix:
       0    1
0  18040  109
1    531  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8728379, 'recall': 0.52082264, 'specificity': 0.52082264, 'f1': 0.5296659, 'auroc': 0.90962255, 'binary_precision': 0.78571427, 'binary_recall': 0.042145595, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.080000006}
confusion matrix:
      0   1
0  5994   3
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_7.png
better model found
persisted
after epoch: 7,now: 2024-06-13 19:38:11.028455,epoch time: 0:23:33.946248,used: 2:45:19.431054,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9673913, 'precision': 0.75142395, 'recall': 0.64051574, 'specificity': 0.64051574, 'f1': 0.67874634, 'auroc': 0.9345721, 'binary_precision': 0.52716047, 'binary_recall': 0.29008153, 'binary_specificity': 0.9909499, 'binary_f1_score': 0.37423313}
confusion matrix:
       0    1
0  41937  383
1   1045  427
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.73464197, 'recall': 0.6206763, 'specificity': 0.6206763, 'f1': 0.65750104, 'auroc': 0.9262208, 'binary_precision': 0.4953846, 'binary_recall': 0.2503888, 'binary_specificity': 0.9909637, 'binary_f1_score': 0.3326446}
confusion matrix:
       0    1
0  17985  164
1    482  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.90955055, 'recall': 0.5456435, 'specificity': 0.5456435, 'f1': 0.57318974, 'auroc': 0.9110679, 'binary_precision': 0.85714287, 'binary_recall': 0.09195402, 'binary_specificity': 0.999333, 'binary_f1_score': 0.16608995}
confusion matrix:
      0   1
0  5993   4
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_8.png
new oracle model saved
early stop counter: 1
val acc:0.965623676776886, best validation acc: 0.9659429788589478, corresponding to test acc:                         0.9595717191696167 / 0.9614893198013306
after epoch: 8,now: 2024-06-13 20:01:49.872499,epoch time: 0:23:38.844044,used: 3:08:58.275098,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96675193, 'precision': 0.7423153, 'recall': 0.6369909, 'specificity': 0.6369909, 'f1': 0.6735609, 'auroc': 0.93141174, 'binary_precision': 0.50915754, 'binary_recall': 0.2834806, 'binary_specificity': 0.99050117, 'binary_f1_score': 0.36419213}
confusion matrix:
       0    1
0  41919  402
1   1054  417
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.73697746, 'recall': 0.62150896, 'specificity': 0.62150896, 'f1': 0.6587484, 'auroc': 0.9276339, 'binary_precision': 0.5, 'binary_recall': 0.251944, 'binary_specificity': 0.9910739, 'binary_f1_score': 0.33505687}
confusion matrix:
       0    1
0  17987  162
1    481  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.91402704, 'recall': 0.5608858, 'specificity': 0.5608858, 'f1': 0.5978065, 'auroc': 0.912385, 'binary_precision': 0.8648649, 'binary_recall': 0.12260536, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.2147651}
confusion matrix:
      0   1
0  5992   5
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_9.png
new oracle model saved
early stop counter: 2
val acc:0.9657832980155945, best validation acc: 0.9659429788589478, corresponding to test acc:                         0.9595717191696167 / 0.9626078605651855
after epoch: 9,now: 2024-06-13 20:25:34.441238,epoch time: 0:23:44.568739,used: 3:32:42.843837,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96819055, 'precision': 0.76500726, 'recall': 0.62640536, 'specificity': 0.62640536, 'f1': 0.6689447, 'auroc': 0.9298166, 'binary_precision': 0.5552326, 'binary_recall': 0.26004085, 'binary_specificity': 0.9927699, 'binary_f1_score': 0.35419565}
confusion matrix:
       0    1
0  42017  306
1   1087  382
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.7380494, 'recall': 0.593812, 'specificity': 0.593812, 'f1': 0.63155717, 'auroc': 0.929101, 'binary_precision': 0.50403225, 'binary_recall': 0.19440125, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.28058362}
confusion matrix:
       0    1
0  18026  123
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.8803623, 'recall': 0.53031784, 'specificity': 0.53031784, 'f1': 0.5467638, 'auroc': 0.9139555, 'binary_precision': 0.8, 'binary_recall': 0.06130268, 'binary_specificity': 0.999333, 'binary_f1_score': 0.11387901}
confusion matrix:
      0   1
0  5993   4
1   245  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_10.png
early stop counter: 3
val acc:0.9658897519111633, best validation acc: 0.9659429788589478, corresponding to test acc:                         0.9595717191696167 / 0.9626078605651855
after epoch: 10,now: 2024-06-13 20:49:01.931818,epoch time: 0:23:27.490580,used: 3:56:10.334417,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.967711, 'precision': 0.7556635, 'recall': 0.6446154, 'specificity': 0.6446154, 'f1': 0.6832466, 'auroc': 0.93372726, 'binary_precision': 0.5353659, 'binary_recall': 0.2982337, 'binary_specificity': 0.99099714, 'binary_f1_score': 0.38307154}
confusion matrix:
       0    1
0  41939  381
1   1033  439
---- Validation: 
scalar performance:
{'acc': 0.96620905, 'precision': 0.74356896, 'recall': 0.6112286, 'specificity': 0.6112286, 'f1': 0.6503065, 'auroc': 0.9302496, 'binary_precision': 0.5138889, 'binary_recall': 0.23017107, 'binary_specificity': 0.9922861, 'binary_f1_score': 0.3179377}
confusion matrix:
       0    1
0  18009  140
1    495  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.91209084, 'recall': 0.54755926, 'specificity': 0.54755926, 'f1': 0.57639176, 'auroc': 0.9146213, 'binary_precision': 0.86206895, 'binary_recall': 0.09578544, 'binary_specificity': 0.999333, 'binary_f1_score': 0.1724138}
confusion matrix:
      0   1
0  5993   4
1   236  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_11.png
better model found
persisted
after epoch: 11,now: 2024-06-13 21:12:17.028795,epoch time: 0:23:15.096977,used: 4:19:25.431394,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9682134, 'precision': 0.7611283, 'recall': 0.65864545, 'specificity': 0.65864545, 'f1': 0.69616693, 'auroc': 0.9337805, 'binary_precision': 0.54535145, 'binary_recall': 0.3267663, 'binary_specificity': 0.9905246, 'binary_f1_score': 0.4086661}
confusion matrix:
       0    1
0  41919  401
1    991  481
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.7383492, 'recall': 0.6125634, 'specificity': 0.6125634, 'f1': 0.65065837, 'auroc': 0.93139595, 'binary_precision': 0.5033557, 'binary_recall': 0.2332815, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.31880978}
confusion matrix:
       0    1
0  18001  148
1    493  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.9144669, 'recall': 0.54947495, 'specificity': 0.54947495, 'f1': 0.579572, 'auroc': 0.91554815, 'binary_precision': 0.8666667, 'binary_recall': 0.099616855, 'binary_specificity': 0.999333, 'binary_f1_score': 0.17869414}
confusion matrix:
      0   1
0  5993   4
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_12.png
early stop counter: 1
val acc:0.9658897519111633, best validation acc: 0.9662090539932251, corresponding to test acc:                         0.9616490602493286 / 0.9626078605651855
after epoch: 12,now: 2024-06-13 21:35:43.065787,epoch time: 0:23:26.036992,used: 4:42:51.468386,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9683275, 'precision': 0.76519936, 'recall': 0.64075893, 'specificity': 0.64075893, 'f1': 0.68213767, 'auroc': 0.9334599, 'binary_precision': 0.5546875, 'binary_recall': 0.2895989, 'binary_specificity': 0.9919189, 'binary_f1_score': 0.38052702}
confusion matrix:
       0    1
0  41979  342
1   1045  426
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.74266315, 'recall': 0.6119511, 'specificity': 0.6119511, 'f1': 0.6508522, 'auroc': 0.9325274, 'binary_precision': 0.5120275, 'binary_recall': 0.23172629, 'binary_specificity': 0.9921759, 'binary_f1_score': 0.31905782}
confusion matrix:
       0    1
0  18007  142
1    494  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.8936369, 'recall': 0.536065, 'specificity': 0.536065, 'f1': 0.55684584, 'auroc': 0.91635776, 'binary_precision': 0.82608694, 'binary_recall': 0.07279693, 'binary_specificity': 0.999333, 'binary_f1_score': 0.13380282}
confusion matrix:
      0   1
0  5993   4
1   242  19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_13.png
early stop counter: 2
val acc:0.9661558270454407, best validation acc: 0.9662090539932251, corresponding to test acc:                         0.9616490602493286 / 0.9626078605651855
after epoch: 13,now: 2024-06-13 21:59:12.900576,epoch time: 0:23:29.834789,used: 5:06:21.303175,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96800786, 'precision': 0.7611555, 'recall': 0.63657254, 'specificity': 0.63657254, 'f1': 0.6775266, 'auroc': 0.93679345, 'binary_precision': 0.5468956, 'binary_recall': 0.28125, 'binary_specificity': 0.9918951, 'binary_f1_score': 0.37146702}
confusion matrix:
       0    1
0  41977  343
1   1058  414
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.7421838, 'recall': 0.5939222, 'specificity': 0.5939222, 'f1': 0.6322453, 'auroc': 0.93342364, 'binary_precision': 0.51229507, 'binary_recall': 0.19440125, 'binary_specificity': 0.9934432, 'binary_f1_score': 0.28184894}
confusion matrix:
       0    1
0  18030  119
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8973372, 'recall': 0.5379807, 'specificity': 0.5379807, 'f1': 0.5601599, 'auroc': 0.91680574, 'binary_precision': 0.8333333, 'binary_recall': 0.07662835, 'binary_specificity': 0.999333, 'binary_f1_score': 0.14035088}
confusion matrix:
      0   1
0  5993   4
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_14.png
early stop counter: 3
val acc:0.9661026000976562, best validation acc: 0.9662090539932251, corresponding to test acc:                         0.9616490602493286 / 0.9626078605651855
after epoch: 14,now: 2024-06-13 22:22:11.014569,epoch time: 0:22:58.113993,used: 5:29:19.417168,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96828187, 'precision': 0.76569176, 'recall': 0.63605857, 'specificity': 0.63605857, 'f1': 0.6780375, 'auroc': 0.936329, 'binary_precision': 0.5560054, 'binary_recall': 0.2798913, 'binary_specificity': 0.9922259, 'binary_f1_score': 0.37234524}
confusion matrix:
       0    1
0  41991  329
1   1060  412
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.7455367, 'recall': 0.5917547, 'specificity': 0.5917547, 'f1': 0.630316, 'auroc': 0.9343954, 'binary_precision': 0.51914895, 'binary_recall': 0.18973562, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.27790433}
confusion matrix:
       0    1
0  18036  113
1    521  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.88960725, 'recall': 0.5341493, 'specificity': 0.5341493, 'f1': 0.5535086, 'auroc': 0.9172902, 'binary_precision': 0.8181818, 'binary_recall': 0.06896552, 'binary_specificity': 0.999333, 'binary_f1_score': 0.12720849}
confusion matrix:
      0   1
0  5993   4
1   243  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_15.png
better model found
persisted
after epoch: 15,now: 2024-06-13 22:44:47.992261,epoch time: 0:22:36.977692,used: 5:51:56.394860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96864724, 'precision': 0.76843333, 'recall': 0.65165704, 'specificity': 0.65165704, 'f1': 0.69230044, 'auroc': 0.939503, 'binary_precision': 0.5604396, 'binary_recall': 0.31182066, 'binary_specificity': 0.9914934, 'binary_f1_score': 0.40069842}
confusion matrix:
       0    1
0  41960  360
1   1013  459
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.7400486, 'recall': 0.61186844, 'specificity': 0.61186844, 'f1': 0.65029985, 'auroc': 0.93520254, 'binary_precision': 0.50680274, 'binary_recall': 0.23172629, 'binary_specificity': 0.9920106, 'binary_f1_score': 0.3180363}
confusion matrix:
       0    1
0  18004  145
1    494  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.90955055, 'recall': 0.5456435, 'specificity': 0.5456435, 'f1': 0.57318974, 'auroc': 0.91774166, 'binary_precision': 0.85714287, 'binary_recall': 0.09195402, 'binary_specificity': 0.999333, 'binary_f1_score': 0.16608995}
confusion matrix:
      0   1
0  5993   4
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_16.png
early stop counter: 1
val acc:0.9659961462020874, best validation acc: 0.9662622213363647, corresponding to test acc:                         0.9605305194854736 / 0.9626078605651855
after epoch: 16,now: 2024-06-13 23:07:22.933502,epoch time: 0:22:34.941241,used: 6:14:31.336101,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96903545, 'precision': 0.77129114, 'recall': 0.66628367, 'specificity': 0.66628367, 'f1': 0.70499945, 'auroc': 0.93790513, 'binary_precision': 0.56516856, 'binary_recall': 0.34171197, 'binary_specificity': 0.9908554, 'binary_f1_score': 0.42591026}
confusion matrix:
       0    1
0  41933  387
1    969  503
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.7441672, 'recall': 0.6202568, 'specificity': 0.6202568, 'f1': 0.6590608, 'auroc': 0.93579614, 'binary_precision': 0.51446944, 'binary_recall': 0.2488336, 'binary_specificity': 0.99167997, 'binary_f1_score': 0.33542976}
confusion matrix:
       0    1
0  17998  151
1    483  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.9144669, 'recall': 0.54947495, 'specificity': 0.54947495, 'f1': 0.579572, 'auroc': 0.9182254, 'binary_precision': 0.8666667, 'binary_recall': 0.099616855, 'binary_specificity': 0.999333, 'binary_f1_score': 0.17869414}
confusion matrix:
      0   1
0  5993   4
1   235  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_17.png
early stop counter: 2
val acc:0.9662622213363647, best validation acc: 0.9662622213363647, corresponding to test acc:                         0.9605305194854736 / 0.9626078605651855
after epoch: 17,now: 2024-06-13 23:30:22.243780,epoch time: 0:22:59.310278,used: 6:37:30.646379,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96910393, 'precision': 0.7756846, 'recall': 0.6496909, 'specificity': 0.6496909, 'f1': 0.6923375, 'auroc': 0.9355669, 'binary_precision': 0.5750636, 'binary_recall': 0.30727395, 'binary_specificity': 0.9921079, 'binary_f1_score': 0.40053165}
confusion matrix:
       0    1
0  41987  334
1   1019  452
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.74841213, 'recall': 0.5963377, 'specificity': 0.5963377, 'f1': 0.63570917, 'auroc': 0.9365779, 'binary_precision': 0.52459013, 'binary_recall': 0.19906688, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.28861332}
confusion matrix:
       0    1
0  18033  116
1    515  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.8852012, 'recall': 0.53223354, 'specificity': 0.53223354, 'f1': 0.550148, 'auroc': 0.91887844, 'binary_precision': 0.8095238, 'binary_recall': 0.0651341, 'binary_specificity': 0.999333, 'binary_f1_score': 0.120567374}
confusion matrix:
      0   1
0  5993   4
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_18.png
better model found
persisted
after epoch: 18,now: 2024-06-13 23:54:07.851781,epoch time: 0:23:45.608001,used: 7:01:16.254380,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9687843, 'precision': 0.769272, 'recall': 0.6579572, 'specificity': 0.6579572, 'f1': 0.6977519, 'auroc': 0.9388331, 'binary_precision': 0.5616921, 'binary_recall': 0.32472825, 'binary_specificity': 0.9911862, 'binary_f1_score': 0.4115368}
confusion matrix:
       0    1
0  41947  373
1    994  478
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.74263275, 'recall': 0.6134512, 'specificity': 0.6134512, 'f1': 0.65230316, 'auroc': 0.93714523, 'binary_precision': 0.5118644, 'binary_recall': 0.2348367, 'binary_specificity': 0.99206567, 'binary_f1_score': 0.3219616}
confusion matrix:
       0    1
0  18005  144
1    492  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.91669476, 'recall': 0.55139065, 'specificity': 0.55139065, 'f1': 0.5827308, 'auroc': 0.91913116, 'binary_precision': 0.87096775, 'binary_recall': 0.10344828, 'binary_specificity': 0.999333, 'binary_f1_score': 0.18493152}
confusion matrix:
      0   1
0  5993   4
1   234  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_19.png
early stop counter: 1
val acc:0.9661558270454407, best validation acc: 0.966421902179718, corresponding to test acc:                         0.9603707194328308 / 0.9626078605651855
after epoch: 19,now: 2024-06-14 00:17:16.211283,epoch time: 0:23:08.359502,used: 7:24:24.613882,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96885276, 'precision': 0.7702664, 'recall': 0.65799266, 'specificity': 0.65799266, 'f1': 0.69803584, 'auroc': 0.9400512, 'binary_precision': 0.5636792, 'binary_recall': 0.32472825, 'binary_specificity': 0.9912571, 'binary_f1_score': 0.41206896}
confusion matrix:
       0    1
0  41950  370
1    994  478
---- Validation: 
scalar performance:
{'acc': 0.9660494, 'precision': 0.74091786, 'recall': 0.6111459, 'specificity': 0.6111459, 'f1': 0.6497543, 'auroc': 0.93784606, 'binary_precision': 0.50859106, 'binary_recall': 0.23017107, 'binary_specificity': 0.9921208, 'binary_f1_score': 0.31691647}
confusion matrix:
       0    1
0  18006  143
1    495  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8973372, 'recall': 0.5379807, 'specificity': 0.5379807, 'f1': 0.5601599, 'auroc': 0.91970426, 'binary_precision': 0.8333333, 'binary_recall': 0.07662835, 'binary_specificity': 0.999333, 'binary_f1_score': 0.14035088}
confusion matrix:
      0   1
0  5993   4
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_20.png
early stop counter: 2
val acc:0.9660493731498718, best validation acc: 0.966421902179718, corresponding to test acc:                         0.9603707194328308 / 0.9626078605651855
after epoch: 20,now: 2024-06-14 00:40:13.916076,epoch time: 0:22:57.704793,used: 7:47:22.318675,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9684417, 'precision': 0.7660631, 'recall': 0.6476164, 'specificity': 0.6476164, 'f1': 0.68829715, 'auroc': 0.9416745, 'binary_precision': 0.55597013, 'binary_recall': 0.30366847, 'binary_specificity': 0.9915643, 'binary_f1_score': 0.3927944}
confusion matrix:
       0    1
0  41963  357
1   1025  447
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.75082743, 'recall': 0.6031708, 'specificity': 0.6031708, 'f1': 0.6433246, 'auroc': 0.93786556, 'binary_precision': 0.52895755, 'binary_recall': 0.21306376, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.3037694}
confusion matrix:
       0    1
0  18027  122
1    506  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.8800577, 'recall': 0.5227384, 'specificity': 0.5227384, 'f1': 0.5331842, 'auroc': 0.9192171, 'binary_precision': 0.8, 'binary_recall': 0.04597701, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.08695652}
confusion matrix:
      0   1
0  5994   3
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_21.png
better model found
persisted
after epoch: 21,now: 2024-06-14 01:03:02.349621,epoch time: 0:22:48.433545,used: 8:10:10.752220,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96876144, 'precision': 0.7664334, 'recall': 0.6714958, 'specificity': 0.6714958, 'f1': 0.70768046, 'auroc': 0.9419719, 'binary_precision': 0.55508024, 'binary_recall': 0.3528212, 'binary_specificity': 0.99017036, 'binary_f1_score': 0.43142146}
confusion matrix:
       0    1
0  41905  416
1    952  519
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.74474573, 'recall': 0.6285349, 'specificity': 0.6285349, 'f1': 0.6667392, 'auroc': 0.93822575, 'binary_precision': 0.51506025, 'binary_recall': 0.2659409, 'binary_specificity': 0.991129, 'binary_f1_score': 0.35076922}
confusion matrix:
       0    1
0  17988  161
1    472  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.9039017, 'recall': 0.5418121, 'specificity': 0.5418121, 'f1': 0.56671965, 'auroc': 0.9199356, 'binary_precision': 0.84615386, 'binary_recall': 0.08429119, 'binary_specificity': 0.999333, 'binary_f1_score': 0.1533101}
confusion matrix:
      0   1
0  5993   4
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_22.png
early stop counter: 1
val acc:0.9663154482841492, best validation acc: 0.9665815234184265, corresponding to test acc:                         0.9597315192222595 / 0.9626078605651855
after epoch: 22,now: 2024-06-14 01:25:57.156199,epoch time: 0:22:54.806578,used: 8:33:05.558798,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96949214, 'precision': 0.7846283, 'recall': 0.643242, 'specificity': 0.643242, 'f1': 0.68854016, 'auroc': 0.94152904, 'binary_precision': 0.5934066, 'binary_recall': 0.29347825, 'binary_specificity': 0.9930057, 'binary_f1_score': 0.3927273}
confusion matrix:
       0    1
0  42024  296
1   1040  432
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.75402784, 'recall': 0.59572536, 'specificity': 0.59572536, 'f1': 0.6357905, 'auroc': 0.93868357, 'binary_precision': 0.53586495, 'binary_recall': 0.19751166, 'binary_specificity': 0.99393904, 'binary_f1_score': 0.28863636}
confusion matrix:
       0    1
0  18039  110
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.86451936, 'recall': 0.51890695, 'specificity': 0.51890695, 'f1': 0.5261222, 'auroc': 0.9204064, 'binary_precision': 0.7692308, 'binary_recall': 0.038314175, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0729927}
confusion matrix:
      0   1
0  5994   3
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_23.png
better model found
persisted
after epoch: 23,now: 2024-06-14 01:48:46.345770,epoch time: 0:22:49.189571,used: 8:55:54.748369,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96873856, 'precision': 0.76535666, 'recall': 0.6752038, 'specificity': 0.6752038, 'f1': 0.7101585, 'auroc': 0.9423553, 'binary_precision': 0.55265903, 'binary_recall': 0.3605442, 'binary_specificity': 0.98986346, 'binary_f1_score': 0.4363936}
confusion matrix:
       0    1
0  41893  429
1    940  530
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.74527156, 'recall': 0.63756317, 'specificity': 0.63756317, 'f1': 0.6747296, 'auroc': 0.9392415, 'binary_precision': 0.515493, 'binary_recall': 0.28460342, 'binary_specificity': 0.9905229, 'binary_f1_score': 0.3667335}
confusion matrix:
       0    1
0  17977  172
1    460  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.9039017, 'recall': 0.5418121, 'specificity': 0.5418121, 'f1': 0.56671965, 'auroc': 0.92053795, 'binary_precision': 0.84615386, 'binary_recall': 0.08429119, 'binary_specificity': 0.999333, 'binary_f1_score': 0.1533101}
confusion matrix:
      0   1
0  5993   4
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_24.png
early stop counter: 1
val acc:0.9663686752319336, best validation acc: 0.9666879773139954, corresponding to test acc:                         0.9594119787216187 / 0.9626078605651855
after epoch: 24,now: 2024-06-14 02:11:49.416041,epoch time: 0:23:03.070271,used: 9:18:57.818640,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96910393, 'precision': 0.77551675, 'recall': 0.6503471, 'specificity': 0.6503471, 'f1': 0.6928674, 'auroc': 0.9415097, 'binary_precision': 0.57468355, 'binary_recall': 0.3086336, 'binary_specificity': 0.99206066, 'binary_f1_score': 0.40159222}
confusion matrix:
       0    1
0  41985  336
1   1017  454
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7558391, 'recall': 0.6108367, 'specificity': 0.6108367, 'f1': 0.6519989, 'auroc': 0.93972075, 'binary_precision': 0.53846157, 'binary_recall': 0.22861587, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.3209607}
confusion matrix:
       0    1
0  18023  126
1    496  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.86451936, 'recall': 0.51890695, 'specificity': 0.51890695, 'f1': 0.5261222, 'auroc': 0.92025846, 'binary_precision': 0.7692308, 'binary_recall': 0.038314175, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0729927}
confusion matrix:
      0   1
0  5994   3
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_25.png
better model found
persisted
after epoch: 25,now: 2024-06-14 02:34:51.840691,epoch time: 0:23:02.424650,used: 9:42:00.243290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96837324, 'precision': 0.7674108, 'recall': 0.6351223, 'specificity': 0.6351223, 'f1': 0.67754525, 'auroc': 0.9402064, 'binary_precision': 0.55950755, 'binary_recall': 0.27785325, 'binary_specificity': 0.9923913, 'binary_f1_score': 0.37131187}
confusion matrix:
       0    1
0  41998  322
1   1063  409
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.75278676, 'recall': 0.5964478, 'specificity': 0.5964478, 'f1': 0.63641834, 'auroc': 0.94011813, 'binary_precision': 0.53333336, 'binary_recall': 0.19906688, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.28992075}
confusion matrix:
       0    1
0  18037  112
1    515  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.88892126, 'recall': 0.51707464, 'specificity': 0.51707464, 'f1': 0.5227158, 'auroc': 0.9203684, 'binary_precision': 0.8181818, 'binary_recall': 0.03448276, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.06617647}
confusion matrix:
      0  1
0  5995  2
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_26.png
early stop counter: 1
val acc:0.9666347503662109, best validation acc: 0.9669008255004883, corresponding to test acc:                         0.9594119787216187 / 0.9626078605651855
after epoch: 26,now: 2024-06-14 02:57:49.379159,epoch time: 0:22:57.538468,used: 10:04:57.781758,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96857876, 'precision': 0.76854765, 'recall': 0.6457201, 'specificity': 0.6457201, 'f1': 0.6872424, 'auroc': 0.9435489, 'binary_precision': 0.5610687, 'binary_recall': 0.2995924, 'binary_specificity': 0.9918478, 'binary_f1_score': 0.39061114}
confusion matrix:
       0    1
0  41975  345
1   1031  441
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7586949, 'recall': 0.61166936, 'specificity': 0.61166936, 'f1': 0.6533083, 'auroc': 0.9404272, 'binary_precision': 0.5441176, 'binary_recall': 0.23017107, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.32349724}
confusion matrix:
       0    1
0  18025  124
1    495  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.86451936, 'recall': 0.51890695, 'specificity': 0.51890695, 'f1': 0.5261222, 'auroc': 0.92067266, 'binary_precision': 0.7692308, 'binary_recall': 0.038314175, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0729927}
confusion matrix:
      0   1
0  5994   3
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_27.png
better model found
persisted
after epoch: 27,now: 2024-06-14 03:20:52.124688,epoch time: 0:23:02.745529,used: 10:28:00.527287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96976614, 'precision': 0.778897, 'recall': 0.6760638, 'specificity': 0.6760638, 'f1': 0.71477807, 'auroc': 0.9425857, 'binary_precision': 0.57969433, 'binary_recall': 0.3612245, 'binary_specificity': 0.9909031, 'binary_f1_score': 0.4450964}
confusion matrix:
       0    1
0  41937  385
1    939  531
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.7500355, 'recall': 0.63247806, 'specificity': 0.63247806, 'f1': 0.6714086, 'auroc': 0.9408179, 'binary_precision': 0.52537316, 'binary_recall': 0.27371696, 'binary_specificity': 0.9912392, 'binary_f1_score': 0.35991818}
confusion matrix:
       0    1
0  17990  159
1    467  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.9054425, 'recall': 0.5323169, 'specificity': 0.5323169, 'f1': 0.55040425, 'auroc': 0.9208574, 'binary_precision': 0.85, 'binary_recall': 0.0651341, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.12099644}
confusion matrix:
      0   1
0  5994   3
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_28.png
early stop counter: 1
val acc:0.9666879773139954, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9594119787216187 / 0.9626078605651855
after epoch: 28,now: 2024-06-14 03:44:05.916997,epoch time: 0:23:13.792309,used: 10:51:14.319596,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9691725, 'precision': 0.775548, 'recall': 0.65586305, 'specificity': 0.65586305, 'f1': 0.6975834, 'auroc': 0.940745, 'binary_precision': 0.57439023, 'binary_recall': 0.3199728, 'binary_specificity': 0.9917533, 'binary_f1_score': 0.41099474}
confusion matrix:
       0    1
0  41971  349
1   1001  471
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.75673616, 'recall': 0.6176423, 'specificity': 0.6176423, 'f1': 0.65892404, 'auroc': 0.94112784, 'binary_precision': 0.53979236, 'binary_recall': 0.24261275, 'binary_specificity': 0.9926718, 'binary_f1_score': 0.33476394}
confusion matrix:
       0    1
0  18016  133
1    487  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.8800577, 'recall': 0.5227384, 'specificity': 0.5227384, 'f1': 0.5331842, 'auroc': 0.92113984, 'binary_precision': 0.8, 'binary_recall': 0.04597701, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.08695652}
confusion matrix:
      0   1
0  5994   3
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_29.png
early stop counter: 2
val acc:0.9670072197914124, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9594119787216187 / 0.9626078605651855
after epoch: 29,now: 2024-06-14 04:07:22.115039,epoch time: 0:23:16.198042,used: 11:14:30.517638,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96924096, 'precision': 0.7763442, 'recall': 0.6556675, 'specificity': 0.6556675, 'f1': 0.6976135, 'auroc': 0.94352317, 'binary_precision': 0.57598037, 'binary_recall': 0.31951055, 'binary_specificity': 0.9918244, 'binary_f1_score': 0.41101882}
confusion matrix:
       0    1
0  41975  346
1   1001  470
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.7637722, 'recall': 0.616335, 'specificity': 0.616335, 'f1': 0.65884966, 'auroc': 0.9413815, 'binary_precision': 0.5539568, 'binary_recall': 0.23950233, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.33441913}
confusion matrix:
       0    1
0  18025  124
1    489  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8728379, 'recall': 0.52082264, 'specificity': 0.52082264, 'f1': 0.5296659, 'auroc': 0.92101014, 'binary_precision': 0.78571427, 'binary_recall': 0.042145595, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.080000006}
confusion matrix:
      0   1
0  5994   3
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_30.png
better model found
persisted
after epoch: 30,now: 2024-06-14 04:30:27.457990,epoch time: 0:23:05.342951,used: 11:37:35.860589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_13_16_52_51_seed_0_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:37:35.860589 at 2024-06-14 04:30:27.457990
persisted model performance metric: 

scalar performance:
{'acc': 0.9595717, 'precision': 0.8728379, 'recall': 0.52082264, 'specificity': 0.52082264, 'f1': 0.5296659, 'auroc': 0.92101014, 'binary_precision': 0.78571427, 'binary_recall': 0.042145595, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.080000006}
confusion matrix:
      0   1
0  5994   3
1   250  11
oracle model performance metric: 

scalar performance:
{'acc': 0.96260786, 'precision': 0.91402704, 'recall': 0.5608858, 'specificity': 0.5608858, 'f1': 0.5978065, 'auroc': 0.912385, 'binary_precision': 0.8648649, 'binary_recall': 0.12260536, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.2147651}
confusion matrix:
      0   1
0  5992   5
1   229  32
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 688276 KiB |   1449 MiB | 462791 GiB | 462790 GiB |
|       from large pool | 684800 KiB |   1444 MiB | 451910 GiB | 451909 GiB |
|       from small pool |   3476 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 688276 KiB |   1449 MiB | 462791 GiB | 462790 GiB |
|       from large pool | 684800 KiB |   1444 MiB | 451910 GiB | 451909 GiB |
|       from small pool |   3476 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 687268 KiB |   1445 MiB | 461987 GiB | 461987 GiB |
|       from large pool | 684800 KiB |   1441 MiB | 451125 GiB | 451124 GiB |
|       from small pool |   2468 KiB |      6 MiB |  10862 GiB |  10862 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1628 MiB |   1628 MiB |   1628 MiB |      0 B   |
|       from large pool |   1618 MiB |   1618 MiB |   1618 MiB |      0 B   |
|       from small pool |     10 MiB |     10 MiB |     10 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116587 KiB | 226744 KiB | 201124 GiB | 201123 GiB |
|       from large pool | 113920 KiB | 225536 KiB | 190206 GiB | 190206 GiB |
|       from small pool |   2667 KiB |   3932 KiB |  10917 GiB |  10917 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2916    |    5887    |   90915 K  |   90912 K  |
|       from large pool |     100    |     205    |   28247 K  |   28247 K  |
|       from small pool |    2816    |    5786    |   62667 K  |   62665 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2916    |    5887    |   90915 K  |   90912 K  |
|       from large pool |     100    |     205    |   28247 K  |   28247 K  |
|       from small pool |    2816    |    5786    |   62667 K  |   62665 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      79    |      79    |      79    |       0    |
|       from large pool |      74    |      74    |      74    |       0    |
|       from small pool |       5    |       5    |       5    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      53    |    2784    |   39156 K  |   39156 K  |
|       from large pool |      39    |      69    |   11234 K  |   11234 K  |
|       from small pool |      14    |    2745    |   27921 K  |   27921 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1449 MiB | 462791 GiB | 462791 GiB |
|       from large pool |  16640 KiB |   1444 MiB | 451910 GiB | 451910 GiB |
|       from small pool |      0 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1449 MiB | 462791 GiB | 462791 GiB |
|       from large pool |  16640 KiB |   1444 MiB | 451910 GiB | 451910 GiB |
|       from small pool |      0 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1445 MiB | 461987 GiB | 461987 GiB |
|       from large pool |  16640 KiB |   1441 MiB | 451125 GiB | 451125 GiB |
|       from small pool |      0 KiB |      6 MiB |  10862 GiB |  10862 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   1628 MiB |   1628 MiB |    842 MiB |
|       from large pool |    780 MiB |   1618 MiB |   1618 MiB |    838 MiB |
|       from small pool |      6 MiB |     10 MiB |     10 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 226744 KiB | 201124 GiB | 201124 GiB |
|       from large pool |  24320 KiB | 225536 KiB | 190206 GiB | 190206 GiB |
|       from small pool |      0 KiB |   5055 KiB |  10917 GiB |  10917 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5887    |   90915 K  |   90915 K  |
|       from large pool |       2    |     205    |   28247 K  |   28247 K  |
|       from small pool |       0    |    5786    |   62667 K  |   62667 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5887    |   90915 K  |   90915 K  |
|       from large pool |       2    |     205    |   28247 K  |   28247 K  |
|       from small pool |       0    |    5786    |   62667 K  |   62667 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      79    |      79    |      37    |
|       from large pool |      39    |      74    |      74    |      35    |
|       from small pool |       3    |       5    |       5    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2784    |   39157 K  |   39157 K  |
|       from large pool |       2    |      69    |   11234 K  |   11234 K  |
|       from small pool |       0    |    2745    |   27922 K  |   27922 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1449 MiB | 462791 GiB | 462791 GiB |
|       from large pool |  16640 KiB |   1444 MiB | 451910 GiB | 451910 GiB |
|       from small pool |      0 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1449 MiB | 462791 GiB | 462791 GiB |
|       from large pool |  16640 KiB |   1444 MiB | 451910 GiB | 451910 GiB |
|       from small pool |      0 KiB |      8 MiB |  10881 GiB |  10881 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1445 MiB | 461987 GiB | 461987 GiB |
|       from large pool |  16640 KiB |   1441 MiB | 451125 GiB | 451125 GiB |
|       from small pool |      0 KiB |      6 MiB |  10862 GiB |  10862 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    786 MiB |   1628 MiB |   1628 MiB |    842 MiB |
|       from large pool |    780 MiB |   1618 MiB |   1618 MiB |    838 MiB |
|       from small pool |      6 MiB |     10 MiB |     10 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 226744 KiB | 201124 GiB | 201124 GiB |
|       from large pool |  24320 KiB | 225536 KiB | 190206 GiB | 190206 GiB |
|       from small pool |      0 KiB |   5055 KiB |  10917 GiB |  10917 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5887    |   90915 K  |   90915 K  |
|       from large pool |       2    |     205    |   28247 K  |   28247 K  |
|       from small pool |       0    |    5786    |   62667 K  |   62667 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5887    |   90915 K  |   90915 K  |
|       from large pool |       2    |     205    |   28247 K  |   28247 K  |
|       from small pool |       0    |    5786    |   62667 K  |   62667 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      79    |      79    |      37    |
|       from large pool |      39    |      74    |      74    |      35    |
|       from small pool |       3    |       5    |       5    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    2784    |   39157 K  |   39157 K  |
|       from large pool |       2    |      69    |   11234 K  |   11234 K  |
|       from small pool |       0    |    2745    |   27922 K  |   27922 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_04_39_19_seed_1_21316520

 Experiment start at: 2024-06-14 04:39:19.750360
before training, model accuracy: 0.04785691574215889
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96664083, 'precision': 0.48355195, 'recall': 0.49975243, 'specificity': 0.49975243, 'f1': 0.49151874, 'auroc': 0.7999873, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99950486, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  42393  21
1   1442   0
---- Validation: 
scalar performance:
{'acc': 0.9635539, 'precision': 0.48203418, 'recall': 0.49972326, 'specificity': 0.49972326, 'f1': 0.49071938, 'auroc': 0.8293593, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18057  10
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95617145, 'precision': 0.47901195, 'recall': 0.49899092, 'specificity': 0.49899092, 'f1': 0.48879734, 'auroc': 0.7831716, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5934  12
1   260   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-14 05:03:00.111771,epoch time: 0:23:40.361411,used: 0:23:40.361411,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_04_39_19_seed_1_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96705127, 'precision': 0.68362266, 'recall': 0.50197434, 'specificity': 0.50197434, 'f1': 0.49574172, 'auroc': 0.8866626, 'binary_precision': 0.4, 'binary_recall': 0.0041608876, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.008236102}
confusion matrix:
       0  1
0  42405  9
1   1436  6
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.4820428, 'recall': 0.4999723, 'specificity': 0.4999723, 'f1': 0.49084386, 'auroc': 0.9048264, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18066  1
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.47903225, 'recall': 0.49949545, 'specificity': 0.49949545, 'f1': 0.4890499, 'auroc': 0.88685817, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5940  6
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-14 05:26:08.307156,epoch time: 0:23:08.195385,used: 0:46:48.556796,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_04_39_19_seed_1_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9672109, 'precision': 0.7388804, 'recall': 0.543256, 'specificity': 0.543256, 'f1': 0.5677024, 'auroc': 0.90906096, 'binary_precision': 0.507874, 'binary_recall': 0.089459084, 'binary_specificity': 0.99705285, 'binary_f1_score': 0.15212265}
confusion matrix:
       0    1
0  42289  125
1   1313  129
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.7151633, 'recall': 0.54052114, 'specificity': 0.54052114, 'f1': 0.5623124, 'auroc': 0.9211656, 'binary_precision': 0.46341464, 'binary_recall': 0.08469539, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.14321609}
confusion matrix:
       0   1
0  18001  66
1    616  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.5416062, 'recall': 0.5013344, 'specificity': 0.5013344, 'f1': 0.49277943, 'auroc': 0.9050902, 'binary_precision': 0.125, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.0074626864}
confusion matrix:
      0  1
0  5939  7
1   259  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_3.png
early stop counter: 1
val acc:0.9636072516441345, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9571382403373718 / 0.9571382403373718
after epoch: 3,now: 2024-06-14 05:49:24.475289,epoch time: 0:23:16.168133,used: 1:10:04.724929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_04_39_19_seed_1_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9674161, 'precision': 0.74457586, 'recall': 0.5627893, 'specificity': 0.5627893, 'f1': 0.5953991, 'auroc': 0.9132674, 'binary_precision': 0.51800555, 'binary_recall': 0.12968099, 'binary_specificity': 0.9958976, 'binary_f1_score': 0.20743205}
confusion matrix:
       0    1
0  42240  174
1   1255  187
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.73211956, 'recall': 0.57218665, 'specificity': 0.57218665, 'f1': 0.60594475, 'auroc': 0.92737085, 'binary_precision': 0.49509802, 'binary_recall': 0.15007429, 'binary_specificity': 0.994299, 'binary_f1_score': 0.23033066}
confusion matrix:
       0    1
0  17964  103
1    572  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7297188, 'recall': 0.5165509, 'specificity': 0.5165509, 'f1': 0.5216604, 'auroc': 0.9113151, 'binary_precision': 0.5, 'binary_recall': 0.034615386, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.064748205}
confusion matrix:
      0  1
0  5937  9
1   251  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_4.png
new oracle model saved
early stop counter: 2
val acc:0.9639807939529419, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9571382403373718 / 0.9581050872802734
after epoch: 4,now: 2024-06-14 06:12:43.370860,epoch time: 0:23:18.895571,used: 1:33:23.620500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_04_39_19_seed_1_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9679405, 'precision': 0.75295377, 'recall': 0.5995702, 'specificity': 0.5995702, 'f1': 0.63994646, 'auroc': 0.9197993, 'binary_precision': 0.5323741, 'binary_recall': 0.20527045, 'binary_specificity': 0.99386996, 'binary_f1_score': 0.29629627}
confusion matrix:
       0    1
0  42154  260
1   1146  296
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.7456485, 'recall': 0.60258764, 'specificity': 0.60258764, 'f1': 0.6417833, 'auroc': 0.9314331, 'binary_precision': 0.52, 'binary_recall': 0.21248142, 'binary_specificity': 0.99269384, 'binary_f1_score': 0.30168775}
confusion matrix:
       0    1
0  17935  132
1    530  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.80314744, 'recall': 0.53753656, 'specificity': 0.53753656, 'f1': 0.5583746, 'auroc': 0.91496885, 'binary_precision': 0.6451613, 'binary_recall': 0.07692308, 'binary_specificity': 0.99815, 'binary_f1_score': 0.13745706}
confusion matrix:
      0   1
0  5935  11
1   240  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-14 06:36:00.791576,epoch time: 0:23:17.420716,used: 1:56:41.041216,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_04_39_19_seed_1_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9674617, 'precision': 0.74305713, 'recall': 0.6060217, 'specificity': 0.6060217, 'f1': 0.64514244, 'auroc': 0.9221653, 'binary_precision': 0.5121556, 'binary_recall': 0.21914008, 'binary_specificity': 0.9929033, 'binary_f1_score': 0.30694512}
confusion matrix:
       0    1
0  42113  301
1   1126  316
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.7531109, 'recall': 0.6121352, 'specificity': 0.6121352, 'f1': 0.6527165, 'auroc': 0.93371236, 'binary_precision': 0.53424656, 'binary_recall': 0.23179792, 'binary_specificity': 0.99247247, 'binary_f1_score': 0.32331604}
confusion matrix:
       0    1
0  17931  136
1    517  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.79882336, 'recall': 0.53937554, 'specificity': 0.53937554, 'f1': 0.5613167, 'auroc': 0.9170976, 'binary_precision': 0.6363636, 'binary_recall': 0.08076923, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.14334472}
confusion matrix:
      0   1
0  5934  12
1   239  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_6.png
better model found
persisted
after epoch: 6,now: 2024-06-14 06:59:10.693956,epoch time: 0:23:09.902380,used: 2:19:50.943596,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_04_39_19_seed_1_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9676441, 'precision': 0.7452453, 'recall': 0.6369316, 'specificity': 0.6369316, 'f1': 0.6742499, 'auroc': 0.92350733, 'binary_precision': 0.51450187, 'binary_recall': 0.28294036, 'binary_specificity': 0.9909228, 'binary_f1_score': 0.36510068}
confusion matrix:
       0    1
0  42029  385
1   1034  408
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.75161964, 'recall': 0.6443776, 'specificity': 0.6443776, 'f1': 0.6819475, 'auroc': 0.93547916, 'binary_precision': 0.52894735, 'binary_recall': 0.2986627, 'binary_specificity': 0.99009246, 'binary_f1_score': 0.38176638}
confusion matrix:
       0    1
0  17888  179
1    472  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.8258598, 'recall': 0.5584381, 'specificity': 0.5584381, 'f1': 0.5916038, 'auroc': 0.918699, 'binary_precision': 0.6888889, 'binary_recall': 0.11923077, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.2032787}
confusion matrix:
      0   1
0  5932  14
1   229  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-14 07:22:20.361321,epoch time: 0:23:09.667365,used: 2:43:00.610961,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_04_39_19_seed_1_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96782655, 'precision': 0.74856853, 'recall': 0.62329286, 'specificity': 0.62329286, 'f1': 0.66285056, 'auroc': 0.9244193, 'binary_precision': 0.52204835, 'binary_recall': 0.25450763, 'binary_specificity': 0.99207807, 'binary_f1_score': 0.34219113}
confusion matrix:
       0    1
0  42078  336
1   1075  367
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.74271834, 'recall': 0.60608095, 'specificity': 0.60608095, 'f1': 0.6449014, 'auroc': 0.9369359, 'binary_precision': 0.5138889, 'binary_recall': 0.21991085, 'binary_specificity': 0.99225104, 'binary_f1_score': 0.3080125}
confusion matrix:
       0    1
0  17927  140
1    525  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8628533, 'recall': 0.5550124, 'specificity': 0.5550124, 'f1': 0.58740956, 'auroc': 0.92091984, 'binary_precision': 0.7631579, 'binary_recall': 0.11153846, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.19463088}
confusion matrix:
      0   1
0  5937   9
1   231  29
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_8.png
new oracle model saved
early stop counter: 1
val acc:0.964514434337616, best validation acc: 0.9652614593505859, corresponding to test acc:                         0.9608443379402161 / 0.9613277316093445
after epoch: 8,now: 2024-06-14 07:45:29.140493,epoch time: 0:23:08.779172,used: 3:06:09.390133,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_04_39_19_seed_1_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9674389, 'precision': 0.74240303, 'recall': 0.6227575, 'specificity': 0.6227575, 'f1': 0.6610986, 'auroc': 0.92558825, 'binary_precision': 0.5097493, 'binary_recall': 0.25381416, 'binary_specificity': 0.9917008, 'binary_f1_score': 0.33888888}
confusion matrix:
       0    1
0  42062  352
1   1076  366
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.74849427, 'recall': 0.62489927, 'specificity': 0.62489927, 'f1': 0.6641281, 'auroc': 0.93822855, 'binary_precision': 0.52409637, 'binary_recall': 0.25854382, 'binary_specificity': 0.99125475, 'binary_f1_score': 0.34626862}
confusion matrix:
       0    1
0  17909  158
1    499  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.85634935, 'recall': 0.5568514, 'specificity': 0.5568514, 'f1': 0.5900925, 'auroc': 0.9219837, 'binary_precision': 0.75, 'binary_recall': 0.115384616, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.2}
confusion matrix:
      0   1
0  5936  10
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_9.png
early stop counter: 2
val acc:0.9649413228034973, best validation acc: 0.9652614593505859, corresponding to test acc:                         0.9608443379402161 / 0.9613277316093445
after epoch: 9,now: 2024-06-14 08:08:29.904248,epoch time: 0:23:00.763755,used: 3:29:10.153888,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_04_39_19_seed_1_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9677125, 'precision': 0.7458578, 'recall': 0.65337956, 'specificity': 0.65337956, 'f1': 0.6878452, 'auroc': 0.9288634, 'binary_precision': 0.5146396, 'binary_recall': 0.31692094, 'binary_specificity': 0.98983824, 'binary_f1_score': 0.39227465}
confusion matrix:
       0    1
0  41983  431
1    985  457
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.7486, 'recall': 0.649989, 'specificity': 0.649989, 'f1': 0.6857854, 'auroc': 0.939621, 'binary_precision': 0.5225, 'binary_recall': 0.31054977, 'binary_specificity': 0.9894282, 'binary_f1_score': 0.38956195}
confusion matrix:
       0    1
0  17876  191
1    464  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.8457531, 'recall': 0.5756617, 'specificity': 0.5756617, 'f1': 0.617271, 'auroc': 0.92310345, 'binary_precision': 0.72727275, 'binary_recall': 0.15384616, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.25396827}
confusion matrix:
      0   1
0  5931  15
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_10.png
new oracle model saved
early stop counter: 3
val acc:0.9650480151176453, best validation acc: 0.9652614593505859, corresponding to test acc:                         0.9608443379402161 / 0.9621334075927734
after epoch: 10,now: 2024-06-14 08:31:23.269707,epoch time: 0:22:53.365459,used: 3:52:03.519347,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_04_39_19_seed_1_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9678493, 'precision': 0.7493336, 'recall': 0.61761045, 'specificity': 0.61761045, 'f1': 0.65764093, 'auroc': 0.929255, 'binary_precision': 0.52395207, 'binary_recall': 0.24271844, 'binary_specificity': 0.99250245, 'binary_f1_score': 0.33175352}
confusion matrix:
       0    1
0  42096  318
1   1092  350
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.74542534, 'recall': 0.606164, 'specificity': 0.606164, 'f1': 0.6454255, 'auroc': 0.9398835, 'binary_precision': 0.51929826, 'binary_recall': 0.21991085, 'binary_specificity': 0.9924171, 'binary_f1_score': 0.30897704}
confusion matrix:
       0    1
0  17930  137
1    525  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.8254007, 'recall': 0.53770477, 'specificity': 0.53770477, 'f1': 0.55893445, 'auroc': 0.9231036, 'binary_precision': 0.6896552, 'binary_recall': 0.07692308, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.13840832}
confusion matrix:
      0   1
0  5937   9
1   240  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_11.png
early stop counter: 4
val acc:0.9646744728088379, best validation acc: 0.9652614593505859, corresponding to test acc:                         0.9608443379402161 / 0.9621334075927734
after epoch: 11,now: 2024-06-14 08:54:02.939882,epoch time: 0:22:39.670175,used: 4:14:43.189522,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_04_39_19_seed_1_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9681913, 'precision': 0.7549721, 'recall': 0.62080187, 'specificity': 0.62080187, 'f1': 0.66175216, 'auroc': 0.9323312, 'binary_precision': 0.5350224, 'binary_recall': 0.24895978, 'binary_specificity': 0.99264395, 'binary_f1_score': 0.33980122}
confusion matrix:
       0    1
0  42102  312
1   1083  359
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.74619853, 'recall': 0.60833746, 'specificity': 0.60833746, 'f1': 0.6477511, 'auroc': 0.9410167, 'binary_precision': 0.52068967, 'binary_recall': 0.2243685, 'binary_specificity': 0.9923064, 'binary_f1_score': 0.3136033}
confusion matrix:
       0    1
0  17928  139
1    522  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.84860945, 'recall': 0.5473201, 'specificity': 0.5473201, 'f1': 0.5749664, 'auroc': 0.92422575, 'binary_precision': 0.7352941, 'binary_recall': 0.09615385, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.17006804}
confusion matrix:
      0   1
0  5937   9
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_12.png
early stop counter: 5
val acc:0.9647278785705566, best validation acc: 0.9652614593505859, corresponding to test acc:                         0.9608443379402161 / 0.9621334075927734
after epoch: 12,now: 2024-06-14 09:16:49.035336,epoch time: 0:22:46.095454,used: 4:37:29.284976,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_04_39_19_seed_1_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9677125, 'precision': 0.74684787, 'recall': 0.6205543, 'specificity': 0.6205543, 'f1': 0.65995556, 'auroc': 0.928892, 'binary_precision': 0.51878613, 'binary_recall': 0.24895978, 'binary_specificity': 0.9921488, 'binary_f1_score': 0.33645737}
confusion matrix:
       0    1
0  42081  333
1   1083  359
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.7476237, 'recall': 0.6133997, 'specificity': 0.6133997, 'f1': 0.6530251, 'auroc': 0.9416648, 'binary_precision': 0.5231788, 'binary_recall': 0.23476969, 'binary_specificity': 0.99202967, 'binary_f1_score': 0.32410255}
confusion matrix:
       0    1
0  17923  144
1    515  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.84860945, 'recall': 0.5473201, 'specificity': 0.5473201, 'f1': 0.5749664, 'auroc': 0.92468643, 'binary_precision': 0.7352941, 'binary_recall': 0.09615385, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.17006804}
confusion matrix:
      0   1
0  5937   9
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_13.png
early stop counter: 6
val acc:0.9648345708847046, best validation acc: 0.9652614593505859, corresponding to test acc:                         0.9608443379402161 / 0.9621334075927734
after epoch: 13,now: 2024-06-14 09:39:26.958993,epoch time: 0:22:37.923657,used: 5:00:07.208633,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_04_39_19_seed_1_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9684194, 'precision': 0.75769114, 'recall': 0.62996346, 'specificity': 0.62996346, 'f1': 0.6708581, 'auroc': 0.9304291, 'binary_precision': 0.5398601, 'binary_recall': 0.26768377, 'binary_specificity': 0.9922431, 'binary_f1_score': 0.35790452}
confusion matrix:
       0    1
0  42085  329
1   1056  386
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.7467596, 'recall': 0.61337197, 'specificity': 0.61337197, 'f1': 0.65284514, 'auroc': 0.9420659, 'binary_precision': 0.5214521, 'binary_recall': 0.23476969, 'binary_specificity': 0.9919743, 'binary_f1_score': 0.3237705}
confusion matrix:
       0    1
0  17922  145
1    515  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.82447565, 'recall': 0.5414668, 'specificity': 0.5414668, 'f1': 0.56511146, 'auroc': 0.9249416, 'binary_precision': 0.6875, 'binary_recall': 0.08461539, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.15068494}
confusion matrix:
      0   1
0  5936  10
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_14.png
early stop counter: 7
val acc:0.9647812247276306, best validation acc: 0.9652614593505859, corresponding to test acc:                         0.9608443379402161 / 0.9621334075927734
after epoch: 14,now: 2024-06-14 10:02:17.701618,epoch time: 0:22:50.742625,used: 5:22:57.951258,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_04_39_19_seed_1_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9685334, 'precision': 0.7592485, 'recall': 0.6323671, 'specificity': 0.6323671, 'f1': 0.67337465, 'auroc': 0.9343116, 'binary_precision': 0.54281765, 'binary_recall': 0.27253816, 'binary_specificity': 0.99219596, 'binary_f1_score': 0.36288092}
confusion matrix:
       0    1
0  42083  331
1   1049  393
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.74844784, 'recall': 0.6256146, 'specificity': 0.6256146, 'f1': 0.66477686, 'auroc': 0.94275486, 'binary_precision': 0.52395207, 'binary_recall': 0.2600297, 'binary_specificity': 0.99119943, 'binary_f1_score': 0.34756702}
confusion matrix:
       0    1
0  17908  159
1    498  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.82447565, 'recall': 0.5414668, 'specificity': 0.5414668, 'f1': 0.56511146, 'auroc': 0.92550135, 'binary_precision': 0.6875, 'binary_recall': 0.08461539, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.15068494}
confusion matrix:
      0   1
0  5936  10
1   238  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_15.png
early stop counter: 8
val acc:0.9649413228034973, best validation acc: 0.9652614593505859, corresponding to test acc:                         0.9608443379402161 / 0.9621334075927734
after epoch: 15,now: 2024-06-14 10:25:28.262714,epoch time: 0:23:10.561096,used: 5:46:08.512354,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_04_39_19_seed_1_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.968921, 'precision': 0.7609142, 'recall': 0.66438794, 'specificity': 0.66438794, 'f1': 0.70065355, 'auroc': 0.9325754, 'binary_precision': 0.5440357, 'binary_recall': 0.33841887, 'binary_specificity': 0.990357, 'binary_f1_score': 0.41727236}
confusion matrix:
       0    1
0  42005  409
1    954  488
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.75147223, 'recall': 0.64652336, 'specificity': 0.64652336, 'f1': 0.68369746, 'auroc': 0.94325626, 'binary_precision': 0.5284974, 'binary_recall': 0.30312034, 'binary_specificity': 0.9899264, 'binary_f1_score': 0.38526914}
confusion matrix:
       0    1
0  17885  182
1    469  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.83238554, 'recall': 0.549075, 'specificity': 0.549075, 'f1': 0.5774306, 'auroc': 0.92596376, 'binary_precision': 0.7027027, 'binary_recall': 0.1, 'binary_specificity': 0.99815, 'binary_f1_score': 0.17508417}
confusion matrix:
      0   1
0  5935  11
1   234  26
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_16.png
early stop counter: 9
val acc:0.9652614593505859, best validation acc: 0.9652614593505859, corresponding to test acc:                         0.9608443379402161 / 0.9621334075927734
after epoch: 16,now: 2024-06-14 10:48:23.749117,epoch time: 0:22:55.486403,used: 6:09:03.998757,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_04_39_19_seed_1_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.968807, 'precision': 0.76494193, 'recall': 0.6268143, 'specificity': 0.6268143, 'f1': 0.6693671, 'auroc': 0.93254435, 'binary_precision': 0.5545723, 'binary_recall': 0.26074895, 'binary_specificity': 0.9928797, 'binary_f1_score': 0.354717}
confusion matrix:
       0    1
0  42112  302
1   1066  376
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.75100327, 'recall': 0.5984344, 'specificity': 0.5984344, 'f1': 0.63816565, 'auroc': 0.94346046, 'binary_precision': 0.53100777, 'binary_recall': 0.20356612, 'binary_specificity': 0.9933027, 'binary_f1_score': 0.2943072}
confusion matrix:
       0    1
0  17946  121
1    536  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.8210999, 'recall': 0.52825755, 'specificity': 0.52825755, 'f1': 0.542804, 'auroc': 0.9260768, 'binary_precision': 0.6818182, 'binary_recall': 0.057692308, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.10638298}
confusion matrix:
      0   1
0  5939   7
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_17.png
early stop counter: 10
val acc:0.9649413228034973, best validation acc: 0.9652614593505859, corresponding to test acc:                         0.9608443379402161 / 0.9621334075927734
after epoch: 17,now: 2024-06-14 11:11:17.997351,epoch time: 0:22:54.248234,used: 6:31:58.246991,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_14_04_39_19_seed_1_21316520
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96851057, 'precision': 0.7567988, 'recall': 0.6468514, 'specificity': 0.6468514, 'f1': 0.6854398, 'auroc': 0.9359516, 'binary_precision': 0.5369458, 'binary_recall': 0.30256766, 'binary_specificity': 0.99113524, 'binary_f1_score': 0.3870395}
confusion matrix:
       0    1
0  42039  376
1   1005  436
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.7528769, 'recall': 0.6293569, 'specificity': 0.6293569, 'f1': 0.66911614, 'auroc': 0.94442356, 'binary_precision': 0.5325444, 'binary_recall': 0.26745912, 'binary_specificity': 0.99125475, 'binary_f1_score': 0.35608307}
confusion matrix:
       0    1
0  17909  158
1    493  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.8237355, 'recall': 0.54522884, 'specificity': 0.54522884, 'f1': 0.57116365, 'auroc': 0.9266713, 'binary_precision': 0.6857143, 'binary_recall': 0.092307694, 'binary_specificity': 0.99815, 'binary_f1_score': 0.16271187}
confusion matrix:
      0   1
0  5935  11
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21316520_18.png
[Fri Jun 14 11:34:01 2024]
Error in rule run_experiment:
    jobid: 0
    input: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_vit_resnet_dinov2_bs16_different_learningrates/rule_results/8.csv

--- Logging error ---
Traceback (most recent call last):
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 628, in save
    _save(obj, opened_zipfile, pickle_module, pickle_protocol, _disable_byteorder_record)
  File "/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/serialization.py", line 862, in _save
    zip_file.write_record(name, storage, num_bytes)
RuntimeError: [enforce fail at inline_container.cc:764] . PytorchStreamWriter failed writing file data/84: file write failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
Shutting down, this might take some time.
--- Logging error ---
