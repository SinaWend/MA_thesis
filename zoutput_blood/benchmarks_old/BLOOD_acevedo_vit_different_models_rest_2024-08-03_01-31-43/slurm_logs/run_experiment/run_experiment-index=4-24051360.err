Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug  3 09:32:48 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051360

 Experiment start at: 2024-08-03 09:44:33.662619
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.044287413358688354
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91831654, 'precision': 0.8342333, 'recall': 0.7140435, 'specificity': 0.9908602, 'f1': 0.7375686, 'auroc': 0.99023247}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   276     0   0    24    1    8    45     0    20   15     94
1     0  1208   0    31    0    0     1    59    16    0     16
2     0     0  26    11   33   14     0    18    52  138     20
3     0     0   0  8213    0   11     2    63   142    2      2
4     0     0   6     7  151    5     2     1   111   21    235
5     0     0   0    74    0  407     0     0     7   32      1
6     2     0   0    23    2    5  1800     0    18    4     54
7     0     6   0   699    1    0     4  6342   175    1     36
8     0     1   1   212    1    4     6    35  2996    1     37
9     0     0   5    25    1  179     0     0    12  268      3
10    2     0   1    12   14    3    13    10   104    1  12636
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9176675, 'precision': 0.85088897, 'recall': 0.72239727, 'specificity': 0.9907952, 'f1': 0.7467687, 'auroc': 0.98968196}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   276     0   0    20    0    8    45     1    20   17     96
1     0  1201   0    30    1    1     0    65    20    0     14
2     0     0  35    14   27   17     0     8    51  145     15
3     0     0   0  8220    0   17     1    61   141    0      0
4     0     0   3     7  161    4     1     1   108   19    235
5     0     0   0    62    0  418     0     0     7   33      1
6     2     0   0    21    1    5  1810     1    25    5     38
7     1     3   0   758    3    0     9  6270   183    0     38
8     0     1   1   219    1    4     3    33  2996    2     36
9     1     0   4    24    0  158     0     3    16  285      2
10    4     0   0    10   16    2    12    10   106    1  12635
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5249423, 'precision': 0.5629626, 'recall': 0.45981425, 'specificity': 0.95277905, 'f1': 0.4410525, 'auroc': 0.8430114}
confusion matrix:
     0    1   2    3   4    5     6    7     8    9     10
0   480    0   0  166   0   68   161    7   161   94    33
1     1  945   0   83  17    2    36  270    32    5   108
2     1    0   1   82  32   40     7    6   576   77   193
3     0    0   0    0   0    0     0    0     0    0     0
4     0    0   0    1  67    0     0    0    62    0  1503
5     0    0   0  136   1  415     0    0     7   31     2
6     0    0   0   17  56    0  1824    1   449    0   720
7     0    0   0  480   0    1     6  661     7    1     8
8     0    0   0  183   0    3     0    0  1178    2     4
9     2    1   2  294  12  276     3    8   224  287    28
10    0    0   0    0   0    0     0    0     1    0  1645
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 10:37:48.749606,epoch time: 0:53:15.086987,used: 0:53:15.086987,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.941219, 'precision': 0.862182, 'recall': 0.79960525, 'specificity': 0.99355054, 'f1': 0.8117402, 'auroc': 0.9948131}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     0    0     0    0    0     2     3     4    7     46
1     4  1219    0    16    0    0     0    68    22    1      2
2     4     0  107     0   45    0     0     4     9  137      6
3     4     0    0  7945    0   22     8   282   160   16      1
4     4     0   24     0  248    0     0     2    17   25    217
5     2     0    0    22    0  272     0     0     6  218      1
6    15     0    1     2    2    0  1848     0     3    3     34
7    10     4    3   177    1    0     8  6951    88    4     16
8     8     0    1   100   10    6     2    68  3007   17     77
9     3     0    8     3    0   22     0     2     4  448      3
10   16     1    0     8   13    0     5    14    19    5  12713
---- Validation: 
scalar performance:
{'acc': 0.93992245, 'precision': 0.8557589, 'recall': 0.79445285, 'specificity': 0.9934004, 'f1': 0.8058285, 'auroc': 0.99455404}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   416     0    0     3    0    0     3     3     2    6     50
1     5  1213    0    20    0    0     0    69    21    1      3
2     1     0  102     1   47    0     0     6     8  139      8
3     8     0    0  7980    0   30     4   268   138   12      0
4     4     0   23     1  250    0     1     4    21   23    212
5     2     0    0    21    0  268     0     0     5  224      1
6    24     0    0     1    1    0  1833     1     3    6     39
7     6     5    2   181    1    0     6  6939    96    5     24
8    12     0    2   102   14    3     3    70  2990   15     85
9     2     0    8     4    0   25     0     1     6  444      3
10   24     0    0     8   15    0     4    17    17    7  12704
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.727419, 'precision': 0.6744925, 'recall': 0.60222536, 'specificity': 0.97259617, 'f1': 0.5821682, 'auroc': 0.88100404}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1140     0   0    3    0    0     4    2     0   21     0
1     48  1104   2   48    0    0    17  251     7   11    11
2     70     0  62   13  252    0    20   32   194  254   118
3      0     0   0    0    0    0     0    0     0    0     0
4      5     0   2    0  252    0     6    1    10    2  1355
5     11     0   0   18    0  155     2    0     5  400     1
6      2     0   0    3    7    0  3023    1     2    1    28
7     12     0   0  125    0    0    45  963     0   16     3
8      8     0   0   99    6    1    12    3  1214   25     2
9     62     4  36   33    6   10     0   22   110  839    15
10     0     0   0    0    1    0     0    0     0    0  1645
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 11:29:02.808931,epoch time: 0:51:14.059325,used: 1:44:29.146312,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9547838, 'precision': 0.8691171, 'recall': 0.8379476, 'specificity': 0.99506545, 'f1': 0.84835833, 'auroc': 0.9968026}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     4    0    0     6     3     4    4     23
1     0  1275    0     7    0    0     0    41     7    0      2
2     1     0  171     1   52    5     0     8     7   63      4
3     2     3    0  8205    0   15     0   118    95    0      0
4     5     0   35     2  270    3     0     3    24   10    187
5     0     0    2    19    0  471     0     0     6   22      1
6    16     3    0     5    2    2  1852     3     7    2     16
7     1    10    1   186    1    2     1  6992    62    0      8
8     2     0    8   104    4    7     1    77  3059    1     32
9     2     0   39     5    0  158     0     2     4  283      0
10   30     1    3     8   19    3     9    14    33    2  12670
---- Validation: 
scalar performance:
{'acc': 0.9536445, 'precision': 0.86988354, 'recall': 0.8352557, 'specificity': 0.9949285, 'f1': 0.84706783, 'auroc': 0.996271}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     1    0     4    1    2     5     5     3    4     21
1     0  1277    0    11    0    0     0    38     5    0      1
2     1     1  169     2   47    5     0     6    10   66      5
3     2     2    1  8204    0   19     1   128    82    1      0
4     7     2   25     3  270    3     0     2    28    7    192
5     0     0    0    25    0  464     0     0     4   27      1
6    16     2    1     2    2    2  1859     3     6    1     14
7     1     8    2   202    1    0     1  6962    76    2     10
8     2     1    4   114    4    2     1    75  3060    1     32
9     1     0   38     7    1  157     0     2     7  280      0
10   37     0    3     8   19    2     8    14    34    1  12670
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7120269, 'precision': 0.6390678, 'recall': 0.61709756, 'specificity': 0.9711235, 'f1': 0.58732474, 'auroc': 0.8706407}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1048     0    0   14    0   45    19     8    13   14     9
1      2  1271    0   23    0    1     4   169     6    1    22
2     17     1  135   21  204   40     9    27   237   50   274
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    0    0  113    0     1     1    11    0  1507
5      2     0    0   58    0  499     2     0     6   24     1
6      0     0    0   14    8    0  2887     2     7    0   149
7      2     0    1  119    0    1    23  1013     0    0     5
8      0     0    0   78    1    7     4    11  1265    1     3
9     20    10  159   67   14  280     3    38   210  302    34
10     0     0    0    0    2    0     0     0     0    0  1644
better model found
persisted
after epoch: 3,now: 2024-08-03 12:20:55.587822,epoch time: 0:51:52.778891,used: 2:36:21.925203,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9460884, 'precision': 0.85806394, 'recall': 0.82371056, 'specificity': 0.99413204, 'f1': 0.833374, 'auroc': 0.996271}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   346     0    0     5    1    2    29     1    15   12     72
1     0  1281    0    12    0    2     0    31     6    0      0
2     0     0  185     2    5   13     1     2     8   94      2
3     0     1    1  8304    0   29     5    42    56    1      0
4     1     0   96     1  264    3     1     3    41   13    116
5     0     0    0    20    0  490     0     0     2    8      1
6     5     0    0     4    1    2  1859     0     6    2     28
7     0    12    3   430    1    2     4  6676   119    0     15
8     0     1    4   185    5    5     0    31  3045    1     18
9     0     0    9     7    0  192     0     0     4  281      0
10    1     0   15     9   67    2     6    11    50    2  12630
---- Validation: 
scalar performance:
{'acc': 0.9468236, 'precision': 0.8542755, 'recall': 0.8208381, 'specificity': 0.99423385, 'f1': 0.82914263, 'auroc': 0.996277}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   350     0    0     4    0    5    28     2     9   14     71
1     0  1286    0     6    0    0     0    32     7    1      0
2     0     0  184     3    4    9     0     3    11   97      1
3     0     3    0  8298    0   29     4    40    65    1      0
4     1     0  112     3  245    5     0     4    35    9    125
5     0     0    1    13    0  492     0     0     1   13      1
6     2     0    0     4    1    3  1847     0     7    2     42
7     0    13    5   386    1    1     2  6721   128    2      6
8     0     0    4   182    4    9     1    23  3061    1     11
9     0     0   16     7    0  191     0     1     3  275      0
10    2     0    9    10   64    3     3     9    58    0  12638
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70719934, 'precision': 0.6869651, 'recall': 0.61169064, 'specificity': 0.97093225, 'f1': 0.6087116, 'auroc': 0.8748918}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   766     1    1    9    1   77   152    0     6  120    37
1     0  1256    6   31    3    5     2  159    13    9    15
2     0     1  285   14  118   74     7   14   321  103    78
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    7    0  436    0     1    1    24    1  1163
5     0     0    0   22    1  540     1    0     1   25     2
6     0     0    1    2    5    1  2879    1    22    1   155
7     0     0    4  449    0    2    13  678    10    5     3
8     0     0    0  174    0   15     4    0  1175    2     0
9     0     5   80   53    1  408     3   14    96  462    15
10    0     0    1    0   14    0     0    0     0    0  1631
early stop counter: 1
val acc:0.9468235969543457, best validation acc: 0.9536445140838623, corresponding to test acc:                         0.7120268940925598 / 0.7274190187454224
after epoch: 4,now: 2024-08-03 13:12:19.902351,epoch time: 0:51:24.314529,used: 3:27:46.239732,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9596265, 'precision': 0.903507, 'recall': 0.8581419, 'specificity': 0.9954457, 'f1': 0.8752105, 'auroc': 0.99729717}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    1     3    0    0     6     0     1    1     13
1     0  1269    0     8    0    0     0    46     5    0      3
2     7     0  200     1   29    0     1    10     6   47     11
3     0     0    0  8170    0    6     1   161   101    0      0
4     6     0   19     2  272    1     3     3    12    5    216
5     0     0    2    41    0  405     0     0     8   64      1
6    12     0    0     2    1    0  1871     1     1    0     19
7     0     6    0   135    1    0     2  7054    42    0     23
8     2     0    2    64    2    0     0    64  3087    0     75
9    10     0   41    10    1   45     2     3     2  377      2
10   52     0    0     9    5    1     8     3     9    1  12704
---- Validation: 
scalar performance:
{'acc': 0.9598502, 'precision': 0.90044487, 'recall': 0.8564849, 'specificity': 0.9954829, 'f1': 0.87346464, 'auroc': 0.9974071}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     3    0    0     3     1     1    2     17
1     0  1270    0     7    0    0     0    46     4    0      5
2     5     0  195     1   35    0     2    18     5   42      9
3     0     0    0  8179    0    2     3   156    97    3      0
4     9     0   17     0  280    1     4     3    11    3    211
5     0     0    0    42    0  406     0     0     7   65      1
6    19     0    1     3    1    0  1868     1     2    0     13
7     0     5    0   143    1    0     2  7057    33    0     24
8     2     0    4    58    2    0     0    59  3103    1     67
9     9     0   41     9    0   54     0     2     6  368      4
10   51     0    1     8    7    1     8     8     9    1  12702
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7160848, 'precision': 0.64579463, 'recall': 0.59901446, 'specificity': 0.9715641, 'f1': 0.5852363, 'auroc': 0.8739477}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1118     0    0   12    0    0    26     5     3    3     3
1      2  1149    0   29    0    0     2   287     6    0    24
2     29     0   90   27  181   10    48    47   255   61   267
3      0     0    0    0    0    0     0     0     0    0     0
4      3     0    1    1  133    0     3     2    11    0  1479
5      8     0    0  145    1  278     4     0     2  152     2
6      0     0    0    5    0    0  3048     1     3    0    10
7      0     0    0   44    0    0     2  1114     1    0     3
8      0     0    0  128    0    1     5     6  1226    2     2
9     28     4  153  205    4   59    23    69   124  436    32
10     0     0    0    0    2    0     1     0     0    0  1643
better model found
persisted
after epoch: 5,now: 2024-08-03 14:02:38.458961,epoch time: 0:50:18.556610,used: 4:18:04.796342,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96107125, 'precision': 0.89715546, 'recall': 0.8649364, 'specificity': 0.99566776, 'f1': 0.87710965, 'auroc': 0.9977121}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    0     8    0    0     0     2     1    3     18
1     0  1265    0    11    0    0     0    50     4    0      1
2     3     0  208     1   14    3     0     7     4   69      3
3     0     1    1  8329    0    5     0    64    37    1      0
4     4     1   49     2  305    3     0     5    11    4    155
5     1     0    1    35    0  441     0     1     4   37      1
6    47     1    1    11    3    1  1805     2     5    2     30
7     0     2    0   195    1    0     1  7047    11    0      7
8     1     1    5   115    2    4     0   133  3000    1     33
9     1     0   25     6    0   86     0     7     1  367      0
10   32     1    3     9   16    1     1     9    17    0  12703
---- Validation: 
scalar performance:
{'acc': 0.96113414, 'precision': 0.8957311, 'recall': 0.8649845, 'specificity': 0.99567467, 'f1': 0.8762803, 'auroc': 0.9976255}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     6    0    1     1     0     1    5     17
1     0  1271    0     8    0    0     0    51     2    0      0
2     1     0  207     2   13    2     0    11     7   67      2
3     1     0    0  8323    0    6     0    70    40    0      0
4     4     0   59     1  298    2     0     4    13    3    155
5     0     0    0    35    0  445     0     0     4   36      1
6    48     1    1    10    4    1  1798     4     4    1     36
7     0     4    0   195    1    0     1  7044    10    0     10
8     1     0    6   119    4    1     0   121  3014    1     29
9     1     0   29     8    0   81     0     4     0  369      1
10   32     0    4     7   15    2     1     9    15    0  12711
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68600017, 'precision': 0.65815115, 'recall': 0.5800428, 'specificity': 0.9688424, 'f1': 0.569246, 'auroc': 0.86191005}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1117     1    0   27    0    2     3    10     1    5     4
1      2  1102    0   34    0    0     0   325     3    0    33
2     16     0  141   43   92   31     2    83   286   54   267
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    2    0  126    0     1     1    18    0  1484
5     11     0    0  192    1  300     1     0     4   80     3
6     11     0    0   32    0    0  2824     3    49    0   148
7      1     0    0  133    0    0     0  1026     0    0     4
8      0     0    0  165    0    0     1    31  1170    2     1
9     25     0  115  223    3  103     0   154   124  357    33
10     0     0    0    0    3    0     0     0     1    0  1642
better model found
persisted
after epoch: 6,now: 2024-08-03 14:54:14.571795,epoch time: 0:51:36.112834,used: 5:09:40.909176,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9671982, 'precision': 0.9071616, 'recall': 0.8817544, 'specificity': 0.99641275, 'f1': 0.89369845, 'auroc': 0.9982661}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     0    0     5    1    1     4     2     1    1     26
1     0  1285    0     6    0    0     1    37     2    0      0
2     0     0  209     2   55    2     3     8     3   23      7
3     0     2    0  8301    0    9     2    85    40    0      0
4     4     0    7     0  388    2     4     5    12    0    117
5     0     0    2    13    1  444     1     0     6   52      1
6    14     0    1     4    0    0  1877     1     3    1      7
7     0     8    0   137    1    0     2  7084    25    0      5
8     1     0    4    70    9    0    12    82  3087    0     30
9     1     1   58     6    8   66     1     3     1  347      1
10    9     0    0     7   31    2    32     8    19    0  12686
---- Validation: 
scalar performance:
{'acc': 0.9662699, 'precision': 0.90164477, 'recall': 0.8805914, 'specificity': 0.9963325, 'f1': 0.890667, 'auroc': 0.99837065}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    0     3    2    1    10     0     2    1     16
1     0  1284    0     2    0    0     0    41     5    0      0
2     0     0  204     2   57    3     1     5     4   33      3
3     0     2    0  8290    0    6     0    87    53    1      1
4     3     0    9     0  385    2     5     5    12    1    117
5     1     0    3    22    1  435     0     0     3   55      1
6    17     0    1     5    1    0  1872     1     3    1      7
7     0     5    0   147    2    0     2  7072    28    0      9
8     3     0    3    72   10    1     5    74  3099    1     28
9     1     0   67     5    2   58     0     0     3  357      0
10   10     0    0     9   31    2    39     8    19    0  12678
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7185336, 'precision': 0.6514525, 'recall': 0.6075567, 'specificity': 0.97170305, 'f1': 0.59443855, 'auroc': 0.8716096}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1055     0    0   27    0    9    33    29     4    8     5
1      4  1136    1   25    0    0     8   287     8    5    25
2      6     0  105   20  261   37   121    47   182   36   200
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    0    0  269    0    19     1    11    0  1332
5      5     0    0  137    2  389     4     0     2   50     3
6      0     0    0    1    0    0  3065     1     0    0     0
7      0     0    0   47    0    1     1  1112     0    0     3
8      0     0    0  159    1    2    17    13  1173    1     4
9     14     0  156  151   18  190    46    51   135  342    34
10     0     0    0    0   10    0    12     0     0    0  1624
better model found
persisted
after epoch: 7,now: 2024-08-03 15:45:55.563893,epoch time: 0:51:40.992098,used: 6:01:21.901274,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9684289, 'precision': 0.9200167, 'recall': 0.8962477, 'specificity': 0.996525, 'f1': 0.9072577, 'auroc': 0.9985513}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    0     2    0    0     2     1     2    2     26
1     0  1298    0     2    0    0     0    28     4    0      0
2     0     0  217     1   36    2     0     2     5   41      8
3     0     1    0  8099    0   14     0   216   106    3      0
4     3     0   18     1  376    0     0     2    11    0    128
5     1     0    1    13    1  446     0     0     3   54      2
6     4     0    1     2    0    0  1881     2     3    1     14
7     0    11    0    61    1    0     1  7160    19    2      7
8     2     1    5    36   17    3     0    68  3144    1     18
9     0     0   31     3    0   36     1     1     3  408     10
10    7     0    1     5   27    0     5     8    20    0  12719
---- Validation: 
scalar performance:
{'acc': 0.96843654, 'precision': 0.91888463, 'recall': 0.89392036, 'specificity': 0.9965266, 'f1': 0.9055282, 'auroc': 0.9983394}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     2    0    0     2     0     4    3     28
1     0  1300    0     3    0    0     0    27     2    0      0
2     0     0  225     1   34    0     0     4     2   39      7
3     0     4    0  8114    0   10     0   221    91    0      0
4     1     0   15     0  368    1     1     2    11    0    140
5     2     0    0    13    0  443     0     0     3   58      2
6     6     0    1     6    1    0  1882     0     4    0      8
7     0    12    0    61    2    0     1  7159    23    0      7
8     0     2    5    49   14    4     0    54  3155    1     12
9     0     0   36     5    1   49     0     1     2  394      5
10    7     0    1     6   26    1     6     6    21    1  12721
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74225146, 'precision': 0.67511946, 'recall': 0.62754756, 'specificity': 0.97413784, 'f1': 0.62032855, 'auroc': 0.87138015}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1021     1    0   33    1    0    37    45     6   20     6
1      0  1213    0    9    0    0     1   240     9    2    25
2      4     2  140   13  244   15    14    33   267   53   230
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    2    0  386    0     5     1    12    0  1227
5      3     0    1  123    0  338     3     0    16  100     8
6      0     0    0    5    0    0  3027     2    24    0     9
7      0     0    1   32    0    1     0  1125     2    0     3
8      0     0    0   82    4    0     2     8  1271    2     1
9      5     5  140   92   12  126     7    44   199  464    43
10     0     0    0    0   17    0     4     0     1    0  1624
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-03 16:38:36.319513,epoch time: 0:52:40.755620,used: 6:54:02.656894,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96925837, 'precision': 0.9265328, 'recall': 0.8744358, 'specificity': 0.9965414, 'f1': 0.8968485, 'auroc': 0.99815434}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    0     1    0    0     4     0     0    0     38
1     0  1307    0     3    0    0     0    19     1    0      1
2     1     0  181     1   62    1     1    14     5   41      4
3     0     4    0  8325    0    3     0    75    32    0      1
4     2     0    2     3  352    1     2     4    15    0    158
5     5     0    0    30    0  429     1     0     3   51      2
6     7     0    0     2    0    0  1879     3     2    0     14
7     0    17    0   111    1    0     1  7111    19    0      3
8     0     2    1   125    5    0     0    57  3085    1     18
9     5     0   22    18    4   47     3     5     2  387      0
10    3     0    1     7   11    1     9    12    19    0  12731
---- Validation: 
scalar performance:
{'acc': 0.9699077, 'precision': 0.9313573, 'recall': 0.87632924, 'specificity': 0.9965917, 'f1': 0.89961183, 'auroc': 0.9979354}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    0     3    0    0     4     2     1    0     39
1     0  1307    0     4    0    0     0    20     1    0      0
2     1     0  180     3   60    3     0     9     3   46      7
3     0     5    0  8334    0    2     0    71    28    0      0
4     2     0    3     3  346    0     0     4    18    0    163
5     0     0    0    31    0  438     0     0     3   48      1
6     6     0    0     7    1    0  1880     1     2    0     11
7     0    19    0   113    1    0     1  7113    13    1      4
8     1     0    0   110    4    0     3    62  3091    0     25
9     3     0   19    17    3   42     2     2     2  402      1
10    4     0    0    11   10    0    10    13    13    0  12735
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6820821, 'precision': 0.60973644, 'recall': 0.56601024, 'specificity': 0.9679958, 'f1': 0.5368142, 'auroc': 0.8368831}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1075     0   0   20    0    1    30    28     1    0    15
1      0  1093   0   18    0    0     0   347     1    1    39
2     11     0   8   29  100   13    90    92   223   20   429
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   0    0   37    0    11     1    13    0  1571
5     18     0   0  173    0  312    13     0     4   48    24
6      0     0   0    6    0    0  3051     1     0    0     9
7      0     0   0   72    0    0     0  1089     1    1     1
8      0     0   0  151    0    0    14    29  1172    2     2
9     60     1  21  186    7  100    96   181   121  269    95
10     0     0   0    0    0    0     2     1     0    0  1643
better model found
persisted
after epoch: 9,now: 2024-08-03 17:30:13.284024,epoch time: 0:51:36.964511,used: 7:45:39.621405,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9706496, 'precision': 0.93003887, 'recall': 0.8915679, 'specificity': 0.99675524, 'f1': 0.9058834, 'auroc': 0.99883413}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     6    1    0     2     1     4    4     21
1     0  1287    0     5    0    0     0    33     5    0      2
2     0     0  210     0   25    1     0     1     4   71      0
3     0     1    0  8320    0   21     0    39    53    1      0
4     2     0   11     1  328    2     0     4    18    4    169
5     0     0    0     7    0  436     0     0     2   75      1
6    14     0    0     8    0    1  1858     3     6    2     16
7     0     4    0   173    2    0     1  7006    73    1      3
8     1     0    1    43    2    2     0    13  3222    5      7
9     0     0   15     7    0   22     0     0     2  447      0
10    6     0    1     7    7    0     2     3    43    4  12721
---- Validation: 
scalar performance:
{'acc': 0.9711114, 'precision': 0.93283874, 'recall': 0.89108515, 'specificity': 0.9967902, 'f1': 0.9063165, 'auroc': 0.9987711}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     0    0     5    0    0     1     2     5    6     21
1     0  1281    0     6    0    0     0    35     6    0      4
2     0     0  204     2   23    2     2     2     2   72      3
3     0     2    0  8326    0   14     0    45    51    1      1
4     3     0   15     1  317    0     2     2    17    4    178
5     0     0    0     5    0  445     0     0     1   69      1
6     9     0    0     7    0    0  1868     2     7    2     13
7     0     3    1   169    1    0     1  7006    80    1      3
8     0     0    1    42    4    0     0    12  3227    4      6
9     0     0   14     0    0   24     0     0     0  455      0
10    5     0    1     6    3    2     4     5    35    2  12733
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6734765, 'precision': 0.63475215, 'recall': 0.5586468, 'specificity': 0.9674357, 'f1': 0.5446938, 'auroc': 0.8400647}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   893     0   0  104   0   10    44    46    12   37    24
1     0  1028   0   34   0    0    12   337    23    2    63
2     3     0  47   73  88   10   103    39   421   76   155
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   1    0  60    0     8     1    47    0  1516
5     1     0   0  155   0  276     4     0     0  155     1
6     0     0   0   25   0    0  2982     1    29    0    30
7     0     0   0   83   0    1     0  1072     5    0     3
8     0     0   0  200   0    0     1     5  1162    2     0
9     2     0  42  256   4   82    22    73   169  463    24
10    0     0   0    0   1    0     1     0     1    0  1643
better model found
persisted
after epoch: 10,now: 2024-08-03 18:21:26.301927,epoch time: 0:51:13.017903,used: 8:36:52.639308,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 8:36:52.639308 at 2024-08-03 18:21:26.301927
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6734765, 'precision': 0.63475215, 'recall': 0.5586468, 'specificity': 0.9674357, 'f1': 0.5446938, 'auroc': 0.8400647}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   893     0   0  104   0   10    44    46    12   37    24
1     0  1028   0   34   0    0    12   337    23    2    63
2     3     0  47   73  88   10   103    39   421   76   155
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   1    0  60    0     8     1    47    0  1516
5     1     0   0  155   0  276     4     0     0  155     1
6     0     0   0   25   0    0  2982     1    29    0    30
7     0     0   0   83   0    1     0  1072     5    0     3
8     0     0   0  200   0    0     1     5  1162    2     0
9     2     0  42  256   4   82    22    73   169  463    24
10    0     0   0    0   1    0     1     0     1    0  1643
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74225146, 'precision': 0.67511946, 'recall': 0.62754756, 'specificity': 0.97413784, 'f1': 0.62032855, 'auroc': 0.87138015}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1021     1    0   33    1    0    37    45     6   20     6
1      0  1213    0    9    0    0     1   240     9    2    25
2      4     2  140   13  244   15    14    33   267   53   230
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    2    0  386    0     5     1    12    0  1227
5      3     0    1  123    0  338     3     0    16  100     8
6      0     0    0    5    0    0  3027     2    24    0     9
7      0     0    1   32    0    1     0  1125     2    0     3
8      0     0    0   82    4    0     2     8  1271    2     1
9      5     5  140   92   12  126     7    44   199  464    43
10     0     0    0    0   17    0     4     0     1    0  1624
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_44_32_seed_0_24051360_instance_wise_predictions.txt
accuracy from prediction file 0.6734765269712447
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/4.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4047 MiB |  18149 MiB | 702705 GiB | 702701 GiB |
|       from large pool |   4023 MiB |  18115 MiB | 698691 GiB | 698687 GiB |
|       from small pool |     24 MiB |     35 MiB |   4014 GiB |   4014 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   4047 MiB |  18149 MiB | 702705 GiB | 702701 GiB |
|       from large pool |   4023 MiB |  18115 MiB | 698691 GiB | 698687 GiB |
|       from small pool |     24 MiB |     35 MiB |   4014 GiB |   4014 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4037 MiB |  18113 MiB | 701421 GiB | 701417 GiB |
|       from large pool |   4013 MiB |  18080 MiB | 697411 GiB | 697407 GiB |
|       from small pool |     23 MiB |     35 MiB |   4009 GiB |   4009 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  18948 MiB |  18948 MiB |  18948 MiB |      0 B   |
|       from large pool |  18910 MiB |  18910 MiB |  18910 MiB |      0 B   |
|       from small pool |     38 MiB |     38 MiB |     38 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    780 MiB |   1826 MiB | 322158 GiB | 322157 GiB |
|       from large pool |    768 MiB |   1820 MiB | 318103 GiB | 318102 GiB |
|       from small pool |     11 MiB |     18 MiB |   4054 GiB |   4054 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4612    |    5882    |   47215 K  |   47211 K  |
|       from large pool |     502    |     727    |   20508 K  |   20508 K  |
|       from small pool |    4110    |    5277    |   26707 K  |   26702 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4612    |    5882    |   47215 K  |   47211 K  |
|       from large pool |     502    |     727    |   20508 K  |   20508 K  |
|       from small pool |    4110    |    5277    |   26707 K  |   26702 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     413    |     413    |     413    |       0    |
|       from large pool |     394    |     394    |     394    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     226    |    1220    |   23884 K  |   23884 K  |
|       from large pool |     182    |     279    |   12599 K  |   12598 K  |
|       from small pool |      44    |    1038    |   11285 K  |   11285 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  18149 MiB | 702705 GiB | 702705 GiB |
|       from large pool |  16640 KiB |  18115 MiB | 698691 GiB | 698691 GiB |
|       from small pool |      0 KiB |     35 MiB |   4014 GiB |   4014 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  18149 MiB | 702705 GiB | 702705 GiB |
|       from large pool |  16640 KiB |  18115 MiB | 698691 GiB | 698691 GiB |
|       from small pool |      0 KiB |     35 MiB |   4014 GiB |   4014 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  18113 MiB | 701421 GiB | 701421 GiB |
|       from large pool |  16640 KiB |  18080 MiB | 697411 GiB | 697411 GiB |
|       from small pool |      0 KiB |     35 MiB |   4009 GiB |   4009 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4828 MiB |  18948 MiB |  18948 MiB |  14120 MiB |
|       from large pool |   4792 MiB |  18910 MiB |  18910 MiB |  14118 MiB |
|       from small pool |     36 MiB |     38 MiB |     38 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1826 MiB | 322160 GiB | 322160 GiB |
|       from large pool |  24320 KiB |   1820 MiB | 318105 GiB | 318105 GiB |
|       from small pool |      0 KiB |     29 MiB |   4054 GiB |   4054 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5882    |   47215 K  |   47215 K  |
|       from large pool |       2    |     727    |   20508 K  |   20508 K  |
|       from small pool |       0    |    5277    |   26707 K  |   26707 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5882    |   47215 K  |   47215 K  |
|       from large pool |       2    |     727    |   20508 K  |   20508 K  |
|       from small pool |       0    |    5277    |   26707 K  |   26707 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     205    |     413    |     413    |     208    |
|       from large pool |     187    |     394    |     394    |     207    |
|       from small pool |      18    |      19    |      19    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1220    |   23886 K  |   23886 K  |
|       from large pool |       3    |     279    |   12599 K  |   12599 K  |
|       from small pool |       0    |    1038    |   11286 K  |   11286 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  18149 MiB | 702705 GiB | 702705 GiB |
|       from large pool |  16640 KiB |  18115 MiB | 698691 GiB | 698691 GiB |
|       from small pool |      0 KiB |     35 MiB |   4014 GiB |   4014 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  18149 MiB | 702705 GiB | 702705 GiB |
|       from large pool |  16640 KiB |  18115 MiB | 698691 GiB | 698691 GiB |
|       from small pool |      0 KiB |     35 MiB |   4014 GiB |   4014 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  18113 MiB | 701421 GiB | 701421 GiB |
|       from large pool |  16640 KiB |  18080 MiB | 697411 GiB | 697411 GiB |
|       from small pool |      0 KiB |     35 MiB |   4009 GiB |   4009 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4828 MiB |  18948 MiB |  18948 MiB |  14120 MiB |
|       from large pool |   4792 MiB |  18910 MiB |  18910 MiB |  14118 MiB |
|       from small pool |     36 MiB |     38 MiB |     38 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1826 MiB | 322160 GiB | 322160 GiB |
|       from large pool |  24320 KiB |   1820 MiB | 318105 GiB | 318105 GiB |
|       from small pool |      0 KiB |     29 MiB |   4054 GiB |   4054 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5882    |   47215 K  |   47215 K  |
|       from large pool |       2    |     727    |   20508 K  |   20508 K  |
|       from small pool |       0    |    5277    |   26707 K  |   26707 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5882    |   47215 K  |   47215 K  |
|       from large pool |       2    |     727    |   20508 K  |   20508 K  |
|       from small pool |       0    |    5277    |   26707 K  |   26707 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     205    |     413    |     413    |     208    |
|       from large pool |     187    |     394    |     394    |     207    |
|       from small pool |      18    |      19    |      19    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1220    |   23886 K  |   23886 K  |
|       from large pool |       3    |     279    |   12599 K  |   12599 K  |
|       from small pool |       0    |    1038    |   11286 K  |   11286 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_39_39_seed_1_24051360

 Experiment start at: 2024-08-03 18:39:40.505701
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.06926468014717102
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9229452, 'precision': 0.8027463, 'recall': 0.78379893, 'specificity': 0.9916064, 'f1': 0.78581303, 'auroc': 0.9920684}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   333     0    7    18    0    0    29     4     6    8     78
1     0  1254    0    22    1    0     0    51     0    0      3
2     2     0  235     3   17    4     2     6     7   35      1
3     2     3    1  8141    1   13     1   225    51    1      0
4     1     1  135     1  228    3     1     8    42   15    104
5     1     0    9    75    0  387     0     0     3   45      1
6    27     2    5    14    1    0  1825     4     7    9     14
7     2    17    4   381    3    1     2  6804    37    0     11
8     2     3   14   458    9    2     8   102  2649    0     49
9     3     0  111    13    2  140     0     3     4  216      1
10   12     0   17    11  191    2    20    44    66    5  12424
---- Validation: 
scalar performance:
{'acc': 0.9220008, 'precision': 0.8043909, 'recall': 0.78274775, 'specificity': 0.9914727, 'f1': 0.78659046, 'auroc': 0.99178994}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   338     0    5    14    2    0    25     8     8    9     74
1     0  1238    0    19    0    0     0    68     1    0      6
2     0     1  231     5   13    4     1    10     7   39      1
3     2     2    1  8139    0   11     3   232    50    0      0
4     1     1  129     3  230    3     2     7    40   11    112
5     2     0    5    67    0  391     0     0     6   49      1
6    25     1    3    11    0    0  1836     9     5    5     13
7     2    22    2   397    4    1     2  6786    38    0     11
8     4     6   18   458   14    2     5   100  2625    0     64
9     3     0  110    18    2  133     1     6     6  214      0
10   12     1   15    10  185    1    21    38    66    6  12441
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7553348, 'precision': 0.6757628, 'recall': 0.6388889, 'specificity': 0.9753646, 'f1': 0.64154506, 'auroc': 0.87909824}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   887     0    3   26    0    0   210     7     1   30     6
1     1  1263    2   37    3    1     4   170     3    0    15
2    15     1  268    9  197   19    33    26   333   70    44
3     0     0    0    0    0    0     0     0     0    0     0
4     1     1    6    0  821    0    18     1    20    1   764
5     9     0    3   73    0  391     8     0    13   95     0
6     0     0    0    2    0    0  3061     2     2    0     0
7     1     0    0   29    0    0     1  1128     2    0     3
8     3     0    1  168    0    4    26     3  1162    1     2
9    27    11  271   96   18  173    16    34   183  301     7
10    0     0    0    0  127    0     5     0     0    0  1514
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 19:32:29.802120,epoch time: 0:52:49.296419,used: 0:52:49.296419,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_39_39_seed_1_24051360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94651645, 'precision': 0.8802912, 'recall': 0.81244797, 'specificity': 0.9940226, 'f1': 0.83918715, 'auroc': 0.99451095}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   394     0    0    12    0    0    14     7    10    4     42
1     0  1272    0    15    0    0     0    43     0    0      2
2     3     0  142     1   57    1     2    18     6   76      6
3     1     1    1  8169    0    7     2   198    55    1      0
4     4     0   17     2  257    1     0     9    31   15    203
5     2     0    2    64    1  362     0     0     8   81      1
6     9     1    0    10    0    0  1858     5     7    2     16
7     0    10    0   202    1    0     2  6991    47    0     10
8     2     2    4   226    4    1     1   112  2913    1     30
9     2     0   32    11    2   49     2     4     9  376      6
10   12     0    0     9   12    1    16    23    77    1  12643
---- Validation: 
scalar performance:
{'acc': 0.9474923, 'precision': 0.87871593, 'recall': 0.81387377, 'specificity': 0.9941279, 'f1': 0.83959335, 'auroc': 0.9946573}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   399     0    0    11    1    0    15     9     8    3     37
1     0  1267    0    13    0    0     0    49     1    1      1
2     1     0  144     4   51    2     3    17     4   78      8
3     0     0    0  8183    0    4     0   190    63    0      0
4     4     1   22     1  256    0     0     7    23   14    211
5     0     0    1    61    0  363     1     0     4   90      1
6    10     2    0    11    0    0  1854     4     6    1     20
7     1     6    1   188    1    0     1  7013    41    0     13
8     3     4    4   215    4    0     1   101  2931    1     32
9     1     0   33    11    3   52     4     5     6  374      4
10   15     0    1     8   19    0     9    28    76    2  12638
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70370114, 'precision': 0.6303203, 'recall': 0.583707, 'specificity': 0.97042483, 'f1': 0.57493305, 'auroc': 0.8647897}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1030     9    0   32    2    0    56    15    13    5     8
1      0  1297    0   30    0    0     0   158     2    0    12
2     36     6   49   30  277    5     7    68   247   61   229
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    0    0  221    0     3     1    13    0  1393
5     13     0    1  113    1  271     2     0    18  171     2
6      0     2    0   49    0    0  2977     3    11    0    25
7      0     0    0  121    0    0     0  1040     0    0     3
8      0     2    0  184    1    0     1    12  1166    2     2
9     56    15  136  166   27   40    11    84   206  365    31
10     0     0    0    0    4    0     0     0     0    0  1642
better model found
persisted
after epoch: 2,now: 2024-08-03 20:24:46.529941,epoch time: 0:52:16.727821,used: 1:45:06.024240,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_39_39_seed_1_24051360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9464362, 'precision': 0.8655946, 'recall': 0.84233904, 'specificity': 0.99424636, 'f1': 0.84758943, 'auroc': 0.9963798}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    1     6    1    0    12     4     3    2     17
1     0  1272    0    10    0    0     0    46     4    0      0
2     2     0  160     1   45    1     2     8    10   80      3
3     5     0    0  8290    0    6     6    76    54    1      0
4     7     1   23     0  348    1     3     3    39   17     97
5     2     0    0    40    0  315     0     0     4  159      1
6    11     0    1     3    2    0  1876     3     3    1      7
7     1    13    1   379    1    0     1  6796    65    2      5
8     4     0    2   233    3    1     1    35  2995    3     18
9     1     0   25     7    2   33     0     0     2  423      0
10   30     1    2     7  126    0    45    21    93    5  12462
---- Validation: 
scalar performance:
{'acc': 0.9462351, 'precision': 0.8662212, 'recall': 0.8406488, 'specificity': 0.99422085, 'f1': 0.84667826, 'auroc': 0.9963662}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     7    1    0    10     3     2    1     15
1     0  1275    0    10    0    0     1    40     5    0      1
2     3     0  159     2   43    0     1     7    12   84      1
3     4     1    1  8311    0    4     6    65    48    0      0
4     5     0   24     1  340    1     6     4    48   17     93
5     0     0    0    42    0  312     1     0     4  161      1
6     8     0    0     0    2    0  1881     2     2    2     11
7     3    15    0   385    1    0     2  6793    60    2      4
8     7     0    4   246    2    2     2    41  2971    3     18
9     3     0   24     9    1   29     2     1     5  419      0
10   27     1    2     8  129    0    48    27    82    2  12470
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72476035, 'precision': 0.67918026, 'recall': 0.5959935, 'specificity': 0.97252595, 'f1': 0.59883064, 'auroc': 0.8664199}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   943     2   0   51    0    0   117    35     7   13     2
1     0  1250   0   37    0    0     1   202     4    0     5
2    23     1  83   30  122    6    39    52   529   75    55
3     0     0   0    0    0    0     0     0     0    0     0
4     4     1   0    0  594    0    51     5    61    1   916
5     8     0   0  169    2  243     2     0    14  154     0
6     0     0   0    9    0    0  3052     3     3    0     0
7     0     0   0   96    0    0     3  1064     1    0     0
8     0     0   0  167    0    0     2     1  1199    1     0
9    15     6  71  221    8   60     7    73   292  377     7
10    0     0   0    0   65    0    24     2     1    0  1554
early stop counter: 1
val acc:0.9462351202964783, best validation acc: 0.9474923014640808, corresponding to test acc:                         0.7037011384963989 / 0.7553347945213318
after epoch: 3,now: 2024-08-03 21:19:43.463353,epoch time: 0:54:56.933412,used: 2:40:02.957652,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_39_39_seed_1_24051360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9549444, 'precision': 0.875659, 'recall': 0.83321077, 'specificity': 0.99502134, 'f1': 0.84915006, 'auroc': 0.99660105}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    0    10    1    0     1     1     1    2     28
1     0  1274    0     8    1    0     0    45     3    0      0
2     0     0  160     3  102    1     1     6     2   36      1
3     2     1    1  8233    0    0     0   162    36    2      0
4     4     0    9     3  366    0     0     2    14    5    136
5     1     0    5    76    0  289     0     0     5  144      1
6    33     0    1     7    2    1  1838     1     0    3     20
7     2     6    1   141    2    0     1  7063    26    1     21
8     3     0    4   199   11    0     0    85  2946    0     47
9     2     0   73    14    4   20     0     5     3  371      1
10    9     0    1     8   40    1     2     9    12    0  12713
---- Validation: 
scalar performance:
{'acc': 0.95321655, 'precision': 0.8756841, 'recall': 0.82796025, 'specificity': 0.99480605, 'f1': 0.8462175, 'auroc': 0.9965961}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    0     8    0    0     2     2     1    4     31
1     0  1264    0    10    0    0     0    53     3    0      2
2     2     0  158     5  110    0     0     3     1   30      3
3     0     1    0  8238    0    0     1   156    42    2      0
4     5     0    7     3  358    0     0     1    10    5    150
5     1     0    0    75    0  288     0     0     5  151      1
6    23     0    1     8    1    2  1840     3     4    3     23
7     2     3    3   143    2    0     1  7071    20    1     19
8     4     0    6   225    7    0     0    84  2921    0     49
9     2     0   67    19   10   21     0     4     3  366      1
10   13     0    0     9   40    1     4    11    21    0  12697
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67368644, 'precision': 0.6317022, 'recall': 0.5419523, 'specificity': 0.9676264, 'f1': 0.52623266, 'auroc': 0.8505432}
confusion matrix:
      0     1    2    3    4   5     6     7     8    9     10
0   1037     1    0   45    4   0    28    22    21    5     7
1      0  1280    0   21    0   0     0   175     1    0    22
2     14     1   64   37  325   0     2    32   261   16   263
3      0     0    0    0    0   0     0     0     0    0     0
4      0     0    0    0  261   0     1     0     9    0  1362
5      3     0    4  375    1  50     0     0    28  129     2
6      0     1    0  119    2   0  2781     5    22    0   137
7      0     0    0   43    0   0     2  1117     0    0     2
8      0     0    0  132    2   0     1    28  1202    0     5
9     18     3  214  279   41   6     2    93   239  199    43
10     0     0    0    0    8   0     0     0     0    0  1638
better model found
persisted
after epoch: 4,now: 2024-08-03 22:21:02.593225,epoch time: 1:01:19.129872,used: 3:41:22.087524,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_39_39_seed_1_24051360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9554259, 'precision': 0.8732271, 'recall': 0.8635544, 'specificity': 0.9952936, 'f1': 0.8621382, 'auroc': 0.99742985}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   395     1    3     4    3    0    21     4     3    3     46
1     0  1311    0     2    0    0     0    11     7    0      1
2     0     0  267     0   24    0     1     1     2   17      0
3     0     8    1  8137    1    5     1   147   137    2      0
4     2     0   53     0  365    0     0     2    28    2     87
5     0     0    3    16    0  340     0     0     9  152      1
6     4     0    1     3    1    0  1874     2     4    0     19
7     1   107    6   201    1    0     1  6906    34    1      5
8     0     3    7    38    5    0     0    67  3156    1     16
9     0     0  136     3    3   14     1     1     5  329      0
10    2     0    2     5   92    0    12    15    34    2  12630
---- Validation: 
scalar performance:
{'acc': 0.953805, 'precision': 0.8729763, 'recall': 0.85995936, 'specificity': 0.99510753, 'f1': 0.8601584, 'auroc': 0.99740386}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   378     0    1     3    2    0    28     4     7    6     54
1     0  1311    0     4    0    0     0    10     4    0      3
2     0     0  264     0   23    0     1     3     5   16      0
3     0    10    0  8117    0    8     0   160   144    1      0
4     1     0   52     1  369    0     1     0    20    3     92
5     0     0    2    16    0  346     0     0     8  148      1
6     4     1    1     2    2    0  1874     4     5    0     15
7     0   113    3   189    1    0     1  6901    48    1      8
8     1     5    5    49    4    0     0    55  3153    1     23
9     0     0  142     3    1   10     1     4     6  326      0
10    2     0    3     6   91    0    10    15    48    2  12619
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72518015, 'precision': 0.6666588, 'recall': 0.5918252, 'specificity': 0.9720552, 'f1': 0.59109414, 'auroc': 0.87405044}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   607     0   15  32    4    2   334    27    27   92    30
1     0  1323    1  11    0    1     1   105    11    0    46
2     0     1  316   2  196    1     4    24   346   31    94
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    4   0  491    0     4     0    16    0  1118
5     0     0    5  64    1  161     0     2    57  301     1
6     0     0    1   2    1    0  3044     2     9    0     8
7     0     0    0  32    0    0     0  1125     1    1     5
8     0     0    0  16    0    0     2    21  1328    2     1
9     2     4  411  29   12   20     2    63   209  366    19
10    0     0    0   0   40    0     2     0     0    0  1604
better model found
persisted
after epoch: 5,now: 2024-08-03 23:33:46.227279,epoch time: 1:12:43.634054,used: 4:54:05.721578,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_39_39_seed_1_24051360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96107125, 'precision': 0.89504427, 'recall': 0.871398, 'specificity': 0.99575096, 'f1': 0.88101244, 'auroc': 0.99796367}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   432     0    0     3    1    0    22     0     1    3     21
1     0  1288    0     8    0    0     1    30     3    0      0
2     0     1  204     0   15    6     1     3     9   73      0
3     0     2    0  8364    0   14     2    29    23    3      0
4     4     0   63     1  331    1     2     3    22   11    100
5     0     0    0    22    0  467     0     0     3   28      1
6     5     0    0     2    0    0  1889     0     2    3      5
7     0    11    0   280    1    0     2  6939    25    1      6
8     1     1    3   205    4    4     3    47  3002    0     26
9     0     0    9     6    0  113     1     3     5  355      1
10    8     1    2     8   51    0    23    14    35    3  12650
---- Validation: 
scalar performance:
{'acc': 0.9601979, 'precision': 0.8952831, 'recall': 0.87076104, 'specificity': 0.9956542, 'f1': 0.88070065, 'auroc': 0.9978372}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   428     0    0     5    0    0    26     3     1    2     18
1     0  1290    0     8    0    0     0    29     4    0      1
2     0     0  206     2   14    4     0     4     3   79      0
3     0     0    0  8374    0   10     0    31    23    1      1
4     4     0   57     0  328    1     4     4    27   17     97
5     0     0    0    18    0  472     0     0     4   26      1
6     5     0    0     1    2    0  1889     0     2    2      7
7     1     9    0   319    1    0     2  6902    26    0      5
8     1     1    3   197    3    1     1    65  3007    1     16
9     0     0   19     4    0  109     0     2     5  353      1
10   11     0    0     9   47    0    32    15    32    2  12648
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6953754, 'precision': 0.66387475, 'recall': 0.57988524, 'specificity': 0.9695344, 'f1': 0.5872576, 'auroc': 0.8682803}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   852     1    0   30    0    0   266    0     1   20     0
1     0  1193    0   36    0    0     5  239     6    0    20
2     5     1  176   27  200   14    54   27   318  131    62
3     0     0    0    0    0    0     0    0     0    0     0
4     2     0    3    1  335    0    23    0    15    1  1253
5     7     0    0   93    1  386     2    0     8   95     0
6     0     0    0    4    0    0  3063    0     0    0     0
7     0     0    0  408    0    1     4  750     0    0     1
8     0     0    0  180    0    1     6    1  1180    1     1
9     9     3   95  180    6  179    18   44   212  376    15
10    0     0    0    0   13    0     5    0     0    0  1628
better model found
persisted
after epoch: 6,now: 2024-08-04 00:50:52.331164,epoch time: 1:17:06.103885,used: 6:11:11.825463,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_39_39_seed_1_24051360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96412134, 'precision': 0.91081095, 'recall': 0.86774135, 'specificity': 0.99601847, 'f1': 0.8845762, 'auroc': 0.9985153}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     7    1    0     9     3     2    2     21
1     0  1272    0     9    0    0     0    48     2    0      1
2     1     0  152     1   65    1     0     6     4   81      1
3     1     0    0  8101    0    6     0   239    88    0      1
4     3     0    9     1  355    2     0     4     9    4    152
5     0     0    0    20    1  442     0     0     2   55      1
6     5     0    0     2    0    3  1875     4     2    5     11
7     0     4    0    60    1    0     2  7160    24    0     11
8     1     0    2    45    5    1     0    83  3101    1     56
9     1     0   22     8    3   48     0     1     2  406      2
10    7     0    1     5   23    1     8    12     6    0  12733
---- Validation: 
scalar performance:
{'acc': 0.9646115, 'precision': 0.9147049, 'recall': 0.87070614, 'specificity': 0.9960632, 'f1': 0.88864994, 'auroc': 0.99839914}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    0     5    1    0     9     7     0    2     22
1     0  1272    0     6    0    0     0    51     3    0      0
2     0     0  161     1   63    1     0     5     6   73      2
3     1     0    0  8105    0    4     0   241    89    0      0
4     1     0    9     0  363    1     0     3     8    6    148
5     0     0    1    24    0  441     0     0     2   52      1
6     4     0    0     3    1    2  1874     8     3    6      7
7     0     4    0    66    1    0     1  7160    21    0     12
8     2     0    1    43    8    1     0    80  3100    2     59
9     0     0   24     6    2   50     0     2     2  403      4
10    4     0    0     7   17    1    10     6     4    1  12746
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70796895, 'precision': 0.65377784, 'recall': 0.5939001, 'specificity': 0.97078747, 'f1': 0.58310986, 'auroc': 0.8601974}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   903     0   0   71    1    1   111    54     7   17     5
1     0  1134   0   33    0    0     3   286     5    0    38
2    18     0  65   34  269   20    18    81   195  108   207
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   0    0  211    0     3     2     8    1  1407
5     6     0   0  152    1  333     2     0    14   83     1
6     0     0   0   18    1    0  3022     2     7    1    16
7     0     0   0   63    0    1     0  1097     0    0     3
8     0     0   0  105    1    0     1    30  1229    0     4
9    11     1  54  182   10  134     4   113   107  489    32
10    0     0   0    0    8    0     2     0     0    0  1636
better model found
persisted
after epoch: 7,now: 2024-08-04 01:50:14.223671,epoch time: 0:59:21.892507,used: 7:10:33.717970,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_39_39_seed_1_24051360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9612586, 'precision': 0.91213346, 'recall': 0.8682103, 'specificity': 0.9956573, 'f1': 0.8871054, 'auroc': 0.9979623}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     2    1    0    13     0     2    2     25
1     0  1302    0     9    0    0     0    19     2    0      0
2     1     0  182     0   84    1     0     1     4   31      8
3     0     1    0  8343    1    6     0    28    58    0      0
4     4     0    2     0  308    1     1     0    11    1    211
5     0     0    0    16    1  439     0     0     4   59      1
6     3     0    0     1    1    0  1891     1     0    1     10
7     0     9    1   336    3    0     1  6731   165    1     16
8     1     0    3    82    5    0     1    13  3163    1     27
9     1     0   33     4    9   44     1     0     2  397      2
10    4     0    1     8    7    1    11     1    26    0  12734
---- Validation: 
scalar performance:
{'acc': 0.96025145, 'precision': 0.9048499, 'recall': 0.8608402, 'specificity': 0.9955392, 'f1': 0.8799275, 'auroc': 0.99806327}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    0     3    1    0     9     1     2    2     25
1     0  1298    0     6    0    0     0    24     3    0      1
2     1     0  175     1   92    1     1     1     4   31      5
3     0     1    0  8355    0    6     0    31    47    0      0
4     3     0    7     0  295    1     2     1    13    1    216
5     0     0    1    22    0  424     0     0     8   65      1
6     6     0    0     3    1    0  1879     0     3    0     16
7     1     8    4   351    1    0     1  6727   154    2     16
8     0     0    3    67    3    2     0    14  3172    0     35
9     1     0   41     3    9   39     2     0     1  396      1
10    4     0    0     7    4    1    13     0    28    1  12738
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.682362, 'precision': 0.6152575, 'recall': 0.56456995, 'specificity': 0.9682457, 'f1': 0.5567686, 'auroc': 0.8368284}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   986     0    0   83    1    0    44    2    19   22    13
1     4  1217    0   37    0    0     1  180    14    0    46
2    16     0   65   14  139    4    12    8   204   39   514
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    0    1   20    0     4    0    10    0  1598
5     5     0    0  115    5  272     1    0    40  152     2
6     0     0    0   45    0    0  2975    0     9    0    38
7     1     0    0  312    0    0     2  831    16    0     2
8     0     0    0   58    0    1     1    0  1307    1     2
9    20     0  142  119   32   50     2   21   245  435    71
10    0     0    0    0    0    0     1    0     0    0  1645
early stop counter: 1
val acc:0.9602514505386353, best validation acc: 0.9646114706993103, corresponding to test acc:                         0.7079689502716064 / 0.7553347945213318
after epoch: 8,now: 2024-08-04 02:50:11.374890,epoch time: 0:59:57.151219,used: 8:10:30.869189,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_39_39_seed_1_24051360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97313786, 'precision': 0.9181486, 'recall': 0.91884214, 'specificity': 0.9971051, 'f1': 0.9177021, 'auroc': 0.99900925}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    0    0     1     1     2    1      9
1     0  1316    0     7    0    0     0     8     1    0      0
2     2     1  249     0   15    1     0     4     3   35      2
3     1     2    1  8354    0   21     0    38    21    1      0
4     6     0   47     0  401    0     1     2    10    3     69
5     0     0    0     7    0  477     0     0     3   33      1
6    22     0    1     4    0    0  1855     0     3    3     19
7     0    17    3   184    1    0     1  7025    25    0      4
8     2     0    5    80    5    2     1    51  3143    0      6
9     0     0   29     1    0   59     0     0     2  402      0
10   12     0    3     9   40    1     1    13    35    0  12681
---- Validation: 
scalar performance:
{'acc': 0.9720744, 'precision': 0.9182606, 'recall': 0.9192962, 'specificity': 0.9969822, 'f1': 0.9180593, 'auroc': 0.99902695}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     2    0    0     0     0     1    2      6
1     0  1312    0     8    0    0     0     9     3    0      0
2     0     0  255     0   13    1     0     1     4   36      2
3     0     1    0  8357    0   15     0    46    20    1      0
4     7     0   41     2  403    2     0     1    10    4     69
5     0     0    1     6    1  480     0     0     2   31      0
6    23     0    1     7    0    0  1842     0     5    3     27
7     0    20    2   183    1    0     1  7026    28    0      4
8     3     0    4    98    7    1     1    57  3122    0      3
9     0     0   28     4    0   64     0     0     1  396      0
10   13     0    2     9   47    1     2    12    33    1  12676
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73329604, 'precision': 0.67422664, 'recall': 0.6247809, 'specificity': 0.9734361, 'f1': 0.6111803, 'auroc': 0.857447}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1085     0    0   31    0    2    10    24     2   13     3
1      1  1280    0   31    0    2     0   173     2    0    10
2     40     0  164   20  108   17     4    59   356   61   186
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    1    1  236    0     2     2    28    0  1362
5      9     0    0   64    0  397     0     0    12  110     0
6      3     0    0   15    0    0  3019     3     3    0    24
7      0     0    0  150    0    1     0  1011     1    0     1
8      0     0    0  105    0    5     1    18  1240    0     1
9     33     1  153  123    0  160     1    68   151  411    36
10     0     0    0    0    6    0     1     0     1    0  1638
better model found
persisted
after epoch: 9,now: 2024-08-04 03:47:09.980043,epoch time: 0:56:58.605153,used: 9:07:29.474342,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_39_39_seed_1_24051360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9731914, 'precision': 0.9052364, 'recall': 0.9169453, 'specificity': 0.9971951, 'f1': 0.9070505, 'auroc': 0.9991374}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    1     0    2    0     6     2     0    3     21
1     0  1309    0     4    0    0     1    13     5    0      0
2     0     1  289     0   12    0     0     1     0    7      2
3     1     1    2  8255    0   16     9    88    65    1      0
4     2     0   46     0  451    0     0     1     2    1     36
5     0     0    3     7    0  447     0     0     2   60      1
6     5     0    1     0    3    0  1881     0     2    1     15
7     0    18    3    71    1    0     2  7134    27    1      7
8     1     0   10    34   30    2     2    39  3143    0     34
9     0     0  126     1    1   38     0     0     1  326      0
10    4     0    1     5   71    1     3    11     5    0  12691
---- Validation: 
scalar performance:
{'acc': 0.97279656, 'precision': 0.9034163, 'recall': 0.9186195, 'specificity': 0.99714243, 'f1': 0.90697706, 'auroc': 0.9990653}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    1     1    2    0     2     0     0    6     20
1     0  1308    0     3    0    0     1    16     3    0      1
2     0     0  294     0   11    1     0     0     0    6      0
3     3     3    4  8252    0   19     7    93    59    0      0
4     1     0   42     0  445    0     0     1     2    2     46
5     0     0    3     6    1  452     0     0     1   58      0
6     3     0    0     0    2    0  1886     0     2    3     12
7     1    17    6    73    1    0     1  7130    28    2      6
8     0     1   11    37   25    0     0    43  3135    0     44
9     0     0  120     1    0   44     0     0     1  327      0
10    8     0    3     6   83    1     3     2     2    0  12688
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7601623, 'precision': 0.68041813, 'recall': 0.65923804, 'specificity': 0.97591186, 'f1': 0.64758503, 'auroc': 0.8689538}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1075     1    0   4    3    4    43     2     3   31     4
1      0  1181    1  28    0    2     0   254     8    0    25
2     15     0  265   5  355   21    10    34   130   71   109
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    1   1  358    0     2     2     6    1  1261
5      5     0    1  35    3  472     0     0     6   69     1
6      0     0    0   1    1    1  3048     0     0    0    16
7      1     0    0  49    0    1     3  1108     0    0     2
8      0     0    0  84    2    8     7    10  1256    0     3
9     23     0  216  52   12  210     2    29   102  470    21
10     0     0    0   0   13    0     1     0     0    0  1632
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-04 04:40:05.687203,epoch time: 0:52:55.707160,used: 10:00:25.181502,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_39_39_seed_1_24051360
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 10:00:25.181502 at 2024-08-04 04:40:05.687203
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7601623, 'precision': 0.68041813, 'recall': 0.65923804, 'specificity': 0.97591186, 'f1': 0.64758503, 'auroc': 0.8689538}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1075     1    0   4    3    4    43     2     3   31     4
1      0  1181    1  28    0    2     0   254     8    0    25
2     15     0  265   5  355   21    10    34   130   71   109
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    1   1  358    0     2     2     6    1  1261
5      5     0    1  35    3  472     0     0     6   69     1
6      0     0    0   1    1    1  3048     0     0    0    16
7      1     0    0  49    0    1     3  1108     0    0     2
8      0     0    0  84    2    8     7    10  1256    0     3
9     23     0  216  52   12  210     2    29   102  470    21
10     0     0    0   0   13    0     1     0     0    0  1632
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7601623, 'precision': 0.68041813, 'recall': 0.65923804, 'specificity': 0.97591186, 'f1': 0.64758503, 'auroc': 0.8689538}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1075     1    0   4    3    4    43     2     3   31     4
1      0  1181    1  28    0    2     0   254     8    0    25
2     15     0  265   5  355   21    10    34   130   71   109
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    1   1  358    0     2     2     6    1  1261
5      5     0    1  35    3  472     0     0     6   69     1
6      0     0    0   1    1    1  3048     0     0    0    16
7      1     0    0  49    0    1     3  1108     0    0     2
8      0     0    0  84    2    8     7    10  1256    0     3
9     23     0  216  52   12  210     2    29   102  470    21
10     0     0    0   0   13    0     1     0     0    0  1632
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_18_39_39_seed_1_24051360_instance_wise_predictions.txt
accuracy from prediction file 0.7601623172182187
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4045 MiB |  18149 MiB |   1372 TiB |   1372 TiB |
|       from large pool |   4022 MiB |  18115 MiB |   1364 TiB |   1364 TiB |
|       from small pool |     23 MiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   4045 MiB |  18149 MiB |   1372 TiB |   1372 TiB |
|       from large pool |   4022 MiB |  18115 MiB |   1364 TiB |   1364 TiB |
|       from small pool |     23 MiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4036 MiB |  18113 MiB |   1369 TiB |   1369 TiB |
|       from large pool |   4013 MiB |  18080 MiB |   1362 TiB |   1362 TiB |
|       from small pool |     22 MiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  18984 MiB |  18984 MiB |  33104 MiB |  14120 MiB |
|       from large pool |  18946 MiB |  18946 MiB |  33064 MiB |  14118 MiB |
|       from small pool |     38 MiB |     38 MiB |     40 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1390 MiB |   2441 MiB | 644825 GiB | 644823 GiB |
|       from large pool |   1377 MiB |   2436 MiB | 636715 GiB | 636714 GiB |
|       from small pool |     12 MiB |     29 MiB |   8109 GiB |   8109 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3670    |    5882    |   94430 K  |   94426 K  |
|       from large pool |     502    |     727    |   41017 K  |   41017 K  |
|       from small pool |    3168    |    5277    |   53412 K  |   53409 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3670    |    5882    |   94430 K  |   94426 K  |
|       from large pool |     502    |     727    |   41017 K  |   41017 K  |
|       from small pool |    3168    |    5277    |   53412 K  |   53409 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     409    |     413    |     617    |     208    |
|       from large pool |     390    |     394    |     597    |     207    |
|       from small pool |      19    |      19    |      20    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     223    |    1220    |   47230 K  |   47229 K  |
|       from large pool |     189    |     284    |   24702 K  |   24701 K  |
|       from small pool |      34    |    1038    |   22528 K  |   22528 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  18149 MiB |   1372 TiB |   1372 TiB |
|       from large pool |  16640 KiB |  18115 MiB |   1364 TiB |   1364 TiB |
|       from small pool |      0 KiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  18149 MiB |   1372 TiB |   1372 TiB |
|       from large pool |  16640 KiB |  18115 MiB |   1364 TiB |   1364 TiB |
|       from small pool |      0 KiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  18113 MiB |   1369 TiB |   1369 TiB |
|       from large pool |  16640 KiB |  18080 MiB |   1362 TiB |   1362 TiB |
|       from small pool |      0 KiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5436 MiB |  18984 MiB |  33104 MiB |  27668 MiB |
|       from large pool |   5400 MiB |  18946 MiB |  33064 MiB |  27664 MiB |
|       from small pool |     36 MiB |     38 MiB |     40 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2441 MiB | 644827 GiB | 644827 GiB |
|       from large pool |  24320 KiB |   2436 MiB | 636718 GiB | 636718 GiB |
|       from small pool |      0 KiB |     29 MiB |   8109 GiB |   8109 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5882    |   94430 K  |   94430 K  |
|       from large pool |       2    |     727    |   41017 K  |   41017 K  |
|       from small pool |       0    |    5277    |   53412 K  |   53412 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5882    |   94430 K  |   94430 K  |
|       from large pool |       2    |     727    |   41017 K  |   41017 K  |
|       from small pool |       0    |    5277    |   53412 K  |   53412 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     208    |     413    |     617    |     409    |
|       from large pool |     190    |     394    |     597    |     407    |
|       from small pool |      18    |      19    |      20    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1220    |   47231 K  |   47231 K  |
|       from large pool |       3    |     284    |   24702 K  |   24702 K  |
|       from small pool |       0    |    1038    |   22528 K  |   22528 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug  4 04:48:45 2024]
Finished job 0.
1 of 1 steps (100%) done
