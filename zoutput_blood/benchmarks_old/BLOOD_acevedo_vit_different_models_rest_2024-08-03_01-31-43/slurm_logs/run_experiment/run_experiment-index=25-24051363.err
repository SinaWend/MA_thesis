Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug  3 17:01:10 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/10.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=10
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_14_56_seed_0_24051363

 Experiment start at: 2024-08-03 17:14:57.213160
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.044287413358688354
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92077804, 'precision': 0.81939614, 'recall': 0.6834072, 'specificity': 0.99117273, 'f1': 0.69416547, 'auroc': 0.9866952}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   153     0   0     8   0    1   176     6     8   15    116
1     0  1269   0    12   0    0     2    37     8    0      4
2     2    10  10     4  33   11    21    11    22  148     40
3     0     4   0  7915   0   13     6   245   242    7      5
4     2     5   2     5  92    2    35     7    45   17    326
5     0     0   0    45   0  284     5     0    16  169      2
6     2     2   0     8   0    0  1856     7    10    1     21
7     0    49   0   219   2    1     2  6821   120    4     45
8     0     2   0    95   0    4    15    63  2957    6    153
9     1     0   3    13   3   58    17     2    18  375      3
10    4     6   1     8   1    0    30    26    34    2  12683
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9211716, 'precision': 0.81756794, 'recall': 0.6882087, 'specificity': 0.9911905, 'f1': 0.69931495, 'auroc': 0.986659}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   146     0   0     8    0    1   172    10    10   19    117
1     0  1264   0    13    0    1     1    39     9    1      4
2     6     6  10     7   38    9    11    24    21  138     42
3     1     4   0  7908    0   16     7   249   238    7     10
4     1     1   2     2  109    3    24     3    51   22    321
5     0     0   0    42    0  300     6     0    13  158      2
6     3     2   0     5    0    0  1848     7    13    1     29
7     1    48   0   232    1    1     6  6829   106    1     40
8     2     6   1    86    3    4    13    66  2949    9    157
9     2     3   3     7    2   53    13     2    17  383      8
10    3     6   0    10    4    2    32    24    22    1  12692
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.649059, 'precision': 0.6757268, 'recall': 0.5134828, 'specificity': 0.9634054, 'f1': 0.47102314, 'auroc': 0.8596599}
confusion matrix:
     0     1   2   3   4   5     6     7     8    9     10
0   316     1   0  34   0   0   724    28    24   36     7
1     2  1284   0  20   0   0     8   154     9    5    17
2    15    11   1   4  50   0   190    54   278  152   260
3     0     0   0   0   0   0     0     0     0    0     0
4     0     4   0   0  66   0    26     2    21    0  1514
5    11     0   0  79   0  50    72     0    27  352     1
6     0     2   0   2   0   0  2880     9    28    1   145
7     0     3   0  22   0   0     8  1124     0    2     5
8     2     0   0  27   0   0    50     6  1269   10     6
9    22    18   0  40   3   6   105    59   223  645    16
10    0     1   0   0   0   0     3     0     0    0  1642
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 18:00:39.430274,epoch time: 0:45:42.217114,used: 0:45:42.217114,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_14_56_seed_0_24051363
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9378478, 'precision': 0.8468345, 'recall': 0.7580583, 'specificity': 0.9931582, 'f1': 0.77570677, 'auroc': 0.9936542}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   368     0   0    14    0    3     7     7     7   22     55
1     0  1245   0    17    0    0     0    57     9    0      4
2     1     0  55    12   21    7     1    11    31  163     10
3     0     1   0  8210    0   10     0   113   105    0      0
4     1     0  22     4  145    5     0     6   102   30    224
5     0     0   0    56    0  416     0     0     6   42      1
6    18     0   0    18    1    2  1815     9    15    9     20
7     1     5   0   363    1    0     1  6792    89    1      9
8     0     1   1   138    1    6     0    49  3077    2     21
9     0     0   4    20    0  154     0     1     9  304      0
10   13     0   4     9    5    3     8    25    96    4  12626
---- Validation: 
scalar performance:
{'acc': 0.93850476, 'precision': 0.8530568, 'recall': 0.7642886, 'specificity': 0.9932353, 'f1': 0.7826461, 'auroc': 0.9937088}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   371     0   0    17    0    0     5     7     8   30     45
1     0  1238   0    18    0    0     0    58    15    0      3
2     0     0  63     4   12   11     1    16    30  165     10
3     1     0   0  8203    0   14     0   103   116    2      1
4     3     0  26     5  155    8     0     8    93   27    214
5     0     0   0    60    0  421     0     0     6   33      1
6    17     0   0    15    0    3  1827     4    10    5     27
7     1     2   0   362    1    1     1  6798    92    0      7
8     2     0   1   140    0    6     0    49  3077    0     21
9     1     0   4    25    1  140     0     0    12  309      1
10   16     0   4    10    5    4     3    26   100    4  12624
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6700483, 'precision': 0.6615867, 'recall': 0.57863617, 'specificity': 0.9669805, 'f1': 0.5385984, 'auroc': 0.8718521}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   985     0   0  35   0    0     7    33    90   19     1
1     1  1101   0  30   0    2     1   293    47    0    24
2    25     0  13  18   9   30     3    41   584  142   150
3     0     0   0   0   0    0     0     0     0    0     0
4     2     0   0   0  26    0     1     2    76    0  1526
5    12     0   0  93   0  383     1     0    31   71     1
6    19     0   0  57   1    0  2598     9   292    1    90
7     1     0   0  81   0    0     1  1071     4    3     3
8     0     0   0  45   0    1     0     2  1320    2     0
9    36     4   5  82   3  139     0    28   383  436    21
10    0     0   0   0   1    0     0     0     1    0  1644
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 18:45:19.181706,epoch time: 0:44:39.751432,used: 1:30:21.968546,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_14_56_seed_0_24051363
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94980735, 'precision': 0.88064396, 'recall': 0.8215938, 'specificity': 0.9945705, 'f1': 0.842984, 'auroc': 0.99532825}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   392     0    0     2    1    0    30     1     9    3     45
1     0  1273    0    11    0    0     0    31    14    0      3
2     2     0  147     3   47    1     3     7    33   67      2
3     1     1    0  8011    1   15     6   133   270    1      0
4     1     0   20     1  258    1     5     2    57    6    187
5     3     0    0    27    0  361     2     0    17  110      1
6     7     0    0     2    1    0  1875     2     6    0     14
7     1     9    0   167    2    0     4  6947   109    3     21
8     0     0    2    42    3    0     2    31  3186    0     30
9     2     0   23     9    0   50     4     1    18  385      1
10   12     0    1     6   20    1    21    11    53    2  12665
---- Validation: 
scalar performance:
{'acc': 0.9498997, 'precision': 0.880042, 'recall': 0.8196346, 'specificity': 0.9945867, 'f1': 0.84147024, 'auroc': 0.9954427}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   381     0    0     2    0    1    30     3    15    3     48
1     0  1275    0     8    0    0     0    33    14    0      2
2     2     1  154     1   41    0     3     6    28   74      2
3     2     1    0  8014    0   17     3   142   258    2      1
4     2     0   19     0  257    1     5     3    59    9    184
5     1     0    0    23    0  357     2     0    19  118      1
6     6     1    0     1    1    0  1879     0    10    1      9
7     1    11    1   163    2    0     4  6952   110    1     20
8     1     0    1    39    0    0     1    38  3181    1     34
9     6     0   29     5    1   47     5     1    20  378      1
10    8     1    1     7   18    1    14    13    47    2  12684
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70754915, 'precision': 0.67197466, 'recall': 0.57810235, 'specificity': 0.9703366, 'f1': 0.56310546, 'auroc': 0.87269247}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   943     0   0    4    0    0   178     7    29    5     4
1     0  1237   0   28    0    0     7   169    39    0    19
2    21     0  32    4  177    1    37    36   547   84    76
3     0     0   0    0    0    0     0     0     0    0     0
4     3     0   0    0  357    0     3     3    45    0  1222
5    28     0   0   80    0  184    28     0    56  215     1
6     0     0   0    8    0    0  2971     4    62    0    22
7     0     0   0  123    0    0    19  1014     5    0     3
8     0     0   0   30    0    0     6     1  1332    1     0
9    42     2  19   52   15   22    30    36   487  418    14
10    0     0   0    0   18    0     2     0     1    0  1625
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-03 19:28:42.614898,epoch time: 0:43:23.433192,used: 2:13:45.401738,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_14_56_seed_0_24051363
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95596105, 'precision': 0.87329996, 'recall': 0.864596, 'specificity': 0.9952798, 'f1': 0.8674191, 'auroc': 0.9965519}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    1     5    0    0     8     7     5    4     28
1     1  1288    0    11    0    0     0    26     6    0      0
2     1     1  238     1   18    4     1     4    10   34      0
3     1     3    0  8253    0   17     1    64    95    2      0
4     2     0   65     6  307    3     4     2    40    6    104
5     3     0    4    18    0  423     1     0     7   64      1
6     7     0    0     3    1    0  1879     2     4    1     11
7     0    18    1   255    2    0     2  6916    60    2      8
8     1     1    4   120    7    3     1    58  3082    1     18
9     4     0   62     6    0   71     2     0    10  338      0
10   10     5    6     8   99    2    17    16    46    2  12581
---- Validation: 
scalar performance:
{'acc': 0.9562391, 'precision': 0.8700419, 'recall': 0.8618226, 'specificity': 0.99532914, 'f1': 0.86485064, 'auroc': 0.996734}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   427     0    1     4    0    1     7     6     6    3     28
1     0  1289    0    13    0    0     0    26     3    0      1
2     3     1  226     2   19    6     1     5    15   34      0
3     1     3    0  8272    0   16     0    58    88    2      0
4     4     3   60     3  315    3     3     5    39    3    101
5     1     0    4    18    1  418     0     0     7   72      0
6     7     0    1     4    1    0  1873     1     7    1     13
7     0    18    2   236    1    0     2  6958    45    0      3
8     0     2    8   110    6    2     0    59  3091    0     18
9     1     0   61     5    0   76     2     2    11  335      0
10   10     7    7    10  114    2    20    23    58    0  12545
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7576436, 'precision': 0.69281507, 'recall': 0.6340403, 'specificity': 0.97575736, 'f1': 0.63924396, 'auroc': 0.88372815}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1068     0    0   12    0    1    62   17     6    3     1
1      4  1288    1   20    2    1     2  159    11    2     9
2     18     5  236   15  193   13    29   43   359   59    45
3      0     0    0    0    0    0     0    0     0    0     0
4      1     3    3    0  653    0     5    3    22    0   943
5     18     0    0  120    0  261    10    0    24  158     1
6      0     0    0    6    7    0  3013    4    11    0    26
7      0     0    0  168    0    0     3  989     0    1     3
8      0     0    0   72    0    1     9    6  1281    1     0
9     40    16  169   76    4   69    10   51   245  451     6
10     0     3    0    0   51    0     2    0     1    0  1589
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-03 20:12:59.945962,epoch time: 0:44:17.331064,used: 2:58:02.732802,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_14_56_seed_0_24051363
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.958476, 'precision': 0.89185166, 'recall': 0.8497244, 'specificity': 0.99551547, 'f1': 0.86498207, 'auroc': 0.9970197}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   373     0    0     4    0    0    53     3     9    3     38
1     0  1298    0     9    0    0     1    20     3    0      1
2     1     0  170     1   18    2     3     6     3  106      2
3     0     8    1  8208    0    9    10   133    68    3      0
4     2     0   31     0  318    2     5     3    24   15    139
5     0     0    1    25    0  401     1     0     4   88      1
6     1     0    0     1    1    0  1891     0     3    2      8
7     0    39    1   121    1    0     9  7051    35    3      3
8     1     5    5   112    4    1     8    68  3062    2     28
9     2     0    8     9    0   52     1     1     4  416      0
10   12     0    5     6   42    0    29    18    39    3  12636
---- Validation: 
scalar performance:
{'acc': 0.9570683, 'precision': 0.88619155, 'recall': 0.8461895, 'specificity': 0.99538934, 'f1': 0.86017853, 'auroc': 0.99667263}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   377     0    1     1    0    1    62     2     8    5     26
1     0  1290    0     7    0    0     1    27     4    0      3
2     1     1  166     3   24    0     3     1     2  111      0
3     0     8    1  8205    0   10     8   136    70    2      0
4     2     0   41     1  311    2     8     2    20   16    136
5     1     0    0    26    0  393     0     0     6   94      1
6     2     0    0     1    1    0  1893     1     3    1      6
7     0    51    2   138    1    0     7  7030    27    4      5
8     0     0    7   115    7    0    10    77  3051    4     25
9     0     0    7     8    0   49     3     1     6  419      0
10    8     0    4     6   34    2    44    16    34    3  12645
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7360946, 'precision': 0.69935644, 'recall': 0.60804355, 'specificity': 0.9731002, 'f1': 0.62201166, 'auroc': 0.8850123}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   753     0    0    6    1    2   366    5     4   27     6
1     0  1162    0   27    2    0    23  236     6    5    38
2     1     1  191   11  353    4    55   20   170  143    66
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  623    0     7    0     8    1   992
5     2     0    0   70    0  226    13    0     3  277     1
6     0     0    0    1    0    0  3062    0     1    0     3
7     0     0    0  208    0    0    31  920     0    2     3
8     0     0    0   79    0    0    25    6  1257    2     1
9     5     2   88   78   15   47    25   23   109  729    16
10    0     0    0    0   45    0     3    0     0    0  1598
better model found
persisted
after epoch: 5,now: 2024-08-03 20:57:56.478671,epoch time: 0:44:56.532709,used: 3:42:59.265511,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_14_56_seed_0_24051363
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95842254, 'precision': 0.8942088, 'recall': 0.864951, 'specificity': 0.9954654, 'f1': 0.8755745, 'auroc': 0.997747}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0     6    1    1    10     4     8    1     21
1     0  1303    1     7    1    0     0    16     4    0      0
2     1     1  188     4   19    2     1     8     3   83      2
3     0     2    1  8270    0   28     1    31   101    1      0
4     3     2   34     1  313    2     2     3    29   10    140
5     1     0    0    13    0  470     1     0     4   30      1
6     4     0    0     5    1    1  1881     2     6    1      6
7     0    23    1   337    1    0     3  6853    39    2      6
8     0     3    3   112    4    6     1    49  3094    7     17
9     2     1   15     4    1  111     1     2     2  354      0
10   14     6    3    13   25    2    11    21    33    1  12665
---- Validation: 
scalar performance:
{'acc': 0.958914, 'precision': 0.89460623, 'recall': 0.8653512, 'specificity': 0.9955123, 'f1': 0.87574077, 'auroc': 0.9977384}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   417     0    0     4    0    0    17     6     6    4     29
1     0  1298    0    10    0    0     0    19     5    0      0
2     0     1  187     5   20    1     1     5     2   86      4
3     0     4    1  8279    0   31     0    26    98    1      0
4     4     2   36     3  309    3     1     2    22   11    146
5     0     0    0     7    0  484     1     0     3   25      1
6     4     0    0     3    1    1  1877     3     6    3     10
7     0    25    0   310    3    0     2  6878    40    2      5
8     1     4    4   114    6    7     1    50  3083    8     18
9     1     0    9     5    0  109     0     0     3  366      0
10   10     5    3    12   34    2     7    16    35    1  12671
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73420554, 'precision': 0.68217134, 'recall': 0.6273375, 'specificity': 0.9733062, 'f1': 0.6215994, 'auroc': 0.87399435}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   951     1    0   19    2    8   151    6    19   11     2
1     0  1355    1   16    2    2     1  111     6    1     4
2     3     2  164   16  248   23    24   32   316   69   118
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  334    0     4    1    22    0  1270
5     4     0    0   56    3  454     7    0     6   60     2
6     0     0    0    3    4    0  2994    3    25    0    38
7     0     0    0  308    0    0     3  849     1    1     2
8     0     0    0   52    0    3     4    5  1305    1     0
9     9     8  106   84   14  190    21   46   189  457    13
10    0     1    0    0   11    0     2    0     1    0  1631
better model found
persisted
after epoch: 6,now: 2024-08-03 21:42:47.239857,epoch time: 0:44:50.761186,used: 4:27:50.026697,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_14_56_seed_0_24051363
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96583366, 'precision': 0.90740824, 'recall': 0.86915076, 'specificity': 0.99621147, 'f1': 0.8863536, 'auroc': 0.99798656}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   410     0    1     3    1    0     8     3     6    6     44
1     0  1290    1     4    0    0     0    31     5    0      1
2     1     0  221     4   35    3     0     4     6   35      3
3     0     1    0  8283    0    3     1    95    55    0      1
4     0     0   21     2  348    2     0     2    20    3    141
5     0     0    1    36    0  440     0     0     4   39      1
6     5     0    0     3    2    1  1873     1     6    2     15
7     1     7    2   118    2    0     3  7093    25    0     11
8     0     1    5    84    5    1     1    63  3105    1     28
9     1     0   50    14    0   91     0     3     5  329      0
10    3     0    3     9   29    2     3    10    28    0  12707
---- Validation: 
scalar performance:
{'acc': 0.9661896, 'precision': 0.9119452, 'recall': 0.87485605, 'specificity': 0.9962468, 'f1': 0.89195, 'auroc': 0.99798363}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     0    0     1    3    1     6     2     6    6     46
1     0  1289    0     4    0    0     1    32     5    0      1
2     2     0  230     3   31    2     0     5     4   33      2
3     0     3    0  8287    0    2     2   101    43    2      0
4     1     0   22     2  361    1     0     1    19    4    128
5     0     0    0    49    0  435     0     0     4   32      1
6     4     0    0     1    6    1  1871     3     5    2     15
7     0     6    0   135    1    0     2  7093    12    0     16
8     0     0    4    90   10    2     0    76  3096    2     16
9     0     0   36    12    3   96     0     1     5  340      0
10    3     0    1     9   37    2     2     6    29    0  12707
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70580006, 'precision': 0.6800698, 'recall': 0.58806247, 'specificity': 0.97074246, 'f1': 0.58799183, 'auroc': 0.8669189}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   939     0    0   28    1    1   102    12    52   17    18
1     0  1184    0   28    4    0     0   256    11    0    16
2     1     1  166   34  164   20     9    53   377   54   136
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  301    0     2     1    27    0  1301
5     2     0    0  249    0  287     0     0     7   46     1
6     0     0    0   23    8    0  2988     2    33    0    13
7     0     0    0   95    0    0    10  1056     1    0     2
8     0     0    0  153    0    0     0    13  1203    1     0
9     4     1   76  252    9  131     4    96   207  334    23
10    0     0    0    0   15    0     0     0     1    0  1630
better model found
persisted
after epoch: 7,now: 2024-08-03 22:37:45.734540,epoch time: 0:54:58.494683,used: 5:22:48.521380,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_14_56_seed_0_24051363
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96770656, 'precision': 0.91480356, 'recall': 0.88453233, 'specificity': 0.99647593, 'f1': 0.897485, 'auroc': 0.9983453}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     1    0    0     0     0     2    1     24
1     0  1266    0    10    0    0     0    46     8    0      2
2     3     0  199     1   44    3     1     6     8   43      4
3     2     0    0  8301    0    6     0    33    93    0      1
4     4     0   10     2  382    1     1     2    26    0    111
5     3     0    0    27    0  465     0     0     6   19      1
6    13     0    0     4    1    0  1876     0     4    1      8
7     1     2    2   221    2    0     4  6975    47    1      8
8     1     0    2    54    1    2     0    19  3202    0     14
9     2     0   32     5    0   95     1     2     8  348      0
10   12     0    0     9   35    0     6     3    30    0  12700
---- Validation: 
scalar performance:
{'acc': 0.96672463, 'precision': 0.90980583, 'recall': 0.8791976, 'specificity': 0.99638605, 'f1': 0.8920746, 'auroc': 0.9983571}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     2    1    0     1     0     2    2     18
1     0  1261    0    14    0    0     0    46     9    0      2
2     3     0  203     0   44    2     0     1    16   40      3
3     0     1    0  8320    0    4     0    39    73    1      2
4     6     0   10     0  375    2     0     2    29    1    114
5     2     0    0    29    0  460     0     0     8   21      1
6     7     0    0     5    3    0  1881     0     3    2      7
7     0     2    0   213    1    1     1  6975    59    1     12
8     1     0    1    48    1    1     0    20  3208    0     16
9     2     0   35     3    1  115     2     1    12  322      0
10   10     0    3     9   40    1    10     2    42    0  12679
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7125866, 'precision': 0.66916984, 'recall': 0.590961, 'specificity': 0.9713731, 'f1': 0.58497494, 'auroc': 0.86536217}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1086     0    0   18    0    0    33     4    20    5     4
1      1  1107    1   38    1    0     4   281    15    0    51
2     30     0  118   21  182   13    22    24   421   32   152
3      0     0    0    0    0    0     0     0     0    0     0
4      3     0    1    0  366    0     5     1    24    0  1233
5     25     0    1  203    1  277     7     0    10   67     1
6      0     0    0    9    0    0  3041     1     4    0    12
7      2     0    0  143    0    0     8  1004     4    0     3
8      0     0    0   90    0    0     4     3  1272    0     1
9     52     1   98  218   12  102     8    52   273  295    26
10     0     0    0    0   25    0     1     0     1    0  1619
better model found
persisted
after epoch: 8,now: 2024-08-03 23:48:37.413178,epoch time: 1:10:51.678638,used: 6:33:40.200018,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_14_56_seed_0_24051363
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9723619, 'precision': 0.9230144, 'recall': 0.89449483, 'specificity': 0.99692035, 'f1': 0.90714395, 'auroc': 0.9980938}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     2    0    0     1     2     2    4     16
1     0  1298    0     5    0    0     0    23     5    0      0
2     4     0  218     0   41    0     0     5     2   40      2
3     2     1    2  8294    0    8     1   102    27    2      0
4     5     0   10     1  359    0     1     3     8    3    149
5     0     0    0    13    0  440     0     0     3   64      1
6    13     0    1     3    0    0  1872     0     3    1     15
7     0     6    1    74    1    0     2  7155    19    0      6
8     2     0    4    85    9    2     0    51  3106    0     37
9     2     0   30     2    1   51     0     0     1  406      0
10    8     0    0     9   10    1     6     5    12    0  12739
---- Validation: 
scalar performance:
{'acc': 0.9721546, 'precision': 0.925158, 'recall': 0.8900262, 'specificity': 0.9968854, 'f1': 0.9052113, 'auroc': 0.99821234}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     0    0    0     1     2     1    5     19
1     0  1292    0     7    0    0     1    29     3    0      0
2     4     0  210     3   35    0     0     6     5   42      7
3     1     2    0  8290    0    9     2    99    35    2      0
4     4     0    6     1  353    1     0     1    10    2    161
5     0     0    0    12    0  437     0     0     2   69      1
6    14     0    1     1    1    0  1873     0     2    1     15
7     1     5    0    85    1    0     1  7156    10    0      6
8     1     0    3    80    4    4     1    52  3128    1     22
9     0     0   29     5    0   49     1     3     1  403      2
10    9     1    1     7   11    1     4     4    11    0  12747
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73189676, 'precision': 0.6626983, 'recall': 0.617798, 'specificity': 0.97296876, 'f1': 0.6029389, 'auroc': 0.8502824}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1068     0   0   9    1    1    39     7    18   19     8
1      2  1250   0  19    2    0     2   170    16    2    36
2      6     0  81   7  195   11    32    14   375   70   224
3      0     0   0   0    0    0     0     0     0    0     0
4      0     0   1   0  201    0     2     0    10    1  1418
5      4     0   0  87    0  312     5     0     8  174     2
6      0     0   0   2    0    0  3001     0     4    0    60
7      0     0   0  66    0    0     9  1076     9    1     3
8      0     0   0  79    0    0     4     1  1281    2     3
9     16     2  92  64    6   83    10    32   248  552    32
10     0     0   0   0    6    0     1     0     0    0  1639
better model found
persisted
after epoch: 9,now: 2024-08-04 01:00:59.708231,epoch time: 1:12:22.295053,used: 7:46:02.495071,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_14_56_seed_0_24051363
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96711797, 'precision': 0.90543103, 'recall': 0.8908024, 'specificity': 0.9964029, 'f1': 0.8951287, 'auroc': 0.99847794}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     0    1    0     0     2     0    5     18
1     0  1279    0    11    0    0     0    33     8    0      1
2     1     0  229     0   21    2     0     2     4   53      0
3     0     0    1  8305    0   31     0    49    50    4      0
4     7     0   25     0  331    2     0     4    16    3    151
5     0     0    0     6    0  475     0     0     1   38      1
6    50     0    2     2    2    0  1829     0     5    3     12
7     1     5    2   178    2    1     1  7012    56    0      6
8     3     0    1   112    3    8     0    20  3122    6     19
9     1     0   33     2    0   71     0     0     1  385      0
10   22     0    2     9   13    2     3     4    14    1  12723
---- Validation: 
scalar performance:
{'acc': 0.96811557, 'precision': 0.9125767, 'recall': 0.8967825, 'specificity': 0.99649686, 'f1': 0.9013132, 'auroc': 0.9984233}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    1     1    0    0     0     1     1    5     10
1     0  1277    0    11    0    0     0    42     1    0      1
2     0     0  238     0   19    0     0     2     7   46      0
3     0     0    0  8320    0   23     0    43    52    2      0
4     4     0   27     1  325    0     0     2    15    7    158
5     0     0    0     9    0  476     0     0     2   33      1
6    61     0    0     1    3    0  1820     3     2    3     15
7     2     6    0   181    1    0     2  7014    54    1      4
8     3     0    2   102    3   10     0    25  3126    8     17
9     0     0   27     1    0   62     0     0     0  403      0
10   21     0    1     6   11    1     2     8    14    2  12730
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7355349, 'precision': 0.6788513, 'recall': 0.638672, 'specificity': 0.9735234, 'f1': 0.6261492, 'auroc': 0.86285657}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1092     0    0    4    1    2    20    7    20   15     9
1      0  1255    3   26    1    3     1  160    20    6    24
2      4     0  195    4  198   18    24   18   296  112   146
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    2    0  166    0     2    1    13    1  1448
5      5     0    0   44    0  457     2    0     4   77     3
6      5     0    1    1    5    0  2933    0    12    2   108
7      1     0    1  214    0    1     8  926    10    0     3
8      1     0    0  115    0    6     5    1  1237    2     3
9     16     4   92   70    8  204     5   25    86  611    16
10     0     0    0    0    5    0     0    0     0    0  1641
early stop counter: 1
val acc:0.9681155681610107, best validation acc: 0.9721546173095703, corresponding to test acc:                         0.7318967580795288 / 0.7576435804367065
after epoch: 10,now: 2024-08-04 01:51:18.467637,epoch time: 0:50:18.759406,used: 8:36:21.254477,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_14_56_seed_0_24051363
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 8:36:21.254477 at 2024-08-04 01:51:18.467637
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73189676, 'precision': 0.6626983, 'recall': 0.617798, 'specificity': 0.97296876, 'f1': 0.6029389, 'auroc': 0.8502824}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1068     0   0   9    1    1    39     7    18   19     8
1      2  1250   0  19    2    0     2   170    16    2    36
2      6     0  81   7  195   11    32    14   375   70   224
3      0     0   0   0    0    0     0     0     0    0     0
4      0     0   1   0  201    0     2     0    10    1  1418
5      4     0   0  87    0  312     5     0     8  174     2
6      0     0   0   2    0    0  3001     0     4    0    60
7      0     0   0  66    0    0     9  1076     9    1     3
8      0     0   0  79    0    0     4     1  1281    2     3
9     16     2  92  64    6   83    10    32   248  552    32
10     0     0   0   0    6    0     1     0     0    0  1639
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7576436, 'precision': 0.69281507, 'recall': 0.6340403, 'specificity': 0.97575736, 'f1': 0.63924396, 'auroc': 0.88372815}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1068     0    0   12    0    1    62   17     6    3     1
1      4  1288    1   20    2    1     2  159    11    2     9
2     18     5  236   15  193   13    29   43   359   59    45
3      0     0    0    0    0    0     0    0     0    0     0
4      1     3    3    0  653    0     5    3    22    0   943
5     18     0    0  120    0  261    10    0    24  158     1
6      0     0    0    6    7    0  3013    4    11    0    26
7      0     0    0  168    0    0     3  989     0    1     3
8      0     0    0   72    0    1     9    6  1281    1     0
9     40    16  169   76    4   69    10   51   245  451     6
10     0     3    0    0   51    0     2    0     1    0  1589
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_14_56_seed_0_24051363_instance_wise_predictions.txt
accuracy from prediction file 0.7318967326663401
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/10.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2611 MiB |  16814 MiB | 414312 GiB | 414309 GiB |
|       from large pool |   2597 MiB |  16782 MiB | 411240 GiB | 411237 GiB |
|       from small pool |     14 MiB |     33 MiB |   3072 GiB |   3072 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2611 MiB |  16814 MiB | 414312 GiB | 414309 GiB |
|       from large pool |   2597 MiB |  16782 MiB | 411240 GiB | 411237 GiB |
|       from small pool |     14 MiB |     33 MiB |   3072 GiB |   3072 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2607 MiB |  16770 MiB | 412754 GiB | 412751 GiB |
|       from large pool |   2594 MiB |  16737 MiB | 409685 GiB | 409682 GiB |
|       from small pool |     13 MiB |     33 MiB |   3069 GiB |   3069 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  17542 MiB |  17542 MiB |  17542 MiB |      0 B   |
|       from large pool |  17506 MiB |  17506 MiB |  17506 MiB |      0 B   |
|       from small pool |     36 MiB |     36 MiB |     36 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 305829 KiB | 700029 KiB |  64354 GiB |  64354 GiB |
|       from large pool | 285440 KiB | 697280 KiB |  61276 GiB |  61276 GiB |
|       from small pool |  20389 KiB |  23171 KiB |   3078 GiB |   3078 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3082    |    4805    |   31279 K  |   31276 K  |
|       from large pool |     349    |     697    |   13399 K  |   13398 K  |
|       from small pool |    2733    |    4255    |   17880 K  |   17877 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3082    |    4805    |   31279 K  |   31276 K  |
|       from large pool |     349    |     697    |   13399 K  |   13398 K  |
|       from small pool |    2733    |    4255    |   17880 K  |   17877 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     510    |     510    |     510    |       0    |
|       from large pool |     492    |     492    |     492    |       0    |
|       from small pool |      18    |      18    |      18    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     172    |    1218    |   16855 K  |   16854 K  |
|       from large pool |     130    |     339    |    8787 K  |    8787 K  |
|       from small pool |      42    |    1087    |    8067 K  |    8067 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  16814 MiB | 414312 GiB | 414312 GiB |
|       from large pool |  16640 KiB |  16782 MiB | 411240 GiB | 411240 GiB |
|       from small pool |      0 KiB |     33 MiB |   3072 GiB |   3072 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  16814 MiB | 414312 GiB | 414312 GiB |
|       from large pool |  16640 KiB |  16782 MiB | 411240 GiB | 411240 GiB |
|       from small pool |      0 KiB |     33 MiB |   3072 GiB |   3072 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  16770 MiB | 412754 GiB | 412754 GiB |
|       from large pool |  16640 KiB |  16737 MiB | 409685 GiB | 409685 GiB |
|       from small pool |      0 KiB |     33 MiB |   3069 GiB |   3069 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2910 MiB |  17542 MiB |  17542 MiB |  14632 MiB |
|       from large pool |   2876 MiB |  17506 MiB |  17506 MiB |  14630 MiB |
|       from small pool |     34 MiB |     36 MiB |     36 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 700029 KiB |  64356 GiB |  64356 GiB |
|       from large pool |  24320 KiB | 697280 KiB |  61277 GiB |  61277 GiB |
|       from small pool |      0 KiB |  28880 KiB |   3078 GiB |   3078 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4805    |   31279 K  |   31279 K  |
|       from large pool |       2    |     697    |   13399 K  |   13399 K  |
|       from small pool |       0    |    4255    |   17880 K  |   17880 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4805    |   31279 K  |   31279 K  |
|       from large pool |       2    |     697    |   13399 K  |   13399 K  |
|       from small pool |       0    |    4255    |   17880 K  |   17880 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     150    |     510    |     510    |     360    |
|       from large pool |     133    |     492    |     492    |     359    |
|       from small pool |      17    |      18    |      18    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1218    |   16855 K  |   16855 K  |
|       from large pool |       3    |     339    |    8787 K  |    8787 K  |
|       from small pool |       0    |    1087    |    8068 K  |    8068 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  16814 MiB | 414312 GiB | 414312 GiB |
|       from large pool |  16640 KiB |  16782 MiB | 411240 GiB | 411240 GiB |
|       from small pool |      0 KiB |     33 MiB |   3072 GiB |   3072 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  16814 MiB | 414312 GiB | 414312 GiB |
|       from large pool |  16640 KiB |  16782 MiB | 411240 GiB | 411240 GiB |
|       from small pool |      0 KiB |     33 MiB |   3072 GiB |   3072 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  16770 MiB | 412754 GiB | 412754 GiB |
|       from large pool |  16640 KiB |  16737 MiB | 409685 GiB | 409685 GiB |
|       from small pool |      0 KiB |     33 MiB |   3069 GiB |   3069 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2910 MiB |  17542 MiB |  17542 MiB |  14632 MiB |
|       from large pool |   2876 MiB |  17506 MiB |  17506 MiB |  14630 MiB |
|       from small pool |     34 MiB |     36 MiB |     36 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 700029 KiB |  64356 GiB |  64356 GiB |
|       from large pool |  24320 KiB | 697280 KiB |  61277 GiB |  61277 GiB |
|       from small pool |      0 KiB |  28880 KiB |   3078 GiB |   3078 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4805    |   31279 K  |   31279 K  |
|       from large pool |       2    |     697    |   13399 K  |   13399 K  |
|       from small pool |       0    |    4255    |   17880 K  |   17880 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4805    |   31279 K  |   31279 K  |
|       from large pool |       2    |     697    |   13399 K  |   13399 K  |
|       from small pool |       0    |    4255    |   17880 K  |   17880 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     150    |     510    |     510    |     360    |
|       from large pool |     133    |     492    |     492    |     359    |
|       from small pool |      17    |      18    |      18    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1218    |   16855 K  |   16855 K  |
|       from large pool |       3    |     339    |    8787 K  |    8787 K  |
|       from small pool |       0    |    1087    |    8068 K  |    8068 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_15_02_seed_1_24051363

 Experiment start at: 2024-08-04 02:15:04.024153
before training, model accuracy: 0.06926468014717102
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92069775, 'precision': 0.82802343, 'recall': 0.71324366, 'specificity': 0.9911537, 'f1': 0.7399451, 'auroc': 0.9851508}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   283     0    0    15   0    1    18    27    18    4    116
1     0  1170    0    21   0    0     0   123    10    0      6
2     3     0  176     1  11    0     4    28    55   23     11
3     1     0    2  8032   0    5     0   249   149    0      1
4     1     1   57     3  59    0     3    12   154   10    239
5     4     0   20    84   0  297     0     0    12  103      1
6    21     2    0    20   0    2  1692    21    20    4    126
7     0     4    1   236   0    0     1  6903   105    0     12
8     0     0    2   167   0    0     0    85  3011    0     31
9     7     0  124    15   1   84     1    11    23  222      5
10    8     0    1     8   1    0     6    51   151    1  12567
---- Validation: 
scalar performance:
{'acc': 0.9204494, 'precision': 0.83139193, 'recall': 0.7124835, 'specificity': 0.9911421, 'f1': 0.7385138, 'auroc': 0.9856637}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   286     0    1    15   0    0    16    25    26    6    108
1     0  1177    0    22   0    0     0   115    11    0      7
2     3     0  181     2   8    2     4    26    46   28     12
3     0     0    0  8015   0    6     0   268   150    1      0
4     0     0   55     3  55    0     3     9   163   13    238
5     2     0   21    78   0  286     0     0    13  120      1
6    13     0    0    20   0    1  1691    25    25    6    127
7     0     2    0   239   0    0     1  6888   119    0     16
8     0     1    1   165   0    0     0    75  3028    0     26
9     7     0  118    15   0   87     1     8    31  219      7
10    3     0    1     7   1    1     9    45   140    4  12585
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.53669626, 'precision': 0.5588773, 'recall': 0.48230577, 'specificity': 0.9534433, 'f1': 0.43960628, 'auroc': 0.80272883}
confusion matrix:
     0    1   2    3   4    5     6     7     8    9     10
0   912    1   0   43   0    0    19   142    28    1    24
1     3  983   0   37   0    0     1   413    15    0    47
2    78    0  43   18  10    5     3    56   602   34   166
3     0    0   0    0   0    0     0     0     0    0     0
4     2    0   0    0  15    0     0     6    55    0  1555
5    78    0   2  148   0  213     1     1    33  114     2
6     2    7   1   13  18    0  1313    20   349    0  1344
7     0    0   0   26   0    0     0  1132     1    1     4
8     1    0   0  117   0    1     0     8  1240    0     3
9   163    3  85  156   0   39     2    97   390  174    28
10    0    0   0    0   0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 03:07:12.144420,epoch time: 0:52:08.120267,used: 0:52:08.120267,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_15_02_seed_1_24051363
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9377408, 'precision': 0.85732687, 'recall': 0.79375935, 'specificity': 0.9930658, 'f1': 0.81838244, 'auroc': 0.99352264}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   386     1    0    12    0    0    19     2    12    6     45
1     0  1274    0    23    0    0     0    26     5    0      4
2     1     0  117     6   79    3     1     8    20   73      4
3     1     2    0  8305    0    7     0    52    69    1      0
4     2     0    6     4  265    1     6     4    55   13    183
5     1     0    2    56    0  406     1     0     4   50      1
6     9     0    0     6    1    0  1866     2     7    2     15
7     2    32    0   602    2    0     3  6511    96    0     14
8     2     1    1   229    3    0     0    47  2973    0     40
9     2     0   41    22    5  124     1     4     7  285      1
10   11     0    0     9   23    0    13    21    51    5  12661
---- Validation: 
scalar performance:
{'acc': 0.93564266, 'precision': 0.85938865, 'recall': 0.79598117, 'specificity': 0.99281716, 'f1': 0.82068634, 'auroc': 0.99342316}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   385     1    0     9    0    0    19     6     6    4     53
1     0  1275    0    20    0    0     0    25     7    0      5
2     2     1  129     4   77    2     2     9    12   70      4
3     2     4    0  8285    0    9     0    65    75    0      0
4     2     1    8     2  264    1     4     5    56    9    187
5     0     0    2    51    0  413     0     0     5   49      1
6     8     0    0    10    0    0  1858     1     8    3     20
7     0    42    0   643    1    1     2  6474    91    0     11
8     1     0    1   235    7    0     1    52  2960    0     39
9     4     0   35    20    8  128     3     1     9  282      3
10   13     1    0     8   22    1    11    24    60    2  12654
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65108794, 'precision': 0.6092489, 'recall': 0.55590343, 'specificity': 0.96522254, 'f1': 0.5359485, 'auroc': 0.8342517}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1075     1   0   31    0    0    31    9     7    6    10
1      0  1176   0   51    1    0     3  210    21    0    37
2     25     0  29   41  173    9     2   22   441   80   193
3      0     0   0    0    0    0     0    0     0    0     0
4      1     0   0    0  103    0     0    0    26    1  1502
5     13     0   0  141    0  342     0    0    13   82     1
6      0     1   0   14    8    0  2522    5   110    0   407
7      1     0   0  238    0    0     3  914     4    0     4
8      0     0   0  130    0    0     1    1  1235    1     2
9     35     2  41  218   36  150     0   32   333  268    22
10     0     0   0    0    3    0     0    1     0    0  1642
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 03:51:02.648086,epoch time: 0:43:50.503666,used: 1:35:58.623933,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_15_02_seed_1_24051363
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9465432, 'precision': 0.86974114, 'recall': 0.8423789, 'specificity': 0.99412817, 'f1': 0.8537719, 'auroc': 0.99571866}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    1    10    2    0     6     4     1    7     21
1     0  1255    0    17    0    0     0    54     4    0      2
2     2     0  172     0   34    2     1     6     8   87      0
3     1     1    0  8315    0   11     0    80    27    2      0
4     6     0   24     4  338    2     1     5    32   17    110
5     1     0    2    37    0  400     0     0     4   76      1
6    12     0    0    10    2    1  1867     2     5    4      5
7     0     9    0   387    1    0     2  6838    21    0      6
8     2     0    2   335    5    1     0    86  2842    2     19
9     2     0   36    12    0   72     2     4     2  362      0
10   48     0    1    11   72    1    15    39    44    5  12558
---- Validation: 
scalar performance:
{'acc': 0.9454594, 'precision': 0.8716844, 'recall': 0.84023637, 'specificity': 0.9939943, 'f1': 0.8527441, 'auroc': 0.9958452}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    0     4    2    0     7     6     4    7     18
1     0  1246    0    23    0    0     0    60     1    0      2
2     2     1  167     1   40    1     1     6     5   88      0
3     0     1    0  8336    0    8     1    64    28    2      0
4     6     0   23     3  337    2     0     8    29   13    118
5     0     0    0    39    0  389     0     0     4   88      1
6    14     0    1     8    0    0  1865     4     4    4      8
7     1     7    0   408    1    0     2  6820    22    0      4
8     3     0    2   353   11    0     2    77  2820    1     27
9     1     0   25    10    2   75     1     1     4  374      0
10   42     1    1    10   73    1    22    39    46    4  12557
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7006227, 'precision': 0.6761813, 'recall': 0.5835776, 'specificity': 0.9705786, 'f1': 0.58872974, 'auroc': 0.8555977}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1077     1   0   50    0    1     8    16     1   16     0
1      1  1004   0   41    0    0     0   447     1    0     5
2     22     2  90   80  187    5     4   104   395   79    47
3      0     0   0    0    0    0     0     0     0    0     0
4      3     2   1    0  582    0     2     5    32    1  1005
5      3     0   1  186    0  254     0     0     6  142     0
6      8     0   0  104    2    0  2876    10    48    0    19
7      1     0   0   70    0    0     0  1092     0    0     1
8      0     0   0  245    0    0     1    28  1093    2     1
9     17     6  70  340   15   45     0   131   146  364     3
10     0     0   0    0   59    0     3     2     0    0  1582
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-04 04:35:14.125092,epoch time: 0:44:11.477006,used: 2:20:10.100939,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_15_02_seed_1_24051363
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95143944, 'precision': 0.88528025, 'recall': 0.8280523, 'specificity': 0.9946221, 'f1': 0.8479445, 'auroc': 0.99584407}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   398     0    0     6    1    0    13     5     8   15     37
1     0  1271    0    10    0    0     0    50     1    0      0
2     0     0  180     1   11    1     0    17     7   94      1
3     0     1    0  8190    0    8     0   203    35    3      0
4     4     1   65     0  227    2     3    12    36   20    168
5     0     0    1    43    0  408     0     0     5   63      1
6     2     1    0     7    0    0  1854     9     7    8     20
7     0    11    0   131    1    0     1  7095    17    0      6
8     1     0    4   201    2    1     1   133  2919    2     30
9     1     0   12     7    0   85     0    10     6  372      0
10   12     0    4     6   16    1    14    35    52    6  12647
---- Validation: 
scalar performance:
{'acc': 0.95313627, 'precision': 0.8889962, 'recall': 0.8349929, 'specificity': 0.9948136, 'f1': 0.8543402, 'auroc': 0.9960701}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   406     0    1     3    0    1    12    10     5   11     34
1     0  1269    0     8    0    0     0    51     3    0      1
2     1     0  181     2   12    3     0    15     6   90      2
3     0     1    0  8194    0    7     0   200    35    3      0
4     3     1   64     0  242    2     1    16    33   19    158
5     0     0    1    41    0  410     0     0     4   64      1
6     6     1    0     4    0    1  1861    11     7    5     12
7     0     9    0   118    1    0     1  7117    15    0      4
8     1     0    4   216    2    3     0   140  2904    1     25
9     0     0   14     8    0   76     0     6     5  384      0
10    9     1    3     6   18    2    10    35    44    3  12665
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6631918, 'precision': 0.6627325, 'recall': 0.5742568, 'specificity': 0.96666145, 'f1': 0.55668074, 'auroc': 0.8362808}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   971     1   0   38    0   10    36    48     3   58     5
1     0  1097   0   35    0    0     0   359     2    0     6
2     6     1  96   40   83   32     0   114   432  109   102
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   1    0  236    0     0     8    38    2  1347
5     1     0   0  124    0  420     0     0     2   45     0
6     0     3   0   79    4    0  2571    22   217    0   171
7     0     0   0   89    0    0     0  1073     0    0     2
8     0     0   0  268    0    1     0    18  1081    1     1
9     6     2  27  242    2  225     0   115   199  303    16
10    0     0   0    0   12    0     0     1     2    0  1631
better model found
persisted
after epoch: 4,now: 2024-08-04 05:18:24.356582,epoch time: 0:43:10.231490,used: 3:03:20.332429,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_15_02_seed_1_24051363
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96107125, 'precision': 0.8844973, 'recall': 0.8789805, 'specificity': 0.9958282, 'f1': 0.8796896, 'auroc': 0.9975478}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    2     5    1    0     5     1     6    3      8
1     0  1269    0    13    0    0     0    47     2    0      0
2     2     0  244     1   23    1     0     1     2   38      0
3     1     1    0  8224    0    5     1   122    81    1      0
4     5     1   47     0  332    0     1     2    22   12    117
5     1     0    1    33    0  431     0     0     3   51      1
6    22     0    1     2    2    1  1866     3     4    0      7
7     3     7    3   149    1    0     1  7053    41    1      4
8     2     0    8    93    4    1     0    66  3103    1     17
9     2     0   50     3    1   82     0     3     5  347      0
10   63     0    3     8   45    0    14    14    45    3  12600
---- Validation: 
scalar performance:
{'acc': 0.9624983, 'precision': 0.8902817, 'recall': 0.8804026, 'specificity': 0.9959819, 'f1': 0.88408124, 'auroc': 0.99751735}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     6    0    0     3     1     4    4      7
1     0  1273    0    10    0    0     0    44     5    0      0
2     1     0  227     1   25    2     1     0     3   52      0
3     2     0    0  8241    0    3     2   110    81    1      0
4     6     1   41     1  343    0     0     2    23   10    112
5     0     0    2    36    0  431     0     0     6   45      1
6    19     0    0     3    3    0  1866     1     8    2      6
7     0     7    1   135    1    0     1  7064    50    1      5
8     1     0    6    90    4    1     1    58  3116    0     19
9     2     0   46     7    2   64     0     2     9  361      0
10   53     0    1     7   49    0    15    12    52    4  12603
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.698034, 'precision': 0.6464739, 'recall': 0.59345055, 'specificity': 0.97014666, 'f1': 0.57687473, 'auroc': 0.852618}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1135     0    1   16    0    1     0     6     4    7     0
1      1  1207    2   36    0    0     1   245     2    0     5
2     42     1  148   49  197   23     1    36   379   57    82
3      0     0    0    0    0    0     0     0     0    0     0
4      4     1    2    0  287    0     1     3    25    1  1309
5     24     0    0  199    1  341     0     0     5   22     0
6     49     2    0   66    3    0  2770     2    63    0   112
7      9     1    0   78    0    0     0  1073     1    0     2
8      1     0    0  167    0    1     1     3  1196    1     0
9     44     2  141  268    8  207     0    45   216  189    17
10     0     0    0    0   14    0     0     1     0    0  1631
better model found
persisted
after epoch: 5,now: 2024-08-04 06:00:46.291949,epoch time: 0:42:21.935367,used: 3:45:42.267796,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_15_02_seed_1_24051363
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9626498, 'precision': 0.9018618, 'recall': 0.86205095, 'specificity': 0.99587345, 'f1': 0.8747024, 'auroc': 0.99769455}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    0     3    0    0     5     2     0    6     17
1     0  1293    0     7    0    0     0    29     3    0      0
2     5     0  196     0   40    0     1     2     1   60      7
3     0     1    0  8224    1   11     1   152    40    4      1
4     7     1   20     1  309    0     3     1    13    6    178
5     2     0    0    18    0  334     1     0     4  161      1
6    17     0    0     3    1    0  1871     3     2    1     10
7     0    16    0    88    1    0     1  7110    29    2     16
8     2     0    5   120    6    4     1    75  3041    1     40
9     4     1   25     4    2   14     0     4     0  437      2
10   28     0    0     8   11    0     7    14    11    1  12715
---- Validation: 
scalar performance:
{'acc': 0.9614284, 'precision': 0.900465, 'recall': 0.8635513, 'specificity': 0.9957496, 'f1': 0.87442434, 'auroc': 0.9975933}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     1    0    0     4     1     0    4     11
1     0  1287    0     9    0    0     0    31     5    0      0
2     3     1  202     0   37    0     0     5     4   56      4
3     1     2    0  8200    1   15     0   164    55    2      0
4     6     2   15     1  311    0     0     3    13   12    176
5     0     0    0    19    0  326     0     0     1  174      1
6    14     0    0     4    0    0  1869     1     0    2     18
7     0     9    1    87    1    0     1  7108    37    2     19
8     3     2    5   119    3    4     0    83  3028    9     40
9     3     0   31     3    2   13     0     1     0  436      4
10   29     0    0     6   15    0     8     8    12    4  12714
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7022319, 'precision': 0.65444434, 'recall': 0.58333135, 'specificity': 0.97039557, 'f1': 0.5732854, 'auroc': 0.852131}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1127     2    0   16    0    0     2    9     2   11     1
1      2  1247    0   37    0    0     1  198     3    1    10
2     49     2  109   30  157    3     1   39   250  123   252
3      0     0    0    0    0    0     0    0     0    0     0
4      1     0    0    0  119    0     1    2    15    1  1494
5     17     0    0  103    0  166     0    0     3  302     1
6     47     0    0   34    1    0  2879    2     9    0    95
7      9     7    0  189    0    0     4  951     0    2     2
8      3     0    0  191    0    0     2    9  1156    5     4
9     36     3  101  173    4   32     0   53    65  641    29
10     0     0    0    0    3    0     0    1     0    0  1642
new oracle model saved
early stop counter: 1
val acc:0.9614284038543701, best validation acc: 0.9624983072280884, corresponding to test acc:                         0.6980339884757996 / 0.7022318840026855
after epoch: 6,now: 2024-08-04 06:42:32.440023,epoch time: 0:41:46.148074,used: 4:27:28.415870,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_15_02_seed_1_24051363
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9667969, 'precision': 0.91439176, 'recall': 0.8778979, 'specificity': 0.99634886, 'f1': 0.8939337, 'auroc': 0.9981259}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   449     0    0     4    0    0     7     6     1    2     14
1     0  1288    0     4    0    0     0    37     3    0      0
2     5     0  226     0   40    0     0     6     5   28      2
3     0     0    0  8236    0    3     1   134    65    0      0
4     9     1   14     0  329    0     2     7    15    7    155
5     4     0    0    25    0  426     1     1     9   54      1
6     9     0    1     0    1    0  1881     3     3    0      8
7     0     7    0    86    1    0     3  7142    21    0      3
8     4     1    1    71    4    1     2    89  3108    1     12
9     4     0   41     7    4   65     2     5     7  358      0
10   11     1    1     7    7    0     6    33    36    0  12692
---- Validation: 
scalar performance:
{'acc': 0.9656012, 'precision': 0.9098668, 'recall': 0.8719269, 'specificity': 0.99619925, 'f1': 0.888138, 'auroc': 0.99818456}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    0     5    0    0     7     2     2    0     16
1     0  1289    0     4    0    0     0    37     2    0      0
2     3     0  217     3   36    1     1    11     6   31      3
3     1     2    0  8241    0    3     0   136    57    0      0
4     5     2   21     0  315    0     1     7    17    3    168
5     5     0    1    32    0  426     1     0     6   49      1
6    10     0    1     2    0    0  1876     4     4    0     11
7     0     8    0    86    1    0     2  7145    19    0      4
8     1     3    4    80    4    1     2    89  3096    1     15
9     9     0   53     7    3   54     2     4     6  354      1
10   17     0    1     7    9    1     9    25    38    0  12689
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69299656, 'precision': 0.63071144, 'recall': 0.57537264, 'specificity': 0.96940446, 'f1': 0.54503524, 'auroc': 0.85129637}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1115     1   0    8    0    0    12    31     1    1     1
1      0  1132   0   32    0    0     3   322     2    0     8
2     39     1  73   42  134   12    10    82   328   33   261
3      0     0   0    0    0    0     0     0     0    0     0
4      1     1   1    0   94    0     1     3    14    0  1518
5     27     0   1  223    0  291     6     0    15   27     2
6      1     0   0    1    0    0  3035     2     4    0    24
7      0     0   0   41    0    0     2  1120     0    0     1
8      0     0   0  110    0    1     7    26  1226    0     0
9     64     2  77  244    9  137    10   109   271  177    37
10     0     0   0    0    3    0     0     1     0    0  1642
better model found
persisted
after epoch: 7,now: 2024-08-04 07:24:00.439450,epoch time: 0:41:27.999427,used: 5:08:56.415297,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_15_02_seed_1_24051363
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96746576, 'precision': 0.9214862, 'recall': 0.88208455, 'specificity': 0.99636704, 'f1': 0.89893156, 'auroc': 0.9986692}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    0     4    1    0     8     5     1    6     33
1     0  1290    0     5    1    0     0    33     2    0      0
2     0     0  203     0   41    0     0     5     4   58      1
3     0     2    0  8120    0   12     0   221    83    1      1
4     1     0   10     0  350    1     0     3     7    8    159
5     0     0    0    12    0  472     0     0     1   35      1
6     6     0    1     4    1    0  1877     5     2    2     10
7     0     6    0    58    1    0     1  7176    16    0      5
8     1     1    4    35    5    3     0    78  3119    0     49
9     2     0   19     1    2   83     0     2     1  380      3
10    2     0    1     4   12    0     5    15     3    1  12748
---- Validation: 
scalar performance:
{'acc': 0.96643037, 'precision': 0.9226635, 'recall': 0.88285697, 'specificity': 0.9962381, 'f1': 0.90019566, 'auroc': 0.9986978}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     1    0     2    0    0    10     5     2    2     40
1     0  1287    0     4    1    0     0    38     2    0      0
2     0     0  210     2   40    1     0     4     0   52      3
3     0     2    1  8116    0   11     0   218    92    0      0
4     2     0   12     0  346    0     1     4     9   10    155
5     0     0    0    10    1  464     0     0     2   43      1
6     2     0    0     1    1    0  1878     6     4    1     15
7     0    11    0    55    1    0     1  7173    19    0      5
8     1     1    4    37    8    2     0    80  3097    0     66
9     0     0   16     1    4   72     0     2     2  394      2
10    3     0    1     5   15    0     6    14     7    1  12744
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69264674, 'precision': 0.6296248, 'recall': 0.58514506, 'specificity': 0.96930695, 'f1': 0.5542594, 'auroc': 0.85103416}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   998     2   0   56    0    7    39    15    14   21    18
1     0  1088   0   32    0    0     1   356    10    0    12
2     4     0  39   20  204   30     2    38   374   47   257
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  125    0     1     2    15    1  1489
5     2     0   0  131    0  414     1     0     6   35     3
6     0     0   0    6    0    0  3013     3     5    0    40
7     1     0   0   67    0    0     0  1090     5    0     1
8     0     0   0  124    0    1     3     0  1239    1     2
9     6     1  38  157   19  235     2    61   327  256    35
10    0     0   0    0    5    0     2     1     0    0  1638
better model found
persisted
after epoch: 8,now: 2024-08-04 08:05:28.372094,epoch time: 0:41:27.932644,used: 5:50:24.347941,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_15_02_seed_1_24051363
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9669306, 'precision': 0.8860633, 'recall': 0.90816313, 'specificity': 0.99660695, 'f1': 0.89250594, 'auroc': 0.99883}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    7     1    3    0     0     4     0    4     14
1     0  1311    0     6    0    0     0    11     4    0      0
2     0     0  257     0   44    0     0     1     2    8      0
3     0     1    1  8146    2   12     0   176   100    1      0
4     4     1   20     0  484    1     0     0     4    0     25
5     0     0    7    10    0  445     0     0     2   56      1
6    13     1    2     0   10    0  1856     7     1    0     18
7     0    26    1    36    3    0     1  7155    34    1      5
8     0     2   12    27   29    2     0    52  3144    0     25
9     0     0  119     2    5   53     0     0     0  314      0
10    7     0    4     7  173    0     4    11     9    1  12578
---- Validation: 
scalar performance:
{'acc': 0.96747357, 'precision': 0.8867028, 'recall': 0.90711343, 'specificity': 0.9966521, 'f1': 0.89265287, 'auroc': 0.9987947}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    8     2    3    0     0     2     0    5     16
1     0  1311    0     3    0    0     0    14     4    0      0
2     0     0  258     0   37    0     0     1     2   14      0
3     0     3    1  8151    0    8     0   184    92    1      0
4     4     0   19     0  484    0     0     0     2    1     29
5     0     0    3    12    0  442     0     0     5   58      1
6    12     1    1     1    4    0  1866     3     1    1     18
7     0    26    1    44    5    0     1  7146    37    1      4
8     2     0    8    20   23    3     0    45  3169    0     26
9     0     0  127     1    5   51     0     0     2  307      0
10    5     0    6     6  169    0     3    10     8    1  12588
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7464493, 'precision': 0.67054355, 'recall': 0.63843143, 'specificity': 0.9746423, 'f1': 0.6374873, 'auroc': 0.86552304}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1055     2    7   25    4    2    25     5     4   39     2
1      0  1251    4   32    1    0     3   197     3    0     8
2      5     1  311    4  436   10     2    40   117   34    55
3      0     0    0    0    0    0     0     0     0    0     0
4      0     1    4    0  408    0     1     1     6    1  1211
5      3     0    8   77    5  384     0     0     8  105     2
6      0     0    0    1    2    0  3000     3     3    0    58
7      1     1    0   65    0    1     0  1093     1    0     2
8      0     0    1  115    5    4     9    13  1215    2     6
9      6     3  401   79   24  122     4    84    68  337     9
10     0     0    0    0   29    0     1     1     0    0  1615
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-04 08:47:04.526297,epoch time: 0:41:36.154203,used: 6:32:00.502144,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_15_02_seed_1_24051363
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9731914, 'precision': 0.9248377, 'recall': 0.9089647, 'specificity': 0.9970919, 'f1': 0.9162525, 'auroc': 0.99884903}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    1     6    1    0     5     4     0    0     21
1     0  1306    0     7    0    0     0    16     3    0      0
2     0     1  261     1   18    2     0     5     4   20      0
3     0     1    1  8231    0    3     0   152    50    0      0
4     3     0   21     0  427    1     0     2    11    4     70
5     0     0    0    25    0  428     0     0     2   65      1
6     3     0    0     1    1    0  1882     3     1    2     15
7     0    15    0    64    1    0     1  7163    13    0      5
8     1     0    6    58    2    0     0    65  3150    0     12
9     0     0   53     4    3   57     0     2     5  369      0
10    5     1    1     7   28    1     6    12    21    0  12712
---- Validation: 
scalar performance:
{'acc': 0.9730373, 'precision': 0.9249819, 'recall': 0.91210663, 'specificity': 0.99707186, 'f1': 0.91742116, 'auroc': 0.9989337}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    1     7    0    0     5     6     0    3     22
1     0  1300    0     6    0    0     0    24     2    0      0
2     0     0  272     1   12    1     0     4     5   16      1
3     0     1    0  8240    0    3     0   150    46    0      0
4     5     1   27     0  424    0     1     4     7    6     64
5     0     0    1    27    0  446     0     0     2   44      1
6     3     0    1     2    2    0  1879     4     3    0     14
7     0    13    1    68    1    0     1  7164    10    0      7
8     1     0    6    61    7    1     0    59  3142    2     17
9     0     0   59     3    3   59     1     0     3  365      0
10    5     3    1     6   33    1     6     9    25    1  12706
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7069894, 'precision': 0.6567844, 'recall': 0.59621704, 'specificity': 0.9708384, 'f1': 0.59247637, 'auroc': 0.84941053}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   933     3    1   51    0    3    58    81     4   22    14
1     0  1192    0   30    1    0     2   258     3    0    13
2     6     1  145   28  291   19     7    47   273   66   132
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    2    0  355    0     1     1    17    2  1255
5     1     0    1  197    2  347     0     0     6   37     1
6     0     1    0   11    3    0  2911     3     9    0   129
7     0     0    0   76    0    0     2  1081     0    0     5
8     0     0    0  143    0    0     3    22  1197    1     4
9     3     1  150  201   17  168     5    79   175  319    19
10    0     0    0    0   20    0     0     1     0    0  1625
better model found
persisted
after epoch: 10,now: 2024-08-04 09:28:30.628373,epoch time: 0:41:26.102076,used: 7:13:26.604220,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_15_02_seed_1_24051363
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 7:13:26.604220 at 2024-08-04 09:28:30.628373
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7069894, 'precision': 0.6567844, 'recall': 0.59621704, 'specificity': 0.9708384, 'f1': 0.59247637, 'auroc': 0.84941053}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   933     3    1   51    0    3    58    81     4   22    14
1     0  1192    0   30    1    0     2   258     3    0    13
2     6     1  145   28  291   19     7    47   273   66   132
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    2    0  355    0     1     1    17    2  1255
5     1     0    1  197    2  347     0     0     6   37     1
6     0     1    0   11    3    0  2911     3     9    0   129
7     0     0    0   76    0    0     2  1081     0    0     5
8     0     0    0  143    0    0     3    22  1197    1     4
9     3     1  150  201   17  168     5    79   175  319    19
10    0     0    0    0   20    0     0     1     0    0  1625
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7464493, 'precision': 0.67054355, 'recall': 0.63843143, 'specificity': 0.9746423, 'f1': 0.6374873, 'auroc': 0.86552304}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1055     2    7   25    4    2    25     5     4   39     2
1      0  1251    4   32    1    0     3   197     3    0     8
2      5     1  311    4  436   10     2    40   117   34    55
3      0     0    0    0    0    0     0     0     0    0     0
4      0     1    4    0  408    0     1     1     6    1  1211
5      3     0    8   77    5  384     0     0     8  105     2
6      0     0    0    1    2    0  3000     3     3    0    58
7      1     1    0   65    0    1     0  1093     1    0     2
8      0     0    1  115    5    4     9    13  1215    2     6
9      6     3  401   79   24  122     4    84    68  337     9
10     0     0    0    0   29    0     1     1     0    0  1615
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_15_02_seed_1_24051363_instance_wise_predictions.txt
accuracy from prediction file 0.7069894353879521
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2611 MiB |  16815 MiB |    809 TiB |    809 TiB |
|       from large pool |   2597 MiB |  16783 MiB |    803 TiB |    803 TiB |
|       from small pool |     14 MiB |     33 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   2611 MiB |  16815 MiB |    809 TiB |    809 TiB |
|       from large pool |   2597 MiB |  16783 MiB |    803 TiB |    803 TiB |
|       from small pool |     14 MiB |     33 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2607 MiB |  16770 MiB |    806 TiB |    806 TiB |
|       from large pool |   2594 MiB |  16737 MiB |    800 TiB |    800 TiB |
|       from small pool |     13 MiB |     33 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  17562 MiB |  17562 MiB |  32194 MiB |  14632 MiB |
|       from large pool |  17526 MiB |  17526 MiB |  32156 MiB |  14630 MiB |
|       from small pool |     36 MiB |     36 MiB |     38 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 305829 KiB | 719869 KiB | 128704 GiB | 128704 GiB |
|       from large pool | 285440 KiB | 717120 KiB | 122546 GiB | 122546 GiB |
|       from small pool |  20389 KiB |  28880 KiB |   6157 GiB |   6157 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3082    |    4805    |   62559 K  |   62556 K  |
|       from large pool |     349    |     697    |   26798 K  |   26798 K  |
|       from small pool |    2733    |    4255    |   35760 K  |   35757 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3082    |    4805    |   62559 K  |   62556 K  |
|       from large pool |     349    |     697    |   26798 K  |   26798 K  |
|       from small pool |    2733    |    4255    |   35760 K  |   35757 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     511    |     511    |     871    |     360    |
|       from large pool |     493    |     493    |     852    |     359    |
|       from small pool |      18    |      18    |      19    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     168    |    1225    |   33714 K  |   33714 K  |
|       from large pool |     130    |     339    |   17529 K  |   17529 K  |
|       from small pool |      38    |    1094    |   16184 K  |   16184 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  16815 MiB |    809 TiB |    809 TiB |
|       from large pool |  16640 KiB |  16783 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     33 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  16815 MiB |    809 TiB |    809 TiB |
|       from large pool |  16640 KiB |  16783 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     33 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  16770 MiB |    806 TiB |    806 TiB |
|       from large pool |  16640 KiB |  16737 MiB |    800 TiB |    800 TiB |
|       from small pool |      0 KiB |     33 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2910 MiB |  17562 MiB |  32194 MiB |  29284 MiB |
|       from large pool |   2876 MiB |  17526 MiB |  32156 MiB |  29280 MiB |
|       from small pool |     34 MiB |     36 MiB |     38 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 719869 KiB | 128705 GiB | 128705 GiB |
|       from large pool |  24320 KiB | 717120 KiB | 122547 GiB | 122547 GiB |
|       from small pool |      0 KiB |  28880 KiB |   6157 GiB |   6157 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4805    |   62559 K  |   62559 K  |
|       from large pool |       2    |     697    |   26798 K  |   26798 K  |
|       from small pool |       0    |    4255    |   35760 K  |   35760 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4805    |   62559 K  |   62559 K  |
|       from large pool |       2    |     697    |   26798 K  |   26798 K  |
|       from small pool |       0    |    4255    |   35760 K  |   35760 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     150    |     511    |     871    |     721    |
|       from large pool |     133    |     493    |     852    |     719    |
|       from small pool |      17    |      18    |      19    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1225    |   33715 K  |   33715 K  |
|       from large pool |       3    |     339    |   17529 K  |   17529 K  |
|       from small pool |       0    |    1094    |   16185 K  |   16185 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug  4 09:37:07 2024]
Finished job 0.
1 of 1 steps (100%) done
