Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Aug  4 01:49:59 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051367

 Experiment start at: 2024-08-04 02:05:11.301709
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.044287413358688354
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9293397, 'precision': 0.84734595, 'recall': 0.7560665, 'specificity': 0.992137, 'f1': 0.78957176, 'auroc': 0.99120593}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   287     0    0    22    2    1    56     5    12   21     77
1     0  1252    0    34    0    0     1    30     8    0      6
2     1     4  119    11   44    4     0    18    27   77      7
3     0     3    0  8183    0    6     1   133   106    1      2
4     0     0   16     8  233    1     2     6    74   13    186
5     0     0    1    94    0  319     0     0     6  100      1
6     3     0    0    27    1    2  1815     4    13    7     36
7     0    40    1   434    2    0     4  6685    79    1     18
8     0     3    4   251    3    0     4    67  2910    1     51
9     0     2   36    33    0   88     0     3    12  318      1
10    3     4    0     8   38    2    32    22    70    3  12614
---- Validation: 
scalar performance:
{'acc': 0.93064064, 'precision': 0.8499338, 'recall': 0.76361716, 'specificity': 0.9923071, 'f1': 0.7955544, 'auroc': 0.99086225}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   292     0    1    18    1    3    52     5    16   21     74
1     0  1255    0    30    1    0     1    32     6    0      7
2     0     9  128    10   45    4     0    12    26   72      6
3     0     1    0  8197    0    9     1   133    99    0      0
4     0     2   16     7  236    0     2     4    70   15    187
5     0     0    0    79    0  326     1     0     8  106      1
6     3     0    0    20    2    3  1822     4    17    7     30
7     0    38    0   461    2    0     6  6657    89    0     12
8     0     4    3   240    4    0     5    61  2939    2     38
9     2     2   34    32    0   79     0     2    12  325      5
10    2     5    1     8   44    2    35    21    61    2  12615
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65829426, 'precision': 0.65954363, 'recall': 0.55080336, 'specificity': 0.9659008, 'f1': 0.56098026, 'auroc': 0.86759806}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   557     2   0  125    0   17   284   10    47  122     6
1     0  1293   0   68    0    0     9   98     2    3    26
2     1    11  52   41  233    7    15   33   422  146    54
3     0     0   0    0    0    0     0    0     0    0     0
4     0     1   0    0  433    0     1    0    36    1  1161
5     0     0   0  132    2  286     2    0     4  166     0
6     0     0   0   31   31    0  2577    3   117    1   307
7     0     0   0  288    0    0     2  868     1    1     4
8     0     0   0  256    0    1     4    3  1102    3     1
9     1    24  42  195   17   76     4   22   130  621     5
10    0     0   0    0   25    0     1    0     0    0  1620
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 02:50:13.721084,epoch time: 0:45:02.419375,used: 0:45:02.419375,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93985444, 'precision': 0.8607939, 'recall': 0.7994003, 'specificity': 0.99324036, 'f1': 0.81694955, 'auroc': 0.99335307}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   415     0    0     4    0    0     3     3     1    1     56
1     2  1213    0    16    0    0     0    78    16    0      7
2     4     0  154     4   36    0     0     5     6   89     14
3     7     0    0  7955    0   17     5   305   137   10      2
4     3     0   26     1  220    0     1     2     8   17    259
5     1     0    0    30    0  288     0     0     6  194      2
6    42     0    0     2    1    0  1820     1     3    3     36
7     6     5    5   145    1    0     3  7007    59    3     28
8     8     0    2   105   12    4     2    86  2918   20    139
9     6     1   31     7    1   28     0     2     6  407      4
10   16     0    0     7    7    0     7    13     9    4  12731
---- Validation: 
scalar performance:
{'acc': 0.93928045, 'precision': 0.85429543, 'recall': 0.79728556, 'specificity': 0.99317837, 'f1': 0.8134799, 'auroc': 0.993189}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   413     0    0     5    0    0     1     5     0    4     55
1     0  1211    0    16    0    0     0    80    15    0     10
2     6     0  148     3   50    0     0     6     7   81     11
3     8     0    0  7959    0   14     3   310   136    8      2
4     3     0   25     2  215    0     1     3    13   16    261
5     2     0    0    29    0  290     0     0     5  194      1
6    44     0    0     3    1    0  1816     1     1    5     37
7     3     5    2   133    1    0     3  7020    68    5     25
8    15     0    2    88   22    8     1    87  2894   18    161
9     6     0   34     5    0   25     0     1     5  415      2
10   17     0    1     7    8    0     3    15     7    4  12734
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7150353, 'precision': 0.65404654, 'recall': 0.5886399, 'specificity': 0.9712651, 'f1': 0.560695, 'auroc': 0.8680108}
confusion matrix:
      0     1   2   3    4   5     6     7     8    9     10
0   1148     0   0   5    0   0     1     6     0    9     1
1     39  1014   2  26    1   0    23   323     7   21    43
2     68     1  83  15  228   0     7    35   116  186   276
3      0     0   0   0    0   0     0     0     0    0     0
4      3     0   0   0  138   0     2     2     4    0  1484
5     13     0   0  45    0  96     2     0     5  429     2
6      0     0   0   2    3   0  3023     0     0    0    39
7     16     0   0  45    0   0    18  1066     0   10     9
8     11     0   0  76   14   1    23     6  1182   38    19
9     80     3  85  17   11   3     1    20    71  824    22
10     0     0   0   0    0   0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 03:37:20.387859,epoch time: 0:47:06.666775,used: 1:32:09.086150,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9562821, 'precision': 0.8794215, 'recall': 0.84874314, 'specificity': 0.9951958, 'f1': 0.86256665, 'auroc': 0.9967493}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    0     3    0    0     7     3     4    3     33
1     0  1288    0     7    0    0     0    35     1    0      1
2     2     0  194     0   51    2     0    10     4   45      4
3     3     2    0  8123    0    9     0   203    98    0      0
4     3     1   27     4  309    2     1     2    19    2    169
5     0     0    1    34    0  396     0     0    11   78      1
6    24     2    0     6    2    1  1847     2     2    2     20
7     0    15    0   131    1    0     2  7075    33    0      7
8     2     0    7    93    7    0     2    99  3051    1     33
9     3     1   58     5    1   72     0     3     4  346      0
10   19     1    1     9   32    2     9    16    18    1  12684
---- Validation: 
scalar performance:
{'acc': 0.9553832, 'precision': 0.8803212, 'recall': 0.84785503, 'specificity': 0.995083, 'f1': 0.8623899, 'auroc': 0.9964551}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   432     1    1     5    2    1     4     3     3    1     30
1     0  1281    0    12    0    0     0    36     2    0      1
2     1     4  194     1   50    2     0     7     6   43      4
3     2     1    0  8112    0    8     1   213   102    1      0
4     3     2   25     2  306    2     0     4    20    1    174
5     0     0    0    36    0  400     0     0     7   77      1
6    21     0    1     6    1    1  1851     5     5    1     16
7     1    11    2   131    1    0     1  7074    32    1     11
8     4     0    6    93    6    0     2   100  3043    0     42
9     3     0   60    10    1   67     1     2     6  342      1
10   22     1    1     9   29    1    15    10    24    2  12682
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.739243, 'precision': 0.6611413, 'recall': 0.6279173, 'specificity': 0.9737786, 'f1': 0.623366, 'auroc': 0.8757999}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1056     2    0   20    0   17    22     9    10   29     5
1      3  1330    0   17    0    1     3   118     3    2    22
2      5     6  137   19  397   10    27    22   141   63   188
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    0    1  263    0     3     1     4    0  1361
5      4     0    1   70    2  355     3     0    13  142     2
6      0     0    1    8    6    0  2988     1     0    0    63
7      0     1    1  119    0    0     4  1033     2    1     3
8      0     0    0   76    8    1     8     9  1260    3     5
9     21     8  206   65   29   79     7    28   161  506    27
10     0     0    0    0    8    0     0     0     0    0  1638
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-04 04:20:01.145311,epoch time: 0:42:40.757452,used: 2:14:49.843602,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9574861, 'precision': 0.8848007, 'recall': 0.8562481, 'specificity': 0.99536073, 'f1': 0.868901, 'auroc': 0.9968723}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   403     0    0     6    1    1     8     1     9    2     52
1     0  1226    1    10    0    0     0    82     9    0      4
2     0     0  199     1   18    2     1     5     8   77      1
3     2     1    1  8250    0   16     3    84    81    1      0
4     1     0   46     1  329    2     0     4    23    4    129
5     2     0    1    25    0  453     0     0     5   34      1
6    18     0    1     3    1    0  1862     0     8    0     14
7     0     4    3   209    1    1     2  6974    60    1      7
8     0     0    4    96   12    2     0    65  3095    1     20
9     0     0   26     7    1  106     1     0     5  347      0
10    2     0    4     8   68    1     8    16    36    1  12649
---- Validation: 
scalar performance:
{'acc': 0.95816505, 'precision': 0.8824808, 'recall': 0.85499007, 'specificity': 0.9954565, 'f1': 0.8669857, 'auroc': 0.99689573}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   403     0    1     8    0    0     9     2     8    3     49
1     0  1237    0     7    0    0     0    79     6    1      2
2     0     0  201     1   19    4     0     5     5   76      1
3     2     1    0  8250    0   10     3    77    96    1      0
4     0     0   48     3  333    2     0     5    22    3    123
5     0     0    1    21    0  455     0     0     5   38      1
6    23     0    1     4    1    0  1856     1     8    2     12
7     0     1    3   198    1    0     1  7001    54    1      5
8     0     0    4    94   10    4     0    63  3098    1     22
9     0     0   29     5    0  121     1     1     9  327      0
10    4     0    2    10   64    1    10    11    33    1  12660
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7582033, 'precision': 0.6935515, 'recall': 0.6481268, 'specificity': 0.97583365, 'f1': 0.6561469, 'auroc': 0.8824399}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1053     0    1    4    1    4    18    2    35   33    19
1      1  1024   29   19    3    3    12  318    21   21    48
2      6     0  309    1  286    9     9    7   196   95    97
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    6    0  661    0     2    1    10    0   953
5      3     0    0   13    3  384     7    0    11  168     3
6      0     0    1    0    3    1  3038    0     2    0    22
7      0     0   21  312    0    0     7  809     8    4     3
8      0     0    0   44    3    6     8    3  1301    4     1
9     12     0  189   11    7  106     6    6   120  667    13
10     0     0    0    0   54    0     1    0     0    0  1591
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-04 04:59:12.388102,epoch time: 0:39:11.242791,used: 2:54:01.086393,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95745933, 'precision': 0.8982857, 'recall': 0.8404697, 'specificity': 0.9951563, 'f1': 0.86351335, 'auroc': 0.9967275}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   449     0    0     5    0    0     4     2     0    1     22
1     0  1270    0    11    0    0     1    45     2    0      2
2     6     0  201     5   33    1     1    13     5   36     11
3     0     0    0  8233    0    4     0   130    70    0      2
4     6     0   19     1  264    0     4     5    18    1    221
5     6     0    1    63    0  383     0     0     7   60      1
6    13     0    1     2    1    0  1870     1     1    0     18
7     0     8    0   157    1    0     1  7054    27    0     15
8     2     1    1    87    1    0     0    91  3016    0     97
9    14     1   50    24    1   64     4     3     6  323      3
10   30     0    0     9    6    2     7     5     9    1  12723
---- Validation: 
scalar performance:
{'acc': 0.9582185, 'precision': 0.9033489, 'recall': 0.841822, 'specificity': 0.995227, 'f1': 0.86711174, 'auroc': 0.9968335}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    0     7    0    0     4     1     1    0     25
1     0  1270    0    10    0    0     0    47     1    0      4
2     4     0  189     0   34    1     4    24     7   34     15
3     0     0    0  8235    0    4     2   127    71    1      0
4     6     0   14     1  273    0     4     5    13    3    220
5     5     0    0    63    0  393     2     0    10   47      1
6    16     0    1     7    0    0  1859     1     4    0     20
7     0     5    0   155    1    0     2  7066    18    0     18
8     1     0    3    91    4    0     0    91  3024    1     81
9     9     0   45    18    1   66     3     3     5  337      6
10   24     0    1     8    7    2     8     6     8    0  12732
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7128664, 'precision': 0.63999987, 'recall': 0.596506, 'specificity': 0.9709841, 'f1': 0.57466024, 'auroc': 0.87109345}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1115     0    0    4    0    0    32    12     2    2     3
1      2  1207    0   24    0    0     8   217     4    1    36
2     31     0   68   13  156    9    69    73   270   45   281
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    0    0  146    0    11     1     6    0  1467
5     27     0    0  106    0  308    16     0    12  115     8
6      0     0    0    5    0    0  3045     1     0    0    16
7      1     0    0   34    0    1     1  1121     1    0     5
8      1     0    0  131    0    1    18    14  1201    1     3
9     84     3  100  117    5   81    89    84   199  340    35
10     0     0    0    0    2    0     6     0     0    0  1638
better model found
persisted
after epoch: 5,now: 2024-08-04 05:37:06.216203,epoch time: 0:37:53.828101,used: 3:31:54.914494,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96155286, 'precision': 0.8972281, 'recall': 0.8632807, 'specificity': 0.99572915, 'f1': 0.87613344, 'auroc': 0.99778646}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    1     5    0    1     1     3     1    2     19
1     0  1289    0     7    0    0     0    32     3    0      0
2     2     0  217     3   17    2     0    11     3   53      4
3     0     1    1  8242    0    4     0   146    43    0      1
4     5     1   53     3  288    1     0    11    10    3    164
5     0     0    3    40    0  422     0     0     5   49      2
6    29     2    3     4    4    1  1838     3     6    1     17
7     0    11    0   107    2    0     1  7133     6    0      4
8     2     0    4    99    4    1     0   153  2994    0     38
9     2     0   37     7    0   78     0     5     2  361      1
10   29     7    0     8   13    1     2    15    12    0  12705
---- Validation: 
scalar performance:
{'acc': 0.96158886, 'precision': 0.90125936, 'recall': 0.8678872, 'specificity': 0.99571526, 'f1': 0.8807209, 'auroc': 0.9977195}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     2    0    2     1     1     1    2     17
1     0  1281    0     9    0    0     0    40     2    0      0
2     3     0  224     2   17    1     0    14     3   47      1
3     0     1    0  8239    0    7     0   140    53    0      0
4     5     0   51     2  293    1     0    10     9    3    165
5     1     0    0    31    0  432     0     1     6   49      1
6    27     3    2     6    8    1  1828     3     2    1     27
7     0    12    0   109    1    0     1  7125    10    0      7
8     1     2    4   102    4    0     1   152  2989    1     40
9     1     0   40    14    1   64     0     7     2  361      3
10   27     2    2     7   12    1     3    15     7    0  12720
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72594976, 'precision': 0.6607037, 'recall': 0.6097925, 'specificity': 0.9726499, 'f1': 0.59472024, 'auroc': 0.87128764}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1114     0    0   15    1    1     8    22     0    4     5
1      0  1267    0   29    0    0     1   188     1    2    11
2     13     0  128   26  177   23     9   107   252   62   218
3      0     0    0    0    0    0     0     0     0    0     0
4      3     2    1    0  178    0     2     2    12    0  1433
5     11     0    1  154    1  299     1     0    12  111     2
6      0     0    0   17    0    0  3038     2     2    0     8
7      1     0    0   41    0    0     0  1118     0    1     3
8      1     0    0  129    1    0     2    39  1194    2     2
9     33     6  105  137    7   91     4   172   160  398    24
10     0     0    0    0    3    0     0     0     1    0  1642
better model found
persisted
after epoch: 6,now: 2024-08-04 06:15:14.787135,epoch time: 0:38:08.570932,used: 4:10:03.485426,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9655394, 'precision': 0.90081495, 'recall': 0.89039737, 'specificity': 0.9962556, 'f1': 0.89514256, 'auroc': 0.9981303}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   449     0    0     3    1    0    10     2     1    0     17
1     0  1302    1     4    0    0     0    23     1    0      0
2     0     0  208     2   48    2     2     6     0   40      4
3     0     8    0  8248    0   18     1   106    58    0      0
4     2     0   16     1  406    2     1     2    10    2     97
5     0     0    1     6    0  457     2     0     7   46      1
6    16     2    1     2    0    0  1874     3     1    1      8
7     0    23    5   165    2    0     3  7033    22    0      9
8     1     0    3    69   24    1     4    68  3065    1     59
9     0     0   44     0    1   77     1     2     4  364      0
10   14     2    0     6   42    2    20    14    12    0  12682
---- Validation: 
scalar performance:
{'acc': 0.96536046, 'precision': 0.90029764, 'recall': 0.89215225, 'specificity': 0.9962597, 'f1': 0.8957818, 'auroc': 0.99824953}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    0     2    2    0    13     1     1    2     17
1     0  1309    0     1    0    0     0    18     4    0      0
2     0     0  212     0   49    1     2     6     3   38      1
3     0     8    1  8238    1   17     2   111    61    1      0
4     4     2   13     0  411    1     6     5     5    3     89
5     1     0    2    10    0  456     0     0     6   45      1
6    19     1    1     1    1    1  1873     1     1    1      8
7     0    25    1   165    2    0     2  7036    24    0     10
8     1     1    3    68   30    1    10    65  3061    0     56
9     0     0   43     3    2   72     0     0     5  368      0
10   12     1    0     7   47    2    31     7     8    0  12681
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74512, 'precision': 0.65834725, 'recall': 0.632037, 'specificity': 0.9738171, 'f1': 0.6246525, 'auroc': 0.87690943}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1075     1    0   3    1    6    43    31     0    9     1
1      5  1263    2  14    0    1    13   183     3    8     7
2      3     0  133   4  319   14   187    40   156   62    97
3      0     0    0   0    0    0     0     0     0    0     0
4      3     0    0   0  353    0   134     1     7    0  1135
5      6     0    1  50    0  354    13     0     5  161     2
6      0     0    0   1    0    0  3066     0     0    0     0
7      2     0    0  24    0    0     2  1131     1    1     3
8      0     0    0  88    4    2    61    17  1192    4     2
9     12     3  215  30   15  102    63    44   124  511    18
10     0     0    0   0   13    0    61     0     0    0  1572
better model found
persisted
after epoch: 7,now: 2024-08-04 06:53:36.618961,epoch time: 0:38:21.831826,used: 4:48:25.317252,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9701413, 'precision': 0.91528046, 'recall': 0.8964132, 'specificity': 0.99676347, 'f1': 0.9044893, 'auroc': 0.9985992}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     0    1    0     2     0     2    1     17
1     0  1301    0     2    0    0     0    23     5    0      1
2     2     0  216     1   37    2     0     0     4   48      2
3     1     2    0  8172    0   23     2   135   100    3      1
4     5     0   18     1  363    1     0     2    18    0    131
5     1     0    0    11    1  462     0     0     4   41      1
6     6     0    1     1    1    0  1882     1     4    0     12
7     0    17    5    69    1    0     1  7128    33    3      5
8     2     2    2    35   11    5     0    51  3167    1     19
9     0     0   21     3    2   73     0     1     3  388      2
10    9     0    1     6   22    1     2     6    24    0  12721
---- Validation: 
scalar performance:
{'acc': 0.9708439, 'precision': 0.9177513, 'recall': 0.89530134, 'specificity': 0.99682236, 'f1': 0.9049767, 'auroc': 0.99853534}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    0     3    1    0     5     0     2    2     25
1     0  1304    0     3    0    0     0    22     3    0      0
2     0     0  226     1   26    1     0     2     2   51      3
3     0     4    1  8181    0   17     0   146    91    0      0
4     5     0   17     0  360    1     1     2    13    0    140
5     0     0    0    13    0  458     0     0     2   47      1
6     8     0    1     2    1    0  1881     0     4    0     11
7     0    18    5    66    1    0     2  7136    28    1      8
8     0     1    4    25    7    2     0    45  3197    2     13
9     1     0   24     3    1   77     0     0     4  382      1
10   13     0    1     6   17    2     6     6    20    0  12725
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75932276, 'precision': 0.6793003, 'recall': 0.6526089, 'specificity': 0.9757494, 'f1': 0.6390909, 'auroc': 0.87347126}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1109     0    1   9    0    1    14    17     7    9     3
1      1  1280    2  13    0    1     5   139     8   15    35
2     26     0  189   5  261   11    19     7   241   82   174
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    1   0  212    0    11     0    11    0  1396
5     11     0    0  57    0  399     3     0    11  106     5
6      0     0    0   3    1    0  3059     0     1    0     3
7      0     0    0  68    0    1     5  1074     8    1     7
8      0     0    0  67    0    3     4     3  1288    4     1
9     33     1  140  30   11  146     8    16   128  603    21
10     0     0    0   0    3    0     2     0     1    0  1640
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-04 07:31:45.390406,epoch time: 0:38:08.771445,used: 5:26:34.088697,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9697667, 'precision': 0.92239904, 'recall': 0.8942859, 'specificity': 0.99669623, 'f1': 0.9073014, 'auroc': 0.9985561}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    1     1    2    0     8     1     5    0     34
1     0  1318    0     1    0    0     0     8     4    0      0
2     0     0  231     1   40    1     0     2     4   31      1
3     1     6    1  8153    0    4     2   179    90    1      3
4     2     0   14     1  378    0     0     6    18    0    120
5     4     0    1    24    0  421     0     0     4   65      2
6     2     0    0     0    2    0  1887     1     3    1     11
7     0    26    1    53    1    0     3  7154    22    0      3
8     0     0    4    36    5    1     0    74  3158    0     16
9     1     0   36     3    1   42     1     4     6  399      0
10    4     0    1     5   21    0    12    13    22    0  12716
---- Validation: 
scalar performance:
{'acc': 0.97041595, 'precision': 0.9246109, 'recall': 0.89534366, 'specificity': 0.99676985, 'f1': 0.90902007, 'auroc': 0.99861825}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   423     0    0     1    2    0    12     3     4    1     37
1     0  1319    0     2    1    0     0     7     2    0      1
2     0     0  226     1   39    2     0     2     8   33      1
3     0     8    0  8160    0    2     3   177    90    0      0
4     2     0   14     1  393    2     0     3    13    0    111
5     1     0    0    24    0  432     0     0     4   59      1
6     5     0    1     0    3    0  1882     2     3    1     11
7     0    22    1    57    1    0     2  7153    23    0      6
8     0     0    2    27    9    0     3    67  3174    0     14
9     1     0   40     6    0   37     0     7     4  397      1
10    2     0    0     6   19    0    15    11    23    0  12720
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74225146, 'precision': 0.6712582, 'recall': 0.6252055, 'specificity': 0.9741159, 'f1': 0.61953324, 'auroc': 0.8613542}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1028     0    1   10    1    0    39    56    11   12    12
1      0  1330    3   12    1    0     3   128     4    2    16
2      2     0  210   12  267    4    21    29   280   63   127
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    5    0  254    0     5     0    13    0  1356
5      8     0    1  158    0  285     4     0    14  111    11
6      0     0    0    4    3    0  3024     2    11    0    23
7      0     1    1   27    0    0     2  1127     2    1     3
8      0     0    0   86    1    0     5    18  1256    3     1
9      9     2  197  102    9   95    13    52   185  455    18
10     0     0    0    0    5    0     1     0     0    0  1640
early stop counter: 1
val acc:0.9704159498214722, best validation acc: 0.9708439111709595, corresponding to test acc:                         0.7593227624893188 / 0.7593227624893188
after epoch: 9,now: 2024-08-04 08:08:54.440456,epoch time: 0:37:09.050050,used: 6:03:43.138747,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97289705, 'precision': 0.92644477, 'recall': 0.904855, 'specificity': 0.99705297, 'f1': 0.91218245, 'auroc': 0.9988473}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     1    1    0     6     0     1    1      2
1     0  1315    1     4    0    0     0     9     3    0      0
2     0     0  230     1   26    0     0     1     3   49      2
3     0     3    1  8316    0   24     1    30    57    2      1
4     4     0   18     1  339    0     6     2    25    5    139
5     0     0    0     4    0  422     0     0     4   90      1
6     9     0    1     2    0    0  1882     1     4    0      9
7     1    19    1   167    1    0     3  7003    62    1      5
8     2     0    1    52    2    2     0    14  3206    3     14
9     0     0   17     3    1   20     1     0     2  449      0
10   17     0    1     8   10    1     1     2    22    2  12730
---- Validation: 
scalar performance:
{'acc': 0.97383976, 'precision': 0.93267727, 'recall': 0.9083468, 'specificity': 0.99713206, 'f1': 0.91679806, 'auroc': 0.99887824}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     0    0    0     3     0     1    3      8
1     0  1318    0     6    0    0     0     6     2    0      0
2     2     0  227     1   21    0     0     6     3   49      3
3     1     3    1  8322    0   19     0    34    56    4      0
4     4     0   14     1  351    0     1     2    17    3    146
5     0     0    0     5    0  429     0     0     3   83      1
6     7     0    0     1    0    0  1884     2     4    1      9
7     0    20    0   162    1    0     2  7007    65    3      5
8     1     0    1    46    1    1     0    16  3215    2     13
9     0     0   19     0    0   18     1     0     0  455      0
10   20     0    1     7    7    1     7     3    18    1  12731
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7382635, 'precision': 0.6903184, 'recall': 0.619475, 'specificity': 0.97357696, 'f1': 0.6137023, 'auroc': 0.86373013}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   999     0    0   29    2    0    78    36     4   19     3
1     0  1334    0   25    1    0    18   105     6    0    10
2     8     1  148   26  161    6   123    30   317   96    99
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    2    0  186    0    39     1    17    1  1387
5    12     0    0   88    0  268     4     0     4  213     3
6     0     0    0    4    0    0  3061     0     1    0     1
7     0     0    0   55    0    0     2  1101     3    1     2
8     0     0    0  143    0    0     2    12  1210    2     1
9    19     8   74  162    3   45    19    63   117  614    13
10    0     0    0    0    4    0    10     0     1    0  1631
better model found
persisted
after epoch: 10,now: 2024-08-04 08:46:57.449589,epoch time: 0:38:03.009133,used: 6:41:46.147880,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 6:41:46.147880 at 2024-08-04 08:46:57.449589
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7382635, 'precision': 0.6903184, 'recall': 0.619475, 'specificity': 0.97357696, 'f1': 0.6137023, 'auroc': 0.86373013}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   999     0    0   29    2    0    78    36     4   19     3
1     0  1334    0   25    1    0    18   105     6    0    10
2     8     1  148   26  161    6   123    30   317   96    99
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    2    0  186    0    39     1    17    1  1387
5    12     0    0   88    0  268     4     0     4  213     3
6     0     0    0    4    0    0  3061     0     1    0     1
7     0     0    0   55    0    0     2  1101     3    1     2
8     0     0    0  143    0    0     2    12  1210    2     1
9    19     8   74  162    3   45    19    63   117  614    13
10    0     0    0    0    4    0    10     0     1    0  1631
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75932276, 'precision': 0.6793003, 'recall': 0.6526089, 'specificity': 0.9757494, 'f1': 0.6390909, 'auroc': 0.87347126}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1109     0    1   9    0    1    14    17     7    9     3
1      1  1280    2  13    0    1     5   139     8   15    35
2     26     0  189   5  261   11    19     7   241   82   174
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    1   0  212    0    11     0    11    0  1396
5     11     0    0  57    0  399     3     0    11  106     5
6      0     0    0   3    1    0  3059     0     1    0     3
7      0     0    0  68    0    1     5  1074     8    1     7
8      0     0    0  67    0    3     4     3  1288    4     1
9     33     1  140  30   11  146     8    16   128  603    21
10     0     0    0   0    3    0     2     0     1    0  1640
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_02_05_10_seed_0_24051367_instance_wise_predictions.txt
accuracy from prediction file 0.7382634856223326
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/1.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4045 MiB |  18021 MiB | 779094 GiB | 779090 GiB |
|       from large pool |   4021 MiB |  17987 MiB | 775091 GiB | 775087 GiB |
|       from small pool |     24 MiB |     35 MiB |   4003 GiB |   4003 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   4045 MiB |  18021 MiB | 779094 GiB | 779090 GiB |
|       from large pool |   4021 MiB |  17987 MiB | 775091 GiB | 775087 GiB |
|       from small pool |     24 MiB |     35 MiB |   4003 GiB |   4003 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4037 MiB |  17985 MiB | 777593 GiB | 777589 GiB |
|       from large pool |   4013 MiB |  17952 MiB | 773594 GiB | 773590 GiB |
|       from small pool |     23 MiB |     35 MiB |   3999 GiB |   3999 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  19670 MiB |  19670 MiB |  19670 MiB |      0 B   |
|       from large pool |  19632 MiB |  19632 MiB |  19632 MiB |      0 B   |
|       from small pool |     38 MiB |     38 MiB |     38 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 684663 KiB |   2223 MiB | 357527 GiB | 357527 GiB |
|       from large pool | 672384 KiB |   2216 MiB | 353479 GiB | 353478 GiB |
|       from small pool |  12279 KiB |     18 MiB |   4048 GiB |   4048 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4612    |    5882    |   47217 K  |   47212 K  |
|       from large pool |     502    |     727    |   20668 K  |   20667 K  |
|       from small pool |    4110    |    5277    |   26549 K  |   26545 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4612    |    5882    |   47217 K  |   47212 K  |
|       from large pool |     502    |     727    |   20668 K  |   20667 K  |
|       from small pool |    4110    |    5277    |   26549 K  |   26545 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     414    |     414    |     414    |       0    |
|       from large pool |     395    |     395    |     395    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     224    |    1220    |   23477 K  |   23477 K  |
|       from large pool |     181    |     283    |   12318 K  |   12318 K  |
|       from small pool |      43    |    1039    |   11159 K  |   11159 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  18021 MiB | 779094 GiB | 779094 GiB |
|       from large pool |  16640 KiB |  17987 MiB | 775091 GiB | 775091 GiB |
|       from small pool |      0 KiB |     35 MiB |   4003 GiB |   4003 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  18021 MiB | 779094 GiB | 779094 GiB |
|       from large pool |  16640 KiB |  17987 MiB | 775091 GiB | 775091 GiB |
|       from small pool |      0 KiB |     35 MiB |   4003 GiB |   4003 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  17985 MiB | 777593 GiB | 777593 GiB |
|       from large pool |  16640 KiB |  17952 MiB | 773594 GiB | 773594 GiB |
|       from small pool |      0 KiB |     35 MiB |   3999 GiB |   3999 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4714 MiB |  19670 MiB |  19670 MiB |  14956 MiB |
|       from large pool |   4678 MiB |  19632 MiB |  19632 MiB |  14954 MiB |
|       from small pool |     36 MiB |     38 MiB |     38 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2223 MiB | 357530 GiB | 357530 GiB |
|       from large pool |  24320 KiB |   2216 MiB | 353481 GiB | 353481 GiB |
|       from small pool |      0 KiB |     29 MiB |   4048 GiB |   4048 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5882    |   47217 K  |   47217 K  |
|       from large pool |       2    |     727    |   20668 K  |   20668 K  |
|       from small pool |       0    |    5277    |   26549 K  |   26549 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5882    |   47217 K  |   47217 K  |
|       from large pool |       2    |     727    |   20668 K  |   20668 K  |
|       from small pool |       0    |    5277    |   26549 K  |   26549 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     202    |     414    |     414    |     212    |
|       from large pool |     184    |     395    |     395    |     211    |
|       from small pool |      18    |      19    |      19    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1220    |   23479 K  |   23479 K  |
|       from large pool |       3    |     283    |   12318 K  |   12318 K  |
|       from small pool |       0    |    1039    |   11160 K  |   11160 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  18021 MiB | 779094 GiB | 779094 GiB |
|       from large pool |  16640 KiB |  17987 MiB | 775091 GiB | 775091 GiB |
|       from small pool |      0 KiB |     35 MiB |   4003 GiB |   4003 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  18021 MiB | 779094 GiB | 779094 GiB |
|       from large pool |  16640 KiB |  17987 MiB | 775091 GiB | 775091 GiB |
|       from small pool |      0 KiB |     35 MiB |   4003 GiB |   4003 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  17985 MiB | 777593 GiB | 777593 GiB |
|       from large pool |  16640 KiB |  17952 MiB | 773594 GiB | 773594 GiB |
|       from small pool |      0 KiB |     35 MiB |   3999 GiB |   3999 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4714 MiB |  19670 MiB |  19670 MiB |  14956 MiB |
|       from large pool |   4678 MiB |  19632 MiB |  19632 MiB |  14954 MiB |
|       from small pool |     36 MiB |     38 MiB |     38 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2223 MiB | 357530 GiB | 357530 GiB |
|       from large pool |  24320 KiB |   2216 MiB | 353481 GiB | 353481 GiB |
|       from small pool |      0 KiB |     29 MiB |   4048 GiB |   4048 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5882    |   47217 K  |   47217 K  |
|       from large pool |       2    |     727    |   20668 K  |   20668 K  |
|       from small pool |       0    |    5277    |   26549 K  |   26549 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5882    |   47217 K  |   47217 K  |
|       from large pool |       2    |     727    |   20668 K  |   20668 K  |
|       from small pool |       0    |    5277    |   26549 K  |   26549 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     202    |     414    |     414    |     212    |
|       from large pool |     184    |     395    |     395    |     211    |
|       from small pool |      18    |      19    |      19    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1220    |   23479 K  |   23479 K  |
|       from large pool |       3    |     283    |   12318 K  |   12318 K  |
|       from small pool |       0    |    1039    |   11160 K  |   11160 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_00_03_seed_1_24051367

 Experiment start at: 2024-08-04 09:00:04.358002
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
before training, model accuracy: 0.06940460950136185
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92412245, 'precision': 0.82914466, 'recall': 0.7655504, 'specificity': 0.99156153, 'f1': 0.78537154, 'auroc': 0.99197704}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   316     0    6    21    0    0    41     6     8    4     81
1     0  1262    0    23    0    0     0    43     0    0      3
2     3     4  222     5   16    3     2    15    13   27      2
3     1     1    1  8204    0    5     0   174    53    0      0
4     1     2   98     4  204    2     2    10    50   14    152
5     0     0    8   109    0  332     1     0     7   62      2
6    14     2    0    14    0    0  1845     8     6    4     15
7     1    26    2   485    2    1     2  6695    36    0     12
8     1     3    7   465    2    0     9    88  2675    1     45
9     3     1  123    29    1  109     1     3     6  215      2
10    9     3   10    12   56    1    28    40    61    2  12570
---- Validation: 
scalar performance:
{'acc': 0.9231777, 'precision': 0.82549816, 'recall': 0.76285166, 'specificity': 0.99146396, 'f1': 0.78305984, 'auroc': 0.99155897}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   325     0    4    15    1    0    40     9     8    5     76
1     0  1252    0    22    0    0     0    54     1    0      3
2     0     4  214     9   19    3     2    14    13   32      2
3     0     0    0  8203    0    8     1   179    49    0      0
4     1     3   95     6  201    1     2     7    54   11    158
5     1     0    9   104    0  336     1     0     6   63      1
6    14     2    2    14    0    0  1844     9     4    5     14
7     2    28    2   499    3    1     2  6685    33    0     10
8     3     7    5   465    3    0     5    83  2677    0     48
9     1     0  121    26    2  114     3     5    11  208      2
10    6     3    8    10   55    1    36    39    67    3  12568
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7159449, 'precision': 0.6603035, 'recall': 0.5870983, 'specificity': 0.97122324, 'f1': 0.5881438, 'auroc': 0.8709485}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   802     1    0   33    0    0   284    12     2   26    10
1     0  1308    0   31    0    0     4   138     2    0    16
2    13    17  174   12  159    3    70    47   372   57    91
3     0     0    0    0    0    0     0     0     0    0     0
4     0     2    3    0  423    0    29     3    22    0  1151
5    12     0    0  134    0  216    14     0    20  195     1
6     0     2    1    8    0    0  3042     6     3    0     5
7     0     0    0   21    0    0     0  1139     1    0     3
8     0     0    0  154    0    0     8     6  1200    1     1
9    22    39  198  165   18   47    46    57   216  318    11
10    0     0    0    0   32    0     3     0     0    0  1611
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 09:39:30.581099,epoch time: 0:39:26.223097,used: 0:39:26.223097,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_00_03_seed_1_24051367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.947881, 'precision': 0.87490034, 'recall': 0.81675017, 'specificity': 0.9941934, 'f1': 0.83923674, 'auroc': 0.9948169}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   413     0    0     7    0    0     8    10     4    4     37
1     0  1256    0    18    0    0     0    54     0    0      4
2     5     0  152     2   56    0     3    14     9   65      6
3     2     0    0  8173    0    9     1   188    60    2      0
4     7     0   19     1  250    1     0     8    26   16    211
5     2     0    2    53    0  355     0     0     2  106      1
6    15     0    0     9    1    0  1854     4     5    3     17
7     0     6    0   195    1    0     2  6996    55    1      7
8     2     1    3   219    3    1     5    99  2930    5     28
9     4     0   39     5    1   46     4     3     7  380      4
10   20     0    0     8   18    1    19    18    41    0  12669
---- Validation: 
scalar performance:
{'acc': 0.9468236, 'precision': 0.8698256, 'recall': 0.8122192, 'specificity': 0.99408436, 'f1': 0.8337991, 'auroc': 0.9949746}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   406     0    0     7    1    0    15    10     6    4     34
1     0  1257    0    12    0    0     2    59     0    0      2
2     4     0  136     0   59    1     3    19     5   78      7
3     0     0    0  8168    0    6     4   191    69    2      0
4     7     0   16     0  252    0     0     3    28   20    213
5     1     0    1    41    0  367     1     0     3  106      1
6    15     2    0     9    0    0  1854     3     5    1     19
7     2     7    1   197    1    0     1  6992    48    1     15
8     6     1    4   222    3    1     6    91  2919    4     39
9     6     0   38     6    2   48     3     4     8  377      1
10   26     0    0     7   16    0    13    20    42    3  12669
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70377105, 'precision': 0.63548696, 'recall': 0.58392966, 'specificity': 0.97038174, 'f1': 0.5768468, 'auroc': 0.86865896}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1020     2    0   37    1    0    86    13     3    2     6
1      0  1279    0   30    0    0     0   176     1    0    13
2     87     2   69   25  252    3    22    65   206   76   208
3      0     0    0    0    0    0     0     0     0    0     0
4      3     0    0    0  161    0     6     1    10    0  1452
5     21     0    0  126    0  257     5     1     3  177     2
6      0     1    0   33    1    0  3007     3     7    0    15
7      0     0    0  107    0    0     1  1053     0    0     3
8      0     1    0  232    0    0     8    10  1110    2     7
9     74    11  151  154   12   36    25    85    97  458    34
10     0     0    0    0    1    0     0     0     0    0  1645
better model found
persisted
after epoch: 2,now: 2024-08-04 10:18:14.323088,epoch time: 0:38:43.741989,used: 1:18:09.965086,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_00_03_seed_1_24051367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94980735, 'precision': 0.8725077, 'recall': 0.8472955, 'specificity': 0.9946456, 'f1': 0.8576554, 'auroc': 0.9963086}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   423     0    0    10    1    0     6     3    13    2     25
1     0  1261    0    10    0    0     0    53     8    0      0
2     2     0  179     2   48    1     1     5    14   58      2
3     1     0    0  8206    0    7     1   126    97    0      0
4     6     1   17     0  327    1     1     3    56   17    110
5     1     0    1    28    0  378     1     0     6  105      1
6    11     0    0     6    0    0  1870     3     8    2      7
7     0    10    0   236    1    0     2  6905   103    2      5
8     1     0    3   126    3    0     0    37  3116    0      9
9     2     0   43     6    3   51     0     4     5  379      0
10   22     4    1     7   88    0    30    25   156    3  12456
---- Validation: 
scalar performance:
{'acc': 0.9505149, 'precision': 0.87208575, 'recall': 0.85051, 'specificity': 0.99472666, 'f1': 0.8593869, 'auroc': 0.99640465}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0     7    0    0     4     3    11    3     24
1     0  1267    0     9    0    0     1    47     8    0      0
2     5     0  177     1   45    0     1     5    15   63      0
3     1     0    1  8213    0   10     1   126    88    0      0
4     4     1   22     0  332    2     1     4    55   13    105
5     2     0    0    26    0  386     0     0     6  100      1
6    12     0    0     3    0    1  1866     5     8    1     12
7     2    13    1   212    1    1     2  6925   101    3      4
8     1     0    4   150    4    3     3    46  3077    1      7
9     2     0   42     6    1   46     2     2    10  382      0
10   19     3    1     8   86    0    33    24   142    1  12479
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7074092, 'precision': 0.6778631, 'recall': 0.5822401, 'specificity': 0.97080255, 'f1': 0.5731069, 'auroc': 0.8611494}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   886     0   0   66    1    0   101    59    47    7     3
1     0  1278   0   33    0    0     2   171    11    0     4
2    11     1  64   27   97    8    23    40   666   31    47
3     0     0   0    0    0    0     0     0     0    0     0
4     3     3   3    0  473    0    49     4    89    0  1009
5     2     0   1  233    0  284     4     0    30   38     0
6     0     0   0   32    0    0  3015     3    17    0     0
7     0     0   0   48    0    0     1  1109     5    0     1
8     0     0   0  138    0    0     2     0  1230    0     0
9    11     7  47  197   11  121     7    65   475  192     4
10    0     2   0    0   38    0    23     2     1    0  1580
better model found
persisted
after epoch: 3,now: 2024-08-04 10:55:53.962194,epoch time: 0:37:39.639106,used: 1:55:49.604192,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_00_03_seed_1_24051367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9549176, 'precision': 0.87306917, 'recall': 0.8392547, 'specificity': 0.99506366, 'f1': 0.8519985, 'auroc': 0.9967109}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    0     6    1    0     0     5     1    2     31
1     0  1281    0     9    0    0     0    36     4    0      1
2     3     0  139     1  122    1     0     8     1   36      1
3     0     0    0  8110    0    1     0   273    51    2      0
4     4     0    5     2  385    2     0     3    13    7    118
5     0     0    1    41    2  338     0     0     4  133      2
6    40     0    1     8    3    1  1813     4     2    4     30
7     1    15    1    92    2    0     1  7102    29    0     21
8     3     0    3   126   12    3     0    99  3006    0     43
9     2     0   60     7    8   31     0     7     2  375      1
10    6     0    1     7   43    1     1    15    15    1  12705
---- Validation: 
scalar performance:
{'acc': 0.9534038, 'precision': 0.870547, 'recall': 0.8341362, 'specificity': 0.9948899, 'f1': 0.84781665, 'auroc': 0.99666977}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    0    11    1    0     0     4     0    2     31
1     0  1276    0     9    0    0     0    42     4    0      1
2     2     0  134     1  129    1     0     8     1   36      0
3     0     0    1  8108    0    5     0   268    57    1      0
4     6     0    4     1  372    2     0     2    11    5    136
5     0     0    0    39    1  339     0     0     5  136      1
6    42     0    1     7    1    1  1814     4     9    2     27
7     1    16    2    93    4    0     1  7107    21    1     19
8     1     0    2   133    9    1     0   105  2995    0     50
9     1     0   59    11   14   27     0     4     3  374      0
10    8     1    0     8   47    1     1    15    25    0  12690
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6717274, 'precision': 0.62811756, 'recall': 0.55525154, 'specificity': 0.96750736, 'f1': 0.5483129, 'auroc': 0.85065794}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   941     1    0  100    1    0     7    76    27    9     8
1     0  1294    0   27    1    0     0   159     3    0    15
2    25     0   31   51  344    6     2    57   280   39   180
3     0     0    0    0    0    0     0     0     0    0     0
4     2     0    0    0  386    0     1     0    12    0  1232
5     0     0    1  333    0  158     0     0    21   78     1
6     3     0    0  143    6    0  2563     7    81    0   264
7     0     0    0   26    0    0     0  1136     0    0     2
8     0     0    0  133    1    0     1    23  1212    0     0
9    13     2  121  283   51   44     1   144   202  250    26
10    0     0    0    0   16    0     0     0     0    0  1630
better model found
persisted
after epoch: 4,now: 2024-08-04 11:34:15.946559,epoch time: 0:38:21.984365,used: 2:34:11.588557,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_00_03_seed_1_24051367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9551852, 'precision': 0.874196, 'recall': 0.8678926, 'specificity': 0.99520737, 'f1': 0.86654884, 'auroc': 0.99750835}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   401     1    2     4    2    0    21     3     2    2     45
1     0  1300    1     5    0    0     0    21     4    0      1
2     0     0  259     0   28    0     1     1     3   20      0
3     0     6    1  8199    1    9     0   122    98    2      1
4     3     0   34     0  395    0     0     3    16    2     86
5     1     0    2    13    0  342     1     0     6  155      1
6     4     0    1     1    1    0  1884     2     2    0     13
7     1    47    6   296    2    0     1  6860    40    2      8
8     0     0    6    76    9    2     0    62  3112    2     24
9     1     0  126     2    2   18     0     1     4  338      0
10    2     0    1     5  122    0    16    12    23    2  12611
---- Validation: 
scalar performance:
{'acc': 0.9546877, 'precision': 0.87574375, 'recall': 0.86915475, 'specificity': 0.995141, 'f1': 0.8680835, 'auroc': 0.997414}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   394     0    1     5    2    0    22     7     4    3     45
1     0  1299    0     5    1    0     0    20     5    0      2
2     0     0  263     0   28    0     1     1     3   16      0
3     0     3    0  8178    0   12     1   136   107    3      0
4     3     0   34     1  401    0     1     1    12    3     83
5     0     0    3    11    0  347     0     0     3  156      1
6     4     0    1     4    2    0  1879     1     3    0     14
7     0    41    3   290    2    0     1  6875    41    1     11
8     0     4    5    87   10    0     0    56  3103    1     30
9     0     0  123     3    4   19     0     1     3  340      0
10    4     0    2     6  119    0    10    10    30    3  12612
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.747079, 'precision': 0.69054985, 'recall': 0.6216478, 'specificity': 0.97410655, 'f1': 0.6325707, 'auroc': 0.8773868}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   532     1   10  32    6    2   485    16     9   69     8
1     0  1331    1  12    3    1     2   104     7    1    37
2     0     0  358   3  360    2    12    24   163   39    54
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    4   0  683    0     3     0     9    0   934
5     0     0    4  48    2  271     4     0    11  252     0
6     0     0    0   1    3    0  3050     1     4    0     8
7     0     0    0  57    0    0     0  1101     2    1     3
8     0     0    0  47    2    2     7    12  1296    2     2
9     1     4  384  36   12   34     6    62   102  483    13
10    0     0    0   0   71    0     2     0     0    0  1573
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-04 12:12:33.285843,epoch time: 0:38:17.339284,used: 3:12:28.927841,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_00_03_seed_1_24051367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96412134, 'precision': 0.89238083, 'recall': 0.89567614, 'specificity': 0.9961672, 'f1': 0.89310867, 'auroc': 0.99816144}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     0    1     4    2    0     7     2     1    4     19
1     0  1277    0     7    0    0     2    43     1    0      0
2     0     1  207     0   21    2     1     4     1   75      0
3     0     0    2  8324    0   13     1    67    27    3      0
4     4     0   46     0  425    1     1     1     6    9     45
5     0     0    0    16    0  458     0     0     1   45      1
6     6     0    0     3    0    0  1886     1     3    3      4
7     0     4    0   157    2    0     1  7083    11    3      4
8     1     1    7   180   14    9     1    97  2958    1     27
9     0     0   17     3    2   67     0     3     1  400      0
10   13     1    2     6  145    0    11    23    15    5  12574
---- Validation: 
scalar performance:
{'acc': 0.9633543, 'precision': 0.89288986, 'recall': 0.8917157, 'specificity': 0.9960808, 'f1': 0.8913095, 'auroc': 0.9979621}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    0     4    3    0     6     5     1    4     15
1     0  1273    0     8    0    0     1    49     1    0      0
2     0     0  203     1   22    1     1     2     2   80      0
3     0     1    0  8320    0    8     0    85    24    2      0
4     3     0   40     0  420    1     2     4     7   15     47
5     0     0    0    18    0  458     0     0     4   40      1
6     6     0    1     2    3    0  1883     2     2    3      6
7     0     6    0   165    1    0     1  7072    13    3      4
8     1     1    4   177   18    7     1   104  2959    3     21
9     0     0   20     4    2   71     0     4     0  392      0
10   12     0    3     7  136    0    13    14    17    4  12590
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75127685, 'precision': 0.6926689, 'recall': 0.6375139, 'specificity': 0.9751405, 'f1': 0.64935637, 'auroc': 0.87838924}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   925     3    1   39    3    1   157     7     1   31     2
1     0  1200    0   29    0    0     1   252     1    0    16
2     1     0  345   14  311   16    14    43   109  119    43
3     0     0    0    0    0    0     0     0     0    0     0
4     2     0    4    0  547    0     7     1     8    1  1063
5     0     0    0   81    2  335     0     0     2  172     0
6     0     0    0   23    0    0  3039     2     1    0     2
7     0     0    0  125    0    0     1  1034     0    1     3
8     0     0    0  169    3    1     3    18  1171    2     3
9     3     1  213   94    6  144     4    78    49  535    10
10    0     0    0    0   37    0     2     0     0    0  1607
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-04 12:50:40.763550,epoch time: 0:38:07.477707,used: 3:50:36.405548,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_00_03_seed_1_24051367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96711797, 'precision': 0.9125261, 'recall': 0.88551867, 'specificity': 0.99640316, 'f1': 0.8944851, 'auroc': 0.99862164}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    0    0     5     1     0    2      6
1     0  1258    0     7    0    0     0    64     2    0      1
2     3     0  179     0   43    0     0     4     2   80      1
3     5     0    0  8195    0   12     1   178    44    1      0
4     7     0   11     0  380    1     0     3     8    3    126
5     0     0    0     9    1  414     0     0     2   94      1
6    10     0    0     1    1    1  1876     3     2    3     10
7     0     3    1    68    1    0     3  7167    11    2      6
8     6     0    2    58   16    2     2   103  3057    3     46
9     3     0   15     2    3   28     1     3     0  438      0
10   23     0    1     4   24    1     8    13     6    2  12714
---- Validation: 
scalar performance:
{'acc': 0.96602917, 'precision': 0.9104442, 'recall': 0.88136023, 'specificity': 0.9962861, 'f1': 0.89102566, 'auroc': 0.99857044}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     1    1    0     3     1     0    1     10
1     0  1256    0     7    0    0     1    66     2    0      0
2     3     0  179     0   46    0     0     3     1   79      1
3     5     0    0  8206    1    8     0   170    49    1      0
4     5     0   11     1  379    0     0     1     6    9    127
5     0     0    0    16    0  402     0     0     2  100      1
6    13     0    0     0    2    1  1873     4     1    3     11
7     0     3    0    64    1    0     1  7174    12    1      9
8     8     0    2    65   19    3     4   112  3039    2     42
9     2     0   14     5    6   26     0     3     2  435      0
10   21     0    0     5   31    1     9    14     6    3  12706
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7201427, 'precision': 0.6553229, 'recall': 0.60448253, 'specificity': 0.97199047, 'f1': 0.5969223, 'auroc': 0.86969405}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1072     0    0   20    1    1    54    15     1    5     1
1      1  1055    0   27    1    0     1   375     5    0    34
2     49     0  117   27  391    6    13    68   115  100   129
3      0     0    0    0    0    0     0     0     0    0     0
4      5     0    1    0  217    0     4     1     6    1  1398
5     16     0    0   96    2  284     0     0     4  188     2
6      1     0    1    7    0    0  3054     2     0    0     2
7      0     0    0   77    0    0     0  1084     0    0     3
8      1     0    0  121    1    0     4    32  1204    2     5
9     35     0   88  153   23   89     4    90    61  571    23
10     0     0    0    0    9    0     2     0     0    0  1635
better model found
persisted
after epoch: 7,now: 2024-08-04 13:28:57.060901,epoch time: 0:38:16.297351,used: 4:28:52.702899,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_00_03_seed_1_24051367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9643086, 'precision': 0.90810966, 'recall': 0.886887, 'specificity': 0.9961028, 'f1': 0.8956301, 'auroc': 0.9983432}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    0     1    0    0    13     0     0   14     21
1     0  1291    0     8    0    0     3    22     7    0      1
2     0     0  225     0   26    1     1     1     5   51      2
3     0     1    1  8326    0   16     4    32    57    0      0
4     3     0   21     0  348    1     3     0    15    5    143
5     0     0    0    12    0  465     0     0     3   39      1
6     4     0    1     0    0    0  1891     0     0    3      9
7     3    14    8   256    2    0     6  6802   151    3     18
8     1     0    5    58    4    1     5    13  3179    2     28
9     1     0   24     1    2   87     1     0     3  372      2
10    7     0    1     8   25    2     9     4    26    2  12709
---- Validation: 
scalar performance:
{'acc': 0.9649592, 'precision': 0.9113972, 'recall': 0.88789153, 'specificity': 0.99616015, 'f1': 0.8974277, 'auroc': 0.9984015}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    0     1    0    0    13     1     0   11     20
1     0  1292    0     6    0    0     2    20    10    0      2
2     0     0  224     1   28    2     0     0     5   50      2
3     1     0    0  8331    0   10     3    29    63    3      0
4     4     0   16     0  345    1     1     1    19    7    145
5     0     0    0    12    0  467     0     0     3   38      1
6     5     0    0     1    1    0  1887     0     0    2     12
7     8     8   12   258    1    1     1  6811   142    5     18
8     1     0    5    57    5    5     3    10  3181    0     29
9     1     0   28     2    2   79     0     0     2  377      2
10    6     0    0     7    9    1    14     0    33    3  12723
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7088085, 'precision': 0.64244395, 'recall': 0.6022471, 'specificity': 0.9706961, 'f1': 0.59053457, 'auroc': 0.8531457}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   806     0    1   48    1   15   154    1     7  123    14
1     1  1260    3   27    0    2     2  160    11    4    29
2     3     0  150   12  177   24    42    8   205   89   305
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    1    0   72    0    15    0     6    1  1538
5     0     0    0   88    0  429     5    0    12   57     1
6     0     0    0   11    0    0  3052    0     0    0     4
7     1     0    0  187    0    1     2  956    11    2     4
8     0     0    0  103    1    3     6    0  1250    2     5
9     1     1  131   82   10  190     9   15   150  515    33
10    0     0    0    0    3    0     2    0     0    0  1641
early stop counter: 1
val acc:0.9649592041969299, best validation acc: 0.966029167175293, corresponding to test acc:                         0.7201427221298218 / 0.7512768507003784
after epoch: 8,now: 2024-08-04 14:07:57.332580,epoch time: 0:39:00.271679,used: 5:07:52.974578,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_00_03_seed_1_24051367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.970061, 'precision': 0.91699874, 'recall': 0.9158468, 'specificity': 0.99674284, 'f1': 0.9153669, 'auroc': 0.9988922}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     5    0    0     2     1     1    2     15
1     0  1319    0     7    0    0     0     4     1    0      1
2     0     0  266     0   16    0     0     1     3   24      2
3     0     3    0  8344    0   23     0    24    45    0      0
4     4     0   28     0  407    0     0     1     9    4     86
5     0     0    0     9    0  466     0     0     2   43      1
6     9     0    0     3    0    0  1873     0     5    1     16
7     0    50    2   287    2    0     1  6861    47    1      9
8     1     3    5    56    8    4     1    26  3175    1     15
9     2     0   61     3    0   49     0     0     2  376      0
10   11     0    2     8   35    0     1     5    19    1  12713
---- Validation: 
scalar performance:
{'acc': 0.9700147, 'precision': 0.91861844, 'recall': 0.9191834, 'specificity': 0.9967507, 'f1': 0.91781557, 'auroc': 0.99879473}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     7    0    1     2     0     2    2      9
1     0  1317    0     6    0    0     0     5     3    0      1
2     0     0  271     0   12    2     0     0     1   26      0
3     0     1    0  8343    0   15     0    26    54    1      0
4     6     0   28     1  409    1     1     1     7    3     82
5     1     0    0     9    1  474     0     0     2   34      0
6     8     0    0     2    0    1  1878     0     5    1     13
7     2    54    1   277    1    0     1  6866    54    1      8
8     2     2    5    67   12    4     1    34  3152    1     16
9     0     0   53     4    1   57     0     0     1  377      0
10    8     0    3     6   36    2     1     3    20    0  12717
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7202827, 'precision': 0.68754375, 'recall': 0.6091856, 'specificity': 0.97220147, 'f1': 0.60981655, 'auroc': 0.86095077}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1050     3    1   43    2    0    45    2     4   10    10
1      3  1364    0   34    0    0     1   72     4    0    21
2     26     6  161   25  118   12    28   10   275   71   283
3      0     0    0    0    0    0     0    0     0    0     0
4      1     0    3    1  180    0     8    0    10    0  1430
5      8     0    1   93    0  395     0    0     7   82     6
6      1     0    0   14    0    0  3034    0     3    0    15
7      2     1    1  392    0    0     2  758     5    0     3
8      0     0    1  113    0    2     4    1  1244    2     3
9     17    11  146  166    1  137     2   16   130  470    41
10     0     0    0    0    6    0     1    0     0    0  1639
better model found
persisted
after epoch: 9,now: 2024-08-04 14:51:03.093918,epoch time: 0:43:05.761338,used: 5:50:58.735916,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_00_03_seed_1_24051367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9745291, 'precision': 0.9166568, 'recall': 0.92294294, 'specificity': 0.99730426, 'f1': 0.9185345, 'auroc': 0.9992376}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     1    3    0     4     2     0    2     13
1     0  1307    0     0    0    0     1    19     5    0      0
2     1     0  261     0   34    0     0     3     1   12      0
3     3     0    0  8185    0   21    22   129    75    2      1
4     2     0   18     0  471    1     0     1     4    0     42
5     1     0    2     4    1  470     0     0     1   40      1
6     5     1    1     0    1    1  1877     0     1    2     19
7     4    12    4    40    2    0     4  7154    34    0     10
8     0     0    9    24   14    2     1    45  3160    1     39
9     0     0   77     1    2   56     0     0     3  353      1
10    4     0    1     4   40    0     1     7     7    0  12728
---- Validation: 
scalar performance:
{'acc': 0.9754447, 'precision': 0.92085594, 'recall': 0.9272885, 'specificity': 0.9973887, 'f1': 0.92250514, 'auroc': 0.9992414}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     2    4    0     3     0     0    3     17
1     0  1301    0     2    0    0     1    24     3    0      1
2     1     0  275     0   27    0     0     0     0    9      0
3     4     2    0  8196    0   15    19   126    75    3      0
4     2     0   14     0  464    0     0     0     2    2     55
5     0     0    2     4    1  477     0     0     2   35      0
6     8     0    1     0    1    1  1878     0     2    1     16
7     2     6    6    47    4    0     7  7154    32    0      7
8     1     0    8    24   18    1     0    31  3179    0     34
9     0     0   82     2    2   47     0     0     1  358      1
10    3     0    1     3   45    0     3     6     4    0  12731
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.762681, 'precision': 0.6865072, 'recall': 0.6532031, 'specificity': 0.9760585, 'f1': 0.6525758, 'auroc': 0.8740732}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1085     0    0   5    3    2    43     1     1   27     3
1      0  1152    1  15    0    2     1   294     6    1    27
2     11     0  258   5  412   10     6    25    81   87   120
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    3   1  423    0     6     0     3    1  1196
5      3     0    2  39    4  365     2     0     3  172     2
6      0     0    0   0    2    0  3053     1     0    1    10
7      0     0    0  35    0    0    47  1076     1    3     2
8      0     0    0  91    5    3     5     5  1253    3     5
9     12     1  209  42   14  108     7    31    76  613    24
10     0     0    0   0   22    0     1     0     0    0  1623
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-04 15:31:02.169138,epoch time: 0:39:59.075220,used: 6:30:57.811136,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_00_03_seed_1_24051367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 6:30:57.811136 at 2024-08-04 15:31:02.169138
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.762681, 'precision': 0.6865072, 'recall': 0.6532031, 'specificity': 0.9760585, 'f1': 0.6525758, 'auroc': 0.8740732}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1085     0    0   5    3    2    43     1     1   27     3
1      0  1152    1  15    0    2     1   294     6    1    27
2     11     0  258   5  412   10     6    25    81   87   120
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    3   1  423    0     6     0     3    1  1196
5      3     0    2  39    4  365     2     0     3  172     2
6      0     0    0   0    2    0  3053     1     0    1    10
7      0     0    0  35    0    0    47  1076     1    3     2
8      0     0    0  91    5    3     5     5  1253    3     5
9     12     1  209  42   14  108     7    31    76  613    24
10     0     0    0   0   22    0     1     0     0    0  1623
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.762681, 'precision': 0.6865072, 'recall': 0.6532031, 'specificity': 0.9760585, 'f1': 0.6525758, 'auroc': 0.8740732}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1085     0    0   5    3    2    43     1     1   27     3
1      0  1152    1  15    0    2     1   294     6    1    27
2     11     0  258   5  412   10     6    25    81   87   120
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    3   1  423    0     6     0     3    1  1196
5      3     0    2  39    4  365     2     0     3  172     2
6      0     0    0   0    2    0  3053     1     0    1    10
7      0     0    0  35    0    0    47  1076     1    3     2
8      0     0    0  91    5    3     5     5  1253    3     5
9     12     1  209  42   14  108     7    31    76  613    24
10     0     0    0   0   22    0     1     0     0    0  1623
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_00_03_seed_1_24051367_instance_wise_predictions.txt
accuracy from prediction file 0.7626810326733366
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4046 MiB |  18021 MiB |   1521 TiB |   1521 TiB |
|       from large pool |   4023 MiB |  17987 MiB |   1513 TiB |   1513 TiB |
|       from small pool |     23 MiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   4046 MiB |  18021 MiB |   1521 TiB |   1521 TiB |
|       from large pool |   4023 MiB |  17987 MiB |   1513 TiB |   1513 TiB |
|       from small pool |     23 MiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4036 MiB |  17985 MiB |   1518 TiB |   1518 TiB |
|       from large pool |   4013 MiB |  17952 MiB |   1510 TiB |   1510 TiB |
|       from small pool |     22 MiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  19774 MiB |  19774 MiB |  34730 MiB |  14956 MiB |
|       from large pool |  19736 MiB |  19736 MiB |  34690 MiB |  14954 MiB |
|       from small pool |     38 MiB |     38 MiB |     40 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1241 MiB |   2223 MiB |    770 TiB |    770 TiB |
|       from large pool |   1228 MiB |   2216 MiB |    762 TiB |    762 TiB |
|       from small pool |     12 MiB |     29 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3670    |    5882    |   94433 K  |   94430 K  |
|       from large pool |     502    |     727    |   41336 K  |   41335 K  |
|       from small pool |    3168    |    5277    |   53097 K  |   53094 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3670    |    5882    |   94433 K  |   94430 K  |
|       from large pool |     502    |     727    |   41336 K  |   41335 K  |
|       from small pool |    3168    |    5277    |   53097 K  |   53094 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     408    |     414    |     620    |     212    |
|       from large pool |     389    |     395    |     600    |     211    |
|       from small pool |      19    |      19    |      20    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     230    |    1220    |   47869 K  |   47869 K  |
|       from large pool |     183    |     285    |   25434 K  |   25434 K  |
|       from small pool |      47    |    1039    |   22435 K  |   22435 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  18021 MiB |   1521 TiB |   1521 TiB |
|       from large pool |  16640 KiB |  17987 MiB |   1513 TiB |   1513 TiB |
|       from small pool |      0 KiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  18021 MiB |   1521 TiB |   1521 TiB |
|       from large pool |  16640 KiB |  17987 MiB |   1513 TiB |   1513 TiB |
|       from small pool |      0 KiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  17985 MiB |   1518 TiB |   1518 TiB |
|       from large pool |  16640 KiB |  17952 MiB |   1510 TiB |   1510 TiB |
|       from small pool |      0 KiB |     35 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5288 MiB |  19774 MiB |  34730 MiB |  29442 MiB |
|       from large pool |   5252 MiB |  19736 MiB |  34690 MiB |  29438 MiB |
|       from small pool |     36 MiB |     38 MiB |     40 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2223 MiB |    770 TiB |    770 TiB |
|       from large pool |  24320 KiB |   2216 MiB |    762 TiB |    762 TiB |
|       from small pool |      0 KiB |     29 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5882    |   94433 K  |   94433 K  |
|       from large pool |       2    |     727    |   41336 K  |   41336 K  |
|       from small pool |       0    |    5277    |   53097 K  |   53097 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5882    |   94433 K  |   94433 K  |
|       from large pool |       2    |     727    |   41336 K  |   41336 K  |
|       from small pool |       0    |    5277    |   53097 K  |   53097 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     204    |     414    |     620    |     416    |
|       from large pool |     186    |     395    |     600    |     414    |
|       from small pool |      18    |      19    |      20    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1220    |   47870 K  |   47870 K  |
|       from large pool |       3    |     285    |   25434 K  |   25434 K  |
|       from small pool |       0    |    1039    |   22436 K  |   22436 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug  4 15:37:22 2024]
Finished job 0.
1 of 1 steps (100%) done
