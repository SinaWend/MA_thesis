Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug  3 01:34:53 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/13.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=13
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051357

 Experiment start at: 2024-08-03 01:49:06.129576
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.044287413358688354
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91837007, 'precision': 0.828274, 'recall': 0.72755927, 'specificity': 0.990926, 'f1': 0.7607331, 'auroc': 0.9906709}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   282     0   0    23    0    0    72     6    10   29     61
1     0  1113   0    27    0    0     1   175     8    0      8
2     2     0  85    13   39    6     1    46    10  107      3
3     0     0   0  8234    0    6     0   129    69    0      0
4     1     0  33     5  173    2     6    19    80   24    196
5     2     0   1    74    0  364     0     0     4   75      1
6     4     0   0    32    0    2  1837     4    11    7     11
7     0     1   0   552    1    0     1  6632    65    0     12
8     1     0   5   395    2    4     4    90  2775    2     17
9     1     0  24    33    1  112     1     9     5  305      2
10   13     0   3    15   13    1    41    39   136    5  12525
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9176943, 'precision': 0.83177066, 'recall': 0.72709006, 'specificity': 0.99083424, 'f1': 0.7616826, 'auroc': 0.9907407}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   299     0   0    20    0    3    64     9    13   23     52
1     0  1096   0    31    0    0     2   189     5    0      9
2     0     1  88    12   32    7     0    43    16  106      7
3     0     0   0  8231    0    8     1   135    65    0      0
4     1     0  28    11  171    3     4    14    91   28    188
5     1     0   0    83    0  353     0     0     5   78      1
6     6     0   0    29    0    1  1835     6    11    4     16
7     0     2   0   569    2    0     1  6618    63    0     10
8     2     0   2   388    1    1     3    73  2787    7     32
9     1     0  28    42    0  109     0     8     5  299      1
10   12     0   3    21   15    1    46    38   125    4  12531
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6023228, 'precision': 0.58077425, 'recall': 0.509677, 'specificity': 0.9606434, 'f1': 0.4940941, 'auroc': 0.8544545}
confusion matrix:
     0    1   2    3    4    5     6    7     8    9     10
0   647    0   0  217    0    3   193   27    27   53     3
1     0  827   0   69    2    0     5  556    10    0    30
2     4    1  24   74  132   92    20  106   385   79    98
3     0    0   0    0    0    0     0    0     0    0     0
4     1    1   0    1  136    0     5    3    49    1  1436
5     1    0   0  144    0  395     3    0     3   45     1
6     0    0   0   48    8    0  2581    6   256    0   168
7     0    0   0  221    0    0     1  939     0    0     3
8     0    0   0  257    0    2     1    8  1100    2     0
9     5    6  72  311   14  240     0   93    65  315    16
10    0    0   0    0    0    0     1    0     0    0  1645
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 03:07:42.857134,epoch time: 1:18:36.727558,used: 1:18:36.727558,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051357
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9461419, 'precision': 0.86413825, 'recall': 0.80678123, 'specificity': 0.9939566, 'f1': 0.82977635, 'auroc': 0.9926729}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   398     0    0     9    0    0     8     2     7    4     55
1     0  1246    0    20    1    0     0    43    10    0     12
2     3     0  154     2   62    2     1     5    15   57     11
3     0     2    0  8192    0   17     1   116   107    0      4
4     1     0   11     2  238    1     0     2    43   11    230
5     1     0    0    36    0  360     2     0     8  113      1
6    32     0    0     7    0    0  1834     4     4    1     26
7     0     7    1   272    3    0     2  6860    78    1     38
8     3     0    4   126    9    6     0    46  3029    1     71
9     4     0   47    10    1   68     0     0    13  345      5
10   19     0    1     7    9    1     8     7    30    3  12707
---- Validation: 
scalar performance:
{'acc': 0.94591415, 'precision': 0.8679971, 'recall': 0.8081361, 'specificity': 0.9939398, 'f1': 0.83168226, 'auroc': 0.99307364}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   400     0    0     9    0    0     4     3     7    5     55
1     0  1254    0    19    1    0     0    40     8    0     10
2     2     0  152     2   67    3     1    11    15   50      9
3     0     1    1  8178    0   13     0   129   116    1      1
4     1     0   15     2  224    0     3     3    39   12    240
5     1     0    1    37    0  361     1     0     7  112      1
6    22     0    0    12    0    0  1839     7     7    1     20
7     1     8    5   270    2    0     2  6847    92    1     37
8     2     0    2   135    6    5     1    52  3046    1     46
9     4     0   40    15    1   58     1     1     8  361      4
10   15     0    1     7    9    1    15    10    35    2  12701
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71265656, 'precision': 0.63591564, 'recall': 0.6044977, 'specificity': 0.9712648, 'f1': 0.5897238, 'auroc': 0.8577901}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1039     1    0   34    0    0     6    12    68    6     4
1      1  1240    5   35    2    2     1   171    14    0    28
2     22     0   97   32  182    9     3    12   315  115   228
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    1    0   68    0     2     1    11    1  1547
5     17     0    0  115    0  324     0     0     8  126     2
6      2     0    0    6    2    0  2925     2    29    2    99
7      3     0    1  129    0    0     6  1013     3    2     7
8      0     0    0   94    3    7     3     3  1252    5     3
9     23     0  122  109   13  104     2     9   143  582    30
10     0     0    0    0    0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 04:23:48.167456,epoch time: 1:16:05.310322,used: 2:34:42.037880,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051357
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9448309, 'precision': 0.86564076, 'recall': 0.7767526, 'specificity': 0.99388736, 'f1': 0.79971904, 'auroc': 0.9948148}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   402     1    0    11    0    1     8     5    10    3     41
1     0  1275    0    12    0    0     0    39     4    0      2
2     0     0  160     9   43   10     1    32    29   20      8
3     0     1    0  8211    0    2     0   168    57    0      0
4     4     0   10     3  226    2     3     5    74    5    207
5     2     0    0    94    0  412     0     0     4    7      1
6     8     0    0    12    0    1  1841    11    13    0     21
7     0    15    0   192    1    0     1  6998    49    0      7
8     1     2    2   185    0    1     0    66  3019    0     20
9     3     1   67    40    1  247     0    10    15  109      0
10    9     3    1    14    6    0     6    14    79    0  12661
---- Validation: 
scalar performance:
{'acc': 0.94345325, 'precision': 0.8596865, 'recall': 0.7739973, 'specificity': 0.9937413, 'f1': 0.7961285, 'auroc': 0.9952421}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   405     0    0    11    0    0     4     8    10    2     43
1     0  1276    0    13    0    0     0    37     5    0      1
2     0     1  155    10   46   11     1    35    26   19      8
3     0     1    0  8200    0    0     0   169    68    0      2
4     3     1   11     6  231    4     0     6    72    4    201
5     0     0    2   100    0  407     0     0     3    8      1
6    14     1    0    12    1    1  1838     8     9    1     23
7     0    14    0   189    1    0     1  6999    54    0      7
8     1     1    2   184    1    0     0    78  3011    0     18
9     1     0   69    45    2  246     0     7    17  104      2
10   10     0    1    18   14    0     4    15    89    0  12645
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6306584, 'precision': 0.6063611, 'recall': 0.5273709, 'specificity': 0.96350396, 'f1': 0.49840996, 'auroc': 0.85795873}
confusion matrix:
     0     1   2    3   4    5     6    7     8   9     10
0   983     2   0   67   0    5    13   12    63   5    20
1     0  1306   0   31   0    0     0  131    11   0    20
2     3     7  29  109  82   45     1   30   350   7   352
3     0     0   0    0   0    0     0    0     0   0     0
4     0     0   0    1  34    0     0    1    19   0  1578
5     3     0   1  321   0  260     0    0     2   3     2
6     0     0   0   81   3    0  2497    6   136   0   344
7     0     0   0  152   0    0     0  999    11   0     2
8     0     0   0  164   0    0     1    4  1200   0     1
9    10    15  47  377  10  244     0   49   280  60    45
10    0     0   0    0   0    0     0    0     0   0  1646
early stop counter: 1
val acc:0.9434532523155212, best validation acc: 0.9459141492843628, corresponding to test acc:                         0.712656557559967 / 0.712656557559967
after epoch: 3,now: 2024-08-03 05:36:00.629001,epoch time: 1:12:12.461545,used: 3:46:54.499425,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051357
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95719177, 'precision': 0.88953465, 'recall': 0.8616971, 'specificity': 0.99536914, 'f1': 0.87268126, 'auroc': 0.9967643}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   432     0    0     4    0    0     8     3     0    2     34
1     0  1277    0     9    0    0     2    38     5    0      1
2     3     0  188     0   34    0     3     6     7   68      2
3     0     1    0  8132    0    7     9   214    74    1      0
4     4     0   29     1  347    1     1     8    25    9    114
5     1     0    0    33    0  370     1     0     4  110      2
6     7     0    0     0    1    0  1881     3     5    2      8
7     2     7    0   128    1    0     4  7075    39    2      5
8     3     0    0   102    5    2     1    79  3084    2     18
9     9     0   18    12    1   41     1     2     3  406      0
10   14     0    2     9   89    0    19    28    47    1  12584
---- Validation: 
scalar performance:
{'acc': 0.9575498, 'precision': 0.89075464, 'recall': 0.86242473, 'specificity': 0.9954286, 'f1': 0.8728004, 'auroc': 0.9969357}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    0     2    1    0     6     4     6    1     24
1     0  1273    0     9    0    0     0    45     5    0      0
2     3     0  181     0   34    1     1     6     6   80      0
3     4     1    0  8126    0    7    10   204    87    1      0
4     6     0   21     1  353    0     1     9    29    9    110
5     2     0    0    33    0  371     0     0     4  110      1
6    11     0    0     1    1    0  1879     0     4    1     11
7     2     6    0   112    1    0     4  7097    38    1      4
8     1     1    3    98    8    2     1    97  3065    3     17
9     7     0   18     9    1   34     0     4     8  412      0
10   15     0    0     7   89    0     8    29    44    2  12602
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74029243, 'precision': 0.6970442, 'recall': 0.6164268, 'specificity': 0.9741653, 'f1': 0.6160923, 'auroc': 0.8849448}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1091     1    0   14    0    0    13    24    18    3     6
1      0  1124    0   26    2    0     8   321     5    0    13
2     31     5  102   27  249    3    14    81   279  132    92
3      0     0    0    0    0    0     0     0     0    0     0
4      3     0    1    0  545    0     9     5    19    0  1051
5      8     0    0  161    1  235     0     0     2  183     2
6      0     0    0    1    2    0  3034     2     5    0    23
7      0     0    0   71    0    0     2  1086     0    2     3
8      0     0    0  162    1    0     2    12  1190    3     0
9     33    11   46  190   12   44     3    58   154  572    14
10     0     0    0    0   36    0     8     0     0    0  1602
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-03 06:45:18.030669,epoch time: 1:09:17.401668,used: 4:56:11.901093,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051357
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95735234, 'precision': 0.89627707, 'recall': 0.8511028, 'specificity': 0.995193, 'f1': 0.8657826, 'auroc': 0.9961217}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   410     0    0     1    0    0     9     1     0    2     60
1     0  1287    0     6    0    0     0    31     3    0      4
2     2     0  215     0   25    1     1     0     3   59      6
3     3     2    0  8089    0   23     0   191   121    6      1
4     2     0   41     1  248    1     0     3    10   10    223
5     2     0    0    11    0  364     1     0     5  137      1
6    11     0    1     1    0    0  1848     1     2    1     43
7     4    18    2    78    1    0     2  7037    70    3     46
8     3     0    4    53    6    3     0    49  3101    5     72
9     2     0   24     3    1   31     1     1     2  426      2
10    4     0    3     6    7    0     1     7     9    2  12757
---- Validation: 
scalar performance:
{'acc': 0.95805806, 'precision': 0.9004351, 'recall': 0.85615355, 'specificity': 0.99527013, 'f1': 0.8712733, 'auroc': 0.9962261}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   418     0    0     1    0    0     2     5     1    2     54
1     0  1294    0     8    0    0     0    24     1    0      5
2     2     0  215     0   28    1     3     1     1   54      7
3     1     2    2  8075    0   22     1   206   126    4      1
4     4     0   31     1  255    0     0     3     9   12    224
5     4     0    0    10    0  382     0     0     7  117      1
6     9     0    1     1    1    0  1849     3     2    0     42
7     4    20    3    96    1    0     1  7029    68    4     39
8     6     0    2    42    5    2     2    44  3121    8     64
9     6     0   20     4    0   36     2     1     3  418      3
10    8     0    1     6    4    0     1     4     9    2  12761
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7304275, 'precision': 0.6576959, 'recall': 0.6173317, 'specificity': 0.9728774, 'f1': 0.6062075, 'auroc': 0.8675861}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   997     2    0   18    2    0    63     9    34   20    25
1     1  1356    1   29    1    0     3    77     9    0    22
2    10     7  122   12  240    5     4    11   272   91   241
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    2    0  101    0     1     0    10    1  1518
5     3     0    0  109    1  316     1     0     9  150     3
6     0     0    0    1    2    0  3012     1     8    0    43
7     0     1    1   23    0    0     1  1125     5    1     7
8     0     0    0  132    0    1     4     4  1224    3     2
9     6    12  115  115   16   82     8    23   188  542    30
10    0     0    0    0    1    0     0     0     0    0  1645
better model found
persisted
after epoch: 5,now: 2024-08-03 07:53:26.253056,epoch time: 1:08:08.222387,used: 6:04:20.123480,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051357
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9530447, 'precision': 0.8729374, 'recall': 0.84594244, 'specificity': 0.9948149, 'f1': 0.8525916, 'auroc': 0.9962034}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   362     0    0     1    1    4    55     0     1    7     52
1     0  1297    0     6    0    1     1    20     4    0      3
2     0     0  203     0   39    5     2     2     0   59      2
3     2     2    2  8230    1   58     5   113    22    1      3
4     2     0   26     1  349    2     2     3     2    5    147
5     0     0    0     6    0  501     0     0     1   12      1
6     3     0    1     0    1    1  1886     1     1    0     12
7     1    35    4   128    4    0    13  7029    22    4     23
8     2     1   13   178   45   47     7    70  2767    9    157
9     0     0   21     3    0  190     3     0     1  274      1
10    5     0    2     7   32    2    11     3     6    1  12723
---- Validation: 
scalar performance:
{'acc': 0.9524141, 'precision': 0.8736138, 'recall': 0.8421184, 'specificity': 0.9947257, 'f1': 0.8507553, 'auroc': 0.9962001}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   350     0    1     1    0    4    67     0     1    7     52
1     0  1294    1     6    0    0     2    24     1    0      4
2     0     0  199     0   34    8     1     0     0   65      5
3     1     1    1  8241    0   62     9    93    31    1      0
4     2     0   25     1  342    4     0     2     2    4    157
5     0     0    0     7    0  500     0     0     1   12      1
6     2     0    0     0    0    0  1888     0     2    1     15
7     4    30    6   129    2    1    19  7020    22    5     27
8     1     1   12   196   31   36    16    75  2763    6    159
9     0     0   22     3    0  186     1     0     0  281      0
10    6     0    3     7   36    2     7     4     1    2  12728
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7121668, 'precision': 0.65320545, 'recall': 0.6116873, 'specificity': 0.9709445, 'f1': 0.60333776, 'auroc': 0.858546}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   722     1    1   20    1   45   196    6    22  102    54
1     4  1275    1   28    2    2    19   88     2   15    63
2     3     0  216    9  332   50    12    7    64   66   256
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    3    0  153    0     2    0     2    1  1472
5     0     0    1   38    1  498     1    0     1   50     2
6     0     0    0    2    1    0  3039    0     0    0    25
7     0     0    5  127    0    1    31  969    11   12     8
8     0     0    1  141   10   21    13    2  1147    6    29
9     1     1  194   51   10  294     2    7    33  516    28
10    0     0    0    0    2    0     0    0     0    0  1644
early stop counter: 1
val acc:0.9524140954017639, best validation acc: 0.9580580592155457, corresponding to test acc:                         0.7304275035858154 / 0.7402924299240112
after epoch: 6,now: 2024-08-03 09:02:16.367012,epoch time: 1:08:50.113956,used: 7:13:10.237436,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051357
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96174014, 'precision': 0.87137437, 'recall': 0.8936253, 'specificity': 0.9960707, 'f1': 0.8780214, 'auroc': 0.9981055}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     1    0     2    0    0    13     0     2    0     19
1     0  1316    1     2    0    0     0     8     3    0      2
2     3     0  244     0   33    0     1     2     1   28      0
3     0     9    3  8075    0   27     0   191   130    4      0
4     7     0   26     0  445    0     1     0     7    1     51
5     2     0    4     8    0  323     0     0     4  179      1
6     8     1    0     2    2    0  1882     1     1    0      9
7     0    62   10    57    6    0     2  7082    33    0     11
8     3     2   14    19   19    5     1    45  3157    0     30
9     2     0   65     3    1   10     2     0     1  409      0
10   20     0    2     8  175    0     5     4    13    0  12567
---- Validation: 
scalar performance:
{'acc': 0.9600107, 'precision': 0.8659359, 'recall': 0.89041924, 'specificity': 0.99590456, 'f1': 0.8730233, 'auroc': 0.99814487}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     2    2     2    0    0    13     0     0    0     18
1     0  1307    1     4    0    0     1     9     5    0      5
2     3     0  242     0   39    0     1     0     0   27      0
3     0    11    4  8079    1   28     2   184   128    3      0
4     5     0   29     0  444    0     1     2     8    1     49
5     1     0    5     5    0  320     0     0     5  184      1
6     7     2    1     1    0    0  1883     1     2    0     11
7     1    58   11    54    5    0     2  7083    38    0     13
8     4     2   12    24   27    2     1    46  3145    0     33
9     3     0   65     3    1   10     2     0     3  406      0
10   20     0    3     5  205    0    11     6    11    0  12535
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7660393, 'precision': 0.684335, 'recall': 0.6387039, 'specificity': 0.97653705, 'f1': 0.6472611, 'auroc': 0.879269}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1034     0    0   27    1    0    51    5    36    2    14
1      2  1326    9   20    3    2    10   69    18    5    35
2     17     0  191    9  490    5     6    4   171   62    60
3      0     0    0    0    0    0     0    0     0    0     0
4      2     0    3    0  674    0     6    0    12    0   936
5     15     0    1   89    4  249     1    0     9  221     3
6      0     0    1    3    0    0  3055    0     6    0     2
7      1     0   19  123    0    0     3  999    14    2     3
8      0     0    4   54    1    5     4    0  1297    3     2
9     20     1  289   62   59   65     4    3    95  531     8
10     0     0    0    0   52    0     1    0     0    0  1593
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-03 10:09:50.441558,epoch time: 1:07:34.074546,used: 8:20:44.311982,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051357
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96794736, 'precision': 0.9199147, 'recall': 0.89046943, 'specificity': 0.9965329, 'f1': 0.90274954, 'auroc': 0.9984015}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    0     1    0    0    21     0     0    5     15
1     0  1290    0    17    0    0     1    21     3    0      0
2     0     0  193     2   37    0     3     6    12   59      0
3     1     1    1  8272    0    9     2    55    95    0      1
4     2     0   15     1  383    0     5     3    20    1    109
5     1     0    0    24    0  449     0     0     7   39      1
6     5     0    0     1    1    0  1890     0     1    1      9
7     2     5    0   190    2    0     6  6984    65    0      9
8     1     0    3    38    3    0     5    29  3198    0     19
9     2     0    8     1    2   58     1     0    12  409      0
10   14     0    1     7   42    1    22     5    30    1  12670
---- Validation: 
scalar performance:
{'acc': 0.96680486, 'precision': 0.9120328, 'recall': 0.88665366, 'specificity': 0.9964272, 'f1': 0.89735556, 'auroc': 0.99845}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    0     3    1    1    27     1     1    3     11
1     0  1284    0    14    1    0     0    29     4    0      0
2     0     0  196     2   35    0     2     3     9   64      1
3     1     0    1  8276    0   10     0    56    94    2      0
4     5     0   17     0  378    0     3     2    21    2    111
5     1     0    0    23    0  441     3     0     2   50      1
6     6     0    0     1    0    0  1889     1     0    2      9
7     1     6    1   205    1    0     5  6972    65    1      8
8     1     0    2    38    7    0     4    30  3200    0     14
9     0     0   14     3    3   60     1     0     7  405      0
10   17     0    1     6   44    0    25     4    29    2  12668
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69775414, 'precision': 0.68640476, 'recall': 0.57112634, 'specificity': 0.9697907, 'f1': 0.58328915, 'auroc': 0.87147725}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   894     0   0   38    0    1   177    2     9   44     5
1     4  1231   1   44    1    0    13  171    12    6    16
2     4     0  83   46  206    5   122   17   334  121    77
3     0     0   0    0    0    0     0    0     0    0     0
4     1     0   3    0  314    0    30    0    27    1  1257
5     2     0   0  187    0  250     5    0     0  145     3
6     0     0   0    2    0    0  3065    0     0    0     0
7     0     0   0  356    0    0    13  773    10    9     3
8     0     0   0  156    0    0    19    0  1190    4     1
9     5     2  35  289   13   63    18   17   134  546    15
10    0     0   0    0   12    0     6    0     1    0  1627
better model found
persisted
after epoch: 8,now: 2024-08-03 11:16:37.041106,epoch time: 1:06:46.599548,used: 9:27:30.911530,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051357
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9694992, 'precision': 0.90489, 'recall': 0.9029247, 'specificity': 0.99676317, 'f1': 0.90351856, 'auroc': 0.9985811}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    0     2    0    0     1     3    12   12     16
1     0  1301    0     5    0    0     0    24     1    0      0
2     0     0  243     1    6    0     0     6     3   52      0
3     0     4    1  8214    0   10     0   104    99    4      1
4     3     0   46     0  404    1     0     6    18    2     59
5     0     0    0     8    0  453     0     0     2   57      1
6    22     1    3     6    8    0  1787     5    13    7     56
7     1    10    1    78    1    0     1  7143    26    0      4
8     0     0    4    15    1    0     0    47  3219    1      9
9     0     0   21     3    0   65     0     2    12  390      0
10    8     0    7     8   76    0     1    14    32    1  12645
---- Validation: 
scalar performance:
{'acc': 0.96985424, 'precision': 0.91173947, 'recall': 0.9070015, 'specificity': 0.9967744, 'f1': 0.90911037, 'auroc': 0.9987573}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    2     1    2    0     1     2    11   11     22
1     0  1301    0     5    0    0     0    25     1    0      0
2     0     0  244     0    7    2     0     1     5   52      1
3     1     3    2  8221    0    6     0   101   106    0      0
4     2     0   37     0  420    1     0     2    11    5     61
5     0     0    0    11    0  460     0     0     5   44      1
6    13     1    5     5    7    0  1792     5     9    5     66
7     0    12    0    73    1    0     1  7147    27    0      4
8     1     0    2    27    3    0     0    51  3202    1      9
9     0     0   18     4    0   63     0     3     7  398      0
10    8     0    2     7   82    2     1     8    44    0  12642
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72811866, 'precision': 0.6818297, 'recall': 0.6272938, 'specificity': 0.972748, 'f1': 0.62940514, 'auroc': 0.8687894}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   773     2    3  27    4    1    15    29    49  244    23
1     0  1272    1  13    1    1     0   170    15   10    16
2     0     2  317   8  250   11     0    23   212  102    90
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    4   0  446    0     0     0    15    1  1167
5     0     0    2  54    1  308     0     0     8  218     1
6     1     1    2  10   13    0  2659     4    75    3   299
7     0     0    1  64    0    0     0  1093     2    1     3
8     0     0    1  73    0    0     1     7  1279    7     2
9     1     6  168  64    7  100     0    34   112  635    10
10    0     0    0   0   20    0     0     0     1    0  1625
better model found
persisted
after epoch: 9,now: 2024-08-03 12:22:57.598334,epoch time: 1:06:20.557228,used: 10:33:51.468758,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051357
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97067636, 'precision': 0.90322626, 'recall': 0.9202588, 'specificity': 0.9969724, 'f1': 0.90946496, 'auroc': 0.9989725}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    1     0    1    0     3     0     3    3     10
1     0  1293    1     1    0    0     2    31     4    0      0
2     1     0  279     0    7    2     0     0     4   19      0
3     8     0    2  8165    0   22     3   154    82    2      1
4     3     0   47     0  424    2     0     2    22    0     39
5     1     0    3     3    0  476     0     0     2   35      1
6    14     0    1     0    2    1  1874     0     5    0     11
7     7     4    3    52    3    0    12  7152    28    0      4
8     1     0    6    30    1    3     4    45  3201    0      4
9     2     0   58     1    0   78     0     0     4  350      0
10   17     0    5     5   81    1     6     5    64    1  12604
---- Validation: 
scalar performance:
{'acc': 0.9718069, 'precision': 0.9050621, 'recall': 0.9218198, 'specificity': 0.9970976, 'f1': 0.9116676, 'auroc': 0.99904716}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    1     1    0    0     4     0     0    1      6
1     0  1294    0     5    0    0     1    26     5    0      1
2     3     0  269     0    9    2     1     0     3   25      0
3    12     0    1  8160    0   29     5   141    91    0      1
4     4     0   49     0  418    1     0     2    23    1     41
5     1     0    1     1    0  480     0     0     2   35      1
6    16     0    2     0    3    1  1870     2     5    1      8
7     6     6    0    50    2    0    26  7146    23    1      5
8     0     0    5    23    4    3     0    34  3224    0      3
9     2     0   62     2    0   57     0     2     3  365      0
10   11     0    4     5   71    2     3     7    58    0  12635
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75127685, 'precision': 0.67550373, 'recall': 0.6435654, 'specificity': 0.9747253, 'f1': 0.6371731, 'auroc': 0.87388855}
confusion matrix:
      0     1    2   3    4    5     6    7     8    9     10
0   1093     0    0   1    0    0    58    2     9    4     3
1      2  1109    3   8    1    1    28  300    12    5    30
2     14     0  296   2  235   15    46   20   309   34    44
3      0     0    0   0    0    0     0    0     0    0     0
4      1     0    3   0  476    0    29    1    23    0  1100
5     19     0    3  27    0  412     3    0    19  106     3
6      0     0    0   0    0    0  3053    0     5    1     8
7      0     0    3  47    0    0   112  993     5    1     3
8      0     0    1  46    0    7    12   16  1281    4     3
9     24     0  309  26    7  131    20   37   149  413    21
10     0     0    0   0   24    0     8    0     2    0  1612
better model found
persisted
after epoch: 10,now: 2024-08-03 13:29:28.923871,epoch time: 1:06:31.325537,used: 11:40:22.794295,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051357
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 11:40:22.794295 at 2024-08-03 13:29:28.923871
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75127685, 'precision': 0.67550373, 'recall': 0.6435654, 'specificity': 0.9747253, 'f1': 0.6371731, 'auroc': 0.87388855}
confusion matrix:
      0     1    2   3    4    5     6    7     8    9     10
0   1093     0    0   1    0    0    58    2     9    4     3
1      2  1109    3   8    1    1    28  300    12    5    30
2     14     0  296   2  235   15    46   20   309   34    44
3      0     0    0   0    0    0     0    0     0    0     0
4      1     0    3   0  476    0    29    1    23    0  1100
5     19     0    3  27    0  412     3    0    19  106     3
6      0     0    0   0    0    0  3053    0     5    1     8
7      0     0    3  47    0    0   112  993     5    1     3
8      0     0    1  46    0    7    12   16  1281    4     3
9     24     0  309  26    7  131    20   37   149  413    21
10     0     0    0   0   24    0     8    0     2    0  1612
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7660393, 'precision': 0.684335, 'recall': 0.6387039, 'specificity': 0.97653705, 'f1': 0.6472611, 'auroc': 0.879269}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1034     0    0   27    1    0    51    5    36    2    14
1      2  1326    9   20    3    2    10   69    18    5    35
2     17     0  191    9  490    5     6    4   171   62    60
3      0     0    0    0    0    0     0    0     0    0     0
4      2     0    3    0  674    0     6    0    12    0   936
5     15     0    1   89    4  249     1    0     9  221     3
6      0     0    1    3    0    0  3055    0     6    0     2
7      1     0   19  123    0    0     3  999    14    2     3
8      0     0    4   54    1    5     4    0  1297    3     2
9     20     1  289   62   59   65     4    3    95  531     8
10     0     0    0    0   52    0     1    0     0    0  1593
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051357_instance_wise_predictions.txt
accuracy from prediction file 0.7512768488071083
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/13.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/13.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/13.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4043 MiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |   4020 MiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |     23 MiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   4043 MiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |   4020 MiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |     23 MiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4036 MiB |  28168 MiB |   1089 TiB |   1089 TiB |
|       from large pool |   4013 MiB |  28119 MiB |   1082 TiB |   1082 TiB |
|       from small pool |     22 MiB |     49 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  29180 MiB |  29180 MiB |  29180 MiB |      0 B   |
|       from large pool |  29128 MiB |  29128 MiB |  29128 MiB |      0 B   |
|       from small pool |     52 MiB |     52 MiB |     52 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 533085 KiB |   1608 MiB | 225864 GiB | 225864 GiB |
|       from large pool | 515792 KiB |   1606 MiB | 218788 GiB | 218787 GiB |
|       from small pool |  17293 KiB |     22 MiB |   7076 GiB |   7076 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3670    |    5393    |   69676 K  |   69672 K  |
|       from large pool |     502    |    1018    |   33625 K  |   33625 K  |
|       from small pool |    3168    |    4690    |   36051 K  |   36047 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3670    |    5393    |   69676 K  |   69672 K  |
|       from large pool |     502    |    1018    |   33625 K  |   33625 K  |
|       from small pool |    3168    |    4690    |   36051 K  |   36047 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     725    |     725    |     725    |       0    |
|       from large pool |     699    |     699    |     699    |       0    |
|       from small pool |      26    |      26    |      26    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     220    |    1249    |   36462 K  |   36461 K  |
|       from large pool |     182    |     469    |   21026 K  |   21026 K  |
|       from small pool |      38    |    1067    |   15435 K  |   15435 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |  16640 KiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |      0 KiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |  16640 KiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |      0 KiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  28168 MiB |   1089 TiB |   1089 TiB |
|       from large pool |  16640 KiB |  28119 MiB |   1082 TiB |   1082 TiB |
|       from small pool |      0 KiB |     49 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4564 MiB |  29180 MiB |  29180 MiB |  24616 MiB |
|       from large pool |   4524 MiB |  29128 MiB |  29128 MiB |  24604 MiB |
|       from small pool |     40 MiB |     52 MiB |     52 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1608 MiB | 225866 GiB | 225866 GiB |
|       from large pool | 134912 KiB |   1606 MiB | 218790 GiB | 218790 GiB |
|       from small pool |      0 KiB |     34 MiB |   7076 GiB |   7076 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |   69676 K  |   69676 K  |
|       from large pool |       2    |    1018    |   33625 K  |   33625 K  |
|       from small pool |       0    |    4690    |   36051 K  |   36051 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |   69676 K  |   69676 K  |
|       from large pool |       2    |    1018    |   33625 K  |   33625 K  |
|       from small pool |       0    |    4690    |   36051 K  |   36051 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     212    |     725    |     725    |     513    |
|       from large pool |     192    |     699    |     699    |     507    |
|       from small pool |      20    |      26    |      26    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1249    |   36462 K  |   36462 K  |
|       from large pool |       4    |     469    |   21026 K  |   21026 K  |
|       from small pool |       0    |    1067    |   15436 K  |   15436 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |  16640 KiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |      0 KiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |  16640 KiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |      0 KiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  28168 MiB |   1089 TiB |   1089 TiB |
|       from large pool |  16640 KiB |  28119 MiB |   1082 TiB |   1082 TiB |
|       from small pool |      0 KiB |     49 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4564 MiB |  29180 MiB |  29180 MiB |  24616 MiB |
|       from large pool |   4524 MiB |  29128 MiB |  29128 MiB |  24604 MiB |
|       from small pool |     40 MiB |     52 MiB |     52 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1608 MiB | 225866 GiB | 225866 GiB |
|       from large pool | 134912 KiB |   1606 MiB | 218790 GiB | 218790 GiB |
|       from small pool |      0 KiB |     34 MiB |   7076 GiB |   7076 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |   69676 K  |   69676 K  |
|       from large pool |       2    |    1018    |   33625 K  |   33625 K  |
|       from small pool |       0    |    4690    |   36051 K  |   36051 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |   69676 K  |   69676 K  |
|       from large pool |       2    |    1018    |   33625 K  |   33625 K  |
|       from small pool |       0    |    4690    |   36051 K  |   36051 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     212    |     725    |     725    |     513    |
|       from large pool |     192    |     699    |     699    |     507    |
|       from small pool |      20    |      26    |      26    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1249    |   36462 K  |   36462 K  |
|       from large pool |       4    |     469    |   21026 K  |   21026 K  |
|       from small pool |       0    |    1067    |   15436 K  |   15436 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051357

 Experiment start at: 2024-08-03 13:47:35.484296
before training, model accuracy: 0.06926468014717102
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9240689, 'precision': 0.83153546, 'recall': 0.73053193, 'specificity': 0.99134284, 'f1': 0.7687371, 'auroc': 0.988828}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   263     0    0    10    1    1    55    17     7    4    125
1     0  1222    0    16    0    0     0    86     1    0      4
2     1     0  122     4   65    2     8    42    11   40     17
3     1     0    0  8095    2   20     0   243    77    1      0
4     1     1   15     3  179    1    15    23    40   10    251
5     0     0   11    62    1  355     1     0     8   81      1
6     7     0    0     6    0    0  1840    13     8    4     30
7     0    10    0   285    1    2     2  6916    30    0     18
8     0     1    3   327    5    1     9   160  2648    0    142
9     4     2   77    16    9   94     6    11    16  245     12
10    3     0    1     8    6    0    30    64    27    2  12653
---- Validation: 
scalar performance:
{'acc': 0.92609334, 'precision': 0.8428898, 'recall': 0.7378843, 'specificity': 0.9915565, 'f1': 0.77575696, 'auroc': 0.98880005}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   253     0    1    13    0    0    64    13     4    8    127
1     0  1221    0    15    0    1     1    88     1    0      5
2     4     0  136     4   55    4     5    38    11   40     15
3     0     0    0  8102    1   17     0   240    79    0      1
4     0     1   20     2  169    1    18    21    36    9    262
5     0     0    9    54    0  376     0     1    11   69      1
6     1     1    0     3    1    0  1853    14     7    4     24
7     0    10    0   266    1    1     3  6941    24    0     19
8     0     2    2   311    6    1     6   160  2666    1    141
9     2     0   75    18    6   93     5    16    11  257     10
10    1     2    1     8    5    0    42    65    22    2  12648
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6680193, 'precision': 0.56469357, 'recall': 0.56184113, 'specificity': 0.96675557, 'f1': 0.52451366, 'auroc': 0.8490588}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   861     0    0   48    0    3   150    51     6    9    42
1     0  1192    0   43    0    0     8   242     0    0    14
2    16     2   30  101  139   38    53   150   225   33   228
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0   21    0    42    10    12    0  1548
5    14     0    4   75    0  444     4     1    14   35     1
6     0     0    0   26    0    0  3025     8     2    0     6
7     0     0    0    9    0    0     4  1148     0    0     3
8     0     0    0  271    0    2    13    20  1053    3     8
9    51     9  135  240   17  214    13   133   160  139    26
10    0     0    0    0    0    0    11     0     0    0  1635
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 14:55:45.572270,epoch time: 1:08:10.087974,used: 1:08:10.087974,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051357
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93870395, 'precision': 0.85567254, 'recall': 0.7739969, 'specificity': 0.99298275, 'f1': 0.803198, 'auroc': 0.9932148}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   387     0    1     8    0    0     6    10     0    3     68
1     0  1232    0    13    0    0     0    80     2    0      5
2     9     0  121     1   57    1     2    41    11   46     23
3     0     0    0  8005    1   19     0   277   129    5      1
4     6     0   15     0  158    1     1    13    39    7    299
5     3     0    3    34    0  348     0     0     8  124      1
6    14     1    1    11    1    0  1815     7     3    0     55
7     1     8    0   162    1    0     0  7048    28    0     14
8     6     0    2    92    1    2     0   141  2924    1    126
9    12     0   47     7    3   48     1    15     7  339     14
10   12     0    0     8    3    0     9    39    13    2  12708
---- Validation: 
scalar performance:
{'acc': 0.93772906, 'precision': 0.86020446, 'recall': 0.7762402, 'specificity': 0.99285054, 'f1': 0.80543065, 'auroc': 0.9933236}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   384     0    0     7    0    0    10    14     1    0     67
1     0  1232    0    12    0    0     0    82     2    0      4
2     9     0  130     0   48    0     1    41    10   43     30
3     1     1    1  7984    0   17     0   302   131    3      0
4     4     0   15     1  147    1     2    13    38    9    309
5     3     0    4    29    0  362     0     0     5  117      1
6    12     0    0    10    1    0  1816    10     1    3     55
7     1     8    1   168    1    0     1  7036    35    0     14
8     3     2    1   106    0    2     1   132  2910    0    139
9    19     0   43     3    3   51     3    13     8  341      9
10   15     0    0    10    4    0     7    28    16    1  12715
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.645071, 'precision': 0.55947137, 'recall': 0.545552, 'specificity': 0.96420264, 'f1': 0.5165266, 'auroc': 0.8376237}
confusion matrix:
      0     1    2    3   4    5     6     7     8    9     10
0   1036     4    0   28   0    0    16    49     4    0    33
1      0  1199    0   17   0    0     0   250     0    0    33
2     62     1   23    8  50    2     0    75   126   34   634
3      0     0    0    0   0    0     0     0     0    0     0
4      1     0    0    0   2    0     0     3     4    0  1623
5     56     0    7   57   2  219     1     0    10  234     6
6      0     1    0   23   0    0  2456    17    12    0   558
7      0     0    0   14   0    0     0  1146     0    1     3
8      3     0    1  107   0    2     0    34  1180    2    41
9    150     9  170   65  22   29     1   159    95  313   124
10     0     0    0    0   0    0     0     0     0    0  1646
better model found
persisted
after epoch: 2,now: 2024-08-03 16:02:31.524877,epoch time: 1:06:45.952607,used: 2:14:56.040581,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051357
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94863015, 'precision': 0.8691933, 'recall': 0.8348259, 'specificity': 0.9944547, 'f1': 0.8471549, 'auroc': 0.9960182}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   393     2    0     9    2    0     9     6     3    5     54
1     0  1276    0     9    0    0     0    43     4    0      0
2     1     4  140     1   73    3     0    20     9   60      1
3     0     1    0  8036    0    7     0   290   104    0      0
4     4     4    4     1  393    0     1     9    20    8     95
5     0     0    2    47    1  424     0     0     7   38      1
6     9     7    0     3    2    0  1863     6     4    4     10
7     0    17    0    99    1    0     2  7101    36    0      9
8     2     2    2   102   25    0     1   152  2974    1     35
9     2     1   38    12    4  100     0    10    14  310      2
10    6    20    1     8  155    1    12    24    17    0  12546
---- Validation: 
scalar performance:
{'acc': 0.9486425, 'precision': 0.864181, 'recall': 0.8353764, 'specificity': 0.99448216, 'f1': 0.8452816, 'auroc': 0.9959763}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   401     1    1     9    4    0     6     8     2    5     46
1     0  1276    0    11    0    0     0    43     2    0      0
2     1     4  133     2   77    3     0    18     9   63      2
3     1     2    0  8025    0    6     3   289   111    2      1
4     2     6    4     0  403    2     2     9    15   12     84
5     0     0    4    47    0  425     0     0     7   37      1
6     9     4    0     4    2    0  1861     4    10    6      8
7     0    24    0   118    1    0     3  7082    32    0      5
8     1     0    2    87   20    0     1   138  3010    0     37
9     0     1   43    13    6  105     0     7    12  304      2
10    8    31    1     7  143    0     8    34    18    1  12545
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7286084, 'precision': 0.644943, 'recall': 0.59364325, 'specificity': 0.9730161, 'f1': 0.58321214, 'auroc': 0.86971563}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   943     9   0   52    3    0    68    45    13    9    28
1     0  1359   0   28    0    0     3   105     1    0     3
2     7    20  32   34  432    4     3   111   243   33    96
3     0     0   0    0    0    0     0     0     0    0     0
4     0    13   0    0  712    0     4     4     7    0   893
5     3     0   0  280    2  227     1     0    26   50     3
6     0     3   0    7    2    0  3038     8     3    0     6
7     0     1   0   22    0    0     0  1141     0    0     0
8     0     0   0   88    3    0     1    22  1252    0     4
9    19    28  97  279   49   63     1   156   276  158    11
10    0     7   0    0   85    0     2     0     0    0  1552
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-03 17:09:48.492444,epoch time: 1:07:16.967567,used: 3:22:13.008148,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051357
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9586633, 'precision': 0.8981126, 'recall': 0.8601581, 'specificity': 0.9954388, 'f1': 0.8771818, 'auroc': 0.99694794}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   407     0    0     5    3    0     6     3     1    0     58
1     0  1297    1     3    0    0     0    24     6    0      1
2     1     0  183     0   55    0     2     7     4   57      3
3     1     2    0  8045    1    8     5   242   136    0      0
4     2     1   15     1  359    1     0     4     9    6    141
5     4     0    0    35    1  413     1     0     7   59      1
6     4     0    0     1    2    0  1871     6     3    1     17
7     0    18    1    88    1    0     3  7108    32    0     11
8     0     3    5    51   22    1     1    90  3073    1     48
9     5     0   24     9    3   60     0     2     9  375      6
10    7     0    2     6   43    0     3    12    21    0  12700
---- Validation: 
scalar performance:
{'acc': 0.9581383, 'precision': 0.8950451, 'recall': 0.8558623, 'specificity': 0.9953925, 'f1': 0.87289417, 'auroc': 0.9970523}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   409     1    0     4    1    0     7     5     0    3     53
1     0  1288    0     5    0    0     0    32     5    0      2
2     3     0  174     0   61    0     1     6     4   59      4
3     0     6    1  8042    0   10     6   241   133    1      0
4     1     1   13     0  351    1     1     8    11    4    148
5     2     0    0    34    1  408     0     0     5   70      1
6    10     0    2     2    2    0  1865     0     2    1     24
7     0    33    1    75    2    0     2  7105    38    0      9
8     0     2    3    47   22    0     0    99  3077    1     45
9     4     0   26     5    3   57     3     3     7  381      4
10    5     0    0     5   34    0     5    12    12    3  12720
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7111173, 'precision': 0.6134815, 'recall': 0.5764883, 'specificity': 0.9707205, 'f1': 0.5505822, 'auroc': 0.86473054}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1067     3    0   9    4    0    35    18     1    0    33
1      0  1361    1  15    0    0     8   102     2    0    10
2     34     0   55   1  298    1    10    39   148   32   397
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    1   0  148    0     2     1     3    0  1477
5     62     0    3  82   12  112    16     0    37  266     2
6      0     0    0   0    0    0  3034     2     1    0    30
7      0     1    1  15    0    0     4  1139     0    0     4
8      0     0    0  37   11    0    12    27  1269    2    12
9    109     4  244  34   40    7    44    93   168  335    59
10     0     0    0   0    2    0     0     0     0    0  1644
better model found
persisted
after epoch: 4,now: 2024-08-03 18:17:09.852349,epoch time: 1:07:21.359905,used: 4:29:34.368053,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051357
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9575664, 'precision': 0.8939413, 'recall': 0.8685496, 'specificity': 0.99534684, 'f1': 0.8781437, 'auroc': 0.9974145}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     0    1     4    1    0     1     8     2    6     39
1     0  1272    0     3    0    0     0    44     7    0      6
2     0     0  216     0   38    2     1     2     2   48      3
3     1     0    0  7993    0   20     0   292   123    7      0
4     3     0   28     0  338    1     0     5    13    9    142
5     0     0    0    12    0  374     0     0     4  130      1
6    18     1    1     1    2    0  1847    14     3    1     20
7     2    11    1    74    1    0     1  7106    48    1     18
8     1     0    5    53   14    2     0    72  3088   10     50
9     1     0   33     2    1   22     1     1     4  426      1
10    6     1    1     4   39    0     8    13    10    4  12709
---- Validation: 
scalar performance:
{'acc': 0.9582185, 'precision': 0.89551187, 'recall': 0.8698416, 'specificity': 0.99542296, 'f1': 0.879841, 'auroc': 0.9977008}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   424     0    1     4    1    0     2     7     0    1     43
1     0  1276    0     4    0    0     0    44     7    0      1
2     0     0  211     0   38    0     1     1     2   56      3
3     0     0    1  7985    1   16     1   303   125    8      0
4     2     0   21     0  355    2     0     1    14    7    137
5     0     0    0    14    1  371     0     0     3  131      1
6    12     0    1     0    2    0  1858    13     2    2     18
7     0     8    2    74    2    0     1  7118    47    2     11
8     0     0    5    48   12    3     0    63  3102    7     56
9     0     0   36     1    1   30     0     1     3  420      1
10    8     1    1     7   41    0     5    10    17    3  12703
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71615475, 'precision': 0.6393426, 'recall': 0.59386116, 'specificity': 0.9714701, 'f1': 0.58197004, 'auroc': 0.8670942}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   946     1    4   42    2    0    27   108     7   18    15
1     0  1291    4   26    1    0     1   137     8    0    31
2     8     0  131    9  287    4    11    41   225   60   239
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    0    0  187    0     6     1     9    0  1429
5     6     0    1  156    2  225     2     0    30  169     1
6     0     0    0    3    1    0  2992     4     8    0    59
7     0     0    0    6    0    0     0  1155     0    0     3
8     0     0    0   38    0    0     2    38  1285    0     7
9    20     1  255   81   24   34     4   103   211  381    23
10    0     0    0    0    3    0     0     0     0    0  1643
better model found
persisted
after epoch: 5,now: 2024-08-03 19:23:51.692674,epoch time: 1:06:41.840325,used: 5:36:16.208378,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051357
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96096426, 'precision': 0.90669394, 'recall': 0.8588768, 'specificity': 0.9956522, 'f1': 0.8778144, 'auroc': 0.9976883}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    0     2    1    0     3     2     0    0     27
1     0  1276    0     6    0    0     0    47     1    0      1
2     5     0  174     1   58    0     1     5     6   62      0
3     0     0    0  8209    0    8     1   169    49    2      0
4     3     0    8     0  327    1     1     5    17    6    171
5     3     0    3    25    0  378     0     0     7  104      1
6     5     0    0     1    1    0  1874     3     4    1     18
7     1    14    0   102    3    0     1  7124    12    0      8
8     2     0    4   109    4    0     1   163  2978    0     35
9     4     0   21     3    4   29     2    10     6  413      1
10   15     1    1     7   21    0     5    11    12    2  12716
---- Validation: 
scalar performance:
{'acc': 0.9602782, 'precision': 0.9024646, 'recall': 0.85622, 'specificity': 0.99558556, 'f1': 0.8743403, 'auroc': 0.99780625}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     0    0     1    2    0     4     4     0    3     27
1     0  1278    0     5    0    0     0    47     2    0      0
2     6     0  175     1   60    0     0     9     4   57      0
3     0     0    0  8201    0    7     2   181    48    1      0
4     5     2    9     0  323    1     0     7    12    5    175
5     1     0    2    19    1  373     0     0     5  119      1
6    11     0    0     3    1    0  1869     2     5    1     16
7     0     7    0    99    2    0     1  7138    13    0      5
8     1     0    3   106    9    0     0   172  2967    1     37
9     8     0   26     2    4   30     0     6     2  414      1
10   15     1    0     4   17    0     4    17    16    2  12720
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6905478, 'precision': 0.61635363, 'recall': 0.57320285, 'specificity': 0.96904284, 'f1': 0.56376624, 'auroc': 0.8621866}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   999     2    0   50    1    0    69    21    10    7    11
1     1  1319    0   30    1    0     3   132     3    0    10
2    13     1   33   23  369    4     6    70   194   49   253
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    0    0  167    0     3     2     8    0  1452
5    16     0    0  171    9  259     2     1    13  119     2
6     0     1    0   29    1    0  2882     3    10    0   141
7     0     0    0  131    0    0     0  1030     0    0     3
8     0     0    0  143    3    0     1    31  1180    2    10
9    39     4  110  153   62   69     9   151   144  359    37
10    0     0    0    0    4    0     0     0     0    0  1642
better model found
persisted
after epoch: 6,now: 2024-08-03 20:31:14.701511,epoch time: 1:07:23.008837,used: 6:43:39.217215,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051357
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96139234, 'precision': 0.9076208, 'recall': 0.8849998, 'specificity': 0.99572134, 'f1': 0.8953365, 'auroc': 0.99810505}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   424     0    0     1    2    0     9     2     1    1     43
1     0  1282    0     4    0    0     0    41     2    0      3
2     3     0  206     0   79    0     0     4     3   15      2
3     1     0    0  7936    1   10     0   329   158    2      0
4     5     0    3     1  418    0     0     2     2    0    108
5     2     0    1     5    2  458     0     0     4   48      1
6     5     0    1     3    1    1  1868     2     3    0     24
7     0     8    0    37    1    0     1  7167    35    0     15
8     2     0    3    25   41    0     0    50  3068    1    104
9     3     0   56     0    9   46     0     1     2  368      8
10    6     0    0     3   31    0     2     9     4    0  12738
---- Validation: 
scalar performance:
{'acc': 0.96003747, 'precision': 0.9034493, 'recall': 0.8809091, 'specificity': 0.99557865, 'f1': 0.8911542, 'auroc': 0.9980073}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   417     0    0     1    2    0     9     1     1    1     51
1     0  1269    0     4    0    0     0    52     3    0      4
2     1     0  208     0   74    0     1     2     1   21      4
3     2     1    0  7916    1   13     1   342   162    1      1
4     2     0    5     0  416    1     1     3     3    0    108
5     0     0    1     7    1  456     0     0     4   50      2
6     2     0    1     3    2    0  1875     3     3    0     19
7     0     8    0    38    3    0     1  7160    35    1     19
8     2     0    2    18   37    0     0    46  3089    1    101
9     2     0   63     3   10   51     0     1     2  356      5
10    6     0    0     4   41    0     3     8     5    0  12729
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7166445, 'precision': 0.6346183, 'recall': 0.61141986, 'specificity': 0.97121245, 'f1': 0.5945823, 'auroc': 0.86251485}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   876     0    0   8    1    1   180     5     6   15    78
1     0  1270    0  19    1    1     3   157     5    0    43
2     3     0   60   1  406    9     7    18   169   48   294
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  246    0     1     0     3    0  1382
5     5     0    2  61   14  424     0     0    15   66     5
6     0     0    1   1    0    0  2914     0     2    0   149
7     0     0    0  14    0    1     0  1144     2    0     3
8     0     0    0  54    0    3     1     4  1299    0     9
9    26     6  176  52   56  160     3    48   188  373    49
10    0     0    0   0    9    0     0     0     0    0  1637
early stop counter: 1
val acc:0.9600374698638916, best validation acc: 0.9602782130241394, corresponding to test acc:                         0.6905478239059448 / 0.7286084294319153
after epoch: 7,now: 2024-08-03 21:41:13.308133,epoch time: 1:09:58.606622,used: 7:53:37.823837,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051357
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9654056, 'precision': 0.89095795, 'recall': 0.90046585, 'specificity': 0.9963682, 'f1': 0.8933082, 'auroc': 0.99846303}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    2     2    4    0     6     1     0    4     29
1     0  1313    1     4    0    1     0    10     3    0      0
2     0     0  247     0   53    0     0     0     1   11      0
3     0     4    3  8312    0   13     0    44    58    3      0
4     4     0   12     0  466    1     0     0    10    1     44
5     0     0    4    15    0  415     0     0     4   82      1
6     6     0    2     4    2    0  1874     0     3    3     13
7     0    65   15   222    7    0     1  6854    88    0     12
8     0     4    6    69   15    1     0    15  3172    1     13
9     0     0  117     4    3   22     0     0     1  346      0
10    6     0    2     6   87    0     4     6    30    3  12649
---- Validation: 
scalar performance:
{'acc': 0.96482545, 'precision': 0.88816917, 'recall': 0.8980079, 'specificity': 0.99630415, 'f1': 0.89073706, 'auroc': 0.9985444}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    1     1    3    0     2     0     2    3     32
1     0  1316    0     5    0    0     0     9     2    0      0
2     0     0  243     0   52    0     0     0     1   15      1
3     0     4    1  8292    0   10     0    47    84    2      0
4     3     0   14     0  462    1     0     0     7    2     50
5     0     0    4    11    1  414     0     0     3   87      1
6     6     0    2     3    2    0  1872     0     4    3     16
7     0    67   20   226   11    0     1  6852    77    1     10
8     2     1    7    61   12    0     0    16  3180    3     14
9     0     0  116     4    5   27     0     0     1  340      0
10    4     1    3     7   89    0     2     5    24    1  12660
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.739243, 'precision': 0.67666024, 'recall': 0.6215825, 'specificity': 0.97400343, 'f1': 0.6309298, 'auroc': 0.86099654}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1018     4    0   33   12    0    19    0     4   55    25
1      0  1427    2   31    1    1     1   23     4    0     9
2      4     2  168   10  427    6     5    2   183   64   144
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    3    0  342    0     3    0     9    1  1275
5      1     0    3   70    7  324     0    0     8  177     2
6      0     1    1    7    2    0  3010    0     3    0    43
7      0     4    8  272    0    1     0  868     8    0     3
8      0     0    1  105    2    2     1    1  1254    1     3
9      5     8  283  103   32   80     0    3    86  520    17
10     0     0    0    0   10    0     0    0     1    0  1635
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-03 23:00:19.310271,epoch time: 1:19:06.002138,used: 9:12:43.825975,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051357
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97174656, 'precision': 0.9205599, 'recall': 0.907296, 'specificity': 0.9969069, 'f1': 0.91088617, 'auroc': 0.999016}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    1     1    0    0     6     0     0    4     11
1     0  1306    0     2    0    1     0    20     2    0      0
2     0     0  264     0   11    0     0     1     4   30      2
3     1     3    0  8240    0    9     1   154    28    2      1
4     5     2   35     1  354    0     1     1     8    2    129
5     0     0    2     6    0  433     0     0     3   75      1
6     7     0    1     2    1    0  1888     1     0    2      6
7     4    16    1    79    1    0     1  7129    26    0      7
8     1     0    5    79    3    2     0    44  3136    2     23
9     0     0   59     2    1   26     0     0     1  403      1
10   30     0    2     5    7    0    13     7    21    1  12707
---- Validation: 
scalar performance:
{'acc': 0.97276986, 'precision': 0.92244434, 'recall': 0.90521395, 'specificity': 0.9970014, 'f1': 0.9103068, 'auroc': 0.9990186}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    2     0    0    0     7     0     0    2      8
1     0  1303    0     4    0    1     0    23     1    0      0
2     0     0  263     0   17    0     0     1     2   28      1
3     0     0    0  8254    0   12     0   146    27    1      0
4     7     0   38     1  333    0     1     2    12    2    143
5     0     0    0     5    0  431     0     0     3   81      1
6     6     0    1     4    1    0  1885     2     1    0      8
7     1    14    1    65    1    0     0  7150    23    0     10
8     2     0    4    76    4    1     0    40  3144    2     23
9     3     0   56     2    1   17     1     0     1  410      2
10   23     0    2     5    7    0    13     4    10    2  12730
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7467991, 'precision': 0.6752077, 'recall': 0.6404383, 'specificity': 0.9745152, 'f1': 0.62893724, 'auroc': 0.8652385}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1066     0    0    7    0    1    53     4     2   33     4
1      0  1307    0   39    0    1     5   135     4    0     8
2     17     1  227   10  130    8    19    21   206  103   273
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    4    0   93    0    31     1    18    0  1485
5      3     0    3   35    2  380     0     0     7  160     2
6      0     0    0    4    0    0  3058     1     1    0     3
7      2     1    0  101    0    1     0  1054     2    0     3
8      0     0    1   99    0    5     4     4  1255    0     2
9     15     2  171   88    3   98     1    37    91  601    30
10     0     0    0    0    4    0     8     0     1    0  1633
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-04 00:25:17.482081,epoch time: 1:24:58.171810,used: 10:37:41.997785,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051357
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97361946, 'precision': 0.937152, 'recall': 0.90015393, 'specificity': 0.9970792, 'f1': 0.9168122, 'auroc': 0.99897766}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   400     0    0     4    1    0    19     2     0    2     55
1     0  1296    0     4    0    0     0    27     5    0      0
2     0     0  232     0   34    0     1     1     4   40      0
3     0     0    0  8277    0    9     3    57    90    1      0
4     1     0   11     0  379    1     0     1    21    2    123
5     0     0    0     6    0  472     0     0     7   35      1
6     0     0    1     1    0    0  1882     4     2    0     17
7     0     6    0   107    1    0     1  7108    36    0      4
8     0     0    4    33    3    0     0    33  3215    0      8
9     0     0   25     3    2   44     1     2     4  410      2
10    2     0    2     7   14    0     7    10    32    0  12719
---- Validation: 
scalar performance:
{'acc': 0.9730908, 'precision': 0.93557173, 'recall': 0.9014869, 'specificity': 0.9970385, 'f1': 0.9169279, 'auroc': 0.9989104}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   409     0    0     2    1    0    24     2     2    1     42
1     0  1298    0     2    0    0     0    29     3    0      0
2     0     0  231     0   32    1     0     2     3   43      0
3     0     0    0  8268    0    7     0    63   102    0      0
4     1     1   12     0  388    1     3     1    18    0    114
5     0     0    0     4    0  474     1     0     6   35      1
6     3     0    1     2    1    0  1876     2     4    0     19
7     0     5    0   122    1    0     2  7093    39    0      3
8     0     0    3    39    2    0     0    30  3209    1     12
9     0     0   27     0    3   51     1     2     6  403      0
10    1     1    2     6   10    0     7    17    22    0  12730
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69642484, 'precision': 0.63944834, 'recall': 0.59379494, 'specificity': 0.96909416, 'f1': 0.5818021, 'auroc': 0.8469318}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   682     5    0  10    5    2   322    23     6   55    60
1     0  1310    2  37    0    0     3   116     9    1    21
2     3     0  150   4  262    7     2    17   317   82   171
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    2   0  132    0     0     1    17    0  1481
5     4     0    0  55    4  364     0     0    26  136     3
6     0     0    0   7    1    0  2782     2    22    0   253
7     0     0    0  58    0    1     0  1097     5    0     3
8     0     0    0  57    0    3     2     2  1303    1     2
9     6     1  131  46   20  131     1    19   257  494    31
10    0     0    0   0    5    0     0     0     1    0  1640
better model found
persisted
after epoch: 10,now: 2024-08-04 01:40:14.879824,epoch time: 1:14:57.397743,used: 11:52:39.395528,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051357
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 11:52:39.395528 at 2024-08-04 01:40:14.879824
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69642484, 'precision': 0.63944834, 'recall': 0.59379494, 'specificity': 0.96909416, 'f1': 0.5818021, 'auroc': 0.8469318}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   682     5    0  10    5    2   322    23     6   55    60
1     0  1310    2  37    0    0     3   116     9    1    21
2     3     0  150   4  262    7     2    17   317   82   171
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    2   0  132    0     0     1    17    0  1481
5     4     0    0  55    4  364     0     0    26  136     3
6     0     0    0   7    1    0  2782     2    22    0   253
7     0     0    0  58    0    1     0  1097     5    0     3
8     0     0    0  57    0    3     2     2  1303    1     2
9     6     1  131  46   20  131     1    19   257  494    31
10    0     0    0   0    5    0     0     0     1    0  1640
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7467991, 'precision': 0.6752077, 'recall': 0.6404383, 'specificity': 0.9745152, 'f1': 0.62893724, 'auroc': 0.8652385}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1066     0    0    7    0    1    53     4     2   33     4
1      0  1307    0   39    0    1     5   135     4    0     8
2     17     1  227   10  130    8    19    21   206  103   273
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    4    0   93    0    31     1    18    0  1485
5      3     0    3   35    2  380     0     0     7  160     2
6      0     0    0    4    0    0  3058     1     1    0     3
7      2     1    0  101    0    1     0  1054     2    0     3
8      0     0    1   99    0    5     4     4  1255    0     2
9     15     2  171   88    3   98     1    37    91  601    30
10     0     0    0    0    4    0     8     0     1    0  1633
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051357_instance_wise_predictions.txt
accuracy from prediction file 0.6964248233400966
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/13.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/13.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4044 MiB |  28236 MiB |   2186 TiB |   2186 TiB |
|       from large pool |   4020 MiB |  28187 MiB |   2172 TiB |   2172 TiB |
|       from small pool |     23 MiB |     50 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   4044 MiB |  28236 MiB |   2186 TiB |   2186 TiB |
|       from large pool |   4020 MiB |  28187 MiB |   2172 TiB |   2172 TiB |
|       from small pool |     23 MiB |     50 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4036 MiB |  28168 MiB |   2179 TiB |   2179 TiB |
|       from large pool |   4013 MiB |  28119 MiB |   2165 TiB |   2165 TiB |
|       from small pool |     22 MiB |     49 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  29192 MiB |  29192 MiB |  53808 MiB |  24616 MiB |
|       from large pool |  29140 MiB |  29140 MiB |  53744 MiB |  24604 MiB |
|       from small pool |     52 MiB |     52 MiB |     64 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 645093 KiB |   1619 MiB | 459148 GiB | 459147 GiB |
|       from large pool | 627800 KiB |   1617 MiB | 444984 GiB | 444983 GiB |
|       from small pool |  17293 KiB |     34 MiB |  14164 GiB |  14164 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3670    |    5393    |  139353 K  |  139350 K  |
|       from large pool |     502    |    1018    |   67251 K  |   67250 K  |
|       from small pool |    3168    |    4690    |   72102 K  |   72099 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3670    |    5393    |  139353 K  |  139350 K  |
|       from large pool |     502    |    1018    |   67251 K  |   67250 K  |
|       from small pool |    3168    |    4690    |   72102 K  |   72099 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     722    |     725    |    1235    |     513    |
|       from large pool |     696    |     699    |    1203    |     507    |
|       from small pool |      26    |      26    |      32    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     223    |    1249    |   72950 K  |   72949 K  |
|       from large pool |     184    |     469    |   41849 K  |   41849 K  |
|       from small pool |      39    |    1067    |   31100 K  |   31100 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  28236 MiB |   2186 TiB |   2186 TiB |
|       from large pool |  16640 KiB |  28187 MiB |   2172 TiB |   2172 TiB |
|       from small pool |      0 KiB |     50 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  28236 MiB |   2186 TiB |   2186 TiB |
|       from large pool |  16640 KiB |  28187 MiB |   2172 TiB |   2172 TiB |
|       from small pool |      0 KiB |     50 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  28168 MiB |   2179 TiB |   2179 TiB |
|       from large pool |  16640 KiB |  28119 MiB |   2165 TiB |   2165 TiB |
|       from small pool |      0 KiB |     49 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4674 MiB |  29192 MiB |  53808 MiB |  49134 MiB |
|       from large pool |   4634 MiB |  29140 MiB |  53744 MiB |  49110 MiB |
|       from small pool |     40 MiB |     52 MiB |     64 MiB |     24 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1619 MiB | 459150 GiB | 459150 GiB |
|       from large pool | 134912 KiB |   1617 MiB | 444986 GiB | 444986 GiB |
|       from small pool |      0 KiB |     34 MiB |  14164 GiB |  14164 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |  139353 K  |  139353 K  |
|       from large pool |       2    |    1018    |   67251 K  |   67251 K  |
|       from small pool |       0    |    4690    |   72102 K  |   72102 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |  139353 K  |  139353 K  |
|       from large pool |       2    |    1018    |   67251 K  |   67251 K  |
|       from small pool |       0    |    4690    |   72102 K  |   72102 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     213    |     725    |    1235    |    1022    |
|       from large pool |     193    |     699    |    1203    |    1010    |
|       from small pool |      20    |      26    |      32    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1249    |   72951 K  |   72951 K  |
|       from large pool |       4    |     469    |   41849 K  |   41849 K  |
|       from small pool |       0    |    1067    |   31101 K  |   31101 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug  4 01:48:52 2024]
Finished job 0.
1 of 1 steps (100%) done
