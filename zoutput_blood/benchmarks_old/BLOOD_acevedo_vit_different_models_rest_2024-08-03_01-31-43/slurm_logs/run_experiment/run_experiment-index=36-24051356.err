Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug  3 01:34:53 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/11.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=11
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051356

 Experiment start at: 2024-08-03 01:49:06.129468
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.044287413358688354
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9188249, 'precision': 0.82315516, 'recall': 0.7206493, 'specificity': 0.99102724, 'f1': 0.7553909, 'auroc': 0.99096775}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   263     0   0    35    0    1    68     5    16   36     59
1     0  1144   0    30    0    0     0   146     6    0      6
2     0     0  81    13   34    8     3    40    26  103      4
3     0     0   0  8227    0    3     0   136    72    0      0
4     0     0  33     8  191    6     3     8   104   17    169
5     1     0   1   113    0  357     0     0     4   44      1
6     4     0   0    39    0    1  1822     8    14    5     15
7     0     1   0   496    1    0     1  6683    71    0     11
8     1     0   3   361    6    2     4    70  2833    0     15
9     1     0  22    51    1  141     1     2     7  266      1
10   13     0   2    19   29    2    49    33   168    1  12475
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.919005, 'precision': 0.82537186, 'recall': 0.7215791, 'specificity': 0.9910328, 'f1': 0.7569769, 'auroc': 0.9911079}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   262     0   0    45    0    0    66     5    20   29     56
1     0  1131   0    30    0    0     0   152     9    0     10
2     0     1  84    18   37    7     0    36    24  100      5
3     0     0   0  8234    0    5     0   133    68    0      0
4     0     0  34     8  195    9     5     8    99   17    164
5     1     0   0   112    0  354     0     0     4   49      1
6     6     0   0    36    0    2  1824     9    12    5     14
7     0     2   0   507    2    0     2  6667    73    0     12
8     0     0   1   358    2    0     4    59  2841    4     27
9     0     0  22    49    0  138     1     2    10  270      1
10   13     0   5    17   26    2    47    32   155    4  12495
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.60134333, 'precision': 0.61695856, 'recall': 0.4968047, 'specificity': 0.9610174, 'f1': 0.49145165, 'auroc': 0.86186045}
confusion matrix:
     0    1   2    3    4    5     6    7     8    9     10
0   509    0   0  374    0    5   110   26    51   90     5
1     0  967   0   85    1    0     3  406    15    0    22
2     2    1  25  120  106   85     7   53   500   57    59
3     0    0   0    0    0    0     0    0     0    0     0
4     2    1   0    2  278    0     2    4    60    1  1283
5     0    0   0  208    0  357     2    0     3   22     0
6     0    0   0   46    4    0  2650    4   310    0    53
7     0    0   1  270    0    0     2  888     0    0     3
8     0    0   0  271    0    1     0    2  1096    0     0
9     1    5  25  461   13  288     0   46    96  188    14
10    0    0   0    0    6    0     1    0     2    0  1637
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 03:07:42.910216,epoch time: 1:18:36.780748,used: 1:18:36.780748,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051356
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9399615, 'precision': 0.8611476, 'recall': 0.7801558, 'specificity': 0.9932448, 'f1': 0.81091845, 'auroc': 0.99192274}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   376     0    0    14    0    0     3     4    14    9     63
1     0  1216    0    20    0    0     0    75    10    0     11
2     1     0  130     4   63    2     1    13    24   65      9
3     0     0    0  8211    0    4     0    98   126    0      0
4     1     0   10     2  218    0     0     3    55   13    237
5     0     0    1    67    0  325     1     0    11  115      1
6    43     0    0    14    1    1  1762     4    11    3     69
7     0     3    2   345    1    0     2  6818    67    0     24
8     1     0    3   120    4    0     0    63  3055    1     48
9     1     0   38    20    2   64     0     3    21  341      3
10   14     0    0     7    8    0     3    15    61    4  12680
---- Validation: 
scalar performance:
{'acc': 0.9397084, 'precision': 0.86348975, 'recall': 0.77966833, 'specificity': 0.99320996, 'f1': 0.8105503, 'auroc': 0.99219257}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   374     0    0    15    0    0     4     3     7    7     73
1     0  1221    0    20    0    0     0    78     4    0      9
2     2     0  130     6   62    3     0    20    24   51     14
3     0     1    0  8189    0    7     0    98   143    2      0
4     2     0   13     2  195    0     0     3    57   10    257
5     0     0    0    65    0  330     0     0    10  115      1
6    43     0    0    17    1    0  1767     5     9    2     64
7     0     4    0   330    1    0     2  6839    71    0     18
8     1     0    2   116    3    2     0    68  3073    1     30
9     1     0   34    23    2   55     0     5    18  352      3
10   14     0    0    11    8    1     8    11    79    3  12661
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6808228, 'precision': 0.6327145, 'recall': 0.57979816, 'specificity': 0.9681351, 'f1': 0.5623776, 'auroc': 0.8535928}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   965     1   0   59    1    0     2    33    68   37     4
1     0  1109   1   38    2    0     2   303    14    0    30
2    10     0  75   42  134   13     0    35   398  142   166
3     0     0   0    0    0    0     0     0     0    0     0
4     2     0   0    0   62    0     1     2    16    1  1549
5     1     0   0  143    0  307     0     0    14  125     2
6     2     0   0    9    2    0  2720     4    65    0   265
7     0     0   1   99    0    0     1  1057     1    2     3
8     0     0   0  106    0    2     1     8  1247    5     1
9     6     3  62  143   12   86     1    46   211  543    24
10    0     0   0    0    0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 04:23:48.020748,epoch time: 1:16:05.110532,used: 2:34:41.891280,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051356
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9495933, 'precision': 0.87120056, 'recall': 0.81270546, 'specificity': 0.99443567, 'f1': 0.8315392, 'auroc': 0.9958047}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   432     0    0     3    0    0     3     3     5    3     33
1     0  1283    0    13    0    0     0    32     4    0      0
2     2     0  171     4   55    9     1    25    10   27      8
3     0     1    0  8073    0    4     2   294    65    0      0
4     6     1   15     2  263    1     1     5    43    6    196
5     3     0    0    59    0  435     0     0     5   17      1
6    10     0    0     5    0    1  1861     6     6    0     18
7     0    11    0   110    1    0     1  7090    45    0      5
8     1     1    4   138    2    1     0    79  3041    0     29
9     2     1   71    26    1  185     0     5    11  191      0
10   17     7    1     9   13    2     9    17    66    0  12652
---- Validation: 
scalar performance:
{'acc': 0.9472783, 'precision': 0.86492515, 'recall': 0.80749226, 'specificity': 0.99419177, 'f1': 0.8252344, 'auroc': 0.9959323}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   423     0    0     7    0    0     3     5     3    3     39
1     0  1277    0    14    0    0     0    37     3    0      1
2     2     0  171     6   58    7     1    22    14   29      2
3     0     0    0  8059    0    2     0   307    70    0      2
4     7     1   16     5  256    2     1     8    49    3    191
5     0     0    1    56    0  441     0     0     4   17      2
6    19     0    1     3    0    0  1853     5     6    0     21
7     0    12    0   112    1    0     2  7083    49    0      6
8     2     1    3   143    3    0     0    92  3027    0     25
9     5     0   69    23    0  196     1     4    11  183      1
10   24     2    2    14   16    1     6    18    72    0  12641
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69733435, 'precision': 0.6221201, 'recall': 0.5903293, 'specificity': 0.9699135, 'f1': 0.5480717, 'auroc': 0.8725519}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1099     0   0   19    0    3     5     6    30    4     4
1      1  1322   0   30    0    0     1   122     9    0    14
2     22     1  38   50  168   79     7    24   397   15   214
3      0     0   0    0    0    0     0     0     0    0     0
4      3     1   0    0   78    0     2     1    23    0  1525
5      9     0   0  164    0  410     0     0     2    5     2
6      0     0   0    6    0    0  2943     3    13    0   102
7      1     0   0   56    0    0     4  1094     8    0     1
8      0     0   0  153    0    1     1     4  1210    1     0
9     42     6  68  221   16  338     1    30   263  128    24
10     0     0   0    0    0    0     0     0     1    0  1645
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-03 05:35:45.309244,epoch time: 1:11:57.288496,used: 3:46:39.179776,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051356
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9581282, 'precision': 0.891067, 'recall': 0.8660883, 'specificity': 0.99548733, 'f1': 0.8762506, 'auroc': 0.99689627}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    0     1    0    0     6     3     1    1     42
1     1  1278    0     8    0    0     1    36     6    0      2
2     1     0  194     2   30    1     2     6     5   69      1
3     2     2    0  8030    0    8     5   236   155    0      0
4     4     0   29     0  347    1     1     8    19    4    126
5     1     0    0    20    0  383     1     0     8  106      2
6     7     0    0     0    1    0  1881     4     4    2      8
7     2     8    1    97    2    0     2  7105    39    0      7
8     2     0    2    33    6    0     1    64  3165    1     22
9     6     0   25    12    0   37     2     2     7  402      0
10    9     0    1     7   85    0    23    22    46    3  12597
---- Validation: 
scalar performance:
{'acc': 0.9581115, 'precision': 0.8892945, 'recall': 0.8657863, 'specificity': 0.99549794, 'f1': 0.8751615, 'auroc': 0.9969168}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   428     0    0     1    1    0     2     5     2    1     43
1     0  1279    0     6    0    0     2    39     6    0      0
2     1     0  190     2   32    0     3     5     6   71      2
3     4     2    0  8040    0    9     8   228   149    0      0
4     5     0   37     0  357    0     1     9    23    5    102
5     2     0    1    27    0  378     0     0     5  107      1
6    12     0    0     0    1    0  1876     2     2    1     14
7     3     8    1    98    1    0     2  7104    44    1      3
8     1     0    2    38    5    2     1    89  3133    2     23
9     5     0   21    11    0   34     0     1    11  409      1
10    8     0    3     6   80    1    14    21    37    1  12625
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7579235, 'precision': 0.6914526, 'recall': 0.6346723, 'specificity': 0.97567433, 'f1': 0.62942696, 'auroc': 0.8844158}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1112     0    0    4    0    0    22     6    12    7     7
1      3  1240    1   23    0    0    12   195     7    1    17
2     25     2  136   11  246    3    39    53   300   98   102
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    2    0  460    0    32     2    22    0  1113
5     15     0    0  148    0  251     3     0    15  156     4
6      0     0    0    1    0    0  3063     2     0    0     1
7      0     0    0   17    0    0     3  1140     0    1     3
8      0     0    0   74    0    0     5    13  1275    3     0
9     30     7  106  126   14   48     9    55   187  535    20
10     0     0    0    0   18    0     7     0     0    0  1621
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-03 06:45:17.701220,epoch time: 1:09:32.391976,used: 4:56:11.571752,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051356
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9587168, 'precision': 0.8977517, 'recall': 0.85590714, 'specificity': 0.99537325, 'f1': 0.87194985, 'auroc': 0.99699295}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    0     1    0    1     4     1     0    1     50
1     0  1288    0     9    0    0     0    27     5    0      2
2     3     0  195     1   31    1     1     4     5   63      8
3     1     1    0  8101    0   14     0   194   123    1      1
4     4     0   31     1  265    0     0     6    13    6    213
5     2     0    0    18    0  417     0     0     7   76      1
6    13     0    1     2    0    0  1844     9     1    1     37
7     4    15    3   100    1    0     1  7026    86    1     24
8     2     0    5    47    6    3     0    43  3135    3     52
9     3     0   26     2    0   55     0     1     5  399      2
10    8     1    1     7   15    0     1     6    16    3  12738
---- Validation: 
scalar performance:
{'acc': 0.95856625, 'precision': 0.89981836, 'recall': 0.8558954, 'specificity': 0.9953747, 'f1': 0.8734076, 'auroc': 0.9970159}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   424     0    0     1    0    0     2     4     1    2     49
1     0  1291    0     9    0    0     0    27     3    0      2
2     4     0  196     0   33    2     1     6     3   63      4
3     0     1    1  8087    0   14     1   212   122    1      1
4     4     0   19     1  285    0     0     6    16    7    201
5     1     0    0    18    0  415     0     0     7   79      1
6     8     0    1     1    1    0  1855     6     5    0     31
7     3    15    3   101    2    0     1  7029    89    2     20
8     4     0    3    45    4    0     0    53  3130    2     55
9     6     1   23     3    0   69     0     1     9  380      1
10   11     0    1     7   12    0     2     4    13    2  12744
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71146715, 'precision': 0.65992004, 'recall': 0.5952988, 'specificity': 0.97085655, 'f1': 0.57705927, 'auroc': 0.8643867}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   969     1   0   13    0    2   104    11    34   20    16
1     3  1291   0   32    0    0    19   117    11    2    24
2    16     4  49   18  120   15    49    10   330   86   318
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  101    0     3     1    11    1  1516
5     7     0   0  132    0  319     6     0     8  115     5
6     0     0   0    2    0    0  3038     0     6    0    21
7     0     0   0   32    0    0    17  1096    11    1     7
8     0     0   0  129    0    0    11     2  1222    1     5
9    16     9  33  155    9  104    40    23   274  440    34
10    0     0   0    0    2    0     0     0     0    0  1644
better model found
persisted
after epoch: 5,now: 2024-08-03 07:53:26.152514,epoch time: 1:08:08.451294,used: 6:04:20.023046,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051356
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9587436, 'precision': 0.8794992, 'recall': 0.8786143, 'specificity': 0.99553263, 'f1': 0.8783833, 'auroc': 0.99732053}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     0    0     4    0    1    10     0     2    4     41
1     0  1317    0     5    0    0     0     7     2    0      1
2     2     1  217     0   46    1     1     1     1   41      1
3     0     6    3  8267    1   24     8    98    31    1      0
4     2     1   21     0  387    0     3     3     7    7    108
5     0     0    0     9    0  450     0     0     2   59      1
6     7     0    1     1    2    0  1870     1     1    2     21
7     1   146    4   142    5    0     6  6909    34    1     15
8     1     6   17   152   28    8     3    51  2942   13     75
9     0     0   47     2    2   77     2     0     2  360      1
10    8     0    2     7   58    1     2     5    12    3  12694
---- Validation: 
scalar performance:
{'acc': 0.9570951, 'precision': 0.8775185, 'recall': 0.8764822, 'specificity': 0.9953375, 'f1': 0.87627935, 'auroc': 0.99746513}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    0     1    0    0     7     0     1    4     45
1     0  1309    0     6    1    0     1    10     2    0      3
2     1     0  212     0   44    1     1     0     1   50      2
3     0     9    1  8273    0   27    10    84    33    3      0
4     3     2   23     1  373    2     0     2     3    7    123
5     0     0    0     8    0  441     0     0     2   69      1
6     9     0    1     0    0    0  1872     0     4    1     21
7     0   161    6   146    6    0    12  6885    31    2     16
8     2     7   11   176   37    7     6    60  2908    7     75
9     2     0   46     1    1   59     0     1     0  383      0
10   12     0    2     9   53    1     3     8     6    2  12700
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7535857, 'precision': 0.69155025, 'recall': 0.6491883, 'specificity': 0.97527087, 'f1': 0.6463826, 'auroc': 0.8675469}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1049     1    0    5    1    3    18     4    16   55    18
1      2  1341    0   26    1    1     3    75     3    7    40
2      4     5  168   17  314   16    12     5   128  115   231
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    3    0  251    0     2     0     5    1  1371
5      2     0    0   45    1  413     1     0     0  128     2
6      0     0    0    2    1    0  3013     0     0    1    50
7      0     0    1   79    0    1    14  1055     6    2     6
8      0     0    0  193    1    4     6     3  1143   11     9
9      1     4  133   70   16  123     4     7    53  697    29
10     0     0    0    0    5    0     0     0     0    0  1641
early stop counter: 1
val acc:0.9570950865745544, best validation acc: 0.9585662484169006, corresponding to test acc:                         0.7114671468734741 / 0.7579234838485718
after epoch: 6,now: 2024-08-03 09:02:16.332439,epoch time: 1:08:50.179925,used: 7:13:10.202971,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051356
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9646565, 'precision': 0.89303637, 'recall': 0.88678074, 'specificity': 0.996264, 'f1': 0.88873714, 'auroc': 0.9982015}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     0    0     1    0    0    28     0     2    0     22
1     0  1303    1     9    0    0     1    13     3    0      2
2     4     0  215     0   58    0     1     3     1   30      0
3     0     1    2  8250    0   17     2    62   103    2      0
4     6     0   13     0  406    0     3     1    14    3     92
5     2     0    2     7    0  387     2     0     4  116      1
6     4     0    0     2    1    0  1890     0     1    0      8
7     2    36    0   145    7    0     3  6922   117    0     31
8     2     0    2    35    7    3     5    18  3200    0     23
9     5     0   50     2    0   24     3     1     5  403      0
10   18     0    0     7   80    0    17     2    21    0  12649
---- Validation: 
scalar performance:
{'acc': 0.96399623, 'precision': 0.8928133, 'recall': 0.88709545, 'specificity': 0.996203, 'f1': 0.888224, 'auroc': 0.9982337}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    0     1    1    0    24     0     0    1     21
1     0  1304    1     6    0    0     1    14     4    0      2
2     3     0  203     0   63    0     1     2     5   34      1
3     2     2    1  8238    1   22     5    58   108    2      1
4     7     0   14     0  412    0     3     1    16    1     85
5     3     0    3     9    0  384     1     0     6  114      1
6     6     0    0     1    0    0  1888     1     4    0      8
7     4    33    3   159    7    0     6  6909   114    1     29
8     1     0    3    32   10    1     3    20  3203    0     23
9     2     0   44     4    2   13     2     0     7  419      0
10   15     0    1     7   76    0    25     1    26    1  12644
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71048766, 'precision': 0.6477491, 'recall': 0.5805608, 'specificity': 0.9702953, 'f1': 0.58462286, 'auroc': 0.86879474}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   938     0    0    3    0    0   204    1    15    5     4
1     3  1285    0   32    2    0    45   86     7    7    32
2    21     2   62    9  376    4   139    3   223   71   105
3     0     0    0    0    0    0     0    0     0    0     0
4     1     0    0    0  363    0    40    0    22    0  1207
5    20     0    0   54    2  219    39    0     3  254     1
6     0     0    0    1    0    0  3066    0     0    0     0
7     0     0    1  263    1    0    53  828    13    2     3
8     0     0    0   86    0    1    80    0  1201    2     0
9    42     3  119   45   45   47   108    9   137  566    16
10    0     0    0    0   12    0     6    0     1    0  1627
better model found
persisted
after epoch: 7,now: 2024-08-03 10:09:49.313332,epoch time: 1:07:32.980893,used: 8:20:43.183864,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051356
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96687716, 'precision': 0.9165792, 'recall': 0.8854801, 'specificity': 0.9964262, 'f1': 0.89768994, 'auroc': 0.9982725}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     1    0    0    11     0     1    3     14
1     0  1300    0    12    0    0     0    14     5    0      1
2     1     0  209     0   29    3     1     4    13   51      1
3     0     2    0  8255    1   14     0    68    95    1      1
4     3     0   15     1  344    0     4     4    36    1    131
5     0     0    0    14    0  474     0     0     4   28      1
6     6     0    0     2    1    0  1887     0     3    0      9
7     1    15    0   161    2    0     1  6978    97    0      8
8     2     0    3    41    4    0     2    31  3200    0     13
9     0     0   14     3    0  109     1     0    12  354      0
10   15     0    1     7   19    1    16     7    42    0  12685
---- Validation: 
scalar performance:
{'acc': 0.96707237, 'precision': 0.916367, 'recall': 0.8832303, 'specificity': 0.99645054, 'f1': 0.8964361, 'auroc': 0.9985481}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    0     3    1    0    17     2     3    4     13
1     0  1298    0     8    0    0     1    18     6    0      1
2     1     0  210     1   28    4     0     4    16   48      0
3     0     1    0  8240    0   12     0    80   106    1      0
4     3     0   16     1  341    0     2     3    37    2    134
5     1     0    0    17    0  472     1     0     3   26      1
6     5     0    0     0    1    0  1890     1     1    1      9
7     0    15    0   154    1    1     6  6998    83    1      6
8     1     0    1    31    2    3     0    27  3218    1     12
9     0     0   20     4    2  104     0     0     7  355      1
10   16     0    1     6   14    0    13     7    45    2  12692
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7184636, 'precision': 0.67066544, 'recall': 0.5998663, 'specificity': 0.9714487, 'f1': 0.59312624, 'auroc': 0.8631307}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1028     0   0   17    0    0    86    4    12   21     2
1      4  1292   0   37    0    0    23  102    12   14    15
2     16     1  91   14  160    7   160    9   322  111   124
3      0     0   0    0    0    0     0    0     0    0     0
4      2     0   2    0  166    0    41    0    28    1  1393
5      8     0   0  101    0  294     7    0     3  177     2
6      0     0   0    2    0    0  3065    0     0    0     0
7      0     0   1  202    0    0    48  882    11   17     3
8      0     0   0  112    0    2    55    1  1185   11     4
9     15     4  45   95   12  118    36   11   150  630    21
10     0     0   0    0    3    0     6    0     1    0  1636
better model found
persisted
after epoch: 8,now: 2024-08-03 11:16:37.081777,epoch time: 1:06:47.768445,used: 9:27:30.952309,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051356
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96984696, 'precision': 0.91440195, 'recall': 0.9085096, 'specificity': 0.9967552, 'f1': 0.9109961, 'auroc': 0.99833286}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     3    1    0     1     4     2    5     13
1     0  1273    0     8    0    0     0    48     1    0      1
2     0     0  235     2   14    0     0    13     0   47      0
3     0     0    0  8238    0    4     0   152    39    4      0
4     6     0   37     0  422    1     0     6     9    6     52
5     0     0    0    11    0  441     0     0     3   65      1
6    15     0    2     5    1    0  1861     6     3    1     14
7     0     5    0    59    1    0     1  7189     6    0      4
8     0     0    4    44    5    0     0   142  3074    2     25
9     0     0   23     3    0   42     0     3     3  419      0
10   13     0    2     8   84    0     2    17    21    2  12643
---- Validation: 
scalar performance:
{'acc': 0.97060317, 'precision': 0.91760445, 'recall': 0.9111671, 'specificity': 0.99682957, 'f1': 0.91401637, 'auroc': 0.9985938}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    0     1    2    0     3     3     0    4     20
1     0  1278    0     7    0    0     0    45     1    0      1
2     0     0  234     1   11    2     0    13     3   47      1
3     0     0    1  8239    0    5     0   154    41    0      0
4     4     0   34     1  431    1     0     8     7    4     49
5     0     0    0    15    0  445     0     0     5   55      1
6    13     0    2     6    2    1  1853     6     3    2     20
7     0     4    1    61    1    0     1  7187     6    0      4
8     1     0    4    30   10    0     0   138  3094    0     19
9     0     0   19     3    0   38     0     5     2  426      0
10   17     0    2     6   86    1     1    14    19    1  12649
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7338557, 'precision': 0.6937822, 'recall': 0.62154365, 'specificity': 0.97354436, 'f1': 0.6280238, 'auroc': 0.86423063}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   970     0    1   28    1    1     7    32     8  120     2
1     0  1151    0   32    1    0     0   290     4    2    19
2     4     1  277   23  209   10     0    71   197  113   110
3     0     0    0    0    0    0     0     0     0    0     0
4     2     0    4    0  447    0     1     4    15    1  1159
5     0     0    0  121    2  271     0     0     7  189     2
6     0     0    0    8    4    0  2903     7    50    1    94
7     1     0    0   56    0    0     0  1103     0    1     3
8     0     0    0  149    0    0     2    30  1185    4     0
9     1     3  125  171    4   65     0   117    75  555    21
10    0     0    0    0   19    0     0     0     0    0  1627
better model found
persisted
after epoch: 9,now: 2024-08-03 12:22:47.569310,epoch time: 1:06:10.487533,used: 10:33:41.439842,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051356
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9694189, 'precision': 0.90713876, 'recall': 0.9157918, 'specificity': 0.9967457, 'f1': 0.90947545, 'auroc': 0.9988551}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   428     0    1     0    1    0    11     0     2    4     36
1     0  1303    1     3    0    0     0    21     4    0      0
2     0     0  284     0    6    0     0     2     1   19      0
3     1     0    2  8059    0   10     4   253   106    3      1
4     1     0   57     0  422    0     0     1     1    1     56
5     0     0    2     2    0  446     0     0     3   67      1
6     5     0    1     0    2    0  1876     0     0    1     23
7     2     7    6    27    3    0     9  7168    31    0     12
8     0     0    9    16    5    1     1    33  3204    0     26
9     0     0   59     0    0   51     0     1     1  381      0
10    4     0    4     5   93    0     3     6    11    1  12662
---- Validation: 
scalar performance:
{'acc': 0.9701217, 'precision': 0.9111463, 'recall': 0.91880953, 'specificity': 0.9968196, 'f1': 0.9134295, 'auroc': 0.99897534}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     1    1     0    2    0    14     0     0    3     37
1     0  1297    0     7    0    0     1    23     3    0      1
2     0     0  281     0    8    0     1     4     0   18      0
3     4     0    1  8060    0   17     2   247   107    2      0
4     2     0   51     1  434    1     0     0     2    1     47
5     0     0    1     6    0  446     0     0     6   61      1
6     3     0    1     1    6    0  1875     2     0    0     20
7     4     5    0    31    3    0     8  7171    34    0      9
8     0     0    8    11   10    1     0    30  3206    2     28
9     0     0   59     2    1   31     0     2     1  396      1
10    6     0    4     3   88    0     3     5     9    1  12677
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74952775, 'precision': 0.6781512, 'recall': 0.6271929, 'specificity': 0.9746916, 'f1': 0.6312082, 'auroc': 0.8742635}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   958     0    1    7    1    3   118     4     6   47    25
1     0  1236    1   15    1    0     9   194     7    3    33
2     0     2  301    5  333    6    33    22   185   46    82
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    4    0  480    0    11     1    14    0  1123
5     1     0    8  117    4  248     4     0    14  193     3
6     0     0    0    1    0    0  3058     1     2    0     5
7     0     1    0    4    0    0    10  1144     0    1     4
8     0     0    1   73    2    0    18    24  1246    5     1
9     2     3  316   86   15   55    16    63   132  428    21
10    0     0    0    0   30    0     2     0     0    0  1614
early stop counter: 1
val acc:0.9701216816902161, best validation acc: 0.9706031680107117, corresponding to test acc:                         0.7338557243347168 / 0.7579234838485718
after epoch: 10,now: 2024-08-03 13:29:27.710583,epoch time: 1:06:40.141273,used: 11:40:21.581115,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051356
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 11:40:21.581115 at 2024-08-03 13:29:27.710583
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7338557, 'precision': 0.6937822, 'recall': 0.62154365, 'specificity': 0.97354436, 'f1': 0.6280238, 'auroc': 0.86423063}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   970     0    1   28    1    1     7    32     8  120     2
1     0  1151    0   32    1    0     0   290     4    2    19
2     4     1  277   23  209   10     0    71   197  113   110
3     0     0    0    0    0    0     0     0     0    0     0
4     2     0    4    0  447    0     1     4    15    1  1159
5     0     0    0  121    2  271     0     0     7  189     2
6     0     0    0    8    4    0  2903     7    50    1    94
7     1     0    0   56    0    0     0  1103     0    1     3
8     0     0    0  149    0    0     2    30  1185    4     0
9     1     3  125  171    4   65     0   117    75  555    21
10    0     0    0    0   19    0     0     0     0    0  1627
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7579235, 'precision': 0.6914526, 'recall': 0.6346723, 'specificity': 0.97567433, 'f1': 0.62942696, 'auroc': 0.8844158}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1112     0    0    4    0    0    22     6    12    7     7
1      3  1240    1   23    0    0    12   195     7    1    17
2     25     2  136   11  246    3    39    53   300   98   102
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    2    0  460    0    32     2    22    0  1113
5     15     0    0  148    0  251     3     0    15  156     4
6      0     0    0    1    0    0  3063     2     0    0     1
7      0     0    0   17    0    0     3  1140     0    1     3
8      0     0    0   74    0    0     5    13  1275    3     0
9     30     7  106  126   14   48     9    55   187  535    20
10     0     0    0    0   18    0     7     0     0    0  1621
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_49_04_seed_0_24051356_instance_wise_predictions.txt
accuracy from prediction file 0.7338557335758763
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/11.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4043 MiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |   4020 MiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |     23 MiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   4043 MiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |   4020 MiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |     23 MiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4036 MiB |  28168 MiB |   1089 TiB |   1089 TiB |
|       from large pool |   4013 MiB |  28119 MiB |   1082 TiB |   1082 TiB |
|       from small pool |     22 MiB |     49 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  29180 MiB |  29180 MiB |  29180 MiB |      0 B   |
|       from large pool |  29128 MiB |  29128 MiB |  29128 MiB |      0 B   |
|       from small pool |     52 MiB |     52 MiB |     52 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 531037 KiB |   1608 MiB | 225866 GiB | 225866 GiB |
|       from large pool | 515792 KiB |   1606 MiB | 218788 GiB | 218787 GiB |
|       from small pool |  15245 KiB |     22 MiB |   7078 GiB |   7078 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3670    |    5393    |   69676 K  |   69672 K  |
|       from large pool |     502    |    1018    |   33625 K  |   33625 K  |
|       from small pool |    3168    |    4690    |   36051 K  |   36047 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3670    |    5393    |   69676 K  |   69672 K  |
|       from large pool |     502    |    1018    |   33625 K  |   33625 K  |
|       from small pool |    3168    |    4690    |   36051 K  |   36047 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     725    |     725    |     725    |       0    |
|       from large pool |     699    |     699    |     699    |       0    |
|       from small pool |      26    |      26    |      26    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     219    |    1249    |   36403 K  |   36403 K  |
|       from large pool |     182    |     469    |   21026 K  |   21026 K  |
|       from small pool |      37    |    1067    |   15376 K  |   15376 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |  16640 KiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |      0 KiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |  16640 KiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |      0 KiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  28168 MiB |   1089 TiB |   1089 TiB |
|       from large pool |  16640 KiB |  28119 MiB |   1082 TiB |   1082 TiB |
|       from small pool |      0 KiB |     49 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4562 MiB |  29180 MiB |  29180 MiB |  24618 MiB |
|       from large pool |   4524 MiB |  29128 MiB |  29128 MiB |  24604 MiB |
|       from small pool |     38 MiB |     52 MiB |     52 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1608 MiB | 225868 GiB | 225868 GiB |
|       from large pool | 134912 KiB |   1606 MiB | 218790 GiB | 218790 GiB |
|       from small pool |      0 KiB |     32 MiB |   7078 GiB |   7078 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |   69676 K  |   69676 K  |
|       from large pool |       2    |    1018    |   33625 K  |   33625 K  |
|       from small pool |       0    |    4690    |   36051 K  |   36051 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |   69676 K  |   69676 K  |
|       from large pool |       2    |    1018    |   33625 K  |   33625 K  |
|       from small pool |       0    |    4690    |   36051 K  |   36051 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     211    |     725    |     725    |     514    |
|       from large pool |     192    |     699    |     699    |     507    |
|       from small pool |      19    |      26    |      26    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1249    |   36404 K  |   36404 K  |
|       from large pool |       4    |     469    |   21026 K  |   21026 K  |
|       from small pool |       0    |    1067    |   15377 K  |   15377 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |  16640 KiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |      0 KiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |  16640 KiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |      0 KiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  28168 MiB |   1089 TiB |   1089 TiB |
|       from large pool |  16640 KiB |  28119 MiB |   1082 TiB |   1082 TiB |
|       from small pool |      0 KiB |     49 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4562 MiB |  29180 MiB |  29180 MiB |  24618 MiB |
|       from large pool |   4524 MiB |  29128 MiB |  29128 MiB |  24604 MiB |
|       from small pool |     38 MiB |     52 MiB |     52 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1608 MiB | 225868 GiB | 225868 GiB |
|       from large pool | 134912 KiB |   1606 MiB | 218790 GiB | 218790 GiB |
|       from small pool |      0 KiB |     32 MiB |   7078 GiB |   7078 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |   69676 K  |   69676 K  |
|       from large pool |       2    |    1018    |   33625 K  |   33625 K  |
|       from small pool |       0    |    4690    |   36051 K  |   36051 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |   69676 K  |   69676 K  |
|       from large pool |       2    |    1018    |   33625 K  |   33625 K  |
|       from small pool |       0    |    4690    |   36051 K  |   36051 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     211    |     725    |     725    |     514    |
|       from large pool |     192    |     699    |     699    |     507    |
|       from small pool |      19    |      26    |      26    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1249    |   36404 K  |   36404 K  |
|       from large pool |       4    |     469    |   21026 K  |   21026 K  |
|       from small pool |       0    |    1067    |   15377 K  |   15377 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051356

 Experiment start at: 2024-08-03 13:47:35.479011
before training, model accuracy: 0.06926468014717102
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9259953, 'precision': 0.8397566, 'recall': 0.741879, 'specificity': 0.99162126, 'f1': 0.7723225, 'auroc': 0.98979276}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   243     0    1     8    1    0    61     7    10    7    145
1     0  1195    1    22    0    0     0   105     1    0      5
2     2     0  183     2   24    2     7    21    15   40     16
3     3     0    1  8092    0   23     8   218    92    2      0
4     0     1   55     3  142    2    12     9    64   11    240
5     0     0    8    61    1  349     0     0     5   94      2
6     4     1    1     5    1    0  1840     4    11    6     35
7     3     5    0   311    1    0     4  6851    58    3     28
8     1     0    5   266    2    2     8    95  2808    0    109
9     1     0   91    11    3   88     5     5    17  261     10
10    1     0    1     9    8    2    20    45    62    0  12646
---- Validation: 
scalar performance:
{'acc': 0.92654806, 'precision': 0.8420819, 'recall': 0.7463108, 'specificity': 0.9916903, 'f1': 0.774904, 'auroc': 0.9898784}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   240     0    1    12    0    0    77     8     5    7    133
1     0  1200    0    19    0    0     0   101     4    0      8
2     3     0  191     2   22    4     3    21    18   38     10
3     3     0    1  8095    0   21     6   214    97    2      1
4     0     1   55     3  135    1    12    12    52   11    257
5     0     0    6    58    0  351     0     0     8   97      1
6     2     0    0     5    1    1  1848     7     7    5     32
7     8     3    0   335    2    0     4  6825    63    1     24
8     1     3    7   252    5    3     9    87  2827    1    101
9     0     0   91    14    1   83     1     7    10  277      9
10    1     0    1     9    7    1    33    43    48    3  12650
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64199257, 'precision': 0.58878005, 'recall': 0.5469216, 'specificity': 0.9640951, 'f1': 0.5168859, 'auroc': 0.8438821}
confusion matrix:
     0    1    2    3   4    5     6     7     8    9     10
0   830    0    0   46   0    1   148    17    19   25    84
1     0  919    0   72   0    0     6   458     6    0    38
2     5    0   63   44  84   37    67    78   445   58   134
3     0    0    0    0   0    0     0     0     0    0     0
4     0    0    1    0  49    0    12     5    33    0  1533
5     5    0    0   76   0  416    12     0    14   69     0
6     0    0    0   80   0    0  2761    10   157    0    59
7     0    0    0   37   0    0     4  1119     0    1     3
8     0    0    0  203   0    3    11     8  1140    2     3
9    20    0  110  203   9  185    47    93   214  234    22
10    0    0    0    0   0    0     1     0     0    0  1645
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 14:55:34.235395,epoch time: 1:07:58.756384,used: 1:07:58.756384,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051356
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9430116, 'precision': 0.8728201, 'recall': 0.7993231, 'specificity': 0.99356925, 'f1': 0.81997615, 'auroc': 0.9940094}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   387     0    0    12    0    0    10    16     5    6     47
1     0  1259    0    15    0    0     0    54     3    0      1
2     6     2  182     1   15    1     3    26    11   54     11
3     0     0    0  8125    0   18     0   216    76    2      0
4     2     3   67     1  133    1     7    12    42   13    258
5     3     0    2    40    0  398     0     0     5   72      1
6     8     0    0    18    0    1  1849     6     4    2     20
7     0    16    0   202    1    1     1  7011    25    0      5
8     2     1    3   193    1    4     1   135  2887    3     65
9     6     1   44     9    1   72     2     8     5  339      6
10   13     1    3     9    3    1    14    44    29    1  12676
---- Validation: 
scalar performance:
{'acc': 0.9433998, 'precision': 0.87786466, 'recall': 0.80075765, 'specificity': 0.99358165, 'f1': 0.8227142, 'auroc': 0.9940671}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   387     0    1    12    0    0    10    16     1    0     56
1     0  1258    0    14    0    0     0    56     1    0      3
2     7     2  181     0   14    3     3    30     6   50     16
3     0     1    1  8124    1   19     1   217    75    1      0
4     4     2   60     3  131    2     7    12    41   14    263
5     1     0    1    38    0  403     0     0     5   72      1
6     6     1    0    15    0    0  1853     5     6    4     18
7     0    14    0   202    1    1     1  7016    24    0      6
8     1     3    3   173    1    2     3   155  2885    1     69
9     9     0   40     9    0   68     4     8     4  345      6
10    9     1    2     9    3    0    14    42    27    3  12686
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7010425, 'precision': 0.61541766, 'recall': 0.5864573, 'specificity': 0.9698108, 'f1': 0.56759655, 'auroc': 0.8515555}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   963     5    0   39   0    0    95    36    12    6    14
1     0  1287    0   30   0    0     2   167     0    0    13
2    13    12  127   15  41   10    81    79   207   96   334
3     0     0    0    0   0    0     0     0     0    0     0
4     1     1    0    0  13    0     6     2     8    0  1602
5    18     0    3   64   0  294    14     2     6  189     2
6     0     0    0   24   0    0  3021     6     1    0    15
7     0     1    0   19   0    0     1  1140     0    1     2
8     0     0    1  176   0    2    11    29  1133    2    16
9    27    24  230  106   0   48    61   122    91  396    32
10    0     0    0    0   0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 16:02:32.561358,epoch time: 1:06:58.325963,used: 2:14:57.082347,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051356
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.949192, 'precision': 0.87202203, 'recall': 0.81136084, 'specificity': 0.99448436, 'f1': 0.8331977, 'auroc': 0.9956321}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   397     0    0    13    0    1     9     5     7    3     48
1     0  1204    0    15    0    0     0   104     5    0      4
2     0     0  125     1   54    4     1    23    26   76      2
3     0     0    0  8205    0   15     1   120    97    0      0
4     4     0    9     0  319    1     2     6    66   11    121
5     0     0    3    35    0  445     0     0     9   27      1
6    10     0    0     8    1    1  1859     4     4    3     18
7     0     3    0   196    1    0     1  6990    67    1      6
8     1     0    2   121    0    2     0    85  3069    0     16
9     0     0   20     8    1  169     0    10    22  259      4
10   10     0    2     9   56    2     9    21    76    0  12605
---- Validation: 
scalar performance:
{'acc': 0.94904375, 'precision': 0.87284434, 'recall': 0.8152263, 'specificity': 0.9944676, 'f1': 0.8360066, 'auroc': 0.995622}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   393     1    0    12    0    1     8     5     7    3     53
1     0  1204    0    15    0    0     0   106     3    0      4
2     0     0  123     3   62    4     0    27    29   62      2
3     1     0    0  8187    0   15     0   126   110    1      0
4     4     0   13     0  325    3     1     6    62    6    119
5     0     0    0    34    0  456     0     0     9   21      1
6     9     0    0     9    2    0  1850     5     9    5     19
7     0     2    0   199    2    1     1  6983    68    0      9
8     1     0    1   109    2    1     0    79  3086    0     17
9     1     0   27     5    3  163     1     5    13  274      1
10   11     0    1     8   56    1     7    21    92    0  12599
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6948856, 'precision': 0.64139694, 'recall': 0.5842858, 'specificity': 0.9695885, 'f1': 0.5654973, 'auroc': 0.86149883}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   844     1   0  107    0   13    88    32    13   54    18
1     0  1002   0   37    0    0     1   420     7    0    32
2     2     0  26   30  250   11     8    76   472   60    80
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  456    0     2     4    28    0  1143
5     1     0   0  115    1  417     1     0    25   31     1
6     0     0   0   21    0    0  2971     6    58    0    11
7     0     0   0   60    0    0     0  1101     0    0     3
8     0     0   0  107    0    2     1    13  1246    0     1
9     4     3  36  189   17  152     4   134   337  252     9
10    0     0   0    0   29    0     0     0     0    0  1617
better model found
persisted
after epoch: 3,now: 2024-08-03 17:09:46.598623,epoch time: 1:07:14.037265,used: 3:22:11.119612,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051356
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95465004, 'precision': 0.8888904, 'recall': 0.8494936, 'specificity': 0.99503434, 'f1': 0.8653882, 'auroc': 0.99670786}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     0    0     2    0    0     4     3     0    0     33
1     0  1287    0     4    0    0     1    34     5    0      1
2    10     0  176     0   51    2     6    12     6   43      6
3     7     4    0  7961    0   10     4   307   146    1      0
4     9     1   14     0  325    2     7     6    19    4    152
5    10     0    0    29    0  405    13     0     7   56      1
6    15     0    0     1    2    0  1864     3     1    0     19
7     0    12    1    60    2    0     2  7139    34    1     11
8     2     1    3    43    9    2     1   123  3062    1     48
9    24     0   25     8    2   63    13     4     6  343      5
10   29     1    0     6   16    0    14    24    26    0  12678
---- Validation: 
scalar performance:
{'acc': 0.95169187, 'precision': 0.8775594, 'recall': 0.8408499, 'specificity': 0.99473065, 'f1': 0.85543084, 'auroc': 0.99662375}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    0     2    0    0     5     4     1    1     31
1     0  1273    0     5    0    0     1    46     2    0      5
2    10     0  166     0   57    0     6    15     4   49      5
3     6     3    0  7913    0   10     6   355   144    2      1
4     8     0   12     0  324    1     2    17    18    3    154
5    10     0    0    22    0  412    12     0     8   56      1
6    18     0    1     0    2    0  1867     0     2    0     18
7     0    17    1    57    2    0     2  7135    44    0      7
8     2     1    3    46   12    1     3   127  3055    1     45
9    32     0   32     2    0   74    17     6     7  318      5
10   32     0    1     6   24    0     9    28    19    0  12677
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7073392, 'precision': 0.6131444, 'recall': 0.5743695, 'specificity': 0.96984386, 'f1': 0.54802155, 'auroc': 0.86348915}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1122     0    0   2    1    0    31     5     3    0     6
1      0  1265    4  14    0    0    11   167     7    0    31
2     51     0   54   0  276    0   141    57   112   40   284
3      0     0    0   0    0    0     0     0     0    0     0
4      4     0    0   0  117    0     7     1     4    0  1500
5     67     0    0  37    2  125   114     0    20  226     1
6      0     0    0   0    0    0  3063     1     0    0     3
7      8     0    0  33    0    0    14  1104     0    0     5
8      1     0    0  24    5    1    57     7  1257    0    18
9    132     3  213   6   19    5   199    56   103  359    42
10     0     0    0   0    2    0     0     0     0    0  1644
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-03 18:17:10.881385,epoch time: 1:07:24.282762,used: 4:29:35.402374,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051356
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9608572, 'precision': 0.90392435, 'recall': 0.8673067, 'specificity': 0.99569887, 'f1': 0.88137424, 'auroc': 0.99728996}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   424     0    1     4    1    1     6     4     1    7     34
1     0  1235    0     9    0    0     0    74     9    0      5
2     0     0  197     0   24    1     1     3     3   79      4
3     1     0    0  8194    0   18     0   153    66    4      0
4     3     0   30     0  311    1     1     7    21   12    153
5     0     0    0    15    0  423     0     0     3   79      1
6     8     0    1     1    1    0  1871     2     4    1     19
7     0     3    1   129    1    0     1  7039    80    5      4
8     3     0    1    93    8    2     0    55  3105    8     20
9     1     0   16     2    1   44     0     2     2  423      1
10   12     0    2     7   24    0     2    16    38    3  12691
---- Validation: 
scalar performance:
{'acc': 0.9605189, 'precision': 0.9037444, 'recall': 0.8641648, 'specificity': 0.9956616, 'f1': 0.8795824, 'auroc': 0.9975354}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   428     0    0     4    0    0     3     5     2    6     35
1     0  1230    0    11    0    0     0    80     9    0      2
2     0     0  187     0   25    0     0     3     4   91      2
3     1     0    0  8196    1   14     0   156    69    3      0
4     1     0   23     0  319    2     0     5    27   11    151
5     0     0    0    15    0  418     0     0     5   82      1
6     4     0    1     1    1    0  1880     3     2    2     14
7     0     2    2   143    1    0     2  7028    76    2      9
8     1     0    3   105    3    1     0    52  3107    5     19
9     0     0   20     1    0   53     0     0     3  416      0
10   12     0    3     8   28    0     4     7    31    3  12700
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69691455, 'precision': 0.63146657, 'recall': 0.5839681, 'specificity': 0.96955204, 'f1': 0.5593792, 'auroc': 0.8571493}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   946     0   1  33    0    2    31    41    29   66    21
1     0  1015   0  27    0    0     0   379    25    0    53
2     5     0  77   8  143    5     2    56   397  130   192
3     0     0   0   0    0    0     0     0     0    0     0
4     2     0   2   0   85    0     2     2    20    0  1520
5     4     0   0  97    1  281     0     0    29  179     1
6     0     0   0  23    0    0  2973     5    36    0    30
7     0     0   0   2    0    0     0  1157     2    0     3
8     0     0   0  57    0    1     2     7  1301    1     1
9     5     1  72  76   13   53     0   115   299  481    22
10    0     0   0   0    1    0     0     0     0    0  1645
better model found
persisted
after epoch: 5,now: 2024-08-03 19:23:38.249134,epoch time: 1:06:27.367749,used: 5:36:02.770123,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051356
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9625963, 'precision': 0.9011711, 'recall': 0.85777223, 'specificity': 0.9958763, 'f1': 0.8769361, 'auroc': 0.99774086}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    0     4    5    0     8     3     1    1     24
1     0  1287    0     8    0    0     0    31     3    0      2
2     3     0  169     1   92    0     1     5     4   37      0
3     0     1    0  8235    0    8     0   159    34    1      0
4     3     0    8     0  346    0     2     4    21    2    153
5     2     0    2    28    2  393     2     0     6   85      1
6     4     0    1     3    1    0  1873     2     3    1     19
7     0     7    0   129    1    0     1  7106    17    1      3
8     2     0    2   103    5    0     1   120  3052    2      9
9     1     0   40     2    9   38     4    14     4  380      1
10    6     1    1     8   19    0    11    13    31    1  12700
---- Validation: 
scalar performance:
{'acc': 0.9626856, 'precision': 0.90254563, 'recall': 0.8583251, 'specificity': 0.9958685, 'f1': 0.87705517, 'auroc': 0.99790657}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    0     1    2    0     6     3     0    2     29
1     0  1286    0     8    0    0     0    35     2    0      1
2     4     0  157     1   93    0     0    10     6   39      2
3     0     1    0  8228    0    5     2   167    35    2      0
4     2     0    6     0  353    1     3     4    15    3    152
5     0     0    1    31    0  395     1     0     4   88      1
6     3     0    1     4    1    0  1880     0     3    0     16
7     1     6    0   119    1    0     1  7110    22    0      5
8     1     0    3   113    6    0     2   114  3037    0     20
9     6     0   37     4    8   34     4     6     1  392      1
10   10     0    1     6   22    0     8    12    23    2  12712
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6798433, 'precision': 0.6081805, 'recall': 0.5637523, 'specificity': 0.9679097, 'f1': 0.54760045, 'auroc': 0.85105276}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   941     1   0   48    4    1    81    20     6   39    29
1     0  1200   0   33    0    0     0   220     6    0    40
2     3     2  39   22  259    5     3    52   327   83   220
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0   62    0     1     3    16    1  1550
5     3     0   0  113    1  217     1     0     6  250     1
6     0     0   0   35    1    0  2848     4    23    0   156
7     0     0   0  108    0    1     0  1050     2    0     3
8     0     0   0  120    0    1     3     7  1236    2     1
9     5     4  67  147   25   46     2   135   190  479    37
10    0     0   0    0    1    0     0     0     0    0  1645
better model found
persisted
after epoch: 6,now: 2024-08-03 20:31:14.529922,epoch time: 1:07:36.280788,used: 6:43:39.050911,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051356
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95529217, 'precision': 0.89213526, 'recall': 0.8687655, 'specificity': 0.9951006, 'f1': 0.87867504, 'auroc': 0.99767643}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    0     1    1    0    15     3     1    0     23
1     0  1235    0     6    0    0     0    88     2    0      1
2     7     0  196     0   68    1     1    16     1   20      2
3     0     0    0  7911    1    7     0   363   154    1      0
4     4     0   10     1  423    0     4     4     4    0     89
5     2     0    1    35    1  432     0     0     6   43      1
6     3     0    0     6    2    0  1879     3     1    0     14
7     0     4    0    44    1    0     1  7187    20    0      7
8     2     0    3    28   33    0     1    96  3015    0    116
9     8     0   65     5   13   59     2     5     5  326      5
10   17     0    0     5   72    1    15    18     3    0  12662
---- Validation: 
scalar performance:
{'acc': 0.95417947, 'precision': 0.89241374, 'recall': 0.8691736, 'specificity': 0.99498, 'f1': 0.8790903, 'auroc': 0.99750817}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    0     1    2    0    18     3     0    0     25
1     0  1226    0     8    0    0     0    96     2    0      0
2     7     0  196     0   61    0     4    14     3   24      3
3     1     0    0  7892    0    5     0   375   166    0      1
4     5     0    8     1  418    0     4     5     7    0     91
5     4     0    3    25    1  446     0     0     5   36      1
6     6     0    1     3    2    0  1878     6     3    0      9
7     0     1    0    51    3    0     2  7180    23    0      5
8     3     0    2    27   28    0     0    98  3012    2    124
9     6     0   62     8   10   60     4     7     4  331      1
10   15     0    1     6   80    0    19    13     3    0  12659
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7093682, 'precision': 0.64427394, 'recall': 0.5919819, 'specificity': 0.970929, 'f1': 0.58152795, 'auroc': 0.8580945}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1011     0    0   37    2    2    58    11    22   13    14
1      0  1083    0   32    1    0     1   324    10    0    48
2     17     1   55   13  322   10     9    33   244   46   265
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    1    0  358    0     4     1     6    0  1262
5      8     0    0  188    3  311     1     0    13   65     3
6      0     0    0   25    0    0  2996     3    10    0    33
7      0     0    0   35    0    0     0  1122     4    0     3
8      0     0    0   88    1    2     1     7  1259    0    12
9     18     3  118  187   28   96     0    64   269  315    39
10     0     0    0    0   16    0     1     0     0    0  1629
new oracle model saved
early stop counter: 1
val acc:0.9541794657707214, best validation acc: 0.9626855850219727, corresponding to test acc:                         0.6798433065414429 / 0.7093682289123535
after epoch: 7,now: 2024-08-03 21:41:14.476327,epoch time: 1:09:59.946405,used: 7:53:38.997316,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051356
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9644692, 'precision': 0.89896333, 'recall': 0.8821412, 'specificity': 0.99620235, 'f1': 0.88847065, 'auroc': 0.99809647}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     1    1     1    0    0    14     3     1    4     28
1     0  1319    0     6    0    0     1     4     2    0      0
2     1     0  242     1   49    0     0     0     2   17      0
3     0    10    0  8214    1   11     0   130    70    1      0
4     4     2   19     0  351    1     1     1    24    1    134
5     0     0    2    26    0  403     0     0     5   84      1
6     3     2    1     0    0    0  1886     2     3    0     10
7     1    94    3    94    2    0     2  7007    57    0      4
8     1     2    5    60    4    0     0    33  3181    0     10
9     0     0   87     3    3   27     0     0     6  365      2
10    9    30    2     5   18    1     2    12    63    1  12650
---- Validation: 
scalar performance:
{'acc': 0.9645847, 'precision': 0.90107465, 'recall': 0.8815759, 'specificity': 0.9962057, 'f1': 0.8894137, 'auroc': 0.99838}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     1    0     0    0    0    19     1     3    3     27
1     0  1318    0     4    0    0     0     7     3    0      0
2     1     0  236     0   45    1     0     0     3   22      4
3     0     4    0  8215    0    9     0   129    82    1      0
4     4     4   11     0  350    1     0     1    19    1    148
5     0     0    1    13    0  409     0     0     7   90      1
6     4     3    1     2    3    0  1880     0     5    1      9
7     0    98    7    95    1    0     1  6996    61    1      5
8     1     5    4    51    2    0     1    38  3185    0      9
9     0     0   78     6    5   28     0     0     4  370      2
10    6    29    1     7   16    0     5     5    52    2  12673
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70384103, 'precision': 0.6520909, 'recall': 0.5777222, 'specificity': 0.97026634, 'f1': 0.5725887, 'auroc': 0.84605825}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   786     5    3   63    0    1   167    13    11   77    44
1     0  1417    0   33    0    0     3    38     5    0     3
2     4    36  168   21  143    1    17     8   362   65   190
3     0     0    0    0    0    0     0     0     0    0     0
4     0    16    3    0   74    0     8     0    38    0  1494
5     0     0    1  157    0  202     1     0    17  211     3
6     0     1    0   13    0    0  3031     0    16    0     6
7     0     3    0  106    0    0     3  1044     5    0     3
8     0     0    0   96    0    0     1     1  1268    2     2
9     3    46  179  205    6   21     7    24   193  432    21
10    0     4    0    0    2    0     1     0     1    0  1638
better model found
persisted
after epoch: 8,now: 2024-08-03 23:00:18.188432,epoch time: 1:19:03.712105,used: 9:12:42.709421,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051356
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96848243, 'precision': 0.91273856, 'recall': 0.8982809, 'specificity': 0.9965595, 'f1': 0.9047916, 'auroc': 0.9982515}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     0    0     1    0    0    19     3     1    3     20
1     0  1315    0     2    0    0     1    12     1    0      0
2     0     0  236     1   35    2     0     0     1   35      2
3     0    10    0  8190    0   15     2   186    35    1      0
4     4     0   16     2  384    0     3     0     4    1    124
5     0     0    0    14    0  465     0     0     3   37      1
6     3     0    1     1    0    0  1889     2     1    4      7
7     0    44    2    67    4    0     1  7091    38    1     16
8     0     1    2    96    9    5     1    46  3107    4     24
9     0     0   44     3    1   72     0     1     0  371      1
10   15     0    1     7   29    1     8     1    14    3  12714
---- Validation: 
scalar performance:
{'acc': 0.9692925, 'precision': 0.9118829, 'recall': 0.8986886, 'specificity': 0.9966588, 'f1': 0.9042737, 'auroc': 0.9984171}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     1    0    0    27     3     0    0     14
1     0  1319    0     3    0    0     0     7     2    0      1
2     0     0  236     0   32    0     0     1     1   41      1
3     0     6    0  8194    0   15     2   186    36    1      0
4     4     0   22     0  379    1     0     0     4    4    125
5     0     0    0     9    0  477     0     0     1   33      1
6     5     0    0     1    0    1  1884     2     3    4      8
7     0    43    2    65    3    0     2  7109    27    2     12
8     3     2    4    78    5    3     1    51  3119    2     28
9     2     0   45     1    2   77     0     0     3  363      0
10   11     0    2     5   26    0     9     8    14    2  12719
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7112573, 'precision': 0.66140467, 'recall': 0.5940542, 'specificity': 0.9711276, 'f1': 0.59284526, 'auroc': 0.8487891}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   787     3    0   60    2    0   177    22     6   95    18
1     0  1307    0   32    0    0     3   138     4    0    15
2     0     9  171   34  190   13    21    17   312  118   130
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    4    0  194    0     9     0    20    1  1405
5     0     0    0  192    0  308     3     0     6   81     2
6     0     0    0   27    0    0  3027     3     2    0     8
7     0     0    1   52    0    0     0  1104     5    0     2
8     0     0    0  151    0    0     2     6  1209    1     1
9     2    12  128  235    7  130     6    48   130  418    21
10    0     0    0    0    4    0     1     0     0    0  1641
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-04 00:25:17.475937,epoch time: 1:24:59.287505,used: 10:37:41.996926,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051356
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9737532, 'precision': 0.9336435, 'recall': 0.90505457, 'specificity': 0.9971038, 'f1': 0.9184625, 'auroc': 0.9989713}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   415     0    0     2    0    0     7     0     1    0     58
1     0  1295    0    10    0    0     0    21     4    0      2
2     1     0  227     0   46    1     2     1     2   30      2
3     0     1    0  8300    0    5     1    52    77    1      0
4     3     0    5     1  425    0     0     0    17    1     87
5     1     0    0    11    0  447     0     0     9   52      1
6     3     0    0     1    1    0  1882     0     3    0     17
7     0     7    0   141    3    0     1  7055    47    0      9
8     0     0    5    37    3    0     0    23  3209    0     19
9     2     0   33     4    8   27     2     0     3  414      0
10    1     0    1     7   32    0     4     0    21    1  12726
---- Validation: 
scalar performance:
{'acc': 0.9724488, 'precision': 0.92900664, 'recall': 0.8972759, 'specificity': 0.9969619, 'f1': 0.9121574, 'auroc': 0.99897766}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   413     0    0     0    1    0    13     0     2    0     54
1     0  1294    0     9    0    0     0    20     5    0      4
2     2     0  223     0   47    1     2     0     2   34      1
3     0     1    0  8315    0    4     0    47    73    0      0
4     0     0    8     1  413    0     2     0    15    0    100
5     0     0    0    13    0  444     1     0     6   55      2
6     3     0    0     1    2    0  1884     0     4    1     13
7     2    10    1   168    1    0     3  7026    46    0      8
8     0     0    1    43    2    1     0    22  3210    1     16
9     3     0   34     1    7   39     3     0     9  395      2
10    1     0    1     6   27    0     4     2    16    1  12738
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69866365, 'precision': 0.64082885, 'recall': 0.57499564, 'specificity': 0.9695097, 'f1': 0.57352346, 'auroc': 0.85604084}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   787     1    0   19    4    0   215    11    13   17   103
1     1  1185    0   44    2    0     6   186    13    0    62
2     2     3  141    8  332    5     5     6   266   45   202
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    2    0  169    0     3     0    12    0  1447
5     7     0    1  112    1  215     2     0    39  209     6
6     0     0    0    3    0    0  3012     1    11    0    40
7     0     0    0  104    0    0     3  1045     6    1     5
8     0     0    0   53    0    0     1     2  1309    2     3
9     8     3  235   91   45   34     7    21   181  482    30
10    0     0    0    0    5    0     0     0     0    0  1641
better model found
persisted
after epoch: 10,now: 2024-08-04 01:40:14.791993,epoch time: 1:14:57.316056,used: 11:52:39.312982,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051356
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 11:52:39.312982 at 2024-08-04 01:40:14.791993
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69866365, 'precision': 0.64082885, 'recall': 0.57499564, 'specificity': 0.9695097, 'f1': 0.57352346, 'auroc': 0.85604084}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   787     1    0   19    4    0   215    11    13   17   103
1     1  1185    0   44    2    0     6   186    13    0    62
2     2     3  141    8  332    5     5     6   266   45   202
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    2    0  169    0     3     0    12    0  1447
5     7     0    1  112    1  215     2     0    39  209     6
6     0     0    0    3    0    0  3012     1    11    0    40
7     0     0    0  104    0    0     3  1045     6    1     5
8     0     0    0   53    0    0     1     2  1309    2     3
9     8     3  235   91   45   34     7    21   181  482    30
10    0     0    0    0    5    0     0     0     0    0  1641
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7112573, 'precision': 0.66140467, 'recall': 0.5940542, 'specificity': 0.9711276, 'f1': 0.59284526, 'auroc': 0.8487891}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   787     3    0   60    2    0   177    22     6   95    18
1     0  1307    0   32    0    0     3   138     4    0    15
2     0     9  171   34  190   13    21    17   312  118   130
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    4    0  194    0     9     0    20    1  1405
5     0     0    0  192    0  308     3     0     6   81     2
6     0     0    0   27    0    0  3027     3     2    0     8
7     0     0    1   52    0    0     0  1104     5    0     2
8     0     0    0  151    0    0     2     6  1209    1     1
9     2    12  128  235    7  130     6    48   130  418    21
10    0     0    0    0    4    0     1     0     0    0  1641
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_13_47_34_seed_1_24051356_instance_wise_predictions.txt
accuracy from prediction file 0.6986636815224235
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4044 MiB |  28236 MiB |   2186 TiB |   2186 TiB |
|       from large pool |   4020 MiB |  28187 MiB |   2172 TiB |   2172 TiB |
|       from small pool |     23 MiB |     50 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   4044 MiB |  28236 MiB |   2186 TiB |   2186 TiB |
|       from large pool |   4020 MiB |  28187 MiB |   2172 TiB |   2172 TiB |
|       from small pool |     23 MiB |     50 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4036 MiB |  28168 MiB |   2179 TiB |   2179 TiB |
|       from large pool |   4013 MiB |  28119 MiB |   2165 TiB |   2165 TiB |
|       from small pool |     22 MiB |     49 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  29192 MiB |  29192 MiB |  53810 MiB |  24618 MiB |
|       from large pool |  29140 MiB |  29140 MiB |  53744 MiB |  24604 MiB |
|       from small pool |     52 MiB |     52 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 643045 KiB |   1619 MiB | 459152 GiB | 459151 GiB |
|       from large pool | 627800 KiB |   1617 MiB | 444985 GiB | 444984 GiB |
|       from small pool |  15245 KiB |     32 MiB |  14167 GiB |  14167 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3670    |    5393    |  139354 K  |  139350 K  |
|       from large pool |     502    |    1018    |   67251 K  |   67250 K  |
|       from small pool |    3168    |    4690    |   72103 K  |   72100 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3670    |    5393    |  139354 K  |  139350 K  |
|       from large pool |     502    |    1018    |   67251 K  |   67250 K  |
|       from small pool |    3168    |    4690    |   72103 K  |   72100 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     722    |     725    |    1236    |     514    |
|       from large pool |     696    |     699    |    1203    |     507    |
|       from small pool |      26    |      26    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     221    |    1249    |   72695 K  |   72695 K  |
|       from large pool |     184    |     469    |   41849 K  |   41849 K  |
|       from small pool |      37    |    1067    |   30845 K  |   30845 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  28236 MiB |   2186 TiB |   2186 TiB |
|       from large pool |  16640 KiB |  28187 MiB |   2172 TiB |   2172 TiB |
|       from small pool |      0 KiB |     50 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  28236 MiB |   2186 TiB |   2186 TiB |
|       from large pool |  16640 KiB |  28187 MiB |   2172 TiB |   2172 TiB |
|       from small pool |      0 KiB |     50 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  28168 MiB |   2179 TiB |   2179 TiB |
|       from large pool |  16640 KiB |  28119 MiB |   2165 TiB |   2165 TiB |
|       from small pool |      0 KiB |     49 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4672 MiB |  29192 MiB |  53810 MiB |  49138 MiB |
|       from large pool |   4634 MiB |  29140 MiB |  53744 MiB |  49110 MiB |
|       from small pool |     38 MiB |     52 MiB |     66 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1619 MiB | 459154 GiB | 459154 GiB |
|       from large pool | 134912 KiB |   1617 MiB | 444987 GiB | 444987 GiB |
|       from small pool |      0 KiB |     32 MiB |  14167 GiB |  14167 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |  139354 K  |  139354 K  |
|       from large pool |       2    |    1018    |   67251 K  |   67251 K  |
|       from small pool |       0    |    4690    |   72103 K  |   72103 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |  139354 K  |  139354 K  |
|       from large pool |       2    |    1018    |   67251 K  |   67251 K  |
|       from small pool |       0    |    4690    |   72103 K  |   72103 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     212    |     725    |    1236    |    1024    |
|       from large pool |     193    |     699    |    1203    |    1010    |
|       from small pool |      19    |      26    |      33    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1249    |   72696 K  |   72696 K  |
|       from large pool |       4    |     469    |   41849 K  |   41849 K  |
|       from small pool |       0    |    1067    |   30846 K  |   30846 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug  4 01:48:48 2024]
Finished job 0.
1 of 1 steps (100%) done
