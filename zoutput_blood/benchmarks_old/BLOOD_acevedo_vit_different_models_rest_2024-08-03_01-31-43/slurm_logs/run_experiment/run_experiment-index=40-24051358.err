Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug  3 05:14:56 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/15.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=15
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_05_31_14_seed_0_24051358

 Experiment start at: 2024-08-03 05:31:16.009496
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.044287413358688354
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9189052, 'precision': 0.8271431, 'recall': 0.7186544, 'specificity': 0.99095297, 'f1': 0.7535881, 'auroc': 0.99021584}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   260     0    1    37    0    3    63    10    10   33     66
1     0  1159    0    27    0    0     1   133     6    0      6
2     0     1  114    13   27    8     4    51    16   76      2
3     0     0    0  8210    0    4     0   148    74    1      1
4     1     0   58     9  138    2     3    17    89   18    204
5     0     0    1   105    0  373     0     0     6   35      1
6     5     0    0    44    0    3  1817    10    12    4     13
7     0     1    0   505    1    0     2  6694    47    0     14
8     0     0    5   335    3    1     3   118  2798    4     28
9     0     0   33    55    0  151     1     7     6  238      2
10    8     0    4    15   10    2    48    42   115    3  12544
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.91838974, 'precision': 0.82867634, 'recall': 0.7173183, 'specificity': 0.990887, 'f1': 0.75403214, 'auroc': 0.9903201}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   252     0    0    45    0    3    61    13    11   32     66
1     0  1147    0    27    0    0     0   145     6    0      7
2     0     1  110    15   30    7     1    48    15   78      7
3     0     0    0  8208    0    3     0   157    72    0      0
4     0     0   51    14  150    5     3    14    90   14    198
5     1     0    1   112    0  357     0     0     5   44      1
6     5     0    0    44    0    3  1814    11    11    5     15
7     0     2    0   502    1    0     3  6694    49    0     14
8     0     0    4   333    1    1     3   108  2807    6     33
9     0     0   31    47    0  146     0     6     8  254      1
10    9     0    6    18   11    2    42    40   125    2  12541
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.60218287, 'precision': 0.6151992, 'recall': 0.50081813, 'specificity': 0.96101046, 'f1': 0.49500203, 'auroc': 0.8552945}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   509     0   0  359    0   10    93   67    38   90     4
1     0  1021   0   68    0    0     1  376    12    0    21
2     2     5  77  110  123   62     9  105   395   57    70
3     0     0   0    0    0    0     0    0     0    0     0
4     0     1   0    1  171    0     4    4    46    1  1405
5     0     0   0  244    0  326     2    0     4   16     0
6     0     0   0  115    3    0  2573    7   246    0   123
7     0     0   0  210    0    0     0  951     0    0     3
8     0     0   0  232    0    1     0   12  1122    2     1
9     0    15  64  383    4  258     0   88    99  215    11
10    0     0   0    0    3    0     1    0     0    0  1642
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 06:45:17.903376,epoch time: 1:14:01.893880,used: 1:14:01.893880,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_05_31_14_seed_0_24051358
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9435199, 'precision': 0.8562488, 'recall': 0.79750776, 'specificity': 0.993696, 'f1': 0.82074594, 'auroc': 0.99220175}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   406     0    0     7    0    0     9     1     6    1     53
1     0  1239    0    20    0    0     0    49    15    0      9
2     5     0  175     2   68    1     2     8    15   29      7
3     0     1    0  8166    0    7     0   108   156    1      0
4     3     0   10     4  230    1     1     3    38    5    244
5     5     0    6    51    0  306     1     0    13  138      1
6    28     0    1     5    0    0  1850     2     4    1     17
7     0     8    1   345    2    0     3  6803    77    0     23
8     6     0    3    85    7    0     2    49  3073    1     69
9    10     0   88    12    2   43     2     3    18  309      6
10   17     0    1     7    7    0     9    12    29    2  12708
---- Validation: 
scalar performance:
{'acc': 0.94348, 'precision': 0.8618089, 'recall': 0.7975047, 'specificity': 0.9936638, 'f1': 0.82228494, 'auroc': 0.99259293}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   400     0    1     5    0    0     9     2     5    3     58
1     0  1251    0    20    0    0     0    46     8    0      7
2     4     0  170     3   68    1     1    13    15   24     13
3     0     1    0  8147    0    9     0   108   174    1      0
4     4     0   14     6  211    0     2     3    33    5    261
5     3     0    4    54    0  308     1     0    10  140      1
6    20     0    0     8    0    0  1854     3     5    1     17
7     2     6    0   356    3    0     3  6791    82    0     22
8     3     0    2    80    1    1     2    54  3095    1     57
9     9     0   78    12    1   39     1     2    13  332      6
10   13     0    0     8    6    1    17     8    28    2  12713
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6894284, 'precision': 0.62876827, 'recall': 0.57864344, 'specificity': 0.9691259, 'f1': 0.57040155, 'auroc': 0.86008316}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1075     0    1   36    0    0     7    7    32   10     2
1      2  1275    0   38    1    2     8  135    18    0    20
2     30     3  104   53  192   12    17   23   335   98   148
3      0     0    0    0    0    0     0    0     0    0     0
4      2     0    1    0   87    0     4    1    15    1  1522
5     18     0    0   99    0  318     1    0    13  141     2
6      2     0    0    3    0    0  2889    1    92    0    80
7      3     0    1  392    0    0     6  751     5    2     4
8      1     0    0  106    1    2     2    1  1253    2     2
9     34     7  125  131   15  105     4   18   219  456    23
10     0     0    0    0    0    0     0    0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 07:53:32.675353,epoch time: 1:08:14.771977,used: 2:22:16.665857,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_05_31_14_seed_0_24051358
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9450182, 'precision': 0.8710135, 'recall': 0.7883924, 'specificity': 0.9939812, 'f1': 0.81621593, 'auroc': 0.9944457}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     0    0     4    0    0    12     4    13    3     34
1     0  1287    0    12    0    0     1    27     4    0      1
2     4     2  151     4   53    4     2    19    37   30      6
3     0     1    0  8127    0    1     1   210    99    0      0
4     3     2   13     2  225    2     5     3    95    3    186
5     5     0    0   110    0  376     0     0    14   14      1
6     8     1    0     5    0    0  1866     4    10    0     13
7     0    36    0   169    1    0     1  6986    54    0     16
8     1     3    2   120    1    0     0    58  3095    0     16
9    15     1   43    34    1  156     4     6    36  197      0
10    8     7    1    14    5    0    20    11   128    0  12599
---- Validation: 
scalar performance:
{'acc': 0.9439615, 'precision': 0.8659289, 'recall': 0.7820063, 'specificity': 0.993863, 'f1': 0.8098488, 'auroc': 0.99458885}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   408     0    0     6    0    0    16     5    15    2     31
1     0  1285    0    15    0    0     0    29     2    0      1
2     4     2  147     6   59    3     1    21    38   25      6
3     0     1    0  8139    0    1     1   204    93    0      1
4     4     1   10     4  225    1     2     4    88    2    198
5     3     0    2   121    0  367     0     0    12   14      2
6     8     0    0     3    0    0  1870     3     9    0     15
7     0    47    1   156    1    0     4  6974    66    0     16
8     1     3    1   113    3    0     0    73  3089    0     13
9    10     0   48    40    1  169     6     7    27  184      1
10   12     5    1    13    8    0    15     9   131    0  12602
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6870496, 'precision': 0.6204896, 'recall': 0.5695728, 'specificity': 0.96890646, 'f1': 0.5324019, 'auroc': 0.87101316}
confusion matrix:
      0     1   2    3    4    5     6     7     8   9     10
0   1075     2   0   25    0    0    33     5    28   1     1
1      1  1390   0   30    0    0     2    57    12   0     7
2     23    18  29   52  138   51    20    17   495  15   157
3      0     0   0    0    0    0     0     0     0   0     0
4      2     1   0    1   58    0     2     1    36   0  1532
5     16     0   0  253    0  308     0     0     7   7     1
6      0     1   0   13    0    0  2943     1    77   0    32
7      0     2   0  145    0    0     3  1004     9   0     1
8      0     0   0   95    0    0     1     3  1269   2     0
9     40    24  40  263   12  226     3    37   373  99    20
10     0     0   0    0    0    0     0     0     1   0  1645
better model found
persisted
after epoch: 3,now: 2024-08-03 09:02:17.420164,epoch time: 1:08:44.744811,used: 3:31:01.410668,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_05_31_14_seed_0_24051358
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95770013, 'precision': 0.8958946, 'recall': 0.8592804, 'specificity': 0.99537295, 'f1': 0.8743564, 'auroc': 0.99673665}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   398     0    0     5    0    0     7     5     4    3     61
1     0  1242    0    19    0    0     3    56     8    0      4
2     0     0  195     1   29    0     2     5     4   73      2
3     0     0    1  8241    0    8     1   109    78    0      0
4     2     0   24     0  348    1     2     9    29    9    115
5     0     0    0    26    0  382     1     0     5  105      2
6     4     0    0     4    2    0  1871     5     5    3     13
7     0     5    2   201    1    0     2  7005    40    1      6
8     1     0    1    91    5    1     2    66  3102    3     24
9     5     0   18    10    0   35     0     4     6  415      0
10    6     0    1     8  108    0    12    22    39    1  12596
---- Validation: 
scalar performance:
{'acc': 0.9577103, 'precision': 0.8951436, 'recall': 0.85978323, 'specificity': 0.9953929, 'f1': 0.87439466, 'auroc': 0.9968274}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   402     0    0     7    0    0     6     7     5    2     54
1     0  1238    1    15    0    0     7    58     8    0      5
2     2     0  194     1   36    1     1     5     2   69      1
3     1     0    1  8213    0    6     2   131    85    1      0
4     5     0   27     2  355    0     1     8    32    6    103
5     0     0    0    24    0  381     0     0     5  110      1
6     6     0    1     2    1    0  1875     3     5    0     15
7     1     4    1   176    1    0     3  7024    50    0      5
8     1     0    2    85    6    2     2    86  3082    6     24
9     4     0   17    12    1   32     0     4     7  414      2
10    5     0    1     8   93    0     8    18    35    2  12626
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.741272, 'precision': 0.69468546, 'recall': 0.6207966, 'specificity': 0.97429395, 'f1': 0.6349014, 'auroc': 0.8834073}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1040     0    0   35    1    0    32   10    35   12     5
1      0  1007    2   33    2    1    24  379    11    8    32
2     15     0  197   22  324    4    28   42   195  142    46
3      0     0    0    0    0    0     0    0     0    0     0
4      1     0    3    0  678    0    18    3    18    0   912
5      3     0    0  116    1  291     0    0     3  177     1
6      0     0    0    1    1    0  3061    2     0    0     2
7      0     0    0  273    0    0     5  879     3    3     1
8      0     0    0  132    0    0     3    7  1223    5     0
9      8     0  118  128   21   72     6   37   102  637     8
10     0     0    0    0   57    0     6    0     1    0  1582
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-03 10:10:23.127945,epoch time: 1:08:05.707781,used: 4:39:07.118449,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_05_31_14_seed_0_24051358
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9587971, 'precision': 0.9038775, 'recall': 0.8462523, 'specificity': 0.9952384, 'f1': 0.866155, 'auroc': 0.9968919}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   424     0    0     1    0    1     3     3     0    2     49
1     0  1292    0     5    0    0     0    28     5    0      1
2     3     1  201     0   28    1     1    10     5   50     12
3     2     2    0  8193    1   15     0   162    60    0      1
4     3     1   36     1  202    0     0     4    10    6    276
5     4     0    1    16    0  425     0     0     4   70      1
6    12     0    1     2    0    0  1837     5     2    0     49
7     0    20    0   120    1    0     1  7069    30    1     19
8     1     2    1   104    4    5     0    55  3037    4     83
9     7     0   31     6    1   47     0     4     2  394      1
10    4     0    2     6    1    0     1     9     9    2  12762
---- Validation: 
scalar performance:
{'acc': 0.9576568, 'precision': 0.90573287, 'recall': 0.84911954, 'specificity': 0.9951253, 'f1': 0.8683541, 'auroc': 0.9968959}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   428     0    0     2    0    0     1     2     0    1     49
1     0  1297    0     6    0    0     0    25     4    0      0
2     2     2  208     1   27    1     2    11     5   44      9
3     0     2    0  8160    0   25     1   175    75    1      1
4     4     0   27     0  206    1     1     3    10    9    278
5     3     0    0    17    0  419     0     0     5   76      1
6    13     0    0     1    0    0  1837     4     2    2     49
7     0    22    0   123    1    0     1  7058    41    1     18
8     2     1    2   113    3    2     0    64  3032    2     75
9     7     1   31     5    0   44     0     3     3  399      0
10    9     0    0     7    2    1     3     8     6    2  12758
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71909326, 'precision': 0.6315018, 'recall': 0.611043, 'specificity': 0.97187376, 'f1': 0.58925414, 'auroc': 0.8581911}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1104     1   0   13    0    1    16     3     6    9    17
1      0  1344   0   27    0    0     3   102     5    0    18
2     14    10  73   21  157   14     2    28   223  105   368
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   0    0   24    0     3     1    10    1  1594
5      7     0   1   83    0  361     0     0     3  131     6
6      0     0   0    1    0    0  2993     3     3    0    67
7      0     0   0   60    0    0     1  1097     1    1     4
8      0     0   0  200    1    0     2     5  1152    3     7
9     24    21  69  143   16  144     3    52   139  484    42
10     0     0   0    0    0    0     0     0     0    0  1646
early stop counter: 1
val acc:0.9576568007469177, best validation acc: 0.957710325717926, corresponding to test acc:                         0.74127197265625 / 0.74127197265625
after epoch: 5,now: 2024-08-03 11:17:57.394191,epoch time: 1:07:34.266246,used: 5:46:41.384695,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_05_31_14_seed_0_24051358
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9619542, 'precision': 0.88062257, 'recall': 0.8911499, 'specificity': 0.9959069, 'f1': 0.8847086, 'auroc': 0.9977546}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    1     2    0    0     7     0     1    8     19
1     0  1312    0     7    0    0     0    10     2    0      1
2     0     0  226     1   36    0     1     0     1   47      0
3     0     3    3  8269    1   45     2    97    18    0      1
4     4     0   35     0  386    0     1     2     5   11     95
5     0     0    0     7    0  479     0     0     1   33      1
6     6     0    1     0    2    0  1879     1     3    2     12
7     2    44   12   133    3    0     6  7026    18    9     10
8     6     1   20   177   35   21     3    77  2886   17     53
9     0     0   34     1    0   94     0     0     1  363      0
10   14     0    1     8   56    1    10     6     9    4  12683
---- Validation: 
scalar performance:
{'acc': 0.9627658, 'precision': 0.88562113, 'recall': 0.89251834, 'specificity': 0.9959755, 'f1': 0.8880148, 'auroc': 0.9978076}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    1     1    0    0     8     0     1    9     16
1     0  1308    0     6    0    0     0    16     1    0      1
2     0     0  226     0   34    1     0     0     0   51      0
3     1     2    2  8281    0   43     1    85    22    3      0
4     3     0   29     0  381    0     0     2     5   11    108
5     0     0    0     8    0  478     0     0     2   32      1
6     5     0    0     1    0    0  1886     1     3    4      8
7     3    38   16   137    2    0     5  7037    16    5      6
8     3     2   19   191   30   17     7    76  2892    9     50
9     0     0   31     3    0   86     0     1     0  372      0
10   15     0    4     6   55    1    10     9     5    6  12685
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7609319, 'precision': 0.70713305, 'recall': 0.6541114, 'specificity': 0.9760252, 'f1': 0.6633917, 'auroc': 0.8683515}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1032     1    2   14    1    1    30    5     9   69     6
1      5  1333    2   22    1    1    19   61     1   14    40
2      2     0  305   15  347   13    10    6    60  142   115
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    4    0  378    0     4    0     5    1  1241
5      1     0    0   43    2  406     1    0     0  138     1
6      1     0    0    2    0    0  3056    0     0    0     8
7      2     0    5  178    0    0    61  893     2   20     3
8      0     0    1  173   14   14    18    4  1124   15     7
9      1     2  169   56   13  139     6    4    18  717    12
10     0     0    0    0   12    0     2    0     0    0  1632
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-03 12:25:31.087861,epoch time: 1:07:33.693670,used: 6:54:15.078365,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_05_31_14_seed_0_24051358
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96658283, 'precision': 0.89461786, 'recall': 0.8953312, 'specificity': 0.99652004, 'f1': 0.89172685, 'auroc': 0.9983978}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     4    0    0     6     1     3    0     23
1     0  1301    0    11    0    0     0    14     4    0      2
2     2     0  204     1   65    0     1     4     2   33      0
3     0     1    1  8259    0   10     0    76    90    2      0
4     5     0   11     0  459    0     1     1    16    2     43
5     1     0    2    12    0  369     0     0     4  132      1
6     9     1    0     5    1    0  1876     1     3    0     10
7     0    30    1   137    6    0     1  7025    53    0     10
8     1     1    5    42   13    4     2    29  3181    1     16
9     1     0   48     3    1   15     0     2     1  421      1
10   12     0    1     9  141    0     6     4    34    1  12586
---- Validation: 
scalar performance:
{'acc': 0.96640366, 'precision': 0.8922443, 'recall': 0.8991473, 'specificity': 0.99651587, 'f1': 0.89274645, 'auroc': 0.99830616}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    0     4    1    0     3     0     0    1     23
1     0  1304    0     7    0    0     1    13     5    0      2
2     3     0  210     0   64    0     1     2     1   31      0
3     0     1    2  8269    2   16     2    63    83    1      1
4     7     0   13     0  460    0     0     2    13    0     44
5     1     0    3    12    1  378     0     0     5  120      1
6     7     0    0     3    0    0  1885     1     4    0      8
7     0    32    3   148    3    0     2  7010    57    1      9
8     3     0    4    43   15    1     1    35  3183    0     11
9     1     0   52     4    4   12     0     0     3  417      0
10   10     1    2     7  161    0    13     6    32    2  12562
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.76540965, 'precision': 0.688177, 'recall': 0.6291846, 'specificity': 0.9765012, 'f1': 0.64162505, 'auroc': 0.8796878}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1038     0    1   26    4    0    64    1    23   11     2
1      2  1371    0   31    3    0    15   55     3    4    15
2     11     5  114   16  518    6    48    8   163   80    46
3      0     0    0    0    0    0     0    0     0    0     0
4      1     0    1    0  886    0    24    0    14    0   707
5      7     0    0  109    2  201     2    0     6  264     1
6      0     0    0    2    0    0  3064    0     0    0     1
7      0     1    3  214    1    0    11  922     6    2     4
8      0     0    0   95    3    0    16    1  1253    2     0
9      6     6  209  113   65   54    21   10   102  547     4
10     0     0    0    0   96    0     5    0     1    0  1544
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-03 13:33:06.157450,epoch time: 1:07:35.069589,used: 8:01:50.147954,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_05_31_14_seed_0_24051358
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9696597, 'precision': 0.9166294, 'recall': 0.89900434, 'specificity': 0.99672866, 'f1': 0.9053582, 'auroc': 0.9984473}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     1    0    0     3     0     1    4     13
1     0  1296    0    11    0    0     0    20     4    0      1
2     0     0  225     1   12    1     2     4    11   55      1
3     1     0    2  8219    0   16     0   107    91    1      0
4     4     0   36     0  343    0     1     4    28    4    119
5     0     0    1    10    0  458     0     0     7   44      1
6    16     0    0     1    0    0  1874     1     3    4      9
7     2    13    3    99    1    0     2  7099    36    1      7
8     1     0    3    34    3    1     1    60  3180    1     12
9     1     0   12     1    0   62     0     0     5  412      0
10   24     0    4     8   20    0     5    11    44    1  12676
---- Validation: 
scalar performance:
{'acc': 0.9698275, 'precision': 0.9158423, 'recall': 0.89980364, 'specificity': 0.9967625, 'f1': 0.9056946, 'auroc': 0.99872845}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     1    0    0     3     1     2    6     13
1     0  1292    0     6    0    0     0    23     8    0      3
2     0     0  229     0   13    1     0     2     8   59      0
3     0     1    1  8229    0   14     1   102    91    1      0
4     7     0   39     0  351    1     0     4    27    4    106
5     0     0    0    13    0  458     0     0     3   46      1
6    13     0    1     0    1    0  1876     3     2    3      9
7     1    12    2   110    1    0     2  7098    34    1      4
8     1     0    2    32    2    1     0    64  3184    1      9
9     0     0   17     0    0   65     0     1     3  407      0
10   19     0    2     7   20    0     7    11    51    3  12676
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73371583, 'precision': 0.67631996, 'recall': 0.6173458, 'specificity': 0.97335625, 'f1': 0.6157159, 'auroc': 0.8705394}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1090     0    0   15    0    0    16    8    18   21     2
1      4  1311    2   29    0    1    14  107    11   12     8
2     31     3  176   25  177    8    69   19   289  125    93
3      0     0    0    0    0    0     0    0     0    0     0
4      2     0    4    0  208    0    23    1    22    1  1372
5      9     0    0   88    0  303     3    0     5  182     2
6      0     0    0    1    0    0  3064    1     0    0     1
7      4     0   10  241    0    0     3  889     2   13     2
8      0     0    0  147    0    3    25    8  1177    9     1
9     22     3  108   94    7  102    15   12   128  631    15
10     0     0    0    0    4    0     4    0     0    0  1638
better model found
persisted
after epoch: 8,now: 2024-08-03 14:41:52.036014,epoch time: 1:08:45.878564,used: 9:10:36.026518,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_05_31_14_seed_0_24051358
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97169304, 'precision': 0.9176291, 'recall': 0.91459936, 'specificity': 0.99699306, 'f1': 0.91543835, 'auroc': 0.9989253}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     5    0    0     0     5     3    4     11
1     0  1293    0     3    0    0     2    30     1    0      2
2     0     0  225     1   18    1     0     6     2   58      0
3     0     1    0  8262    0    5     0   126    41    2      0
4     6     0   24     0  448    1     0     6    12    5     37
5     0     0    0    21    0  456     0     0     1   42      1
6     9     0    0     6    2    0  1868     5     4    0     14
7     1     5    1    71    1    0     1  7172     9    0      4
8     1     0    4    56    6    2     0    99  3120    1      7
9     0     0   12     6    1   59     0     0     1  414      0
10   11     0    1     7  111    1     6    19    30    1  12605
---- Validation: 
scalar performance:
{'acc': 0.97271633, 'precision': 0.9194336, 'recall': 0.9202337, 'specificity': 0.9971145, 'f1': 0.9193349, 'auroc': 0.99894255}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     2    0    0     2     6     4    5     12
1     0  1298    0     5    0    0     0    28     1    0      0
2     0     0  237     1   17    3     0     2     2   50      0
3     0     1    1  8285    0    6     0   107    39    1      0
4     6     0   24     1  451    3     2     6     6    4     36
5     0     0    0    17    0  462     0     0     1   40      1
6     7     0    0     4    1    1  1873     6     4    2     10
7     0    10    1    72    1    0     1  7168     9    0      3
8     1     0    3    59    9    0     0    97  3120    2      5
9     0     0   11     5    0   56     1     0     2  418      0
10   12     0    2     6  112    3     9    21    29    1  12601
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7494578, 'precision': 0.6942971, 'recall': 0.63833517, 'specificity': 0.97512317, 'f1': 0.6499857, 'auroc': 0.8699056}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1032     0    0   32    1    1    13   18    10   59     4
1      2  1204    1   27    1    2    10  196     5   27    24
2     15     1  224   22  354   16    10   41    92  113   127
3      0     0    0    0    0    0     0    0     0    0     0
4      2     0    1    0  578    0     4    2     6    2  1038
5      0     0    0   74    2  363     1    0     4  145     3
6      3     0    0    9    1    0  2991    2    13    1    47
7      0     0    1  203    0    0     2  951     0    6     1
8      0     0    4  197    5    0     1   11  1143    5     4
9      9     1  163  103   26  123     3   33    41  624    11
10     0     0    0    0   42    0     2    0     0    0  1602
better model found
persisted
after epoch: 9,now: 2024-08-03 15:49:50.622295,epoch time: 1:07:58.586281,used: 10:18:34.612799,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_05_31_14_seed_0_24051358
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97206765, 'precision': 0.89749146, 'recall': 0.9187318, 'specificity': 0.9971001, 'f1': 0.90451276, 'auroc': 0.99900055}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    1     0    0    0     2     0     0    6     19
1     0  1292    1     2    0    0     0    32     5    0      0
2     0     0  289     0    3    0     0     0     1   19      0
3     3     1    3  8218    1   13     0   145    50    5      0
4     5     0   86     0  396    0     1     0     4    1     46
5     0     0    3     3    0  440     0     0     2   72      1
6     8     0    1     0    3    0  1879     0     3    1     13
7     0     5   13    48    3    0     5  7158    22    0     11
8     1     1   13    30   11    4     0    25  3191    2     17
9     0     0   74     0    0   30     0     0     0  389      0
10   10     0    9     6  113    0     3     4    16    3  12625
---- Validation: 
scalar performance:
{'acc': 0.97327805, 'precision': 0.90389246, 'recall': 0.9195699, 'specificity': 0.9972164, 'f1': 0.9082626, 'auroc': 0.999015}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    2     0    1    0     5     0     0    3     13
1     0  1292    1     6    0    0     0    29     3    0      1
2     0     0  289     0    6    0     0     0     1   16      0
3     3     0    4  8216    0   16     0   139    62    0      0
4     4     0   81     0  392    2     1     1     3    1     54
5     0     0    2     3    0  433     0     0     1   81      1
6     2     0    0     1    6    0  1886     2     0    1     10
7     0     5    8    47    1    0     3  7172    21    1      7
8     0     0   12    32   12    2     0    29  3193    2     14
9     0     0   76     2    0   18     0     1     0  396      0
10    7     0    8     5   96    2     3     3    13    1  12658
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7717764, 'precision': 0.70551807, 'recall': 0.6563593, 'specificity': 0.97734725, 'f1': 0.6714153, 'auroc': 0.88204855}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1058     0    3   15    2    1    26    8    15   39     3
1      0  1211    3   18    3    1    22  208     5   14    14
2      1     1  526   13  298   12     9    9    81   39    26
3      0     0    0    0    0    0     0    0     0    0     0
4      2     0   13    0  756    0     7    0     8    0   847
5      2     0   10   80    1  326     0    0     4  168     1
6      0     0    0    1    0    0  3062    0     1    1     2
7      0     0    6  197    0    0     8  948     1    2     2
8      0     0    4  151   11    0     5   13  1181    5     0
9      4     3  473   81   11  106     4   11    36  399     9
10     0     0    0    0   80    0     2    0     0    0  1564
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-03 16:58:22.676724,epoch time: 1:08:32.054429,used: 11:27:06.667228,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_05_31_14_seed_0_24051358
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 11:27:06.667228 at 2024-08-03 16:58:22.676724
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7717764, 'precision': 0.70551807, 'recall': 0.6563593, 'specificity': 0.97734725, 'f1': 0.6714153, 'auroc': 0.88204855}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1058     0    3   15    2    1    26    8    15   39     3
1      0  1211    3   18    3    1    22  208     5   14    14
2      1     1  526   13  298   12     9    9    81   39    26
3      0     0    0    0    0    0     0    0     0    0     0
4      2     0   13    0  756    0     7    0     8    0   847
5      2     0   10   80    1  326     0    0     4  168     1
6      0     0    0    1    0    0  3062    0     1    1     2
7      0     0    6  197    0    0     8  948     1    2     2
8      0     0    4  151   11    0     5   13  1181    5     0
9      4     3  473   81   11  106     4   11    36  399     9
10     0     0    0    0   80    0     2    0     0    0  1564
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7717764, 'precision': 0.70551807, 'recall': 0.6563593, 'specificity': 0.97734725, 'f1': 0.6714153, 'auroc': 0.88204855}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1058     0    3   15    2    1    26    8    15   39     3
1      0  1211    3   18    3    1    22  208     5   14    14
2      1     1  526   13  298   12     9    9    81   39    26
3      0     0    0    0    0    0     0    0     0    0     0
4      2     0   13    0  756    0     7    0     8    0   847
5      2     0   10   80    1  326     0    0     4  168     1
6      0     0    0    1    0    0  3062    0     1    1     2
7      0     0    6  197    0    0     8  948     1    2     2
8      0     0    4  151   11    0     5   13  1181    5     0
9      4     3  473   81   11  106     4   11    36  399     9
10     0     0    0    0   80    0     2    0     0    0  1564
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_05_31_14_seed_0_24051358_instance_wise_predictions.txt
accuracy from prediction file 0.7717763940390401
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/15.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4043 MiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |   4020 MiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |     23 MiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   4043 MiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |   4020 MiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |     23 MiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4036 MiB |  28168 MiB |   1089 TiB |   1089 TiB |
|       from large pool |   4013 MiB |  28119 MiB |   1082 TiB |   1082 TiB |
|       from small pool |     22 MiB |     49 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  29180 MiB |  29180 MiB |  29180 MiB |      0 B   |
|       from large pool |  29128 MiB |  29128 MiB |  29128 MiB |      0 B   |
|       from small pool |     52 MiB |     52 MiB |     52 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 531037 KiB |   1608 MiB | 225861 GiB | 225860 GiB |
|       from large pool | 515792 KiB |   1606 MiB | 218790 GiB | 218790 GiB |
|       from small pool |  15245 KiB |     22 MiB |   7070 GiB |   7070 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3670    |    5393    |   69678 K  |   69675 K  |
|       from large pool |     502    |    1018    |   33625 K  |   33625 K  |
|       from small pool |    3168    |    4690    |   36052 K  |   36049 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3670    |    5393    |   69678 K  |   69675 K  |
|       from large pool |     502    |    1018    |   33625 K  |   33625 K  |
|       from small pool |    3168    |    4690    |   36052 K  |   36049 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     725    |     725    |     725    |       0    |
|       from large pool |     699    |     699    |     699    |       0    |
|       from small pool |      26    |      26    |      26    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     217    |    1249    |   36276 K  |   36276 K  |
|       from large pool |     182    |     469    |   21026 K  |   21026 K  |
|       from small pool |      35    |    1067    |   15249 K  |   15249 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |  16640 KiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |      0 KiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |  16640 KiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |      0 KiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  28168 MiB |   1089 TiB |   1089 TiB |
|       from large pool |  16640 KiB |  28119 MiB |   1082 TiB |   1082 TiB |
|       from small pool |      0 KiB |     49 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4562 MiB |  29180 MiB |  29180 MiB |  24618 MiB |
|       from large pool |   4524 MiB |  29128 MiB |  29128 MiB |  24604 MiB |
|       from small pool |     38 MiB |     52 MiB |     52 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1608 MiB | 225863 GiB | 225863 GiB |
|       from large pool | 134912 KiB |   1606 MiB | 218792 GiB | 218792 GiB |
|       from small pool |      0 KiB |     32 MiB |   7070 GiB |   7070 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |   69678 K  |   69678 K  |
|       from large pool |       2    |    1018    |   33625 K  |   33625 K  |
|       from small pool |       0    |    4690    |   36052 K  |   36052 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |   69678 K  |   69678 K  |
|       from large pool |       2    |    1018    |   33625 K  |   33625 K  |
|       from small pool |       0    |    4690    |   36052 K  |   36052 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     211    |     725    |     725    |     514    |
|       from large pool |     192    |     699    |     699    |     507    |
|       from small pool |      19    |      26    |      26    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1249    |   36277 K  |   36277 K  |
|       from large pool |       4    |     469    |   21026 K  |   21026 K  |
|       from small pool |       0    |    1067    |   15250 K  |   15250 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |  16640 KiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |      0 KiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |  16640 KiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |      0 KiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  28168 MiB |   1089 TiB |   1089 TiB |
|       from large pool |  16640 KiB |  28119 MiB |   1082 TiB |   1082 TiB |
|       from small pool |      0 KiB |     49 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4562 MiB |  29180 MiB |  29180 MiB |  24618 MiB |
|       from large pool |   4524 MiB |  29128 MiB |  29128 MiB |  24604 MiB |
|       from small pool |     38 MiB |     52 MiB |     52 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1608 MiB | 225863 GiB | 225863 GiB |
|       from large pool | 134912 KiB |   1606 MiB | 218792 GiB | 218792 GiB |
|       from small pool |      0 KiB |     32 MiB |   7070 GiB |   7070 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |   69678 K  |   69678 K  |
|       from large pool |       2    |    1018    |   33625 K  |   33625 K  |
|       from small pool |       0    |    4690    |   36052 K  |   36052 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |   69678 K  |   69678 K  |
|       from large pool |       2    |    1018    |   33625 K  |   33625 K  |
|       from small pool |       0    |    4690    |   36052 K  |   36052 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     211    |     725    |     725    |     514    |
|       from large pool |     192    |     699    |     699    |     507    |
|       from small pool |      19    |      26    |      26    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1249    |   36277 K  |   36277 K  |
|       from large pool |       4    |     469    |   21026 K  |   21026 K  |
|       from small pool |       0    |    1067    |   15250 K  |   15250 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_17_19_seed_1_24051358

 Experiment start at: 2024-08-03 17:17:21.138987
before training, model accuracy: 0.06926468014717102
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9292059, 'precision': 0.8407779, 'recall': 0.7747647, 'specificity': 0.99202573, 'f1': 0.79225355, 'auroc': 0.9902905}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   306     0    1     8    2    0    26     8     5   14    113
1     0  1181    1    15    0    0     0   124     1    0      7
2     1     0  210     3   16    6     2    18     4   46      6
3     6     0    2  8141    0   38     3   179    68    2      0
4     1     0   91     1  174    3     5    12    34   17    201
5     0     0    5    37    0  430     0     0     4   43      1
6    13     0    0     5    0    0  1835     8     5   12     30
7     2     2    3   365    2    0     3  6828    43    2     14
8     5     0    7   287    2   18     8   114  2721    0    134
9     1     0   82     6    1  146     1     2     4  244      5
10    6     0    9     8   12    3    20    38    35    3  12660
---- Validation: 
scalar performance:
{'acc': 0.92780524, 'precision': 0.83575165, 'recall': 0.77119607, 'specificity': 0.99188936, 'f1': 0.7869376, 'auroc': 0.9903381}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   293     0    0     9    1    0    42     7     2   16    113
1     1  1185    0    16    0    0     0   118     4    0      8
2     0     0  214     1   13    6     1    20     4   51      2
3     5     0    0  8123    2   53     1   182    68    4      2
4     1     0   88     2  166    3     9    13    34   17    206
5     0     0    7    36    0  434     0     0     1   42      1
6    10     1    0     3    1    1  1845     7     4    7     29
7     5     4    2   366    1    1     3  6812    54    1     16
8     3     0   11   289    6   16     6   103  2719    2    141
9     0     0   80     6    1  158     1     8     3  236      0
10    3     0    8     7   14    0    30    39    28    8  12659
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6670398, 'precision': 0.60343087, 'recall': 0.5698799, 'specificity': 0.9667682, 'f1': 0.5481485, 'auroc': 0.85086554}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   916    0    3   24    1    1    93    20     4   72    36
1     0  838    0   45    0    0    20   554     0    2    40
2     1    0  193   51  179   63    56    91   196   70   115
3     0    0    0    0    0    0     0     0     0    0     0
4     0    0    3    0   88    0    16     9    14    1  1502
5     1    0    1   72    1  451     4     0     0   62     0
6     0    0    0   38    0    0  2990    13     2    0    24
7     0    0    0   36    0    0     2  1122     0    0     4
8     1    0    3  281    1    9    21    14  1025    6     9
9     6    7  247  161   14  273     8    87    56  268    10
10    0    0    0    0    0    0     2     1     0    0  1643
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 18:27:54.611848,epoch time: 1:10:33.472861,used: 1:10:33.472861,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_17_19_seed_1_24051358
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9448309, 'precision': 0.86766756, 'recall': 0.8063543, 'specificity': 0.9938107, 'f1': 0.8261454, 'auroc': 0.99473494}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   397     0    0    13    0    0    12     8     5    4     44
1     0  1264    0    24    0    0     0    38     3    0      3
2     5     1  142     0   32    1     4    20     6   91     10
3     0     0    0  8132    0   30     1   181    91    2      0
4     4     2   23     1  193    2     5    11    22   26    250
5     4     0    0    22    0  433     0     0     5   55      2
6    11     0    0    11    0    0  1860     5     2    2     17
7     1    25    0   292    1    0     2  6894    38    1      8
8     5     0    2   128    4    5     0    97  2985    4     65
9    10     1   33     8    0   97     0     6     4  330      4
10   16     0    1     9    7    1    21    32    21    2  12684
---- Validation: 
scalar performance:
{'acc': 0.9437742, 'precision': 0.8699645, 'recall': 0.80606335, 'specificity': 0.99367595, 'f1': 0.8256451, 'auroc': 0.9946655}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   400     0    0     7    1    0    20    10     1    0     44
1     0  1265    0    20    0    0     0    41     3    0      3
2     8     1  137     0   31    6     3    28     7   78     13
3     2     1    0  8117    0   25     1   192   100    2      0
4     8     0   26     2  180    2    11     5    31   20    254
5     2     0    0    24    0  438     0     0     5   51      1
6    11     0    0    11    0    0  1859     1     3    4     19
7     0    27    0   283    1    0     1  6907    36    1      9
8     4     2    4   139    1    8     3   111  2951    2     71
9    14     0   26     5    1   83     5     5     3  346      5
10   20     0    0    14    5    0    14    34    20    6  12683
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.715665, 'precision': 0.62349117, 'recall': 0.61415976, 'specificity': 0.9711697, 'f1': 0.58975744, 'auroc': 0.8623458}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1020     1    0   21    0    1    97    15     3    5     7
1      0  1300    0   40    0    0    18   113     0    0    28
2     12     2   77   21  133   18   115    40   165  109   323
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    0    0   28    0     8     3     6    0  1586
5     12     0    0   30    0  456    15     0     1   78     0
6      0     0    0   32    0    0  3011     4     1    0    19
7      0     0    0   80    0    0     3  1078     0    1     2
8      0     0    0  147    1    5    30    16  1157    3    11
9     27    22  124   88    8  162    67    59    92  456    32
10     0     0    0    0    0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 19:35:32.942499,epoch time: 1:07:38.330651,used: 2:18:11.803512,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_17_19_seed_1_24051358
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94873714, 'precision': 0.871995, 'recall': 0.8194956, 'specificity': 0.99440444, 'f1': 0.83968925, 'auroc': 0.99642944}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   386     0    0     6    0    1    16     6     5    6     57
1     0  1268    0    10    0    0     0    50     4    0      0
2     1     3  134     0   64    5     1    19    14   69      2
3     0     0    0  8014    0    7     0   327    90    0      0
4     5     3    8     1  323    2     2     6    45   11    133
5     0     0    1    39    0  441     0     0     7   31      1
6     9     3    0     3    1    1  1861     5     5    3     17
7     0    18    0   104    1    0     2  7085    47    0      8
8     1     4    1   130    7    3     0    95  3026    1     28
9     1     1   32    15    5  131     1     8    10  286      3
10    7    27    0     7   54    2     9    13    35    0  12636
---- Validation: 
scalar performance:
{'acc': 0.9494182, 'precision': 0.87906635, 'recall': 0.8243533, 'specificity': 0.9944655, 'f1': 0.8453311, 'auroc': 0.99619484}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   392     1    0     7    0    1    16     8     3    4     51
1     0  1274    0    13    0    0     0    44     1    0      0
2     0     3  128     3   65    3     1    23    14   69      3
3     0     1    0  8006    0    8     3   326    94    2      0
4     3     6   10     0  329    1     5     6    33    9    137
5     0     0    0    41    0  443     0     0     8   28      1
6     4     1    0     7    0    0  1859     3    10    4     20
7     0    24    0   108    2    0     2  7072    51    0      6
8     0     3    2   115    6    2     0    90  3046    0     32
9     0     2   29    16    4  118     0     6    12  306      0
10    8    23    0     6   43    0     8    16    52    1  12639
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70202196, 'precision': 0.62975657, 'recall': 0.5781123, 'specificity': 0.97001266, 'f1': 0.5508158, 'auroc': 0.8697902}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   854     3   0   39    0    0   211    32     2   14    15
1     0  1350   0   25    0    0     1   119     1    0     3
2     1    27  22   40  182   14    68    73   439   28   121
3     0     0   0    0    0    0     0     0     0    0     0
4     0    20   0    0  320    0    28     3    24    0  1238
5     1     0   0  214    1  316     6     0    20   34     0
6     0     3   0   13    0    0  3036     5     8    0     2
7     0     1   0   11    0    0     3  1148     0    0     1
8     0     0   0   81    0    0     1    33  1254    0     1
9     4    38  35  268   17  170    32   173   274  119     7
10    0    11   0    0   13    0     7     0     0    0  1615
better model found
persisted
after epoch: 3,now: 2024-08-03 20:44:19.820335,epoch time: 1:08:46.877836,used: 3:26:58.681348,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_17_19_seed_1_24051358
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9551584, 'precision': 0.8918591, 'recall': 0.8571305, 'specificity': 0.9949776, 'f1': 0.87316173, 'auroc': 0.99686325}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   422     0    0     5    2    0     3     2     0    1     48
1     0  1300    0     3    0    0     0    23     5    0      1
2     4     0  207     0   48    0     1     2     1   46      3
3     0     2    2  8007    0    5     2   317   102    3      0
4     4     1   15     1  321    0     0     4     3    7    183
5     3     0    0    37    0  411     0     0     7   62      1
6    14     1    1     1    1    0  1858     8     1    1     19
7     0    16    4    64    2    0     1  7149    16    0     10
8     1     5    9    56   39    1     0   161  2929    2     92
9     9     0   28     9    5   71     1     1     3  364      2
10    7     3    2     5   21    0     7    14     3    0  12732
---- Validation: 
scalar performance:
{'acc': 0.95434, 'precision': 0.8908384, 'recall': 0.8533472, 'specificity': 0.99489367, 'f1': 0.8703804, 'auroc': 0.9967693}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     0    0     3    2    0     7     3     0    2     45
1     0  1286    0     5    0    0     0    36     3    0      2
2     3     1  199     0   46    0     1     3     1   54      4
3     2     2    1  8012    0   10     2   314    95    2      0
4     2     0   14     1  330    0     1     6     2    4    179
5     5     0    1    32    0  409     1     0     4   68      1
6    13     2    1     1    2    0  1859     4     2    1     23
7     0    26    2    56    2    0     1  7142    26    2      8
8     0     2    8    59   26    0     1   178  2929    1     92
9    13     0   30     3    3   72     3     4     3  357      5
10    8     0    0     4   20    0     6    19     4    1  12734
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7248303, 'precision': 0.6270299, 'recall': 0.61125135, 'specificity': 0.9718282, 'f1': 0.59385115, 'auroc': 0.86721456}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1086     0    0   4    1    0    67     4     1    2     5
1      1  1327    0  18    0    0     8   130     2    0    13
2     25     1   90   1  375    6    83    31    88   31   284
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    0   0   75    0     5     2     2    0  1547
5     22     0    0  49    3  347    56     0    11  103     1
6      0     0    0   0    0    0  3063     1     0    0     3
7      1     0    0  49    0    0     6  1105     0    0     3
8      0     0    0  43   15    2    53    11  1231    2    13
9     70    16  218  32   35   83   110    43   106  390    34
10     0     0    0   0    0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-03 21:57:48.431754,epoch time: 1:13:28.611419,used: 4:40:27.292767,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_17_19_seed_1_24051358
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9611783, 'precision': 0.9013162, 'recall': 0.87334156, 'specificity': 0.9957329, 'f1': 0.8827064, 'auroc': 0.99763674}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    0     3    1    0     5     1     0    6     22
1     0  1261    0     8    0    0     0    51     6    1      5
2     0     0  190     0   39    1     1     1     1   77      2
3     6     0    0  8256    0   17     1    85    62    9      0
4     7     0   14     0  338    1     1     4    13   15    146
5     0     0    0    13    0  407     0     0     2   98      1
6    12     0    1     0    1    0  1875     1     2    0     16
7     6     3    2   194    1    1     2  6991    43    8     12
8     7     0    4   132    6   10     0    67  3028    9     32
9     1     0   16     3    5   28     0     1     2  436      0
10   21     0    1     7   23    0     4    10    28    3  12698
---- Validation: 
scalar performance:
{'acc': 0.96113414, 'precision': 0.89570606, 'recall': 0.86650264, 'specificity': 0.9957457, 'f1': 0.876206, 'auroc': 0.9978498}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     3    1    1     1     1     0    4     26
1     0  1261    0     8    0    0     0    57     5    0      1
2     0     0  174     0   46    0     0     2     2   88      0
3     2     0    1  8260    0   20     2    88    60    7      0
4     5     0   16     0  344    1     0     2    12   11    148
5     1     0    1     9    0  393     1     0     2  113      1
6     9     0    0     0    1    0  1879     2     1    2     14
7     4     4    1   204    1    1     2  6995    38    9      6
8     6     0    4   122    4    8     1    59  3053    7     32
9     0     0   22     2    1   40     0     0     1  427      0
10   23     0    1     8   18    0     8     6    28    4  12700
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7205625, 'precision': 0.62098587, 'recall': 0.61411786, 'specificity': 0.97187287, 'f1': 0.59350145, 'auroc': 0.86397827}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1091     0    0   15    1    1    31     4     1   20     6
1      2  1161    1   30    2    0    25   202     4    2    70
2     33     0   56   12  306    8    12    38   161   75   314
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    0    0   81    0     2     2     9    0  1539
5      6     0    0   69    3  393     2     0     2  116     1
6      0     0    0    9    0    0  3030     2     2    0    24
7      5     0    0   52    0    1     0  1102     1    0     3
8      2     0    0  109    1    4     4     8  1235    3     4
9     41     1  154   85   44  141     8    50    68  505    40
10     0     0    0    0    1    0     0     0     0    0  1645
better model found
persisted
after epoch: 5,now: 2024-08-03 23:19:32.861843,epoch time: 1:21:44.430089,used: 6:02:11.722856,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_17_19_seed_1_24051358
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96417487, 'precision': 0.9101008, 'recall': 0.87893593, 'specificity': 0.99603724, 'f1': 0.89219505, 'auroc': 0.9980314}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     0    0     2    3    0     3     1     4    0     29
1     0  1273    0     7    0    0     0    46     2    0      3
2     3     0  229     1   45    0     0     2     7   25      0
3     2     0    1  8261    1    7     0   131    33    2      0
4     5     0   11     1  378    0     0     3    12    4    125
5     3     0    5    27    0  365     0     0     5  115      1
6     7     0    2     2    2    0  1865     2     2    0     25
7     0     6    0   129    3    0     3  7091    20    2     11
8     3     0    3   119    4    2     0   121  3031    2     11
9     2     0   52     4    3   14     0    12     2  403      1
10   13     0    2     8   26    0     3     9    29    1  12700
---- Validation: 
scalar performance:
{'acc': 0.963916, 'precision': 0.9077588, 'recall': 0.87883794, 'specificity': 0.9960173, 'f1': 0.8912239, 'auroc': 0.9981128}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    0     4    1    0     4     2     0    2     25
1     0  1275    0     7    0    0     0    46     2    0      2
2     3     0  219     0   46    0     0     4     7   32      1
3     0     0    1  8257    0    4     1   145    30    2      0
4     5     0   14     0  386    1     0     3    10    4    116
5     0     0    3    32    0  368     0     0     4  113      1
6     4     0    1     5    0    1  1869     1     4    1     22
7     2     4    0   128    2    0     1  7104    18    0      6
8     4     0    4   121    9    2     1   125  3008    0     22
9     6     0   48     3    3   20     0     7     0  406      0
10   14     0    2     6   37    0     5    11    22    0  12699
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6915273, 'precision': 0.61925906, 'recall': 0.57634115, 'specificity': 0.96922123, 'f1': 0.568401, 'auroc': 0.85988986}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1037     0    0   41    1    0    65    3     1    4    18
1      0  1177    0   32    1    0     2  245     4    0    38
2     12     0   84   14  363    7    10   54   209   43   219
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    1    0  166    0     1    3    10    0  1452
5     13     0    0  130    4  314     2    1     7  120     1
6      1     0    0   27    0    0  2989    2     3    0    45
7      0     0    0  168    0    0     2  991     0    0     3
8      0     0    0  168    0    1     4   23  1170    2     2
9     28     1  175  170   35  123     5  148   108  313    31
10     0     0    0    0    2    0     0    1     0    0  1643
better model found
persisted
after epoch: 6,now: 2024-08-04 00:50:52.333883,epoch time: 1:31:19.472040,used: 7:33:31.194896,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_17_19_seed_1_24051358
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9590379, 'precision': 0.8994292, 'recall': 0.8828821, 'specificity': 0.99554276, 'f1': 0.88823164, 'auroc': 0.9979097}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    0     2    3    0     1     5     2    0     20
1     0  1234    0     5    0    0     0    88     3    0      2
2     3     0  195     0   66    1     0    10     3   33      1
3     1     0    0  8115    1    3     0   246    70    1      0
4     6     0    8     1  455    0     0     4     1    2     62
5     0     0    0    39    0  432     0     0     3   46      1
6     6     0    0     3    3    1  1872     5     1    0     17
7     0     3    0    63    2    0     1  7182     9    0      4
8     2     0    2    65   60    1     0   169  2912    3     80
9     4     0   35     5    8   66     0     3     1  371      0
10   14     1    1     5  118    0     2    21     3    1  12627
---- Validation: 
scalar performance:
{'acc': 0.9597967, 'precision': 0.902773, 'recall': 0.88773304, 'specificity': 0.99563015, 'f1': 0.8925636, 'auroc': 0.9978768}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    0     2    1    0     3     6     1    3     22
1     0  1234    0     7    0    0     1    88     2    0      0
2     1     0  200     1   60    0     1    13     0   35      1
3     0     0    1  8120    0    3     0   243    73    0      0
4     6     0    5     1  451    0     1     4     3    4     64
5     0     0    0    31    1  447     0     0     2   39      1
6     9     0    1     3    4    0  1872     5     2    1     11
7     0     3    0    66    2    0     1  7179     9    0      5
8     3     0    4    60   58    0     0   163  2930    3     75
9     2     0   32     6    7   61     0     2     1  382      0
10    9     0    2     6  130    0     5    18     4    0  12622
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7421815, 'precision': 0.6594934, 'recall': 0.6316509, 'specificity': 0.97407854, 'f1': 0.62085414, 'auroc': 0.87191784}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1104     0    0   14    3    0    32     7     1    5     4
1      0  1186    0   24    0    0     2   277     0    0    10
2     36     1   64   11  485    9    62    77    41   65   164
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    0    0  496    0     6     4     2    0  1123
5      9     0    0  103    2  418     4     0     1   54     1
6      0     0    0    5    1    0  3047     2     0    0    12
7      0     0    0   17    0    1     0  1143     0    0     3
8      0     0    0  151   24    5    11    27  1138    1    13
9     54     8  141  106   29  172    52   114    33  412    16
10     0     0    0    0   45    0     0     1     0    0  1600
new oracle model saved
early stop counter: 1
val acc:0.9597967267036438, best validation acc: 0.963916003704071, corresponding to test acc:                         0.6915273070335388 / 0.7421814799308777
after epoch: 7,now: 2024-08-04 02:05:04.089953,epoch time: 1:14:11.756070,used: 8:47:42.950966,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_17_19_seed_1_24051358
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9664758, 'precision': 0.8978301, 'recall': 0.8888897, 'specificity': 0.9963976, 'f1': 0.889572, 'auroc': 0.99807966}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     1    0     0    1    0     3     0     0    2     40
1     0  1321    0     5    0    0     0     3     3    0      0
2     1     0  265     0   35    0     0     0     1    9      1
3     0    11    2  8204    0   12     0   140    65    3      0
4     3     0   18     0  417    1     0     0     7    0     92
5     0     0    1    13    0  356     0     0     1  149      1
6     3     0    1     1    2    0  1865     1     2    1     31
7     0    63    5    95    3    0     3  7042    35    0     18
8     0     1    4    55   12    1     1    48  3150    2     22
9     0     0  129     2    3    8     0     0     2  348      1
10    7     0    2     5   26    0     1     3    29    1  12719
---- Validation: 
scalar performance:
{'acc': 0.96586865, 'precision': 0.8939146, 'recall': 0.8845564, 'specificity': 0.9963522, 'f1': 0.88594407, 'auroc': 0.9982303}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     0    1     1    1    0     3     0     1    3     32
1     0  1319    0     3    0    0     0     7     3    0      0
2     0     0  249     1   45    0     0     0     1   14      2
3     0     6    0  8194    0    8     0   153    75    4      0
4     3     1   15     0  408    1     0     0     9    0    102
5     0     0    2     9    0  357     0     0     2  150      1
6     6     1    1     2    3    0  1865     1     2    0     27
7     0    67    9    95    2    0     2  7043    35    0     12
8     0     3    6    57    9    1     1    44  3160    0     15
9     1     0  121     1    5   10     1     0     1  353      0
10    3     1    3     7   36    0     2     2    21    1  12720
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7031414, 'precision': 0.65893507, 'recall': 0.5707892, 'specificity': 0.9702023, 'f1': 0.5748699, 'auroc': 0.85416985}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   918     5    0   31    0    1   149    0     3   20    43
1     0  1420    1   24    0    0    13   23     5    0    13
2     3     9  150   19  229    1    19    3   347   41   194
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    2    0  190    0     6    0    31    0  1404
5     4     0    4   91    3  170     3    0     9  305     3
6     0     0    0    7    0    0  3050    0     5    0     5
7     1     2    1  295    0    0    27  829     6    0     3
8     0     0    0  108    0    0     1    1  1257    2     1
9     5    31  271  156   16   15    17    7   161  427    31
10    0     0    0    0    4    0     2    0     1    0  1639
better model found
persisted
after epoch: 8,now: 2024-08-04 03:22:40.377486,epoch time: 1:17:36.287533,used: 10:05:19.238499,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_17_19_seed_1_24051358
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9734054, 'precision': 0.9175087, 'recall': 0.919842, 'specificity': 0.9971291, 'f1': 0.9181283, 'auroc': 0.99897784}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    1     0    1    0     2     0     1    3     10
1     0  1300    0     4    0    0     0    25     2    0      0
2     0     0  246     1   16    2     0     0     0   46      1
3     1     5    0  8328    0    8     1    87     8    1      0
4     6     0   28     2  411    1     0     0     5    7     78
5     0     0    0     8    1  469     0     0     1   41      0
6    12     0    1     1    1    0  1884     0     1    5      3
7     0    14    5   116    1    0     1  7096    22    4      5
8     1     0    7   135   10    3     0    32  3085    5     17
9     0     0   27     0    0   48     0     0     1  417      0
10   35     0    2     5   39    0     5     7    14    5  12681
---- Validation: 
scalar performance:
{'acc': 0.9731978, 'precision': 0.91588706, 'recall': 0.9162208, 'specificity': 0.99710363, 'f1': 0.91537446, 'auroc': 0.99893826}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     0    0    0     3     2     0    4      8
1     0  1305    0     2    0    0     1    19     4    0      1
2     0     0  238     0   13    0     0     0     2   59      0
3     5     5    1  8315    0   10     0    87    16    1      0
4     5     0   34     0  401    1     0     1     4   12     81
5     0     0    0     9    0  478     0     0     0   33      1
6     8     0    0     2    0    0  1885     3     1    2      7
7     0    13    6   102    2    0     1  7115    17    2      7
8     2     0    8   138   10    4     0    37  3077    2     18
9     0     0   24     2    1   56     0     0     0  410      0
10   27     0    4     6   38    0     5     6    14    3  12693
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75288606, 'precision': 0.69629705, 'recall': 0.6509545, 'specificity': 0.9752131, 'f1': 0.6491749, 'auroc': 0.8630498}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1079     0    0    6    0    1    36     2     1   43     2
1      1  1182    0   36    1    3    38   200     3    1    34
2      4     1  267   25  242   21    57     9   116  169   104
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    5    0  323    0     9     0     8    2  1285
5      3     0    0   50    0  447     1     0     2   89     0
6      1     0    0    4    0    0  3060     1     0    0     1
7      1     0    0   99    0    1     8  1047     5    0     3
8      0     0    1  190    0    5    30     3  1135    5     1
9      9     3  134  106    4  202    22    21    35  584    17
10     0     0    0    0    8    0     1     0     0    0  1637
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-04 04:33:11.045857,epoch time: 1:10:30.668371,used: 11:15:49.906870,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_17_19_seed_1_24051358
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.972683, 'precision': 0.9377011, 'recall': 0.89989674, 'specificity': 0.9969991, 'f1': 0.9160205, 'auroc': 0.9989307}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     0    0     3    1    0    12     0     1    2     23
1     0  1286    0    11    0    0     0    32     3    0      0
2     0     0  207     2   48    2     2     4     8   39      0
3     0     0    0  8364    0   11     1    15    46    0      0
4     3     0    7     2  368    1     3     1    35    3    116
5     0     0    0     5    0  486     0     0     6   23      1
6     2     0    0     4    0    0  1889     0     3    1      8
7     0     4    0   223    2    0     1  6991    39    0      3
8     0     0    2    54    1    1     0    17  3220    0      1
9     1     0   13     3    5   58     4     0     1  408      0
10    3     0    1     7    8    0    21     3    55    0  12695
---- Validation: 
scalar performance:
{'acc': 0.97268957, 'precision': 0.9371453, 'recall': 0.89911705, 'specificity': 0.9969898, 'f1': 0.9156667, 'auroc': 0.99884146}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     0    0     4    2    0    12     2     1    1     19
1     0  1275    0    10    0    0     0    43     4    0      0
2     0     0  214     1   46    0     1     2     5   43      0
3     0     0    0  8383    0    4     1    15    37    0      0
4     2     1    7     2  369    0     3     1    31    0    123
5     0     0    0     2    0  487     0     0     5   26      1
6     2     0    0     3    0    0  1891     0     3    1      8
7     0     5    0   229    1    0     3  6984    40    0      3
8     0     0    2    56    1    0     0    14  3220    1      2
9     2     0   16     2    3   65     4     4     4  393      0
10    4     1    1     7    7    1    16     6    46    1  12706
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72594976, 'precision': 0.64721155, 'recall': 0.6188328, 'specificity': 0.9723511, 'f1': 0.5992377, 'auroc': 0.85459995}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   984     0    0   10    3    1   111     1     1   36    23
1     0  1217    0   43    0    0    16   198     5    0    20
2     3     0  109    7  240   15    28    20   282  127   184
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  107    0     8     1    27    0  1489
5     4     0    0   36    0  409     1     0     8  133     1
6     0     0    0   10    0    0  3053     1     3    0     0
7     0     0    0  139    0    1     9  1007     5    0     3
8     0     0    0   58    0    5     6     5  1292    3     1
9     5     5   74   61   16  188     6    52   145  557    28
10    0     0    0    0    1    0     3     0     1    0  1641
early stop counter: 1
val acc:0.9726895689964294, best validation acc: 0.9731978178024292, corresponding to test acc:                         0.7528860569000244 / 0.7528860569000244
after epoch: 10,now: 2024-08-04 05:41:37.914062,epoch time: 1:08:26.868205,used: 12:24:16.775075,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_17_19_seed_1_24051358
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 12:24:16.775075 at 2024-08-04 05:41:37.914062
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75288606, 'precision': 0.69629705, 'recall': 0.6509545, 'specificity': 0.9752131, 'f1': 0.6491749, 'auroc': 0.8630498}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1079     0    0    6    0    1    36     2     1   43     2
1      1  1182    0   36    1    3    38   200     3    1    34
2      4     1  267   25  242   21    57     9   116  169   104
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    5    0  323    0     9     0     8    2  1285
5      3     0    0   50    0  447     1     0     2   89     0
6      1     0    0    4    0    0  3060     1     0    0     1
7      1     0    0   99    0    1     8  1047     5    0     3
8      0     0    1  190    0    5    30     3  1135    5     1
9      9     3  134  106    4  202    22    21    35  584    17
10     0     0    0    0    8    0     1     0     0    0  1637
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75288606, 'precision': 0.69629705, 'recall': 0.6509545, 'specificity': 0.9752131, 'f1': 0.6491749, 'auroc': 0.8630498}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1079     0    0    6    0    1    36     2     1   43     2
1      1  1182    0   36    1    3    38   200     3    1    34
2      4     1  267   25  242   21    57     9   116  169   104
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    5    0  323    0     9     0     8    2  1285
5      3     0    0   50    0  447     1     0     2   89     0
6      1     0    0    4    0    0  3060     1     0    0     1
7      1     0    0   99    0    1     8  1047     5    0     3
8      0     0    1  190    0    5    30     3  1135    5     1
9      9     3  134  106    4  202    22    21    35  584    17
10     0     0    0    0    8    0     1     0     0    0  1637
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_17_17_19_seed_1_24051358_instance_wise_predictions.txt
accuracy from prediction file 0.752886028125656
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/15.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/15.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4044 MiB |  28236 MiB |   2186 TiB |   2186 TiB |
|       from large pool |   4020 MiB |  28187 MiB |   2172 TiB |   2172 TiB |
|       from small pool |     23 MiB |     50 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   4044 MiB |  28236 MiB |   2186 TiB |   2186 TiB |
|       from large pool |   4020 MiB |  28187 MiB |   2172 TiB |   2172 TiB |
|       from small pool |     23 MiB |     50 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4036 MiB |  28168 MiB |   2179 TiB |   2179 TiB |
|       from large pool |   4013 MiB |  28119 MiB |   2165 TiB |   2165 TiB |
|       from small pool |     22 MiB |     49 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  29192 MiB |  29192 MiB |  53810 MiB |  24618 MiB |
|       from large pool |  29140 MiB |  29140 MiB |  53744 MiB |  24604 MiB |
|       from small pool |     52 MiB |     52 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 645093 KiB |   1619 MiB | 459139 GiB | 459139 GiB |
|       from large pool | 627800 KiB |   1617 MiB | 444986 GiB | 444986 GiB |
|       from small pool |  17293 KiB |     32 MiB |  14153 GiB |  14153 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3670    |    5393    |  139355 K  |  139352 K  |
|       from large pool |     502    |    1018    |   67251 K  |   67250 K  |
|       from small pool |    3168    |    4690    |   72104 K  |   72101 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3670    |    5393    |  139355 K  |  139352 K  |
|       from large pool |     502    |    1018    |   67251 K  |   67250 K  |
|       from small pool |    3168    |    4690    |   72104 K  |   72101 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     722    |     725    |    1236    |     514    |
|       from large pool |     696    |     699    |    1203    |     507    |
|       from small pool |      26    |      26    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     223    |    1249    |   72364 K  |   72363 K  |
|       from large pool |     184    |     469    |   41849 K  |   41849 K  |
|       from small pool |      39    |    1067    |   30514 K  |   30514 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  28236 MiB |   2186 TiB |   2186 TiB |
|       from large pool |  16640 KiB |  28187 MiB |   2172 TiB |   2172 TiB |
|       from small pool |      0 KiB |     50 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  28236 MiB |   2186 TiB |   2186 TiB |
|       from large pool |  16640 KiB |  28187 MiB |   2172 TiB |   2172 TiB |
|       from small pool |      0 KiB |     50 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  28168 MiB |   2179 TiB |   2179 TiB |
|       from large pool |  16640 KiB |  28119 MiB |   2165 TiB |   2165 TiB |
|       from small pool |      0 KiB |     49 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4674 MiB |  29192 MiB |  53810 MiB |  49136 MiB |
|       from large pool |   4634 MiB |  29140 MiB |  53744 MiB |  49110 MiB |
|       from small pool |     40 MiB |     52 MiB |     66 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1619 MiB | 459142 GiB | 459142 GiB |
|       from large pool | 134912 KiB |   1617 MiB | 444989 GiB | 444988 GiB |
|       from small pool |      0 KiB |     32 MiB |  14153 GiB |  14153 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |  139355 K  |  139355 K  |
|       from large pool |       2    |    1018    |   67251 K  |   67251 K  |
|       from small pool |       0    |    4690    |   72104 K  |   72104 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |  139355 K  |  139355 K  |
|       from large pool |       2    |    1018    |   67251 K  |   67251 K  |
|       from small pool |       0    |    4690    |   72104 K  |   72104 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     213    |     725    |    1236    |    1023    |
|       from large pool |     193    |     699    |    1203    |    1010    |
|       from small pool |      20    |      26    |      33    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1249    |   72364 K  |   72364 K  |
|       from large pool |       4    |     469    |   41850 K  |   41850 K  |
|       from small pool |       0    |    1067    |   30514 K  |   30514 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug  4 05:50:25 2024]
Finished job 0.
1 of 1 steps (100%) done
