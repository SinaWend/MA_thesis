Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug  3 20:50:54 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/12.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=12
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_21_07_01_seed_0_24051364

 Experiment start at: 2024-08-03 21:07:03.232062
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.044287413358688354
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9161227, 'precision': 0.841064, 'recall': 0.6860554, 'specificity': 0.990539, 'f1': 0.72803664, 'auroc': 0.9874103}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   237     0   0    27   0    1    94    17    19   15     73
1     0  1117   0    28   0    0     0   176     5    0      6
2     1     2  72    25  13    5     4    78    18   78     16
3     0     0   0  8077   0    2     0   300    58    0      1
4     0     1  19    18  94    4     8    43    83   18    251
5     2     0   0   120   0  306     0     1     7   84      1
6     5     1   0    30   0    1  1819    20    11    3     18
7     0     2   0   237   1    0     2  6997    17    0      8
8     0     1   2   351   1    0     4   216  2677    4     39
9     1     1  24    75   1   86     2    19     7  274      3
10   10     1   0    13   3    4    51    68    68    2  12571
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9151264, 'precision': 0.82525766, 'recall': 0.678067, 'specificity': 0.9904212, 'f1': 0.7195989, 'auroc': 0.9872178}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   239     0   0    30   0    0    93    21    17   18     65
1     0  1103   0    27   0    0     1   189     4    0      8
2     0     1  65    35  18    6     4    84    16   65     18
3     0     0   0  8087   0    5     0   287    60    0      1
4     0     0  30    10  93    5    10    33    93   15    250
5     1     0   0   137   0  283     0     0     6   93      1
6     3     1   0    33   0    0  1811    20    11    3     26
7     0     3   0   235   0    0     2  6999    14    0     12
8     3     0   1   347   1    0     6   194  2684    2     58
9     0     0  28    65   0   94     1    25    10  268      2
10   12     1   0    18   7    4    46    62    62    4  12580
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.56755054, 'precision': 0.56803995, 'recall': 0.46866187, 'specificity': 0.95723176, 'f1': 0.43703485, 'auroc': 0.8428001}
confusion matrix:
     0    1   2    3   4    5     6     7     8    9     10
0   468    0   0  371   0    1   172    87    42   20     9
1     0  779   0   46   0    0     2   641     3    0    28
2     9    1  11   73  23   73    15   196   367   37   210
3     0    0   0    0   0    0     0     0     0    0     0
4     2    1   0    0  13    0     0     8    39    0  1570
5     3    0   0  260   0  299     3     0     9   18     0
6     1    0   0   47   0    0  2542    20   206    0   251
7     0    0   0   60   0    0     0  1101     0    0     3
8     0    0   0  225   0    2     1    38  1103    0     1
9    10    8  21  380   0  207     1   186   154  150    20
10    0    0   0    0   0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 22:26:52.531842,epoch time: 1:19:49.299780,used: 1:19:49.299780,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_21_07_01_seed_0_24051364
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93589467, 'precision': 0.83561456, 'recall': 0.76477504, 'specificity': 0.9928525, 'f1': 0.7865696, 'auroc': 0.98832774}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   390     0    0    14    0    0     7     3    14    7     48
1     0  1233    0    24    0    0     0    51    15    0      9
2     2     1  111     4   78    1     1     7    23   67     17
3     0     1    1  8110    0   20     0   130   168    6      3
4     3     0    8     2  149    0     1     3    52   14    307
5     3     0    1    40    0  286     0     0    11  179      1
6    46     0    1    17    0    1  1800     3    11    2     27
7     1     6    3   316    2    0     2  6755   147    0     30
8     3     2    3    90    4    2     1    33  3078    2     77
9     3     1   44    12    3   33     0     4    25  363      5
10   18     0    1     8    5    2     8    11    33    1  12705
---- Validation: 
scalar performance:
{'acc': 0.9359904, 'precision': 0.83626425, 'recall': 0.7698533, 'specificity': 0.992889, 'f1': 0.78825194, 'auroc': 0.9883907}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   402     0    0    11    0    1     4     4     9    5     47
1     0  1240    0    20    1    0     0    50    11    0     10
2     2     1  106     3   75    0     0     9    23   73     20
3     0     1    1  8082    0   23     0   137   193    2      1
4     2     0   11     1  147    0     3     2    48   16    309
5     1     0    2    40    0  290     1     0    11  175      1
6    57     0    0    12    0    1  1796     6    12    1     23
7     2    10    1   297    2    0     2  6766   155    1     29
8     3     1    2    95    2    0     0    37  3089    4     63
9     3     0   45    13    2   28     1     0    12  383      6
10   20     0    1     7    3    0    16     9    46    3  12691
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70454067, 'precision': 0.60586953, 'recall': 0.59079957, 'specificity': 0.9702702, 'f1': 0.5637988, 'auroc': 0.8378371}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1036     1    0  44    0    0     1    16    56    6    10
1      0  1223    0  30    0    2     4   184    24    0    32
2     23     3   40   8  118    7     0    24   307  113   372
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    0   0   20    0     1     2     9    1  1599
5     15     0    0  85    0  237     0     0    19  232     4
6     15     0    0   3    1    0  2889     2    35    0   122
7      0     0    1  39    0    0     0  1113     5    1     5
8      2     0    0  51    0    2     0     3  1296    7     9
9     29     2  105  66   11   34     0    34   240  570    46
10     0     0    0   0    0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 00:02:35.206962,epoch time: 1:35:42.675120,used: 2:55:31.974900,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_21_07_01_seed_0_24051364
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9440015, 'precision': 0.8593489, 'recall': 0.78747207, 'specificity': 0.9937889, 'f1': 0.81129193, 'auroc': 0.99324316}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   385     0    0     8    0    1    23     2     5    3     55
1     0  1258    0    21    0    0     0    40     7    0      6
2     0     2  109     7   93    7     2    12    24   52      4
3     2     1    0  8149    1    9     5   187    84    0      1
4     3     1    9     2  262    1     3     3    49    7    199
5     2     0    0    54    0  438     0     0     8   17      1
6     8     0    0     6    0    2  1862     2     5    0     22
7     1    11    1   238    1    0     4  6895    81    0     31
8     3     1    3   144    6    1     0    48  3036    1     53
9     0     2   28    27    3  196     1     4    15  216      1
10   11     3    1     8   19    3    16    10    49    0  12673
---- Validation: 
scalar performance:
{'acc': 0.943373, 'precision': 0.8565618, 'recall': 0.78787416, 'specificity': 0.9937242, 'f1': 0.8114563, 'auroc': 0.9934131}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   395     0    0     9    0    3    22     2     2    2     48
1     0  1253    0    22    0    0     0    47     7    0      3
2     1     1  112     9   88    4     1    14    20   59      3
3     0     1    0  8151    0    5     1   185    96    0      1
4     2     1    7     1  273    6     2     3    49    5    190
5     0     0    0    66    0  429     1     0     4   20      1
6    10     0    0     5    1    0  1855     2     6    2     27
7     3    15    0   230    2    0     3  6899    76    0     37
8     1     1    1   150    3    3     1    58  3025    0     53
9     1     0   37    28    1  196     1     3    15  209      2
10    9     1    2    10   28    2    20     8    49    0  12667
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69306654, 'precision': 0.6202152, 'recall': 0.59199744, 'specificity': 0.9692944, 'f1': 0.55228114, 'auroc': 0.8584098}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1081     1   0   21    0    2    18     4    22    8    13
1      0  1268   0   38    1    0     1   138    20    0    33
2      5     3  15   38  219   35     1    11   376   32   280
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   0    0   60    0     0     0    13    0  1560
5      4     0   0  128    1  430     0     0    12   13     4
6      0     0   0    5    8    0  2844     1    59    0   150
7      0     0   0   65    0    0     0  1079    13    0     7
8      0     0   0   62    1    2     1     1  1299    1     3
9     13     6  22  220   38  252     0    31   328  184    43
10     0     0   0    0    0    0     0     0     0    0  1646
better model found
persisted
after epoch: 3,now: 2024-08-04 01:24:42.435548,epoch time: 1:22:07.228586,used: 4:17:39.203486,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_21_07_01_seed_0_24051364
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95111835, 'precision': 0.88064337, 'recall': 0.83257467, 'specificity': 0.99460787, 'f1': 0.8547693, 'auroc': 0.99518806}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   399     0    0     9    0    0    13    11     2    0     49
1     0  1267    0    13    0    0     0    43     6    0      3
2     2     0  194     4   30    1     1    13    14   52      0
3     0     1    0  8148    0    1     0   210    77    0      1
4     2     0   28     2  319    0     0     9    39    5    135
5     0     0    0    66    0  382     1     0    10   60      2
6     4     0    0     3    1    0  1869     6    10    1     13
7     0    10    0   157    2    0     1  7066    20    0      7
8     1     2    4   159    5    0     1   120  2982    0     22
9     7     0   58    28    0   72     2     8    11  307      0
10    6     0    1     9   83    0    10    30    38    0  12616
---- Validation: 
scalar performance:
{'acc': 0.95174533, 'precision': 0.8850301, 'recall': 0.8358606, 'specificity': 0.9946817, 'f1': 0.85859287, 'auroc': 0.99494314}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   396     1    0     7    0    0    12    16     6    2     43
1     0  1260    0    12    0    0     0    55     3    0      2
2     3     1  193     6   34    2     1    14    12   45      1
3     1     1    0  8139    0    3     0   218    77    0      1
4     5     0   28     3  331    0     1    10    38    3    120
5     3     0    0    67    0  378     0     0     8   64      1
6     7     0    1     4    1    0  1873     1     5    0     16
7     0     7    0   140    1    0     1  7086    25    0      5
8     0     0    2   155    6    0     1   138  2969    2     23
9     3     0   53    27    0   68     2     4     9  326      1
10    3     0    2    11   68    0     6    30    46    0  12630
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7304974, 'precision': 0.6721082, 'recall': 0.61075777, 'specificity': 0.9730874, 'f1': 0.6071314, 'auroc': 0.8751449}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1050     1    0   31    1    0    24    37    19    1     6
1      0  1197    0   28    1    0     1   243     8    0    21
2     17     4  171   21  269    2     2    57   303   53   116
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    0    0  345    0     4     3    12    0  1267
5     19     0    0  148    1  264     0     0    21  136     3
6      0     0    0    4    1    0  3015     3     2    0    42
7      0     0    0   49    0    0     0  1112     0    0     3
8      0     0    0   85    0    0     0    18  1262    2     3
9     29    12  187  168   12   42     0    66   208  393    20
10     0     0    0    0   13    0     1     0     0    0  1632
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-04 02:39:07.492778,epoch time: 1:14:25.057230,used: 5:32:04.260716,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_21_07_01_seed_0_24051364
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9539009, 'precision': 0.88593775, 'recall': 0.85066366, 'specificity': 0.9949391, 'f1': 0.8628185, 'auroc': 0.995828}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     1    0     2    0    0     3     2    11    2     37
1     0  1295    0     6    0    0     0    23     5    0      2
2     0     2  207     0   26    0     1     2     6   63      5
3     4     5    0  8000    0   17     2   244   162    0      2
4     4     1   38     1  259    1     1     3    26   11    194
5     4     0    2    19    0  389     0     0     7   99      1
6    12     2    3     4    1    0  1835     3     9    2     37
7     1    37    4   104    1    0     1  7007    87    0     19
8     1     2    6    72    3    4     0    50  3123    4     31
9     3     0   41     4    0   45     0     2     3  393      2
10    7     1    2     6   16    0     2     6    34    2  12720
---- Validation: 
scalar performance:
{'acc': 0.9547412, 'precision': 0.88815, 'recall': 0.8511454, 'specificity': 0.9950218, 'f1': 0.8642936, 'auroc': 0.9956853}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   433     1    2     2    0    0     0     4     3    3     35
1     0  1290    0     7    0    0     0    23     5    0      7
2     2     0  204     0   27    0     1     5     6   65      2
3     0     7    0  8016    0   15     1   237   159    2      3
4     4     1   32     1  270    0     0     3    18   12    198
5     6     0    0    23    0  381     0     0     4  106      1
6    12     1    1     2    0    0  1833     7     8    2     42
7     2    28    4   109    2    0     1  7011    93    1     14
8     3     1    4    55    2    3     1    47  3148    3     29
9     3     1   35     7    0   50     0     1     6  388      2
10   11     1    3     6   14    0     3     7    31    1  12719
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73364586, 'precision': 0.6471391, 'recall': 0.6167722, 'specificity': 0.97314835, 'f1': 0.59540415, 'auroc': 0.85364044}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1100     1    0   4    1    1     1    14    28   15     5
1      1  1355    0  26    1    1     0    83    13    1    18
2      7    12  106   4  195    1     0    11   320  128   231
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    3   0   62    0     1     0    14    1  1551
5      6     0    0  45    0  219     0     0    13  305     4
6      0     0    1   2    0    0  2950     1    11    0   102
7      0     0    1  16    0    0     0  1131    10    1     5
8      0     0    0  81    0    0     1     1  1280    5     2
9     12    22  125  52   17   27     1    23   194  637    27
10     0     0    0   0    0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-04 03:47:29.366749,epoch time: 1:08:21.873971,used: 6:40:26.134687,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_21_07_01_seed_0_24051364
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.945366, 'precision': 0.84730804, 'recall': 0.847174, 'specificity': 0.9942307, 'f1': 0.8419805, 'auroc': 0.9949886}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   345     0    1     1    0    2   101     0     0    6     27
1     0  1310    0    11    0    0     2     7     1    0      1
2     0     2  216     1   27    4     4     1     2   55      0
3     0    13    3  8284    0   41    10    60    26    1      1
4     2     1   55     2  348    0     7     1     5   10    108
5     0     0    0     8    0  483     2     0     3   24      1
6     2     0    0     0    1    0  1894     0     1    1      7
7     0   157    8   288    5    0    26  6732    33    3     11
8     1    12   19   221   38   23    19    55  2858    9     41
9     0     1   28     2    0  161     3     0     0  298      0
10    5     2   11     8   94    1    82    10    12    1  12566
---- Validation: 
scalar performance:
{'acc': 0.9448174, 'precision': 0.8454451, 'recall': 0.84597456, 'specificity': 0.99414766, 'f1': 0.84164673, 'auroc': 0.9949989}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   350     0    0     1    1    1    98     0     3    4     25
1     0  1303    0    10    0    0     4    12     1    0      2
2     0     0  219     1   23    2     2     0     1   64      0
3     0     7    2  8297    0   40     5    60    23    3      3
4     3     0   64     3  329    1     8     4     3    8    116
5     1     0    0     9    0  477     2     0     2   29      1
6     4     0    0     1    1    0  1893     0     2    0      7
7     0   164    9   299    7    0    20  6718    34    4     10
8     2    13    8   234   51   12    29    54  2836   14     43
9     0     0   28     4    0  148     1     1     0  311      0
10    6     0    8    10   94    0    68     8    11    2  12589
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73847336, 'precision': 0.67553574, 'recall': 0.62993085, 'specificity': 0.9733743, 'f1': 0.6347028, 'auroc': 0.86008316}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   886     0    0    8    1    3   194    1    15   48    14
1     2  1379    3   25    0    3    22   36     6    7    16
2     1    10  254    5  378    8    40    6    67   89   157
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    7    0  213    0    15    0     3    1  1394
5     1     0    1   30    2  406     3    0     3  138     8
6     0     0    0    0    0    0  3063    0     0    1     3
7     0     1    4  138    0    1    52  952     9    3     4
8     0     0    0  116   13    5    38    1  1182    6     9
9     2    17  272   39   21  105    17    6    57  579    22
10    0     0    0    0    3    0     2    0     0    0  1641
new oracle model saved
early stop counter: 1
val acc:0.9448174238204956, best validation acc: 0.9547411799430847, corresponding to test acc:                         0.7336458563804626 / 0.7384733557701111
after epoch: 6,now: 2024-08-04 04:55:52.200902,epoch time: 1:08:22.834153,used: 7:48:48.968840,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_21_07_01_seed_0_24051364
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9589576, 'precision': 0.87645596, 'recall': 0.86702645, 'specificity': 0.9956032, 'f1': 0.86995864, 'auroc': 0.99691045}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     1    0     5    0    0     5     3     3    0     41
1     0  1310    0     7    0    0     0    12     2    0      1
2     2     3  231     0   44    0     1     4     3   21      3
3     0     9    0  8161    0   27     0   170    71    1      0
4     3     0   25     2  377    0     0     1    11    2    117
5     2     0    6    15    0  349     1     0     6  141      1
6    14     2    0     3    2    0  1873     3     1    0      8
7     0   132    1    93    1    0     1  6991    30    0     14
8     1     7    9    84   18    4     0    56  3080    0     36
9     6     0   80     9    3   22     1     5     7  357      3
10    7     1    0    10   57    0     7     9    14    1  12688
---- Validation: 
scalar performance:
{'acc': 0.9601177, 'precision': 0.87710714, 'recall': 0.86959726, 'specificity': 0.99574125, 'f1': 0.8713974, 'auroc': 0.99684024}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   432     2    0     3    1    0     4     1     1    1     38
1     0  1312    0     5    0    0     0    12     2    0      1
2     4     0  231     1   45    0     1     5     5   19      1
3     0     8    1  8185    2   23     1   149    68    3      0
4     3     1   21     2  379    0     0     2    11    2    118
5     2     0    5    11    0  347     1     0     7  147      1
6    14     1    0     6    0    0  1862     5     2    0     18
7     0   119    2    96    1    0     1  7005    31    0     10
8     2     2    7    74   26    1     1    58  3096    1     28
9     5     1   85     6    0   22     1     3     6  363      1
10    5     1    1    10   61    0    11     8    16    1  12682
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7402225, 'precision': 0.6472436, 'recall': 0.61292017, 'specificity': 0.97380114, 'f1': 0.60254383, 'auroc': 0.8657375}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1119     1    0   9    0    0     2    19    11    1     8
1      1  1352    0  20    2    1     1    96     5    1    20
2     30     7  123   4  395    2     6    27    88   43   290
3      0     0    0   0    0    0     0     0     0    0     0
4      3     0    0   0  275    0     5     1     4    0  1345
5     20     0    8  32    2  201     0     0    20  306     3
6      1     0    0   2    0    0  3052     0     1    0    11
7      0     1    0  18    0    0     0  1140     1    1     3
8      0     0    1  52    9    0     1    10  1289    3     5
9     50     7  361  43   58   18     4    41   124  392    39
10     0     0    0   0    9    0     0     0     0    0  1637
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-04 06:01:45.063585,epoch time: 1:05:52.862683,used: 8:54:41.831523,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_21_07_01_seed_0_24051364
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95965326, 'precision': 0.8823484, 'recall': 0.87558365, 'specificity': 0.9957468, 'f1': 0.87704706, 'auroc': 0.99707603}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     3    1    1    12     0     4    5     10
1     0  1303    0    11    0    0     1    12     5    0      0
2     1     0  200     1   20    2     1     2     7   78      0
3     0     5    0  8288    1   10     1    68    64    0      0
4     5     0   33     1  360    1     4     4    29    4     98
5     0     0    0    21    0  463     0     0     8   28      1
6     7     0    0     2    0    0  1885     0     4    2      8
7     0    38    2   209    2    0     5  6909    93    0      5
8     2     2    3    89    3    2     3    34  3150    2      6
9     0     0   10     4    0  136     0     0    11  332      0
10   50     1    1    10   83    1    32    12    68    3  12532
---- Validation: 
scalar performance:
{'acc': 0.96046543, 'precision': 0.8796811, 'recall': 0.87572145, 'specificity': 0.99585104, 'f1': 0.87658167, 'auroc': 0.9973568}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     1    1     2    1    1    15     0     7    4      3
1     0  1298    0     6    0    0     0    20     8    0      0
2     0     0  197     1   20    3     0     1    12   78      0
3     0     4    0  8292    0    6     0    67    71    0      0
4     5     0   42     2  359    1     0     3    31    6     90
5     0     0    0    30    0  452     1     0     5   32      1
6     7     0    1     0    1    0  1889     0     4    2      4
7     2    34    1   208    1    0     5  6905   102    1      6
8     2     1    3    68    2    3     2    31  3172    2     10
9     0     0   17     9    0  116     0     0     6  345      0
10   45     0    3     7   90    2    28     7    63    1  12550
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7728958, 'precision': 0.7011361, 'recall': 0.668594, 'specificity': 0.97723496, 'f1': 0.66771466, 'auroc': 0.877835}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1049     0    1   16    0    2    32     3    10   57     0
1      2  1294   11   28    2    0    10   110    14   17    11
2      3     0  341    9  253   12    22    19   186  113    57
3      0     0    0    0    0    0     0     0     0    0     0
4      3     0    5    0  384    0    23     0     9    1  1208
5      2     0    0   52    1  435     0     0     3   98     1
6      0     0    1    2    0    0  3063     0     0    0     1
7      2     1    3  103    0    1     0  1040     4    7     3
8      0     0    1   93    2    4    10     2  1250    7     1
9      4     1  216   69   10  155     4    14    93  563     8
10     0     0    0    0   14    0     4     0     0    0  1628
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-04 07:08:16.588424,epoch time: 1:06:31.524839,used: 10:01:13.356362,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_21_07_01_seed_0_24051364
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96369326, 'precision': 0.8965138, 'recall': 0.8848659, 'specificity': 0.9961308, 'f1': 0.88826716, 'auroc': 0.9977428}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   420     1    0     6    1    0     0     6     7   15     27
1     0  1268    0     3    0    0     0    55     2    0      3
2     0     0  188     1   25    0     0     6     5   84      2
3     0     5    1  8233    0    9     0    80   107    2      0
4     3     0   33     0  421    1     0     6    13    4     58
5     0     0    1    14    0  428     0     0     6   71      1
6     6     0    2    12    4    0  1841     2     7    7     27
7     1     5    0   162    2    0     1  7043    44    3      4
8     0     0    4    51   10    1     0    46  3154    4     26
9     0     0   12     4    1   50     0     2     4  420      0
10    2     1    1     8  136    0     4    16    16    5  12603
---- Validation: 
scalar performance:
{'acc': 0.96463823, 'precision': 0.90102434, 'recall': 0.89114344, 'specificity': 0.9962381, 'f1': 0.8934061, 'auroc': 0.9978958}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   422     1    1     4    2    0     1     6     4   15     27
1     0  1268    0     8    0    0     0    52     3    0      1
2     0     0  201     0   24    1     0     4     4   78      0
3     0     4    1  8272    1    6     0    57    99    0      0
4     1     0   28     0  427    2     0     5    12    8     56
5     0     0    0    18    0  423     0     1     5   73      1
6     8     0    4     6    5    1  1844     5     4    6     25
7     0     7    0   182    2    0     1  7021    48    1      3
8     1     1    1    56   20    0     0    38  3153    5     21
9     0     0    7     5    0   47     0     1     2  431      0
10    3     1    1     8  142    2     2    18    16    2  12601
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7237109, 'precision': 0.68891203, 'recall': 0.6205484, 'specificity': 0.9723711, 'f1': 0.62671447, 'auroc': 0.86111367}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   921     2    0   35    2    1     1    18    25  155    10
1     0  1008    1   27    1    0     1   410     7   11    33
2     0     0  220   12  319    3     0    50   106  130   175
3     0     0    0    0    0    0     0     0     0    0     0
4     2     0    4    0  531    0     0     1     3    1  1091
5     0     0    0   70    1  305     0     0     6  208     2
6     0     1    0    5    3    0  2743     1     6    3   305
7     0     0    0   79    0    1     0  1083     1    0     0
8     0     0    0  107    5    0     1     7  1238    5     7
9     1     3  156   87    5   51     0    56    72  686    20
10    0     0    0    0   37    0     0     0     0    0  1609
better model found
persisted
after epoch: 9,now: 2024-08-04 08:14:48.305758,epoch time: 1:06:31.717334,used: 11:07:45.073696,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_21_07_01_seed_0_24051364
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96551263, 'precision': 0.90569437, 'recall': 0.88865346, 'specificity': 0.99625933, 'f1': 0.8952011, 'auroc': 0.997568}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    1     0    0    0     1     3     4    6     31
1     0  1293    0     8    0    0     0    25     5    0      1
2     0     0  237     2    9    0     0     6     3   52      3
3     0     3    2  8121    0   10     0   203    96    2      2
4     3     0   56     0  356    1     0     4    24    3     92
5     0     0    0     9    0  398     0     0     9  104      1
6     4     1    1     4    1    0  1831     5     5    1     55
7     0     9    1    52    1    0     1  7170    24    0      7
8     2     1    3    32    2    1     1    77  3159    1     16
9     0     0   18     0    0   46     0     0     4  423      2
10    4     0    5     5   63    0     3    13    33    1  12662
---- Validation: 
scalar performance:
{'acc': 0.9651732, 'precision': 0.9062678, 'recall': 0.8918685, 'specificity': 0.99623877, 'f1': 0.8973744, 'auroc': 0.99791294}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     2    0     1    0    0     3     5     2    4     32
1     0  1293    0     8    0    0     0    23     5    1      2
2     1     0  242     0    8    0     0     7     5   48      1
3     1     3    1  8090    0   19     0   212   113    0      1
4     6     0   50     0  362    1     0     4    25    2     89
5     0     1    1     7    0  408     0     0    14   89      1
6    12     0    1     5    3    0  1837     4     3    3     40
7     0    11    4    55    0    0     1  7161    27    0      6
8     0     0    4    33    3    0     0    78  3163    1     14
9     0     0   28     2    0   34     0     3     2  421      3
10    4     0    1     7   57    1     3    10    38    3  12672
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7445603, 'precision': 0.684041, 'recall': 0.64150685, 'specificity': 0.9742582, 'f1': 0.63250434, 'auroc': 0.8624632}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1061     1    0  10    1    2    20    19     9   38     9
1      1  1256    1  14    1    1     0   196     4    1    24
2      4     4  241   4  175    3     2    41   255   81   205
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    3   0  276    0     1     1    16    0  1334
5      2     0    2  44    1  347     0     0    24  170     2
6      0     0    0   1    0    0  2861     1     5    0   199
7      0     0    0   5    0    0     0  1155     0    1     3
8      0     0    1  57    0    0     2    31  1272    6     1
9      6    11  216  51    5   63     0    81   140  535    29
10     0     0    0   0    6    0     0     0     2    0  1638
better model found
persisted
after epoch: 10,now: 2024-08-04 09:21:32.529372,epoch time: 1:06:44.223614,used: 12:14:29.297310,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_21_07_01_seed_0_24051364
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 12:14:29.297310 at 2024-08-04 09:21:32.529372
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7445603, 'precision': 0.684041, 'recall': 0.64150685, 'specificity': 0.9742582, 'f1': 0.63250434, 'auroc': 0.8624632}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1061     1    0  10    1    2    20    19     9   38     9
1      1  1256    1  14    1    1     0   196     4    1    24
2      4     4  241   4  175    3     2    41   255   81   205
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    3   0  276    0     1     1    16    0  1334
5      2     0    2  44    1  347     0     0    24  170     2
6      0     0    0   1    0    0  2861     1     5    0   199
7      0     0    0   5    0    0     0  1155     0    1     3
8      0     0    1  57    0    0     2    31  1272    6     1
9      6    11  216  51    5   63     0    81   140  535    29
10     0     0    0   0    6    0     0     0     2    0  1638
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7728958, 'precision': 0.7011361, 'recall': 0.668594, 'specificity': 0.97723496, 'f1': 0.66771466, 'auroc': 0.877835}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1049     0    1   16    0    2    32     3    10   57     0
1      2  1294   11   28    2    0    10   110    14   17    11
2      3     0  341    9  253   12    22    19   186  113    57
3      0     0    0    0    0    0     0     0     0    0     0
4      3     0    5    0  384    0    23     0     9    1  1208
5      2     0    0   52    1  435     0     0     3   98     1
6      0     0    1    2    0    0  3063     0     0    0     1
7      2     1    3  103    0    1     0  1040     4    7     3
8      0     0    1   93    2    4    10     2  1250    7     1
9      4     1  216   69   10  155     4    14    93  563     8
10     0     0    0    0   14    0     4     0     0    0  1628
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_21_07_01_seed_0_24051364_instance_wise_predictions.txt
accuracy from prediction file 0.7445602742601274
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/12.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/12.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/12.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4043 MiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |   4020 MiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |     23 MiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   4043 MiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |   4020 MiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |     23 MiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4036 MiB |  28168 MiB |   1089 TiB |   1089 TiB |
|       from large pool |   4013 MiB |  28119 MiB |   1082 TiB |   1082 TiB |
|       from small pool |     22 MiB |     49 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  29180 MiB |  29180 MiB |  29180 MiB |      0 B   |
|       from large pool |  29128 MiB |  29128 MiB |  29128 MiB |      0 B   |
|       from small pool |     52 MiB |     52 MiB |     52 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 533085 KiB |   1608 MiB | 225861 GiB | 225860 GiB |
|       from large pool | 515792 KiB |   1606 MiB | 218791 GiB | 218791 GiB |
|       from small pool |  17293 KiB |     22 MiB |   7069 GiB |   7069 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3670    |    5393    |   69679 K  |   69675 K  |
|       from large pool |     502    |    1018    |   33625 K  |   33625 K  |
|       from small pool |    3168    |    4690    |   36053 K  |   36050 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3670    |    5393    |   69679 K  |   69675 K  |
|       from large pool |     502    |    1018    |   33625 K  |   33625 K  |
|       from small pool |    3168    |    4690    |   36053 K  |   36050 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     725    |     725    |     725    |       0    |
|       from large pool |     699    |     699    |     699    |       0    |
|       from small pool |      26    |      26    |      26    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     218    |    1249    |   36219 K  |   36219 K  |
|       from large pool |     182    |     469    |   21026 K  |   21026 K  |
|       from small pool |      36    |    1067    |   15192 K  |   15192 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |  16640 KiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |      0 KiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |  16640 KiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |      0 KiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  28168 MiB |   1089 TiB |   1089 TiB |
|       from large pool |  16640 KiB |  28119 MiB |   1082 TiB |   1082 TiB |
|       from small pool |      0 KiB |     49 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4564 MiB |  29180 MiB |  29180 MiB |  24616 MiB |
|       from large pool |   4524 MiB |  29128 MiB |  29128 MiB |  24604 MiB |
|       from small pool |     40 MiB |     52 MiB |     52 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1608 MiB | 225863 GiB | 225863 GiB |
|       from large pool | 134912 KiB |   1606 MiB | 218793 GiB | 218793 GiB |
|       from small pool |      0 KiB |     34 MiB |   7069 GiB |   7069 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |   69679 K  |   69679 K  |
|       from large pool |       2    |    1018    |   33625 K  |   33625 K  |
|       from small pool |       0    |    4690    |   36053 K  |   36053 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |   69679 K  |   69679 K  |
|       from large pool |       2    |    1018    |   33625 K  |   33625 K  |
|       from small pool |       0    |    4690    |   36053 K  |   36053 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     212    |     725    |     725    |     513    |
|       from large pool |     192    |     699    |     699    |     507    |
|       from small pool |      20    |      26    |      26    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1249    |   36220 K  |   36220 K  |
|       from large pool |       4    |     469    |   21027 K  |   21027 K  |
|       from small pool |       0    |    1067    |   15193 K  |   15193 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |  16640 KiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |      0 KiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  28235 MiB |   1093 TiB |   1093 TiB |
|       from large pool |  16640 KiB |  28185 MiB |   1086 TiB |   1086 TiB |
|       from small pool |      0 KiB |     50 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  28168 MiB |   1089 TiB |   1089 TiB |
|       from large pool |  16640 KiB |  28119 MiB |   1082 TiB |   1082 TiB |
|       from small pool |      0 KiB |     49 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4564 MiB |  29180 MiB |  29180 MiB |  24616 MiB |
|       from large pool |   4524 MiB |  29128 MiB |  29128 MiB |  24604 MiB |
|       from small pool |     40 MiB |     52 MiB |     52 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1608 MiB | 225863 GiB | 225863 GiB |
|       from large pool | 134912 KiB |   1606 MiB | 218793 GiB | 218793 GiB |
|       from small pool |      0 KiB |     34 MiB |   7069 GiB |   7069 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |   69679 K  |   69679 K  |
|       from large pool |       2    |    1018    |   33625 K  |   33625 K  |
|       from small pool |       0    |    4690    |   36053 K  |   36053 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |   69679 K  |   69679 K  |
|       from large pool |       2    |    1018    |   33625 K  |   33625 K  |
|       from small pool |       0    |    4690    |   36053 K  |   36053 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     212    |     725    |     725    |     513    |
|       from large pool |     192    |     699    |     699    |     507    |
|       from small pool |      20    |      26    |      26    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1249    |   36220 K  |   36220 K  |
|       from large pool |       4    |     469    |   21027 K  |   21027 K  |
|       from small pool |       0    |    1067    |   15193 K  |   15193 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_39_20_seed_1_24051364

 Experiment start at: 2024-08-04 09:39:21.776221
before training, model accuracy: 0.06926468014717102
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91879815, 'precision': 0.8321904, 'recall': 0.7225815, 'specificity': 0.9907787, 'f1': 0.75402653, 'auroc': 0.9879789}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   258     0    1    11   0    0    78     6     8    7    114
1     0  1175    0    26   0    0     1   112     2    0     13
2     1     0  149     6  17    2     3    23    26   64     21
3     2     0    3  8126   0   26     3   183    91    4      1
4     2     0   38     2  94    2    10     8    80   14    289
5     0     0    6    56   0  337     1     0     9  109      2
6     8     0    0     6   0    0  1829     7    10    6     42
7     1     5    2   476   1    1     2  6682    62    1     31
8     5     1    5   330   1    1    13    68  2774    1     97
9     5     0   56    13   1   91    10     4    23  275     14
10    2     0    3    14   5    0    24    28    74    2  12642
---- Validation: 
scalar performance:
{'acc': 0.9203424, 'precision': 0.83361644, 'recall': 0.7213557, 'specificity': 0.99095917, 'f1': 0.7521416, 'auroc': 0.9881195}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   259     0    0    11   0    0    88     4     6    8    107
1     0  1191    0    20   0    0     3   102     4    0     12
2     4     0  134     8  18    3     6    28    27   60     24
3     2     0    1  8137   0   26     3   178    93    0      0
4     1     0   35     6  83    0    12    10    78   27    287
5     2     0    1    53   0  349     3     0    10  101      2
6     4     0    0     2   0    0  1843     9    10    4     36
7     4     6    0   463   1    1     3  6691    68    1     27
8     2     1    7   316   0    2    13    66  2786    1    102
9     4     0   65    17   0   79    10     8    13  279     18
10    1     0    3     8   3    0    29    30    64    3  12655
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6609529, 'precision': 0.6443223, 'recall': 0.5405828, 'specificity': 0.9652981, 'f1': 0.52841127, 'auroc': 0.8604373}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   776     0    1   33   0    0   244    34    19   12    51
1     0  1043    0   41   0    0    40   333     2    0    40
2     3     2  145   39   6    3   233    56   267   96   165
3     0     0    0    0   0    0     0     0     0    0     0
4     0     0    2    0  17    0    57     3    29    0  1525
5     8     0    2   76   0  227    28     1    10  236     4
6     0     0    0    5   0    0  3053     3     1    0     5
7     0     0    0    8   0    0     4  1147     0    1     4
8     1     0    3  211   0    3    74    10  1053    7     8
9    27     6  210  185   0   39   154    62    80  348    26
10    0     0    0    0   0    0     8     0     0    0  1638
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-04 10:48:08.166152,epoch time: 1:08:46.389931,used: 1:08:46.389931,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_39_20_seed_1_24051364
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9362425, 'precision': 0.8552833, 'recall': 0.78376865, 'specificity': 0.99281895, 'f1': 0.8074068, 'auroc': 0.9925695}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   383     0    0    19    0    0     2    10     7    8     54
1     0  1229    0    28    0    0     0    69     3    0      3
2     3     0  157     2   32    1     2    28    12   60     15
3     0     0    0  8188    0   25     0   132    87    4      1
4     3     0   31     2  157    1     0    13    64   16    252
5     0     0    0    31    0  417     0     0     7   65      1
6    17     1    0    38    0    1  1795     4     5    7     40
7     0     8    0   387    1    0     0  6817    43    0      6
8     3     0    1   210    1    3     0    99  2931    2     45
9     4     1   52     7    0  117     1     7    11  288      5
10   26     0    3    14    6    1     5    47    58    3  12631
---- Validation: 
scalar performance:
{'acc': 0.9359101, 'precision': 0.863413, 'recall': 0.7907031, 'specificity': 0.99273944, 'f1': 0.8132088, 'auroc': 0.9928948}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   394     0    0    12    0    1     5    15     5    4     47
1     0  1233    0    25    0    0     0    67     4    0      3
2     4     0  165     0   24    2     1    27    15   50     24
3     1     2    1  8176    0   23     0   156    80    1      0
4     8     0   29     3  152    1     2     6    59   19    260
5     1     0    2    27    0  431     0     0     6   53      1
6    25     1    0    37    0    1  1782     2     6    7     47
7     0     8    0   415    1    0     1  6790    41    2      7
8     3     0    3   229    1    5     0    93  2912    1     49
9     5     0   53     7    1  105     1     8     6  300      7
10   24     0    0    14    2    1     7    43    49    2  12654
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6816624, 'precision': 0.60090995, 'recall': 0.5828178, 'specificity': 0.9681848, 'f1': 0.5578313, 'auroc': 0.8498361}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   918     1    0  113   0    3    25    47    12   25    26
1     0  1238    0   35   0    0     0   194     1    0    31
2     6     2  119   18  49   15     6    61   258   69   412
3     0     0    0    0   0    0     0     0     0    0     0
4     1     0    1    0  15    0     0     3    12    1  1600
5     1     0    8   65   0  427     2     0    12   76     1
6     0     0    0   30   0    0  2854     7    11    0   165
7     0     0    0   46   0    0     0  1115     0    0     3
8     0     1    1  155   0    6     2    14  1181    1     9
9    14    13  337  138   1  142    14    87   113  230    48
10    0     0    0    0   0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-04 11:56:28.861563,epoch time: 1:08:20.695411,used: 2:17:07.085342,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_39_20_seed_1_24051364
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94956654, 'precision': 0.87332946, 'recall': 0.8201015, 'specificity': 0.9944587, 'f1': 0.84001017, 'auroc': 0.99541026}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   389     0    0     8    0    0    20     3     6    4     53
1     0  1245    0    12    0    0     0    63     5    0      7
2     3     1  125     0   87    2     1     9    15   64      5
3     0     0    0  8096    1   13     1   196   129    1      1
4     3     0    3     2  340    0     2     2    26   10    151
5     2     0    2    32    0  428     0     0    10   45      1
6    12     1    0     1    4    3  1861     5     4    0     17
7     0     5    0   161    6    0     2  6959    96    1     35
8     2     1    2   103   10    3     5    75  3047    1     47
9     5     0   26     9    6  117     4     9    10  304      3
10   15     0    0     7   39    2     7     8    15    0  12697
---- Validation: 
scalar performance:
{'acc': 0.9478133, 'precision': 0.865859, 'recall': 0.8153657, 'specificity': 0.99427676, 'f1': 0.8348506, 'auroc': 0.9954538}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   390     1    0     6    1    0    19     7     5    3     51
1     0  1246    0    17    0    0     0    57     3    0      9
2     5     0  127     1   89    1     0    14     6   65      4
3     4     1    0  8068    0   16     6   214   128    2      1
4     2     0    7     1  326    2     2     1    28   10    160
5     0     0    0    42    0  420     0     0     7   51      1
6     7     0    0     3    2    0  1863     4     9    1     19
7     0     7    1   162    5    1     1  6947   108    2     31
8     1     0    2    95   10    5     3    65  3064    2     49
9     8     0   31     8    3  125     3     2    16  295      2
10   11     0    0     7   40    0     7    10    31    2  12688
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6992234, 'precision': 0.63118446, 'recall': 0.5714397, 'specificity': 0.9693564, 'f1': 0.5600482, 'auroc': 0.8673002}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   750     3    0   27    1    0   288    41    27    9    24
1     0  1254    0   27    1    0     5   166     8    0    38
2     2     2   54    7  311    2    32    32   365   33   175
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  376    0     4     1    13    0  1239
5     2     0    2  140    7  252    27     2    40  119     1
6     0     0    0    0    1    0  3019     2     5    0    40
7     0     0    0   23    0    0     1  1137     0    0     3
8     0     1    0   56    0    0     9    20  1280    1     3
9     8    15  139  100   37   45    77   110   333  244    29
10    0     0    0    0   18    0     0     0     0    0  1628
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-04 13:06:45.891124,epoch time: 1:10:17.029561,used: 3:27:24.114903,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_39_20_seed_1_24051364
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95291096, 'precision': 0.89147633, 'recall': 0.8336093, 'specificity': 0.9947839, 'f1': 0.85445017, 'auroc': 0.99572784}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   404     0    0     5    1    0    11    10     2    0     50
1     0  1274    0    10    0    0     0    44     3    0      1
2     5     0  139     0   53    0     3    10     5   93      4
3     5     2    0  8038    1    7     1   275   108    3      0
4     1     0   11     1  320    1     1     4    11   16    173
5     1     0    0    34    0  376     1     1     5  102      1
6    11     2    0     2    2    0  1850    12     4    2     20
7     1    12    0    96    1    0     2  7112    27    1     10
8     0     5    1    65   18    0     0   133  3010    7     56
9     4     0   16    11    1   42     7     4     6  398      4
10   10     0    0     8   27    0     8    18    26    2  12695
---- Validation: 
scalar performance:
{'acc': 0.95220006, 'precision': 0.8847709, 'recall': 0.82832146, 'specificity': 0.9947007, 'f1': 0.8493768, 'auroc': 0.99577016}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   409     1    0     4    1    0     6     6     0    2     54
1     0  1262    0     8    0    0     0    50     4    0      8
2     3     0  135     0   56    0     1    12     4   98      3
3     1     1    0  8037    0    9     2   269   119    2      0
4     1     0   16     1  313    0     1     4    12   10    181
5     3     0    0    31    0  370     3     0     6  107      1
6     7     0    1     1    1    0  1871     3     4    0     20
7     0    10    0    96    2    0     1  7111    33    4      8
8     1     1    2    80   12    1     1   140  3000    5     53
9    11     0   20     7    2   45     8     4     8  384      4
10    9     0    1     8   26    0     7    20    16    3  12706
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7111873, 'precision': 0.63535523, 'recall': 0.5829719, 'specificity': 0.9706471, 'f1': 0.5606662, 'auroc': 0.868204}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1060     0    0   7    0    0    70    20     5    1     7
1      0  1218    0  25    0    0     5   234     4    0    13
2     17     1  110   4  197    0    57    43   211   68   307
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    0   0   89    0     8     2     5    0  1527
5     18     0    0  99    0  153    43     0    33  245     1
6      0     0    0   0    0    0  3060     1     0    0     6
7      0     0    0  18    0    0     1  1141     1    0     3
8      0     0    0  58    2    0    11    18  1272    2     7
9     51     8  148  57    8   10    83    92   227  418    35
10     0     0    0   0    1    0     1     0     0    0  1644
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-04 14:17:51.257593,epoch time: 1:11:05.366469,used: 4:38:29.481372,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_39_20_seed_1_24051364
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9540347, 'precision': 0.89013255, 'recall': 0.83436716, 'specificity': 0.99482334, 'f1': 0.856264, 'auroc': 0.9953153}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   373     0    2     7    1    0     5     8     2   14     71
1     0  1246    0     9    0    0     0    63     3    0     11
2     0     0  167     1   61    2     0     3     1   67     10
3     1     0    1  8138    1   20     1   173    93    7      1
4     2     0   12     0  284    1     0     2    14   14    210
5     0     0    0    15    1  398     0     0     3  103      1
6     9     0    0     1    4    0  1852     4     3    4     31
7     0     5    1   165    2    0     2  7008    61    3     16
8     2     0    3    85   10    2     1    71  3049    7     65
9     0     0   29     1    4   46     0     2     1  405      4
10    1     0    1     5   11    0     5    11    18    5  12738
---- Validation: 
scalar performance:
{'acc': 0.9531898, 'precision': 0.88794714, 'recall': 0.830775, 'specificity': 0.9947467, 'f1': 0.85224825, 'auroc': 0.99570817}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   384     0    1     6    0    0     4     6     2   14     66
1     0  1245    0     8    0    0     0    65     7    0      7
2     0     0  157     0   62    1     0     4     1   81      6
3     2     0    0  8139    1   15     2   187    88    6      0
4     2     0   12     0  277    2     0     0    10   12    224
5     0     0    1    17    0  385     0     0     4  112      2
6     6     0    0     1    4    0  1856    11     4    4     22
7     0     5    3   178    2    0     2  6983    70    5     17
8     0     0    3    92    9    1     0    69  3055   11     56
9     0     0   28     2    4   48     0     0     0  410      1
10    5     0    1     8    7    0     3     7    16    5  12744
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7013923, 'precision': 0.61011004, 'recall': 0.584347, 'specificity': 0.96995866, 'f1': 0.5658645, 'auroc': 0.8517091}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   884     0   0   42    0    1    33    70     3  107    30
1     0  1203   5   30    1    0     5   207     5    0    43
2     2     0  38   11  262    6    16    36   191  107   346
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0   38    0     5     0     5    1  1584
5     2     0   0  124    0  278     0     1    15  172     0
6     0     0   0    4    0    0  3028     3     6    0    26
7     0     0   0    7    0    0     0  1154     0    0     3
8     0     0   0   97    1    0     3    27  1228    3    11
9     1     0  96  115   31   40    14   118   144  528    50
10    0     0   0    0    0    0     0     0     0    0  1646
better model found
persisted
after epoch: 5,now: 2024-08-04 15:31:01.165089,epoch time: 1:13:09.907496,used: 5:51:39.388868,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_39_20_seed_1_24051364
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95202804, 'precision': 0.8974635, 'recall': 0.8378284, 'specificity': 0.994701, 'f1': 0.85773486, 'auroc': 0.9960721}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    2     6    1    0     7    13     2    1     22
1     0  1242    0    17    0    0     0    69     2    0      1
2     2     0  207     2   35    0     0    17     4   44      1
3     0     0    0  8167    0    2     0   229    38    2      0
4     4     0   25     1  331    0     0    10    21   13    134
5     1     0    1    72    0  258     1     2     5  180      1
6     9     0    1     6    1    0  1860     6     4    1     19
7     0     4    0   112    1    0     3  7132     9    0      4
8     1     0    2   165    2    0     0   221  2886    1     18
9     1     0   36    11    1    8     2    19     4  410      1
10   17     2    2     8   39    0    11    17    33    1  12661
---- Validation: 
scalar performance:
{'acc': 0.9523606, 'precision': 0.9011022, 'recall': 0.8395393, 'specificity': 0.9947344, 'f1': 0.8601632, 'auroc': 0.99623525}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   427     0    1     8    0    0    11     8     1    3     24
1     0  1242    0    17    0    0     0    71     2    0      0
2     5     1  200     0   30    0     0    22     4   48      2
3     0     0    0  8168    0    1     0   233    38    0      0
4     5     2   24     1  354    1     0     8    14    9    121
5     0     0    0    79    0  257     0     1     6  177      1
6     7     0    0     8    0    0  1866     5     4    5     13
7     0     3    0   111    1    0     3  7133    10    0      4
8     3     0    1   155    5    0     1   237  2865    3     26
9     3     0   32    14    1    8     0    19     2  414      0
10   13     0    2     6   37    0     7    23    28    2  12678
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67795426, 'precision': 0.652135, 'recall': 0.54318625, 'specificity': 0.9680117, 'f1': 0.53325504, 'auroc': 0.857361}
confusion matrix:
     0     1    2    3    4   5     6     7     8    9     10
0   919     0    0   99    2   0    69    59     5   11     6
1     0  1159    0   34    0   0     1   295     1    0     9
2     2     1  119   33  256   0    15   109   216   70   194
3     0     0    0    0    0   0     0     0     0    0     0
4     1     0    1    0  207   0     3     3    10    1  1407
5     1     0    1  317    0  65     0     2    14  192     0
6     0     0    0   22    0   0  2975     5     7    0    58
7     0     1    0   46    0   0     0  1115     0    0     2
8     0     0    0  172    1   0     2    37  1153    1     4
9    11     2  131  237   10   5     5   264   108  336    28
10    0     0    0    0    4   0     0     0     0    0  1642
early stop counter: 1
val acc:0.9523605704307556, best validation acc: 0.9531897902488708, corresponding to test acc:                         0.7013922929763794 / 0.7111873030662537
after epoch: 6,now: 2024-08-04 16:50:56.045034,epoch time: 1:19:54.879945,used: 7:11:34.268813,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_39_20_seed_1_24051364
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9578874, 'precision': 0.8858932, 'recall': 0.85952675, 'specificity': 0.9953411, 'f1': 0.8719701, 'auroc': 0.9969316}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    0     3    2    0    13     1     1    1     37
1     0  1274    0     9    0    0     0    44     3    0      2
2     1     0  207     0   69    1     0     5     1   23      5
3     4     2    0  8076    0    5     1   222   126    0      1
4     4     0   10     1  380    0     0     1     3    3    137
5     2     0    3    30    0  391     0     0     5   88      2
6     7     1    1     2    4    0  1869     3     2    0     19
7     0     6    2    78    1    0     1  7131    29    1     15
8     2     0    4    48   45    1     0    91  2995    0    108
9     6     0   73     5   12   51     0     3     4  334      5
10    4     0    0     5   43    0     3    10     5    3  12720
---- Validation: 
scalar performance:
{'acc': 0.9591547, 'precision': 0.8922659, 'recall': 0.8671292, 'specificity': 0.99546605, 'f1': 0.87903494, 'auroc': 0.9968196}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     0    0     2    2    0    11     3     0    3     41
1     0  1278    0     4    0    0     0    45     4    0      1
2     2     0  224     0   61    0     0     4     3   16      2
3     1     2    1  8100    0    6     1   193   134    2      0
4     2     1   10     0  372    1     1     5     3    1    143
5     1     0    2    21    3  402     0     0     5   86      1
6     5     0    1     3    3    0  1871     2     1    0     22
7     1     7    1    96    2    0     1  7118    24    1     14
8     2     0    6    41   37    0     2    83  3013    0    112
9     2     0   71     7   11   49     0     1     4  345      3
10    5     0    0     7   50    0     5    10     4    1  12714
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72476035, 'precision': 0.6470878, 'recall': 0.6098161, 'specificity': 0.97241515, 'f1': 0.5983715, 'auroc': 0.8706932}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1100     0    0   15    0    1    23     6     4   10    11
1      0  1165    0   30    0    0     0   293     3    0     8
2      8     0  139    6  355    5     4    41   220   53   184
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    1    0  232    0     2     3     5    1  1388
5      8     0    4  122    6  316     0     0    21  115     0
6      0     0    0    5    0    0  3033     2     1    0    26
7      0     0    0   27    0    0     0  1135     0    0     2
8      0     0    0   91    2    1     0     9  1259    1     7
9     20     1  226  130   19   66     2    67   241  338    27
10     0     0    0    0    4    0     0     0     0    0  1642
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-04 18:11:25.056514,epoch time: 1:20:29.011480,used: 8:32:03.280293,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_39_20_seed_1_24051364
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96155286, 'precision': 0.88110316, 'recall': 0.8804119, 'specificity': 0.9958974, 'f1': 0.8773975, 'auroc': 0.99718714}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     1    3     2    1    0    21     3     1    3     36
1     0  1305    0     8    0    1     0    14     4    0      0
2     0     0  261     0   39    0     0     0     1   11      0
3     0     5    3  8235    0   16     0   120    56    2      0
4     3     0   28     0  406    1     1     0     7    1     91
5     0     0    2    17    0  375     0     0     3  122      2
6     2     1    1     1    4    0  1876     2     2    1     17
7     2    45   31   114    5    0     2  6989    52    1     23
8     2     1   11   107   18    2     0    49  3077    3     26
9     0     0  114     2    3   28     0     1     2  343      0
10    7     0    2     5   66    0     9    10    31    3  12660
---- Validation: 
scalar performance:
{'acc': 0.9613481, 'precision': 0.87715256, 'recall': 0.8769621, 'specificity': 0.9959012, 'f1': 0.8734969, 'auroc': 0.99734724}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   416     0    1     2    5    0    27     2     1    2     27
1     0  1307    0     6    0    0     0    15     4    0      0
2     1     0  257     0   38    0     0     0     0   16      0
3     0     3    2  8216    0   12     1   142    61    3      0
4     3     0   29     0  404    2     0     0     7    2     92
5     0     0    2    12    1  378     0     0     2  124      2
6     5     1    4     1    2    0  1874     1     2    0     18
7     1    36   33   112    3    0     1  7006    56    3     14
8     1     1   13   100   22    0     1    51  3084    2     21
9     0     0  123     5    6   30     2     0     0  325      2
10    6     0    3     6   68    0     8     5    25    2  12673
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.735185, 'precision': 0.68400645, 'recall': 0.6154344, 'specificity': 0.9734661, 'f1': 0.62931216, 'auroc': 0.86837614}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   876     0    0   32    3    1   160    6     5   73    14
1     1  1368    4   44    0    0    10   57     6    0     9
2     2     2  253   14  319    1     8    8   214   85   109
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    5    1  395    0     9    0    14    1  1208
5     1     0    2   92    0  291     0    0     5  200     1
6     0     0    0   11    1    0  3024    0    12    0    19
7     0     4    8  149    0    1     2  987     9    1     3
8     0     0    1  170    1    0     1    0  1193    2     2
9     1     6  332  113   12   50     3   15    98  487    20
10    0     0    0    0    9    0     3    0     0    0  1634
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-04 19:29:43.108107,epoch time: 1:18:18.051593,used: 9:50:21.331886,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_39_20_seed_1_24051364
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9659407, 'precision': 0.8949511, 'recall': 0.88953, 'specificity': 0.9963597, 'f1': 0.8895024, 'auroc': 0.9976446}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     1    0     1    0    0     5     0     1    2      4
1     0  1283    0     3    0    0     0    39     4    0      2
2     6     0  233     0   34    0     1     2     6   29      1
3     4     4    0  8199    0   15     1   151    64    1      0
4    14     0   22     2  350    1     1     0    10    5    133
5     2     0    0     8    0  401     0     1     5  102      1
6    23     0    1     0    0    0  1877     1     0    1      5
7     5    12    0    80    1    0     2  7105    52    1      6
8     8     1    4    74    7    1     2    47  3127    6     18
9     6     0   50     2    0   33     1     1     1  399      0
10   70     0    1     6   23    0     3     8    22    0  12660
---- Validation: 
scalar performance:
{'acc': 0.96651065, 'precision': 0.89840186, 'recall': 0.89495647, 'specificity': 0.99640983, 'f1': 0.8939052, 'auroc': 0.99766475}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     1    0    0     5     1     0    1      4
1     0  1290    0     3    0    0     0    35     3    0      1
2     5     0  238     0   32    0     0     2     5   29      1
3     2     3    1  8181    0   14     0   159    79    1      0
4    14     0   20     0  356    1     1     1     9    6    131
5     1     0    1     9    1  420     0     0     4   85      0
6    25     0    1     1    0    0  1869     1     3    2      6
7     2     9    0    81    1    0     1  7112    44    3     12
8     9     0    4    58    4    1     0    45  3150    3     22
9     7     0   60     3    0   23     2     2     1  394      1
10   81     0    1     6   21    0     5     7    23    0  12652
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7141258, 'precision': 0.6594136, 'recall': 0.5917318, 'specificity': 0.9711386, 'f1': 0.57334614, 'auroc': 0.86139715}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1127     0    0   10    1    0    21     3     3    3     2
1      3  1131    1   38    0    0    14   267     6    0    39
2     62     0  114   10   88    1    75    33   293   80   259
3      0     0    0    0    0    0     0     0     0    0     0
4      5     0    2    1  117    0    51     1    14    0  1442
5     14     0    1  121    0  208     4     0    11  233     0
6      0     0    0    2    0    0  3062     1     1    0     1
7      1     0    0   34    0    0     3  1122     2    0     2
8      0     0    0  111    0    0     7     5  1242    2     3
9     60     1  116  124    3   26    68    73   177  445    44
10     0     0    0    0    2    0     5     0     0    0  1639
better model found
persisted
after epoch: 9,now: 2024-08-04 20:43:54.385426,epoch time: 1:14:11.277319,used: 11:04:32.609205,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_39_20_seed_1_24051364
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9654859, 'precision': 0.9094455, 'recall': 0.87214726, 'specificity': 0.9962729, 'f1': 0.8856769, 'auroc': 0.99752986}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     0    0    0     6     1     1    1     13
1     0  1292    0     5    0    0     0    23     9    0      3
2     5     0  157     0   87    0     1     3     6   51      2
3     6     4    0  8218    0    4    12    57   134    2      0
4     7     0    3     1  340    1     1     0    23    4    159
5     1     0    0    16    0  445     0     0    13   45      1
6     8     0    0     0    0    0  1884     0     3    2     10
7     2     9    0   165    2    0     2  6965   112    0      6
8     4     0    2    38    1    0     0    17  3221    1     12
9     2     0   19     4    6   61     2     1     7  389      2
10   14     0    1     7    8    1    12     2    34    0  12714
---- Validation: 
scalar performance:
{'acc': 0.964023, 'precision': 0.90646225, 'recall': 0.86333454, 'specificity': 0.99608624, 'f1': 0.8778657, 'auroc': 0.9975614}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     1    0     0    0    1     7     0     1    1     15
1     0  1291    0     5    0    0     1    24    10    0      1
2     2     0  145     1   86    0     1     2     8   63      4
3     1     2    0  8226    0    4     7    75   121    2      2
4     9     0    3     0  321    1     1     2    21    3    178
5     0     0    0    13    0  443     0     0     9   55      1
6     7     0    1     0    0    0  1884     0     3    1     12
7     3     8    1   165    1    0     4  6950   121    0     12
8     4     1    1    36    1    0     1    19  3221    0     12
9     5     0   12     2    3   71     0     0     6  385      9
10   17     0    1     6   11    2     5     7    30    0  12717
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7142657, 'precision': 0.64279294, 'recall': 0.5977815, 'specificity': 0.9711076, 'f1': 0.57591254, 'auroc': 0.8527047}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1056     0   0    3    0    1    92     0     5   10     3
1      4  1251   0   63    0    0    15   117    13    1    35
2     29     0  21   13  104    2    34    13   332   87   380
3      0     0   0    0    0    0     0     0     0    0     0
4      3     0   2    1   44    0    14     0    19    0  1550
5      8     0   0  122    0  299     1     0    11  146     5
6      0     0   0    1    0    0  3051     0     7    0     8
7      5     0   1   69    0    0    18  1054    11    1     5
8      0     0   0  104    0    0     9     1  1252    2     2
9     40     1  24  100    7   59    36    30   203  539    98
10     0     0   0    0    1    0     2     0     1    0  1642
early stop counter: 1
val acc:0.9640229940414429, best validation acc: 0.9665106534957886, corresponding to test acc:                         0.7141258120536804 / 0.7351850271224976
after epoch: 10,now: 2024-08-04 22:05:06.524453,epoch time: 1:21:12.139027,used: 12:25:44.748232,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_39_20_seed_1_24051364
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 12:25:44.748232 at 2024-08-04 22:05:06.524453
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7141258, 'precision': 0.6594136, 'recall': 0.5917318, 'specificity': 0.9711386, 'f1': 0.57334614, 'auroc': 0.86139715}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1127     0    0   10    1    0    21     3     3    3     2
1      3  1131    1   38    0    0    14   267     6    0    39
2     62     0  114   10   88    1    75    33   293   80   259
3      0     0    0    0    0    0     0     0     0    0     0
4      5     0    2    1  117    0    51     1    14    0  1442
5     14     0    1  121    0  208     4     0    11  233     0
6      0     0    0    2    0    0  3062     1     1    0     1
7      1     0    0   34    0    0     3  1122     2    0     2
8      0     0    0  111    0    0     7     5  1242    2     3
9     60     1  116  124    3   26    68    73   177  445    44
10     0     0    0    0    2    0     5     0     0    0  1639
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.735185, 'precision': 0.68400645, 'recall': 0.6154344, 'specificity': 0.9734661, 'f1': 0.62931216, 'auroc': 0.86837614}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   876     0    0   32    3    1   160    6     5   73    14
1     1  1368    4   44    0    0    10   57     6    0     9
2     2     2  253   14  319    1     8    8   214   85   109
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    5    1  395    0     9    0    14    1  1208
5     1     0    2   92    0  291     0    0     5  200     1
6     0     0    0   11    1    0  3024    0    12    0    19
7     0     4    8  149    0    1     2  987     9    1     3
8     0     0    1  170    1    0     1    0  1193    2     2
9     1     6  332  113   12   50     3   15    98  487    20
10    0     0    0    0    9    0     3    0     0    0  1634
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_04_09_39_20_seed_1_24051364_instance_wise_predictions.txt
accuracy from prediction file 0.7141257958441195
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/12.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/12.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   4044 MiB |  28236 MiB |   2186 TiB |   2186 TiB |
|       from large pool |   4020 MiB |  28187 MiB |   2172 TiB |   2172 TiB |
|       from small pool |     23 MiB |     50 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   4044 MiB |  28236 MiB |   2186 TiB |   2186 TiB |
|       from large pool |   4020 MiB |  28187 MiB |   2172 TiB |   2172 TiB |
|       from small pool |     23 MiB |     50 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   4036 MiB |  28168 MiB |   2179 TiB |   2179 TiB |
|       from large pool |   4013 MiB |  28119 MiB |   2165 TiB |   2165 TiB |
|       from small pool |     22 MiB |     49 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  29192 MiB |  29192 MiB |  53808 MiB |  24616 MiB |
|       from large pool |  29140 MiB |  29140 MiB |  53744 MiB |  24604 MiB |
|       from small pool |     52 MiB |     52 MiB |     64 MiB |     12 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 643045 KiB |   1619 MiB | 459163 GiB | 459163 GiB |
|       from large pool | 627800 KiB |   1617 MiB | 444988 GiB | 444987 GiB |
|       from small pool |  15245 KiB |     34 MiB |  14175 GiB |  14175 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3670    |    5393    |  139357 K  |  139353 K  |
|       from large pool |     502    |    1018    |   67251 K  |   67251 K  |
|       from small pool |    3168    |    4690    |   72105 K  |   72102 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3670    |    5393    |  139357 K  |  139353 K  |
|       from large pool |     502    |    1018    |   67251 K  |   67251 K  |
|       from small pool |    3168    |    4690    |   72105 K  |   72102 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     722    |     725    |    1235    |     513    |
|       from large pool |     696    |     699    |    1203    |     507    |
|       from small pool |      26    |      26    |      32    |       6    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     215    |    1249    |   72616 K  |   72616 K  |
|       from large pool |     184    |     469    |   41850 K  |   41849 K  |
|       from small pool |      31    |    1067    |   30766 K  |   30766 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  28236 MiB |   2186 TiB |   2186 TiB |
|       from large pool |  16640 KiB |  28187 MiB |   2172 TiB |   2172 TiB |
|       from small pool |      0 KiB |     50 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  28236 MiB |   2186 TiB |   2186 TiB |
|       from large pool |  16640 KiB |  28187 MiB |   2172 TiB |   2172 TiB |
|       from small pool |      0 KiB |     50 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  28168 MiB |   2179 TiB |   2179 TiB |
|       from large pool |  16640 KiB |  28119 MiB |   2165 TiB |   2165 TiB |
|       from small pool |      0 KiB |     49 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4672 MiB |  29192 MiB |  53808 MiB |  49136 MiB |
|       from large pool |   4634 MiB |  29140 MiB |  53744 MiB |  49110 MiB |
|       from small pool |     38 MiB |     52 MiB |     64 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1619 MiB | 459165 GiB | 459165 GiB |
|       from large pool | 134912 KiB |   1617 MiB | 444990 GiB | 444990 GiB |
|       from small pool |      0 KiB |     34 MiB |  14175 GiB |  14175 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5393    |  139357 K  |  139357 K  |
|       from large pool |       2    |    1018    |   67251 K  |   67251 K  |
|       from small pool |       0    |    4690    |   72105 K  |   72105 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5393    |  139357 K  |  139357 K  |
|       from large pool |       2    |    1018    |   67251 K  |   67251 K  |
|       from small pool |       0    |    4690    |   72105 K  |   72105 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     212    |     725    |    1235    |    1023    |
|       from large pool |     193    |     699    |    1203    |    1010    |
|       from small pool |      19    |      26    |      32    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1249    |   72617 K  |   72617 K  |
|       from large pool |       4    |     469    |   41850 K  |   41850 K  |
|       from small pool |       0    |    1067    |   30767 K  |   30767 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Aug  4 22:14:01 2024]
Finished job 0.
1 of 1 steps (100%) done
