Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Aug  3 01:34:49 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/9.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=9
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_48_00_seed_0_24051355

 Experiment start at: 2024-08-03 01:48:02.028999
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.044287413358688354
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9186644, 'precision': 0.8029967, 'recall': 0.6775302, 'specificity': 0.9907441, 'f1': 0.6896838, 'auroc': 0.9858943}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   154     0   0    11   0    3   161    10     7   16    121
1     0  1271   0    17   0    0     1    32     5    0      6
2     2    11   9     9  28   27    13    17    23  126     47
3     1     4   0  7983   0   10     2   247   184    3      3
4     1     3   5     5  75    8    11     7    33   17    373
5     0     0   0    60   0  312     3     0    14  130      2
6     2     1   0    16   0    0  1850     6     7    2     23
7     0    91   0   249   0    1     4  6799    61    3     55
8     1     8   0   124   3    4    16    75  2824    5    235
9     0     1   4    16   2   84     9     3    16  350      8
10    3     7   0     7   4    0    28    25     8    4  12709
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9184967, 'precision': 0.7997637, 'recall': 0.68272126, 'specificity': 0.99073, 'f1': 0.6938846, 'auroc': 0.9857807}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   164     0   0    11   0    2   145    12     6   22    121
1     0  1265   0    19   0    1     0    35     6    0      6
2     2     7   6     9  33   24     8    25    21  131     46
3     1     4   0  7971   0   15     1   250   187    4      7
4     1     2   2     8  86    5     8     4    36   25    362
5     1     0   0    51   0  320     1     0    13  133      2
6     2     3   0    11   0    0  1845     9     9    2     27
7     0    96   0   252   1    1     3  6788    71    0     53
8     1     9   0   107   5    5    15    77  2823    9    245
9     0     2   5    12   1   75    12     3    13  361      9
10    4     9   0    10   3    1    22    23    13    2  12709
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.63359684, 'precision': 0.5483421, 'recall': 0.5051357, 'specificity': 0.96193767, 'f1': 0.46607906, 'auroc': 0.8504607}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   180     3   0   63   0    0   814    34    29   30    17
1     0  1343   0   21   0    0     9    93     8    3    22
2     8    10   0   12  58   10   132    63   243  143   336
3     0     0   0    0   0    0     0     0     0    0     0
4     0     6   0    0  21    0    11     3    15    0  1577
5     6     0   0  112   0  140    52     0    29  252     1
6     0     4   0    4   0    0  2838     8    11    0   202
7     0    10   0   44   0    0     5  1099     0    1     5
8     0     0   0   52   1    1    45     8  1246    6    11
9     9    28   0   63   4   28    84    97   253  546    25
10    0     1   0    0   0    0     2     0     0    0  1643
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 02:37:20.612714,epoch time: 0:49:18.583715,used: 0:49:18.583715,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_48_00_seed_0_24051355
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9372592, 'precision': 0.84540415, 'recall': 0.75992405, 'specificity': 0.99311674, 'f1': 0.775342, 'auroc': 0.9934081}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   375     0   0     8    0    3     1    12     7   27     50
1     0  1200   0    15    0    0     0    95    17    0      5
2     1     0  63     8   16    4     1    16    25  169      9
3     0     1   0  8133    0   15     0   156   132    2      0
4     1     0  27     4  138    3     0     7    82   44    233
5     0     0   0    42    0  404     0     0     7   67      1
6    46     0   0    18    0    3  1764    11    17   12     36
7     2     2   0   269    2    0     1  6899    76    3      8
8     1     0   1   104    1    4     0    76  3082    4     23
9     0     0   2    18    0  120     0     3    10  338      1
10   17     0   3     9    6    2     2    29    81    9  12635
---- Validation: 
scalar performance:
{'acc': 0.9373813, 'precision': 0.84696794, 'recall': 0.76261973, 'specificity': 0.99312574, 'f1': 0.7778754, 'auroc': 0.9932906}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   373     0   0    12    0    0     2    10     9   32     45
1     0  1204   0    17    0    1     0    84    21    0      5
2     0     0  66     7    9    4     0    19    25  173      9
3     0     0   0  8129    0   15     0   150   143    2      1
4     3     0  30     5  138    3     0    12    81   46    221
5     0     0   0    53    0  405     0     0     6   56      1
6    45     0   0    14    0    5  1767     6    15    8     48
7     1     1   0   275    1    0     1  6901    79    0      6
8     2     0   3    93    0    6     0    67  3093    1     31
9     0     0   4    21    0  106     0     3    11  347      1
10   24     0   3    10    8    3     4    34    79   10  12621
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64556074, 'precision': 0.65433204, 'recall': 0.5687983, 'specificity': 0.964403, 'f1': 0.52721405, 'auroc': 0.8753808}
confusion matrix:
      0    1   2   3   4    5     6     7     8    9     10
0   1036    0   0  22   0    0     0    16    62   28     6
1      2  931   0  22   1    2     0   427    58    4    52
2     16    0   9  13  21   18     2    35   479  233   189
3      0    0   0   0   0    0     0     0     0    0     0
4      1    0   0   0  50    0     0     0    46    3  1533
5     15    0   0  92   0  358     0     0    16  110     1
6     19    0   0   7  10    0  2251     5   437    2   336
7      2    0   0  60   0    0     5  1081     9    4     3
8      3    0   0  32   0    5     2     3  1320    4     1
9     40    1   2  65   3  122     0    25   304  547    28
10     0    0   0   0   1    0     0     0     1    0  1644
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 03:21:03.974075,epoch time: 0:43:43.361361,used: 1:33:01.945076,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_48_00_seed_0_24051355
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9470516, 'precision': 0.88355136, 'recall': 0.809574, 'specificity': 0.9942551, 'f1': 0.83325565, 'auroc': 0.99500054}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   387     0    0     2    0    0    30     2    15    4     43
1     0  1267    0    10    0    0     0    33    18    0      4
2     1     0  111     4   51    3     4     6    48   80      4
3     0     1    1  8104    1   14     3    85   228    2      0
4     1     0    8     1  250    1     4     2    80    9    182
5     3     0    0    27    0  396     1     0    17   76      1
6     7     0    0     5    1    0  1868     2    10    1     13
7     0     6    1   290    2    0     2  6819   124    2     17
8     1     0    1    56    1    0     3    34  3178    0     22
9     2     0   11     9    1   72     3     0    29  365      1
10   14     0    0     8   19    0    15    13    69    2  12652
---- Validation: 
scalar performance:
{'acc': 0.94725156, 'precision': 0.883474, 'recall': 0.80621934, 'specificity': 0.99427915, 'f1': 0.83006966, 'auroc': 0.99505913}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   386     0    0     6    0    1    20     1    20    3     46
1     0  1268    0    10    0    0     0    32    20    0      2
2     2     0  105     2   40    2     4     7    55   92      3
3     1     0    0  8116    0   14     1    78   227    2      1
4     1     0   12     1  235    2     4     2    89   10    183
5     0     0    0    25    0  397     1     0    19   78      1
6     5     1    0     3    0    0  1877     0    10    1     11
7     0     8    1   294    2    0     3  6822   118    0     17
8     1     0    0    53    1    1     1    37  3179    0     23
9     2     0   12     5    0   72     4     1    30  367      0
10    7     0    1     7   19    1    10     9    79    2  12661
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6878192, 'precision': 0.68218255, 'recall': 0.5574626, 'specificity': 0.96832895, 'f1': 0.539294, 'auroc': 0.8711251}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   931     0   0    4    0    0   151    3    58    9    14
1     0  1220   0   21    1    2    11  161    63    0    20
2     7     0  11    2   83    3    34   17   692   49   117
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   0    0  251    0     3    1    85    0  1293
5    19     0   0   84    0  202    34    0    68  184     1
6     0     0   0    1    0    0  3012    0    27    0    27
7     0     0   0  180    0    0    41  915    23    1     4
8     0     0   0   20    0    1    12    0  1337    0     0
9    28     2   3   30    8   44    39   13   634  319    17
10    0     0   0    0   11    0     1    0     1    0  1633
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-03 04:06:21.874392,epoch time: 0:45:17.900317,used: 2:18:19.845393,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_48_00_seed_0_24051355
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9534461, 'precision': 0.87622815, 'recall': 0.84187746, 'specificity': 0.9949455, 'f1': 0.8528065, 'auroc': 0.9964838}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   416     0    0     7    0    0     6     7    12   10     25
1     0  1274    0    15    0    1     0    34     4    1      3
2     0     1  186     1   20    7     1     3    10   82      1
3     1     0    1  8270    0   22     0    59    82    1      0
4     3     0   58     3  238    3     5     3    61   14    151
5     0     0    2    17    0  460     0     0     6   35      1
6     7     0    1    12    1    2  1858     3     8    2     14
7     0    11    0   299    2    1     1  6878    62    2      8
8     1     1    3   124    2    9     0    56  3087    1     12
9     0     0   20     3    0  117     1     0     8  344      0
10   18     0    8     8   26    1     6    16    80    4  12625
---- Validation: 
scalar performance:
{'acc': 0.95476794, 'precision': 0.8810144, 'recall': 0.8453214, 'specificity': 0.99508035, 'f1': 0.8568009, 'auroc': 0.9965497}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    1     6    0    1     4     4    11    8     23
1     0  1271    0    14    0    1     0    38     6    0      2
2     1     0  190     3   15    6     1     4    15   75      2
3     0     0    0  8266    0   20     0    66    86    2      0
4     2     0   57     4  238    3     2     4    62    8    159
5     0     0    1    14    0  454     0     0     4   47      1
6    10     0    0     7    0    2  1862     6     6    2     13
7     0    11    5   262    0    0     1  6934    46    0      6
8     0     1    5   123    1    6     0    55  3088    1     16
9     0     0   21     3    0  111     1     1     6  350      0
10   10     0    9     8   29    2    13    20    88    1  12616
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7186035, 'precision': 0.6633051, 'recall': 0.6087173, 'specificity': 0.9718676, 'f1': 0.59280425, 'auroc': 0.87377167}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   984     1    0   55    0    0    39    42    23   19     7
1     1  1189    0   25    0    2     6   221    13    2    40
2    10     2  147   13  100   34    34    62   444   84    85
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    2    0  260    0     7     5    53    1  1304
5     3     0    0   98    0  370     3     0    15  102     1
6     0     0    0    7    0    0  2980     4    31    0    45
7     0     0    0  117    0    0     1  1040     2    1     3
8     0     0    0   81    0    1     4    11  1270    2     1
9    12    14  110   82    5  204     7    84   219  392     8
10    0     0    0    0    5    0     1     0     1    0  1639
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-03 04:50:13.931161,epoch time: 0:43:52.056769,used: 3:02:11.902162,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_48_00_seed_0_24051355
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9529645, 'precision': 0.85961175, 'recall': 0.85385925, 'specificity': 0.9950772, 'f1': 0.8547984, 'auroc': 0.99669826}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   384     0    0     2    0    0    49     3    14    9     22
1     0  1308    1     8    0    0     0    11     2    2      0
2     0     1  196     0   11    2     0     3     8   90      1
3     0    11    1  8098    0   13     8   232    74    3      0
4     2     0   80     0  304    2     2     2    40   12     95
5     0     0    2    20    1  436     1     0     4   57      0
6     1     1    0     2    0    0  1889     1     4    2      7
7     0   107    4    85    0    0     6  7013    42    2      4
8     1     4    4   103    5    3     4    63  3095    2     12
9     0     0   21     4    0   90     0     1     6  371      0
10   17     1    9     7   99    1    24    23    83    2  12524
---- Validation: 
scalar performance:
{'acc': 0.95228034, 'precision': 0.86155796, 'recall': 0.8558578, 'specificity': 0.9950104, 'f1': 0.85646534, 'auroc': 0.99637926}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   382     0    1     2    0    1    51     2    13   12     19
1     0  1307    0     9    0    0     0    12     4    0      0
2     0     1  202     0   12    1     0     2     8   86      0
3     0     6    1  8090    0   16     9   248    69    1      0
4     2     1   79     1  295    3     6     3    41   11     97
5     0     0    0    19    0  437     0     0     7   57      1
6     3     1    0     1    1    1  1889     2     4    1      5
7     1   124    2    88    1    0     4  6992    45    4      4
8     1     4    5   106    8    3     4    69  3090    2      4
9     0     0   15     3    0   81     1     2     6  385      0
10   14     3    9     8   93    2    32    19    81    3  12532
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74833834, 'precision': 0.69210434, 'recall': 0.6219624, 'specificity': 0.9741987, 'f1': 0.63166285, 'auroc': 0.88618135}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   570     0    1  11    2    1   522     8    15   34     6
1     0  1314    0  19    3    0     4   135     8    4    12
2     1     1  231   9  192   11    47    19   378   92    34
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    5   0  798    0     3     1    24    1   801
5     1     0    0  61    0  293    15     0    11  210     1
6     0     0    0   1    1    0  3057     1     4    0     3
7     0     0    0  63    0    1     9  1086     2    0     3
8     0     0    0  95    0    1     9    10  1253    2     0
9     3     6  157  64   11   92    27    41   181  552     3
10    0     0    1   0  101    0     1     0     1    0  1542
new oracle model saved
early stop counter: 1
val acc:0.9522803425788879, best validation acc: 0.9547679424285889, corresponding to test acc:                         0.7186034917831421 / 0.7483383417129517
after epoch: 5,now: 2024-08-03 05:33:59.846133,epoch time: 0:43:45.914972,used: 3:45:57.817134,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_48_00_seed_0_24051355
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9588773, 'precision': 0.8949336, 'recall': 0.85648483, 'specificity': 0.99556184, 'f1': 0.8684812, 'auroc': 0.99764144}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   419     0    0     4    0    1    19     2     9    6     23
1     0  1299    0     7    0    0     0    19     7    0      0
2     2     0  169     2   21    1     0     5     2  104      6
3     0     0    0  8253    0   34     1    44   101    2      0
4     4     1   27     1  298    1     2     3    29   14    159
5     1     0    0     9    0  473     0     0     6   30      1
6     4     0    0     3    0    2  1880     3     8    2      5
7     0    18    1   264    1    0     2  6897    74    3      5
8     1     2    2    71    2   12     1    31  3161    3     10
9     1     0    5     1    1  127     1     2     3  352      0
10   11     2    1     8   17    2    20    22    73    0  12638
---- Validation: 
scalar performance:
{'acc': 0.95942223, 'precision': 0.8921844, 'recall': 0.8589289, 'specificity': 0.99561465, 'f1': 0.868844, 'auroc': 0.99766725}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     0    0     2    0    0    17     4     7    3     29
1     0  1301    0     7    0    1     0    18     5    0      0
2     1     1  166     1   19    3     0     3     6  108      4
3     0     5    1  8251    0   37     0    42   101    3      0
4     2     1   32     1  293    3     2     3    27   12    163
5     0     0    0     8    0  488     0     0     2   22      1
6     4     0    0     3    0    2  1877     3     9    2      8
7     0    19    2   253    2    0     1  6905    76    3      4
8     1     1    2    63    5   10     1    31  3162    7     13
9     0     0    9     3    0  120     0     0     2  359      0
10   10     1    3     9   21    0    14    23    68    2  12645
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74477017, 'precision': 0.67440784, 'recall': 0.64079595, 'specificity': 0.974399, 'f1': 0.61797404, 'auroc': 0.87680024}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1016     4    0   19    2    3    62   14    29   19     2
1      0  1335    0   12    0    3     2  131    11    1     4
2      7     1  116   10  209   37    27   31   346  103   128
3      0     0    0    0    0    0     0    0     0    0     0
4      1     0    1    0  294    0     6    1    25    1  1304
5      6     0    0   36    1  494     3    0     6   45     1
6      0     0    0    6    0    0  3032    4    13    0    12
7      0     0    0  185    0    1     7  963     5    0     3
8      0     0    0   42    0    6     2    2  1315    3     0
9     18     5   75   47    9  300     4   41   171  447    20
10     0     1    0    0    9    0     2    0     1    0  1633
better model found
persisted
after epoch: 6,now: 2024-08-03 06:18:46.466486,epoch time: 0:44:46.620353,used: 4:30:44.437487,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_48_00_seed_0_24051355
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96444243, 'precision': 0.9041095, 'recall': 0.8769441, 'specificity': 0.99612904, 'f1': 0.8897296, 'auroc': 0.9978916}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   428     0    0     1    0    0     4     6     7    7     29
1     0  1305    0     3    0    0     0    20     4    0      0
2     1     1  222     4   32    1     0     8     6   36      1
3     0     4    0  8195    0    6     0   170    64    0      0
4     0     0   25     1  367    1     0     1    22    3    119
5     0     0    0    32    0  410     0     0     7   71      1
6     8     0    0     3    1    0  1871     3     7    2     13
7     0    25    1    73    3    0     3  7130    19    0      8
8     0     1    4    77    9    1     0   102  3079    2     19
9     1     1   42     7    0   66     0     4     7  365      0
10    5     0    2     7   43    0     5    10    45    2  12675
---- Validation: 
scalar performance:
{'acc': 0.9658419, 'precision': 0.9088963, 'recall': 0.8851538, 'specificity': 0.99627495, 'f1': 0.8965155, 'auroc': 0.9980266}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     0    0     1    2    0     4     2     7    7     30
1     0  1302    0     4    0    0     0    22     4    0      0
2     2     0  223     1   33    2     0     8     3   37      3
3     1     5    0  8217    0    1     1   156    56    3      0
4     1     0   19     1  381    1     0     2    19    3    112
5     0     0    0    29    0  433     0     0     5   53      1
6     7     0    0     0    3    0  1876     6     5    3      8
7     0    25    0   100    1    0     2  7117     8    0     12
8     0     1    3    73   12    1     0   104  3089    1     12
9     0     0   36     7    2   66     1     2     7  371      1
10   12     1    3     6   47    0     5    11    40    2  12669
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7321066, 'precision': 0.67953205, 'recall': 0.61449945, 'specificity': 0.9731179, 'f1': 0.6061331, 'auroc': 0.8743659}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   946     1    0   11    1    1    83    39    62   18     8
1     0  1264    0   21    0    0     3   188     8    1    14
2     3     0  153    9  213   10    19    88   366   59    95
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  311    0     3     4    35    0  1279
5     6     0    0  121    1  311     5     0    25  122     1
6     0     0    0    4    0    0  3048     3    11    0     1
7     0     0    0   27    0    0     1  1131     2    0     3
8     0     0    0  115    0    0     2    20  1231    2     0
9     5     2   67  141   11  110    13   154   174  442    18
10    0     0    0    0   16    0     1     0     2    0  1627
better model found
persisted
after epoch: 7,now: 2024-08-03 07:02:01.659506,epoch time: 0:43:15.193020,used: 5:13:59.630507,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_48_00_seed_0_24051355
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96746576, 'precision': 0.9106214, 'recall': 0.8954135, 'specificity': 0.996473, 'f1': 0.90227133, 'auroc': 0.9983037}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     0    0     2    1    0     6     0     1    5     27
1     0  1261    0    13    0    0     0    51     6    0      1
2     1     0  246     0   19    1     1     5     2   36      1
3     0     0    0  8247    1    6     1    72   108    1      0
4     2     0   33     1  377    1     2     5    14    3    101
5     1     0    0    19    0  441     0     0     5   54      1
6     3     0    1     2    2    0  1888     1     3    0      7
7     0     1    0   174    3    0     2  7034    40    2      7
8     0     0    6    38    4    5     0    52  3169    1     20
9     0     0   51     3    0   55     0     1     5  378      0
10   11     0    1     8   49    1    18     5    22    2  12678
---- Validation: 
scalar performance:
{'acc': 0.96758056, 'precision': 0.91104287, 'recall': 0.89470834, 'specificity': 0.9964726, 'f1': 0.9019596, 'auroc': 0.9984119}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     0    0     2    0    0     5     0     0    6     29
1     0  1251    0    13    0    0     0    58     8    0      2
2     1     0  250     0   17    0     0     4     4   35      1
3     0     0    1  8278    0    5     0    63    91    1      1
4     3     0   30     2  372    1     3     6    14    3    105
5     0     0    0    19    0  448     0     0     5   48      1
6     3     0    0     0    1    0  1889     2     2    2      9
7     0     1    1   166    2    0     1  7041    44    0      9
8     0     0    8    35    6    1     0    48  3171    2     25
9     1     0   54     4    1   58     1     4     2  368      0
10    6     0    3     9   56    0    25     4    27    2  12664
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7498076, 'precision': 0.68915653, 'recall': 0.6347885, 'specificity': 0.97488004, 'f1': 0.64067346, 'auroc': 0.8792114}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1029     0    0   13    3    0    85   10    12   14     4
1      3  1198    0   36    2    0    11  222    11    1    15
2      9     0  268   10  226   10    52   19   277   64    80
3      0     0    0    0    0    0     0    0     0    0     0
4      1     0    6    0  530    0    17    1    14    0  1064
5     11     0    0   94    1  346     9    0    11  119     1
6      0     0    0    4    0    0  3055    1     2    0     5
7      0     0    0  160    0    0     7  990     4    0     3
8      0     0    0   94    1    0    16    2  1254    2     1
9     18     1  183   96   12  135    20   43   157  461    11
10     0     0    0    0   54    0     5    0     1    0  1586
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-03 07:46:08.320461,epoch time: 0:44:06.660955,used: 5:58:06.291462,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_48_00_seed_0_24051355
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97241545, 'precision': 0.9209854, 'recall': 0.91020817, 'specificity': 0.99705154, 'f1': 0.9143739, 'auroc': 0.9986915}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     2    0    0     2     2     4    3      8
1     0  1288    0     9    0    0     0    28     6    0      0
2     1     0  220     1   25    0     1     7     1   56      0
3     0     1    2  8298    0    7     1    94    33    3      0
4     4     0   19     2  423    1     0     6    17    5     62
5     0     0    0    16    0  432     0     0     2   70      1
6     9     0    1     1    1    0  1883     1     4    2      6
7     0     9    0   101    1    0     1  7132    16    0      4
8     1     0    3    87    7    3     0    54  3132    0      9
9     0     0   12     4    0   41     0     2     1  433      0
10   22     0    1     8   60    1     7    11    38    0  12642
---- Validation: 
scalar performance:
{'acc': 0.97071016, 'precision': 0.9131887, 'recall': 0.9044853, 'specificity': 0.9968821, 'f1': 0.9074637, 'auroc': 0.9985935}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     2    0    0     4     1     4    6      8
1     0  1294    0     7    0    0     0    23     7    0      1
2     0     0  208     1   30    0     0     7     4   62      0
3     1     0    0  8293    0    9     3   100    32    2      0
4     4     0   26     3  422    0     0     4    13    5     62
5     0     0    0    17    0  434     0     1     1   67      1
6    12     0    0     2    2    1  1877     3     1    2      8
7     0     7    0    98    1    0     3  7137    14    1      4
8     1     0    2    94    5    5     1    63  3117    1      7
9     0     1   13     5    1   41     1     3     1  427      0
10   24     0    1     7   74    1    14    15    36    1  12623
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74658924, 'precision': 0.6778269, 'recall': 0.6343471, 'specificity': 0.97457355, 'f1': 0.6188358, 'auroc': 0.86745864}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1072     0    0    5    1    2    50    11    15   14     0
1      1  1302    0   21    1    0     7   142    10    0    15
2      5     3  118    5  223   26    25    24   388   87   111
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    3    0  367    0     7     2    23    1  1229
5      4     0    0   72    1  392     3     0     7  112     1
6      0     0    0    4    0    0  3050     2     3    0     8
7      0     0    0   83    0    0     4  1069     5    0     3
8      0     0    0  114    1    1     7     2  1243    2     0
9      9     9   56   71    7  240    10    65   217  439    14
10     0     0    0    0   22    0     4     0     1    0  1619
better model found
persisted
after epoch: 9,now: 2024-08-03 08:29:54.094513,epoch time: 0:43:45.774052,used: 6:41:52.065514,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_48_00_seed_0_24051355
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9669039, 'precision': 0.9182213, 'recall': 0.88633406, 'specificity': 0.99630284, 'f1': 0.8983985, 'auroc': 0.9984759}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     4    1    0     1     6     0    4      9
1     0  1249    0    11    0    0     0    69     2    0      1
2     0     0  226     1   19    1     0     4     1   60      0
3     0     0    0  8323    0    7     0    89    19    2      0
4     8     0   25     2  332    1     0     7     5    5    154
5     0     0    0    20    0  415     0     0     1   84      1
6    35     0    2     5    4    0  1844     3     1    1     10
7     1     4    1   108    1    0     1  7136     5    1      6
8     0     0    3   157    5    2     0   102  2987    7     31
9     2     0   25     3    0   24     0     0     1  438      0
10   13     0    1     9   13    2     3    11     8    2  12731
---- Validation: 
scalar performance:
{'acc': 0.96709913, 'precision': 0.9222953, 'recall': 0.8904197, 'specificity': 0.99631214, 'f1': 0.9024585, 'auroc': 0.9985931}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     1    0    0     0     3     1    6     11
1     0  1255    0     9    0    0     0    64     1    0      3
2     0     0  234     1   19    0     0     8     1   48      1
3     0     0    0  8321    0    8     0    85    24    2      0
4     6     0   22     2  339    0     0     5     5    9    151
5     0     0    0    21    0  414     0     0     2   83      1
6    30     1    1     5    1    0  1845     6     3    2     14
7     1     2    0   120    1    0     1  7127     8    1      4
8     4     0    2   145    6    3     0   103  2990    9     34
9     0     0   27     5    0   21     0     2     0  438      0
10   19     0    1     8   10    0     2    17     5    3  12731
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.699993, 'precision': 0.64680433, 'recall': 0.590079, 'specificity': 0.96998763, 'f1': 0.5801575, 'auroc': 0.8583976}
confusion matrix:
      0    1    2    3    4    5     6     7     8    9     10
0   1115    0    0    7    0    0     6    29     5    5     3
1      0  987    0   36    1    0     0   416     3    1    55
2     23    0  136   19  223    8    15    46   171   95   279
3      0    0    0    0    0    0     0     0     0    0     0
4      1    0    0    0  117    0     1     1     8    1  1504
5     14    0    0  101    0  263     8     0     5  191    10
6      8    0    0    2    1    0  2925     2     8    0   121
7      0    0    0  137    0    0     0  1024     0    0     3
8      0    0    0  130    1    1     6     7  1214    3     8
9     33    1  105  130    7   85     9    74    78  584    31
10     0    0    0    0    4    0     1     0     1    0  1640
early stop counter: 1
val acc:0.967099130153656, best validation acc: 0.9707101583480835, corresponding to test acc:                         0.7465892434120178 / 0.749807596206665
after epoch: 10,now: 2024-08-03 09:13:05.423625,epoch time: 0:43:11.329112,used: 7:25:03.394626,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_48_00_seed_0_24051355
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 7:25:03.394626 at 2024-08-03 09:13:05.423625
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74658924, 'precision': 0.6778269, 'recall': 0.6343471, 'specificity': 0.97457355, 'f1': 0.6188358, 'auroc': 0.86745864}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1072     0    0    5    1    2    50    11    15   14     0
1      1  1302    0   21    1    0     7   142    10    0    15
2      5     3  118    5  223   26    25    24   388   87   111
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    3    0  367    0     7     2    23    1  1229
5      4     0    0   72    1  392     3     0     7  112     1
6      0     0    0    4    0    0  3050     2     3    0     8
7      0     0    0   83    0    0     4  1069     5    0     3
8      0     0    0  114    1    1     7     2  1243    2     0
9      9     9   56   71    7  240    10    65   217  439    14
10     0     0    0    0   22    0     4     0     1    0  1619
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7498076, 'precision': 0.68915653, 'recall': 0.6347885, 'specificity': 0.97488004, 'f1': 0.64067346, 'auroc': 0.8792114}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1029     0    0   13    3    0    85   10    12   14     4
1      3  1198    0   36    2    0    11  222    11    1    15
2      9     0  268   10  226   10    52   19   277   64    80
3      0     0    0    0    0    0     0    0     0    0     0
4      1     0    6    0  530    0    17    1    14    0  1064
5     11     0    0   94    1  346     9    0    11  119     1
6      0     0    0    4    0    0  3055    1     2    0     5
7      0     0    0  160    0    0     7  990     4    0     3
8      0     0    0   94    1    0    16    2  1254    2     1
9     18     1  183   96   12  135    20   43   157  461    11
10     0     0    0    0   54    0     5    0     1    0  1586
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_01_48_00_seed_0_24051355_instance_wise_predictions.txt
accuracy from prediction file 0.7465892394878612
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/9.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2611 MiB |  16814 MiB | 414313 GiB | 414310 GiB |
|       from large pool |   2597 MiB |  16782 MiB | 411240 GiB | 411238 GiB |
|       from small pool |     14 MiB |     33 MiB |   3072 GiB |   3072 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2611 MiB |  16814 MiB | 414313 GiB | 414310 GiB |
|       from large pool |   2597 MiB |  16782 MiB | 411240 GiB | 411238 GiB |
|       from small pool |     14 MiB |     33 MiB |   3072 GiB |   3072 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2607 MiB |  16770 MiB | 412755 GiB | 412752 GiB |
|       from large pool |   2594 MiB |  16737 MiB | 409686 GiB | 409683 GiB |
|       from small pool |     13 MiB |     33 MiB |   3069 GiB |   3069 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  17542 MiB |  17542 MiB |  17542 MiB |      0 B   |
|       from large pool |  17506 MiB |  17506 MiB |  17506 MiB |      0 B   |
|       from small pool |     36 MiB |     36 MiB |     36 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 305829 KiB | 700029 KiB |  64355 GiB |  64355 GiB |
|       from large pool | 285440 KiB | 697280 KiB |  61277 GiB |  61277 GiB |
|       from small pool |  20389 KiB |  23171 KiB |   3078 GiB |   3078 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3082    |    4805    |   31279 K  |   31276 K  |
|       from large pool |     349    |     697    |   13399 K  |   13398 K  |
|       from small pool |    2733    |    4255    |   17880 K  |   17877 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3082    |    4805    |   31279 K  |   31276 K  |
|       from large pool |     349    |     697    |   13399 K  |   13398 K  |
|       from small pool |    2733    |    4255    |   17880 K  |   17877 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     510    |     510    |     510    |       0    |
|       from large pool |     492    |     492    |     492    |       0    |
|       from small pool |      18    |      18    |      18    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     170    |    1218    |   16908 K  |   16907 K  |
|       from large pool |     130    |     339    |    8787 K  |    8787 K  |
|       from small pool |      40    |    1087    |    8120 K  |    8120 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  16814 MiB | 414313 GiB | 414313 GiB |
|       from large pool |  16640 KiB |  16782 MiB | 411240 GiB | 411240 GiB |
|       from small pool |      0 KiB |     33 MiB |   3072 GiB |   3072 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  16814 MiB | 414313 GiB | 414313 GiB |
|       from large pool |  16640 KiB |  16782 MiB | 411240 GiB | 411240 GiB |
|       from small pool |      0 KiB |     33 MiB |   3072 GiB |   3072 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  16770 MiB | 412755 GiB | 412755 GiB |
|       from large pool |  16640 KiB |  16737 MiB | 409686 GiB | 409686 GiB |
|       from small pool |      0 KiB |     33 MiB |   3069 GiB |   3069 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2910 MiB |  17542 MiB |  17542 MiB |  14632 MiB |
|       from large pool |   2876 MiB |  17506 MiB |  17506 MiB |  14630 MiB |
|       from small pool |     34 MiB |     36 MiB |     36 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 700029 KiB |  64357 GiB |  64357 GiB |
|       from large pool |  24320 KiB | 697280 KiB |  61278 GiB |  61278 GiB |
|       from small pool |      0 KiB |  28880 KiB |   3078 GiB |   3078 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4805    |   31279 K  |   31279 K  |
|       from large pool |       2    |     697    |   13399 K  |   13399 K  |
|       from small pool |       0    |    4255    |   17880 K  |   17880 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4805    |   31279 K  |   31279 K  |
|       from large pool |       2    |     697    |   13399 K  |   13399 K  |
|       from small pool |       0    |    4255    |   17880 K  |   17880 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     150    |     510    |     510    |     360    |
|       from large pool |     133    |     492    |     492    |     359    |
|       from small pool |      17    |      18    |      18    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1218    |   16909 K  |   16909 K  |
|       from large pool |       3    |     339    |    8787 K  |    8787 K  |
|       from small pool |       0    |    1087    |    8121 K  |    8121 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  16814 MiB | 414313 GiB | 414313 GiB |
|       from large pool |  16640 KiB |  16782 MiB | 411240 GiB | 411240 GiB |
|       from small pool |      0 KiB |     33 MiB |   3072 GiB |   3072 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  16814 MiB | 414313 GiB | 414313 GiB |
|       from large pool |  16640 KiB |  16782 MiB | 411240 GiB | 411240 GiB |
|       from small pool |      0 KiB |     33 MiB |   3072 GiB |   3072 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  16770 MiB | 412755 GiB | 412755 GiB |
|       from large pool |  16640 KiB |  16737 MiB | 409686 GiB | 409686 GiB |
|       from small pool |      0 KiB |     33 MiB |   3069 GiB |   3069 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2910 MiB |  17542 MiB |  17542 MiB |  14632 MiB |
|       from large pool |   2876 MiB |  17506 MiB |  17506 MiB |  14630 MiB |
|       from small pool |     34 MiB |     36 MiB |     36 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 700029 KiB |  64357 GiB |  64357 GiB |
|       from large pool |  24320 KiB | 697280 KiB |  61278 GiB |  61278 GiB |
|       from small pool |      0 KiB |  28880 KiB |   3078 GiB |   3078 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4805    |   31279 K  |   31279 K  |
|       from large pool |       2    |     697    |   13399 K  |   13399 K  |
|       from small pool |       0    |    4255    |   17880 K  |   17880 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4805    |   31279 K  |   31279 K  |
|       from large pool |       2    |     697    |   13399 K  |   13399 K  |
|       from small pool |       0    |    4255    |   17880 K  |   17880 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     150    |     510    |     510    |     360    |
|       from large pool |     133    |     492    |     492    |     359    |
|       from small pool |      17    |      18    |      18    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1218    |   16909 K  |   16909 K  |
|       from large pool |       3    |     339    |    8787 K  |    8787 K  |
|       from small pool |       0    |    1087    |    8121 K  |    8121 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")

using device: cuda:0

reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_31_58_seed_1_24051355

 Experiment start at: 2024-08-03 09:31:59.598864
before training, model accuracy: 0.06926468014717102
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92034996, 'precision': 0.8334984, 'recall': 0.709537, 'specificity': 0.99110556, 'f1': 0.7433789, 'auroc': 0.9839345}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   250     0    1    14   0    1    53    22    19    5    117
1     0  1221    0    26   0    0     0    64    13    0      6
2     3     0  146     2  22    0     7    25    71   27      9
3     0     2    0  7944   0    5     0   263   224    0      1
4     1     2   28     4  79    0    10     7   149    5    254
5     2     0   10    77   0  310     1     0    26   94      1
6     3     2    0    15   0    0  1726    11    22    4    125
7     0    11    0   252   0    0     0  6835   142    0     22
8     0     1    2   124   0    0     0    63  3050    0     56
9     2     0  105    17   1   85     5     6    36  227      9
10    2     1    0     8   0    0    18    41   112    1  12611
---- Validation: 
scalar performance:
{'acc': 0.9197539, 'precision': 0.8346341, 'recall': 0.7111279, 'specificity': 0.99105525, 'f1': 0.7433598, 'auroc': 0.98460007}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   258     0    2    14   0    0    56    19    23    6    105
1     0  1222    0    25   0    0     0    70     9    0      6
2     1     1  152     5  16    1     6    23    60   34     13
3     0     1    0  7909   0    7     0   308   215    0      0
4     0     0   27     2  77    0     8     8   152   11    254
5     0     0   12    76   0  307     1     0    20  104      1
6     4     1    0    15   0    1  1727    12    22    4    122
7     0    14    0   248   0    0     1  6832   148    0     22
8     0     1    1   130   0    1     0    58  3052    0     53
9     2     0  102    18   1   89     2     5    43  225      6
10    3     0    1     7   0    1    12    36   111    1  12624
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.50241375, 'precision': 0.56307197, 'recall': 0.45675588, 'specificity': 0.9500587, 'f1': 0.41503847, 'auroc': 0.7900532}
confusion matrix:
     0     1   2    3   4    5    6     7     8   9     10
0   815     0   0  119   1    0   81    61    61   2    30
1     1  1069   0   53   0    0    3   309    19   0    45
2    29     0  14   44   9    1   18    44   659  20   177
3     0     0   0    0   0    0    0     0     0   0     0
4     0     0   0    0   9    0    2     4    58   0  1560
5    21     0   0  247   0  193    7     0    48  75     1
6     0     2   0   18   6    0  979    33   508   0  1521
7     0     0   0   42   0    0    1  1114     3   1     3
8     0     0   0  111   0    1    1     2  1252   0     3
9    78     2  19  315   4   42   12    53   491  90    31
10    0     0   0    0   0    0    0     0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 10:16:23.920882,epoch time: 0:44:24.322018,used: 0:44:24.322018,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_31_58_seed_1_24051355
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9427708, 'precision': 0.86285955, 'recall': 0.7898014, 'specificity': 0.993619, 'f1': 0.8161056, 'auroc': 0.9919777}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   374     0    0    12    0    0    13     9    11    3     61
1     0  1264    0    21    0    0     0    37     4    0      6
2     3     2  117     3   54    5     3    16    28   75      6
3     0     1    0  8203    0   13     0   119    99    1      1
4     1     0   11     1  239    3    11     5    53   11    204
5     2     0    2    35    0  435     0     0     5   41      1
6    10     0    0     7    0    1  1859     3    11    2     15
7     0    14    0   366    1    0     1  6787    71    0     22
8     1     1    2   156    3    0     0    71  3012    0     50
9     2     0   37    14    3  154     2    11    10  258      1
10    4     0    0     8   11    1    19    21    39    2  12689
---- Validation: 
scalar performance:
{'acc': 0.9412064, 'precision': 0.8567065, 'recall': 0.7881235, 'specificity': 0.99344325, 'f1': 0.81408805, 'auroc': 0.9921735}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   358     0    0    11    2    0    20    12     7    5     68
1     0  1269    0    14    0    0     0    37     7    0      5
2     2     2  122     4   57    3     2    14    21   81      4
3     0     2    0  8190    0    9     0   136   103    0      0
4     2     0   14     1  238    3     4    11    48   11    207
5     0     0    3    35    0  434     1     0     5   42      1
6     7     1    0    10    1    0  1860     1    10    2     16
7     0    18    0   383    1    0     1  6777    68    0     17
8     1     0    2   168    5    1     1    80  2989    1     48
9     3     0   44    12    4  147     2    10     6  263      2
10    4     1    2     8   17    1    11    26    37    2  12687
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66983837, 'precision': 0.6304518, 'recall': 0.5763188, 'specificity': 0.9668603, 'f1': 0.5281627, 'auroc': 0.82376057}
confusion matrix:
      0     1   2    3   4    5     6     7     8    9     10
0   1018     2   0   28   0    1    36    22    36    7    20
1      0  1136   0   38   0    1     3   251    21    0    49
2     13     0  21   13  94   51    10    30   498   45   240
3      0     0   0    0   0    0     0     0     0    0     0
4      1     0   0    0  46    0     2     2    23    0  1559
5     19     0   0   89   0  438     3     0    18   23     2
6      0     1   0    4   2    0  2702     5   162    0   191
7      0     0   0   66   0    1     1  1089     3    0     4
8      0     0   0   65   0    3     0     2  1298    0     2
9     36     1   7  104  27  255     1    45   450  182    29
10     0     0   0    0   1    0     0     1     0    0  1644
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 10:59:17.624237,epoch time: 0:42:53.703355,used: 1:27:18.025373,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_31_58_seed_1_24051355
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94461685, 'precision': 0.8662503, 'recall': 0.84180045, 'specificity': 0.993935, 'f1': 0.8525659, 'auroc': 0.995503}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    1    10    2    0    10     5     5    8     17
1     0  1243    0    19    0    0     0    65     4    0      1
2     2     0  178     1   33    2     1     6     7   82      0
3     0     0    0  8307    0    7     0    76    45    2      0
4     6     0   28     4  338    2     1     5    35   12    108
5     1     0    1    39    0  410     0     0     5   64      1
6     9     0    0     8    1    1  1870     4     5    4      6
7     0     8    0   455    1    0     2  6763    31    0      4
8     2     0    3   276   10    1     0    76  2908    0     18
9     2     0   38     9    0   85     0     5     5  347      1
10   54     1    3    11   73    2    16    52    63    2  12517
---- Validation: 
scalar performance:
{'acc': 0.94465697, 'precision': 0.8675411, 'recall': 0.83568996, 'specificity': 0.9939173, 'f1': 0.8494704, 'auroc': 0.995635}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    0     8    3    0     9     8     7    7     16
1     0  1241    0    22    0    0     0    65     2    0      2
2     1     1  173     2   35    3     1     8     7   80      1
3     0     0    0  8320    0    8     0    60    50    2      0
4     4     0   24     2  321    2     3     9    36   14    124
5     1     0    2    40    0  401     0     0     2   74      1
6    14     0    0    11    1    0  1863     4     6    2      7
7     2     4    0   457    1    0     1  6764    32    0      4
8     2     0    4   277   11    0     1    66  2912    1     22
9     1     0   35    10    1   93     0     1     4  347      1
10   40     1    3    11   57    1    22    53    57    2  12549
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6923669, 'precision': 0.66447604, 'recall': 0.5884542, 'specificity': 0.9696322, 'f1': 0.58872736, 'auroc': 0.8562753}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1036     1   0   59    2    0    22    19     4   25     2
1      0  1036   0   42    0    0     0   416     1    0     4
2      9     0  80   59  253   10     2    63   413   74    52
3      0     0   0    0    0    0     0     0     0    0     0
4      3     0   0    0  623    0     1     9    20    1   976
5      3     0   0  148    1  330     0     0    13   97     0
6      4     3   0  131   20    0  2658    51   103    0    97
7      1     0   0  104    0    0     0  1058     0    0     1
8      0     0   0  190    2    0     0    17  1157    2     2
9     12     1  63  248   21  100     0    87   260  343     2
10     0     0   0    0   69    0     0     2     0    0  1575
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-03 11:41:51.636193,epoch time: 0:42:34.011956,used: 2:09:52.037329,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_31_58_seed_1_24051355
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95208156, 'precision': 0.8900752, 'recall': 0.83463746, 'specificity': 0.99468654, 'f1': 0.8543711, 'auroc': 0.9953023}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   409     1    2     8    0    1     7     7    10   11     27
1     0  1267    0    10    0    0     0    52     3    0      0
2     1     0  208     2   14    2     0    18    10   56      1
3     0     3    0  8227    0    6     1   164    37    2      0
4     3     1   57     0  227    2     3    12    50   10    173
5     0     0    2    45    0  414     0     0     7   52      1
6     6     2    0     8    0    0  1858     6     6    9     13
7     0     8    0   161    1    1     1  7065    19    0      6
8     1     0    3   197    1    0     1   142  2919    2     28
9     1     0   33     5    0   90     0    10     7  347      0
10   11     1    4     7   12    1    17    36    56    4  12644
---- Validation: 
scalar performance:
{'acc': 0.95327, 'precision': 0.89377606, 'recall': 0.8384429, 'specificity': 0.99480426, 'f1': 0.85868204, 'auroc': 0.9954706}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   413     0    1     5    0    1     8    11     8    9     27
1     0  1271    0     8    0    0     0    51     2    0      0
2     1     1  215     1   10    1     0    16     5   58      4
3     0     1    0  8228    0    5     0   169    36    1      0
4     2     1   53     0  238    1     1    17    36   14    176
5     0     0    1    48    0  410     0     0     4   57      1
6     3     1    0     4    0    1  1866     8     5    7     13
7     0     9    0   145    1    0     1  7087    19    0      3
8     0     0    4   197    3    0     1   151  2918    1     21
9     1     0   37     9    0   90     1     9     4  342      0
10   11     1    2     8   14    2     8    45    54    1  12650
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6487791, 'precision': 0.6581787, 'recall': 0.55316746, 'specificity': 0.9652775, 'f1': 0.53712595, 'auroc': 0.8241776}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   943     2   1   58    0    1    35    47    17   62     4
1     0  1025   0   37    0    0     0   424     4    0     9
2     1     0  75   49   56   19     2   112   525   79    97
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   0    0  172    0     1     8    49    2  1400
5     1     0   0  175    1  358     0     0     4   53     0
6     0     1   0  105    4    0  2619    22   227    0    89
7     0     0   0  103    0    0     0  1060     0    0     1
8     0     0   0  253    0    1     0    13  1101    1     1
9     7     1  28  257    2  174     0   115   258  281    14
10    0     0   0    0    5    0     0     1     1    0  1639
better model found
persisted
after epoch: 4,now: 2024-08-03 12:25:23.312387,epoch time: 0:43:31.676194,used: 2:53:23.713523,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_31_58_seed_1_24051355
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9602954, 'precision': 0.8825655, 'recall': 0.8769027, 'specificity': 0.9957776, 'f1': 0.8778142, 'auroc': 0.9974237}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     6    1    0     3     1     5    1      6
1     0  1286    0    10    0    0     0    33     2    0      0
2     5     0  234     2   31    0     0     5     4   31      0
3     0     1    0  8182    0    7     1   157    87    1      0
4     8     1   38     0  343    2     0     5    32    7    103
5     3     0    0    32    0  419     0     0     6   60      1
6    23     0    0     1    1    0  1866     4     5    1      7
7     0    11    1   124    1    0     2  7078    40    2      4
8     1     0    6    89    5    1     0    68  3119    0      6
9     3     0   54     6    2   79     0     6     5  338      0
10   80     0    1     8   42    1    11    25    60    0  12567
---- Validation: 
scalar performance:
{'acc': 0.9605992, 'precision': 0.8892891, 'recall': 0.8782674, 'specificity': 0.99579203, 'f1': 0.8819715, 'auroc': 0.9973255}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     6    0    0     4     3     5    1      7
1     0  1288    0     9    0    0     0    31     4    0      0
2     5     0  233     2   31    1     1     6     4   29      0
3     1     0    0  8213    0    4     2   143    76    1      0
4     9     1   28     1  355    1     0     3    32    6    103
5     4     0    2    40    0  415     0     0     7   52      1
6    23     0    0     4    2    0  1863     1     8    1      6
7     1    10    0   133    2    0     1  7073    42    0      3
8     1     0    3   101    2    0     1    74  3109    0      5
9     8     0   52     6    2   68     0     5     8  344      0
10   75     1    1     7   43    0     9    25    71    2  12562
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6967047, 'precision': 0.6642184, 'recall': 0.58206666, 'specificity': 0.97004086, 'f1': 0.55962163, 'auroc': 0.84337515}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1100     1   0   25    0    1     5    20    13    5     0
1      0  1252   0   34    0    0     0   204     3    0     6
2     28     0  67   58   92   31     5    46   532   52   104
3      0     0   0    0    0    0     0     0     0    0     0
4      4     0   2    0  250    0     3     1    46    1  1326
5     16     0   2  267    1  294     0     0     3    9     0
6      7     0   0   70    1    0  2877     4    67    0    41
7      6     1   0   43    0    0     2  1108     3    0     1
8      0     0   0  157    0    1     1     3  1208    0     0
9     41     2  44  299    6  192     0    62   310  166    15
10     0     0   0    0    8    0     0     1     1    0  1636
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-03 13:10:35.334609,epoch time: 0:45:12.022222,used: 3:38:35.735745,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_31_58_seed_1_24051355
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9623555, 'precision': 0.90274036, 'recall': 0.8640243, 'specificity': 0.99585104, 'f1': 0.87706184, 'auroc': 0.997575}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    0     1    1    0     4     2     1    6     28
1     0  1285    0     8    0    0     0    34     3    0      2
2     3     0  208     0   38    0     1     1     3   53      5
3     1     1    0  8196    0   10     0   139    85    3      0
4     5     0   23     0  308    0     1     2    17    8    175
5     0     0    0    19    0  344     1     0     3  153      1
6    27     0    0     3    1    0  1847     4     4    3     19
7     0    10    0    86    1    0     1  7073    69    1     22
8     1     0    4    75    4    2     0    59  3110    1     39
9     2     0   27     2    1   22     0     3     1  433      2
10   20     0    0     8    9    0     5     9    18    1  12725
---- Validation: 
scalar performance:
{'acc': 0.9620169, 'precision': 0.90691245, 'recall': 0.86941147, 'specificity': 0.99579436, 'f1': 0.8824787, 'auroc': 0.9976888}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     0    0    0     4     2     0    4     27
1     0  1282    0    10    0    0     0    36     4    0      0
2     1     1  210     0   33    0     0     4     5   55      3
3     0     1    0  8186    0   12     0   149    91    1      0
4     6     0   21     1  321    0     0     2    14    8    166
5     0     0    0    19    0  354     0     0     4  143      1
6    15     0    1     6    1    0  1850     2     2    2     29
7     1    11    1    78    1    0     1  7051    76    3     42
8     4     1    4    69    5    0     0    62  3108    4     39
9     1     0   22     6    3   18     0     2     3  435      3
10   18     0    2     6   15    0     5     6    19    3  12722
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7121668, 'precision': 0.6721083, 'recall': 0.5963597, 'specificity': 0.97129095, 'f1': 0.58353704, 'auroc': 0.8500528}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1078     1   0   25    1    0     2    17    14   27     5
1      2  1217   0   32    1    0     0   218     9    0    20
2     15     0  92   24  146    5     0    36   371  119   207
3      0     0   0    0    0    0     0     0     0    0     0
4      1     0   1    0  189    0     1     2    21    1  1417
5      8     0   0  131    1  199     0     0     6  247     0
6     10     0   0   49    1    0  2848     3    41    0   115
7      7     1   0   40    0    0     1  1110     2    1     2
8      1     0   0  130    0    0     0    15  1220    2     2
9     20     2  64  179    7   34     0    71   148  585    27
10     0     0   0    0    5    0     0     0     0    0  1641
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-03 13:54:52.027407,epoch time: 0:44:16.692798,used: 4:22:52.428543,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_31_58_seed_1_24051355
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96746576, 'precision': 0.9051693, 'recall': 0.87766826, 'specificity': 0.9964628, 'f1': 0.88948095, 'auroc': 0.9982621}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    1     3    0    1     3     6     0    1     17
1     0  1287    0     4    0    0     0    38     3    0      0
2     6     0  216     0   34    0     0     4     7   41      4
3     0     0    0  8237    0    5     0   131    66    0      0
4     9     1   20     0  345    0     4     3    17    8    132
5     5     0    1    15    0  417     1     1     6   73      2
6    15     1    1     0    2    0  1869     5     3    1      9
7     1     7    0    86    1    0     1  7139    23    0      5
8     5     0    3    67    5    2     0    67  3132    0     13
9    11     0   37     6    2   63     0     2     6  364      2
10   21     0    1     7   11    0     8    19    23    1  12703
---- Validation: 
scalar performance:
{'acc': 0.96776783, 'precision': 0.9087602, 'recall': 0.88402784, 'specificity': 0.99649215, 'f1': 0.8946961, 'auroc': 0.9982111}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     4    0    0     5     2     0    2     16
1     0  1293    0     2    0    0     0    34     3    0      0
2     4     0  227     2   32    1     1     5     7   33      0
3     1     2    0  8224    1    7     0   134    71    0      0
4     6     0   20     0  346    2     2     2    17    6    138
5     4     0    0    22    0  427     0     0     6   61      1
6    14     1    1     1    1    1  1871     5     5    1      7
7     0     9    0    87    1    0     1  7133    30    0      4
8     1     3    3    57    3    0     2    66  3141    1     19
9    10     0   45     2    3   55     1     4     6  366      1
10   24     0    1     8   15    1    10    14    24    1  12698
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7064297, 'precision': 0.65024155, 'recall': 0.59778845, 'specificity': 0.9707047, 'f1': 0.5614228, 'auroc': 0.8486861}
confusion matrix:
      0     1   2    3   4    5     6     7     8    9     10
0   1119     1   0   10   0    0     3    30     3    3     1
1      0  1148   0   27   0    0     1   309     7    0     7
2     39     0  77   16  60   23     4    53   426   86   231
3      0     0   0    0   0    0     0     0     0    0     0
4      3     0   1    0  74    0     6     3    21    1  1524
5     30     0   0  135   0  378     1     0    11   35     2
6      0     0   0    5   0    0  3022     3    11    0    26
7      1     0   0   47   0    0     0  1115     0    0     1
8      0     0   0  112   0    2     1     8  1245    0     2
9     49     1  43  159   3  220     1    73   284  279    25
10     0     0   0    0   2    0     3     1     0    0  1640
better model found
persisted
after epoch: 7,now: 2024-08-03 14:39:49.738130,epoch time: 0:44:57.710723,used: 5:07:50.139266,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_31_58_seed_1_24051355
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9670109, 'precision': 0.91126704, 'recall': 0.88415384, 'specificity': 0.9963704, 'f1': 0.8950077, 'auroc': 0.9985086}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     0    0     4    1    0     4     6     2    7     23
1     0  1287    0     9    1    0     0    32     2    0      0
2     0     0  210     0   24    2     0     2     5   68      1
3     0     1    0  8239    0   29     0   104    66    1      0
4     1     0   29     0  343    1     0     2    14    4    145
5     0     0    1     9    0  478     0     0     1   31      1
6     9     0    1     5    1    0  1866     4     4    5     13
7     0    10    1   134    1    0     1  7064    44    1      7
8     1     0    5    69    7    7     0    48  3120    2     36
9     1     0   16     1    0   97     0     0     1  375      2
10    4     0    2     6   17    0     9    11    16    1  12725
---- Validation: 
scalar performance:
{'acc': 0.9679818, 'precision': 0.91334903, 'recall': 0.8868146, 'specificity': 0.9964629, 'f1': 0.89768064, 'auroc': 0.99859047}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    0     2    2    1     2     4     3    3     27
1     0  1291    0     7    1    0     0    30     3    0      0
2     0     0  216     0   23    2     0     1     3   66      1
3     1     2    0  8262    0   25     0    89    61    0      0
4     2     0   23     0  347    1     1     0    11    7    147
5     1     0    0     6    0  475     0     0     4   34      1
6     9     0    0     4    1    0  1867     5     3    3     16
7     0    13    0   124    2    0     1  7081    38    0      6
8     1     0    6    59    7    6     0    55  3111    1     50
9     0     0   14     2    2   99     0     1     0  374      1
10    4     0    3     7   22    0    10     9    13    3  12725
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7029315, 'precision': 0.64698035, 'recall': 0.6024189, 'specificity': 0.9703927, 'f1': 0.5692524, 'auroc': 0.84752303}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   951     0   3   37    3   19    17    25    34   71    10
1     0  1149   0   40    1    1     0   268    19    0    21
2     1     0  89    8  158   60     1    17   465   87   129
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   1    0  142    0     4     1    23    1  1460
5     2     0   0   61    1  495     0     0     8   25     0
6     0     0   0   11    1    0  3001     3    17    1    33
7     0     0   0  124    0    1     0  1027     9    1     2
8     0     0   0  115    0    5     1     0  1247    0     2
9     3     0  35   93    8  348     0    23   300  306    21
10    0     0   0    0    3    0     2     1     0    0  1640
better model found
persisted
after epoch: 8,now: 2024-08-03 15:23:59.594710,epoch time: 0:44:09.856580,used: 5:51:59.995846,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_31_58_seed_1_24051355
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.967439, 'precision': 0.8907458, 'recall': 0.91411674, 'specificity': 0.99664974, 'f1': 0.89876425, 'auroc': 0.9986167}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    3     1    3    0     0     6     0    5      7
1     0  1309    0     5    1    0     0    14     3    0      0
2     0     0  265     1   28    0     0     3     2   13      0
3     0     6    0  8227    0    3     0   146    56    1      0
4     5     1   24     0  471    1     0     1    13    0     23
5     0     0    2    13    0  472     0     0     2   31      1
6    31     1    2     2    6    1  1833    10     3    2     17
7     0    44    1    66    1    0     1  7118    27    0      4
8     1     1   12    56    8    0     0    62  3149    0      4
9     0     0   87     2    2   83     0     1     1  317      0
10   18     3    5     6  161    2     2    24    32    1  12540
---- Validation: 
scalar performance:
{'acc': 0.9656012, 'precision': 0.8839422, 'recall': 0.905297, 'specificity': 0.99645114, 'f1': 0.8914304, 'auroc': 0.9985732}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     1    5     2    0    0     0     7     0    4      5
1     0  1313    0     3    0    0     0    12     4    0      0
2     0     0  259     0   32    0     0     3     2   16      0
3     0     4    1  8216    0    2     0   168    48    1      0
4     6     1   26     0  463    0     0     1     7    2     33
5     0     0    3    25    0  448     0     0     4   40      1
6    25     3    1     2    7    1  1839     7     3    4     16
7     0    44    0    70    1    0     1  7107    38    0      4
8     0     2    5    58    7    2     0    57  3156    2      7
9     0     0   93     1    2   88     0     0     3  306      0
10   22     5    9     8  154    0     3    16    45    1  12533
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75729376, 'precision': 0.67507905, 'recall': 0.6548207, 'specificity': 0.9757402, 'f1': 0.64385605, 'auroc': 0.8594761}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1035     3   18   13    7    7     4    17     4   60     2
1      0  1367    3   30    1    0     0    90     4    0     4
2      1     3  262    4  330   17     0    23   261   59    55
3      0     0    0    0    0    0     0     0     0    0     0
4      2     1    4    1  373    0     1     0    14    1  1236
5      2     0    2   66    3  451     0     0    10   56     2
6      0     1    1    2    3    0  2970     3     7    1    79
7      1     3    1   44    0    1     0  1109     3    1     1
8      0     0    0  112    0    1     1     3  1250    1     2
9      3     6  236   64   15  230     0    34   155  387     7
10     0     2    0    0   21    0     1     1     1    0  1620
new oracle model saved
early stop counter: 1
val acc:0.9656012058258057, best validation acc: 0.9679818153381348, corresponding to test acc:                         0.7029315233230591 / 0.7572937607765198
after epoch: 9,now: 2024-08-03 16:06:49.997349,epoch time: 0:42:50.402639,used: 6:34:50.398485,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_31_58_seed_1_24051355
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9722014, 'precision': 0.9141872, 'recall': 0.911673, 'specificity': 0.99704117, 'f1': 0.91205764, 'auroc': 0.9988863}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     0    1     4    0    0     4     2     1    1     27
1     0  1311    0     4    0    0     0    13     4    0      0
2     1     0  264     1   17    1     1     4     4   19      0
3     0     1    0  8232    0    5     0   119    81    0      0
4     4     0   26     0  454    1     1     0     9    2     42
5     0     0    2    16    1  412     0     0     2   88      0
6     4     1    0     1    2    0  1874     1     2    2     21
7     1    18    0    80    2    0     2  7096    46    0     17
8     0     0    3    38    7    0     0    37  3190    0     19
9     1     0   70     2    1   39     2     2     4  371      1
10    4     0    2     7   61    1     4     4    21    0  12690
---- Validation: 
scalar performance:
{'acc': 0.9717801, 'precision': 0.9082013, 'recall': 0.905792, 'specificity': 0.9970137, 'f1': 0.906003, 'auroc': 0.9989038}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    1     6    0    0     3     2     1    4     26
1     0  1310    0     7    0    0     0    13     2    0      0
2     3     0  259     0   24    3     0     1     6   16      0
3     2     2    0  8247    0    3     0   117    68    1      0
4     3     1   24     0  446    1     1     0    12    1     50
5     0     0    3    19    0  415     0     0     5   78      1
6     6     0    0     1    2    0  1879     1     2    0     17
7     0    18    1    86    3    0     1  7099    47    0     10
8     1     2    6    34    7    1     0    32  3200    0     13
9     0     0   82     4    2   47     2     0     4  352      0
10    6     0    1     6   62    0     4     7    25    2  12683
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74477017, 'precision': 0.6775683, 'recall': 0.631376, 'specificity': 0.9744096, 'f1': 0.63002527, 'auroc': 0.8640463}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   939     0    1   30    3    1    78    30    12   58    18
1     0  1262    1   33    2    1     7   170     5    1    17
2     1     1  153    7  316   14    16    17   273   87   130
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    3    0  483    0     2     0    15    1  1129
5     2     0    0  101    2  384     2     0    11   89     1
6     0     0    0    2    3    1  3023     0     5    0    33
7     6     0    0  114    0    1     9  1021     7    1     5
8     0     0    0   87    0    3     5     1  1270    1     3
9     2     2  129   90   26  164     7    32   169  492    24
10    0     0    0    0   27    0     0     0     1    0  1618
better model found
persisted
after epoch: 10,now: 2024-08-03 16:50:45.473652,epoch time: 0:43:55.476303,used: 7:18:45.874788,model: blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_31_58_seed_1_24051355
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 7:18:45.874788 at 2024-08-03 16:50:45.473652
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74477017, 'precision': 0.6775683, 'recall': 0.631376, 'specificity': 0.9744096, 'f1': 0.63002527, 'auroc': 0.8640463}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   939     0    1   30    3    1    78    30    12   58    18
1     0  1262    1   33    2    1     7   170     5    1    17
2     1     1  153    7  316   14    16    17   273   87   130
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    3    0  483    0     2     0    15    1  1129
5     2     0    0  101    2  384     2     0    11   89     1
6     0     0    0    2    3    1  3023     0     5    0    33
7     6     0    0  114    0    1     9  1021     7    1     5
8     0     0    0   87    0    3     5     1  1270    1     3
9     2     2  129   90   26  164     7    32   169  492    24
10    0     0    0    0   27    0     0     0     1    0  1618
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75729376, 'precision': 0.67507905, 'recall': 0.6548207, 'specificity': 0.9757402, 'f1': 0.64385605, 'auroc': 0.8594761}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1035     3   18   13    7    7     4    17     4   60     2
1      0  1367    3   30    1    0     0    90     4    0     4
2      1     3  262    4  330   17     0    23   261   59    55
3      0     0    0    0    0    0     0     0     0    0     0
4      2     1    4    1  373    0     1     0    14    1  1236
5      2     0    2   66    3  451     0     0    10   56     2
6      0     1    1    2    3    0  2970     3     7    1    79
7      1     3    1   44    0    1     0  1109     3    1     1
8      0     0    0  112    0    1     1     3  1250    1     2
9      3     6  236   64   15  230     0    34   155  387     7
10     0     2    0    0   21    0     1     1     1    0  1620
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_diva_b8efecac6_not_commited_2024md_08md_03_09_31_58_seed_1_24051355_instance_wise_predictions.txt
accuracy from prediction file 0.7447701672147204
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_vit_different_models_rest_2024-08-03_01-31-43/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2612 MiB |  16815 MiB |    809 TiB |    809 TiB |
|       from large pool |   2597 MiB |  16783 MiB |    803 TiB |    803 TiB |
|       from small pool |     14 MiB |     33 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   2612 MiB |  16815 MiB |    809 TiB |    809 TiB |
|       from large pool |   2597 MiB |  16783 MiB |    803 TiB |    803 TiB |
|       from small pool |     14 MiB |     33 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2608 MiB |  16770 MiB |    806 TiB |    806 TiB |
|       from large pool |   2594 MiB |  16737 MiB |    800 TiB |    800 TiB |
|       from small pool |     14 MiB |     33 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  17562 MiB |  17562 MiB |  32194 MiB |  14632 MiB |
|       from large pool |  17526 MiB |  17526 MiB |  32156 MiB |  14630 MiB |
|       from small pool |     36 MiB |     36 MiB |     38 MiB |      2 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 304911 KiB | 719869 KiB | 128707 GiB | 128707 GiB |
|       from large pool | 285440 KiB | 717120 KiB | 122548 GiB | 122547 GiB |
|       from small pool |  19471 KiB |  28880 KiB |   6159 GiB |   6159 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4024    |    5294    |   62560 K  |   62556 K  |
|       from large pool |     349    |     697    |   26798 K  |   26798 K  |
|       from small pool |    3675    |    4842    |   35761 K  |   35758 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4024    |    5294    |   62560 K  |   62556 K  |
|       from large pool |     349    |     697    |   26798 K  |   26798 K  |
|       from small pool |    3675    |    4842    |   35761 K  |   35758 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     511    |     511    |     871    |     360    |
|       from large pool |     493    |     493    |     852    |     359    |
|       from small pool |      18    |      18    |      19    |       1    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     178    |    1225    |   33795 K  |   33795 K  |
|       from large pool |     130    |     339    |   17529 K  |   17529 K  |
|       from small pool |      48    |    1094    |   16266 K  |   16266 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  16815 MiB |    809 TiB |    809 TiB |
|       from large pool |  16640 KiB |  16783 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     33 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  16815 MiB |    809 TiB |    809 TiB |
|       from large pool |  16640 KiB |  16783 MiB |    803 TiB |    803 TiB |
|       from small pool |      0 KiB |     33 MiB |      6 TiB |      6 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  16770 MiB |    806 TiB |    806 TiB |
|       from large pool |  16640 KiB |  16737 MiB |    800 TiB |    800 TiB |
|       from small pool |      0 KiB |     33 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2910 MiB |  17562 MiB |  32194 MiB |  29284 MiB |
|       from large pool |   2876 MiB |  17526 MiB |  32156 MiB |  29280 MiB |
|       from small pool |     34 MiB |     36 MiB |     38 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 719869 KiB | 128708 GiB | 128708 GiB |
|       from large pool |  24320 KiB | 717120 KiB | 122549 GiB | 122549 GiB |
|       from small pool |      0 KiB |  28880 KiB |   6159 GiB |   6159 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    5294    |   62560 K  |   62560 K  |
|       from large pool |       2    |     697    |   26798 K  |   26798 K  |
|       from small pool |       0    |    4842    |   35761 K  |   35761 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    5294    |   62560 K  |   62560 K  |
|       from large pool |       2    |     697    |   26798 K  |   26798 K  |
|       from small pool |       0    |    4842    |   35761 K  |   35761 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     150    |     511    |     871    |     721    |
|       from large pool |     133    |     493    |     852    |     719    |
|       from small pool |      17    |      18    |      19    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1225    |   33797 K  |   33797 K  |
|       from large pool |       3    |     339    |   17529 K  |   17529 K  |
|       from small pool |       0    |    1094    |   16267 K  |   16267 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Aug  3 16:59:41 2024]
Finished job 0.
1 of 1 steps (100%) done
