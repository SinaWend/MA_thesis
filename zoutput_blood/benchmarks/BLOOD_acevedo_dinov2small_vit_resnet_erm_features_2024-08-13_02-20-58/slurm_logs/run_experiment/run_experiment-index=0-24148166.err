Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Aug 13 07:54:47 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_dinov2small_vit_resnet_erm_features_2024-08-13_02-20-58/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_dinov2small_vit_resnet_erm_features_2024-08-13_02-20-58/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_08_07_38_seed_0_24148166

 Experiment start at: 2024-08-13 08:07:39.459821
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.12040859460830688
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9419414, 'precision': 0.8660363, 'recall': 0.81779647, 'specificity': 0.993539, 'f1': 0.8354707, 'auroc': 0.9957346}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   379     0    1     4    1    0     7     9     4    4     74
1     0  1256    0    13    0    0     0    53     5    0      5
2     0     0  147     0   49    3     1     4     5   89     14
3     2     0    1  7882    1   21     2   273   242   13      1
4     1     0   12     0  273    2     0     5    19   17    210
5     2     0    0    22    0  382     0     0     5  108      2
6    16     1    0     2    3    0  1834     8     9    3     32
7     2     7    3   164    2    0     2  6989    58    8     24
8     0     0   10    69   22    6     1    97  2972   13    106
9     2     0   16     5    1   62     0     2     4  397      4
10    8     0    5     8   36    0     7    16    19    1  12695
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9424636, 'precision': 0.86875796, 'recall': 0.8203635, 'specificity': 0.99360055, 'f1': 0.8383429, 'auroc': 0.9958345}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   383     0    0     5    0    0    13     7     4    6     65
1     0  1249    1    10    0    0     0    64     3    0      5
2     3     0  151     0   41    1     0     5     3   90     18
3     2     1    2  7887    2   20     2   298   217    9      0
4     1     0   18     1  282    2     0     5    16   17    197
5     2     0    1    22    1  385     0     0     4  105      1
6    21     1    0     2    8    0  1827     6     7    3     33
7     1     8    1   158    1    0     4  7005    60    7     20
8     2     0    5    73   22    1     0    95  2979   14    105
9     3     0   15     3    1   62     0     2     7  392      8
10    9     0    3     9   28    0    11    19    21    2  12694
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.727419, 'precision': 0.64948344, 'recall': 0.6173937, 'specificity': 0.9723746, 'f1': 0.60362333, 'auroc': 0.8841384}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1013     2    0   4    0    0    56    26    42    8    19
1      2  1137    0  20    1    1     3   255     5    7    68
2     23     6  234   3  217    5    14    37   114   53   309
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    2   0  147    0     2     2     6    0  1472
5     60     0    2  28    2  319     2     0    16  155     8
6      1     0    0   1    3    0  3016     3    13    0    30
7      0     1    0  16    0    0    10  1125     0    3     9
8      3     0    2  26    7    4    16    15  1277    9    11
9     57     8  221  19    4   85    16    52   137  486    52
10     0     0    0   0    3    0     0     0     0    0  1643
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-13 08:46:33.357755,epoch time: 0:38:53.897934,used: 0:38:53.897934,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_08_07_38_seed_0_24148166
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94413525, 'precision': 0.87242794, 'recall': 0.84809476, 'specificity': 0.9939166, 'f1': 0.8567453, 'auroc': 0.99734586}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     2    1     3    0    0     2     7     0    1     54
1     0  1296    0     4    0    0     0    31     1    0      0
2     5     0  241     0   26    1     0    12     5   17      5
3     1    10    0  7650    0   22     0   559   197    0      0
4     3     2   40     0  307    3     0     8    30    7    138
5     2     0    5    20    1  392     0     0    10   90      1
6    15     2    1     1    1    2  1823     6     9    1     46
7     2    28    2    57    1    0     2  7112    57    1      3
8     0     2    2    35    7    6     0   118  3102    0     23
9     1     2   96     3    0   56     0     8    10  313      4
10    9     0    1     7   36    0     3    29    65    2  12640
---- Validation: 
scalar performance:
{'acc': 0.9445232, 'precision': 0.8777041, 'recall': 0.851387, 'specificity': 0.99395204, 'f1': 0.8610393, 'auroc': 0.99732107}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   417     1    2     0    0    0     3     9     0    2     49
1     0  1292    0     5    0    0     0    33     2    0      0
2     3     0  242     0   20    2     0    12     7   22      4
3     0     7    0  7669    0   18     0   541   205    0      0
4     4     1   33     0  319    2     0     6    31    3    140
5     1     0    1    14    0  401     0     0     8   95      1
6    13     3    3     1    0    1  1811     7    12    2     55
7     0    25    0    50    1    0     1  7127    57    0      4
8     2     3    2    44    5    5     0   118  3092    0     25
9     8     2   90     3    3   54     0     7    13  311      2
10   10     0    5     5   27    1     2    30    85    1  12630
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7271392, 'precision': 0.6494452, 'recall': 0.6277697, 'specificity': 0.9725134, 'f1': 0.6015796, 'auroc': 0.88578373}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1042     8    1   6    1    0    14    36    31    6    25
1      0  1335    0  12    1    2     0   127     5    0    17
2      8     7  285   3  115   14     1    83   262   42   195
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    2   0  144    0     1     2    29    0  1455
5     11     0    3  31    0  382     0     0    21  139     5
6      0     3    0   2    3    0  2821    11    79    0   148
7      0     1    0   7    0    0     0  1150     1    1     4
8      0     1    0  37    0    2     1    22  1305    2     0
9     29    24  267  31    4  147     1   119   202  286    27
10     0     0    0   0    2    0     0     0     1    0  1643
better model found
persisted
after epoch: 2,now: 2024-08-13 09:25:52.588591,epoch time: 0:39:19.230836,used: 1:18:13.128770,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_08_07_38_seed_0_24148166
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95794094, 'precision': 0.8871071, 'recall': 0.8634334, 'specificity': 0.9954644, 'f1': 0.8671883, 'auroc': 0.9981505}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   405     0    1     1    1    1    28     8     2    7     29
1     0  1291    0    10    0    0     0    30     0    0      1
2     1     0  246     0    1    8     1     4     4   46      1
3     0     1    0  8314    0   21     3    41    57    1      0
4     2     1   84     0  285    3     1     6    33   10    113
5     0     0    0     8    0  501     0     0     0   11      1
6     3     0    0     4    1    0  1881     0     6    4      9
7     0    12    1   313    1    1     1  6881    48    0      6
8     1     4    4   117    2   13     0    48  3093    2     11
9     0     0   31     4    0  173     1     0     5  279      0
10    3     1    9     7   41    2    19    20    61    1  12628
---- Validation: 
scalar performance:
{'acc': 0.95690787, 'precision': 0.8828158, 'recall': 0.8610436, 'specificity': 0.99535704, 'f1': 0.8633555, 'auroc': 0.99808747}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   404     0    3     5    0    1    19     3     6    6     36
1     0  1292    0    11    0    0     0    28     1    0      0
2     0     0  248     1    4    7     1     3     5   43      0
3     0     1    0  8308    0   26     2    45    58    0      0
4     3     1   96     0  283    4     3     2    37    9    101
5     0     0    0     9    0  493     0     0     2   16      1
6     1     0    1     6    0    3  1880     0     6    1     10
7     0    12    1   338    1    1     2  6858    46    1      5
8     1     1    5   109    3    6     0    48  3107    0     16
9     0     0   35     5    0  177     0     0     2  274      0
10    1     4   14     7   46    3    13    24    55    2  12627
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.721542, 'precision': 0.68701243, 'recall': 0.6205597, 'specificity': 0.97217876, 'f1': 0.60917914, 'auroc': 0.8890402}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   740     2    1   36    3   28   283   11     9   51     6
1     0  1343    1   24    0    9     0  109     4    0     9
2     0    11  396   17   90   71    13   29   269   46    73
3     0     0    0    0    0    0     0    0     0    0     0
4     1     2   14    0  390    0     3    1    30    0  1192
5     1     0    1   32    0  542     1    0     2   13     0
6     0     1    1    3    0    0  3035    3    15    0     9
7     0     0    0  334    0    1     6  819     1    0     3
8     0     0    1  128    0   16     9    3  1213    0     0
9     3    31  153   87    2  454    10   33   136  220     8
10    0     0    0    0   29    0     1    0     1    0  1615
better model found
persisted
after epoch: 3,now: 2024-08-13 10:05:43.791538,epoch time: 0:39:51.202947,used: 1:58:04.331717,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_08_07_38_seed_0_24148166
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95973355, 'precision': 0.9057872, 'recall': 0.89908993, 'specificity': 0.99563366, 'f1': 0.8990654, 'auroc': 0.99873734}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    3     4    1    0     3     2     2    1     20
1     0  1298    0     5    0    0     0    27     2    0      0
2     0     0  270     0   14    2     1     4     2   19      0
3     0     4    3  7807    0   14     0   499   111    1      0
4     3     0   32     0  386    1     0     5    12    0    100
5     1     0    2     8    2  473     0     1     9   24      1
6     5     0    3     5    2    1  1868     5     5    0     14
7     0    24    2    35    1    0     3  7136    52    1      8
8     0     1    4    28    9    1     0    47  3173    1     32
9     1     0   81     2    7   75     0     0     2  325      0
10   10     0    8     3   41    0     9    14    18    0  12688
---- Validation: 
scalar performance:
{'acc': 0.95864654, 'precision': 0.90828145, 'recall': 0.8984107, 'specificity': 0.9955179, 'f1': 0.8992544, 'auroc': 0.99875003}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     1    2     0    3    0     7     8     1    1     19
1     0  1303    0     3    0    0     0    24     2    0      0
2     0     0  275     1   15    2     0     4     4   10      1
3     0     4    0  7781    0   11     1   518   124    1      0
4     3     0   34     0  385    2     0     4    15    1     95
5     0     0    2    13    0  477     0     0     7   21      1
6     8     0    2     2    2    4  1856    10     7    0     17
7     0    22    1    29    1    0     3  7147    56    0      6
8     3     1    2    28    7    3     1    60  3159    0     32
9     1     0   81     1    5   79     0     2     3  321      0
10    6     0    8     2   39    1    10    14    22    0  12694
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7464493, 'precision': 0.683856, 'recall': 0.6454588, 'specificity': 0.9744773, 'f1': 0.6282133, 'auroc': 0.8862647}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   847     2    5  52    3   26   110    31    62   23     9
1     0  1378    0   7    1    4     1    85     6    0    17
2     0     7  384   4  172   28    10    24   245   25   116
3     0     0    0   0    0    0     0     0     0    0     0
4     1     0    9   0  305    0     1     0    11    0  1306
5     2     0   11  61    1  467     0     0    17   32     1
6     0     2    0   2    1    0  2973     4    21    0    64
7     0     2    1  23    0    1     4  1123     6    0     4
8     0     0    2  60    2    3     4     0  1293    2     4
9     5    18  301  49    4  232     7    34   208  262    17
10    0     0    0   0    8    0     1     0     0    0  1637
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-13 10:48:30.261023,epoch time: 0:42:46.469485,used: 2:40:50.801202,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_08_07_38_seed_0_24148166
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9676798, 'precision': 0.9209898, 'recall': 0.89856493, 'specificity': 0.9965104, 'f1': 0.9045896, 'auroc': 0.9990214}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    0    0     4     3     1    1      3
1     0  1291    1     4    0    0     0    35     1    0      0
2     7     1  237     0   15    0     2     4     3   40      3
3     1     1    0  8156    0    5     0   186    87    1      0
4    10     0   13     0  315    1     2     6    43    4    145
5     1     0    0    16    0  422     0     0     4   77      1
6    15     0    0     4    0    0  1875     2     4    0      7
7     0     4    0    56    1    0     2  7168    28    1      3
8     5     0    1    35    1    2     1    44  3195    1      9
9     5     0   17     1    0   23     0     3     3  441      0
10   78     0    1     7   16    0    22    22    52    0  12597
---- Validation: 
scalar performance:
{'acc': 0.9680086, 'precision': 0.9177415, 'recall': 0.89971066, 'specificity': 0.99656606, 'f1': 0.90366685, 'auroc': 0.9990127}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     1    0    0     3     5     1    0      3
1     0  1297    0     3    0    0     0    29     3    0      0
2     5     0  236     0   18    0     3     5     2   41      2
3     2     0    0  8162    0    6     0   167   101    2      0
4    10     0   19     1  328    0     6     5    33    5    132
5     4     0    0    15    0  417     0     0     5   79      1
6    27     0    0     1    0    0  1871     1     3    0      5
7     1     4    0    68    0    0     1  7164    23    0      4
8     4     0    1    33    0    2     1    46  3194    2     13
9     6     0   17     2    0   22     1     2     1  442      0
10   83     0    1     7   14    1    18    17    47    0  12608
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73546493, 'precision': 0.6480764, 'recall': 0.62113667, 'specificity': 0.9730542, 'f1': 0.5957047, 'auroc': 0.87583995}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1113     0    0   7    0    0    20    21     8    1     0
1      7  1338    0  17    0    0     4   111     3    0    19
2     54     3  128   5  105    3   147    34   296   72   168
3      0     0    0   0    0    0     0     0     0    0     0
4      4     0    1   0   62    0    23     0    23    0  1520
5     39     0    0  55    0  309    20     0    16  151     2
6      0     0    0   2    0    0  3059     2     2    0     2
7      4     0    0  32    0    0     6  1118     0    1     3
8      0     0    0  55    0    1    49    16  1246    2     1
9     46    10   94  65    5  116    68    62   145  499    27
10     0     0    0   0    1    0     3     1     1    0  1640
better model found
persisted
after epoch: 5,now: 2024-08-13 11:28:25.272341,epoch time: 0:39:55.011318,used: 3:20:45.812520,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_08_07_38_seed_0_24148166
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9731111, 'precision': 0.92304504, 'recall': 0.91699827, 'specificity': 0.9971538, 'f1': 0.9163048, 'auroc': 0.9992813}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    0    0     3     0     0    1      8
1     0  1299    1     3    0    0     1    23     2    0      3
2     0     0  279     0   14    0     1     1     2   15      0
3     5     1    2  8178    0   12     0   140    97    2      1
4     6     0   12     1  433    0     1     0    10    1     75
5     0     0    2    12    0  346     2     0     2  156      1
6     3     0    0     0    0    0  1891     0     1    0     12
7     1     6    0    65    2    0     1  7139    45    1      4
8     0     1    2    30    5    0     1    29  3220    1      6
9     1     0   57     2    1    4     1     0     2  425      0
10   11     0    3     6   32    0     4     8    38    0  12690
---- Validation: 
scalar performance:
{'acc': 0.9720476, 'precision': 0.9216088, 'recall': 0.9152083, 'specificity': 0.99703455, 'f1': 0.9148561, 'auroc': 0.9993245}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     0    1    0     6     0     0    1      9
1     0  1302    1     3    0    0     0    22     2    0      2
2     1     0  274     0   19    0     2     2     2   12      0
3     3     1    1  8164    1    4     2   166    98    0      0
4     6     0   13     0  440    0     0     0     8    0     72
5     1     0    3    13    0  353     0     0     7  143      1
6     5     0    1     0    0    0  1889     0     2    0     11
7     0     5    0    64    1    0     1  7140    47    0      7
8     2     1    3    35    5    0     0    30  3209    2      9
9     2     0   61     2    2    3     0     2     2  418      1
10   16     0    6     5   32    0     8     7    37    0  12685
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7481285, 'precision': 0.67044866, 'recall': 0.63611186, 'specificity': 0.9744353, 'f1': 0.6327871, 'auroc': 0.88554734}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   970     0    0   5    2    9   130     7     9   36     2
1     7  1291    2  13    2    1     6   136     4    2    35
2     6     3  342   4  278    7    27    29   191   51    77
3     0     0    0   0    0    0     0     0     0    0     0
4     1     0    2   0  282    0     4     0    15    0  1329
5     3     0    8  39    5  316     6     0    13  201     1
6     0     0    0   1    2    0  3016     1    15    0    32
7     1     0    0  35    0    0    19  1101     3    1     4
8     0     0    6  55    3    2    25     8  1268    3     0
9     8     4  293  36   11   84    24    72   112  473    20
10    0     0    0   0    9    0     1     1     1    0  1634
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-13 12:12:18.064513,epoch time: 0:43:52.792172,used: 4:04:38.604692,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_08_07_38_seed_0_24148166
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9721479, 'precision': 0.9204035, 'recall': 0.9166593, 'specificity': 0.99708307, 'f1': 0.9156903, 'auroc': 0.99932754}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     3    3    0     0     1     1    1      3
1     0  1315    0     5    0    0     0    11     1    0      0
2     1     0  218     0    5    5     0     2     7   74      0
3     0     0    0  8363    0   10     0    14    51    0      0
4     4     0   16     1  457    1     0     3    25    8     24
5     0     0    0     4    0  506     0     0     4    5      1
6    11     0    0     7    2    3  1871     2     4    1      7
7     1    10    0   273    1    0     1  6888    83    1      5
8     0     0    0    23    1    1     0    12  3249    1      6
9     0     0    1     1    0  137     0     0     6  348      0
10   14     0    4     9   75    1     5     8    30    0  12649
---- Validation: 
scalar performance:
{'acc': 0.9721011, 'precision': 0.9177306, 'recall': 0.9155358, 'specificity': 0.9970936, 'f1': 0.9136108, 'auroc': 0.99935967}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     5    1    1     0     0     0    1      6
1     0  1311    0     6    0    0     0    11     4    0      0
2     2     0  218     0    7    1     0     1     5   78      0
3     0     0    0  8356    0    9     0    14    60    1      0
4     4     0   17     1  463    1     0     5    22    5     21
5     0     0    0     5    0  508     0     0     2    5      1
6     6     1    0     4    2    2  1880     3     5    0      5
7     0     9    0   250    1    0     1  6910    90    0      4
8     0     0    1    22    0    1     0    10  3254    0      8
9     0     0    1     5    0  148     0     0     3  336      0
10   19     1    3     7   86    1     5     7    29    1  12637
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7464493, 'precision': 0.70339745, 'recall': 0.63940185, 'specificity': 0.9749824, 'f1': 0.6372179, 'auroc': 0.8903989}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   944     0    0   68    2   52    20   44    17   15     8
1     4  1320    4   28    1    2     2  113    12    4     9
2     3     0  259   16  205   54    10   27   274   85    82
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0   10    0  629    0     5    0    11    0   978
5     0     0    0   76    1  492     0    0    14    8     1
6     1     0    1    1    0    0  3006    2    31    0    25
7     1     0    0  354    0    2     1  798     3    1     4
8     0     0    1   82    0    6     7    4  1268    1     1
9     2     2   75   89    5  375     1   47   174  356    11
10    0     0    0    0   48    0     1    0     0    0  1597
better model found
persisted
after epoch: 7,now: 2024-08-13 12:51:27.946780,epoch time: 0:39:09.882267,used: 4:43:48.486959,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_08_07_38_seed_0_24148166
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98105735, 'precision': 0.9484337, 'recall': 0.95852005, 'specificity': 0.99799085, 'f1': 0.9532453, 'auroc': 0.9996891}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     0    4    0     4     0     0    2      5
1     0  1324    0     1    0    0     0     5     1    0      0
2     0     0  283     0   12    1     0     0     1   14      1
3     1     2    1  8177    0    6     0   179    72    0      0
4     1     0   12     0  499    0     0     0     3    2     22
5     0     0    0     2    1  491     0     0     1   26      0
6     3     0    0     0    1    0  1892     1     2    0      8
7     1     9    1    34    1    0     3  7191    16    2      5
8     2     0    1    16   10    1     0    42  3204    2     17
9     0     0   27     2    1   23     1     0     1  438      0
10    7     0    3     6   59    0     1     3    14    0  12702
---- Validation: 
scalar performance:
{'acc': 0.98124915, 'precision': 0.94567525, 'recall': 0.95895517, 'specificity': 0.9980267, 'f1': 0.9519743, 'auroc': 0.999699}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     0    4    1     0     1     0    0      5
1     0  1327    0     1    0    0     0     4     0    0      0
2     0     0  286     0   12    0     0     1     1   11      1
3     2     3    1  8159    0   10     0   188    77    0      0
4     0     0   16     0  500    1     0     0     3    0     19
5     0     0    0     1    2  484     0     0     0   33      1
6     4     0    0     0    4    0  1894     0     0    0      6
7     0    12    2    26    1    0     2  7198    18    1      5
8     1     1    5    13    9    0     0    39  3216    1     11
9     0     0   27     2    2   25     0     1     1  435      0
10   10     0    3     6   53    0     2     3     5    1  12713
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7703071, 'precision': 0.69099987, 'recall': 0.661263, 'specificity': 0.976732, 'f1': 0.6583733, 'auroc': 0.88552886}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1000     1    0  13    9    5    66    23    18   26     9
1      1  1349    1   6    2    1     6    96     6    2    29
2      3     5  257   3  345   17    29    25   129   85   117
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    6   0  451    0     2     0     6    0  1168
5      4     0    0  25    7  387     4     0    17  146     2
6      1     0    0   1    1    0  3009     2     7    0    46
7      1     1    0  75    0    0    11  1070     1    1     4
8      0     0    1  29    5    5    28    19  1273    5     5
9     11    10  169  21   15  162    24    38    72  594    21
10     0     0    0   0   25    0     0     1     0    0  1620
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-13 13:31:22.786742,epoch time: 0:39:54.839962,used: 5:23:43.326921,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_08_07_38_seed_0_24148166
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98186004, 'precision': 0.938517, 'recall': 0.9490763, 'specificity': 0.9980684, 'f1': 0.939993, 'auroc': 0.9997379}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    2     1    4    0     3     1     0    3     13
1     0  1326    0     3    0    0     0     2     1    0      0
2     0     0  310     0    1    0     0     0     0    1      0
3     0     0    0  8349    1    0     0    64    25    0      1
4     2     0   37     0  475    0     0     0     0    1     24
5     0     0    7     7    0  467     0     0     2   37      1
6     4     0    7     0    1    1  1884     0     0    0     10
7     0    16    9    61    0    0     3  7147    16    0     12
8     0     1   15    21   19    0     1    44  3154    0     39
9     1     0   81     1    0    8     0     0     0  402      0
10    0     1   12     4   43    0     1     0     2    0  12728
---- Validation: 
scalar performance:
{'acc': 0.9822121, 'precision': 0.94095886, 'recall': 0.95270973, 'specificity': 0.99810094, 'f1': 0.9438832, 'auroc': 0.99973005}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    4     1    5    0     1     0     0    2      8
1     0  1318    0     5    0    0     0     6     2    0      1
2     0     0  311     0    0    0     0     0     0    1      0
3     0     0    1  8338    0    2     0    66    30    2      1
4     1     0   34     0  482    0     0     0     0    1     21
5     1     0    5    11    0  460     0     0     0   42      2
6     4     0    3     1    1    0  1886     1     0    0     12
7     0    11    8    63    1    0     6  7146    19    0     11
8     1     1    8    15   13    1     0    48  3167    4     38
9     0     0   69     0    1    6     0     0     1  416      0
10    1     0   11     3   46    0     1     0     0    0  12734
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.77520466, 'precision': 0.7070694, 'recall': 0.66372454, 'specificity': 0.97744024, 'f1': 0.67010885, 'auroc': 0.8877855}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1017     0   10  15    4   10    34    13     1   59     7
1      6  1371    5  17    2    0     2    64     2    1    29
2      2     1  570   7  232    9    15    17    63   49    50
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0   19   0  470    0     7     0     7    0  1130
5      3     0   39  73    3  299     3     0     7  163     2
6      0     0    4   2    2    0  3001     2     8    0    48
7      1    10    2  77    0    0    11  1051     0    3     9
8      0     1   17  63   12    4    31    25  1209    2     6
9      4     5  383  71    4   97    14    33    41  470    15
10     0     0    0   0   22    0     2     0     0    0  1622
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-13 14:17:16.606151,epoch time: 0:45:53.819409,used: 6:09:37.146330,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_08_07_38_seed_0_24148166
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9809236, 'precision': 0.94634736, 'recall': 0.95234805, 'specificity': 0.9979849, 'f1': 0.9491447, 'auroc': 0.999673}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     1    0     0    3    0    15     0     1    1      3
1     0  1313    0     4    0    0     0    13     2    0      0
2     0     0  282     1    0    0     0     0     1   27      1
3     1     0    0  8401    0    5     1    20     7    3      0
4     3     0   32     0  465    0     1     0    15    4     19
5     0     0    0     5    1  497     0     0     1   17      0
6     0     0    1     0    0    0  1903     0     2    2      0
7     0     7    2   181    0    0     3  7029    31    6      5
8     0     1    1    46    2    1     0    10  3227    1      6
9     0     0    7     1    0   43     1     0     2  439      0
10   10     0    4     5   46    0    38     3    36    1  12648
---- Validation: 
scalar performance:
{'acc': 0.9811689, 'precision': 0.94767416, 'recall': 0.95410687, 'specificity': 0.9980017, 'f1': 0.9506339, 'auroc': 0.99972796}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     0    5    0    10     0     0    1      4
1     0  1319    0     4    0    0     0     8     1    0      0
2     0     0  284     1    0    0     0     0     1   26      0
3     0     0    0  8403    0    5     0    22     9    1      0
4     1     0   32     0  461    0     0     0    13    6     26
5     0     0    0     5    0  499     0     0     1   16      0
6     1     0    0     1    0    1  1903     0     0    0      2
7     1    10    4   181    1    1     4  7032    26    2      3
8     0     0    1    55    1    0     0     7  3227    1      4
9     1     0    4     0    0   47     0     0     0  441      0
10    8     0    6     5   44    1    39     0    43    1  12649
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74868816, 'precision': 0.7141851, 'recall': 0.6305529, 'specificity': 0.9746527, 'f1': 0.64900374, 'auroc': 0.88898367}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   900     0    0   38    0    9   148    5    11   58     1
1     4  1304    2   32    2    0    11  100     3   22    19
2     1     1  383   18  130   23    92   13   174  138    42
3     0     0    0    0    0    0     0    0     0    0     0
4     2     1   16    0  474    0    48    0    29    1  1062
5     2     0    2   73    2  271     6    0     5  231     0
6     0     0    1    2    0    0  3048    2     6    1     7
7     2     5    0  300    0    0    25  823     0    7     2
8     0     0    3  123    0    4    64    6  1159   10     1
9     3     3   90   73    2  124    36   11    35  749    11
10    0     0    0    0   29    0    24    0     3    0  1590
early stop counter: 1
val acc:0.9811689257621765, best validation acc: 0.9822121262550354, corresponding to test acc:                         0.7752046585083008 / 0.7752046585083008
after epoch: 10,now: 2024-08-13 15:06:07.827206,epoch time: 0:48:51.221055,used: 6:58:28.367385,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_08_07_38_seed_0_24148166
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 6:58:28.367385 at 2024-08-13 15:06:07.827206
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.77520466, 'precision': 0.7070694, 'recall': 0.66372454, 'specificity': 0.97744024, 'f1': 0.67010885, 'auroc': 0.8877855}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1017     0   10  15    4   10    34    13     1   59     7
1      6  1371    5  17    2    0     2    64     2    1    29
2      2     1  570   7  232    9    15    17    63   49    50
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0   19   0  470    0     7     0     7    0  1130
5      3     0   39  73    3  299     3     0     7  163     2
6      0     0    4   2    2    0  3001     2     8    0    48
7      1    10    2  77    0    0    11  1051     0    3     9
8      0     1   17  63   12    4    31    25  1209    2     6
9      4     5  383  71    4   97    14    33    41  470    15
10     0     0    0   0   22    0     2     0     0    0  1622
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.77520466, 'precision': 0.7070694, 'recall': 0.66372454, 'specificity': 0.97744024, 'f1': 0.67010885, 'auroc': 0.8877855}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1017     0   10  15    4   10    34    13     1   59     7
1      6  1371    5  17    2    0     2    64     2    1    29
2      2     1  570   7  232    9    15    17    63   49    50
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0   19   0  470    0     7     0     7    0  1130
5      3     0   39  73    3  299     3     0     7  163     2
6      0     0    4   2    2    0  3001     2     8    0    48
7      1    10    2  77    0    0    11  1051     0    3     9
8      0     1   17  63   12    4    31    25  1209    2     6
9      4     5  383  71    4   97    14    33    41  470    15
10     0     0    0   0   22    0     2     0     0    0  1622
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_08_07_38_seed_0_24148166_instance_wise_predictions.txt
accuracy from prediction file 0.7752046456307283
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_vit_resnet_erm_features_2024-08-13_02-20-58/rule_results/0.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_vit_resnet_erm_features_2024-08-13_02-20-58/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_vit_resnet_erm_features_2024-08-13_02-20-58/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1657 MiB |   5046 MiB | 285198 GiB | 285196 GiB |
|       from large pool |   1650 MiB |   5036 MiB | 282834 GiB | 282832 GiB |
|       from small pool |      7 MiB |     14 MiB |   2363 GiB |   2363 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1657 MiB |   5046 MiB | 285198 GiB | 285196 GiB |
|       from large pool |   1650 MiB |   5036 MiB | 282834 GiB | 282832 GiB |
|       from small pool |      7 MiB |     14 MiB |   2363 GiB |   2363 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1654 MiB |   5034 MiB | 284093 GiB | 284091 GiB |
|       from large pool |   1647 MiB |   5024 MiB | 281732 GiB | 281730 GiB |
|       from small pool |      6 MiB |     13 MiB |   2361 GiB |   2361 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5424 MiB |   5424 MiB |   5424 MiB |      0 B   |
|       from large pool |   5408 MiB |   5408 MiB |   5408 MiB |      0 B   |
|       from small pool |     16 MiB |     16 MiB |     16 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 284864 KiB | 434522 KiB |  59369 GiB |  59369 GiB |
|       from large pool | 279936 KiB | 432718 KiB |  56997 GiB |  56997 GiB |
|       from small pool |   4928 KiB |   6949 KiB |   2372 GiB |   2372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2646    |    3945    |   22818 K  |   22815 K  |
|       from large pool |     247    |     352    |    9350 K  |    9350 K  |
|       from small pool |    2399    |    3599    |   13467 K  |   13465 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2646    |    3945    |   22818 K  |   22815 K  |
|       from large pool |     247    |     352    |    9350 K  |    9350 K  |
|       from small pool |    2399    |    3599    |   13467 K  |   13465 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     166    |     166    |     166    |       0    |
|       from large pool |     158    |     158    |     158    |       0    |
|       from small pool |       8    |       8    |       8    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     102    |     557    |   10843 K  |   10843 K  |
|       from large pool |      87    |     121    |    5706 K  |    5706 K  |
|       from small pool |      15    |     451    |    5136 K  |    5136 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5046 MiB | 285198 GiB | 285198 GiB |
|       from large pool |  16640 KiB |   5036 MiB | 282834 GiB | 282834 GiB |
|       from small pool |      0 KiB |     14 MiB |   2363 GiB |   2363 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5046 MiB | 285198 GiB | 285198 GiB |
|       from large pool |  16640 KiB |   5036 MiB | 282834 GiB | 282834 GiB |
|       from small pool |      0 KiB |     14 MiB |   2363 GiB |   2363 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5034 MiB | 284093 GiB | 284093 GiB |
|       from large pool |  16640 KiB |   5024 MiB | 281732 GiB | 281732 GiB |
|       from small pool |      0 KiB |     13 MiB |   2361 GiB |   2361 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1936 MiB |   5424 MiB |   5424 MiB |   3488 MiB |
|       from large pool |   1924 MiB |   5408 MiB |   5408 MiB |   3484 MiB |
|       from small pool |     12 MiB |     16 MiB |     16 MiB |      4 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 434522 KiB |  59371 GiB |  59371 GiB |
|       from large pool |  24320 KiB | 432718 KiB |  56998 GiB |  56998 GiB |
|       from small pool |      0 KiB |  11365 KiB |   2372 GiB |   2372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3945    |   22818 K  |   22818 K  |
|       from large pool |       2    |     352    |    9350 K  |    9350 K  |
|       from small pool |       0    |    3599    |   13467 K  |   13467 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3945    |   22818 K  |   22818 K  |
|       from large pool |       2    |     352    |    9350 K  |    9350 K  |
|       from small pool |       0    |    3599    |   13467 K  |   13467 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      95    |     166    |     166    |      71    |
|       from large pool |      89    |     158    |     158    |      69    |
|       from small pool |       6    |       8    |       8    |       2    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     557    |   10843 K  |   10843 K  |
|       from large pool |       3    |     121    |    5706 K  |    5706 K  |
|       from small pool |       0    |     451    |    5137 K  |    5137 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Aug 13 15:40:48 2024]
Finished job 0.
1 of 1 steps (100%) done
