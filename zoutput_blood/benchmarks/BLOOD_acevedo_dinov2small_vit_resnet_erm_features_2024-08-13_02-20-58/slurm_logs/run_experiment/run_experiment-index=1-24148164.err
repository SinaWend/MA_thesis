Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Aug 13 02:22:34 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_dinov2small_vit_resnet_erm_features_2024-08-13_02-20-58/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_dinov2small_vit_resnet_erm_features_2024-08-13_02-20-58/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_02_49_18_seed_0_24148164

 Experiment start at: 2024-08-13 02:49:18.856378
before training, model accuracy: 0.05282306298613548
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.84880674, 'precision': 0.54420805, 'recall': 0.48482177, 'specificity': 0.98317015, 'f1': 0.48145875, 'auroc': 0.9685932}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     0   0    36   0   3   321    30    42   3     47
1    0  1124   0    16   0   0     0   173     4   0     15
2    0     1   0    13   0   1   136    53    85   0     23
3    0     1   0  7641   0   0     7   548   233   0      8
4    0     0   0     5   0   1   116    22   103   0    292
5    0     0   0   300   0  92    69     3    45  11      1
6    0    11   0    37   0   2  1468    41   165   0    184
7    0    36   0   376   0   0     2  6641   138   0     69
8    0     1   0   377   0   0    64   251  2416   0    187
9    0     1   0   117   0  41   202    26    92  13      1
10   0     8   0    13   0   0   200    76   166   0  12330
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.84841514, 'precision': 0.5606636, 'recall': 0.48565185, 'specificity': 0.983157, 'f1': 0.4832953, 'auroc': 0.96786135}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0    0     1   0    35   0   6   325    21    40   1     54
1    0  1126   0    17   0   0     1   168     5   0     15
2    0     3   0    14   0   4   126    42   101   1     21
3    0     1   0  7631   0   0     6   558   238   0      6
4    0     0   0     4   0   1   124    17   111   0    282
5    0     0   0   307   0  87    69     1    47   9      1
6    0     3   0    29   0   1  1465    56   170   0    184
7    0    36   0   406   0   0     6  6627   124   0     66
8    0     0   0   372   0   0    79   250  2431   0    164
9    0     1   0   117   0  34   187    19   112  22      1
10   0     5   0    17   0   0   204    74   167   0  12329
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.4162177, 'precision': 0.33580077, 'recall': 0.3357935, 'specificity': 0.9382354, 'f1': 0.28367642, 'auroc': 0.7724177}
confusion matrix:
    0     1   2    3   4   5     6    7    8   9     10
0    0     1   0    3   0   4  1114   29   17   0     2
1    0  1092   0   17   0   0    24  210   15   0   141
2    0     4   0   48   0   1   511   70  201   0   180
3    0     0   0    0   0   0     0    0    0   0     0
4    0     0   0    0   0   0    42    1    8   0  1582
5    0     0   0  315   0  31   152    3   88   2     1
6    0     6   0    1   0   0  1326    6   27   0  1701
7    0    69   0    2   0   0    69  982   26   0    16
8    0     0   0   45   0   3   411    1  873   1    36
9    0    16   0  239   0  11   501  121  235   1    13
10   0     0   0    0   0   0     2    0    0   0  1644
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-13 03:18:45.005149,epoch time: 0:29:26.148771,used: 0:29:26.148771,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_02_49_18_seed_0_24148164
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.898277, 'precision': 0.7855079, 'recall': 0.656884, 'specificity': 0.9885645, 'f1': 0.69382656, 'auroc': 0.98630214}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   214     0   1    23    1    3   111    24    26    9     71
1     0  1147   0    17    0    0     0   153     5    0     10
2    12     3  51     4   58    2     3    27    60   65     27
3     0     1   0  7806    0   17     0   448   160    1      4
4     3     0   9     3  109    1    16    19    81   11    287
5     1     0   0   125    0  323     1     0    12   57      2
6    15     0   0    22    0    4  1684    17    65    9     92
7     1    20   0   320    1    0     3  6801    78    1     39
8     0     0   0   291    0    2     8   159  2718    3    114
9    11     2  23    61    3  137     5    13    42  191      5
10    5     2   0    21   10    2    54    63   105    0  12530
---- Validation: 
scalar performance:
{'acc': 0.8994249, 'precision': 0.7891748, 'recall': 0.65483916, 'specificity': 0.988703, 'f1': 0.69208765, 'auroc': 0.98578453}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   196     0   0    23   0    4   124    20    30   10     76
1     0  1141   0    16   0    0     1   155    11    0      8
2     8     4  54     6  55    1     5    27    59   64     29
3     0     0   0  7837   0   11     0   425   164    0      3
4     4     0   8     3  97    1    11    15    85   20    295
5     4     0   0   123   0  317     0     0    14   62      1
6    16     2   0    19   0    4  1701    23    53    6     84
7     0    20   0   285   0    0     1  6834    77    0     48
8     0     0   2   278   1    0     7   190  2715    3    100
9     9     1  22    50   1  129     5    13    53  205      5
10    6     2   0    17   5    1    51    74   110    2  12528
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5094102, 'precision': 0.5217572, 'recall': 0.4117766, 'specificity': 0.9488489, 'f1': 0.36387724, 'auroc': 0.82512367}
confusion matrix:
    0     1   2    3   4    5     6     7     8   9     10
0   21     0   0   27   0    3  1057    27    20  11     4
1    0  1068   0   26   0    0    23   253     9   0   120
2    0     3   1   51   0   11   276    63   318   1   291
3    0     0   0    0   0    0     0     0     0   0     0
4    0     0   0    0   0    0    14     2    10   0  1607
5    2     0   0  302   0  176    56     1    31  23     1
6    0     2   0    1   0    0  2073     5    15   0   971
7    0    12   0    4   0    0    40  1076    19   0    13
8    0     0   0   80   0    6    82     3  1153  10    36
9    4    12   1  273   0   57   290   120   281  67    32
10   0     0   0    0   0    0     0     0     0   0  1646
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-13 03:45:54.145826,epoch time: 0:27:09.140677,used: 0:56:35.289448,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_02_49_18_seed_0_24148164
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.91976136, 'precision': 0.81298566, 'recall': 0.75170904, 'specificity': 0.99124765, 'f1': 0.77645993, 'auroc': 0.99130493}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   302     0    0     7    3    1    78    19    13    5     55
1     0  1243    0    18    0    0     0    61     4    0      5
2     7     3  150     2   46    2     1    15    22   60      4
3     3     3    0  7907    0   15     1   306   198    4      1
4     3     0   36     5  212    0     8     9    68   11    187
5     4     0    4    74    1  332     5     0    15   85      1
6    18     2    0    12    0    0  1789    11    33    5     36
7     2    48    2   293    2    0     3  6795    99    2     19
8     0     1    2   201    3    0     9   122  2908    4     45
9    13     2   61    26    2   92     4     6    19  261      7
10   12     2    8    24   42    0    55    43   129    0  12478
---- Validation: 
scalar performance:
{'acc': 0.92015517, 'precision': 0.8147999, 'recall': 0.75439036, 'specificity': 0.99127316, 'f1': 0.77912736, 'auroc': 0.9912424}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   317     1    2    12    1    0    64    11    13    5     57
1     0  1240    0    19    1    0     0    61     3    0      8
2     4     4  144     3   46    4     4    15    25   59      4
3     0     2    0  7910    1   14     1   305   204    2      1
4     0     0   39     1  220    2     7     8    67   12    183
5     6     0    1    82    0  335     0     0     7   89      1
6    19     2    0    11    3    2  1787    10    29    2     43
7     0    54    2   302    2    0     8  6766   101    0     30
8     2     2    2   182    5    2    12   119  2916    1     53
9    16     3   57    24    1   92     2     5    29  262      2
10   10     1    7    20   40    1    53    38   122    1  12503
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5526481, 'precision': 0.55048424, 'recall': 0.44178146, 'specificity': 0.95257044, 'f1': 0.4060523, 'auroc': 0.8353799}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   101     0   0    6   0    0  1041    9     9    3     1
1     0  1252   0   23   0    0    26  122     7    0    69
2     3    17   4   20   6    6   372   47   237   16   287
3     0     0   0    0   0    0     0    0     0    0     0
4     0     1   0    0   4    0    22    1    17    0  1588
5    20     0   0  180   0  192   110    1    35   51     3
6     1     3   0    1   0    0  2406    1     6    0   649
7     0    39   0    3   0    0   115  989     9    0     9
8     2     0   0   45   1    1   109    5  1167   11    29
9    18    78  13  127   0   29   426   73   196  138    39
10    0     0   0    0   0    0     0    0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-13 04:14:19.910989,epoch time: 0:28:25.765163,used: 1:25:01.054611,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_02_49_18_seed_0_24148164
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9309182, 'precision': 0.83771557, 'recall': 0.7869564, 'specificity': 0.99237007, 'f1': 0.8081434, 'auroc': 0.9937916}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   355     1    1    13    0    3    31    11     9    6     52
1     1  1227    0    18    0    0     0    69     7    0     10
2     4     2  165     4   46    5     2    10    10   55      8
3     2     0    0  7944    1   35     0   316   139    0      0
4     2     0   34     0  252    1     5    10    39    8    188
5     3     0    3    58    0  394     2     0     2   58      1
6    23     0    0    15    1    1  1798     8    17    2     43
7     0    14    3   236    1    0     4  6912    77    1     16
8     1     0    4   188    7    4     7   126  2893    3     63
9     5     0   52    16    5  122     2     6    11  270      4
10   25     2    2     8   29    2    37    39    63    2  12584
---- Validation: 
scalar performance:
{'acc': 0.92959744, 'precision': 0.83032477, 'recall': 0.77844274, 'specificity': 0.9922287, 'f1': 0.7999727, 'auroc': 0.993807}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   351     0    2    13    1    0    37    12     8    3     56
1     0  1229    0    18    1    0     0    73     3    0      8
2     5     1  154     1   53    7     3    11    17   56      4
3     3     1    0  7948    1   35     1   305   141    5      0
4     2     0   39     1  244    1     4     7    40    9    192
5     1     0    2    55    0  390     2     0     5   64      2
6    22     0    0    12    1    1  1801    12    22    4     33
7     0    23    1   240    1    0     2  6897    78    3     20
8     1     0    2   182    4    4     6   125  2888    5     79
9     8     0   55    22    0  125     3     4    14  258      4
10   17     2    5    15   30    1    30    47    52    4  12593
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.53879523, 'precision': 0.56372654, 'recall': 0.46033087, 'specificity': 0.95260715, 'f1': 0.43290803, 'auroc': 0.8402288}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   242     0   0   50   0    1   775    32    18   31    21
1     0  1207   0   29   0    0     7   178     8    0    70
2     1    17  15   56  16   14    73    63   310   24   426
3     0     0   0    0   0    0     0     0     0    0     0
4     0     1   0    0   5    0     4     1    18    0  1604
5     5     0   0  256   0  232     9     0    32   54     4
6     7     2   0    2   1    0  1772     3    21    0  1259
7     1     7   0    9   0    0    25  1103    12    0     7
8     0     0   1   70   0    3    12     9  1232    9    34
9     6    69  27  246   2   55    85   101   232  247    67
10    0     0   0    0   0    0     0     0     0    0  1646
better model found
persisted
after epoch: 4,now: 2024-08-13 04:42:54.922763,epoch time: 0:28:35.011774,used: 1:53:36.066385,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_02_49_18_seed_0_24148164
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93902504, 'precision': 0.8456167, 'recall': 0.8163844, 'specificity': 0.9933448, 'f1': 0.8289986, 'auroc': 0.99475986}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   386     0    0    11    0    1    16     7     8    2     52
1     0  1256    0    15    0    0     0    49     7    0      5
2     4     0  204     1   23    2     1     6     7   55      9
3     3     2    0  8042    1   14     2   251   119    3      1
4     2     0   56     5  272    1     1     2    41   12    147
5     5     0    3    52    0  365     0     0     5   90      1
6    23     1    2     5    4    0  1819     4    16    7     25
7     0    24    4   217    1    0     3  6900    87    0     29
8     1     1   10   176    9    1    13    87  2965    3     28
9     6     2   46    16    3   89     0     2     8  315      6
10   16     0    5    12   67    3    26    23    65    3  12573
---- Validation: 
scalar performance:
{'acc': 0.938478, 'precision': 0.8419008, 'recall': 0.8127192, 'specificity': 0.99329424, 'f1': 0.8245864, 'auroc': 0.9948518}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   384     1    1     9    0    0    13     4     9    3     59
1     0  1250    3    17    0    0     0    56     3    0      3
2     4     0  201     1   26    0     1     7    10   58      4
3     1     1    0  8057    0   13     2   244   120    1      1
4     1     1   69     2  269    1     4     5    31    9    147
5     5     0    1    56    0  365     0     0     8   85      1
6    27     0    1     6    2    3  1817     7    12    6     27
7     2    30    3   206    4    0     2  6902    91    2     23
8     1     2    9   171    7    0     8    80  2970    6     42
9     9     0   54    19    2   87     1     6     7  307      1
10   22     1   10    12   50    3    34    23    76    2  12563
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.55425733, 'precision': 0.6560669, 'recall': 0.45876825, 'specificity': 0.95407, 'f1': 0.4429135, 'auroc': 0.8333168}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   316     1   0   33   0    0   786     7     3   17     7
1     0  1253   0   34   0    0    12   132     5    0    63
2     8    30   3   80   2    8   147    60   168   39   470
3     0     0   0    0   0    0     0     0     0    0     0
4     0     1   0    1   8    0     5     1    15    0  1602
5     5     0   0  252   0  176    26     0    12  120     1
6    27     2   0    4   0    1  2085     1     6    0   941
7     2    13   0   26   0    0    60  1048     5    0    10
8     1     0   0  149   0    0    42     8  1103   12    55
9    13   125   1  325   0   17   134    91    82  285    64
10    0     0   0    0   1    0     0     0     0    0  1645
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-13 05:10:48.853181,epoch time: 0:27:53.930418,used: 2:21:29.996803,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_02_49_18_seed_0_24148164
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9422892, 'precision': 0.8535211, 'recall': 0.8310993, 'specificity': 0.993715, 'f1': 0.8415031, 'auroc': 0.9953729}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   395     2    1     6    1    0    21     5     5    4     43
1     0  1256    0    12    2    0     0    50     6    0      6
2     3     0  188     1   56    2     3     6     3   49      1
3     3     0    0  8035    0   18     3   229   147    4      1
4     3     1   23     1  331    1     3     4    20    9    143
5     2     0    0    41    0  368     1     0     7  101      1
6    14     1    0     6    2    0  1847     3     9    2     23
7     3    33    7   228    4    0     8  6864    90    2     22
8     2     0    8   144   25    2    11    62  2975    6     61
9     6     0   51     8    3   67     2     0     7  347      2
10   27     2    3    11   50    2    31    17    35    1  12613
---- Validation: 
scalar performance:
{'acc': 0.9422763, 'precision': 0.85234237, 'recall': 0.8332065, 'specificity': 0.9937372, 'f1': 0.8418348, 'auroc': 0.9955448}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   405     0    0     5    3    0    28     6     2    3     31
1     0  1266    0    17    0    0     1    39     3    0      6
2     2     1  191     0   58    0     2     1     3   52      2
3     0     3    1  8040    1   17     3   223   149    2      1
4     4     0   32     1  314    1     2     3    18    9    155
5     6     0    0    37    0  367     0     0     6  104      1
6    20     0    1     2    2    0  1847     3     8    3     22
7     6    28    7   220    7    0     2  6870   101    0     24
8     1     3    3   145   31    1    10    65  2983    4     50
9     8     0   42     9    7   58     1     1    10  356      1
10   21     2    5    12   50    3    41    18    52    4  12588
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5984048, 'precision': 0.6391536, 'recall': 0.4711387, 'specificity': 0.95734125, 'f1': 0.45829964, 'auroc': 0.83823675}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   261     0   0    8   0    1   886    0     0   13     1
1     0  1253   0   35   0    0    49  102     4    0    56
2     3    11  11   21  23    2   388   23   117   56   360
3     0     0   0    0   0    0     0    0     0    0     0
4     0     0   0    0  29    0    34    1    11    0  1558
5     1     0   0  120   0  149    71    0    10  239     2
6    20     0   0    1   0    0  2810    1     0    0   235
7     2     8   0   32   0    0   208  899     8    1     6
8     0     0   1   73   2    0   137    3  1076   20    58
9     6    76   7  122   6    7   348   18    84  422    41
10    0     0   0    0   2    0     1    0     0    0  1643
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-13 05:37:37.939399,epoch time: 0:26:49.086218,used: 2:48:19.083021,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_02_49_18_seed_0_24148164
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9475064, 'precision': 0.8651787, 'recall': 0.84309304, 'specificity': 0.99428725, 'f1': 0.85194623, 'auroc': 0.99622226}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   407     0    0     7    0    0    11     6     8    3     41
1     0  1262    0    12    0    0     0    49     6    0      3
2     1     0  209     2   36    1     1     4     6   49      3
3     0     2    0  8100    0   23     1   205   104    3      1
4     4     0   43     4  330    3     0     3    24    6    122
5     3     0    1    34    0  446     0     0     6   30      1
6    17     0    0    13    2    0  1841     5    10    2     17
7     0    16    4   202    3    0     1  6951    70    1     14
8     0     1    2   147    9    5     3   105  2987    2     34
9     4     0   46     8    2  139     1     3     7  282      1
10   21     1    6    14   66    3    16    23    43    1  12599
---- Validation: 
scalar performance:
{'acc': 0.94631535, 'precision': 0.86882764, 'recall': 0.8420521, 'specificity': 0.9941484, 'f1': 0.8532397, 'auroc': 0.9958266}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   406     0    0     7    1    3    16     4     4    2     40
1     0  1262    0    12    0    0     0    54     3    0      1
2     3     0  215     1   30    2     0     6     7   46      2
3     0     3    0  8085    0   20     0   216   112    3      1
4     4     0   29     1  337    2     3     4    33    5    121
5     2     0    1    35    0  436     0     0     5   41      1
6    17     0    1    13    3    0  1827    11    14    3     19
7     1    14    1   208    2    0     1  6963    62    0     13
8     1     0    5   161    7    0     4   105  2978    2     33
9     5     0   43    11    1  142     1     9     3  277      1
10   18     1    4    15   59    4    22    25    55    1  12592
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.60896945, 'precision': 0.6502876, 'recall': 0.4932415, 'specificity': 0.9590602, 'f1': 0.47299892, 'auroc': 0.8414477}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   309     0   0   14   0    3   821     4     1   11     7
1     0  1220   0   39   0    0    21   154     5    0    60
2     4    10   4   35   6    8   248    46   242   35   377
3     0     0   0    0   0    0     0     0     0    0     0
4     1     0   0    0  27    0    14     1    26    0  1564
5     4     0   0  138   0  233    48     0    22  145     2
6    26     0   0    1   0    1  2706     2     9    0   322
7     2     1   0   44   0    0    85  1021     3    0     8
8     0     0   0   69   0    1    62     5  1197    7    29
9     8    54   3  160   3   20   259    65   174  343    48
10    0     0   0    0   2    0     0     0     0    0  1644
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-13 06:05:26.684300,epoch time: 0:27:48.744901,used: 3:16:07.827922,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_02_49_18_seed_0_24148164
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9490315, 'precision': 0.8758834, 'recall': 0.8329106, 'specificity': 0.9943583, 'f1': 0.84888184, 'auroc': 0.9957156}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   414     1    0     7    0    0    14     6     1    2     37
1     0  1255    0    20    0    0     0    47     3    0      7
2     3     0  152     0   36    1     2     5     3  105      5
3     2     2    0  8161    0   17     0   153    99    3      1
4     3     0   30     1  300    2     5     4    17   11    166
5     2     0    0    26    0  446     0     0     2   43      2
6     9     0    0    12    1    1  1852     7     4    1     21
7     1    20    1   216    1    0     1  6943    59    2     18
8     0     2    2   148   10    5     8    88  2953    7     72
9     9     0    9     6    0  124     3     2     3  336      1
10   18     8    2    18   25    1    23    16    21    3  12659
---- Validation: 
scalar performance:
{'acc': 0.94882977, 'precision': 0.8739752, 'recall': 0.83383775, 'specificity': 0.99434733, 'f1': 0.84925663, 'auroc': 0.99582165}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   406     0    0     6    0    2    20     7     0    4     38
1     0  1251    1    14    0    0     0    50     3    0     13
2     4     0  151     1   38    1     3     3     4  104      3
3     1     3    0  8151    0   21     2   155   102    2      3
4     6     0   28     2  318    2     2     6    18   12    145
5     1     0    0    29    0  442     0     0     2   45      2
6    12     0    0     9    0    0  1860     4     5    2     16
7     1    18    1   205    3    0     2  6966    46    2     21
8     1     0    2   158   15    2     5    89  2943    8     73
9     5     0   10    10    2  111     3     5     4  340      3
10   17     4    2    22   34    3    22    25    21    2  12644
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6188344, 'precision': 0.63828623, 'recall': 0.5061654, 'specificity': 0.9603236, 'f1': 0.48661193, 'auroc': 0.8399572}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   414     0   0   13   0    4   711     5     1   11    11
1     0  1245   0   33   0    0    11   153     6    0    51
2     4     9   6   24  10    5   161    73   166   57   500
3     0     0   0    0   0    0     0     0     0    0     0
4     0     1   0    0  13    0    11     1     8    0  1599
5     7     0   0  110   0  215    42     0    11  204     3
6    15     0   0    1   0    1  2648     2     4    0   396
7     1     2   0   24   0    0    59  1070     1    0     7
8     3     0   1   59   0    0    53     9  1156   15    74
9    17    41   4  132   1   18   165   134   112  432    81
10    0     0   0    0   0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-13 06:34:07.428552,epoch time: 0:28:40.744252,used: 3:44:48.572174,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_02_49_18_seed_0_24148164
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9534461, 'precision': 0.8761819, 'recall': 0.85667944, 'specificity': 0.9949857, 'f1': 0.86495453, 'auroc': 0.9970274}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   408     1    0    10    1    1    15     3     2    4     38
1     0  1280    0    15    0    0     0    33     3    0      1
2     2     1  204     0   35    2     0     3     5   59      1
3     1     1    0  8203    0   28     2   100    99    1      1
4     2     0   34     1  345    1     3     6    37   10    100
5     0     0    0    23    1  446     0     0     4   46      1
6     7     0    0    10    1    0  1869     0     7    5      9
7     1    24    3   256    4    0     4  6891    72    1      8
8     1     5    3   124    5    2     4    55  3069    3     25
9     3     1   31     6    1  122     1     1     5  321      1
10   17     2    3    15   55    3    21    16    59    1  12600
---- Validation: 
scalar performance:
{'acc': 0.954019, 'precision': 0.8777429, 'recall': 0.8561942, 'specificity': 0.9950355, 'f1': 0.8651316, 'auroc': 0.99702024}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   419     0    0     5    1    1    10     3     4    2     38
1     0  1281    1    16    0    0     0    30     3    0      1
2     0     1  207     0   30    1     0     4     8   58      3
3     0     2    0  8207    0   24     1    93   113    0      0
4     2     1   40     0  338    2     4     4    31    8    109
5     2     0    0    21    0  446     0     0     7   44      1
6     6     0    0     7    0    1  1860     3    12    3     16
7     0    19    1   260    1    1     3  6898    70    2     10
8     0     0    5   115    8    2     4    61  3080    3     18
9     4     0   31     9    1  135     1     1     3  308      0
10   15     2    3    12   52    1    16    15    57    1  12622
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.62995875, 'precision': 0.67112243, 'recall': 0.5298611, 'specificity': 0.96185416, 'f1': 0.5127233, 'auroc': 0.84409153}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   459     0   0   19   0    7   593     6     2   57    27
1     0  1271   0   41   0    0     9   126     6    0    46
2     1    23  13   43  11   10   116    55   272   68   403
3     0     0   0    0   0    0     0     0     0    0     0
4     0     3   0    1  52    0     6     1    25    0  1545
5     1     0   0  108   0  310     9     0    12  150     2
6     4     0   0    1   1    1  2530     2    15    1   512
7     2     1   0   40   0    0    65  1048     1    0     7
8     0     0   1   78   0    4    33     9  1204   16    25
9     4    72   5  192   3   47    88    79   119  477    51
10    0     1   0    0   5    0     0     0     0    0  1640
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-08-13 07:02:29.888519,epoch time: 0:28:22.459967,used: 4:13:11.032141,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_02_49_18_seed_0_24148164
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9572185, 'precision': 0.8934145, 'recall': 0.8649318, 'specificity': 0.9953616, 'f1': 0.8773035, 'auroc': 0.99735916}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     1    0     3    0    1     8     3     6    0     31
1     0  1284    0    14    0    0     0    24     5    0      5
2     2     1  190     2   50    0     2     4     5   54      2
3     1     2    0  8174    0   14     0    95   148    0      4
4     5     1   13     2  375    0     1     3    23    4    112
5     2     0    0    28    1  432     3     0     9   45      1
6     9     0    0     4    1    0  1863     1     8    3     17
7     2    29    2   218    1    0     6  6888    99    3     16
8     2     2    2    81    7    0     3    41  3123    2     32
9     5     0   23     7    3   97     3     0    12  341      1
10   15     2    3     8   37    1    12    11    28    0  12677
---- Validation: 
scalar performance:
{'acc': 0.95436674, 'precision': 0.882811, 'recall': 0.8541189, 'specificity': 0.99505705, 'f1': 0.8663846, 'auroc': 0.9972002}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     0    1     3    1    0    15     4     2    1     35
1     0  1277    0    12    0    0     2    30     7    0      4
2     1     1  176     2   53    1     3     3     7   62      3
3     0     3    0  8162    0   16     1    95   161    1      1
4     5     0   15     2  367    1     2     5    21    5    116
5     3     0    0    24    0  430     0     0     7   56      1
6    12     0    0     3    1    0  1863     3     6    2     18
7     3    31    1   227    2    0     4  6878    98    0     21
8     2     1    2    90    6    0     6    39  3109    1     40
9     5     0   29     9    1  101     0     1    12  331      4
10   12     1    2     7   43    3    19     7    36    1  12665
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58972925, 'precision': 0.6954708, 'recall': 0.48178765, 'specificity': 0.95780146, 'f1': 0.4608765, 'auroc': 0.837259}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   444     0   0   29   0    1   630    16     3   14    33
1     0  1172   0   42   0    0    13   203     5    0    64
2     1     5   3   46   6    3    98    83   255   30   485
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    0  45    0     5     1    21    0  1561
5     2     0   0  203   0  156    40     0    44  145     2
6     6     0   0    1   0    0  2375     2     8    0   675
7     3     0   0   36   0    0    38  1077     3    0     7
8     0     0   0   58   0    0    25    10  1241    3    33
9     7    37   0  259   2   14   120   142   210  275    71
10    0     0   0    0   5    0     0     0     0    0  1641
better model found
persisted
after epoch: 10,now: 2024-08-13 07:30:20.172427,epoch time: 0:27:50.283908,used: 4:41:01.316049,model: blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_02_49_18_seed_0_24148164
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 10 with time: 4:41:01.316049 at 2024-08-13 07:30:20.172427
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58972925, 'precision': 0.6954708, 'recall': 0.48178765, 'specificity': 0.95780146, 'f1': 0.4608765, 'auroc': 0.837259}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   444     0   0   29   0    1   630    16     3   14    33
1     0  1172   0   42   0    0    13   203     5    0    64
2     1     5   3   46   6    3    98    83   255   30   485
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    0  45    0     5     1    21    0  1561
5     2     0   0  203   0  156    40     0    44  145     2
6     6     0   0    1   0    0  2375     2     8    0   675
7     3     0   0   36   0    0    38  1077     3    0     7
8     0     0   0   58   0    0    25    10  1241    3    33
9     7    37   0  259   2   14   120   142   210  275    71
10    0     0   0    0   5    0     0     0     0    0  1641
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.62995875, 'precision': 0.67112243, 'recall': 0.5298611, 'specificity': 0.96185416, 'f1': 0.5127233, 'auroc': 0.84409153}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   459     0   0   19   0    7   593     6     2   57    27
1     0  1271   0   41   0    0     9   126     6    0    46
2     1    23  13   43  11   10   116    55   272   68   403
3     0     0   0    0   0    0     0     0     0    0     0
4     0     3   0    1  52    0     6     1    25    0  1545
5     1     0   0  108   0  310     9     0    12  150     2
6     4     0   0    1   1    1  2530     2    15    1   512
7     2     1   0   40   0    0    65  1048     1    0     7
8     0     0   1   78   0    4    33     9  1204   16    25
9     4    72   5  192   3   47    88    79   119  477    51
10    0     1   0    0   5    0     0     0     0    0  1640
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b8efecac6_not_commited_2024md_08md_13_02_49_18_seed_0_24148164_instance_wise_predictions.txt
accuracy from prediction file 0.5897292380885748
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_vit_resnet_erm_features_2024-08-13_02-20-58/rule_results/1.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_vit_resnet_erm_features_2024-08-13_02-20-58/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_vit_resnet_erm_features_2024-08-13_02-20-58/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 488794 KiB |   3088 MiB | 371869 GiB | 371869 GiB |
|       from large pool | 398080 KiB |   3016 MiB | 371399 GiB | 371399 GiB |
|       from small pool |  90714 KiB |    127 MiB |    470 GiB |    470 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 488794 KiB |   3088 MiB | 371869 GiB | 371869 GiB |
|       from large pool | 398080 KiB |   3016 MiB | 371399 GiB | 371399 GiB |
|       from small pool |  90714 KiB |    127 MiB |    470 GiB |    470 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 478098 KiB |   3081 MiB | 371377 GiB | 371377 GiB |
|       from large pool | 387840 KiB |   3010 MiB | 370909 GiB | 370908 GiB |
|       from small pool |  90258 KiB |    126 MiB |    468 GiB |    468 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3380 MiB |   3380 MiB |   3380 MiB |      0 B   |
|       from large pool |   3252 MiB |   3252 MiB |   3252 MiB |      0 B   |
|       from small pool |    128 MiB |    128 MiB |    128 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1070 MiB |   1099 MiB | 195964 GiB | 195963 GiB |
|       from large pool |   1063 MiB |   1089 MiB | 195439 GiB | 195438 GiB |
|       from small pool |      7 MiB |     15 MiB |    525 GiB |    525 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3009    |    4644    |   20481 K  |   20478 K  |
|       from large pool |      87    |     178    |   10161 K  |   10161 K  |
|       from small pool |    2922    |    4522    |   10320 K  |   10317 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3009    |    4644    |   20481 K  |   20478 K  |
|       from large pool |      87    |     178    |   10161 K  |   10161 K  |
|       from small pool |    2922    |    4522    |   10320 K  |   10317 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     103    |     103    |     103    |       0    |
|       from large pool |      39    |      39    |      39    |       0    |
|       from small pool |      64    |      64    |      64    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    1083    |    7435 K  |    7435 K  |
|       from large pool |      18    |      26    |    2899 K  |    2899 K  |
|       from small pool |      18    |    1065    |    4535 K  |    4535 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3088 MiB | 371869 GiB | 371869 GiB |
|       from large pool |  16640 KiB |   3016 MiB | 371399 GiB | 371399 GiB |
|       from small pool |      0 KiB |    127 MiB |    470 GiB |    470 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3088 MiB | 371869 GiB | 371869 GiB |
|       from large pool |  16640 KiB |   3016 MiB | 371399 GiB | 371399 GiB |
|       from small pool |      0 KiB |    127 MiB |    470 GiB |    470 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3081 MiB | 371377 GiB | 371377 GiB |
|       from large pool |  16640 KiB |   3010 MiB | 370909 GiB | 370909 GiB |
|       from small pool |      0 KiB |    126 MiB |    468 GiB |    468 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1548 MiB |   3380 MiB |   3380 MiB |   1832 MiB |
|       from large pool |   1452 MiB |   3252 MiB |   3252 MiB |   1800 MiB |
|       from small pool |     96 MiB |    128 MiB |    128 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 134912 KiB |   1180 MiB | 195965 GiB | 195964 GiB |
|       from large pool | 134912 KiB |   1161 MiB | 195439 GiB | 195439 GiB |
|       from small pool |      0 KiB |     28 MiB |    525 GiB |    525 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4644    |   20481 K  |   20481 K  |
|       from large pool |       2    |     178    |   10161 K  |   10161 K  |
|       from small pool |       0    |    4522    |   10320 K  |   10320 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4644    |   20481 K  |   20481 K  |
|       from large pool |       2    |     178    |   10161 K  |   10161 K  |
|       from small pool |       0    |    4522    |   10320 K  |   10320 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      70    |     103    |     103    |      33    |
|       from large pool |      22    |      39    |      39    |      17    |
|       from small pool |      48    |      64    |      64    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1083    |    7435 K  |    7435 K  |
|       from large pool |       3    |      27    |    2899 K  |    2899 K  |
|       from small pool |       0    |    1065    |    4535 K  |    4535 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Aug 13 07:53:27 2024]
Finished job 0.
1 of 1 steps (100%) done
