Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jul  8 12:01:15 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_3_5/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_3_5/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672

 Experiment start at: 2024-07-08 12:09:10.799117
before training, model accuracy: 0.08150843530893326
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93024933, 'precision': 0.82573485, 'recall': 0.7705933, 'specificity': 0.9923295, 'f1': 0.7844813, 'auroc': 0.9939929}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   409     0    0     6    1    0     5     3     3    1     55
1     1  1193    0    12    0    0     1   101     9    1     14
2     8     0  141     2   91    0     1    10     8   44      7
3     5     0    0  7942    0    3     3   302   183    1      1
4     7     0   13     1  286    1     1     3    22    8    197
5     7     0    5   115    1  185     0     0    25  182      1
6    62     0    1     5    1    0  1800     3     5    1     30
7     7     6    2   185    9    0     1  6903   122    0     26
8     4     0    4   115   30    0     2    67  2957    1    115
9    20     0   72    23   14   10     0     1    14  334      5
10   41     0    2     6   71    0    10    27    14    2  12619
---- Validation: 
scalar performance:
{'acc': 0.9312826, 'precision': 0.8282376, 'recall': 0.7748029, 'specificity': 0.99244535, 'f1': 0.78768337, 'auroc': 0.9941932}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   419     0    0     5    0    0     3     2     4    0     50
1     0  1202    1    11    0    0     0    98     5    0     15
2     6     0  151     1   90    0     1     7     8   40      8
3     5     0    1  7974    1    2     2   285   167    1      2
4     8     0   13     1  287    0     4     5    23    7    191
5     8     0    7   122    2  178     0     0    24  179      1
6    64     0    1     6    1    0  1795     4     8    2     27
7     3     6    3   176    6    0     3  6900   136    1     31
8     8     0    5   128   31    0     4    77  2934    0    109
9    17     0   78    21    7   12     0     0    16  336      6
10   33     1    1     6   70    0     7    17    17    4  12640
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65402645, 'precision': 0.60411626, 'recall': 0.53894186, 'specificity': 0.9650564, 'f1': 0.50971407, 'auroc': 0.87714404}
confusion matrix:
      0    1    2   3    4   5     6     7     8    9     10
0   1104    0    0  15    0   0     7    21     2    1    20
1      4  939    1  20    0   0     3   431     4    1    96
2     52    0  104   2  393   0     3    77    78   42   264
3      0    0    0   0    0   0     0     0     0    0     0
4      2    0    1   0  123   0     1     1     3    0  1502
5     42    0    6  69    2  44     2     1    35  384     7
6      1    0    0   1    2   0  2571     3     2    0   487
7      1    0    0   3    0   0     0  1152     2    1     5
8      4    0    0  34   29   0    16    24  1246    3    14
9     71    0  307  19   30   1     3   141   112  420    33
10     0    0    0   0    1   0     0     0     0    0  1645
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-08 12:50:11.495895,epoch time: 0:41:00.696778,used: 0:41:00.696778,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9443493, 'precision': 0.8469722, 'recall': 0.8359967, 'specificity': 0.99403703, 'f1': 0.8342222, 'auroc': 0.99638367}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    1     2    2    0     1     4     1    3     22
1     0  1252    0    14    0    0     0    59     5    0      2
2     5     0  178     1   75    0     0     6     3   43      1
3    13     0    1  8091    0   10     0   161   153   10      0
4     8     0   12     1  333    0     0     6    18   10    151
5     4     0    0    39    1  310     1     0    13  152      1
6   121     0    1     5    2    0  1757     0     4    2     15
7     9    15    2   202    3    0     1  6943    70    2     16
8     9     0    7    94   22    0     2    82  3015    2     61
9     8     0   43     6    5   20     0     5     5  401      0
10   74     0    4    10   85    0     8    21    19    3  12569
---- Validation: 
scalar performance:
{'acc': 0.943373, 'precision': 0.8400463, 'recall': 0.83483875, 'specificity': 0.99394166, 'f1': 0.83105755, 'auroc': 0.996443}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     2    2    0     1     3     0    2     20
1     0  1258    1    15    0    0     0    50     4    1      3
2     4     0  171     0   70    0     1     9     5   52      0
3    14     1    1  8077    2   14     2   149   172    8      0
4     8     0   11     0  340    0     0     3    14    7    156
5     4     0    2    35    2  316     0     0    10  151      1
6   112     0    1     7    3    1  1760     1     5    3     15
7    10    14    5   226    3    0     1  6902    84    4     16
8    13     0    5    96   24    0     1    64  3026    4     63
9     7     0   57     5    4   25     0     3     4  387      1
10   76     0    3    10   78    0    10    24    14    3  12578
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69677466, 'precision': 0.6282521, 'recall': 0.5730515, 'specificity': 0.9694092, 'f1': 0.5553469, 'auroc': 0.8776769}
confusion matrix:
      0     1    2   3    4   5     6     7     8    9     10
0   1144     0    1   4    0   0     2     6     1    9     3
1      6  1176    7  17    0   0     0   233    15    5    40
2     42     1  182   0  498   0     4    24   102   26   136
3      0     0    0   0    0   0     0     0     0    0     0
4      3     0    1   0  222   0     2     1     7    0  1397
5     24     0   19  14   13  75     0     0    21  426     0
6      8     0    1   0    5   0  2781     0     5    1   266
7     14     0    4  44    0   0     0  1097     1    0     4
8     12     0    7  24   18   0     9     9  1280    7     4
9     43     1  515   8   46   0     1    43    98  366    16
10     0     0    0   0   10   0     0     0     0    0  1636
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-08 13:26:19.800462,epoch time: 0:36:08.304567,used: 1:17:09.001345,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95095783, 'precision': 0.88198245, 'recall': 0.8407102, 'specificity': 0.9946793, 'f1': 0.85210073, 'auroc': 0.9972356}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   428     0    0     4    3    0     4     4     2    4     34
1     0  1272    0    17    0    0     1    38     2    0      2
2     1     2  165     2   51    1     2    20     4   63      1
3     0     1    0  8231    1    5     1    94   100    4      0
4     2     0   21     1  355    0     2     5    18   13    122
5     3     0    0    50    2  276     1     0    11  177      1
6    12     0    0    14    2    0  1862     2     5    1     10
7     0    12    0   313    4    0     1  6883    42    0      7
8     1     0    3   119   16    2     1    87  3051    1     13
9     2     1   28     8    4    8     0     2     6  434      0
10   11     1    3     8   88    0    19    24    51    4  12586
---- Validation: 
scalar performance:
{'acc': 0.95220006, 'precision': 0.8875579, 'recall': 0.84791076, 'specificity': 0.9948158, 'f1': 0.858948, 'auroc': 0.9971439}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   426     0    0     7    2    0     5     2     2    6     33
1     0  1276    0    17    0    0     0    35     3    0      1
2     0     0  184     0   48    1     1    14     4   60      0
3     0     1    0  8250    0    3     0    82    99    5      0
4     5     1   21     0  356    1     1     4    24   12    114
5     1     0    0    46    4  284     1     0     5  179      1
6    12     1    0    15    2    0  1858     2     6    4      8
7     0     8    0   302    3    0     1  6899    44    0      8
8     0     0    1   131   14    0     1    78  3050    3     18
9     2     1   25    13    3    7     1     2     3  435      1
10   12     1    3     8   90    0    17    27    54    4  12580
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7283985, 'precision': 0.6670542, 'recall': 0.5943722, 'specificity': 0.97274077, 'f1': 0.5764626, 'auroc': 0.8871788}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   980     0   0  49    1    0    24    67    14   22    13
1     0  1255   0  37    0    0     0   178    12    0    17
2     7     1  86  12  284    1     4    89   334  103    94
3     0     0   0   0    0    0     0     0     0    0     0
4     1     0   1   0  301    0     2     1    36    0  1291
5     2     0   0  68    4  105     4     0    22  386     1
6     0     0   0   6    0    0  3037     0    11    0    13
7     0     0   0  58    0    0     0  1102     1    1     2
8     1     0   0  56    0    0    10     5  1294    3     1
9     3     2  69  67   10   14     6   101   225  617    23
10    0     0   0   0   12    0     0     0     0    0  1634
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-08 14:02:45.473451,epoch time: 0:36:25.672989,used: 1:53:34.674334,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9488442, 'precision': 0.8719542, 'recall': 0.83012664, 'specificity': 0.9944237, 'f1': 0.83880633, 'auroc': 0.99664515}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   411     0    0     1    0    0    21     2     0    8     40
1     0  1250    0    11    0    0     4    57     5    0      5
2     2     0  160     0   53    0     1     3     0   89      3
3     2     0    4  8039    1   11    25   234   113    8      0
4     6     0   13     1  328    0     6     2     5   13    165
5     0     0    1    21    1  266     0     0     3  228      1
6     4     0    0     1    0    0  1885     0     0    4     14
7     7     4    4    97    4    0     9  7072    30    6     30
8     2     0    8    83   70    0     6   112  2912    7     96
9     1     0   24     4    2    7     1     1     0  452      0
10   11     0    1     6   43    0    24     8     7    5  12689
---- Validation: 
scalar performance:
{'acc': 0.94792026, 'precision': 0.86745846, 'recall': 0.8283605, 'specificity': 0.99433386, 'f1': 0.835665, 'auroc': 0.9967165}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     0    0     3    0    0    27     1     0    5     35
1     1  1231    0    15    0    0     0    76     1    0      8
2     2     0  157     0   62    1     1     7     1   79      2
3     7     1    1  8046    1   16    18   235   110    5      0
4     5     0   19     0  327    0     0     0     2   15    171
5     0     0    0    25    1  261     1     0     2  230      1
6     3     0    0     1    1    0  1886     1     1    2     13
7     8     7    4   107    9    0    15  7040    35    4     36
8     2     0    6    78   78    2     4   109  2928   11     78
9     1     0   21     1    3    4     0     1     1  460      1
10   17     0    1     6   42    0    25     6     7    2  12690
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7005527, 'precision': 0.6399868, 'recall': 0.57483363, 'specificity': 0.969597, 'f1': 0.56950194, 'auroc': 0.8695256}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1033     0    0    7    0    0    91    6     1   22    10
1      6  1097    1   26    1    0    17  274     5   19    53
2     16     0  169    7  477    1    25   19    16   94   191
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    1    0  127    0     2    0     0    0  1503
5      3     0    1   34    3  113    10    0     1  427     0
6      1     0    0    0    2    0  3012    0     0    1    51
7      7     0    7  106    0    0    62  966     0   12     4
8      0     1    5   69   45    9    54   13  1110   47    17
9     13     0  240   29   23    8    13   25    19  741    26
10     0     0    0    0    1    0     0    0     0    0  1645
early stop counter: 1
val acc:0.9479202628135681, best validation acc: 0.9522000551223755, corresponding to test acc:                         0.7283985018730164 / 0.7283985018730164
after epoch: 4,now: 2024-07-08 14:41:10.015349,epoch time: 0:38:24.541898,used: 2:31:59.216232,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94124573, 'precision': 0.8663501, 'recall': 0.7986426, 'specificity': 0.9937473, 'f1': 0.8020486, 'auroc': 0.9967567}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   386     0    2     9    0    4     3     2    17    4     56
1     0  1285    0     7    0    0     0    35     3    0      2
2     0     1  217     1    3   19     0    17    28   24      2
3     0     2    0  7854    0   19     0   248   314    0      0
4     1     0   81     1  197    7     0    14    89    4    145
5     0     0    0    12    0  494     0     0     8    5      2
6     5     1    4     9    1    6  1786     5    27    0     64
7     0    15    1    77    0    0     1  7028   133    0      8
8     0     2    2    24    0    1     0    73  3184    0      9
9     0     0   56     6    0  297     0     3    21  110      0
10    4     0    5     7    8    2     3    16   109    0  12639
---- Validation: 
scalar performance:
{'acc': 0.9407516, 'precision': 0.8661142, 'recall': 0.79809654, 'specificity': 0.9936928, 'f1': 0.8008242, 'auroc': 0.9966502}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   386     0    0     8    1    5     3     3    19    6     52
1     0  1291    0     5    0    0     0    32     3    0      1
2     0     0  227     0    1   23     0    12    27   19      3
3     0     8    1  7858    0   14     0   259   300    0      0
4     2     0   88     1  175    5     0    15    91    8    154
5     0     0    1    18    0  487     0     0    10    4      1
6     6     2    4     7    0    6  1768     7    33    3     72
7     0    21    2    78    0    0     1  7016   142    0      5
8     0     2    1    27    0    0     0    58  3200    0      8
9     0     0   44     7    0  295     0     4    24  119      0
10    5     0    7     7    8    2     3    11   109    1  12643
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5868607, 'precision': 0.63207847, 'recall': 0.54335666, 'specificity': 0.95862335, 'f1': 0.48478216, 'auroc': 0.87582815}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   739     0    2   76   0   40    71   100    88   39    15
1     0  1295    0    9   0    0     0   177     5    0    13
2     0     0  118   14  10   69     0    95   597   31    81
3     0     0    0    0   0    0     0     0     0    0     0
4     0     0    4    0  54    0     0     1   122    1  1451
5     0     0    0   64   0  500     0     1    16   11     0
6     0    15    0   16   0    0  1535    10   973    0   518
7     0     0    0   31   0    0     0  1128     3    0     2
8     0     0    0   69   0    5     0    19  1277    0     0
9     2     3   60  125   0  414     0   110   309  101    13
10    0     0    0    0   1    0     0     0     4    0  1641
early stop counter: 2
val acc:0.9407516121864319, best validation acc: 0.9522000551223755, corresponding to test acc:                         0.7283985018730164 / 0.7283985018730164
after epoch: 5,now: 2024-07-08 15:17:15.406950,epoch time: 0:36:05.391601,used: 3:08:04.607833,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9611248, 'precision': 0.91797614, 'recall': 0.8654666, 'specificity': 0.99556863, 'f1': 0.88542527, 'auroc': 0.9982648}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   405     0    0     3    1    0     9     5     1    4     55
1     0  1286    0     7    0    0     0    35     2    0      1
2     0     0  234     1   12    3     0     3     5   49      5
3     0     1    0  8227    0    1     0   104   104    1      1
4     3     0   41     2  266    1     2     3    14    7    200
5     0     0    0    29    0  416     0     0     6   69      1
6     3     0    0     4    0    0  1873     2     2    2     22
7     0    12    4   182    2    0     3  6991    56    1     13
8     1     0    2    74    7    1     0    62  3064    2     82
9     0     0   25     7    0   45     0     2     4  408      2
10    2     1    2     7    8    0     3     5     8    2  12753
---- Validation: 
scalar performance:
{'acc': 0.9602247, 'precision': 0.91400105, 'recall': 0.8624037, 'specificity': 0.99547267, 'f1': 0.88219225, 'auroc': 0.998192}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   404     0    0     5    0    0     9     3     0    4     58
1     0  1286    0     7    0    0     0    33     4    0      2
2     2     0  231     1   12    1     1     0     7   50      7
3     0     1    0  8197    0    4     0   114   121    3      0
4     1     0   45     2  273    1     0     2     9    5    201
5     0     0    0    38    0  400     0     0     8   74      1
6     5     0    2     1    0    0  1880     1     1    0     18
7     0    11    6   175    1    0     2  7011    46    1     12
8     0     0    4    73    7    2     0    57  3060    3     90
9     0     0   23    12    0   41     0     2     9  406      0
10    2     0    5     8   12    1     5     7     6    0  12750
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69859374, 'precision': 0.65849113, 'recall': 0.5815759, 'specificity': 0.9698523, 'f1': 0.5768157, 'auroc': 0.8805374}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   816     0    0  103    1    0    98    77     7   29    39
1     0  1238    0   33    1    0     3   205     3    0    16
2     2     1  166   44  149   13    21    89   171   42   317
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0   93    0     2     2     7    0  1529
5     0     0    1  188    0  284     1     2    13   99     4
6     0     0    0    3    0    0  3022     2     1    0    39
7     0     0    0   44    0    0     1  1116     1    0     2
8     0     0    0   89    1    0     8    31  1223    2    16
9     1     0  140  242    3   71     8   118   128  388    38
10    0     0    0    0    2    0     4     1     0    0  1639
better model found
persisted
after epoch: 6,now: 2024-07-08 15:53:12.594126,epoch time: 0:35:57.187176,used: 3:44:01.795009,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9599208, 'precision': 0.89227664, 'recall': 0.8762903, 'specificity': 0.99568796, 'f1': 0.8812149, 'auroc': 0.9981225}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   414     0    0     4    1    1    17     2     3    7     33
1     0  1310    0     6    0    0     0    13     3    0      0
2     0     0  172     0    8    5     1     6     3  117      0
3     0     2    0  8282    0   21     0    99    33    2      0
4     2     1   40     1  364    2     3     6    19   17     84
5     0     0    0    14    0  473     0     0     3   30      1
6     2     0    0     0    0    2  1896     1     2    0      5
7     0    33    0   211    1    0     1  6974    38    0      5
8     0     4    2   199    6   10     2    63  2995    7      5
9     0     0    3     2    0   74     1     2     0  411      0
10    3     2   19     7   69    2    23    16    60    6  12587
---- Validation: 
scalar performance:
{'acc': 0.95958275, 'precision': 0.88775307, 'recall': 0.8707158, 'specificity': 0.9956585, 'f1': 0.87537044, 'auroc': 0.9981284}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   420     0    0     2    2    0    18     3     0    6     32
1     0  1304    0     6    0    0     0    19     3    0      0
2     0     0  153     1   11    6     0     2     4  133      2
3     0     2    0  8273    0   21     1   104    38    1      0
4     2     1   45     2  359    3     3     8    17   16     83
5     0     0    0    10    0  471     0     0     3   36      1
6     7     0    0     3    0    0  1887     0     1    3      7
7     0    29    1   205    1    0     2  6989    31    2      5
8     0     1    2   199    6    8     0    53  3012    9      6
9     0     0    2     1    0   71     0     4     1  414      0
10    2     2   17     9   59    2    37    15    56    5  12592
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7447002, 'precision': 0.6955693, 'recall': 0.64090824, 'specificity': 0.97438675, 'f1': 0.61408275, 'auroc': 0.8899299}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   905     0    0  47    1   11    75    84     3   34    10
1     0  1371    0  19    0    0     0   101     2    0     6
2     3     2  149  11  112   43    20    93   336  131   115
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    5   0  217    0    15     3    38    1  1354
5     0     0    0  43    0  482     1     2     7   57     0
6     0     0    0   3    0    0  3061     1     1    0     1
7     0     0    0  12    0    1     1  1149     0    0     1
8     0     0    0  99    0    7     5    21  1235    0     3
9     1     4   18  98    2  269     4   148   135  444    14
10    0     0    0   0   10    0     4     1     0    0  1631
new oracle model saved
early stop counter: 1
val acc:0.9595827460289001, best validation acc: 0.9602246880531311, corresponding to test acc:                         0.6985937356948853 / 0.7447001934051514
after epoch: 7,now: 2024-07-08 16:29:22.233046,epoch time: 0:36:09.638920,used: 4:20:11.433929,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9634792, 'precision': 0.9156342, 'recall': 0.8848692, 'specificity': 0.99609905, 'f1': 0.8963578, 'auroc': 0.99859416}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     0    0     5    1    1     7     3     2    3     20
1     0  1303    0     6    0    0     0    21     2    0      0
2     1     0  182     1   32    4     0     7     5   80      0
3     0     2    0  8112    0   12     0   129   181    1      0
4     3     0   11     1  371    1     0     7    26    3    116
5     0     0    0    18    0  449     0     2     5   46      1
6     4     0    1     8    1    2  1866     6     9    0     11
7     0    29    0    97    1    0     1  7028   105    0      4
8     0     0    1    39    2    3     0    29  3212    1      9
9     0     0   11     5    1   57     0     1     3  414      1
10   10     1    1     7   32    0     6    13    87    0  12633
---- Validation: 
scalar performance:
{'acc': 0.96557444, 'precision': 0.9182785, 'recall': 0.8900278, 'specificity': 0.9963228, 'f1': 0.9010757, 'auroc': 0.9987085}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    0     6    1    2     6     4     1    2     13
1     0  1302    0     7    0    0     0    21     2    0      0
2     0     0  197     0   29    3     1     5     7   70      0
3     0     1    0  8150    0    9     0   110   168    2      0
4     3     0   17     0  364    3     0     4    30    5    113
5     0     0    0    17    0  450     0     0     6   47      1
6     3     0    0     7    2    1  1865     5    12    0     13
7     0    22    0   101    1    1     1  7037    98    0      4
8     0     3    2    36    1    2     0    32  3210    1      9
9     1     1    8     4    1   59     0     2     3  414      0
10   11     2    1     9   29    1     6    13    63    0  12661
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.721612, 'precision': 0.6622696, 'recall': 0.6071116, 'specificity': 0.9720425, 'f1': 0.58631545, 'auroc': 0.8812541}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   747     0    2   94    1    2    92   121    56   39    16
1     0  1331    0   17    0    0     0   130     8    0    13
2     4     3  112   19  172   26     7    82   345   79   166
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    3    0  159    0     4     2    38    0  1427
5     0     0    0  118    1  356     0     0    22   95     0
6     0     0    0    4    0    0  3042     1     6    0    14
7     0     0    0   12    0    0     0  1145     5    0     2
8     0     0    0   32    0    3     1     9  1322    3     0
9     3     7   48   97    6  162     2   108   213  465    26
10    0     0    0    0    8    0     0     1     2    0  1635
better model found
persisted
after epoch: 8,now: 2024-07-08 17:05:21.846643,epoch time: 0:35:59.613597,used: 4:56:11.047526,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94247645, 'precision': 0.8769749, 'recall': 0.8935222, 'specificity': 0.99375725, 'f1': 0.88285214, 'auroc': 0.9980129}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    2     6    1    0     3     0     2    3      5
1     0  1256    0    25    0    0     0    48     1    0      2
2     0     0  252     4    7    1     0     1     2   45      0
3     0     0    0  8397    0    1     0    18    21    0      0
4     5     0   57     4  420    1     0     2    22    6     22
5     0     0    0    67    0  425     0     0     3   26      0
6     5     0    2     4    7    1  1850     1     3    0     34
7     1     6    1   725    1    0     1  6468    58    0      4
8     1     0    3   243    5    1     0    30  3008    3      2
9     1     0   19    17    1   58     0     0     3  394      0
10   46     0   20     7  278    2     3    15   123    2  12295
---- Validation: 
scalar performance:
{'acc': 0.94203556, 'precision': 0.8705474, 'recall': 0.883742, 'specificity': 0.9937178, 'f1': 0.87525886, 'auroc': 0.9979417}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     6    2    0     7     1     2    3      6
1     0  1260    0    28    0    0     0    40     3    0      1
2     0     0  242     5    7    2     0     1     2   53      0
3     0     0    0  8400    0    0     0    20    20    0      0
4     6     0   61     4  406    2     0     2    27    6     25
5     0     0    0    72    1  410     0     0     2   36      0
6    10     0    0     9    8    2  1841     0     7    2     29
7     0     5    2   693    1    0     1  6496    61    1      5
8     0     0    4   253    8    0     0    28  2996    2      5
9     1     0   16    24    0   62     0     0     1  389      0
10   59     1   20     8  244    1     1    12   125    3  12322
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72287136, 'precision': 0.7053036, 'recall': 0.61051416, 'specificity': 0.9727708, 'f1': 0.6355691, 'auroc': 0.88560194}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   920     0   12  120    3   27    15   30    11   29     3
1     3  1045    2   65    1    0     1  341    12    4    25
2     3     0  324   60  230    5     1   61   214   78    39
3     0     0    0    0    0    0     0    0     0    0     0
4     3     0    4    0  760    0     2    3    34    1   826
5     0     0    2  201    0  263     0    0     6  120     0
6     4     0    2   20   10    0  2787    2    33    1   208
7     0     0    1  229    0    0     3  929     1    0     1
8     0     0    1  120    1    0     2    9  1232    3     2
9     3     0  148  263    2   49     1   70    82  509    10
10    0     0    0    1   79    0     0    0     3    0  1563
early stop counter: 1
val acc:0.9420355558395386, best validation acc: 0.9655744433403015, corresponding to test acc:                         0.7216119766235352 / 0.7447001934051514
after epoch: 9,now: 2024-07-08 17:41:22.199102,epoch time: 0:36:00.352459,used: 5:32:11.399985,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9636398, 'precision': 0.91005504, 'recall': 0.9066617, 'specificity': 0.9961368, 'f1': 0.9061257, 'auroc': 0.9986824}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   432     1    1     2    2    0     5     3     0    3     33
1     0  1323    0     2    0    0     0     6     1    0      0
2     0     0  280     0    3    1     1     4     4   18      1
3     0    26    0  8097    0    5     1   204   104    3      0
4     1     0   46     0  378    0     0     6    31    2     75
5     0     0    1    27    1  441     0     0     6   45      0
6     2     2    0     6    1    0  1880     2     2    0     11
7     0   153    0    68    2    0     1  7001    33    0      7
8     0     9    1    48    1    0     0    66  3156    0     14
9     0     2   58     6    1   32     0     3     5  386      0
10    1     9    5     7   72    1     6    15    32    0  12643
---- Validation: 
scalar performance:
{'acc': 0.9608934, 'precision': 0.90548563, 'recall': 0.9030036, 'specificity': 0.99583817, 'f1': 0.90230644, 'auroc': 0.998611}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   420     3    9     3    0    0     5     0     1    2     40
1     0  1325    0     0    0    0     0     6     1    0      0
2     0     0  270     1    7    0     1     5     5   22      1
3     0    31    0  8057    0    5     0   233   113    1      0
4     1     3   44     1  384    0     0     3    21    4     78
5     0     0    1    21    0  439     0     0     8   51      1
6     2     5    0     7    1    1  1866     2    10    0     14
7     0   150    3    72    0    0     1  6994    40    0      5
8     1     6    3    55    4    0     1    79  3132    0     15
9     0     0   45     3    1   35     0     3     4  402      0
10    1     6    7     7   76    1     6    17    41    0  12634
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7267194, 'precision': 0.6800457, 'recall': 0.60726464, 'specificity': 0.97268075, 'f1': 0.5971283, 'auroc': 0.88420284}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   756     5    5   95    0   17    58   113    14   63    44
1     0  1382    0   17    0    0     0    94     2    0     4
2     3    19  129   14   99    5     3   110   421   84   128
3     0     0    0    0    0    0     0     0     0    0     0
4     0     5    4    0  368    0     2     3    49    1  1201
5     0     0    4  114    1  323     0     2    28  120     0
6     2     0    0   10    0    0  3020     3    11    0    21
7     0    12    0    7    0    0     2  1140     0    0     3
8     0     1    0   82    0    3     3    36  1241    1     3
9     1    36   58  138    3   95     1   167   213  411    14
10    0     2    0    0   23    0     2     1     1    0  1617
early stop counter: 2
val acc:0.9608933925628662, best validation acc: 0.9655744433403015, corresponding to test acc:                         0.7216119766235352 / 0.7447001934051514
after epoch: 10,now: 2024-07-08 18:17:24.779171,epoch time: 0:36:02.580069,used: 6:08:13.980054,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97230846, 'precision': 0.9313917, 'recall': 0.91118205, 'specificity': 0.9969648, 'f1': 0.91836154, 'auroc': 0.9992561}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    0    0     1     0     0    1     12
1     0  1282    0     6    0    0     0    39     3    0      2
2     1     0  255     0   18    0     0     2     1   35      0
3     2     0    0  8365    0    0     0    32    38    1      1
4     8     0   16     1  437    0     0     3    10    0     64
5     2     0    2    59    0  351     0     0     6   99      1
6     6     0    0     0    1    0  1879     1     5    1     14
7     3     5    0   179    1    0     2  7028    39    0      6
8     2     0    1    94    7    0     0    31  3132    0     26
9     1     0   19    10    0   16     0     1     3  443      0
10   15     0    4     6   47    0     2     6    15    0  12700
---- Validation: 
scalar performance:
{'acc': 0.97279656, 'precision': 0.9325231, 'recall': 0.9156349, 'specificity': 0.9970232, 'f1': 0.92127526, 'auroc': 0.9993007}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    0    0     2     0     0    0      8
1     1  1300    0     7    0    0     0    23     1    0      0
2     2     0  255     2   13    0     0     2     1   37      0
3     2     0    0  8363    1    0     0    36    37    1      0
4     6     0   14     0  435    0     0     0     9    2     73
5     0     0    4    53    2  365     0     0     4   92      1
6    10     0    0     2    3    0  1878     0     2    1     12
7     5     6    0   187    1    0     1  7024    34    2      5
8     4     0    1    87    9    0     0    40  3135    0     20
9     0     0   13     9    3   12     0     2     7  447      0
10   21     0    5     7   43    0     2     7    18    0  12693
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68187225, 'precision': 0.6607138, 'recall': 0.5593265, 'specificity': 0.9683208, 'f1': 0.544137, 'auroc': 0.88021994}
confusion matrix:
      0    1    2    3    4    5     6     7     8    9     10
0   1102    0    3   20    0    1    26     7     2    5     4
1      3  984    0   35    0    0     2   430    11    0    34
2     34    0  169   21  113    2     4   126   344   28   174
3      0    0    0    0    0    0     0     0     0    0     0
4      0    0    1    0  264    0     2     2    30    0  1334
5      9    0   12  293    2  107     0     1    27  139     2
6      4    0    0    3    1    0  2825     2     8    0   224
7      0    0    0   14    0    0     0  1147     0    0     3
8      1    0    0   87    0    0     3    30  1245    1     3
9     26    0  136  256    2   22     3   181   220  272    19
10     0    0    0    0   13    0     1     1     0    0  1631
better model found
persisted
after epoch: 11,now: 2024-07-08 18:56:57.557331,epoch time: 0:39:32.778160,used: 6:47:46.758214,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9694724, 'precision': 0.9145168, 'recall': 0.90999836, 'specificity': 0.9967251, 'f1': 0.9080127, 'auroc': 0.9990711}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     1    3     1    1    0     0     2     2    0     22
1     0  1292    0     2    0    0     0    35     3    0      0
2     0     0  287     0    3    0     0     0     1   21      0
3     0     1    1  8177    0    9     1   114   132    3      0
4     5     0   59     0  358    1     0     2     9    5     99
5     0     0    0     6    0  419     0     0     3   92      1
6     6     1    1     2    0    0  1858     4     9    2     25
7     0     4    3    92    1    0     1  7094    58    3      6
8     0     0    7    26    4    5     0    31  3203    4     16
9     1     0   61     2    0   16     0     1     1  411      0
10    0     0   21     7   38    0     2    14    25    1  12685
---- Validation: 
scalar performance:
{'acc': 0.97014844, 'precision': 0.92086136, 'recall': 0.9160967, 'specificity': 0.99678564, 'f1': 0.9141166, 'auroc': 0.99908763}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    3     2    0    0     0     8     1    1     31
1     0  1290    0     5    0    0     0    34     3    0      0
2     0     0  297     1    2    0     0     1     1   10      0
3     0     1    1  8190    0   14     0   102   129    2      1
4     1     0   61     0  367    1     0     2    10    3     94
5     0     0    3     3    0  426     0     0     1   87      1
6     7     1    1     3    2    0  1853     8     9    2     22
7     0     3    5    94    1    0     1  7087    70    1      3
8     0     0    9    24    3    3     0    30  3206    4     17
9     1     0   51     2    0    9     0     0     0  430      0
10    3     0   15     6   36    0     1    14    33    2  12686
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72420067, 'precision': 0.6804767, 'recall': 0.60268, 'specificity': 0.97232723, 'f1': 0.5931996, 'auroc': 0.88234603}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   734     0   15  41    2    2    10   195    23   82    66
1     0  1116    5  18    1    0     0   334    11    2    12
2     1     0  459   3  103    4     3    59   128   81   174
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0   19   0  180    0     2     2    12    0  1418
5     0     0    9  48    2  143     0     3     7  375     5
6     0     0    0   2    0    0  3023     1     0    0    41
7     0     0    3  26    0    0     0  1128     2    3     2
8     0     0    2  34    2    3     1    19  1293    9     7
9     2     0  259  41    0   21     0    70    95  636    13
10    0     0    0   0    7    0     0     0     0    0  1639
early stop counter: 1
val acc:0.9701484441757202, best validation acc: 0.9727965593338013, corresponding to test acc:                         0.6818722486495972 / 0.7447001934051514
after epoch: 12,now: 2024-07-08 19:36:22.652394,epoch time: 0:39:25.095063,used: 7:27:11.853277,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9685092, 'precision': 0.9156736, 'recall': 0.9170784, 'specificity': 0.9967023, 'f1': 0.90739614, 'auroc': 0.9992236}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    0     2    6    0    10     1     0    2     15
1     0  1313    0     1    0    0     0    13     3    0      2
2     0     0  179     0   34    0     0     1     0   97      1
3     1     2    1  8280    1    5     0   104    34    8      0
4     2     0    4     0  505    0     0     0     3    2     23
5     0     0    0     9    0  446     1     0     0   64      1
6     1     0    0     2    2    0  1892     3     2    0      6
7     0    18    2   116    6    0     3  7066    37    9      7
8     0     0    2    73   31    3     2    37  3077   10     60
9     0     0    2     1    1   20     0     0     0  468      0
10    3     0    1     6  236    0     6     5     8    3  12526
---- Validation: 
scalar performance:
{'acc': 0.9704427, 'precision': 0.9176116, 'recall': 0.91874135, 'specificity': 0.9969052, 'f1': 0.9101432, 'auroc': 0.9992561}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     1    4    0     6     1     0    2     14
1     0  1310    0     7    0    0     0    11     2    0      2
2     0     0  178     0   32    0     1     0     3   98      0
3     1     2    1  8285    0   11     1   104    31    3      1
4     3     0    6     0  505    0     1     0     2    3     19
5     0     0    0     9    1  448     0     0     2   60      1
6     3     0    0     0    2    0  1894     1     0    1      7
7     0    16    2    94    6    0     1  7088    42   11      5
8     0     1    0    81   35    2     1    32  3077   11     56
9     0     0    3     1    1   20     1     0     0  467      0
10    4     0    1     5  191    1     6     8     6    1  12573
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.77814317, 'precision': 0.7167525, 'recall': 0.65693694, 'specificity': 0.977514, 'f1': 0.6541199, 'auroc': 0.89047164}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   900     0    0   5    6    3   159    32     1   52    12
1     3  1234    0  25    4    1     1   193     5   11    22
2     6     0  133   4  427   10     8    56   109  164    98
3     0     0    0   0    0    0     0     0     0    0     0
4     1     0    0   0  720    0     2     1     6    2   901
5     0     0    0  38    5  285    11     0     5  248     0
6     0     0    0   0    1    0  3050     0     0    1    15
7     0     1    0  17    0    0     1  1141     0    3     1
8     0     0    0  52    1    9     6    23  1268    6     5
9     4     1   31  31   17   83     1    61    62  837     9
10    0     0    0   0   90    0     1     1     0    0  1554
new oracle model saved
early stop counter: 2
val acc:0.9704427123069763, best validation acc: 0.9727965593338013, corresponding to test acc:                         0.6818722486495972 / 0.7781431674957275
after epoch: 13,now: 2024-07-08 20:13:28.911828,epoch time: 0:37:06.259434,used: 8:04:18.112711,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9695259, 'precision': 0.9226417, 'recall': 0.925998, 'specificity': 0.9966487, 'f1': 0.92324364, 'auroc': 0.99927706}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    1     1    4    0     0     0     0    0     12
1     0  1310    0     0    0    0     0    20     1    0      1
2     0     0  282     0    8    0     0     3     0   17      2
3     0     3    1  8163    0    2     0   211    52    2      2
4     3     0   35     0  438    0     0     2     1    4     56
5     0     0    2    14    0  440     0     0     2   62      1
6     7     0    0     1    1    0  1877     2     0    1     19
7     0    11    2    54    0    0     0  7181     9    1      5
8     1     2    5    51   49    0     0   145  2959    1     83
9     2     0   44     2    0   24     0     3     0  418      0
10    6     0    0     6   61    1     2    10     2    1  12704
---- Validation: 
scalar performance:
{'acc': 0.9695065, 'precision': 0.92169404, 'recall': 0.92187154, 'specificity': 0.9966461, 'f1': 0.9210154, 'auroc': 0.99925685}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     0    4    1     2     1     0    1     19
1     0  1311    0     0    0    0     0    21     0    0      0
2     0     0  279     1    6    0     0     3     0   23      0
3     0     5    0  8170    0    5     0   203    55    2      0
4     3     0   30     0  432    0     0     2     1    4     67
5     0     0    3    21    1  443     0     1     1   50      1
6     9     0    0     3    1    0  1877     1     3    0     14
7     0     8    3    58    1    0     1  7182     6    0      6
8     0     3    8    49   58    0     0   134  2968    1     75
9     0     0   38     6    1   35     0     2     0  411      0
10    4     0    2     6   55    0     1     8     2    1  12717
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74267125, 'precision': 0.69963264, 'recall': 0.6294471, 'specificity': 0.9743823, 'f1': 0.6374742, 'auroc': 0.886021}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1000     0    0   38    2    5     4    94     2   23     2
1      1  1066    2   20    2    0     0   383     3    2    20
2     11     0  268   24  322    8     2    94    69  111   106
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    9    0  589    0     1     4     3    0  1025
5      3     0    7  118    7  259     0     0     2  195     1
6     10     0    2   15    4    0  2908     8     3    0   117
7      1     0    0   29    0    0     1  1132     0    0     1
8      1     0    2  109   13    6     5    47  1173    4    10
9      7     0   98  151    7   71     0   131    33  626    13
10     0     0    0    0   51    0     0     1     0    0  1594
early stop counter: 3
val acc:0.9695065021514893, best validation acc: 0.9727965593338013, corresponding to test acc:                         0.6818722486495972 / 0.7781431674957275
after epoch: 14,now: 2024-07-08 20:49:25.750219,epoch time: 0:35:56.838391,used: 8:40:14.951102,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9751712, 'precision': 0.9418228, 'recall': 0.9187271, 'specificity': 0.99731845, 'f1': 0.9281091, 'auroc': 0.9994337}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     2    3    0     1     2     3    0     12
1     0  1291    0     6    0    0     0    33     2    0      0
2     0     0  264     0    9    3     0    10     8   18      0
3     1     0    0  8295    0    1     0    84    57    0      0
4     4     0   15     0  416    0     0     3    24    0     77
5     0     0    1    16    0  488     0     0     3   12      1
6     6     0    0     4    1    0  1878     4     6    0      8
7     0     2    0    71    1    0     0  7145    39    0      4
8     0     0    1    48    0    0     0    34  3208    0      5
9     0     1   42     4    0   77     0     5    10  353      1
10    6     2    2     8   14    1     7    12    91    0  12651
---- Validation: 
scalar performance:
{'acc': 0.9750435, 'precision': 0.9440354, 'recall': 0.9230869, 'specificity': 0.9972999, 'f1': 0.9313309, 'auroc': 0.9994195}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     2    2    0     2     2     5    0     16
1     0  1288    0     4    0    0     0    37     3    0      0
2     0     0  278     1    9    0     0     3     5   16      0
3     0     1    0  8281    0    6     0    83    69    0      0
4     4     0   12     1  409    0     0     3    34    1     75
5     0     0    1    14    0  492     0     0     1   12      1
6     8     0    0     3    1    0  1877     4     7    0      8
7     1     1    0    89    1    0     0  7130    38    0      5
8     0     0    1    41    0    0     0    29  3220    0      5
9     0     0   46     4    0   68     0     5     5  365      0
10    5     0    1     6   11    2     5    17    90    1  12658
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6922969, 'precision': 0.6427935, 'recall': 0.57627803, 'specificity': 0.9692092, 'f1': 0.54620475, 'auroc': 0.87737435}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   909     1   1   51    3    2    33    96    22   17    35
1     0  1103   0   17    0    0     0   348     9    0    22
2     4     0  86   22   91   20     5   112   439   41   195
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   1    0  125    0     5     2    59    0  1440
5     4     0   1  121    6  323     0     1    40   92     4
6     0     0   0    4    0    0  3045     1     7    0    10
7     0     0   0   11    0    0     0  1150     0    0     3
8     0     0   0   54    0    2     2    41  1271    0     0
9     9     3  41  149    6  165     0   195   286  246    37
10    0     1   0    0    7    0     1     0     0    0  1637
better model found
persisted
after epoch: 15,now: 2024-07-08 21:25:29.341490,epoch time: 0:36:03.591271,used: 9:16:18.542373,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.976723, 'precision': 0.9379074, 'recall': 0.9177542, 'specificity': 0.9973911, 'f1': 0.92734754, 'auroc': 0.9993431}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     0    0     5    8    0     0     2     1    0     26
1     0  1280    0     4    1    0     0    43     1    0      3
2     0     0  260     0   39    1     0     0     0    7      5
3     0     0    0  8298    0   15     0    78    48    0      0
4     0     0    1     0  430    0     0     1     4    0    103
5     0     0    1     4    0  458     0     0     4   53      1
6     2     1    0     8    2    0  1855     5     3    0     31
7     0     2    3    69    2    0     0  7166    17    0      5
8     0     0    2    37    9    1     0    43  3173    0     31
9     0     0   67     1    7   12     0     0     3  399      4
10    4     0    0     5   19    1     1     8     5    1  12746
---- Validation: 
scalar performance:
{'acc': 0.9748562, 'precision': 0.93499863, 'recall': 0.9124354, 'specificity': 0.9971589, 'f1': 0.92305654, 'auroc': 0.9993562}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   420     0    1     6   12    0     0     4     1    2     37
1     0  1293    0     5    0    0     0    32     1    0      1
2     0     0  262     2   33    1     0     1     1    7      5
3     0     0    1  8297    0   17     0    85    40    0      0
4     0     0    1     0  426    1     0     0     3    1    107
5     0     0    2     4    1  458     0     0     2   53      1
6     6     0    0     6    4    0  1847     8     1    1     35
7     0     3    1    84    2    0     1  7148    20    1      5
8     0     0    1    47    9    2     0    43  3146    0     48
9     2     0   67     1    5   15     0     1     3  395      4
10    1     0    1     4   18    1     2    10     6    0  12753
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6923669, 'precision': 0.6310982, 'recall': 0.5907389, 'specificity': 0.9690977, 'f1': 0.5759144, 'auroc': 0.8700832}
confusion matrix:
     0    1    2   3    4    5     6     7     8    9     10
0   872    0    4  52   14   13     7   119     8   60    21
1     2  975    0  29    1    1     1   371     8    3   108
2     3    0  165  12  239   20     1    51   168   71   285
3     0    0    0   0    0    0     0     0     0    0     0
4     0    0    2   0  115    0     1     1    13    0  1501
5     1    0    4  40    1  338     0     1     7  200     0
6     3    0    0  16    0    0  2850     5    14    0   179
7     0    0    0  50    0    1     0  1106     3    1     3
8     0    0    0  43    2   11     4    23  1271    4    12
9     3    0  134  54   12  129     0    84   128  560    33
10    0    0    0   0    2    0     0     0     0    0  1644
early stop counter: 1
val acc:0.9748561978340149, best validation acc: 0.9750434756278992, corresponding to test acc:                         0.6922969222068787 / 0.7781431674957275
after epoch: 16,now: 2024-07-08 22:01:19.872689,epoch time: 0:35:50.531199,used: 9:52:09.073572,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97273654, 'precision': 0.92307675, 'recall': 0.90037173, 'specificity': 0.9969832, 'f1': 0.9031503, 'auroc': 0.9993755}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    2     5    0    0     2     1     1    5     42
1     0  1302    0     3    0    0     0    21     4    0      2
2     0     0  303     0    4    0     0     1     1    2      0
3     0     0    3  8259    1   18     0    95    58    0      1
4     0     0   68     0  320    0     0     3     4    3    141
5     0     0    5     4    0  424     0     0     0   87      1
6     5     0    1     7    0    1  1878     1     2    0     13
7     2     4    5    75    1    0     1  7150    19    2      6
8     0     0    8    31    8    3     0    41  3161    4     39
9     0     0  112     1    0    4     0     1     0  375      0
10    0     0    4     7    5    0     1     7    10    0  12760
---- Validation: 
scalar performance:
{'acc': 0.9726361, 'precision': 0.92718613, 'recall': 0.90400124, 'specificity': 0.99694896, 'f1': 0.9064959, 'auroc': 0.9993706}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   433     0    0     2    0    0     0     2     0    2     44
1     0  1301    0     3    0    0     0    22     5    0      1
2     0     0  309     0    2    0     0     0     0    1      0
3     0     0    1  8260    0   16     0   102    54    7      0
4     0     0   69     1  320    0     1     0     0    2    146
5     0     0    6     3    0  416     0     0     0   95      1
6     4     0    2     8    0    0  1876     6     1    0     11
7     0     3    8    86    0    0     1  7138    21    1      7
8     0     0   13    30    5    1     0    42  3155    4     46
9     0     0   98     0    0    4     0     0     0  389      2
10    1     0    2     9    3    1     1     7     6    1  12765
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7154551, 'precision': 0.6572435, 'recall': 0.6049901, 'specificity': 0.9715505, 'f1': 0.6005826, 'auroc': 0.8744546}
confusion matrix:
     0     1    2    3   4    5     6    7     8    9     10
0   958     2    4   65   0    3    35   34     6   30    33
1     1  1185    4   21   0    0    10  224    15    0    39
2     1     0  390    7  55   11     5   40   123   72   311
3     0     0    0    0   0    0     0    0     0    0     0
4     0     0    9    0  40    0     7    2    10    0  1565
5     1     0    8   32   2  298     0    0     3  247     1
6     0     0    0    2   0    0  3037    0     2    0    26
7     0     0    3  317   0    2     1  835     2    3     1
8     0     0    4   42   0   20     4    8  1276    3    13
9     2     0  249   39   0  111     2   45    93  565    31
10    0     0    0    0   1    0     2    1     0    0  1642
early stop counter: 2
val acc:0.9726361036300659, best validation acc: 0.9750434756278992, corresponding to test acc:                         0.6922969222068787 / 0.7781431674957275
after epoch: 17,now: 2024-07-08 22:37:07.469205,epoch time: 0:35:47.596516,used: 10:27:56.670088,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9799604, 'precision': 0.9605491, 'recall': 0.93494403, 'specificity': 0.9977526, 'f1': 0.9462246, 'auroc': 0.9996244}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     1    1    0     0     3     1    1     18
1     0  1302    0     1    1    0     0    26     2    0      0
2     0     0  282     1    3    1     0     1     4   19      1
3     0     0    0  8255    0    0     0   142    36    1      1
4     3     0    8     0  399    1     0     3    30    3     92
5     0     0    1    14    0  458     0     0     7   41      0
6     3     0    0     2    0    1  1883     4     3    0     11
7     0     1    1    49    0    0     0  7196    12    0      6
8     0     0    0    36    1    0     0    55  3194    0      8
9     0     0   21     3    0   15     0     3     1  450      0
10    5     0    5     2   12    0     1    11     9    0  12750
---- Validation: 
scalar performance:
{'acc': 0.9802327, 'precision': 0.95950794, 'recall': 0.93818784, 'specificity': 0.99779516, 'f1': 0.9475867, 'auroc': 0.9996383}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     0    3    0     0     1     2    0     15
1     0  1305    0     2    0    0     0    23     1    0      1
2     0     0  273     0    8    0     0     1     8   22      0
3     0     0    0  8259    0    0     0   153    27    0      1
4     3     0   13     0  414    0     0     1    26    3     79
5     0     0    0     8    2  465     0     0     2   44      0
6    11     0    0     3    0    0  1868     6     3    0     17
7     0     1    0    39    0    0     0  7209    12    0      4
8     2     0    0    44    0    0     0    48  3189    1     12
9     0     0   20     0    1    8     0     3     0  461      0
10    6     0    3     3    6    0     1    10    26    0  12741
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6996432, 'precision': 0.6530553, 'recall': 0.5957741, 'specificity': 0.9698252, 'f1': 0.57192457, 'auroc': 0.87822145}
confusion matrix:
      0     1    2    3   4    5     6     7     8    9     10
0   1049     0    1   18   0    2    12    63     8    6    11
1      2  1067    0   23   0    0     0   343    12    0    52
2     11     0  159    6  69   16     3   109   329   35   278
3      0     0    0    0   0    0     0     0     0    0     0
4      1     0    2    0  67    0     2     3    32    0  1526
5     10     0    7   98   0  311     2     1    16  134    13
6      3     0    0    2   0    0  2851     4    10    0   197
7      0     0    1   10   0    0     0  1149     2    0     2
8      0     0    0   38   0    4     1    46  1278    0     3
9     19     0  107  108   0   93     0   180   167  425    38
10     0     0    0    0   1    0     0     1     0    0  1644
better model found
persisted
after epoch: 18,now: 2024-07-08 23:12:47.044522,epoch time: 0:35:39.575317,used: 11:03:36.245405,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97979987, 'precision': 0.95179605, 'recall': 0.92631173, 'specificity': 0.9977171, 'f1': 0.93785286, 'auroc': 0.99956894}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     0    3    0     1     1     0    0     16
1     0  1311    0     1    0    0     0    18     1    0      1
2     1     0  260     0   36    0     0     1     2    7      5
3     2     0    0  8284    0   10     1    62    76    1      0
4     2     0    1     0  408    0     0     1     6    0    121
5     1     0    1    12    0  489     0     0     7    9      1
6     3     0    0     0    1    0  1886     0     3    0     14
7     0     4    1    75    3    0     3  7142    25    0     12
8     0     0    2    17    8    0     0    11  3218    0     39
9     2     0   31     2    7   52     0     0     3  389      7
10    3     0    0     6    7    0     1     1     4    0  12772
---- Validation: 
scalar performance:
{'acc': 0.98087466, 'precision': 0.95787483, 'recall': 0.933692, 'specificity': 0.9978266, 'f1': 0.9448469, 'auroc': 0.99958855}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     0    2    0     1     0     0    0     14
1     0  1310    0     2    0    1     0    18     0    0      1
2     1     0  266     0   31    0     1     1     1    7      4
3     3     0    0  8296    0    8     0    54    79    0      0
4     4     0    2     0  418    0     0     0     3    0    112
5     0     0    0    15    2  491     0     0     6    7      0
6     1     0    0     0    1    1  1886     0     5    1     13
7     1     3    0    71    1    0     1  7144    23    0     21
8     0     0    1    18    4    0     0    18  3215    0     40
9     0     0   29     2    7   43     0     0     2  406      4
10    1     0    0     5    6    0     2     1     9    0  12772
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68110263, 'precision': 0.62038904, 'recall': 0.5645897, 'specificity': 0.96803504, 'f1': 0.5452953, 'auroc': 0.87464875}
confusion matrix:
      0    1    2    3    4    5     6     7     8    9     10
0   1008    0    0   17    1    2    35    54    16    2    35
1      0  934    0   34    0    0     1   440    16    0    74
2      8    0  103   17  211    7     2    91   287   22   267
3      0    0    0    0    0    0     0     0     0    0     0
4      1    0    0    0  156    0     2     3    15    0  1456
5     12    0   12  138   11  252     0     2    44  118     3
6      1    0    0    3    1    0  2964     2     7    0    89
7      0    0    1   57    0    0     2  1100     3    0     1
8      0    0    0   44    0    2     3    24  1294    0     3
9     12    0  125  153   20  111     5   150   223  288    50
10     0    0    0    0    9    0     0     1     0    0  1636
better model found
persisted
after epoch: 19,now: 2024-07-08 23:48:33.712421,epoch time: 0:35:46.667899,used: 11:39:22.913304,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9809771, 'precision': 0.9526055, 'recall': 0.95085895, 'specificity': 0.99798095, 'f1': 0.9512719, 'auroc': 0.99968773}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     2    5    0     8     0     2    1      9
1     0  1325    0     1    0    0     0     6     0    0      0
2     0     0  260     0   14    0     0     0     3   35      0
3     2     3    0  8327    0    1     9    47    46    0      2
4     4     0    3     0  489    0     1     1     5    2     34
5     0     0    0    18    1  485     0     0     3   14      0
6     2     0    0     1    0    0  1896     1     0    0      8
7     0    30    3    79    1    0     2  7035   104    0      9
8     1     0    0    28    3    0     1     7  3238    0     18
9     0     0   12     3    0   19     0     0     3  455      0
10    1     1    3     5   71    0     5     3     5    0  12699
---- Validation: 
scalar performance:
{'acc': 0.98173064, 'precision': 0.9575503, 'recall': 0.95571303, 'specificity': 0.9980612, 'f1': 0.9561718, 'auroc': 0.99974346}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     0    3    0    10     0     3    0      7
1     0  1323    0     0    0    0     1     7     0    0      1
2     0     1  262     0   10    0     0     1     3   35      0
3     1     5    0  8343    0    0     5    40    46    0      0
4     1     0    4     0  508    0     2     0     5    1     18
5     0     0    0    20    1  484     0     0     3   13      0
6     2     0    0     0    0    0  1897     0     2    0      7
7     0    27    2    87    1    0     2  7026   111    2      7
8     1     1    0    33    4    0     2     8  3221    0     26
9     0     0   12     1    0   15     0     0     3  461      1
10    3     0    2     5   54    0     5     3     7    0  12717
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7391031, 'precision': 0.65996844, 'recall': 0.61325836, 'specificity': 0.9736266, 'f1': 0.60952127, 'auroc': 0.87980646}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   941     0    3   6   12    0    89    39     8   48    24
1     1  1309    1  16    2    1     1   120    13    4    31
2     2     3  156   5  348    7     8    23   276   48   139
3     0     0    0   0    0    0     0     0     0    0     0
4     1     0    1   0  471    0     3     1    18    0  1138
5     6     0   20  83    7  189     3     0    27  255     2
6     1     0    0   1    2    0  2955     3     2    0   103
7     0     0    1  22    0    0     8  1111    19    2     1
8     0     1    0  34    1    1    11     7  1310    4     1
9     5     8  167  56   19   61     6    30   233  528    24
10    0     1    0   0   50    0     0     1     0    0  1594
better model found
persisted
after epoch: 20,now: 2024-07-09 00:24:20.906733,epoch time: 0:35:47.194312,used: 12:15:10.107616,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9757331, 'precision': 0.93449056, 'recall': 0.9430753, 'specificity': 0.9974951, 'f1': 0.9357322, 'auroc': 0.9996015}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    5    0     0     2     0    1      6
1     0  1313    0     2    0    0     0    15     2    0      0
2     0     0  258     0   16    0     0     5     1   32      0
3     3     0    0  8286    0    2     0    58    85    4      0
4     1     0    6     0  503    0     0     4    10    3     12
5     1     0    3     9    0  414     0     0     7   87      0
6     4     1    0     0    3    0  1894     0     0    1      4
7     1     5    0   130    1    0     3  7096    21    0      5
8     0     1    0    24    5    0     0    24  3233    2      7
9     0     0   12     1    2    3     0     2     4  468      1
10    5     0    2     4  152    0     9    13    73    0  12535
---- Validation: 
scalar performance:
{'acc': 0.9773171, 'precision': 0.9369106, 'recall': 0.9462274, 'specificity': 0.99765927, 'f1': 0.93858385, 'auroc': 0.9996414}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    4    0     1     0     2    0      6
1     0  1307    0     3    0    0     0    21     0    1      0
2     0     0  255     0   17    0     0     5     3   32      0
3     1     1    0  8308    0    2     0    58    65    5      0
4     1     0    5     0  511    0     1     0     7    2     12
5     2     0    0     4    2  425     0     0     5   82      1
6     8     0    0     2    1    0  1892     0     1    0      4
7     2     3    0   121    0    0     1  7112    21    0      5
8     1     0    0    20    8    0     1    20  3237    0      9
9     0     0   14     0    1    4     0     0     3  471      0
10    4     0    1     6  151    0    10    10    65    0  12549
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73539495, 'precision': 0.65269595, 'recall': 0.60882264, 'specificity': 0.9735223, 'f1': 0.6044855, 'auroc': 0.8809907}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1049     0    1   15    9    1     7    33     1   37    17
1      4  1165    0   35    1    0     1   261     6    2    24
2     19     1  160    6  358    5     1   110   212   61    82
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    1    0  444    0     4     3    25    0  1155
5     11     1   28   45   13  189     1     0    11  293     0
6      4     0    0    4    0    0  3027     4     1    0    27
7      2     0    1  138    0    1     1  1018     0    1     2
8      4     0    1   43    2    4     4    22  1283    5     2
9     23     2  161   62   19   58     1   116   113  568    14
10     0     0    0    0   37    0     0     1     0    0  1608
early stop counter: 1
val acc:0.9773170948028564, best validation acc: 0.9817306399345398, corresponding to test acc:                         0.7391030788421631 / 0.7781431674957275
after epoch: 21,now: 2024-07-09 01:02:34.611003,epoch time: 0:38:13.704270,used: 12:53:23.811886,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9773919, 'precision': 0.9567017, 'recall': 0.94635403, 'specificity': 0.9974558, 'f1': 0.9503095, 'auroc': 0.9997408}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     2    0    2     3     3     0    6      4
1     0  1313    0     2    0    0     0    16     1    0      0
2     0     0  286     0    1    0     0     3     1   21      0
3     0     0    0  8392    0    6     0    31     2    5      0
4     7     0   15     0  455    0     0     4     1   10     47
5     0     0    0     1    0  470     0     0     1   49      0
6     4     0    0     5    0    0  1884     3     1    2      9
7     0     1    0    84    0    0     0  7174     1    2      1
8     0     2    0   280    9    2     1    84  2887    4     27
9     0     0   12     2    0    4     0     1     0  474      0
10    5     0    3    10   20    0     1    16     3    2  12733
---- Validation: 
scalar performance:
{'acc': 0.97761136, 'precision': 0.9558185, 'recall': 0.9466311, 'specificity': 0.9974763, 'f1': 0.9502131, 'auroc': 0.99974567}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     4    0    3     2     5     0    4      4
1     0  1312    0     5    0    0     0    15     0    0      0
2     0     0  282     2    1    0     0     3     1   23      0
3     0     1    0  8407    0    2     0    26     2    2      0
4     6     0   20     0  463    0     0     2     1    4     43
5     0     0    1     3    1  473     0     0     0   43      0
6     5     1    0     4    0    0  1887     1     1    1      8
7     0     4    0    95    0    0     0  7161     3    1      1
8     2     1    1   275    9    2     1    73  2891    5     36
9     0     0   14     0    0    6     0     0     0  473      0
10    6     1    6     7   15    1     2    15     4    1  12738
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70873857, 'precision': 0.6613264, 'recall': 0.58889973, 'specificity': 0.97078544, 'f1': 0.5896229, 'auroc': 0.8799863}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   757     0    0   35    4    7   136    19     2  190    20
1     0  1197    1   28    1    0     0   255     1    1    15
2     6     3  214   25  250   10     7    93    87  145   175
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0   10    0  244    0     3     4     5    0  1366
5     1     0    5   29    0  223     1     1     1  328     3
6     0     0    0    9    0    0  3007     2     1    0    48
7     0     0    0  119    0    0     0  1042     0    1     2
8     0     0    2  169    4   10    11    33  1121   13     7
9     3     1   82   70    8   97     2   105    52  695    22
10    0     0    0    0   15    0     0     1     0    0  1630
early stop counter: 2
val acc:0.9776113629341125, best validation acc: 0.9817306399345398, corresponding to test acc:                         0.7391030788421631 / 0.7781431674957275
after epoch: 22,now: 2024-07-09 01:38:22.082542,epoch time: 0:35:47.471539,used: 13:29:11.283425,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98474956, 'precision': 0.96727955, 'recall': 0.956366, 'specificity': 0.9983032, 'f1': 0.9610093, 'auroc': 0.9998295}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     2    3    0     2     0     0    2     16
1     0  1324    0     1    0    0     0     6     1    0      0
2     0     0  261     0   17    0     0     0     1   33      0
3     0     1    0  8388    0    4     1    35     6    1      0
4     3     0    3     0  492    0     0     0     7    4     30
5     0     0    0     8    0  484     1     0     2   26      0
6     0     0    0     0    0    0  1892     0     1    0     14
7     0    14    1   101    2    0     1  7109    29    0      7
8     0     1    0    72    0    0     0    13  3181    1     28
9     0     0    3     1    0    8     0     0     1  480      0
10    0     0    1     7   36    0     3     5     3    1  12737
---- Validation: 
scalar performance:
{'acc': 0.9854755, 'precision': 0.96818084, 'recall': 0.9570643, 'specificity': 0.9983799, 'f1': 0.96213853, 'auroc': 0.9998247}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     1    1    0     3     0     0    3     16
1     0  1322    0     3    1    0     0     6     0    0      0
2     0     0  266     0   12    0     0     2     4   27      1
3     0     0    0  8393    0    0     0    37    10    0      0
4     3     0    4     0  499    0     0     0     6    4     23
5     0     0    1    13    0  478     0     0     1   28      0
6     3     0    0     1    2    0  1892     1     0    0      9
7     0     7    2   115    0    0     2  7106    20    0     13
8     0     0    0    59    1    0     0     7  3208    0     21
9     0     0    5     4    0   13     0     0     0  471      0
10    2     0    2     7   26    0     1     5     5    0  12748
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7013923, 'precision': 0.6420673, 'recall': 0.57628274, 'specificity': 0.96982574, 'f1': 0.5639001, 'auroc': 0.87806237}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   856     0    0   24    4    3   149    15    39   18    62
1     0  1247    0   22    2    0     1   171    16    0    40
2     5     0  117   10  188    9    24    45   366   33   218
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  216    0     3     2    32    0  1379
5     3     0    4  102    2  241    35     1    32  172     0
6     0     0    0    1    0    0  3038     1     5    0    22
7     0     1    0   87    0    0     4  1061     6    0     5
8     0     0    0   48    0    3     7    10  1302    0     0
9     3     3   85  129   10  114    26    89   324  315    39
10    0     0    0    0   11    0     2     1     0    0  1632
better model found
persisted
after epoch: 23,now: 2024-07-09 02:13:55.373945,epoch time: 0:35:33.291403,used: 14:04:44.574828,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98662245, 'precision': 0.9621058, 'recall': 0.95861614, 'specificity': 0.9985874, 'f1': 0.9589404, 'auroc': 0.9998334}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    2    0     0     1     0    0      1
1     0  1321    0     0    0    0     0    11     0    0      0
2     1     0  273     1   15    0     0     2     0   20      0
3     0     0    0  8386    0    0     2    33    16    0      0
4     5     0    1     0  514    0     0     0     2    0     17
5     1     0    0    21    0  435     0     0     3   61      0
6     6     0    0     1    2    0  1895     0     1    0      3
7     0     9    0    58    1    0     0  7185     6    0      4
8     0     0    1    53    7    0     0    20  3213    0      2
9    10     0    5     5    2    0     0     0     1  470      0
10    8     1    0     4   48    0     4     4    18    0  12705
---- Validation: 
scalar performance:
{'acc': 0.9865454, 'precision': 0.9605523, 'recall': 0.9569853, 'specificity': 0.9985932, 'f1': 0.9571403, 'auroc': 0.9998328}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     1    0     2    2    0     1     1     1    0      0
1     0  1322    0     3    0    0     0     6     1    0      0
2     4     0  273     1   15    0     0     0     1   17      1
3     0     0    0  8390    0    0     0    35    14    1      0
4     3     0    0     0  522    0     2     0     5    0      7
5     5     0    1    20    0  421     0     0     5   69      0
6     2     0    0     0    0    0  1899     0     3    0      4
7     0     4    1    55    1    0     0  7197     5    0      2
8     0     1    0    48    2    0     0    25  3216    0      4
9     7     0    8     1    3    2     0     1     2  469      0
10    9     1    0     5   50    0     6     5    22    0  12698
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71440566, 'precision': 0.64372146, 'recall': 0.5815484, 'specificity': 0.9713057, 'f1': 0.56975484, 'auroc': 0.87760466}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   994     0   0   32    4    0    59    44    21    3    13
1     4  1254   0   26    0    0    10   179     8    0    18
2    10     1  45   28  319    6    35    67   292   54   158
3     0     0   0    0    0    0     0     0     0    0     0
4     1     2   0    0  326    0    35     2    30    1  1236
5    13     0   4  155    6  169     5     2    28  203     7
6     0     0   0    1    0    0  3064     0     2    0     0
7     0     0   0  103    0    0     5  1046     9    0     1
8     0     0   0   55    1    2     8    16  1288    0     0
9    14     4  42  168   39   60    21   115   222  417    35
10    0     1   0    0   27    0     8     1     1    0  1608
better model found
persisted
after epoch: 24,now: 2024-07-09 02:49:33.085013,epoch time: 0:35:37.711068,used: 14:40:22.285896,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98357236, 'precision': 0.955302, 'recall': 0.94514906, 'specificity': 0.9982213, 'f1': 0.94729185, 'auroc': 0.99974227}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   481     0    0     0    1    0     0     0     0    0      1
1     0  1309    0     3    0    0     0    19     0    0      0
2     0     0  227     0    3    2     0     1     0   79      0
3     0     0    0  8334    0    9     0    79    17    0      0
4     7     0    6     0  462    2     0     0     4    4     54
5     2     0    0     2    0  500     0     0     0   17      0
6    43     0    0     4    0    0  1852     2     0    1      6
7     1     3    0    54    0    0     1  7174    22    3      6
8     5     0    0    45    2    7     1    19  3190    3     23
9     2     0    0     2    0   15     0     0     0  474      0
10   10     0    0     1    8    0     1     5     4    3  12759
---- Validation: 
scalar performance:
{'acc': 0.9839508, 'precision': 0.9586538, 'recall': 0.9450868, 'specificity': 0.99824786, 'f1': 0.9488665, 'auroc': 0.9997739}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     1    1    0     0     0     1    0      4
1     1  1309    0     5    0    0     0    14     3    0      0
2     1     0  224     0    4    5     1     0     1   74      2
3     5     0    0  8338    0    7     0    75    15    0      0
4     7     0    3     0  461    1     1     1     8    3     54
5     1     0    0     3    0  507     0     0     0   10      0
6    32     0    0     1    0    0  1862     1     0    0     12
7     1     3    0    58    0    0     0  7163    27    7      6
8     3     0    0    34    1    4     0     9  3214    3     28
9     4     0    0     1    0   14     0     0     1  473      0
10   11     0    0     3    9    0     2     4     8    1  12758
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71930313, 'precision': 0.67087156, 'recall': 0.6103624, 'specificity': 0.97192603, 'f1': 0.5910733, 'auroc': 0.8756887}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1120     0    0   9    0    0     0    17     2    8    14
1     12  1131    1  30    0    6     9   272     9    4    25
2     24     0  129  40  106   26     5    70   199  178   238
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    6   0  162    0     5     2    23    1  1432
5     21     0    1  43    0  284     0     0     0  239     4
6      4     0    0  18    0    0  2920     1     3    0   121
7      8     0    0  87    0    2     1  1057     3    5     1
8      9     0    0  80    0   37     7    18  1195   15     9
9     49     1   24  98    2  153     1    53    81  650    25
10     0     0    0   0   10    0     3     0     0    0  1633
early stop counter: 1
val acc:0.9839507937431335, best validation acc: 0.9865453839302063, corresponding to test acc:                         0.7144056558609009 / 0.7781431674957275
after epoch: 25,now: 2024-07-09 03:25:12.736552,epoch time: 0:35:39.651539,used: 15:16:01.937435,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9879869, 'precision': 0.97096086, 'recall': 0.9663904, 'specificity': 0.9986598, 'f1': 0.96848845, 'auroc': 0.9998634}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    4    1     1     0     0    0      6
1     0  1322    0     1    0    0     0     8     0    0      1
2     1     0  283     0    4    0     0     2     0   20      2
3     1     0    0  8349    0    8     0    67    11    1      1
4     3     0   14     0  479    0     1     0     2    0     40
5     0     0    0     1    0  511     0     0     1    7      1
6     7     0    0     1    0    0  1894     0     0    0      6
7     2    14    4    34    1    0     0  7195     7    0      5
8     0     1    4    61    3    0     1    24  3182    1     19
9     0     0    4     1    1   18     0     0     0  468      1
10    4     0    0     3    5    0     2     3     2    0  12773
---- Validation: 
scalar performance:
{'acc': 0.9877491, 'precision': 0.9717307, 'recall': 0.96211433, 'specificity': 0.9986216, 'f1': 0.96657073, 'auroc': 0.9998655}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     0    4    1     2     0     0    0      9
1     0  1325    0     2    0    0     0     5     0    0      0
2     0     0  287     0    4    0     0     1     0   18      2
3     0     0    1  8356    0    5     0    66     9    2      1
4     1     0    9     0  465    0     0     0     1    2     61
5     0     0    0     1    0  510     0     0     1    8      1
6     8     0    0     3    0    0  1897     0     0    0      0
7     0    11    1    35    0    0     1  7210     3    0      4
8     1     0    3    54    5    1     1    35  3177    2     17
9     0     0    5     1    0   31     1     1     0  454      0
10    3     0    0     4    4    0     2     1     3    0  12779
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71832365, 'precision': 0.658987, 'recall': 0.6129383, 'specificity': 0.97169876, 'f1': 0.59902894, 'auroc': 0.87000936}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   974     1    0   23   1   17    31    10     5   21    87
1     7  1202    2   25   0    2     7   206     4    0    44
2    12     2  222   18  90   15    10    31   151   59   405
3     0     0    0    0   0    0     0     0     0    0     0
4     1     0    5    1  97    0     5     2    16    0  1506
5     6     0    6   51   4  374     2     1     4  129    15
6     1     0    0    2   0    0  3002     0     1    0    61
7     3     0    5   30   0    1     2  1108     6    4     5
8     0     0    4  122   1   13     8    16  1198    2     6
9    11     3  159   94   6  208     3    49    79  453    72
10    0     0    0    0   7    0     2     0     0    0  1637
better model found
persisted
after epoch: 26,now: 2024-07-09 04:00:47.505679,epoch time: 0:35:34.769127,used: 15:51:36.706562,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9852847, 'precision': 0.97194827, 'recall': 0.96004826, 'specificity': 0.9983362, 'f1': 0.9654637, 'auroc': 0.99985874}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     1    4    0     2     1     0    0      4
1     0  1318    0     2    0    0     0     9     2    0      1
2     0     0  287     1    4    0     0     0     1   19      0
3     0     1    0  8413    0    4     0    18     2    0      0
4     2     0   11     1  460    0     0     0     6    2     57
5     0     0    0     1    0  514     0     0     0    5      0
6     2     0    0     4    0    0  1899     0     0    0      2
7     0     2    0   100    0    0     0  7117    34    5      7
8     1     0    1   138    1    1     0     4  3134    1     14
9     0     0    3     2    0   37     0     0     1  450      0
10    4     0    3     5    3    0     7     4     3    0  12763
---- Validation: 
scalar performance:
{'acc': 0.9854487, 'precision': 0.9713131, 'recall': 0.959225, 'specificity': 0.99835855, 'f1': 0.9646314, 'auroc': 0.99986565}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     2    3    1     1     0     0    1      2
1     0  1318    0     2    0    0     0    11     1    0      0
2     0     0  286     1    1    1     0     1     0   22      0
3     0     0    0  8420    0    3     0    15     2    0      0
4     4     0   16     0  451    0     1     0     3    2     62
5     0     0    0     3    0  514     0     0     0    4      0
6     3     0    0     2    0    0  1900     1     0    0      2
7     0     1    0    85    1    0     0  7126    44    2      6
8     1     0    0   142    1    2     0     8  3130    0     12
9     0     0    3     1    0   35     0     0     0  454      0
10    3     0    2     5    5    0     3     2     7    0  12769
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70454067, 'precision': 0.6365857, 'recall': 0.593835, 'specificity': 0.9702963, 'f1': 0.5833616, 'auroc': 0.8700284}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   819     0    0   54    5   16   105    18     3   53    97
1     2  1212    1   35    1    3     8   162    14    2    59
2     2     0  155   19  224   21    14    28   208   87   257
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    2    0  110    0    11     1    15    0  1493
5     2     0    1   40    6  369     1     1     3  168     1
6     0     0    0    2    0    0  3043     0     0    0    22
7     0     1    3  136    0    0     3  1005     9    2     5
8     0     0    0  100    4   18     6     5  1228    3     6
9     6     3  111   87   11  202     5    43   143  496    30
10    0     0    0    0    6    0     7     0     0    0  1633
early stop counter: 1
val acc:0.9854487180709839, best validation acc: 0.9877490997314453, corresponding to test acc:                         0.7183236479759216 / 0.7781431674957275
after epoch: 27,now: 2024-07-09 04:36:18.716921,epoch time: 0:35:31.211242,used: 16:27:07.917804,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9880137, 'precision': 0.9605986, 'recall': 0.96151066, 'specificity': 0.9987199, 'f1': 0.95841974, 'auroc': 0.9998913}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    2     1    3    0     4     1     0    1      9
1     0  1318    0     0    0    0     0    11     1    0      0
2     0     0  309     0    1    0     0     0     1    1      0
3     0     0    1  8364    0   17     1    41    12    0      0
4     1     0   40     0  454    1     0     1     3    1     38
5     0     0    0     0    0  514     0     0     0    7      0
6     2     0    0     1    0    0  1900     2     3    0      0
7     0     3    7    38    0    0     0  7201    12    2      2
8     0     0    2    32    1    2     1    20  3231    0      6
9     0     0   59     0    1   12     0     0     0  421      0
10    1     0    2     4    5    0     6    10    12    0  12754
---- Validation: 
scalar performance:
{'acc': 0.98761535, 'precision': 0.9621793, 'recall': 0.9628469, 'specificity': 0.9986665, 'f1': 0.96010625, 'auroc': 0.99989635}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     0    3    0     4     1     1    0     14
1     0  1317    0     1    0    0     0    14     0    0      0
2     0     0  311     0    0    0     0     1     0    0      0
3     0     0    0  8358    0   21     0    43    15    2      1
4     1     0   38     0  459    0     0     0     4    0     37
5     0     0    2     2    0  511     0     0     0    6      0
6     1     0    0     1    0    0  1900     2     1    0      3
7     0     2    8    48    0    0     0  7194    11    1      1
8     0     0    3    21    2    1     0    25  3238    0      6
9     0     0   52     0    1   10     1     0     2  427      0
10    0     0    3     2    7    0     6    13    18    0  12747
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73630446, 'precision': 0.65880346, 'recall': 0.6285056, 'specificity': 0.97330475, 'f1': 0.6171129, 'auroc': 0.8732387}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   790     0   21   7   18   14   143    75     7   47    48
1     0  1229    9   7    0    7     5   221     1    7    13
2     1     1  488   1  132   16    16    30    94   43   193
3     0     0    0   0    0    0     0     0     0    0     0
4     0     1   21   0  175    1     6     1    10    0  1418
5     3     0   27  10    2  325     3     1     2  219     0
6     0     0    1   0    0    0  3031     2     2    1    30
7     0     0    6  20    0    1     1  1132     1    2     1
8     0     0   29  15    2   31     8    36  1233    9     7
9     2     1  366   8    4  139     0    39    68  486    24
10    0     0    0   0    8    0     3     0     0    0  1635
early stop counter: 2
val acc:0.9876153469085693, best validation acc: 0.9877490997314453, corresponding to test acc:                         0.7183236479759216 / 0.7781431674957275
after epoch: 28,now: 2024-07-09 05:11:51.865636,epoch time: 0:35:33.148715,used: 17:02:41.066519,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9850439, 'precision': 0.96359926, 'recall': 0.97121316, 'specificity': 0.99834603, 'f1': 0.9669492, 'auroc': 0.99985665}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    4    0     0     0     0    0      0
1     0  1325    0     2    0    0     0     5     0    0      0
2     0     1  298     0    4    0     1     0     0    7      1
3     1     0    1  8372    0   43     0    11     4    3      5
4     4     0    1     1  492    0     0     0     1    1     39
5     0     0    0     0    0  511     0     0     0   10      0
6     4     0    0     2    1    1  1887     0     0    0     12
7     6    10    3   137    0    2     2  7069    26    4      4
8     6     0    3    95    2    8     2     6  3157    1     14
9     0     0   13     2    0   16     0     0     0  462      0
10   12     1    1     0    6    0     1     3     3    0  12766
---- Validation: 
scalar performance:
{'acc': 0.984673, 'precision': 0.96401, 'recall': 0.9674108, 'specificity': 0.9983003, 'f1': 0.9652013, 'auroc': 0.99984676}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    2    1     1     0     0    0      2
1     0  1325    0     2    0    0     0     4     1    0      0
2     0     0  295     0    8    2     0     0     0    7      0
3     0     0    0  8373    0   46     0    11     4    0      6
4     5     0    1     2  485    0     0     2     1    0     43
5     0     0    0     1    0  509     0     0     1    9      1
6     6     0    0     0    0    0  1887     0     0    0     15
7     4     8    0   145    1    3     1  7077    18    4      4
8     0     0    1    95    6   14     3     8  3161    2      6
9     2     0   15     1    0   16     0     1     1  456      1
10    8     2    1     1    5    0     4     5     3    0  12767
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68872875, 'precision': 0.64618564, 'recall': 0.5940287, 'specificity': 0.9687282, 'f1': 0.5908749, 'auroc': 0.86556906}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   944     0    0   40    7   20    37   35     4   45    38
1     5  1325    0   32    1    9     5   91     3    5    23
2     8     2  119   21  381   25     7   28    89   86   249
3     0     0    0    0    0    0     0    0     0    0     0
4     1     0    2    1  212    0     2    1    10    0  1404
5     3     0    2   35    5  320     4    0     1  219     3
6     0     0    1    4    4    2  2521    1     6    0   528
7     4     1    1  175    1    1     9  952     7    7     6
8     2     0    3   91   15   37     9    8  1175   21     9
9     8     7   83   86   29  181     2   27    37  646    31
10    0     0    0    0   13    0     2    1     0    0  1630
early stop counter: 3
val acc:0.984673023223877, best validation acc: 0.9877490997314453, corresponding to test acc:                         0.7183236479759216 / 0.7781431674957275
after epoch: 29,now: 2024-07-09 05:47:18.271790,epoch time: 0:35:26.406154,used: 17:38:07.472673,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98927116, 'precision': 0.9727786, 'recall': 0.9791542, 'specificity': 0.99887097, 'f1': 0.97582495, 'auroc': 0.99987257}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     1    1    0     1     1     0    0      0
1     0  1321    0     1    0    0     1     8     1    0      0
2     0     0  301     0    1    0     0     3     1    6      0
3     0     0    1  8368    0    3     1    40    22    0      0
4     4     0    2     0  515    0     0     0     7    3      8
5     0     0    0     4    0  507     0     0     2    8      0
6     0     0    0     0    1    0  1898     2     1    0      6
7     1     2    0    56    0    0     0  7194    10    0      1
8     0     0    0    16    3    0     0    23  3251    0      2
9     0     1    8     3    1   14     1     1     1  463      0
10    5     0    2     2   59    0     4     4    39    1  12679
---- Validation: 
scalar performance:
{'acc': 0.9887388, 'precision': 0.9707668, 'recall': 0.9771521, 'specificity': 0.9988166, 'f1': 0.9736796, 'auroc': 0.99988055}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    4    0     1     2     0    0      2
1     0  1323    0     1    0    0     0     7     1    0      0
2     0     0  291     1    1    0     0     4     2   13      0
3     0     0    0  8378    0    1     0    42    19    0      0
4     2     0    1     1  519    0     0     1     8    1      6
5     0     0    0     3    0  510     0     0     0    8      0
6     0     0    0     2    0    1  1899     1     1    0      4
7     1     1    0    52    0    0     0  7197    11    0      3
8     2     0    0    27    4    0     0    16  3244    0      3
9     0     0    6     0    0   18     0     0     2  467      0
10    6     0    2     4   71    1     1     7    42    0  12662
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.713706, 'precision': 0.65495, 'recall': 0.59912705, 'specificity': 0.9713372, 'f1': 0.5848084, 'auroc': 0.8785092}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   912     0   0  50    4    7    45    64     8   72     8
1     1  1105   0  29    0    0     1   318     7    2    36
2     5     1  90  12  180   46    17   107   262  123   172
3     0     0   0   0    0    0     0     0     0    0     0
4     1     1   2   0  291    0     9     2    31    0  1296
5     1     0   0  64    0  327     1     1     5  193     0
6     0     0   0   3    0    0  3034     2     4    0    24
7     1     0   0  99    0    0     1  1055     4    2     2
8     0     0   0  88    1    9     5    37  1221    7     2
9     4     4  45  63    8  155     6   120   152  558    22
10    0     0   0   0   30    0     7     1     0    0  1608
better model found
persisted
after epoch: 30,now: 2024-07-09 06:22:56.025822,epoch time: 0:35:37.754032,used: 18:13:45.226705,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 18:13:45.226705 at 2024-07-09 06:22:56.025822
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.713706, 'precision': 0.65495, 'recall': 0.59912705, 'specificity': 0.9713372, 'f1': 0.5848084, 'auroc': 0.8785092}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   912     0   0  50    4    7    45    64     8   72     8
1     1  1105   0  29    0    0     1   318     7    2    36
2     5     1  90  12  180   46    17   107   262  123   172
3     0     0   0   0    0    0     0     0     0    0     0
4     1     1   2   0  291    0     9     2    31    0  1296
5     1     0   0  64    0  327     1     1     5  193     0
6     0     0   0   3    0    0  3034     2     4    0    24
7     1     0   0  99    0    0     1  1055     4    2     2
8     0     0   0  88    1    9     5    37  1221    7     2
9     4     4  45  63    8  155     6   120   152  558    22
10    0     0   0   0   30    0     7     1     0    0  1608
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.77814317, 'precision': 0.7167525, 'recall': 0.65693694, 'specificity': 0.977514, 'f1': 0.6541199, 'auroc': 0.89047164}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   900     0    0   5    6    3   159    32     1   52    12
1     3  1234    0  25    4    1     1   193     5   11    22
2     6     0  133   4  427   10     8    56   109  164    98
3     0     0    0   0    0    0     0     0     0    0     0
4     1     0    0   0  720    0     2     1     6    2   901
5     0     0    0  38    5  285    11     0     5  248     0
6     0     0    0   0    1    0  3050     0     0    1    15
7     0     1    0  17    0    0     1  1141     0    3     1
8     0     0    0  52    1    9     6    23  1268    6     5
9     4     1   31  31   17   83     1    61    62  837     9
10    0     0    0   0   90    0     1     1     0    0  1554
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_12_09_10_seed_0_21725672_instance_wise_predictions.txt
accuracy from prediction file 0.7137060099349332
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_3_5/rule_results/1.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_3_5/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_3_5/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 458868 KiB |   6811 MiB |   1412 TiB |   1412 TiB |
|       from large pool | 415617 KiB |   6775 MiB |   1395 TiB |   1395 TiB |
|       from small pool |  43251 KiB |     62 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 458868 KiB |   6811 MiB |   1412 TiB |   1412 TiB |
|       from large pool | 415617 KiB |   6775 MiB |   1395 TiB |   1395 TiB |
|       from small pool |  43251 KiB |     62 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 449054 KiB |   6803 MiB |   1406 TiB |   1406 TiB |
|       from large pool | 407075 KiB |   6767 MiB |   1389 TiB |   1389 TiB |
|       from small pool |  41979 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7504 MiB |   7504 MiB |   7504 MiB |      0 B   |
|       from large pool |   7440 MiB |   7440 MiB |   7440 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 460683 KiB | 687911 KiB |   1061 TiB |   1061 TiB |
|       from large pool | 454783 KiB | 678614 KiB |   1044 TiB |   1044 TiB |
|       from small pool |   5900 KiB |  14742 KiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4556    |    6799    |  236930 K  |  236926 K  |
|       from large pool |     187    |     783    |  130600 K  |  130600 K  |
|       from small pool |    4369    |    6537    |  106330 K  |  106325 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4556    |    6799    |  236930 K  |  236926 K  |
|       from large pool |     187    |     783    |  130600 K  |  130600 K  |
|       from small pool |    4369    |    6537    |  106330 K  |  106325 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     343    |     343    |     343    |       0    |
|       from large pool |     311    |     311    |     311    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      63    |    1620    |  156339 K  |  156339 K  |
|       from large pool |      36    |     308    |  101067 K  |  101067 K  |
|       from small pool |      27    |    1584    |   55271 K  |   55271 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6811 MiB |   1412 TiB |   1412 TiB |
|       from large pool |  16640 KiB |   6775 MiB |   1395 TiB |   1395 TiB |
|       from small pool |      0 KiB |     62 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6811 MiB |   1412 TiB |   1412 TiB |
|       from large pool |  16640 KiB |   6775 MiB |   1395 TiB |   1395 TiB |
|       from small pool |      0 KiB |     62 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6803 MiB |   1406 TiB |   1406 TiB |
|       from large pool |  16640 KiB |   6767 MiB |   1389 TiB |   1389 TiB |
|       from small pool |      0 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    898 MiB |   7504 MiB |   7504 MiB |   6606 MiB |
|       from large pool |    850 MiB |   7440 MiB |   7440 MiB |   6590 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 687911 KiB |   1061 TiB |   1061 TiB |
|       from large pool |  24320 KiB | 678614 KiB |   1044 TiB |   1044 TiB |
|       from small pool |      0 KiB |  38227 KiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6799    |  236930 K  |  236930 K  |
|       from large pool |       2    |     783    |  130600 K  |  130600 K  |
|       from small pool |       0    |    6537    |  106330 K  |  106330 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6799    |  236930 K  |  236930 K  |
|       from large pool |       2    |     783    |  130600 K  |  130600 K  |
|       from small pool |       0    |    6537    |  106330 K  |  106330 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     343    |     343    |     281    |
|       from large pool |      38    |     311    |     311    |     273    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1620    |  156340 K  |  156340 K  |
|       from large pool |       3    |     308    |  101067 K  |  101067 K  |
|       from small pool |       0    |    1584    |   55272 K  |   55272 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6811 MiB |   1412 TiB |   1412 TiB |
|       from large pool |  16640 KiB |   6775 MiB |   1395 TiB |   1395 TiB |
|       from small pool |      0 KiB |     62 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6811 MiB |   1412 TiB |   1412 TiB |
|       from large pool |  16640 KiB |   6775 MiB |   1395 TiB |   1395 TiB |
|       from small pool |      0 KiB |     62 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6803 MiB |   1406 TiB |   1406 TiB |
|       from large pool |  16640 KiB |   6767 MiB |   1389 TiB |   1389 TiB |
|       from small pool |      0 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    898 MiB |   7504 MiB |   7504 MiB |   6606 MiB |
|       from large pool |    850 MiB |   7440 MiB |   7440 MiB |   6590 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 687911 KiB |   1061 TiB |   1061 TiB |
|       from large pool |  24320 KiB | 678614 KiB |   1044 TiB |   1044 TiB |
|       from small pool |      0 KiB |  38227 KiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6799    |  236930 K  |  236930 K  |
|       from large pool |       2    |     783    |  130600 K  |  130600 K  |
|       from small pool |       0    |    6537    |  106330 K  |  106330 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6799    |  236930 K  |  236930 K  |
|       from large pool |       2    |     783    |  130600 K  |  130600 K  |
|       from small pool |       0    |    6537    |  106330 K  |  106330 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     343    |     343    |     281    |
|       from large pool |      38    |     311    |     311    |     273    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1620    |  156340 K  |  156340 K  |
|       from large pool |       3    |     308    |  101067 K  |  101067 K  |
|       from small pool |       0    |    1584    |   55272 K  |   55272 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672

 Experiment start at: 2024-07-09 06:54:45.368266
before training, model accuracy: 0.10312740504741669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92348033, 'precision': 0.8195378, 'recall': 0.75817466, 'specificity': 0.99193656, 'f1': 0.73516953, 'auroc': 0.9938585}
confusion matrix:
     0     1    2     3    4   5     6     7     8    9      10
0   428     0    0     4    0   0     7     5     8    8     23
1     0  1273    0     7    0   0     1    45     4    0      2
2     3     0  144     1   10   0     3    19     8  123      1
3    10     8    0  7834    0   0     8   408   160   10      1
4    15     1  112     2  172   0     4     5    61   26    141
5     1     0    0    96    0  37     0     0     6  380      1
6    34     1    1     2    0   0  1834     3     6    9     17
7     9    52    2   146    1   0     7  6953    81    5      6
8     6     8    4   142    3   0     1   139  2971    7     14
9     4     0    9     8    0   0     0     4     8  457      3
10   89     0   35     7   39   0    28    43   131    8  12413
---- Validation: 
scalar performance:
{'acc': 0.9240872, 'precision': 0.8220007, 'recall': 0.7592358, 'specificity': 0.9920083, 'f1': 0.73389614, 'auroc': 0.99370736}
confusion matrix:
     0     1    2     3    4   5     6     7     8    9      10
0   436     0    0     2    0   0     7     8     5    9     16
1     0  1275    0    10    0   0     1    42     2    1      1
2     2     2  149     0    5   0     1    20     8  122      3
3    12     7    1  7841    0   0    11   396   159   12      1
4    12     0  120     1  157   0     3     7    57   23    159
5     1     0    1    93    0  35     0     0     8  382      1
6    35     0    2     1    1   0  1836     2     7   10     14
7     4    65    1   127    1   0     6  6956    92    8      5
8     5     4    5   145    3   0     2   126  2984    7     15
9     0     1   14    10    0   0     0     5     4  459      0
10   97     2   28     4   31   0    24    53   123   15  12419
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72972786, 'precision': 0.71653295, 'recall': 0.59589463, 'specificity': 0.97289217, 'f1': 0.55772996, 'auroc': 0.8898789}
confusion matrix:
      0     1    2   3    4   5     6     7     8    9     10
0   1115     0    0   5    0   0     0     4     6   36     4
1      4  1220    0  19    0   0     1   234     2    0    19
2     35     0  158   2   62   0     0   141   261  229   127
3      0     0    0   0    0   0     0     0     0    0     0
4      3     0    6   0  208   0     2     4    18    2  1390
5      7     0    0  78    0   3     1     0    13  489     1
6      2     0    1   1    3   0  2960     6    20    0    74
7     14     0    0  12    0   0     0  1132     0    2     4
8      7     0    0  69    0   0     3    30  1254    6     1
9     30     2   26  47    1   0     0   183    95  739    14
10     0     0    0   0    5   0     0     0     0    0  1641
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-09 07:31:50.057715,epoch time: 0:37:04.689449,used: 0:37:04.689449,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9388645, 'precision': 0.8703901, 'recall': 0.8088161, 'specificity': 0.9933666, 'f1': 0.81634444, 'auroc': 0.9965023}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   417     1    0     2    1    0     6     9     1   11     35
1     0  1286    0     6    0    0     0    33     4    0      2
2     0     3  118     0   51    0     1     9     9  121      0
3     1     4    0  7918    0   14     0   412    82    8      0
4     4     4   13     0  334    0     1     9    23   14    137
5     0     0    0    42    0  209     1     0     5  262      1
6    17     0    0    12    2    0  1808    23     7    5     33
7     1    26    0   174    3    0     1  6990    57    3      7
8     2     5    1   159   18    0     0   120  2940    9     41
9     0     0    4     7    4    6     0     5     3  464      0
10   34     1    3     7   72    0     6    30    28    7  12607
---- Validation: 
scalar performance:
{'acc': 0.9402702, 'precision': 0.8669281, 'recall': 0.8056228, 'specificity': 0.99353826, 'f1': 0.8128303, 'auroc': 0.9965307}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   410     0    0     8    3    0     7     8     3   15     29
1     0  1286    0     8    0    0     0    32     3    0      3
2     0     3  116     1   46    0     1    12     8  122      3
3     1     3    1  7980    1    6     0   370    72    5      1
4     6     4   19     1  335    0     0    12    28    7    127
5     1     0    1    40    2  202     0     0     8  265      2
6    31     2    0     7    2    0  1806    18     4    6     32
7     1    28    0   172    1    0     1  7004    49    4      5
8     2     5    2   158   19    1     0   119  2947    4     39
9     1     2    3     9    4    6     0     6     3  459      0
10   32     1    2     6   72    0    11    34    26    5  12607
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6792136, 'precision': 0.66465193, 'recall': 0.564839, 'specificity': 0.9676322, 'f1': 0.5427822, 'auroc': 0.87966645}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   871     0   0   37    0    0   131    52     1   74     4
1     1  1294   0   11    0    0     0   174     2    0    17
2     7     9  20   12  318    0     1   178   213  114   143
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    0  329    0     1     3    20    1  1278
5     1     0   0  100    6  115     1     1    20  348     0
6     0     0   0    7    7    0  2506    20    49    0   478
7     0     0   0    3    0    0     0  1159     1    0     1
8     0     0   0   85    0    0     1    56  1224    1     3
9     6    25   7   87   23   11     0   239   155  564    20
10    0     0   0    0   19    0     0     1     0    0  1626
better model found
persisted
after epoch: 2,now: 2024-07-09 08:07:27.425076,epoch time: 0:35:37.367361,used: 1:12:42.056810,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9390518, 'precision': 0.8420569, 'recall': 0.8430197, 'specificity': 0.99350154, 'f1': 0.83040977, 'auroc': 0.9963821}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     2    4     3    2    0     4     3     1   15     12
1     0  1283    0     7    0    0     0    38     3    0      1
2     0     0  261     1    7    0     2     6     0   35      0
3     3     2    3  7786    0   32     0   494   117    2      0
4     6     1  153     0  212    2     2    10    27    5    121
5     1     0    8    14    0  431     0     0     7   59      1
6    28     2    2    10    1    0  1823    24     3    3     11
7     1    38   19   111    0    0     1  7053    32    1      7
8     2     2   24   135    6    0     0   142  2955    5     25
9     0     0   98     7    1   75     2     1     3  306      0
10   35     5   46     6   48    0    17    31    46    6  12551
---- Validation: 
scalar performance:
{'acc': 0.94048417, 'precision': 0.84692216, 'recall': 0.84828573, 'specificity': 0.99364626, 'f1': 0.83542144, 'auroc': 0.9966104}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     2    5     2    1    0     2     5     1   10     19
1     0  1285    0     5    0    0     0    39     3    0      0
2     0     1  269     2    6    1     1     3     3   26      0
3     1     2    2  7810    0   28     0   466   128    3      0
4    10     2  149     2  223    2     2     8    17    1    123
5     0     0    7    11    0  430     1     0     7   64      1
6    21     4    7     7    1    1  1826    22     6    1     12
7     1    33   14   121    0    0     1  7059    30    1      5
8     6     2   20   138    9    3     0   129  2963    4     22
9     0     0   98     8    1   68     3     2     3  310      0
10   40     3   57     6   47    0    13    36    38    7  12549
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.76331073, 'precision': 0.6866855, 'recall': 0.64837396, 'specificity': 0.9761007, 'f1': 0.6369661, 'auroc': 0.88634354}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1055     7    0   4    1    0    34    13     0   51     5
1      3  1327    0  13    0    0     0   145     5    0     6
2     23     2  438   2  146    4    14    67   147   37   135
3      0     0    0   0    0    0     0     0     0    0     0
4      0     1   12   0  190    0     2     2    16    0  1410
5      1     0   11  24    1  251     4     2    14  283     1
6      0     0    0   0    0    0  3058     3     1    0     5
7      0     1    1   2    0    0     0  1158     0    1     1
8      0     0    2  27    1    2     4    44  1285    2     3
9      8     9  321  16    2   33     3    94   129  509    13
10     0     0    0   0    5    0     1     1     0    0  1639
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-09 08:45:24.012683,epoch time: 0:37:56.587607,used: 1:50:38.644417,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94994116, 'precision': 0.88504815, 'recall': 0.83866477, 'specificity': 0.99435616, 'f1': 0.8521514, 'auroc': 0.9974062}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   344     0    2     5    5    0    20     0     0    5    102
1     0  1249    3     9    0    0     2    53     2    0     14
2     0     0  257     0   16    0     1     1     2   32      3
3     1     0    2  8207    0    2    19   120    74   10      3
4     0     0   37     1  326    1     1     1     7    9    156
5     0     0    5    41    0  292     3     0     9  170      1
6     4     0    1     0    1    0  1858     0     3    0     41
7     1     9    9   194    2    0    10  6967    30    3     38
8     0     0   15   135   37    0     2    93  2899    4    109
9     0     0   73     5    1   10     0     3     2  398      1
10    1     0    2     7   50    0     6     5    10    4  12708
---- Validation: 
scalar performance:
{'acc': 0.9527083, 'precision': 0.8884569, 'recall': 0.84643865, 'specificity': 0.99467397, 'f1': 0.85936767, 'auroc': 0.99750453}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   364     0    1     1    2    0    16     1     0    6     92
1     0  1271    1    12    0    0     0    36     2    0     10
2     0     0  251     0   15    0     1     3     4   36      2
3     0     0    2  8207    0    9    20   126    69    5      2
4     0     0   36     1  343    0     0     1     7   10    141
5     0     0    4    36    0  295     0     0     8  177      1
6     5     0    1     3    2    0  1867     0     0    0     30
7     0     7    9   179    2    0    11  6987    29    2     39
8     0     0    8   124   34    0     1    92  2913    2    122
9     2     0   70     3    1   12     0     0     6  397      2
10    0     0    4     7   43    0     4     6     8    2  12722
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67109776, 'precision': 0.64908916, 'recall': 0.54898965, 'specificity': 0.9666244, 'f1': 0.52936137, 'auroc': 0.879425}
confusion matrix:
     0    1   2   3    4    5     6     7     8    9     10
0   790    0   0   6    0    0   199    14     2   45   114
1     0  961   0  18    0    0     1   392    10    0   117
2     2    0  79   6  105    3     4    84   202   77   453
3     0    0   0   0    0    0     0     0     0    0     0
4     0    0   1   0  106    0     1     1     8    0  1516
5     2    0   0  87    0  148     4     0    20  326     5
6     0    0   0   1    0    0  2914     1     0    0   151
7     0    0   0   6    0    0     3  1153     0    0     2
8     0    0   0  61    0    0     6    20  1269    1    13
9     3    0  61  62    3   21     4   171   221  527    64
10    0    0   0   0    0    0     0     1     0    0  1645
better model found
persisted
after epoch: 4,now: 2024-07-09 09:22:05.841269,epoch time: 0:36:41.828586,used: 2:27:20.473003,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95620185, 'precision': 0.8955877, 'recall': 0.8795025, 'specificity': 0.9952376, 'f1': 0.8827784, 'auroc': 0.9981263}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   400     0    0     1    0    1    17     1     0    4     59
1     0  1298    0     3    0    0     0    21     5    0      4
2     0     0  252     0    8    1     0     1     2   47      1
3     2     3    2  7885    0   43     3   272   222    4      1
4     3     0   61     0  299    3     0     2    14    7    150
5     0     0    0     6    0  459     0     0     4   51      1
6     3     0    0     2    0    0  1885     0     1    3     14
7     2    34    6    79    1    0     4  6995   119    3     22
8     0     1    7    35    8    7     1    33  3154    4     45
9     0     0   30     1    0   67     1     1     2  389      1
10    3     0    5     5   22    1     7     9    15    3  12723
---- Validation: 
scalar performance:
{'acc': 0.95591813, 'precision': 0.89451444, 'recall': 0.8780526, 'specificity': 0.9952094, 'f1': 0.8808316, 'auroc': 0.99825656}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     0    0     2    0    0    16     0     1    4     48
1     0  1289    0     5    0    0     0    27     7    0      4
2     0     0  250     0    5    1     1     1     1   51      2
3     2     3    2  7877    0   44     4   290   213    5      0
4     3     0   65     0  295    2     0     2    11    8    153
5     0     0    2     6    0  454     0     0     6   52      1
6     3     0    1     1    1    1  1883     0     1    0     17
7     1    23   11    64    2    0     3  7014   122    2     23
8     0     1    6    31    5   10     1    33  3154    4     51
9     0     0   35     3    0   67     0     1     2  385      0
10    0     0    7     7   18    1    10     5    20    4  12724
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7368642, 'precision': 0.6772684, 'recall': 0.63296115, 'specificity': 0.97324336, 'f1': 0.6100085, 'auroc': 0.88914806}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   850     1    2  17    1    1   200     5    14   51    28
1     2  1275    0   7    0    0    10   141    16    0    48
2     7     2  207   1  103   26     6    16   317   66   264
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  165    0     2     1    18    1  1445
5     3     0    0  35    0  461     1     0    12   79     1
6     0     0    0   1    0    0  3056     0     0    0    10
7     2     0    0   4    0    0    10  1133    12    0     3
8     0     0    0  17    1    9     9     0  1329    1     4
9     4     4  113  39    1  229     5    37   254  415    36
10    0     0    0   0    3    0     0     0     2    0  1641
better model found
persisted
after epoch: 5,now: 2024-07-09 09:57:46.496800,epoch time: 0:35:40.655531,used: 3:03:01.128534,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9535531, 'precision': 0.87932384, 'recall': 0.842608, 'specificity': 0.9948077, 'f1': 0.8588069, 'auroc': 0.9972949}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     2    1    0     3     2     0    0     31
1     0  1295    0     5    0    0     0    26     1    0      4
2     5     0  191     0   79    0     2     4     3   10     18
3     1     1    0  7995    0    9     1   260   162    0      9
4     6     0    4     0  294    0     0     1     8    0    226
5     5     1    5    21    3  385     0     0     6   94      1
6    13     0    0     0    2    0  1869     5     0    0     19
7     1    49    0    72    1    0     1  7032    69    0     39
8     2     1    3    45   13    1     2    68  3077    0     82
9    14     0   87     9   18   25     3     0     4  323     10
10   13     0    0     7   14    0    10     5     9    0  12735
---- Validation: 
scalar performance:
{'acc': 0.9525478, 'precision': 0.8755351, 'recall': 0.8363243, 'specificity': 0.9946996, 'f1': 0.8533506, 'auroc': 0.99723166}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     1    0     4    1    0     1     0     2    1     29
1     0  1293    0     6    0    0     0    28     2    0      3
2     4     0  187     1   83    0     1     6     4   10     16
3     1     3    0  8003    0   14     1   253   158    0      7
4     5     0    1     1  281    0     1     1    14    1    234
5     8     0    3    22    2  367     0     0     9  107      3
6    15     0    0     0    1    0  1869     5     3    0     15
7     0    56    3    73    4    0     2  7017    68    0     42
8     0     2    3    38    8    0     2    62  3085    0     96
9    11     0   85     9   15   25     2     3    10  325      8
10   12     0    1     7   13    0    10     3    10    0  12740
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7035612, 'precision': 0.5924713, 'recall': 0.5855725, 'specificity': 0.9700006, 'f1': 0.5515793, 'auroc': 0.87165254}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1111     1    0  10    0    0    19    16     3    1     9
1      0  1222    0   9    0    0     0   217     4    0    47
2     30     1   22   5  405    3    18    32   213    9   277
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    0   0   49    0     5     1     8    0  1568
5     41     0    1  90   20  310     5     2    37   78     8
6      1     0    0   0    0    0  3059     0     2    0     5
7      0     0    0   3    0    0     0  1158     2    0     1
8      1     0    0  38    2    0     6    22  1288    1    12
9     75     4  104  75  132   57    16   103   315  194    62
10     0     0    0   0    0    0     2     1     0    0  1643
early stop counter: 1
val acc:0.9525477886199951, best validation acc: 0.9559181332588196, corresponding to test acc:                         0.7368642091751099 / 0.7633107304573059
after epoch: 6,now: 2024-07-09 10:33:37.566070,epoch time: 0:35:51.069270,used: 3:38:52.197804,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.958476, 'precision': 0.9041761, 'recall': 0.8712445, 'specificity': 0.99541867, 'f1': 0.8825991, 'auroc': 0.9981551}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   428     0    0     1    0    0    19     0     0    4     31
1     0  1295    0     4    0    0     0    25     2    0      6
2     2     0  184     1   32    1     2     4     6   75      5
3    11     6    0  8019    0   34     1   180   176    7      3
4     4     0   13     0  322    0     7     1    13    8    171
5     0     0    1     9    0  432     0     0     4   74      1
6     4     0    0     0    1    1  1880     1     2    2     15
7     5    12    2    85    1    0     1  7035    90    1     31
8     0     4    0    29    7    5     2    48  3101    3     97
9     1     0   12     3    2   41     1     1     2  429      1
10   12     0    1     8   17    0    45     4     5    3  12699
---- Validation: 
scalar performance:
{'acc': 0.958486, 'precision': 0.9005113, 'recall': 0.869022, 'specificity': 0.99544823, 'f1': 0.8798617, 'auroc': 0.9982137}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    0     0    0    0    16     1     0    4     28
1     0  1295    0     2    0    0     0    24     5    0      6
2     1     0  181     0   33    2     2     0     5   84      4
3    12     1    0  8035    0   33     3   179   167    8      2
4     4     0   12     0  329    1     4     2    16    9    162
5     1     0    0     9    0  426     0     0     6   78      1
6     5     0    0     0    0    1  1886     1     3    2     10
7     3    20    2   101    1    0     1  7023    89    2     23
8     1     5    3    33    5    2     1    53  3098    2     93
9     2     0   17     4    2   49     1     1     3  414      0
10   10     0    0     7   13    2    33     4    12    3  12712
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70454067, 'precision': 0.61981034, 'recall': 0.58444995, 'specificity': 0.97002083, 'f1': 0.5500152, 'auroc': 0.878977}
confusion matrix:
      0     1   2   3   4    5     6     7     8    9     10
0   1020     0   0   4   0    0    87     9    34    6    10
1      0  1089   0  12   0    0     0   324     4    0    70
2     28     0  28   2  91    4    25    56   253   76   452
3      0     0   0   0   0    0     0     0     0    0     0
4      1     0   1   0  35    0     4     2     2    0  1588
5     19     0   0  54   0  240     1     2    41  233     2
6      0     0   0   2   0    0  3057     0     2    0     6
7      0     0   0   0   0    0     0  1158     5    0     1
8      1     0   0  10   0    0     2    23  1320    1    13
9     38     1  35  40   5   36     8   134   316  483    41
10     0     0   0   0   1    0     3     1     1    0  1640
better model found
persisted
after epoch: 7,now: 2024-07-09 11:09:55.917450,epoch time: 0:36:18.351380,used: 4:15:10.549184,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9616599, 'precision': 0.9050395, 'recall': 0.8768872, 'specificity': 0.99574757, 'f1': 0.88835686, 'auroc': 0.9983121}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     0    1    1     6     0     1    1     27
1     0  1250    0     9    0    0     3    63     5    0      2
2     1     0  202     0   55    2     1     2     2   42      5
3     4     1    1  8034    0   49    14   194   136    3      1
4     4     0    4     0  328    0     0     1    14    1    187
5     1     0    2     1    0  458     1     0     4   53      1
6    11     0    0     1    1    0  1864     0     0    1     30
7     3     9    3    67    2    0    12  7089    51    3     24
8     2     0    2    27    9    4     2    55  3131    5     59
9     3     0   26     2    4   62     0     1     0  393      2
10    9     0    2     6    9    1     3     4    10    0  12748
---- Validation: 
scalar performance:
{'acc': 0.9591547, 'precision': 0.8996965, 'recall': 0.8763673, 'specificity': 0.99548835, 'f1': 0.88565946, 'auroc': 0.9982399}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     1    2    0     6     0     0    0     22
1     0  1261    0     9    0    0     5    54     2    0      1
2     2     0  200     1   51    1     1     3     4   39     10
3     6     0    1  8003    0   50    24   206   147    3      0
4     2     0    7     0  325    1     1     1    20    1    181
5     3     0    3     5    0  449     0     0     3   57      1
6    11     0    0     1    1    1  1873     1     0    0     20
7     5     9    4    84    4    1    11  7059    55    4     29
8     2     0    4    36   15    6    10    52  3096    4     71
9     5     0   22     2    6   54     0     1     0  402      1
10   11     0    1     7   12    1     7     6    13    0  12738
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7342755, 'precision': 0.6394284, 'recall': 0.63413715, 'specificity': 0.97301096, 'f1': 0.60169184, 'auroc': 0.8784652}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1097     0   0   4    0    2    55     6     1    3     2
1      7  1195   0  21    0    0     8   206    13    0    49
2     24     0  85   2  212   26    44    36   218   59   309
3      0     0   0   0    0    0     0     0     0    0     0
4      0     0   1   0   70    0     5     2    12    0  1543
5     12     0   4  15    0  479     8     0     2   70     2
6      1     0   0   0    0    0  3062     0     0    0     4
7      6     0   0  17    0    1    13  1117     6    2     2
8      1     0   0  39    3   10    31    21  1253    2    10
9     29     1  91  52   17  169    27    82   135  493    41
10     0     0   0   0    0    0     0     1     1    0  1644
better model found
persisted
after epoch: 8,now: 2024-07-09 11:46:06.285750,epoch time: 0:36:10.368300,used: 4:51:20.917484,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96885705, 'precision': 0.9174907, 'recall': 0.8951982, 'specificity': 0.9966073, 'f1': 0.9034976, 'auroc': 0.99891317}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     3    1    0     1     0     3    1     22
1     0  1302    0     7    0    0     0    19     3    0      1
2     0     0  237     0   32    5     0     1     3   32      2
3     0     2    1  8274    0   17     0    82    59    3      0
4     3     0   16     0  368    2     0     1    27    4    118
5     0     0    0     8    0  492     0     0     4   16      1
6    13     0    0     4    2    4  1861     2     3    0     19
7     0     8    3   156    1    0     0  7031    59    0      6
8     1     0    2    62    4    4     0    31  3176    1     14
9     0     0   38     3    2  115     0     2     4  329      0
10    3     0    1     8   18    2     1    12    55    1  12690
---- Validation: 
scalar performance:
{'acc': 0.96744686, 'precision': 0.9175717, 'recall': 0.8959525, 'specificity': 0.9964436, 'f1': 0.90335584, 'auroc': 0.9988649}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     2    0    0     0     0     3    1     22
1     0  1301    0     6    1    0     0    20     4    0      0
2     1     0  241     1   27    3     0     1     5   29      4
3     1     4    1  8297    0   15     0    65    56    1      0
4     5     0   11     0  369    2     0     0    29    1    122
5     0     0    0    10    0  499     0     0     4    6      2
6    19     0    0     5    1    0  1851     1     8    1     22
7     2    19    4   165    1    0     1  7004    62    0      7
8     0     0    3    76    7    2     0    44  3146    1     17
9     0     0   41     3    0  120     0     0     4  325      0
10    7     0    4     7   22    1     1    16    58    0  12680
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7107675, 'precision': 0.6708632, 'recall': 0.6140655, 'specificity': 0.9711473, 'f1': 0.5891118, 'auroc': 0.88364637}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1019     0    1   47    2   18    17    28    13   18     7
1      0  1259    0   40    0    0     0   173     9    1    17
2      9     0  132   19   86   42     1    31   457   39   199
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    2    0  220    0     1     1    46    0  1363
5      4     0    4   75    0  457     0     0     8   41     3
6      4     0    0    1    1    0  2813     3    24    0   221
7      0     0    0   85    0    1     0  1072     5    0     1
8      0     0    0   85    0    7     1     4  1271    1     1
9      6     2  103  159    3  271     0    51   230  284    28
10     0     0    0    0   12    0     0     0     2    0  1632
better model found
persisted
after epoch: 9,now: 2024-07-09 12:22:21.246784,epoch time: 0:36:14.961034,used: 5:27:35.878518,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.970061, 'precision': 0.9255713, 'recall': 0.89714825, 'specificity': 0.9966396, 'f1': 0.9020331, 'auroc': 0.9991529}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     1    0    0     1     0     1    4      9
1     0  1300    0     5    0    0     0    23     1    0      2
2     1     0  280     0    2    1     0     1     2   25      0
3     0     0    2  8353    0    2     0    47    33    2      0
4     5     0   82     1  267    1     0     1    13    2    167
5     0     0    3    35    0  403     0     0     1   77      2
6     8     0    4     3    1    0  1876     0     3    0     13
7     0    12    9   194    1    0     1  7007    31    1      7
8     1     1    7    75    2    1     0    40  3125    1     43
9     0     0   34     1    0   25     0     1     0  432      0
10    7     0    4     6    5    0     5     8     7    2  12747
---- Validation: 
scalar performance:
{'acc': 0.9698275, 'precision': 0.9277314, 'recall': 0.8985499, 'specificity': 0.9966069, 'f1': 0.9040183, 'auroc': 0.99917763}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     3    0    0     1     1     1    3     14
1     0  1304    0     4    0    0     0    21     2    0      1
2     0     0  288     1    0    0     0     1     3   17      2
3     0     2    2  8351    0    1     1    46    36    1      0
4     4     0   74     0  278    2     0     1    11    3    166
5     0     0    2    35    0  396     0     0     3   84      1
6    15     0    3     2    0    2  1869     0     3    3     11
7     1     9    8   185    1    0     3  7016    33    0      9
8     0     1   10    92    3    0     0    40  3104    4     42
9     0     0   31     7    0   20     0     0     1  434      0
10    9     0    3     7    4    1     2     3     8    2  12757
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70712936, 'precision': 0.68299794, 'recall': 0.58252174, 'specificity': 0.9708123, 'f1': 0.5780368, 'auroc': 0.8833242}
confusion matrix:
     0     1    2    3   4    5     6    7     8    9     10
0   949     0    5   48   0    2    23   22    11   92    18
1     1  1244    0   30   0    0     2  185     5    0    32
2     5     0  253   18  55    6     2   32   226  100   318
3     0     0    0    0   0    0     0    0     0    0     0
4     0     0    1    0  58    0     1    1    15    1  1556
5     2     0    5  122   0  131     1    0     5  324     2
6     2     1    0    0   0    0  3000    1     0    0    63
7     0     0    0  230   0    0     0  929     1    2     2
8     0     0    0  115   0    1     5    6  1232    5     6
9     2     6  105  154   1   21     0   45   104  666    33
10    0     0    0    0   1    0     0    0     0    0  1645
better model found
persisted
after epoch: 10,now: 2024-07-09 12:58:34.214584,epoch time: 0:36:12.967800,used: 6:03:48.846318,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9640946, 'precision': 0.91166157, 'recall': 0.8688582, 'specificity': 0.9961551, 'f1': 0.8709602, 'auroc': 0.99888027}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   470     0   0     4    3    0     1     2     0    0      3
1     0  1284   0     6    0    0     0    40     1    0      1
2     7     0  92     0   86    1     0    15     3  105      3
3     0     0   0  8227    0    0     0   171    40    0      0
4     9     0   0     3  442    0     0     5     9    1     70
5     0     0   0    38    1  413     0     1     5   60      2
6    32     0   0     9    2    0  1846     6     2    0     11
7     0     7   0   101    2    0     1  7141     9    0      3
8     8     1   0    66    8    1     0   140  3055    2     11
9     9     0   1    12    3   33     0     4     2  429      0
10   58     0   0    11   53    1     3    12    22    0  12635
---- Validation: 
scalar performance:
{'acc': 0.96388924, 'precision': 0.9134082, 'recall': 0.8689718, 'specificity': 0.99612737, 'f1': 0.87117517, 'auroc': 0.9988746}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   471     0   0     2    1    0     1     5     0    1      2
1     0  1283   0     5    0    0     0    42     2    0      0
2     3     0  87     1   94    1     1    18     5  101      1
3     1     0   0  8223    0    1     0   176    39    0      0
4     8     0   1     2  446    1     0     1    11    3     66
5     0     0   0    51    1  408     0     0     3   57      1
6    27     0   0     7    1    0  1853     8     4    1      7
7     1     5   0   101    1    0     1  7140    11    0      5
8     2     1   0    81    6    0     0   135  3056    3     12
9     2     0   1    13    4   28     1     3     2  438      1
10   66     1   0    10   49    0     4    14    21    1  12630
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68103266, 'precision': 0.57989, 'recall': 0.55648303, 'specificity': 0.96827716, 'f1': 0.5289573, 'auroc': 0.87811136}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1051     0   0   34    0    0     0    76     7    0     2
1      5  1113   0   30    0    0     0   337     3    0    11
2    139     0   0   41  351    4     1    59   197   22   201
3      0     0   0    0    0    0     0     0     0    0     0
4      7     0   0    0  279    0     2     4    14    0  1327
5     44     0   0  259    2  177     0     2    11   93     4
6     52     0   0   24    0    0  2881     6     8    0    96
7      1     0   0   10    0    0     0  1152     0    0     1
8     11     0   0   73    0    0     0    31  1250    0     5
9    222     2   0  295   57   52     1   111   153  209    35
10     0     0   0    0   22    0     0     1     1    0  1622
early stop counter: 1
val acc:0.9638892412185669, best validation acc: 0.9698274731636047, corresponding to test acc:                         0.7071293592453003 / 0.7633107304573059
after epoch: 11,now: 2024-07-09 13:34:41.052887,epoch time: 0:36:06.838303,used: 6:39:55.684621,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97241545, 'precision': 0.93003774, 'recall': 0.9079952, 'specificity': 0.99698234, 'f1': 0.91678476, 'auroc': 0.9991779}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   414     0    1     1    1    1    27     1     0    2     35
1     0  1274    0     2    0    0     0    53     1    0      2
2     0     0  246     0   10    2     1     4     1   47      1
3     0     0    0  8298    0   25     1    69    42    3      0
4     2     0   20     0  404    2     0     7     9    3     92
5     0     0    0     5    0  504     0     0     1   10      1
6     1     0    0     1    0    1  1893     0     3    2      7
7     0     4    0   104    2    0     3  7126    17    0      6
8     0     0    0    41   10   17     0    89  3098   11     29
9     0     0    9     1    0   98     0     0     1  384      0
10    3     0    3     6   33    2     5    12    24    1  12704
---- Validation: 
scalar performance:
{'acc': 0.97030896, 'precision': 0.9206039, 'recall': 0.90337723, 'specificity': 0.9967767, 'f1': 0.9097024, 'auroc': 0.9991657}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     0    0     2    1    1    25     1     0    2     30
1     0  1279    0     2    0    0     0    48     2    0      1
2     0     0  246     0   11    1     1     2     0   51      0
3     0     0    0  8270    0   36     2    72    57    3      0
4     4     0   23     0  400    4     0     3     9    4     92
5     0     0    0     7    0  496     0     0     2   15      1
6     1     0    0     0    0    1  1892     0     3    0     11
7     0     3    3   115    0    0     5  7109    23    1      6
8     0     1    1    47    7   21     0    81  3098    9     31
9     0     0   16     1    0  108     0     2     0  365      1
10    0     0    5     7   37    1     5    14    27    1  12699
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7112573, 'precision': 0.68159425, 'recall': 0.5989925, 'specificity': 0.9708649, 'f1': 0.5836413, 'auroc': 0.88649595}
confusion matrix:
     0    1    2   3    4    5     6     7     8    9     10
0   832    1    0  11    0    4   164    83    14   22    39
1     0  792    0  16    0    0     0   650    15    0    26
2     8    0  107   7  104   15     9   119   286  106   254
3     0    0    0   0    0    0     0     0     0    0     0
4     0    0    2   0  420    0     2     5    34    1  1169
5     4    0    1  32    1  345     0     4     8  195     2
6     2    0    0   0    0    0  3052     2     1    0    10
7     0    0    0  13    0    0     0  1149     0    1     1
8     0    0    0  42    0    3     5    37  1277    4     2
9     6    0   36  50    1  122     0   185   132  581    24
10    0    0    0   0   33    0     0     1     1    0  1611
better model found
persisted
after epoch: 12,now: 2024-07-09 14:10:45.312797,epoch time: 0:36:04.259910,used: 7:15:59.944531,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9720944, 'precision': 0.9274875, 'recall': 0.9125783, 'specificity': 0.99692583, 'f1': 0.91761017, 'auroc': 0.999225}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     2    2    0     6     0     1    0     26
1     0  1313    0     0    0    0     1    14     4    0      0
2     1     0  282     0   14    0     2     0     1    8      4
3     0     2    2  8302    0    6     6    75    44    1      0
4     3     0   29     0  378    2     0     0     6    2    119
5     0     0    2    29    1  464     1     0     1   22      1
6     6     0    0     1    0    0  1887     0     2    0     11
7     6    19   12   105    2    0     3  7014    88    1     13
8     1     0    7    95   11    0     0    11  3146    3     22
9     1     0   48     4    6   60     2     1     1  367      3
10    2     1    2     7   20    1     8     3    14    0  12734
---- Validation: 
scalar performance:
{'acc': 0.97260934, 'precision': 0.93049717, 'recall': 0.9175934, 'specificity': 0.9969891, 'f1': 0.92218375, 'auroc': 0.9992196}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    0     1    2    0    14     0     0    0     15
1     0  1311    0     2    0    1     0    16     2    0      0
2     0     0  288     0    9    1     0     0     0   11      3
3     3     2    0  8288    0    7     3    89    46    2      0
4     3     0   25     0  391    0     0     0     5    1    114
5     0     0    0    27    0  462     1     0     2   28      1
6     4     0    0     1    1    0  1890     0     0    0     12
7     6    17    9   107    1    0     1  7020    85    1     18
8     0     0    1    89   11    0     1    17  3157    3     17
9     5     0   42     4    6   65     0     0     2  369      0
10    4     0    2     7   18    1     8     2    20    0  12734
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7185336, 'precision': 0.6557032, 'recall': 0.6017321, 'specificity': 0.97153854, 'f1': 0.58427095, 'auroc': 0.87978184}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   908     0    0    5    3    2   174    24    29    3    22
1     3  1324    0   16    0    0     0   123    17    0    16
2     9     0  121   16  136   18     7    34   346   49   279
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    0    0  120    0     2     0    26    0  1484
5     8     0    0  116    0  322     9     1    16  118     2
6     1     0    0    0    0    0  3055     0     1    0    10
7     1     0    0   40    0    0     0  1115     7    0     1
8     0     0    0   74    0    1     9     4  1281    0     1
9    17     4   93  113    9  114    20    68   278  384    37
10    0     0    0    0    6    0     0     0     0    0  1640
better model found
persisted
after epoch: 13,now: 2024-07-09 14:47:05.543135,epoch time: 0:36:20.230338,used: 7:52:20.174869,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9703018, 'precision': 0.91625834, 'recall': 0.93040746, 'specificity': 0.9969235, 'f1': 0.919554, 'auroc': 0.9992077}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     2    0    0     6     1     1    0      3
1     0  1303    0     6    0    0     0    21     2    0      0
2     1     0  262     1   16    2     1     4     3   22      0
3     0     0    0  8370    0    0     0    38    30    0      1
4     5     0    9     2  480    4     1     5    17    0     15
5     0     0    0     8    1  505     1     0     1    5      0
6     2     0    0     1    0    0  1897     2     3    0      2
7     0     7    2   165    1    0     1  7054    30    0      3
8     0     1    1   101    1    0     0    33  3153    0      5
9     0     0   18     9    3  112     1     2     5  343      0
10   31     2    6     7  217    2    22     9    68    0  12430
---- Validation: 
scalar performance:
{'acc': 0.9713789, 'precision': 0.9153501, 'recall': 0.93018544, 'specificity': 0.99705887, 'f1': 0.9188516, 'auroc': 0.9992199}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     3    0    1     8     1     1    0      2
1     0  1306    0     5    0    0     0    19     2    0      0
2     0     0  259     2   16    5     2     2     3   23      0
3     0     0    0  8378    0    1     0    32    29    0      0
4     7     0   10     1  488    1     1     1    16    0     14
5     1     0    0     9    0  500     0     0     6    4      1
6     1     1    0     0    0    0  1895     3     4    0      4
7     0    10    1   152    1    0     1  7072    25    0      3
8     0     1    1    77    1    0     0    32  3182    0      2
9     0     0   22     5    0  117     1     2     4  342      0
10   27     6    5     7  223    1    15    14    72    0  12426
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7329462, 'precision': 0.6775256, 'recall': 0.6191622, 'specificity': 0.97327614, 'f1': 0.60337675, 'auroc': 0.8875457}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   915     2    0   30    0    3   141    41    28    6     4
1     1  1236    0   23    1    0     0   224     7    0     7
2    19     1  102   32  190   34    24    76   378   29   130
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    1    0  595    0     5     1    36    0   994
5    13     0    1   98    0  421     3     2    18   35     1
6     5     0    0    5    0    0  3017     2     9    0    29
7     0     0    0   22    0    0     0  1139     1    0     2
8     0     0    0   90    0    2     2    23  1253    0     0
9    12     2   79  253    6  190    11   133   211  217    23
10    0     0    0    0   61    0     3     0     1    0  1581
early stop counter: 1
val acc:0.9713789224624634, best validation acc: 0.9726093411445618, corresponding to test acc:                         0.7185335755348206 / 0.7633107304573059
after epoch: 14,now: 2024-07-09 15:23:15.483832,epoch time: 0:36:09.940697,used: 8:28:30.115566,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97707087, 'precision': 0.9453723, 'recall': 0.93271697, 'specificity': 0.9974167, 'f1': 0.9382789, 'auroc': 0.99950993}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   422     0    0     3    6    0     7     1     1    2     41
1     0  1308    1     1    0    1     0    15     1    0      4
2     0     0  285     1    7    0     0     2     1   16      0
3     0     2    0  8308    0    7     0    52    64    4      1
4     0     0   17     0  420    0     0     2     3    2     95
5     0     0    1     7    0  478     0     0     2   32      1
6     2     0    0     5    2    0  1883     0     0    1     14
7     0    15    3    95    1    0     0  7110    28    0     11
8     0     0    7    43   14    4     0    27  3132    9     58
9     0     0   24     0    4   23     0     0     0  442      0
10    0     0    2     6   29    0     8    10     9    0  12731
---- Validation: 
scalar performance:
{'acc': 0.97678214, 'precision': 0.9418939, 'recall': 0.9312274, 'specificity': 0.9973892, 'f1': 0.9357437, 'auroc': 0.999464}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   427     0    0     0    7    0     5     1     1    1     41
1     0  1316    0     1    0    0     0    11     1    0      3
2     0     0  282     0    5    0     2     1     0   21      1
3     0     1    1  8307    1    9     0    52    68    1      0
4     0     0   19     0  425    0     0     1     0    0     94
5     0     0    2     3    0  468     0     0     0   47      1
6     3     0    0     1    2    0  1884     2     1    0     15
7     0    12    3   118    1    0     0  7091    25    1     14
8     0     0    9    44   17    7     0    22  3133   10     54
9     0     0   27     0    2   23     1     0     0  437      3
10    1     0    2     7   19    0     9     6     5    0  12747
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70384103, 'precision': 0.63884395, 'recall': 0.593332, 'specificity': 0.9701958, 'f1': 0.5811194, 'auroc': 0.8765623}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   981     6    1  45    4    1    48    26    14    7    37
1     1  1226    0  18    0    0     0   169    12    1    72
2     1     1  162  10  134    9     3    44   241   73   337
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    2   1   62    0     0     1    14    0  1553
5     5     0   16  67    4  237     2     0     2  257     2
6     0     0    0   2    0    0  2834     1     1    0   229
7     1     0    0  80    0    0     0  1079     2    0     2
8     0     0    0  65    1    4     1    15  1277    1     6
9     4     2  150  98    9   78     2    61   132  557    44
10    0     0    0   0    0    0     1     0     0    0  1645
better model found
persisted
after epoch: 15,now: 2024-07-09 15:59:28.576837,epoch time: 0:36:13.093005,used: 9:04:43.208571,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97955906, 'precision': 0.94536483, 'recall': 0.9512872, 'specificity': 0.9978198, 'f1': 0.94798833, 'auroc': 0.99958533}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     0    1    0    14     0     0    0      1
1     0  1313    0     0    0    0     0    18     1    0      0
2     0     0  285     1    5    1     0     1     2   17      0
3     0     3    0  8335    0   15     1    66    17    1      0
4     5     0   14     0  478    0     0     1     9    3     29
5     0     0    1     7    0  498     0     0     0   15      0
6     4     0    0     2    0    0  1888     5     1    0      6
7     2    12    0    99    2    0     1  7115    30    0      4
8     0     2    2    88    3    7     0    40  3142    2     10
9     0     0   18     1    0   51     0     1     0  421      1
10    8     0    3     7   59    1    19     3    21    0  12671
---- Validation: 
scalar performance:
{'acc': 0.9787348, 'precision': 0.9386865, 'recall': 0.94482756, 'specificity': 0.99774563, 'f1': 0.94157356, 'auroc': 0.99957055}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     1    2    1    12     0     1    0      3
1     0  1315    0     2    0    0     0    14     1    0      0
2     1     0  273     1    7    0     0     2     2   25      1
3     0     1    0  8334    0   16     0    70    18    0      1
4     5     0    8     0  486    0     0     2     6    2     30
5     0     0    3     5    0  479     0     0     1   32      1
6     2     0    1     3    0    0  1891     5     2    0      4
7     1    10    0    95    1    1     1  7125    26    0      5
8     1     3    4    78    7    5     1    37  3147    2     11
9     0     0   17     1    1   53     0     3     0  418      0
10   14     1    1     4   66    1    20     7    22    1  12659
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7321766, 'precision': 0.6487284, 'recall': 0.6191423, 'specificity': 0.97302145, 'f1': 0.59956133, 'auroc': 0.8799381}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   963     4    0   8    1    1   107    51     6   25     4
1     1  1273    0   7    1    0     0   194     4    0    19
2    14     3  168   9  184   26    10    70   337   59   135
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  271    0     3     2    39    0  1318
5     5     0   12  33    3  345     0     1     8  185     0
6     0     0    0  20    0    0  3009     5     6    0    27
7     0     0    0  14    0    0     0  1144     5    0     1
8     0     0    0  48    1    6     1    27  1283    1     3
9     6     3  119  76   12  193     0   114   214  379    21
10    0     0    0   0   13    0     2     1     0    0  1630
better model found
persisted
after epoch: 16,now: 2024-07-09 16:35:26.531925,epoch time: 0:35:57.955088,used: 9:40:41.163659,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9729238, 'precision': 0.9394918, 'recall': 0.9234594, 'specificity': 0.99706346, 'f1': 0.9302411, 'auroc': 0.9994879}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     0    3     0    5    1     6     1     5    9     41
1     0  1308    0     5    0    0     0    15     2    0      2
2     0     0  243     0    2    3     0     0     2   62      0
3     0     0    0  8315    0    4     0    51    67    2      0
4     0     0   25     1  449    0     0     0    16    5     43
5     0     0    0     5    0  498     0     0     5   12      0
6     1     0    1     2    0    1  1883     3     3    0     14
7     0     6    2   245    0    0     0  6913    90    3      4
8     0     0    0    49    0    1     0     6  3236    0      4
9     0     0    5     0    0   63     0     0     3  422      0
10    0     0    0     5   37    0     3     9    52    0  12685
---- Validation: 
scalar performance:
{'acc': 0.9721546, 'precision': 0.94016254, 'recall': 0.924008, 'specificity': 0.99695796, 'f1': 0.9309448, 'auroc': 0.9994516}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     0    0     2    3    0     3     5     2    9     47
1     0  1305    0     5    0    0     0    16     4    0      2
2     0     0  243     0    1    2     0     1     6   58      1
3     0     0    0  8335    0    5     0    44    54    2      0
4     0     0   24     0  449    0     0     1    17    2     46
5     0     0    0     7    0  496     0     0     5   13      0
6     0     0    2     4    2    2  1881     2     3    1     11
7     0     5    3   278    0    0     0  6888    86    0      5
8     0     0    0    51    2    2     0     7  3227    2      5
9     0     0    2     1    0   52     0     0     6  432      0
10    0     0    2     4   54    0     3     9    47    1  12676
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64975864, 'precision': 0.6415702, 'recall': 0.55883145, 'specificity': 0.96478254, 'f1': 0.551003, 'auroc': 0.8756448}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   701     0    6   30   17   18    75    93    62  108    60
1     0  1132    0   31    1    0     1   247    17    0    70
2     1     0  151   23  161    9     3    43   359   58   207
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    2    0  215    0     0     2    27    0  1387
5     0     0    2   98    0  302     0     1    21  166     2
6     1     0    1    3    3    0  2360     3    20    0   676
7     0     0    0   64    0    0     0  1092     7    0     1
8     0     0    0   68    0    0     1     6  1290    2     3
9     2     0   88  158    4  107     0    56   293  409    20
10    0     0    0    0   10    0     0     0     1    0  1635
early stop counter: 1
val acc:0.9721546173095703, best validation acc: 0.9787347912788391, corresponding to test acc:                         0.7321766018867493 / 0.7633107304573059
after epoch: 17,now: 2024-07-09 17:12:01.044187,epoch time: 0:36:34.512262,used: 10:17:15.675921,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.980442, 'precision': 0.94360286, 'recall': 0.9492959, 'specificity': 0.9979155, 'f1': 0.9459293, 'auroc': 0.9996371}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    0     1    3    1    19     2     0    7     15
1     0  1281    1     5    0    0     2    38     0    0      5
2     0     0  283     0    5    1     0     0     0   23      0
3     0     0    0  8266    0   17     0   106    41    5      0
4     3     0   14     0  481    1     1     0     2    3     33
5     0     0    0     0    0  485     0     0     0   36      0
6     0     0    0     2    1    0  1897     3     0    2      3
7     0     1    2    44    0    0     1  7183    20    2     11
8     0     0    2    32   21    6     1    25  3182    7     19
9     0     0   11     0    0   25     0     0     0  457      0
10    4     0    2     6   65    1     9     3     8    2  12695
---- Validation: 
scalar performance:
{'acc': 0.979136, 'precision': 0.937199, 'recall': 0.9416457, 'specificity': 0.9977907, 'f1': 0.93877447, 'auroc': 0.9996276}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   428     0    1     1    3    0    23     2     0    8     17
1     0  1289    1     2    0    0     1    35     0    0      4
2     0     0  266     0    6    1     0     1     0   38      0
3     0     0    0  8250    1   21     0   117    44    7      0
4     4     0   17     0  481    1     1     0     1    4     30
5     0     0    0     0    0  492     1     0     0   28      0
6     0     0    0     4    0    0  1898     0     0    0      6
7     1     1    2    37    2    0     1  7192    15    2     12
8     0     0    2    38   21    7     6    27  3171    8     16
9     0     0   11     0    0   38     0     0     1  443      0
10    2     0    3     6   60    0    11     6    10    3  12695
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70111245, 'precision': 0.6507017, 'recall': 0.58958256, 'specificity': 0.9697522, 'f1': 0.57583374, 'auroc': 0.87844557}
confusion matrix:
     0    1    2   3    4    5     6     7     8    9     10
0   676    0    0  18    3    3   207   101    44  101    17
1     0  919    0  23    0    1     8   462    12    1    73
2     4    0  195  12  182   26    50    59   214  102   171
3     0    0    0   0    0    0     0     0     0    0     0
4     0    0    0   0  265    0     5     1    23    1  1338
5     1    0    0  55    2  343     4     2     7  178     0
6     0    0    0   6    0    0  3045     1     1    0    14
7     0    0    0   9    0    0     1  1148     2    1     3
8     0    0    1  47    0    9     7    20  1278    4     4
9     2    0   96  67    8  192    11    90   126  520    25
10    0    0    0   0   11    0     2     0     1    0  1632
better model found
persisted
after epoch: 18,now: 2024-07-09 17:48:20.052684,epoch time: 0:36:19.008497,used: 10:53:34.684418,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9799604, 'precision': 0.94658023, 'recall': 0.93785095, 'specificity': 0.99785507, 'f1': 0.9405012, 'auroc': 0.9995626}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     1    0    0     3     0     0    0      4
1     0  1317    0     0    0    0     1    13     1    0      0
2     2     0  293     0   11    0     0     4     1    0      0
3    12     1    0  8305    0    1    10    78    31    0      1
4     4     1   11     0  468    0     3     2    13    1     36
5     3     0    2    52    0  427     0     0     5   31      1
6     2     0    0     0    0    0  1901     0     0    0      4
7     3    15    0    55    0    0     5  7167    12    0      6
8     1     0    0    39    3    0     1    60  3186    0      6
9     3     1   60    13    1   19     1     4     3  388      0
10   13     3    1     3   21    0    11     7    33    0  12700
---- Validation: 
scalar performance:
{'acc': 0.9790023, 'precision': 0.9464734, 'recall': 0.9413559, 'specificity': 0.99775887, 'f1': 0.9425936, 'auroc': 0.9995677}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    1    0     1     0     1    0      2
1     0  1319    0     0    0    0     0    12     1    0      0
2     2     0  293     0   11    0     0     4     1    1      0
3     9     0    0  8291    0    2    10    86    41    0      1
4     9     0    9     0  471    0     1     3    15    0     31
5     2     0    1    48    0  435     0     1     5   29      0
6     4     0    0     0    0    0  1898     0     3    0      3
7     3    18    0    61    0    0     4  7162    12    0      5
8     1     1    0    44    4    0     4    75  3161    0      6
9     3     0   55    11    0   17     0     3     2  401      1
10   15     1    0     3   29    0    11     6    40    0  12691
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72727907, 'precision': 0.6481121, 'recall': 0.5991349, 'specificity': 0.9725338, 'f1': 0.58262986, 'auroc': 0.8819885}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1034     6    0    8    0    0    90    16     2    9     5
1      1  1308    0   18    1    1     1   149     7    0    13
2     16     8  114   13  166   12    23    95   353   45   170
3      0     0    0    0    0    0     0     0     0    0     0
4      0     1    0    0  293    0     1     2    28    1  1307
5     13     0    6  125    2  204     9     4    33  193     3
6      0     0    0    1    0    0  3053     1     1    0    11
7      3     1    0   20    0    0     1  1135     0    0     4
8      0     0    0   48    1    1    15    26  1279    0     0
9     22    11  124  130    9   73    16   148   232  345    27
10     0     0    0    0   13    0     2     0     1    0  1630
early stop counter: 1
val acc:0.9790022969245911, best validation acc: 0.9791359901428223, corresponding to test acc:                         0.7011124491691589 / 0.7633107304573059
after epoch: 19,now: 2024-07-09 18:48:02.180618,epoch time: 0:59:42.127934,used: 11:53:16.812352,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9797731, 'precision': 0.9482602, 'recall': 0.95384663, 'specificity': 0.997893, 'f1': 0.95041955, 'auroc': 0.99973106}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    2    0     0     0     3    0      4
1     0  1318    0     0    0    0     0    12     2    0      0
2     0     0  268     1   31    0     0     0     2    9      1
3     0     3    0  8236    0    6     0    37   157    1      0
4     5     0    1     0  496    0     0     0    10    0     27
5     0     0    0     1    0  502     0     0     6   12      0
6    24     0    0     1    1    0  1846     0     3    0     33
7     0     8    0    69    2    0     0  7093    85    0      5
8     2     0    0    11    3    0     0     6  3269    0      2
9     0     0   30     2    3   22     1     0     4  431      0
10    7     0    1     3   58    0     2     5    30    0  12687
---- Validation: 
scalar performance:
{'acc': 0.98058045, 'precision': 0.9517164, 'recall': 0.9540642, 'specificity': 0.9979659, 'f1': 0.95242363, 'auroc': 0.99971807}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    1    0     0     0     4    0      4
1     0  1318    0     1    0    0     0    10     3    0      0
2     0     0  271     0   30    0     1     0     2    5      3
3     2     1    0  8245    0    3     0    33   153    3      0
4     3     0    0     0  498    0     0     0    10    0     28
5     1     0    0     3    0  490     0     0     4   23      0
6    15     0    0     2    2    0  1859     0     2    0     28
7     1     7    0    71    3    0     0  7099    77    0      7
8     0     0    0     8    0    0     0     8  3276    0      4
9     0     0   29     0    5   21     0     1     5  432      0
10    3     0    0     8   52    0     1     5    30    0  12697
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6345764, 'precision': 0.6236928, 'recall': 0.5463458, 'specificity': 0.9631973, 'f1': 0.5288477, 'auroc': 0.8645528}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   917     3   1   40    2    1     9    90    79   10    18
1     0  1167   0   28    0    0     0   252    16    0    36
2    19     2  46   13  160    6     0    28   421   36   284
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   1    0  312    0     0     1    37    0  1281
5    18     0   9  132    8  232     0     1    45  139     8
6    32     0   0    9    3    0  2070     1    28    0   924
7     2     0   0   27    0    0     1  1113    16    0     5
8     0     0   0   39    1    0     3     7  1316    1     3
9    25     3  63  109   28   70     2    24   477  276    60
10    0     0   0    0   21    0     0     0     4    0  1621
better model found
persisted
after epoch: 20,now: 2024-07-09 19:39:25.610845,epoch time: 0:51:23.430227,used: 12:44:40.242579,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98089683, 'precision': 0.9400059, 'recall': 0.9407153, 'specificity': 0.9979812, 'f1': 0.9392793, 'auroc': 0.99967873}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     4    0    0     0     0     1    1      2
1     0  1306    0    10    0    0     0    16     0    0      0
2     0     0  254     1    1    2     0     2     2   48      2
3     0     0    0  8405    0    5     0    17    11    0      0
4     6     0   34     0  464    3     0     0     5    4     23
5     0     0    0     5    0  515     0     0     0    1      0
6     4     0    0     1    0    3  1896     0     1    0      3
7     0     4    1   155    0    0     1  7079    14    0      5
8     0     0    0    60    1    3     0    16  3212    0      4
9     0     0    2     1    0  100     0     0     0  390      0
10    5     0    3     5   56    2     7     3    46    2  12666
---- Validation: 
scalar performance:
{'acc': 0.98095495, 'precision': 0.94292504, 'recall': 0.9427674, 'specificity': 0.99798274, 'f1': 0.94174266, 'auroc': 0.9996376}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     1    0    0     2     0     2    1      5
1     0  1306    0    10    0    0     0    15     0    0      1
2     0     0  266     1    0    5     0     2     0   36      2
3     0     0    0  8403    0    1     0    21    15    0      0
4     7     0   27     1  468    1     1     0     8    5     21
5     0     0    0     8    0  512     0     0     0    1      0
6     4     0    0     1    0    2  1895     0     1    0      5
7     0     3    1   140    0    0     1  7090    22    1      7
8     0     0    0    60    1    5     1    14  3209    2      4
9     0     0    5     1    0  102     0     0     0  385      0
10    5     0    3     6   55    0     8     6    45    1  12667
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7205625, 'precision': 0.68064463, 'recall': 0.60730076, 'specificity': 0.97231007, 'f1': 0.6031332, 'auroc': 0.8813606}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   827     1    1   99    2   15    84   51    32   41    17
1     1  1295    1   48    2    0     2  126     9    1    14
2    15     0  159   45  192   65     2   47   305   87    98
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    6    0  380    0     6    1    39    0  1201
5     5     0    1   90    2  393     0    0     3   96     2
6     2     0    0   25    0    0  3023    0     2    0    15
7     1     1    0  160    0    1     0  996     2    0     3
8     1     0    0  116    0   13     4    5  1229    2     0
9     5     6   36  216    8  282     1   41   138  385    19
10    0     1    0    0   30    1     2    0     0    0  1612
better model found
persisted
after epoch: 21,now: 2024-07-09 20:18:14.730083,epoch time: 0:38:49.119238,used: 13:23:29.361817,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98557895, 'precision': 0.96492445, 'recall': 0.95264137, 'specificity': 0.9984532, 'f1': 0.9581247, 'auroc': 0.9997902}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    3    0     1     1     1    0      6
1     0  1312    0     2    0    0     0    18     0    0      0
2     0     0  256     0   25    1     0     3     4   21      2
3     0     0    0  8318    1    2     0    28    87    0      0
4     3     0    0     0  493    0     0     1     3    0     38
5     0     0    0     2    2  497     0     0     2   18      0
6     4     0    0     4    1    0  1892     3     1    0      2
7     1     1    1    81    0    0     0  7150    25    0      4
8     0     0    0    10    6    1     0    10  3257    0     12
9     4     0    6     2    2   39     0     2     3  434      1
10    3     0    1     1   10    0     0     6    17    0  12757
---- Validation: 
scalar performance:
{'acc': 0.98531497, 'precision': 0.9627273, 'recall': 0.95043504, 'specificity': 0.9984274, 'f1': 0.9557892, 'auroc': 0.9997867}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    1     1    2    0     0     1     0    0      9
1     0  1311    0     2    0    0     0    19     0    0      0
2     0     0  248     0   30    0     0     2     4   27      1
3     0     0    0  8323    0    1     0    31    85    0      0
4     3     0    1     0  484    0     0     1     1    0     49
5     0     0    0     2    0  496     0     0     3   20      0
6     3     0    0     4    1    0  1894     1     2    1      2
7     0     3    0    65    1    0     1  7156    33    1      5
8     0     0    1    10   10    1     0    11  3255    0      8
9     1     0    3     1    2   37     0     1     1  447      0
10    3     0    3     2   14    0     3     6    12    0  12753
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71965295, 'precision': 0.62359244, 'recall': 0.60501647, 'specificity': 0.97177255, 'f1': 0.5787918, 'auroc': 0.8765405}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1020     1    6  12   11    3    38    36     8   15    20
1      0  1216    0  13    1    0     1   250     7    0    11
2      8     1   79   7  323   15     0    65   330   24   163
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    0   0  237    0     1     3    23    0  1368
5      8     0    7  66   11  343     0     2    30  124     1
6      6     0    0   2    0    0  3005     3     2    0    49
7      0     0    0  34    0    0     0  1127     2    0     1
8      0     0    0  20    1    2     0    13  1334    0     0
9     13     2  110  56   40  153     0   128   323  289    23
10     0     0    0   0    8    0     1     1     0    0  1636
better model found
persisted
after epoch: 22,now: 2024-07-09 20:54:19.066657,epoch time: 0:36:04.336574,used: 13:59:33.698391,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9877461, 'precision': 0.96815556, 'recall': 0.9773021, 'specificity': 0.9986762, 'f1': 0.9724769, 'auroc': 0.99987155}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    4    0     0     0     0    0      3
1     0  1314    0     1    0    0     0    15     1    0      1
2     0     0  301     0    1    0     0     0     0    7      1
3     1     0    0  8335    2    4     0    78    13    2      2
4     2     0    3     0  522    0     1     0     1    0     10
5     0     0    0     7    0  498     0     0     0   16      0
6     6     0    0     3    1    0  1893     0     0    0      5
7     0     5    2    31    0    0     0  7215     7    2      3
8     0     0    3    52    7    1     0    38  3179    3     13
9     2     0   16     0    1    5     0     0     0  469      0
10    4     0    1     6   49    1     4     2     8    1  12716
---- Validation: 
scalar performance:
{'acc': 0.9864384, 'precision': 0.96101725, 'recall': 0.9729586, 'specificity': 0.99855554, 'f1': 0.9665661, 'auroc': 0.9998443}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    4    0     0     1     0    0      5
1     0  1314    0     1    0    0     0    17     0    0      0
2     1     0  304     0    4    0     0     0     0    2      1
3     0     0    0  8329    0    4     1    96     7    3      0
4     3     0    5     0  514    1     0     0     2    0     14
5     0     0    0     7    0  488     0     0     2   23      1
6     6     0    0     2    0    0  1894     1     1    0      4
7     0     4    1    28    1    0     0  7213    13    0      5
8     0     0    7    44    9    3     0    37  3184    6      6
9     2     0   19     0    0    8     0     0     0  464      0
10    3     0    2     4   68    0     2     0    14    2  12701
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7511369, 'precision': 0.67893827, 'recall': 0.6429322, 'specificity': 0.97501516, 'f1': 0.6346817, 'auroc': 0.88490504}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1065     1    2  14    6    8     4    32    13   20     5
1      1  1204    0  15    1    0     0   255     7    0    16
2      8     1  148  11  381   17     1    79   156  124    89
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    0   0  576    0     1     2    17    1  1035
5      3     0    4  39    6  303     0     1     3  232     1
6     27     0    1   4   14    0  2803     2     4    0   212
7      1     0    0  22    0    0     0  1133     2    3     3
8      1     0    3  59    2   12     1    31  1251    9     1
9     11     2   73  50   18  113     0    84   106  659    21
10     0     0    0   0   52    0     0     0     0    0  1594
better model found
persisted
after epoch: 23,now: 2024-07-09 21:30:22.780595,epoch time: 0:36:03.713938,used: 14:35:37.412329,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97848886, 'precision': 0.9518349, 'recall': 0.9316941, 'specificity': 0.99763906, 'f1': 0.93984824, 'auroc': 0.99961525}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    1     4    5    0     0     4     0    3     18
1     0  1295    0     1    0    0     0    34     1    0      1
2     0     0  272     0    0    1     0    16     5   17      1
3     0     0    0  8307    0    1     0   105    24    0      0
4     1     1   22     0  472    0     0     6    10    1     25
5     0     0    0    44    0  393     0     0     6   77      1
6    13     0    1     3    1    1  1833    12     4    1     39
7     0     1    0    47    0    0     0  7208     5    0      3
8     1     1    0    69    0    0     0    43  3177    0      5
9     0     0   14     7    0    3     0     0     0  469      0
10    2     0    0     1   41    0     0     7    43    0  12698
---- Validation: 
scalar performance:
{'acc': 0.9784405, 'precision': 0.952991, 'recall': 0.93175876, 'specificity': 0.9976402, 'f1': 0.9402103, 'auroc': 0.99954146}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    2     2    5    1     0     2     1    1     19
1     0  1292    0     4    0    0     0    35     0    0      1
2     0     0  272     2    3    0     0    11     3   20      1
3     0     0    0  8307    0    0     1   111    21    0      0
4     2     0   17     0  487    0     0     2    14    0     17
5     0     0    1    52    0  380     0     1     5   81      1
6    13     0    1     3    1    1  1842    14     2    0     31
7     0     3    0    53    0    0     0  7196     7    0      6
8     0     0    0    64    0    0     0    51  3179    0      2
9     0     0    9     6    0    6     0     4     2  466      0
10    1     1    3     1   34    0     0     6    42    0  12708
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5506192, 'precision': 0.6198479, 'recall': 0.48235387, 'specificity': 0.9549295, 'f1': 0.46228236, 'auroc': 0.8613883}
confusion matrix:
     0    1   2    3    4    5     6     7     8    9     10
0   754    0  12   38    3    1     4   254    20   45    39
1     1  905   0   21    0    0     0   527     6    0    39
2     8    0  54   32   87    3     0   180   405   84   162
3     0    0   0    0    0    0     0     0     0    0     0
4     0    1   0    0  285    0     0     4    70    1  1272
5     1    0   8  159    3  109     0    13    31  263     5
6    42    0   0    8    1    1  1410    17    25    0  1563
7     0    0   0    7    0    0     0  1153     2    0     2
8     0    0   0  118    0    0     0    62  1188    1     1
9     8    1  45  190    2   20     0   287   165  390    29
10    0    0   0    0   22    0     0     1     1    0  1622
early stop counter: 1
val acc:0.978440523147583, best validation acc: 0.9864383935928345, corresponding to test acc:                         0.7511368989944458 / 0.7633107304573059
after epoch: 24,now: 2024-07-09 22:08:19.205401,epoch time: 0:37:56.424806,used: 15:13:33.837135,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9850974, 'precision': 0.9540417, 'recall': 0.95316637, 'specificity': 0.99842703, 'f1': 0.9524377, 'auroc': 0.99975204}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    1    0     1     1     0    0      0
1     0  1292    0     1    0    0     2    27     5    0      5
2     1     0  299     0    8    0     0     1     1    0      2
3     3     0    1  8307    0    1    16    62    46    0      1
4     4     0    8     0  480    0     2     1     4    0     40
5     6     0    0     3    1  473     0     0     3   35      0
6     5     0    0     0    0    0  1901     0     0    0      2
7     0     1    1    45    0    0     0  7175    39    0      3
8     0     0    0    16    1    1     5     6  3260    0      6
9     7     0   62     1    2   16     2     1     2  399      1
10    5     0    0     1   16    0     2     1    14    0  12753
---- Validation: 
scalar performance:
{'acc': 0.9842985, 'precision': 0.953923, 'recall': 0.9504386, 'specificity': 0.9983363, 'f1': 0.9507034, 'auroc': 0.999715}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    0    0     1     1     0    0      6
1     1  1283    0     1    0    0     3    36     6    0      2
2     1     0  299     0    6    0     2     1     1    0      2
3     5     1    0  8315    0    1     9    58    50    0      1
4     7     0    6     0  481    0     1     3     4    0     37
5     6     0    0     2    0  475     2     0     2   33      1
6     3     0    0     0    0    0  1901     1     0    0      3
7     1     2    0    47    0    0     1  7161    49    0      4
8     0     0    0    16    2    0     1     2  3266    0      9
9     8     0   71     2    2   12     3     1     2  390      2
10    3     0    1     1   11    0     8     4    16    0  12752
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70342124, 'precision': 0.6231439, 'recall': 0.5842682, 'specificity': 0.97016037, 'f1': 0.5531362, 'auroc': 0.8757188}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1088     0   0   6    1    0    18    39     5    1    12
1      0  1059   0  16    0    0     9   371     9    0    35
2     52     0  72   9  127    8     8    86   376   36   241
3      0     0   0   0    0    0     0     0     0    0     0
4      0     0   0   0  184    0     4     3    31    0  1411
5     66     0   1  70    1  252     1     0    20  170    11
6      9     0   0   1    0    0  3008     0     1    0    48
7      2     0   0   5    0    0     1  1153     2    0     1
8      4     0   0  42    0    1     9    21  1288    3     2
9    100     1  93  85    6  104     7   103   284  313    41
10     0     0   0   0    7    0     2     0     0    0  1637
early stop counter: 2
val acc:0.9842985272407532, best validation acc: 0.9864383935928345, corresponding to test acc:                         0.7511368989944458 / 0.7633107304573059
after epoch: 25,now: 2024-07-09 22:44:08.048807,epoch time: 0:35:48.843406,used: 15:49:22.680541,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.97790027, 'precision': 0.9399283, 'recall': 0.94399875, 'specificity': 0.99766374, 'f1': 0.9378034, 'auroc': 0.9996791}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    4     1    1    0     7     4     0    0     10
1     0  1320    0     1    0    0     0    11     0    0      0
2     0     0  310     0    0    0     0     0     0    1      1
3     0     1    1  8209    0    2     0   203    22    0      0
4     4     0   34     0  471    0     0     3     8    0     19
5     0     0    4     7    0  470     1     0     4   35      0
6     2     0    1     0    0    0  1899     1     0    0      5
7     0    17    5    40    1    0     0  7182    13    0      4
8     1     1    6    44    4    0     1    44  3186    0      7
9     0     0  104     2    0    7     0     0     3  377      0
10    3     0    9     1   32    0     5    16    58    0  12670
---- Validation: 
scalar performance:
{'acc': 0.9785476, 'precision': 0.943254, 'recall': 0.9428221, 'specificity': 0.99770963, 'f1': 0.9390613, 'auroc': 0.99967134}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    3     1    2    0     4     7     1    0     14
1     0  1318    0     0    0    0     0    12     1    0      1
2     0     0  308     1    0    0     0     2     1    0      0
3     0     3    1  8255    0    2     0   165    14    0      0
4     4     0   34     0  462    0     0     2     9    0     28
5     2     0    3    10    0  476     0     0     3   26      1
6     0     0    0     1    0    0  1900     3     1    0      3
7     0    17    1    55    1    0     2  7178     9    0      2
8     0     1    6    59    3    0     0    31  3188    0      8
9     0     0  104     3    0    5     0     0     1  380      0
10    5     1    7     3   33    0     2    19    59    0  12667
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7335059, 'precision': 0.6710899, 'recall': 0.6040624, 'specificity': 0.9732042, 'f1': 0.5978316, 'auroc': 0.8808961}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   860     2    6   35    1    0   119   107    21    8    11
1     0  1363    0   10    0    0     0   114     3    0     9
2    52    20  244   17  106    5    24    69   277   49   152
3     0     0    0    0    0    0     0     0     0    0     0
4     1     4    6    0  332    0    10     1    20    0  1259
5    13     0   11  143    0  175     4     2    30  212     2
6     2     0    0    5    0    0  3053     0     1    0     6
7     0     4    1    6    0    0     0  1150     2    0     1
8     0     0    0   54    0    2     6    24  1283    0     1
9    35    23  182  153    5   50    11    77   172  410    19
10    0     0    0    0   29    0     2     1     0    0  1614
early stop counter: 3
val acc:0.9785475730895996, best validation acc: 0.9864383935928345, corresponding to test acc:                         0.7511368989944458 / 0.7633107304573059
after epoch: 26,now: 2024-07-09 23:19:54.128437,epoch time: 0:35:46.079630,used: 16:25:08.760171,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9835456, 'precision': 0.96710074, 'recall': 0.9280067, 'specificity': 0.9981012, 'f1': 0.94560015, 'auroc': 0.99967474}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    0     1    4    0    14     0     1    0     16
1     0  1316    0     0    0    0     0    11     3    0      0
2     1     0  265     1   28    0     0     0     1    2     14
3     0     1    0  8333    0    1     1    57    46    0      0
4     0     0    2     0  364    0     0     1    11    0    161
5     0     0    0     9    0  475     0     0     8   29      0
6     2     0    0     0    0    0  1902     0     3    0      1
7     0     3    0    57    0    0     0  7164    30    0      8
8     0     0    0     9    0    0     0    11  3271    0      5
9     1     0   30     2    2    1     2     1     9  440      4
10    0     0    0     1    2    1     0     2     4    0  12784
---- Validation: 
scalar performance:
{'acc': 0.9832821, 'precision': 0.966027, 'recall': 0.92755675, 'specificity': 0.9980694, 'f1': 0.9448775, 'auroc': 0.9996295}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    0     1    4    0     9     1     0    0     20
1     0  1315    0     0    0    0     0    15     1    0      1
2     1     0  261     0   26    0     1     1     4    3     15
3     0     1    0  8317    0    3     2    65    50    1      1
4     0     0    1     0  368    0     0     1     9    0    160
5     0     0    1     6    0  470     0     0     8   36      0
6     1     0    0     0    0    0  1903     0     0    0      4
7     0     2    0    43    1    0     2  7179    31    0      7
8     0     1    0     5    0    0     0     9  3271    0     10
9     0     0   28     3    1    4     0     2     6  446      3
10    0     0    0     1    3    0     1     2     7    0  12782
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68697965, 'precision': 0.614278, 'recall': 0.56784284, 'specificity': 0.9683479, 'f1': 0.5428357, 'auroc': 0.8672737}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   905     1   0  12    3    6   144    15    35   15    34
1     1  1153   0   8    0    0     4   286     8    0    39
2     5     0  32  11  162   10     4    46   406   52   287
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   0  132    0     4     2    22    0  1473
5     3     0   1  61    5  268     2     1    30  218     3
6     0     0   0   2    0    0  2973     0     4    0    88
7     0     2   0  89    0    0     3  1059     8    0     3
8     0     0   0  41    0    3     4    12  1310    0     0
9     6     3  37  77   20  111    15    59   418  353    38
10    0     0   0   0    9    0     2     1     0    0  1634
early stop counter: 4
val acc:0.9832820892333984, best validation acc: 0.9864383935928345, corresponding to test acc:                         0.7511368989944458 / 0.7633107304573059
after epoch: 27,now: 2024-07-09 23:55:45.501723,epoch time: 0:35:51.373286,used: 17:01:00.133457,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98351884, 'precision': 0.9653581, 'recall': 0.9654647, 'specificity': 0.99818695, 'f1': 0.96509075, 'auroc': 0.9998113}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     1    5    0     1     0     0    3      9
1     0  1316    0     2    0    0     0    11     1    0      0
2     0     0  285     1   13    0     0     0     1   12      0
3     1     0    0  8163    0   13     1   225    27   10      0
4     0     0    1     0  501    0     0     1     1    0     33
5     0     0    1     2    0  487     0     0     1   29      1
6     4     0    0     1    0    0  1895     0     2    0      6
7     0     2    1    28    0    0     1  7213    12    2      5
8     0     0    1    19   10    0     2    25  3207    5     27
9     0     0    8     1    0    7     0     0     1  476      0
10    1     0    0     2   31    0     1     1     2    1  12753
---- Validation: 
scalar performance:
{'acc': 0.9831751, 'precision': 0.9649672, 'recall': 0.96438724, 'specificity': 0.9981427, 'f1': 0.9643216, 'auroc': 0.99978817}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     0    7    1     2     0     0    1     13
1     0  1321    0     1    0    0     0     6     4    0      0
2     0     0  285     0    9    0     0     0     0   17      1
3     0     0    1  8170    0    9     5   221    23   11      0
4     2     0    6     0  489    0     3     2     1    1     35
5     0     0    0     2    0  491     0     0     1   26      1
6     2     0    1     1    0    0  1894     0     1    1      8
7     1     2    1    41    0    0     1  7197    12    3      7
8     0     0    3    13    4    0     2    14  3224    8     28
9     0     0    1     0    0   10     0     0     0  482      0
10    3     1    1     3   25    0     5    10     4    0  12744
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72720915, 'precision': 0.67120135, 'recall': 0.6097212, 'specificity': 0.97249115, 'f1': 0.6030194, 'auroc': 0.87627745}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   743     0    1  33   12   18   108    37    40  145    33
1     1  1172    0  36    0    0     4   237    18    6    25
2     7     0  163  13  236   11    17    61   176  137   194
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    4   0  351    0     5     0    13    1  1259
5     0     0    4  75    2  251     0     1     7  247     5
6     4     0    0   4    0    0  2958     2     2    0    97
7     0     0    0  29    0    0     0  1132     1    2     0
8     0     0    4  40    1    3     3    13  1297    5     4
9     6     2   65  44   14  100     6    62   107  710    21
10    0     1    0   0   24    0     2     1     1    0  1617
early stop counter: 5
val acc:0.9831750988960266, best validation acc: 0.9864383935928345, corresponding to test acc:                         0.7511368989944458 / 0.7633107304573059
after epoch: 28,now: 2024-07-10 00:32:17.310014,epoch time: 0:36:31.808291,used: 17:37:31.941748,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98812073, 'precision': 0.9752084, 'recall': 0.97212875, 'specificity': 0.99866885, 'f1': 0.9735807, 'auroc': 0.9998967}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     1    5    0     2     1     0    0      3
1     0  1325    0     1    0    0     0     3     1    0      0
2     0     0  298     0    4    0     1     0     0    8      1
3     2     0    0  8416    0    1     0    10    11    0      0
4     2     0    4     0  499    0     0     0     1    0     33
5     0     0    0     3    0  504     0     0     2   12      0
6     1     0    0     1    2    0  1864     1     3    0     35
7     0     0    0   109    1    0     0  7091    58    0      4
8     0     0    1    36    3    0     0     4  3244    1      6
9     0     0   20     1    3    5     0     0     0  464      0
10    6     0    2     7   12    0     0     0    10    0  12756
---- Validation: 
scalar performance:
{'acc': 0.98943424, 'precision': 0.9802378, 'recall': 0.97357935, 'specificity': 0.9988067, 'f1': 0.9768555, 'auroc': 0.99990463}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     0    9    0     2     2     0    0      6
1     0  1322    0     5    0    0     0     5     0    0      0
2     0     0  295     1    6    0     0     0     0    8      2
3     0     0    0  8412    0    1     0    11    16    0      0
4     1     0    1     0  507    0     0     0     2    0     28
5     0     0    0     5    0  507     0     0     1    8      0
6     0     0    0     1    1    1  1873     1     2    0     29
7     0     2    1    92    0    0     2  7110    48    1      9
8     0     0    0    27    4    0     0     1  3258    0      6
9     0     0   16     2    0    4     0     0     1  470      0
10    5     0    1     6    4    0     0     0     8    0  12772
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66172254, 'precision': 0.64834696, 'recall': 0.5709498, 'specificity': 0.966313, 'f1': 0.5781784, 'auroc': 0.866397}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   841     0    3  101   22    5   106    6    19   54    13
1     1  1193    1   59    1    0     0  200    11    0    33
2     2     1  195   54  239   28     4   22   204   90   176
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    3    1  231    0     1    0    16    1  1380
5     2     0    6   80    1  317     2    0     6  174     4
6     9     0    1   89    4    1  2419    2    18    0   524
7     0     0    1  186    0    0     1  963     7    4     2
8     0     0    1  182    3    5     0    2  1172    3     2
9     4     2  121  192   15  189     3   20    76  489    26
10    0     0    0    1    6    0     0    0     1    0  1638
better model found
persisted
after epoch: 29,now: 2024-07-10 01:08:11.859254,epoch time: 0:35:54.549240,used: 18:13:26.490988,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98812073, 'precision': 0.9693415, 'recall': 0.9706596, 'specificity': 0.9986955, 'f1': 0.9692763, 'auroc': 0.9998988}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     1    0     0    6    3     5     2     2    7     32
1     0  1329    0     0    0    0     0     2     1    0      0
2     0     0  304     1    3    0     0     0     1    3      0
3     0     1    1  8378    0    4     0    41    12    1      1
4     0     0    2     0  529    1     0     0     2    0      5
5     0     0    0     2    0  517     0     0     0    2      0
6     0     0    0     2    5    0  1886     4     1    0     10
7     0    20    3    35    2    0     0  7152    39    0     12
8     0     1    1    22    8    2     0     5  3216    0     39
9     0     0   17     0    1   25     0     0     0  450      0
10    2     0    1     3   36    0     1     0     3    0  12746
---- Validation: 
scalar performance:
{'acc': 0.9881503, 'precision': 0.9687524, 'recall': 0.97332567, 'specificity': 0.99870163, 'f1': 0.9704133, 'auroc': 0.9999107}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     1    0     1    8    1     1     2     1    2     29
1     0  1331    0     0    0    0     0     1     0    0      0
2     0     0  302     0    7    0     0     0     0    3      0
3     0     2    1  8361    0    6     0    52    16    1      1
4     0     0    0     0  531    0     0     0     1    0      7
5     0     0    0     0    0  515     0     0     0    6      0
6     0     1    0     3    0    1  1893     2     2    0      6
7     0    14    5    39    3    0     0  7158    36    3      7
8     0     0    4    23   11    2     0     7  3209    0     40
9     0     0   19     0    0   19     0     0     0  455      0
10    0     0    1     4   38    0     0     0     3    0  12750
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.721542, 'precision': 0.65993845, 'recall': 0.6153063, 'specificity': 0.97202563, 'f1': 0.6006014, 'auroc': 0.87345976}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   588    10    3  40   40   86    57    27    26  198    95
1     0  1323    2  13    0    0     0   102     9    1    49
2     0     2  159   7  281   30     1    12   215  105   203
3     0     0    0   0    0    0     0     0     0    0     0
4     0     1    3   0  364    0     2     0    16    1  1246
5     0     0    0  34    1  418     0     2     3  132     2
6     0     0    0   5    3    0  2906     0     2    1   150
7     0     5    2  25    0    0     0  1120     9    1     2
8     0     2    0  54    1   13     1     8  1286    2     3
9     1     8   77  59   18  294     0    12   110  528    30
10    0     0    0   0   22    0     1     1     1    0  1621
early stop counter: 1
val acc:0.9881502985954285, best validation acc: 0.9894342422485352, corresponding to test acc:                         0.6617225408554077 / 0.7633107304573059
after epoch: 30,now: 2024-07-10 01:44:08.501841,epoch time: 0:35:56.642587,used: 18:49:23.133575,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 18:49:23.133575 at 2024-07-10 01:44:08.501841
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66172254, 'precision': 0.64834696, 'recall': 0.5709498, 'specificity': 0.966313, 'f1': 0.5781784, 'auroc': 0.866397}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   841     0    3  101   22    5   106    6    19   54    13
1     1  1193    1   59    1    0     0  200    11    0    33
2     2     1  195   54  239   28     4   22   204   90   176
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    3    1  231    0     1    0    16    1  1380
5     2     0    6   80    1  317     2    0     6  174     4
6     9     0    1   89    4    1  2419    2    18    0   524
7     0     0    1  186    0    0     1  963     7    4     2
8     0     0    1  182    3    5     0    2  1172    3     2
9     4     2  121  192   15  189     3   20    76  489    26
10    0     0    0    1    6    0     0    0     1    0  1638
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.76331073, 'precision': 0.6866855, 'recall': 0.64837396, 'specificity': 0.9761007, 'f1': 0.6369661, 'auroc': 0.88634354}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1055     7    0   4    1    0    34    13     0   51     5
1      3  1327    0  13    0    0     0   145     5    0     6
2     23     2  438   2  146    4    14    67   147   37   135
3      0     0    0   0    0    0     0     0     0    0     0
4      0     1   12   0  190    0     2     2    16    0  1410
5      1     0   11  24    1  251     4     2    14  283     1
6      0     0    0   0    0    0  3058     3     1    0     5
7      0     1    1   2    0    0     0  1158     0    1     1
8      0     0    2  27    1    2     4    44  1285    2     3
9      8     9  321  16    2   33     3    94   129  509    13
10     0     0    0   0    5    0     1     1     0    0  1639
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_06_54_45_seed_1_21725672_instance_wise_predictions.txt
accuracy from prediction file 0.6617225215140279
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_3_5/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze_3_5/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 459345 KiB |   6811 MiB |   2823 TiB |   2823 TiB |
|       from large pool | 414728 KiB |   6775 MiB |   2790 TiB |   2790 TiB |
|       from small pool |  44617 KiB |     62 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 459345 KiB |   6811 MiB |   2823 TiB |   2823 TiB |
|       from large pool | 414728 KiB |   6775 MiB |   2790 TiB |   2790 TiB |
|       from small pool |  44617 KiB |     62 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 449784 KiB |   6803 MiB |   2812 TiB |   2812 TiB |
|       from large pool | 407075 KiB |   6767 MiB |   2779 TiB |   2779 TiB |
|       from small pool |  42709 KiB |     60 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7498 MiB |   7504 MiB |  14104 MiB |   6606 MiB |
|       from large pool |   7434 MiB |   7440 MiB |  14024 MiB |   6590 MiB |
|       from small pool |     64 MiB |     64 MiB |     80 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 443823 KiB | 687911 KiB |   2060 TiB |   2060 TiB |
|       from large pool | 429048 KiB | 678614 KiB |   2026 TiB |   2026 TiB |
|       from small pool |  14775 KiB |  38227 KiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    6392    |    8370    |  473862 K  |  473855 K  |
|       from large pool |     187    |     783    |  261201 K  |  261201 K  |
|       from small pool |    6205    |    8141    |  212660 K  |  212654 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    6392    |    8370    |  473862 K  |  473855 K  |
|       from large pool |     187    |     783    |  261201 K  |  261201 K  |
|       from small pool |    6205    |    8141    |  212660 K  |  212654 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     343    |     343    |     624    |     281    |
|       from large pool |     311    |     311    |     584    |     273    |
|       from small pool |      32    |      32    |      40    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      64    |    1681    |  314549 K  |  314549 K  |
|       from large pool |      35    |     311    |  204229 K  |  204229 K  |
|       from small pool |      29    |    1646    |  110319 K  |  110319 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6811 MiB |   2823 TiB |   2823 TiB |
|       from large pool |  16640 KiB |   6775 MiB |   2790 TiB |   2790 TiB |
|       from small pool |      0 KiB |     62 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6811 MiB |   2823 TiB |   2823 TiB |
|       from large pool |  16640 KiB |   6775 MiB |   2790 TiB |   2790 TiB |
|       from small pool |      0 KiB |     62 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6803 MiB |   2812 TiB |   2812 TiB |
|       from large pool |  16640 KiB |   6767 MiB |   2779 TiB |   2779 TiB |
|       from small pool |      0 KiB |     60 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |   7504 MiB |  14104 MiB |  13222 MiB |
|       from large pool |    824 MiB |   7440 MiB |  14024 MiB |  13200 MiB |
|       from small pool |     58 MiB |     64 MiB |     80 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 687911 KiB |   2060 TiB |   2060 TiB |
|       from large pool |  24320 KiB | 678614 KiB |   2026 TiB |   2026 TiB |
|       from small pool |      0 KiB |  47102 KiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8370    |  473862 K  |  473862 K  |
|       from large pool |       2    |     783    |  261201 K  |  261201 K  |
|       from small pool |       0    |    8141    |  212660 K  |  212660 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8370    |  473862 K  |  473862 K  |
|       from large pool |       2    |     783    |  261201 K  |  261201 K  |
|       from small pool |       0    |    8141    |  212660 K  |  212660 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     343    |     624    |     558    |
|       from large pool |      37    |     311    |     584    |     547    |
|       from small pool |      29    |      32    |      40    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1681    |  314551 K  |  314551 K  |
|       from large pool |       3    |     311    |  204229 K  |  204229 K  |
|       from small pool |       0    |    1646    |  110321 K  |  110321 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6811 MiB |   2823 TiB |   2823 TiB |
|       from large pool |  16640 KiB |   6775 MiB |   2790 TiB |   2790 TiB |
|       from small pool |      0 KiB |     62 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6811 MiB |   2823 TiB |   2823 TiB |
|       from large pool |  16640 KiB |   6775 MiB |   2790 TiB |   2790 TiB |
|       from small pool |      0 KiB |     62 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6803 MiB |   2812 TiB |   2812 TiB |
|       from large pool |  16640 KiB |   6767 MiB |   2779 TiB |   2779 TiB |
|       from small pool |      0 KiB |     60 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |   7504 MiB |  14104 MiB |  13222 MiB |
|       from large pool |    824 MiB |   7440 MiB |  14024 MiB |  13200 MiB |
|       from small pool |     58 MiB |     64 MiB |     80 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 687911 KiB |   2060 TiB |   2060 TiB |
|       from large pool |  24320 KiB | 678614 KiB |   2026 TiB |   2026 TiB |
|       from small pool |      0 KiB |  47102 KiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8370    |  473862 K  |  473862 K  |
|       from large pool |       2    |     783    |  261201 K  |  261201 K  |
|       from small pool |       0    |    8141    |  212660 K  |  212660 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8370    |  473862 K  |  473862 K  |
|       from large pool |       2    |     783    |  261201 K  |  261201 K  |
|       from small pool |       0    |    8141    |  212660 K  |  212660 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     343    |     624    |     558    |
|       from large pool |      37    |     311    |     584    |     547    |
|       from small pool |      29    |      32    |      40    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1681    |  314551 K  |  314551 K  |
|       from large pool |       3    |     311    |  204229 K  |  204229 K  |
|       from small pool |       0    |    1646    |  110321 K  |  110321 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_02_16_33_seed_2_21725672

 Experiment start at: 2024-07-10 02:16:33.105575
before training, model accuracy: 0.08185825496912003
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92198205, 'precision': 0.84753996, 'recall': 0.7459224, 'specificity': 0.9909941, 'f1': 0.7857201, 'auroc': 0.9928569}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   316     0   0     7    0    0    11    11     1    1    136
1     0  1229   0    14    1    0     0    81     3    0      4
2     2     0  90     6  137    1     2    24     4   30     16
3     1     1   0  7706    1    8     3   637    79    0      2
4     0     0   1     1  274    0     0     7    13    3    240
5     2     0   3    84    3  316     0     1     9  100      3
6     7     0   0     3    7    0  1770     3     7    2    108
7     0    12   0   102    6    0     1  7090    22    2     30
8     0     1   1   254   26    0     1   206  2644    0    163
9     2     0  50    25   20   50     1    19     7  301     18
10    3     0   0     6   29    0     3    16     8    1  12724
---- Validation: 
scalar performance:
{'acc': 0.9216531, 'precision': 0.84797484, 'recall': 0.74657035, 'specificity': 0.99095654, 'f1': 0.7858366, 'auroc': 0.99242836}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   304     0   0     7    0    0    14     8     0    3    147
1     0  1234   0    16    0    0     0    72     4    0      6
2     1     0  98     3  139    1     1    23     8   22     16
3     2     0   0  7707    0    9     0   644    71    2      5
4     1     0   0     4  291    1     0     8    12    5    217
5     0     0   0    71    2  310     1     0    10  124      3
6    10     0   0     6   11    0  1744     6     6    1    124
7     1    10   0   101    3    0     0  7101    23    0     26
8     0     1   1   244   31    0     3   196  2643    0    177
9     4     1  48    22   21   53     1    20     4  299     20
10    1     0   0     8   27    1     4    22     7    1  12725
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58497167, 'precision': 0.6020591, 'recall': 0.52952766, 'specificity': 0.95794296, 'f1': 0.5105764, 'auroc': 0.8598697}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   956     0   0   19    2    0    27    31     2   30   103
1     0  1145   0   27    0    0     0   306     1    1    19
2     2     0  14    4  299    4     1   171    41   82   397
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0   49    0     0     2     4    0  1578
5     3     0   0   64    5  209     0     2     3  302     4
6     0     1   0    1   12    0  1398     7     6    0  1642
7     0     0   0    3    0    0     0  1152     0    1     8
8     0     0   0  107   20    1     1    48  1167    6    20
9     5     2  47   45   16   18     1   274    31  625    73
10    0     0   0    0    0    0     0     0     0    0  1646
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-10 02:54:20.582370,epoch time: 0:37:47.476795,used: 0:37:47.476795,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_02_16_33_seed_2_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9412725, 'precision': 0.8582603, 'recall': 0.7980865, 'specificity': 0.99376243, 'f1': 0.81111234, 'auroc': 0.99655163}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   379     0    0     5    1    0    40     2     9    7     40
1     0  1246    0    15    0    0     0    54    17    0      0
2     0     0  102     1   33   22     1     8    16  124      5
3     0     0    0  7992    0   30     1   138   274    2      0
4     3     1   15     0  291    5     1     4    44   15    160
5     0     0    0    19    0  485     0     0     9    7      1
6     6     1    0     7    1    1  1871     1     7    0     13
7     0     9    0   219    1    2     4  6774   244    2      8
8     0     0    0    54    3    7     0    40  3163    1     26
9     1     0    5     6    1  246     1     2     7  222      1
10    7     0    3     6   31    2    35    13    39    3  12656
---- Validation: 
scalar performance:
{'acc': 0.9409121, 'precision': 0.8640269, 'recall': 0.8008822, 'specificity': 0.9937059, 'f1': 0.81427026, 'auroc': 0.99656427}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   384     0    0     6    1    2    33     1     7    6     43
1     0  1248    0    16    0    0     0    51    17    0      0
2     2     0  105     1   30   17     2    12    17  125      1
3     0     0    0  7977    0   19     0   141   302    1      0
4     2     1   11     0  288    5     1     6    54   11    160
5     0     0    0    10    0  496     0     0     8    6      1
6     4     0    0     4    2    1  1877     2     6    0     12
7     0    13    0   238    1    1     2  6775   227    0      8
8     1     1    1    58    3   11     0    35  3152    1     33
9     1     0    5     5    0  248     0     3    10  221      0
10    9     3    1     8   28    2    23    21    44    4  12653
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72441053, 'precision': 0.69080305, 'recall': 0.61922795, 'specificity': 0.97201073, 'f1': 0.5884098, 'auroc': 0.88600284}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   916     0   0  22    1    1   192    18     6    7     7
1     1  1334   0  26    0    0     1   119    12    0     6
2     7     4  34   8  106   13     5    92   283  129   334
3     0     0   0   0    0    0     0     0     0    0     0
4     0     3   0   0   92    0     0     2     8    1  1527
5     5     0   0  63    0  408     3     0    33   79     1
6     0     0   0   1    0    0  2946     1     7    0   112
7     0     2   0  27    0    0     2  1127     3    0     3
8     0     0   0  27    1    2     3     7  1323    1     6
9    18    12   4  56    3  106     7   119   259  531    22
10    0     0   0   0    2    0     0     1     0    0  1643
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-10 03:32:02.254310,epoch time: 0:37:41.671940,used: 1:15:29.148735,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_02_16_33_seed_2_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9419681, 'precision': 0.8664616, 'recall': 0.8274888, 'specificity': 0.993723, 'f1': 0.84140575, 'auroc': 0.99693555}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   428     0    0     2    1    0    30     6     7    0      9
1     0  1265    0     6    0    0     1    53     5    0      2
2     3     0  135     1   84    3     4    16     9   44     13
3     2     1    0  7727    0   18    16   485   188    1      0
4     8     0    7     0  294    3     8     5    32    5    177
5     2     0    1    25    3  417     0     0     7   64      1
6     7     0    0     2    0    0  1890     1     4    0      4
7     3    12    0    77    1    0     5  7080    76    1      7
8     0     0    2    90    9    2     7    84  3061    4     35
9    12     0   30    10    7   68     1     6    11  342      6
10   38     0    0     7   27    2    91    21    40    1  12568
---- Validation: 
scalar performance:
{'acc': 0.9441755, 'precision': 0.8707224, 'recall': 0.83256423, 'specificity': 0.9939394, 'f1': 0.8461188, 'auroc': 0.9968612}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    0     2    1    0    24     3     3    1     15
1     0  1263    0     7    0    0     0    55     3    0      4
2     5     0  140     2   82    1     3    11    12   48      8
3     3     1    0  7765    0   17    14   465   175    0      0
4     8     0    5     1  300    2     4     5    26    5    183
5     5     0    0    27    3  417     0     0     4   63      2
6     4     0    0     0    0    0  1893     1     4    0      6
7     3     8    0    77    2    0     3  7097    66    0      9
8     2     0    1    87    6    0     2    88  3074    0     36
9    15     2   30     6    6   68     4     5     8  346      3
10   43     1    0     6   36    2    78    19    42    0  12569
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7366543, 'precision': 0.64982533, 'recall': 0.62713253, 'specificity': 0.97311157, 'f1': 0.59115684, 'auroc': 0.88422805}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1030     0   0   5    0    0   127     1     3    3     1
1      1  1296   0  11    0    0     3   168     6    0    14
2     17     1  19   1  173   16    58    62   318   77   273
3      0     0   0   0    0    0     0     0     0    0     0
4      3     0   0   0   86    0    21     1    13    0  1509
5      8     0   0  46    0  399     9     0    35   95     0
6      0     0   0   1    0    0  3065     1     0    0     0
7      0     0   0   4    0    0     8  1147     3    1     1
8      0     0   0  15    0    3    13    11  1325    1     2
9     13     6  16  17    9  102    28   170   217  525    34
10     0     0   0   0    0    0     8     1     0    0  1637
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-10 04:07:50.091359,epoch time: 0:35:47.837049,used: 1:51:16.985784,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_02_16_33_seed_2_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9534728, 'precision': 0.88690484, 'recall': 0.8680179, 'specificity': 0.9948685, 'f1': 0.8757511, 'auroc': 0.99759877}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   395     0    0     5    0    0     8     2     1    0     72
1     0  1292    0     5    0    0     0    33     1    0      1
2     1     0  224     1   23    2     1     3     1   54      2
3     1     4    0  8060    0    9     5   293    59    4      1
4     2     0   33     2  378    0     1     2     8    8    105
5     1     0    0    30    1  388     0     0     1   99      1
6     9     0    1     2    3    0  1866     1     0    2     24
7     0    32    4    93    2    0     1  7095    20    0     17
8     0     4    7   154   34    3     2   144  2888    6     54
9     0     0   34     5    1   42     0     5     1  405      0
10    1     0    3     7  109    0     3     9    13    1  12646
---- Validation: 
scalar performance:
{'acc': 0.9545807, 'precision': 0.89353967, 'recall': 0.86997896, 'specificity': 0.99497795, 'f1': 0.8797798, 'auroc': 0.99761575}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   398     0    0     5    0    0     7     2     0    3     68
1     0  1293    0     7    0    0     0    30     1    0      1
2     2     0  221     2   28    2     0     6     1   47      3
3     0     5    0  8077    0    9     4   287    53    3      2
4     3     0   32     1  381    0     0     2    10    8    102
5     0     0    0    35    1  382     0     0     4   98      1
6     8     0    1     0    2    0  1873     1     3    0     20
7     0    35    1    96    2    0     1  7089    26    1     14
8     0     8    5   143   24    3     0   141  2906    5     61
9     0     0   29     7    0   31     1     9     1  415      0
10    1     0    5     8  101    0     6     9    13    1  12652
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7190233, 'precision': 0.69358444, 'recall': 0.590158, 'specificity': 0.97158146, 'f1': 0.5911634, 'auroc': 0.8870872}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   804     0    0   36    1    0   222    42     4   19    42
1     0  1302    0   18    0    0     0   154     2    0    23
2     0     0  120   21  185    2    14   102   101   91   379
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  372    0     2     2     2    0  1255
5     1     0    0  190    1  176     7     0     9  206     2
6     0     0    0    1    0    0  3008     1     0    0    57
7     0     0    0   22    0    0     4  1133     0    0     5
8     0     1    1   76    2    1    17    50  1214    2     6
9     0     0   72  125    4   29    26   233    55  542    51
10    0     0    0    0   36    0     4     0     0    0  1606
better model found
persisted
after epoch: 4,now: 2024-07-10 04:43:39.974513,epoch time: 0:35:49.883154,used: 2:27:06.868938,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_02_16_33_seed_2_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95422196, 'precision': 0.90044534, 'recall': 0.8323201, 'specificity': 0.99477303, 'f1': 0.8568085, 'auroc': 0.997474}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   398     1    0     2    0    0    10     1     2    1     68
1     0  1290    0     6    0    0     0    29     2    0      4
2     1     0  141     0   54    1     2     8     2   79     24
3     0     1    0  8129    1   15     9   176   102    2      1
4     1     0    5     0  254    1     1     0    15    1    261
5     0     0    0    22    3  464     0     0     6   25      1
6     3     0    1     0    2    0  1881     1     2    0     17
7     1    42    2   118    3    0     5  6970    81    3     40
8     0     2    0    91   10    2     6    45  3043    5     92
9     2     0   16     7    4   96     1     1     4  355      7
10    1     0    0     8    4    2    14     6    17    1  12740
---- Validation: 
scalar performance:
{'acc': 0.953912, 'precision': 0.9045899, 'recall': 0.8298007, 'specificity': 0.99473846, 'f1': 0.8553015, 'auroc': 0.9973277}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   385     0    0     3    0    0    21     2     0    1     71
1     0  1290    0     6    0    0     0    28     2    0      6
2     0     0  131     1   61    2     1     4     4   82     26
3     3     7    1  8120    0   13     9   180   102    3      2
4     1     0    4     0  259    1     1     1    15    4    253
5     0     0    0    25    1  470     0     0     4   19      2
6     4     0    0     1    2    2  1874     2     2    1     20
7     0    30    0   112    2    0     7  6978    97    2     37
8     1     0    2    84   10    4    10    50  3039    3     93
9     1     0    6     6    8   91     0     5     5  363      8
10    2     0    0     5    4    1    11     8    12    0  12753
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70461065, 'precision': 0.6237201, 'recall': 0.5940504, 'specificity': 0.9698927, 'f1': 0.564118, 'auroc': 0.87065077}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   740     0   0   10   1   13   302    15     2   27    60
1     0  1343   0   22   0    0     2   107     7    0    18
2     0     1   2    8  38   13    14    35   271  129   504
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    0  26    0     1     1    10    1  1594
5     0     0   0  110   1  368     6     0    13   92     2
6     0     0   0    1   0    0  2986     1     0    0    79
7     0     0   0    7   0    0     1  1148     4    0     4
8     0     1   0   82   0    0    15     8  1253    4     7
9     0     2   6   89   3  132    21    67   200  561    56
10    0     0   0    0   0    0     2     0     0    0  1644
early stop counter: 1
val acc:0.9539120197296143, best validation acc: 0.9545807242393494, corresponding to test acc:                         0.7190232872962952 / 0.7366542816162109
after epoch: 5,now: 2024-07-10 05:19:26.687120,epoch time: 0:35:46.712607,used: 3:02:53.581545,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_02_16_33_seed_2_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94766694, 'precision': 0.8728751, 'recall': 0.7922542, 'specificity': 0.99409306, 'f1': 0.8204238, 'auroc': 0.9966067}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   423     0    0     2    1    1    24     2     1    0     29
1     0  1285    0    12    0    0     0    30     2    0      3
2     1     1  114     3  118    2     3     7     8   29     26
3     2     0    0  8162    0    1     4   137   131    0      2
4     2     0    1     2  217    0     1     1    13    0    301
5     1     0    1    73    5  288     2     0    20  129      2
6     7     1    0     2    2    0  1856     0     2    1     37
7     8    28    0   204    3    0     9  6877    96    0     38
8     1     6    1    72    7    0     1    52  3106    0     50
9     5     0   31    21   27   19     1     6    14  359     10
10   12     0    0     8    8    0     5     4    20    1  12733
---- Validation: 
scalar performance:
{'acc': 0.94773304, 'precision': 0.8711808, 'recall': 0.7937198, 'specificity': 0.9941127, 'f1': 0.8198879, 'auroc': 0.99666935}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0     1    0    0    28     1     0    0     22
1     0  1281    0    14    0    0     0    31     3    0      3
2     2     0  109     5  120    0     2     8     2   42     22
3     2     2    0  8161    0    2     5   139   127    0      2
4     5     1    1     1  213    0     1     2    18    2    295
5     0     0    1    70    4  293     0     0    22  130      1
6     8     0    0     0    2    0  1857     0     4    0     37
7     5    30    0   200    4    0     9  6886    88    0     43
8     0     1    1    70    9    0     5    59  3091    0     60
9     7     1   32    18   22   18     1     5    15  369      5
10   13     0    0     7    4    1     4     5    22    0  12740
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.619534, 'precision': 0.5997571, 'recall': 0.50610137, 'specificity': 0.9612654, 'f1': 0.48960406, 'auroc': 0.852531}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   628     0   0   33    1    0   468    20     3    2    15
1     2  1290   0   28    0    0     1   155     2    0    21
2     2     1  11   24  205    0    17    54   255   36   410
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0   16    0     1     1     6    0  1609
5     2     0   0  230   17  155    12     1    35  137     3
6     2     1   0    2    1    0  2529     2     2    0   528
7     0     0   0  110    0    0    13  1032     1    0     8
8     0     1   0   86    1    0     8    18  1239    0    17
9     3     8  14  203   69   19    34   162   264  309    52
10    0     0   0    0    0    0     0     0     0    0  1646
early stop counter: 2
val acc:0.9477330446243286, best validation acc: 0.9545807242393494, corresponding to test acc:                         0.7190232872962952 / 0.7366542816162109
after epoch: 6,now: 2024-07-10 05:55:11.974004,epoch time: 0:35:45.286884,used: 3:38:38.868429,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_02_16_33_seed_2_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96040237, 'precision': 0.89895475, 'recall': 0.8869241, 'specificity': 0.99575096, 'f1': 0.89047945, 'auroc': 0.9984285}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     0    0     5    2    0     6     3     0    1     54
1     0  1275    0    10    0    0     0    39     5    0      2
2     2     0  219     1   47    2     1    10     3   26      1
3     0     0    0  8270    0    4     0    91    72    1      0
4     3     0   12     0  449    0     0     1    18    2     53
5     0     0    1    30    1  449     1     0     7   31      1
6     3     0    1     0    2    0  1882     0     6    0     14
7     0     7    0   203    2    0     1  6995    51    0      5
8     0     1    1   109   16    0     1    55  3100    1     12
9     0     0   50    11    3   79     0     1     4  345      0
10    1     0    5     9  188    0     5    19    65    0  12500
---- Validation: 
scalar performance:
{'acc': 0.9611074, 'precision': 0.9000445, 'recall': 0.88858324, 'specificity': 0.9958395, 'f1': 0.89197433, 'auroc': 0.99842507}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   408     0    0     2    2    0    14     2     2    2     51
1     0  1278    0     8    0    0     0    41     3    0      2
2     0     0  222     0   44    1     1     7     5   31      1
3     0     0    0  8274    1    4     0    96    62    3      0
4     2     0    7     0  442    1     0     1    18    3     65
5     0     0    1    31    2  454     0     0     6   27      0
6     4     0    1     3    1    0  1882     0     5    0     12
7     1    12    1   188    3    0     1  6994    61    0      4
8     0     0    1    99   16    0     0    51  3120    1      8
9     0     0   43     6    4   81     0     1     6  352      0
10    1     0    6     8  191    0     5    13    66    1  12505
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6566851, 'precision': 0.6466683, 'recall': 0.52541196, 'specificity': 0.9654386, 'f1': 0.5204996, 'auroc': 0.8822314}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   679    0    7   32    2    0   321    28     6   15    80
1     0  748    0   26    0    0     0   676     6    0    43
2     0    0  144   13  252    3     7   142   218   34   202
3     0    0    0    0    0    0     0     0     0    0     0
4     0    0    2    0  401    0     1     4    12    0  1213
5     0    0    4  273    1  124     3     2    31  153     1
6     0    0    0    1    4    0  3011     3     2    0    46
7     0    0    0    9    0    0     0  1154     0    0     1
8     0    0    0  106    1    0     2    40  1219    0     2
9     0    0  123  180    7   25    17   281   178  303    23
10    0    0    0    0   42    0     0     1     0    0  1603
better model found
persisted
after epoch: 7,now: 2024-07-10 06:31:15.019779,epoch time: 0:36:03.045775,used: 4:14:41.914204,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_02_16_33_seed_2_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95858306, 'precision': 0.9076216, 'recall': 0.86279833, 'specificity': 0.99539727, 'f1': 0.8749521, 'auroc': 0.99827397}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     1    0    0     2     1     0    1     16
1     0  1306    0     2    0    0     0    23     1    0      0
2     3     0  201     0    8    2     1    10     5   76      6
3     8     6    0  8099    0   15     2   204   105    0      0
4     6     0   33     0  233    2     1     4    21    7    232
5     0     0    0    17    0  476     0     0     7   20      1
6     9     1    0     2    1    0  1872     1     1    1     18
7     2    32    0   124    1    0     2  7053    43    1      4
8     1    14    3    97    1    5     6    77  3063    0     29
9     2     0   12    10    0  104     0     3     3  359      0
10   26     1    1     5    1    1     6    13    33    2  12704
---- Validation: 
scalar performance:
{'acc': 0.9578173, 'precision': 0.9105787, 'recall': 0.8607314, 'specificity': 0.99528754, 'f1': 0.875011, 'auroc': 0.9983398}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     1    0     3    0    0     4     4     1    2     13
1     1  1302    0     7    0    0     0    21     1    0      0
2     2     0  209     1   10    2     1    10     6   58     13
3    10     6    0  8114    0   11     2   208    89    0      0
4     5     1   26     0  227    2     0     4    19   11    244
5     1     0    0    26    0  471     0     0     7   15      1
6     8     0    0     0    1    0  1874     2     3    2     18
7     6    27    0   128    1    0     3  7045    50    0      5
8     1    19    2    97    1    2     0    89  3058    1     26
9     3     0   13     6    0  109     0     4     2  355      1
10   29     1    1     6    0    1     6    13    40    1  12698
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7066396, 'precision': 0.667843, 'recall': 0.6030951, 'specificity': 0.97068334, 'f1': 0.5722986, 'auroc': 0.8756839}
confusion matrix:
      0     1    2    3   4    5     6     7     8    9     10
0   1016     0    0   23   0   12    74    26     5   11     3
1      2  1312    0   19   0    0     0   158     0    0     8
2     15     4  112   29  15   30     5   164   212   93   336
3      0     0    0    0   0    0     0     0     0    0     0
4      0     0    2    1  14    0     1     2    20    1  1592
5      7     0    0  124   0  411     0     1     6   39     4
6      4     0    0    1   0    0  2974     3     0    0    85
7      0     0    0   20   0    0     0  1143     0    0     1
8      0     7    0  196   0    4     4    24  1130    0     5
9     14    11   36  182   0  198     7   242    77  342    28
10     0     0    0    0   0    0     0     0     0    0  1646
early stop counter: 1
val acc:0.9578173160552979, best validation acc: 0.9611073732376099, corresponding to test acc:                         0.6566851139068604 / 0.7366542816162109
after epoch: 8,now: 2024-07-10 07:07:21.417434,epoch time: 0:36:06.397655,used: 4:50:48.311859,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_02_16_33_seed_2_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96393406, 'precision': 0.9278227, 'recall': 0.8811987, 'specificity': 0.99602365, 'f1': 0.9021292, 'auroc': 0.99898183}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     0    0     1    1    0    13     1     0    2     29
1     0  1270    0     5    0    0     0    49     5    0      2
2     0     0  211     1   50    0     1     5    10   30      4
3     0     0    0  7987    0    2     0   294   152    2      2
4     3     0    2     0  370    1     2     2    23    1    135
5     0     0    0    26    0  414     2     0    19   59      1
6     0     0    0     5    0    0  1883     4     1    0     15
7     0     5    0    45    1    0     2  7146    54    0     11
8     0     0    1    28    0    0     2    53  3188    0     23
9     0     0   36     3    3   36     2     5    12  394      2
10    2     0    0     6   10    0    13     5    25    1  12729
---- Validation: 
scalar performance:
{'acc': 0.96549416, 'precision': 0.9322783, 'recall': 0.8882661, 'specificity': 0.996187, 'f1': 0.9083767, 'auroc': 0.9989534}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     2    3    0    10     1     0    1     28
1     0  1271    0     4    0    0     0    48     6    0      3
2     0     0  221     1   51    0     3     6    10   17      3
3     0     1    0  8021    0    1     1   271   144    0      1
4     2     0    2     0  380    0     3     1    18    0    133
5     0     0    1    27    2  416     0     0    20   54      1
6     1     0    0     1    0    0  1891     2     1    0     12
7     0     8    0    52    1    0     1  7147    47    0      9
8     0     0    0    31    2    0     1    65  3171    1     25
9     1     0   31     1    4   39     2     3     9  402      1
10    4     0    0     7   10    0    13     7    17    1  12737
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6722871, 'precision': 0.6182777, 'recall': 0.5436675, 'specificity': 0.9669446, 'f1': 0.51422834, 'auroc': 0.87250817}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   881     0   1   44   0    2   159    50     9   15     9
1     1  1045   0   19   1    0     0   381     9    0    43
2     5     0  38   13  99    3    20    58   399   39   341
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    1  46    0     3     1    17    0  1565
5     1     0   2  206   1  166     6     3    70  136     1
6     0     0   0    1   0    0  3056     3     1    0     6
7     0     0   0    5   0    0     0  1155     3    0     1
8     0     0   0   59   0    0     0    22  1285    1     3
9     0     0  36  122  13   31     9   129   455  297    45
10    0     0   0    0   1    0     4     1     0    0  1640
better model found
persisted
after epoch: 9,now: 2024-07-10 07:42:55.887124,epoch time: 0:35:34.469690,used: 5:26:22.781549,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_02_16_33_seed_2_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9659675, 'precision': 0.91492224, 'recall': 0.89282966, 'specificity': 0.99627197, 'f1': 0.8979269, 'auroc': 0.99899405}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     0    0     1    3    0     8     0     0    1     49
1     0  1300    0     1    1    0     0    26     3    0      1
2     0     1  260     0   30    2     0     3     6    8      2
3     0     1    2  8100    1   27     0   174   131    0      1
4     3     0    8     0  405    1     0     1    11    3    107
5     0     0    2     4    0  499     0     1     4   10      1
6     6     1    0     1    1    0  1875     1     3    0     20
7     1    22    0    73    5    0     1  7067    65    0     29
8     0     1    2    33    7    2     4    30  3161    0     54
9     1     0   84     1    1  119     1     1     9  276      0
10    0     0    1     7   28    1     3     5     9    0  12740
---- Validation: 
scalar performance:
{'acc': 0.9659222, 'precision': 0.91504693, 'recall': 0.8962339, 'specificity': 0.9962715, 'f1': 0.8986372, 'auroc': 0.9989553}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    0     2    1    1     7     0     0    1     46
1     0  1307    0     4    0    0     0    17     4    0      0
2     1     0  267     0   31    0     0     5     1    6      1
3     1     5    0  8102    1   20     3   180   127    0      1
4     2     0    8     0  413    0     0     2    10    1    103
5     0     0    2     5    0  501     0     0     5    7      1
6     4     0    0     1    1    0  1881     0     1    0     20
7     1    22    0    72    2    0     0  7054    74    0     40
8     0     0    3    33    7    4     2    32  3167    0     48
9     1     0   98     1    2  119     0     1     4  267      0
10    0     0    3     7   39    0     4     4    12    0  12727
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6897782, 'precision': 0.6298614, 'recall': 0.5751741, 'specificity': 0.9685449, 'f1': 0.5586745, 'auroc': 0.87971306}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   672     1    6   55    0    7   323    32    38    9    27
1     1  1284    1   15    2    0     0   150     6    0    40
2     0     0  138   14  234   13    13    38   289   28   248
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  150    0     2     1     8    0  1471
5     0     0    9  119    2  363     4     0    27   66     2
6     0     0    1    1    0    0  3006     2     1    0    56
7     0     0    1   57    0    0     3  1096     2    0     5
8     0     3    0   73    0    1     4     5  1274    0    10
9     0     7  185  101    5  150    11    82   327  234    35
10    0     0    0    0    4    0     0     0     0    0  1642
better model found
persisted
after epoch: 10,now: 2024-07-10 08:18:50.866074,epoch time: 0:35:54.978950,used: 6:02:17.760499,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_02_16_33_seed_2_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9660477, 'precision': 0.93244183, 'recall': 0.8870062, 'specificity': 0.9961474, 'f1': 0.9064197, 'auroc': 0.9990068}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     0    0     6    1    0     6     1     1    0     25
1     0  1270    0    10    0    0     2    42     5    1      1
2     0     0  238     1   16    1     1     7     4   40      4
3     0     0    2  8361    0    3     1    30    40    0      2
4     3     0   22     1  343    0     0     3    11    3    153
5     0     0    0    22    0  469     0     0     9   19      2
6     4     0    0     1    0    1  1872     0     2    0     28
7     1     6    1   274    1    0     7  6933    32    1      7
8     2     0    0   113    3    1     0    86  3069    1     19
9     0     0   12    12    2  102     0     0     3  360      1
10    5     0    0     8    9    0     1     5    15    2  12749
---- Validation: 
scalar performance:
{'acc': 0.9668584, 'precision': 0.9362212, 'recall': 0.8887229, 'specificity': 0.9962258, 'f1': 0.9087724, 'auroc': 0.99897766}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     3    1    0     5     0     1    0     29
1     0  1272    1    14    0    0     1    36     7    0      1
2     1     0  240     3   12    3     0     5     5   38      5
3     0     0    0  8362    0    2     1    36    36    0      3
4     4     0   19     1  343    0     0     5    19    5    143
5     0     0    0    28    0  475     0     0     5   12      1
6     3     0    0     0    0    1  1869     0     3    1     31
7     1     5    0   259    3    0     6  6951    30    0     10
8     1     0    0   120    2    0     1    81  3072    0     19
9     1     0   16    11    1  101     0     0     2  359      2
10    6     0    1     7    7    0     1     5    10    0  12759
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.637235, 'precision': 0.6336899, 'recall': 0.54182553, 'specificity': 0.96350634, 'f1': 0.5322548, 'auroc': 0.86345494}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   971     0   1   20    0    2    47    11     8    3   107
1     2  1116   0   31    0    0     0   287     6    0    57
2     2     0  67   16  142    7     8    81   199   47   446
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    1   54    0     1     2     9    0  1566
5     4     0   0  169    0  220     3     0    30  128    38
6     3     0   0    1    0    0  2362     3     2    0   696
7     0     0   0  139    0    0     2  1017     2    0     4
8     0     0   0   89    0    1     4    32  1235    1     8
9     6     0  59  173    4   53    18   153   152  421    98
10    0     0   0    0    0    0     0     1     0    0  1645
better model found
persisted
after epoch: 11,now: 2024-07-10 08:57:10.073974,epoch time: 0:38:19.207900,used: 6:40:36.968399,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_02_16_33_seed_2_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9686965, 'precision': 0.91038424, 'recall': 0.92614746, 'specificity': 0.99674857, 'f1': 0.91425824, 'auroc': 0.9991552}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   449     0    0     0    2    0    27     0     0    0      5
1     0  1309    1     4    0    0     0    15     2    0      1
2     1     0  266     1   14    5     0     1     2   22      0
3     0     2    1  8327    0   16     1    65    27    0      0
4     4     0   16     0  487    3     4     0     5    1     19
5     0     0    0     5    0  505     0     0     1    9      1
6     2     0    0     0    0    0  1901     1     1    0      3
7     0    14    3   150    1    0     2  7073    17    0      4
8     0     1    4   126   10    8     9    60  3065    1     12
9     1     0   13     2    1  135     2     0     0  338      0
10   18     2    3     7  188    2    44    14    23    3  12486
---- Validation: 
scalar performance:
{'acc': 0.96851677, 'precision': 0.90920496, 'recall': 0.9226216, 'specificity': 0.99671906, 'f1': 0.9124415, 'auroc': 0.99920326}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    0     1    1    1    24     0     0    0      5
1     0  1309    0     3    0    1     0    18     1    0      0
2     0     0  259     0   15    4     1     0     2   31      0
3     0     2    0  8326    0   12     1    77    22    0      0
4     6     0   20     0  479    2     2     5     6    2     17
5     0     0    0     6    0  506     0     0     1    7      1
6     3     0    0     0    0    0  1900     0     2    0      3
7     0    14    3   161    0    0     5  7063    14    2      3
8     0     0    7   137    9    9     4    66  3058    2      4
9     0     0   12     2    0  139     3     0     1  336      0
10   16     0    3     9  171    1    33    16    24    2  12521
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7394529, 'precision': 0.68645656, 'recall': 0.62978244, 'specificity': 0.9735839, 'f1': 0.6276639, 'auroc': 0.8889529}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   777     0    3   21    2   23   330     4     1    4     5
1     1  1242    1   18    2    0     9   205     5    0    16
2     3     0  259    8  307   53    54    55   100   77    99
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    3    1  571    0    13     1     5    2  1037
5     2     0    0  108    0  447     6     0     5   24     0
6     0     0    1    2    0    0  3058     1     1    0     4
7     0     0    1   53    0    0     2  1106     1    0     1
8     0     2    3  128    3    9    34    23  1166    0     2
9     0     7  145   95    6  300    35   122    62  354    11
10    0     0    0    0   52    0     5     0     0    0  1589
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-10 09:33:08.830142,epoch time: 0:35:58.756168,used: 7:16:35.724567,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_02_16_33_seed_2_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.970061, 'precision': 0.92710376, 'recall': 0.92957586, 'specificity': 0.9968752, 'f1': 0.9272611, 'auroc': 0.999325}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    2    0     0     2     3    0      6
1     0  1289    0     2    0    0     0    37     3    0      1
2     2     0  257     0   17    1     0     1     7   26      1
3     1     2    0  8106    0    4     0   199   123    3      1
4     3     0    9     0  467    0     1     3    21    0     35
5     1     0    0    15    0  424     0     0     6   74      1
6     9     0    0     0    1    0  1889     1     0    0      8
7     0     6    2    61    1    0     1  7108    82    0      3
8     0     0    2    23    1    0     0    22  3244    1      2
9     3     0   15     2    6   27     0     0     4  436      0
10   10     0    1     7  104    0     6     8    87    0  12567
---- Validation: 
scalar performance:
{'acc': 0.97004145, 'precision': 0.927647, 'recall': 0.9303376, 'specificity': 0.99687535, 'f1': 0.92805105, 'auroc': 0.999266}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     2    1    0     0     1     1    0      6
1     0  1290    0     0    0    0     0    35     7    0      0
2     1     0  261     0   20    1     1     2     4   22      0
3     2     0    0  8111    0    5     0   190   130    2      0
4     5     0    8     0  455    1     1     2    30    1     36
5     1     0    2    19    0  427     0     0     7   64      1
6     7     0    0     0    0    0  1889     3     2    0      7
7     1     6    0    54    2    0     1  7113    85    0      3
8     1     0    1    25    0    0     3    22  3240    0      4
9     1     0   22     2    4   20     0     0     4  440      0
10    4     0    2     7  117    0     8    13    78    0  12567
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7233611, 'precision': 0.6728347, 'recall': 0.593652, 'specificity': 0.97213006, 'f1': 0.5834575, 'auroc': 0.88295543}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   988     0   1   16    0    0    61    67    25    4     8
1     6  1213   0   30    2    0     3   211    11    0    23
2    34     0  79   16  242    8    50    64   332   75   115
3     0     0   0    0    0    0     0     0     0    0     0
4     2     0   0    0  371    0    11     1    46    1  1201
5    14     0   1  129    3  176    15     3     9  240     2
6     2     0   0    3    0    0  3053     2     1    0     6
7     0     0   0   64    0    0     1  1096     0    0     3
8     0     0   0   88    0    0    34    15  1227    2     4
9    25     0  27  123   15   56    55   118   167  529    22
10    0     0   0    0   33    0     4     1     1    0  1607
better model found
persisted
after epoch: 13,now: 2024-07-10 10:10:22.212275,epoch time: 0:37:13.382133,used: 7:53:49.106700,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_02_16_33_seed_2_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9645762, 'precision': 0.9310684, 'recall': 0.9168809, 'specificity': 0.9961648, 'f1': 0.92207813, 'auroc': 0.99926364}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     0    1    0     3     0     1    0     19
1     0  1309    0     4    0    0     1    13     4    0      1
2     0     0  262     0   10    0     0     0     1   34      5
3     5     1    0  8207    0   12     7    47   158    2      0
4     5     0   10     1  395    1     0     1     7    3    116
5     2     0    3     8    0  481     0     0     2   21      3
6     2     0    0     1    2    0  1839     0     1    1     61
7     3    20    6   118    2    0     2  6717   364    5     26
8     0     0    0    19    3    1     1     4  3244    4     20
9     6     0   15     0    2   66     0     0     2  401      1
10    7     0    2     7    7    0     0     0    31    0  12738
---- Validation: 
scalar performance:
{'acc': 0.96568143, 'precision': 0.93259, 'recall': 0.9153733, 'specificity': 0.99627304, 'f1': 0.9220828, 'auroc': 0.99925584}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     0    1    0     7     0     0    0     22
1     0  1306    0     3    0    0     2    14     6    0      1
2     0     0  254     0   13    0     0     0     2   39      4
3     2     1    2  8235    0   11     1    39   144    4      1
4     5     0   10     0  388    1     0     0    10    1    124
5     1     0    4     5    1  484     0     0     2   22      2
6     4     0    0     1    1    0  1856     0     2    0     44
7     5    12    5   129    2    0     6  6721   352    4     29
8     1     0    1    24    3    1     2     5  3235    2     22
9     3     0   19     0    1   54     0     0     4  412      0
10    4     0    1     7    5    0     3     0    18    0  12758
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6911075, 'precision': 0.6558794, 'recall': 0.5821204, 'specificity': 0.96853554, 'f1': 0.5753701, 'auroc': 0.86971295}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   945     0    9   3    0    0   102     9    22    5    75
1     7  1225    0  15    0    2     2   156     9    2    81
2     5     0  133   3  127    2     4     9   120   60   552
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  154    0     1     0     5    0  1473
5     3     0   52  42    1  180     9     1    16  256    32
6     1     0    0   1    5    0  2632     2     2    0   424
7     0     0    1  15    0    0     9  1117    16    1     5
8     0     0    0  28    2    2    14     2  1304    3    15
9     8     0  235  14    6   30    24    21   128  552   119
10    0     0    0   0   10    0     0     0     0    0  1636
early stop counter: 1
val acc:0.9656814336776733, best validation acc: 0.9700414538383484, corresponding to test acc:                         0.723361074924469 / 0.7394528985023499
after epoch: 14,now: 2024-07-10 11:05:40.954184,epoch time: 0:55:18.741909,used: 8:49:07.848609,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_02_16_33_seed_2_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97773975, 'precision': 0.9337576, 'recall': 0.9463192, 'specificity': 0.99762785, 'f1': 0.9391495, 'auroc': 0.99956214}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     1    0     0    0    0     6     1     0    0     17
1     0  1312    0     1    0    0     0    16     2    0      1
2     0     0  276     0    6    0     2     0     0   28      0
3     0     1    1  8334    0   10     4    55    22    6      2
4     4     0   21     0  477    0     2     0     3    1     31
5     0     0    0     8    0  453     0     0     0   59      1
6     2     0    0     0    0    0  1900     0     0    0      6
7     2    13    8   129    2    0     5  7068    22    4     10
8     0     1    6    51   10    1     1    42  3160    5     19
9     0     0   16     1    0   14     1     0     1  460      0
10    2     0    1     7  112    0    14     4     6    2  12646
---- Validation: 
scalar performance:
{'acc': 0.9790825, 'precision': 0.93540967, 'recall': 0.94623363, 'specificity': 0.99777853, 'f1': 0.9402087, 'auroc': 0.999557}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    0     1    0    0    10     0     0    2     20
1     0  1318    0     1    0    0     0    13     0    0      0
2     0     0  277     0    4    0     0     0     2   29      0
3     0     0    1  8349    0   10     4    51    23    2      0
4     5     0   19     0  475    1     1     1     7    2     28
5     0     0    1     6    0  460     0     0     0   53      1
6     1     0    0     0    0    0  1903     0     0    0      4
7     3     5    8   115    1    0     6  7097    22    1      7
8     0     0    1    46    7    3     2    41  3173    3     20
9     0     0   17     0    0   21     0     0     1  454      0
10    1     0    4     7  115    0    13     4     5    0  12647
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75603443, 'precision': 0.6914277, 'recall': 0.6360937, 'specificity': 0.975266, 'f1': 0.63914037, 'auroc': 0.88622606}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   945     0    2   9    0    7   107    26     8   25    41
1     1  1195    1  14    0    1    11   258     1    2    15
2     3     0  200   6  227    8    53    60   112  102   244
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  584    0    30     2     5    0  1011
5     2     0    4  61    0  286     3     2     5  228     1
6     0     0    0   1    1    0  3058     1     1    0     5
7     0     0    0  42    0    0     4  1113     1    2     2
8     0     2    0  67    3    6    19    38  1226    4     5
9     4     2  135  48    9   79    32    97    82  626    23
10    0     0    0   0   62    0    11     0     0    0  1573
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-10 11:46:01.493232,epoch time: 0:40:20.539048,used: 9:29:28.387657,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_10_02_16_33_seed_2_21725672
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
slurmstepd: error: *** JOB 21725672 ON gpusrv39 CANCELLED AT 2024-07-10T12:01:43 DUE TO TIME LIMIT ***
