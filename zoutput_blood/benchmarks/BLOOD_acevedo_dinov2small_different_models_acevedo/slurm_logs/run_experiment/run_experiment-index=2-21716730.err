Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul  7 09:20:30 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730

 Experiment start at: 2024-07-07 09:38:30.768336
before training, model accuracy: 0.08150843530893326
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93311214, 'precision': 0.8311853, 'recall': 0.7908407, 'specificity': 0.99277794, 'f1': 0.8021661, 'auroc': 0.99449974}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   403     0    1     6    1    0     9     2     6    2     53
1     1  1238    0    13    0    0     0    64     8    0      8
2     1     1  159     2   89    0     1    12    10   35      2
3     5     0    0  8051    0    3     5   192   182    1      1
4     3     0   10     1  342    0     2     3    34    4    140
5     5     0    5   117    0  213     0     0    30  150      1
6    30     0    1     5    5    0  1815     3     8    4     37
7     4    13    3   286    7    0     3  6767   157    1     20
8     3     1    4   124   20    0     0    56  3058    0     29
9     6     0   93    17   16   23     0     1    20  315      2
10   24     0    2     6  140    0    12    28    62    3  12515
---- Validation: 
scalar performance:
{'acc': 0.9350542, 'precision': 0.8329885, 'recall': 0.7967783, 'specificity': 0.99300665, 'f1': 0.8066232, 'auroc': 0.99479765}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     0    2     3    1    0     9     0     7    0     49
1     0  1250    0    14    0    0     0    55     4    0      9
2     4     0  164     0   94    1     1     7    12   27      2
3     5     0    2  8059    1    3     5   183   180    1      1
4     3     0   12     0  337    0     2     5    34    8    138
5     3     0    8   109    4  220     2     0    28  145      2
6    33     0    1     6    3    0  1818     5     7    1     34
7     3    19    5   259   12    0     4  6784   161    2     16
8     4     0    4   134   22    0     2    61  3041    1     27
9     6     0   92    14   11   22     1     0    20  323      4
10   17     0    1     7  139    0     4    22    53    4  12549
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64374167, 'precision': 0.63078666, 'recall': 0.54545236, 'specificity': 0.96417063, 'f1': 0.5341807, 'auroc': 0.87963116}
confusion matrix:
      0     1    2    3    4   5     6     7     8    9     10
0   1041     0    0   35    0   0    28    29     6   16    15
1      0  1089    0   21    0   0     1   325     8    0    55
2     12     1  127    9  448   0     1    98   143   40   136
3      0     0    0    0    0   0     0     0     0    0     0
4      2     0    1    0  319   0     1     1     9    0  1300
5      1     0    9  169    1  82     0     2    33  289     6
6      1     1    0    1   22   0  2129     3    32    0   878
7      1     0    0   30    0   0     0  1125     3    1     4
8      1     0    0   90    8   0     6    24  1235    4     2
9     20     4  258   99   29   6     0   163   118  422    18
10     0     0    0    0   14   0     0     0     0    0  1632
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-07 10:11:44.376031,epoch time: 0:33:13.607695,used: 0:33:13.607695,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94397473, 'precision': 0.87528795, 'recall': 0.8172518, 'specificity': 0.993865, 'f1': 0.83453906, 'auroc': 0.9964103}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   387     0    0     3    1    1    28     4     5   11     43
1     0  1257    1    12    0    0     0    51     6    0      5
2     0     0  117     0   67    2     2    16     5  100      3
3     0     0    0  8031    0   17     6   230   145   10      0
4     2     0   10     0  298    2     4     6    20   15    182
5     0     0    0    38    0  342     1     0     7  132      1
6     7     0    1     5    3    0  1874     2     3    2     10
7     0     8    1   244    1    0     1  6883   108    4     13
8     1     0    2   137   13    3    15    54  3008   11     50
9     0     0   18     6    1   26     2     4     3  432      1
10    8     0    2     8   27    0    50    11    27    7  12653
---- Validation: 
scalar performance:
{'acc': 0.94278455, 'precision': 0.8748905, 'recall': 0.8221807, 'specificity': 0.9937498, 'f1': 0.83750284, 'auroc': 0.9965622}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   380     0    0     5    2    0    33     5     1   13     44
1     0  1248    0    15    0    0     0    55     7    0      7
2     0     0  123     1   58    1     1    15     5  105      3
3     1     0    0  8014    0   19     6   238   154    8      0
4     3     0   11     0  306    1     4     3    19   14    178
5     0     0    0    27    0  364     1     0     4  124      1
6     6     0    1     1    1    1  1880     5     4    1      8
7     2    10    1   249    1    0     1  6873   110    4     14
8     0     0    1   142   13    5    15    58  2999   16     47
9     0     0   14     4    3   30     1     5     1  435      0
10   12     0    3     7   41    0    61    16    28    4  12624
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70538026, 'precision': 0.6417605, 'recall': 0.58054125, 'specificity': 0.970082, 'f1': 0.57433754, 'auroc': 0.8798944}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   918     0    0  12    2    0   117    12     2   87    20
1     1  1173    2  28    0    0     3   233     3    3    53
2     2     0  158   2  432    1    11    35    55   56   263
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  142    0     2     2     4    0  1482
5     0     0    9  16    7  138    15     1     4  399     3
6     0     0    1   0    1    0  2991     1     0    1    72
7     0     0    0  27    1    0     5  1125     2    1     3
8     0     0    9  78   27    1    41    16  1173    8    17
9     3     1  293  21   41   10    11    68    30  624    35
10    0     0    0   0    5    0     1     0     0    0  1640
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-07 10:43:10.680062,epoch time: 0:31:26.304031,used: 1:04:39.911726,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93525255, 'precision': 0.84966314, 'recall': 0.8243764, 'specificity': 0.99299973, 'f1': 0.8268285, 'auroc': 0.9961771}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    0     4    2    0     0     6     0    1     22
1     0  1188    0    16    0    0     0   122     1    0      5
2     5     0  169     2   64    0     1    32     1   37      1
3     3     0    0  8148    0    3     0   240    40    3      0
4     6     0   20     1  395    0     0    13    10    9     85
5     8     0    1    69    0  266     0     1     4  170      2
6    52     0    1     9    3    0  1816     3     7    0     17
7     2     3    0   194    3    0     1  7041    12    0      6
8     3     0    2   295   42    0     1   244  2687    5     15
9    11     0   56    17    1   11     0     4     3  390      0
10   37     0    3     8  212    0    14    63    48    2  12408
---- Validation: 
scalar performance:
{'acc': 0.93481344, 'precision': 0.8552592, 'recall': 0.827175, 'specificity': 0.9929416, 'f1': 0.8307755, 'auroc': 0.99581563}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     4    2    0     5     6     1    2     19
1     0  1186    0    17    0    0     0   122     2    0      5
2     3     0  184     3   56    1     1    28     1   35      0
3     2     0    0  8097    0    3     0   280    54    4      0
4     9     0   16     3  389    0     1    16    14    9     82
5     5     0    1    77    1  258     0     0     5  173      1
6    41     0    1     9    4    0  1821     5     5    2     20
7     2     4    1   201    4    0     1  7030    13    2      7
8     3     0    0   287   34    0     0   240  2711    7     14
9    12     0   48    16    5    9     0     5     0  398      0
10   37     0    4     9  207    0     7    49    50    3  12430
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6722871, 'precision': 0.63160026, 'recall': 0.559244, 'specificity': 0.967087, 'f1': 0.53805345, 'auroc': 0.88029623}
confusion matrix:
      0    1    2    3    4   5     6     7     8    9     10
0   1139    0    0    8    0   0     1    17     2    2     1
1     11  856    0   19    0   0     2   521     3    0    87
2     64    0   98   10  438   0     2   119   114   62   108
3      0    0    0    0    0   0     0     0     0    0     0
4      3    0    0    0  346   0     1     2    13    0  1268
5     47    0    4  106    3  91     1     1    10  329     0
6     64    0    0    1   11   0  2599     2     9    0   381
7      6    0    0    9    0   0     0  1146     0    0     3
8      8    0    0   89    3   0    10    69  1187    3     1
9     75    0  133   59   24  10     2   226    66  523    19
10     0    0    0    0   22   0     0     0     0    0  1624
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_3.png
early stop counter: 1
val acc:0.9348134398460388, best validation acc: 0.9427845478057861, corresponding to test acc:                         0.7053802609443665 / 0.7053802609443665
after epoch: 3,now: 2024-07-07 11:14:34.867949,epoch time: 0:31:24.187887,used: 1:36:04.099613,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95465004, 'precision': 0.9007095, 'recall': 0.83980936, 'specificity': 0.99500155, 'f1': 0.85638595, 'auroc': 0.99761677}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   390     0    0     4    3    0     9     6     2    9     60
1     0  1282    0    12    0    0     0    34     2    0      2
2     1     0  167     0   63    0     0     7     2   71      0
3     0     1    0  8292    1    1     2    71    68    1      0
4     3     0    9     1  372    0     0     2    11    8    133
5     0     0    0    46    2  266     0     0     4  202      1
6     4     1    0     2    8    0  1828     4     4    7     50
7     0    12    0   245    4    0     3  6933    58    0      8
8     0     4    2   136   13    0     2    61  3042    3     33
9     0     0   17    12    2    3     0     1     3  454      0
10    6     0    2     7   65    0     2    11    43    3  12655
---- Validation: 
scalar performance:
{'acc': 0.9529758, 'precision': 0.8919879, 'recall': 0.8347473, 'specificity': 0.994819, 'f1': 0.85091364, 'auroc': 0.99751043}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   392     0    0     6    5    0     9     2     3    8     58
1     0  1276    0    19    0    0     0    34     2    0      1
2     1     0  164     2   67    0     1     5     2   69      1
3     0     1    0  8293    1    4     0    75    64    2      0
4     2     0   13     1  366    1     0     3    12    6    135
5     0     0    0    46    1  261     0     0     4  208      1
6     2     0    1     7    6    0  1833     3     6    6     44
7     0    12    1   272    1    0     1  6902    62    1     13
8     0     1    5   153   11    0     1    61  3039    0     25
9     0     1   25    10    3    5     0     1     2  445      1
10    7     0    2     6   65    0     6    14    38    2  12656
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.58385223, 'precision': 0.62082595, 'recall': 0.49912584, 'specificity': 0.95817953, 'f1': 0.487993, 'auroc': 0.8673781}
confusion matrix:
     0     1   2    3    4   5     6     7     8    9     10
0   645     1   0  105   12   0   108    76    15  157    51
1     0  1230   0   28    1   0     0   222     5    0    13
2     2     1  50   23  385   1     0    58   236   71   188
3     0     0   0    0    0   0     0     0     0    0     0
4     0     0   0    0  146   0     0     1    26    0  1460
5     0     0   0  190    5  82     0     1    15  296     3
6     0     1   0   10   14   0  1720     3    30    0  1289
7     0     0   0  103    0   0     0  1059     0    0     2
8     0     0   0  122    0   0     2    11  1231    1     3
9     0     3  52  221   34   9     0   106   137  539    36
10    0     0   0    0    3   0     0     0     0    0  1643
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_4.png
better model found
persisted
after epoch: 4,now: 2024-07-07 11:46:01.246833,epoch time: 0:31:26.378884,used: 2:07:30.478497,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9373127, 'precision': 0.83880967, 'recall': 0.84361255, 'specificity': 0.99337405, 'f1': 0.82771564, 'auroc': 0.9967307}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    2     2    0    0     8     4     0    3     27
1     0  1247    0     6    0    0     0    70     6    0      3
2     0     0  264     0    0    5     1     5     2   35      0
3     0     0    1  7477    0   54     0   649   255    1      0
4     4     0  145     1  244    3     0     7    22   12    101
5     0     0    1     4    0  495     0     0     6   14      1
6    14     0    3     3    0    1  1853    12     7    0     15
7     0     5    3    27    0    0     1  7146    73    1      7
8     0     0    8    31    9    6     0   112  3100    0     29
9     0     0   58     1    0  216     0     2     6  210      0
10   21     0   33     6  105    2     6    17    39    4  12560
---- Validation: 
scalar performance:
{'acc': 0.93668586, 'precision': 0.8365315, 'recall': 0.8441012, 'specificity': 0.9933255, 'f1': 0.8264018, 'auroc': 0.9967632}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    2     2    0    2     4     3     3    6     23
1     0  1250    1     5    0    0     0    63     8    0      5
2     1     0  264     0    0   15     1     3     2   25      1
3     0     2    2  7463    0   51     0   684   236    2      0
4     4     0  143     0  256    5     0     5    24   11     91
5     0     0    2     5    0  491     0     0     7   15      1
6    16     0    1     1    1    3  1845    13     9    1     18
7     0     7    9    32    0    0     1  7139    68    1      8
8     1     0    7    21    9   11     1   111  3109    0     26
9     0     0   62     1    0  216     0     2     6  206      0
10   21     0   35     6  112    1     6    15    39    4  12557
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7237109, 'precision': 0.6697454, 'recall': 0.6338354, 'specificity': 0.9724897, 'f1': 0.6139501, 'auroc': 0.8863979}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   794     0   16  56    1   10    21   140    66   62     4
1     0  1164    1  20    1    0     0   280    17    0    16
2     1     0  440  11   71   42     1    57   321   23    48
3     0     0    0   0    0    0     0     0     0    0     0
4     2     0   21   0  630    0     1     1    47    1   930
5     0     0    1  70    0  477     0     3    14   27     0
6     3     0    2   7    3    0  2682     4   162    0   204
7     0     0    0   3    0    0     0  1158     1    0     2
8     1     0    0  69    0    6     0    31  1262    0     1
9     1     0  228  78    1  333     1   127   194  170     4
10    0     0    0   0   78    0     1     0     0    0  1567
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_5.png
new oracle model saved
early stop counter: 1
val acc:0.9366858601570129, best validation acc: 0.9529758095741272, corresponding to test acc:                         0.583852231502533 / 0.7237108945846558
after epoch: 5,now: 2024-07-07 12:17:32.964708,epoch time: 0:31:31.717875,used: 2:39:02.196372,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9561751, 'precision': 0.8943506, 'recall': 0.8718995, 'specificity': 0.99510396, 'f1': 0.882137, 'auroc': 0.9979259}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   387     1    0     1    1    0    18     2     1    3     69
1     0  1291    0     2    0    0     0    34     1    0      3
2     2     0  225     0   40    1     1     2     1   33      7
3     0     4    1  7990    1   11     0   265   162    3      2
4     1     0   15     0  385    1     0     1     3    6    127
5     0     0    0    14    0  434     0     0     2   70      1
6     2     0    1     2    2    0  1877     3     2    0     19
7     0    12    3    64   12    0     1  7067    52    0     53
8     0     0    5    39   54    1     1    66  2995    3    131
9     0     0   55     4    1   58     0     1     4  367      3
10    0     0    1     6   54    0     4     1     3    2  12720
---- Validation: 
scalar performance:
{'acc': 0.95607865, 'precision': 0.898859, 'recall': 0.8767035, 'specificity': 0.9950703, 'f1': 0.88672936, 'auroc': 0.9979243}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   390     0    0     4    1    0    14     1     0    3     70
1     0  1292    0     3    0    0     0    32     2    0      3
2     0     0  233     1   41    0     1     0     1   27      8
3     0     3    1  7957    2   20     0   288   166    1      2
4     1     0   11     1  393    0     0     0     4    5    124
5     0     0    0    13    0  442     0     0     6   58      2
6     1     0    1     3    1    1  1884     2     0    0     15
7     0     9    4    79   14    0     1  7066    42    0     50
8     1     1    9    36   44    2     0    71  2993    3    136
9     0     0   61     3    2   52     0     3     4  363      5
10    0     0    1     5   47    1     2     6     4    0  12730
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7467991, 'precision': 0.6643454, 'recall': 0.62657815, 'specificity': 0.97440726, 'f1': 0.62496734, 'auroc': 0.8835666}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   981     0    0  16   10    2    79    29     4   28    21
1     0  1196    0  10    4    1     1   249     7    0    31
2     3     0  206   1  510    9     0    32    72   40   142
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  474    0     2     0     5    0  1152
5     1     0    9  53    5  273     1     1    32  215     2
6     0     0    0   1    3    0  3021     1     0    0    41
7     0     0    0  24    0    0     1  1135     2    0     2
8     0     0    0   9    6    1     3    19  1321    3     8
9     1     0  315  24   22   53     0   106   135  447    34
10    0     0    0   0   25    0     1     0     0    0  1620
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-07 12:49:09.524857,epoch time: 0:31:36.560149,used: 3:10:38.756521,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9615261, 'precision': 0.92527395, 'recall': 0.85906893, 'specificity': 0.9956035, 'f1': 0.88520545, 'auroc': 0.9984006}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   402     0    0     5    1    0    12     5     1    2     54
1     0  1276    0    13    0    0     0    38     1    0      4
2     1     0  188     0   16    1     1    12     2   88      3
3     0     0    1  8282    0    5     0    97    52    2      0
4     3     0   18     1  318    1     1     7     5    8    177
5     0     0    0    61    0  390     1     0     4   64      1
6     2     0    1     0    1    0  1890     0     1    0     13
7     1     5    0   139    1    0     4  7092    13    1      7
8     0     1    3   158   12    1     2   131  2916    6     63
9     1     0    3     7    1   38     0     4     1  437      1
10    2     0    2     8   11    1     9    10     3    1  12747
---- Validation: 
scalar performance:
{'acc': 0.9594757, 'precision': 0.9191174, 'recall': 0.85302436, 'specificity': 0.99537915, 'f1': 0.87793934, 'auroc': 0.9983966}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   405     0    0     2    0    0    15     6     0    1     54
1     0  1274    1     9    0    0     0    46     1    0      1
2     2     0  167     1   21    0     0    16     1  100      4
3     0     0    0  8257    0    1     0   118    61    2      1
4     4     0   29     1  301    1     0     5     4    8    186
5     0     0    0    48    0  401     0     1     3   67      1
6     3     0    0     4    0    0  1885     0     2    1     13
7     0     9    0   157    1    0     2  7063    20    0     13
8     0     1    5   164   10    1     2   119  2926    5     63
9     1     0    4     5    0   33     1     2     2  445      0
10    1     0    1     7    9    0    12    13     5    2  12746
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70153224, 'precision': 0.6673273, 'recall': 0.5831092, 'specificity': 0.97002184, 'f1': 0.5678871, 'auroc': 0.8806501}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   900     0   0   70    0    1    75    97    10    9     8
1     2  1133   0   33    0    0     1   298     3    0    29
2    16     0  88   12  131    8    29   139    90  140   362
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    0   47    0     5     2     8    0  1570
5     1     0   0  129    1  240     4     0     7  209     1
6     0     0   0    4    0    0  3041     1     0    0    21
7     0     0   0   61    0    0     1  1100     0    0     2
8     0     0   0   89    2    1    12    49  1204    2    11
9     8     0  21  117    3   40     5   211    68  630    34
10    0     0   0    0    0    0     2     0     0    0  1644
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_7.png
better model found
persisted
after epoch: 7,now: 2024-07-07 13:20:45.545096,epoch time: 0:31:36.020239,used: 3:42:14.776760,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96037567, 'precision': 0.90823954, 'recall': 0.8841937, 'specificity': 0.99586165, 'f1': 0.8878672, 'auroc': 0.9985786}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     5    2    0     2     1     3    1      5
1     0  1304    0     7    0    0     0    17     4    0      0
2     0     0  152     1   70    1     0     2    17   69      0
3     0     4    0  8199    0    5     0    59   169    1      0
4     3     0    0     1  414    0     0     4    41    2     74
5     0     0    0    20    0  403     0     0    10   87      1
6     7     0    1     1    2    0  1878     4     5    0     10
7     0    38    0   188    2    0     2  6879   152    0      4
8     1     1    0    46    1    0     0    25  3215    1      6
9     0     0    9     5    3   21     0     0    12  443      0
10   32     1    1     7   90    0     9    10    94    2  12544
---- Validation: 
scalar performance:
{'acc': 0.96185637, 'precision': 0.90988755, 'recall': 0.88706785, 'specificity': 0.99602723, 'f1': 0.89107645, 'auroc': 0.99850243}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     5    2    0     5     2     5    3      6
1     0  1309    0     9    0    0     0    11     3    0      0
2     0     0  160     0   60    1     0     3    21   67      0
3     1     4    0  8211    1    8     0    49   164    2      0
4     4     0    2     0  412    1     0     2    45    3     70
5     0     0    0    19    0  408     0     0    10   83      1
6     9     0    0     4    0    1  1879     2     7    1      5
7     1    39    0   181    1    0     1  6896   143    0      3
8     0     1    0    40    2    0     0    23  3222    0      8
9     0     0    7     4    4   20     0     2     9  447      0
10   34     2    2     7   79    0     8     7    96    1  12560
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73581475, 'precision': 0.6637826, 'recall': 0.6081668, 'specificity': 0.97347534, 'f1': 0.59411895, 'auroc': 0.88246584}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   951     0   0  69    1    2    13    68    36   30     0
1     3  1351   0  24    0    0     0   100    18    0     3
2    19     0  39   9  308    6     5    23   422   69   115
3     0     0   0   0    0    0     0     0     0    0     0
4     2     1   0   0  346    0     2     1    36    0  1245
5     4     0   1  95    5  215     0     0    38  234     0
6     2     0   0   5    1    0  3021     1    17    0    20
7     1     1   0  65    0    0     0  1076    18    2     1
8     1     0   0  20    0    1     2     0  1345    1     0
9    10     3  41  65   34   40     1    31   333  555    24
10    0     0   0   0   25    0     2     0     1    0  1618
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_8.png
better model found
persisted
after epoch: 8,now: 2024-07-07 13:52:13.110526,epoch time: 0:31:27.565430,used: 4:13:42.342190,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9668504, 'precision': 0.92732406, 'recall': 0.8888279, 'specificity': 0.99631155, 'f1': 0.90338975, 'auroc': 0.9989711}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     1    0    0     6     2     0    0     36
1     0  1281    0     8    0    0     0    39     2    0      2
2     1     0  207     0    6    0     1     7     3   84      3
3     0     0    0  8106    0    3     1   263    63    1      0
4     5     0   36     0  364    0     0     4     7    6    117
5     0     0    1    31    1  394     0     0     6   87      1
6     4     0    0     3    0    0  1877     1     2    2     18
7     1     9    1    47    1    0     1  7177    23    1      4
8     0     0    1    63    7    0     0    71  3108    4     42
9     0     0    6     3    0   17     0     2     0  465      0
10    3     0    5     5   26    0     2    18    12    0  12720
---- Validation: 
scalar performance:
{'acc': 0.9662699, 'precision': 0.92550015, 'recall': 0.88423795, 'specificity': 0.99625117, 'f1': 0.8997145, 'auroc': 0.99887955}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     0    0     1    0    0     6     3     1    3     39
1     0  1283    0    11    0    0     0    35     1    0      2
2     2     0  207     0    5    0     1     6     2   87      2
3     0     0    0  8110    0    2     0   257    68    3      0
4     6     0   31     0  354    0     0     2    11    9    126
5     0     0    3    33    0  390     0     0     4   90      1
6     4     0    0     5    0    0  1882     1     1    1     14
7     0     9    0    45    1    0     1  7173    30    1      5
8     0     0    3    62   13    0     0    70  3104    3     41
9     1     0    9     5    0   13     1     1     2  460      1
10    3     0    2     7   27    0     5    13     8    0  12731
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67032814, 'precision': 0.68614286, 'recall': 0.55083025, 'specificity': 0.967094, 'f1': 0.55065715, 'auroc': 0.87997335}
confusion matrix:
     0     1    2    3    4   5     6     7     8    9     10
0   830     0    5   77    2   0   132    46    10   27    41
1     0  1099    0   32    1   0     0   347     3    2    15
2     4     0  151   40  197   1     3   103   255   77   184
3     0     0    0    0    0   0     0     0     0    0     0
4     0     0    2    0  429   0     0     2    17    0  1183
5     0     0   13  220    0  65     4     0     9  275     6
6     2     0    0    8   12   0  2575     6    10    0   454
7     0     0    0   39    0   0     0  1123     0    1     1
8     0     0    0  150    0   0     3    20  1195    0     2
9     2     0   60  306    3   5     4   134   100  494    29
10    0     0    0    0   24   0     1     1     0    0  1620
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_9.png
better model found
persisted
after epoch: 9,now: 2024-07-07 14:23:59.467936,epoch time: 0:31:46.357410,used: 4:45:28.699600,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.964817, 'precision': 0.91539776, 'recall': 0.900688, 'specificity': 0.9961929, 'f1': 0.90061986, 'auroc': 0.9990375}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     3    2    0     5     0     0    0     17
1     0  1321    0     3    0    0     0     6     1    0      1
2     0     0  281     0    2    0     1     1     1   22      4
3     1    15    0  8277    0    3     1    78    60    3      2
4     3     0   59     1  299    0     2     0    10    1    164
5     0     0    0    15    1  405     0     0     4   95      1
6     7     0    0     1    0    0  1890     0     0    0      8
7     1   260    3   120    1    0     2  6816    42    0     20
8     0     6    6    68    5    1     3    44  3136    0     26
9     1     0   41     3    0   12     0     0     1  434      1
10    5     0    4     7    8    0     7     1    12    0  12747
---- Validation: 
scalar performance:
{'acc': 0.96386254, 'precision': 0.9102459, 'recall': 0.89206964, 'specificity': 0.99610436, 'f1': 0.89313173, 'auroc': 0.99893177}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     2    0    0     9     1     0    0     16
1     0  1328    0     1    0    0     0     2     1    0      0
2     0     0  266     1    3    0     2     2     1   34      3
3     0    16    0  8270    0    3     1    86    61    2      1
4     4     1   61     0  293    0     0     0    14    3    163
5     0     0    1    15    0  392     0     0     2  109      2
6     8     0    1     1    0    0  1886     0     2    0     10
7     2   259    1   125    1    0     2  6823    30    1     21
8     1    11    2    64    4    1     4    41  3141    0     27
9     0     0   40     1    1   17     1     2     1  428      2
10    8     2    3     7    5    0     7     1    11    0  12752
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72776884, 'precision': 0.6846514, 'recall': 0.60652524, 'specificity': 0.97253084, 'f1': 0.59891665, 'auroc': 0.8826388}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   830     2    1   77    0    0   140    64    21   12    23
1     0  1364    0   17    0    0     5    94     3    1    15
2     6     0  255   15   79    9     8    53   180   79   331
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    2    0  109    0     2     2    14    0  1503
5     4     0    6  133    1  211     1     0    19  209     8
6     1     0    0    3    0    0  3026     0     1    0    36
7     1     0    1   14    0    0     0  1144     0    1     3
8     0     0    1   49    0    1    10    28  1274    4     3
9     3     2  135   95    0   53     5    87   157  547    53
10    0     0    0    0    4    0     0     0     0    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_10.png
early stop counter: 1
val acc:0.9638625383377075, best validation acc: 0.9662699103355408, corresponding to test acc:                         0.6703281402587891 / 0.746799111366272
after epoch: 10,now: 2024-07-07 14:55:41.942223,epoch time: 0:31:42.474287,used: 5:17:11.173887,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9684557, 'precision': 0.9279765, 'recall': 0.90159285, 'specificity': 0.99651057, 'f1': 0.91096616, 'auroc': 0.9990514}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    0    0     1     2     0    1      6
1     0  1293    0     4    0    0     0    33     1    0      1
2     3     0  201     0    9    0     0     3     2   92      2
3     0     2    0  8279    0   10     2   124    17    5      0
4     7     0   25     1  381    0     1     4    14    3    103
5     0     0    0    15    0  443     0     0     2   59      1
6    15     0    0     1    1    0  1879     2     2    0      7
7     1     6    0   161    1    0     0  7067    22    1      4
8     1     1    1   155    4    0     0    76  3028    1     26
9     2     0    4     6    1   28     0     0     2  450      0
10   19     2    1     7   24    0     7    17    14    1  12703
---- Validation: 
scalar performance:
{'acc': 0.96758056, 'precision': 0.9266617, 'recall': 0.89904016, 'specificity': 0.99642366, 'f1': 0.9088061, 'auroc': 0.99902856}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     2    0    0     1     2     0    1      8
1     0  1296    0     1    0    0     0    34     1    0      0
2     2     0  194     2    4    1     1     4     4   96      4
3     2     2    0  8294    0    8     0   111    22    1      0
4     7     0   19     0  389    1     3     3    17    5     95
5     0     0    0     9    0  454     0     0     2   55      1
6    11     0    0     1    0    0  1878     6     0    0     12
7     3    12    0   178    1    0     1  7042    22    0      6
8     2     6    0   158    9    3     1    73  3016    2     26
9     0     0    3     4    1   42     1     4     1  437      0
10   20     1    1     7   25    0     6     9    23    0  12704
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7415518, 'precision': 0.69654155, 'recall': 0.62378454, 'specificity': 0.97409004, 'f1': 0.6131147, 'auroc': 0.8887412}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1075     0    0   30    0    5    13    36     1   10     0
1      2  1123    0   22    0    0     0   342     0    0    10
2     38     2  132   10  173   12    27   127   211  150   133
3      0     0    0    0    0    0     0     0     0    0     0
4      3     0    3    0  363    0     6     4    23    0  1231
5      6     0    0   55    2  263     8     2     6  250     0
6      2     0    0    6    0    0  3044     4     0    0    11
7      1     0    0   47    0    1     1  1112     0    1     1
8      2     0    0  104    0    2    12    51  1187   10     2
9     18     1   26   59    4   67    10   175    79  682    16
10     0     0    0    0   25    0     3     0     0    0  1618
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_11.png
better model found
persisted
after epoch: 11,now: 2024-07-07 15:27:14.431879,epoch time: 0:31:32.489656,used: 5:48:43.663543,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9701145, 'precision': 0.9224367, 'recall': 0.9061005, 'specificity': 0.99673194, 'f1': 0.9088978, 'auroc': 0.99915785}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     0    4     2    4    0     4     5     1    4     29
1     0  1291    0     4    0    0     0    34     3    0      0
2     0     0  287     1    6    3     0     1     0   14      0
3     1     1    0  8152    0   10     0   209    65    0      0
4     0     0   41     0  374    3     1     3    11    4    101
5     0     0    1     4    0  505     0     0     1    9      1
6     1     0    3     2    1    1  1873     1     3    1     22
7     0     3    1    49    1    0     0  7197     6    0      5
8     0     0    3    35    6   16     0    93  3125    1     17
9     2     0   49     6    2  112     0     5     0  317      0
10    2     0   11     7   32    1     1    17    13    1  12708
---- Validation: 
scalar performance:
{'acc': 0.9700147, 'precision': 0.92443883, 'recall': 0.90993613, 'specificity': 0.9967219, 'f1': 0.91198695, 'auroc': 0.99923104}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     0    3     2    4    0     5     5     1    1     26
1     0  1287    0     5    0    0     0    38     2    0      0
2     0     0  290     1    4    3     0     2     2   10      0
3     0     0    0  8153    0   21     0   200    64    0      2
4     0     0   40     0  382    3     0     2    12    3     97
5     0     0    0     3    0  502     0     0     2   13      1
6     3     0    1     2    2    1  1868     7     3    1     20
7     0     4    3    52    1    0     0  7193     9    0      3
8     0     0    5    39    3   11     0    92  3123    2     21
9     0     0   60     7    0   94     1     3     1  327      0
10    1     0    9     7   33    2     3    17    20    1  12703
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6937662, 'precision': 0.6289976, 'recall': 0.589218, 'specificity': 0.9693389, 'f1': 0.5721388, 'auroc': 0.8751998}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   886     0    6   37    1    5    44   146     4   25    16
1     0  1105    1   18    0    0     0   328     1    0    46
2     4     0  269   22  145   18     1   114   138   31   273
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    4    0   49    0     1     2     7    0  1570
5     2     0   12  124    2  342     0     1    12   96     1
6     2     0    0    7    0    0  2930     6     2    0   120
7     0     0    0    9    0    0     0  1154     0    0     1
8     0     0    1   81    0    5     2    50  1224    1     6
9     2     1  235  129    4  141     0   212    74  313    26
10    0     0    0    0    1    0     0     1     0    0  1644
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_12.png
better model found
persisted
after epoch: 12,now: 2024-07-07 15:58:46.816012,epoch time: 0:31:32.384133,used: 6:20:16.047676,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96623504, 'precision': 0.91621524, 'recall': 0.8750658, 'specificity': 0.99637955, 'f1': 0.87897354, 'auroc': 0.9988831}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   433     0    0     2    2    1    16     0     0   13     16
1     0  1290    0     1    0    0     0    35     3    0      3
2     0     0  102     0   32    2     0     3     3  168      2
3     0     0    0  8145    0   29     0   174    85    3      0
4     2     0    2     1  427    2     2     1    13   12     77
5     0     0    0     8    1  489     1     0     3   19      0
6     5     0    0     4    0    1  1863    10     1    0     24
7     0     4    0    68    2    0     0  7139    27   12     12
8     0     3    1    38    9    8     1    73  3111    6     45
9     0     0    0     2    0   76     0     0     0  414      0
10    4     0    0     6   36    1    11     3    21   11  12701
---- Validation: 
scalar performance:
{'acc': 0.9665641, 'precision': 0.9123754, 'recall': 0.87112916, 'specificity': 0.9964416, 'f1': 0.8714806, 'auroc': 0.9989282}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   428     0   0     2    3    3    21     1     0   11     14
1     0  1292   0     3    0    0     0    34     2    0      1
2     0     0  84     0   47    1     0     2     3  173      2
3     0     3   0  8142    0   38     0   166    82    9      0
4     2     0   3     0  431    2     0     0    10   12     79
5     0     0   0     6    0  494     0     0     1   20      0
6     6     0   0     5    2    3  1849     7     3    5     28
7     1     7   0    68    3    0     1  7130    33   12     10
8     0     1   0    37   11    5     0    58  3144    8     32
9     0     0   0     2    0   72     0     1     1  417      0
10    3     0   0     8   32    2     3     4    13    7  12724
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6982439, 'precision': 0.6773656, 'recall': 0.59214985, 'specificity': 0.9696293, 'f1': 0.5812536, 'auroc': 0.88193905}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   706     0   0  50    4   23   175    52     4  146    10
1     2  1094   0  19    1    0     0   345     2    5    31
2     4     0  41  18  356   16     2    72   146  213   147
3     0     0   0   0    0    0     0     0     0    0     0
4     1     0   0   1  437    0     1     2    13    1  1177
5     0     0   1  84    5  277     3     0     6  216     0
6     3     1   0  75    8    1  2685     8    10    3   273
7     0     0   0   3    0    0     0  1157     0    3     1
8     0     0   0  97    6    5     7    42  1194   10     9
9     2     0   9  88   17   85     0    75    64  780    17
10    0     0   0   0   36    0     0     1     0    0  1609
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_13.png
early stop counter: 1
val acc:0.9665641188621521, best validation acc: 0.9700146913528442, corresponding to test acc:                         0.693766176700592 / 0.746799111366272
after epoch: 13,now: 2024-07-07 16:30:14.871866,epoch time: 0:31:28.055854,used: 6:51:44.103530,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96682364, 'precision': 0.89654857, 'recall': 0.929043, 'specificity': 0.9966172, 'f1': 0.9086214, 'auroc': 0.9989157}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     1    4    0     0     0     0    1      5
1     0  1318    0     4    0    0     0     8     1    0      1
2     1     0  260     0    5    3     0     1     0   42      0
3     3     2    2  8349    0    1     1    30    48    0      0
4     5     0   45     0  468    1     0     4     2    4     10
5     1     0    0    54    0  435     0     0     4   26      1
6    14     0    0     1    7    1  1869     1     3    0     12
7     1    24    3   155    0    0     2  7045    30    0      3
8     0     1    3    58   10    0     0    31  3185    0      8
9     3     0   15    10    0   44     0     2     1  418      0
10   10     0    7     7  399    1     1    22    28    1  12317
---- Validation: 
scalar performance:
{'acc': 0.9658419, 'precision': 0.8916023, 'recall': 0.92580235, 'specificity': 0.99652493, 'f1': 0.9046277, 'auroc': 0.9988408}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    1     0    3    0     0     2     0    1      7
1     0  1318    0     2    0    0     0    10     1    0      1
2     0     0  252     1    1    1     0     2     1   54      0
3     2     0    0  8328    0    2     1    44    63    0      0
4     5     0   44     0  468    1     0     3     3    4     11
5     0     0    0    46    0  439     0     0     2   33      1
6    20     0    0     2    4    2  1867     0     0    0     13
7     2    22    1   155    1    0     2  7050    29    0      3
8     0     1    4    53   16    0     1    37  3178    0      6
9     1     0   18     6    0   50     0     2     1  415      0
10    7     0    9     7  400    1     5    16    26    1  12324
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74148184, 'precision': 0.69515383, 'recall': 0.6309735, 'specificity': 0.9743812, 'f1': 0.6432758, 'auroc': 0.8869045}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   993     0    1   48   13   29    26   11     3   36    10
1     2  1172    0   21    1    0     0  279    12    0    12
2     6     0  277   22  291   14     3   79   181   82    60
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0   13    0  878    0     1    3    10    0   728
5     1     0    7  146    9  316     2    0     8  102     1
6     3     1    2    5   18    0  2773    3     8    0   254
7     1     0    0  197    0    0     0  964     1    0     1
8     0     0    0   81    2    2     2   14  1269    0     0
9     3     1   97  178    6  122     0  107   176  437    10
10    0     0    0    0  126    0     0    1     0    0  1519
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_14.png
early stop counter: 2
val acc:0.9658418893814087, best validation acc: 0.9700146913528442, corresponding to test acc:                         0.693766176700592 / 0.746799111366272
after epoch: 14,now: 2024-07-07 17:01:49.345867,epoch time: 0:31:34.474001,used: 7:23:18.577531,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97115797, 'precision': 0.9245311, 'recall': 0.9038957, 'specificity': 0.9969301, 'f1': 0.9086176, 'auroc': 0.99938744}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    1     1    8    0     6     2     0    2     17
1     0  1274    0     9    0    0     0    46     3    0      0
2     0     0  247     0   33    4     0    11     5   11      1
3     0     0    0  8129    0    4     1   185   118    1      0
4     2     0    3     1  456    0     0     2    12    0     63
5     0     0    0    10    1  501     1     1     4    3      0
6     7     0    1     1    0    3  1879     8     0    0      8
7     0     7    0    49    1    0     1  7176    24    0      4
8     0     0    3    19    1    0     1    52  3211    0      9
9     0     0   61     3    4  144     0     4     1  276      0
10    6     0    0     5   33    0     7    14    25    0  12704
---- Validation: 
scalar performance:
{'acc': 0.9723151, 'precision': 0.9295876, 'recall': 0.90782785, 'specificity': 0.99704516, 'f1': 0.9125707, 'auroc': 0.99936366}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    0     1    3    4     4     3     0    0     17
1     0  1263    0     8    0    0     1    57     3    0      0
2     0     0  254     1   37    1     0    10     0    8      1
3     0     0    0  8141    1    5     3   177   113    0      0
4     3     0    1     1  457    0     0     4    15    0     58
5     0     0    0     9    1  507     0     0     2    2      0
6     3     0    0     0    3    1  1892     2     2    1      4
7     0     4    0    49    1    0     1  7185    18    0      7
8     0     0    1    20    0    0     1    48  3212    0     14
9     1     0   62     4    7  137     1     6     1  274      0
10    3     0    0     5   34    1     5    11    23    0  12714
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66004336, 'precision': 0.6236948, 'recall': 0.53488386, 'specificity': 0.96600163, 'f1': 0.5138501, 'auroc': 0.8727556}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   676     0  13   64    4   20   180   110    10   18    75
1     0  1004   0   32    0    0     4   430    13    0    16
2     0     0  95   28  136   17     9   134   381   14   201
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  206    0     2     5    41    0  1379
5     1     0   9  274    1  223     3     5    24   41    11
6     0     0   0    3    0    0  2998     2     8    0    56
7     0     0   0    4    0    0     0  1156     3    0     1
8     0     0   0   54    0    0     2    35  1279    0     0
9     2     1  95  253    5  149     1   232   210  161    28
10    0     0   0    0   10    0     0     0     0    0  1636
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_15.png
better model found
persisted
after epoch: 15,now: 2024-07-07 17:33:27.926618,epoch time: 0:31:38.580751,used: 7:54:57.158282,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97495717, 'precision': 0.9274811, 'recall': 0.9487364, 'specificity': 0.9974457, 'f1': 0.93408555, 'auroc': 0.999587}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     1    6    0     1     1     1    0      3
1     0  1315    0     2    0    0     0    14     0    0      1
2     0     0  253     1   34    0     0     1     0   22      1
3     0     1    1  8298    0    6     0    80    50    3      0
4     0     0    1     0  528    0     0     1     1    0      8
5     0     0    0    15    1  460     0     0     4   41      0
6     2     0    0     1    0    0  1896     2     1    0      5
7     1    16    4    88    6    0     1  7078    58    1     11
8     0     1    0    47   19    0     0    14  3208    0      7
9     0     0   23     0    8   17     1     0     0  444      0
10   15     0    0     6  249    1     4     2    22    1  12490
---- Validation: 
scalar performance:
{'acc': 0.97547144, 'precision': 0.928495, 'recall': 0.9515724, 'specificity': 0.99750984, 'f1': 0.9359718, 'auroc': 0.99956167}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     0    7    0     0     1     0    0      3
1     1  1319    0     1    0    0     0    11     0    0      0
2     0     0  256     1   26    1     0     1     0   26      1
3     0     1    2  8309    0    2     1    77    47    1      0
4     0     1    1     0  527    0     0     0     3    1      6
5     0     0    0    12    0  467     0     0     1   40      1
6     7     0    0     1    1    0  1891     2     2    0      4
7     1    15    2    90    5    1     0  7084    56    2      9
8     1     0    1    45   24    0     4    16  3202    0      3
9     1     0   21     2    3   16     1     1     1  447      0
10    6     0    0     6  261    0     4     1    22    2  12494
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.754845, 'precision': 0.6699251, 'recall': 0.63019323, 'specificity': 0.97515184, 'f1': 0.6285043, 'auroc': 0.8835687}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   990     0    0  37    1    6    72    32     9   21     2
1     4  1298    1  23    1    0     4   142    10    0    16
2    17     0  133   5  468    8    54    23   139   59   109
3     0     0    0   0    0    0     0     0     0    0     0
4     2     0    3   0  529    0     5     2    17    0  1075
5     3     0   11  77   13  262    30     0    15  181     0
6     3     0    0   0    0    0  3059     0     2    0     3
7     0     0    2  32    0    0     1  1124     2    1     2
8     0     0    0  51    3    3    18    10  1282    3     0
9    13     2  128  63   48   95    56    51   143  517    21
10    0     0    0   0   48    0     2     0     1    0  1595
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_16.png
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-07 18:05:58.269784,epoch time: 0:32:30.343166,used: 8:27:27.501448,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9758401, 'precision': 0.9365082, 'recall': 0.9424076, 'specificity': 0.99737245, 'f1': 0.9363672, 'auroc': 0.9995062}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     1    1    0     1     1     0    1      3
1     0  1317    0     3    0    0     0     8     0    0      4
2     0     0  302     0    1    0     1     0     0    7      0
3     1     2    1  8253    0    0     1   158    19    0      0
4     5     0   68     0  404    0     0     1     6    3     52
5     0     0    1    15    0  471     0     0     0   33      1
6    10     1    0     2    0    0  1887     0     2    1      5
7     0    27    7   100    0    0     1  7106    17    1      6
8     1     1    9    95    9    3     1    47  3103    3     23
9     0     0   41     1    0   12     0     1     0  438      0
10    9     0   11     7   30    0     4     4    12    0  12717
---- Validation: 
scalar performance:
{'acc': 0.9757924, 'precision': 0.936059, 'recall': 0.9392659, 'specificity': 0.9973678, 'f1': 0.934304, 'auroc': 0.99949825}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    1     1    1    0     0     0     0    0      5
1     0  1319    0     3    0    0     0     9     0    0      1
2     0     0  306     0    0    1     0     1     0    4      0
3     1     1    1  8245    0    2     0   170    19    1      0
4     6     0   66     0  408    0     0     0     3    2     54
5     0     0    2    19    0  456     0     0     2   41      1
6    15     0    2     2    0    1  1875     4     1    0      8
7     0    39    4    95    0    0     0  7109    13    1      4
8     2     0   10    90    3    0     0    38  3132    0     21
9     0     0   43     4    0   19     0     1     1  425      0
10    9     0    7     7   26    0     3     4    10    0  12730
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70496047, 'precision': 0.6785555, 'recall': 0.57944834, 'specificity': 0.9707462, 'f1': 0.57950604, 'auroc': 0.87809366}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   954     0   13   71    0    8    56    29     6   19    14
1     0  1126    2   27    1    0     4   261     4    0    74
2     4     0  438   33   37   11    13    70   162   52   195
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0   18    0  162    0     3     3    17    0  1429
5     0     0   39  265    0  117     2     1     5  163     0
6     1     0    0    2    0    0  3038     0     0    0    26
7     1     0    1   69    0    0     0  1091     0    0     2
8     0     0    0  158    0    0     6    31  1169    1     5
9     3     0  196  274    1   74     0   127    89  347    26
10    0     0    0    0   10    0     2     0     0    0  1634
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_17.png
better model found
persisted
after epoch: 17,now: 2024-07-07 18:37:33.105059,epoch time: 0:31:34.835275,used: 8:59:02.336723,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97832835, 'precision': 0.96005166, 'recall': 0.9416294, 'specificity': 0.99762964, 'f1': 0.95003045, 'auroc': 0.9995769}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     2    2    0     0     4     1    0      4
1     0  1316    0     0    0    0     0    16     0    0      0
2     0     0  274     0   17    0     1     4     6   10      0
3     0     0    0  8125    0    4     0   230    76    0      0
4     4     0    1     0  418    0     2     0    36    1     77
5     0     0    1     9    0  489     0     0     4   18      0
6     7     0    0     1    0    0  1884     1     4    0     10
7     0     3    0    37    1    0     0  7201    19    0      4
8     0     1    0    17    1    0     0    40  3234    0      1
9     1     0   29     2    1   19     0     1     3  437      0
10    7     0    1     4    9    0     1     3    52    0  12718
---- Validation: 
scalar performance:
{'acc': 0.9760867, 'precision': 0.95517385, 'recall': 0.936661, 'specificity': 0.99737567, 'f1': 0.9450753, 'auroc': 0.9995323}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    4    0     1     3     2    0      4
1     0  1311    0     1    0    0     0    20     0    0      0
2     0     0  269     1   22    2     1     2     4   10      1
3     0     3    0  8105    0    1     2   253    74    1      1
4     4     0    4     0  407    0     1     0    31    0     92
5     0     0    0     4    0  492     0     0     4   20      1
6     6     0    0     2    1    0  1877     3     5    0     14
7     0     1    2    35    1    0     0  7200    23    0      3
8     0     1    1    15    0    0     0    42  3233    0      4
9     0     0   31     1    2   20     0     0     5  433      1
10    5     1    2     5   10    0     2    11    65    0  12695
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6871895, 'precision': 0.6237035, 'recall': 0.5702207, 'specificity': 0.968698, 'f1': 0.54477954, 'auroc': 0.87384695}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   956     0    0   23    0    0    23   136    27    2     3
1     3  1129    0    6    0    0     0   346     3    0    12
2    29     3  109   16  164   10    20   144   387   26   107
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    0    0  153    0     5     6    67    0  1401
5    13     0   12  173    5  251     4     6    23  103     2
6    30     3    0   12    0    0  2929     5    24    0    64
7     0     0    1    2    0    1     0  1159     0    0     1
8     0     0    0   56    0    0     2    63  1247    2     0
9    25     6   96  158   17   90    12   264   199  252    18
10    0     0    0    0    7    0     0     1     1    0  1637
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_18.png
better model found
persisted
after epoch: 18,now: 2024-07-07 19:09:22.839059,epoch time: 0:31:49.734000,used: 9:30:52.070723,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97848886, 'precision': 0.9408922, 'recall': 0.920092, 'specificity': 0.99771863, 'f1': 0.92633593, 'auroc': 0.9996495}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     1    4    0     9     0     1    0      2
1     0  1307    0     0    0    0     0    23     2    0      0
2     0     0  246     0   12    5     0     6     2   40      1
3     2     0    0  8363    0    8     2    45    14    1      1
4     3     0   11     0  445    0     5     3    11    0     61
5     0     0    0     3    0  514     0     0     1    2      0
6     1     0    0     0    0    0  1905     0     0    0      1
7     0     4    0    97    1    0     3  7131    26    0      3
8     1     0    2    91    0    4     2    12  3180    0      3
9     0     0    7     2    0  166     0     1     0  317      0
10    5     0    0     3   14    1    29     6    37    1  12698
---- Validation: 
scalar performance:
{'acc': 0.97865456, 'precision': 0.9439395, 'recall': 0.9235264, 'specificity': 0.9977386, 'f1': 0.9296354, 'auroc': 0.9996515}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    3    0     6     0     0    1      2
1     0  1300    0     2    0    0     0    28     2    0      0
2     0     0  246     0    9    8     2     3     1   42      1
3     0     1    0  8377    0    7     1    37    17    0      0
4     6     0    8     0  452    0     2     3     8    3     57
5     0     0    0     2    0  518     1     0     0    0      0
6     0     0    0     0    0    0  1907     0     1    0      0
7     0     2    0   100    1    0     8  7126    24    0      4
8     0     0    1    78    0    2     4    16  3189    0      6
9     0     0    4     3    0  163     0     0     0  323      0
10    1     0    0     6   17    1    44    10    39    0  12678
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66046315, 'precision': 0.6408112, 'recall': 0.54896426, 'specificity': 0.9655982, 'f1': 0.51791716, 'auroc': 0.87648773}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   566     0   0   42    0   33   472    23    12   11    11
1     4  1088   0   37    1    0     7   311    12    0    39
2     3     0  46   31  135   73    79    77   358   47   166
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   0    0  186    0    14     4    42    0  1386
5     0     0   2   98    0  442    23     0     7   20     0
6     0     0   0    3    0    0  3046     1     4    0    13
7     1     0   0  103    0    0     4  1050     4    0     2
8     0     0   0  130    0    1    16    17  1203    2     1
9     1     0  20  248    4  351    51    91   167  178    26
10    0     0   0    0    7    0     3     1     0    0  1635
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_19.png
better model found
persisted
after epoch: 19,now: 2024-07-07 19:41:21.088820,epoch time: 0:31:58.249761,used: 10:02:50.320484,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98188674, 'precision': 0.95525044, 'recall': 0.95908993, 'specificity': 0.9980546, 'f1': 0.95704675, 'auroc': 0.9997405}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    1     0    4    0     1     1     0    4      4
1     0  1320    0     1    0    0     0     9     2    0      0
2     0     0  273     0    4    0     0     0     0   34      1
3     1    11    0  8140    0    4     2   218    57    4      0
4     3     0   10     0  485    0     0     1     3    0     37
5     0     0    1     6    1  499     0     0     1   13      0
6     7     0    0     0    0    0  1895     0     0    1      5
7     0    11    3    17    1    0     1  7208    16    2      4
8     1     0    6    15    6    2     3    27  3220    2     14
9     0     0    6     1    0   24     0     0     0  460      1
10    4     1    4     6   33    0     1     5     8    0  12731
---- Validation: 
scalar performance:
{'acc': 0.9816504, 'precision': 0.95378727, 'recall': 0.95707446, 'specificity': 0.99803215, 'f1': 0.9551722, 'auroc': 0.99974436}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    2    0     3     0     0    0      7
1     0  1322    0     0    0    0     0     9     1    0      0
2     0     0  268     0    3    0     0     0     1   39      1
3     0    11    0  8143    0    6     2   225    50    3      0
4     4     0   15     1  487    0     0     0     2    1     29
5     0     0    1     6    0  488     0     0     1   24      1
6    13     0    0     1    1    0  1887     0     0    3      3
7     0    12    0    24    2    0     1  7206    12    3      5
8     0     1    3    16    5    0     0    28  3226    0     17
9     0     0    7     0    0   22     0     0     0  464      0
10    5     0    2     5   33    0     5     3     6    0  12737
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75085706, 'precision': 0.6739623, 'recall': 0.6323111, 'specificity': 0.9748968, 'f1': 0.62652624, 'auroc': 0.8833804}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   937     0    5  15    3    1    30    69     8   82    20
1     1  1223    0  12    1    1     0   214    12    3    32
2    12     1  274   2  224    7     5    64   180   69   177
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  392    0     2     3    14    0  1221
5     4     0   15  51    5  251     3     6    11  246     0
6     2     0    1   0    1    0  3023     1     1    1    37
7     0     5    0   1    0    1     0  1154     1    0     2
8     1     0    0  12    2    3     3    45  1293    9     2
9     3     2  188  20    3   81     1   140   103  575    21
10    0     0    0   0   35    0     0     1     0    0  1610
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_20.png
better model found
persisted
after epoch: 20,now: 2024-07-07 20:12:52.917141,epoch time: 0:31:31.828321,used: 10:34:22.148805,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9777932, 'precision': 0.950391, 'recall': 0.9401803, 'specificity': 0.99754715, 'f1': 0.94419485, 'auroc': 0.99967355}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   410     0    0     3    5    0    38     1     0    2     23
1     0  1303    0     1    0    0     0    27     0    0      1
2     0     0  300     0    1    0     0     1     1    7      2
3     1     2    1  8301    0    3     3   102    23    0      1
4     2     0   14     0  467    0     1     0     2    1     52
5     0     0    3     7    0  480     0     0     1   30      0
6     0     0    0     0    0    0  1901     1     1    0      5
7     0     7    1   115    0    0     6  7123     4    1      8
8     0     0    2    65   11    0     4    61  3123    1     29
9     0     0   39     2    0   24     2     1     0  424      0
10    0     0    1     4   40    0    20     2    11    0  12714
---- Validation: 
scalar performance:
{'acc': 0.98036647, 'precision': 0.9568226, 'recall': 0.94395804, 'specificity': 0.99783754, 'f1': 0.94931614, 'auroc': 0.99966365}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   401     0    1     2    5    0    49     2     1    0     22
1     0  1309    0     1    0    0     1    17     0    0      4
2     0     0  297     0    2    0     1     2     2    7      1
3     0     1    1  8324    0    3     0    92    19    0      0
4     1     0   11     0  477    1     1     1     3    1     43
5     0     0    0    12    0  478     0     0     1   30      0
6     0     0    0     1    0    0  1905     0     0    0      2
7     0     4    1    99    0    0     5  7145     4    0      7
8     0     1    4    54    8    1     6    51  3148    0     23
9     0     0   32     1    0   15     1     0     1  443      0
10    0     1    1     5   36    0    19     5     5    0  12724
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6504583, 'precision': 0.61456895, 'recall': 0.53006303, 'specificity': 0.96429557, 'f1': 0.5254545, 'auroc': 0.87360954}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   534     0    1  50    3    1   479    35     4   15    48
1     0  1135    0  27    1    0     4   265     3    0    64
2     0     0  166  13  257    5    26   103   106   25   314
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  228    0     2     3     5    0  1395
5     3     0   10  93    3  142    18     5    11  293    14
6     0     0    0   2    3    0  2734     3     1    0   324
7     0     0    1  51    0    0     1  1109     0    0     2
8     0     0    0  48    5    2    22    62  1223    2     6
9     1     0  244  72   21   58    17   199    86  391    48
10    0     0    0   0   10    0     1     0     0    0  1635
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_21.png
early stop counter: 1
val acc:0.9803664684295654, best validation acc: 0.9816504120826721, corresponding to test acc:                         0.7508570551872253 / 0.7548450231552124
after epoch: 21,now: 2024-07-07 20:44:56.796555,epoch time: 0:32:03.879414,used: 11:06:26.028219,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98333156, 'precision': 0.9627237, 'recall': 0.9512738, 'specificity': 0.99813557, 'f1': 0.9565158, 'auroc': 0.99976325}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     5    3    1     7     3     0    2     10
1     0  1309    0     0    0    0     0    21     2    0      0
2     0     0  279     0    1    0     0     2     0   28      2
3     0     6    0  8301    0    2     0    93    32    2      2
4     4     1   22     0  444    1     2     2     8    0     55
5     0     0    1     5    0  498     0     0     1   14      1
6     1     0    0     0    0    0  1896     2     1    2      4
7     0     4    0    47    2    0     1  7190     7    2     11
8     0     0    2    41    4    0     1    45  3161    3     39
9     0     0   10     0    1   16     0     0     0  466      0
10    1     2    1     3   18    0     1     2     7    1  12757
---- Validation: 
scalar performance:
{'acc': 0.9837368, 'precision': 0.9659977, 'recall': 0.9527186, 'specificity': 0.9981707, 'f1': 0.95870835, 'auroc': 0.9997562}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    0     2    2    2     5     6     0    1     17
1     0  1310    0     0    0    0     0    21     0    0      1
2     0     0  281     0    0    0     0     2     1   28      0
3     0     9    0  8310    0    1     1    88    27    3      1
4     6     0   24     0  440    0     0     1    11    0     57
5     0     0    0     2    0  508     0     0     0   11      0
6     0     1    0     3    0    0  1893     6     0    0      5
7     0     0    0    61    0    0     1  7183    14    0      6
8     0     0    3    29    2    1     0    34  3182    3     42
9     0     0    5     0    0   17     0     1     2  468      0
10    1     3    2     2   15    0     5     4    10    0  12754
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6782341, 'precision': 0.6371317, 'recall': 0.5699602, 'specificity': 0.96746695, 'f1': 0.55680555, 'auroc': 0.86894125}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   677     1   13  32    3    7   142    62     7   64   162
1     0  1158    0  18    1    1     2   299     6    1    13
2     0     2  165  10   80   11     4    64   233   51   395
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    2   0  129    0     3     3    14    0  1482
5     1     0   47  75    8  261     1     2    10  175    12
6     0     2    1   4    3    0  2763     5    15    0   274
7     0     0    0  14    0    1     0  1144     2    0     3
8     0     0    0  38    1   10     4    39  1266    4     8
9     1     2  125  71   11  125     2   101   151  491    57
10    0     1    0   0    3    0     1     1     0    0  1640
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_22.png
better model found
persisted
after epoch: 22,now: 2024-07-07 21:16:26.577818,epoch time: 0:31:29.781263,used: 11:37:55.809482,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.9549985, 'recall': 0.9292872, 'specificity': 0.99780965, 'f1': 0.9387108, 'auroc': 0.99970293}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     1    0     3    6    0     5     0     1    1     11
1     0  1270    0     1    0    0     0    58     3    0      0
2     0     0  284     0    9    2     0     2     3   10      2
3     1     2    0  8389    0    6     1    30     9    0      0
4     2     0    8     1  431    0     0     1     3    0     93
5     0     0    0     2    0  516     0     0     0    3      0
6     0     0    0     2    0    4  1893     0     1    0      8
7     0     2    2   100    1    0     1  7128    21    0      9
8     0     0    0    71    4    0     0    15  3174    0     31
9     0     0   25     5    2  114     0     0     3  344      0
10    2     0    2     5    5    0     3     4     8    0  12762
---- Validation: 
scalar performance:
{'acc': 0.98074096, 'precision': 0.95926076, 'recall': 0.9352136, 'specificity': 0.9978316, 'f1': 0.9442617, 'auroc': 0.99973094}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    0     4    7    0     8     0     0    0     16
1     0  1270    0     2    0    0     0    58     1    0      1
2     1     0  296     1    5    1     0     1     1    5      1
3     0     0    0  8388    0    2     2    36    12    0      0
4     1     0    4     0  445    0     1     1     3    1     83
5     0     0    1     6    0  512     0     0     0    2      0
6     1     0    0     1    1    0  1902     0     0    0      3
7     1     2    1    94    2    0     1  7130    23    0     11
8     1     0    1    78    2    1     0    24  3157    0     32
9     0     0   24     1    2  109     0     0     1  356      0
10    4     0    0     7    7    0     2     7     8    0  12761
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6835514, 'precision': 0.6177961, 'recall': 0.5787076, 'specificity': 0.96828973, 'f1': 0.54020107, 'auroc': 0.86902046}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   907     0    2   25   1   39    83    20     3   18    72
1     0  1025    0   20   0    1     2   375    13    0    63
2     3     3  142   15  78   77    19    49   267   36   326
3     0     0    0    0   0    0     0     0     0    0     0
4     0     0    2    0  37    0     3     2     8    0  1581
5     2     0    7   99   0  413     1     2     8   53     7
6     0     0    0    3   0    0  3017     1     2    0    44
7     0     0    0   16   0    1     1  1143     2    0     1
8     0     0    0   81   0   10     1    26  1246    0     6
9     1     2   77  139   1  396     2    89   185  197    48
10    0     0    0    0   0    0     2     1     0    0  1643
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_23.png
early stop counter: 1
val acc:0.9807409644126892, best validation acc: 0.9837368130683899, corresponding to test acc:                         0.6782341003417969 / 0.7548450231552124
after epoch: 23,now: 2024-07-07 21:48:15.346517,epoch time: 0:31:48.768699,used: 12:09:44.578181,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98450875, 'precision': 0.97293097, 'recall': 0.96001303, 'specificity': 0.9982414, 'f1': 0.9657146, 'auroc': 0.9997834}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     0    1    0     7     0     0    1      8
1     0  1320    0     0    0    0     0    12     0    0      0
2     0     0  302     0    2    0     0     2     0    5      0
3     3     1    1  8282    0    4     1    91    45    5      4
4     4     0    3     0  440    0     0     2     2    3     85
5     0     0    0     5    0  485     0     0     0   31      0
6     0     0    1     2    0    0  1901     0     1    1      2
7     1     9    0    56    0    0     0  7174    18    0      5
8     0     0    2    72    6    1     0    18  3178    0     19
9     0     0   11     0    0    8     0     1     0  472      1
10    1     0    1     0    3    0     1     2     8    0  12777
---- Validation: 
scalar performance:
{'acc': 0.9830146, 'precision': 0.967137, 'recall': 0.95092934, 'specificity': 0.9980889, 'f1': 0.95801985, 'auroc': 0.9997751}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    1     0    1    0     6     2     0    2     16
1     0  1320    0     0    0    0     0    12     0    0      0
2     0     0  292     0    3    0     0     2     0   14      1
3     1     1    1  8296    0    1     0    77    58    0      5
4     4     0    6     0  439    0     0     3     3    2     82
5     0     0    0     6    0  471     0     0     0   44      0
6     0     0    0     2    0    0  1899     0     1    2      4
7     1     6    3    62    1    0     1  7157    27    0      7
8     0     0    2    80    2    0     1    23  3176    1     11
9     0     0   18     0    0    8     0     0     0  467      0
10    2     0    0     2    3    0     1     4     5    1  12778
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6937662, 'precision': 0.66726756, 'recall': 0.57483155, 'specificity': 0.9692302, 'f1': 0.57571745, 'auroc': 0.8655772}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   847     0    2   33   0    4   163    26     8   27    60
1     5  1107    0   38   0    1    18   227    18    4    81
2     2     0  252   30  71    3    15    21   149   93   379
3     0     0    0    0   0    0     0     0     0    0     0
4     1     0    2    1  64    0     3     0     6    0  1556
5     1     0   10  123   1  204     3     1     7  234     8
6     0     0    1    3   0    0  3031     1     2    0    29
7     4     0    1  106   0    2     3  1042     4    0     2
8     0     0    0  181   0    4    12    11  1145    7    10
9     3     1  113  168   0   73     4    44   102  582    47
10    0     0    0    0   1    0     3     0     0    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_24.png
early stop counter: 2
val acc:0.9830145835876465, best validation acc: 0.9837368130683899, corresponding to test acc:                         0.6782341003417969 / 0.7548450231552124
after epoch: 24,now: 2024-07-07 22:19:38.982708,epoch time: 0:31:23.636191,used: 12:41:08.214372,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9851242, 'precision': 0.96095634, 'recall': 0.9712428, 'specificity': 0.9984456, 'f1': 0.9656873, 'auroc': 0.999846}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    2    0     0     2     0    0      3
1     0  1319    0     3    0    0     0     9     0    0      0
2     2     0  293     0    7    1     0     1     0    8      0
3     1     1    1  8155    0   22     1   149   106    2      1
4     3     0    4     0  510    0     0     0     3    2     17
5     0     0    1     1    0  515     0     0     0    4      0
6    13     0    0     1    0    0  1890     1     1    0      2
7     1     7    0    12    0    0     0  7222    20    0      3
8     0     0    0     6    0    0     0    10  3271    0      7
9     0     0   20     0    0   30     0     2     0  440      0
10    3     3    0     1   44    0     2     4     6    0  12729
---- Validation: 
scalar performance:
{'acc': 0.9854755, 'precision': 0.96039736, 'recall': 0.9720135, 'specificity': 0.99849033, 'f1': 0.96584046, 'auroc': 0.99987423}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    3    0     0     1     0    0      2
1     0  1321    0     3    0    0     0     8     0    0      0
2     1     0  288     0   10    2     1     0     0    9      1
3     1     0    1  8178    0   20     0   131   106    2      1
4     5     0    1     0  515    0     0     0     3    1     14
5     1     0    2     0    0  512     0     0     1    4      1
6    12     0    0     1    0    0  1886     3     1    0      5
7     1     9    0    16    1    0     0  7215    20    0      3
8     3     0    3     6    3    0     0    11  3267    0      3
9     0     0   16     0    0   25     0     0     1  451      0
10    4     1    1     1   46    0     0     4     7    0  12732
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75435525, 'precision': 0.6598706, 'recall': 0.6476696, 'specificity': 0.9752486, 'f1': 0.6251972, 'auroc': 0.87866646}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1085     0    0   6    0    9    13    26     5   17     9
1      2  1293    1  11    1    1     2   146    28    2    12
2     26     3  197   1  301   32     6    17   203   31   198
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    1   0  377    0     3     1    23    0  1227
5     15     0    2  14    4  438     5     0    16   90     8
6      2     0    0   1    1    0  3022     0     4    0    37
7      1     1    0  41    0    1     0  1108    10    0     2
8      4     0    1   6    5   12     3     6  1330    0     3
9     27     2  190   8   31  259     0    41   219  323    37
10     0     0    0   0   35    0     1     0     1    0  1609
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_25.png
better model found
persisted
after epoch: 25,now: 2024-07-07 22:51:05.200031,epoch time: 0:31:26.217323,used: 13:12:34.431695,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9880672, 'precision': 0.9673599, 'recall': 0.9694113, 'specificity': 0.9986837, 'f1': 0.9678547, 'auroc': 0.99987406}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     1    5    1     0     0     0    0      4
1     0  1318    0     1    0    0     0    13     0    0      0
2     0     0  305     0    2    0     0     1     1    3      0
3     1     0    0  8374    0    3     1    46    12    0      0
4     2     0    9     0  500    0     0     0     2    0     26
5     0     0    3     5    0  505     0     0     1    7      0
6     7     0    1     1    2    0  1883     3     1    0     10
7     0     5    1    53    0    0     1  7186    11    2      5
8     0     1    0    23    3    2     1    35  3197    0     33
9     0     0   31     2    1   22     0     0     0  437      0
10    6     1    3     1   21    0     0     1     6    0  12753
---- Validation: 
scalar performance:
{'acc': 0.9886853, 'precision': 0.9697726, 'recall': 0.9726459, 'specificity': 0.9987581, 'f1': 0.970819, 'auroc': 0.9998813}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    5    0     0     0     0    0      2
1     0  1315    0     0    0    0     0    16     0    0      1
2     0     0  304     0    5    0     0     0     0    3      0
3     1     0    1  8375    0    3     0    38    22    0      0
4     0     0    7     0  509    0     0     1     2    0     20
5     0     0    0     3    0  507     0     0     1   10      0
6     7     0    0     0    2    0  1884     4     1    0     10
7     0     5    2    47    1    0     1  7195     7    0      7
8     0     2    2    34    3    1     0    31  3201    0     22
9     0     0   29     7    1   14     0     0     0  442      0
10    3     0    1     2   27    0     0     5     4    0  12754
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7125166, 'precision': 0.646697, 'recall': 0.59877396, 'specificity': 0.97118056, 'f1': 0.5886013, 'auroc': 0.8754195}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1008     0    5   15    1    4    23    56     8   26    24
1      1  1136    1   24    1    0     0   286     9    0    41
2     13     2  203    9  203   15     4    79   262   33   192
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    3    0  224    0     1     3    31    0  1370
5      2     0   18  116    5  267     3     3    17  152     9
6      6     0    0    8    2    0  2936     5     7    0   103
7      0     0    1   49    0    0     0  1110     0    0     4
8      0     0    0   38    0    6     5    28  1286    2     5
9      6     2  187  125   15   91     0    78   208  389    36
10     0     0    0    0   21    0     0     0     0    0  1625
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_26.png
better model found
persisted
after epoch: 26,now: 2024-07-07 23:23:11.741381,epoch time: 0:32:06.541350,used: 13:44:40.973045,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9835991, 'precision': 0.96866906, 'recall': 0.96550304, 'specificity': 0.9981935, 'f1': 0.96647155, 'auroc': 0.9998624}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    3    0     0     1     0    1      5
1     0  1325    0     0    0    0     0     6     0    0      0
2     0     0  295     0    5    0     1     0     0   11      0
3     0     1    1  8135    0    3     0   240    56    3      0
4     1     0    4     0  490    0     0     0     2    1     41
5     0     0    1     5    0  464     1     0     1   49      0
6     3     0    1     2    0    0  1892     1     0    0      9
7     0    17    1     6    1    0     0  7225     7    0      6
8     2     0    4    16    1    0     0    29  3219    3     22
9     0     0    9     0    0    1     0     0     1  481      1
10    1     0    1     2   11    0     3     3     5    1  12764
---- Validation: 
scalar performance:
{'acc': 0.9830948, 'precision': 0.9696299, 'recall': 0.96266365, 'specificity': 0.9981332, 'f1': 0.96548873, 'auroc': 0.99986076}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     2    3    0     1     1     2    1      9
1     0  1328    0     0    0    0     0     3     0    0      1
2     0     0  290     0    4    0     0     2     0   15      1
3     0     3    0  8135    0    2     0   240    57    3      0
4     2     0    5     0  481    0     0     1     3    5     42
5     0     0    1     6    0  471     0     0     1   41      1
6     4     0    0     1    0    0  1896     3     1    0      3
7     0    10    1    10    1    0     0  7227     7    2      7
8     1     1    2    16    3    0     0    37  3210    4     22
9     0     0    6     0    0    2     0     0     1  484      0
10    0     0    0     3   12    0     3     3     7    1  12767
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7421815, 'precision': 0.6649036, 'recall': 0.6119813, 'specificity': 0.9739409, 'f1': 0.59518266, 'auroc': 0.87675256}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1040     0    0  13    1    0    29    36     2   35    14
1      1  1290    0  10    0    0     1   149     6    1    41
2     20     5  209   3  328    1    13    54   154   81   147
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    1   0  207    0    13     2    16    0  1393
5      4     0   15  64    4  106     5     2    21  369     2
6      0     0    1   1    0    0  3051     1     5    0     8
7      1     0    0  10    0    0     1  1147     0    3     2
8      2     0    0  21    1    2     5    30  1300    6     3
9     14    10  143  31   19   14     3    87   166  624    26
10     0     0    0   0    8    0     3     1     0    0  1634
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_27.png
early stop counter: 1
val acc:0.9830948114395142, best validation acc: 0.9886853098869324, corresponding to test acc:                         0.7125166058540344 / 0.7548450231552124
after epoch: 27,now: 2024-07-07 23:54:55.155406,epoch time: 0:31:43.414025,used: 14:16:24.387070,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9850439, 'precision': 0.9706524, 'recall': 0.96135616, 'specificity': 0.9983183, 'f1': 0.9658412, 'auroc': 0.9997829}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     1    4    0     0     0     0    0     16
1     0  1327    0     0    0    0     0     5     0    0      0
2     1     0  292     0   10    0     1     1     2    5      0
3     0     0    0  8304    0    0     1   105    27    0      1
4     4     0    4     1  483    0     0     0     0    0     47
5     0     0    0    18    0  481     0     0     1   21      0
6    10     0    0     1    0    0  1869     0     3    3     22
7     0     8    1    73    1    0     0  7143    31    0      5
8     1     0    1    43    5    0     0    10  3225    0     11
9     0     0   18     2    3    3     0     1     1  465      0
10    3     0    1     0   13    0     0     3     6    0  12766
---- Validation: 
scalar performance:
{'acc': 0.98448575, 'precision': 0.968658, 'recall': 0.95797986, 'specificity': 0.99825364, 'f1': 0.96289545, 'auroc': 0.9997568}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     1    5    0     0     2     0    0     15
1     0  1330    0     0    0    0     1     1     0    0      0
2     1     0  296     1    6    0     1     1     0    6      0
3     0     1    0  8311    0    2     0    97    29    0      0
4     3     0    4     0  475    0     0     0     5    0     52
5     0     0    2    13    1  467     0     0     2   36      0
6    13     0    0     1    0    0  1862     1     3    1     27
7     0     9    0    77    0    0     0  7145    25    0      9
8     0     0    1    54    3    0     0     9  3220    0      9
9     0     0   22     1    1    4     0     0     1  464      0
10    3     0    1     1    4    0     0     2    10    0  12775
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7113272, 'precision': 0.64554894, 'recall': 0.5778523, 'specificity': 0.9709986, 'f1': 0.5591039, 'auroc': 0.8720775}
confusion matrix:
     0     1    2    3    4   5     6     7     8    9     10
0   880     0    0   19    1   1    21   102     8   82    56
1     2  1314    0    6    2   0     0   155     5    0    15
2    24     4  223    9  167   3     9   113   149   44   270
3     0     0    0    0    0   0     0     0     0    0     0
4     1     0    1    0  180   0     1     4    12    0  1434
5     3     0   21  159    2  71     7    17    25  284     3
6     1     0    1    4    1   0  2997     1     3    0    59
7     0     0    1    5    0   0     0  1155     0    1     2
8     0     0    1   27    0   0     3    60  1273    2     4
9    15     4  192   81   13  16     1   189   157  438    31
10    0     0    0    0    9   0     0     1     0    0  1636
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_28.png
early stop counter: 2
val acc:0.9844857454299927, best validation acc: 0.9886853098869324, corresponding to test acc:                         0.7125166058540344 / 0.7548450231552124
after epoch: 28,now: 2024-07-08 00:26:45.685935,epoch time: 0:31:50.530529,used: 14:48:14.917599,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98927116, 'precision': 0.96706307, 'recall': 0.97793716, 'specificity': 0.99889535, 'f1': 0.9718624, 'auroc': 0.9999149}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    2    0     0     0     0    0      2
1     0  1324    0     0    0    0     0     6     1    0      0
2     1     0  283     0   23    0     0     0     0    5      0
3     0     0    0  8373    1    5     0    33    28    0      0
4     4     0    0     0  532    0     0     0     0    0      3
5     0     0    0     2    1  499     0     0     2   17      0
6    10     1    0     0    2    1  1889     0     1    0      4
7     1    11    0    65    1    0     0  7155    25    0      5
8     1     0    0    10    2    0     0     5  3277    0      1
9     0     0    9     1    2    5     0     0     0  476      0
10   16     0    1     2   59    0     1     6    17    0  12688
---- Validation: 
scalar performance:
{'acc': 0.9884713, 'precision': 0.9649057, 'recall': 0.9766282, 'specificity': 0.9988233, 'f1': 0.9698962, 'auroc': 0.99991506}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     1    2    0     0     0     0    0      0
1     0  1323    0     1    0    0     0     7     1    0      0
2     1     0  283     0   25    0     0     0     0    3      0
3     1     0    0  8364    0    2     0    40    32    0      1
4     4     0    0     0  531    0     0     0     0    0      4
5     1     0    0     3    2  500     0     0     2   13      0
6    17     0    0     0    0    0  1884     1     4    0      2
7     0    12    0    58    2    0     0  7156    35    0      2
8     0     0    0     3    4    0     0     3  3284    0      2
9     1     0    9     3    2    6     0     1     1  470      0
10   14     0    1     3   75    0     1     8    15    0  12679
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7245505, 'precision': 0.6472362, 'recall': 0.6000827, 'specificity': 0.9723573, 'f1': 0.58602077, 'auroc': 0.8728198}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1072     0    1   13    6    4     4    40     4   19     7
1     11  1227    0   21    1    0     2   204     9    1    23
2     13     0  100   10  320    5     6   102   284   36   139
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    1    0  398    0     5     4    34    0  1190
5      6     0   14  123   12  172     3     4    28  229     1
6     14     0    0    5    6    0  2905     3     8    0   126
7      1     0    0   15    0    0     0  1144     2    0     2
8      2     0    1   33    0    1     1    29  1299    3     1
9      9     1  109  109   38   42     1   174   200  428    26
10     1     0    0    0   31    0     1     1     1    0  1611
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_29.png
early stop counter: 3
val acc:0.9884713292121887, best validation acc: 0.9886853098869324, corresponding to test acc:                         0.7125166058540344 / 0.7548450231552124
after epoch: 29,now: 2024-07-08 00:58:22.803276,epoch time: 0:31:37.117341,used: 15:19:52.034940,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9877194, 'precision': 0.96703434, 'recall': 0.97421837, 'specificity': 0.99869084, 'f1': 0.96987563, 'auroc': 0.9999012}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    4    0     0     0     0    0      0
1     0  1306    0     2    0    0     0    21     1    1      1
2     0     0  284     0   17    1     0     0     0   10      0
3     2     0    0  8398    0   14     0    11    10    0      0
4     2     0    0     0  527    0     0     0     0    0     10
5     0     0    0     0    0  520     0     0     0    1      0
6     9     0    0     4    0    0  1886     2     3    0      4
7     0     0    1   157    1    0     0  7085    18    0      2
8     0     0    0    23    2    4     0     4  3261    0      1
9     1     0    6     0    5   30     0     0     0  451      0
10    6     0    1     1   58    0     3     0     5    0  12721
---- Validation: 
scalar performance:
{'acc': 0.9872944, 'precision': 0.9641193, 'recall': 0.9732649, 'specificity': 0.9986629, 'f1': 0.9676508, 'auroc': 0.99991024}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    5    0     0     0     0    0      1
1     0  1304    0     1    0    0     0    27     0    0      0
2     0     0  277     1   14    1     0     1     0   16      2
3     1     0    0  8393    0   13     2     9    21    1      0
4     1     0    0     0  532    0     0     0     0    0      6
5     0     0    0     0    0  516     0     0     0    5      0
6     7     0    0     0    0    2  1897     0     0    0      2
7     2     0    0   129    0    0     0  7105    24    0      5
8     1     0    0    14    6    1     0     8  3258    0      8
9     0     0    1     1    2   32     0     0     0  457      0
10   12     0    1     3   77    0     2     0     7    0  12694
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7085986, 'precision': 0.6462629, 'recall': 0.60022914, 'specificity': 0.9708954, 'f1': 0.5824625, 'auroc': 0.8745353}
confusion matrix:
      0    1   2    3    4    5     6    7     8    9     10
0   1072    0   0   15    3   23    13    6     2   20    16
1     10  891   0   44    1    7     2  452    18    1    73
2     18    0  71   15  356   23     4   23   219   61   225
3      0    0   0    0    0    0     0    0     0    0     0
4      2    0   0    0  380    0     7    1    14    0  1229
5      5    0   1   48   11  405     0    0     5  115     2
6     14    0   0    2    1    1  3026    0     3    0    20
7      4    0   0  211    0    1     0  938     5    1     4
8      3    0   0   50    1   25     1    4  1278    4     4
9     13    0  45   58   36  278     3   40   168  456    40
10     0    0   0    0   33    0     2    0     0    0  1611
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_30.png
early stop counter: 4
val acc:0.9872943758964539, best validation acc: 0.9886853098869324, corresponding to test acc:                         0.7125166058540344 / 0.7548450231552124
after epoch: 30,now: 2024-07-08 01:29:50.679461,epoch time: 0:31:27.876185,used: 15:51:19.911125,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:51:19.911125 at 2024-07-08 01:29:50.679461
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7125166, 'precision': 0.646697, 'recall': 0.59877396, 'specificity': 0.97118056, 'f1': 0.5886013, 'auroc': 0.8754195}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1008     0    5   15    1    4    23    56     8   26    24
1      1  1136    1   24    1    0     0   286     9    0    41
2     13     2  203    9  203   15     4    79   262   33   192
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    3    0  224    0     1     3    31    0  1370
5      2     0   18  116    5  267     3     3    17  152     9
6      6     0    0    8    2    0  2936     5     7    0   103
7      0     0    1   49    0    0     0  1110     0    0     4
8      0     0    0   38    0    6     5    28  1286    2     5
9      6     2  187  125   15   91     0    78   208  389    36
10     0     0    0    0   21    0     0     0     0    0  1625
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.754845, 'precision': 0.6699251, 'recall': 0.63019323, 'specificity': 0.97515184, 'f1': 0.6285043, 'auroc': 0.8835687}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   990     0    0  37    1    6    72    32     9   21     2
1     4  1298    1  23    1    0     4   142    10    0    16
2    17     0  133   5  468    8    54    23   139   59   109
3     0     0    0   0    0    0     0     0     0    0     0
4     2     0    3   0  529    0     5     2    17    0  1075
5     3     0   11  77   13  262    30     0    15  181     0
6     3     0    0   0    0    0  3059     0     2    0     3
7     0     0    2  32    0    0     1  1124     2    1     2
8     0     0    0  51    3    3    18    10  1282    3     0
9    13     2  128  63   48   95    56    51   143  517    21
10    0     0    0   0   48    0     2     0     1    0  1595
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_09_38_30_seed_0_21716730_instance_wise_predictions.txt
accuracy from prediction file 0.712516616525572
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/2.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 458977 KiB |   6809 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 415725 KiB |   6773 MiB |   1450 TiB |   1450 TiB |
|       from small pool |  43251 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 458977 KiB |   6809 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 415725 KiB |   6773 MiB |   1450 TiB |   1450 TiB |
|       from small pool |  43251 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 449054 KiB |   6803 MiB |   1467 TiB |   1467 TiB |
|       from large pool | 407075 KiB |   6767 MiB |   1449 TiB |   1449 TiB |
|       from small pool |  41979 KiB |     60 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7500 MiB |   7500 MiB |   7500 MiB |      0 B   |
|       from large pool |   7436 MiB |   7436 MiB |   7436 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 433951 KiB | 703689 KiB |   1100 TiB |   1100 TiB |
|       from large pool | 428050 KiB | 694392 KiB |   1082 TiB |   1082 TiB |
|       from small pool |   5900 KiB |  14742 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4556    |    6799    |  244115 K  |  244111 K  |
|       from large pool |     187    |     783    |  135552 K  |  135552 K  |
|       from small pool |    4369    |    6537    |  108562 K  |  108558 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4556    |    6799    |  244115 K  |  244111 K  |
|       from large pool |     187    |     783    |  135552 K  |  135552 K  |
|       from small pool |    4369    |    6537    |  108562 K  |  108558 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     342    |     342    |     342    |       0    |
|       from large pool |     310    |     310    |     310    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      62    |    1570    |  147478 K  |  147478 K  |
|       from large pool |      37    |     309    |   91278 K  |   91278 K  |
|       from small pool |      25    |    1533    |   56200 K  |   56200 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6809 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   1450 TiB |   1450 TiB |
|       from small pool |      0 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6809 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   1450 TiB |   1450 TiB |
|       from small pool |      0 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6803 MiB |   1467 TiB |   1467 TiB |
|       from large pool |  16640 KiB |   6767 MiB |   1449 TiB |   1449 TiB |
|       from small pool |      0 KiB |     60 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    872 MiB |   7500 MiB |   7500 MiB |   6628 MiB |
|       from large pool |    824 MiB |   7436 MiB |   7436 MiB |   6612 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 703689 KiB |   1100 TiB |   1100 TiB |
|       from large pool |  24320 KiB | 694392 KiB |   1082 TiB |   1082 TiB |
|       from small pool |      0 KiB |  38227 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6799    |  244115 K  |  244115 K  |
|       from large pool |       2    |     783    |  135552 K  |  135552 K  |
|       from small pool |       0    |    6537    |  108562 K  |  108562 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6799    |  244115 K  |  244115 K  |
|       from large pool |       2    |     783    |  135552 K  |  135552 K  |
|       from small pool |       0    |    6537    |  108562 K  |  108562 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     342    |     342    |     281    |
|       from large pool |      37    |     310    |     310    |     273    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1570    |  147479 K  |  147479 K  |
|       from large pool |       3    |     309    |   91278 K  |   91278 K  |
|       from small pool |       0    |    1533    |   56201 K  |   56201 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6809 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   1450 TiB |   1450 TiB |
|       from small pool |      0 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6809 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   1450 TiB |   1450 TiB |
|       from small pool |      0 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6803 MiB |   1467 TiB |   1467 TiB |
|       from large pool |  16640 KiB |   6767 MiB |   1449 TiB |   1449 TiB |
|       from small pool |      0 KiB |     60 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    872 MiB |   7500 MiB |   7500 MiB |   6628 MiB |
|       from large pool |    824 MiB |   7436 MiB |   7436 MiB |   6612 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 703689 KiB |   1100 TiB |   1100 TiB |
|       from large pool |  24320 KiB | 694392 KiB |   1082 TiB |   1082 TiB |
|       from small pool |      0 KiB |  38227 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6799    |  244115 K  |  244115 K  |
|       from large pool |       2    |     783    |  135552 K  |  135552 K  |
|       from small pool |       0    |    6537    |  108562 K  |  108562 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6799    |  244115 K  |  244115 K  |
|       from large pool |       2    |     783    |  135552 K  |  135552 K  |
|       from small pool |       0    |    6537    |  108562 K  |  108562 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     342    |     342    |     281    |
|       from large pool |      37    |     310    |     310    |     273    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1570    |  147479 K  |  147479 K  |
|       from large pool |       3    |     309    |   91278 K  |   91278 K  |
|       from small pool |       0    |    1533    |   56201 K  |   56201 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730

 Experiment start at: 2024-07-08 01:42:54.440372
before training, model accuracy: 0.10312740504741669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92805547, 'precision': 0.83893573, 'recall': 0.7656053, 'specificity': 0.9923423, 'f1': 0.75415707, 'auroc': 0.9942767}
confusion matrix:
     0     1    2     3    4   5     6     7     8    9      10
0   414     0    0     4    0   0     8     6     6   12     33
1     0  1288    0    11    1   0     0    26     4    0      2
2     1     0  158     2    5   0     2     9    10  121      4
3     6     6    2  8006    0   0     9   234   166    8      2
4     8     1  120     0  144   0     2     4    53   21    186
5     1     0    0    96    0  84     0     0     9  330      1
6    26     1    0     3    0   0  1830     0     9   10     28
7     4    94    6   227    1   0     5  6740   158   12     15
8     1     4    5   145    2   0     1    68  3038   13     18
9     0     0    8    10    0   0     0     3    12  456      4
10   36     3   19     7   20   0    24    22   122   11  12529
---- Validation: 
scalar performance:
{'acc': 0.9269761, 'precision': 0.825711, 'recall': 0.7593817, 'specificity': 0.9922417, 'f1': 0.7431767, 'auroc': 0.9941169}
confusion matrix:
     0     1    2     3    4   5     6     7     8    9      10
0   412     1    0     5    0   0     9     4     9   11     32
1     0  1295    0    10    0   0     0    19     4    1      3
2     0     3  152     1   11   0     1    13     8  121      2
3     9     4    1  7987    0   0    14   234   175   15      1
4     4     0  128     1  123   0     1     6    57   21    198
5     0     0    1   100    0  74     0     0     8  337      1
6    26     0    0     1    0   0  1839     0     6    7     29
7     3   101    6   230    1   0     6  6750   142   10     16
8     3     5    6   141    3   0     4    66  3045    6     17
9     0     1   17    10    0   1     0     2     3  458      1
10   47     4   20     7   24   0    21    21   113   19  12520
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7047506, 'precision': 0.6990062, 'recall': 0.57430863, 'specificity': 0.97025985, 'f1': 0.53102994, 'auroc': 0.8859224}
confusion matrix:
      0     1   2    3    4   5     6     7     8    9     10
0   1056     2   0    3    0   0    23     5     8   67     6
1      1  1325   0   23    0   0     2   118     2    0    28
2     31     6  41    2   91   0     1    83   373  174   213
3      0     0   0    0    0   0     0     0     0    0     0
4      1     0   1    0  154   0     1     4    24    1  1447
5     14     0   0  107    0  14     2     0    29  424     2
6      1     0   0    1    1   0  2792     4    37    0   231
7     12     0   0   21    0   0    17  1102     6    1     5
8      4     0   0   46    1   0     2    10  1302    4     1
9     34    18   7   69    1   0     2   102   240  646    18
10     0     0   0    0    4   0     0     0     1    0  1641
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-08 02:15:31.847894,epoch time: 0:32:37.407522,used: 0:32:37.407522,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9440818, 'precision': 0.8785473, 'recall': 0.8160565, 'specificity': 0.9937044, 'f1': 0.8358662, 'auroc': 0.99631166}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   377     0    0     9    1    0    13     8     0   17     58
1     0  1253    0    16    0    0     0    51     3    0      8
2     0     0  170     1   56    1     1     8     1   72      2
3     2     0    1  8210    1    8     2   113    96    5      1
4     2     0   11     1  314    1     0     4     6    8    192
5     0     0    4    34    1  266     0     0     2  212      1
6     7     1    0    16    3    0  1845     2     4    5     24
7     3    10    1   300    5    0     2  6871    39    4     27
8     3     0    6   158   26    0     0   116  2839    8    139
9     0     0   27     9    8   13     0     4     0  431      1
10    7     0    4    10   34    0    10    11     5    4  12710
---- Validation: 
scalar performance:
{'acc': 0.94409525, 'precision': 0.8808595, 'recall': 0.810892, 'specificity': 0.9936901, 'f1': 0.83359194, 'auroc': 0.99629354}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   371     0    0    13    1    0    14     7     0   19     58
1     0  1250    0    16    0    0     0    53     3    0     10
2     0     0  169     2   57    1     0    11     2   68      2
3     1     1    1  8219    1    7     1   112    89    7      1
4     4     0   13     1  310    0     0     6     9    4    192
5     0     0    1    40    4  256     0     0     3  215      2
6     5     0    0    12    5    0  1851     0     2    5     28
7     1     8    3   280    4    0     3  6893    41    2     30
8     1     0    5   176   19    1     2   100  2845    6    141
9     0     1   24    12   11   14     0     5     3  422      1
10    1     0    2    10   38    0    18    14     3    1  12709
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6425523, 'precision': 0.62850887, 'recall': 0.5193149, 'specificity': 0.96448475, 'f1': 0.5099657, 'auroc': 0.86848295}
confusion matrix:
     0    1   2    3    4    5     6     7     8    9     10
0   799    0   0  126    6    0    51    23     2  138    25
1     1  824   0   54    0    0     2   544     3    0    71
2     4    0  27   57  278    2     0   150   142   85   270
3     0    0   0    0    0    0     0     0     0    0     0
4     0    0   0    0   65    0     1     3    13    1  1550
5     1    0   0  193    6  156     0     0    12  222     2
6     0    0   0    3    0    0  2962     5     5    0    92
7     2    0   0   97    0    0     0  1060     0    0     5
8     1    0   0  173    1    0     3    15  1162    2    13
9     2    0  22  312   28   16     2   162    64  485    44
10    0    0   0    0    0    0     0     1     1    0  1644
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_2.png
better model found
persisted
after epoch: 2,now: 2024-07-08 02:47:11.762195,epoch time: 0:31:39.914301,used: 1:04:17.321823,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94863015, 'precision': 0.84732383, 'recall': 0.8524864, 'specificity': 0.9945763, 'f1': 0.84314436, 'auroc': 0.9967901}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   417     1    0     4    2    0    25     0     6    2     26
1     0  1292    0     8    0    0     0    22     6    0      4
2     0     1  256     0    7    4     1     3     4   36      0
3     0     2    2  8180    0   11     0   130   114    0      0
4     4     0  118     2  259    1     2     2    33    9    109
5     0     0    3    35    0  449     1     0     8   24      1
6     4     0    2     4    0    1  1880     0     4    2     10
7     0    43   18   212    1    0     1  6905    75    2      6
8     3     2   14   113   13    0     1    67  3058    2     23
9     1     0   65    11    1  124     0     1     7  282      1
10   17     1   55     7  132    1    36    16    44    4  12478
---- Validation: 
scalar performance:
{'acc': 0.94735855, 'precision': 0.848317, 'recall': 0.8519512, 'specificity': 0.99442583, 'f1': 0.8423448, 'auroc': 0.99687415}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   411     0    1     4    1    2    21     1     2    6     34
1     0  1290    0     7    0    0     0    25     9    0      1
2     0     0  263     2    5    4     0     3     7   28      0
3     1     3    1  8164    0   13     3   143   111    1      0
4     3     1  133     1  265    2     1     1    26    6    100
5     0     0    6    39    0  441     0     0     9   25      1
6     3     1    2     3    1    0  1875     1     7    3     12
7     2    46   22   229    3    0     2  6880    70    1     10
8     1     1   10   117   11    3     1    60  3059    2     31
9     0     0   68    13    1  118     1     2     9  281      0
10   18     4   53     9  125    2    33    13    48    3  12488
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73679423, 'precision': 0.68708473, 'recall': 0.62826097, 'specificity': 0.9732531, 'f1': 0.61493117, 'auroc': 0.8876956}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   781     0    1   17    1   13   286     5     2   63     1
1     2  1335    0   18    0    0     1   130     9    0     4
2     2     2  222    8  126   19    42    25   391   79    99
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    7    0  223    0     5     1    29    1  1367
5     1     0    0   75    1  417     4     0    20   73     1
6     0     0    0    1    0    0  3051     0     8    0     7
7     0     0    0   18    0    0     0  1145     0    0     1
8     0     0    0   65    0    1     4    11  1288    1     0
9     1    13   81  102    1  161    19    48   272  432     7
10    0     0    1    0    6    0     1     1     0    0  1637
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-08 03:18:41.048248,epoch time: 0:31:29.286053,used: 1:35:46.607876,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9512254, 'precision': 0.88795316, 'recall': 0.8351096, 'specificity': 0.9947448, 'f1': 0.8526554, 'auroc': 0.9974591}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   366     0    0     6    2    0    48     4     8    4     45
1     0  1232    0    13    0    0     2    72    10    0      3
2     1     0  229     1    7    0     2    21    12   37      2
3     0     0    1  8141    0    5     6   163   120    2      0
4     2     0   76     1  272    0     2    10    49    6    121
5     0     0    3    64    0  314     4     0     9  126      1
6     3     0    0     2    0    0  1887     3     5    0      8
7     0     3    1   138    0    0     2  7048    65    0      6
8     0     0    4    76    0    0     3    74  3124    0     13
9     0     0   44     8    0   17     5     9    10  399      1
10    1     0    5     7   54    0    70    28    86    1  12541
---- Validation: 
scalar performance:
{'acc': 0.9527618, 'precision': 0.8877602, 'recall': 0.8418169, 'specificity': 0.9949259, 'f1': 0.85710347, 'auroc': 0.99737084}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   377     0    0     1    2    0    50     3     5    3     42
1     0  1246    0    12    0    0     2    64     5    0      3
2     1     0  241     0    6    0     3    17    15   29      0
3     0     0    1  8146    0    4     6   162   120    1      0
4     2     0   81     1  283    0     6     7    45    2    112
5     0     0    6    59    0  320     4     0    13  118      1
6     5     0    0     2    0    0  1884     1     7    1      8
7     0     4    1   123    0    0     5  7060    63    0      9
8     0     0    5    85    4    0     1    73  3116    0     12
9     0     0   45    10    0   21     8    11    11  385      2
10    3     0    6     7   55    0    62    23    77    2  12561
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.694186, 'precision': 0.6665406, 'recall': 0.5586214, 'specificity': 0.96883535, 'f1': 0.54390144, 'auroc': 0.8856971}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   728     0    0  15    1    0   352    13     3   43    15
1     0  1090    0  18    0    0     2   348     9    0    32
2     3     0  126   4  133    1    51   102   431   57   107
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  313    0    13     3    53    1  1249
5     3     0    1  84    4  107    15     1    37  340     0
6     0     0    0   1    0    0  3062     1     1    0     2
7     0     0    0  17    0    0     2  1144     0    0     1
8     0     0    0  64    0    0    11    24  1267    4     0
9     6     1   68  74    5   11    26   186   271  464    25
10    0     0    0   0   17    0     7     1     0    0  1621
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_4.png
better model found
persisted
after epoch: 4,now: 2024-07-08 03:50:00.591842,epoch time: 0:31:19.543594,used: 2:07:06.151470,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9536066, 'precision': 0.8934988, 'recall': 0.85478973, 'specificity': 0.9948212, 'f1': 0.865147, 'auroc': 0.99767655}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   424     0    2     7    0    0     9     1     1    2     37
1     0  1237    1    17    0    0     1    58     5    0     12
2     0     0  265     2    7    1     2     2     2   26      5
3     0     0    0  8223    1    8     0    91   114    0      0
4     3     0   84     1  243    1     0     5    16    6    180
5     0     0    1    56    0  399     0     0     2   62      1
6    11     0    1     9    0    0  1865     3     0    2     17
7     1     4    5   242    0    0     2  6888   104    0     19
8     2     0   15   145    3    0     1    37  3031    8     53
9     0     0   62    12    0   62     0     1     2  352      1
10   11     0    9     8   20    1     9     6    14    0  12715
---- Validation: 
scalar performance:
{'acc': 0.9530025, 'precision': 0.8897075, 'recall': 0.8540183, 'specificity': 0.994785, 'f1': 0.86262894, 'auroc': 0.9977353}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    1     9    2    1     9     1     1    2     32
1     0  1239    0    17    0    0     1    59     6    0     10
2     0     0  266     0    7    0     1     3     1   33      1
3     1     0    2  8215    0    6     0   109   106    1      0
4     4     0   94     2  235    1     3     4    15    3    178
5     0     0    6    48    0  401     0     0     7   58      1
6    12     0    1    10    0    0  1861     2     4    0     18
7     1     4    3   235    2    0     2  6898   106    0     14
8     1     0   13   150    7    6     3    39  3019    7     51
9     1     0   72     7    0   53     1     3     2  354      0
10    6     0    5     8   21    1    10     5    23    2  12715
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.633247, 'precision': 0.6678437, 'recall': 0.5094079, 'specificity': 0.9639458, 'f1': 0.51614773, 'auroc': 0.87640095}
confusion matrix:
     0    1    2    3   4    5     6     7     8    9     10
0   712    0    2  265   0    1    69    31    32   44    14
1     4  876    0   57   0    0     7   468    11    0    76
2     4    0  163  113  53    8    59    57   247   78   233
3     0    0    0    0   0    0     0     0     0    0     0
4     0    0    2    1  61    0     2     1    16    2  1548
5     2    0    0  367   0  177     0     0     3   41     2
6     0    0    0    8   0    0  3025     0     1    0    33
7     0    0    0   76   0    0     1  1083     2    0     2
8     0    0    1  320   1    0     4     4  1028    1    11
9     2    0   55  513   1   58    14   107    79  281    27
10    0    0    0    1   0    0     0     0     0    0  1645
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_5.png
better model found
persisted
after epoch: 5,now: 2024-07-08 04:21:17.446780,epoch time: 0:31:16.854938,used: 2:38:23.006408,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9589844, 'precision': 0.8837859, 'recall': 0.8720377, 'specificity': 0.99560666, 'f1': 0.8742895, 'auroc': 0.99804664}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    0     6    3    0    10     3     1    0      9
1     0  1269    0    15    0    0     0    37     2    0      8
2     3     0  198     0   83    0     2     4     3   18      1
3     0     0    0  8243    0    5     1   115    72    0      2
4     8     0    5     2  440    0     1     2    11    1     69
5     2     0    1    36    2  352     0     0     9  117      2
6    13     0    0     3    2    0  1878     2     4    0      6
7     0     6    2   194    1    0     2  7026    24    0      9
8     3     0    3    98   25    0     0    95  3030    0     40
9     3     0   71    14   15   12     3     3     3  368      1
10   40     1    2     8  127    0    13     6     8    0  12588
---- Validation: 
scalar performance:
{'acc': 0.95872676, 'precision': 0.87599576, 'recall': 0.8675935, 'specificity': 0.9956088, 'f1': 0.86794573, 'auroc': 0.99797684}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     7    2    0    10     3     0    0      6
1     0  1271    0    13    0    0     0    38     3    0      7
2     2     0  193     1   83    0     1    14     3   15      0
3     1     1    0  8258    1    7     2   106    63    0      1
4     6     0    2     1  449    0     2     2     9    2     66
5     5     0    4    34    2  346     0     0     7  122      1
6    15     0    0     7    3    0  1868     2     1    0     12
7     0     6    1   171    4    0     2  7041    27    0     13
8     6     1    3    90   30    0     1    86  3040    0     39
9     7     0   73    13   18   23     3     4     6  345      1
10   42     0    2     8  134    0    15     7    12    0  12576
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7081788, 'precision': 0.629624, 'recall': 0.5652129, 'specificity': 0.97056794, 'f1': 0.552722, 'auroc': 0.8799222}
confusion matrix:
     0     1    2    3    4   5     6     7     8    9     10
0   916     0    0   64    2   0    98    70     9    1    10
1     2  1169    0   29    0   0     4   240     4    0    51
2    13     0   30    9  602   0    29    52    98   17   165
3     0     0    0    0    0   0     0     0     0    0     0
4     3     0    0    0  592   0     6     1     7    0  1024
5    13     0    3  173   28  89    21     3    28  233     1
6     0     0    0    1    0   0  3045     0     1    0    20
7     0     0    0   10    0   0     0  1151     0    0     3
8     0     0    0   59    6   0    14    21  1266    0     4
9    35     1  129  158  143   9    42   120   190  272    38
10    0     0    0    0   52   0     1     1     0    0  1592
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_6.png
better model found
persisted
after epoch: 6,now: 2024-07-08 04:52:37.125204,epoch time: 0:31:19.678424,used: 3:09:42.684832,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9568975, 'precision': 0.89101845, 'recall': 0.87019014, 'specificity': 0.9952904, 'f1': 0.8750669, 'auroc': 0.9981746}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   380     0    1     2    1    0    35     0     0    7     57
1     0  1277    0    14    0    0     0    33     5    2      1
2     0     0  215     0   30    0     1     0     1   65      0
3     0     0    1  8288    4   29     5    78    22   10      0
4     0     0   19     0  403    1     0     0     5   10    101
5     0     0    0     7    0  344     0     0     2  167      1
6     2     0    0     0    0    0  1891     0     1    2     11
7     4    11   20   194    8    0     3  6911    94    4     15
8     0     0    4   211   32    8     5    34  2911   11     78
9     0     0   20     2    2   11     0     0     0  457      0
10    0     0    3     8   63    0    19     2    10    2  12688
---- Validation: 
scalar performance:
{'acc': 0.9570416, 'precision': 0.88785285, 'recall': 0.8776931, 'specificity': 0.995314, 'f1': 0.8788228, 'auroc': 0.99815017}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   390     0    2     2    0    0    37     0     0    5     47
1     0  1277    1    15    0    1     0    33     4    0      1
2     0     0  231     0   27    0     1     0     1   52      0
3     2     1    0  8277    1   32     5    80    29   13      0
4     4     0   16     0  408    0     1     0     3    6    101
5     0     0    0     7    0  357     0     0     1  155      1
6     3     0    0     0    0    0  1892     0     2    3      8
7     4    11   20   194    6    0     3  6915    91    4     17
8     2     0    6   208   38   10     3    28  2900   18     83
9     0     0   23     3    1   15     0     0     1  449      1
10    4     0    7     7   69    0    13     3     6    4  12683
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67809415, 'precision': 0.6251474, 'recall': 0.5568292, 'specificity': 0.96719325, 'f1': 0.5418134, 'auroc': 0.86258715}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   639     0   0    6    3    1   333     9    15  127    37
1     4  1255   1   32    0    1     3   161    14    2    26
2     2     0  85    6  178    3    26    12   269  102   332
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    1   87    0     2     1    17    1  1524
5     1     0   0   36    4  161     4     0     2  382     2
6     0     0   0    1    0    0  2864     1     1    0   200
7     3     0   0   40    0    0     8  1096    13    3     1
8     0     0   0  131    0    6    19     5  1193    6    10
9     3     0  79   63   13   52    12    20   192  669    34
10    0     0   0    0    2    0     1     0     0    0  1643
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_7.png
early stop counter: 1
val acc:0.9570416212081909, best validation acc: 0.9587267637252808, corresponding to test acc:                         0.7081788182258606 / 0.7367942333221436
after epoch: 7,now: 2024-07-08 05:23:53.844666,epoch time: 0:31:16.719462,used: 3:40:59.404294,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9629709, 'precision': 0.916716, 'recall': 0.88073844, 'specificity': 0.9958463, 'f1': 0.89525414, 'auroc': 0.9987545}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   418     0    1     4    3    1     8     0     0    2     46
1     0  1283    0    10    0    0     0    31     4    0      4
2     0     0  206     0   48    6     0     4     3   42      3
3     0     0    0  8232    1   31     2    49   121    1      1
4     1     0    4     0  379    1     1     3     8    3    139
5     1     0    0     4    0  487     0     0     5   23      1
6     3     0    1     0    1    2  1879     3     0    1     18
7     0    13    1   223    2    0     1  6916    89    0     18
8     0     0    0    42   15    5     1    21  3091    2    118
9     0     0   19     2    2  112     0     1     4  352      1
10    2     0    1     7   19    3     5     3     3    0  12749
---- Validation: 
scalar performance:
{'acc': 0.9635683, 'precision': 0.91780734, 'recall': 0.8853613, 'specificity': 0.99590534, 'f1': 0.89871347, 'auroc': 0.99867606}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   413     0    1     3    5    1    14     0     0    1     45
1     0  1281    0     6    0    1     0    35     4    0      5
2     0     0  210     0   45    3     0     2     2   44      6
3     1     1    0  8245    0   26     0    49   118    0      0
4     0     0    5     0  389    1     0     3     6    2    133
5     0     0    0     2    0  497     0     0     4   17      1
6     5     0    1     3    2    0  1875     1     1    0     20
7     0    17    2   216    4    1     2  6923    81    0     19
8     1     0    2    51   11    3     1    18  3088    0    121
9     0     0   21     3    3  103     0     1     3  359      0
10    2     0    1     7   30    1     5     2     4    1  12743
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7080389, 'precision': 0.6497945, 'recall': 0.6040679, 'specificity': 0.97030264, 'f1': 0.57134587, 'auroc': 0.88244164}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   798     0   0  37    2   21   269    14     4    5    20
1     1  1216   0  17    0    0     0   214    10    0    41
2     5     0  44  10  244   33    21    34   247   37   340
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   0  203    0     3     1    10    1  1415
5     4     0   0  42    1  493     5     0    11   35     1
6     0     0   0   2    0    0  3008     3     0    0    54
7     0     0   0  33    0    0     1  1123     5    0     2
8     0     0   0  28    0    2    12     2  1311    0    15
9     8     0  38  72   21  266    16    53   317  293    53
10    0     0   0   0   15    0     0     0     0    0  1631
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_8.png
better model found
persisted
after epoch: 8,now: 2024-07-08 05:55:09.876710,epoch time: 0:31:16.032044,used: 4:12:15.436338,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9667701, 'precision': 0.91855216, 'recall': 0.90747905, 'specificity': 0.9963604, 'f1': 0.9110312, 'auroc': 0.99887294}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     3    1    0     1     0     0    0      7
1     0  1284    0     2    0    0     0    37     4    0      3
2     0     0  259     1   25    1     0     0     1   25      0
3     1     0    1  8136    0   13     2   198    82    4      1
4     3     0   22     1  350    1     0     1    11    4    146
5     1     0    0     6    0  432     0     0     3   77      1
6    10     0    1     1    0    0  1875     3     1    1     16
7     0    11   10    63    2    1     1  7037   127    0     12
8     0     0    4    68    4    6     0    26  3150    3     34
9     0     0   38     2    0   21     1     1     2  427      1
10   18     0    4     6   21    0     4     5    22    1  12713
---- Validation: 
scalar performance:
{'acc': 0.96664435, 'precision': 0.9194327, 'recall': 0.90627825, 'specificity': 0.9963339, 'f1': 0.911451, 'auroc': 0.9988778}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     2    1    0     1     2     1    0     10
1     0  1283    0     2    0    0     0    39     3    0      5
2     2     0  255     0   25    1     0     0     1   26      2
3     1     0    2  8151    0   11     0   177    92    4      2
4     6     0   13     1  363    0     1     2     7    4    142
5     0     0    0     6    0  438     1     0     2   73      1
6    11     0    0     0    0    0  1874     4     0    1     18
7     0     8    8    74    1    0     1  7031   124    1     17
8     0     0    5    85    6    5     2    20  3137    3     33
9     1     0   37     1    2   31     0     1     2  418      0
10   17     0    1     7   21    0     3     3    20    2  12722
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72650945, 'precision': 0.6387547, 'recall': 0.6167307, 'specificity': 0.972421, 'f1': 0.5959677, 'auroc': 0.88117933}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1063     0    2  12    2    2    12    14    12   43     8
1      0  1164    0   7    0    0     1   299     6    0    22
2     18     1  178   2  218   12     7    41   244   41   253
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    0   0  168    0     3     1    18    1  1440
5      3     0    7  43    3  328     0     3     8  196     1
6      5     0    0   0    0    0  2979     3     1    0    79
7      0     0    0   1    0    0     0  1154     6    0     3
8      1     0    1  24    0    3     4     9  1320    2     6
9     10     3  192  44   10  109     1    95   243  394    36
10     0     0    0   0   10    0     0     0     0    0  1636
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_9.png
better model found
persisted
after epoch: 9,now: 2024-07-08 06:26:32.160203,epoch time: 0:31:22.283493,used: 4:43:37.719831,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96524507, 'precision': 0.927507, 'recall': 0.88254094, 'specificity': 0.9960873, 'f1': 0.895908, 'auroc': 0.9989605}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    1     0    0    0     2     0     1    2     12
1     0  1285    0     8    0    0     0    30     9    0      0
2     0     0  267     2    9    1     1     3     3   18      8
3     1     0    0  8306    0    4     1    47    80    0      0
4     5     0   26     1  233    0     1     3    20    1    249
5     0     0    3    20    0  418     0     0    13   66      1
6     7     0    0     3    1    0  1884     1     3    1      8
7     0     5    2   187    1    0     1  6884   174    0     10
8     1     0    1    48    3    1     0    17  3193    0     31
9     0     0   56     5    0   27     0     2     4  397      2
10    9     0    0     8    4    0     4     2    18    0  12745
---- Validation: 
scalar performance:
{'acc': 0.96394277, 'precision': 0.92126215, 'recall': 0.87720466, 'specificity': 0.99594784, 'f1': 0.89034396, 'auroc': 0.9989368}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     2    0    0     7     0     1    0     14
1     0  1284    0     7    0    0     0    28    11    0      2
2     0     0  260     1   12    0     1     4     6   19      9
3     0     0    0  8296    0   10     1    51    80    2      0
4     3     0   35     0  225    1     1     2    21    1    250
5     1     0    1    23    0  421     0     0    11   63      1
6     5     0    0     1    1    1  1882     0     5    0     13
7     0     7    2   199    1    0     1  6875   167    0     13
8     1     0    1    51    4    1     0    18  3194    0     26
9     0     0   56     6    3   31     0     1     4  392      0
10   11     0    2     7    3    0     3     2    18    1  12749
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68795913, 'precision': 0.62595314, 'recall': 0.57176405, 'specificity': 0.96880704, 'f1': 0.5594615, 'auroc': 0.8742468}
confusion matrix:
      0     1    2    3   4    5     6    7     8    9     10
0   1015     0    0   53   0    1    62    4     6   24     5
1      4  1248    0   42   0    0     1  167    21    0    16
2     22     0  129   27  37   10    29   15   328   37   381
3      0     0    0    0   0    0     0    0     0    0     0
4      0     0    0    0   9    0     6    1    15    1  1601
5      5     0    2  128   0  294     4    0    19  139     1
6      7     0    0    4   0    0  3016    0     0    0    40
7      1     0    0  253   0    0     1  906     2    0     1
8      0     0    0  130   0    1     8    0  1227    1     3
9     11     1  109  158   3   89    21   30   323  347    45
10     0     0    0    1   0    0     3    0     0    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_10.png
early stop counter: 1
val acc:0.9639427661895752, best validation acc: 0.9666443467140198, corresponding to test acc:                         0.7265094518661499 / 0.7367942333221436
after epoch: 10,now: 2024-07-08 06:57:52.961920,epoch time: 0:31:20.801717,used: 5:14:58.521548,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9695259, 'precision': 0.9211319, 'recall': 0.8921033, 'specificity': 0.99665964, 'f1': 0.90054107, 'auroc': 0.9990298}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     0    3    0     9     1     0    1     13
1     0  1313    0     3    0    0     1    13     0    0      2
2     0     0  172     0   62    1     1     0     1   68      7
3     0     3    1  8312    1    5     0    79    34    2      1
4     4     0    1     0  425    0     0     0     4    1    104
5     0     0    2    10    2  391     1     0     1  112      1
6     3     0    0     0    0    0  1895     2     1    0      7
7     1    23    2   131    1    0     3  7035    43    4     21
8     3     2    6    89   15    2     7    41  3060    8     59
9     0     0    9     4    4   18     0     1     1  454      2
10    2     0    0     7   41    0    14     2     3    2  12724
---- Validation: 
scalar performance:
{'acc': 0.96870404, 'precision': 0.92239267, 'recall': 0.88880223, 'specificity': 0.99656254, 'f1': 0.8983351, 'auroc': 0.99907446}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     0    1    0    13     0     0    1     16
1     0  1306    0     3    0    0     0    19     3    0      1
2     1     0  167     0   61    0     1     1     0   72      9
3     0     1    0  8305    0    4     1    87    37    3      2
4     3     0    2     0  429    1     2     0     3    6     93
5     0     0    1    14    0  385     0     0     2  118      1
6     4     1    0     1    0    0  1893     2     0    0      7
7     3    21    1   136    3    0     1  7032    41    5     22
8     0     0    0   104    8    2     5    34  3069    9     65
9     0     0   13     3    4   15     1     0     0  454      3
10    8     0    0     7   38    0    16     1     2    1  12723
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71916324, 'precision': 0.66643244, 'recall': 0.5852357, 'specificity': 0.9715355, 'f1': 0.57297635, 'auroc': 0.8783223}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   827     0   0  30    1    0   146    25    50   41    50
1     3  1337   0  18    1    0     3   104     7    2    24
2     4     0  41  15  178    5    18    20   186   96   452
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   0  270    0     7     1    11    1  1343
5     5     0   0  97    0  127     5     0     1  353     4
6     0     0   0   2    0    0  3043     0     0    0    22
7     0     0   0  37    0    0     1  1117     2    3     4
8     2     0   1  75    2    0    17     1  1248    8    16
9     7     5  51  88   16   23    24    33   157  652    81
10    0     0   0   0   26    0     3     0     0    0  1617
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_11.png
better model found
persisted
after epoch: 11,now: 2024-07-08 07:29:36.601206,epoch time: 0:31:43.639286,used: 5:46:42.160834,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97249573, 'precision': 0.9375054, 'recall': 0.8991655, 'specificity': 0.99692124, 'f1': 0.91411245, 'auroc': 0.9991273}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     0    0    0     4     2     0    1     19
1     0  1295    0     2    0    0     0    32     2    0      1
2     4     0  199     1   55    1     1     4     1   37      9
3     1     2    0  8241    0   24     4    83    82    1      0
4     3     0    4     0  323    0     1     3    17    0    188
5     1     0    0     2    1  496     0     0     0   20      1
6     5     0    0     2    0    1  1894     1     1    0      4
7     0     9    0   116    1    0     1  7079    48    0      8
8     0     0    1    43    1    4     2    28  3202    3     11
9     2     0   12     1    1   43     1     0     2  430      1
10    8     0    1     7    5    0     8    11    20    1  12732
---- Validation: 
scalar performance:
{'acc': 0.9721814, 'precision': 0.92900056, 'recall': 0.8936663, 'specificity': 0.99693346, 'f1': 0.9072957, 'auroc': 0.9991493}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     2    0    0     4     2     1    1      8
1     0  1303    0     2    0    0     0    27     0    0      0
2     4     0  190     0   57    0     3     4     3   46      5
3     2     5    0  8242    0   25     0    79    84    3      0
4     5     0    3     0  333    1     2     2    19    2    172
5     0     0    1     3    0  478     1     0     3   34      1
6     6     0    0     0    0    0  1892     0     1    0      9
7     0     7    0   119    1    0     2  7077    54    0      5
8     0     2    1    42    1    6     2    21  3207    1     13
9     3     1   17     1    5   51     0     1     3  411      0
10    5     0    1     7    2    0     6    12    16    0  12747
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.707759, 'precision': 0.64598304, 'recall': 0.598928, 'specificity': 0.97055894, 'f1': 0.5592929, 'auroc': 0.8776012}
confusion matrix:
      0     1   2   3   4    5     6     7     8    9     10
0   1079     1   0  12   0    0    28    31    11    2     6
1      2  1013   0  20   0    0     1   436    13    1    13
2     18     0  12   7  59   23    19    58   373   61   385
3      0     0   0   0   0    0     0     0     0    0     0
4      2     0   0   0  91    0     3     2    24    0  1511
5     16     0   0  43   0  373     2     3    12  140     3
6      2     0   0   1   0    0  3038     2     1    0    23
7      0     0   0  32   0    0     0  1124     7    0     1
8      0     0   0  46   0    4     7     6  1302    2     3
9     30     4  12  73   1  151    10    83   288  441    44
10     0     0   0   0   1    0     1     0     1    0  1643
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_12.png
better model found
persisted
after epoch: 12,now: 2024-07-08 08:01:37.920338,epoch time: 0:32:01.319132,used: 6:18:43.479966,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9724422, 'precision': 0.9326389, 'recall': 0.91483045, 'specificity': 0.9969305, 'f1': 0.9197839, 'auroc': 0.9993089}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     2    1    0     1     1     1    1     23
1     0  1306    0     0    0    0     0    24     2    0      0
2     0     0  298     0    3    0     0     1     0    8      2
3     0     0    1  8260    1    1     0    75   100    0      0
4     4     0   34     0  356    0     0     0     5    0    140
5     0     0    1    23    1  448     1     0     7   39      1
6    15     2    1     2    0    0  1869     3     3    0     12
7     0    12    4   152    2    0     2  7028    48    5     10
8     0     0    4    34   17    0     0    18  3185    2     36
9     1     0   74     3    0   29     0     0     2  384      0
10    5     0    2     7    7    1     4     1     6    0  12759
---- Validation: 
scalar performance:
{'acc': 0.9722081, 'precision': 0.9296479, 'recall': 0.9119054, 'specificity': 0.9969121, 'f1': 0.916515, 'auroc': 0.9992412}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     4    0    0     0     1     0    0     25
1     0  1307    0     3    0    0     0    20     2    0      0
2     1     0  295     1    5    0     0     3     0    7      0
3     1     0    1  8278    1    1     0    58    99    0      1
4     6     0   43     1  361    1     0     1     3    0    123
5     0     0    2    29    0  441     0     0     4   44      1
6    15     0    0     2    1    0  1872     1     2    0     15
7     0    12    6   163    0    1     1  7020    46    2     14
8     0     0    6    28   12    0     0    28  3184    2     36
9     1     0   75     4    2   34     0     2     1  374      0
10    3     0    2     7    8    0     4     6     4    1  12761
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71538514, 'precision': 0.6324273, 'recall': 0.6025309, 'specificity': 0.9713634, 'f1': 0.5789263, 'auroc': 0.8732978}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1000     1    3   26    0    0    23    59    21    4    33
1      2  1285    0   18    0    0     0   153    17    0    24
2     18     0  157    9  135   19    12    29   197   22   417
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    0    0   48    0     3     0     8    0  1573
5      8     0    4  121    1  337     0     0    45   72     4
6      2     0    0    3    0    0  3028     1     0    0    33
7      0     0    0   52    0    0     0  1105     4    0     3
8      0     0    0   25    0    1     3     6  1327    1     7
9     10     0  190   85   15  156     6    41   285  294    55
10     0     0    0    0    0    0     2     0     0    0  1644
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_13.png
better model found
persisted
after epoch: 13,now: 2024-07-08 08:33:16.653505,epoch time: 0:31:38.733167,used: 6:50:22.213133,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9680008, 'precision': 0.9134011, 'recall': 0.92621374, 'specificity': 0.99674344, 'f1': 0.91623574, 'auroc': 0.9991819}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     0    1    0    14     1     0    0      3
1     0  1310    0     2    0    0     0    20     0    0      0
2     0     0  225     0   38    2     4     2     5   33      3
3     0     5    1  8244    0    1     0   122    65    0      1
4     6     1    2     1  496    1     2     1    14    1     13
5     0     0    0    15    0  485     1     0     2   17      1
6     1     0    0     1    0    0  1900     2     3    0      0
7     0    23    0    67    3    0     1  7113    52    0      4
8     1     2    1    43    2    0     1    35  3207    1      2
9     2     0   20     4    1   74     2     4     2  384      0
10   18    11    0     6  220    2    58    34    92    0  12353
---- Validation: 
scalar performance:
{'acc': 0.9680086, 'precision': 0.91361886, 'recall': 0.9212893, 'specificity': 0.99673456, 'f1': 0.91444457, 'auroc': 0.9992509}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     1    0     2    2    0    12     2     0    0      2
1     0  1308    0     3    0    0     0    21     0    0      0
2     0     0  223     1   39    2     1     8     3   35      0
3     0     6    0  8230    0    1     1   121    81    0      0
4     5     2    6     0  490    0     2     3    16    0     15
5     2     0    0    21    0  480     1     0     5   11      1
6     3     0    0     1    0    0  1897     3     2    0      2
7     2    19    0    69    1    0     1  7123    47    0      3
8     0     3    2    43    1    1     0    35  3209    0      2
9     0     0   24     5    2   83     1     2     2  374      0
10    5    21    0     9  190    0    58    24    95    1  12393
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71713424, 'precision': 0.6692177, 'recall': 0.5877891, 'specificity': 0.9714676, 'f1': 0.5816925, 'auroc': 0.88607585}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   686     2   0  114    1    2   269    53    31    9     3
1     0  1265   0   20    0    0     0   210     3    0     1
2     6     5  59   28  266   17    93   122   295   35    89
3     0     0   0    0    0    0     0     0     0    0     0
4     1     2   2    0  783    0    25     6    20    0   794
5     3     0   0  203    0  309    20     1    15   40     1
6     0     0   0    2    0    0  3061     3     1    0     0
7     0     0   0   40    0    0     0  1121     2    0     1
8     0     0   0   83    0    2    19     6  1259    0     1
9     8     9  42  218    6  157    49   145   277  216    10
10    0     3   0    0  137    0    15     0     0    0  1491
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_14.png
early stop counter: 1
val acc:0.9680085778236389, best validation acc: 0.9722080826759338, corresponding to test acc:                         0.7153851389884949 / 0.7367942333221436
after epoch: 14,now: 2024-07-08 09:04:52.685973,epoch time: 0:31:36.032468,used: 7:21:58.245601,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97891694, 'precision': 0.94241333, 'recall': 0.93974304, 'specificity': 0.9977069, 'f1': 0.93938327, 'auroc': 0.99956185}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    1     1    7    0     0     0     0    1     18
1     0  1318    0     1    0    0     0    10     0    0      2
2     0     0  296     1    8    0     0     0     2    4      1
3     0     0    0  8277    0   17     0    70    73    1      0
4     1     0   12     0  436    0     0     1     3    0     86
5     1     0    0     2    0  499     0     0     1   18      0
6     5     0    0     4    4    1  1865     0     4    1     23
7     0    18    6    89    2    0     0  7084    58    0      6
8     0     0    5    26   12    2     0    12  3229    0      8
9     0     0   54     0    7   48     0     0     0  384      0
10    1     0    1     4   21    1     0     5    17    0  12745
---- Validation: 
scalar performance:
{'acc': 0.978815, 'precision': 0.94374603, 'recall': 0.9395318, 'specificity': 0.9976842, 'f1': 0.9405581, 'auroc': 0.9995858}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     0    6    0     1     0     0    0     22
1     0  1323    0     1    0    1     0     5     1    0      1
2     0     0  288     1   11    1     0     2     0    9      0
3     0     1    1  8277    0   17     0    68    74    1      1
4     1     0    7     1  450    0     0     2     2    0     76
5     1     0    0     1    0  496     0     0     1   21      1
6    12     0    0     0    7    0  1855     3     3    0     28
7     0    14    2    98    2    0     1  7080    62    0      6
8     0     0    5    25    4    2     0    11  3233    2     14
9     1     0   48     1    5   46     0     1     1  388      2
10    4     0    2     7   13    0     0     5    16    0  12749
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7074792, 'precision': 0.6282963, 'recall': 0.60798573, 'specificity': 0.9706577, 'f1': 0.5854243, 'auroc': 0.8738897}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   865     5   10   22   48   16    13    49    41   40    61
1     2  1293    0   12    0    2     0   133    39    0    18
2     3     1  188    5  347   36     0    26   216   24   169
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  276    0     1     1    18    1  1335
5     2     0   13   22    5  462     0     0     4   79     5
6     7     0    1    7    4    0  2831     3     4    0   210
7     0     0    1  137    0    2     0  1001    22    0     1
8     0     0    1   12    2   14     1     2  1336    0     2
9     2     2  209   40   28  350     0    36   212  232    26
10    0     0    0    0   18    0     0     0     0    0  1628
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_15.png
better model found
persisted
after epoch: 15,now: 2024-07-08 09:36:19.157186,epoch time: 0:31:26.471213,used: 7:53:24.716814,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9727098, 'precision': 0.93597376, 'recall': 0.93094814, 'specificity': 0.9970139, 'f1': 0.9327637, 'auroc': 0.9994483}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     0    1    0     2     0     2    0      9
1     0  1304    0     2    2    0     0    21     2    0      1
2     0     0  248     0   18    3     0     2     2   37      2
3     0     3    0  8368    0   11     3    22    31    0      0
4     3     0    9     0  469    0     0     0     7    3     48
5     0     0    0    12    0  492     0     0     2   14      1
6     2     0    0     1    1    0  1874     1     3    0     24
7     4     6    0   303    2    0     2  6888    55    0      5
8     0     1    2    86    6    2     0    17  3170    1     11
9     0     0   20     2    3   66     0     1     2  397      2
10    7     0    0     6   66    0     2     4    27    2  12678
---- Validation: 
scalar performance:
{'acc': 0.97375953, 'precision': 0.9363524, 'recall': 0.931515, 'specificity': 0.99714154, 'f1': 0.93297637, 'auroc': 0.99945325}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     2    1    0     4     2     3    0      9
1     0  1303    0     2    0    0     0    23     3    0      1
2     0     0  248     1   25    1     0     0     6   26      5
3     1     2    0  8363    0   18     3    26    26    0      1
4     5     0    9     1  479    0     1     0     8    0     36
5     0     0    1    10    1  492     0     0     1   15      1
6     5     0    0     1    1    1  1875     0     1    0     24
7     2     2    2   272    2    0     3  6936    42    0      4
8     0     0    2    76   10    1     0    23  3169    1     14
9     0     0   17     1    2   73     0     1     3  396      0
10    8     0    1     7   59    2     3     7    28    0  12681
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70635974, 'precision': 0.6364126, 'recall': 0.5962903, 'specificity': 0.9703575, 'f1': 0.58192503, 'auroc': 0.876081}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   996     0   0  10    7    5    80    13    18    8    33
1     6  1157   0  16    1    1     4   252    18    1    43
2     4     1  71   7  348   13     4    24   257   32   254
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   0  338    0     1     0    14    0  1280
5     5     0   7  46   13  349     4     1    10  152     5
6     2     0   1   3    0    0  2882     3     1    0   175
7     1     0   0  98    0    0     1  1052    10    0     2
8     1     0   1  57    1    2     7     4  1289    1     7
9    11     1  77  74   64  159    20    33   308  343    47
10    0     0   0   0   27    0     0     0     0    0  1619
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_16.png
early stop counter: 1
val acc:0.9737595319747925, best validation acc: 0.9788150191307068, corresponding to test acc:                         0.7074791789054871 / 0.7367942333221436
after epoch: 16,now: 2024-07-08 10:08:07.198118,epoch time: 0:31:48.040932,used: 8:25:12.757746,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9697399, 'precision': 0.9305974, 'recall': 0.896705, 'specificity': 0.9966188, 'f1': 0.90734595, 'auroc': 0.9993793}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   427     0    0     1    2    0    14     0     1    1     37
1     0  1268    0     7    0    0     1    42     8    0      6
2     0     0  249     1    0    3     0     0     4   50      5
3     0     0    3  8332    0   10     3    47    41    3      0
4     1     0   55     0  312    1     3     0    13    2    152
5     0     0    0     2    0  513     0     0     0    5      0
6     1     0    1     1    0    0  1892     1     0    0     12
7     0     0   14   192    0    0     7  6918   105    5     22
8     0     0    0    51    1   14     4     8  3191    2     25
9     0     0    5     0    0  107     0     0     1  378      2
10    1     0    0     6    3    0     7     2     7    0  12765
---- Validation: 
scalar performance:
{'acc': 0.97071016, 'precision': 0.930737, 'recall': 0.89914846, 'specificity': 0.996738, 'f1': 0.908913, 'auroc': 0.9993458}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    0     0    1    0    11     0     0    0     46
1     0  1272    0     4    0    0     1    38    15    1      1
2     0     0  249     0    2    3     0     0     4   46      8
3     1     0    1  8353    0   19     5    31    29    1      0
4     2     0   64     0  313    1     4     0     8    2    145
5     0     0    0     2    0  513     0     0     0    6      0
6     2     0    0     1    0    1  1892     1     2    0      9
7     1     1   11   179    0    1     5  6917   125    6     19
8     0     0    0    43    2   10     7     7  3197    1     29
9     0     0    3     1    0   97     0     0     1  390      1
10    0     0    1     6    3    0     4     1    12    0  12769
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6675995, 'precision': 0.66239417, 'recall': 0.5693325, 'specificity': 0.9662851, 'f1': 0.5356782, 'auroc': 0.8689853}
confusion matrix:
     0    1    2   3   4    5     6     7     8    9     10
0   732    0    2  22   0    9   223    11    11   41   119
1     3  924    0  19   0    1    31   325   109    1    86
2     1    0  100  10  21   50    22    14   361   51   385
3     0    0    0   0   0    0     0     0     0    0     0
4     0    0    1   0  60    0     5     2    23    0  1542
5     1    0    1  44   0  464     4     0     9   65     4
6     0    0    0   2   0    0  2939     1     1    0   124
7     0    0    1  44   0    0     0  1083    35    0     1
8     0    0    0  69   0    9    11     0  1273    3     5
9     1    0   35  61   1  308    17    18   297  326    73
10    0    0    0   0   4    0     0     0     1    0  1641
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_17.png
early stop counter: 2
val acc:0.9707101583480835, best validation acc: 0.9788150191307068, corresponding to test acc:                         0.7074791789054871 / 0.7367942333221436
after epoch: 17,now: 2024-07-08 10:39:35.988367,epoch time: 0:31:28.790249,used: 8:56:41.547995,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9754388, 'precision': 0.9368962, 'recall': 0.93514186, 'specificity': 0.99738866, 'f1': 0.9330929, 'auroc': 0.9995904}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   481     0    0     0    0    1     0     1     0    0      0
1     0  1274    0     2    0    0     0    53     1    0      2
2     0     0  288     0    5    3     0     0     1   15      0
3     4     1    0  8084    4    7     0   202   128    4      1
4     7     0   17     0  433    2     0     0     7    2     70
5     0     0    0     5    0  510     0     0     5    1      0
6     4     0    1     0    0    0  1891     4     2    0      6
7     1     1    0    17    0    0     1  7212    26    0      6
8     2     0    2     6    7    0     0    35  3230    0     13
9     0     0   23     0    0  114     0     3     2  351      0
10   31     0    1     4   31    2     1     1    20    0  12704
---- Validation: 
scalar performance:
{'acc': 0.9736793, 'precision': 0.9332391, 'recall': 0.92966974, 'specificity': 0.99719536, 'f1': 0.92848253, 'auroc': 0.99952555}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    0    0     3     0     0    2      0
1     0  1257    0     3    0    0     0    67     3    0      2
2     0     0  283     0    6    1     0     1     2   18      1
3     4     1    1  8083    1   14     0   205   127    1      3
4    10     0   16     0  430    1     0     1     7    2     72
5     0     0    0     2    0  507     0     0     6    6      0
6     4     0    0     0    1    1  1890     1     3    0      8
7     2     0    1    37    0    0     1  7188    28    0      8
8     3     0    1    10    2    1     0    36  3232    1     10
9     0     0   21     0    0  123     0     2     0  347      0
10   30     0    1     3   32    2     2     3    16    1  12706
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70454067, 'precision': 0.655894, 'recall': 0.5991656, 'specificity': 0.97026354, 'f1': 0.56150305, 'auroc': 0.8822904}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   892     0    2   7    3   52   114    43    16   32     9
1     0  1030    0  10    0    0     0   417     7    0    35
2    16     0  112   5  111   47    15    98   321   43   247
3     0     0    0   0    0    0     0     0     0    0     0
4     1     0    1   0  283    0     1     3    18    0  1326
5     1     0    0  62    0  457     0     5    33   34     0
6     1     0    0   3    0    0  3025     2     3    0    33
7     0     0    0  10    0    0     0  1151     1    0     2
8     1     0    0  28    0    4     5    26  1306    0     0
9     7     0   40  54    2  332    10   210   243  203    36
10    0     0    0   0   31    0     2     1     1    0  1611
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_18.png
early stop counter: 3
val acc:0.9736793041229248, best validation acc: 0.9788150191307068, corresponding to test acc:                         0.7074791789054871 / 0.7367942333221436
after epoch: 18,now: 2024-07-08 11:11:14.826121,epoch time: 0:31:38.837754,used: 9:28:20.385749,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98153895, 'precision': 0.9463897, 'recall': 0.942243, 'specificity': 0.9979893, 'f1': 0.9412416, 'auroc': 0.9996624}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    1    0     3     0     0    2      8
1     0  1319    0     1    0    0     0    11     1    0      0
2     0     0  307     0    2    0     0     0     0    2      0
3     0     0    0  8368    0    1     0    50    20    0      0
4     4     0   31     0  433    0     0     1     5    2     63
5     0     0    4    13    0  463     0     0     1   40      0
6     3     0    1     0    1    0  1883     0     3    1     15
7     0    22    6    94    0    0     1  7108    24    0      8
8     0     1    4    55    1    1     0    19  3202    1     12
9     0     0   79     5    0   14     0     0     1  394      0
10    0     0    4     6   19    0     2     3    17    1  12740
---- Validation: 
scalar performance:
{'acc': 0.9815969, 'precision': 0.9432187, 'recall': 0.94509137, 'specificity': 0.9980237, 'f1': 0.9414259, 'auroc': 0.999632}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     1    1     1    1    0     1     0     0    3      3
1     0  1322    0     1    0    0     1     7     1    0      0
2     0     0  308     0    2    0     0     1     0    1      0
3     0     0    2  8360    0    5     0    51    22    0      0
4     4     0   31     0  442    0     0     2     9    3     48
5     0     0    3    13    0  459     0     0     0   46      0
6     6     1    1     2    0    1  1880     0     1    2     14
7     0    16    8    83    0    0     1  7125    24    0      8
8     0     0    5    56    2    1     0    25  3194    1     12
9     0     0   72     2    1   14     0     1     0  403      0
10    4     1    4     6   20    0     5     1    22    1  12732
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7579934, 'precision': 0.6989293, 'recall': 0.643062, 'specificity': 0.97561866, 'f1': 0.6463201, 'auroc': 0.8854913}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   848     1    1  20    2   17   116    23    38   91    13
1     1  1364    0  24    0    0     0   101     5    0     4
2     4     4  325  11  163   16    12    61   168  102   149
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0   12   1  431    0     1     0    19    1  1168
5     1     0    7  56    0  305     4     1     1  216     1
6     1     0    3   2    1    0  3014     2     0    0    44
7     0     0    0  52    0    0     6  1101     2    0     3
8     0     0    2  87    1   12    28     7  1225    5     3
9     2     4  109  75    3  108    11    71   118  616    20
10    0     1    0   0   37    0     2     1     0    0  1605
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_19.png
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-08 11:42:54.311055,epoch time: 0:31:39.484934,used: 9:59:59.870683,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98188674, 'precision': 0.966215, 'recall': 0.95193803, 'specificity': 0.9979484, 'f1': 0.9586899, 'auroc': 0.99977636}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     2    2    0     1     4     0    1      4
1     0  1307    0     2    0    0     0    23     0    0      0
2     0     0  283     1   10    1     0     1     0   15      1
3     0     0    0  8408    0    2     0    21     9    0      0
4     4     0    6     0  462    0     0     2     2    2     61
5     0     0    0    11    0  502     0     0     1    7      0
6     2     0    0     0    0    1  1899     2     0    1      3
7     0     4    0   187    2    0     1  7060     2    1      5
8     0     1    0    98    4    0     2    48  3124    0     16
9     0     0   12     1    0   43     0     1     1  435      0
10    6     0    0     6   17    0     6     3     5    0  12750
---- Validation: 
scalar performance:
{'acc': 0.98151666, 'precision': 0.96830606, 'recall': 0.95299006, 'specificity': 0.99789655, 'f1': 0.96010923, 'auroc': 0.9997684}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     1    0     1    1    0     1     0     0    2      4
1     0  1305    0     6    0    0     0    21     0    0      0
2     0     0  291     1    7    1     0     2     2    7      1
3     0     1    0  8406    0    0     0    24     9    0      0
4     4     0    4     2  456    0     1     0     4    1     67
5     0     0    0    10    0  503     0     0     1    7      0
6     0     0    1     1    0    0  1900     1     1    1      3
7     0     3    1   186    3    0     1  7058    10    0      3
8     0     1    0   110    0    0     1    47  3116    3     18
9     0     0   13     0    0   47     0     2     0  431      0
10    3     1    0     6   17    1     3     5     4    1  12755
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72245157, 'precision': 0.664634, 'recall': 0.6082032, 'specificity': 0.9721273, 'f1': 0.5961422, 'auroc': 0.87176967}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1009     2    1   18    2    1    51    39     5   22    20
1      1  1267    0   24    0    0     0   193     3    0    11
2     12     1  126   19  195    9    11    86   128   65   363
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    0    0  137    0     1     2     9    1  1482
5      4     0    4  101    2  307     4     5     9  150     6
6      1     0    0    4    0    0  3018     1     1    0    42
7      0     0    0   73    0    0     0  1089     1    0     1
8      0     0    0   92    1    3     9    26  1231    2     6
9      8     0   65  120   15  115     6   144   124  502    38
10     0     0    0    1    4    0     1     0     0    0  1640
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_20.png
early stop counter: 1
val acc:0.9815166592597961, best validation acc: 0.9815968871116638, corresponding to test acc:                         0.7579934000968933 / 0.7579934000968933
after epoch: 20,now: 2024-07-08 12:14:42.192917,epoch time: 0:31:47.881862,used: 10:31:47.752545,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98327804, 'precision': 0.9467547, 'recall': 0.93560475, 'specificity': 0.99825484, 'f1': 0.9372933, 'auroc': 0.9997322}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    1    0     2     0     0    0      1
1     0  1324    0     0    0    0     0     7     0    1      0
2     0     0  208     0   19    5     0     2     2   75      1
3     0     0    0  8366    0   11     0    25    35    1      0
4     6     0    0     0  501    0     0     2     4    1     25
5     0     0    0     1    0  516     1     0     0    3      0
6     0     1    0     0    0    0  1904     0     0    0      3
7     1    19    0    99    1    0     4  7108    20    3      4
8     1     0    0    17    6    2     1    21  3225    1     22
9     2     0    1     2    0  103     0     0     1  383      1
10   13     0    0     6   24    1     5     3     6    0  12737
---- Validation: 
scalar performance:
{'acc': 0.9838438, 'precision': 0.9512296, 'recall': 0.93826646, 'specificity': 0.9982923, 'f1': 0.94136775, 'auroc': 0.99970907}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     1    0    0     4     0     0    0      1
1     0  1324    0     2    0    0     0     4     0    0      2
2     1     0  215     0   16    4     1     4     1   69      1
3     2     0    0  8361    1   10     1    28    36    1      0
4     5     0    1     0  485    1     0     1     6    1     39
5     0     0    0     1    0  520     0     0     0    0      0
6     0     0    0     0    0    0  1903     0     0    0      5
7     4    11    0    82    1    0     4  7133    22    3      5
8     1     0    0    19    2    3     0    19  3230    2     20
9     0     0    0     1    0   93     0     0     0  398      1
10   13     0    0     7   19    1     6     6     8    1  12735
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68460083, 'precision': 0.6681568, 'recall': 0.59090793, 'specificity': 0.9682213, 'f1': 0.5526406, 'auroc': 0.87634236}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   883     0   0   36    0   23   145    41    14    8    20
1     4  1149   0   29    0    0     4   255    15    3    40
2    29     0  35    9  104   95    29    46   295   61   312
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   0    0  193    0     5     1    24    0  1409
5     3     0   0   31    0  489    10     0     4   52     3
6     5     0   0    3    0    0  2769     4    10    0   276
7     1     0   0  119    0    1     1  1032     6    1     3
8     0     0   0   42    1   12    23     9  1273    2     8
9    14     0   7   56    1  484    24    44   144  329    34
10    0     0   0    0   11    0     2     0     0    0  1633
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_21.png
better model found
persisted
after epoch: 21,now: 2024-07-08 12:47:05.438821,epoch time: 0:32:23.245904,used: 11:04:10.998449,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9852044, 'precision': 0.9664292, 'recall': 0.9524865, 'specificity': 0.9983783, 'f1': 0.95840013, 'auroc': 0.9998037}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    2    0     3     0     0    1      8
1     0  1310    0     0    0    0     0    21     1    0      0
2     0     0  262     0    8    0     0     0     0   42      0
3     1     0    0  8327    0   10     1    56    37    4      0
4     4     0    5     0  450    0     0     1     8    3     67
5     0     0    0     1    0  494     0     0     0   26      0
6     2     0    0     3    0    1  1897     0     0    0      4
7     2     1    1    57    0    0     3  7142    46    3      8
8     0     0    1    32    2    1     2     8  3238    2     10
9     0     0    4     0    0   16     0     1     1  470      1
10    2     0    1     3    2    0     4     2    17    0  12764
---- Validation: 
scalar performance:
{'acc': 0.98526144, 'precision': 0.96905994, 'recall': 0.95066386, 'specificity': 0.998374, 'f1': 0.95855236, 'auroc': 0.99982005}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     0    2    0     2     1     3    1      9
1     0  1311    0     0    0    0     0    19     2    0      0
2     0     0  257     0   10    0     0     1     0   44      0
3     1     0    0  8331    0    6     0    53    46    3      0
4     4     0    3     0  444    0     1     0    10    1     76
5     0     0    0     2    0  498     0     0     0   21      0
6     4     0    0     1    0    0  1895     2     1    1      4
7     0     0    0    56    0    0     1  7146    51    2      9
8     0     0    0    29    3    1     0     8  3242    4      9
9     0     0    4     1    0   12     0     1     1  474      0
10    1     0    1     2    3    0     3     3    11    1  12771
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7017421, 'precision': 0.65044063, 'recall': 0.59325176, 'specificity': 0.96997464, 'f1': 0.56335115, 'auroc': 0.8682487}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   980     1   1    6   0   17    64     3    29   29    40
1     5  1138   0   32   0    0     1   292    13    1    17
2     5     0  61    9  49   35    11    34   301  147   363
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   1    1  48    0     2     1    15    0  1565
5     4     0   0   34   1  324     5     0     2  220     2
6     2     0   1    2   0    0  2941     3     3    0   115
7     1     0   0  103   0    0     0  1049     8    0     3
8     0     0   0   67   0   14    13     2  1268    3     3
9     5     1  18   61   3  204    14    36   183  578    34
10    0     0   0    0   2    0     0     1     0    0  1643
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_22.png
better model found
persisted
after epoch: 22,now: 2024-07-08 13:18:40.852568,epoch time: 0:31:35.413747,used: 11:35:46.412196,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9772046, 'precision': 0.9486495, 'recall': 0.94135034, 'specificity': 0.99747974, 'f1': 0.9423833, 'auroc': 0.9996643}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    0    0     0     0     1    0      7
1     0  1328    0     0    0    0     0     3     0    0      0
2     0     0  300     0    0    0     0     1     1    2      8
3     0     9    0  8073    0   22     1   218   111    0      2
4     7     0   37     0  392    0     0     1     4    1     97
5     1     0    1     0    0  472     1     0     9   37      0
6    16     0    0     1    0    0  1881     2     0    1      7
7     1    14    1    21    0    0     1  7194    22    0     10
8     0     0    1     5    0    0     0    35  3206    0     47
9     1     0   39     1    1   14     0     2     3  431      1
10    4     0    0     3    7    0     2     1     6    0  12772
---- Validation: 
scalar performance:
{'acc': 0.9773706, 'precision': 0.94812703, 'recall': 0.9397584, 'specificity': 0.9974853, 'f1': 0.9406872, 'auroc': 0.9996686}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    1    0     0     0     0    0      9
1     0  1327    0     0    0    0     0     4     0    0      1
2     0     0  297     0    0    0     0     2     0    5      8
3     1    13    0  8082    0   21     1   222    98    2      0
4     7     0   37     0  381    0     1     1     6    2    104
5     0     0    2     0    0  489     0     0     4   25      1
6     9     0    1     0    0    0  1887     0     2    0      9
7     0    20    0    20    0    0     0  7191    21    0     13
8     0     0    1     5    3    0     1    21  3216    0     49
9     1     0   56     0    0    8     0     2     2  421      3
10    6     0    1     2    5    0     2     0     5    0  12775
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7423914, 'precision': 0.6800951, 'recall': 0.62927693, 'specificity': 0.9739227, 'f1': 0.6102758, 'auroc': 0.87824106}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1108     4    0   7    0    2     8    25     8    1     7
1      1  1348    0   3    0    0     1   113     5    0    28
2     38     3  242   0   46   12    21    43   163   33   414
3      0     0    0   0    0    0     0     0     0    0     0
4      4     1    0   0  126    0     4     1    12    0  1485
5     33     3   14  27    0  283     9     2     6  213     2
6      1     0    1   0    0    0  2994     1     1    0    69
7      3     2    0  43    0    0     2  1109     3    0     2
8      4     1    1  15    0    5    19    19  1287    3    16
9     53    10  163  14    0  114    15    65   178  476    49
10     0     0    0   0    7    0     0     1     0    0  1638
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_23.png
early stop counter: 1
val acc:0.9773706197738647, best validation acc: 0.9852614402770996, corresponding to test acc:                         0.7017421126365662 / 0.7579934000968933
after epoch: 23,now: 2024-07-08 13:50:14.678410,epoch time: 0:31:33.825842,used: 12:07:20.238038,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9821543, 'precision': 0.9513441, 'recall': 0.9367428, 'specificity': 0.9980713, 'f1': 0.9410222, 'auroc': 0.9997535}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    1     2    1    0     2     0     1    0     21
1     0  1324    0     4    0    0     0     4     0    0      0
2     0     0  284     1    7    0     0     0     1   18      1
3     0     0    0  8328    0    0     0    63    46    0      0
4     3     1   35     0  447    0     0     1     8    1     43
5     0     0    0    21    0  381     0     0    17  102      0
6     1     0    0     0    0    0  1885     1     1    1     18
7     0    31    2    63    0    0     2  7151    10    0      4
8     0     0    1    28    4    0     0    23  3225    0     14
9     0     0   13     2    1    2     0     0     1  474      0
10    1     0    2     5   18    0     1     7     5    0  12755
---- Validation: 
scalar performance:
{'acc': 0.9815701, 'precision': 0.9498043, 'recall': 0.93488955, 'specificity': 0.998002, 'f1': 0.93916523, 'auroc': 0.9997301}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     0    0    0     4     1     0    2     13
1     0  1325    0     2    0    0     0     5     0    0      0
2     0     0  285     0    8    0     0     3     3   11      2
3     0     1    0  8343    0    0     0    56    40    0      0
4     6     0   42     0  430    0     0     1     9    2     49
5     0     0    0    24    0  382     0     0    12  103      0
6     1     0    0     0    0    0  1888     0     1    2     16
7     0    29    1    75    1    0     0  7145    11    0      3
8     0     0    0    31    0    0     0    32  3212    0     21
9     0     0   16     3    0    2     0     1     1  470      0
10    0     1    1     4   20    0     1     8     7    1  12753
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.674456, 'precision': 0.67299926, 'recall': 0.5560099, 'specificity': 0.9671143, 'f1': 0.53875804, 'auroc': 0.86866754}
confusion matrix:
     0     1    2    3    4   5     6     7     8    9     10
0   741     0    1   39    0   0   157   113    29   51    39
1     0  1367    0   24    0   0     0    97     4    1     6
2    20     3  131   17  114   1     1    96   168   96   368
3     0     0    0    0    0   0     0     0     0    0     0
4     0     0    0    0  161   0     1     3     8    0  1460
5     8     0    1  138    1  59     9     1    12  343    20
6     3     0    0    3    1   0  2570     2     1    0   487
7     0     2    0   31    0   0     0  1129     0    0     2
8     0     0    0   86    0   0    11    41  1214    5    13
9    10     8   68  109    3   7     7   141   109  631    44
10    0     0    0    0    9   0     0     0     0    0  1637
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_24.png
early stop counter: 2
val acc:0.9815701246261597, best validation acc: 0.9852614402770996, corresponding to test acc:                         0.7017421126365662 / 0.7579934000968933
after epoch: 24,now: 2024-07-08 14:21:53.658443,epoch time: 0:31:38.980033,used: 12:38:59.218071,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98169947, 'precision': 0.96122074, 'recall': 0.9633486, 'specificity': 0.99803746, 'f1': 0.9617947, 'auroc': 0.99983686}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    0     0    3    2     5     0     4    1     28
1     0  1317    0     0    0    0     0    13     1    0      1
2     0     0  295     0    6    1     0     0     0   10      0
3     0     1    0  8088    1    5     0   247    95    1      0
4     2     0    2     0  517    0     0     0     2    1     14
5     0     0    0     6    0  488     0     0     8   19      0
6     0     0    0     1    0    1  1899     2     0    0      5
7     0     5    0    14    1    0     0  7227    14    0      3
8     0     1    4     8    7    0     0    21  3250    0      4
9     0     0   27     0    1    6     0     0     3  456      0
10    1     0    2     2   51    1     2     2    16    0  12715
---- Validation: 
scalar performance:
{'acc': 0.98277384, 'precision': 0.962191, 'recall': 0.962188, 'specificity': 0.99815726, 'f1': 0.9618205, 'auroc': 0.9998086}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     0    0     1    5    1    10     0     3    0     20
1     0  1317    0     0    0    0     0    15     0    0      0
2     0     0  292     0    7    0     0     0     3   10      0
3     0     0    1  8153    0    2     0   190    93    1      0
4     2     1    2     0  511    0     0     0     4    1     18
5     0     0    0     2    0  495     0     0     3   21      0
6     0     0    0     3    0    0  1894     2     2    0      7
7     0     4    2    12    3    0     1  7227    10    0      6
8     0     1    1     5    5    0     0    33  3244    0      7
9     0     0   30     0    0    9     0     1     3  450      0
10    0     1    1     3   43    0     6     4    23    0  12715
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71874344, 'precision': 0.6393802, 'recall': 0.59577906, 'specificity': 0.9714688, 'f1': 0.58865964, 'auroc': 0.8731721}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   769     3    1  22    6   12   169    69    57   25    37
1     0  1283    0  10    0    0     2   184     8    0    12
2     1     4  172  10  315   14    37    64   131   54   213
3     0     0    0   0    0    0     0     0     0    0     0
4     0     1    1   0  318    0     3     1     8    1  1300
5     5     0    2  84    2  252     8     2    31  205     1
6     0     0    0   3    1    0  3014     1     1    0    47
7     0     0    0  26    0    0     1  1131     3    0     3
8     0     1    0  27    1    0    15    20  1298    4     4
9     6     9  230  47   15   88    23   101   177  411    30
10    0     0    0   0   19    0     1     1     0    0  1625
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_25.png
early stop counter: 3
val acc:0.9827738404273987, best validation acc: 0.9852614402770996, corresponding to test acc:                         0.7017421126365662 / 0.7579934000968933
after epoch: 25,now: 2024-07-08 14:53:53.591439,epoch time: 0:31:59.932996,used: 13:10:59.151067,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98785317, 'precision': 0.9665716, 'recall': 0.97422576, 'specificity': 0.99869037, 'f1': 0.96998876, 'auroc': 0.99986684}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   481     0    0     1    0    0     0     0     0    1      0
1     0  1324    0     1    0    0     0     6     0    0      0
2     1     0  296     0    3    0     0     0     0   10      2
3     1     7    0  8312    1   51     0    38    27    0      0
4     6     0    4     0  494    0     1     1     2    1     30
5     0     0    0     0    0  512     0     0     0    9      0
6     5     0    0     0    0    1  1897     1     0    0      3
7     0    11    2    61    1    0     0  7165    17    1      6
8     1     0    0    12    6    1     1    23  3219    2     29
9     0     0    6     0    0   22     1     1     1  462      0
10   11     0    1     2   10    1     2     2     6    0  12760
---- Validation: 
scalar performance:
{'acc': 0.9872676, 'precision': 0.966219, 'recall': 0.97046864, 'specificity': 0.9986031, 'f1': 0.96781194, 'auroc': 0.9998636}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   482     0    0     0    0    0     0     0     0    0      1
1     0  1324    0     0    0    0     0     7     1    0      0
2     0     0  297     0    4    0     0     2     1    8      0
3     1     5    0  8321    0   47     2    38    26    0      0
4     6     0    3     1  483    0     0     1     2    1     42
5     0     0    2     0    0  508     0     0     0   11      0
6     6     0    0     0    0    0  1898     0     0    0      4
7     1     6    3    78    1    0     1  7157     8    1      9
8     1     0    0    15    3    3     0    18  3224    1     31
9     0     0    7     0    0   28     0     2     1  453      2
10   14     0    2     4    6    0     5     1     2    0  12762
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73238647, 'precision': 0.67080176, 'recall': 0.622169, 'specificity': 0.9730123, 'f1': 0.6067366, 'auroc': 0.88152385}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1095     0    1   11    0    4    33   12     9    0     5
1     11  1282    1   17    0    1     6  131    11    1    38
2     22     1  184   12  138   26    32   33   193   41   333
3      0     0    0    0    0    0     0    0     0    0     0
4      2     0    1    0  215    0     3    2     8    0  1402
5     22     0    4   44    2  377    11    1     5  123     3
6      3     0    0    4    0    0  3030    1     2    0    27
7      7     0    0  146    0    1     7  997     3    0     3
8      2     1    2   37    2    7    36    9  1263    2     9
9     23     7   97   64    5  234    45   72   157  391    42
10     0     0    0    0   10    0     1    0     1    0  1634
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_26.png
better model found
persisted
after epoch: 26,now: 2024-07-08 15:25:31.709109,epoch time: 0:31:38.117670,used: 13:42:37.268737,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9851509, 'precision': 0.97235936, 'recall': 0.9588179, 'specificity': 0.99830985, 'f1': 0.9647466, 'auroc': 0.9998395}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     0    0    0     5     0     0    0     14
1     0  1324    0     1    0    0     0     7     0    0      0
2     0     0  294     0    5    1     0     5     0    7      0
3     0     0    0  8311    0    6     0    95    23    1      1
4     3     1    4     0  473    1     1     0     1    0     55
5     0     0    0     0    0  517     0     0     0    4      0
6     0     0    1     0    0    0  1892     1     0    0     14
7     1     5    0    42    1    0     2  7199     4    1      7
8     0     1    0    22    5    1     0    85  3141    1     40
9     0     0   10     0    0   58     0     1     0  424      0
10    0     0    1     1    5    1     0     3     0    0  12782
---- Validation: 
scalar performance:
{'acc': 0.98542196, 'precision': 0.9708605, 'recall': 0.9551567, 'specificity': 0.9983474, 'f1': 0.96202433, 'auroc': 0.9998366}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     1    1    0     4     0     1    0     15
1     0  1327    0     2    0    0     0     3     0    0      0
2     0     0  292     1    3    3     1     1     0    8      3
3     0     0    0  8334    0    4     2    80    18    1      1
4     5     1    3     0  471    1     0     1     0    1     56
5     0     0    0     2    0  512     0     0     1    6      0
6     2     0    0     2    0    1  1883     1     1    0     18
7     0     6    0    44    0    0     1  7209     2    1      2
8     0     0    0    16    4    3     1    89  3151    0     32
9     0     0   11     0    0   64     0     3     0  415      0
10    0     0    1     2    5    1     0     2     0    0  12785
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64619046, 'precision': 0.6228294, 'recall': 0.5803468, 'specificity': 0.9641615, 'f1': 0.5473093, 'auroc': 0.8595136}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   938     2    0  12    3   32    93    36     6    2    46
1     0  1356    0  15    0    0     1   108     2    0    17
2     5     3   88   2  206   61    17   112    82   25   414
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  117    0     1     2     3    0  1510
5     3     0    0  53    4  459     9     2     3   58     1
6     2     0    0   4    1    0  2034     7     1    0  1018
7     0     1    0  32    0    0     5  1124     0    0     2
8     1     0    0  52    3   18    15    50  1220    1    10
9     8    13  104  48   10  377    33   170    57  258    59
10    0     1    0   0    2    0     0     1     0    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_27.png
early stop counter: 1
val acc:0.9854219555854797, best validation acc: 0.9872676134109497, corresponding to test acc:                         0.7323864698410034 / 0.7579934000968933
after epoch: 27,now: 2024-07-08 15:57:14.440486,epoch time: 0:31:42.731377,used: 14:14:20.000114,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98924446, 'precision': 0.9756361, 'recall': 0.9690173, 'specificity': 0.9988002, 'f1': 0.97214186, 'auroc': 0.9998582}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    3    1     5     0     0    0      4
1     0  1312    0     0    0    0     1    19     0    0      0
2     0     0  302     0    2    0     0     1     0    6      0
3     0     1    0  8368    0    1     2    37    29    0      1
4     3     0    6     1  470    1     1     2     1    1     53
5     0     0    0     4    0  500     0     0     0   17      0
6     0     0    0     1    0    1  1899     0     0    1      5
7     0     1    0    44    0    0     2  7198    14    1      4
8     0     1    3    13    6    0     0    27  3226    2     17
9     0     0    8     0    0   18     0     1     1  465      0
10    1     1    2     2   14    0     2     4     2    0  12764
---- Validation: 
scalar performance:
{'acc': 0.9899157, 'precision': 0.97303057, 'recall': 0.96708906, 'specificity': 0.99888057, 'f1': 0.9697579, 'auroc': 0.99988544}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    2    0     3     0     0    1      4
1     0  1317    0     0    0    0     0    15     0    0      0
2     0     0  291     0    7    0     0     1     0   11      2
3     0     2    1  8364    0    5     1    48    18    1      0
4     3     1   12     0  465    0     0     1     2    1     54
5     0     0    0     0    0  507     0     0     0   14      0
6     0     0    0     0    0    0  1903     2     0    0      3
7     0     3    0    42    0    0     1  7204    11    2      2
8     0     0    4     7    4    2     0    20  3242    4     13
9     0     0   15     1    0    9     0     4     0  463      1
10    2     0    2     2    4    1     3     0     2    1  12779
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72867835, 'precision': 0.64591825, 'recall': 0.62147593, 'specificity': 0.97254455, 'f1': 0.6070643, 'auroc': 0.8702976}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   936     0    5  10    4   30    76    13    13   39    44
1     0  1234    0  15    0    5     0   221     6    1    17
2     1     0  225   4  203   19    15    25    83   75   365
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  127    0     3     3     4    0  1495
5     3     0    5  42    4  337     2     0     3  195     1
6     0     0    0   0    1    0  2969     3     1    1    92
7     2     0    2  18    0    1     4  1127     8    1     1
8     1     0    5  24    1   26    20     5  1269    5    14
9     2     1  193  25   10  182     8    37    87  554    38
10    0     0    0   0    8    0     0     1     0    0  1637
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_28.png
better model found
persisted
after epoch: 28,now: 2024-07-08 16:29:07.180585,epoch time: 0:31:52.740099,used: 14:46:12.740213,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98731804, 'precision': 0.96514463, 'recall': 0.9591012, 'specificity': 0.99858475, 'f1': 0.9603428, 'auroc': 0.9998823}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    2     1    1    0    13     1     0    0     19
1     0  1323    0     0    0    0     0     9     0    0      0
2     0     0  310     0    0    0     0     0     0    2      0
3     0     2    1  8390    0    0     2    24    18    0      0
4     2     0   37     0  460    0     1     0     0    0     39
5     0     0    1     5    0  485     0     0     0   30      0
6     0     0    0     0    0    0  1893     0     0    0     15
7     0     6    5    63    0    0     3  7160    23    0      2
8     0     1    4    32    5    0     0    13  3200    1     40
9     0     0   35     0    0    7     0     0     1  450      0
10    1     0    2     0    2    0     1     1     1    0  12785
---- Validation: 
scalar performance:
{'acc': 0.9874549, 'precision': 0.9672362, 'recall': 0.9602925, 'specificity': 0.9985921, 'f1': 0.96201736, 'auroc': 0.9998804}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    0     0    2    0    16     1     0    1     16
1     0  1326    0     0    0    0     0     6     0    0      0
2     0     0  312     0    0    0     0     0     0    0      0
3     0     2    0  8387    0    1     2    39     9    0      0
4     3     0   39     0  449    0     0     0     1    1     46
5     0     0    1     7    0  487     0     0     0   26      0
6     0     0    0     1    0    0  1892     0     2    0     13
7     0     3    4    54    0    0     2  7181    19    0      2
8     0     0    6    34    6    0     0    20  3193    0     37
9     0     0   29     0    0    3     0     0     1  460      0
10    1     0    1     2    4    0     2     0     4    0  12782
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6741062, 'precision': 0.6519747, 'recall': 0.5683777, 'specificity': 0.96703017, 'f1': 0.57572025, 'auroc': 0.87058693}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   794     0    5   33    2   11   257    9     8   17    34
1     1  1215    4   16    1    0     2  208    15    1    36
2     2     0  347   10  139   12    22   29   101   49   304
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    3    0  131    0     1    2     6    0  1490
5     2     0    9   98    0  245    30    1    11  190     6
6     0     0    2    2    0    0  2700    3     0    0   360
7     0     0    1  262    0    0    11  883     5    0     2
8     0     1   10   79    2    0    22   10  1235    1    10
9     4     0  287  101    1   87    38   39   105  441    34
10    0     0    0    0    2    0     0    0     0    0  1644
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_29.png
early stop counter: 1
val acc:0.987454891204834, best validation acc: 0.9899157285690308, corresponding to test acc:                         0.7286783456802368 / 0.7579934000968933
after epoch: 29,now: 2024-07-08 17:00:47.843901,epoch time: 0:31:40.663316,used: 15:17:53.403529,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9884953, 'precision': 0.9702003, 'recall': 0.957568, 'specificity': 0.99874145, 'f1': 0.962681, 'auroc': 0.9998745}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   481     0    0     0    0    0     0     0     0    0      1
1     0  1324    0     0    0    0     0     6     1    0      1
2     1     0  253     0    5    1     1     1     3   46      1
3     1     0    0  8402    0    0     1    22     8    2      2
4     7     0    4     0  465    0     3     0     6    2     52
5     0     0    0    10    0  495     0     0     0   16      0
6     8     0    0     1    1    1  1895     0     0    1      1
7     1     4    2    54    0    0     0  7168    25    5      5
8     1     0    0    43    4    0     1     9  3224    2     10
9     0     0    1     0    0   15     0     0     1  476      0
10    4     0    1     0    7    0     2     4    12    0  12763
---- Validation: 
scalar performance:
{'acc': 0.9880433, 'precision': 0.9722833, 'recall': 0.95833933, 'specificity': 0.99868286, 'f1': 0.9637914, 'auroc': 0.9998613}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   481     1    0     0    0    0     0     1     0    0      0
1     0  1321    0     2    0    0     0     7     0    0      2
2     2     0  251     0    3    2     0     1     0   51      2
3     1     1    0  8393    0    2     0    33     8    2      0
4     7     0    2     2  464    0     0     0    10    2     52
5     0     0    0     3    0  500     0     0     0   18      0
6     3     0    0     0    0    0  1901     0     0    0      4
7     1     7    0    65    0    0     0  7166    17    4      5
8     1     1    0    53    1    0     1    10  3221    0      8
9     1     0    0     1    1    7     1     0     0  482      0
10    8     0    1     0   11    0     3     1    14    0  12758
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73791367, 'precision': 0.6623645, 'recall': 0.6164726, 'specificity': 0.973414, 'f1': 0.5949974, 'auroc': 0.8712286}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1116     0   0   5    1    0    19    12     3    7     7
1      2  1268   0   9    0    0     5   131    17    2    65
2     37     0  65   1  176    4    23    31   241   64   373
3      0     0   0   0    0    0     0     0     0    0     0
4      0     0   0   0  212    0     7     2    15    0  1397
5     33     0   2  38    4  212     3     0    18  266    16
6      2     0   0   0    0    0  2998     3     2    0    62
7      1     0   0  18    0    0     1  1134     5    2     3
8      2     1   0  22    1    2     8    18  1307    5     4
9     40     2  57  25   17   65    21    32   185  610    83
10     0     0   0   0   19    0     1     1     0    0  1625
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_30.png
early stop counter: 2
val acc:0.9880433082580566, best validation acc: 0.9899157285690308, corresponding to test acc:                         0.7286783456802368 / 0.7579934000968933
after epoch: 30,now: 2024-07-08 17:32:24.730046,epoch time: 0:31:36.886145,used: 15:49:30.289674,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:49:30.289674 at 2024-07-08 17:32:24.730046
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72867835, 'precision': 0.64591825, 'recall': 0.62147593, 'specificity': 0.97254455, 'f1': 0.6070643, 'auroc': 0.8702976}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   936     0    5  10    4   30    76    13    13   39    44
1     0  1234    0  15    0    5     0   221     6    1    17
2     1     0  225   4  203   19    15    25    83   75   365
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  127    0     3     3     4    0  1495
5     3     0    5  42    4  337     2     0     3  195     1
6     0     0    0   0    1    0  2969     3     1    1    92
7     2     0    2  18    0    1     4  1127     8    1     1
8     1     0    5  24    1   26    20     5  1269    5    14
9     2     1  193  25   10  182     8    37    87  554    38
10    0     0    0   0    8    0     0     1     0    0  1637
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7579934, 'precision': 0.6989293, 'recall': 0.643062, 'specificity': 0.97561866, 'f1': 0.6463201, 'auroc': 0.8854913}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   848     1    1  20    2   17   116    23    38   91    13
1     1  1364    0  24    0    0     0   101     5    0     4
2     4     4  325  11  163   16    12    61   168  102   149
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0   12   1  431    0     1     0    19    1  1168
5     1     0    7  56    0  305     4     1     1  216     1
6     1     0    3   2    1    0  3014     2     0    0    44
7     0     0    0  52    0    0     6  1101     2    0     3
8     0     0    2  87    1   12    28     7  1225    5     3
9     2     4  109  75    3  108    11    71   118  616    20
10    0     1    0   0   37    0     2     1     0    0  1605
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_01_42_54_seed_1_21716730_instance_wise_predictions.txt
accuracy from prediction file 0.7286783740292451
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456107 KiB |   6809 MiB |   2937 TiB |   2937 TiB |
|       from large pool | 412856 KiB |   6773 MiB |   2901 TiB |   2901 TiB |
|       from small pool |  43251 KiB |     62 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456107 KiB |   6809 MiB |   2937 TiB |   2937 TiB |
|       from large pool | 412856 KiB |   6773 MiB |   2901 TiB |   2901 TiB |
|       from small pool |  43251 KiB |     62 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 449054 KiB |   6803 MiB |   2934 TiB |   2934 TiB |
|       from large pool | 407075 KiB |   6767 MiB |   2898 TiB |   2898 TiB |
|       from small pool |  41979 KiB |     60 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7502 MiB |   7502 MiB |  14130 MiB |   6628 MiB |
|       from large pool |   7438 MiB |   7438 MiB |  14050 MiB |   6612 MiB |
|       from small pool |     64 MiB |     64 MiB |     80 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 465492 KiB | 703689 KiB |   2236 TiB |   2236 TiB |
|       from large pool | 459592 KiB | 694533 KiB |   2200 TiB |   2200 TiB |
|       from small pool |   5900 KiB |  38227 KiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4556    |    6799    |  488230 K  |  488225 K  |
|       from large pool |     187    |     783    |  271105 K  |  271105 K  |
|       from small pool |    4369    |    6537    |  217124 K  |  217120 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4556    |    6799    |  488230 K  |  488225 K  |
|       from large pool |     187    |     783    |  271105 K  |  271105 K  |
|       from small pool |    4369    |    6537    |  217124 K  |  217120 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     343    |     343    |     624    |     281    |
|       from large pool |     311    |     311    |     584    |     273    |
|       from small pool |      32    |      32    |      40    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      66    |    1677    |  297711 K  |  297711 K  |
|       from large pool |      41    |     312    |  186203 K  |  186203 K  |
|       from small pool |      25    |    1636    |  111507 K  |  111507 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6809 MiB |   2937 TiB |   2937 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   2901 TiB |   2901 TiB |
|       from small pool |      0 KiB |     62 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6809 MiB |   2937 TiB |   2937 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   2901 TiB |   2901 TiB |
|       from small pool |      0 KiB |     62 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6803 MiB |   2934 TiB |   2934 TiB |
|       from large pool |  16640 KiB |   6767 MiB |   2898 TiB |   2898 TiB |
|       from small pool |      0 KiB |     60 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    900 MiB |   7502 MiB |  14130 MiB |  13230 MiB |
|       from large pool |    852 MiB |   7438 MiB |  14050 MiB |  13198 MiB |
|       from small pool |     48 MiB |     64 MiB |     80 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 703689 KiB |   2236 TiB |   2236 TiB |
|       from large pool |  24320 KiB | 694533 KiB |   2200 TiB |   2200 TiB |
|       from small pool |      0 KiB |  38227 KiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6799    |  488230 K  |  488230 K  |
|       from large pool |       2    |     783    |  271105 K  |  271105 K  |
|       from small pool |       0    |    6537    |  217124 K  |  217124 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6799    |  488230 K  |  488230 K  |
|       from large pool |       2    |     783    |  271105 K  |  271105 K  |
|       from small pool |       0    |    6537    |  217124 K  |  217124 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     343    |     624    |     561    |
|       from large pool |      39    |     311    |     584    |     545    |
|       from small pool |      24    |      32    |      40    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1677    |  297712 K  |  297712 K  |
|       from large pool |       3    |     312    |  186203 K  |  186203 K  |
|       from small pool |       0    |    1636    |  111508 K  |  111508 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6809 MiB |   2937 TiB |   2937 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   2901 TiB |   2901 TiB |
|       from small pool |      0 KiB |     62 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6809 MiB |   2937 TiB |   2937 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   2901 TiB |   2901 TiB |
|       from small pool |      0 KiB |     62 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6803 MiB |   2934 TiB |   2934 TiB |
|       from large pool |  16640 KiB |   6767 MiB |   2898 TiB |   2898 TiB |
|       from small pool |      0 KiB |     60 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    900 MiB |   7502 MiB |  14130 MiB |  13230 MiB |
|       from large pool |    852 MiB |   7438 MiB |  14050 MiB |  13198 MiB |
|       from small pool |     48 MiB |     64 MiB |     80 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 703689 KiB |   2236 TiB |   2236 TiB |
|       from large pool |  24320 KiB | 694533 KiB |   2200 TiB |   2200 TiB |
|       from small pool |      0 KiB |  38227 KiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6799    |  488230 K  |  488230 K  |
|       from large pool |       2    |     783    |  271105 K  |  271105 K  |
|       from small pool |       0    |    6537    |  217124 K  |  217124 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6799    |  488230 K  |  488230 K  |
|       from large pool |       2    |     783    |  271105 K  |  271105 K  |
|       from small pool |       0    |    6537    |  217124 K  |  217124 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     343    |     624    |     561    |
|       from large pool |      39    |     311    |     584    |     545    |
|       from small pool |      24    |      32    |      40    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1677    |  297712 K  |  297712 K  |
|       from large pool |       3    |     312    |  186203 K  |  186203 K  |
|       from small pool |       0    |    1636    |  111508 K  |  111508 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730

 Experiment start at: 2024-07-08 17:45:49.271935
before training, model accuracy: 0.08185825496912003
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9147849, 'precision': 0.8446549, 'recall': 0.72108984, 'specificity': 0.9902673, 'f1': 0.759365, 'auroc': 0.99283016}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   351     0   0     8    0    0     2    27     1    4     90
1     0  1182   0    18    0    0     0   126     3    0      3
2     3     0  38     8  143    1     2    66     9   35      7
3     0     0   0  7728    0    2     0   655    53    0      0
4     1     0   1     2  274    0     0    16    34    4    207
5     1     0   1   131    3  268     0     1    10  104      2
6    27     1   0    30    9    1  1699    21     9    2    108
7     0     4   0   106    1    0     1  7127    16    0     10
8     0     0   0   306    6    1     0   344  2536    0    103
9     3     1  17    37   21   46     0    43    11  308      6
10    5     2   0     9   29    0     2    41    21    1  12680
---- Validation: 
scalar performance:
{'acc': 0.9128795, 'precision': 0.8409311, 'recall': 0.7121158, 'specificity': 0.990045, 'f1': 0.75017, 'auroc': 0.9927044}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   336     0   0    15    0    1     1    28     2    2     98
1     0  1195   0    16    0    0     0   117     2    0      2
2     0     1  34     6  138    1     1    69    15   43      4
3     0     0   0  7724    0    3     0   652    59    0      2
4     1     0   0     3  281    0     0    20    30    4    200
5     0     1   0   139    2  253     0     0     9  116      1
6    33     1   0    28    8    0  1676    23    15    3    121
7     0     6   0   105    2    0     1  7128    14    0      9
8     0     0   0   309    8    0     0   330  2526    0    123
9     4     2  15    41   23   49     0    47    13  292      7
10    6     0   0     9   25    0     4    46    20    3  12683
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.51640666, 'precision': 0.565534, 'recall': 0.45861602, 'specificity': 0.95134246, 'f1': 0.42931408, 'auroc': 0.8636688}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   757     2   0   56   0    0     1   278     6   22    48
1     0  1076   0   21   0    0     0   396     1    0     5
2     2     0   0   13  53    1     0   439    55   59   393
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    0  20    0     0     9     4    0  1600
5     7     0   0  189   0  107     0     9    15  261     4
6     0     1   0    3   4    0  1167    46     6    0  1840
7     0     0   0    3   0    0     0  1158     0    0     3
8     0     0   0   97   1    0     0   164  1096    1    11
9     5     5   0   90   1    9     0   605    30  355    37
10    0     0   0    0   0    0     0     1     0    0  1645
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-08 18:18:46.607263,epoch time: 0:32:57.335328,used: 0:32:57.335328,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.944162, 'precision': 0.87070715, 'recall': 0.8306552, 'specificity': 0.9940566, 'f1': 0.8435079, 'auroc': 0.99653053}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   353     0    0     8    3    0    82     5     2    4     26
1     0  1246    0    13    0    0     0    67     6    0      0
2     0     0  135     1   48    1     3    16     9   99      0
3     1     0    0  7943    0   19     3   310   160    1      0
4     2     0   17     0  374    2     3     6    29   10     96
5     1     0    0    20    0  428     0     0    10   61      1
6     4     0    0     9    1    0  1879     2     4    1      8
7     0    11    1   143    2    0     1  7030    70    1      4
8     0     1    0    83   13    3     1   115  3053    3     22
9     1     1    9     7    5   89     4     3    16  357      0
10    7    14    3    10  102    1    54    45    63    5  12491
---- Validation: 
scalar performance:
{'acc': 0.94259727, 'precision': 0.8671993, 'recall': 0.8227639, 'specificity': 0.99386984, 'f1': 0.83648205, 'auroc': 0.99639374}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   338     0    0     8    3    0    89     5     3    4     33
1     0  1255    0    13    0    0     0    56     8    0      0
2     0     0  131     2   47    5     2    12    13  100      0
3     2     0    0  7937    0   17     4   331   149    0      0
4     2     1   19     1  344    3     6     9    25   13    116
5     0     0    0    17    0  423     3     0    11   66      1
6     2     0    0     6    2    0  1882     1     5    0     10
7     0    10    0   140    3    0     3  7038    65    0      6
8     0     2    1    81   17    3     5   112  3051    2     22
9     0     0    5    10    1   88     5     6    12  366      0
10    9    19    1    12  124    2    52    59    43    1  12474
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7099979, 'precision': 0.66926587, 'recall': 0.60571116, 'specificity': 0.97049236, 'f1': 0.581893, 'auroc': 0.8807384}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   774     0   0  11    1    7   328    10     3   22    14
1     0  1228   0  21    0    0     0   235    13    0     2
2     2     0  69   5  182   13     1   139   384   96   124
3     0     0   0   0    0    0     0     0     0    0     0
4     1     0   2   0  219    0     1     7    34    0  1369
5     1     0   0  39    2  442     6     0    24   78     0
6     0     0   0   1    5    0  2940     6    13    0   102
7     0     0   0  67    0    0     0  1093     1    1     2
8     0     0   0  36    1    4     7    14  1305    2     1
9     3     3  23  55    7  119    11   148   311  444    13
10    0     0   0   0    9    0     0     2     1    0  1634
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-08 18:53:18.127552,epoch time: 0:34:31.520289,used: 1:07:28.855617,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9385702, 'precision': 0.8729415, 'recall': 0.8272464, 'specificity': 0.99320567, 'f1': 0.8466414, 'auroc': 0.9967744}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    1     2    1    0     7     8     1    0     16
1     0  1269    0     7    0    0     0    54     1    0      1
2     4     0  174     1   55    1     1    50     1   17      8
3     2     1    0  7649    0    3     7   688    87    1      0
4     7     1   13     2  346    0     1    15    12    2    140
5     3     0    2    61    2  371     0     5    10   65      1
6    10     0    1     1    1    0  1878     4     3    0     10
7     0    11    0    77    1    0     2  7143    22    0      6
8     2     1    3   105   15    0     2   219  2905    2     40
9    16     0   73    13    2   48     1    50     7  279      4
10   36     1    1     9   42    1    18    45    23    0  12619
---- Validation: 
scalar performance:
{'acc': 0.93796974, 'precision': 0.8693807, 'recall': 0.82642066, 'specificity': 0.9931344, 'f1': 0.8445558, 'auroc': 0.9967487}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    1     2    0    0     8     6     0    0     18
1     0  1266    0     7    0    0     0    57     1    0      1
2     4     0  185     0   54    1     1    46     1   11      9
3     4     1    0  7664    0    6    14   671    80    0      0
4     7     0   10     2  337    1     0    11    12    3    156
5     2     0    2    55    1  365     1     8     9   77      1
6    10     0    1     0    1    0  1879     3     1    0     13
7     0    11    0    77    1    0     1  7155    16    0      4
8     2     1    1   126   10    0     0   234  2884    1     37
9    10     0   88    11    3   52     1    47     6  274      1
10   41     0    1     6   46    1    23    50    19    0  12609
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70454067, 'precision': 0.6450354, 'recall': 0.595869, 'specificity': 0.9702765, 'f1': 0.56528413, 'auroc': 0.8789812}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1136     0   0   3    0    0    12    14     1    1     3
1      0  1266   0  15    0    0     0   211     1    0     6
2     43     0  60  10  121    3     1   266    76   29   406
3      0     0   0   0    0    0     0     0     0    0     0
4      2     0   0   0   84    0     2     2     5    0  1538
5     24     0   0  99    2  328     0     8    29   99     3
6      1     0   0   1    1    0  2895     2     0    0   167
7      0     0   0   7    0    0     0  1156     0    0     1
8      0     0   0  64    1    0     7    68  1219    1    10
9     58     4  73  70    4   53     4   491    57  285    38
10     0     0   0   0    4    0     0     1     0    0  1641
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_3.png
early stop counter: 1
val acc:0.9379697442054749, best validation acc: 0.9425972700119019, corresponding to test acc:                         0.7099978923797607 / 0.7099978923797607
after epoch: 3,now: 2024-07-08 19:25:53.670077,epoch time: 0:32:35.542525,used: 1:40:04.398142,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9450717, 'precision': 0.8942123, 'recall': 0.8563262, 'specificity': 0.9938992, 'f1': 0.8722751, 'auroc': 0.9975191}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     5    1    0     6     8     0    2     23
1     0  1259    0    10    0    0     0    62     1    0      0
2     1     0  191     3   40    1     2    20     1   51      2
3     0     3    0  7905    0    7     0   480    37    4      0
4     5     1   14     0  348    1     3    13     6   12    136
5     0     0    0    32    1  409     0     0     0   78      1
6     5     0    0     7    1    0  1870     9     0    1     15
7     0     8    0    64    1    0     2  7179     6    0      4
8     1     3    3   176   30    0     4   343  2691    6     39
9     1     0   24     5    0   50     0    10     1  402      0
10   15     3    4     5   55    0    34    36     7    2  12631
---- Validation: 
scalar performance:
{'acc': 0.94553965, 'precision': 0.8954717, 'recall': 0.85741514, 'specificity': 0.9939228, 'f1': 0.8734305, 'auroc': 0.9974359}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    0     4    1    0    14     4     0    1     25
1     0  1269    0    12    0    0     0    51     0    0      0
2     3     0  190     1   37    1     2    16     1   55      6
3     0     2    0  7909    0    7     0   490    30    2      0
4     5     0   19     1  350    1     2     9     6   10    136
5     1     0    0    35    0  403     0     0     2   79      1
6     8     0    0     5    0    0  1881     3     2    1      8
7     0     6    0    81    1    0     0  7164     6    0      7
8     1     1    8   188   29    3     1   328  2678    4     55
9     1     0   24     4    0   38     1    12     0  413      0
10   14     2    3    10   47    1    28    25     8    0  12658
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6915273, 'precision': 0.6910645, 'recall': 0.56791645, 'specificity': 0.96927327, 'f1': 0.56035674, 'auroc': 0.87886405}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   956     0   0   84    0    0    55    48     1   22     4
1     1  1159   0   20    0    0     0   312     1    0     6
2    12     0  94   32   87    3     9   300    42   93   343
3     0     0   0    0    0    0     0     0     0    0     0
4     2     1   0    0  153    0     3     4     3    1  1466
5     4     0   0  215    0  211     1     4     1  155     1
6     0     0   0    1    0    0  3049     4     1    0    12
7     0     0   0    7    0    0     0  1155     0    0     2
8     0     0   0  154    2    0    12   126  1066    1     9
9    10     4  44  214    1   29     2   384    19  403    27
10    0     0   0    0    6    0     1     1     0    0  1638
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_4.png
better model found
persisted
after epoch: 4,now: 2024-07-08 19:59:20.537174,epoch time: 0:33:26.867097,used: 2:13:31.265239,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95711154, 'precision': 0.8844098, 'recall': 0.8808768, 'specificity': 0.9953501, 'f1': 0.8817299, 'auroc': 0.9978078}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     0    0     1    4    0     0     2     1    6     48
1     0  1269    1     8    0    0     0    44     4    1      4
2     1     0  225     0   38    0     1     0     0   46      1
3     3     0    1  7998    1   36     1   257   135    4      0
4     4     0   23     0  353    1     0     0    11    6    141
5     0     0    2    10    0  430     0     0     4   74      1
6    11     0    1     5    2    0  1867     1     2    2     16
7     0    12   33    85    3    0     1  6981   127    2     21
8     1     1   10    53   21   14     0    35  3113   12     36
9     0     0   30     3    1   44     0     0     2  413      0
10    9     0    3     8   45    0     6     3    14    2  12703
---- Validation: 
scalar performance:
{'acc': 0.95701486, 'precision': 0.88452953, 'recall': 0.88024974, 'specificity': 0.9953448, 'f1': 0.8815224, 'auroc': 0.99773836}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   415     0    0     3    2    1     3     1     1   10     47
1     0  1267    1     6    0    0     0    43     6    0      9
2     0     0  224     1   40    1     1     0     2   43      0
3     0     1    0  8026    0   36     1   239   135    2      0
4     4     0   23     0  358    1     0     1     8    6    138
5     1     0    0    15    1  434     0     0     3   65      2
6     9     0    0     3    3    2  1868     3     2    5     13
7     2    14   30    84    2    0     2  6973   136    3     19
8     0     0    9    41   23   11     1    43  3111   13     44
9     1     0   31     1    0   46     0     1     3  410      0
10    7     0    9     5   47    1     7     7    17    4  12692
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71615475, 'precision': 0.6474241, 'recall': 0.6085113, 'specificity': 0.9713274, 'f1': 0.5952679, 'auroc': 0.8673191}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1011     0    5  19    5    0    12     9    22   51    36
1      1  1219    0  14    0    0     2   196    10    1    56
2      3     0  216   2  144    4     5    19   160   81   381
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    1   0   42    0     1     1     4    0  1584
5      5     0    9  74    3  236     0     0     8  255     2
6      0     0    0   1    0    0  2822     0     2    0   242
7      0     0    1  11    0    0     0  1142     5    0     5
8      0     0    0  37    1    0     6     8  1303    5    10
9      7     1  241  42    6   31     1    54   123  599    32
10     0     0    0   0    0    0     0     0     0    0  1646
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-08 20:31:26.118348,epoch time: 0:32:05.581174,used: 2:45:36.846413,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94913846, 'precision': 0.8907863, 'recall': 0.84794235, 'specificity': 0.9943191, 'f1': 0.86043495, 'auroc': 0.99772125}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     2    0    0     2     0     0    0     16
1     0  1303    0    14    0    0     0    10     4    0      1
2     4     0  140     0   83    1     1     2     3   67     11
3     5     4    0  8212    0    6     1   130    81    0      0
4     6     0    1     1  315    0     0     2     8    2    203
5     3     0    0    35    2  421     0     0     8   51      1
6    34     0    0     3    2    0  1842     0     2    0     25
7    16   114    0   428    4    0     6  6620    57    0     18
8     2     4    1   104    7    2     0    57  3055    0     64
9    16     0   12    11    6   54     0     3     2  383      6
10   32     1    0     7    8    1     6     6     9    0  12721
---- Validation: 
scalar performance:
{'acc': 0.9501672, 'precision': 0.8880316, 'recall': 0.84694576, 'specificity': 0.9944393, 'f1': 0.85849786, 'auroc': 0.9978504}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     2    0    0     1     0     0    0     16
1     0  1301    0    17    0    0     1    11     1    0      1
2     6     0  131     2   74    1     2     4     5   73     14
3     5     4    0  8229    0    5     0   122    74    1      0
4     5     0    4     1  322    0     1     0     7    2    197
5     5     0    1    35    2  418     0     0     7   52      1
6    36     0    0     0    1    0  1842     0     2    0     27
7    11   119    0   418    2    0     3  6641    51    0     20
8     4     0    1   102   12    3     1    57  3055    1     60
9    13     0   14     8   12   52     0     4     2  386      2
10   34     0    0     8    4    1     4     4     7    1  12733
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6911775, 'precision': 0.63958234, 'recall': 0.583079, 'specificity': 0.96912384, 'f1': 0.5649294, 'auroc': 0.8767356}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1097     0   0   23    1    3    10    6     4    7    19
1      6  1388   0   12    0    0     1   77     3    0    12
2      9     3  40   16  141    6     2   66   271   67   394
3      0     0   0    0    0    0     0    0     0    0     0
4      0     0   0    0   37    0     1    1    10    0  1584
5      8     0   1  131    4  319     0    0    18  109     2
6      7     1   0    1    0    0  2797    1     1    0   259
7      3     0   0  292    0    0     0  864     0    0     5
8      1     0   0   49    2    1     1   18  1286    1    11
9      8    14  30  185    7   78     5  126   227  406    51
10     0     0   0    0    1    0     0    0     0    0  1645
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_6.png
early stop counter: 1
val acc:0.950167179107666, best validation acc: 0.9570148587226868, corresponding to test acc:                         0.7161547541618347 / 0.7161547541618347
after epoch: 6,now: 2024-07-08 21:02:57.100296,epoch time: 0:31:30.981948,used: 3:17:07.828361,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.957165, 'precision': 0.9019808, 'recall': 0.8714024, 'specificity': 0.99534154, 'f1': 0.8823612, 'auroc': 0.9984439}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    0     2    2    0    16     1     1    0     14
1     0  1315    0     3    0    0     0    12     0    0      1
2     6     1  188     3   75    0     2     8     5   23      1
3     2    11    0  8320    1    0     2    65    37    0      0
4     5     1    1     1  421    0     4     1     8    1     95
5     3     1    0    75    3  357     2     0     4   75      1
6     5     1    0     0    0    0  1895     0     1    0      6
7     0   112    0   286    3    0     3  6827    26    0      7
8     0    16    0   175   28    0     5    65  2970    0     37
9    10     0   37    17   13   16     3     4     2  391      0
10    8     0    1     9   63    0    47     6    14    0  12644
---- Validation: 
scalar performance:
{'acc': 0.9577638, 'precision': 0.90035754, 'recall': 0.87349343, 'specificity': 0.9954241, 'f1': 0.8829863, 'auroc': 0.9984493}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   441     0    0     1    1    0    25     1     0    0     14
1     0  1320    0     2    0    0     0     8     2    0      0
2     4     1  195     4   69    0     1    11     1   24      2
3     1    11    0  8339    0    1     3    50    34    1      0
4     6     0    0     2  427    0     3     4     5    1     91
5     5     0    1    66    4  356     0     0     3   85      1
6     6     0    1     2    0    0  1890     0     2    0      7
7     1   111    1   269    3    0     1  6836    36    0      7
8     0    15    1   179   24    1     2    61  2980    0     33
9    14     0   36    20   13   15     1     2     0  391      1
10    8     0    1    10   62    0    63     7    14    0  12631
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7065697, 'precision': 0.64645267, 'recall': 0.57142806, 'specificity': 0.9702805, 'f1': 0.55635005, 'auroc': 0.8809519}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   905     4   0   24    0    0   203    12     8    4    10
1     3  1387   0   13    0    0     4    83     1    0     8
2    11     6  40   23  280    0    57    65   166   66   301
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  160    0    17     3     3    0  1450
5     6     0   2  214    5  129    14     0    15  205     2
6     0     0   0    1    0    0  3062     0     0    0     4
7     1     0   0   11    0    0     2  1147     2    0     1
8     0     6   0   89    2    0    17    21  1226    1     8
9    14    36  48  234   28   19    41   117   153  411    36
10    0     0   0    0    7    0     7     0     0    0  1632
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_7.png
better model found
persisted
after epoch: 7,now: 2024-07-08 21:34:56.360295,epoch time: 0:31:59.259999,used: 3:49:07.088360,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9651113, 'precision': 0.9096148, 'recall': 0.8869874, 'specificity': 0.9961647, 'f1': 0.8923663, 'auroc': 0.9987782}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     1    0     1    1    0     5     1     0    2     30
1     0  1311    0     3    0    0     1    16     1    0      0
2     2     0  268     0    8    1     0     1     1   28      3
3     2     7    0  8220    0    5    20   107    76    1      0
4     3     0   56     2  323    1     1     0     9    2    142
5     0     0    4    21    0  354     0     0     5  136      1
6    12     0    0     0    0    0  1885     0     2    0      9
7     1    25    3   121    1    0     9  7034    60    0     10
8     1     0    4    70   10    1     1    46  3095    0     68
9     0     0   45     3    0   18     0     1     3  422      1
10    4     1    7     7   16    1    17    13     6    0  12718
---- Validation: 
scalar performance:
{'acc': 0.96426374, 'precision': 0.90801626, 'recall': 0.88346636, 'specificity': 0.99607575, 'f1': 0.8886327, 'auroc': 0.9987297}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    0     2    0    0     6     0     2    4     34
1     0  1307    0     2    0    0     0    22     1    0      0
2     0     0  270     0    6    0     0     1     3   30      2
3     1     2    1  8225    0    2    15   110    81    3      0
4     2     1   68     1  316    0     2     1     8    2    138
5     0     0    2    24    1  347     0     0     5  141      1
6    15     0    0     0    0    0  1880     0     1    1     11
7     2    30    3   134    1    0     8  7030    51    0      6
8     0     0    6    74    7    1     1    54  3086    0     67
9     0     0   46     2    0   16     1     0     4  424      0
10    1     1    8     7   23    0    11     8     7    1  12729
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71958303, 'precision': 0.6871773, 'recall': 0.589687, 'specificity': 0.9716251, 'f1': 0.5812774, 'auroc': 0.8818538}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   831     0    4   38    0    0   160    15     6   98    18
1     1  1366    0   13    0    0     0   114     1    0     4
2     2     5  333   16   47    2    69    52   122   51   316
3     0     0    0    0    0    0     0     0     0    0     0
4     0     1    5    0  106    0     6     3     6    0  1506
5     2     0    6  169    0  105    11     0    13  284     2
6     0     0    0    1    0    0  3050     2     1    0    13
7     0     0    1   23    0    0     2  1137     0    0     1
8     0     4    2   68    1    0    31    26  1222    3    13
9     2    18  243  125    1   20    28    72   108  494    26
10    0     0    0    0    3    0     2     0     0    0  1641
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-08 22:06:34.203730,epoch time: 0:31:37.843435,used: 4:20:44.931795,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9597068, 'precision': 0.92930835, 'recall': 0.8651625, 'specificity': 0.9952923, 'f1': 0.8872292, 'auroc': 0.9984045}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    0     1    0    0     5     0     1    0     25
1     1  1294    0     8    0    0     1    25     1    0      1
2     3     0  189     1   30    0     0     2     4   69     14
3     3     0    1  8335    0    9     3    30    54    1      2
4     3     0    5     0  235    1     0     0    11    3    281
5     0     0    0    14    0  469     0     0     4   32      2
6     3     0    0     1    0    0  1889     0     0    0     15
7     4     9    0   318    0    0     2  6760   119    2     50
8     1     1    0    81    2    2     5    20  3074    3    106
9     4     0    8     4    1   58     5     0     2  409      2
10    5     0    0     7    1    0     8     1     4    1  12765
---- Validation: 
scalar performance:
{'acc': 0.9603317, 'precision': 0.9317324, 'recall': 0.8699732, 'specificity': 0.9953662, 'f1': 0.8920827, 'auroc': 0.9984759}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     0    0    0     5     0     0    0     24
1     0  1290    0     8    0    0     0    30     2    0      2
2     3     0  197     0   30    2     2     2     5   59     12
3     3     1    0  8335    0    4     3    30    62    0      2
4     5     0    6     0  246    0     5     0     8    3    266
5     1     0    1    14    0  472     0     0     3   29      1
6     4     0    0     1    0    0  1892     0     2    0      9
7     2    14    1   317    1    0     3  6759   111    1     56
8     1     0    0    81    2    2     5    14  3080    1    110
9     1     0    6     3    2   65     0     0     4  407      5
10    4     0    0     7    1    0    10     1     3    0  12770
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6847408, 'precision': 0.6508887, 'recall': 0.5571287, 'specificity': 0.96818244, 'f1': 0.535896, 'auroc': 0.8615653}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   976     0   0   27   0    0   123     2    12    8    22
1     7  1216   0   35   0    0     0   204     3    0    34
2    33     1  33   17   7    2    28    27   138   73   656
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    1   6    0     2     1     2    1  1620
5    11     0   1  156   0  155     9     0    15  232    13
6     1     0   0    1   0    0  3025     0     0    0    40
7     3     0   0  102   0    0     1  1053     1    1     3
8     2     0   0   91   0    1    16     8  1211    1    40
9    74     4  35  158   0   21    33    26   224  467    95
10    0     0   0    0   0    0     1     0     0    0  1645
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_9.png
early stop counter: 1
val acc:0.9603316783905029, best validation acc: 0.9642637372016907, corresponding to test acc:                         0.7195830345153809 / 0.7195830345153809
after epoch: 9,now: 2024-07-08 22:38:07.374447,epoch time: 0:31:33.170717,used: 4:52:18.102512,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96698415, 'precision': 0.9136325, 'recall': 0.8977034, 'specificity': 0.99649054, 'f1': 0.89770097, 'auroc': 0.99901253}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    0     1    4    1     9     1     2    0     14
1     0  1289    0     5    0    0     1    34     3    0      0
2     0     0  278     0   19    1     0     3     5    6      0
3     1     0    0  8171    0   11     7   157    90    0      0
4     4     1   29     0  390    1     1     3    30    0     80
5     0     0    0     9    0  495     1     0     7    8      1
6     2     0    1     1    0    0  1886     0     5    0     13
7     0     6    0    83    2    0     2  7108    57    1      4
8     1     0    1    81    5    1     0    34  3165    0      6
9     0     0   93     6    1  129     0     3     3  258      0
10    3     0    2     7   48    2     7    10    64    0  12651
---- Validation: 
scalar performance:
{'acc': 0.9674201, 'precision': 0.91779214, 'recall': 0.9024937, 'specificity': 0.99652433, 'f1': 0.9017199, 'auroc': 0.99901134}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     1    2    0    10     2     2    1     12
1     0  1297    0     5    0    0     0    28     2    0      0
2     0     0  291     0   11    1     0     2     5    2      0
3     0     2    0  8190    0    4     8   158    78    0      0
4     4     1   24     0  386    2     2     2    28    0     90
5     0     0    3    15    0  492     0     0     5    5      1
6     7     0    0     1    0    0  1881     0     5    0     14
7     0     9    2    79    1    0     2  7110    58    0      4
8     0     0    1    78    1    1     1    43  3167    0      4
9     0     0   96     1    2  122     0     3     3  266      0
10    4     1    5     7   54    1     9    14    67    0  12634
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65829426, 'precision': 0.62013775, 'recall': 0.5409119, 'specificity': 0.96520907, 'f1': 0.5188811, 'auroc': 0.8734573}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   452     1   17   33    0   15   533    51    32   19    17
1     0  1149    0   29    0    0     2   303     6    0    10
2     2     0  158   22  116   18    60    65   371   23   180
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0   97    0     5     1    30    1  1499
5     1     0    8  173    0  335    28     0    17   28     2
6     1     0    0    1    0    0  3028     1     1    0    35
7     0     0    1   45    0    0     0  1113     3    0     2
8     0     0    1   90    0    1     9    15  1253    0     1
9     3     5  183  203    4  156    49   108   221  184    21
10    0     0    0    0    5    0     1     0     0    0  1640
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_10.png
better model found
persisted
after epoch: 10,now: 2024-07-08 23:09:32.663236,epoch time: 0:31:25.288789,used: 5:23:43.391301,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9675193, 'precision': 0.92629665, 'recall': 0.88287324, 'specificity': 0.9963711, 'f1': 0.89712906, 'auroc': 0.99905956}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     1    0    1     5     1     0    1     20
1     0  1291    0     6    0    0     0    32     2    0      0
2     1     0  216     0   12   10     0     7     4   52     10
3     1     0    1  8340    0   30     0    20    46    1      0
4     3     0   20     0  327    2     1     1     9    6    170
5     0     0    0     1    0  512     0     0     3    3      2
6     5     0    0     3    0    0  1892     1     0    0      7
7     1    18    0   245    1    0     2  6951    38    0      7
8     0     2    1   107    0    6     0    36  3118    2     22
9     2     0   12     4    0  153     0     2     1  315      3
10    3     0    0     7    3    2    10     7    16    0  12746
---- Validation: 
scalar performance:
{'acc': 0.96717936, 'precision': 0.9301101, 'recall': 0.8836324, 'specificity': 0.9963189, 'f1': 0.8986131, 'auroc': 0.99906135}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     1    0    0     4     0     0    1     25
1     0  1289    0     4    0    0     0    37     1    0      1
2     0     0  229     1    7    9     0     8     1   46     11
3     1     0    0  8349    0   25     0    22    42    0      1
4     3     0   18     1  315    3     1     4    13    3    178
5     0     0    0     1    0  512     0     0     1    6      1
6     6     0    0     1    0    0  1892     0     1    1      7
7     2    15    0   252    1    1     2  6937    48    0      7
8     0     0    0   106    2   13     1    37  3119    2     16
9     0     0   13     5    0  158     0     0     1  314      2
10    2     1    0     7    1    0     6    12    17    0  12750
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.701952, 'precision': 0.64868975, 'recall': 0.6034614, 'specificity': 0.9699827, 'f1': 0.5644214, 'auroc': 0.8754512}
confusion matrix:
      0     1   2    3   4    5     6     7     8    9     10
0   1036     0   1    7   0    5    68     3    15    7    28
1      1  1137   0   24   0    0     0   307    11    0    19
2      6     3  74   16  25   38     9    49   249   75   471
3      0     0   0    0   0    0     0     0     0    0     0
4      0     0   0    0  19    0     3     2    14    2  1593
5      8     0   2   50   0  474    11     0     4   31    12
6      1     0   0    1   0    0  2973     2     1    0    89
7      4     0   0  108   0    0     1  1048     2    0     1
8      0     2   0   64   0   10     6     5  1278    1     4
9     21     8  43   77   0  267    27    68   218  349    59
10     0     0   0    0   1    0     0     0     0    0  1645
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_11.png
early stop counter: 1
val acc:0.9671793580055237, best validation acc: 0.9674201011657715, corresponding to test acc:                         0.6582942605018616 / 0.7195830345153809
after epoch: 11,now: 2024-07-08 23:41:00.787052,epoch time: 0:31:28.123816,used: 5:55:11.515117,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97281677, 'precision': 0.93938196, 'recall': 0.9248656, 'specificity': 0.9970302, 'f1': 0.9313891, 'auroc': 0.99929285}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     0    1    0    12     0     2    0     12
1     0  1297    0     4    0    0     0    25     5    0      1
2     1     0  270     1   22    1     1     0     1   11      4
3     0     2    0  8209    0   11     3    53   158    3      0
4     5     0    6     0  420    0     0     0    13    0     95
5     0     0    1     7    0  471     0     0     9   32      1
6     3     0    0     1    1    0  1893     0     2    0      8
7     0    20    2   141    1    0     1  7002    76    0     21
8     0     1    1    26    3    1     1    19  3209    0     35
9     1     0   35     4    0   47     2     0     3  398      2
10   12     0    2     6   15    0     5     5     9    1  12735
---- Validation: 
scalar performance:
{'acc': 0.97279656, 'precision': 0.9358975, 'recall': 0.9199755, 'specificity': 0.9970304, 'f1': 0.9268919, 'auroc': 0.9993022}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    0     1    1    0    14     0     0    0     17
1     0  1304    0     1    0    0     0    22     4    0      1
2     1     0  264     0   24    1     1     4     5    8      4
3     0     5    0  8221    0   12     0    65   136    0      1
4     6     0    5     0  418    0     1     2    12    0     95
5     0     0    2    12    1  473     1     0     6   25      1
6     2     0    0     2    0    0  1895     0     2    0      7
7     0    18    0   140    1    0     1  7004    82    0     19
8     0     0    2    16    7    1     0    16  3216    1     37
9     4     0   46     0    0   51     4     1     4  383      0
10   20     0    1     5   14    0     4     5     7    0  12740
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6971245, 'precision': 0.64716756, 'recall': 0.5802134, 'specificity': 0.969228, 'f1': 0.5675953, 'auroc': 0.8780548}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   818     0    0  46    0    0   242    20    12   11    21
1     6  1097    0  13    1    0     1   327    13    0    41
2    14     2  139   3  146    5     5    26   242   73   360
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  112    0     3     2    15    1  1499
5     2     0   11  47    1  238     2     0    18  270     3
6     0     0    0   1    0    0  2962     1     2    0   101
7     1     0    0  89    0    0     0  1069     2    0     3
8     0     1    0  18    1    1     3    12  1326    2     6
9    13     4  100  38    7   47     9    46   250  564    59
10    0     0    0   0    5    0     2     0     0    0  1639
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_12.png
better model found
persisted
after epoch: 12,now: 2024-07-09 00:12:29.286309,epoch time: 0:31:28.499257,used: 6:26:40.014374,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96575344, 'precision': 0.89964265, 'recall': 0.9341831, 'specificity': 0.9965328, 'f1': 0.91246414, 'auroc': 0.9991751}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     0    0     1    7    0     6     1     4    0     21
1     0  1319    0     2    0    0     0    10     1    0      0
2     1     0  275     0    6    0     0     1     1   28      0
3     1    11    0  8126    0    5     0   196    97    3      0
4     1     1   30     0  485    0     0     1     8    1     12
5     0     0    0    15    1  434     0     0     3   68      0
6     3     0    0     1    2    0  1888     0     2    0     12
7     0    34    3    46    3    0     2  7129    42    2      3
8     0     3    5    13   16    1     1    47  3202    4      3
9     0     0   28     1    0   27     0     1     1  435      0
10    7     2    7     6  350    0     6     6    45    1  12360
---- Validation: 
scalar performance:
{'acc': 0.9645847, 'precision': 0.89705455, 'recall': 0.93723285, 'specificity': 0.9964137, 'f1': 0.91258025, 'auroc': 0.9991474}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    1     0    3    0     6     1     2    2     18
1     0  1323    0     0    0    0     0     7     2    0      0
2     0     0  280     0    4    1     0     0     0   27      0
3     0     7    1  8115    0    8     1   213    92    3      0
4     2     0   33     1  478    0     0     0     9    2     14
5     0     0    1    12    1  439     0     0     3   65      0
6     2     2    0     2    3    0  1886     1     0    2     10
7     0    29    4    52    3    0     1  7121    50    1      4
8     0     0    4    13   12    1     0    49  3212    2      3
9     2     0   26     1    0   22     0     0     2  439      1
10   10     4   13     6  367    1     6     7    63    1  12318
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.77324563, 'precision': 0.7099309, 'recall': 0.6426219, 'specificity': 0.97708523, 'f1': 0.6486954, 'auroc': 0.89150363}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   842     0    0  23    1    0   181    69    13   35     6
1     1  1383    0   8    2    0     0   103     0    0     2
2     4     4  374   7  312    3    11    69   113   73    45
3     0     0    0   0    0    0     0     0     0    0     0
4     0     2    7   0  838    0     1     2    11    1   771
5     2     0    8  89    1  132     7     3    12  336     2
6     3     0    0   1    2    0  2949     3     0    0   109
7     1     0    0  25    0    0     0  1133     1    1     3
8     0     2    0  41    5    0     5    54  1257    6     0
9     7    20  169  61    8   23    10   154    68  614     3
10    0     0    0   0  114    0     1     0     0    1  1530
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_13.png
new oracle model saved
early stop counter: 1
val acc:0.9645847082138062, best validation acc: 0.9727965593338013, corresponding to test acc:                         0.6971244812011719 / 0.773245632648468
after epoch: 13,now: 2024-07-09 00:44:00.837290,epoch time: 0:31:31.550981,used: 6:58:11.565355,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97233516, 'precision': 0.9434668, 'recall': 0.9127933, 'specificity': 0.9968925, 'f1': 0.92435306, 'auroc': 0.9993327}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    0     4    0    0     9     1     0    0     40
1     0  1313    0     4    0    0     2    12     1    0      0
2     0     0  289     0    4    0     3     1     0    9      6
3     0     1    0  8202    0    5     4   123   104    0      0
4     1     1   15     0  363    0     2     3     6    3    145
5     3     0    3    14    0  468     0     0     4   25      3
6     0     0    0     2    0    0  1897     0     1    0      7
7     0    44    2    73    2    0     2  7078    44    0     18
8     0     0    2    28    1    0     5    52  3171    1     36
9     2     0   64     2    0   34     4     2     5  378      2
10    0     0    1     7    8    0     6     5    11    0  12754
---- Validation: 
scalar performance:
{'acc': 0.9716999, 'precision': 0.9408313, 'recall': 0.90688205, 'specificity': 0.9968249, 'f1': 0.9194145, 'auroc': 0.9992824}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   422     0    0     0    1    0    22     0     1    0     37
1     0  1313    0     7    0    0     0    10     2    0      0
2     0     0  287     0    5    0     2     4     1    9      4
3     0     0    0  8208    0    2     2   122   106    0      0
4     2     1   15     0  353    1     5     1     7    2    152
5     0     0    6    15    0  464     1     0     5   28      2
6     1     0    0     1    0    0  1894     2     1    1      8
7     0    30    3    92    1    0     3  7078    39    2     17
8     0     0    3    33    4    0     1    49  3176    0     30
9     3     0   73     3    0   33     1     1     7  370      2
10    0     1    0     7    4    0     5     9     8    0  12762
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65815437, 'precision': 0.6489362, 'recall': 0.55975324, 'specificity': 0.9653987, 'f1': 0.55871373, 'auroc': 0.87450695}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   710     0    5   61   0    4   308     8     1   13    60
1     0  1303    0   51   0    0     0   118     8    0    19
2     1     1  160   29  98    9    11    32   219   49   406
3     0     0    0    0   0    0     0     0     0    0     0
4     0     0    1    1  52    0     3     1    10    0  1565
5     5     0    8   97   0  306     8     0     3  136    29
6     1     0    0    5   0    0  2578     1     5    0   477
7     0     2    0  118   0    0     0  1038     3    0     3
8     0     0    0  131   0    5    17    19  1187    0    11
9     3     2  106  201   5   83    21    61   164  429    62
10    0     0    0    0   0    0     2     0     0    0  1644
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_14.png
early stop counter: 2
val acc:0.9716998934745789, best validation acc: 0.9727965593338013, corresponding to test acc:                         0.6971244812011719 / 0.773245632648468
after epoch: 14,now: 2024-07-09 01:15:32.792313,epoch time: 0:31:31.955023,used: 7:29:43.520378,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9751445, 'precision': 0.9334449, 'recall': 0.9504512, 'specificity': 0.9973923, 'f1': 0.9396893, 'auroc': 0.99955785}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    1    0     1     1     0    0      1
1     0  1302    0     2    0    0     0    22     5    0      1
2     0     0  268     0   11    0     0     2     1   30      0
3     0     0    0  8365    0    2     0    53    13    2      0
4     6     0    7     0  510    0     0     1     5    0     10
5     0     0    0     9    0  450     0     0     1   60      1
6    15     0    0     2    1    1  1866     3     7    1     12
7     3     7    0   128    1    0     1  7103    14    0      6
8     2     0    0    99    6    2     1    58  3124    2      2
9     0     0    9     4    1   14     0     0     0  465      0
10   28     0    0     7  168    0     1    12    63    0  12515
---- Validation: 
scalar performance:
{'acc': 0.9747492, 'precision': 0.93384695, 'recall': 0.94802773, 'specificity': 0.99734503, 'f1': 0.9390116, 'auroc': 0.9995523}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     2    4    1     2     0     0    0      5
1     0  1306    0     1    0    0     0    21     3    0      1
2     0     0  265     1   10    0     0     2     2   32      0
3     0     0    0  8358    0    6     0    61    15    0      0
4     5     1    4     0  509    0     0     2     9    0      9
5     0     0    0    10    0  455     0     0     1   54      1
6    11     0    0     3    3    0  1879     3     1    1      7
7     2     4    0   132    2    0     1  7105    15    0      4
8     1     0    1   109    5    3     2    63  3107    3      2
9     1     0   12     2    1   15     0     1     0  461      0
10   21     0    1     7  163    0     2     5    70    0  12527
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6976142, 'precision': 0.6649554, 'recall': 0.5861064, 'specificity': 0.969783, 'f1': 0.5800772, 'auroc': 0.8818193}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   766     0   2   52   18   30    34    46    96   85    41
1     1  1073   0   23    0    1     0   346    22    0    33
2     1     0  86   19  243   12     3    80   410   92    69
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    0  572    0     1     2    54    1  1002
5     0     0   0  107    0  284     0     3    18  180     0
6     3     0   0    2    1    0  2751     1    20    0   289
7     0     0   0   29    0    0     0  1134     0    0     1
8     0     0   0   98    1    3     0    25  1242    0     1
9     2     0  33  155   13   96     2   110   224  481    21
10    0     0   0    0   62    0     1     0     1    0  1582
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_15.png
better model found
persisted
after epoch: 15,now: 2024-07-09 01:47:02.378172,epoch time: 0:31:29.585859,used: 8:01:13.106237,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9707299, 'precision': 0.9296881, 'recall': 0.86911404, 'specificity': 0.9968208, 'f1': 0.8855662, 'auroc': 0.9992788}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     2    5    0     0     0     0    0     17
1     0  1299    0     1    0    0     0    30     2    0      0
2     1     0  117     2   29    5     0    12    22  120      3
3     0     0    0  8382    0    0     0    32    23    2      0
4     1     0    0     0  407    0     0     1    43    2     85
5     0     0    0    31    0  479     0     0     4    6      1
6    12     0    0     2    0    0  1864     0     4    0     26
7     0     6    0   191    1    0     1  7000    55    1      7
8     0     0    0    63    1    0     0    11  3215    0      5
9     0     0    1    13    0  134     0     3     7  335      0
10    0     0    0     7   11    0     1     4    45    0  12725
---- Validation: 
scalar performance:
{'acc': 0.9703357, 'precision': 0.9332276, 'recall': 0.87164, 'specificity': 0.99677813, 'f1': 0.88992023, 'auroc': 0.9993221}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     1    5    0     1     0     1    2     17
1     0  1288    0     4    0    1     0    34     4    0      1
2     0     0  128     1   26    4     0    16    29  106      2
3     0     2    0  8377    0    0     1    31    29    0      0
4     2     0    0     0  406    0     0     2    50    5     74
5     0     0    0    38    0  476     0     0     4    2      1
6    10     0    0     2    0    0  1862     1     1    0     32
7     0     5    0   181    0    0     1  7003    69    0      6
8     0     0    0    69    0    0     0    12  3207    0      8
9     0     0    0     8    0  131     0     1     8  345      0
10    0     0    0     6   13    0     0     4    44    1  12728
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6068705, 'precision': 0.6741191, 'recall': 0.5145976, 'specificity': 0.96072143, 'f1': 0.49899602, 'auroc': 0.868556}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   910     0   0   49    0    1    61    35    55   17    42
1     3  1142   0   31    1    0     1   257    13    0    51
2     5     0   8   42  104    4     4    46   477   73   252
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    1  113    1     0     1    38    0  1479
5     4     0   0  312    1  164     2     0    22   74    13
6     3     0   0    1    0    0  2091     1     4    0   967
7     2     0   0   65    0    0     0  1089     4    0     4
8     0     0   0  145    0    1     4    13  1205    0     2
9    10     0   0  369    8   74     7    83   235  309    42
10    0     0   0    0    3    0     0     0     0    0  1643
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_16.png
early stop counter: 1
val acc:0.9703357219696045, best validation acc: 0.9747492074966431, corresponding to test acc:                         0.6976141929626465 / 0.773245632648468
after epoch: 16,now: 2024-07-09 02:18:26.486346,epoch time: 0:31:24.108174,used: 8:32:37.214411,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97765946, 'precision': 0.9512308, 'recall': 0.94087833, 'specificity': 0.99751556, 'f1': 0.94570553, 'auroc': 0.9995832}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    1     4    4    0     5     3     0    2     12
1     0  1289    0     5    0    0     0    37     1    0      0
2     0     0  285     1   11    0     0     4     1    8      0
3     0     0    0  8223    0    4     0   161    50    0      0
4     5     0    7     1  472    1     0     2     2    0     49
5     0     0    1    21    0  473     0     0     4   20      1
6     1     0    3     6    1    2  1859     2     0    2     32
7     0     1    0    40    0    0     1  7207     9    0      6
8     0     0    2    35   12    1     0    72  3138    2     34
9     0     0   31     2    0   35     0     3     1  421      0
10    0     3    0     5   46    0     2    14     1    0  12722
---- Validation: 
scalar performance:
{'acc': 0.97656816, 'precision': 0.94787914, 'recall': 0.9368874, 'specificity': 0.9973937, 'f1': 0.9421627, 'auroc': 0.9995155}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   449     0    1     4    3    0     2     9     1    2     12
1     0  1293    0     9    0    0     0    27     2    0      1
2     0     0  276     0   19    0     0     4     1   12      0
3     0     0    0  8212    0    4     0   164    58    2      0
4     2     0   12     0  464    1     0     1     0    2     57
5     0     0    0    14    1  479     0     0     2   24      1
6     1     0    1     7    2    1  1860     3     1    1     31
7     0     2    0    52    0    0     1  7187    17    0      6
8     1     0    3    30   16    1     0    63  3141    0     41
9     0     0   28     5    0   36     0     2     0  422      0
10    2     0    0     6   39    0     1    16     5    1  12726
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65325683, 'precision': 0.62678075, 'recall': 0.5446712, 'specificity': 0.965218, 'f1': 0.53629124, 'auroc': 0.86964965}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   672     0    6  154    2   13    47   164     7   68    37
1     0  1075    0   22    0    0     1   380     4    0    17
2     9     3  115   12  261    5     4   141    87   79   299
3     0     0    0    0    0    0     0     0     0    0     0
4     0     1    1    0  124    0     0     3     5    1  1498
5     2     0    7  144    1  176     2     1     6  248     5
6     3     0    0    1    2    0  2610     6     0    0   445
7     0     0    0   34    0    0     0  1126     0    1     3
8     0     0    0   57   10    1     7    38  1231    6    20
9     9     2  105   96   10   38     0   201    75  570    31
10    0     0    0    0    8    0     0     0     0    0  1638
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_17.png
better model found
persisted
after epoch: 17,now: 2024-07-09 02:49:53.476473,epoch time: 0:31:26.990127,used: 9:04:04.204538,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98095036, 'precision': 0.9536903, 'recall': 0.94433796, 'specificity': 0.99790895, 'f1': 0.94820863, 'auroc': 0.999633}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     0    6    0     2     0     0    1      7
1     0  1310    0     2    0    0     0    17     1    0      2
2     0     0  252     0   22    0     0     2     1   31      4
3     1     3    1  8305    0   37     1    64    22    3      0
4     1     0    4     0  459    0     0     0     5    0     70
5     0     0    0     0    0  484     0     0     1   35      1
6     4     0    0     1    0    1  1887     2     1    3      9
7     3     5    1   105    1    0     1  7078    57    1     12
8     1     0    1    43    4    2     3     7  3215    0     19
9     1     0    6     2    0   24     0     0     0  458      2
10    4     0    0     3   11    0     6     2    17    0  12749
---- Validation: 
scalar performance:
{'acc': 0.9809014, 'precision': 0.95406663, 'recall': 0.9455172, 'specificity': 0.99789715, 'f1': 0.94912815, 'auroc': 0.99964803}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    1     0    3    0     3     0     0    3      8
1     0  1312    0     1    0    0     0    16     2    0      1
2     0     0  260     0   18    2     0     0     1   28      3
3     3     2    0  8289    1   31     2    72    31    3      6
4     1     0    4     0  455    0     0     2     3    0     74
5     0     0    0     0    0  477     0     0     2   41      1
6     5     0    0     0    0    0  1889     0     1    0     13
7     1    11    1    94    1    1     1  7082    60    0     13
8     0     0    1    37    8    2     0     9  3219    1     19
9     1     0    6     0    3   18     0     0     1  463      1
10    9     0    1     2    6    0     4     4    10    0  12760
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70852864, 'precision': 0.64740247, 'recall': 0.59620523, 'specificity': 0.9704896, 'f1': 0.5789442, 'auroc': 0.8738307}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   960     0   0  16    1    9    46    24    20   44    50
1     6  1166   0  13    0    0     4   250     8    0    52
2    11     0  94   2  124    5     6    42   178   52   501
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   1   0  110    0     4     1     8    0  1509
5     2     0   4  32    1  277     3     0     7  234    32
6     3     0   0   1    0    0  2940     0     1    0   122
7     2     0   0  11    0    0     1  1146     1    1     2
8     0     0   0  65    3   11    10    20  1237    5    19
9     9     4  94  41   13   75     5    75   150  556   115
10    0     0   0   0    4    0     1     0     0    0  1641
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_18.png
better model found
persisted
after epoch: 18,now: 2024-07-09 03:21:31.966882,epoch time: 0:31:38.490409,used: 9:35:42.694947,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97897047, 'precision': 0.9443119, 'recall': 0.9547904, 'specificity': 0.9977958, 'f1': 0.9485778, 'auroc': 0.9997129}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    7    0     5     0     0    0      1
1     0  1321    0     3    0    0     0     7     1    0      0
2     1     0  277     0   11    2     0     1     0   18      2
3     7     1    1  8345    0   16    10    37    21    2      0
4     2     0    3     0  497    1     0     0     7    1     28
5     0     0    0     1    0  514     1     0     1    3      1
6     3     0    0     1    0    0  1899     0     1    2      2
7     7    13    0   127    1    0     5  7003    94    4      7
8     2     1    0    77    1    1     0     4  3202    1      4
9     1     0   10     2    1   69     0     0     0  410      0
10   24     0    2     6   53    0    27     1    28    1  12652
---- Validation: 
scalar performance:
{'acc': 0.97953725, 'precision': 0.9482398, 'recall': 0.95407355, 'specificity': 0.99783146, 'f1': 0.95045114, 'auroc': 0.9997153}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     1    6    0     5     0     0    0      3
1     0  1322    0     1    0    0     0     9     0    0      0
2     0     0  273     0   16    1     0     1     2   17      2
3     5     3    0  8362    0   12    13    26    19    0      0
4     5     0    4     0  492    2     1     0     7    0     28
5     0     0    0     1    0  512     0     0     2    4      2
6     2     0    0     0    0    0  1898     0     2    1      5
7     3    15    0   155    2    0     2  6999    82    2      5
8     2     1    0    71    0    4     2     3  3203    1      9
9     1     0   15     1    0   55     0     0     1  420      0
10   17     0    1     6   48    1    25     3    23    1  12671
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7380536, 'precision': 0.6680798, 'recall': 0.6315174, 'specificity': 0.97364753, 'f1': 0.6157012, 'auroc': 0.8806815}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1004     1    3   20    4   17    58    18    23   12    10
1      6  1326    0   24    0    0     2   121     6    0    14
2     19     0  163   18  157   16    20    28   258   72   264
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    1    0  201    0     6     1    23    1  1400
5     10     0   13   47    4  419     5     0     5   87     2
6      3     0    0    1    0    0  3038     1     1    0    23
7      0     0    0   52    0    0     3  1104     4    0     1
8      0     0    0  103    0    4    19    11  1225    1     7
9     33     8  118  103   14  188     5    39   153  450    26
10     1     1    0    0   17    0     8     0     0    0  1619
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_19.png
early stop counter: 1
val acc:0.9795372486114502, best validation acc: 0.9809014201164246, corresponding to test acc:                         0.7085286378860474 / 0.773245632648468
after epoch: 19,now: 2024-07-09 03:52:56.203624,epoch time: 0:31:24.236742,used: 10:07:06.931689,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98194027, 'precision': 0.9573915, 'recall': 0.9496616, 'specificity': 0.99809605, 'f1': 0.95233834, 'auroc': 0.99970716}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     2    2    0    15     0     0    0      4
1     0  1312    0     7    0    0     0     7     5    0      0
2     1     0  248     0   41    1     1     1     0   16      3
3     0     0    0  8273    0   12     3    44   104    0      2
4     2     0    0     0  497    1     2     2     5    0     30
5     1     0    0     4    1  504     0     0     3    7      1
6     0     0    0     2    0    0  1902     0     0    0      3
7     1     2    1    84    3    0     1  7090    69    2     10
8     1     0    0     9    2    0     2     3  3260    1     17
9     2     0    4     0    5   44     0     0     1  437      0
10    6     0    2     4   26    1    24     3     9    1  12718
---- Validation: 
scalar performance:
{'acc': 0.9818644, 'precision': 0.95856017, 'recall': 0.945773, 'specificity': 0.99807477, 'f1': 0.9507476, 'auroc': 0.99968505}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     1    3    0    14     0     0    0      3
1     0  1311    0     9    0    0     0     9     3    0      0
2     0     0  246     0   42    0     3     0     1   18      2
3     0     0    0  8284    0   11     0    40   104    1      0
4     1     0    0     0  485    0     3     1     3    0     46
5     0     0    0     1    2  506     0     0     6    6      0
6     0     0    0     3    1    0  1902     0     0    0      2
7     0     4    0    97    0    0     3  7092    58    3      8
8     1     0    0     8    3    0     0     5  3262    0     17
9     1     0    4     1    6   54     1     0     0  426      0
10    5     0    0     3   20    1    19     3    14    0  12731
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6920171, 'precision': 0.6455786, 'recall': 0.5786422, 'specificity': 0.9686891, 'f1': 0.56525713, 'auroc': 0.8727846}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   699     0    1   35    6    4   343    16    30   22    14
1     2  1204    0   29    1    0     5   220    17    1    20
2     6     0  113   16  210   17    29    32   381   50   161
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  169    0     9     1    41    2  1411
5     3     0    0   81    4  340     9     0    27  125     3
6     3     0    0    1    0    0  2966     2    11    0    84
7     1     0    0  107    0    0     2  1045     4    0     5
8     0     0    0   35    0    3    13    11  1306    1     1
9     5     2   59  102   26  150    17    40   300  413    23
10    0     0    0    0    4    0     6     0     0    0  1636
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_20.png
better model found
persisted
after epoch: 20,now: 2024-07-09 04:24:22.521405,epoch time: 0:31:26.317781,used: 10:38:33.249470,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98488337, 'precision': 0.9578795, 'recall': 0.9589326, 'specificity': 0.9983445, 'f1': 0.95799494, 'auroc': 0.99976456}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    2    1     1     2     0    0      3
1     0  1318    0     0    0    0     0    14     0    0      0
2     0     0  283     0    1    1     0     0     0   27      0
3     2     1    0  8321    0   20     8    63    20    1      2
4     6     0   20     0  461    0     0     1     1    2     47
5     0     0    0     0    0  514     0     0     0    6      1
6     2     0    0     0    0    0  1902     0     0    0      4
7     1     4    1    57    0    1     2  7184     8    3      1
8     0     0    1    30    9    1     2    54  3162    0     36
9     2     0   12     1    0   34     0     0     0  443      1
10   11     0    1     3   19    0     2     2     7    0  12750
---- Validation: 
scalar performance:
{'acc': 0.98475325, 'precision': 0.9578908, 'recall': 0.9603567, 'specificity': 0.9983423, 'f1': 0.9585798, 'auroc': 0.99976605}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    0    0     2     1     0    2      0
1     0  1316    0     1    0    0     0    15     0    0      0
2     0     0  287     0    1    0     2     1     0   20      1
3     2     0    0  8316    0   26    10    57    27    0      2
4     6     1   17     0  469    1     0     1     1    2     41
5     0     0    0     1    0  510     0     0     0    9      1
6     2     0    0     1    0    0  1902     0     0    0      3
7     2     2    1    53    0    0     2  7188    11    2      4
8     0     0    1    35    5    8     3    46  3161    3     34
9     0     0    7     0    0   43     0     0     0  439      4
10   12     0    2     1   19    0     6     3     4    0  12749
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73546493, 'precision': 0.68040985, 'recall': 0.624406, 'specificity': 0.97318774, 'f1': 0.6153277, 'auroc': 0.8792285}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   967     0    1   7    0    4   126    20     6   27    12
1     2  1190    0  21    0    1     4   260     3    0    18
2     7     0  228   9   95    8    19    50   144   83   372
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    4   0  193    0     7     4    11    1  1413
5     5     0   10  41    0  324    14     2     1  187     8
6     3     0    0   1    0    0  3046     3     1    0    13
7     0     0    0  41    0    0     0  1119     0    3     1
8     0     0    2  49    1   14    31    24  1224   10    15
9    17     4  143  54    4  110    14    74    92  591    34
10    0     0    0   0   11    0     5     0     0    0  1630
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_21.png
better model found
persisted
after epoch: 21,now: 2024-07-09 04:55:47.450345,epoch time: 0:31:24.928940,used: 11:09:58.178410,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98482984, 'precision': 0.9691163, 'recall': 0.96291304, 'specificity': 0.9983517, 'f1': 0.96572876, 'auroc': 0.999818}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    1    0     1     0     0    0      1
1     0  1318    0     1    0    0     0     5     1    0      7
2     0     0  274     1    8    2     0     1     2   21      3
3     0     0    0  8368    0    0     0    27    41    0      1
4     6     0    5     0  487    1     2     0     6    0     32
5     0     0    0     9    1  490     0     0     5   16      0
6     2     0    0     0    0    0  1898     2     2    0      4
7     0    25    0   133    0    0     0  7054    46    1      4
8     1     0    0    29    1    0     0    14  3244    0      6
9     0     0    5     2    1   16     0     1     0  468      0
10   10     0    1     5   17    0    10     5    17    0  12728
---- Validation: 
scalar performance:
{'acc': 0.9837903, 'precision': 0.96572113, 'recall': 0.9578642, 'specificity': 0.9982568, 'f1': 0.9614475, 'auroc': 0.99979705}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     1    0     0    0    0     4     0     0    0      3
1     0  1323    0     1    0    0     0     5     0    0      3
2     0     0  278     0    6    1     0     1     2   23      1
3     0     1    0  8360    0    0     0    28    51    0      0
4     5     0    8     0  468    1     2     2    17    0     36
5     0     0    0    11    0  481     1     0     6   22      0
6     1     0    0     1    0    0  1898     0     2    0      6
7     1    31    0   127    0    0     1  7055    45    0      5
8     0     0    1    32    1    0     1    11  3246    1      3
9     2     0    4     0    0   19     0     1     3  464      0
10    8     0    0     2   21    0     9     3    22    0  12731
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7010425, 'precision': 0.67196804, 'recall': 0.5795346, 'specificity': 0.96952975, 'f1': 0.57165706, 'auroc': 0.87915564}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   806     2    0   19    0    3   263    27    38    9     3
1     1  1284    0   26    0    0     3   116     3    0    66
2     4     0  115   15   87   11   115    37   309   79   243
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  172    0    12     3    16    0  1430
5     6     0    3  125    0  266    30     1    19  139     3
6     0     0    0    1    0    0  3032     2     1    0    31
7     0     0    0   74    0    0     1  1087     0    0     2
8     0     0    0   76    0    1    40    20  1224    2     7
9    11     7   57  163    4   89    65    45   264  404    28
10    0     0    0    0   14    0     2     0     0    0  1630
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_22.png
early stop counter: 1
val acc:0.9837902784347534, best validation acc: 0.9847532510757446, corresponding to test acc:                         0.7354649305343628 / 0.773245632648468
after epoch: 22,now: 2024-07-09 05:27:22.143299,epoch time: 0:31:34.692954,used: 11:41:32.871364,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9814052, 'precision': 0.95152295, 'recall': 0.96178436, 'specificity': 0.9979851, 'f1': 0.95606565, 'auroc': 0.999715}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    2     3    2    4     0     1     1    6      4
1     0  1314    0     5    0    0     0    13     0    0      0
2     0     0  300     0    0    0     0     0     0   11      1
3     0     0    0  8403    0    4     0    28     2    2      0
4     5     0   38     1  475    1     0     1     3    6      9
5     0     0    0     4    0  507     0     0     0   10      0
6     7     0    0     2    0    0  1886     1     2    1      9
7     0     2    3   192    0    0     1  7047    13    1      3
8     0     2    0    89    4    4     1    36  3148    6      4
9     0     0   16     2    0   19     0     1     0  455      0
10    3     1    6     5   49    0     2     7    33    1  12686
---- Validation: 
scalar performance:
{'acc': 0.9810887, 'precision': 0.94972706, 'recall': 0.95684963, 'specificity': 0.99794745, 'f1': 0.952683, 'auroc': 0.9996976}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     1    2     4    5    3     1     2     1    4      7
1     0  1312    0     7    0    0     0    13     0    0      0
2     0     0  296     0    0    1     0     1     0   14      0
3     0     0    0  8405    0    4     0    26     4    1      0
4     4     0   48     0  465    2     0     0     4    2     14
5     0     0    0     6    0  498     0     0     0   17      0
6     5     0    0     2    0    1  1886     0     1    2     11
7     0     5    2   188    0    0     1  7054    11    1      3
8     0     1    0    98    3    6     0    28  3153    3      4
9     0     0   13     2    0   19     0     0     0  459      0
10    2     1    2     4   47    0     1     4    32    6  12697
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67669487, 'precision': 0.64900327, 'recall': 0.5762736, 'specificity': 0.967636, 'f1': 0.572961, 'auroc': 0.8744249}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   574     3    1   46   12  105   105    57    19  205    43
1     1  1213    2   36    1    0     6   216     3    0    21
2     2     2  232   19  166   28    11    49   134  135   237
3     0     0    0    0    0    0     0     0     0    0     0
4     0     1    6    1  193    0     0     2     8    1  1421
5     0     0    0   89    1  332     1     0     3  163     3
6     9     0    0    3    3    0  2708     3     2    2   337
7     0     0    0   88    0    0     0  1069     4    1     2
8     0     0    2  146    7   13    17    18  1157    3     7
9     0     4   96  169    3  133     1    79    66  562    24
10    0     0    0    0   14    0     0     0     0    0  1632
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_23.png
early stop counter: 2
val acc:0.9810886979103088, best validation acc: 0.9847532510757446, corresponding to test acc:                         0.7354649305343628 / 0.773245632648468
after epoch: 23,now: 2024-07-09 05:58:48.231989,epoch time: 0:31:26.088690,used: 12:12:58.960054,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9838934, 'precision': 0.96291625, 'recall': 0.9605294, 'specificity': 0.9982126, 'f1': 0.96125454, 'auroc': 0.99981856}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     0    4    0    14     2     0    1      7
1     0  1324    0     0    0    0     1     6     0    0      0
2     0     0  295     0    1    0     0     0     0   15      1
3     1     0    1  8379    0    5     9    22     8    0     12
4     1     0   17     0  482    0     0     1     2    1     35
5     0     0    0     3    0  483     0     0     0   34      1
6     2     0    0     0    0    0  1903     1     0    1      1
7     0     5    8   151    0    0     5  7082    10    0      4
8     0     0    2    58    2    1     6    36  3161    2     27
9     0     0   16     1    1   11     0     0     0  464      0
10    4     0    1     2    9    0    18     3     6    3  12746
---- Validation: 
scalar performance:
{'acc': 0.98421824, 'precision': 0.9650916, 'recall': 0.9597856, 'specificity': 0.9982443, 'f1': 0.96188074, 'auroc': 0.9998301}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     1    3    0    15     0     0    0      1
1     0  1322    0     1    0    0     0     9     0    0      0
2     0     0  288     0    2    0     0     1     0   21      0
3     1     0    1  8374    0    2    15    23     6    2     16
4     2     0   14     1  466    0     0     1     6    1     48
5     0     0    1     2    0  487     0     0     0   31      0
6     0     0    1     0    0    0  1906     0     0    0      1
7     0     8    7   135    0    0     5  7093    14    0      3
8     1     0    0    58    2    0     8    35  3165    3     24
9     0     0   12     2    0    5     1     0     0  473      0
10    5     0    4     2    9    0    14     2     1    1  12758
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64807945, 'precision': 0.64756334, 'recall': 0.5218117, 'specificity': 0.9638661, 'f1': 0.53112113, 'auroc': 0.8697656}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   493     0    1   25    1    1   597   14     7   17    14
1     0  1057    2   38    0    0    28  320    14    3    37
2     0     0  250   18  108    7   114   29   189   85   215
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0   13    1  142    0    35    1    17    1  1423
5     0     0    7   88    0  189    67    0     5  230     6
6     1     0    1    1    0    0  3045    0     1    0    18
7     0     0    0  308    0    0     7  841     4    1     3
8     0     1    2  117    0    2   112   12  1117    2     5
9     1     1  119  149    4   63    70   34   167  503    26
10    0     0    0    0    6    0    14    0     0    0  1626
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_24.png
early stop counter: 3
val acc:0.9842182397842407, best validation acc: 0.9847532510757446, corresponding to test acc:                         0.7354649305343628 / 0.773245632648468
after epoch: 24,now: 2024-07-09 06:30:22.015301,epoch time: 0:31:33.783312,used: 12:44:32.743366,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98769265, 'precision': 0.96731615, 'recall': 0.96908975, 'specificity': 0.998702, 'f1': 0.9680586, 'auroc': 0.9998206}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     0    2    0     6     1     0    0      6
1     0  1323    0     0    0    0     0     8     0    0      0
2     0     0  275     0    8    0     0     0     0   28      0
3     0     2    1  8291    0    3     0   102    40    1      0
4     3     0   12     0  507    0     0     1     2    1     13
5     0     0    0     5    0  499     0     0     2   15      0
6     1     0    0     1    0    0  1898     0     4    0      4
7     2    18    2    26    2    0     0  7199    10    1      3
8     0     0    0     8    3    0     0    33  3246    1      4
9     0     0    5     0    0   12     0     0     0  476      0
10    3     0    2     3   28    0     0     0    22    0  12734
---- Validation: 
scalar performance:
{'acc': 0.9876689, 'precision': 0.9666685, 'recall': 0.9682959, 'specificity': 0.9986973, 'f1': 0.96733284, 'auroc': 0.9998546}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    1    0     2     2     0    2      6
1     0  1325    0     0    0    0     0     6     1    0      0
2     0     0  275     0    6    0     0     1     0   30      0
3     1     2    0  8306    0    3     0    87    41    0      0
4     2     0   11     0  500    0     0     0     5    2     19
5     0     0    0     4    0  502     0     0     1   14      0
6     1     0    0     0    2    0  1898     1     2    0      4
7     0    15    3    28    0    0     1  7195    19    0      4
8     1     0    0    11    2    0     0    31  3247    1      3
9     0     0    5     0    0   13     1     0     0  474      0
10    8     0    1     4   33    0     0     2    16    0  12732
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.674526, 'precision': 0.6477511, 'recall': 0.54904294, 'specificity': 0.96734035, 'f1': 0.5389799, 'auroc': 0.87156504}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   787     1    1   56   12    0   104   116    41   22    30
1     2  1064    0   22    0    0     4   325    21    0    61
2     7     0  145   26  148    3    16    58   317   57   238
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    4    0  276    0     0     1    26    0  1326
5     5     0    7  213    6  109     3     2    40  203     4
6     3     0    0    2    1    0  2837     2     2    1   219
7     0     0    0    4    0    0     0  1157     1    0     2
8     1     0    0   59    0    0     3    52  1251    2     2
9    11     1   97  190   11   35     6   106   260  385    35
10    0     0    0    0   16    0     0     0     0    0  1630
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_25.png
better model found
persisted
after epoch: 25,now: 2024-07-09 07:01:46.488367,epoch time: 0:31:24.473066,used: 13:15:57.216432,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98220783, 'precision': 0.9665694, 'recall': 0.9551224, 'specificity': 0.997995, 'f1': 0.9599656, 'auroc': 0.9998096}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    0    0     3     0     0    1      1
1     0  1329    0     2    0    0     0     1     0    0      0
2     1     0  257     2    4    2     0     7     1   34      4
3     0     2    0  8389    0   17     0    27     3    0      0
4     7     0    4     0  469    0     1     2     3    1     52
5     0     0    0     3    0  509     0     0     0    9      0
6     6     0    0     2    0    0  1897     1     0    0      2
7     1    34    0   195    0    0     1  7015    15    0      1
8     1     1    0    91    6    2     3    21  3131    1     38
9     0     0    7     2    0   18     0     0     0  466      0
10    2     0    1     3    5    0     7     2     1    1  12772
---- Validation: 
scalar performance:
{'acc': 0.9823726, 'precision': 0.96677184, 'recall': 0.9566424, 'specificity': 0.9980222, 'f1': 0.96080893, 'auroc': 0.99977654}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   482     0    0     0    0    0     1     0     0    0      0
1     0  1328    0     2    0    0     0     2     0    0      0
2     1     0  261     0    5    1     1     4     2   34      3
3     0     1    0  8395    0   17     0    19     5    3      0
4     6     0    4     1  471    0     0     1     4    2     50
5     0     1    0     3    0  505     0     0     0   12      0
6     3     0    0     3    0    0  1898     0     0    0      4
7     2    27    0   199    0    0     1  7020    14    0      2
8     0     4    0    84    1    2     2    21  3147    3     32
9     0     0    3     3    0   22     0     1     0  464      0
10    6     0    1     4    7    0    13     6     4    0  12755
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7021619, 'precision': 0.6610091, 'recall': 0.58309746, 'specificity': 0.9699885, 'f1': 0.5717393, 'auroc': 0.87584656}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   878     1    0   21    0   10    93    55     8   84    20
1     2  1272    0   24    1    0     2   172     6    0    20
2     4     0  122   10  131   10    52   101   225   95   265
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    1  172    0     6     2    14    1  1437
5     0     0    0   58    0  228     8     2    10  282     4
6     0     0    0    2    0    0  2928     3     1    0   133
7     0     0    0  122    0    0     0  1038     0    1     3
8     0     0    0   85    0    3     9    26  1241    2     4
9     0     3   44  100    5   92    16   113   213  521    30
10    0     0    0    0    7    0     2     1     0    0  1636
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_26.png
early stop counter: 1
val acc:0.9823725819587708, best validation acc: 0.9876688718795776, corresponding to test acc:                         0.6745259761810303 / 0.773245632648468
after epoch: 26,now: 2024-07-09 07:33:26.440010,epoch time: 0:31:39.951643,used: 13:47:37.168075,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9876659, 'precision': 0.9707822, 'recall': 0.96092916, 'specificity': 0.9986394, 'f1': 0.96519774, 'auroc': 0.99983513}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     1    1    0     0     1     0    0      4
1     0  1295    0    14    0    0     0    21     2    0      0
2     0     0  297     0    3    1     0     0     0   11      0
3     0     0    1  8342    0    3     0    66    24    1      0
4     4     0    8     0  478    0     0     0     3    0     46
5     0     0    0     4    0  506     0     0     0   11      0
6     0     0    0     3    0    0  1899     0     1    1      4
7     1     1    1    43    1    0     0  7181    31    0      4
8     0     0    1    20    0    0     0     7  3246    2     19
9     0     0   12     3    1   58     0     2     0  417      0
10    2     0    0     3    1    0     4     1     4    0  12778
---- Validation: 
scalar performance:
{'acc': 0.98732114, 'precision': 0.9739171, 'recall': 0.96228015, 'specificity': 0.9985904, 'f1': 0.9675408, 'auroc': 0.99985254}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     5    0    0     3     0     0    0      3
1     0  1296    0    14    0    0     0    20     2    0      0
2     0     0  295     0    6    1     0     0     0    9      1
3     0     0    1  8328    0    2     0    76    32    1      0
4     5     0    6     0  475    0     0     0     2    1     50
5     0     0    0     6    0  510     0     0     0    4      1
6     2     0    1     1    0    0  1902     0     0    0      2
7     1     1    0    34    0    0     2  7186    34    0      7
8     0     0    0    31    1    0     1     9  3235    1     18
9     0     0   13     3    0   43     0     1     1  432      0
10    4     0    0     2    1    0     2     1     6    0  12780
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6354859, 'precision': 0.6166345, 'recall': 0.5307158, 'specificity': 0.9634352, 'f1': 0.5181314, 'auroc': 0.8633558}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   656     0    7   52    7    2   131   102    88   69    56
1     1  1122    0   37    0    0     3   273    21    0    42
2     4     0  125   26  124   16    11    57   379   53   220
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  105    0     2     1    31    0  1493
5     0     0    6  177    1  220     3     2    22  157     4
6    10     0    0   41    0    0  2541     6    37    0   432
7     0     0    0   31    0    0     0  1130     0    0     3
8     0     0    0  110    0    0     2    20  1230    1     7
9     3     0   87  225    8   81     6    90   290  314    33
10    0     0    0    0    4    0     1     0     1    0  1640
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_27.png
early stop counter: 2
val acc:0.987321138381958, best validation acc: 0.9876688718795776, corresponding to test acc:                         0.6745259761810303 / 0.773245632648468
after epoch: 27,now: 2024-07-09 08:04:50.587418,epoch time: 0:31:24.147408,used: 14:19:01.315483,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9806025, 'precision': 0.9566524, 'recall': 0.95368624, 'specificity': 0.9978484, 'f1': 0.9539087, 'auroc': 0.9997676}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   416     0    0     1    5    0    14     0     0    0     47
1     0  1308    0     0    0    0     0    21     0    0      3
2     0     0  298     1    4    2     0     2     0    3      2
3     0     2    0  8360    0    8     1    58     4    0      6
4     2     0   16     0  508    0     0     1     2    0     10
5     0     0    1     6    0  506     0     0     0    5      1
6     2     0    0     0    0    0  1900     1     0    0      4
7     0     1    0   130    0    0     0  7088    37    0      8
8     0     0    1   109   11    3     0    15  3133    0     24
9     0     0   21     1    2   37     1     1     2  428      0
10    1     0    0     0   76    0     5     1     3    0  12706
---- Validation: 
scalar performance:
{'acc': 0.98106194, 'precision': 0.9578409, 'recall': 0.9573904, 'specificity': 0.9979118, 'f1': 0.9564456, 'auroc': 0.99976337}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0     0    4    0     7     0     0    1     40
1     0  1300    0     0    0    0     0    30     0    0      2
2     0     0  302     0    3    1     0     1     0    4      1
3     1     4    1  8356    0    8     1    65     3    0      1
4     0     0   16     0  511    0     0     2     2    0      8
5     0     0    0     4    0  510     0     0     1    5      1
6     0     0    0     2    0    0  1902     0     1    0      3
7     1     2    0   128    1    0     0  7107    20    0      6
8     1     1    1   116    8    1     3    15  3132    0     18
9     0     0   15     3    1   43     1     2     4  424      0
10    0     0    2     0   78    0     9     1     4    0  12702
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.62443155, 'precision': 0.6376478, 'recall': 0.49412453, 'specificity': 0.96180433, 'f1': 0.4922257, 'auroc': 0.87037486}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   289    0    8   63    3    1   564    44    13   47   138
1     0  888    0   34    0    0     1   514     7    0    55
2     0    1  154   35  138   10    40    79   145   27   386
3     0    0    0    0    0    0     0     0     0    0     0
4     0    0    2    1  322    0     4     2     6    0  1296
5     0    0    8  163    3  179    50     1     4  150    34
6     0    0    0    5    0    0  3006     1     1    0    54
7     0    0    0   54    0    0     0  1107     0    0     3
8     0    0    0  176    2    1    34    13  1135    0     9
9     0    4  101  310    9   63    78   119   133  236    84
10    0    0    0    0   35    0     2     0     0    0  1609
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_28.png
early stop counter: 3
val acc:0.9810619354248047, best validation acc: 0.9876688718795776, corresponding to test acc:                         0.6745259761810303 / 0.773245632648468
after epoch: 28,now: 2024-07-09 08:36:19.117059,epoch time: 0:31:28.529641,used: 14:50:29.845124,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99060893, 'precision': 0.9736297, 'recall': 0.96634245, 'specificity': 0.99897015, 'f1': 0.9698748, 'auroc': 0.9998662}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    3    0     3     1     0    0      5
1     0  1326    0     0    0    0     0     6     0    0      0
2     0     0  273     0   33    1     0     0     0    3      2
3     0     0    0  8388    0    3     0    33    12    1      0
4     3     0    0     0  507    0     0     0     0    0     29
5     0     0    2     1    0  500     0     0     1   17      0
6     2     0    0     0    0    0  1895     0     0    0     10
7     0     3    1    37    0    0     2  7202    14    0      5
8     0     0    0    23    8    0     0    19  3233    2     11
9     1     0   18     6    0    9     0     1     2  456      0
10    2     0    1     1    5    0     0     2     7    0  12774
---- Validation: 
scalar performance:
{'acc': 0.9901297, 'precision': 0.9760301, 'recall': 0.9668422, 'specificity': 0.9989077, 'f1': 0.97124827, 'auroc': 0.999867}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    3    0     0     0     1    0      1
1     0  1326    0     0    0    0     0     5     0    0      1
2     1     0  271     0   32    1     0     0     1    4      2
3     0     1    0  8367    0    2     3    50    15    0      2
4     2     0    0     0  497    1     0     0     2    0     37
5     0     0    0     8    0  498     0     0     0   15      0
6     0     0    0     2    0    0  1901     0     1    0      4
7     0     3    0    38    0    0     1  7205    11    0      7
8     1     2    0    30    5    0     1    12  3232    1     12
9     0     0   14     2    2    9     0     0     0  466      0
10    3     0    0     0    7    0     3     4     4    0  12775
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70300144, 'precision': 0.6207347, 'recall': 0.58602977, 'specificity': 0.969947, 'f1': 0.5692599, 'auroc': 0.8717496}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   977     0    0   25    0    6    89    16    12   36     9
1     3  1206    0   17    0    0     5   210    12    1    45
2    18     1   69    7  258   15    21    31   197   55   343
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0   98    0     3     2     8    0  1522
5     6     0    2  116    7  260    18     1    20  159     3
6     7     0    0    1    0    0  2965     0     1    0    93
7     1     0    0   33    0    0     1  1121     3    2     3
8     0     1    0   41    1    3    13    14  1282    2    13
9    18     1  115  118   43   61    32    50   211  428    60
10    0     0    0    0    3    0     1     0     0    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716730_29.png
better model found
persisted
after epoch: 29,now: 2024-07-09 09:08:34.323961,epoch time: 0:32:15.206902,used: 15:22:45.052026,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_17_45_49_seed_2_21716730
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
slurmstepd: error: *** JOB 21716730 ON gpusrv57 CANCELLED AT 2024-07-09T09:20:34 DUE TO TIME LIMIT ***
