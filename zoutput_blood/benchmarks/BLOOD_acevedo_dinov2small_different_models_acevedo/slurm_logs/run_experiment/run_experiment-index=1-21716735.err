Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul  7 23:45:10 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735

 Experiment start at: 2024-07-07 23:54:37.565839
before training, model accuracy: 0.08150843530893326
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92899185, 'precision': 0.8237586, 'recall': 0.7805284, 'specificity': 0.99223423, 'f1': 0.7921133, 'auroc': 0.99374807}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   394     0    0     5    2    0     0     2     4    2     74
1     1  1250    0     9    1    0     1    49    13    0      8
2     2     1  109     2  110    0     2     4    11   67      4
3     1     1    0  7926    1    4     4   329   172    0      2
4     4     0    4     1  341    1     1     3    24    3    157
5     8     0    3    92    3  260     0     0    24  129      2
6    85     1    2     6    9    0  1689     6     6    2    102
7     0    32    4   178   15    0     1  6861   137    2     31
8     3     1    1   135   43    0     3    58  2974    0     77
9     8     0   48    14   31   30     1     1    11  343      6
10   17     0    1     5  145    0     6    18    23    2  12575
---- Validation: 
scalar performance:
{'acc': 0.92978466, 'precision': 0.82510763, 'recall': 0.7852309, 'specificity': 0.9923142, 'f1': 0.795837, 'auroc': 0.99392545}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   394     0    0     5    3    0     0     3     6    2     70
1     0  1262    0    11    0    0     0    42    10    0      7
2     2     2  117     2  119    2     1     1     7   51      8
3     2     2    2  7938    3    5     3   322   159    1      3
4     1     0    4     0  340    2     0     5    22    6    159
5     5     0    3    93    5  259     2     0    17  135      2
6    92     0    1     6    8    0  1685     5     7    1    103
7     1    29    7   161   19    0     0  6860   155    1     32
8     3     0    2   147   39    0     1    64  2958    1     81
9     8     0   49    10   24   28     1     1    11  356      5
10   14     0    0     6  148    0     1    13    19    4  12591
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6688589, 'precision': 0.6177708, 'recall': 0.55702853, 'specificity': 0.96649283, 'f1': 0.53420323, 'auroc': 0.87686837}
confusion matrix:
      0     1    2   3    4   5     6     7     8    9     10
0   1043     0    1  25    0   0     2    40    14    5    40
1      0  1219    0  15    0   0     0   200     6    0    59
2     12     2   68   1  416   0     1    55   127   61   272
3      0     0    0   0    0   0     0     0     0    0     0
4      1     0    0   0  159   0     1     1     4    0  1467
5     15     0    2  63    1  78     7     2    41  373    10
6      2     1    0   1    1   0  2467     2    17    0   576
7      1     0    0   6    1   0     0  1144     4    1     7
8      2     0    0  41   19   0     8    21  1257    3    19
9     28    11  190  25   52   3     2   116   180  481    49
10     0     0    0   0    2   0     0     0     0    0  1644
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-08 00:26:43.816395,epoch time: 0:32:06.250556,used: 0:32:06.250556,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9433594, 'precision': 0.8738117, 'recall': 0.83075297, 'specificity': 0.99387926, 'f1': 0.84288406, 'auroc': 0.9963035}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   391     0    0     5    2    2    13     5     3   19     43
1     0  1259    2    13    0    0     0    48     4    0      6
2     0     0  146     0   53    1     2     5     6   98      1
3     1     0    0  7995    0   16     3   218   192   14      0
4     1     0   18     1  306    2     1     3    27   19    161
5     1     0    0    31    0  345     1     0     7  135      1
6    13     0    1    10    0    1  1859     6     4    2     11
7     0    20    3   242    4    0     2  6797   176    8     11
8     0     0    3   107    7    1     3    42  3090   12     29
9     0     0   10     5    2   23     0     3     4  445      1
10   13     0    7     8   40    0    26    11    54    8  12626
---- Validation: 
scalar performance:
{'acc': 0.93976194, 'precision': 0.86775446, 'recall': 0.8254547, 'specificity': 0.9934921, 'f1': 0.83725446, 'auroc': 0.9963237}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   390     0    0     4    2    0    16     4     2   17     48
1     0  1251    0    13    0    0     2    48    10    0      8
2     0     0  142     2   47    1     1     6     8  102      3
3     0     2    0  7961    0   25     2   233   205   12      0
4     2     0   13     0  304    0     2     3    28   22    165
5     0     0    0    31    0  349     0     0     6  134      1
6    15     0    1     5    2    0  1858     8     6    4      9
7     1    13    3   271    2    0     1  6762   188   12     12
8     0     0    1   125    4    4     2    42  3075   16     27
9     0     0   19     5    2   28     1     2     3  433      0
10   10     0    6     6   52    0    32    13    57   12  12608
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7111173, 'precision': 0.6447604, 'recall': 0.58724844, 'specificity': 0.9708026, 'f1': 0.5790183, 'auroc': 0.88254726}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   809     0    4  47    2    0    81    32     3  173    19
1     0  1140    2  26    0    0     2   248     9    2    70
2     1     1  187   2  284    4    17    31   185   60   243
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  160    0     6     1    13    1  1452
5     0     0    6  37    1  180     9     0    10  347     2
6     0     0    1   1    0    0  3038     1     2    0    24
7     1     0    2  19    0    0     0  1133     4    1     4
8     0     0    2  59    2    1    19     7  1273    4     3
9     1     0  264  32    9   20     8    80    86  607    30
10    0     0    0   0    6    0     3     0     0    0  1637
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-08 00:57:19.704150,epoch time: 0:30:35.887755,used: 1:02:42.138311,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9419146, 'precision': 0.86128044, 'recall': 0.83693826, 'specificity': 0.99380386, 'f1': 0.83732975, 'auroc': 0.9966726}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    0     6    3    0     8     6     2    2     27
1     0  1234    0    25    0    0     1    54     5    0     13
2     3     0  143     0   84    1     1    22     3   54      1
3     1     0    0  8133    2    3     0   221    72    3      2
4     4     0    9     1  417    0     0     9    13   11     75
5     2     0    0    65    0  291     0     1     3  158      1
6    15     0    0     8    5    1  1851     4     6    3     15
7     0     7    1   184    6    0     2  7023    28    2      9
8     1     0    2   203   33    4     1   130  2906    2     12
9     2     0   33    13    2   15     0     5     3  420      0
10   26     0    1     7  281    0    41    24    49    8  12358
---- Validation: 
scalar performance:
{'acc': 0.94152737, 'precision': 0.86340046, 'recall': 0.8347349, 'specificity': 0.99376583, 'f1': 0.8351257, 'auroc': 0.9964881}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    0     7    1    0    12     3     1    4     21
1     0  1227    0    24    2    0     0    64     6    0      9
2     2     0  138     1   88    1     1    21     1   59      0
3     0     0    0  8122    1    2     0   251    61    2      1
4     6     0    4     1  411    2     1     7    17   10     80
5     1     0    1    63    1  283     0     0     3  168      1
6    27     0    0    13    5    0  1845     1     4    3     10
7     0    10    0   184    4    0     3  7020    32    1     11
8     1     0    1   201   27    0     2   120  2928    4     12
9     2     0   26    13    4   13     1     6     1  426      1
10   29     0    3     6  271    0    26    27    59   10  12365
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6922969, 'precision': 0.6526724, 'recall': 0.55709666, 'specificity': 0.9693457, 'f1': 0.546988, 'auroc': 0.8806083}
confusion matrix:
     0     1   2    3    4   5     6     7     8    9     10
0   973     0   0   79    2   0    33    56     7   16     4
1     3  1077   0   29    1   0     6   257     7    0   119
2    17     0  23   33  455   1    11   109   176   78   112
3     0     0   0    0    0   0     0     0     0    0     0
4     1     0   0    0  374   0     1     1    14    0  1242
5    10     0   0  216    3  92     0     1    10  260     0
6     2     0   0    2    2   0  2992     2     6    0    61
7     3     0   0   79    0   0     0  1078     0    0     4
8     0     0   0  133    2   0     8    29  1196    0     2
9    23     0  27  224   48   9     4   217    97  465    23
10    0     0   0    0   21   0     0     0     0    0  1625
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_3.png
better model found
persisted
after epoch: 3,now: 2024-07-08 01:28:00.779968,epoch time: 0:30:41.075818,used: 1:33:23.214129,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9513859, 'precision': 0.89288396, 'recall': 0.8337116, 'specificity': 0.99467456, 'f1': 0.84646076, 'auroc': 0.9974649}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   394     0    0     4    3    0     5     4     0    9     64
1     0  1280    0    13    0    0     0    32     5    0      2
2     1     1  129     2   59    0     0     1     1  116      1
3     0     1    0  8292    2   11     1    71    58    1      0
4     3     0    6     1  372    0     0     1    16   16    124
5     0     0    0    31    1  294     0     0     5  189      1
6     9     0    0     4   12    2  1813     0     7    6     55
7     1    15    0   281    3    0     2  6878    67    3     13
8     1     1    0   171   17    0     0    63  3015    8     20
9     0     0    8     9    2    7     0     0     2  464      0
10    8     0    2     9   81    0     2    11    49    4  12628
---- Validation: 
scalar performance:
{'acc': 0.95019394, 'precision': 0.88939023, 'recall': 0.8327471, 'specificity': 0.9945574, 'f1': 0.84407365, 'auroc': 0.99730486}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   404     0    0     4    4    0     3     1     2    8     57
1     0  1274    0    19    0    0     0    36     2    0      1
2     0     0  125     2   63    0     0     5     3  113      1
3     1     2    0  8299    1    9     0    66    57    4      1
4     2     0    9     1  373    1     0     1    17   15    120
5     0     0    0    31    0  287     0     0     2  200      1
6     4     0    0     7   12    0  1820     1     5   12     47
7     2    21    1   313    4    0     3  6848    61    1     11
8     0     1    2   191   12    1     0    61  3008    4     16
9     1     0    8     8    3    4     0     1     2  466      0
10    7     0    3     7   90    0     4    13    48    5  12619
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67578536, 'precision': 0.65766907, 'recall': 0.5627656, 'specificity': 0.96755385, 'f1': 0.5553224, 'auroc': 0.8794723}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   749     0   0   93    6    2    30    17    17  233    23
1     0  1233   0   29    0    0     0   209     2    3    23
2     3     4  83   25  390    3     2    28   184  151   142
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  161    0     1     1    21    1  1448
5     0     0   0   82    4  139     0     0     1  366     0
6     1     0   0   17    6    0  2626     1     8    1   407
7     1     0   0  134    0    0     0  1024     2    1     2
8     0     0   0  132    3    0     1     6  1215    9     4
9     1     6  46  112   16   23     0    45    76  787    25
10    0     0   0    0    4    0     0     0     0    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_4.png
better model found
persisted
after epoch: 4,now: 2024-07-08 01:58:32.708218,epoch time: 0:30:31.928250,used: 2:03:55.142379,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93126607, 'precision': 0.85260576, 'recall': 0.82746345, 'specificity': 0.9927468, 'f1': 0.8214374, 'auroc': 0.9969129}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   432     0    4     4    0    0     7     4     6    2     24
1     1  1212    2     5    0    0     1    93    13    0      5
2     0     0  248     0    5    9     3    10    20   16      1
3     0     2    0  7331    0   30     0   687   387    0      0
4     4     0   97     1  243    3     0     4    78    8    101
5     0     0    1     9    0  489     0     0    10   11      1
6    12     0    2     4    0    2  1853    11    10    0     14
7     0     3    2    26    0    0     1  7097   130    0      4
8     0     0    2    27    1    2     0    71  3177    0     15
9     0     0   70     4    0  229     0     3    14  173      0
10   19     0   18     6   58    1     4    22   111    2  12552
---- Validation: 
scalar performance:
{'acc': 0.93090814, 'precision': 0.84725547, 'recall': 0.8276858, 'specificity': 0.9927212, 'f1': 0.82083595, 'auroc': 0.99681854}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   427     0    3     4    0    2     6     4     7    5     25
1     0  1224    1     6    0    0     0    79    16    0      6
2     0     0  249     0    6   13     2     6    18   18      0
3     0     0    1  7347    0   31     0   663   398    0      0
4     4     0  100     1  237    4     0     2    82    6    103
5     0     0    3     8    0  484     1     0    10   14      1
6    14     0    3     2    0    2  1836    14    13    1     23
7     0     4    4    27    0    0     1  7081   139    1      8
8     1     0    3    21    1    2     0    61  3191    0     16
9     0     0   71     3    0  209     0     2    21  187      0
10   20     0   20     6   66    0     5    17   120    3  12539
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6982439, 'precision': 0.64696884, 'recall': 0.60587347, 'specificity': 0.9697696, 'f1': 0.584399, 'auroc': 0.8825723}
confusion matrix:
     0    1    2   3    4    5     6     7     8    9     10
0   767    0   21  51    2    7    25    96    52  127    22
1     2  953    2  18    5    3     0   427    34    0    55
2     0    0  342   3   67   24     0    40   415   38    86
3     0    0    0   0    0    0     0     0     0    0     0
4     0    0   11   0  396    0     1     2    56    0  1167
5     1    0    3  32    0  450     0     1    18   86     1
6     0    0    1   1    3    0  2765     3    64    0   230
7     0    0    0   2    0    0     0  1155     5    0     2
8     0    0    0  38    0    7     0    16  1307    0     2
9     0    0  244  30    2  265     0    65   284  239     8
10    0    0    0   0   40    0     0     0     0    0  1606
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_5.png
early stop counter: 1
val acc:0.9309081435203552, best validation acc: 0.9501939415931702, corresponding to test acc:                         0.6757853627204895 / 0.7111173272132874
after epoch: 5,now: 2024-07-08 02:29:18.626681,epoch time: 0:30:45.918463,used: 2:34:41.060842,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9528842, 'precision': 0.8878427, 'recall': 0.8777685, 'specificity': 0.9948225, 'f1': 0.8805906, 'auroc': 0.99778455}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   369     0    2     7    1    0    46     2     0    5     51
1     0  1297    0     3    0    0     0    27     4    0      0
2     1     0  256     0    9    0     1     2     4   38      1
3     0     1    2  7922    1   17     2   363   128    2      1
4     2     0   45     0  344    1     0     1     5   13    128
5     0     0    1    14    1  426     0     0     3   75      1
6     1     0    1     3    2    0  1886     1     3    0     11
7     1    24    6    95    5    0     2  7059    32    0     40
8     1     0    6    45   55    9     2   104  2979    8     86
9     0     0   36     2    0   31     1     1     4  418      0
10    2     1    7     6   82    0    25     2     4    3  12659
---- Validation: 
scalar performance:
{'acc': 0.9516651, 'precision': 0.8833929, 'recall': 0.87434393, 'specificity': 0.99470115, 'f1': 0.8763033, 'auroc': 0.9977293}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   365     0    1     5    1    0    55     0     0    6     50
1     0  1295    0     4    2    0     1    28     2    0      0
2     1     0  256     0   10    1     2     0     2   38      2
3     0     1    3  7882    1   24     2   380   143    3      1
4     2     0   56     1  344    1     0     0     4    8    123
5     0     0    0    12    0  424     1     0     6   76      2
6     2     0    1     1    1    0  1893     1     1    0      8
7     1    19    8    97    6    0     1  7067    26    0     40
8     0     0   12    45   54    8     1   104  2976    6     90
9     0     0   39     5    0   36     1     2     2  407      1
10    0     1    6     6   75    0    26     5     6    2  12669
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72769886, 'precision': 0.66397864, 'recall': 0.600458, 'specificity': 0.97210085, 'f1': 0.60936904, 'auroc': 0.88517255}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   620     0    5  19    2    0   426    25     7   57     9
1     1  1252    2  11    5    0     5   182     7    2    32
2     1     0  270   1  504    3    21    19    60   38    98
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  549    0    16     1     3    0  1063
5     0     0   14  56    5  246    12     1    20  236     2
6     0     0    0   1    0    0  3059     0     0    0     7
7     0     0    2  72    1    0     6  1075     3    0     5
8     0     0    1  18   22    3    15    19  1277    2    13
9     1     0  372  32   19   56    15    54   118  448    22
10    0     0    0   0   32    0     9     0     0    0  1605
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-08 03:00:04.057579,epoch time: 0:30:45.430898,used: 3:05:26.491740,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9554259, 'precision': 0.8894714, 'recall': 0.866071, 'specificity': 0.9950771, 'f1': 0.8750813, 'auroc': 0.9979871}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   415     1    0     8    2    0    21     2     1    5     27
1     0  1285    1    11    0    0     0    30     3    0      2
2     0     0  176     0   13    2     0     1     0  119      1
3     0     0    0  8319    1    7     0    65    43    2      2
4     2     0   32     0  359    0     2     3     3   17    121
5     0     0    0    30    0  454     0     0     1   35      1
6     6     0    0     2    0    0  1883     3     3    2      9
7     1    49    7   292    4    0     2  6848    35    4     21
8     1     2    7   223   19    5     1    71  2907    3     54
9     0     0    2     6    3   79     2     0     1  400      0
10   13     0    9    10   57    1    20     8    10    2  12664
---- Validation: 
scalar performance:
{'acc': 0.9561321, 'precision': 0.89283806, 'recall': 0.8674339, 'specificity': 0.9951577, 'f1': 0.877167, 'auroc': 0.9979571}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   419     0    0     7    2    1    15     4     1    4     30
1     0  1288    1    10    0    0     0    24     5    0      4
2     0     0  176     1   15    4     1     4     0  111      0
3     1     0    1  8305    0    6     0    70    54    2      1
4     2     0   31     1  352    0     1     2     7   12    131
5     1     0    0    24    0  461     0     0     1   33      1
6     5     1    1     5    0    0  1882     1     4    0      9
7     1    54    4   275    5    0     2  6866    36    4     18
8     0     3    6   217   20    7     1    74  2920    7     41
9     0     0    2     5    1   79     0     2     3  401      0
10    8     1    6     9   54    0    17     8    12    6  12675
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.701952, 'precision': 0.6552906, 'recall': 0.5922886, 'specificity': 0.9702005, 'f1': 0.5852388, 'auroc': 0.87951505}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   836     0    0  140    0    4    53    80    26   19    12
1     1  1083    0   47    0    0     8   298     6    1    55
2    13     0  139   23  201   17    29    43    96  134   320
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    1    0   65    0     3     1     5    0  1557
5     0     0    0  113    3  347     3     0     8  117     1
6     0     0    0    4    0    0  3055     0     0    0     8
7     0     0    1  107    0    1     1  1047     1    2     4
8     0     0    0  126    2    5    10    24  1188    1    14
9     4     0   64  126    7  130     7    76    65  631    27
10    0     0    0    0    0    0     4     0     0    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_7.png
better model found
persisted
after epoch: 7,now: 2024-07-08 03:30:44.145419,epoch time: 0:30:40.087840,used: 3:36:06.579580,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95844924, 'precision': 0.90144116, 'recall': 0.88144344, 'specificity': 0.9956706, 'f1': 0.8848748, 'auroc': 0.99853516}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    0     5    1    0    16     2     4    1      3
1     0  1291    0     6    0    0     1    30     4    0      0
2     0     0  172     1   40    1     1     4    13   80      0
3     0     0    0  8212    0    3     1    58   161    2      0
4     4     0    7     1  387    0     1     4    49    2     84
5     0     0    0    24    0  389     0     0     7  100      1
6     5     0    1     2    1    1  1890     1     3    0      4
7     0    20    0   195    2    0     3  6909   133    0      3
8     1     0    1    36    0    0     0    19  3232    0      7
9     0     0    8     4    2   21     1     0     9  448      0
10   57     1    1     8   82    0    65    14   119    1  12442
---- Validation: 
scalar performance:
{'acc': 0.95872676, 'precision': 0.8996882, 'recall': 0.88238513, 'specificity': 0.99570596, 'f1': 0.8853534, 'auroc': 0.9985525}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     5    2    0    18     2     4    1      5
1     0  1296    0     9    0    0     0    24     2    0      1
2     0     0  179     0   37    3     0     2    18   72      1
3     0     2    0  8207    0    5     2    56   166    2      0
4     4     0    6     1  396    0     2     0    45    4     81
5     0     0    0    20    1  385     0     0    11  103      1
6     8     0    0     5    1    1  1885     2     3    0      3
7     0    16    2   183    1    0     4  6916   139    1      3
8     0     0    1    37    3    0     0    25  3221    1      8
9     0     0   10     6    2   23     0     1     8  443      0
10   57     0    2     8   77    0    65    10   106    3  12468
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71496534, 'precision': 0.6502503, 'recall': 0.5935972, 'specificity': 0.9713216, 'f1': 0.56804264, 'auroc': 0.8821268}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1011     0   0   35    0    0    33    60    27    4     0
1      3  1271   0   21    0    0     3   169    15    0    17
2     16     0  29   17  158   11    32    29   501   62   160
3      0     0   0    0    0    0     0     0     0    0     0
4      3     0   0    0  123    0    33     1    34    0  1439
5      2     0   0  121    1  280     0     0    54  134     0
6      0     0   0    2    0    0  3062     1     0    0     2
7      1     0   0   91    0    0     1  1063     7    0     1
8      0     0   0   23    0    0     3     3  1341    0     0
9     17     3  22  111    8   86     8    59   391  410    22
10     0     0   0    0    3    0    13     0     1    0  1629
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_8.png
better model found
persisted
after epoch: 8,now: 2024-07-08 04:01:10.925624,epoch time: 0:30:26.780205,used: 4:06:33.359785,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9661012, 'precision': 0.9313803, 'recall': 0.8827927, 'specificity': 0.99624395, 'f1': 0.9018097, 'auroc': 0.9989515}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   411     0    0    12    0    0    11     7     2    2     38
1     0  1279    0    12    0    0     0    37     2    0      2
2     3     0  191     1   36    0     0    10     2   67      2
3     0     1    0  8105    0    4     0   240    86    1      0
4     5     0   10     1  390    1     0     6    11    3    112
5     0     0    0    29    0  396     0     0     5   90      1
6     2     0    0     5    0    1  1877     2     2    1     17
7     0    11    0    67    1    0     1  7155    26    1      3
8     0     0    2    49    4    0     0    78  3135    1     27
9     0     0   11     4    0   15     0     4     1  458      0
10    3     0    1     7   21    0     7    18    22    0  12712
---- Validation: 
scalar performance:
{'acc': 0.9651464, 'precision': 0.93034935, 'recall': 0.87982315, 'specificity': 0.99613893, 'f1': 0.8995061, 'auroc': 0.9988642}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   414     0    0    11    0    0    11    10     1    1     35
1     0  1283    0    11    0    0     0    35     2    0      1
2     1     0  200     1   23    0     0    14     4   65      4
3     0     1    0  8095    0    1     0   258    84    1      0
4     3     0    6     2  389    0     0     2    14    8    115
5     0     0    1    35    0  373     0     1     5  105      1
6     5     0    0     6    0    0  1882     2     3    0     10
7     0    12    0    52    1    0     1  7167    26    1      5
8     1     0    2    61    6    0     0    88  3104    3     31
9     1     0   11     9    0   21     1     1     0  449      0
10    2     0    3     7   25    0     6    16    10    1  12726
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69614494, 'precision': 0.69137377, 'recall': 0.56368756, 'specificity': 0.96975565, 'f1': 0.56783664, 'auroc': 0.883191}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   781     0    1   81    0    1   155    92    27   12    20
1     0  1153    0   37    2    0     1   266     5    0    35
2     1     0  129   50  187    1     4   108   275   77   183
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  347    0     2     2    14    0  1268
5     0     0    5  232    1  144     4     1    21  182     2
6     0     0    0    2    0    0  3035     1     2    0    27
7     0     0    0   74    0    0     0  1089     0    0     1
8     0     0    0  145    0    0     3    21  1199    0     2
9     3     0   54  322    2   19     5   165   100  446    21
10    0     0    0    0   18    0     0     1     0    0  1627
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_9.png
better model found
persisted
after epoch: 9,now: 2024-07-08 04:31:36.353227,epoch time: 0:30:25.427603,used: 4:36:58.787388,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9649775, 'precision': 0.92204034, 'recall': 0.8922874, 'specificity': 0.9961082, 'f1': 0.9025304, 'auroc': 0.99879944}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    1     1    1    1     4     1     0    0     20
1     0  1310    0     3    0    0     0    15     2    0      2
2     1     0  267     1   11    1     1     8     1   15      6
3     1    10    0  8091    0    3     2   235    94    4      0
4     5     0   31     1  320    0     1     4    15    1    161
5     0     0    2    28    1  393     0     0     8   88      1
6     7     0    0     0    0    0  1882     1     1    1     14
7     0    61    0    66    1    0     2  7096    27    0     12
8     1     3    4    44    2    1     2    82  3110    0     46
9     0     0   54     3    2   13     3     5     3  407      3
10    7     0    4     7   13    0     5     2    15    0  12738
---- Validation: 
scalar performance:
{'acc': 0.9632473, 'precision': 0.9176575, 'recall': 0.88160527, 'specificity': 0.99590856, 'f1': 0.8941448, 'auroc': 0.9987333}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     1    0     2    0    0    12     1     1    0     19
1     0  1311    0     1    0    0     0    17     2    0      1
2     0     0  257     2   14    0     3    13     1   16      6
3     1     8    0  8098    0    4     0   235    93    1      0
4     5     0   31     1  311    0     0     4    14    0    173
5     0     0    2    25    0  379     0     1     4  109      1
6     9     0    0     2    0    0  1881     0     2    0     14
7     1    43    1    78    1    0     2  7101    28    0     10
8     0     2    3    60    3    0     0    89  3093    0     46
9     3     0   62     2    1   11     2     6     5  396      5
10    9     0    5     7    9    0     8     8    13    0  12737
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6945358, 'precision': 0.66320944, 'recall': 0.5720516, 'specificity': 0.9692676, 'f1': 0.5586587, 'auroc': 0.88085526}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   866     0    0   49   0    2   161    76     3    6     7
1     1  1144    0   19   0    0     2   301     4    0    28
2     9     0  152   26  80   11    24   137   252   57   267
3     0     0    0    0   0    0     0     0     0    0     0
4     0     0    1    0  91    0     2     4    23    0  1512
5     1     0    2  183   0  206     8     1    19  171     1
6     3     0    0    6   0    0  3038     2     0    0    18
7     0     0    0   12   0    0     3  1148     0    0     1
8     0     0    0   89   0    0    16    50  1210    1     4
9     4     0   79  163   1   47    14   222   143  430    34
10    0     0    0    0   1    0     2     1     0    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_10.png
early stop counter: 1
val acc:0.9632472991943359, best validation acc: 0.9651464223861694, corresponding to test acc:                         0.6961449384689331 / 0.7276988625526428
after epoch: 10,now: 2024-07-08 05:02:00.257684,epoch time: 0:30:23.904457,used: 5:07:22.691845,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9709439, 'precision': 0.929898, 'recall': 0.9231498, 'specificity': 0.9968034, 'f1': 0.9257264, 'auroc': 0.9991934}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    0    0     1     1     0    0     10
1     0  1286    0     5    0    0     0    38     2    0      1
2     5     0  251     0    9    1     0     1     4   41      0
3     3     1    0  8324    0    4     0    60    43    4      0
4     7     0   30     1  416    0     0     3     8    1     73
5     1     0    1    20    0  448     0     0     2   47      1
6    12     1    0     0    1    1  1879     1     1    0     11
7     0     4    3   229    1    0     1  6980    38    2      5
8     3     1    3    89    9    1     0    52  3108    3     24
9     1     0   18     4    0   22     0     0     0  448      0
10   13     0    5     6   41    0     1    28    20    2  12679
---- Validation: 
scalar performance:
{'acc': 0.969988, 'precision': 0.92584336, 'recall': 0.91655093, 'specificity': 0.9967152, 'f1': 0.9201501, 'auroc': 0.9991672}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    0    0     0     1     0    0      9
1     0  1293    0     4    0    0     0    33     2    0      0
2     1     0  239     1   11    1     1     4     2   51      1
3     1     0    0  8326    0    3     0    58    50    2      0
4     7     0   24     1  419    0     1     1     7    2     77
5     0     0    0    20    0  435     0     0     1   64      1
6    14     0    0     0    0    0  1878     1     0    1     14
7     5     7    1   230    2    0     1  6979    37    0      3
8     2     1    2    86   10    4     0    60  3101    6     24
9     1     0   15     3    0   32     0     1     2  439      0
10   14     0    2     7   45    0     7    15    24    1  12681
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72287136, 'precision': 0.66804516, 'recall': 0.60767305, 'specificity': 0.9721798, 'f1': 0.6004944, 'auroc': 0.88643473}
confusion matrix:
      0    1    2   3    4    5     6     7     8    9     10
0   1090    0    0  16    1    1    16    37     3    3     3
1      0  967    0  23    0    0     0   486     4    0    19
2     43    1  156   9  325    8     6    75   101   68   223
3      0    0    0   0    0    0     0     0     0    0     0
4      0    0    1   0  335    0     2     3     6    0  1286
5     19    0    2  88    5  239     2     0     9  213    15
6      2    0    0   3    0    0  2976     3     0    0    83
7      2    0    0  22    0    1     0  1137     1    0     1
8      1    1    1  93    4    1     6    44  1208    3     8
9     43    0  115  66   10   49     4   115    98  607    30
10     0    0    0   0   27    0     1     1     0    0  1617
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_11.png
better model found
persisted
after epoch: 11,now: 2024-07-08 05:32:24.145195,epoch time: 0:30:23.887511,used: 5:37:46.579356,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9701413, 'precision': 0.9220623, 'recall': 0.90920514, 'specificity': 0.9967869, 'f1': 0.911149, 'auroc': 0.99911475}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    2     3    2    0     3     5     5    3     20
1     0  1295    0     4    0    0     0    28     3    0      2
2     0     0  282     1    3    4     0     3     1   18      0
3     0     3    0  8121    0   13     0   213    88    0      0
4     3     0   46     0  368    3     0     2    16    6     94
5     0     0    1     6    0  497     0     0     1   15      1
6     2     0    2     2    0    0  1887     6     4    0      5
7     0     3    4    51    1    0     1  7176    23    0      3
8     0     0    2    27    3    6     0    71  3177    3      7
9     1     0   37     6    1  108     0     2     2  336      0
10    8     0   14     7   22    1     7    13    38    2  12681
---- Validation: 
scalar performance:
{'acc': 0.97068346, 'precision': 0.92534006, 'recall': 0.9119538, 'specificity': 0.99683523, 'f1': 0.9148405, 'auroc': 0.99913687}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    4     3    1    0     9     7     1    2     18
1     0  1289    0     4    0    0     1    34     3    0      1
2     0     0  277     1    4    6     0     3     1   20      0
3     0     0    0  8146    0   18     0   193    83    0      0
4     2     0   44     0  373    2     0     1    18    6     93
5     0     0    0     6    1  499     0     0     1   13      1
6     4     0    0     6    0    1  1872    12     4    1      8
7     0     6    6    58    0    0     1  7162    29    0      3
8     0     0    5    30    3    7     0    55  3181    2     13
9     1     0   30     4    0   97     0     1     0  360      0
10    5     0   11     7   20    2     3    14    40    2  12692
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6846708, 'precision': 0.64736587, 'recall': 0.57848644, 'specificity': 0.96840435, 'f1': 0.5546657, 'auroc': 0.87766546}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   662     0   24   61   0   17   125   175    46   43    17
1     0  1080    0   20   0    0     0   349     5    0    45
2     1     0  217   17  41   32     7   103   255   52   290
3     0     0    0    0   0    0     0     0     0    0     0
4     0     0    4    0  48    0     1     3    13    0  1564
5     0     0    8  128   0  396     1     2     8   49     0
6     0     0    1    6   0    1  3021     4     2    0    32
7     0     0    0    9   0    0     0  1152     1    0     2
8     0     0    0   80   0    4     1    36  1246    0     3
9     2     0  124  159   0  190     1   190   126  322    23
10    0     0    0    0   2    0     1     1     0    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_12.png
better model found
persisted
after epoch: 12,now: 2024-07-08 06:02:50.763540,epoch time: 0:30:26.618345,used: 6:08:13.197701,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9690443, 'precision': 0.9150572, 'recall': 0.9044167, 'specificity': 0.99670434, 'f1': 0.9036918, 'auroc': 0.9991603}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     0    0     1    4    0    11     1     0    0     23
1     0  1308    0     0    0    0     0    22     1    0      1
2     0     0  173     0   47    3     0     0     1   88      0
3     2     8    0  8194    0   28     3   170    31    0      0
4     3     0    5     0  480    1     1     1     6    4     38
5     0     0    0     5    0  483     0     0     1   31      1
6     1     0    0     0    1    1  1894     2     1    0      8
7     1    10    1    64    3    0     1  7159    16    2      7
8     0     2    0    83   23   11     4    88  3031    5     48
9     1     0    4     2    3   79     0     0     0  403      0
10    5     1    1     8  102    0    13     5     7    1  12651
---- Validation: 
scalar performance:
{'acc': 0.96993446, 'precision': 0.9164158, 'recall': 0.9084171, 'specificity': 0.9968048, 'f1': 0.90678805, 'auroc': 0.999175}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     0    1    0     9     1     1    4     21
1     0  1315    0     2    0    0     0    14     1    0      0
2     0     0  175     0   52    2     1     1     1   80      0
3     6     6    0  8205    0   22     1   165    32    2      1
4     1     0    8     0  480    2     2     0     7    2     37
5     0     0    0     6    0  484     0     0     3   27      1
6     0     0    0     0    1    0  1896     0     0    0     11
7     2    17    0    67    4    0     2  7142    20    6      5
8     1     2    0    77   19   11     1    73  3061    4     47
9     0     0    3     3    2   72     1     0     0  412      0
10    2     1    2     7  111    0     8     6    12    2  12645
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7668789, 'precision': 0.69367194, 'recall': 0.65049213, 'specificity': 0.97626853, 'f1': 0.6444918, 'auroc': 0.8869685}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   931     0    0   7    3    2   197    12     0    8    10
1     3  1291    2  10    1    0     0   175     4    3    10
2     5     1  118   5  474   23     6    40    86  111   146
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  530    0     3     2     4    1  1093
5     1     0    1  28    6  330    10     1     2  213     0
6     0     0    0   3    1    0  3046     1     0    0    16
7     3     0    0   3    0    1     0  1152     1    3     1
8     0     1    0  49   10   23    16    39  1213   11     8
9     9     3   54  34   43  110     9    63    44  751    17
10    0     0    0   0   45    0     1     1     0    0  1599
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_13.png
new oracle model saved
early stop counter: 1
val acc:0.9699344635009766, best validation acc: 0.9706834554672241, corresponding to test acc:                         0.6846708059310913 / 0.7668789029121399
after epoch: 13,now: 2024-07-08 06:33:18.884939,epoch time: 0:30:28.121399,used: 6:38:41.319100,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9718001, 'precision': 0.9103814, 'recall': 0.9342278, 'specificity': 0.99707854, 'f1': 0.9194172, 'auroc': 0.9991573}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    0     1    6    0     3     1     1    0     24
1     0  1316    0     3    0    0     0    12     1    0      0
2     0     0  292     1    2    0     0     4     1   12      0
3     0     2    1  8297    0    3     0    76    57    0      0
4     1     0   64     0  443    0     0     7     3    3     18
5     1     0    0    20    0  445     0     0     3   51      1
6     3     0    1     1    2    0  1888     1     3    0      9
7     1    17    3    95    0    0     2  7116    26    0      3
8     0     1    5    38   12    1     0    53  3173    0     13
9     0     0   38     3    1   25     0     0     2  424      0
10    1     3    7     6  242    0     3    28    20    2  12481
---- Validation: 
scalar performance:
{'acc': 0.96974725, 'precision': 0.9090892, 'recall': 0.93099546, 'specificity': 0.9968593, 'f1': 0.91715455, 'auroc': 0.99915}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    1     1    7    0     1     2     0    1     22
1     0  1314    0     4    0    0     1    12     1    0      0
2     0     0  279     2    8    2     1     3     1   16      0
3     0     0    0  8269    0    1     0    96    74    0      0
4     2     0   52     0  457    1     0     8     2    3     14
5     0     0    0    24    1  444     0     0     1   50      1
6     3     0    0     2    2    0  1885     1     3    0     12
7     0    17    4    99    0    0     3  7117    22    0      3
8     0     2    5    42   18    0     1    58  3155    1     14
9     1     0   34     9    0   23     0     3     2  421      0
10    1     4    9     6  259    0     1    27    24    0  12465
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7488981, 'precision': 0.6888541, 'recall': 0.629214, 'specificity': 0.9747722, 'f1': 0.6351992, 'auroc': 0.88564044}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   881     0    3   40   10   18   110    27     4   26    51
1     0  1227    0   18    1    0     0   226     9    0    18
2     1     0  226   11  340    7     1    99   136   53   141
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  646    0     1     6     5    0   974
5     1     0    8  103   11  276     1     0    17  174     1
6     0     0    0    2    2    0  2974     2     1    0    86
7     1     0    0   26    0    0     1  1134     0    0     2
8     0     0    1   53    4    1     4    28  1277    1     1
9     3     1  153  126   14   64     1   142   107  500    26
10    0     0    0    0   82    0     0     1     0    0  1563
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_14.png
early stop counter: 2
val acc:0.9697472453117371, best validation acc: 0.9706834554672241, corresponding to test acc:                         0.6846708059310913 / 0.7668789029121399
after epoch: 14,now: 2024-07-08 07:03:46.995418,epoch time: 0:30:28.110479,used: 7:09:09.429579,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9766428, 'precision': 0.93018997, 'recall': 0.9312011, 'specificity': 0.9975448, 'f1': 0.9281778, 'auroc': 0.9995021}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     0    5    0     2     2     0    0     10
1     0  1305    0     5    0    0     0    16     5    0      1
2     0     0  250     0   29    1     0     4     2   26      0
3     1     0    0  8281    0   13     1    62    80    0      0
4     3     0    6     0  492    1     0     0     5    0     32
5     0     0    1     3    0  512     0     0     0    4      1
6    12     0    0     1    0    1  1884     1     2    1      5
7     0     7    0   118    2    0     1  7064    60    1      9
8     0     0    1    20    7    5     1    20  3218    1     23
9     0     0   34     4    3  107     0     0     2  343      0
10    9     0    1     7   62    1     5     5    13    0  12691
---- Validation: 
scalar performance:
{'acc': 0.97603315, 'precision': 0.93340135, 'recall': 0.9310312, 'specificity': 0.99746346, 'f1': 0.92966914, 'auroc': 0.999458}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     0    5    1     2     1     0    0     12
1     0  1300    0     4    0    0     1    22     5    0      0
2     0     0  256     1   30    1     1     0     0   21      2
3     1     0    0  8266    0   17     0    67    88    1      0
4     2     0    4     0  489    0     0     1     4    0     39
5     0     0    0     6    1  508     0     0     0    5      1
6     9     0    0     0    1    0  1893     1     1    0      3
7     1     8    1   132    1    0     2  7046    64    1      9
8     0     0    3    30    7    6     0    24  3207    2     17
9     0     0   29     3    3  112     0     1     1  344      0
10    3     0    1     3   53    0     2     8     8    0  12718
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7288183, 'precision': 0.6319058, 'recall': 0.61494696, 'specificity': 0.97270596, 'f1': 0.59215397, 'auroc': 0.8753215}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   997     0    1  23    5   10    20    73     7   15    19
1     0  1231    0  14    0    1     1   219     9    0    24
2     3     1   92   4  285   25     6    65   185   51   298
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  221    0     4     2    10    0  1396
5     1     0    6  67   11  354     0     1    14  128    10
6     1     0    0   2    0    0  3049     0     0    0    15
7     0     0    0   7    0    1     0  1149     3    0     4
8     0     0    0  28    0    9     4    32  1288    2     7
9     5     1  136  50   37  221     5   108   128  400    46
10    0     0    0   0    8    0     1     1     0    0  1636
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_15.png
better model found
persisted
after epoch: 15,now: 2024-07-08 07:34:32.238526,epoch time: 0:30:45.243108,used: 7:39:54.672687,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9755993, 'precision': 0.9361677, 'recall': 0.9356663, 'specificity': 0.997388, 'f1': 0.93340546, 'auroc': 0.99953896}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     1    9    0     1     0     0    0     16
1     0  1301    0     4    0    0     1    22     1    1      2
2     0     0  232     1   44    1     1     2     1   27      3
3     0     1    1  8342    0    6     0    31    55    2      1
4     0     0    1     0  510    0     0     0     2    1     25
5     0     0    0     7    0  462     0     0     3   48      1
6     6     0    0     2    1    0  1877     1     2    0     18
7     0     6    1   186    3    0     3  7011    45    0      9
8     0     0    1    51   19    0     0    15  3183    1     26
9     0     0   21     2    6   19     0     0     0  445      0
10    0     0    0     4  129    0     2     0    10    0  12645
---- Validation: 
scalar performance:
{'acc': 0.9777986, 'precision': 0.94541645, 'recall': 0.94273704, 'specificity': 0.99760365, 'f1': 0.9419359, 'auroc': 0.99958473}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     1    5    0     2     1     0    0     14
1     0  1310    0     2    0    0     1    16     1    0      2
2     0     0  242     0   38    0     1     2     0   27      2
3     0     1    0  8371    0    3     0    22    42    1      0
4     0     0    1     0  510    0     0     0     2    1     25
5     0     0    0     6    1  460     0     0     5   48      1
6     5     0    0     3    4    0  1885     0     1    0     10
7     1     9    1   190    3    0     2  7008    40    1     10
8     0     0    1    62   13    1     1    15  3176    1     26
9     0     0   15     4    5    8     0     1     0  459      1
10    1     0    0     5  105    0     3     2     6    0  12674
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69180715, 'precision': 0.64111805, 'recall': 0.5697869, 'specificity': 0.9691249, 'f1': 0.5662937, 'auroc': 0.8770832}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   984    0    7   58    5    1    15    31     8   45    16
1     3  978    0   38    0    1     6   381    15    3    74
2    11    0  104   15  347    1     1    39   129   69   299
3     0    0    0    0    0    0     0     0     0    0     0
4     0    0    0    0  342    0     1     2     8    0  1280
5     4    0   31  110    8  133     5     0     3  283    15
6     4    0    0    4    2    0  2858     3     3    0   193
7     2    0    1   52    0    1     0  1099     4    1     4
8     0    0    1  113    7    2    14    13  1206    6     8
9     9    0  161  125   13   31     0    84    95  568    51
10    0    0    0    0   29    0     0     1     0    0  1616
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_16.png
better model found
persisted
after epoch: 16,now: 2024-07-08 08:05:12.667686,epoch time: 0:30:40.429160,used: 8:10:35.101847,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9762682, 'precision': 0.92420065, 'recall': 0.93833435, 'specificity': 0.99748623, 'f1': 0.92788947, 'auroc': 0.99941725}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     0    2    0     3     0     0    3     11
1     0  1326    0     1    0    0     0     5     0    0      0
2     0     0  291     0    0    0     0     0     0   20      0
3     1     2    1  8294    0    7     1   102    23    3      1
4     2     0  103     0  378    0     0     2     6    6     42
5     0     0    3     7    0  469     0     0     0   41      1
6     5     0    0     3    0    0  1894     2     0    0      4
7     1    23    6    94    0    0     1  7112    21    2      5
8     0     1   14    69   10    1     3    37  3139    2     19
9     0     0   16     2    0   16     0     0     0  459      0
10    3     1   20     6   55    1    10     4    30    1  12663
---- Validation: 
scalar performance:
{'acc': 0.97611344, 'precision': 0.9237705, 'recall': 0.9398818, 'specificity': 0.99748063, 'f1': 0.92854196, 'auroc': 0.99939334}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    1     0    0    0     3     0     0    2      5
1     0  1322    0     1    0    0     0     8     1    0      0
2     0     0  296     0    0    0     0     0     0   16      0
3     2     7    1  8294    0   10     2   101    20    3      0
4     4     0  109     0  380    0     2     0     4    3     37
5     0     0    2    11    0  458     0     0     1   48      1
6     4     0    1     7    0    0  1889     1     2    0      4
7     2    23    3    92    0    0     1  7113    23    1      7
8     1     2   13    75   10    3     3    36  3135    2     16
9     0     0   14     1    0   13     0     0     0  465      0
10    5     3   10     6   59    1    13     5    26    0  12668
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72972786, 'precision': 0.68124324, 'recall': 0.61292076, 'specificity': 0.972922, 'f1': 0.6125799, 'auroc': 0.8818914}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   848     0   18   35    2    4    93    22    25  106    17
1     2  1117    3   19    1    0    10   321    13    0    13
2     1     0  493   16   59   14    22    49   152  110    99
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0   28    0  247    0    48     4    37    0  1269
5     0     0   23   80    0  228     3     2     7  249     0
6     0     0    0    2    0    0  3064     1     0    0     0
7     0     0    1   84    0    1     3  1071     3    0     1
8     0     0    1  112    0    5     7    22  1221    2     0
9     2     0  207  113    1  114     2    67   108  511    12
10    0     0    0    0    9    0     7     0     0    0  1630
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_17.png
early stop counter: 1
val acc:0.9761134386062622, best validation acc: 0.977798581123352, corresponding to test acc:                         0.6918071508407593 / 0.7668789029121399
after epoch: 17,now: 2024-07-08 08:35:54.288291,epoch time: 0:30:41.620605,used: 8:41:16.722452,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97856915, 'precision': 0.95591176, 'recall': 0.92153186, 'specificity': 0.99756426, 'f1': 0.9365047, 'auroc': 0.9994897}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     1    3    0     0     2     0    0      7
1     0  1301    0     3    0    0     0    26     1    0      1
2     2     0  274     0   17    0     0     4     3    7      5
3     1     2    0  8294    0    1     0    95    41    0      1
4     3     0    3     0  367    0     0     3    18    0    145
5     0     0    1    22    1  453     0     0     8   35      1
6    13     1    0     6    0    0  1873     2     4    0      8
7     2     1    1    58    1    0     1  7184    13    0      4
8     0     0    1    50    1    0     0    47  3186    0      9
9     2     0   44    11    2    9     0     3     4  414      4
10    2     0    0     6    3    0     1     8    16    0  12759
---- Validation: 
scalar performance:
{'acc': 0.9780661, 'precision': 0.9563401, 'recall': 0.92250085, 'specificity': 0.99750155, 'f1': 0.937258, 'auroc': 0.99950534}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     0    4    0     0     1     1    0      9
1     0  1300    0     2    0    0     0    28     2    0      0
2     0     0  277     0   18    0     0     2     5    7      3
3     0     1    0  8291    0    1     1    99    46    0      1
4     3     0    3     1  361    0     0     2    15    0    154
5     0     0    1    17    0  460     0     0     5   36      2
6    10     0    0     3    1    0  1875     2     2    0     15
7     1     3    1    62    1    0     0  7174    19    0      4
8     0     0    1    53    0    0     0    42  3187    0     13
9     2     0   40     6    7   10     0     3     8  417      0
10    4     0    0     7    0    0     2     6    22    0  12755
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6752956, 'precision': 0.62423503, 'recall': 0.5521066, 'specificity': 0.96764815, 'f1': 0.5350251, 'auroc': 0.8675077}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   928     0    5   70   0    1    11   116     7   18    14
1     0  1128    0   11   0    0     0   342     3    0    15
2    13     3  150   34  65    4     4   119   247   24   352
3     0     0    0    0   0    0     0     0     0    0     0
4     0     0    0    0  43    0     1     5    17    0  1567
5     3     0   22  202   3  178     6     4    12  159     3
6     6     0    0   13   0    0  2991     4     2    0    51
7     0     0    0   21   0    0     0  1141     0    0     2
8     0     1    0  129   0    0     3    56  1178    2     1
9     5     5  189  228   9   31     3   193   161  272    41
10    0     0    0    0   2    0     1     0     0    0  1643
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_18.png
better model found
persisted
after epoch: 18,now: 2024-07-08 09:06:36.428077,epoch time: 0:30:42.139786,used: 9:11:58.862238,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9823951, 'precision': 0.9651177, 'recall': 0.9365828, 'specificity': 0.9980344, 'f1': 0.94909656, 'auroc': 0.99975485}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    1    1     2     2     0    0      3
1     0  1265    0     2    0    0     0    63     2    0      0
2     1     0  262     0    2    2     0     8     3   32      2
3     0     0    0  8374    0    5     0    42    15    0      0
4     4     0   11     0  414    1     1     3    20    0     85
5     0     0    0     8    0  505     0     0     2    4      1
6     1     0    0     2    0    0  1897     0     3    0      4
7     0     0    0    78    1    0     2  7161    20    0      3
8     1     0    0    77    0    1     0    17  3191    0      8
9     0     0    4     5    0   58     1     1     3  421      0
10    4     1    1     2    7    0     5     3    17    0  12754
---- Validation: 
scalar performance:
{'acc': 0.98306805, 'precision': 0.9668663, 'recall': 0.9387665, 'specificity': 0.9981085, 'f1': 0.9512611, 'auroc': 0.99975693}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    2    0     0     0     2    0      1
1     0  1260    0     1    0    0     0    68     3    0      0
2     2     0  265     0    5    1     2     4     2   29      2
3     1     0    0  8393    0    1     0    32    13    0      0
4     5     0   10     0  418    0     0     0    21    0     85
5     0     0    0    10    0  506     0     0     2    3      0
6     3     0    0     2    0    0  1893     2     2    0      6
7     0     0    0    80    0    0     2  7158    22    0      3
8     0     0    1    69    0    0     1    15  3204    0      6
9     0     0    6     4    0   53     0     4     5  421      0
10    3     0    0     4    5    0     6     1    21    0  12756
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65829426, 'precision': 0.64809644, 'recall': 0.54287314, 'specificity': 0.9660877, 'f1': 0.5260112, 'auroc': 0.8694818}
confusion matrix:
     0    1   2    3    4    5     6     7     8    9     10
0   848    0   3   80    1   33    73    83    12   19    18
1     0  900   0   33    0    0     2   530    11    0    23
2     4    0  92   45   61   33    14    87   441   43   195
3     0    0   0    0    0    0     0     0     0    0     0
4     0    0   1    0  151    0     4     3    52    0  1422
5     1    0   3  179    0  305     6     0    13   83     2
6     3    0   0   14    0    0  3004     3     2    0    41
7     0    0   0  117    0    0     0  1043     1    0     3
8     0    0   0  153    0    0     2    17  1195    1     2
9     3    0  42  304    1  154     6   141   228  234    24
10    0    0   0    0    7    0     1     1     0    0  1637
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_19.png
better model found
persisted
after epoch: 19,now: 2024-07-08 09:37:14.187057,epoch time: 0:30:37.758980,used: 9:42:36.621218,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9753318, 'precision': 0.9209448, 'recall': 0.94761825, 'specificity': 0.9974345, 'f1': 0.9305756, 'auroc': 0.99954885}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     2    3    0     0     0     0    0      3
1     0  1319    0     0    1    0     0    10     1    0      1
2     0     0  283     0    0    0     0     0     0   29      0
3     2    12    3  8118    0   10     2   213    50   27      0
4     5     0   42     0  466    0     0     0     1    2     23
5     0     0    0     2    0  418     0     0     1  100      0
6     6     0    0     0    1    0  1891     0     0    3      7
7     1    20   28    14    2    0     2  7131    37   17     11
8     1     2   14    18   14    3     3    23  3157   19     42
9     0     0    5     0    0    0     0     0     0  487      0
10    1     1   12     4   58    0     1     3     3    1  12709
---- Validation: 
scalar performance:
{'acc': 0.97563195, 'precision': 0.92215264, 'recall': 0.9434524, 'specificity': 0.99746543, 'f1': 0.9289163, 'auroc': 0.99960506}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    1     0    3    0     0     0     0    0      6
1     0  1323    0     0    0    0     0     9     0    0      0
2     0     0  275     0    1    0     0     0     0   36      0
3     0     6    5  8130    0   16     0   201    56   26      0
4     2     0   38     0  478    0     0     0     1    3     17
5     1     0    1     6    0  394     0     0     1  118      0
6     4     0    1     0    1    0  1894     2     0    1      5
7     1    23   22    16    3    1     6  7138    34   11     10
8     0     0   11    19   12    2     1    25  3159   19     48
9     0     0    5     0    0    0     0     0     0  488      0
10    4     1    6     6   54    0     2     0     1    0  12722
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7381935, 'precision': 0.68955135, 'recall': 0.61297, 'specificity': 0.97373575, 'f1': 0.6138176, 'auroc': 0.88038284}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   767     1   23  38    4    0    25   170     8   91    43
1     1  1052    5  13    7    0     5   321     6   36    53
2     5     0  449   4  214    2     0    20    83   99   139
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0   13   0  540    0     1     1     6    0  1072
5     0     0   44  56    3  108     2     6     2  370     1
6     1     0    2   1    1    0  2987     3     2    0    70
7     1     0    7  11    0    0     0  1131     2   10     2
8     0     1    9  50   14    4     6    31  1211   35     9
9     0     1  284  28    3   17     0    31    28  733    12
10    0     0    0   0   72    0     0     1     0    0  1573
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_20.png
early stop counter: 1
val acc:0.9756319522857666, best validation acc: 0.98306804895401, corresponding to test acc:                         0.6582942605018616 / 0.7668789029121399
after epoch: 20,now: 2024-07-08 10:08:04.130174,epoch time: 0:30:49.943117,used: 10:13:26.564335,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9832513, 'precision': 0.95464766, 'recall': 0.96108454, 'specificity': 0.9981981, 'f1': 0.95699453, 'auroc': 0.99976075}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     1    3    0     6     0     1    0      3
1     0  1326    0     1    0    0     0     3     1    0      1
2     0     0  304     1    2    0     0     0     0    3      2
3     2     9    0  8328    0    6     0    64    25    3      0
4     2     0   17     0  460    0     0     0     2    1     57
5     0     0    1     2    0  488     0     0     1   29      0
6     0     0    0     0    0    0  1904     0     0    0      4
7     1    56    7    70    0    0     4  7110    13    0      4
8     1     0    8    38    6    1     5    37  3183    4     13
9     0     0   33     1    1    5     0     0     1  451      0
10    3     1    3     3   25    0    14     2    13    0  12728
---- Validation: 
scalar performance:
{'acc': 0.98349607, 'precision': 0.95859957, 'recall': 0.95996076, 'specificity': 0.998202, 'f1': 0.95859385, 'auroc': 0.9997611}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    3    0     2     0     0    0      8
1     0  1326    0     0    0    0     0     4     0    1      1
2     0     0  301     0    2    1     1     0     1    6      0
3     2     4    1  8325    0    3     1    76    27    1      0
4     2     0    8     0  462    1     2     2     3    1     58
5     0     0    0     5    0  485     0     0     2   28      1
6     2     0    0     0    0    0  1902     0     1    0      3
7     0    45    9    70    0    0     2  7117    17    0      5
8     0     1    7    40    2    2     8    32  3186    1     17
9     0     0   31     1    0   11     0     0     0  450      0
10    5     2    2     5   17    0    13     2     6    0  12744
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.717694, 'precision': 0.6611825, 'recall': 0.5938349, 'specificity': 0.971637, 'f1': 0.59504044, 'auroc': 0.87713504}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   865     0   10   67    4    0   100    46    12   31    35
1     1  1286    3   30    1    1     1   139     6    7    24
2     4     0  336   16  195    2    16    42   114   59   231
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    5    0  211    0     1     1     8    0  1407
5     4     0   32  115    0  156     9     3     7  261     5
6     1     0    1    3    1    1  2986     4     2    0    68
7     0     0    7   60    0    0     2  1083     1    6     5
8     0     0    8   70    4    3    17    29  1221    8    10
9     4     0  325  107    4   50     6    62    65  484    30
10    0     0    0    0   14    0     1     1     0    0  1630
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_21.png
better model found
persisted
after epoch: 21,now: 2024-07-08 10:38:39.442535,epoch time: 0:30:35.312361,used: 10:44:01.876696,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9807363, 'precision': 0.95302665, 'recall': 0.95792645, 'specificity': 0.9979378, 'f1': 0.9545937, 'auroc': 0.9997141}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     1    4    0     8     2     0    1     11
1     0  1327    0     0    0    0     0     5     0    0      0
2     0     0  287     0    5    0     1     9     0    9      1
3     2     3    0  8283    0    0     3   125    17    1      4
4     5     1    4     0  509    0     0     4     5    1     10
5     0     0    2    22    1  459     1     0     4   30      1
6     3     1    0     0    0    1  1893     0     0    0      8
7     0    11    0    51    0    0     3  7193     3    0      3
8     1     4    1    49   11    1     2    62  3143    0     22
9     0     0   16     0    1   10     0     0     1  465      0
10    1    20    0     1  109    0    13     5     3    0  12641
---- Validation: 
scalar performance:
{'acc': 0.9809282, 'precision': 0.9528856, 'recall': 0.9588041, 'specificity': 0.99797213, 'f1': 0.95517, 'auroc': 0.9997195}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     0    3    1     6     1     1    0     12
1     0  1326    0     0    0    0     0     6     0    0      0
2     0     0  279     0    7    0     0     6     1   18      1
3     0     8    0  8283    0    1     5   121    19    2      1
4     5     1    4     0  508    0     0     3     5    0     13
5     0     0    4     9    0  478     0     0     1   29      0
6     0     2    0     1    0    0  1898     0     1    0      6
7     0    15    0    46    0    0     9  7184     8    0      3
8     0     4    0    46   12    0     3    68  3145    1     17
9     1     0   17     0    1    8     1     1     1  463      0
10    1    20    0     1   95    0    13    12     5    0  12649
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7220318, 'precision': 0.65413415, 'recall': 0.5970992, 'specificity': 0.97190845, 'f1': 0.59658015, 'auroc': 0.8728385}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   873     0   16  37    6    1   143    34     4   18    38
1     0  1332    0  21    1    1     0   135     2    5     2
2     5     8  184  13  235    7    18    46   183   69   247
3     0     0    0   0    0    0     0     0     0    0     0
4     0     1    0   0  347    0     2     3    11    1  1268
5     2     0   47  82    5  169    22     2     9  254     0
6     1     0    0   2    1    0  2934     2     0    0   127
7     3     2    0  48    0    0     5  1102     0    1     3
8     0     0    0  85    5    4    28    16  1216    7     9
9     8     6  193  87    7   69    15    74   103  548    27
10    0     0    0   0   28    0     2     1     0    0  1615
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_22.png
early stop counter: 1
val acc:0.9809281826019287, best validation acc: 0.9834960699081421, corresponding to test acc:                         0.7176939845085144 / 0.7668789029121399
after epoch: 22,now: 2024-07-08 11:11:14.014643,epoch time: 0:32:34.572108,used: 11:16:36.448804,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9797196, 'precision': 0.9540989, 'recall': 0.92861414, 'specificity': 0.9977034, 'f1': 0.93671495, 'auroc': 0.99973905}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     1    0     3    5    0     1     0     0    0     19
1     0  1297    0     3    0    0     0    30     0    0      2
2     0     0  287     0   13    2     0     3     1    4      2
3     0     1    0  8374    0    1     0    56     6    0      0
4     1     0    3     1  462    0     0     0     0    1     71
5     0     0    0     7    0  511     0     1     1    1      0
6     2     0    0     1    0    2  1884     1     1    1     16
7     0     6    0    63    1    0     0  7176     9    0      9
8     0     1    2    75   14    4     0    40  3084    0     75
9     0     0   24     3    2  145     2     0     0  316      1
10    0     0    2     3    5    0     2     5     1    0  12773
---- Validation: 
scalar performance:
{'acc': 0.97953725, 'precision': 0.95161104, 'recall': 0.9288317, 'specificity': 0.9976872, 'f1': 0.93668383, 'auroc': 0.99970317}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     2    5    0     0     0     0    0     16
1     0  1299    0     5    0    0     0    26     1    0      1
2     0     0  277     0   17    2     0     5     0    9      2
3     0     0    0  8364    0    3     0    60    13    0      0
4     1     0    3     0  465    0     0     1     2    0     67
5     0     0    1     8    0  508     0     0     0    3      1
6     5     0    0     0    2    0  1883     1     1    0     16
7     0     3    1    67    1    0     0  7175     7    0     11
8     0     0    1    67   11    4     0    49  3088    2     74
9     0     0   24     2    3  132     0     2     0  327      3
10    2     0    0     3    8    0     2     5     1    1  12774
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6897782, 'precision': 0.6110778, 'recall': 0.5826895, 'specificity': 0.9687058, 'f1': 0.57104784, 'auroc': 0.8610458}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   980     2    1  13    2    9    14    44     0   34    71
1     1  1204    1  11    2    2     1   221     5    4    47
2     8     0  177   7  297   15     4    59    42   35   371
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    2   0  105    0     1     1     0    0  1524
5     4     0   27  44    8  282    10     6     4  192    15
6     1     0    1   1    1    1  2814     2     0    0   246
7     1     1    0  38    0    0     0  1118     0    1     5
8     0     0    2  60   18   11    10    40  1168    6    55
9     8     4  248  43   39  177    11   121    53  373    60
10    0     0    0   0    5    0     2     1     0    0  1638
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_23.png
early stop counter: 2
val acc:0.9795372486114502, best validation acc: 0.9834960699081421, corresponding to test acc:                         0.7176939845085144 / 0.7668789029121399
after epoch: 23,now: 2024-07-08 11:42:05.796522,epoch time: 0:30:51.781879,used: 11:47:28.230683,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98400044, 'precision': 0.97332, 'recall': 0.9492618, 'specificity': 0.99816, 'f1': 0.9596156, 'auroc': 0.99981755}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     0    1    1     4     1     0    0      4
1     0  1316    0     1    0    0     0    15     0    0      0
2     0     0  280     0    8    0     0     4     0   17      2
3     1     1    0  8296    0    3     0   115    17    2      2
4     7     0    2     0  406    0     1     0     2    1    120
5     0     0    0     2    0  478     0     0     0   41      0
6     0     0    0     2    0    0  1902     0     0    0      4
7     2     5    0    49    1    0     1  7190    12    0      3
8     0     3    1    72    3    2     1    17  3181    2     14
9     1     0    2     1    0    7     1     1     0  479      1
10    4     0    0     0    0    0     1     2     8    0  12778
---- Validation: 
scalar performance:
{'acc': 0.9833088, 'precision': 0.9708229, 'recall': 0.945114, 'specificity': 0.9980833, 'f1': 0.9564053, 'auroc': 0.99978304}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    1    0     6     2     1    0      4
1     0  1315    0     0    0    0     0    16     1    0      0
2     0     0  273     0   12    0     0     3     0   21      3
3     2     1    0  8295    0    3     0   110    27    0      2
4     6     0    4     0  396    0     5     1     4    1    122
5     0     0    0     2    0  491     0     0     0   28      0
6     0     0    0     1    0    0  1898     3     0    1      5
7     2     4    0    39    1    0     2  7200    10    0      7
8     0     2    0    90    2    0     0    16  3175    0     11
9     2     0    9     0    0    7     1     1     1  471      1
10    3     0    1     1    3    0     3     4     3    0  12778
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.63891417, 'precision': 0.6184093, 'recall': 0.5229637, 'specificity': 0.96346563, 'f1': 0.51504, 'auroc': 0.8506439}
confusion matrix:
     0     1    2    3   4    5     6    7     8    9     10
0   666     0    3   39   0    2   324   83     6   16    31
1     1  1061    0   25   1    0     8  318     9    2    74
2     5     0  109   37  33   10    48   66   214   65   428
3     0     0    0    0   0    0     0    0     0    0     0
4     0     0    2    0  25    0     2    2    18    0  1584
5     4     0   11  127   0  233    52    1     2  155     7
6     0     0    0    4   0    0  2880    0     0    0   183
7     1     0    1  158   0    1     4  993     2    0     4
8     0     0    0  177   0    5    22   19  1134    2    11
9     6     0   73  211   6  112    52  109   117  388    63
10    0     0    0    0   0    0     3    0     0    0  1643
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_24.png
early stop counter: 3
val acc:0.9833087921142578, best validation acc: 0.9834960699081421, corresponding to test acc:                         0.7176939845085144 / 0.7668789029121399
after epoch: 24,now: 2024-07-08 12:12:51.017246,epoch time: 0:30:45.220724,used: 12:18:13.451407,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9845355, 'precision': 0.957374, 'recall': 0.9537944, 'specificity': 0.9983611, 'f1': 0.9549037, 'auroc': 0.9997937}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    5    0     1     1     0    0      5
1     0  1299    0     5    0    0     0    21     5    0      1
2     1     0  268     1   18    2     0     2     3   16      1
3     3     0    0  8328    0   11     0    42    53    1      1
4     3     0    6     0  490    0     0     1     7    1     31
5     0     0    1     2    0  513     0     0     1    4      0
6     6     0    0     0    0    0  1894     0     0    0      8
7     4     1    2    60    0    0     0  7134    61    0      3
8     0     0    1    24    0    1     0     6  3253    0      9
9     0     0   16     1    0   56     1     0     1  415      2
10    9     0    0     5   22    0     2     3    18    0  12733
---- Validation: 
scalar performance:
{'acc': 0.98504746, 'precision': 0.9609386, 'recall': 0.95739734, 'specificity': 0.99839723, 'f1': 0.9587294, 'auroc': 0.9998206}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     1    3    0     1     0     1    0      6
1     0  1303    0     6    0    0     0    19     3    0      1
2     1     0  273     0   20    2     1     0     2    9      4
3     1     0    2  8337    0   14     2    45    39    0      0
4     3     0    2     0  485    1     0     0     4    0     44
5     0     0    0     2    0  511     0     0     0    7      1
6    11     0    1     0    1    1  1886     0     2    0      6
7     2     2    3    67    0    0     0  7127    63    0      1
8     2     0    0    22    2    0     0    12  3252    0      6
9     1     0   15     1    0   40     0     0     0  435      1
10    6     0    0     3   21    0     4     2    14    0  12746
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69866365, 'precision': 0.6152293, 'recall': 0.5828794, 'specificity': 0.9697337, 'f1': 0.56235963, 'auroc': 0.86631924}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1013     0    1   43    1    3    31    44    14    9    11
1      0  1107    2   32    2    1     7   269    59    5    15
2     33     0   96    9  218   14    11    35   276   25   298
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    1    0  165    0     5     0    20    0  1442
5     19     0    3   84   15  313     1     2    17  124    14
6      7     0    0    2    0    0  3015     1     0    0    42
7      0     1    1  109    0    1     2  1024    20    1     5
8      0     0    0   41    1    3     4     7  1311    0     3
9     37     0  128   64   58  172     4    61   245  307    61
10     0     0    0    0    8    0     3     0     0    0  1635
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_25.png
better model found
persisted
after epoch: 25,now: 2024-07-08 12:44:04.052280,epoch time: 0:31:13.035034,used: 12:49:26.486441,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98630136, 'precision': 0.96295696, 'recall': 0.9597437, 'specificity': 0.9984815, 'f1': 0.9600922, 'auroc': 0.99983996}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    1     0    5    0     0     0     0    1     19
1     0  1327    0     1    0    0     0     4     0    0      0
2     0     0  307     0    1    0     0     2     1    1      0
3     0     2    0  8378    0    2     0    31    23    1      0
4     1     0   17     0  462    0     0     0     3    0     56
5     0     0    1     2    0  489     0     0     2   26      1
6     5     0    1     1    2    0  1890     0     1    0      8
7     0    32    3    95    0    0     0  7111    18    0      5
8     0     2    3    21    4    2     0    16  3227    1     19
9     0     0   49     0    0    3     0     0     0  441      0
10    1     0    1     0    7    1     1     2     3    1  12775
---- Validation: 
scalar performance:
{'acc': 0.9859569, 'precision': 0.9609191, 'recall': 0.9587775, 'specificity': 0.9984487, 'f1': 0.9583708, 'auroc': 0.999845}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     1    0     1    6    0     0     0     1    0     16
1     0  1325    0     0    0    0     0     4     0    0      3
2     0     0  306     0    1    0     0     2     1    2      0
3     0     1    0  8378    0    4     0    34    23    0      0
4     0     0   22     0  465    0     0     0     1    0     51
5     0     0    2     1    0  493     0     0     1   24      0
6     2     0    0     1    2    1  1891     1     1    1      8
7     0    34    5    74    1    0     1  7116    21    1     12
8     0     1    0    28    3    0     0    20  3224    0     20
9     1     0   56     0    1    3     0     0     0  431      1
10    0     0    3     2   10    0     0     5     3    0  12773
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6984538, 'precision': 0.6237827, 'recall': 0.5783396, 'specificity': 0.96971524, 'f1': 0.56546617, 'auroc': 0.86751974}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   948     0    8   21    0    4    13    98     1   22    55
1     0  1229    2   21    1    0     1   201    13    0    31
2     3     1  191    9  153    8     2    65   227   23   333
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  109    0     3     1    16    0  1503
5     4     0   43   78   10  217     2     4    19  196    19
6     5     0    0    2    0    0  2962     3     0    0    95
7     0     1    1  108    0    0     0  1048     0    1     5
8     0     0    0   34    1    2     3    22  1296    3     9
9     4     1  258   73   23   70     1   114   194  343    56
10    0     0    0    0    5    0     1     0     0    0  1640
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_26.png
better model found
persisted
after epoch: 26,now: 2024-07-08 13:14:57.530123,epoch time: 0:30:53.477843,used: 13:20:19.964284,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98022795, 'precision': 0.9656468, 'recall': 0.93015933, 'specificity': 0.9976858, 'f1': 0.94379944, 'auroc': 0.99973524}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    0     0    4    0     2     2     0    0     25
1     0  1328    0     0    0    0     0     3     0    0      0
2     0     0  290     0    1    0     1     1     0   17      2
3     0     3    1  8254    0    3     0   122    43   11      2
4     2     0   11     0  339    1     1     0     5    3    177
5     0     0    1    14    0  454     0     0     4   48      0
6     2     0    0     1    0    0  1889     0     0    1     15
7     0     9    1    16    0    0     0  7227     5    1      4
8     0     1    2    20    3    0     0    70  3153    3     44
9     2     0    9     3    0    6     0     0     3  470      0
10    0     0    1     0    0    0     0     1     6    0  12783
---- Validation: 
scalar performance:
{'acc': 0.98124915, 'precision': 0.9687895, 'recall': 0.9324325, 'specificity': 0.9977795, 'f1': 0.94614625, 'auroc': 0.9997285}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    0     2    2    0     3     2     1    0     34
1     0  1326    0     1    0    0     0     3     1    0      1
2     0     0  299     0    0    0     0     1     0    8      4
3     1     2    0  8280    0    4     0   114    36    2      1
4     3     0   16     0  342    0     0     0     0    2    176
5     0     0    2     7    0  444     0     0     3   64      1
6     5     0    0     1    0    0  1891     4     0    0      7
7     0    10    1    15    0    0     0  7231     1    1      6
8     0     0    2    19    1    0     0    59  3160    3     52
9     1     0    3     1    0    2     0     0     1  484      1
10    0     0    0     0    2    0     0     3     3    0  12788
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.721612, 'precision': 0.6259459, 'recall': 0.6031129, 'specificity': 0.9719393, 'f1': 0.577584, 'auroc': 0.8649305}
confusion matrix:
     0     1    2   3   4    5     6     7     8    9     10
0   993     0    1  18   1    0    24    98     8    5    22
1     0  1312    0  14   0    0     0   153     5    0    15
2    19     0  143  12  77   10    18    79   226   72   359
3     0     0    0   0   0    0     0     0     0    0     0
4     0     0    0   0  23    0     8     3    17    0  1582
5    26     0    3  71   0  243     3     5    21  211     9
6     0     0    0   4   0    0  3032     4     3    0    24
7     0     0    0  27   0    0     0  1135     0    1     1
8     0     0    0  30   1    4     3    45  1281    2     4
9    28     3  124  59   4   83     1   135   143  510    47
10    0     0    0   0   0    0     3     1     0    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_27.png
early stop counter: 1
val acc:0.9812491536140442, best validation acc: 0.9859569072723389, corresponding to test acc:                         0.6984537839889526 / 0.7668789029121399
after epoch: 27,now: 2024-07-08 13:45:42.756097,epoch time: 0:30:45.225974,used: 13:51:05.190258,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98868257, 'precision': 0.97572047, 'recall': 0.9696304, 'specificity': 0.99875975, 'f1': 0.97240186, 'auroc': 0.9998651}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     2    6    0     0     0     1    2      5
1     0  1308    0     0    0    0     0    24     0    0      0
2     0     0  278     0   15    0     0     0     1   18      0
3     0     0    0  8327    0    1     2    81    27    0      0
4     2     0    2     1  509    0     0     0     1    1     23
5     0     0    0     5    0  502     0     0     1   13      0
6     2     1    0     1    0    1  1894     0     0    1      8
7     0     0    0    52    2    0     0  7185    17    3      3
8     0     0    1    20    3    0     0     5  3252    0     15
9     0     0    3     0    0   12     0     0     2  476      0
10    0     0    0     0   21    0     3     6     6    1  12755
---- Validation: 
scalar performance:
{'acc': 0.98930055, 'precision': 0.9763371, 'recall': 0.96742576, 'specificity': 0.99881744, 'f1': 0.97168624, 'auroc': 0.9998816}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     1    6    0     0     2     2    1     12
1     0  1307    0     0    0    0     0    25     0    0      0
2     0     0  286     0    8    0     1     0     0   17      0
3     0     1    0  8354    0    0     0    63    22    0      0
4     0     0    5     0  501    0     0     0     3    3     27
5     0     0    0     6    0  492     0     0     2   21      0
6     2     0    0     1    2    0  1887     2     0    0     14
7     0     0    1    34    1    0     0  7199    27    1      2
8     0     0    1    18    0    0     0     3  3259    0     15
9     0     0    5     1    1    9     0     0     1  475      1
10    0     0    0     1   17    0     2     3     6    1  12766
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6808228, 'precision': 0.6348005, 'recall': 0.55817664, 'specificity': 0.9679656, 'f1': 0.54541737, 'auroc': 0.86448514}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   870     0    4   53    0    0    54   102    10   17    60
1     0  1069    1   16    0    0     3   364     9    0    37
2    12     0  121   25  171    7    19    51   261   27   321
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0  134    0     3     3    16    0  1476
5     8     0    8  211    1  204    28     2    26   93    11
6     0     0    0    3    0    0  2987     1     2    0    74
7     0     0    0   41    0    0     0  1120     0    0     3
8     0     0    0   55    0    1    14    21  1274    0     5
9    12     1  114  191   26   75    19   105   229  314    51
10    0     0    0    0    7    0     1     0     0    0  1638
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_28.png
better model found
persisted
after epoch: 28,now: 2024-07-08 14:16:28.373792,epoch time: 0:30:45.617695,used: 14:21:50.807953,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9876659, 'precision': 0.9771183, 'recall': 0.9682747, 'specificity': 0.99868006, 'f1': 0.9722796, 'auroc': 0.9998918}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     2    1    0     3     0     2    1      3
1     0  1311    0     2    0    0     0    17     1    0      0
2     2     0  282     0    5    0     0     2     4   15      2
3     0     0    0  8330    0    0     1    61    48    0      0
4     6     0    2     0  484    0     0     0    13    0     34
5     0     0    1     2    0  495     0     0     0   23      0
6     4     0    0     0    0    0  1899     0     2    0      3
7     0     5    1    21    1    0     0  7182    47    0      6
8     0     0    0     7    0    0     0     5  3281    0      3
9     0     0    2     0    0    3     0     3     2  483      0
10    5     0    1     1    8    0    10    25    43    0  12697
---- Validation: 
scalar performance:
{'acc': 0.9889795, 'precision': 0.98140585, 'recall': 0.9714335, 'specificity': 0.99880993, 'f1': 0.9760301, 'auroc': 0.99989545}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    0    0     0     1     1    0      1
1     0  1318    0     2    0    0     0    12     0    0      0
2     1     0  284     0    4    0     0     3     3   14      3
3     0     1    0  8333    0    0     0    60    46    0      0
4     5     0    0     0  488    0     1     2     7    0     36
5     0     0    0     5    0  493     0     0     3   20      0
6     1     0    0     2    1    0  1901     1     1    0      1
7     0     4    0    28    0    0     0  7191    41    0      1
8     0     0    0     8    0    0     0     5  3280    0      3
9     0     0    4     1    0    2     0     4     0  482      0
10    4     0    1     1    7    0     3    17    40    0  12723
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6794235, 'precision': 0.59882164, 'recall': 0.5590044, 'specificity': 0.9675598, 'f1': 0.5255987, 'auroc': 0.8608022}
confusion matrix:
     0    1   2   3    4    5     6     7     8    9     10
0   968    0   0   8    0    0    94    33    13   34    20
1     2  879   0  12    0    0     5   540    26    1    34
2    12    0  64   3  141    9    18    93   344   53   278
3     0    0   0   0    0    0     0     0     0    0     0
4     0    0   0   0   55    0    10     5    39    0  1524
5     3    0   2  48    3  200    18     4    23  282     9
6     1    0   0   1    0    0  3019     2     4    0    40
7     0    0   0  18    0    1     1  1142     0    0     2
8     0    0   0  24    0    2     6    31  1305    0     2
9    11    0  57  24   10   80     8   186   282  440    39
10    0    0   0   0    2    0     4     1     0    0  1639
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_29.png
early stop counter: 1
val acc:0.9889795184135437, best validation acc: 0.989300549030304, corresponding to test acc:                         0.6808227896690369 / 0.7668789029121399
after epoch: 29,now: 2024-07-08 14:47:42.232687,epoch time: 0:31:13.858895,used: 14:53:04.666848,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9903681, 'precision': 0.97818226, 'recall': 0.97689754, 'specificity': 0.9989294, 'f1': 0.97737396, 'auroc': 0.9999126}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     0    2    0     1     4     1    0      8
1     0  1317    0     4    0    0     0    10     0    0      1
2     0     0  306     0    2    0     0     0     0    4      0
3     0     0    0  8380    0   16     0    22    12    4      1
4     2     0    4     0  507    0     0     0     2    0     24
5     0     0    0     2    0  515     0     0     2    2      0
6     4     0    0     5    1    1  1880     3     4    0     10
7     1     0    0    57    0    0     0  7194    12    0      0
8     0     0    0    30    6    1     0    21  3224    0     13
9     0     0    8     0    1   22     0     0     0  461      1
10    1     0    2     2   14    0     0     6     4    0  12766
---- Validation: 
scalar performance:
{'acc': 0.9899425, 'precision': 0.97745585, 'recall': 0.9748648, 'specificity': 0.9988824, 'f1': 0.9760175, 'auroc': 0.9999027}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     2    5    0     2     3     0    0      9
1     0  1317    0     2    0    0     0    13     0    0      0
2     0     0  305     0    4    1     0     0     0    2      0
3     0     0    0  8387    0   11     0    23    17    1      1
4     1     0    3     0  509    0     0     1     0    0     25
5     0     0    0     0    0  510     0     0     2    9      0
6     5     0    0     0    0    1  1890     1     4    0      7
7     0     0    0    62    0    0     0  7191     9    0      3
8     0     0    1    34    4    0     0    24  3221    0     12
9     0     0   13     1    0   20     0     1     0  458      0
10    0     1    1     3   15    0     1    11     5    0  12759
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6897782, 'precision': 0.6261772, 'recall': 0.5866419, 'specificity': 0.9688776, 'f1': 0.56684923, 'auroc': 0.86526144}
confusion matrix:
      0    1    2    3    4    5     6     7     8    9     10
0   1037    0    1   16    7   18     8    29     4   25    25
1      2  940    0   29    1    1     0   484     7    4    31
2      6    0  107    8  298   27     1   102   152   33   281
3      0    0    0    0    0    0     0     0     0    0     0
4      0    0    0    0  217    0     2     3     7    0  1404
5      5    0    6   35    7  370     1     1    14  146     7
6      0    0    0    1    1    0  2870     2     1    0   192
7      0    0    0  137    0    1     0  1019     2    0     5
8      0    0    0   33    4   13     1    27  1285    1     6
9      8    0   87   42   50  217     1   142   161  381    48
10     0    0    0    0   13    0     0     0     0    0  1633
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_30.png
better model found
persisted
after epoch: 30,now: 2024-07-08 15:18:29.531860,epoch time: 0:30:47.299173,used: 15:23:51.966021,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:23:51.966021 at 2024-07-08 15:18:29.531860
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6897782, 'precision': 0.6261772, 'recall': 0.5866419, 'specificity': 0.9688776, 'f1': 0.56684923, 'auroc': 0.86526144}
confusion matrix:
      0    1    2    3    4    5     6     7     8    9     10
0   1037    0    1   16    7   18     8    29     4   25    25
1      2  940    0   29    1    1     0   484     7    4    31
2      6    0  107    8  298   27     1   102   152   33   281
3      0    0    0    0    0    0     0     0     0    0     0
4      0    0    0    0  217    0     2     3     7    0  1404
5      5    0    6   35    7  370     1     1    14  146     7
6      0    0    0    1    1    0  2870     2     1    0   192
7      0    0    0  137    0    1     0  1019     2    0     5
8      0    0    0   33    4   13     1    27  1285    1     6
9      8    0   87   42   50  217     1   142   161  381    48
10     0    0    0    0   13    0     0     0     0    0  1633
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7668789, 'precision': 0.69367194, 'recall': 0.65049213, 'specificity': 0.97626853, 'f1': 0.6444918, 'auroc': 0.8869685}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   931     0    0   7    3    2   197    12     0    8    10
1     3  1291    2  10    1    0     0   175     4    3    10
2     5     1  118   5  474   23     6    40    86  111   146
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  530    0     3     2     4    1  1093
5     1     0    1  28    6  330    10     1     2  213     0
6     0     0    0   3    1    0  3046     1     0    0    16
7     3     0    0   3    0    1     0  1152     1    3     1
8     0     1    0  49   10   23    16    39  1213   11     8
9     9     3   54  34   43  110     9    63    44  751    17
10    0     0    0   0   45    0     1     1     0    0  1599
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_23_54_37_seed_0_21716735_instance_wise_predictions.txt
accuracy from prediction file 0.6897782131113133
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/1.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 458977 KiB |   6809 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 415725 KiB |   6773 MiB |   1450 TiB |   1450 TiB |
|       from small pool |  43251 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 458977 KiB |   6809 MiB |   1468 TiB |   1468 TiB |
|       from large pool | 415725 KiB |   6773 MiB |   1450 TiB |   1450 TiB |
|       from small pool |  43251 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 449054 KiB |   6803 MiB |   1467 TiB |   1467 TiB |
|       from large pool | 407075 KiB |   6767 MiB |   1449 TiB |   1449 TiB |
|       from small pool |  41979 KiB |     60 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7500 MiB |   7500 MiB |   7500 MiB |      0 B   |
|       from large pool |   7436 MiB |   7436 MiB |   7436 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 433951 KiB | 703689 KiB |   1100 TiB |   1100 TiB |
|       from large pool | 428050 KiB | 694392 KiB |   1082 TiB |   1082 TiB |
|       from small pool |   5900 KiB |  14742 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4556    |    6799    |  244115 K  |  244111 K  |
|       from large pool |     187    |     783    |  135552 K  |  135552 K  |
|       from small pool |    4369    |    6537    |  108562 K  |  108558 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4556    |    6799    |  244115 K  |  244111 K  |
|       from large pool |     187    |     783    |  135552 K  |  135552 K  |
|       from small pool |    4369    |    6537    |  108562 K  |  108558 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     342    |     342    |     342    |       0    |
|       from large pool |     310    |     310    |     310    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      60    |    1621    |  147170 K  |  147170 K  |
|       from large pool |      37    |     309    |   91278 K  |   91278 K  |
|       from small pool |      23    |    1584    |   55892 K  |   55892 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6809 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   1450 TiB |   1450 TiB |
|       from small pool |      0 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6809 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   1450 TiB |   1450 TiB |
|       from small pool |      0 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6803 MiB |   1467 TiB |   1467 TiB |
|       from large pool |  16640 KiB |   6767 MiB |   1449 TiB |   1449 TiB |
|       from small pool |      0 KiB |     60 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    872 MiB |   7500 MiB |   7500 MiB |   6628 MiB |
|       from large pool |    824 MiB |   7436 MiB |   7436 MiB |   6612 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 703689 KiB |   1100 TiB |   1100 TiB |
|       from large pool |  24320 KiB | 694392 KiB |   1082 TiB |   1082 TiB |
|       from small pool |      0 KiB |  40275 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6799    |  244115 K  |  244115 K  |
|       from large pool |       2    |     783    |  135552 K  |  135552 K  |
|       from small pool |       0    |    6537    |  108562 K  |  108562 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6799    |  244115 K  |  244115 K  |
|       from large pool |       2    |     783    |  135552 K  |  135552 K  |
|       from small pool |       0    |    6537    |  108562 K  |  108562 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     342    |     342    |     281    |
|       from large pool |      37    |     310    |     310    |     273    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1621    |  147172 K  |  147172 K  |
|       from large pool |       3    |     309    |   91278 K  |   91278 K  |
|       from small pool |       0    |    1584    |   55893 K  |   55893 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6809 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   1450 TiB |   1450 TiB |
|       from small pool |      0 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6809 MiB |   1468 TiB |   1468 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   1450 TiB |   1450 TiB |
|       from small pool |      0 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6803 MiB |   1467 TiB |   1467 TiB |
|       from large pool |  16640 KiB |   6767 MiB |   1449 TiB |   1449 TiB |
|       from small pool |      0 KiB |     60 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    872 MiB |   7500 MiB |   7500 MiB |   6628 MiB |
|       from large pool |    824 MiB |   7436 MiB |   7436 MiB |   6612 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 703689 KiB |   1100 TiB |   1100 TiB |
|       from large pool |  24320 KiB | 694392 KiB |   1082 TiB |   1082 TiB |
|       from small pool |      0 KiB |  40275 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6799    |  244115 K  |  244115 K  |
|       from large pool |       2    |     783    |  135552 K  |  135552 K  |
|       from small pool |       0    |    6537    |  108562 K  |  108562 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6799    |  244115 K  |  244115 K  |
|       from large pool |       2    |     783    |  135552 K  |  135552 K  |
|       from small pool |       0    |    6537    |  108562 K  |  108562 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     342    |     342    |     281    |
|       from large pool |      37    |     310    |     310    |     273    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1621    |  147172 K  |  147172 K  |
|       from large pool |       3    |     309    |   91278 K  |   91278 K  |
|       from small pool |       0    |    1584    |   55893 K  |   55893 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735

 Experiment start at: 2024-07-08 15:31:22.393202
before training, model accuracy: 0.10312740504741669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92834973, 'precision': 0.8276139, 'recall': 0.76351285, 'specificity': 0.9923514, 'f1': 0.75006187, 'auroc': 0.99397105}
confusion matrix:
     0     1    2     3    4   5     6     7     8    9      10
0   421     0    0     3    0   0     6     5     5    6     37
1     0  1276    0     8    1   0     1    38     5    0      3
2     3     0  138     1    9   0     3    13     4  138      3
3    13     5    0  7786    0   2    10   438   167   16      2
4     9     2  105     0  180   0     1     4    31   29    178
5     2     0    0    81    0  63     0     0     7  367      1
6    26     1    0     3    0   0  1839     0     9    7     22
7    12    52    2   113    1   0     9  6955    86    6     26
8     7     7    4   104   13   0     9   116  2984   12     39
9     2     0    7     7    0   0     0     3     8  462      4
10   32     4   22     9   39   0    18    21    49    5  12594
---- Validation: 
scalar performance:
{'acc': 0.9289822, 'precision': 0.82837397, 'recall': 0.7628324, 'specificity': 0.99244523, 'f1': 0.7456707, 'auroc': 0.9941583}
confusion matrix:
     0     1    2     3    4   5     6     7     8    9      10
0   426     1    0     2    0   0     5     4     7   10     28
1     0  1277    0     9    0   0     0    39     4    1      2
2     2     1  137     0   12   0     1    16     4  134      5
3    16     3    1  7807    0   0    13   410   167   20      3
4     8     0  112     0  171   0     2     7    27   28    184
5     0     0    0    82    0  54     0     0     6  378      1
6    27     0    0     0    1   0  1849     0     4    5     22
7     8    66    1   106    2   0    12  6958    83   10     19
8     6     9    6   101   10   0     5   122  2990    7     40
9     1     0   13     6    0   0     0     2     4  467      0
10   42     4   21     6   32   0    18    25    47    7  12594
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6988036, 'precision': 0.68400973, 'recall': 0.5701453, 'specificity': 0.96961653, 'f1': 0.52162325, 'auroc': 0.8855489}
confusion matrix:
      0     1   2   3    4   5     6     7     8    9     10
0   1131     0   0   2    0   0     2     3     3   16    13
1      3  1279   0  21    0   0     2   159     3    0    32
2     49     1  27   3   99   0     2   117   263  159   295
3      0     0   0   0    0   0     0     0     0    0     0
4      1     0   1   0  127   0     1     1    15    1  1486
5     14     0   0  68    0   8     1     1    31  466     3
6      3     0   0   1    2   0  2758     4    17    0   282
7     13     0   0  31    0   0    15  1092     1    0    12
8      5     0   0  42    2   0     5    16  1287    4     9
9     53     7   7  32    2   0     3   157   207  634    35
10     0     0   0   0    1   0     0     0     0    0  1645
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-08 16:03:09.261017,epoch time: 0:31:46.867815,used: 0:31:46.867815,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94657, 'precision': 0.88088614, 'recall': 0.8143056, 'specificity': 0.99398625, 'f1': 0.8375585, 'auroc': 0.99645895}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   413     0    0     8    0    0     1     9     0    2     50
1     0  1251    0    14    0    0     0    58     3    0      5
2     0     2  141     1   88    2     1    14     2   57      4
3     1     0    0  8189    2    5     1   168    72    0      1
4     2     0    5     1  310    0     0     3    13    6    199
5     0     0    0    45    2  290     0     1     7  174      1
6    22     0    0    25    2    0  1817     4     4    5     28
7     0     7    0   215    2    0     1  6991    23    2     21
8     1     0    3   171   13    1     0   146  2873    4     83
9     0     0   28    13    9   25     0     5     3  408      2
10   13     0    0    10   35    0     8    15    16    2  12696
---- Validation: 
scalar performance:
{'acc': 0.9458874, 'precision': 0.87955964, 'recall': 0.80793977, 'specificity': 0.9938973, 'f1': 0.8333205, 'auroc': 0.9964773}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   401     0    0    12    2    0     2    11     0    2     53
1     0  1248    0    14    0    0     0    60     3    0      7
2     0     1  141     1   76    1     1    20     2   64      5
3     0     0    1  8212    1    7     0   154    62    2      1
4     5     0    9     2  305    0     0     8    12    2    196
5     0     0    1    53    3  277     0     0     7  178      2
6    18     0    0    21    2    0  1825     4     2    3     33
7     0    11    2   230    1    0     1  6971    29    0     20
8     0     0    2   182   12    1     0   140  2880    3     76
9     3     1   24    16   11   24     0     6     2  402      4
10   10     0    1     8   31    1     9    20    15    1  12700
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66011333, 'precision': 0.62483853, 'recall': 0.54208046, 'specificity': 0.96601427, 'f1': 0.5219033, 'auroc': 0.8702743}
confusion matrix:
     0    1   2    3    4    5     6     7     8    9     10
0   993    0   0   84    4    0    15    36     4   17    17
1     0  985   0   20    0    0     0   455     1    0    38
2     6    2  18   24  270    2     0   167   167   60   299
3     0    0   0    0    0    0     0     0     0    0     0
4     0    0   0    0   58    0     1     3    14    1  1556
5     3    0   0  160    6  174     0     0    22  225     2
6     0    0   0    1    1    0  2853     8    16    0   188
7     0    0   0   81    0    0     0  1079     0    0     4
8     0    0   0   93    1    0     1    57  1209    1     8
9    16    4  14  171   46   19     2   262   137  423    43
10    0    0   0    0    1    0     0     1     1    0  1643
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_2.png
better model found
persisted
after epoch: 2,now: 2024-07-08 16:34:04.069152,epoch time: 0:30:54.808135,used: 1:02:41.675950,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9488442, 'precision': 0.8573088, 'recall': 0.853951, 'specificity': 0.99459344, 'f1': 0.8480034, 'auroc': 0.9969526}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   395     1    0     4    1    0    40     0     1    2     39
1     0  1296    0     6    0    0     0    21     6    0      3
2     0     0  268     0    9    1     1     2     2   28      1
3     1     3    1  8059    0    8     3   193   171    0      0
4     3     0  102     0  293    2     4     1    21    4    109
5     1     0    4    32    0  433     2     0    12   36      1
6     3     0    2     2    0    0  1884     1     5    0     10
7     0    68   25   144    1    0     2  6881   125    0     17
8     0     1   12    63   14    0     3    49  3112    0     42
9     1     0   96     8    2  103     1     1     9  272      0
10    8     1   25     6  104    0    41    10    21    4  12571
---- Validation: 
scalar performance:
{'acc': 0.94714457, 'precision': 0.8546461, 'recall': 0.849679, 'specificity': 0.99438727, 'f1': 0.8443208, 'auroc': 0.9969427}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   389     0    0     3    1    0    41     0     3    4     42
1     0  1295    0     7    0    0     1    20     7    0      2
2     2     0  266     2   11    2     1     2     5   21      0
3     0     2    1  8047    0   12     3   201   173    1      0
4     2     0  107     1  285    1     5     1    18    3    116
5     0     0    8    34    0  429     0     0    11   38      1
6     4     2    2     0    1    0  1880     2     8    0      9
7     2    58   30   163    2    0     1  6864   119    1     25
8     0     1    8    69   11    2     4    44  3105    2     50
9     1     0  103    11    3   89     3     1     8  274      0
10    9     1   23     7  112    0    33     7    26    3  12575
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71867347, 'precision': 0.660187, 'recall': 0.60377884, 'specificity': 0.9709915, 'f1': 0.5895461, 'auroc': 0.8862615}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   725     2    0  15    1    3   404     2     2   11     5
1     3  1370    0  10    0    0     9    85    11    0    11
2     7     9  145   6  166    9   110    13   322   57   171
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    4   0  163    0     6     1    16    0  1443
5     2     0    0  60    0  372    22     0    32  103     1
6     0     1    0   0    0    0  3055     0     4    0     7
7     1     1    0  15    0    0    13  1117    15    0     2
8     0     0    0  30    1    1    15     1  1316    1     5
9     7    22  135  66    2   95    61    24   337  368    20
10    0     0    0   0    3    0     1     0     1    0  1641
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-08 17:04:53.505706,epoch time: 0:30:49.436554,used: 1:33:31.112504,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95301795, 'precision': 0.88905823, 'recall': 0.83214307, 'specificity': 0.99478185, 'f1': 0.8521142, 'auroc': 0.99764764}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   349     0    4    10    1    0     5     3     3   30     78
1     1  1205    1    12    0    0     0    85    11    0     17
2     0     0  207     2    7    0     1     7     9   77      2
3     0     0    2  8182    0    7     0   153    92    1      1
4     2     0   77     0  269    3     0    10    28   11    139
5     0     0    0    51    0  363     0     0     7   99      1
6     9     0    2     5    2    0  1815     4     7    8     56
7     0     4    1   157    0    0     2  7032    59    0      8
8     0     0    8    92    3    0     1    58  3099    1     32
9     0     0   19     7    0   38     0     7     5  417      0
10    1     0    8     7   31    0     3    24    32    5  12682
---- Validation: 
scalar performance:
{'acc': 0.9549017, 'precision': 0.89083505, 'recall': 0.83849853, 'specificity': 0.99500614, 'f1': 0.8565903, 'auroc': 0.9976832}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   357     0    2     2    1    1     7     4     2   25     82
1     0  1232    1    12    0    0     0    70     6    0     11
2     0     0  209     0    5    0     1    14     7   75      1
3     1     0    1  8186    0    9     1   149    91    2      0
4     1     0   84     0  274    1     0     3    29   12    135
5     0     0    1    42    0  365     0     0     6  106      1
6     6     0    2    11    1    0  1824     5     6    8     45
7     0     4    1   137    0    0     2  7047    65    0      9
8     0     0    3    90    7    0     0    71  3087    1     37
9     2     0   17     6    0   38     0     3     4  422      1
10    0     0   10     5   30    1     3    15    33    3  12696
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65787446, 'precision': 0.6536877, 'recall': 0.54440063, 'specificity': 0.96563506, 'f1': 0.5260609, 'auroc': 0.8793611}
confusion matrix:
     0    1   2   3    4    5     6     7     8    9     10
0   728    0   0  44    0    0    27    32     3  276    60
1     1  826   0  18    0    0     1   553    12    0    88
2     2    0  99   9  123    3     4    92   335   99   249
3     0    0   0   0    0    0     0     0     0    0     0
4     0    0   2   0  155    0     2     3    22    1  1448
5     1    0   0  96    2  176     1     0    19  295     2
6     1    0   0   1    0    0  2781     3     4    0   277
7     0    0   0  13    0    0     0  1145     2    1     3
8     0    0   0  75    0    0     3    12  1274    3     3
9     2    0  44  86    4   28     2   136   228  577    30
10    0    0   0   0    4    0     0     0     0    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_4.png
better model found
persisted
after epoch: 4,now: 2024-07-08 17:35:39.207349,epoch time: 0:30:45.701643,used: 2:04:16.814147,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9468643, 'precision': 0.89655054, 'recall': 0.85020834, 'specificity': 0.99419045, 'f1': 0.865468, 'auroc': 0.9977369}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     0    0     8    0    0     8     0     6    4     27
1     0  1263    0    14    0    0     0    41    11    0      2
2     0     0  232     2    9    1     1     0     7   55      5
3     0     0    0  8242    0    2     2    48   143    0      0
4     3     0   49     1  245    0     3     3    61   10    164
5     0     0    0    66    0  400     0     0     6   48      1
6     7     0    0     6    0    0  1878     0     5    3      9
7     0     9    1   443    1    0     5  6592   204    0     10
8     1     0    3   100    0    1     1    14  3169    1      5
9     0     0   33    20    0   70     0     2     6  361      0
10   22     0    3    10   12    1    19     7   138    3  12578
---- Validation: 
scalar performance:
{'acc': 0.9480273, 'precision': 0.8954717, 'recall': 0.85210156, 'specificity': 0.9943441, 'f1': 0.8660805, 'auroc': 0.99774635}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     0    0    11    1    1     7     0     8    3     22
1     1  1270    0    19    0    0     0    36     6    0      0
2     0     0  225     3    8    1     1     4     7   61      2
3     0     0    1  8244    0    5     0    49   141    0      0
4     5     0   58     2  247    0     2     4    55    8    158
5     1     0    1    61    0  397     0     0     6   54      1
6     8     0    0     4    0    1  1884     0     3    0      8
7     2     9    2   406    1    0     2  6621   217    0      5
8     0     0    3   110    2    3     1    19  3149    1      8
9     0     0   22    10    0   71     0     1     8  381      0
10   14     0    3     8   10    1    24     6   133    3  12594
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.662772, 'precision': 0.66707873, 'recall': 0.5332899, 'specificity': 0.9666134, 'f1': 0.5268947, 'auroc': 0.88033956}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   812     0   0  123   0    0   138    3    46   46     2
1     8  1220   0   43   0    0     3  193    16    0    16
2     5     1  41   69  48    7    36   23   509  104   172
3     0     0   0    0   0    0     0    0     0    0     0
4     0     0   1    0  62    0     7    1    60    2  1500
5     2     0   0  306   0  195     0    0     9   79     1
6     0     0   0    5   0    0  3050    0     1    0    11
7     4     0   0  238   0    0     3  901    17    0     1
8     0     0   0  170   0    0     3    0  1197    0     0
9     4     1  12  381   1   86     4   53   215  354    26
10    0     0   0    1   1    0     2    0     1    0  1641
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_5.png
early stop counter: 1
val acc:0.9480273127555847, best validation acc: 0.9549016952514648, corresponding to test acc:                         0.6578744649887085 / 0.7186734676361084
after epoch: 5,now: 2024-07-08 18:06:41.738255,epoch time: 0:31:02.530906,used: 2:35:19.345053,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9585563, 'precision': 0.8784427, 'recall': 0.8754095, 'specificity': 0.99557, 'f1': 0.87453496, 'auroc': 0.9982334}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     1    2    0     6     6     0    0     16
1     0  1275    0     7    0    0     0    43     2    0      4
2     2     0  196     0   88    0     0     2     1   21      2
3     2     1    1  8118    1   14     1   211    86    3      0
4     6     0    5     1  430    0     0     1     6    1     89
5     1     0    2    16    1  382     0     0     4  113      2
6    25     0    0     2    2    0  1843     8     5    2     21
7     0    10    3   106    4    0     1  7113    20    0      7
8     3     0    6    75   47    4     0   108  3017    0     34
9     0     0   78     3   13   15     0     1     2  378      3
10   20     1    2     7  118    0     2    10    10    0  12623
---- Validation: 
scalar performance:
{'acc': 0.95894074, 'precision': 0.8769985, 'recall': 0.8730473, 'specificity': 0.99564296, 'f1': 0.8721557, 'auroc': 0.9980315}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    1     5    4    0     5     5     0    2     16
1     0  1273    0    10    0    0     0    40     4    0      5
2     2     0  193     0   89    0     1     5     1   19      2
3     1     1    1  8144    2   12     1   192    86    0      0
4     6     0    3     1  445    0     0     3     5    2     74
5     1     0    4    17    3  370     0     0     8  116      2
6    27     0    0     6    2    0  1840     9     5    0     19
7     0    11    1   100    5    0     1  7111    29    1      6
8     3     1    6    67   45    1     0    95  3045    0     33
9     2     0   73     3   11   27     0     3     1  372      1
10   17     1    1     8  129    0     5     9    14    0  12612
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7257399, 'precision': 0.62003744, 'recall': 0.5905011, 'specificity': 0.97220945, 'f1': 0.5755631, 'auroc': 0.877964}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1033     2    1   7    2    0    58    57     1    0     9
1      0  1260    0  13    0    0     0   202     3    0    21
2     18     1   24   1  599    2     8    48    82   20   212
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    0   0  487    0     3     1     2    0  1138
5     20     0    6  60   25  165     4     2    22  286     2
6      1     0    0   0    0    0  3052     0     0    0    14
7      0     0    0   4    0    0     0  1156     1    1     2
8      0     0    0  25   11    0    11    35  1278    2     8
9     45    10  191  35  208   16    12   113   154  313    40
10     0     0    0   0   39    0     1     1     0    0  1605
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-08 18:37:56.536857,epoch time: 0:31:14.798602,used: 3:06:34.143655,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9593857, 'precision': 0.9064002, 'recall': 0.86223066, 'specificity': 0.9954382, 'f1': 0.8794943, 'auroc': 0.9983991}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   381     0    0     2    1    1    35     0     0    5     58
1     0  1276    0    12    0    1     0    35     3    0      5
2     0     0  210     1   34    0     0     2     3   59      3
3     1     0    1  8298    2    8     8    87    28    4      0
4     1     0   14     1  358    0     2     0     7    7    149
5     0     0    1    26    0  360     0     0     4  129      1
6     2     0    0     0    0    0  1892     0     1    1     11
7     1     7    5   194    6    0     3  6975    50    4     19
8     0     0    3   180   21    4     5    38  2948    8     87
9     0     0   22     3    1   28     0     0     2  435      1
10    0     0    2     7   37    0    11     4     8    1  12725
---- Validation: 
scalar performance:
{'acc': 0.9595292, 'precision': 0.90753883, 'recall': 0.8702947, 'specificity': 0.99545115, 'f1': 0.8854435, 'auroc': 0.99837637}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   386     0    0     2    1    0    28     0     0    3     63
1     0  1267    0    12    0    0     0    41     5    1      6
2     0     0  217     0   39    1     0     0     2   52      1
3     1     2    0  8309    0   12     3    80    29    4      0
4     4     0    8     0  372    0     1     1    10    5    138
5     0     0    0    19    0  382     0     0     4  115      1
6     2     0    0     0    0    0  1894     0     1    3      8
7     2     8    6   205   10    0     3  6955    56    1     19
8     0     0    5   187   25    5     2    37  2938    6     91
9     0     0   25     5    2   21     0     0     2  436      2
10    3     0    2     8   44    0     9     3     9    2  12716
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6700483, 'precision': 0.6022358, 'recall': 0.5376564, 'specificity': 0.9661701, 'f1': 0.51242155, 'auroc': 0.8675005}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   567     0   0    5    1    0   446     1     4   92    54
1     2  1156   0   24    0    1     1   249    12    2    52
2     3     0  36    9  153    2    79    14   301   77   341
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    1   50    0     3     1    18    1  1559
5     1     0   1   65    4  123    11     0     7  378     2
6     0     0   0    0    0    0  3043     0     2    0    22
7     1     0   0   13    0    0     3  1138     6    2     1
8     0     0   0  103    0    0    17     5  1237    4     4
9     7     0  55   55   17   29    24    34   286  584    46
10    0     0   0    1    0    0     2     0     0    0  1643
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_7.png
better model found
persisted
after epoch: 7,now: 2024-07-08 19:13:20.812988,epoch time: 0:35:24.276131,used: 3:41:58.419786,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9612853, 'precision': 0.90210474, 'recall': 0.8870363, 'specificity': 0.99568623, 'f1': 0.8915809, 'auroc': 0.9986315}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   408     0    0     3    2    1    26     0     0    2     41
1     0  1299    0     5    0    1     1    23     2    0      1
2     0     0  229     0   11    2     1     0     0   68      1
3     0     6    1  8209    0   71     4    40   100    6      1
4     2     1   38     0  346    1     3     0     2    7    139
5     0     0    0     1    0  490     0     0     1   28      1
6     2     0    1     2    1    0  1890     0     0    1     11
7     0    19    8   230    1    0     2  6935    45    4     19
8     0     1    3    60   23   14     3    40  3000    7    144
9     0     0    7     1    1   89     0     1     1  393      0
10    3     0    2     7   32    2    11     3     2    0  12730
---- Validation: 
scalar performance:
{'acc': 0.96196336, 'precision': 0.9023302, 'recall': 0.8894455, 'specificity': 0.9957758, 'f1': 0.8932353, 'auroc': 0.99859995}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   409     0    0     3    3    1    28     0     0    3     36
1     0  1301    0     6    0    1     0    19     4    0      1
2     0     0  232     0   16    2     1     1     0   59      1
3     0     2    1  8229    0   69     1    45    90    3      0
4     1     0   38     0  352    2     1     0     1    8    136
5     0     0    0     1    0  488     0     0     2   29      1
6     6     0    0     1    0    0  1890     0     0    0     11
7     0    30    6   229    3    1     2  6921    51    6     16
8     0     1    6    66   23   13     5    32  3006   11    133
9     0     0   11     3    1   82     0     0     1  395      0
10    3     0    3     7   23    1    12     4     3    0  12740
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7355349, 'precision': 0.6677946, 'recall': 0.6330567, 'specificity': 0.9731416, 'f1': 0.6155634, 'auroc': 0.8850984}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   977     0    0  43    0    3   117    15     1    5     9
1     2  1214    0  11    0    0     5   224     6    1    36
2    17     0  109   3  228   28    45    26   125   72   362
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  252    0     3     1     7    1  1369
5     7     0    0  20    2  479     7     0     0   74     3
6     0     0    0   1    0    0  3045     1     0    0    20
7     0     0    0  70    0    1     4  1084     1    1     3
8     2     0    2  34    6   16    47     3  1216    4    40
9    22     2  104  43   15  197    23    41   135  507    48
10    0     0    0   0   16    0     0     0     0    0  1630
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-08 19:45:34.054651,epoch time: 0:32:13.241663,used: 4:14:11.661449,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96080375, 'precision': 0.9135266, 'recall': 0.88006574, 'specificity': 0.9955918, 'f1': 0.8920812, 'auroc': 0.99847597}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     2    0    0     0     3     0    2     17
1     0  1277    0     3    0    0     0    43     6    0      1
2     1     0  228     1   29    3     1     3     4   25     17
3     1     0    1  8117    0   23     0   200    93    1      2
4     4     0   10     1  274    1     0     0     9    7    233
5     0     0    1     7    0  428     0     0     2   81      1
6    22     0    1     1    0    0  1853     6     4    2     19
7     0    20    6    80    2    1     1  6987   142    1     24
8     0     0    6    93    8   11     0    19  3104    4     50
9     0     0   28     3    2   24     0     0     2  431      3
10   11     0    2     8    3    0     2     3    11    1  12753
---- Validation: 
scalar performance:
{'acc': 0.96223086, 'precision': 0.91403913, 'recall': 0.8807815, 'specificity': 0.9957333, 'f1': 0.89338493, 'auroc': 0.99855494}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     1    2    0     0     3     0    1     18
1     0  1269    0     6    0    0     0    47     8    0      2
2     0     0  234     0   29    2     1     1     0   32     13
3     0     0    1  8166    2   21     0   184    62    2      2
4     5     0    5     0  278    0     0     0     7    5    239
5     0     0    0     6    0  439     0     0     2   73      1
6    24     0    1     2    0    0  1853     6     2    1     19
7     0    13    7    88    2    0     1  6995   131    1     27
8     0     0    3    93   10    8     0    15  3116    4     47
9     1     0   34     1    1   37     0     0     4  412      3
10   10     0    1     7    4    0     1     6    11    3  12753
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.731407, 'precision': 0.6287476, 'recall': 0.6247165, 'specificity': 0.9728157, 'f1': 0.5948516, 'auroc': 0.8822406}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1080     0    0  13    2    0    24    22     2    9    18
1      1  1220    0  13    0    0     0   230     8    0    27
2     21     3  123   2  198   19    47    23   190   45   344
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    1   0   94    0     9     1    11    0  1516
5      7     0    2  40    0  410     9     2     6  116     0
6      0     0    0   1    0    0  3056     0     0    0    10
7      0     1    0   3    0    1     0  1145    11    0     3
8      0     0    0  21    0   19     8     3  1310    1     8
9     18     1  198  33    9  191    13    45   206  377    46
10     0     0    0   0    3    0     4     0     0    0  1639
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_9.png
better model found
persisted
after epoch: 9,now: 2024-07-08 20:16:47.539533,epoch time: 0:31:13.484882,used: 4:45:25.146331,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9652183, 'precision': 0.91373575, 'recall': 0.90115565, 'specificity': 0.99620986, 'f1': 0.9046359, 'auroc': 0.9989228}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     0    1    1     2     0     1    2      8
1     1  1243    0     6    0    1     1    60    17    0      3
2     0     0  265     1   17    0     1     1     1   22      4
3    11     0    0  8221    0   12     5    74   114    2      0
4     7     0   29     1  333    0     1     3    15    1    149
5     1     0    4     8    1  445     0     0     6   55      1
6     8     0    0     3    2    0  1882     0     4    0      9
7     6     2    9   175    1    0     3  6914   146    0      8
8     2     0    3    29    5    2     1    18  3196    1     38
9     2     0   52     3    1   29     0     0     5  401      0
10   20     0    2     7   22    0     6     5    20    0  12708
---- Validation: 
scalar performance:
{'acc': 0.964558, 'precision': 0.91590405, 'recall': 0.9012815, 'specificity': 0.99612117, 'f1': 0.90565413, 'auroc': 0.9988413}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     1    0    0     3     0     1    0      7
1     1  1233    0     8    0    0     2    64    20    0      4
2     2     0  265     1   14    0     1     2     2   20      5
3    10     0    0  8222    0   15     3    75   111    3      1
4     8     0   26     0  335    1     0     2    15    0    152
5     0     0    4     9    0  437     0     1     7   62      1
6     9     0    0     1    2    1  1880     0     1    0     14
7     9     1    6   185    1    0     6  6900   148    0      9
8     1     0    3    41    7    2     0    19  3186    2     35
9     2     0   46     1    1   30     0     1     1  411      0
10   22     0    0     7   17    0     5     5    20    0  12720
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6889386, 'precision': 0.6184554, 'recall': 0.58169216, 'specificity': 0.96894646, 'f1': 0.55671173, 'auroc': 0.87749034}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1093     0    0   22    0    0    30   12     4    4     5
1     12  1121    0   39    0    0     2  261    33    0    31
2     39     0  129   15  108   28     6   27   365   24   274
3      0     0    0    0    0    0     0    0     0    0     0
4      4     0    1    0   50    0     3    3    35    0  1537
5     18     0    5   75    0  398     5    0    16   73     2
6      7     0    0    2    0    0  3010    0     3    0    45
7      5     0    0  270    0    1     1  872    13    0     2
8      1     0    0   92    0    5     5    0  1265    0     2
9     51     0  149  106    5  188     5   20   306  268    39
10     0     0    0    0    2    0     2    0     1    0  1641
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_10.png
better model found
persisted
after epoch: 10,now: 2024-07-08 20:47:29.462368,epoch time: 0:30:41.922835,used: 5:16:07.069166,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96246254, 'precision': 0.9201999, 'recall': 0.9013946, 'specificity': 0.99588233, 'f1': 0.9060127, 'auroc': 0.9989459}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     3    4    0     8     0     0    0      6
1     0  1301    0     9    0    0     1    15     3    0      3
2     2     0  175     2   54    1     1     1     5   64      7
3     0     0    0  8286    0    4     0    89    55    4      0
4     3     0    1     2  452    0     0     2     6    1     72
5     0     0    0    13    0  450     1     0     3   51      2
6     4     0    0     2    0    0  1892     0     0    1      9
7     0    15    1   398    2    0     2  6729    93    2     22
8     3     0    1    73   16    4     2    27  3132    1     33
9     0     0   11     6    5   36     0     0     1  432      2
10   15     0    0    13   78    2    14     1    10    0  12662
---- Validation: 
scalar performance:
{'acc': 0.9631403, 'precision': 0.92655694, 'recall': 0.90485436, 'specificity': 0.99595344, 'f1': 0.9111473, 'auroc': 0.9989665}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     3    3    0    12     1     0    1      7
1     0  1301    0     8    0    0     0    17     4    0      2
2     0     0  188     0   48    0     0     3     1   68      4
3     0     0    0  8273    0    3     0   103    60    1      0
4     4     0    0     1  447    1     1     0     6    5     74
5     0     0    0    18    0  443     0     0     5   54      1
6     5     0    0     2    0    0  1891     1     1    1      7
7     0    17    2   376    2    0     4  6744    95    1     24
8     1     0    0    82    7    0     3    19  3152    2     30
9     0     0    7     2    3   27     2     0     2  446      4
10   10     0    0     8   84    0    16     4     8    0  12666
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7108375, 'precision': 0.68297005, 'recall': 0.5807842, 'specificity': 0.97134006, 'f1': 0.5870599, 'auroc': 0.8819395}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1045     0   0   49    2    1    39    1     3   25     5
1      4  1259   0   40    0    0     6  134    17    3    36
2     19     0  29   26  304    6     8   11   233  121   258
3      0     0   0    0    0    0     0    0     0    0     0
4      0     0   0    0  499    0     6    0    16    1  1111
5      7     0   0   69    0  239     2    0     3  271     1
6      3     0   0    1    0    0  3060    1     0    0     2
7      1     0   1  626    0    0     1  511    13   10     1
8      0     0   0   93    3   12    10    0  1237    9     6
9     14     2  16   98   19   55     9   11   161  707    45
10     0     0   0    1   67    0     3    0     1    0  1574
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_11.png
early stop counter: 1
val acc:0.9631403088569641, best validation acc: 0.9645580053329468, corresponding to test acc:                         0.6889386177062988 / 0.7355349063873291
after epoch: 11,now: 2024-07-08 21:18:07.354201,epoch time: 0:30:37.891833,used: 5:46:44.960999,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9738602, 'precision': 0.9365123, 'recall': 0.90870106, 'specificity': 0.9970965, 'f1': 0.91963774, 'auroc': 0.99928886}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     1    0    1     0     2     1    5     14
1     0  1311    0     2    0    0     0    18     1    0      0
2     3     0  219     0   26    3     0     1     1   58      1
3     0    10    0  8296    0    9     0    79    42    2      0
4     4     0    9     0  359    1     0     3    13    1    149
5     0     0    0    10    0  479     0     0     0   32      0
6    12     0    0     3    0    1  1871     2     3    1     15
7     0    28    0   110    1    0     1  7076    38    2      6
8     0     3    0    78    2    8     0    32  3155    3     14
9     0     0   13     2    0   42     0     0     1  435      0
10   10     0    4     7    7    0     2     7    16    1  12739
---- Validation: 
scalar performance:
{'acc': 0.9723151, 'precision': 0.9314048, 'recall': 0.9019203, 'specificity': 0.9969224, 'f1': 0.91363883, 'auroc': 0.9992735}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     3    1    0     1     1     0    1     12
1     0  1311    0     1    0    0     0    19     0    0      1
2     0     1  216     0   28    2     0     3     0   58      4
3     0     5    0  8296    0    7     0    93    35    4      0
4     4     0   11     0  350    2     0     1    11    4    156
5     0     0    0     8    0  462     0     0     1   49      1
6    11     1    0     1    2    0  1865     3     2    3     20
7     0    28    0   117    2    0     2  7073    40    0      3
8     0     4    1    89    3    7     0    31  3144    4     13
9     1     0   15     6    0   43     0     1     1  426      0
10    8     0    2     7    7    1     2     5    17    4  12743
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6967047, 'precision': 0.63834035, 'recall': 0.58544046, 'specificity': 0.9695041, 'f1': 0.5487117, 'auroc': 0.87149704}
confusion matrix:
      0     1   2    3   4    5     6     7     8    9     10
0   1046     4   0   10   1    2     2    75    13    5    12
1      1  1129   0   14   0    0     0   326     7    0    22
2     24     4  25    7  42   14     0    60   347   93   399
3      0     0   0    0   0    0     0     0     0    0     0
4      0     0   0    0  28    0     2     1    20    1  1581
5     16     0   1   51   0  263     1     2    12  243     3
6     15     0   0    1   0    0  2889     3     7    0   152
7      0     0   0   39   0    1     0  1118     5    0     1
8      0     0   0   59   0    4     3    15  1284    2     3
9     22    24   9  100   2  115     3    72   228  533    29
10     0     0   0    0   1    0     0     1     1    0  1643
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_12.png
better model found
persisted
after epoch: 12,now: 2024-07-08 21:49:09.502110,epoch time: 0:31:02.147909,used: 6:17:47.108908,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9707299, 'precision': 0.93825316, 'recall': 0.8910661, 'specificity': 0.9966396, 'f1': 0.91000247, 'auroc': 0.9992651}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   426     0    0     1    2    0     7     0     1    1     45
1     0  1290    0     3    0    0     1    36     2    0      0
2     0     0  279     0    4    0     1     5     1   13      9
3     0     0    0  8263    0    1     5    85    83    0      1
4     1     0   25     0  325    0     0     0    12    2    174
5     1     0    0    55    0  425     1     0     5   33      1
6     5     0    0     2    1    0  1867     0     2    0     30
7     0     5    2    93    0    0     2  7107    30    2     22
8     0     0    0    37    7    0     0    49  3168    1     34
9     3     0   58    13    1   47     0     3     1  366      1
10    1     0    0     7    7    0     2     2     7    0  12766
---- Validation: 
scalar performance:
{'acc': 0.97135216, 'precision': 0.93953836, 'recall': 0.8939509, 'specificity': 0.9967102, 'f1': 0.91272056, 'auroc': 0.99923867}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   416     0    0     2    5    1     8     1     0    1     49
1     0  1290    0     4    0    0     0    36     2    0      0
2     0     0  275     1    9    0     0     7     0   15      5
3     0     0    0  8277    0    1     3    80    78    1      0
4     2     0   28     0  325    0     1     1     9    0    173
5     0     0    0    50    0  437     0     0     5   28      1
6     4     1    0     1    1    0  1873     0     0    0     28
7     0     5    2   102    0    0     1  7107    29    1     18
8     0     0    1    34    8    0     2    58  3162    1     30
9     1     0   52    10    2   38     1     2     0  386      1
10    0     0    1     6    8    0     2     4     8    1  12766
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6819422, 'precision': 0.60963315, 'recall': 0.56679684, 'specificity': 0.96785, 'f1': 0.53958756, 'auroc': 0.874492}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   916     0   0   16    0    0    55    45    56    4    78
1     0  1157   0   24    0    0     0   280    12    0    26
2     6     0  47    9  116    7     4    49   237   33   507
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0   40    0     2     1    19    0  1571
5     8     0   4  130    2  241    14     0    54  122    17
6     3     0   0    1    0    0  2871     2     2    0   188
7     0     0   0    5    0    0     0  1156     2    0     1
8     0     0   0   20    0    0     2    12  1329    1     6
9    14     2  71   89   24   87    10    86   312  345    97
10    0     0   0    0    1    0     0     0     0    0  1645
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_13.png
early stop counter: 1
val acc:0.9713521599769592, best validation acc: 0.9723150730133057, corresponding to test acc:                         0.6967046856880188 / 0.7355349063873291
after epoch: 13,now: 2024-07-08 22:19:47.551267,epoch time: 0:30:38.049157,used: 6:48:25.158065,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9706496, 'precision': 0.9219775, 'recall': 0.92520964, 'specificity': 0.9969832, 'f1': 0.9200828, 'auroc': 0.9991778}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     1    0    0     7     2     1    1      3
1     0  1312    0     1    0    0     0    19     0    0      0
2     0     0  211     0   30    2     0     3     0   65      1
3     0     5    1  8151    0    3     0   179    98    1      1
4     6     0    4     0  486    2     1     1    18    3     17
5     0     0    0     8    0  484     1     0     5   23      0
6     2     0    0     0    0    0  1895     2     4    0      4
7     0    14    0    51    1    0     1  7159    33    0      4
8     0     3    0    31    2    0     0    51  3205    0      3
9     0     0    5     3    2   74     0     2     3  404      0
10    6     6    0     6  170    2    14    17    67    1  12505
---- Validation: 
scalar performance:
{'acc': 0.9702822, 'precision': 0.9180666, 'recall': 0.92347693, 'specificity': 0.9969617, 'f1': 0.91688824, 'auroc': 0.9992962}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     3    2    0     8     3     0    0      7
1     0  1316    0     2    0    0     0    14     0    0      0
2     0     0  204     0   35    4     0     3     0   66      0
3     0     2    1  8147    0    1     0   165   124    0      0
4     7     0    4     1  496    1     0     2    11    3     14
5     0     0    0     8    0  493     0     0     4   16      0
6     4     2    0     1    0    0  1887     2     4    2      6
7     0    18    1    47    1    0     1  7164    30    0      3
8     0     4    1    23    1    2     0    46  3215    1      3
9     0     0    7     2    1   80     0     2     4  397      0
10    8     8    1     8  170    1     9    15    78    3  12495
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73581475, 'precision': 0.6673342, 'recall': 0.61951023, 'specificity': 0.973508, 'f1': 0.5993862, 'auroc': 0.88558227}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   825     9   0   59    1    2   113   109    31   17     4
1     1  1311   0   12    1    0     0   167     4    0     3
2    18    11  36   19  264   45    42    92   327   74    87
3     0     0   0    0    0    0     0     0     0    0     0
4     0     1   0    0  702    0     6     4    29    3   888
5     7     0   0  128    0  401     5     1     9   41     0
6     8     1   0    1    4    0  2975     5    15    0    58
7     0     0   0   18    0    0     0  1144     1    0     1
8     0     4   0   55    0    6     6    16  1282    0     1
9    11    19  22  147    7  240    14   116   235  313    13
10    0     2   0    0  112    0     4     0     0    0  1528
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_14.png
new oracle model saved
early stop counter: 2
val acc:0.9702821969985962, best validation acc: 0.9723150730133057, corresponding to test acc:                         0.6967046856880188 / 0.7358147501945496
after epoch: 14,now: 2024-07-08 22:50:19.390330,epoch time: 0:30:31.839063,used: 7:18:56.997128,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9797731, 'precision': 0.9443388, 'recall': 0.94550073, 'specificity': 0.99782544, 'f1': 0.9435258, 'auroc': 0.99962705}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    1     1   10    0     0     0     0    1     14
1     0  1311    0     2    0    0     0    16     0    0      2
2     0     0  293     0   13    0     0     0     1    4      1
3     0     1    1  8246    1    5     0    92    91    0      1
4     0     0    9     1  474    0     0     3     2    1     49
5     0     0    1     8    2  499     0     0     1   10      0
6     3     0    0     2    2    0  1874     3     3    1     19
7     0    10    2    59    1    0     1  7141    41    1      7
8     0     0    3    28   10    1     0    15  3217    3     17
9     0     0   47     0    4   56     1     0     0  385      0
10    1     0    5     4   45    0     2     4    10    0  12724
---- Validation: 
scalar performance:
{'acc': 0.97811955, 'precision': 0.93844986, 'recall': 0.9401437, 'specificity': 0.99765694, 'f1': 0.93795764, 'auroc': 0.9996111}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    1     3   10    1     0     1     1    1     19
1     0  1304    0     3    0    0     0    22     1    0      2
2     0     0  287     0   13    1     0     0     1   10      0
3     0     0    1  8239    1    6     0    93    97    2      1
4     1     0   11     0  475    0     0     3     1    0     48
5     0     0    1     7    2  497     0     0     3   11      0
6     3     0    0     2    3    0  1875     3     2    2     18
7     0     7    5    65    3    0     1  7128    46    2      8
8     0     0    2    21   13    2     0    13  3223    2     20
9     0     0   41     1    5   62     0     1     2  381      0
10    1     0    4     5   55    1     2     5    11    0  12712
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7188834, 'precision': 0.6388923, 'recall': 0.61636996, 'specificity': 0.9718094, 'f1': 0.60012484, 'auroc': 0.8756336}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   782     0   38  40   57   16    36    73    35   65    28
1     3  1250    1  14    0    1     0   186     9    1    34
2     0     1  214  11  401   30     2    23   187   28   118
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    2   1  473    0     1     1    10    1  1144
5     3     0    6  65    7  451     1     0     6   53     0
6     2     0    1   1   10    0  2853     2     4    0   194
7     0     0    4  42    0    3     0  1093    19    2     1
8     0     0    0  23    7   15     3     5  1313    0     4
9     3     1  256  57   23  329     2    25   172  244    25
10    0     0    0   0   42    0     1     1     0    0  1602
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_15.png
better model found
persisted
after epoch: 15,now: 2024-07-08 23:20:53.338331,epoch time: 0:30:33.948001,used: 7:49:30.945129,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97899723, 'precision': 0.9500088, 'recall': 0.93958014, 'specificity': 0.9976623, 'f1': 0.94464576, 'auroc': 0.99961215}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     1    1    0     2     1     0    1     23
1     0  1295    0     5    0    0     1    30     1    0      0
2     1     0  271     0   17    2     0     2     2   15      2
3     0     2    0  8357    1   23     0    27    27    1      0
4     4     0    4     0  453    0     0     0     6    0     72
5     1     0    0     1    0  481     0     0     2   36      0
6     0     0    0     1    0    0  1886     2     0    1     16
7     1     4    0   164    1    0     1  7073    17    0      4
8     0     1    0    64    4    3     1    38  3167    2     16
9     0     0   26     0    1   29     0     0     1  435      1
10    0     0    0     6   43    0     2     5    16    0  12720
---- Validation: 
scalar performance:
{'acc': 0.9795908, 'precision': 0.950203, 'recall': 0.9401323, 'specificity': 0.9977313, 'f1': 0.9449183, 'auroc': 0.9996187}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     1    2    0     3     0     2    0     31
1     0  1309    0     0    0    0     0    23     0    0      0
2     0     0  267     0   14    1     0     3     5   18      4
3     0     0    0  8355    0   32     0    28    24    1      0
4     2     0    2     0  465    1     1     0     3    1     64
5     0     0    0     0    1  481     1     0     1   36      1
6     2     0    0     3    0    1  1879     1     1    0     21
7     0     4    1   135    2    0     1  7105    13    0      4
8     0     1    2    59    6    1     1    48  3160    1     17
9     2     0   21     0    1   26     0     1     2  440      0
10    0     0    0     6   46    1     6     5    15    0  12717
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6988736, 'precision': 0.64188755, 'recall': 0.59157705, 'specificity': 0.969578, 'f1': 0.58204424, 'auroc': 0.8722436}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   971     0   2    5    1    3    52    20     5    8   103
1     2  1176   0   15    0    2     5   251     5    0    43
2     6     1  70    5  245    8     5    52   197   38   388
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  292    0     2     3    12    0  1324
5     2     0   5   25    7  326     5     0    10  193    19
6     5     0   0    2    0    0  2789     2     2    0   267
7     0     0   0  150    0    1     2  1003     4    0     4
8     0     0   0   39    2   13     8    22  1275    1    10
9    14     2  93   47   49  107    14    74   195  459    83
10    0     0   0    0   17    0     1     0     0    0  1628
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_16.png
better model found
persisted
after epoch: 16,now: 2024-07-08 23:51:23.500550,epoch time: 0:30:30.162219,used: 8:20:01.107348,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.976616, 'precision': 0.9419858, 'recall': 0.92886335, 'specificity': 0.99732757, 'f1': 0.93185127, 'auroc': 0.99954885}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     0    0    1     6     0     0    0     13
1     0  1286    1     9    0    0     0    34     1    0      1
2     0     0  280     0    0    2     0     0     1   29      0
3     3     0    1  8335    0   20     0    43    27    9      1
4     4     0   53     0  352    0     4     0     1    1    124
5     0     0    0     1    0  504     0     0     0   15      0
6     1     0    0     1    0    0  1897     0     0    0      9
7     0     1   12   105    1    0     2  7107    14    6     15
8     0     0    2    84    6   11     2    19  3074    4     94
9     0     0   17     0    0   41     0     0     0  435      0
10    4     0    1     2    6    0     5     2     2    0  12769
---- Validation: 
scalar performance:
{'acc': 0.9766484, 'precision': 0.9432415, 'recall': 0.9311832, 'specificity': 0.99732757, 'f1': 0.9331728, 'auroc': 0.99958223}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    0    0     1     0     0    0     12
1     0  1280    4     8    0    0     0    34     4    2      0
2     0     0  286     0    0    0     0     0     1   20      5
3     3     0    0  8338    0   25     0    38    28    8      0
4     5     0   57     1  345    0     0     0     1    2    128
5     0     0    0     1    0  504     0     0     0   16      0
6     4     0    0     0    0    0  1898     0     0    1      5
7     0     2   12   110    1    1     1  7107    13    0     18
8     0     0    3    80    5   13     4    24  3069    7     91
9     0     0    9     0    0   42     1     0     0  441      0
10    2     0    1     4    5    0     8     0     2    0  12774
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71958303, 'precision': 0.65334046, 'recall': 0.6185466, 'specificity': 0.9717474, 'f1': 0.59564114, 'auroc': 0.87687653}
confusion matrix:
      0     1    2    3   4    5     6     7     8    9     10
0   1028     0    4    5   1   11    51     3     2   27    38
1      2  1139    1   16   0    1     5   258    26    2    49
2      5     0  263    5  36   26    23    17   260   50   330
3      0     0    0    0   0    0     0     0     0    0     0
4      0     0    4    0  35    0     6     1    16    0  1571
5      4     0    8   25   0  407     3     0     4  137     4
6      2     0    0    0   0    0  3008     2     2    0    53
7      1     0    5  117   0    1     2  1015    16    5     2
8      0     0    1   48   0   25    14     3  1268    5     6
9      5     0  173   34   1  230     6    17   160  478    33
10     0     0    0    0   1    0     1     0     0    0  1644
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_17.png
early stop counter: 1
val acc:0.9766483902931213, best validation acc: 0.9795907735824585, corresponding to test acc:                         0.6988735795021057 / 0.7358147501945496
after epoch: 17,now: 2024-07-09 00:21:58.937718,epoch time: 0:30:35.437168,used: 8:50:36.544516,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97790027, 'precision': 0.9499119, 'recall': 0.9417405, 'specificity': 0.9975935, 'f1': 0.94514817, 'auroc': 0.9996505}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    0    0     2     2     0    1      2
1     0  1276    0     0    0    0     0    53     1    0      2
2     0     0  257     0   18    0     1     1     0   32      3
3     1     1    0  8136    0   12     1   225    58    1      0
4     7     0    9     0  447    2     0     2     9    1     61
5     0     0    0     4    0  482     0     0     3   32      0
6    11     0    0     0    2    0  1881     5     2    0      7
7     1     0    0    47    0    0     0  7195    14    1      6
8     0     0    1    17    6    2     0    42  3213    3     11
9     1     0   11     0    1   22     0     2     0  456      0
10   18     0    1     5   18    0     3     5    13    1  12731
---- Validation: 
scalar performance:
{'acc': 0.97729033, 'precision': 0.9500011, 'recall': 0.94289017, 'specificity': 0.9975297, 'f1': 0.9458442, 'auroc': 0.9996261}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    0    0     3     1     0    0      2
1     0  1280    0     1    0    0     0    49     1    0      1
2     1     0  266     0   15    0     0     3     1   26      0
3     3     0    0  8125    1   14     0   225    66    5      1
4     9     0    8     0  442    1     0     1     9    3     66
5     0     0    0     3    0  487     0     0     3   28      0
6     6     0    0     0    0    0  1892     1     1    1      7
7     0     0    0    53    1    0     0  7196    13    0      2
8     1     0    2    19    3    1     1    54  3205    1      9
9     0     0   14     0    2   28     0     2     1  446      0
10   20     0    0     5   15    0     6     8    21    1  12720
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7288883, 'precision': 0.6528729, 'recall': 0.6234344, 'specificity': 0.9726739, 'f1': 0.5965841, 'auroc': 0.88478196}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1078     0    0   2    0   13    22    19     1   34     1
1      1  1081    0   8    0    1     0   370    12    2    24
2     22     0  114   1  192    8     6    91   278  111   192
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    1   0  207    0     3     1    28    1  1391
5     10     0    2  17    0  350     1     1     5  206     0
6      8     0    0   1    0    0  2939    12    13    1    93
7      1     0    0  26    0    1     1  1133     1    0     1
8      0     0    0  19    0   19     3    24  1301    2     2
9     14     0   65  13    5  144     3   153   134  581    25
10     0     0    0   0   11    0     0     1     0    0  1634
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_18.png
early stop counter: 2
val acc:0.9772903323173523, best validation acc: 0.9795907735824585, corresponding to test acc:                         0.6988735795021057 / 0.7358147501945496
after epoch: 18,now: 2024-07-09 00:52:44.426466,epoch time: 0:30:45.488748,used: 9:21:22.033264,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9788902, 'precision': 0.94823015, 'recall': 0.92065513, 'specificity': 0.9976423, 'f1': 0.9304986, 'auroc': 0.9995565}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     0    0    0     1     1     1    0      8
1     0  1310    0     1    0    0     0    20     1    0      0
2     0     0  292     0    9    0     0     1     1    4      4
3     0     0    0  8349    0    0     0    58    31    0      1
4     4     0   21     0  362    1     0     1    14    1    135
5     0     0    0    32    1  416     0     0     4   68      0
6     4     0    0     1    0    0  1892     0     0    1      9
7     0     7    2    72    0    0     1  7136    38    1      6
8     0     0    1    61    0    0     0    20  3210    0      4
9     0     0   63     7    0   10     0     1     6  406      0
10    4     0    1     7    4    0     1     7    25    1  12742
---- Validation: 
scalar performance:
{'acc': 0.9797512, 'precision': 0.9509767, 'recall': 0.92645174, 'specificity': 0.99773693, 'f1': 0.93512726, 'auroc': 0.99957645}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     1    1    0     0     1     1    0      3
1     0  1317    0     1    0    0     0    14     0    0      0
2     0     0  295     0    6    0     0     4     1    0      6
3     0     1    0  8354    0    3     0    56    26    0      0
4     4     0   18     0  377    0     1     4    12    1    122
5     1     0    4    36    0  410     0     0     5   65      0
6     7     0    0     2    0    1  1890     1     2    1      4
7     0    10    0    79    0    0     0  7142    28    1      5
8     0     0    1    59    0    0     0    21  3202    1     12
9     0     0   56     4    1    6     0     2     2  421      1
10    5     0    3     7    5    0     2     7    23    0  12744
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.721472, 'precision': 0.6720482, 'recall': 0.59442663, 'specificity': 0.971999, 'f1': 0.58329576, 'auroc': 0.87811524}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1008     1    5  21    1    0    43    39    18   16    18
1      2  1208    0  22    0    0     0   227    10    2    28
2     10     0  267   5   77    3     6    63   188   67   329
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    6   1  195    0     2     2    18    0  1409
5     11     0   41  61    0  108     2     1     9  355     4
6      1     0    1   3    0    0  2992     2     1    0    67
7      1     0    0  90    0    0     2  1067     3    0     1
8      0     0    3  46    0    0    11    18  1282    5     5
9     12     2  240  62    4   23     3    76   127  555    33
10     0     0    0   0   15    0     0     1     0    0  1630
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_19.png
better model found
persisted
after epoch: 19,now: 2024-07-09 01:23:24.350712,epoch time: 0:30:39.924246,used: 9:52:01.957510,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9810841, 'precision': 0.95738167, 'recall': 0.9541728, 'specificity': 0.99789625, 'f1': 0.955461, 'auroc': 0.99972755}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    1     0    4    0     6     2     0    0      3
1     0  1306    1     4    0    0     2    19     0    0      0
2     0     0  286     0   21    0     0     0     0    4      1
3     0     0    0  8396    0   10     3    21     9    1      0
4     3     0    3     0  486    0     0     0     2    0     45
5     0     0    0     6    0  498     0     0     0   17      0
6     0     0    0     0    0    2  1902     0     1    0      3
7     0     2    0   183    1    0     2  7063     8    0      3
8     1     1    3   111   13    6     3    30  3096    2     27
9     0     0   26     1    1   32     0     0     2  431      0
10    6     1    2     6   23    0     9     3     5    0  12738
---- Validation: 
scalar performance:
{'acc': 0.97991174, 'precision': 0.95531666, 'recall': 0.9544151, 'specificity': 0.99775696, 'f1': 0.95435697, 'auroc': 0.9997249}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     1    1    0     5     1     0    1      5
1     0  1304    0     5    0    0     0    23     0    0      0
2     0     0  289     0   17    0     0     1     0    4      1
3     1     1    0  8399    0    6     4    22     5    2      0
4     3     0    1     1  489    0     0     0     1    0     44
5     0     0    0     3    0  507     0     0     0   11      0
6     0     0    0     0    0    0  1903     0     0    1      4
7     2     1    4   195    0    0     3  7043    13    1      3
8     1     2    3   117   15    4     3    39  3074    5     33
9     0     0   35     1    1   36     0     0     0  420      0
10    6     0    2     8   25    1     4     5     7    1  12737
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7228014, 'precision': 0.6777924, 'recall': 0.60859543, 'specificity': 0.9721957, 'f1': 0.6205564, 'auroc': 0.8816129}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1015     0    1   15    1    2    94   16     0   17     9
1      2  1111    0   32    1    0     2  315     6    1    29
2     12     0  305   12  284   12    28   32    29   86   215
3      0     0    0    0    0    0     0    0     0    0     0
4      0     0    4    1  304    0     5    1     3    0  1315
5     13     0   12   58    3  277    13    0     0  216     0
6      2     0    0    1    0    0  3040    0     0    0    24
7      1     1    2  208    0    0     6  943     2    0     1
8      0     0    3  179   14   13    33   19  1091    7    11
9     13     0  212   99   10   77    22   32    27  624    21
10     0     0    0    0   22    0     3    0     0    0  1621
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_20.png
better model found
persisted
after epoch: 20,now: 2024-07-09 01:53:55.783676,epoch time: 0:30:31.432964,used: 10:22:33.390474,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97629493, 'precision': 0.9440229, 'recall': 0.92440945, 'specificity': 0.99747574, 'f1': 0.92887574, 'auroc': 0.99965686}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    0    0     2     0     0    1      2
1     0  1315    0     6    0    0     0     5     3    0      3
2     0     0  187     0   22    4     1     1     5   90      2
3     0     0    0  8386    0    8     0    14    30    0      0
4     6     0    1     0  475    0     0     1     7    1     48
5     0     0    0     0    0  520     0     0     0    1      0
6     1     0    0     0    0    2  1902     0     0    0      3
7     0     9    0   242    1    0     4  6856   140    2      5
8     0     0    0    28    2    1     0     6  3249    0     10
9     1     0    0     0    0   99     0     0     0  393      0
10    5     0    1     6   17    2    12     0    22    1  12729
---- Validation: 
scalar performance:
{'acc': 0.97771835, 'precision': 0.9440746, 'recall': 0.9255611, 'specificity': 0.99763656, 'f1': 0.93064046, 'auroc': 0.99960816}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     2    0    0     4     0     0    0      3
1     0  1308    0     7    0    0     0     9     5    0      3
2     0     0  201     1   13    5     0     1     5   85      1
3     0     0    0  8388    0   11     0    15    26    0      0
4     6     0    3     0  461    1     0     1     7    4     56
5     0     0    0     1    0  520     0     0     0    0      0
6     0     0    0     0    0    1  1905     0     0    0      2
7     0     6    0   193    2    0     8  6919   129    0      8
8     1     0    0    23    0    1     0     3  3264    1      3
9     0     0    1     0    0  102     0     0     0  390      0
10    5     0    2     5   19    2    16     3    21    1  12722
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6792136, 'precision': 0.65568995, 'recall': 0.5688244, 'specificity': 0.9679785, 'f1': 0.55073565, 'auroc': 0.8727105}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   920     0   0   35    0   36    82   15    41   34     7
1     4  1167   0   61    1    0    21  142    46    2    55
2    13     0  65   13  133   56    45   14   372  102   202
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   0    1  145    0    22    1    23    2  1439
5     3     0   0   56    0  431     1    0     7   92     2
6     1     0   0    5    0    0  3038    1     2    0    20
7     2     0   0  474    0    1    24  617    44    1     1
8     0     0   0   61    0   13     6    2  1285    1     2
9     8     1  16   98    7  325    17   15   208  417    25
10    0     0   0    0    6    0    15    1     1    0  1623
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_21.png
early stop counter: 1
val acc:0.9777183532714844, best validation acc: 0.979911744594574, corresponding to test acc:                         0.7228013873100281 / 0.7358147501945496
after epoch: 21,now: 2024-07-09 02:24:28.147965,epoch time: 0:30:32.364289,used: 10:53:05.754763,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98410743, 'precision': 0.9666584, 'recall': 0.95059687, 'specificity': 0.9982177, 'f1': 0.95790946, 'auroc': 0.99980897}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    0     0    3    0     3     0     0    0     32
1     0  1292    0     4    0    0     0    35     0    0      1
2     0     0  259     0   13    0     0     2     0   36      2
3     0     1    0  8379    0    2     4    26    24    0      0
4     2     0    1     0  496    0     0     0     3    3     33
5     0     0    0    10    0  482     0     0     0   29      0
6     0     0    0     1    0    0  1888     1     2    0     15
7     0     2    1   106    2    0     2  7095    39    1     15
8     0     0    2    38    1    0     1     9  3223    0     22
9     0     0    9     1    1   11     0     1     0  470      0
10    0     0    2     5   25    0     1     2     7    0  12753
---- Validation: 
scalar performance:
{'acc': 0.9844323, 'precision': 0.96816033, 'recall': 0.95349836, 'specificity': 0.99825263, 'f1': 0.96028423, 'auroc': 0.9998282}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     0    2    0     1     1     0    1     25
1     0  1297    1     4    0    0     0    29     0    0      1
2     0     0  258     0   21    0     0     2     0   29      2
3     0     0    0  8392    0    0     1    28    19    0      0
4     3     0    2     0  499    0     0     0     3    1     31
5     0     0    0    10    1  492     1     0     1   16      0
6     3     0    0     1    0    0  1884     1     1    1     17
7     1     0    1   108    0    0     1  7086    49    0     19
8     0     0    3    48    2    0     1     9  3219    0     14
9     0     0    7     4    0   12     0     2     0  468      0
10    0     0    0     5   30    0     0     2     4    0  12755
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67795426, 'precision': 0.6441829, 'recall': 0.5561899, 'specificity': 0.96747917, 'f1': 0.5556866, 'auroc': 0.87392396}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   708     2   1   31    2    6   176    95    19   69    61
1     1  1053   0   35    0    0     4   314    11    1    80
2     9     0  74   14  193    7    27    28   186  104   373
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    1  387    0     2     1     9    1  1232
5     3     0   2  116    1  173    25     0     4  265     3
6     0     0   0    1    1    0  2832     3     4    0   226
7     0     0   0  114    0    0     2  1038     5    0     5
8     0     0   0   84    0    3    24    10  1235    2    12
9    10     0  81  136   11   65    32    49   122  593    38
10    0     0   0    0   49    0     0     0     0    0  1597
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_22.png
better model found
persisted
after epoch: 22,now: 2024-07-09 02:55:10.344375,epoch time: 0:30:42.196410,used: 11:23:47.951173,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.981753, 'precision': 0.95161533, 'recall': 0.9679867, 'specificity': 0.9980824, 'f1': 0.959176, 'auroc': 0.9997781}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    0    0     2     0     0    0      1
1     0  1327    0     0    0    0     0     4     0    0      0
2     0     0  305     0    3    0     0     0     0    4      0
3     0     8    0  8168    0    2     0   200    57    1      0
4     6     0   17     0  487    0     0     1     1    1     26
5     0     0    1     4    0  481     1     0     2   32      0
6     5     1    0     0    2    0  1899     0     0    0      1
7     1    16    2    16    0    0     1  7209    16    0      3
8     0     2    1    15    5    0     2    49  3215    0      5
9     0     0   26     1    1    3     1     2     0  459      0
10   19     7    4     1   65    0    18     7    10    0  12664
---- Validation: 
scalar performance:
{'acc': 0.98146313, 'precision': 0.94996834, 'recall': 0.96844643, 'specificity': 0.99805695, 'f1': 0.95852137, 'auroc': 0.99978024}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    1     0    0    0     1     1     0    0      0
1     0  1327    0     0    0    0     0     5     0    0      0
2     0     0  307     0    2    0     0     0     0    3      0
3     0    10    0  8165    0    7     2   198    57    1      0
4     5     1   19     0  490    0     1     1     4    0     18
5     0     0    1     5    0  478     1     0     3   33      0
6     2     0    0     0    0    0  1904     0     1    0      1
7     0    17    2    21    0    0     1  7207    12    0      5
8     0     0    3    13    6    0     3    39  3220    0     12
9     0     0   25     1    0    7     1     0     1  458      0
10   22    12    5     2   61    0    17     8    13    0  12656
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.76673895, 'precision': 0.6879175, 'recall': 0.65254664, 'specificity': 0.976343, 'f1': 0.64318645, 'auroc': 0.8846837}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1003     3    2   5    2    5    54    34     5   53     4
1      0  1363    0   4    0    0     3   117    10    0     2
2     13     1  333   2  121   10    45    80   162   71   177
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0   12   0  282    0    21     2    15    0  1301
5      7     0   10  33    0  299    11     1    13  217     1
6      3     0    0   0    0    0  3055     2     1    0     6
7      0     2    0   3    0    0     3  1152     2    1     1
8      0     1    5  17    1    1    20    22  1297    5     1
9      6     3  222  20    4   94     9    80   120  558    21
10     0     2    0   0   23    0     3     1     0    0  1617
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_23.png
new oracle model saved
early stop counter: 1
val acc:0.9814631342887878, best validation acc: 0.9844322800636292, corresponding to test acc:                         0.6779542565345764 / 0.7667389512062073
after epoch: 23,now: 2024-07-09 03:25:50.961529,epoch time: 0:30:40.617154,used: 11:54:28.568327,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9825824, 'precision': 0.95293945, 'recall': 0.9434326, 'specificity': 0.9981609, 'f1': 0.9439843, 'auroc': 0.9997602}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    1    0     0     2     1    0      5
1     0  1322    0     0    0    0     0     9     1    0      0
2     0     0  303     0    1    0     0     4     1    3      0
3     0     0    0  8339    0    2     0    63    31    1      1
4     6     1   27     1  443    0     0     4    19    2     36
5     0     0    1     9    0  367     0     0     3  141      0
6     4     0    0     0    0    0  1887     1     7    0      8
7     1     3    0    45    0    0     0  7203    10    0      1
8     0     0    0    26    0    0     1    54  3212    0      2
9     0     0   15     0    0    0     0     0     0  478      0
10    9     0    3     4   11    0     1    20    49    0  12697
---- Validation: 
scalar performance:
{'acc': 0.9816771, 'precision': 0.94678605, 'recall': 0.9383285, 'specificity': 0.99808156, 'f1': 0.93756926, 'auroc': 0.99974364}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    1     0    0    0     2     0     0    1      4
1     0  1315    0     2    0    0     0    14     1    0      0
2     0     0  300     0    0    0     0     5     2    5      0
3     2     1    0  8352    0    0     0    56    29    0      0
4     8     0   34     0  439    0     0     3    20    1     34
5     0     0    0    12    0  352     0     1     3  153      0
6     2     0    0     0    0    0  1894     1     3    0      8
7     0     5    0    52    0    0     0  7201     7    0      0
8     1     1    0    25    2    0     0    51  3214    0      2
9     0     0   18     0    0    0     0     2     0  473      0
10   11     1    5     4   18    0     1    16    55    0  12685
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.735255, 'precision': 0.6859183, 'recall': 0.6015072, 'specificity': 0.9733837, 'f1': 0.5795273, 'auroc': 0.88307416}
confusion matrix:
      0     1    2   3    4   5     6     7     8    9     10
0   1016     0    0  11    0   0    31    69     9   12    22
1      1  1381    0  11    0   0     1    91     7    0     7
2     26     1  142  14   90   2    16   155   328   82   159
3      0     0    0   0    0   0     0     0     0    0     0
4      0     0    1   0  259   0     5     8    54    0  1306
5     23     0    2  95    0  89     9     4    26  336     8
6      9     0    0   0    0   0  3021     2     2    0    33
7      1     0    0  25    0   0     3  1134     0    0     1
8      0     0    0  50    0   0     7    51  1258    4     0
9     23     5   73  96    2  14    12   182   120  583    27
10     0     1    0   0   16   0     1     2     0    0  1626
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_24.png
early stop counter: 2
val acc:0.9816771149635315, best validation acc: 0.9844322800636292, corresponding to test acc:                         0.6779542565345764 / 0.7667389512062073
after epoch: 24,now: 2024-07-09 03:56:21.660738,epoch time: 0:30:30.699209,used: 12:24:59.267536,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98062927, 'precision': 0.9602924, 'recall': 0.9571459, 'specificity': 0.99788946, 'f1': 0.9582467, 'auroc': 0.9997505}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    3    0     6     0     0    1      2
1     0  1303    0     3    0    0     0    26     0    0      0
2     0     0  275     0   19    0     0     4     1   12      1
3     0     1    0  8255    0    4     0   153    24    0      1
4     3     0    2     0  514    1     0     1     2    0     15
5     0     0    0     9    0  461     0     0     3   48      0
6     0     0    0     2    0    0  1906     0     0    0      0
7     0     3    0   139    2    0     1  7107     9    0      3
8     1     0    0    24    6    0     3    65  3178    0     18
9     0     0   20     1    1    6     1     1     0  463      0
10    3     1    0     6   35    1    20     3     4    0  12719
---- Validation: 
scalar performance:
{'acc': 0.9806072, 'precision': 0.9632387, 'recall': 0.9563827, 'specificity': 0.99786836, 'f1': 0.95937216, 'auroc': 0.9997302}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     2    3    0     5     0     1    0      5
1     0  1298    0     6    0    0     0    28     0    0      0
2     1     0  273     2   16    0     0     5     0   13      2
3     0     0    0  8251    0    0     0   162    26    0      1
4     2     0    2     0  511    0     0     2     3    1     18
5     0     0    0     3    0  469     0     0     2   46      1
6     1     0    0     4    0    0  1901     0     1    0      1
7     0     0    0   131    1    0     1  7120     8    0      4
8     0     1    0    21    2    0     0    69  3185    0     18
9     0     0   15     2    1   11     0     0     0  464      0
10    3     1    0     7   37    0    15     8     4    0  12721
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7443504, 'precision': 0.66648453, 'recall': 0.6239463, 'specificity': 0.9741231, 'f1': 0.61894447, 'auroc': 0.8804736}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1021     1    0   22    0   15    63    19     1   20     8
1      2  1364    0   12    0    0     3   109     3    2     4
2     14     7  113   10  362    8    56    90    85   93   177
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    0    1  292    0    41     1     5    1  1292
5      5     1    0   48    4  279     3     0     7  244     1
6      1     0    0    0    1    0  3063     0     1    0     1
7      0     3    2  140    0    0     5  1006     1    5     2
8      0     1    0   68    5    3    34    16  1223   14     6
9     13     9  106   41   30   68    20    99    64  661    26
10     0     2    0    0   14    0    13     0     0    0  1617
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_25.png
early stop counter: 3
val acc:0.9806072115898132, best validation acc: 0.9844322800636292, corresponding to test acc:                         0.6779542565345764 / 0.7667389512062073
after epoch: 25,now: 2024-07-09 04:26:49.420813,epoch time: 0:30:27.760075,used: 12:55:27.027611,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98571277, 'precision': 0.9643401, 'recall': 0.9678528, 'specificity': 0.9984457, 'f1': 0.965996, 'auroc': 0.9997748}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    1     0    0    0     1     0     0    0      1
1     0  1313    0     2    0    1     2    10     2    0      1
2     0     0  290     0    5    0     0     2     1   13      1
3     0     0    0  8347    0    9     3    41    36    1      0
4     5     0    8     0  496    0     0     4     3    0     23
5     0     0    0     8    0  482     0     0     5   25      1
6     3     0    0     0    0    0  1898     0     1    0      5
7     2     8    1   111    0    0     6  7110    19    1      6
8     0     0    1    22    0    0     2    13  3227    0     29
9     0     0   13     0    1    9     0     0     0  470      0
10   13     0    0     1   40    0     2     5     5    0  12729
---- Validation: 
scalar performance:
{'acc': 0.98496723, 'precision': 0.9655868, 'recall': 0.96647584, 'specificity': 0.9983455, 'f1': 0.96589756, 'auroc': 0.9997766}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    2     1    2    0     0     0     0    0      1
1     0  1318    0     2    0    0     0     9     2    0      1
2     0     0  282     0    5    1     0     5     1   15      3
3     5     1    0  8346    0    9     0    34    41    3      1
4     5     0    2     0  493    0     0     1     3    0     35
5     0     0    0     6    0  496     0     0     0   18      1
6     4     0    0     0    0    0  1901     0     0    0      3
7     6     8    2   119    0    0     6  7102    16    0      6
8     1     0    0    32    0    0     2    14  3214    2     31
9     0     0   10     3    1    5     1     2     2  469      0
10   10     0    0     4   38    0     7     6     5    1  12725
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7074092, 'precision': 0.64991164, 'recall': 0.59257674, 'specificity': 0.9705794, 'f1': 0.5864845, 'auroc': 0.87671256}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   955     1    2   23    0    9   103    24    19   25     9
1     7  1205    0   17    0    1     1   230    15    0    23
2    12     0  131    9  216   13    24    78   241   43   248
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    2    1  341    0     3     2    12    0  1271
5     2     0   13   99    1  297    10     0    16  151     3
6    14     0    0   11    0    0  2907     2     9    0   124
7     4     0    0  146    0    0     5  1004     4    0     1
8     0     0    0   65    1    3    12    20  1264    1     4
9    10     1  102  106   17  126    19   120   215  391    30
10    0     0    0    0   27    0     2     1     0    0  1616
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_26.png
better model found
persisted
after epoch: 26,now: 2024-07-09 04:57:27.898233,epoch time: 0:30:38.477420,used: 13:26:05.505031,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9845355, 'precision': 0.9663861, 'recall': 0.9649126, 'specificity': 0.9983064, 'f1': 0.9653575, 'auroc': 0.9998435}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     1    1    0     1     1     2    0      6
1     0  1321    0     2    0    0     0     9     0    0      0
2     0     0  296     0    3    0     0     8     1    4      0
3     1     0    0  8249    0   10     1   153    21    1      1
4     5     0    4     0  504    1     0     1     4    1     19
5     0     0    0     6    0  498     0     0     1   16      0
6     4     0    0     0    1    0  1883     1     4    0     15
7     0     8    1    10    0    0     0  7242     1    0      0
8     1     1    2    12    5    3     0   108  3147    1     16
9     0     0   35     1    0    8     0     5     3  441      0
10    4     0    1     0   16    0     1    16     9    0  12746
---- Validation: 
scalar performance:
{'acc': 0.98478, 'precision': 0.96574944, 'recall': 0.96472466, 'specificity': 0.99833536, 'f1': 0.96494174, 'auroc': 0.99982125}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    1    0     2     1     1    0      7
1     0  1322    0     2    0    0     0     8     0    0      0
2     0     1  299     0    0    0     0     7     0    2      3
3     1     1    0  8272    0    7     0   137    20    0      2
4     7     0    3     0  507    0     0     0     3    0     19
5     0     0    2     6    0  487     0     0     1   25      0
6     2     0    0     0    1    0  1889     3     2    1     10
7     0     7    0    15    0    0     0  7243     0    0      0
8     0     0    1    14    6    3     0   106  3150    0     16
9     1     0   35     0    1    8     0     8     0  440      0
10    1     0    1     3   25    1     0    11    18    0  12736
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7202127, 'precision': 0.6277716, 'recall': 0.60956913, 'specificity': 0.9717723, 'f1': 0.5885842, 'auroc': 0.875399}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   949     0    1   4    8    6    40    89    10   22    41
1     0  1296    0  10    0    0     0   180     2    0    11
2     9     4  116   2  324   20     2   151   118   52   217
3     0     0    0   0    0    0     0     0     0    0     0
4     0     1    1   0  247    0     3     6    10    1  1364
5     8     0    7  34    2  336     5     5     4  191     0
6    14     0    0   1    2    0  2913    11     4    0   122
7     0     0    0   6    0    1     1  1154     1    0     1
8     1     0    0  21    2   12     5    67  1257    3     2
9    15     6  142  26   36  153     3   254    78  393    31
10    0     0    0   0   10    0     0     2     1    0  1633
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_27.png
early stop counter: 1
val acc:0.9847800135612488, best validation acc: 0.9849672317504883, corresponding to test acc:                         0.7074092030525208 / 0.7667389512062073
after epoch: 27,now: 2024-07-09 05:28:06.808374,epoch time: 0:30:38.910141,used: 13:56:44.415172,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98571277, 'precision': 0.9583746, 'recall': 0.9636265, 'specificity': 0.99844193, 'f1': 0.96067, 'auroc': 0.99977946}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     0    5    0     1     1     0    1      4
1     0  1315    0     2    1    0     0    10     4    0      0
2     0     0  287     0   15    0     0     0     0    6      3
3     0     0    1  8339    0   17     0    39    39    3      1
4     2     0    3     1  509    1     0     0     0    0     23
5     0     0    1     0    0  506     0     0     1   13      0
6     0     0    1     1    0    1  1896     0     0    1      7
7     0     2    5    58    5    1     2  7153    30    2      6
8     0     0    2    19   15    2     0    15  3169    9     64
9     0     0   22     0    0   40     0     0     1  430      0
10    0     0    1     2   17    0     3     1     1    0  12767
---- Validation: 
scalar performance:
{'acc': 0.98598367, 'precision': 0.9589734, 'recall': 0.9657965, 'specificity': 0.99846816, 'f1': 0.9620379, 'auroc': 0.99981475}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     0    4    0     6     0     0    1      8
1     0  1314    0     2    0    1     0    15     0    0      0
2     0     0  289     0   13    0     0     0     0    6      4
3     0     1    0  8334    0   22     1    51    24    5      2
4     2     0    2     0  519    0     0     0     0    0     16
5     0     0    1     4    0  504     0     0     0   12      0
6     3     0    0     0    0    0  1900     0     0    0      5
7     0     1    4    55    3    0     1  7154    32    2     13
8     0     0    7    11   23    1     0     6  3177    8     63
9     0     0   17     0    1   35     0     0     0  439      1
10    0     0    1     1   20    1     4     1     1    0  12767
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7460995, 'precision': 0.670094, 'recall': 0.6260892, 'specificity': 0.97417974, 'f1': 0.6291961, 'auroc': 0.8786727}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   931     0    9   6    3    7   118     7     3   60    26
1     2  1200   10  13    2    7    30   180    13    7    35
2     2     2  348   1  329    4     6     8    46   65   204
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    3   0  366    0     4     0     2    1  1257
5     1     0   40  19    0  214    13     0     4  301     0
6     1     0    0   0    0    0  3046     0     1    0    19
7     0     0   19  14    1    1     9  1110     5    4     1
8     0     0   26  15   32   23    37     7  1191   22    17
9     4     0  338   7   14   50     9    14    32  641    28
10    0     0    0   0   27    0     1     1     0    0  1617
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_28.png
better model found
persisted
after epoch: 28,now: 2024-07-09 05:58:38.816501,epoch time: 0:30:32.008127,used: 14:27:16.423299,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98434824, 'precision': 0.9525275, 'recall': 0.9635638, 'specificity': 0.99831784, 'f1': 0.9562767, 'auroc': 0.99978346}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    1    0     2     0     0    0      5
1     0  1331    0     0    0    0     0     1     0    0      0
2     0     0  310     0    0    0     0     0     0    2      0
3     2    13    0  8346    0    2     2    61     9    1      1
4     6     0   46     0  475    0     0     0     0    0     12
5     1     0    1     4    0  479     0     0     2   33      1
6     3     0    0     2    0    0  1897     1     0    0      5
7     4    54    3    57    0    0     1  7116    14    0     13
8     1     2    5    38   10    0     2    35  3153    0     50
9     0     0   42     1    0    4     0     0     0  446      0
10    4     1    2     0   16    0     4     0     3    0  12763
---- Validation: 
scalar performance:
{'acc': 0.9841648, 'precision': 0.95409817, 'recall': 0.9638193, 'specificity': 0.99828005, 'f1': 0.9571314, 'auroc': 0.99978936}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    1    0     2     0     0    0      4
1     0  1332    0     0    0    0     0     0     0    0      0
2     0     0  311     0    0    0     0     0     0    1      0
3     2     9    1  8347    0    1     0    70     8    1      1
4     7     0   45     0  473    0     0     0     1    0     13
5     3     0    2    10    0  476     0     0     1   29      0
6     4     0    0     0    0    0  1899     0     1    0      4
7     3    44    2    55    0    0     0  7140     6    0     15
8     0     3    4    55    8    0     3    39  3130    0     54
9     2     0   38     0    0    1     0     1     0  451      0
10    6     2    5     0   19    0     5     0     1    0  12758
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7374239, 'precision': 0.663449, 'recall': 0.61582637, 'specificity': 0.9735681, 'f1': 0.60562396, 'auroc': 0.88372743}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1108     0    1   7    0    2    24     4     3   10    11
1      3  1281    3  10    0    1     6   169     8    2    16
2     25     2  314  12  110   10    23    35   184   57   243
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    8   0  165    0     6     1    12    0  1441
5     23     1    8  70    1  184    11     0    12  277     5
6      4     0    0   1    0    0  3040     0     2    0    20
7      7     0    0  61    0    0     1  1088     6    0     1
8      1     3    1  73    1    4    16    13  1250    5     3
9     25     3  248  80    2   72    23    50   119  482    33
10     0     0    0   0   15    0     3     0     0    0  1628
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_29.png
early stop counter: 1
val acc:0.9841647744178772, best validation acc: 0.985983669757843, corresponding to test acc:                         0.7460994720458984 / 0.7667389512062073
after epoch: 29,now: 2024-07-09 06:29:21.931645,epoch time: 0:30:43.115144,used: 14:57:59.538443,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9875054, 'precision': 0.9624847, 'recall': 0.9703928, 'specificity': 0.998693, 'f1': 0.96612006, 'auroc': 0.99987125}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    1    0     1     1     0    0      4
1     0  1319    0     1    1    0     0    10     1    0      0
2     0     0  282     0    9    2     0     1     0   17      1
3     1     0    0  8291    0   33     0    44    63    2      4
4     5     0    1     0  517    0     1     0     0    0     15
5     0     0    0     1    0  508     0     0     0   12      0
6     1     0    0     1    0    0  1900     1     0    0      5
7     0     1    3    34    1    0     0  7184    33    5      3
8     1     0    0    10    4    2     2    14  3243    1     17
9     1     0   10     0    1   28     2     0     1  450      0
10    4     0    1     0   34    0     1     3    10    0  12740
---- Validation: 
scalar performance:
{'acc': 0.98780257, 'precision': 0.9626477, 'recall': 0.96987, 'specificity': 0.99873567, 'f1': 0.9656409, 'auroc': 0.9998565}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    2    0     1     0     0    0      4
1     0  1322    0     0    0    0     0    10     0    0      0
2     0     0  272     0   13    2     0     1     1   23      0
3     1     0    0  8278    0   41     1    47    62    5      5
4     6     0    2     0  516    0     0     0     3    1     11
5     0     0    0     0    0  515     0     0     0    6      0
6     2     0    0     0    0    0  1903     2     0    0      1
7     0     2    1    27    3    0     0  7198    28    3      3
8     0     0    0    11    4    5     0    12  3246    2     16
9     0     0    6     1    0   27     1     0     2  455      1
10    0     0    1     0   32    0     3     3     9    0  12748
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7120269, 'precision': 0.6401516, 'recall': 0.5855119, 'specificity': 0.970628, 'f1': 0.5756012, 'auroc': 0.8735399}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   781     2    1  13    4   10   151    60    33   75    40
1     2  1048    0   8    1    1    16   350    19    3    51
2    14     0  137   1  286    4    60    41   199   71   202
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  372    0    11     2    16    1  1230
5     3     0    7  18    2  184    21     3    13  338     3
6     1     0    0   1    0    0  3037     1     3    0    24
7     1     0    1  22    0    2     3  1103    15   15     2
8     0     0    0  11    3    4    50    13  1277    5     7
9     9     0   95  18   16   85    37    48   177  628    24
10    0     0    0   0   36    0     0     0     0    0  1610
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_30.png
better model found
persisted
after epoch: 30,now: 2024-07-09 06:59:51.722410,epoch time: 0:30:29.790765,used: 15:28:29.329208,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:28:29.329208 at 2024-07-09 06:59:51.722410
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7120269, 'precision': 0.6401516, 'recall': 0.5855119, 'specificity': 0.970628, 'f1': 0.5756012, 'auroc': 0.8735399}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   781     2    1  13    4   10   151    60    33   75    40
1     2  1048    0   8    1    1    16   350    19    3    51
2    14     0  137   1  286    4    60    41   199   71   202
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  372    0    11     2    16    1  1230
5     3     0    7  18    2  184    21     3    13  338     3
6     1     0    0   1    0    0  3037     1     3    0    24
7     1     0    1  22    0    2     3  1103    15   15     2
8     0     0    0  11    3    4    50    13  1277    5     7
9     9     0   95  18   16   85    37    48   177  628    24
10    0     0    0   0   36    0     0     0     0    0  1610
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.76673895, 'precision': 0.6879175, 'recall': 0.65254664, 'specificity': 0.976343, 'f1': 0.64318645, 'auroc': 0.8846837}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1003     3    2   5    2    5    54    34     5   53     4
1      0  1363    0   4    0    0     3   117    10    0     2
2     13     1  333   2  121   10    45    80   162   71   177
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0   12   0  282    0    21     2    15    0  1301
5      7     0   10  33    0  299    11     1    13  217     1
6      3     0    0   0    0    0  3055     2     1    0     6
7      0     2    0   3    0    0     3  1152     2    1     1
8      0     1    5  17    1    1    20    22  1297    5     1
9      6     3  222  20    4   94     9    80   120  558    21
10     0     2    0   0   23    0     3     1     0    0  1617
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_15_31_22_seed_1_21716735_instance_wise_predictions.txt
accuracy from prediction file 0.7120268662981879
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456107 KiB |   6809 MiB |   2937 TiB |   2937 TiB |
|       from large pool | 412856 KiB |   6773 MiB |   2901 TiB |   2901 TiB |
|       from small pool |  43251 KiB |     62 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456107 KiB |   6809 MiB |   2937 TiB |   2937 TiB |
|       from large pool | 412856 KiB |   6773 MiB |   2901 TiB |   2901 TiB |
|       from small pool |  43251 KiB |     62 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 449054 KiB |   6803 MiB |   2934 TiB |   2934 TiB |
|       from large pool | 407075 KiB |   6767 MiB |   2898 TiB |   2898 TiB |
|       from small pool |  41979 KiB |     60 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7502 MiB |   7502 MiB |  14130 MiB |   6628 MiB |
|       from large pool |   7438 MiB |   7438 MiB |  14050 MiB |   6612 MiB |
|       from small pool |     64 MiB |     64 MiB |     80 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 465492 KiB | 703689 KiB |   2236 TiB |   2236 TiB |
|       from large pool | 459592 KiB | 694533 KiB |   2200 TiB |   2200 TiB |
|       from small pool |   5900 KiB |  40275 KiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4556    |    6799    |  488231 K  |  488227 K  |
|       from large pool |     187    |     783    |  271105 K  |  271105 K  |
|       from small pool |    4369    |    6537    |  217125 K  |  217121 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4556    |    6799    |  488231 K  |  488227 K  |
|       from large pool |     187    |     783    |  271105 K  |  271105 K  |
|       from small pool |    4369    |    6537    |  217125 K  |  217121 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     343    |     343    |     624    |     281    |
|       from large pool |     311    |     311    |     584    |     273    |
|       from small pool |      32    |      32    |      40    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      66    |    1621    |  298389 K  |  298389 K  |
|       from large pool |      41    |     312    |  186203 K  |  186203 K  |
|       from small pool |      25    |    1584    |  112185 K  |  112185 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6809 MiB |   2937 TiB |   2937 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   2901 TiB |   2901 TiB |
|       from small pool |      0 KiB |     62 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6809 MiB |   2937 TiB |   2937 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   2901 TiB |   2901 TiB |
|       from small pool |      0 KiB |     62 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6803 MiB |   2934 TiB |   2934 TiB |
|       from large pool |  16640 KiB |   6767 MiB |   2898 TiB |   2898 TiB |
|       from small pool |      0 KiB |     60 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    900 MiB |   7502 MiB |  14130 MiB |  13230 MiB |
|       from large pool |    852 MiB |   7438 MiB |  14050 MiB |  13198 MiB |
|       from small pool |     48 MiB |     64 MiB |     80 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 703689 KiB |   2236 TiB |   2236 TiB |
|       from large pool |  24320 KiB | 694533 KiB |   2200 TiB |   2200 TiB |
|       from small pool |      0 KiB |  40275 KiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6799    |  488231 K  |  488231 K  |
|       from large pool |       2    |     783    |  271105 K  |  271105 K  |
|       from small pool |       0    |    6537    |  217125 K  |  217125 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6799    |  488231 K  |  488231 K  |
|       from large pool |       2    |     783    |  271105 K  |  271105 K  |
|       from small pool |       0    |    6537    |  217125 K  |  217125 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     343    |     624    |     561    |
|       from large pool |      39    |     311    |     584    |     545    |
|       from small pool |      24    |      32    |      40    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1621    |  298390 K  |  298390 K  |
|       from large pool |       3    |     312    |  186203 K  |  186203 K  |
|       from small pool |       0    |    1584    |  112186 K  |  112186 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6809 MiB |   2937 TiB |   2937 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   2901 TiB |   2901 TiB |
|       from small pool |      0 KiB |     62 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6809 MiB |   2937 TiB |   2937 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   2901 TiB |   2901 TiB |
|       from small pool |      0 KiB |     62 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6803 MiB |   2934 TiB |   2934 TiB |
|       from large pool |  16640 KiB |   6767 MiB |   2898 TiB |   2898 TiB |
|       from small pool |      0 KiB |     60 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    900 MiB |   7502 MiB |  14130 MiB |  13230 MiB |
|       from large pool |    852 MiB |   7438 MiB |  14050 MiB |  13198 MiB |
|       from small pool |     48 MiB |     64 MiB |     80 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 703689 KiB |   2236 TiB |   2236 TiB |
|       from large pool |  24320 KiB | 694533 KiB |   2200 TiB |   2200 TiB |
|       from small pool |      0 KiB |  40275 KiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6799    |  488231 K  |  488231 K  |
|       from large pool |       2    |     783    |  271105 K  |  271105 K  |
|       from small pool |       0    |    6537    |  217125 K  |  217125 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6799    |  488231 K  |  488231 K  |
|       from large pool |       2    |     783    |  271105 K  |  271105 K  |
|       from small pool |       0    |    6537    |  217125 K  |  217125 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     343    |     624    |     561    |
|       from large pool |      39    |     311    |     584    |     545    |
|       from small pool |      24    |      32    |      40    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1621    |  298390 K  |  298390 K  |
|       from large pool |       3    |     312    |  186203 K  |  186203 K  |
|       from small pool |       0    |    1584    |  112186 K  |  112186 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735

 Experiment start at: 2024-07-09 07:12:35.736638
before training, model accuracy: 0.08185825496912003
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91869116, 'precision': 0.85263884, 'recall': 0.71842015, 'specificity': 0.9907214, 'f1': 0.7544073, 'auroc': 0.99287444}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   286     0   0    22    3    0     7    24     2    9    130
1     0  1180   0    24    0    0     0   123     3    0      2
2     0     0  33     7  150    0     1    47     7   56     11
3     0     0   0  7946    1    3     0   422    66    0      0
4     1     0   1     3  292    1     0    14    26    3    198
5     1     0   0   108    4  265     0     1     8  132      2
6    14     1   0    48    8    0  1664    18    14    5    135
7     0     9   0   210    2    0     1  7002    27    1     13
8     0     0   0   346   11    0     0   207  2674    1     57
9     1     1  10    37   24   39     0    29     8  340      4
10    1     1   0    10   40    0     4    41    37    1  12655
---- Validation: 
scalar performance:
{'acc': 0.91790825, 'precision': 0.83951944, 'recall': 0.7120291, 'specificity': 0.9906393, 'f1': 0.7476054, 'auroc': 0.9926882}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   281     0   0    25    3    1     6    19     5   10    133
1     0  1185   0    24    0    0     0   118     3    0      2
2     0     1  30     1  162    2     1    49     8   54      4
3     0     0   0  7945    0    5     0   425    63    0      2
4     1     0   0     4  290    0     0    19    32    4    189
5     0     0   1   108    3  259     0     0     6  143      1
6    15     0   0    47   12    0  1648    22    11    3    150
7     0     3   0   199    2    0     0  7020    29    0     12
8     0     0   0   337   13    0     0   208  2667    0     71
9     1     1  15    43   25   40     0    32     8  325      3
10    0     0   0     7   38    0     7    46    28    4  12666
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5007346, 'precision': 0.57056975, 'recall': 0.4548453, 'specificity': 0.9497071, 'f1': 0.42860448, 'auroc': 0.8589913}
confusion matrix:
     0     1   2    3    4    5    6     7     8    9     10
0   573     1   0   89    2    0    1   233    35   29   207
1     0  1109   0   27    0    0    0   343     2    0    18
2     1     1   0   23  137    1    0   296    81   70   405
3     0     0   0    0    0    0    0     0     0    0     0
4     0     0   0    0   54    0    0     5     6    0  1568
5     2     0   0  176    1  115    0     3     9  281     5
6     0     1   0    8   14    0  858    19    19    0  2148
7     0     0   0   12    0    0    0  1149     0    0     3
8     0     0   0  134    1    0    0    60  1167    1     7
9     2     2   0  137    9   13    1   391    37  487    58
10    0     0   0    0    0    0    0     1     0    0  1645
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-09 07:44:10.256136,epoch time: 0:31:34.519498,used: 0:31:34.519498,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.92875105, 'precision': 0.8427887, 'recall': 0.8048953, 'specificity': 0.9925202, 'f1': 0.81342256, 'auroc': 0.9954805}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   321     1    0    15    1    2    90    10     2    8     33
1     0  1265    0    13    0    0     0    52     2    0      0
2     0     2  123     2   29    3     1    21    17  114      0
3     0     2    0  7918    0   10     0   377   130    0      0
4     1     5   19     0  324    2     6    11    65   14     92
5     0     0    0    39    0  439     0     1     9   32      1
6     3     0    0     9    1    1  1875     6     5    1      7
7     0    18    0   108    1    0     1  7091    41    0      3
8     0     2    0    97    5    2     2   150  3027    2      7
9     1     2    5     8    2  125     1    10    20  318      0
10    8   257    4     7  125    3   125   101   150    3  12012
---- Validation: 
scalar performance:
{'acc': 0.92900896, 'precision': 0.84329367, 'recall': 0.8034334, 'specificity': 0.99251103, 'f1': 0.814129, 'auroc': 0.9954791}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   323     0    0     9    0    1    92    11     8    6     33
1     0  1268    0    12    0    0     0    47     5    0      0
2     0     1  125     2   28    3     2    30    15  106      0
3     0     0    0  7898    0    8     0   417   117    0      0
4     1     5   23     1  307    3     7    17    63   12    100
5     1     0    0    30    0  434     0     0    11   44      1
6     2     0    0     9    2    0  1879     1     6    0      9
7     0    22    0   115    1    0     2  7077    44    0      4
8     0     2    0   101    6    3     5   145  3020    3     11
9     0     1   11    12    0  115     2    10    17  325      0
10    6   240    3     7  113    1   121    97   132    1  12075
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66669, 'precision': 0.6637186, 'recall': 0.55708206, 'specificity': 0.9665805, 'f1': 0.52254206, 'auroc': 0.8753952}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   622     0   0  104    0   27   308    37    38   26     8
1     0  1221   0   38    0    0     0   236     3    0     1
2     1     3  15   28   65   30     2   218   453   94   106
3     0     0   0    0    0    0     0     0     0    0     0
4     0    14   0    0  118    0     2    16    98    1  1384
5     2     0   0  139    0  409     0     0    21   21     0
6     0     0   0   11    2    0  2949     7    13    0    85
7     0     1   0   54    0    0     0  1108     0    0     1
8     0     0   0  113    0    1     2    20  1234    0     0
9     1    11   2  246    0  184     1   177   276  235     4
10    0     8   0    0    8    0     2     4     6    0  1618
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-09 08:14:39.234152,epoch time: 0:30:28.978016,used: 1:02:03.497514,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93605524, 'precision': 0.85977364, 'recall': 0.81983066, 'specificity': 0.99305266, 'f1': 0.82908654, 'auroc': 0.99651384}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     4    0    0     2     7     1    0      5
1     0  1260    0     9    0    0     0    57     4    0      2
2     8     0  124     1   59    1     1    61     9   42      6
3     3     0    0  7783    0    6     0   572    73    1      0
4    22     0   10     1  302    1     4    19    39    4    137
5     4     0    0    51    1  412     0     2    10   39      1
6    28     0    1     5    0    1  1857     8     4    0      4
7     1     8    0    91    1    0     1  7125    29    0      6
8     3     1    1   159    6    2     0   180  2920    1     21
9    21     0   22    14    1   87     0    30     8  309      1
10  167     0    0     7   47    2    26    50    66    0  12430
---- Validation: 
scalar performance:
{'acc': 0.9369533, 'precision': 0.86036885, 'recall': 0.8184641, 'specificity': 0.9931333, 'f1': 0.82920355, 'auroc': 0.99649066}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     3    0    0     4     5     1    0      7
1     0  1247    0     8    0    0     0    73     2    0      2
2    10     0  128     1   49    2     4    54    11   47      6
3     3     2    0  7812    0    5     1   548    68    1      0
4    20     0   11     1  299    2     2    17    37    7    143
5     5     0    0    48    0  416     0     4     7   40      1
6    22     0    0     4    0    0  1861     7     3    1     10
7     0    11    0    89    1    0     1  7137    22    0      4
8     3     0    0   160    5    1     0   191  2913    0     23
9    23     0   27    13    2   90     2    29     9  298      0
10  159     0    0     7   38    0    26    50    60    2  12454
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70125234, 'precision': 0.64120406, 'recall': 0.5865083, 'specificity': 0.9699335, 'f1': 0.5499532, 'auroc': 0.87771606}
confusion matrix:
      0     1   2   3   4    5     6     7     8    9     10
0   1142     0   0   6   0    0     8    11     1    1     1
1      5  1198   0  16   0    0     0   269     1    0    10
2     89     0  17  10  69    3     4   208   119   39   457
3      0     0   0   0   0    0     0     0     0    0     0
4      3     0   0   0  61    0     1     2     5    0  1561
5     35     0   0  92   0  275     1     7    29  149     4
6      4     0   0   2   0    0  2956     2     1    0   102
7      0     0   0   8   0    0     0  1155     0    0     1
8      0     0   0  65   0    0     5    67  1223    1     9
9    107     4  21  51   2   31     4   419    96  354    48
10     0     0   0   0   2    0     1     1     0    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-09 08:45:22.074879,epoch time: 0:30:42.840727,used: 1:32:46.338241,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9375803, 'precision': 0.88243365, 'recall': 0.84754646, 'specificity': 0.9930672, 'f1': 0.862635, 'auroc': 0.9971875}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   424     0    0     3    0    0    12    10     0    1     33
1     0  1269    0     8    0    0     0    54     1    0      0
2     3     0  214     0   26    1     2    24     1   37      4
3     1     1    0  7688    0    7     0   689    49    1      0
4     4     1   24     0  334    1     4    12     3    8    148
5     1     0    0    42    1  382     1     1     3   89      1
6     5     1    0     3    0    1  1879     4     0    1     14
7     1    18    1    48    1    0     2  7182     5    0      6
8     2     9    7   146   28    3     6   381  2676    4     34
9     2     0   47     8    0   40     1    12     0  380      3
10   11     7    6     4   67    0    15    46    19    2  12615
---- Validation: 
scalar performance:
{'acc': 0.93708706, 'precision': 0.8854851, 'recall': 0.8463813, 'specificity': 0.9929997, 'f1': 0.8632057, 'auroc': 0.9969761}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   416     0    0     4    1    0    17     8     0    2     35
1     0  1272    0     8    0    0     0    51     1    0      0
2     3     1  209     0   28    0     3    23     1   40      4
3     0     2    0  7676    0    6     3   706    47    0      0
4     5     0   31     1  331    1     1    12     7    9    141
5     2     0    0    46    1  384     0     1     1   85      1
6     5     0    0     2    0    0  1885     2     2    1     11
7     0    12    0    63    1    0     2  7177     6    0      4
8     4     6    4   152   28    3     1   383  2670    3     42
9     0     0   39     4    1   35     4    18     1  390      1
10   14    10    1     8   62    0    17    48    10    3  12623
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69124746, 'precision': 0.68752027, 'recall': 0.56470853, 'specificity': 0.96896076, 'f1': 0.5501673, 'auroc': 0.8821474}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   970     0   0   17    0    0   134    37     3    5     4
1     1  1200   0   18    0    0     0   271     0    0     9
2    24     1  89   19   60    0    22   321    60   85   334
3     0     0   0    0    0    0     0     0     0    0     0
4     2     0   0    0  144    0     1     4     5    0  1477
5    10     0   0  177    0  174     9     5     4  212     1
6     0     0   0    1    0    0  3035     2     0    0    29
7     0     0   0    9    0    0     0  1153     0    0     2
8     0     1   0  120    0    0    25   134  1084    2     4
9    23     2  43  149    1   17    24   414    37  394    33
10    0     0   0    0    8    0     0     1     0    0  1637
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_4.png
better model found
persisted
after epoch: 4,now: 2024-07-09 09:16:06.480930,epoch time: 0:30:44.406051,used: 2:03:30.744292,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9537939, 'precision': 0.8796473, 'recall': 0.8795681, 'specificity': 0.9950229, 'f1': 0.8791352, 'auroc': 0.9977535}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   414     0    0     1   11    0     8     1     3    5     40
1     0  1281    0     9    0    0     0    36     3    0      2
2     1     0  239     0   38    0     2     2     0   30      0
3     0     1    0  7880    2   24     1   407   118    2      1
4     3     0   21     0  373    1     0     1     9    6    125
5     2     0    1    12    3  427     0     0     6   69      1
6     9     0    0     2    2    1  1873     4     2    0     14
7     0    23   18    56    5    0     1  7046    97    1     18
8     0     3    7    65   29   10     1    42  3103    7     29
9     1     0   56     2    2   53     0     1     2  376      0
10    7     0    2     7   85    0    34     3    14    4  12637
---- Validation: 
scalar performance:
{'acc': 0.9537515, 'precision': 0.87975067, 'recall': 0.87698156, 'specificity': 0.9950146, 'f1': 0.8780167, 'auroc': 0.997598}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   416     0    0     4    8    0     7     1     2    6     39
1     0  1283    0     7    0    0     1    34     2    0      5
2     0     0  235     1   42    1     1     0     2   30      0
3     1     5    0  7894    3   28     0   391   114    3      1
4     4     0   21     0  360    1     1     1    11    3    137
5     2     0    0    13    1  426     0     0     6   72      1
6     6     1    0     0    3    2  1873     9     2    4      8
7     0    17    9    59    2    0     2  7048   110    1     17
8     0     2    8    56   31    5     4    49  3105    7     29
9     1     0   52     3    2   51     0     2     4  378      0
10    9     1    4     6   91    1    21     4    19    2  12638
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72399074, 'precision': 0.64656514, 'recall': 0.6132468, 'specificity': 0.972123, 'f1': 0.60033965, 'auroc': 0.8729108}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1032     0    2  10    9    0    18    11    32   21    35
1      2  1224    0  19    0    0     3   209     5    0    37
2      4     0  180   5  262    5     3    36   140   84   296
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    1   0   61    0     1     1     3    0  1566
5     11     0    3  80    9  271     1     0     8  207     2
6      0     0    0   1    0    0  2948     1     0    0   117
7      0     0    0   7    0    0     0  1145     6    1     5
8      1     0    0  52    5    1    10    14  1268    3    16
9     16     1  185  52   10   37     6    84   135  574    37
10     0     0    0   0    0    0     1     0     0    0  1645
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-09 09:47:35.105812,epoch time: 0:31:28.624882,used: 2:34:59.369174,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95561326, 'precision': 0.89203966, 'recall': 0.86860204, 'specificity': 0.99517876, 'f1': 0.87276924, 'auroc': 0.9980461}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     1    1    0     1     0     0    2      8
1     0  1300    0    13    0    0     0    15     4    0      0
2     1     1  137     0   68    2     1     5     3   93      1
3     5     1    0  8259    0   13     2    78    81    0      0
4     5     0    3     1  387    0     0     2    12    6    122
5     1     0    0    32    0  438     0     0     5   44      1
6    20     0    0     2    5    0  1862     0     3    0     16
7     8    66    0   392    3    0    13  6703    69    0      9
8     2     3    3   115   11    2     1    34  3104    0     21
9     4     0   11     7    5   70     0     0     2  393      1
10   30     2    0     8   53    0     6     7    18    3  12664
---- Validation: 
scalar performance:
{'acc': 0.9535643, 'precision': 0.88600016, 'recall': 0.86497396, 'specificity': 0.99497443, 'f1': 0.8665974, 'auroc': 0.9980722}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     0    1    0     1     0     2    2      9
1     0  1298    0    12    0    0     1    18     3    0      0
2     2     0  132     0   69    1     0     2     4   97      5
3     5     4    0  8260    0   13     6    70    80    2      0
4     8     1    6     0  388    1     0     1    10    7    117
5     1     0    0    30    2  430     0     0     6   51      1
6    30     0    0     0    3    1  1852     0     4    0     18
7     6    69    0   418    4    0     8  6675    72    0     13
8     6     0    0   113   12    3     3    42  3094    3     20
9     3     0    7     4    1   78     0     1     1  398      0
10   36     1    1     9   55    3     5     4    26    2  12654
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68830895, 'precision': 0.6493348, 'recall': 0.5817401, 'specificity': 0.9689, 'f1': 0.5762533, 'auroc': 0.8806423}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1089     0   0   20    2    3    33    2     3    9     9
1      6  1334   0   20    0    0     0  128     4    0     7
2     20     7  46   17  301    9     2   60   211   78   264
3      0     0   0    0    0    0     0    0     0    0     0
4      0     0   0    0  175    0     1    1     8    0  1448
5     11     0   0  111   12  324     3    0    10  120     1
6     22     0   0    7    1    0  2733    1     4    0   299
7      2     0   0  416    0    0     0  743     0    0     3
8      1     0   0   72    2    1     8   13  1265    4     4
9     17     7  42  170   26   79    16  111   148  487    34
10     0     0   0    0    4    0     0    0     0    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_6.png
early stop counter: 1
val acc:0.9535642862319946, best validation acc: 0.9537515044212341, corresponding to test acc:                         0.7239907383918762 / 0.7239907383918762
after epoch: 6,now: 2024-07-09 10:18:59.726482,epoch time: 0:31:24.620670,used: 3:06:23.989844,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95662993, 'precision': 0.88095534, 'recall': 0.86078787, 'specificity': 0.9952995, 'f1': 0.86528, 'auroc': 0.9981578}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     1    0    0    10     0     1    1     15
1     0  1315    0     5    0    0     0     6     2    0      3
2     5     0  171     1   98    0     4     5     0   26      2
3     4     7    0  8287    3    4     2    61    67    1      2
4     6     0    2     0  401    0     4     0     3    1    121
5    24     0    1    24    5  337     1     0     6  122      1
6     7     1    0     0    1    0  1890     0     0    0      9
7     4   118    2   253    5    0     3  6805    57    0     17
8     2     7    2    96   48    0     6    40  2993    4     98
9    30     0   46     8    9    5     4     0     1  388      2
10   15     0    1     8   36    0    14     3     2    0  12713
---- Validation: 
scalar performance:
{'acc': 0.9568811, 'precision': 0.8802645, 'recall': 0.85893357, 'specificity': 0.9953195, 'f1': 0.8637911, 'auroc': 0.998165}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     1    0    0     5     0     0    0     19
1     0  1319    0     3    0    0     0     7     1    0      2
2     7     0  167     1  102    0     1     5     1   25      3
3     5    11    0  8296    2    3     1    57    65    0      0
4     7     0    2     0  394    0     1     2     3    2    128
5    27     0    1    22    4  333     1     0     2  130      1
6    10     0    0     4    1    0  1885     0     3    0      5
7     3   109    3   241    7    0     2  6816    63    2     19
8     1     5    2   103   48    1     0    42  2993    3     98
9    27     0   40     5   13   13     1     1     0  391      2
10   10     0    1     7   29    0    16     4     8    0  12721
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70628977, 'precision': 0.6508115, 'recall': 0.5711433, 'specificity': 0.9703219, 'f1': 0.5579245, 'auroc': 0.8830291}
confusion matrix:
      0     1   2    3    4   5     6     7     8    9     10
0   1000     1   0   23    0   0   131     7     1    1     6
1      4  1345   0   22    1   0     6    96     0    0    25
2     32     3  52   16  338   0    29    70    82   45   348
3      0     0   0    0    0   0     0     0     0    0     0
4      1     0   0    0  211   0     4     2     1    0  1414
5     31     0   0  173    6  93    17     0     8  255     9
6      0     0   0    1    0   0  3008     0     1    0    57
7      1     0   0   67    0   0     2  1093     0    0     1
8      1     1   0   87   14   0    19    21  1197    1    29
9     67    15  70  173   35  11    48   140    66  464    48
10     0     0   0    0   12   0     2     0     0    0  1632
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_7.png
better model found
persisted
after epoch: 7,now: 2024-07-09 10:50:05.526875,epoch time: 0:31:05.800393,used: 3:37:29.790237,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9623288, 'precision': 0.90538925, 'recall': 0.8741599, 'specificity': 0.99589133, 'f1': 0.88193375, 'auroc': 0.998582}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     1    1     2    0    0    21     0     0    3     17
1     0  1310    0     5    0    0     0    15     2    0      0
2     0     0  264     1   15    1     2     6     1   17      5
3     0     4    2  8200    0    6     8   138    80    0      0
4     5     0   21     2  357    0     5     0    16    0    133
5     0     0   11    31    0  291     1     1    12  173      1
6     4     0    0     1    0    0  1894     0     1    0      8
7     2    42    0   116    1    0     8  7056    31    0      8
8     4     0    5    72    6    0     8    77  3059    0     65
9     0     0   73     5    2    4     4     4     5  395      1
10   13     0    4     6   16    0    24    13     8    2  12704
---- Validation: 
scalar performance:
{'acc': 0.96150863, 'precision': 0.9065124, 'recall': 0.8743032, 'specificity': 0.99579984, 'f1': 0.88187224, 'auroc': 0.99859345}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    1     3    0    0    25     1     1    1     14
1     0  1305    0     3    0    0     0    20     3    0      1
2     0     0  263     0   16    0     4     7     4   17      1
3     0     3    1  8193    0    1     7   147    86    2      0
4     4     0   21     0  356    0     8     2    11    2    135
5     1     0   10    35    0  289     4     0     6  175      1
6     3     0    0     0    0    0  1896     1     1    0      7
7     1    40    1   119    1    0     8  7057    28    0     10
8     1     1   12    67    5    0     7    90  3041    0     72
9     0     0   69     3    3    3     3     2     3  406      1
10   15     0    2     7   19    0    32     8     8    2  12703
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66850907, 'precision': 0.6434578, 'recall': 0.5313555, 'specificity': 0.9659215, 'f1': 0.51435506, 'auroc': 0.8818952}
confusion matrix:
     0     1    2    3    4   5     6     7     8    9     10
0   587     0    2   24    0   0   527     7     1   16     6
1     2  1306    0   15    0   0     2   148     6    0    20
2     1     1  164   11   83   1    84    92   179   24   375
3     0     0    0    0    0   0     0     0     0    0     0
4     0     0    1    0  122   0     3     2     5    0  1500
5     2     0   13  143    0  78    56     1    33  265     1
6     0     0    0    1    0   0  3000     0     1    0    65
7     0     0    0   50    0   0     1  1110     0    0     3
8     0     2    0   28    1   0    26    53  1245    1    14
9     1     0  214  118    1   6    83   229   153  305    27
10    0     0    0    0    6   0     1     1     0    0  1638
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_8.png
better model found
persisted
after epoch: 8,now: 2024-07-09 11:23:24.502127,epoch time: 0:33:18.975252,used: 4:10:48.765489,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9575664, 'precision': 0.9205618, 'recall': 0.86489135, 'specificity': 0.9950847, 'f1': 0.8855829, 'auroc': 0.998433}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   418     0    0     1    0    0    22     0     0    1     41
1     0  1297    0     4    0    0     3    23     2    0      2
2     0     0  213     0   32    2     2     1     4   49      9
3     4     1    0  8292    0   38    14    45    40    2      2
4     3     0    6     0  277    1     1     0     4    3    244
5     0     0    0     8    0  488     1     0     1   21      2
6     0     0    0     2    0    0  1895     0     1    0     10
7     2    11    0   319    1    0     5  6813    68    1     44
8     1     2    1   143    3    8    12    28  2975    1    121
9     2     0   16     3    2  105     2     0     2  358      3
10    2     0    0     7    3    0    13     0     2    1  12764
---- Validation: 
scalar performance:
{'acc': 0.9577638, 'precision': 0.9193521, 'recall': 0.8651812, 'specificity': 0.99511296, 'f1': 0.88517296, 'auroc': 0.998458}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   416     0    0     1    0    0    26     0     0    1     39
1     0  1298    0     6    0    0     0    23     2    0      3
2     1     0  208     0   33    2     4     0     2   53      9
3     4     1    0  8308    0   37    14    38    36    1      1
4     4     1    7     1  272    1     9     0     6    1    237
5     0     0    0     8    0  488     0     0     3   21      1
6     2     0    0     0    0    0  1899     0     0    0      7
7     3    12    0   338    1    0     8  6804    53    2     44
8     0     1    2   139    2    8    11    24  2985    2    122
9     4     0   16     1    2   92     1     0     1  372      4
10    2     0    0     8    4    0    18     4     3    1  12756
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6819422, 'precision': 0.6147866, 'recall': 0.56493914, 'specificity': 0.9676199, 'f1': 0.5566876, 'auroc': 0.8703917}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   831     0   0   16   0    5   305    0     1    4     8
1     3  1313   0   26   0    0     9  137     2    0     9
2     8     0  51   18  48    6    60   19    92   58   655
3     0     0   0    0   0    0     0    0     0    0     0
4     0     0   0    1   2    0    11    1     2    0  1616
5     4     0   1   90   0  321     8    0     8  154     6
6     0     0   0    1   0    0  3062    0     0    0     4
7     2     0   0  189   0    0    19  951     0    1     2
8     0     0   2  154   1    4    51   12  1085    1    60
9    24     2  69  148   6   78    56   33   142  487    92
10    0     0   0    0   0    0     2    0     0    0  1644
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_9.png
early stop counter: 1
val acc:0.9577637910842896, best validation acc: 0.9615086317062378, corresponding to test acc:                         0.6685090661048889 / 0.7239907383918762
after epoch: 9,now: 2024-07-09 11:54:52.267829,epoch time: 0:31:27.765702,used: 4:42:16.531191,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9672517, 'precision': 0.9145728, 'recall': 0.8962983, 'specificity': 0.99643123, 'f1': 0.9028539, 'auroc': 0.9989099}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     0    2    0     3     0     1    1     20
1     0  1278    0     5    0    0     1    46     2    0      0
2     0     0  244     0   48    1     0     7     2   10      0
3     0     0    0  8075    0   13     2   215   130    1      1
4     3     1    6     0  401    1     0     1     4    1    121
5     0     0    3     8    0  478     1     0     8   22      1
6     7     0    0     1    2    0  1888     1     0    0      9
7     0     8    0    58    3    0     2  7131    48    1     12
8     2     0    1    28   12    0     0    60  3154    0     37
9     0     0   85     2    5   81     0     4     5  311      0
10    6     0    2     4   24    0     4     6    11    1  12736
---- Validation: 
scalar performance:
{'acc': 0.96635014, 'precision': 0.9138776, 'recall': 0.8962678, 'specificity': 0.9963391, 'f1': 0.9022235, 'auroc': 0.9988616}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    1     0    1    0     4     2     1    1     18
1     0  1293    0     5    0    0     0    30     3    0      1
2     1     0  247     0   44    0     1     8     4    6      1
3     0     1    0  8051    0   14     3   233   137    1      0
4     4     1   12     0  385    0     1     1     9    0    126
5     0     0    2     8    2  481     1     0     6   20      1
6     9     0    0     0    0    0  1880     2     4    0     13
7     1     9    1    62    5    0     1  7129    44    1     12
8     0     0    2    30    9    1     0    68  3160    1     25
9     0     0   84     0    4   79     1     3     5  317      0
10    7     0    1     7   27    0    10     6     8    1  12729
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6829217, 'precision': 0.6041302, 'recall': 0.57077396, 'specificity': 0.9675582, 'f1': 0.55358386, 'auroc': 0.87002116}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   756     0    3  30    2    2   272    51    32   11    11
1     4  1208    0  23    0    0     6   228     8    0    22
2     4     0  105   8  303    8    80    41   197   30   239
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0   72    0     6     1     8    0  1545
5     3     0   20  85    3  347    36     0    15   80     3
6     1     0    0   1    0    0  2978     0     2    0    85
7     1     0    0  40    0    0     4  1113     1    1     4
8     0     0    1  50    4    1    37    18  1246    2    11
9     7     0  220  66   23  117   100    96   173  294    41
10    0     0    0   0    2    0     2     0     0    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_10.png
better model found
persisted
after epoch: 10,now: 2024-07-09 12:25:39.918604,epoch time: 0:30:47.650775,used: 5:13:04.181966,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96337223, 'precision': 0.9219779, 'recall': 0.87618184, 'specificity': 0.9958735, 'f1': 0.89101815, 'auroc': 0.9989973}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   426     0    0     4    1    0    13     0     0    0     39
1     0  1280    0     7    0    0     1    38     4    1      0
2     0     0  241     1    6    1     0     7     4   48      4
3     1     0    0  8329    0   15     0    40    54    0      0
4     2     0   45     0  291    2     0     1    14    1    183
5     0     0    0     1    0  510     0     0     2    6      2
6     4     0    0     3    0    1  1889     1     2    0      8
7     4    12    0   336    1    0     8  6853    42    1      6
8     0     1    1    78    1    4     0    46  3130    1     32
9     0     0   17     5    1  145     0     7     3  313      1
10    2     0    1     7    6    1     8     8    16    0  12745
---- Validation: 
scalar performance:
{'acc': 0.96330076, 'precision': 0.9245975, 'recall': 0.87858284, 'specificity': 0.9958607, 'f1': 0.89338344, 'auroc': 0.9990446}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     0    0     1    0    1     8     3     1    1     32
1     0  1281    0     6    0    0     0    39     4    0      2
2     1     0  244     2    4    4     0     8     4   41      4
3     1     1    0  8337    0   12     0    33    56    0      0
4     2     0   40     1  284    1     0     4    18    6    183
5     0     0    0     7    0  505     1     0     2    5      1
6     3     0    1     0    0    1  1892     0     3    0      8
7     2    10    0   357    1    0     5  6842    43    0      5
8     0     0    2    81    3    2     2    40  3131    1     34
9     0     0   16     3    0  145     0     3     2  323      1
10    4     0    1     7    7    1     7     9    22    0  12738
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6876793, 'precision': 0.612687, 'recall': 0.5871402, 'specificity': 0.96852076, 'f1': 0.55601525, 'auroc': 0.8747331}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   937     0   1   15   0    9   138     3     6    8    53
1     1  1214   0   28   0    0     0   221     4    0    31
2     1     0  97   24  13   28    14    54   219   40   525
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    1   0    0     2     1    10    0  1619
5     5     0   1   87   0  446     5     0    10   30     8
6     0     0   0    1   0    0  2931     2     0    0   133
7     5     0   0   98   0    1     8  1047     3    0     2
8     0     0   0   95   0    2    16    10  1240    1     6
9     6     4  70  163   0  240    29    92   206  272    55
10    0     0   0    0   1    0     0     0     0    0  1645
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_11.png
early stop counter: 1
val acc:0.9633007645606995, best validation acc: 0.9663501381874084, corresponding to test acc:                         0.6829217076301575 / 0.7239907383918762
after epoch: 11,now: 2024-07-09 12:56:25.809747,epoch time: 0:30:45.891143,used: 5:43:50.073109,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9685895, 'precision': 0.9260714, 'recall': 0.90165854, 'specificity': 0.99649936, 'f1': 0.90630275, 'auroc': 0.9989842}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     0    0    0     9     0     1    1      9
1     1  1288    0     5    0    0     2    29     5    0      2
2     2     0  282     1    9    0     1     0     1    9      7
3     4     0    1  8236    0   25     4    64   102    2      1
4     6     0   30     0  297    0     6     2    12    0    186
5     3     0    2     7    0  485     0     0     6   17      1
6     6     0    0     0    0    0  1894     0     0    0      8
7     3    12   10   132    1    0     3  7014    69    0     20
8     1     0    1    37    1    0     2    24  3174    0     56
9     6     0   66     2    0   57     4     1     2  352      2
10   25     0    2     7    1    0    19     8    11    0  12717
---- Validation: 
scalar performance:
{'acc': 0.9681958, 'precision': 0.9226434, 'recall': 0.9026966, 'specificity': 0.9964709, 'f1': 0.9039266, 'auroc': 0.999012}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     0    0    0     6     1     0    0     10
1     0  1297    1     6    0    0     0    22     5    0      1
2     2     0  287     0    1    1     1     0     0   11      9
3     9     2    1  8229    0   22     2    73    98    2      2
4     7     0   34     0  293    0     8     3     8    1    185
5     3     0    1     7    0  482     2     0     4   21      1
6     3     0    0     1    0    0  1900     1     1    0      2
7     5    10   13   136    2    0     2  7009    71    1     16
8     4     0    5    33    1    1     2    19  3169    1     61
9    10     0   75     1    0   50     5     0     1  351      0
10   28     0    3     6    1    0    21    11    13    0  12713
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73105717, 'precision': 0.64817727, 'recall': 0.6229831, 'specificity': 0.97270733, 'f1': 0.59401983, 'auroc': 0.87674993}
confusion matrix:
      0     1    2   3   4    5     6     7     8    9     10
0   1098     0    0   5   0    0    55     7     3    1     1
1     13  1261    1   9   0    0     7   156    17    2    33
2     20     0  175   4  26   16    28    22   234   33   457
3      0     0    0   0   0    0     0     0     0    0     0
4      3     0    2   0  19    0     6     1    23    0  1579
5     25     0   10  50   1  367    12     0    14  110     3
6      0     0    0   0   0    0  3048     2     1    0    16
7     13     0    0   9   0    0     4  1130     4    4     0
8      2     0    0  25   0    3    10    10  1311    5     4
9     61     0  143  50   8  123    30    28   247  398    49
10     0     0    0   0   1    0     3     0     0    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_12.png
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-09 13:27:23.984805,epoch time: 0:30:58.175058,used: 6:14:48.248167,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9607502, 'precision': 0.8913545, 'recall': 0.9183193, 'specificity': 0.9959294, 'f1': 0.89972365, 'auroc': 0.99884385}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    1     0    5    0     1     1     3    2     35
1     0  1306    0     3    0    0     0    22     1    0      0
2     0     0  287     0    5    0     0     2     0   18      0
3     1    12    0  8042    0    2     1   291    90    0      0
4     2     1   70     0  435    1     0     3     4    2     21
5     0     0    0    18    0  394     0     0     4  104      1
6     4     0    1     1    1    0  1880     3     2    0     16
7     1    12    2    39    0    0     0  7169    38    0      3
8     0     7    2    31   19    1     1   102  3125    3      4
9     0     0   30     2    0   14     0     5     1  441      0
10    4     0   16     5  316    0     3    29    21    1  12395
---- Validation: 
scalar performance:
{'acc': 0.9604922, 'precision': 0.8891347, 'recall': 0.9166079, 'specificity': 0.995912, 'f1': 0.897734, 'auroc': 0.998821}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     0    4    0     1     3     0    3     34
1     0  1312    0     1    0    0     0    17     2    0      0
2     0     0  283     0    2    1     1     3     0   22      0
3     0     5    0  8048    0    1     1   294    90    1      0
4     1     0   78     0  427    1     0     5     8    3     16
5     1     0    2    21    1  397     0     0     3   96      0
6     2     0    1     0    1    0  1886     2     3    0     13
7     0    13    0    32    1    0     1  7171    44    0      3
8     1     5    5    31   18    1     0   104  3117    6      8
9     0     0   37     5    0   11     0     2     1  437      0
10    4     2   20     8  303    0     7    24    34    2  12392
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7416218, 'precision': 0.69613636, 'recall': 0.6180458, 'specificity': 0.97391033, 'f1': 0.6215573, 'auroc': 0.88900506}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   890     0    0   20    1    0   137    57     5   31    29
1     0  1319    0    8    1    0     0   166     0    0     5
2     4     5  285   12  283    3    29   131   149   66    48
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    7    0  763    0     2     6    13    1   841
5     0     0    3  134    1  149    26     4    11  262     2
6     1     1    1    3   10    0  2780    10     3    0   258
7     0     0    0    3    0    0     0  1159     0    0     2
8     0     3    0   35    2    0    11    79  1238    1     1
9     6     8  100  104    5   29    28   307    79  467     4
10    0     0    0    0   94    0     0     1     0    1  1550
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_13.png
new oracle model saved
early stop counter: 1
val acc:0.9604921936988831, best validation acc: 0.9681957960128784, corresponding to test acc:                         0.7310571670532227 / 0.7416217923164368
after epoch: 13,now: 2024-07-09 13:59:04.615208,epoch time: 0:31:40.630403,used: 6:46:28.878570,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97279, 'precision': 0.9391936, 'recall': 0.91265345, 'specificity': 0.9969641, 'f1': 0.9202536, 'auroc': 0.9994006}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   433     0    0     1    0    0    15     0     0    0     34
1     0  1320    0     2    0    0     2     6     2    0      0
2     1     0  296     1    3    1     1     1     0    6      2
3     3     5    0  8331    0    3     4    57    35    1      0
4     4     1   38     0  349    1     0     0     7    1    138
5     1     0    2    13    0  487     0     0     2   14      1
6     0     0    0     1    0    0  1900     0     1    0      5
7     1    55    4   125    1    0    12  6985    65    1     14
8     1     0    0   110    1    1     2    17  3137    1     26
9     0     0   56     5    0   69     4     0     1  357      1
10    0     1    2     7    5    0     2     2     9    0  12764
---- Validation: 
scalar performance:
{'acc': 0.9731176, 'precision': 0.9399946, 'recall': 0.9113215, 'specificity': 0.9969902, 'f1': 0.91982925, 'auroc': 0.9994027}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   432     0    0     1    0    0     9     0     0    1     40
1     0  1319    0     1    0    0     1     6     4    0      1
2     0     0  297     0    1    0     2     0     0   10      2
3     0     2    1  8350    0    1     2    57    27    0      0
4     2     1   40     0  339    2     0     1     7    1    146
5     0     0    2    20    0  481     0     0     1   16      1
6     2     0    0     2    1    0  1896     0     1    0      6
7     0    49    1   133    0    0    15  6992    62    4      9
8     0     0    5   100    2    0     2    24  3146    0     17
9     1     0   55     1    0   67     2     1     2  364      0
10    0     0    1     8    5    0     6     3     9    0  12764
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6936962, 'precision': 0.67521846, 'recall': 0.5783073, 'specificity': 0.9686268, 'f1': 0.575126, 'auroc': 0.8813118}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   734     0    1   26   0    1   383     5     0    5    15
1     1  1281    0   36   0    0    12   121    17    1    30
2     0     1  238   14  44    8    59    23   161   56   411
3     0     0    0    0   0    0     0     0     0    0     0
4     0     0    6    0  54    0     6     0    10    0  1557
5     1     0    5  126   0  306    60     0     4   86     4
6     0     0    0    2   0    0  3034     0     0    0    31
7     0     0    0  108   0    1    14  1032     5    1     3
8     0     0    2  101   0    2    37     9  1211    0     8
9     2     1  120  114   0  131   105    30   204  386    44
10    0     0    0    0   2    0     4     0     1    0  1639
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_14.png
better model found
persisted
after epoch: 14,now: 2024-07-09 14:29:59.618136,epoch time: 0:30:55.002928,used: 7:17:23.881498,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97062284, 'precision': 0.9264534, 'recall': 0.92552614, 'specificity': 0.9968574, 'f1': 0.9235487, 'auroc': 0.99929863}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     2    0    1     2     0     1    0      2
1     0  1311    0     5    0    0     0    14     2    0      0
2     0     0  213     0   14    1     1     1     1   80      1
3     0     0    0  8391    0    3     0    22    19    0      0
4     8     1   10     1  469    2     0     3    14    5     26
5     0     0    0    14    0  471     0     0     2   33      1
6    15     0    0     4    0    1  1865     4     5    2     12
7     4    14    0   238    1    0     2  6976    24    0      4
8     0     1    1   140    3    6     0    63  3076    1      5
9     0     0    3     3    0   38     0     1     1  447      0
10   25     1    3     9   93    0     5     5    65    4  12584
---- Validation: 
scalar performance:
{'acc': 0.9714056, 'precision': 0.92919016, 'recall': 0.9288789, 'specificity': 0.9969353, 'f1': 0.92664397, 'auroc': 0.99932134}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    1     1    0    1     1     0     2    1      2
1     0  1311    0     5    0    0     0    14     2    0      0
2     1     0  220     0   11    2     0     2     5   71      0
3     0     0    0  8398    0    7     0    25    10    0      0
4     8     0    9     0  463    1     1     2    21    6     28
5     0     0    0    13    0  477     0     0     0   30      1
6    14     0    0     5    0    1  1875     3     0    1      9
7     1     8    0   219    2    0     1  7010    18    1      5
8     0     1    0   159    0    5     0    64  3059    3      5
9     0     0    1     1    0   37     0     0     1  453      0
10   35     2    1     7   95    2     9     9    57    3  12576
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7048205, 'precision': 0.66861165, 'recall': 0.59181726, 'specificity': 0.9705764, 'f1': 0.5871302, 'auroc': 0.8800668}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   862     0    1   27    0   50   116    9    22   76     7
1     3  1252    0   37    1    0     0  190     8    0     8
2     6     0  104   32  183   42    20   77   336  111   104
3     0     0    0    0    0    0     0    0     0    0     0
4     1     2    1    0  328    0     4    1    50    0  1246
5     1     0    1   91    0  344     2    0     8  145     0
6     3     0    0   11    0    1  2941    2     5    0   104
7     1     0    0  202    0    0     0  960     0    0     1
8     0     0    0  134    0    3     9   24  1197    2     1
9     2     4   31  207    5  142     8  100   144  474    20
10    0     0    0    0   29    0     3    0     1    1  1612
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_15.png
early stop counter: 1
val acc:0.9714056253433228, best validation acc: 0.9731175899505615, corresponding to test acc:                         0.6936962008476257 / 0.7416217923164368
after epoch: 15,now: 2024-07-09 15:00:57.874651,epoch time: 0:30:58.256515,used: 7:48:22.138013,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9710777, 'precision': 0.9283442, 'recall': 0.8835215, 'specificity': 0.9968721, 'f1': 0.8950944, 'auroc': 0.9992657}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     1    5    1     0     0     0    2      6
1     0  1275    0     5    0    0     1    44     4    0      3
2     0     0  135     0   21    4     0    10    11  128      2
3     1     1    0  8327    0    3     4    80    21    1      1
4     1     0    5     0  387    0     0     2    33    8    103
5     0     0    0     8    0  500     0     0     1   11      1
6    13     0    0     0    1    4  1875     0     4    1     10
7     2     5    0   120    1    0     1  7076    48    2      7
8     0     0    0    69    2    1     0    37  3168    1     17
9     0     0    0     1    0  101     0     0     5  386      0
10   11     0    0     5   12    0     5     4    57    1  12698
---- Validation: 
scalar performance:
{'acc': 0.9710312, 'precision': 0.9271907, 'recall': 0.8835029, 'specificity': 0.99686587, 'f1': 0.894512, 'auroc': 0.99928236}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    5    0     0     0     0    0      8
1     0  1280    0     4    0    2     0    37     5    1      3
2     0     0  134     0   13    4     0     8    14  135      4
3     0     0    0  8325    0    6     2    78    28    0      1
4     0     0    7     0  391    0     0     1    28    6    106
5     0     0    0    12    0  498     0     1     1    8      1
6    21     0    0     3    0    1  1864     2     2    1     14
7     5     4    1   105    1    0     1  7081    55    2     10
8     0     0    0    74    1    5     0    32  3171    0     13
9     0     0    0     1    0  104     0     0     3  385      0
10   11     0    0     5    6    0     3     1    64    3  12703
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6847408, 'precision': 0.6352544, 'recall': 0.58170027, 'specificity': 0.9683961, 'f1': 0.54765576, 'auroc': 0.8776382}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1095     0   0    8    1    6    18    21     5   11     5
1      1  1091   0   15    1    0     1   342    10    0    38
2      6     0  21   16  165   33     7    46   372   77   272
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   0    0   69    1     1     2    20    0  1540
5      9     0   0  143    2  353     3     1    11   69     1
6      4     0   0    9    0    0  2832     3     1    1   217
7      1     0   0   34    0    0     0  1126     1    0     2
8      1     0   0  107    0    0     8    29  1224    1     0
9     16     2   8  154   18  166    10   112   286  335    30
10     0     0   0    0    5    0     0     0     0    0  1641
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_16.png
early stop counter: 2
val acc:0.9710311889648438, best validation acc: 0.9731175899505615, corresponding to test acc:                         0.6936962008476257 / 0.7416217923164368
after epoch: 16,now: 2024-07-09 15:31:43.374249,epoch time: 0:30:45.499598,used: 8:19:07.637611,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9815925, 'precision': 0.9501322, 'recall': 0.9475148, 'specificity': 0.99801254, 'f1': 0.9482847, 'auroc': 0.9996481}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    1    0     0     0     1    0      7
1     0  1289    0     4    0    0     0    34     4    0      1
2     1     0  278     1   13    0     0     4     0   13      0
3     0     0    0  8325    0    2     0    53    57    1      0
4     5     0    7     0  483    0     0     2     7    1     34
5     1     0    0     9    0  492     0     0     4   13      1
6    14     0    0     1    0    3  1878     0     0    0     12
7     0     3    0    81    0    0     1  7156    19    0      4
8     0     0    0    37    1    0     0    41  3194    1     22
9     0     0   26     1    0   62     2     0     0  402      0
10   12     0    3     5   39    1     3     5     7    1  12717
---- Validation: 
scalar performance:
{'acc': 0.98058045, 'precision': 0.9454849, 'recall': 0.945197, 'specificity': 0.99791527, 'f1': 0.94430417, 'auroc': 0.9996404}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    1    0     0     1     0    0      7
1     0  1295    0     7    0    0     0    29     1    0      0
2     0     0  281     1   16    1     0     3     2    8      0
3     0     0    0  8324    0    1     0    59    56    0      0
4     7     0   13     0  477    1     0     0     3    2     36
5     1     0    0     9    0  499     0     0     1   10      1
6    13     0    0     1    0    0  1878     0     2    1     13
7     0     4    0    88    1    0     1  7131    32    1      7
8     0     0    0    37    4    1     0    33  3203    1     17
9     2     0   23     1    0   80     0     1     0  386      0
10   11     0    3     5   51    0     1     7     7    0  12711
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67368644, 'precision': 0.64608437, 'recall': 0.56441796, 'specificity': 0.9675664, 'f1': 0.5495167, 'auroc': 0.87635756}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   915     0   4   82    0   19    34    52    23   28    13
1     0  1096   0   38    1    0     1   343     4    0    16
2     5     0  83   48  144   25     8    71   360   58   213
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   0    0  132    1     2     4    23    0  1470
5     1     0   1  192    0  312     2     0     8   74     2
6     5     0   0   19    0    0  2854     4     6    0   179
7     0     0   0  104    0    0     0  1056     1    0     3
8     0     0   0  112    1    2     5    14  1228    3     5
9     6     1  37  267    6  148     4   103   227  313    25
10    0     0   0    0    6    0     0     0     0    0  1640
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_17.png
better model found
persisted
after epoch: 17,now: 2024-07-09 16:02:27.342504,epoch time: 0:30:43.968255,used: 8:49:51.605866,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9793718, 'precision': 0.9565381, 'recall': 0.9316513, 'specificity': 0.9977385, 'f1': 0.9429905, 'auroc': 0.99961156}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    0     1    7    0    15     3     0    0     18
1     0  1322    0     1    0    0     0     7     1    0      1
2     0     0  241     2   30    1     1     2     2   27      6
3     0     9    0  8220    1    0     0   161    46    0      0
4     1     0    2     0  467    0     2     0     6    0     61
5     0     0    0    21    0  470     2     0     7   20      1
6     0     0    0     0    0    0  1899     2     2    0      5
7     0    16    1    43    3    0     0  7169    23    0      9
8     0     4    0    35    5    0     2    26  3207    0     16
9     1     1    8     6    3   33     1     2     3  434      1
10    2     0    0     3   28    0     5     3    14    0  12737
---- Validation: 
scalar performance:
{'acc': 0.9782533, 'precision': 0.95392215, 'recall': 0.9267429, 'specificity': 0.99760383, 'f1': 0.9391846, 'auroc': 0.99957114}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     1    6    0    22     1     0    0     15
1     0  1324    0     0    0    0     0     8     0    0      0
2     0     0  235     2   28    0     1     3     3   33      7
3     0     7    0  8205    1    0     1   170    54    1      1
4     0     0    4     1  455    0     1     2     5    0     71
5     1     0    0    25    0  467     1     0     6   20      1
6     0     0    0     0    0    0  1895     0     3    0     10
7     0    19    0    45    1    0     1  7166    27    0      6
8     1     0    0    29    7    0     1    25  3209    0     24
9     1     1   12     8    2   27     0     1     5  433      3
10    2     0    0     2   31    0     4     5     7    0  12745
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6641713, 'precision': 0.634465, 'recall': 0.53635275, 'specificity': 0.96571124, 'f1': 0.51227003, 'auroc': 0.87061626}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   636     1   1   39    0    0   363    57    36    4    33
1     3  1348   0   13    1    0     0   113     3    0    18
2     1     0  26    8   97    6    53    67   312   31   414
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  111    0     3     1    14    0  1504
5     2     0   0  141    1  173    46     1    29  162    37
6     0     0   0    1    0    0  2898     3     1    0   164
7     0     0   0   22    0    0     0  1139     1    0     2
8     0     0   0   72    0    0    10    26  1255    0     7
9     4     2  18  152    9   62    51   159   313  269    98
10    0     0   0    0    6    0     2     0     0    0  1638
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_18.png
early stop counter: 1
val acc:0.9782533049583435, best validation acc: 0.9805804491043091, corresponding to test acc:                         0.6736864447593689 / 0.7416217923164368
after epoch: 18,now: 2024-07-09 16:33:09.727382,epoch time: 0:30:42.384878,used: 9:20:33.990744,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9820741, 'precision': 0.94973737, 'recall': 0.95372826, 'specificity': 0.9981145, 'f1': 0.95107806, 'auroc': 0.9996923}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    5    0     1     0     1    0      7
1     0  1316    0     1    0    0     0    13     2    0      0
2     1     0  263     0   22    0     0     3     3   19      1
3     5     2    0  8307    1    6     3    74    41    1      0
4     1     0    3     0  495    1     0     1    11    0     27
5     0     0    0     6    0  495     0     0     1   18      1
6     6     0    0     0    1    0  1894     0     2    1      4
7     5    11    0    72    1    0     9  7119    34    0     10
8     0     0    1    26    4    0     1    21  3234    0      6
9     1     0    9     1    0   42     0     1     0  439      0
10   10     0    1     6   78    1     4     2    17    0  12675
---- Validation: 
scalar performance:
{'acc': 0.98293436, 'precision': 0.9519805, 'recall': 0.9549881, 'specificity': 0.99820966, 'f1': 0.9526247, 'auroc': 0.9996768}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    6    0     0     1     0    0      6
1     1  1312    0     1    0    0     0    16     2    0      0
2     0     0  262     0   23    2     0     5     2   17      1
3     6     1    0  8329    0    4     2    64    34    0      0
4     1     0    1     0  509    1     0     1     6    2     18
5     0     0    0     3    0  499     0     0     3   15      1
6     4     0    0     0    0    0  1896     0     3    0      5
7     3    17    0    59    2    0     8  7140    32    0      4
8     0     0    0    37    4    1     1    21  3218    1     13
9     1     0   11     0    1   44     0     3     2  431      0
10    8     0    1     6   75    0     4     5    16    0  12681
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7183936, 'precision': 0.63637906, 'recall': 0.60041964, 'specificity': 0.9716841, 'f1': 0.5821982, 'auroc': 0.8783771}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1095     0    1    9    0    4    45     1     2    1    12
1      6  1236    0   20    2    0     0   204     2    0    29
2     11     3   80   14  223   13     7    93   247   27   297
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    0    0  307    1     3     2    20    0  1299
5     18     0   18   99    6  316     6     0    13  109     7
6      1     0    0    2    0    0  3033     2     1    0    28
7     11     0    0   25    0    0    12  1114     0    0     2
8      2     0    0   78    1    3    17    39  1224    0     6
9     35     4  122  148   22  117    21   167   182  266    53
10     0     0    0    0   46    0     3     0     0    0  1597
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_19.png
better model found
persisted
after epoch: 19,now: 2024-07-09 17:04:53.145996,epoch time: 0:31:43.418614,used: 9:52:17.409358,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9817262, 'precision': 0.95472175, 'recall': 0.93598634, 'specificity': 0.99804115, 'f1': 0.94340265, 'auroc': 0.9996767}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     1    2    0     2     0     1    0      0
1     0  1300    0     8    0    0     0    19     4    0      0
2     1     0  226     0   52    1     0     0     1   29      2
3     0     0    0  8349    0    4     0    34    51    0      0
4     4     0    2     1  453    1     0     0    10    0     68
5     0     0    0     5    0  504     0     0     3    8      1
6     2     0    0     3    0    1  1897     0     1    0      3
7     1     4    0   102    1    0     1  7073    75    0      6
8     0     0    0    24    2    1     0     7  3255    1      5
9     2     0    4     2   13   47     0     0     2  423      0
10   15     0    0     3   11    0     5     1    23    0  12736
---- Validation: 
scalar performance:
{'acc': 0.98076767, 'precision': 0.9511206, 'recall': 0.9306816, 'specificity': 0.9979395, 'f1': 0.9382375, 'auroc': 0.9996703}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    4    0     0     0     0    1      1
1     0  1299    0     6    0    0     0    20     7    0      0
2     0     0  212     0   56    0     1     1     5   35      2
3     0     0    0  8355    0    4     0    33    48    0      0
4     3     0    0     1  453    1     0     1     8    1     71
5     0     0    0     4    0  508     0     0     2    7      0
6     3     0    0     6    0    0  1896     0     0    0      3
7     2     2    0   109    2    0     1  7069    73    0      7
8     0     0    0    32    3    1     0     7  3251    0      2
9     2     0    7     2    9   55     0     0     3  415      0
10   19     0    0     5    9    0     6     2    24    0  12731
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68991816, 'precision': 0.6270217, 'recall': 0.5723371, 'specificity': 0.96880436, 'f1': 0.5517084, 'auroc': 0.87047136}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   879     0   0   58    1    5   130    26    47    6    18
1     4  1178   0   32    1    0     2   257    13    0    12
2     7     0  59   34  152   15    14    42   371   34   287
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   2    0   76    0    10     1    59    0  1484
5     6     0   3  125    5  300     7     1    14  116    15
6     0     0   0    9    0    0  3037     1     3    0    17
7     1     0   1   65    0    1     1  1090     4    0     1
8     0     0   0   89    0    2    12    12  1252    1     2
9    15     1  41  154   41  131    20    55   272  359    48
10    0     0   0    0    2    0     9     0     4    0  1631
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_20.png
early stop counter: 1
val acc:0.9807676672935486, best validation acc: 0.9829343557357788, corresponding to test acc:                         0.7183936238288879 / 0.7416217923164368
after epoch: 20,now: 2024-07-09 17:36:08.141380,epoch time: 0:31:14.995384,used: 10:23:32.404742,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98089683, 'precision': 0.95932406, 'recall': 0.9492772, 'specificity': 0.9979198, 'f1': 0.95365155, 'auroc': 0.9997354}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     2    0     0    4    0     5     1     0    0      5
1     0  1309    0     0    0    0     0    22     0    0      1
2     0     0  269     0   10    0     0     5     1   21      6
3     0     3    0  8184    0    7     1   163    77    0      3
4     4     0    5     0  470    0     0     1     6    0     52
5     0     0    0     2    0  459     0     0     3   57      0
6     1     0    0     0    0    0  1901     2     0    0      4
7     0     1    0    50    0    0     1  7201     6    0      3
8     0     0    0     9    3    0     3    65  3201    2     12
9     1     0   14     0    1    5     1     1     0  470      0
10    4     0    1     4   29    0     5     5    14    0  12733
---- Validation: 
scalar performance:
{'acc': 0.9799652, 'precision': 0.95526254, 'recall': 0.95104414, 'specificity': 0.99782753, 'f1': 0.9525708, 'auroc': 0.9997206}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    6    0     3     1     0    0      4
1     0  1313    0     0    0    0     0    19     0    0      0
2     0     0  270     0   12    0     2     4     0   20      4
3     2     2    0  8138    0   16     0   193    87    1      1
4     4     0    6     0  478    0     0     0     3    0     48
5     0     0    0     2    1  457     0     0     1   59      1
6     1     0    0     1    0    0  1900     1     0    0      5
7     0     1    1    42    1    0     0  7204    11    0      5
8     1     0    1    11    5    1     2    50  3201    3     21
9     0     0   10     0    2    7     0     1     1  472      0
10    3     0    1     4   32    0     5     5    12    0  12734
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72259146, 'precision': 0.6542348, 'recall': 0.6032179, 'specificity': 0.9720379, 'f1': 0.58762056, 'auroc': 0.8776662}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1016     0    3  20    3    1    53    25     5   27    17
1      0  1139    0  19    0    0     1   316     4    0    20
2      6     0  140   9  133    7     5    88   241   75   311
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    1   0  178    0     2     5    26    0  1421
5      6     0    7  53    4  226     3     2     5  278     8
6      1     0    0   4    0    0  3033     5     2    0    22
7      1     0    0  27    0    0     0  1132     0    2     2
8      0     0    0  45    1   10    15    36  1245   10     8
9      7     0  118  55   15   63     4   115   131  589    40
10     0     0    0   0   14    0     2     0     0    0  1630
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_21.png
early stop counter: 2
val acc:0.9799652099609375, best validation acc: 0.9829343557357788, corresponding to test acc:                         0.7183936238288879 / 0.7416217923164368
after epoch: 21,now: 2024-07-09 18:07:38.790349,epoch time: 0:31:30.648969,used: 10:55:03.053711,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98595357, 'precision': 0.96907103, 'recall': 0.95361435, 'specificity': 0.9984289, 'f1': 0.9607508, 'auroc': 0.9998086}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     3    0    0     2     0     1    1      8
1     0  1322    0     2    0    0     0     7     0    0      1
2     0     0  287     0   13    1     0     0     1    9      1
3     0     0    0  8390    0    1     0    31    14    1      0
4     6     0   13     0  441    2     1     0    16    0     60
5     0     0    0    20    0  480     0     0     1   20      0
6     1     0    0     0    0    0  1900     0     1    0      6
7     0     6    0   115    0    0     1  7126    13    0      2
8     0     0    0    40    1    0     1    20  3228    0      5
9     0     0   24     2    0   11     0     2     0  454      0
10    3     1    0     5    6    0     2     2    18    1  12755
---- Validation: 
scalar performance:
{'acc': 0.98590344, 'precision': 0.97214955, 'recall': 0.9559637, 'specificity': 0.9984359, 'f1': 0.96368474, 'auroc': 0.9998208}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     1    0    1     3     1     0    0      5
1     0  1311    0     3    0    0     0    17     1    0      0
2     0     0  284     1   14    0     0     2     3    5      3
3     0     0    0  8385    0    1     0    34    20    0      0
4     6     0    6     0  462    0     0     2    12    1     50
5     0     0    0    23    0  473     0     0     3   22      0
6     1     1    0     2    0    0  1898     0     0    2      4
7     0     5    0   106    0    0     0  7136    16    0      2
8     0     0    0    27    0    0     1    29  3235    1      3
9     0     0   18     2    0   11     0     1     2  459      0
10    4     0    0     4    5    2     3     4    31    0  12743
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.62520117, 'precision': 0.61509645, 'recall': 0.5051489, 'specificity': 0.9620074, 'f1': 0.49149618, 'auroc': 0.86636025}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   494     0    9   85   0    1   417    44    23   67    30
1     0  1180    0   42   0    0     0   230    13    0    34
2     0     0  115   29  68    5    21    59   315   54   349
3     0     0    0    0   0    0     0     0     0    0     0
4     0     0    1    0  60    0     2     1    14    0  1555
5     0     0   13  181   0  111    21     2    37  223     4
6     0     0    1    4   0    0  2660     3     7    0   392
7     0     0    0  102   0    0     1  1057     0    0     4
8     0     0    0   83   0    0    19    26  1236    2     4
9     1     0  125  191   3   29    32    93   246  379    38
10    0     0    0    0   1    0     1     0     0    0  1644
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_22.png
better model found
persisted
after epoch: 22,now: 2024-07-09 19:20:33.399027,epoch time: 1:12:54.608678,used: 12:07:57.662389,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9841342, 'precision': 0.9629061, 'recall': 0.9576546, 'specificity': 0.9982701, 'f1': 0.9592427, 'auroc': 0.99976856}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     4    3    0     5     0     0    0      4
1     0  1310    0     7    0    1     0    13     0    0      1
2     0     0  302     0    0    0     0     2     2    4      2
3     0     0    0  8293    0    3     0    93    50    0      0
4     3     0   26     0  448    0     0     3     9    0     50
5     0     0    0     6    0  501     0     0     1   13      0
6     1     0    1     2    0    0  1894     4     2    0      4
7     0     1    1    69    0    0     0  7184     6    0      1
8     0     0    0    21    2    0     1    28  3236    1      5
9     0     0   32     2    1   22     0     0     1  435      0
10    6     0    3     3   17    0     0    13    38    0  12713
---- Validation: 
scalar performance:
{'acc': 0.9844323, 'precision': 0.96487486, 'recall': 0.95689946, 'specificity': 0.99830693, 'f1': 0.9598079, 'auroc': 0.99978226}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     1    3    0     8     0     0    0      3
1     0  1310    0     6    0    0     0    15     1    0      0
2     0     0  304     1    2    0     0     1     0    4      0
3     0     0    0  8295    0    1     1    97    45    0      1
4     2     0   30     0  442    0     0     4    13    1     47
5     0     0    1    10    0  498     0     0     1   11      0
6     0     0    0     3    0    0  1900     1     0    0      4
7     0     2    0    57    1    0     1  7186    14    0      4
8     0     0    1    19    2    1     0    34  3238    0      1
9     1     0   20     5    0   31     1     1     1  433      0
10    4     0    2     2   12    0     1    13    33    0  12729
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65059817, 'precision': 0.60723084, 'recall': 0.54719424, 'specificity': 0.9648648, 'f1': 0.51754177, 'auroc': 0.8636785}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   704     0    5   22    7    8   124   168    68   12    52
1     0  1203    0   32    0    0     0   243     6    0    15
2     1     1  117   18  107   22     4    97   456   26   166
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0   66    1     2     3    56    0  1505
5     1     0   10  138    7  309     8    12    30   67    10
6     0     0    1    6    1    0  2654    10    20    0   375
7     0     0    0   27    0    0     0  1132     1    0     4
8     0     0    0   47    0    0     2    31  1289    1     0
9     3     1   79  180   13  165     8   151   322  183    32
10    0     0    0    0    1    0     1     1     1    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_23.png
early stop counter: 1
val acc:0.9844322800636292, best validation acc: 0.9859034419059753, corresponding to test acc:                         0.6252011656761169 / 0.7416217923164368
after epoch: 23,now: 2024-07-09 19:55:04.977782,epoch time: 0:34:31.578755,used: 12:42:29.241144,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.9627705, 'recall': 0.9595357, 'specificity': 0.998264, 'f1': 0.9606345, 'auroc': 0.99981374}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     1    6    0     1     0     0    0      3
1     0  1316    1     1    0    0     0    13     0    0      0
2     0     0  295     1    2    0     0     0     0   13      1
3     0     0    0  8412    0    1     0    18     5    0      1
4     2     0   16     0  473    0     0     0     2    0     46
5     0     0    1     5    0  478     0     0     0   37      0
6     4     0    0     1    0    0  1895     0     1    1      6
7     0     4    5   172    0    0     0  7046    23    8      7
8     0     0    2    72    4    4     0    18  3189    2      4
9     0     0   23     2    0   13     0     0     0  455      0
10    2     0    1     3    5    0     2     3    15    0  12761
---- Validation: 
scalar performance:
{'acc': 0.985101, 'precision': 0.9686103, 'recall': 0.96270305, 'specificity': 0.99834216, 'f1': 0.9649464, 'auroc': 0.9997941}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     3    2    0     1     0     0    0      2
1     0  1319    0     1    0    0     0    12     0    0      0
2     0     0  301     0    0    0     0     0     1    8      2
3     1     0    1  8408    0    0     0    20     9    0      1
4     4     0   18     0  465    1     0     1     8    0     42
5     1     0    2    11    0  467     0     0     2   38      0
6     2     0    0     0    0    0  1899     0     0    0      7
7     1     3    2   153    1    0     0  7066    33    2      4
8     0     0    1    73    2    2     1    16  3196    1      4
9     0     0   12     2    1    4     0     0     0  474      0
10    6     0    1     2    9    0     2     4    14    0  12758
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6593437, 'precision': 0.64756685, 'recall': 0.5497018, 'specificity': 0.96575177, 'f1': 0.5346346, 'auroc': 0.87221617}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   894     0    1   49   0    0    59    26    83   27    31
1     4  1120    0   26   0    0     1   288    24    1    35
2     3     2  141   17  86    3     3    14   374   88   284
3     0     0    0    0   0    0     0     0     0    0     0
4     0     0    3    1  67    0     2     0    30    0  1530
5     3     0    3  110   2  133     2     1    28  305     5
6     4     0    1   10   0    0  2574     4     9    0   465
7     0     0    0   94   0    0     0  1057     9    1     3
8     0     0    0   63   0    2     4     7  1291    3     0
9     7     0   73  135   4   21     1    25   332  503    36
10    0     0    0    0   1    0     1     0     0    0  1644
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_24.png
early stop counter: 2
val acc:0.9851009845733643, best validation acc: 0.9859034419059753, corresponding to test acc:                         0.6252011656761169 / 0.7416217923164368
after epoch: 24,now: 2024-07-09 20:27:03.914383,epoch time: 0:31:58.936601,used: 13:14:28.177745,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98319775, 'precision': 0.96120095, 'recall': 0.9597775, 'specificity': 0.9981661, 'f1': 0.95937157, 'auroc': 0.9997962}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   481     0    0     0    0    0     1     0     0    0      1
1     0  1314    0     3    0    0     0    14     0    0      0
2     1     0  296     0    2    0     0     0     0   11      1
3     1     1    0  8281    0    1     0   124    31    1      0
4     9     0   34     0  436    0     3     1     1    1     54
5     1     0    0     4    0  484     2     0     0   29      1
6     0     0    0     0    0    0  1906     0     1    0      1
7     2    22    0    20    1    0     1  7208     4    0      5
8     0     3    1    40    3    0     1    85  3144    2     16
9     1     0    8     1    0    7     0     1     0  475      0
10   23     0    1     4    7    0    19     3    12    0  12723
---- Validation: 
scalar performance:
{'acc': 0.9837903, 'precision': 0.9636166, 'recall': 0.9621621, 'specificity': 0.9982361, 'f1': 0.96220285, 'auroc': 0.9998018}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    0    0     4     0     0    1      1
1     0  1319    0     1    0    0     0    11     0    0      1
2     1     0  296     0    1    0     0     1     0   13      0
3     2     2    0  8272    0    1     1   136    24    2      0
4     5     0   21     0  465    0     4     0     4    1     39
5     1     0    1     7    0  476     2     1     1   31      1
6     1     0    0     0    0    0  1903     1     1    0      2
7     3    15    0    25    1    0     2  7213     3    0      3
8     0     0    3    37    4    0     1    84  3151    1     15
9     0     0    9     0    0    9     1     0     1  473      0
10   24     0    0     4    5    0    14     3    12    0  12734
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69733435, 'precision': 0.6698764, 'recall': 0.573748, 'specificity': 0.9693941, 'f1': 0.5675593, 'auroc': 0.8801799}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   773     0    1   58    0    0   228    53    18   28    11
1     2  1169    0   29    0    0     3   275     3    0    18
2     3     0  191   21   83   11    67   105   307   87   140
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    6    0  205    0    47     6    41    1  1326
5     5     0    4  123    0  210    14     2    13  221     0
6     1     0    0   12    0    0  3030     3     1    0    20
7     2     0    0   63    0    0     1  1095     0    1     2
8     0     0    0   81    0    1    16    46  1221    3     2
9     7     0   52  147    2   85    32   145   196  452    19
10    0     0    0    0    8    0    15     1     1    0  1621
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_25.png
early stop counter: 3
val acc:0.9837902784347534, best validation acc: 0.9859034419059753, corresponding to test acc:                         0.6252011656761169 / 0.7416217923164368
after epoch: 25,now: 2024-07-09 20:57:34.219836,epoch time: 0:30:30.305453,used: 13:44:58.483198,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9877194, 'precision': 0.9678461, 'recall': 0.96952975, 'specificity': 0.9986944, 'f1': 0.9684969, 'auroc': 0.9998504}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    1    0     3     0     1    0      2
1     0  1326    0     1    0    0     0     4     0    0      1
2     0     0  287     0    6    0     0     1     1   17      0
3     0     4    1  8357    0    1     0    32    42    1      0
4     6     0    5     0  493    0     0     1     7    0     27
5     0     0    1     2    0  486     0     0     1   31      0
6     2     0    0     1    1    0  1895     2     0    1      6
7     1    16    3    88    1    0     0  7111    39    2      1
8     1     1    0     9    4    1     1     8  3261    1      8
9     0     0    4     1    0   11     0     0     0  477      0
10    1     0    1     2   33    0     2     1     5    0  12749
---- Validation: 
scalar performance:
{'acc': 0.9880166, 'precision': 0.969525, 'recall': 0.9710378, 'specificity': 0.99873364, 'f1': 0.9698851, 'auroc': 0.9998695}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    0    0     0     0     1    1      4
1     0  1327    0     2    0    0     0     3     0    0      0
2     1     0  283     0    4    0     0     1     0   21      2
3     0     5    0  8348    0    3     0    36    47    1      0
4     5     0    8     1  503    0     0     0     5    1     16
5     0     0    0     4    0  480     1     0     1   35      0
6     1     0    0     3    0    0  1899     0     0    0      5
7     2    16    2    79    1    0     1  7115    45    1      3
8     0     1    0     7    2    0     0     9  3270    2      5
9     0     0    2     1    0    5     0     0     0  485      0
10    1     0    2     3   29    0     0     2     9    0  12750
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69502556, 'precision': 0.661221, 'recall': 0.57303077, 'specificity': 0.9693586, 'f1': 0.56458557, 'auroc': 0.87604666}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   816     0    2   40    0   12   101    27     2  111    59
1     0  1267    0   32    2    0     5   167     9    0    17
2     1     2  118   17  131    6     6    48   369   96   221
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    1  222    0     2     1    33    2  1371
5     1     0    2   97    2  185     7     0    21  272     5
6     0     0    1   21    0    0  2876     3     2    0   164
7     2     0    0  112    0    0     2  1042     3    0     3
8     0     0    0   60    0    4     9    17  1275    3     2
9     2     3   43  123    7   70     9    78   268  502    32
10    0     0    0    0   15    0     0     0     0    0  1631
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_26.png
better model found
persisted
after epoch: 26,now: 2024-07-09 21:28:06.510381,epoch time: 0:30:32.290545,used: 14:15:30.773743,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98392016, 'precision': 0.9610448, 'recall': 0.9589288, 'specificity': 0.9982152, 'f1': 0.959875, 'auroc': 0.9997729}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     0    3    1     0     1     0    0      6
1     0  1322    0     1    0    0     0     6     0    0      3
2     0     0  285     0   19    1     1     0     0    3      3
3     0     1    0  8230    2    8     0    82   109    2      3
4     4     0    5     0  489    0     0     0     1    0     40
5     0     0    1     6    0  481     0     0     0   33      0
6     3     0    0     0    1    0  1888     0     1    0     15
7     2     8    3    36    4    0     0  7158    15    0     37
8     0     2    2     8    4    0     0    13  3224    0     42
9     0     0   32     1    3   10     0     0     0  447      0
10    0     0    0     2    5    0     4     0     2    1  12779
---- Validation: 
scalar performance:
{'acc': 0.98512775, 'precision': 0.9684661, 'recall': 0.9646192, 'specificity': 0.9983463, 'f1': 0.9664644, 'auroc': 0.9998176}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     3    2    0     1     0     0    0      8
1     0  1324    0     1    0    0     1     2     1    0      3
2     0     0  289     0   13    0     0     0     0    6      4
3     1     0    1  8244    0    3     0    78   111    2      0
4     4     0    0     0  491    0     0     0     1    0     43
5     0     0    2     5    0  498     0     0     0   16      0
6     8     0    0     2    1    0  1889     0     4    0      4
7     0     6    1    38    5    0     3  7161    22    0     29
8     2     1    3    13    2    1     0     9  3224    1     40
9     1     0   22     0    2   13     0     0     0  455      0
10    2     0    0     2    2    0     3     0     2    0  12785
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69124746, 'precision': 0.63041335, 'recall': 0.5677486, 'specificity': 0.96893495, 'f1': 0.5518099, 'auroc': 0.8657144}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   913     0    3   50    1    2    33    25    59   29    55
1     6  1218    0   30    0    0    14   183     7    0    41
2    10     3  110    9  153    7     3    62   247   44   367
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0   95    0     4     1    13    0  1519
5     4     0   11  121    7  161     5     0    25  247    11
6     7     0    0   14    0    0  2925     2     2    0   117
7     2     0    0   44    0    0     1  1106     3    1     7
8     0     0    0   50    4    0     5    21  1277    2    11
9    16     0  109  122   10   39    17    98   239  431    56
10    0     0    0    0    2    0     0     0     0    0  1644
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_27.png
early stop counter: 1
val acc:0.9851277470588684, best validation acc: 0.9880166053771973, corresponding to test acc:                         0.6950255632400513 / 0.7416217923164368
after epoch: 27,now: 2024-07-09 21:58:30.711339,epoch time: 0:30:24.200958,used: 14:45:54.974701,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98236835, 'precision': 0.9692683, 'recall': 0.94805545, 'specificity': 0.99802077, 'f1': 0.95767844, 'auroc': 0.9997661}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   399     0    1     1    2    0    48     2     1    1     28
1     0  1322    0     0    0    0     0     8     1    0      1
2     0     0  285     0   12    2     0     0     1    9      3
3     0     3    0  8289    0    5     4   118    15    0      5
4     3     0    4     0  478    0     0     0     2    0     52
5     0     0    0     3    0  507     1     0     1    6      1
6     0     0    0     0    0    0  1900     4     0    0      3
7     0    25    0    83    3    0     1  7105    28    0     19
8     0     0    2    45    2    0     5    18  3205    0     19
9     0     0   15     2    0   29     0     1     0  446      0
10    0     0    0     0    2    0     3     1     5    0  12781
---- Validation: 
scalar performance:
{'acc': 0.98288083, 'precision': 0.9693403, 'recall': 0.94832456, 'specificity': 0.9980869, 'f1': 0.95777977, 'auroc': 0.99979436}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   403     0    0     0    0    1    52     0     0    0     27
1     0  1327    0     0    0    0     0     5     0    0      0
2     0     0  285     0   10    1     1     0     1   10      4
3     0     6    0  8288    0    5     8   118    10    0      5
4     2     0    2     0  484    0     0     1     1    1     48
5     0     0    0     3    0  512     0     0     0    6      0
6     0     0    0     2    0    0  1899     0     1    0      6
7     0    12    0    77    1    0     2  7123    35    2     13
8     0     0    0    53    1    1     1    14  3210    0     16
9     0     0   18     1    0   38     1     0     2  432      1
10    1     0    0     1    3    0     3     0     6    0  12782
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66382146, 'precision': 0.6047199, 'recall': 0.54539406, 'specificity': 0.965534, 'f1': 0.5261335, 'auroc': 0.8714711}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   577     1    1  18    1    2   450    19     7   23    71
1     0  1289    0  16    1    0     2   156     7    0    28
2     1     1   99   7  144   10     7    56   168   22   500
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0   76    0     3     2     6    0  1546
5     1     0    8  87    0  259    40     5    23  154    15
6     1     0    0   2    0    0  2892     0     1    0   171
7     0     0    0   8    0    0     0  1151     0    0     5
8     0     0    0  53    0    1    10    47  1249    1     9
9     6     5  144  95    5  109    57   116   249  255    96
10    0     0    0   0    3    0     2     0     0    0  1641
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_28.png
early stop counter: 2
val acc:0.9828808307647705, best validation acc: 0.9880166053771973, corresponding to test acc:                         0.6950255632400513 / 0.7416217923164368
after epoch: 28,now: 2024-07-09 22:29:01.900448,epoch time: 0:30:31.189109,used: 15:16:26.163810,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9875054, 'precision': 0.96952593, 'recall': 0.96600527, 'specificity': 0.9985913, 'f1': 0.96753716, 'auroc': 0.99985975}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     0    5    0     0     0     0    0     12
1     0  1328    0     0    0    0     0     3     1    0      0
2     0     0  296     0   12    0     0     0     0    2      2
3     1     0    0  8329    0    5     0    82    18    1      1
4     1     1    1     0  487    0     0     0     2    0     47
5     0     0    1     1    0  509     0     0     0    9      1
6    14     0    0     0    1    0  1870     0     1    0     21
7     1    17    2    36    0    0     0  7188    12    0      8
8     0     1    1    21    5    0     0    18  3219    1     30
9     1     0   29     1    1   15     0     0     0  445      1
10    3     0    0     0   10    0     1     0     6    0  12772
---- Validation: 
scalar performance:
{'acc': 0.98710716, 'precision': 0.96482956, 'recall': 0.96575797, 'specificity': 0.9985688, 'f1': 0.9648235, 'auroc': 0.9998562}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    5    0     0     0     0    0      1
1     0  1323    0     0    0    0     0     9     0    0      0
2     0     0  296     0   13    1     0     0     0    2      0
3     0     1    0  8318    0    2     5    99    15    0      0
4     1     0    2     1  493    1     0     0     1    0     40
5     0     0    1     1    0  505     0     0     1   13      0
6    13     0    0     0    1    0  1885     0     1    0      8
7     0    12    4    37    1    0     0  7193     6    0     12
8     0     1    3    19    4    0     0    18  3210    0     41
9     1     0   39     0    0   21     0     0     0  431      1
10    3     1    1     0   12    1     2     2     2    0  12772
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6936962, 'precision': 0.6300349, 'recall': 0.6072218, 'specificity': 0.9690743, 'f1': 0.5836401, 'auroc': 0.8733635}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1101     0    0  21    2    5    12     7     1   13     8
1      3  1279    0  16    3    0     1   163    10    1    23
2     22     0  100   1  329   23     1    33   158   42   306
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    0   0  135    0     0     1     7    0  1488
5      7     0    3  56    6  406     2     0    21   90     1
6     23     0    0   4    2    0  2499     3     1    0   535
7      2     1    0  69    0    1     1  1084     2    0     4
8      1     0    0  24    2    6     3    20  1300    2    12
9     42     4  114  44   66  188     3    63   188  373    52
10     0     0    0   0    8    0     0     0     0    0  1638
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_29.png
early stop counter: 3
val acc:0.9871071577072144, best validation acc: 0.9880166053771973, corresponding to test acc:                         0.6950255632400513 / 0.7416217923164368
after epoch: 29,now: 2024-07-09 22:59:42.129503,epoch time: 0:30:40.229055,used: 15:47:06.392865,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98796016, 'precision': 0.96370465, 'recall': 0.9736464, 'specificity': 0.998729, 'f1': 0.96805936, 'auroc': 0.99987364}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    6    0     0     0     0    2      1
1     0  1328    0     0    0    0     0     3     0    0      1
2     0     0  289     1    1    0     0     2     0   17      2
3     1     0    0  8378    0    2     0    47     9    1      0
4     2     0    4     0  522    1     0     1     0    1      8
5     0     0    0     1    0  484     0     0     0   36      0
6    18     0    1     0    2    1  1871     5     2    1      7
7     0     3    0    50    1    0     0  7198     7    0      4
8     0     1    0    47   10    0     0    23  3209    2      4
9     0     0    3     0    1    5     0     1     0  482      1
10   13     0    1     4   57    1     0    10    13    1  12691
---- Validation: 
scalar performance:
{'acc': 0.98809683, 'precision': 0.96292156, 'recall': 0.97214425, 'specificity': 0.9987539, 'f1': 0.96695817, 'auroc': 0.99988365}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    4    0     0     0     0    2      1
1     0  1328    0     0    0    0     0     4     0    0      0
2     0     0  282     0    2    0     0     1     0   26      1
3     0     0    0  8392    0    5     0    37     6    0      0
4     1     0    6     0  520    0     0     2     1    1      8
5     0     0    0     1    0  490     0     0     0   30      0
6    22     1    0     6    3    0  1858     7     2    4      5
7     0     3    0    55    0    0     0  7200     6    0      1
8     2     0    1    36    7    0     0    24  3221    1      4
9     0     0    2     1    1    7     1     0     1  480      0
10   13     4    1     3   49    1     2    12    18    0  12693
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7051004, 'precision': 0.64474714, 'recall': 0.6016902, 'specificity': 0.9705801, 'f1': 0.58890903, 'auroc': 0.8745164}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   761     0    4   46   26   86    12    52     6  148    29
1     1  1210    0   33    2    0     0   224     9    1    19
2     1     1  132   21  307   33     0    87   189   73   171
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    1  357    1     2     1    17    0  1254
5     1     0    3   77    7  404     1     1     6   91     1
6     9     1    1   21   12    1  2844     8     5    0   165
7     1     0    0   18    0    2     0  1138     0    2     3
8     0     0    0  115    7   22     7    21  1191    4     3
9     1     1   83  141   11  217     4    98   118  425    38
10    0     0    0    0   30    0     0     0     0    0  1616
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716735_30.png
better model found
persisted
after epoch: 30,now: 2024-07-09 23:30:30.653279,epoch time: 0:30:48.523776,used: 16:17:54.916641,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 16:17:54.916641 at 2024-07-09 23:30:30.653279
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7051004, 'precision': 0.64474714, 'recall': 0.6016902, 'specificity': 0.9705801, 'f1': 0.58890903, 'auroc': 0.8745164}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   761     0    4   46   26   86    12    52     6  148    29
1     1  1210    0   33    2    0     0   224     9    1    19
2     1     1  132   21  307   33     0    87   189   73   171
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    1  357    1     2     1    17    0  1254
5     1     0    3   77    7  404     1     1     6   91     1
6     9     1    1   21   12    1  2844     8     5    0   165
7     1     0    0   18    0    2     0  1138     0    2     3
8     0     0    0  115    7   22     7    21  1191    4     3
9     1     1   83  141   11  217     4    98   118  425    38
10    0     0    0    0   30    0     0     0     0    0  1616
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7416218, 'precision': 0.69613636, 'recall': 0.6180458, 'specificity': 0.97391033, 'f1': 0.6215573, 'auroc': 0.88900506}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   890     0    0   20    1    0   137    57     5   31    29
1     0  1319    0    8    1    0     0   166     0    0     5
2     4     5  285   12  283    3    29   131   149   66    48
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    7    0  763    0     2     6    13    1   841
5     0     0    3  134    1  149    26     4    11  262     2
6     1     1    1    3   10    0  2780    10     3    0   258
7     0     0    0    3    0    0     0  1159     0    0     2
8     0     3    0   35    2    0    11    79  1238    1     1
9     6     8  100  104    5   29    28   307    79  467     4
10    0     0    0    0   94    0     0     1     0    1  1550
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_12_35_seed_2_21716735_instance_wise_predictions.txt
accuracy from prediction file 0.7051003987966137
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 458660 KiB |   6809 MiB |   4413 TiB |   4413 TiB |
|       from large pool | 414043 KiB |   6773 MiB |   4359 TiB |   4359 TiB |
|       from small pool |  44617 KiB |     62 MiB |     53 TiB |     53 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 458660 KiB |   6809 MiB |   4413 TiB |   4413 TiB |
|       from large pool | 414043 KiB |   6773 MiB |   4359 TiB |   4359 TiB |
|       from small pool |  44617 KiB |     62 MiB |     53 TiB |     53 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 449784 KiB |   6803 MiB |   4401 TiB |   4401 TiB |
|       from large pool | 407075 KiB |   6767 MiB |   4347 TiB |   4347 TiB |
|       from small pool |  42709 KiB |     60 MiB |     53 TiB |     53 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7496 MiB |   7502 MiB |  20726 MiB |  13230 MiB |
|       from large pool |   7432 MiB |   7438 MiB |  20630 MiB |  13198 MiB |
|       from small pool |     64 MiB |     64 MiB |     96 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 507995 KiB | 703689 KiB |   3413 TiB |   3413 TiB |
|       from large pool | 497316 KiB | 694533 KiB |   3358 TiB |   3358 TiB |
|       from small pool |  10679 KiB |  40275 KiB |     54 TiB |     54 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    6392    |    8370    |  732346 K  |  732340 K  |
|       from large pool |     187    |     783    |  406658 K  |  406658 K  |
|       from small pool |    6205    |    8141    |  325688 K  |  325682 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    6392    |    8370    |  732346 K  |  732340 K  |
|       from large pool |     187    |     783    |  406658 K  |  406658 K  |
|       from small pool |    6205    |    8141    |  325688 K  |  325682 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     343    |     343    |     904    |     561    |
|       from large pool |     311    |     311    |     856    |     545    |
|       from small pool |      32    |      32    |      48    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |    1625    |  463259 K  |  463259 K  |
|       from large pool |      42    |     312    |  295397 K  |  295397 K  |
|       from small pool |      30    |    1584    |  167862 K  |  167862 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6809 MiB |   4413 TiB |   4413 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   4359 TiB |   4359 TiB |
|       from small pool |      0 KiB |     62 MiB |     53 TiB |     53 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6809 MiB |   4413 TiB |   4413 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   4359 TiB |   4359 TiB |
|       from small pool |      0 KiB |     62 MiB |     53 TiB |     53 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6803 MiB |   4401 TiB |   4401 TiB |
|       from large pool |  16640 KiB |   6767 MiB |   4347 TiB |   4347 TiB |
|       from small pool |      0 KiB |     60 MiB |     53 TiB |     53 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    944 MiB |   7502 MiB |  20726 MiB |  19782 MiB |
|       from large pool |    890 MiB |   7438 MiB |  20630 MiB |  19740 MiB |
|       from small pool |     54 MiB |     64 MiB |     96 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 703689 KiB |   3413 TiB |   3413 TiB |
|       from large pool |  24320 KiB | 694533 KiB |   3358 TiB |   3358 TiB |
|       from small pool |      0 KiB |  43006 KiB |     54 TiB |     54 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8370    |  732346 K  |  732346 K  |
|       from large pool |       2    |     783    |  406658 K  |  406658 K  |
|       from small pool |       0    |    8141    |  325688 K  |  325688 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8370    |  732346 K  |  732346 K  |
|       from large pool |       2    |     783    |  406658 K  |  406658 K  |
|       from small pool |       0    |    8141    |  325688 K  |  325688 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      67    |     343    |     904    |     837    |
|       from large pool |      40    |     311    |     856    |     816    |
|       from small pool |      27    |      32    |      48    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1625    |  463261 K  |  463261 K  |
|       from large pool |       3    |     312    |  295397 K  |  295397 K  |
|       from small pool |       0    |    1584    |  167863 K  |  167863 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul  9 23:36:06 2024]
Finished job 0.
1 of 1 steps (100%) done
