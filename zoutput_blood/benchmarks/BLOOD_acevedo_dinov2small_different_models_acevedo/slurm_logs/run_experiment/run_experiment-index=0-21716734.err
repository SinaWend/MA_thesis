Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul  7 18:51:27 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734

 Experiment start at: 2024-07-07 19:02:09.049426
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.08150843530893326
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91855735, 'precision': 0.8256231, 'recall': 0.7788398, 'specificity': 0.99110705, 'f1': 0.7823009, 'auroc': 0.9933406}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   404     0    0     7    0    0     6     1     6    6     53
1     0  1259    1    18    0    0     1    26    18    1      7
2     3     0  138     2   18    4     1     0    18  101     27
3     6     1    2  8032    0   57     6   111   222    1      0
4     8     0   41     1  114    4     0     0    44   13    314
5     2     0    0    20    0  374     0     0    10  114      1
6    52     0    0     3    0    2  1797     1    14    3     36
7     3    34   25   466    1    2     5  6117   574    8     27
8     3     0    5   161    2    8     1    16  3055    7     38
9     6     0   25     6    0   65     1     0     8  374      7
10   28     0    2     8    2    0     7     7    69    3  12668
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9195399, 'precision': 0.8262143, 'recall': 0.7795979, 'specificity': 0.9912045, 'f1': 0.7844399, 'auroc': 0.99330723}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   402     0    0     9    0    0     4     2     7    4     55
1     0  1265    0    20    0    0     1    28    12    0      6
2     1     0  136     3   19    6     1     1    14  103     28
3     3     1    3  8048    0   61     5   107   210    2      0
4    13     0   36     0  129    2     0     1    54   13    291
5     1     0    3    22    0  375     1     0     6  111      2
6    55     0    0     3    0    1  1795     1    14    0     39
7     2    42   24   470    1    2     6  6131   538   16     33
8     2     0    7   167    0   13     1    20  3040    5     41
9     2     0   23     6    0   76     2     0     7  368      9
10   22     0    3     7    3    2     6     9    54    2  12688
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6573148, 'precision': 0.6203185, 'recall': 0.5806288, 'specificity': 0.96531236, 'f1': 0.55619717, 'auroc': 0.8729209}
confusion matrix:
      0     1    2   3   4    5     6     7     8    9     10
0   1050     0    0  20   0    2    19    17    20    6    36
1      6  1188    1  31   0    0     0   206    23    1    43
2     21     0  108   2   7    9     0    20   239   36   573
3      0     0    0   0   0    0     0     0     0    0     0
4      0     0    1   0   2    0     1     1    14    0  1614
5     14     0    0  57   0  353     0     0    26  120    22
6     10     0    1   1   0    0  2219     1    41    0   794
7      7     4    1  11   0    1     0  1110    23    0     7
8      2     0    1  42   0    6     0     1  1310    1     7
9     35     1  164  60   0   81     1    50   216  409   120
10     0     0    0   0   0    0     0     0     0    0  1646
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-07 19:41:07.937583,epoch time: 0:38:58.888157,used: 0:38:58.888157,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9333262, 'precision': 0.86289257, 'recall': 0.7733015, 'specificity': 0.9927264, 'f1': 0.78452444, 'auroc': 0.9952581}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   374     0   0     6    0    0     5     2     4    0     92
1     0  1242   0    12    0    0     0    59     9    0     10
2     2     0  55     0  150    0     2    15     7   76      5
3     0     1   0  7836    0    4     9   246   336    3      2
4     1     0   1     1  336    0     1     2    14    6    177
5     5     0   0    39    4  214     0     1    13  243      2
6    20     0   0     3    4    1  1785     1     6    3     84
7     0    11   0   188   11    0     3  6815   210    2     23
8     1     0   0    46   30    0     0    34  3110    4     71
9     6     0  10    12   27    3     0     4     7  419      5
10    4     1   0     6   44    0     4    10    24    2  12698
---- Validation: 
scalar performance:
{'acc': 0.93146986, 'precision': 0.8612728, 'recall': 0.7727584, 'specificity': 0.9925437, 'f1': 0.7829293, 'auroc': 0.9952459}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   378     0   0     2    0    0     6     2     6    1     88
1     0  1255   0    10    0    0     0    56     6    0      5
2     3     0  52     2  146    0     0    16     4   82      7
3     1     0   0  7796    2    7    15   274   340    3      2
4     2     0   2     0  332    0     0     3    16    8    176
5     3     0   0    37    5  221     0     0    16  237      2
6    18     0   0     3    1    0  1790     2     6    1     87
7     2     9   0   198    5    0     2  6808   226    0     15
8     2     0   2    57   34    1     4    46  3086    1     63
9     7     0   4     9   29    7     1     9     7  415      5
10    2     0   0     8   56    0     5     9    25    1  12690
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5870006, 'precision': 0.5795338, 'recall': 0.50607216, 'specificity': 0.9580036, 'f1': 0.47434822, 'auroc': 0.8633365}
confusion matrix:
      0     1   2   3    4   5     6     7     8    9     10
0   1091     0   0  12    0   0     7     9     1    1    49
1      4  1000   0  20    0   0     2   386    13    0    74
2     25     1   2   3  342   0     1    40    81   30   490
3      0     0   0   0    0   0     0     0     0    0     0
4      0     0   0   0   76   0     1     1     1    0  1554
5     48     0   0  43   14  64     0     2    27  356    38
6      0     0   0   1    0   0  1715     0     3    0  1348
7      1     0   0   4    0   0     0  1145     7    1     6
8      2     0   0  20   21   0    14    11  1236    4    62
9     89     0  13  13  151   2     2   164   125  417   161
10     0     0   0   0    2   0     0     0     0    0  1644
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_2.png
better model found
persisted
after epoch: 2,now: 2024-07-07 20:17:12.097171,epoch time: 0:36:04.159588,used: 1:15:03.047745,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93346, 'precision': 0.8531494, 'recall': 0.80826676, 'specificity': 0.99273455, 'f1': 0.80632746, 'auroc': 0.99635386}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     3    0    0     0    12     0    9      7
1     0  1235    0     9    0    0     0    86     1    0      1
2     1     0  197     1    4    1     1    22     1   84      0
3     1     0    0  7792    0    6     2   547    82    7      1
4    17     0  124     1  170    0     0    19    16   17    175
5     0     0    0    40    0  266     0     1     3  210      1
6    43     0    0     9    0    0  1824     8     0    4     20
7     0     5    1    73    0    0     1  7162    15    0      7
8     8     0    3   114    3    0     1   285  2788   14     79
9     3     0   20     6    0   19     1    12     0  432      0
10  113     0   20     7    9    0     5    42    12   12  12571
---- Validation: 
scalar performance:
{'acc': 0.933904, 'precision': 0.8569425, 'recall': 0.8104815, 'specificity': 0.9927708, 'f1': 0.808462, 'auroc': 0.9964098}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     0    1     5    0    0     2    12     0    6     14
1     0  1236    0     9    0    0     0    82     1    0      4
2     1     0  203     1    1    0     1    23     1   80      1
3     2     0    0  7787    0    4     0   548    93    6      0
4    16     0  126     0  170    2     0    16    13   21    175
5     2     0    0    37    0  262     0     0     5  214      1
6    40     0    1     3    1    0  1822    17     1    3     20
7     1     8    1    66    1    0     1  7168    14    0      5
8     9     0    6   124    5    0     2   285  2774    9     82
9     2     0   20     5    0    9     0     8     0  449      0
10  101     0   21     6   10    0     3    33    11   11  12600
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6992234, 'precision': 0.68974555, 'recall': 0.57628024, 'specificity': 0.96987724, 'f1': 0.5490161, 'auroc': 0.8833866}
confusion matrix:
     0     1    2    3   4   5     6     7     8    9     10
0   993     0    0   58   0   0     2    90     1   23     3
1     0  1147    0   20   0   0     0   315     3    0    14
2    40     0  227   13  22   0     0   183   204  112   214
3     0     0    0    0   0   0     0     0     0    0     0
4     6     0    4    0  40   0     1     3    10    1  1568
5     0     0    0  143   0  76     0     3    27  342     1
6    14     0    0    7   0   0  2886     1     4    0   155
7     0     0    0    7   0   0     0  1154     1    0     2
8     0     0    1   48   1   0     0    42  1266    2    10
9     4     1   66   70   0   4     0   299   109  561    23
10    0     0    0    0   2   0     0     0     0    0  1644
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-07 20:53:14.620899,epoch time: 0:36:02.523728,used: 1:51:05.571473,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94426906, 'precision': 0.8949508, 'recall': 0.80385035, 'specificity': 0.9936478, 'f1': 0.8342829, 'auroc': 0.9964813}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   415     0    0     3    0    0    24     5     1    3     32
1     0  1202    0     9    0    0     0   106     3    0     11
2     2     0  151     2   38    2     0    14    10   65     28
3     1     0    0  8055    0    8     5   301    66    1      0
4     7     0    2     0  195    1     0     5    28   10    291
5     0     0    0    54    1  331     0     1     7  126      1
6    12     0    0     2    0    0  1843     5     3    1     40
7     0     3    0   172    1    0     4  7036    39    0     10
8     2     0    1   202    1    0     4    91  2962    1     32
9     2     0   24    12    1   31     1    11     4  403      4
10   21     0    1     6    5    0     6    15    38    1  12700
---- Validation: 
scalar performance:
{'acc': 0.94267756, 'precision': 0.8883582, 'recall': 0.80432564, 'specificity': 0.993479, 'f1': 0.83300334, 'auroc': 0.99645203}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   418     0    0     4    0    0    18     6     1    2     34
1     0  1194    0    10    0    0     0   111     2    0     15
2     1     0  151     0   51    0     1    20    10   66     12
3     3     1    0  8038    0    5     8   305    79    1      0
4     5     0    9     1  181    0     0     6    36   12    289
5     1     0    0    44    0  352     0     0     9  114      1
6    11     0    1     4    1    0  1842     4     5    1     39
7     1     4    0   168    2    0     2  7029    47    0     12
8     1     0    4   222    3    0     2    90  2930    0     44
9     1     0   21    10    1   34     0    10     5  406      5
10   20     0    0     7    4    0     6    17    39    2  12701
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5963059, 'precision': 0.6033757, 'recall': 0.5079773, 'specificity': 0.95935607, 'f1': 0.47260112, 'auroc': 0.86458313}
confusion matrix:
      0    1   2    3   4   5     6     7     8    9     10
0   1062    0   0   23   0   1    14    48     2   10    10
1      3  746   0   20   0   0     0   661    11    0    58
2      9    0  54   14  30   1     0   110   287   65   445
3      0    0   0    0   0   0     0     0     0    0     0
4      2    0   0    0   5   0     0     2    25    0  1599
5      4    0   0  145   0  94     0     2    43  299     5
6      1    0   0    7   0   0  2067     4     2    0   986
7      1    0   0   12   0   0     1  1147     0    0     3
8      0    0   0   82   0   0     3    17  1263    1     4
9     10    0  47  115   0   6     0   191   257  439    72
10     0    0   0    0   0   0     0     0     0    0  1646
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_4.png
better model found
persisted
after epoch: 4,now: 2024-07-07 21:29:29.011033,epoch time: 0:36:14.390134,used: 2:27:19.961607,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94584763, 'precision': 0.8718421, 'recall': 0.83144706, 'specificity': 0.99391127, 'f1': 0.8374948, 'auroc': 0.997025}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     1    0    0     2     3     0    2     31
1     0  1261    0     7    0    0     0    52     5    0      6
2     4     0  158     0   16    2     1     1     0  122      7
3     6     1    0  7949    0   70     2   244   151   15      1
4     4     0   36     0  197    2     1     2     9   21    266
5     1     0    0     7    0  462     0     0     3   47      1
6    26     0    1     4    1    1  1837     2     1    2     33
7     2     9    5   136    1    1     3  6981    68   13     44
8     3     0    4    75    3   25     1    56  2945   19    164
9     5     0    7     3    0   99     0     0     1  376      2
10   20     0    0     7    3    1     8     4     5    4  12742
---- Validation: 
scalar performance:
{'acc': 0.9456734, 'precision': 0.8768358, 'recall': 0.8360621, 'specificity': 0.99386656, 'f1': 0.8432362, 'auroc': 0.9970306}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     0    0     1    0    0     3     2     0    4     31
1     0  1269    1     6    0    2     0    45     5    0      4
2     1     0  165     0   13    3     0     3     1  114     12
3     6     1    0  7945    0   53     2   263   150   15      5
4     5     0   33     0  213    2     1     2     7   20    256
5     3     0    0     7    0  472     0     0     3   35      1
6    25     0    0     4    0    1  1837     6     2    4     29
7     1     9    8   125    2    2     2  6967    74   13     62
8     4     0    3    75    3   28     2    63  2923   24    171
9     3     0    7     4    0  104     1     0     1  371      2
10   17     0    2     7    1    0     5     5     3    6  12750
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7368642, 'precision': 0.64377964, 'recall': 0.63693273, 'specificity': 0.97338396, 'f1': 0.6051661, 'auroc': 0.8775789}
confusion matrix:
      0     1    2   3   4    5     6     7     8    9     10
0   1146     0    0   1   0    0     3     4     2    5     9
1      4  1115    0  17   0    2     0   314    10    3    34
2     33     0  147   2  18   16     0    36    80  127   556
3      0     0    0   0   0    0     0     0     0    0     0
4      3     0    0   0   4    0     1     0     4    0  1621
5     18     0    0   8   0  389     0     1     4  170     2
6      2     0    0   0   0    0  2995     0     0    0    70
7      3     0    0   3   0    1     0  1148     3    3     3
8      1     0    1  16   0   27     5    11  1285   10    14
9     40     0  107  14   0   99     1    76    79  657    64
10     0     0    0   0   0    0     0     0     0    0  1646
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-07 22:05:26.983801,epoch time: 0:35:57.972768,used: 3:03:17.934375,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95761985, 'precision': 0.88254774, 'recall': 0.87350273, 'specificity': 0.99539965, 'f1': 0.8739153, 'auroc': 0.9979524}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   427     1    0     4    2    0     6     3     1    3     36
1     0  1281    1     8    0    0     0    40     2    0      0
2     1     0  185     1   21    0     1     2     1   96      4
3     0     1    1  8252    0   15     1   112    48    7      2
4     1     0   35     1  392    0     0     2     3   14     91
5     0     0    0     8    2  384     0     0     4  121      2
6     9     0    0     2    1    1  1874     1     2    1     16
7     0    12    8   181    1    0     1  7015    31    4      9
8     1     0    9   155   55    2     0    65  2920   12     76
9     0     0   13     3    0   27     0     0     1  447      2
10    6     0    3     7  136    0     7     9     7    3  12615
---- Validation: 
scalar performance:
{'acc': 0.9560519, 'precision': 0.87997925, 'recall': 0.86760974, 'specificity': 0.9952198, 'f1': 0.86846066, 'auroc': 0.9980264}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     0    0     3    1    0     1     1     0    3     44
1     0  1275    0     8    0    0     0    45     3    0      1
2     0     0  167     0   30    0     0     0     0  112      3
3     0     5    1  8241    0   12     2   116    56    7      0
4     2     0   31     0  390    1     0     0     4   13     98
5     1     0    1    17    0  377     0     0     3  121      1
6     9     0    0     2    1    1  1875     2     1    1     16
7     2    13    8   175    1    0     1  7015    34    5     11
8     1     0    6   168   48    5     0    65  2910   11     82
9     2     0    8     4    0   25     0     0     0  454      0
10    4     1    7     7  145    1     7    10     5    1  12608
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7747149, 'precision': 0.7087762, 'recall': 0.6462858, 'specificity': 0.97730404, 'f1': 0.641806, 'auroc': 0.8889667}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1101     0    0   9    2    3    11    13     1   24     6
1      0  1162    0  12    0    0     0   313     3    0     9
2     17     0  178   2  344    1     6    51    93  125   198
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    0   0  689    0     8     1     3    0   932
5      3     0    1  19    2  168     0     2     8  383     6
6      0     0    0   0    0    0  3060     1     0    1     5
7      0     0    0  18    0    0     2  1141     1    1     1
8      0     0    1  45    7    5     1    17  1278    7     9
9      9     1   94  28   17   13     1    92    93  758    31
10     0     0    0   0  106    0     1     1     0    0  1538
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-07 22:41:29.218011,epoch time: 0:36:02.234210,used: 3:39:20.168585,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95537245, 'precision': 0.90406686, 'recall': 0.86085814, 'specificity': 0.9949444, 'f1': 0.87925965, 'auroc': 0.9980898}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   397     0    0     4    2    0     7     1     0    2     70
1     0  1290    0     7    0    1     0    31     2    0      1
2     0     0  176     0   81    1     2     2     2   38      9
3     1     0    0  7949    3   33     7   336   100    5      3
4     1     2    6     0  339    2     0     2     2    1    184
5     1     0    0     5    3  453     0     0     4   54      1
6     5     0    1     0    1    0  1872     5     1    1     22
7     0    31    0    57    1    0     3  7132    24    1     15
8     1     0    1    57   15    5     3   141  2951    3    117
9     0     1   31     2    7   43     1     2     2  403      1
10    1     3    1     8   14    0     4    11     5    1  12746
---- Validation: 
scalar performance:
{'acc': 0.95487493, 'precision': 0.90055364, 'recall': 0.85715747, 'specificity': 0.99489737, 'f1': 0.8756908, 'auroc': 0.9980266}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   398     0    0     2    1    0     8     1     0    3     70
1     0  1299    0     6    0    0     0    24     2    0      1
2     1     0  177     0   78    0     1     6     2   40      7
3     0     1    0  7935    0   37    11   352    96    8      0
4     1     2    4     0  336    1     0     3     7    2    183
5     0     0    0     6    4  440     0     0     4   66      1
6     4     0    0     1    1    0  1873     3     1    1     24
7     0    40    0    44    1    0     1  7145    22    0     12
8     0     1    0    63   20    4     3   126  2951    2    126
9     0     0   37     4    6   42     2     0     3  393      6
10    0     3    1     8   17    1     2    10     3    0  12751
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72518015, 'precision': 0.6187922, 'recall': 0.60256493, 'specificity': 0.9720185, 'f1': 0.577086, 'auroc': 0.8689163}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1027     0   0   8    1    0    65    26     1    4    38
1      2  1345   0   6    0    2     0   132     4    0     8
2      3     4  44   0  209    3    11    48    91   56   546
3      0     0   0   0    0    0     0     0     0    0     0
4      0     0   0   0   31    0     6     1     1    0  1594
5      2     0   3  19    5  218     7     2    12  319     5
6      0     0   0   1    0    0  3057     2     0    0     7
7      0     6   0   5    0    0     2  1148     0    1     2
8      1     0   0  20    1    6    17    38  1253    5    29
9     10    15  98   8   28   29     7   110   142  599    91
10     0     0   0   0    0    0     3     0     0    0  1643
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_7.png
early stop counter: 1
val acc:0.9548749327659607, best validation acc: 0.9560518860816956, corresponding to test acc:                         0.7747148871421814 / 0.7747148871421814
after epoch: 7,now: 2024-07-07 23:17:44.692161,epoch time: 0:36:15.474150,used: 4:15:35.642735,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94988763, 'precision': 0.8930565, 'recall': 0.87656415, 'specificity': 0.99468195, 'f1': 0.8813007, 'auroc': 0.9978005}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    0     3    1    3     5     1     6    4     23
1     0  1282    0    14    0    0     0    29     7    0      0
2     0     0  186     0   21    1     0     1    23   79      1
3     0     1    1  8274    0   26     0    44    92    1      0
4     6     0   15     1  368    3     1     4    51    4     85
5     0     0    0    13    0  444     0     0     4   59      1
6    11     0    1     4    3    1  1869     3     7    1      8
7     2    15    5   399    1    0     1  6522   306    3      7
8     0     0    0    78    2    3     0    10  3200    3      0
9     0     0    7     1    1   60     0     0    12  412      0
10   16     0    3     7   75    1    11    13   155    3  12509
---- Validation: 
scalar performance:
{'acc': 0.9492042, 'precision': 0.8930514, 'recall': 0.8782391, 'specificity': 0.9946177, 'f1': 0.88139504, 'auroc': 0.9978801}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     3    2    2     4     1     5    5     17
1     0  1283    0    10    0    0     2    26    10    0      1
2     0     0  184     1   26    2     0     1    19   78      1
3     0     0    0  8274    0   22     1    43    97    3      0
4     5     0   12     0  378    3     0     3    50    3     85
5     1     0    0     9    0  433     0     0     5   72      1
6    10     0    0     5    2    1  1872     1     3    0     14
7     0    11    5   400    1    0     1  6521   313    6      7
8     1     0    0    82    3    3     0     8  3196    1      2
9     0     0    3     1    1   57     1     0    10  420      0
10   17     0    2     9   95    1    12    15   159    5  12481
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70810884, 'precision': 0.6805388, 'recall': 0.59164333, 'specificity': 0.9707564, 'f1': 0.57107544, 'auroc': 0.87685174}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   929     0   0  21    3   25     8    40    21  108    15
1     4  1099   0  34    1    1     0   303    24    3    30
2     3     0  72  12   73   15     6    19   499   96   220
3     0     0   0   0    0    0     0     0     0    0     0
4     1     0   0   0  163    0     4     1    48    0  1416
5     0     0   0  67    0  303     0     0    25  197     0
6     0     0   0   3    0    0  3053     1     2    0     8
7     4     0   0  63    0    0     0  1070     8   14     5
8     1     0   0  86    0    3     0     0  1273    6     1
9     4     0  14  85    1   94     1    35   344  525    34
10    0     0   0   0    9    0     3     0     0    0  1634
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_8.png
early stop counter: 2
val acc:0.9492042064666748, best validation acc: 0.9560518860816956, corresponding to test acc:                         0.7747148871421814 / 0.7747148871421814
after epoch: 8,now: 2024-07-07 23:53:18.477463,epoch time: 0:35:33.785302,used: 4:51:09.428037,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9586633, 'precision': 0.9147599, 'recall': 0.8799621, 'specificity': 0.99543273, 'f1': 0.89418733, 'auroc': 0.9984843}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   449     0    0     3    1    1     1     0     1    3     24
1     0  1259    0    13    0    0     0    50     7    0      2
2     3     0  190     5   27    3     0     0     6   74      4
3     2     0    0  8329    0    4     1    27    73    2      0
4     5     0   15     1  360    1     2     2    25    4    124
5     0     0    1    21    0  458     0     0     3   37      1
6     4     0    0     5    3    0  1877     0     6    0     12
7     2     4    3   426    1    0     3  6673   140    5      6
8     1     0    0    99    4    3     0    22  3145    3     17
9     0     0   14     6    1   69     0     0     3  400      0
10    5     1    2     9   24    0     7    13    43    0  12691
---- Validation: 
scalar performance:
{'acc': 0.9586198, 'precision': 0.9136678, 'recall': 0.874895, 'specificity': 0.9954248, 'f1': 0.89072, 'auroc': 0.9984762}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    0     1    1    2     6     1     1    3     28
1     0  1259    0    16    0    0     0    46     8    0      3
2     2     0  190     1   27    1     0     0     3   86      2
3     2     0    0  8325    0    4     2    32    75    0      0
4     4     0   21     0  352    1     1     2    24    6    128
5     0     0    0    25    1  451     0     0     7   34      3
6     8     0    0     1    0    0  1885     0     1    1     12
7     0     2    2   428    1    0     4  6682   138    2      6
8     0     0    0    87    0    1     1    19  3166    3     19
9     1     0   12     6    0   77     0     0     5  391      1
10    7     0    0     9   22    0     7    12    42    0  12697
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6692787, 'precision': 0.6481042, 'recall': 0.5395088, 'specificity': 0.9668877, 'f1': 0.50970906, 'auroc': 0.8724655}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   982     0   0   54   0    1    37    34    14    4    44
1     2  1044   0   33   0    0     3   360    25    0    32
2     7     0  29   15  36    3     7    23   481   21   393
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    0  28    0     3     1    29    0  1572
5     4     0   0  221   0  158     1     0    60  126    22
6     0     0   0    3   0    0  3054     0     0    0    10
7     2     0   0   87   0    0     0  1057    15    0     3
8     0     0   0   48   0    0     1     2  1315    0     4
9    10     0  14  191   2   40     1    51   500  253    75
10    0     0   0    0   0    0     0     0     0    0  1646
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_9.png
better model found
persisted
after epoch: 9,now: 2024-07-08 00:28:51.246984,epoch time: 0:35:32.769521,used: 5:26:42.197558,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9583958, 'precision': 0.91607326, 'recall': 0.8513023, 'specificity': 0.9953965, 'f1': 0.86946505, 'auroc': 0.99852055}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     1    0    0     3     5     1    0     10
1     0  1233    0    21    0    0     0    67     6    0      5
2     7     0  190     1   14    0     0    10     3   81      6
3     0     0    0  8317    0    4     0    49    68    1      0
4    11     0   22     1  250    0     1    10    46   11    187
5     5     0    1    37    0  332     0     0     8  137      1
6    10     0    1    17    0    0  1858     5     9    0      8
7     1     3    0   251    1    0     1  6954    48    0      4
8     1     0    0   124    1    0     0    44  3113    3      9
9     5     0   10    10    0    9     0     1     5  453      0
10   33     0    0     8    3    0     6    17    64    2  12658
---- Validation: 
scalar performance:
{'acc': 0.95856625, 'precision': 0.91708463, 'recall': 0.8521601, 'specificity': 0.9954268, 'f1': 0.87011045, 'auroc': 0.99841493}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     5    0    0     0     2     2    1      6
1     0  1243    0    21    0    0     0    64     1    0      3
2     2     0  185     2   12    0     0     9    15   83      4
3     0     0    0  8299    0    4     0    64    70    3      0
4     9     0   18     0  254    0     0     7    58    6    187
5     5     0    0    36    0  334     0     0     7  138      1
6     9     0    1    10    0    0  1872     3     7    0      6
7     0     4    0   243    1    0     2  6962    46    1      6
8     1     0    1   122    0    0     0    52  3110    2      8
9     9     0   10     6    0   10     0     2     6  450      0
10   39     0    2     9    2    0     7    15    60    2  12660
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6794935, 'precision': 0.6172898, 'recall': 0.5477275, 'specificity': 0.9677495, 'f1': 0.51014346, 'auroc': 0.8711923}
confusion matrix:
      0    1   2    3   4   5     6     7     8    9     10
0   1083    0   0   27   1   0    25    28     4    0     2
1      3  963   0   21   0   0     2   422    16    0    72
2     51    0  65    8  60   1    46    88   299   65   332
3      0    0   0    0   0   0     0     0     0    0     0
4      4    0   0    0  14   0    22     3    17    0  1573
5     37    0   1  114   3  80     4     0    38  311     4
6      0    0   0    3   0   0  3062     0     0    0     2
7      2    0   0   93   0   0     1  1062     2    0     4
8      1    0   0   65   0   0     3    17  1278    1     5
9     69    0  39   76   4   7     9   121   300  466    46
10     0    0   0    0   0   0     7     0     0    0  1639
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_10.png
early stop counter: 1
val acc:0.9585662484169006, best validation acc: 0.9586197733879089, corresponding to test acc:                         0.6692786812782288 / 0.7747148871421814
after epoch: 10,now: 2024-07-08 01:04:43.261912,epoch time: 0:35:52.014928,used: 6:02:34.212486,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96492404, 'precision': 0.91632277, 'recall': 0.91250896, 'specificity': 0.99613965, 'f1': 0.912554, 'auroc': 0.99902236}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0     3    4    0     5     1     0    4     35
1     0  1313    0     8    0    0     0     9     1    0      1
2     0     0  255     0   17    1     0     0     0   37      2
3     0     0    1  8335    0    1     0    83    15    3      0
4     1     0   19     0  449    1     0     2     2    2     62
5     0     0    1    16    0  419     0     0     1   83      1
6     4     1    1     4    3    0  1878     1     1    1     14
7     0    45    4   211    1    0     1  6978    12    2     11
8     1     1    7   182   37    0     0   111  2911    6     40
9     0     0   25     3    0   21     0     1     0  442      0
10    2     2    1     9  107    1     5     5     5    0  12654
---- Validation: 
scalar performance:
{'acc': 0.96538717, 'precision': 0.9150894, 'recall': 0.9094158, 'specificity': 0.9961971, 'f1': 0.9107121, 'auroc': 0.99898374}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   433     0    0     4    6    0     2     0     0    2     36
1     0  1312    0     9    0    0     0    11     0    0      0
2     0     0  256     0   25    1     0     2     0   28      0
3     0     0    1  8322    0    4     0    94    18    1      0
4     2     0   17     1  447    0     0     2     2    1     67
5     0     0    0    18    1  409     0     0     3   89      1
6     4     1    1     2    2    1  1883     2     2    0     10
7     0    42    2   180    2    0     1  7013    11    2     12
8     1     3    4   165   36    2     0   115  2916    9     45
9     0     0   25     2    2   31     0     1     1  431      0
10    4     3    1     9   97    0     3     3     6    1  12669
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.717694, 'precision': 0.67735165, 'recall': 0.59412265, 'specificity': 0.97177804, 'f1': 0.6127571, 'auroc': 0.8786592}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   881     0    2   24    8    1   174    5     0   60    15
1     3  1268    3   31    1    0     2  174     2    1    14
2     5     2  235   23  410    7     5   32    76   71   149
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    1    1  366    0     2    1     4    0  1258
5     0     0    0   99    3  251     4    0     4  231     0
6     1     0    0    2    0    0  3057    1     0    0     6
7     1     0    5  363    0    0     4  783     2    5     1
8     0     0    2  138    4    1     6   21  1187    7     4
9     4     2  164  104   31   63     2   72    59  611    25
10    0     0    0    0   25    0     2    0     0    0  1619
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_11.png
better model found
persisted
after epoch: 11,now: 2024-07-08 01:40:42.804216,epoch time: 0:35:59.542304,used: 6:38:33.754790,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9706496, 'precision': 0.91915226, 'recall': 0.9027793, 'specificity': 0.9968285, 'f1': 0.9067196, 'auroc': 0.99906194}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    1     1    2    0     1     2     0    3     13
1     0  1305    0     3    0    0     0    23     1    0      0
2     0     0  261     0   15    0     0     4     3   27      1
3     0     3    1  8247    0    3     0   125    57    3      0
4     7     1   36     0  389    0     0     1    12    2     91
5     0     0    4    35    0  343     0     0     4  134      1
6     9     1    0     1    1    0  1886     1     3    0      6
7     1    23    0    71    1    0     2  7143    16    0      6
8     0     2    4    59    7    0     1    98  3099    3     23
9     0     0   35     2    1    9     1     2     0  442      1
10    8     0    4     8   41    0     4     9    13    0  12704
---- Validation: 
scalar performance:
{'acc': 0.9703892, 'precision': 0.91800725, 'recall': 0.9068787, 'specificity': 0.9968031, 'f1': 0.9091127, 'auroc': 0.99899673}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     0    3    0     1     1     0    2      9
1     0  1302    1     3    0    0     0    23     2    0      1
2     0     0  268     0   14    1     0     6     1   22      0
3     0     5    0  8251    0    2     0   125    54    3      0
4     6     0   25     1  399    0     0     1    14    2     91
5     0     0    2    26    0  359     0     0     6  127      1
6     8     1    0     1    2    0  1885     2     2    2      5
7     0    16    2    73    2    0     2  7149    17    0      4
8     1     1    6    64   11    0     2   106  3076    1     28
9     0     0   47     5    2   10     0     1     0  428      0
10   12     0    7     8   42    0     9     7    16    1  12694
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7349052, 'precision': 0.6491998, 'recall': 0.60322964, 'specificity': 0.9731554, 'f1': 0.59496933, 'auroc': 0.87834156}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   933     0    2  44    8    0   116    32     9   19     7
1     0  1389    0   6    0    0     0    94     1    1     8
2     8     1  206   0  372    3    20    31   190   43   141
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  259    0     8     2    10    0  1354
5     0     0   30  60   24  148     1     2    26  301     0
6     0     0    0   0    0    0  3065     0     0    0     2
7     1     1    1  21    0    0     3  1135     0    0     2
8     0     0    0  30    4    1     4    18  1306    6     1
9     7     5  336  32   33   21     7    83   154  437    22
10    0     0    0   0   16    0     4     0     0    0  1626
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_12.png
better model found
persisted
after epoch: 12,now: 2024-07-08 02:16:52.667850,epoch time: 0:36:09.863634,used: 7:14:43.618424,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.962409, 'precision': 0.9083303, 'recall': 0.8479751, 'specificity': 0.9957887, 'f1': 0.8594583, 'auroc': 0.99869746}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   428     1   0     4    0    0     4     2     0    1     43
1     0  1315   0     2    0    0     0    12     1    0      2
2     0     0  87     0   93    4     0     3     1  113     11
3     0     8   0  8193    1   20     0   142    71    2      1
4     4     0   0     0  354    1     0     0     6    1    172
5     0     0   0     6    1  497     0     0     4   12      1
6     7     1   0     4    1    2  1825     3     0    1     63
7     1    39   0   105    3    0     1  7051    35    0     29
8     0     6   0    45   12    5     1    39  3110    9     68
9     1     0   3     5    1  123     0     1     0  357      2
10    1     0   0     7   13    0     2     2    14    0  12754
---- Validation: 
scalar performance:
{'acc': 0.963916, 'precision': 0.91339904, 'recall': 0.8559618, 'specificity': 0.99594986, 'f1': 0.86785483, 'auroc': 0.99878424}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   439     0   0     3    1    0     0     0     0    2     38
1     0  1316   0     3    0    0     0    12     0    0      1
2     0     0  97     0   83    3     0     5     0  116      8
3     0     7   0  8224    1   19     0   116    70    2      1
4     3     0   1     0  358    1     0     1     6    3    166
5     0     0   0    11    0  499     0     0     1    9      1
6    12     1   0     6    2    2  1839     3     0    0     43
7     0    34   0   123    3    0     0  7034    35    5     31
8     0     3   0    47    4    5     0    54  3104    5     74
9     0     0   2     5    1  116     0     0     1  365      3
10    1     0   0     7   11    0     2     4     9    1  12761
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72070247, 'precision': 0.6301396, 'recall': 0.61413735, 'specificity': 0.9718799, 'f1': 0.57748306, 'auroc': 0.8732045}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1058     0   0  18    2    5     8    37     5    5    32
1      3  1345   0  11    1    1     1   101     5    0    31
2     21     3  14  10  265   41     2    46   169   65   379
3      0     0   0   0    0    0     0     0     0    0     0
4      0     0   0   0   55    0     2     1     8    0  1567
5     12     1   0  58    1  421     1     2     6   75    15
6      0     0   0   3    0    0  2999     0     0    0    65
7      3     4   1  71    1    0     5  1062     4    8     5
8      0     6   0  49    1   11     6     4  1278    1    14
9     32    22  10  54   30  272     4    80   131  424    78
10     0     0   0   0    1    0     0     0     0    0  1645
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_13.png
early stop counter: 1
val acc:0.963916003704071, best validation acc: 0.970389187335968, corresponding to test acc:                         0.7349051833152771 / 0.7747148871421814
after epoch: 13,now: 2024-07-08 02:52:59.033933,epoch time: 0:36:06.366083,used: 7:50:49.984507,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9673587, 'precision': 0.9348193, 'recall': 0.8933055, 'specificity': 0.99634373, 'f1': 0.910298, 'auroc': 0.99897915}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     2    0    1     5     2     1    0     28
1     0  1297    0     2    0    0     0    30     1    0      2
2     2     0  209     1   13    2     0     8     2   68      7
3     0    11    0  8153    0    4     4   169    98    0      0
4     5     0   21     1  350    1     0     1    24    3    133
5     1     0    0    19    0  460     0     0     2   37      2
6     5     0    0     2    0    0  1870     1     2    0     28
7     0    17    1   109    0    0     2  7078    43    1     14
8     0     2    0    64    3    1     0    52  3133    4     36
9     1     0    5     2    1   45     5     2     2  426      4
10    4     0    2     6    9    0     1    10    21    0  12736
---- Validation: 
scalar performance:
{'acc': 0.96758056, 'precision': 0.92981017, 'recall': 0.8878265, 'specificity': 0.99638224, 'f1': 0.9040873, 'auroc': 0.9989619}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    0     1    0    0     6     0     0    1     24
1     0  1294    0     0    0    0     0    33     1    0      4
2     3     0  196     2   11    1     1     8     0   81      9
3     1     7    0  8167    0    3     8   162    91    0      1
4     7     0   25     1  332    0     0     4    23    3    144
5     0     0    1    15    0  455     1     0     3   45      1
6     6     0    0     0    1    0  1867     1     4    0     29
7     0    20    1   103    0    0     0  7079    50    0     12
8     0     3    1    51    0    0     0    47  3160    1     33
9     2     0    6     3    0   48     0     3     3  428      0
10    3     0    1     7   13    0     1    10    17    0  12744
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6855104, 'precision': 0.6520932, 'recall': 0.5586168, 'specificity': 0.96794176, 'f1': 0.5319483, 'auroc': 0.8750145}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   710     0   1   11   0    0   226    49     3    0   170
1     1  1287   0    6   0    0     1   138    13    1    52
2     1     0  57    4  38   11     5    97   312   22   468
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    0  54    0     2     0    21    0  1556
5     4     0   1  110   1  207    20     9    43  146    51
6     0     0   0    1   0    0  3024     1     1    0    40
7     0     0   0    6   0    0     1  1148     7    0     2
8     0     4   0   14   0    1     9    25  1313    0     4
9     6     0  51   41   1   48    18   233   263  353   123
10    0     0   0    0   1    0     0     0     0    0  1645
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_14.png
early stop counter: 2
val acc:0.9675805568695068, best validation acc: 0.970389187335968, corresponding to test acc:                         0.7349051833152771 / 0.7747148871421814
after epoch: 14,now: 2024-07-08 03:29:13.853320,epoch time: 0:36:14.819387,used: 8:27:04.803894,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97313786, 'precision': 0.9386426, 'recall': 0.92089, 'specificity': 0.99700475, 'f1': 0.9292611, 'auroc': 0.99916226}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     1    3    0     4     0     0    2      8
1     0  1283    0    12    0    0     0    34     1    0      2
2     0     0  250     0   19    2     0     0     0   41      0
3     0     0    0  8326    1    3     0    91    16    0      0
4     2     0    9     1  423    1     0     2     6    5     90
5     0     0    0    12    0  474     0     0     1   33      1
6     6     0    0     3    0    0  1885     0     3    0     11
7     0     7    0   119    1    0     2  7110    19    2      4
8     0     0    2   159   16    4     1    72  3009    2     29
9     0     0   25     3    0   47     0     1     0  417      0
10    8     0    2     7   20    1     2     4    19    0  12730
---- Validation: 
scalar performance:
{'acc': 0.9723151, 'precision': 0.9374038, 'recall': 0.9207151, 'specificity': 0.9968995, 'f1': 0.9286639, 'auroc': 0.99926203}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     1    4    1     5     0     0    1      8
1     0  1278    0    14    0    0     0    36     3    0      1
2     0     0  257     1   21    2     0     0     0   30      1
3     0     0    0  8314    1    5     1   102    16    1      0
4     1     0   10     0  417    0     0     1     4    2    104
5     0     0    0    14    0  479     0     0     1   26      1
6     7     0    0     3    2    0  1880     0     2    0     14
7     1     6    2   128    1    0     2  7110     9    0      6
8     1     0    1   156   22    2     0    75  3011    7     21
9     0     0   31     2    0   46     0     1     0  412      1
10    8     0    3     7   19    0     3     9    18    0  12729
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72469044, 'precision': 0.64420706, 'recall': 0.61336976, 'specificity': 0.9721931, 'f1': 0.60711884, 'auroc': 0.8713823}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   902     0    2   22    6    6   147   17     4   36    28
1     2  1345    3   18    1    0     0   98    12    1    19
2     1     1  181    5  359   28    17   20   101   82   220
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    0    1  106    0    15    0     3    0  1508
5     0     0    6   56    7  365     2    0     1  154     1
6     1     0    0    2    0    0  3062    0     0    0     2
7     0     0   12  140    0    0    11  982     5   10     4
8     0     0    1   90   16   20     8   13  1208    7     7
9     4     2  148   52   26  169     5   27   102  568    34
10    0     0    0    0    3    0     4    0     0    0  1639
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_15.png
better model found
persisted
after epoch: 15,now: 2024-07-08 04:05:07.026299,epoch time: 0:35:53.172979,used: 9:02:57.976873,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96149933, 'precision': 0.90212214, 'recall': 0.9036735, 'specificity': 0.995872, 'f1': 0.9010341, 'auroc': 0.9988208}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     1    0     0    8    0     1     2     1    0     30
1     0  1317    0     1    0    0     0    10     1    0      3
2     0     0  238     0   61    0     1     1     0    9      2
3     1     5    0  7984    6    3     4   263   164    3      3
4     1     0   10     0  455    0     0     0     0    0     73
5     1     0    1    11    7  441     0     0     9   49      2
6    13     1    0     1    6    0  1861     0     2    0     23
7     7    72    9    32   13    1     2  6981   111    0     36
8     1     0    3    13   43    0     0    12  3147    1     76
9     3     0   53     2   31   21     2     1     5  373      2
10    4     0    2     5   71    0     1     5     5    0  12701
---- Validation: 
scalar performance:
{'acc': 0.9605724, 'precision': 0.9018308, 'recall': 0.90347016, 'specificity': 0.99577135, 'f1': 0.9003798, 'auroc': 0.9987275}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     0    6    0     3     1     0    0     27
1     0  1318    0     0    0    0     0    12     1    0      1
2     1     1  232     1   65    0     0     0     2    8      2
3     4     5    1  7960    6    3     3   268   180    3      7
4     1     0    5     1  455    0     0     2     0    0     75
5     1     0    2    14    9  439     0     0     6   50      0
6     8     1    0     0    7    0  1865     1     1    0     25
7     1    68   13    33   18    0     3  6993   101    1     34
8     1     1    4    10   46    1     0    18  3136    0     79
9     2     0   53     1   32   15     1     1     2  379      7
10    3     0    1     7   88    0     4     1     4    0  12688
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71363604, 'precision': 0.6365679, 'recall': 0.5859903, 'specificity': 0.9706182, 'f1': 0.58019054, 'auroc': 0.87093496}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   906     0    1   3   17    1   179    13     2    0    48
1     6  1411    1   5    5    0     2    32     9    1    27
2     6     3  107   1  547    4    17    16    75   10   229
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  303    0     5     0     3    0  1322
5    15     0    9  43   38  241    28     2    36  117    63
6     0     0    0   0    1    0  3022     0     0    0    44
7     4     3    3  19    4    0    46  1060    18    1     6
8     0     1    0  20   20    0    36     3  1271    0    19
9    24    10  219  23  147   63    34    58   205  246   108
10    0     0    0   0   13    0     0     0     0    0  1633
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_16.png
early stop counter: 1
val acc:0.9605724215507507, best validation acc: 0.9723150730133057, corresponding to test acc:                         0.7246904373168945 / 0.7747148871421814
after epoch: 16,now: 2024-07-08 04:40:43.698300,epoch time: 0:35:36.672001,used: 9:38:34.648874,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9767498, 'precision': 0.9407642, 'recall': 0.9295455, 'specificity': 0.9974951, 'f1': 0.9349144, 'auroc': 0.9994391}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    0     4    5    2     5     2     1    2     14
1     0  1276    0     6    0    0     0    45     3    0      2
2     2     0  252     2   26    2     0     2     4   19      3
3     0     1    0  8349    0    4     0    50    33    1      0
4     1     0    8     1  463    0     0     1    15    3     47
5     0     0    0     9    0  472     0     0     3   36      1
6     3     0    0     2    0    0  1885     6     3    0      8
7     0     2    0   113    1    0     1  7094    49    0      3
8     0     0    0    67    5    0     0    20  3195    0      9
9     0     0   31     3    0   37     0     1     0  421      0
10    5     0    0     8   60    0     1     9    57    0  12653
---- Validation: 
scalar performance:
{'acc': 0.97614014, 'precision': 0.93942106, 'recall': 0.92578185, 'specificity': 0.9974254, 'f1': 0.93228, 'auroc': 0.99941444}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     0    2     6    4    0     4     2     3    1     18
1     0  1278    0     5    0    0     0    47     2    0      0
2     0     0  248     3   35    2     0     1     3   18      2
3     0     2    0  8336    0    4     1    57    39    1      0
4     2     0    6     0  454    0     0     1    18    3     55
5     0     0    0    12    1  477     0     1     4   26      0
6     6     0    0     4    0    0  1879     4     4    1     10
7     0     4    1   114    0    1     1  7103    38    0      3
8     0     0    1    57    5    1     0    19  3209    0      4
9     0     0   32     3    1   39     0     1     2  415      0
10    2     0    1    14   59    0     3    13    53    0  12651
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71104735, 'precision': 0.6327078, 'recall': 0.59988457, 'specificity': 0.9709595, 'f1': 0.57529724, 'auroc': 0.8751941}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   889     0   0  89    4   33    48    42    16   34    15
1     1  1257   0  14    1    0     2   185    16    2    21
2     2     0  83   8  280   21     5    57   294   46   219
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   1  137    0     3     1    23    0  1468
5     1     0   2  74    2  375     1     2    29  101     5
6     0     0   0   3    0    0  3005     1     1    0    57
7     0     0   0  40    0    0     0  1120     2    0     2
8     0     0   1  49    0    5     1    13  1300    0     1
9     3     1  69  66   18  164     1   121   288  357    49
10    0     0   0   0    4    0     0     1     1    0  1640
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_17.png
better model found
persisted
after epoch: 17,now: 2024-07-08 05:15:55.384199,epoch time: 0:35:11.685899,used: 10:13:46.334773,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9735124, 'precision': 0.92858964, 'recall': 0.9287437, 'specificity': 0.99724144, 'f1': 0.92605317, 'auroc': 0.9992937}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    1    0     2     0     0    1      2
1     0  1259    0     6    0    0     0    61     2    0      4
2     0     0  214     1    2    1     0    21     3   70      0
3     0     0    0  8243    0    4     0   111    79    1      0
4     3     0   20     0  467    0     0     9    22    2     16
5     0     0    0     4    1  452     0     1     3   59      0
6     5     0    0     4    1    1  1891     1     2    0      3
7     0     1    0    63    0    0     2  7179    12    1      3
8     0     0    0    31    0    1     0    62  3197    1      4
9     0     0    7     2    0   10     0     2     1  471      0
10   19     0    2     8  132    1     6    19    65    6  12536
---- Validation: 
scalar performance:
{'acc': 0.97346526, 'precision': 0.9246642, 'recall': 0.92542636, 'specificity': 0.9972414, 'f1': 0.92281044, 'auroc': 0.9992877}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     1    1    0     3     1     0    1      1
1     0  1274    0     8    0    0     0    43     2    0      5
2     0     0  216     2    6    0     0    19     3   66      0
3     0     0    0  8256    0    4     0   106    73    1      0
4     4     0   30     0  449    0     0     8    20    6     22
5     0     0    1     8    1  446     0     1     2   62      0
6     5     1    0     0    0    1  1891     3     1    3      3
7     0     2    0    52    0    0     1  7199     8    0      3
8     0     0    0    38    1    1     0    62  3190    0      4
9     0     0    5     2    0   13     0     4     0  469      0
10    7     0    2     7  144    0     8    23    71    6  12528
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69894356, 'precision': 0.6713623, 'recall': 0.5722809, 'specificity': 0.9698576, 'f1': 0.56214803, 'auroc': 0.8825588}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   851     0   0   39    1    1   109    73    24   66     6
1     2  1040   1   31    0    0     4   377     9    0    35
2     2     0  77   16  105   14    47   114   443  123    74
3     0     0   0    0    0    0     0     0     0    0     0
4     1     0   5    0  333    0    30     9    70    1  1184
5     1     0   2  166    2  210     2     3    17  189     0
6     0     0   0    5    0    0  3056     2     2    0     2
7     1     0   1   62    0    0     2  1095     2    1     0
8     0     0   0   98    0    0     3    19  1249    1     0
9     2     0  15  180    5   85     7   122   233  469    19
10    0     0   0    0   25    0     7     1     3    0  1610
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_18.png
early stop counter: 1
val acc:0.9734652638435364, best validation acc: 0.9761401414871216, corresponding to test acc:                         0.711047351360321 / 0.7747148871421814
after epoch: 18,now: 2024-07-08 05:51:43.844436,epoch time: 0:35:48.460237,used: 10:49:34.795010,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97463614, 'precision': 0.9436681, 'recall': 0.9200039, 'specificity': 0.99727005, 'f1': 0.93083835, 'auroc': 0.99942124}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    1     1    3    0    13     0     0    1     11
1     0  1287    0     1    0    0     0    37     4    0      1
2     0     0  247     0    7    0     1     9     7   38      3
3     1     0    0  8217    0    1     2    79   137    0      2
4     4     0   18     1  429    0     3     3    15    2     64
5     0     0    1    29    0  432     1     1    12   44      1
6     2     0    0     0    0    0  1899     1     3    0      3
7     1     0    1   111    0    0     1  7112    30    0      7
8     1     0    1    17    1    0     1    39  3226    0      9
9     4     0    9     3    2   28     0     5     8  433      1
10    5     0    0     5   35    0     8     4    43    0  12693
---- Validation: 
scalar performance:
{'acc': 0.97515047, 'precision': 0.94492114, 'recall': 0.9259237, 'specificity': 0.99733496, 'f1': 0.93467915, 'auroc': 0.9994195}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   463     0    0     2    3    0    11     0     0    0      4
1     0  1284    0     1    0    0     0    42     4    0      1
2     0     0  253     1    9    0     4     6     3   35      1
3     2     0    0  8216    0    0     6    72   143    0      1
4     5     0   17     0  433    0     4     4    15    0     61
5     0     0    1    29    0  435     2     0    12   39      3
6     1     0    0     1    0    0  1898     0     2    0      6
7     0     2    0   105    1    0     3  7113    35    0      6
8     0     0    3    19    3    0     3    38  3221    0      9
9     1     0   11     2    1   26     1     2     7  442      0
10    2     0    1     6   43    0     6     7    33    0  12698
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6619324, 'precision': 0.64832735, 'recall': 0.52662253, 'specificity': 0.96586955, 'f1': 0.50816095, 'auroc': 0.8739061}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   759     0   0   31    2    1   281    35     9    9    43
1     4  1022   0   29    0    0     1   337    40    1    65
2     6     0  78   16   95    6    23    45   438   33   275
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  179    0    17     1    33    0  1403
5     3     0   1  289    1  114     9     0    71   77    27
6     0     0   0    1    0    0  3046     1     2    0    17
7     4     0   0   30    0    0     5  1108    15    0     2
8     0     0   0   53    0    0     4    19  1292    0     2
9     5     0  56  216    8   35    19   103   409  233    53
10    0     0   0    0   12    0     3     0     1    0  1630
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_19.png
early stop counter: 2
val acc:0.975150465965271, best validation acc: 0.9761401414871216, corresponding to test acc:                         0.711047351360321 / 0.7747148871421814
after epoch: 19,now: 2024-07-08 06:27:13.980453,epoch time: 0:35:30.136017,used: 11:25:04.931027,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97618794, 'precision': 0.93355006, 'recall': 0.9371909, 'specificity': 0.997412, 'f1': 0.9326587, 'auroc': 0.9995324}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    0    0     0     0     0    0      6
1     0  1312    0     3    0    0     0    16     1    0      0
2     1     0  284     0    3    0     0     1     1   21      1
3     3     0    0  8314    0    1     6    96    17    1      0
4     9     0   21     0  437    0     0     1     5    2     63
5     2     0    0    22    0  450     0     0     2   44      1
6   136     0    0     1    0    0  1762     0     1    0      8
7     3    15    7    82    0    0     1  7118    24    0     14
8     1     2    2    60    4    1     0    35  3139    2     49
9     1     0   21     7    1   12     0     0     0  450      1
10   16     0    1     6   18    1     2     1     4    0  12743
---- Validation: 
scalar performance:
{'acc': 0.9764344, 'precision': 0.9310398, 'recall': 0.93202364, 'specificity': 0.9974617, 'f1': 0.9283433, 'auroc': 0.99962044}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     0    0    0     0     0     0    0      3
1     0  1316    0     2    0    0     0    14     0    0      0
2     0     0  275     1    7    0     0     0     2   25      2
3     2     2    1  8316    0    0    10    83    25    0      1
4    10     0   25     0  438    0     0     1     2    2     61
5     1     0    0    32    0  424     0     0     1   62      1
6   136     1    0     1    0    0  1756     0     2    0     12
7     3     8    4    68    4    0     1  7146    20    0     11
8     2     1    1    53    5    0     1    41  3152    1     39
9     6     0   17     5    0    9     0     2     0  454      0
10   13     1    2     7   16    0     3     3     4    0  12747
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7270692, 'precision': 0.6534493, 'recall': 0.5936632, 'specificity': 0.9727711, 'f1': 0.5808644, 'auroc': 0.88259476}
confusion matrix:
      0     1    2    3    4   5     6     7     8    9     10
0   1117     0    1   12    2   0     5    18     3    4     8
1      3  1363    1   12    0   0     0   107     2    1    10
2     21     5  297   13  163   6    34    67   205   24   180
3      0     0    0    0    0   0     0     0     0    0     0
4      0     2    3    0  239   0    15     4    16    0  1354
5     10     0   18  286    1  95     5    11    17  145     4
6      3     0    0    3    0   0  3053     1     1    0     6
7      1     0    0   40    0   0     2  1117     1    1     2
8      1     0    0   76    0   1     8    57  1221    2     4
9     23     6  247  180    4  53     8   180   141  266    29
10     0     0    0    0   18   0     3     0     1    0  1624
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_20.png
better model found
persisted
after epoch: 20,now: 2024-07-08 07:02:39.153722,epoch time: 0:35:25.173269,used: 12:00:30.104296,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97923803, 'precision': 0.93727744, 'recall': 0.9447013, 'specificity': 0.9977986, 'f1': 0.939685, 'auroc': 0.9995788}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     0    7    0     6     0     1    0      8
1     0  1309    0     4    0    0     0    18     1    0      0
2     0     0  293     0   15    0     0     1     1    1      1
3     0     1    0  8284    0    3     0   103    48    1      0
4     3     0    7     0  487    0     0     3     4    0     35
5     1     0    1     5    0  463     0     0     2   49      0
6     3     0    0     1    0    0  1900     0     1    0      3
7     0     2    0    81    1    0     2  7155    17    0      5
8     1     0    2    47    9    2     0    26  3196    0     12
9     0     0   77     3    3   10     0     2     3  395      0
10   14     0    0     7   74    0    13     7    18    0  12657
---- Validation: 
scalar performance:
{'acc': 0.97983146, 'precision': 0.94148076, 'recall': 0.9448645, 'specificity': 0.9978554, 'f1': 0.9421667, 'auroc': 0.99960726}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    1     1    8    0     5     1     2    0      6
1     0  1309    0     5    0    0     0    17     1    0      0
2     0     0  287     2   16    1     0     1     1    3      1
3     0     0    0  8283    0    3     0   107    47    0      0
4     0     0    6     0  494    0     0     0     6    0     33
5     3     0    2     9    0  465     0     0     1   40      1
6     3     0    0     1    0    0  1898     0     1    0      5
7     1     6    2    84    0    0     2  7145    21    0      4
8     1     0    0    44    6    1     0    28  3208    0      8
9     1     0   68     1    5   15     0     2     3  398      0
10    9     0    0     5   60    0    13     7    17    0  12685
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7256699, 'precision': 0.63023794, 'recall': 0.60349244, 'specificity': 0.97210974, 'f1': 0.5951569, 'auroc': 0.8769327}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   998     0    2  13   16    0    73    40     7   10    11
1     0  1188    1  10    3    3     5   259    14    1    15
2     4     0  140   5  504    7    51    43   120   38   103
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    1   0  320    0    51     1     7    0  1253
5     4     0    3  45   19  264    18     3    32  202     2
6     0     0    0   1    1    0  3062     0     1    0     2
7     0     0    6  47    0    1     1  1100     4    2     3
8     0     1    1  12   10    5    23    17  1297    1     3
9    12     2  237  31   80   94    28    86   154  390    23
10    0     0    0   0   19    0    13     0     1    0  1613
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_21.png
better model found
persisted
after epoch: 21,now: 2024-07-08 07:38:01.785062,epoch time: 0:35:22.631340,used: 12:35:52.735636,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97848886, 'precision': 0.941555, 'recall': 0.93846846, 'specificity': 0.99767005, 'f1': 0.9376782, 'auroc': 0.99959064}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    1     1    0    2     1     0     0    1      2
1     0  1277    0     7    0    0     1    46     1    0      0
2     0     0  287     0    8    1     0     1     0   13      2
3     0     0    1  8325    0   16     0    50    41    4      0
4     9     0   30     0  404    2     2     3    10    7     72
5     0     0    0     4    0  511     0     0     1    4      1
6    14     0    0     4    0    1  1881     1     2    1      3
7     3     1    2   124    0    0     1  7101    25    0      7
8     1     0    0    29    2    1     4    29  3212    0     18
9     1     0   14     2    0   72     0     1     2  400      0
10   34     1    6     6   12    1    11    10    13    0  12700
---- Validation: 
scalar performance:
{'acc': 0.978708, 'precision': 0.9449074, 'recall': 0.94053745, 'specificity': 0.9976926, 'f1': 0.9403248, 'auroc': 0.9995975}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     3    0    3     0     0     0    1      3
1     0  1270    0     5    0    0     0    54     2    0      1
2     0     0  294     0    5    0     0     1     2   10      0
3     0     0    0  8315    0   17     0    53    55    0      0
4     7     0   29     0  414    0     1     1     7    8     72
5     0     0    0     1    0  512     0     0     2    5      1
6    10     0    2     2    0    3  1882     4     1    1      3
7     1     2    1   123    1    0     0  7107    27    0      3
8     0     0    2    31    1    3     0    37  3207    0     15
9     0     0   18     0    0   77     0     1     1  396      0
10   27     0    3     6   12    0    13     5    11    0  12719
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7163647, 'precision': 0.64423126, 'recall': 0.6162101, 'specificity': 0.9715454, 'f1': 0.59316367, 'auroc': 0.87676746}
confusion matrix:
      0    1    2    3   4    5     6    7     8    9     10
0   1057    0    4   12   1   22    10   22     2   28    12
1     10  988    0   18   0    4    18  396    20    1    44
2     11    0  328    4  81   27    32   42   174   72   244
3      0    0    0    0   0    0     0    0     0    0     0
4      1    1    6    0  76    0    31    3    13    0  1502
5      2    0   17   23   0  428     1    0     6  115     0
6      1    0    1    3   0    0  3059    0     0    0     3
7      3    0    6  196   0    2     1  947     5    2     2
8      0    0    3   25   0   24     8    8  1295    2     5
9      7    0  214   15   1  271     2   46   130  422    29
10     0    0    0    0   1    0     6    0     0    0  1639
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_22.png
early stop counter: 1
val acc:0.978708028793335, best validation acc: 0.9798314571380615, corresponding to test acc:                         0.7256699204444885 / 0.7747148871421814
after epoch: 22,now: 2024-07-08 08:13:21.645758,epoch time: 0:35:19.860696,used: 13:11:12.596332,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9826359, 'precision': 0.9642456, 'recall': 0.95050573, 'specificity': 0.9980587, 'f1': 0.956468, 'auroc': 0.99975616}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     0    4    0     0     2     0    1      9
1     0  1326    0     0    0    0     0     5     0    0      0
2     0     0  281     0    3    0     0     2     0   23      3
3     1     4    0  8259    0    6     0    87    79    1      0
4     7     1   12     0  422    0     1     1     4    0     91
5     0     0    0     3    0  488     0     0     3   26      1
6     5     0    0     1    0    0  1889     1     3    0      8
7     1    14    0    47    1    0     1  7176    21    0      4
8     1     1    0    19    2    0     1    39  3199    0     33
9     0     0   11     1    1    9     0     3     0  467      1
10    7     1    2     4    7    1     3     4    11    0  12753
---- Validation: 
scalar performance:
{'acc': 0.98285407, 'precision': 0.9635483, 'recall': 0.94818133, 'specificity': 0.99807715, 'f1': 0.95511854, 'auroc': 0.9997176}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     0    3    0     0     1     1    0     10
1     0  1322    0     0    0    0     0     9     0    0      1
2     0     0  276     0    9    0     0     2     0   23      2
3     1     5    0  8268    0    3     0    93    70    0      0
4     5     0   13     0  422    1     0     1     5    1     91
5     0     0    0     4    0  490     0     0     2   24      1
6     5     1    1     1    0    0  1889     3     2    0      6
7     0    16    0    45    0    0     0  7177    20    0      7
8     2     1    0    18    4    0     1    28  3204    1     37
9     0     0    8     1    0   20     0     2     2  460      0
10    4     1    0     5   10    0     2     5     1    0  12768
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7182537, 'precision': 0.61134315, 'recall': 0.59122634, 'specificity': 0.97143507, 'f1': 0.5637271, 'auroc': 0.8729763}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1020     0    2   4    2    0    80    26     3   13    20
1      1  1385    0   3    0    0     0    96     8    1     5
2      8     9  115   0  160    4    16    54   302   50   297
3      0     0    0   0    0    0     0     0     0    0     0
4      0     4    0   0   45    0    10     3    15    2  1554
5      3     0   10  28    1  192     2     4    48  300     4
6      0     0    0   1    0    0  3061     0     0    0     5
7      0     1    1  73    0    0     4  1076     5    1     3
8      1     0    0   7    1    2     8    14  1334    1     2
9     13     7  122  17   11   60     7   124   338  398    40
10     0     0    0   0    2    0     3     1     0    0  1640
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_23.png
better model found
persisted
after epoch: 23,now: 2024-07-08 08:48:59.560023,epoch time: 0:35:37.914265,used: 13:46:50.510597,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98194027, 'precision': 0.960016, 'recall': 0.9574795, 'specificity': 0.998014, 'f1': 0.9580533, 'auroc': 0.99974537}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     1    0     0    1    0     5     0     1    1      0
1     0  1315    1     1    0    0     1    13     1    0      0
2     2     0  285     0    4    1     0     0     2   15      3
3     0     0    2  8344    0   14     2    27    46    3      0
4     8     0    7     0  449    0     0     0     3    1     71
5     1     0    0     4    0  515     0     0     0    1      0
6     1     0    0     1    0    0  1902     0     0    0      3
7     1    10    9   156    2    1     1  7015    59    0      8
8     1     1    1    30    4    2     5    12  3217    2     21
9     3     0   12     0    1   30     1     0     0  446      0
10   16     0    1     4    5    0     7     2    18    1  12739
---- Validation: 
scalar performance:
{'acc': 0.9813027, 'precision': 0.95808876, 'recall': 0.95307183, 'specificity': 0.99795187, 'f1': 0.95486027, 'auroc': 0.99973476}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    1     0    0    0     4     0     1    1      2
1     0  1315    0     2    0    0     1    14     0    0      0
2     1     0  284     0    9    0     0     0     0   17      1
3     2     0    0  8343    0   13     1    32    45    4      0
4     7     0    4     0  446    0     3     0     6    3     70
5     1     0    0     2    0  506     0     0     0   11      1
6     2     0    0     0    0    0  1901     0     0    0      5
7     0    10    4   163    1    0     1  7001    74    3      8
8     2     0    0    20    2    0     7     7  3234    3     21
9     4     0   13     1    0   38     2     0     0  434      1
10   17     0    1     3    3    0     8     3    12    1  12748
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7006227, 'precision': 0.6215219, 'recall': 0.5897416, 'specificity': 0.96953183, 'f1': 0.58220404, 'auroc': 0.8663507}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1061     0    0   13    1    0    69   14     5    0     7
1      8  1358    4   17    0    3    18   49    14   13    15
2     31     1  193    3  172   10    50   16   110   69   360
3      0     0    0    0    0    0     0    0     0    0     0
4      3     0    1    0   42    0     4    1     3    0  1579
5     40     0    1   23    0  276    11    0     3  226    12
6      4     0    0    2    1    0  2902    0     1    0   157
7     12     0   43  175    0    0    47  859     5   17     6
8      4     0   13   51    5   21   133    2  1117    6    18
9     48     4  195   43   11  100    34   11    80  561    50
10     0     0    0    0    0    0     1    0     0    0  1645
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_24.png
early stop counter: 1
val acc:0.9813026785850525, best validation acc: 0.9828540682792664, corresponding to test acc:                         0.7182536721229553 / 0.7747148871421814
after epoch: 24,now: 2024-07-08 09:24:27.439203,epoch time: 0:35:27.879180,used: 14:22:18.389777,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.97653574, 'precision': 0.9604029, 'recall': 0.94347286, 'specificity': 0.9973044, 'f1': 0.95059323, 'auroc': 0.99972224}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     0    3    0     0     0     1    0     10
1     0  1319    0     0    0    0     0    12     0    0      1
2     0     0  295     1    0    1     0     3     0   10      2
3     0     1    0  8402    0    2     0    27     5    0      0
4     3     1   22     2  416    1     0     2     3    1     88
5     0     0    0    10    0  493     0     0     2   16      0
6     3     1    0     5    0    0  1887     0     1    1     10
7     0    65    0   180    1    0     1  6990    15    0     11
8     0     5    0   177    5    0     0    34  3016    2     56
9     0     1   19     4    1   26     0     1     1  440      0
10    2     0    1     4    7    0     2     2     3    0  12773
---- Validation: 
scalar performance:
{'acc': 0.9758192, 'precision': 0.95469105, 'recall': 0.9395261, 'specificity': 0.99723387, 'f1': 0.9452885, 'auroc': 0.9996694}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     3    4    0     3     0     0    0      7
1     0  1326    0     0    0    0     0     6     0    0      0
2     0     1  294     4    0    0     0     2     2    7      2
3     0     4    0  8401    0    0     0    31     4    0      0
4     4     0   33     0  407    0     0     2     3    0     90
5     0     0    0     8    0  498     0     0     1   14      0
6     3     2    0     5    1    0  1875     3     3    0     16
7     1    56    3   175    0    0     1  6994    20    0     15
8     1     6    2   170    3    0     0    27  3028    0     59
9     0     0   22     3    0   40     0     1     0  426      1
10    3     1    1     3   12    0     2     3     5    0  12766
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7035612, 'precision': 0.6561353, 'recall': 0.5950986, 'specificity': 0.97032946, 'f1': 0.5866793, 'auroc': 0.863783}
confusion matrix:
     0     1    2    3   4    5     6    7     8    9     10
0   966     0    2   39   3    7    40    4     4   23    82
1     1  1366    0   17   0    1     0   54    10    1    49
2     3     0  181   20  96   29    19   20   232   41   374
3     0     0    0    0   0    0     0    0     0    0     0
4     0     0    1    1  56    0     2    1    10    0  1562
5     1     0    3   72   0  363     2    1    10  133     7
6     0     0    1    5   0    0  2953    0     1    0   107
7     1     1    1  215   0    0     1  920    15    0    10
8     0     0    0  137   0    5     7    1  1213    1     6
9     3     7  121  142   3  167    11   40   196  392    55
10    0     0    0    0   0    0     0    0     0    0  1646
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_25.png
early stop counter: 2
val acc:0.9758191704750061, best validation acc: 0.9828540682792664, corresponding to test acc:                         0.7182536721229553 / 0.7747148871421814
after epoch: 25,now: 2024-07-08 10:00:44.140575,epoch time: 0:36:16.701372,used: 14:58:35.091149,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9815657, 'precision': 0.959626, 'recall': 0.9460178, 'specificity': 0.99792635, 'f1': 0.95158213, 'auroc': 0.9997376}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    1     1    4    0     3     2     0    0      7
1     0  1293    0     5    0    0     1    31     0    0      2
2     0     0  290     1   13    0     0     4     1    1      2
3     0     0    0  8395    0    2     0    29    11    0      0
4     2     0    7     0  448    0     1     0     4    1     76
5     1     0    2     3    0  498     0     0     0   17      0
6     1     0    1     0    0    0  1897     2     2    0      5
7     1     3    0   159    1    0     4  7069    17    0      8
8     0     0    2    77    1    0     2    33  3169    1     11
9     0     0   60     2    0   18     0     1     0  411      0
10    7     0    1     2    4    0    14     3    11    0  12752
---- Validation: 
scalar performance:
{'acc': 0.98322856, 'precision': 0.9627754, 'recall': 0.95365036, 'specificity': 0.9981265, 'f1': 0.95752645, 'auroc': 0.9997508}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     1    1    0     2     1     1    0      7
1     0  1310    0     2    0    0     0    20     0    0      0
2     0     0  296     0    8    0     1     1     1    4      1
3     1     0    0  8389    0    8     0    32    10    0      0
4     6     0    4     0  455    0     2     0     4    1     67
5     0     0    0     6    0  493     0     0     0   22      0
6     2     0    0     0    0    0  1899     1     1    0      5
7     0     2    1   150    0    0     8  7084    15    0      5
8     0     1    0    64    2    3     3    33  3182    3      5
9     1     0   45     1    1   16     0     1     0  428      0
10    4     0    0     4    8    0    11     5    12    0  12752
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69684464, 'precision': 0.6204021, 'recall': 0.58202356, 'specificity': 0.9695426, 'f1': 0.5767698, 'auroc': 0.86667037}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   980     0    3   20    2   10    77    29     1   35    13
1     6  1053    2   37    1    0    12   314    17    2    55
2     6     0  218   10  278    7    30    32   132   42   260
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    2    1   93    0     8     1    14    1  1513
5     2     0   17   65    2  280     0     3     9  210     4
6     1     0    1    0    0    0  3049     0     1    0    15
7     0     0    2  154    1    0     0  1001     2    1     3
8     0     0    3  102    4    6    18    29  1204    0     4
9     8     0  268   99   20  114    13    81    63  440    31
10    0     0    0    0    0    0     4     0     0    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_26.png
better model found
persisted
after epoch: 26,now: 2024-07-08 10:38:18.285608,epoch time: 0:37:34.145033,used: 15:36:09.236182,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.980442, 'precision': 0.9375234, 'recall': 0.9471674, 'specificity': 0.997942, 'f1': 0.93929064, 'auroc': 0.99967265}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     0    5    1     0     0     1    1      7
1     0  1326    0     1    0    0     0     2     2    0      1
2     0     0  295     0    0    0     0     0     0   17      0
3     1     0    0  8351    0    4     0    36    41    4      0
4     0     0   69     1  428    0     0     2     7    2     30
5     0     0    2     4    0  437     0     0     5   73      0
6    17     2    0     5    2    3  1865     3     2    0      9
7     0    15    7   138    0    0     1  7074    23    1      3
8     1     1    9    29    2    0     0    30  3215    4      4
9     0     0   15     0    0    2     0     0     0  476      0
10    2     0   19     2   22    1     1    11    25    1  12710
---- Validation: 
scalar performance:
{'acc': 0.9813294, 'precision': 0.93904096, 'recall': 0.9485922, 'specificity': 0.99804485, 'f1': 0.9410616, 'auroc': 0.9996698}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     1    6    1     0     1     1    1      4
1     0  1323    0     0    0    0     0     8     1    0      0
2     0     0  291     0    0    0     0     1     0   20      0
3     0     1    0  8356    0    1     1    26    52    3      0
4     0     0   71     0  439    1     0     1     2    4     21
5     0     0    0     9    1  444     0     0     4   63      0
6    16     0    2     3    1    0  1872     2     1    1     10
7     2    12   13   128    0    0     1  7083    23    0      3
8     0     1    7    35    3    0     0    20  3222    4      4
9     0     0   16     0    0    5     0     0     1  471      0
10    3     0   15     5   17    0     1    12    23    2  12718
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7116071, 'precision': 0.64631176, 'recall': 0.5904414, 'specificity': 0.97104895, 'f1': 0.5793383, 'auroc': 0.8655483}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   892     0   20  11   36    9     9    68     4   77    44
1     1  1267    7  15    3    0     1   168     9    3    25
2     0     0  498   3  164    2     1    35   114   34   164
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0   24   0  155    0     1     1    10    0  1442
5     0     0  109  42   12  100     0     4    10  310     5
6     2     0    3   4    1    0  2880     0     2    0   175
7     1     0    9  78    0    0     0  1069     3    0     4
8     0     0   13  33    3    6     4    33  1267    6     5
9     2     1  523  31   10   13     0    69    65  402    21
10    0     0    0   0    4    0     1     0     0    0  1641
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_27.png
early stop counter: 1
val acc:0.9813293814659119, best validation acc: 0.9832285642623901, corresponding to test acc:                         0.6968446373939514 / 0.7747148871421814
after epoch: 27,now: 2024-07-08 11:13:56.387994,epoch time: 0:35:38.102386,used: 16:11:47.338568,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9820473, 'precision': 0.94121, 'recall': 0.95920396, 'specificity': 0.99812984, 'f1': 0.9480907, 'auroc': 0.9997466}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     3    2    0     1     2     0    0      6
1     0  1311    0     2    0    0     0    17     0    0      1
2     0     0  294     0    2    0     0     1     0   14      1
3     1     0    0  8347    0    1     0    67    19    0      2
4     3     0    8     0  514    1     0     0     5    2      6
5     0     0    0     4    2  508     0     0     0    5      1
6     5     0    1     2    3    2  1873     2     0    2     18
7     1     7    0    51    1    1     1  7180    15    1      7
8     0     0    3    43   13    1     0    20  3195    3     17
9     0     0   20     0    0   74     0     1     0  398      0
10    4     0    0     2  164    0     1     0     6    0  12616
---- Validation: 
scalar performance:
{'acc': 0.98181087, 'precision': 0.9417081, 'recall': 0.9598814, 'specificity': 0.9981104, 'f1': 0.9484459, 'auroc': 0.9997591}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    1     0    3    0     1     1     0    0      6
1     0  1314    0     2    0    0     0    16     0    0      0
2     0     0  292     0    6    1     0     0     1   11      1
3     1     0    0  8348    1    2     1    65    20    1      1
4     5     0    6     0  512    0     0     1     3    1     11
5     0     0    0     4    0  513     0     0     1    3      0
6     6     0    0     4    5    2  1871     2     2    0     16
7     0     5    1    49    0    0     1  7174    27    0      8
8     1     2    1    44   14    5     0    17  3199    0     13
9     0     0   24     2    1   63     0     2     0  401      0
10    5     0    1     4  169    0     1     1     5    0  12610
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7558245, 'precision': 0.6643174, 'recall': 0.63544214, 'specificity': 0.9754734, 'f1': 0.6328404, 'auroc': 0.87839633}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   979     0    5   2   57   10    22    36    11   30    18
1     3  1311    3  13    3    0     1   137     7    1    20
2     3     0  299   5  444   10     5    55   115   25    54
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    6   0  829    0     2     2     5    0   789
5     4     0   67  61   49  299     1     8    14   82     7
6     1     0    4   1    9    0  2965     2     1    0    84
7     6     0    5   4    1    1     0  1139     1    1     6
8     1     0    5  43   19    2     5    28  1262    2     3
9    11     0  402  53   75  113     1   139   100  220    23
10    0     0    0   0  145    0     1     0     0    0  1500
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_28.png
early stop counter: 2
val acc:0.9818108677864075, best validation acc: 0.9832285642623901, corresponding to test acc:                         0.6968446373939514 / 0.7747148871421814
after epoch: 28,now: 2024-07-08 11:49:32.971399,epoch time: 0:35:36.583405,used: 16:47:23.921973,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9861944, 'precision': 0.96203077, 'recall': 0.9662644, 'specificity': 0.99853754, 'f1': 0.96375513, 'auroc': 0.9998401}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    3    0     0     0     0    2      3
1     0  1314    0     1    0    0     0    15     2    0      0
2     0     0  287     0    0    0     0     0     1   23      1
3     0     0    0  8248    0    4     0   120    62    2      0
4     3     0   25     0  487    0     0     3     4    2     15
5     0     0    1     3    0  477     0     0     2   38      0
6     6     0    0     2    2    0  1887     3     1    0      7
7     0     2    1    28    0    0     0  7217     9    0      7
8     0     0    0     6    3    2     1    23  3252    1      8
9     0     0    5     0    0    5     0     0     1  482      0
10    1     0    1     2   37    0     1     3    12    1  12734
---- Validation: 
scalar performance:
{'acc': 0.9868931, 'precision': 0.96790177, 'recall': 0.97164845, 'specificity': 0.99860376, 'f1': 0.9695243, 'auroc': 0.9998386}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     0    3    0     1     0     1    0      6
1     0  1301    0     3    0    0     0    27     1    0      0
2     0     0  293     0    0    0     0     1     0   17      1
3     0     0    0  8266    0    2     0   111    61    0      0
4     2     0   18     0  506    0     0     2     3    1      7
5     0     0    0     1    0  486     0     0     2   32      0
6     5     0    1     2    1    1  1884     4     1    0      9
7     1     0    0    31    1    0     0  7215    12    0      5
8     0     0    0     3    3    0     0    20  3260    1      9
9     0     0    4     0    0    5     0     0     1  483      0
10    1     0    3     3   35    0     3     4    18    0  12729
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7339957, 'precision': 0.66767156, 'recall': 0.61253726, 'specificity': 0.97329646, 'f1': 0.6101681, 'auroc': 0.8777023}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   967     0    9    9   16    1    32    61     5   47    23
1     0  1155    1    7    1    0     0   299    15    3    18
2     1     0  304    4  219    4     4    50   221   88   120
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    5    0  335    0     4     2    20    0  1267
5     3     0   26   63    5  206     0     2    24  262     1
6     0     0    2    2    0    0  3019     9     1    0    34
7     0     0    3  113    0    0     1  1038     3    1     5
8     0     0    3   22    1    3     4    17  1319    0     1
9     5     2  170   56    8   58     1    78   200  531    28
10    0     0    0    0   28    0     0     0     1    0  1617
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_29.png
better model found
persisted
after epoch: 29,now: 2024-07-08 12:25:15.205057,epoch time: 0:35:42.233658,used: 17:23:06.155631,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98194027, 'precision': 0.95442, 'recall': 0.9471067, 'specificity': 0.99801785, 'f1': 0.9502684, 'auroc': 0.99970627}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   432     0    1     0    5    1     0     0     1    0     43
1     0  1330    0     0    0    0     0     2     0    0      0
2     0     0  281     0    2    0     0     2     1   25      1
3     2     5    0  8336    0    0     0    78    15    1      1
4     1     0   16     0  498    0     0     0     4    1     19
5     0     0    1    29    0  488     0     0     0    3      0
6     5     2    0     1    0    2  1882     0     0    2     11
7     0    56    0    67    1    0     1  7112    12    0     14
8     0     3    0    53    9    0     1    25  3180    0     24
9     0     0    8     3    0   59     0     2     2  418      1
10    0     0    4     0   37    1     0     3     6    0  12744
---- Validation: 
scalar performance:
{'acc': 0.9815434, 'precision': 0.9535291, 'recall': 0.9450626, 'specificity': 0.9979909, 'f1': 0.94869286, 'auroc': 0.99974316}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    1     0    9    1     1     0     1    1     30
1     0  1330    0     0    0    0     0     2     0    0      0
2     0     1  274     0    4    1     0     2     2   27      1
3     0     4    0  8362    0    0     0    60    14    0      0
4     0     1   15     0  504    0     0     0     0    3     16
5     0     0    0    35    0  483     0     0     0    2      1
6     2     0    1     0    1    1  1891     0     0    1     11
7     0    68    0    69    0    0     3  7098    13    2     12
8     0     4    0    71    9    1     2    29  3155    0     25
9     0     0    5     3    0   66     0     5     1  412      1
10    0     1    3     1   34    0     3     2     5    0  12747
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71993285, 'precision': 0.64740396, 'recall': 0.60086143, 'specificity': 0.9719358, 'f1': 0.5909138, 'auroc': 0.87182987}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   808     0    4   21   20   47    22    57    32  124    35
1     0  1353    1   14    1    2     2   109     9    2     6
2     4     4  235   13  157   18     9    40   271   89   175
3     0     0    0    0    0    0     0     0     0    0     0
4     0     1   12    0  236    0     9     1    20    0  1354
5     0     0    0  121    3  266     0     5    26  170     1
6     4     0    1    2    1    0  2989     1     2    0    67
7     1     1    1   33    0    0     0  1120     2    2     4
8     0     0    0   71    0    3     5    16  1270    4     1
9     1     4  125   87   12  125     0    97   278  383    25
10    0     0    0    0   14    0     2     0     0    0  1630
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_30.png
early stop counter: 1
val acc:0.9815434217453003, best validation acc: 0.9868931174278259, corresponding to test acc:                         0.7339956760406494 / 0.7747148871421814
after epoch: 30,now: 2024-07-08 13:00:26.645880,epoch time: 0:35:11.440823,used: 17:58:17.596454,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 17:58:17.596454 at 2024-07-08 13:00:26.645880
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7339957, 'precision': 0.66767156, 'recall': 0.61253726, 'specificity': 0.97329646, 'f1': 0.6101681, 'auroc': 0.8777023}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   967     0    9    9   16    1    32    61     5   47    23
1     0  1155    1    7    1    0     0   299    15    3    18
2     1     0  304    4  219    4     4    50   221   88   120
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    5    0  335    0     4     2    20    0  1267
5     3     0   26   63    5  206     0     2    24  262     1
6     0     0    2    2    0    0  3019     9     1    0    34
7     0     0    3  113    0    0     1  1038     3    1     5
8     0     0    3   22    1    3     4    17  1319    0     1
9     5     2  170   56    8   58     1    78   200  531    28
10    0     0    0    0   28    0     0     0     1    0  1617
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7747149, 'precision': 0.7087762, 'recall': 0.6462858, 'specificity': 0.97730404, 'f1': 0.641806, 'auroc': 0.8889667}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1101     0    0   9    2    3    11    13     1   24     6
1      0  1162    0  12    0    0     0   313     3    0     9
2     17     0  178   2  344    1     6    51    93  125   198
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    0   0  689    0     8     1     3    0   932
5      3     0    1  19    2  168     0     2     8  383     6
6      0     0    0   0    0    0  3060     1     0    1     5
7      0     0    0  18    0    0     2  1141     1    1     1
8      0     0    1  45    7    5     1    17  1278    7     9
9      9     1   94  28   17   13     1    92    93  758    31
10     0     0    0   0  106    0     1     1     0    0  1538
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_19_02_09_seed_0_21716734_instance_wise_predictions.txt
accuracy from prediction file 0.7339956622122717
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/0.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457488 KiB |   2004 MiB |    980 TiB |    980 TiB |
|       from large pool | 414237 KiB |   1971 MiB |    966 TiB |    966 TiB |
|       from small pool |  43251 KiB |     62 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457488 KiB |   2004 MiB |    980 TiB |    980 TiB |
|       from large pool | 414237 KiB |   1971 MiB |    966 TiB |    966 TiB |
|       from small pool |  43251 KiB |     62 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 449054 KiB |   1999 MiB |    979 TiB |    979 TiB |
|       from large pool | 407075 KiB |   1966 MiB |    965 TiB |    965 TiB |
|       from small pool |  41979 KiB |     60 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2276 MiB |   2276 MiB |      0 B   |
|       from large pool |   2212 MiB |   2212 MiB |   2212 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 326895 KiB | 366140 KiB |    821 TiB |    821 TiB |
|       from large pool | 323043 KiB | 360722 KiB |    807 TiB |    807 TiB |
|       from small pool |   3852 KiB |  12186 KiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4556    |    6799    |  178511 K  |  178507 K  |
|       from large pool |     187    |     311    |   93157 K  |   93157 K  |
|       from small pool |    4369    |    6537    |   85353 K  |   85349 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4556    |    6799    |  178511 K  |  178507 K  |
|       from large pool |     187    |     311    |   93157 K  |   93157 K  |
|       from small pool |    4369    |    6537    |   85353 K  |   85349 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     124    |     124    |       0    |
|       from large pool |      92    |      92    |      92    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      53    |    1523    |   90597 K  |   90597 K  |
|       from large pool |      32    |      88    |   58496 K  |   58496 K  |
|       from small pool |      21    |    1491    |   32101 K  |   32101 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |    980 TiB |    980 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    966 TiB |    966 TiB |
|       from small pool |      0 KiB |     62 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |    980 TiB |    980 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    966 TiB |    966 TiB |
|       from small pool |      0 KiB |     62 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1999 MiB |    979 TiB |    979 TiB |
|       from large pool |  16640 KiB |   1966 MiB |    965 TiB |    965 TiB |
|       from small pool |      0 KiB |     60 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 784384 KiB |   2276 MiB |   2276 MiB |   1510 MiB |
|       from large pool | 737280 KiB |   2212 MiB |   2212 MiB |   1492 MiB |
|       from small pool |  47104 KiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 432633 KiB |    821 TiB |    821 TiB |
|       from large pool |  24320 KiB | 408037 KiB |    807 TiB |    807 TiB |
|       from small pool |      0 KiB |  29150 KiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6799    |  178511 K  |  178511 K  |
|       from large pool |       2    |     311    |   93157 K  |   93157 K  |
|       from small pool |       0    |    6537    |   85353 K  |   85353 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6799    |  178511 K  |  178511 K  |
|       from large pool |       2    |     311    |   93157 K  |   93157 K  |
|       from small pool |       0    |    6537    |   85353 K  |   85353 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      56    |     124    |     124    |      68    |
|       from large pool |      33    |      92    |      92    |      59    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1523    |   90598 K  |   90598 K  |
|       from large pool |       3    |      88    |   58496 K  |   58496 K  |
|       from small pool |       0    |    1491    |   32102 K  |   32102 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |    980 TiB |    980 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    966 TiB |    966 TiB |
|       from small pool |      0 KiB |     62 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |    980 TiB |    980 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    966 TiB |    966 TiB |
|       from small pool |      0 KiB |     62 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1999 MiB |    979 TiB |    979 TiB |
|       from large pool |  16640 KiB |   1966 MiB |    965 TiB |    965 TiB |
|       from small pool |      0 KiB |     60 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 784384 KiB |   2276 MiB |   2276 MiB |   1510 MiB |
|       from large pool | 737280 KiB |   2212 MiB |   2212 MiB |   1492 MiB |
|       from small pool |  47104 KiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 432633 KiB |    821 TiB |    821 TiB |
|       from large pool |  24320 KiB | 408037 KiB |    807 TiB |    807 TiB |
|       from small pool |      0 KiB |  29150 KiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6799    |  178511 K  |  178511 K  |
|       from large pool |       2    |     311    |   93157 K  |   93157 K  |
|       from small pool |       0    |    6537    |   85353 K  |   85353 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6799    |  178511 K  |  178511 K  |
|       from large pool |       2    |     311    |   93157 K  |   93157 K  |
|       from small pool |       0    |    6537    |   85353 K  |   85353 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      56    |     124    |     124    |      68    |
|       from large pool |      33    |      92    |      92    |      59    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1523    |   90598 K  |   90598 K  |
|       from large pool |       3    |      88    |   58496 K  |   58496 K  |
|       from small pool |       0    |    1491    |   32102 K  |   32102 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734

 Experiment start at: 2024-07-08 13:16:58.746700
before training, model accuracy: 0.10312740504741669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.87556183, 'precision': 0.7954034, 'recall': 0.7592562, 'specificity': 0.9860773, 'f1': 0.7650566, 'auroc': 0.9916506}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   348     0    0     1    1    0    19    11     0   12     91
1     0  1261    0     7    0    0     0    56     3    0      4
2     0     0  170     0   55    1     3     8     2   51     21
3     0     1    3  5911    0  189     8  2178   120   26      1
4     1     0   17     1  180    1     1    17     8   13    300
5     1     0    5    11    0  336     2     0     3  160      3
6    11     0    1     1    0    0  1854    14     0    1     25
7     1    41    4    29    1    1     2  7144    21    8     13
8     2     3   16   128   21   89    11   259  2536   28    202
9     1     0   63     1    2   42     4     6     0  368      6
10    5     1    3     5   24    0    20   103    10    6  12617
---- Validation: 
scalar performance:
{'acc': 0.8752173, 'precision': 0.79643714, 'recall': 0.7616046, 'specificity': 0.9860647, 'f1': 0.76730824, 'auroc': 0.99206096}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   336     0    3     0    0    0    21    14     0    7    102
1     0  1258    0     6    0    0     0    60     2    0      6
2     0     0  170     0   56    1     3    16     1   44     21
3     1     2    2  5907    1  204     7  2179   104   32      1
4     1     0   24     0  212    0     3    13    10   11    265
5     0     0    1    12    0  334     5     0     6  160      3
6     8     0    2     0    0    0  1864     9     2    2     21
7     0    38    8    32    2    1     2  7134    33    6      9
8     1     8   12   124   24   85    14   269  2505   38    216
9     0     0   65     2    1   36     2     9     2  371      5
10    6     2    4     5   24    0    22    88    13    3  12629
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6958651, 'precision': 0.6074357, 'recall': 0.5918393, 'specificity': 0.968935, 'f1': 0.56645906, 'auroc': 0.87469196}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   803     0    0   5    0    0   190    57     1   51    63
1     0  1365    0   2    0    0     4   112     2    0    14
2     1     3   53   2  140   10    11    80   163   91   461
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0   35    0     1     3     7    0  1587
5     1     0    0  16    0  340     4     8     4  217     2
6     0     0    0   0    0    0  2813     3     0    0   251
7     0     0    0   1    0    0     0  1160     0    1     2
8     1     1    0  36    1   17    64    75  1144    6    25
9     1    11  112   8   11   85     8   180    73  588    60
10    0     0    0   0    0    0     0     1     0    0  1645
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-08 13:53:50.221285,epoch time: 0:36:51.474585,used: 0:36:51.474585,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9362425, 'precision': 0.82256454, 'recall': 0.84191227, 'specificity': 0.9931921, 'f1': 0.8306931, 'auroc': 0.9960485}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   432     0    1     1    1    0    10     1     1    2     34
1     0  1306    1     7    0    0     0    14     2    0      2
2     8     0  182     0   72    0     3     6     1   34      4
3     4    18    3  8109    0  100     6    92   104    2      1
4     7     0   11     0  350    3     5     2     9    1    151
5     7     0    2    11    0  420     4     0     5   71      1
6    10     2    0     6    2    0  1870     2     2    1     13
7     7   203   30   360   20    3     2  6467   143    5     23
8     7    12    9   151   48   30    17    33  2888   10     91
9     8     0   66     4   12   75     7     0     2  319      0
10   21     2    1    10   56    1    24    11    15    1  12650
---- Validation: 
scalar performance:
{'acc': 0.93681955, 'precision': 0.82304287, 'recall': 0.8434731, 'specificity': 0.9932667, 'f1': 0.83141255, 'auroc': 0.9958205}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     1    2     2    1    0    16     1     0    2     33
1     0  1305    1     6    0    0     0    14     2    0      4
2     9     1  176     0   74    2     3     3     0   39      5
3    13    16    3  8109    0   83     9    93   107    7      0
4     8     1   12     0  355    1     2     1    13    2    144
5     4     0    1    10    0  446     2     0     4   53      1
6    14     0    1     5    0    0  1877     1     2    0      8
7     3   205   34   362   11    0     3  6470   148    4     25
8     8     6    9   142   48   25    19    41  2907    8     83
9    13     0   62     3   10   82     6     1     1  313      2
10   29     1    2     8   62    0    22    11    20    1  12640
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7365144, 'precision': 0.6545553, 'recall': 0.6321399, 'specificity': 0.97343516, 'f1': 0.61247206, 'auroc': 0.8816161}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1089     5    0   16    0    1    37     5     3    9     5
1      3  1427    0   15    0    0     0    42     3    0     9
2     29    14  118   19  272   25    39    42   245   28   184
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    1    1  240    0     3     1    13    0  1373
5      5     0    3   54    2  442    14     0     5   67     0
6      1     2    0    1    0    0  2965     2     2    0    94
7      6     5    0   34    0    0     2  1113     2    0     2
8      1     8    0  128    7    5    45     7  1157    3     9
9     24    75  174  112   22  182    23    78    90  342    15
10     0     0    0    0   10    0     1     1     0    0  1634
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-08 14:29:29.166064,epoch time: 0:35:38.944779,used: 1:12:30.419364,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92810893, 'precision': 0.85320896, 'recall': 0.7848928, 'specificity': 0.99210286, 'f1': 0.8029569, 'auroc': 0.99526024}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   306     0    0    12    3    3    48    10     5   11     85
1     0  1119    0    21    1    0     2   176     9    0      3
2     0     0  100     4   39    9     0    43     9  106      2
3     0     0    0  8214    0   36     2   142    42    0      1
4     1     0   18     2  353    5     1    13    33   11    102
5     0     0    0    24    1  472     0     1     2   19      2
6     4     0    0    14    1    3  1843     1    10    1     31
7     0     6    0   442    1    1     3  6763    43    0      5
8     0     0    0   301   10   13     0   147  2801    3     21
9     0     0    3     9    0  173     0    15     3  289      1
10    0     0    2    15  188    2     7    53    94    2  12429
---- Validation: 
scalar performance:
{'acc': 0.92999864, 'precision': 0.859675, 'recall': 0.7863797, 'specificity': 0.9922803, 'f1': 0.80534625, 'auroc': 0.9954343}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   310     0   0    13    4    4    42     6     6    8     90
1     0  1141   0    21    1    0     1   159     5    0      4
2     0     1  91     4   44    6     1    43     5  116      1
3     0     0   0  8234    0   35     5   120    46    0      0
4     1     0  12     4  352    4     0    12    31   14    109
5     0     0   0    23    0  465     1     1     6   24      1
6     3     0   0     9    4    1  1852     2     5    1     31
7     0     3   0   421    1    0     3  6799    31    0      7
8     0     0   0   329    9   10     0   153  2772    1     22
9     0     0   2    10    1  161     0    10     3  305      1
10    1     1   3    12  161    3     9    65    94    0  12447
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6577346, 'precision': 0.65519154, 'recall': 0.56370234, 'specificity': 0.9659326, 'f1': 0.5367756, 'auroc': 0.8858017}
confusion matrix:
     0    1   2    3    4    5     6    7     8    9     10
0   743    0   0   47   12  102    79   29     2  107    49
1     0  520   0   40    2    0     0  864    23    0    50
2     0    0  60   15  352   49     1  161   211  109    57
3     0    0   0    0    0    0     0    0     0    0     0
4     0    0   1    0  483    0     1    3    14    0  1131
5     1    0   0   29    0  527     0    1     5   27     2
6     0    0   0    1    0    0  2896    4     1    0   165
7     0    0   0  195    0    1     0  964     1    0     3
8     0    0   0  126    0   15     0   30  1197    0     2
9     1    0  11   69    5  309     1  222   109  389    21
10    0    0   0    0   21    0     2    1     0    0  1622
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_3.png
early stop counter: 1
val acc:0.9299986362457275, best validation acc: 0.9368195533752441, corresponding to test acc:                         0.7365143895149231 / 0.7365143895149231
after epoch: 3,now: 2024-07-08 15:05:05.425589,epoch time: 0:35:36.259525,used: 1:48:06.678889,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9365368, 'precision': 0.8538597, 'recall': 0.83816653, 'specificity': 0.99312997, 'f1': 0.83328456, 'auroc': 0.99660444}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     4    0    0     1     2     2    2     19
1     0  1213    0    16    0    1     0    86    12    0      4
2     3     0  239     0   13    3     0    10     7   28      9
3    10     0    2  7704    0   86     2   244   378    5      5
4    17     0   42     1  231    1     0     4    22    9    212
5     2     0    1    10    0  470     0     0     8   29      1
6    63     0    1     3    1    1  1785     2     6    2     44
7     9     3    7   188    1    2     2  6932    94    7     18
8     9     0    5    51    6    7     0    92  3063    7     55
9     5     0   48     4    0  149     1     8     4  273      1
10   68     0    6     6    8    1     4    27    33    0  12641
---- Validation: 
scalar performance:
{'acc': 0.93604386, 'precision': 0.85032284, 'recall': 0.8352585, 'specificity': 0.9930752, 'f1': 0.8309423, 'auroc': 0.99653137}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     3    0    0     1     1     3    1     22
1     0  1215    0    18    0    1     1    84    10    0      3
2     7     1  225     0   15    2     0    11     4   40      7
3     4     0    2  7734    0   84     1   251   355    2      7
4    18     0   44     1  231    1     0     5    20    7    212
5     1     0    0    14    0  469     0     0     9   26      2
6    59     0    2     3    1    2  1786     3     8    1     43
7     6     5   18   205    1    0     1  6904   105    4     16
8    11     0    8    46    9   14     0    97  3057    4     50
9     4     0   43     2    0  145     0     9     6  282      2
10   74     0    5    10   10    0     1    22    35    0  12639
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7244805, 'precision': 0.6437021, 'recall': 0.62453365, 'specificity': 0.9722314, 'f1': 0.6025029, 'auroc': 0.8774566}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1052     0    0  15    0    0     0    70    28    0     5
1      8  1221    1  19    0    0     1   221     1    0    27
2    160     1  229   2  103    8     4    46    76   51   335
3      0     0    0   0    0    0     0     0     0    0     0
4      5     0    1   0   44    0     4     3     5    0  1571
5     39     0    1  29    1  382     0     0     5  133     2
6      8     0    0   1    0    0  2926     1     1    0   130
7      6     0    1  37    0    1     0  1118     0    0     1
8      4     0    1  46    6   13    14    16  1231   10    29
9    129     0  222  21    0   68     1    81    66  507    42
10     0     0    0   0    0    0     0     1     0    0  1645
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_4.png
early stop counter: 2
val acc:0.9360438585281372, best validation acc: 0.9368195533752441, corresponding to test acc:                         0.7365143895149231 / 0.7365143895149231
after epoch: 4,now: 2024-07-08 15:40:20.489651,epoch time: 0:35:15.064062,used: 2:23:21.742951,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9494328, 'precision': 0.8738797, 'recall': 0.85545933, 'specificity': 0.9945716, 'f1': 0.8597858, 'auroc': 0.9971735}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     3    2    0     3     2     1    2      8
1     0  1265    0    12    0    0     1    49     3    0      0
2     2     0  156     3   63    1     0    11    17   57      2
3     3     1    0  8252    0    2     2    69   108    0      0
4     9     0   11     1  349    1     0     3    33    8    124
5     0     0    0    29    0  418     0     0    14   59      1
6    22     0    0     2    2    1  1859     1     9    1     11
7     3     9    1   343    1    0     1  6724   173    1      6
8     1     0    0   137    3    0     0    20  3109    1     25
9     4     0   26     8    5   62     0     1    15  371      1
10  119     3    2     8   57    0    17     8    56    4  12522
---- Validation: 
scalar performance:
{'acc': 0.94888324, 'precision': 0.8721595, 'recall': 0.85291064, 'specificity': 0.9945046, 'f1': 0.85759634, 'auroc': 0.9972075}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     1    0     2    1    0     3     0     1    2      9
1     0  1259    0     9    0    0     0    56     7    0      1
2     3     0  161     1   65    2     1    12    12   54      1
3     4     3    0  8234    0    6     2    71   119    0      1
4     8     0    7     2  349    1     1     1    32    8    130
5     1     0    1    40    0  402     0     0    10   66      1
6    22     0    0     5    2    1  1856     1     1    1     19
7     8     6    0   328    1    0     2  6744   165    2      9
8     1     0    2   134    5    0     1    23  3107    2     21
9     2     1   25     9    2   73     0     5    10  366      0
10  115     3    1     7   56    0    10    11    57    4  12532
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66347164, 'precision': 0.6244459, 'recall': 0.55077195, 'specificity': 0.96614087, 'f1': 0.517032, 'auroc': 0.87441}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1068     0   0   15    1    0     4    20    48   12     2
1      0  1093   0   17    0    0     0   377     5    0     7
2     46     1  24   13  155    1     2    82   364   82   245
3      0     0   0    0    0    0     0     0     0    0     0
4      3     1   0    0  137    0     2     2    28    0  1460
5     10     0   1  102    2  100     0     0    36  337     4
6      6     0   0    1    0    0  2549     2     4    0   505
7      2     0   0   21    0    0     1  1136     2    0     2
8      1     0   0   59    0    0     4    16  1275    2    13
9     46     0  33   97   16    6     0   166   274  463    36
10     0     0   0    0    6    0     1     1     0    0  1638
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_5.png
better model found
persisted
after epoch: 5,now: 2024-07-08 16:16:28.883360,epoch time: 0:36:08.393709,used: 2:59:30.136660,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9556935, 'precision': 0.8869984, 'recall': 0.8658029, 'specificity': 0.99519074, 'f1': 0.87382585, 'auroc': 0.9978584}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     1    0    0     1     6     2    2     10
1     0  1266    0     7    0    0     0    56     1    0      0
2     2     1  179     0   62    0     1    16     5   43      3
3     2     2    0  7984    0   13     1   328   107    2      0
4     9     0   11     1  342    1     1     9    12    5    148
5     2     0    0    14    1  432     0     1    11   58      1
6    22     1    0     1    2    0  1869     3     3    0      6
7     0     6    0    61    1    0     1  7170    19    1      5
8     2     0    1    54   10    2     0   172  3029    4     21
9     2     0   41     4    4   60     0     3     3  374      1
10   68     5    0     7   28    0    22    28    22    1  12614
---- Validation: 
scalar performance:
{'acc': 0.9552494, 'precision': 0.8852103, 'recall': 0.8622859, 'specificity': 0.99512243, 'f1': 0.8709536, 'auroc': 0.9977611}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     1    1    0     2     1     1    1      8
1     0  1267    0     6    0    0     0    58     1    0      0
2     1     0  169     0   67    1     1    12     5   53      3
3     1     1    0  7978    2   10     1   340   106    1      0
4     6     1    9     0  329    1     2     6    13    3    169
5     3     0    0    16    1  443     0     0     6   51      1
6    20     1    0     0    1    1  1868     5     3    0      9
7     1    11    0    64    1    0     1  7163    20    0      4
8     2     0    2    46   11    1     0   159  3046    2     27
9     3     0   45     4    4   58     0     9     4  366      0
10   64     7    3     5   22    0    23    34    23    0  12615
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71279645, 'precision': 0.6188914, 'recall': 0.6004465, 'specificity': 0.9711418, 'f1': 0.5692458, 'auroc': 0.8840814}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1109     0   0   9    0    1    19    29     2    0     1
1      0  1013   0  13    0    0     1   466     1    0     5
2     37     4  27  11  348   16    16   111   275   67   103
3      0     0   0   0    0    0     0     0     0    0     0
4      4     0   0   0  250    0    14     3    22    0  1340
5     13     0   0  70    1  360     1     0    22  124     1
6      7     0   0   1    1    0  3049     3     2    0     4
7      1     0   0  12    0    0     0  1150     0    0     1
8      1     0   0  67    1    2     4    43  1248    1     3
9     26     4  44  69   23  130     1   236   229  354    21
10     1     0   0   0    9    0     7     1     0    0  1628
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_6.png
better model found
persisted
after epoch: 6,now: 2024-07-08 16:52:57.334827,epoch time: 0:36:28.451467,used: 3:35:58.588127,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95537245, 'precision': 0.88769615, 'recall': 0.87824106, 'specificity': 0.995153, 'f1': 0.87182343, 'auroc': 0.99812996}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    1     2    0    0     6     2     0    2     14
1     0  1267    1    15    0    0     0    45     1    0      1
2     0     0  285     0    7    3     0     9     1    7      0
3     2     0    2  8250    0   21     1   141    22    0      0
4     7     0  112     0  284    0     0     4    12    3    117
5     0     0    3     6    0  475     1     0     2   33      1
6     9     0    1     1    1    0  1885     1     3    0      7
7     1    10    3   201    0    0     4  7025    17    0      4
8     0     0   23   242    4   14     3   132  2862    2     12
9     1     0  111     4    1   63     3     2     0  308      0
10   27     0   29     7   40    0    17    25    35    1  12612
---- Validation: 
scalar performance:
{'acc': 0.9563194, 'precision': 0.8864937, 'recall': 0.8768632, 'specificity': 0.9952647, 'f1': 0.8706762, 'auroc': 0.9981515}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    2     1    0    0     4     2     0    0     12
1     1  1263    0    14    0    0     0    53     1    0      0
2     1     0  287     0    5    3     1     4     1   10      0
3     0     0    1  8261    0   22     1   133    21    1      0
4     6     0  110     1  289    0     1     9     7    2    114
5     0     0    6    14    0  457     1     0     1   41      1
6    10     0    1     1    1    0  1885     0     3    0      7
7     0     5    4   187    0    0     2  7050    12    1      4
8     2     0   17   236    5   11     2   123  2889    1     10
9     1     0  105     4    0   80     0     2     1  300      0
10   24     0   33     9   38    2    12    26    43    0  12609
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7239208, 'precision': 0.6680758, 'recall': 0.6234714, 'specificity': 0.97244674, 'f1': 0.6082772, 'auroc': 0.8832072}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1002     0    3   15    2    9    41    72     6   14     6
1      1  1163    1   37    0    0    11   269     5    0    12
2      3     2  403   21  114   25    34    73   255   26    59
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0   15    1  185    0    15     2    35    0  1380
5      2     0    4   54    0  436     1     1     1   92     1
6      1     0    0    4    0    0  3036     3     3    0    20
7      0     0    0   66    0    1    10  1084     2    0     1
8      0     0    0  183    0   10    18    25  1132    1     1
9      6     1  250  155    1  219     8   141    75  271    10
10     0     0    2    0    6    0     2     1     0    0  1635
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_7.png
better model found
persisted
after epoch: 7,now: 2024-07-08 17:28:49.136286,epoch time: 0:35:51.801459,used: 4:11:50.389586,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95852953, 'precision': 0.880849, 'recall': 0.87456745, 'specificity': 0.9955106, 'f1': 0.8759239, 'auroc': 0.9981346}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    1     1    3    0     8     0     1    1     21
1     0  1307    0     8    2    0     0    10     1    0      4
2     2     0  194     1   91    1     0     4     1   17      1
3     0     3    1  8329    0    9     1    53    41    1      1
4     2     0    5     1  429    0     1     0     5    1     95
5     1     0    2    30    0  418     0     0     5   64      1
6     7     0    1     2    4    0  1881     0     1    1     10
7     0    74    8   263    8    0     3  6804    69    2     31
8     0     6    2   124   36    1     0    36  3026    2     62
9     2     0   92     4   17   41     1     0     3  333      0
10    5     0    1     8  102    0    13     1     4    1  12658
---- Validation: 
scalar performance:
{'acc': 0.9577638, 'precision': 0.8789736, 'recall': 0.87285733, 'specificity': 0.9954434, 'f1': 0.8738371, 'auroc': 0.9982023}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    0     2    3    0    11     1     0    2     29
1     0  1312    0     8    0    0     0     9     1    0      2
2     0     1  196     1   99    0     0     2     2   10      1
3     1     4    1  8307    0   15     0    59    49    2      2
4     2     0    3     1  439    0     1     0     6    0     87
5     0     0    1    25    3  425     1     0     4   61      1
6     9     0    0     4    2    0  1880     0     1    0     12
7     1    81    8   269    6    0     2  6804    74    1     19
8     0     7    2   118   36    2     1    40  3028    1     61
9     6     0   93     7   12   52     0     0     5  317      1
10    7     0    2     7   91    1    11     3    10    1  12663
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7056601, 'precision': 0.6162188, 'recall': 0.5863323, 'specificity': 0.9704118, 'f1': 0.5803037, 'auroc': 0.87280303}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1093     1    1   20   11    0     8     9     3    5    19
1      4  1252    1   23    0    0     2   157     4    0    56
2      6     3   65   14  601   11     7    14   118   21   155
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    0    0  219    0     2     0     4    0  1408
5     12     0   13   71   21  297     1     0     4  171     2
6      0     0    0    2    1    0  3017     0     0    0    47
7      1     0    0  131    2    0     2  1016     3    1     8
8      1     1    1   80   27    1    14    10  1211    5    19
9     21    14  287   89  136   71     3    37   180  279    20
10     0     0    0    0    6    0     2     1     0    0  1637
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_8.png
better model found
persisted
after epoch: 8,now: 2024-07-08 18:04:49.598507,epoch time: 0:36:00.462221,used: 4:47:50.851807,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9601616, 'precision': 0.91588515, 'recall': 0.88352084, 'specificity': 0.995601, 'f1': 0.8979553, 'auroc': 0.9983087}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   433     0    0     6    2    0     4     4     0    4     30
1     0  1299    0     3    0    0     0    28     2    0      0
2     2     0  203     1   55    1     0    10     5   31      4
3     0     5    0  8021    0    5     1   334    71    1      0
4     1     0    2     2  392    1     0     1    22    1    117
5     0     1    0    24    1  457     0     0    11   26      1
6     2     0    0     5    2    0  1870     5     4    1     19
7     0    42    0    54    2    0     2  7123    28    0     12
8     0     2    2    94   14    1     1   101  3043    0     37
9     0     0   29     5    4   62     0     4     7  378      4
10   11     2    0     7   59    2     4    12    27    0  12668
---- Validation: 
scalar performance:
{'acc': 0.96014446, 'precision': 0.9085035, 'recall': 0.87813485, 'specificity': 0.995635, 'f1': 0.8913039, 'auroc': 0.99840117}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   439     0    1     6    3    0     5     4     0    2     23
1     0  1307    0     2    0    0     0    21     1    0      1
2     1     0  192     0   56    2     1    13     7   35      5
3     0     5    0  8039    0    6     1   319    70    0      0
4     1     0    4     1  399    1     0     2    18    2    111
5     0     0    0    25    2  455     0     0     9   29      1
6    10     1    0     7    2    1  1865     4     2    0     16
7     0    52    1    58    2    0     1  7118    20    0     13
8     1     1    2   108    5    0     0   113  3052    0     14
9     2     0   28     5    4   80     0     5    12  352      5
10   10     0    4     9   54    0     3    12    25    2  12677
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71321625, 'precision': 0.6307102, 'recall': 0.5949253, 'specificity': 0.97107166, 'f1': 0.56782174, 'auroc': 0.87682277}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   960     7   1  18    7    2    46   105     4   11     9
1     0  1342   0   7    0    0     0   138     2    0    10
2     4    15  47  11  276   11    10    87   327   48   179
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   0  200    0     4     3    21    1  1404
5     4     0   1  92    4  290     1     5    48  146     1
6     2     0   0   8    1    0  2962     8     2    0    84
7     0     0   0   1    0    0     1  1158     2    0     2
8     0     2   0  30    0    0     3    58  1274    2     1
9     9    37  48  62   27   75     4   218   303  323    31
10    0     0   0   0    7    0     0     1     0    0  1638
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_9.png
better model found
persisted
after epoch: 9,now: 2024-07-08 18:41:16.945687,epoch time: 0:36:27.347180,used: 5:24:18.198987,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95930547, 'precision': 0.8905543, 'recall': 0.89560133, 'specificity': 0.99562293, 'f1': 0.88791144, 'auroc': 0.99835634}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    3     1    3    0     2     0     0    1      2
1     0  1290    0     7    0    0     0    34     0    0      1
2     0     1  278     0   10    2     0     2     1   18      0
3     2     0    1  8298    0    3     2    90    41    1      1
4     5     0   72     0  327    0     2     1    19    6    107
5     1     0    4    29    0  444     0     0     3   39      1
6    16     0    2     2    0    0  1878     1     0    2      6
7     1    14    5   290    2    0     2  6849    89    1     10
8     2     1    4   140    3    8     2    32  3092    6      6
9     0     0   68     4    0   61     0     1     1  358      0
10   75     0   14     7   37    0    21     6    60    1  12570
---- Validation: 
scalar performance:
{'acc': 0.95827204, 'precision': 0.8886949, 'recall': 0.8933639, 'specificity': 0.99549985, 'f1': 0.88464713, 'auroc': 0.99839646}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    5     1    2    0     2     0     0    2      6
1     0  1289    0     7    0    0     0    35     0    0      1
2     0     0  286     2    6    0     1     3     3   11      0
3     1     1    0  8303    0    5     6    88    32    3      1
4     7     0   69     0  317    1     1     2    22    3    117
5     1     0    0    25    1  452     0     0     2   40      0
6    17     0    2     2    0    4  1870     1     2    1      9
7     2    14   11   291    2    0     3  6842    87    2     11
8     5     0   10   145    3    4     2    35  3078    4     10
9     0     0   75     5    0   65     1     0     1  346      0
10   74     0   15     7   39    1    26     4    52    1  12577
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7258798, 'precision': 0.67295027, 'recall': 0.6103424, 'specificity': 0.9724957, 'f1': 0.6078762, 'auroc': 0.88244337}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1089     0    0   18    1    1     3    47     5    5     1
1     11  1123    0   26    0    0    14   281     3    0    41
2     49     0  287   29  140   11    90    45   200   46   118
3      0     0    0    0    0    0     0     0     0    0     0
4      9     0    2    1  256    0    63     2    26    0  1274
5     14     0   11  162    2  275     1     0     9  115     3
6      6     0    0    2    0    0  3058     1     0    0     0
7      4     0    2   44    0    0     7  1094     3    2     8
8      3     0    1  116    0    1    21    10  1216    2     0
9     38     1  253  174    4   60    13    78   109  383    24
10     4     0    0    0   31    0    17     0     0    0  1594
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_10.png
early stop counter: 1
val acc:0.9582720398902893, best validation acc: 0.9601444602012634, corresponding to test acc:                         0.713216245174408 / 0.7365143895149231
after epoch: 10,now: 2024-07-08 19:22:55.684390,epoch time: 0:41:38.738703,used: 6:05:56.937690,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9616599, 'precision': 0.8991881, 'recall': 0.8976045, 'specificity': 0.99599874, 'f1': 0.8928536, 'auroc': 0.9987397}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     2    4    1    12     0     0    1     10
1     0  1316    0     3    0    0     0    12     1    0      0
2     2     0  171     2   38    0     2     9     4   84      0
3     0     1    0  8198    0    5    10   159    62    3      0
4     2     0    9     0  454    1     1     2    18    3     49
5     0     0    0     8    0  464     2     0     8   38      1
6     3     1    0     1    0    0  1895     0     4    0      4
7     1    40    0   146    2    0    10  7022    36    0      4
8     0     0    2    91    7    0     1    74  3111    2      8
9     0     1    8     1    4   68     0     2     5  403      1
10   11     0    1     7  225    0    26    11    55    1  12456
---- Validation: 
scalar performance:
{'acc': 0.95968974, 'precision': 0.8941151, 'recall': 0.893385, 'specificity': 0.995791, 'f1': 0.8879177, 'auroc': 0.99867624}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   449     0    0     0    5    0    16     1     1    3      8
1     0  1310    0     2    0    0     0    18     2    0      0
2     0     0  164     1   43    0     0     8     8   88      0
3     0     6    0  8165    1   10    11   175    68    4      0
4     1     0   12     0  442    0     1     2    17    6     58
5     0     0    0    15    1  470     1     0     3   30      1
6     2     0    0     1    0    0  1893     2     3    0      7
7     0    35    0   139    1    0    12  7038    35    0      5
8     1     0    0    97    7    2     1    82  3099    5      2
9     0     0    8     2    5   65     0     3     3  407      0
10   16     1    3     7  232    1    27    11    56    1  12441
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7377737, 'precision': 0.6788064, 'recall': 0.62493724, 'specificity': 0.9736577, 'f1': 0.6047343, 'auroc': 0.882702}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   943     0   0   13   10    7    88    55    16   30     8
1     6  1278   0   25    0    0     2   167    11    2     8
2     5     4  41   14  232   22     1    51   415  122   108
3     0     0   0    0    0    0     0     0     0    0     0
4     0     1   0    0  408    0     2     2    57    1  1162
5     2     0   0   55    4  400     1     0    12  116     2
6     2     0   0    1    0    0  3025     4    13    0    22
7     5     0   0   49    1    1    11  1086     6    4     1
8     0     0   0   68    0    3     6    21  1270    2     0
9     6     3  14  117   13  178     4    78   220  483    21
10    0     0   0    0   30    0     3     0     2    0  1611
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_11.png
new oracle model saved
early stop counter: 2
val acc:0.959689736366272, best validation acc: 0.9601444602012634, corresponding to test acc:                         0.713216245174408 / 0.7377737164497375
after epoch: 11,now: 2024-07-08 20:02:49.146072,epoch time: 0:39:53.461682,used: 6:45:50.399372,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.960991, 'precision': 0.9086907, 'recall': 0.90356904, 'specificity': 0.9958719, 'f1': 0.90382737, 'auroc': 0.9989021}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   422     0    0     1    3    1    50     0     2    1      3
1     0  1291    0     7    0    0     1    24     6    0      2
2     0     0  269     1   11    0     0     1     3   26      0
3     0     1    1  8234    0   31     2    27   136    4      0
4     5     0   39     1  366    1     1     2    28    3     93
5     0     0    0     5    0  441     1     0     6   67      1
6     2     0    0     3    0    1  1893     0     4    1      3
7     0     8    2   309    1    0     5  6795   138    1      6
8     0     0    2    49    2    5     3    13  3219    3      0
9     0     0   39     1    0   32     0     1     5  415      0
10   21     0    7     8   24    2    46    10   102    1  12573
---- Validation: 
scalar performance:
{'acc': 0.9634613, 'precision': 0.9116502, 'recall': 0.9091909, 'specificity': 0.9961267, 'f1': 0.90915996, 'auroc': 0.9988689}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    0     1    1    0    47     1     1    1      2
1     0  1287    0     6    0    0     0    34     4    0      1
2     0     0  274     0   16    1     0     0     2   19      0
3     0     1    1  8242    0   39     4    31   121    1      0
4     5     0   24     0  384    0     2     0    27    3     94
5     0     0    1     5    0  438     0     0     6   70      1
6     0     0    0     1    0    0  1901     0     2    1      3
7     1     8    2   291    1    0     6  6849   103    0      4
8     0     0    3    44    0    3     4     8  3228    3      3
9     0     0   41     3    0   31     0     0     5  413      0
10   17     1    4     8   46    1    39    11    95    0  12574
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.688239, 'precision': 0.641783, 'recall': 0.5736394, 'specificity': 0.968187, 'f1': 0.55713034, 'auroc': 0.8815797}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   496     0    1   21    3    5   463    76    64   37     4
1     0  1140    0   25    0    0    18   298     5    0    13
2     2     2  182   30  144   41    73    51   372   48    70
3     0     0    0    0    0    0     0     0     0    0     0
4     0     1    3    0  255    0    39     2    53    0  1280
5     2     0    2   55    0  385     3     0    22  122     1
6     0     0    0    1    0    0  3064     1     0    0     1
7     0     0    0   57    0    0     1  1103     1    0     2
8     0     0    0   66    0    4    20     8  1271    1     0
9     2     1  123  113    4  194    17    71   275  317    20
10    0     0    0    1   14    0     7     0     0    0  1624
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_12.png
better model found
persisted
after epoch: 12,now: 2024-07-08 20:41:38.787480,epoch time: 0:38:49.641408,used: 7:24:40.040780,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96543235, 'precision': 0.90660757, 'recall': 0.91639376, 'specificity': 0.99633455, 'f1': 0.91028744, 'auroc': 0.99890625}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     2    5    0     3     1     0    0     26
1     0  1314    0     1    1    1     0    12     1    0      2
2     1     0  241     0   27    1     1     4     2   33      2
3     7     5    0  8263    0   13     3    72    69    2      4
4     2     0   15     0  451    2     1     5     8    2     53
5     0     0    0     9    0  482     0     0     3   25      2
6    12     0    1     1    8    0  1862     0     1    0     23
7     9    57    3   204    0    0     3  6869   111    1      8
8     1     1    1    67   10    2     2    12  3184    1     13
9     0     0   22     6    0   73     0     1     4  387      0
10    4     0    3     7  152    0     4    10    26    0  12585
---- Validation: 
scalar performance:
{'acc': 0.9654407, 'precision': 0.91019726, 'recall': 0.9176809, 'specificity': 0.9963094, 'f1': 0.91288435, 'auroc': 0.9989861}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    0     1    2    0     2     0     0    1     26
1     0  1315    0     2    0    0     0    12     2    0      1
2     1     0  244     1   27    4     0     2     0   33      0
3     7     6    1  8252    0    8    11    77    75    3      0
4     4     0    8     0  456    1     0     2    11    5     52
5     0     0    0    14    0  479     0     0     4   23      1
6     8     0    0     0    2    0  1867     2     3    0     26
7     5    59    1   225    1    0     1  6869    88    1     15
8     1     3    1    65    8    5     0    19  3172    2     20
9     3     0   29     5    0   67     0     0     5  383      1
10    5     0    0     6  145    0     3     7    25    0  12605
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7441405, 'precision': 0.67738503, 'recall': 0.63573, 'specificity': 0.9742162, 'f1': 0.63114893, 'auroc': 0.88430214}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1020     0    0    9    7    3    54    25     6    4    42
1      1  1354    1   14    1    0     2   102     5    0    19
2      8     1  183   19  315   16     5    67   208   46   147
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    2    0  494    0     1     1    21    0  1114
5      6     0   10   71    2  368     0     0    14  118     3
6      3     0    0    1    1    0  2876     2     3    0   181
7      1     0    1   33    1    1    13  1108     2    0     4
8      3     0    0   58    5    2    21    11  1258    4     8
9     18     3  149  109   16  114    10    68   227  389    34
10     0     0    0    0   60    0     0     0     0    0  1586
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_13.png
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-08 21:20:42.745967,epoch time: 0:39:03.958487,used: 8:03:43.999267,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97118473, 'precision': 0.93791074, 'recall': 0.90475196, 'specificity': 0.9967378, 'f1': 0.9195468, 'auroc': 0.99916667}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     2    1    0     1     2     0    0     16
1     0  1270    0     7    0    1     0    51     1    0      2
2     2     0  245     1   24    1     0     4     5   28      2
3     1     0    0  8277    0    5     0   115    41    0      0
4     4     0   13     0  374    0     1     2     7    0    137
5     1     0    0     9    0  478     1     0     8   23      1
6    12     0    0     2    0    1  1878     0     3    0     11
7     0     3    0   114    2    0     1  7111    15    0     17
8     0     0    0    78    6    2     2    85  3081    0     42
9     6     0   19     7    4   65     1     2     5  380      4
10   11     0    2     6   12    0     2     8     7    0  12744
---- Validation: 
scalar performance:
{'acc': 0.9724756, 'precision': 0.93801415, 'recall': 0.90649855, 'specificity': 0.99690175, 'f1': 0.92018336, 'auroc': 0.99916416}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     0    0    1     0     1     0    0     16
1     0  1278    1     5    0    1     0    44     1    0      2
2     2     0  237     1   30    1     0     8     4   24      5
3     0     0    0  8285    0    8     0    97    49    1      0
4     6     0   11     0  383    0     0     3    13    0    123
5     1     0    0    10    0  488     0     0     5   15      2
6    14     0    0     3    0    0  1875     1     4    0     11
7     1     2    1    98    2    0     1  7133    12    0     15
8     1     0    1    63    7    0     2    84  3090    0     48
9     5     0   19     3    5   73     1     1     9  376      1
10   13     0    1     9    6    0     6     5    10    0  12746
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7029315, 'precision': 0.6177528, 'recall': 0.59775484, 'specificity': 0.9700576, 'f1': 0.56886965, 'auroc': 0.8769926}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1091     0    0  12    0    0    24    20     7    1    15
1      3  1024    0  24    0    2     4   388    12    0    42
2     14     0  127  10  186   26    13    38   173   49   379
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    0   0   61    0     4     2     6    0  1560
5     13     0    7  43    1  365     0     0    15  141     7
6      4     0    0   2    0    0  2986     0     1    0    74
7      2     0    0  42    0    2     5  1110     1    0     2
8      6     0    0  47    0   18    12    24  1249    4    10
9     45     0  102  42   10  194     7    81   203  390    63
10     0     0    0   0    0    0     2     0     0    0  1644
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_14.png
better model found
persisted
after epoch: 14,now: 2024-07-08 22:00:52.717027,epoch time: 0:40:09.971060,used: 8:43:53.970327,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9677601, 'precision': 0.929725, 'recall': 0.9149411, 'specificity': 0.99645364, 'f1': 0.92033494, 'auroc': 0.9992317}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     0    2    0    10     1     0    1     23
1     0  1299    0     3    0    0     0    29     0    0      0
2     1     0  273     0    4    0     0     5     0   26      3
3     4     1    0  8018    0   15     9   332    56    2      1
4     2     0   48     1  371    0     1    10     7    5     94
5     3     0    3    11    0  444     0     0     2   55      2
6     3     0    0     0    0    0  1892     1     0    0     12
7     0     6    1    33    1    0     0  7207    14    0      3
8     0     0    2    35    2    5     5   135  3096    0     15
9     4     0   25     2    0   20     1     4     2  435      0
10    2     1    4     6   31    0     7    28    23    0  12690
---- Validation: 
scalar performance:
{'acc': 0.9673666, 'precision': 0.93095285, 'recall': 0.91509026, 'specificity': 0.9964069, 'f1': 0.9210879, 'auroc': 0.9991821}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   446     0    0     0    3    0     8     4     0    0     22
1     0  1301    0     2    0    0     0    28     1    0      0
2     0     0  273     0    3    0     1     6     2   27      0
3     2     3    0  8003    1   12    15   344    59    1      0
4     3     0   44     0  376    0     0     6     7    2    101
5     5     0    0    11    1  440     0     0     2   60      2
6     5     0    0     0    0    0  1895     1     0    0      7
7     0     6    1    28    1    0     1  7213     8    2      5
8     0     3    3    45    5    1     5   140  3076    2     16
9     6     0   21     1    0   19     2     3     1  438      2
10    1     1    6     7   26    0     4    23    24    0  12704
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6747359, 'precision': 0.6360843, 'recall': 0.54998446, 'specificity': 0.96695435, 'f1': 0.5268596, 'auroc': 0.8810335}
confusion matrix:
     0     1    2   3   4    5     6     7     8    9     10
0   819     0    1   3   0    0   197   133     1    0    16
1     0  1042    0   5   0    0     0   437     0    0    15
2    21     2  158   5  56    4    37   230   146   41   315
3     0     0    0   0   0    0     0     0     0    0     0
4     0     0    2   0  73    0    10     7    11    0  1530
5    39     0    9  66   0  183    37    12    38  195    13
6     0     0    0   1   0    0  3053     5     0    0     8
7     0     0    0   2   0    0     1  1160     0    0     1
8     0     2    1  35   1    0    31   118  1178    0     4
9    51     1  110  42   0   38    22   318   168  337    50
10    0     0    0   0   1    0     4     0     0    0  1641
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_15.png
early stop counter: 1
val acc:0.9673665761947632, best validation acc: 0.9724755883216858, corresponding to test acc:                         0.7029315233230591 / 0.7441405057907104
after epoch: 15,now: 2024-07-08 22:40:24.897189,epoch time: 0:39:32.180162,used: 9:23:26.150489,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9723887, 'precision': 0.9197362, 'recall': 0.9174874, 'specificity': 0.9970496, 'f1': 0.917565, 'auroc': 0.9991231}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     0    0     0    3    0    12     2     1    4     19
1     0  1296    0     1    0    0     0    31     3    0      1
2     0     0  235     1    3    2     0     4     0   66      1
3     0     3    0  8225    0   43     2    95    70    1      0
4     3     0   59     0  391    1     0     6     7    7     65
5     0     0    0     2    0  494     0     0     3   19      1
6     1     0    0     0    0    1  1898     2     3    0      3
7     0     6    0   126    2    1     1  7076    44    1      4
8     0     0    2    33    2    1     2    46  3189    0     21
9     1     0    6     0    0   53     0     0     2  430      1
10    4     0    3     7   60    1     5    20    26    0  12668
---- Validation: 
scalar performance:
{'acc': 0.97164637, 'precision': 0.91656524, 'recall': 0.9156807, 'specificity': 0.99698, 'f1': 0.91487014, 'auroc': 0.9989556}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    1     0    1    0    21     3     0    3     16
1     0  1308    0     1    0    0     0    21     2    0      0
2     0     0  235     0    4    1     0     2     0   68      2
3     1     1    0  8227    0   47     3    88    72    1      0
4     4     0   63     1  383    2     1     2     9    6     68
5     0     0    0     2    0  494     0     0     2   22      1
6     3     0    0     2    0    0  1891     3     4    1      4
7     0     8    1   113    0    0     2  7090    45    1      5
8     1     0    1    42    1    6     1    57  3165    0     22
9     0     0    6     0    0   50     0     2     0  434      1
10    4     0    2     7   60    2    13    23    25    0  12660
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6967047, 'precision': 0.6517755, 'recall': 0.591171, 'specificity': 0.9692873, 'f1': 0.5670888, 'auroc': 0.8827012}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   830     0    1   9    1   11   187    67    12   29    23
1     0  1051    0  17    0    0     0   408     6    0    17
2     6     1  204   5   50   34    19   126   256   74   240
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    7   0  117    0     5     9    19    0  1476
5     0     0    3  39    0  384    15     4    20  125     2
6     0     0    1   1    0    0  2994     4     2    0    65
7     0     0    0  28    0    0     0  1134     0    0     2
8     0     0    1  37    0    3    11    49  1261    1     7
9     5     2  103  65    3  172    31   139   237  351    29
10    0     0    0   0   11    0     1     1     1    0  1632
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_16.png
early stop counter: 2
val acc:0.9716463685035706, best validation acc: 0.9724755883216858, corresponding to test acc:                         0.7029315233230591 / 0.7441405057907104
after epoch: 16,now: 2024-07-08 23:19:24.638201,epoch time: 0:38:59.741012,used: 10:02:25.891501,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9737532, 'precision': 0.9440373, 'recall': 0.9140391, 'specificity': 0.9971334, 'f1': 0.92591643, 'auroc': 0.9992195}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    3     1    3    0     3     2     2    0     14
1     0  1307    0     3    0    0     0    18     3    0      1
2     0     0  268     0    4    0     1     7     8   21      3
3     4     1    0  8241    0    4     3    76   110    1      0
4     1     0   25     0  350    0     0     2    33    1    126
5     0     0    0    15    0  476     0     0     5   23      1
6     2     0    1     0    0    0  1879     4     4    0     18
7     2     9    0    74    0    0     5  7110    60    0      4
8     0     0    1    24    0    0     0    31  3235    0      5
9     0     0   28     3    0   52     0     5    14  391      0
10    3     0    1     5    9    1     4    13    71    0  12683
---- Validation: 
scalar performance:
{'acc': 0.97223485, 'precision': 0.9370296, 'recall': 0.9110141, 'specificity': 0.996991, 'f1': 0.9211452, 'auroc': 0.9992401}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    2     2    5    0     3     2     1    0     16
1     0  1306    0     4    0    0     0    19     3    0      0
2     0     0  261     0    8    3     0     8     7   20      5
3     4     1    1  8209    0    2     2    90   130    0      1
4     4     0   24     0  354    1     0     1    33    3    119
5     1     0    1     9    0  480     0     0    12   17      1
6     8     0    1     1    0    1  1877     1     6    0     13
7     1    11    0    88    0    0     2  7098    59    0      6
8     0     0    1    17    0    0     1    26  3247    0      4
9     1     0   32     2    0   59     1     2    11  385      0
10    7     0    2     5   11    1     2    18    71    1  12678
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6937662, 'precision': 0.63702786, 'recall': 0.58099383, 'specificity': 0.96904826, 'f1': 0.54825807, 'auroc': 0.8786852}
confusion matrix:
     0     1   2   3   4    5     6     7     8    9     10
0   898     0   3  15   2   10    94    83    26   28    11
1     5  1018   0  18   0    0     3   412    19    0    24
2     6     2  75   3  66   16    14    65   519   68   181
3     0     0   0   0   0    0     0     0     0    0     0
4     0     0   1   0  86    0     6     5    68    0  1467
5     4     0   5  42   0  329     7     2    51  146     6
6     1     0   0   0   0    0  3033     2     3    0    28
7     0     0   0   7   0    0     0  1153     3    0     1
8     0     0   0  24   0    1     5    25  1314    1     0
9     7     1  48  45   2   98    14    97   421  376    28
10    0     0   0   0   6    0     3     1     2    0  1634
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_17.png
early stop counter: 3
val acc:0.972234845161438, best validation acc: 0.9724755883216858, corresponding to test acc:                         0.7029315233230591 / 0.7441405057907104
after epoch: 17,now: 2024-07-08 23:58:06.161291,epoch time: 0:38:41.523090,used: 10:41:07.414591,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97099745, 'precision': 0.9429519, 'recall': 0.90167737, 'specificity': 0.99680984, 'f1': 0.9191845, 'auroc': 0.99926925}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     4    1    0     4     0     1    0     19
1     0  1292    0    12    0    0     0    27     0    0      1
2     2     0  214     0   28    0     0    10    20   34      4
3     0     0    0  8367    0    2     0    27    42    0      0
4     5     0    7     1  415    0     0     0    30    0     80
5     0     0    0    32    0  398     0     0    16   74      1
6     0     0    0     2    0    0  1895     0     3    0      8
7     0     5    0   258    1    0     1  6941    51    0      7
8     1     0    0    69    1    0     0    17  3202    1      5
9     0     0   12     3    2   16     1     2    21  436      0
10    8     0    1     9   20    1     9     6    59    0  12678
---- Validation: 
scalar performance:
{'acc': 0.9719139, 'precision': 0.946588, 'recall': 0.9035492, 'specificity': 0.99690866, 'f1': 0.9219652, 'auroc': 0.999252}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    0     3    0    0     8     0     2    1     14
1     0  1302    0     7    0    0     0    20     2    0      1
2     1     0  218     1   24    0     0     9    20   32      7
3     0     0    0  8380    0    1     1    19    38    1      0
4     5     0    5     2  418    0     1     1    31    1     75
5     1     0    0    38    1  400     0     0    19   62      0
6     3     0    0     4    0    0  1881     1     3    0     16
7     1     6    0   249    1    0     1  6956    47    0      4
8     0     0    0    56    0    0     1    22  3210    0      7
9     1     0   11    11    4   14     1     3    16  432      0
10    6     0    0     8   21    0    12     3    62    1  12683
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65815437, 'precision': 0.62683815, 'recall': 0.5238141, 'specificity': 0.96567637, 'f1': 0.5106499, 'auroc': 0.8745877}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   898     0   1   29    1    0   168   14     7   25    27
1     2  1111   0   43    0    0     1  292    11    0    39
2     5     1  74   31  123    3    20   57   377   46   278
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   0    0   90    0     7    1    24    0  1511
5     8     0   2  161    4  109    45    1    22  230    10
6     3     0   0    3    0    0  3037    2     1    0    21
7     0     0   0  248    0    0     3  911     1    0     1
8     0     0   0  131    0    0    10   25  1199    2     3
9     7     1  44  201    8   31    50  110   306  336    43
10    0     0   0    1    1    0     2    0     0    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_18.png
early stop counter: 4
val acc:0.9719138741493225, best validation acc: 0.9724755883216858, corresponding to test acc:                         0.7029315233230591 / 0.7441405057907104
after epoch: 18,now: 2024-07-09 00:36:46.288981,epoch time: 0:38:40.127690,used: 11:19:47.542281,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96885705, 'precision': 0.92285013, 'recall': 0.9090235, 'specificity': 0.99658626, 'f1': 0.91491354, 'auroc': 0.9989562}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0     6    3    0    12     1     3    0     27
1     0  1317    0     3    0    0     0     9     2    0      1
2     1     0  240     0   19    1     0     2     3   43      3
3     0     0    0  8184    1   26     0   124    82   19      1
4     2     0   16     1  394    0     1     1     7    3    114
5     0     0    0    18    1  456     0     0     2   43      1
6     2     0    0     5    2    1  1873     2    11    1     11
7     0    26   10    92    3    0     4  7019    71   10     28
8     0     1    1    50   18    6     1    30  3142    5     40
9     1     0   14     2    1   38     1     0     3  432      1
10    1     2    1     6   28    1     8     4    18    1  12724
---- Validation: 
scalar performance:
{'acc': 0.968276, 'precision': 0.92502046, 'recall': 0.91335386, 'specificity': 0.9965005, 'f1': 0.91824615, 'auroc': 0.99898636}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    0     5    5    0     5     2     1    0     36
1     0  1312    0     2    0    0     0    16     2    0      0
2     0     0  249     0   20    0     0     1     3   37      2
3     0     0    2  8189    1   18     0   133    72   23      2
4     2     0   12     0  401    2     1     3     6    2    110
5     0     0    0     9    0  458     0     0     3   51      0
6     3     0    0     4    0    0  1883     2     5    0     11
7     0    21    6   121    8    0     4  6984    75   10     36
8     1     4    4    54   18    5     0    36  3128   10     36
9     2     0   11     3    4   30     1     0     1  439      2
10    4     0    1     8   30    0    11     1    14    0  12727
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6729168, 'precision': 0.615425, 'recall': 0.54836285, 'specificity': 0.9671275, 'f1': 0.52896416, 'auroc': 0.8667627}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   744     0   1  101    1    0    54   146    56    5    62
1     5  1102   0   24    0    0    23   277    13    1    54
2    18     1  84   17  197   12    11    30   298   38   309
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    0   82    0    15     2    19    0  1514
5     8     0   0  207    6  216     1     2    43  107     2
6     1     0   0    2    0    0  3024     2     8    0    30
7     1     0   0   27    0    0     7  1106     6    0    17
8     0     0   1   33    5    0     3    17  1302    2     7
9    27     1  64  111   23   98     4    69   360  320    60
10    1     0   0    0    3    0     4     0     0    0  1638
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_19.png
early stop counter: 5
val acc:0.9682760238647461, best validation acc: 0.9724755883216858, corresponding to test acc:                         0.7029315233230591 / 0.7441405057907104
after epoch: 19,now: 2024-07-09 01:15:23.723114,epoch time: 0:38:37.434133,used: 11:58:24.976414,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9824754, 'precision': 0.96013117, 'recall': 0.9445447, 'specificity': 0.99809194, 'f1': 0.9512173, 'auroc': 0.999733}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     1    5    0     0     0     0    1     18
1     0  1318    0     1    0    0     0    10     2    0      1
2     0     0  289     0    7    0     0     3     6    6      1
3     1     0    1  8280    0    2     0    52    98    1      1
4     2     0   11     0  432    0     0     1    16    1     76
5     0     0    1     3    0  491     0     0     9   17      0
6     1     0    0     1    1    0  1894     0     3    0      7
7     0     6    0    61    0    0     1  7135    54    0      7
8     0     0    1    13    1    0     0    17  3259    0      4
9     0     0   35     1    2   37     0     1     2  413      1
10    3     0    1     5    4    0     1     4    25    0  12752
---- Validation: 
scalar performance:
{'acc': 0.9818644, 'precision': 0.961469, 'recall': 0.94733495, 'specificity': 0.9980124, 'f1': 0.9530258, 'auroc': 0.9997255}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    1     0    2    0     1     0     2    0     13
1     0  1314    0     5    0    0     0    10     3    0      0
2     0     0  295     0    4    0     0     2     4    4      3
3     1     0    0  8279    0    2     1    58    98    1      0
4     3     0   14     0  426    0     1     1    11    1     82
5     0     0    2     3    0  494     0     0    10   12      0
6     4     0    0     1    1    0  1889     0     2    0     11
7     1     8    2    73    2    0     2  7127    46    0      4
8     0     0    0    17    0    0     0    26  3247    0      6
9     1     1   37     2    1   24     0     2     3  422      0
10    3     0    1     4    7    0     1     4    26    0  12750
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.717694, 'precision': 0.63034195, 'recall': 0.6129458, 'specificity': 0.9715505, 'f1': 0.585847, 'auroc': 0.87658376}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   964     0    8  12    4   25    38    46     6   41    26
1     1  1284    0  14    0    0     0   175    10    0    15
2     0     5  163   9  165   28     6    47   303   38   251
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   1   80    0     3     3    18    1  1527
5     1     0   16  52    1  389     0     0    30  102     1
6     1     0    0   2    0    0  2943     1     1    0   119
7     0     0    0  29    0    1     1  1132     0    0     1
8     0     0    0  31    0    4     2    18  1311    0     4
9     6    11  147  55    7  159     0    70   299  353    30
10    0     1    0   1    2    0     2     0     1    0  1639
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_20.png
better model found
persisted
after epoch: 20,now: 2024-07-09 01:51:36.406424,epoch time: 0:36:12.683310,used: 12:34:37.659724,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98113763, 'precision': 0.9396871, 'recall': 0.95121855, 'specificity': 0.99799305, 'f1': 0.9435972, 'auroc': 0.99965954}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    2     0    4    0     4     1     0    0     11
1     0  1300    0     2    0    0     1    26     1    0      1
2     0     0  295     0   14    0     0     3     0    0      0
3     1     0    1  8306    0    5     3    61    59    2      2
4     3     0    8     0  502    0     1     0     3    0     22
5     0     0    2     2    1  486     0     0     2   27      1
6     4     0    1     1    0    0  1884     2     0    0     15
7     0     3    0    60    1    0     2  7155    29    1     11
8     1     0    2    13    5    1     2    27  3205    0     39
9     1     0   77     1    0   17     0     0     1  395      1
10    6     0    3     3   97    0     1     0     1    0  12682
---- Validation: 
scalar performance:
{'acc': 0.9802595, 'precision': 0.93887615, 'recall': 0.94932044, 'specificity': 0.99789596, 'f1': 0.9421164, 'auroc': 0.99964076}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    1     0    6    0     7     0     0    0      9
1     0  1304    0     4    0    0     1    22     1    0      0
2     0     0  300     0   10    0     0     1     0    1      0
3     1     0    1  8293    0   10     3    60    70    1      1
4     1     0   15     0  488    0     0     0     3    1     31
5     0     0    2     3    1  486     0     0     2   26      1
6     1     0    1     0    0    0  1884     2     2    1     17
7     0     4    3    62    2    0     3  7156    28    0      7
8     0     0    4    16   17    1     1    33  3179    0     45
9     1     0   72     0    2   21     0     0     3  394      0
10    0     0    2     1   82    0     3     2     3    0  12703
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68362135, 'precision': 0.63026917, 'recall': 0.5723597, 'specificity': 0.96767104, 'f1': 0.5696943, 'auroc': 0.8752341}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   748     0   18   3    4    0   307    54     5    7    24
1     0  1068    1  13    0    0     3   357    11    1    45
2     9     0  208   2  366    8    17    50    92   25   238
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  377    0     4     1     3    0  1248
5     4     0   52  45    9  261    36     2    20  158     5
6     2     0    1   0    5    0  2767     1     1    0   290
7     0     0    0   8    0    0     4  1148     0    0     4
8     0     0    2  24   12    3    14    23  1285    2     5
9     7     0  363  36   58   62    31    85   149  299    47
10    0     0    0   0   35    0     1     0     0    0  1610
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_21.png
early stop counter: 1
val acc:0.9802594780921936, best validation acc: 0.9818643927574158, corresponding to test acc:                         0.7176939845085144 / 0.7441405057907104
after epoch: 21,now: 2024-07-09 02:27:31.402903,epoch time: 0:35:54.996479,used: 13:10:32.656203,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97915775, 'precision': 0.94336987, 'recall': 0.93480104, 'specificity': 0.99772465, 'f1': 0.9354043, 'auroc': 0.99967456}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    1    0     0     0     0    0      6
1     0  1304    1     2    0    0     0    18     6    0      1
2     2     0  293     0    5    0     0     0     0    9      3
3     1     1    2  8229    0    4     1   145    53    2      0
4     7     0   13     0  439    0     0     0     1    1     78
5     2     0    1     4    1  374     0     0     1  138      0
6    24     0    0     2    1    0  1859     0     0    1     21
7     0     4    1    35    0    0     0  7204     9    1      9
8     0     0    4    19    5    0     0    39  3191    6     31
9     1     0   26     1    1    1     0     0     0  463      0
10    5     0    0     3   13    0     1     0     4    1  12765
---- Validation: 
scalar performance:
{'acc': 0.9798582, 'precision': 0.94458246, 'recall': 0.9388914, 'specificity': 0.9977922, 'f1': 0.9385314, 'auroc': 0.9996907}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    0    0     0     1     0    1      6
1     0  1309    0     1    0    0     1    18     1    0      2
2     1     0  302     0    5    0     0     0     0    4      0
3     5     0    0  8239    0    2     0   136    52    5      1
4     7     0   10     0  438    0     0     0     0    1     83
5     0     0    2     3    2  387     0     0     1  126      0
6    21     0    0     0    1    0  1865     3     0    0     18
7     2     5    3    37    0    0     0  7198     8    3      9
8     0     0    4    16    9    0     0    34  3194    3     36
9     4     0   28     0    1    2     0     1     0  457      0
10    9     0    1     3   10    0     1     1     3    0  12768
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69257677, 'precision': 0.6515087, 'recall': 0.58153075, 'specificity': 0.9689436, 'f1': 0.56394637, 'auroc': 0.87386584}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1018     0    1  14    0    0    12    90     8   12    15
1      0  1189    0  16    0    0     1   237    12    1    43
2     21     0  211   4  130    3     3    48   108   77   410
3      0     0    0   0    0    0     0     0     0    0     0
4      1     0    1   0   87    0     3     2    10    0  1529
5     20     0   11  49    4  107     5     2    14  374     6
6      7     0    1   0    0    0  2636     1     1    0   421
7      0     0    0  41    0    0     0  1114     0    2     7
8      2     0    4  43    2    0     6    34  1266    7     6
9     25     1  191  26    6   13     3    87    73  630    82
10     0     0    0   0    4    0     1     0     0    0  1641
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_22.png
early stop counter: 2
val acc:0.9798582196235657, best validation acc: 0.9818643927574158, corresponding to test acc:                         0.7176939845085144 / 0.7441405057907104
after epoch: 22,now: 2024-07-09 03:03:35.913825,epoch time: 0:36:04.510922,used: 13:46:37.167125,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9833851, 'precision': 0.95834875, 'recall': 0.9588212, 'specificity': 0.998201, 'f1': 0.95829237, 'auroc': 0.99974114}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     1    0    0     0     0     0    0      3
1     0  1320    0     0    0    0     0    12     0    0      0
2     1     0  274     0   15    0     0     4     2   15      1
3     2     1    0  8359    0    3     0    67     6    1      0
4     8     0    1     0  501    0     2     0     1    2     24
5     0     0    0     6    0  498     0     0     0   16      0
6     1     0    0     0    0    0  1903     0     1    0      3
7     1     8    0    74    1    0     4  7162     9    0      4
8     0     1    0    68    3    0     0    66  3141    0     17
9     0     0   19     3    0   32     2     0     1  434      2
10   25     3    0     6   36    0    16     3    17    1  12684
---- Validation: 
scalar performance:
{'acc': 0.9842985, 'precision': 0.959376, 'recall': 0.96143305, 'specificity': 0.99830925, 'f1': 0.9601662, 'auroc': 0.99975693}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    2    0     2     0     0    0      3
1     0  1320    0     0    0    0     0    11     1    0      0
2     2     0  278     0   16    0     1     0     3   11      1
3     0     1    0  8358    0    2     1    64    12    2      0
4     8     0    3     0  500    0     1     1     3    1     22
5     1     0    0     5    0  497     0     0     0   18      0
6     5     0    0     1    0    0  1898     1     0    0      3
7     1     9    1    63    0    0     3  7179     5    1      3
8     1     1    1    68    2    0     2    51  3154    0     16
9     2     0   13     3    0   26     1     1     1  446      0
10   23     3    0     6   39    0    10     7    15    1  12692
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7301476, 'precision': 0.6415727, 'recall': 0.609197, 'specificity': 0.97260463, 'f1': 0.60004824, 'auroc': 0.88328224}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   966     0    1  13    5    0   157    11     6    5     6
1     3  1221    1  15    0    0     1   233     4    0    21
2    11     4  126   9  348   12    44    34   226   70   131
3     0     0    0   0    0    0     0     0     0    0     0
4     1     0    0   1  353    0    26     1    22    0  1229
5    12     0    7  39   13  273    12     1    10  216     9
6     0     0    0   1    0    0  3052     0     1    0    13
7     0     0    0  26    0    0     6  1129     1    1     1
8     1     0    1  75    2    5     8    29  1247    1     1
9    30     4  139  55   42  116    19    78   152  468    34
10    0     0    0   0   34    0     9     1     1    0  1601
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_23.png
better model found
persisted
after epoch: 23,now: 2024-07-09 03:39:15.471446,epoch time: 0:35:39.557621,used: 14:22:16.724746,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97931826, 'precision': 0.94825625, 'recall': 0.9407822, 'specificity': 0.9977299, 'f1': 0.9418639, 'auroc': 0.9995733}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     0    6     4    5    0    10     0     1    0     12
1     0  1308    0     3    0    0     0    20     1    0      0
2     0     0  301     0    0    0     0     4     0    6      0
3     0     1    0  8348    0    7     1    55    25    1      0
4     2     0   54     1  411    0     0     3    12    1     54
5     0     0    0     6    0  476     0     0     4   34      1
6     2     0    3     4    2    0  1886     2     0    0      8
7     1     5    1   149    1    0     1  7088    12    0      5
8     0     1    1    54    2    0     0    47  3179    0     11
9     0     0   39     5    0    9     0     3     0  437      0
10    3     0   13     7   17    0     2     9    20    0  12724
---- Validation: 
scalar performance:
{'acc': 0.97849405, 'precision': 0.94750184, 'recall': 0.94166005, 'specificity': 0.9976391, 'f1': 0.94250005, 'auroc': 0.99965477}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    4     1    5    0     9     3     3    1      9
1     0  1313    0     4    0    0     0    14     1    0      0
2     0     0  303     1    1    0     0     3     0    4      0
3     1     2    0  8337    0    8     0    66    25    1      0
4     2     0   47     1  424    1     0     2     6    3     53
5     0     0    1     8    0  472     0     0     4   36      0
6     3     0    3     8    1    0  1881     0     1    1     10
7     2     5    0   151    0    0     0  7081    18    0      8
8     0     0    1    61    1    0     0    60  3165    0      8
9     0     0   40     3    0   15     0     0     2  433      0
10    4     0    6     7   18    0     2    12    21    2  12724
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6838313, 'precision': 0.6559272, 'recall': 0.585137, 'specificity': 0.9684992, 'f1': 0.58291745, 'auroc': 0.87630653}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   837     1   18   62    7   41    72   15    13   98     6
1     2  1050    2   36    0    0     2  378     8    0    21
2     2     1  313   30   92   20     6   68   346   73    64
3     0     0    0    0    0    0     0    0     0    0     0
4     0     1   10    1  231    0     4    1    46    0  1339
5     2     0    7   64    0  363     0    0    14  141     1
6     3     0    3    8    1    0  2763    3    79    0   207
7     0     0    0  274    0    0     6  879     2    2     1
8     0     0    0   63    1    5     1   21  1276    3     0
9     4     3  135  121    1  139     4   77   206  432    15
10    0     0    0    0   14    0     1    0     1    0  1630
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_24.png
early stop counter: 1
val acc:0.9784940481185913, best validation acc: 0.9842985272407532, corresponding to test acc:                         0.7301476001739502 / 0.7441405057907104
after epoch: 24,now: 2024-07-09 04:14:40.344991,epoch time: 0:35:24.873545,used: 14:57:41.598291,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98523116, 'precision': 0.9670015, 'recall': 0.9517287, 'specificity': 0.99835837, 'f1': 0.9582387, 'auroc': 0.99980235}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     0    2    0     6     0     0    1     14
1     0  1323    0     1    0    0     0     8     0    0      0
2     0     0  249     0   13    1     1     1     2   45      0
3     1     2    0  8332    0   12     0    69    20    2      0
4     3     0    4     0  467    0     0     1     2    0     62
5     0     0    0     3    0  503     0     0     1   14      0
6     3     0    0     0    0    0  1902     0     0    0      2
7     0    14    0    55    0    0     0  7170    18    0      6
8     1     1    0    43    4    2     1    33  3185    0     25
9     0     0    1     0    0   20     0     0     0  471      0
10    3     1    1     2   12    1     3     4     5    0  12762
---- Validation: 
scalar performance:
{'acc': 0.98512775, 'precision': 0.96533686, 'recall': 0.94980216, 'specificity': 0.9983464, 'f1': 0.9565786, 'auroc': 0.9998046}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     0    3    1     3     2     0    2     12
1     0  1322    0     1    0    0     0     9     0    0      0
2     0     0  249     0   13    0     0     0     1   45      4
3     1     0    0  8337    0    5     2    65    25    4      1
4     4     0    5     0  465    0     0     0     2    0     63
5     0     0    0     2    1  505     0     0     1   12      0
6     2     0    0     1    0    0  1901     0     2    1      1
7     1    16    0    46    0    0     1  7173    20    1      7
8     1     1    1    37    5    1     0    34  3185    1     30
9     0     0    3     0    0   27     0     0     0  462      1
10    0     2    0     4   12    0     4     3     1    0  12770
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69432586, 'precision': 0.63692254, 'recall': 0.58598185, 'specificity': 0.9689472, 'f1': 0.56765425, 'auroc': 0.8719781}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   904     1   1    5    8    5   153   21     3   33    36
1     2  1185   0   32    0    2    23  217     5    4    29
2     7     2  90    6  243   24    28   68   182   53   312
3     0     0   0    0    0    0     0    0     0    0     0
4     1     0   1    0  117    0     9    0     9    0  1496
5     8     0   2   48    3  371    15    1    12  113    19
6     3     0   0    1    0    0  2951    1     0    0   111
7     0     1   0  129    0    1    38  993     0    0     2
8     1     0   0   36    5    9    25   28  1253    1    12
9    12     6  39   63   23  198    36   90   179  420    71
10    0     0   0    0    3    0     3    0     0    0  1640
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_25.png
better model found
persisted
after epoch: 25,now: 2024-07-09 04:50:07.470687,epoch time: 0:35:27.125696,used: 15:33:08.723987,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.97669625, 'precision': 0.9489098, 'recall': 0.94735324, 'specificity': 0.9975195, 'f1': 0.947116, 'auroc': 0.9997195}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     0    0     4    3    0    29     0     0    1      3
1     0  1329    0     0    0    0     0     2     1    0      0
2     0     0  276     0    3    0     1     0     0   32      0
3     0     3    0  8396    0    3     1    36     0    0      0
4     3     0   13     0  473    0     5     0     0    7     36
5     0     0    0    13    0  467     0     0     0   41      0
6     0     0    0     1    0    1  1905     1     0    0      0
7     0    31    1    95    0    0     2  7124     6    1      2
8     1     0    3   159   16    1     9    42  3044    2     19
9     0     0    5     1    0   10     2     0     0  475      0
10    2     8    1     4   33    1   164     4     2    1  12573
---- Validation: 
scalar performance:
{'acc': 0.97761136, 'precision': 0.95156294, 'recall': 0.9515413, 'specificity': 0.9976064, 'f1': 0.9508665, 'auroc': 0.99974227}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     1    4    0    22     0     0    0      3
1     0  1328    0     0    0    0     0     3     1    0      0
2     1     0  273     0    2    1     1     2     0   31      1
3     1     1    0  8398    0    3     0    32     3    2      0
4     4     0   11     0  476    0     5     2     1    4     36
5     0     0    0    12    0  484     0     0     0   25      0
6     0     0    0     2    0    0  1906     0     0    0      0
7     1    43    1    96    0    0     1  7119     3    0      1
8     0     0    2   146   21    3     9    44  3044    2     25
9     0     0    5     1    0   11     0     1     0  475      0
10    2     3    2     5   31    0   155     3     2    1  12592
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6997132, 'precision': 0.67925274, 'recall': 0.570844, 'specificity': 0.9695486, 'f1': 0.581707, 'auroc': 0.8801292}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   760     0    0   32    2    2   289   15     0   63     7
1     1  1296    1   36    1    0     6  150     1    2     5
2     2     6  163   51  195   18   157   52   142  119   110
3     0     0    0    0    0    0     0    0     0    0     0
4     0     3    4    1  278    0   110    2    12    0  1223
5     1     0    1  136    0  187    15    1     1  249     1
6     0     0    0    2    1    0  3060    0     1    0     3
7     0     0    0  193    0    0    13  957     1    0     0
8     0     0    0  172    2    4    21   16  1144    9     2
9     4    10   43  244    6   74    37   53    79  565    22
10    0     2    0    0    8    0    44    1     0    0  1591
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_26.png
early stop counter: 1
val acc:0.9776113629341125, best validation acc: 0.9851277470588684, corresponding to test acc:                         0.694325864315033 / 0.7441405057907104
after epoch: 26,now: 2024-07-09 05:25:34.811917,epoch time: 0:35:27.341230,used: 16:08:36.065217,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98450875, 'precision': 0.9591671, 'recall': 0.9648821, 'specificity': 0.9983459, 'f1': 0.96183276, 'auroc': 0.999788}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    6    0     0     0     1    0      6
1     0  1322    0     3    0    0     0     5     2    0      0
2     0     0  301     0    2    0     0     0     2    6      1
3     3     0    0  8312    0    4     1    63    54    1      1
4     2     0   12     0  483    0     0     0     4    1     37
5     0     0    0     3    1  497     0     1     0   19      0
6    27     0    1     0    3    0  1860     0     1    0     16
7     1    11    2    64    0    0     2  7115    60    0      8
8     0     0    0    18    2    1     0     6  3262    0      5
9     3     0   13     2    1   26     0     0     0  448      0
10    2     1    0     0   34    0     1     5    22    0  12727
---- Validation: 
scalar performance:
{'acc': 0.98494047, 'precision': 0.9623911, 'recall': 0.9653572, 'specificity': 0.99837875, 'f1': 0.9637031, 'auroc': 0.99979866}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     0    6    0     0     0     0    0     12
1     0  1319    0     4    0    0     0     6     2    0      1
2     0     0  299     0    2    0     0     1     1    7      2
3     1     0    0  8313    0    7     0    58    56    2      3
4     2     0   16     0  479    0     0     1     8    0     33
5     1     0    1     5    0  499     0     0     1   14      0
6    21     1    0     0    3    0  1865     0     3    0     15
7     1    19    0    77    1    0     1  7113    48    0      5
8     0     0    0    20    3    0     0     6  3265    0      2
9     0     0   18     2    0   13     0     0     0  460      0
10    1     1    0     2   28    0     1     2    16    0  12745
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70712936, 'precision': 0.6526382, 'recall': 0.6034271, 'specificity': 0.97052544, 'f1': 0.5933656, 'auroc': 0.87739676}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1057     1    1   2   10    1     3    14    15   28    38
1      3  1281    0  20    2    0     0   169    11    0    13
2      5     2  124   4  231   11     2    44   359   53   180
3      0     0    0   0    0    0     0     0     0    0     0
4      0     1    1   0  432    0     3     2    36    0  1158
5     10     0    3  52    1  262     0     1    11  227    25
6     15     1    0   1   11    0  2552     5    31    0   451
7      5     2    0  78    0    1     2  1067     3    0     6
8      1     0    0  56    1    2     0    12  1293    5     0
9     14     6   93  50   25  120     0    48   290  438    53
10     0     1    0   0   43    0     0     0     1    0  1601
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_27.png
early stop counter: 2
val acc:0.9849404692649841, best validation acc: 0.9851277470588684, corresponding to test acc:                         0.694325864315033 / 0.7441405057907104
after epoch: 27,now: 2024-07-09 06:01:03.516871,epoch time: 0:35:28.704954,used: 16:44:04.770171,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97776645, 'precision': 0.9561193, 'recall': 0.93516296, 'specificity': 0.99755585, 'f1': 0.9442395, 'auroc': 0.99968576}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   423     0    3     4    5    1    38     1     0    0      8
1     0  1304    0     1    0    0     0    26     0    0      1
2     0     0  283     0   11    0     0    15     0    3      0
3     0     1    0  8367    0    0     0    66     2    0      0
4     3     0    8     0  481    0     2     5     6    1     33
5     0     0    1    16    0  494     1     0     1    7      0
6     1     0    0     1    0    0  1904     1     0    0      1
7     0     5    0    52    0    0     2  7200     1    0      3
8     0     1    1   101    0    1     1   196  2984    0     11
9     0     0   37     7    0   41     0    12     0  395      0
10    1     0    2     3   34    0    12    23     9    1  12710
---- Validation: 
scalar performance:
{'acc': 0.9768089, 'precision': 0.9578955, 'recall': 0.93695885, 'specificity': 0.9974353, 'f1': 0.945814, 'auroc': 0.99965465}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   409     0    6     3    3    0    39     4     0    1     18
1     0  1298    0     2    0    0     0    31     0    0      1
2     0     0  289     0    8    1     0    11     0    3      0
3     0     3    0  8350    0    1     0    81     5    0      0
4     2     0   12     1  483    0     3     6     4    1     27
5     0     0    1    10    1  503     0     0     1    5      0
6     0     0    0     0    1    0  1905     1     0    0      1
7     0     2    0    48    0    0     1  7210     1    0      3
8     0     1    0   114    2    1     0   206  2955    0     17
9     0     0   34     7    0   35     0     9     0  408      0
10    1     0    2     4   28    1    15    26    11    0  12708
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65129787, 'precision': 0.6261331, 'recall': 0.5308188, 'specificity': 0.96469355, 'f1': 0.522352, 'auroc': 0.87517965}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   482     1   10   29    7    6   422    93    21   46    53
1     0  1036    0   21    1    0     9   399     5    0    28
2     0     3  133   45  199   22    55   171   171   36   180
3     0     0    0    0    0    0     0     0     0    0     0
4     0     1    0    0  253    0    13     4    18    0  1344
5     1     0    6  171    2  283    16     3     5  100     5
6     0     0    0    3    0    0  2985     2     4    0    73
7     0     0    0   67    0    0     6  1085     1    0     5
8     0     0    0  117    0    2    14    57  1177    2     1
9     1     9   82  218   11  155    44   220   111  251    35
10    0     0    0    0   19    0     2     1     0    0  1624
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_28.png
early stop counter: 3
val acc:0.9768089056015015, best validation acc: 0.9851277470588684, corresponding to test acc:                         0.694325864315033 / 0.7441405057907104
after epoch: 28,now: 2024-07-09 06:36:29.798763,epoch time: 0:35:26.281892,used: 17:19:31.052063,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9835456, 'precision': 0.96010375, 'recall': 0.9542593, 'specificity': 0.998262, 'f1': 0.9565747, 'auroc': 0.99978155}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     1    2    0     1     0     0    0     19
1     0  1313    0     1    0    0     2    12     3    0      1
2     0     0  256     1   20    0     0     0     3   30      1
3     1     1    0  8293    0    9     2    53    75    2      0
4     3     0    1     0  493    0     0     1     8    0     33
5     0     0    0     2    0  494     0     0     2   23      0
6     4     0    0     1    0    1  1889     0     0    0     12
7     6    10    0    39    0    0     6  7094   102    3      5
8     0     0    0     8    2    0     1     9  3269    1      6
9     0     0   10     0    1   19     0     1     0  461      1
10    2     0    0     3   25    0     7     3    13    1  12739
---- Validation: 
scalar performance:
{'acc': 0.9819714, 'precision': 0.9558558, 'recall': 0.9505756, 'specificity': 0.99809635, 'f1': 0.95202786, 'auroc': 0.99976784}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     0    3    0     0     0     1    0     21
1     0  1312    0     1    0    0     1    16     1    0      1
2     0     0  241     0   32    0     0     1     3   34      1
3     0     0    0  8280    0   11     4    56    85    4      0
4     3     0    2     0  499    1     0     1     2    0     31
5     0     0    0     1    0  496     0     0     1   23      0
6     7     0    0     0    0    0  1885     0     1    0     15
7     3     9    0    44    1    0     2  7059   134    3     10
8     0     0    0    12    6    1     0     2  3265    0     10
9     0     0    8     0    1   16     0     0     1  466      1
10    1     0    1     1   33    0     3     1     6    0  12750
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6962149, 'precision': 0.6162779, 'recall': 0.57827175, 'specificity': 0.9692451, 'f1': 0.54309076, 'auroc': 0.8695259}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   993     0   0   5    2    5    25    19    15   10    96
1     0  1220   0  10    0    2     6   210    10    0    41
2     8     0  19  11  162   13    21    39   381   24   337
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   0  130    0     5     2    29    0  1467
5     9     0   2  77    4  318     3     1    25   88    65
6     3     1   0   1    0    0  3021     0     2    0    39
7     1     1   0   8    0    0     7  1133     7    2     5
8     2     0   0  45    0    5    14    15  1285    1     3
9    20     6  23  64   26  152    32    78   366  197   173
10    0     0   0   0    8    0     3     0     0    0  1635
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_29.png
early stop counter: 4
val acc:0.9819713830947876, best validation acc: 0.9851277470588684, corresponding to test acc:                         0.694325864315033 / 0.7441405057907104
after epoch: 29,now: 2024-07-09 07:12:11.973046,epoch time: 0:35:42.174283,used: 17:55:13.226346,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98357236, 'precision': 0.9577632, 'recall': 0.9480295, 'specificity': 0.9982849, 'f1': 0.9509891, 'auroc': 0.99976385}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     4    2    0     4     1     4    0      2
1     0  1301    0     1    0    0     1    25     3    0      1
2     0     0  274     0   11    6     0     6     5    9      1
3     0     0    0  8369    0    0     0    54    16    0      0
4     5     0    4     0  499    0     0     2    13    0     16
5     0     0    0    10    0  508     0     0     3    0      0
6     1     0    0     3    0    0  1897     2     1    1      3
7     2     4    0    42    0    0     1  7166    45    0      3
8     0     0    0    41    1    0     0     8  3245    0      1
9     1     0    8     3    5   90     0     7     3  375      1
10    4     0    0     4   55    0     3     9    53    0  12662
---- Validation: 
scalar performance:
{'acc': 0.98381704, 'precision': 0.95722806, 'recall': 0.9491903, 'specificity': 0.9983099, 'f1': 0.9513346, 'auroc': 0.99975085}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     1    1    0     1     0     1    0      4
1     0  1311    0     3    0    0     0    16     2    0      0
2     1     0  269     0   12    2     0     4     6   16      2
3     0     1    0  8364    0    0     2    57    16    0      0
4     4     0    2     0  504    0     3     3     6    0     17
5     0     0    0    12    0  505     0     1     2    1      0
6     1     0    0     0    0    0  1899     2     1    0      5
7     0     2    0    44    1    0     3  7173    39    0      3
8     0     0    1    34    1    0     0     9  3248    0      3
9     0     0    7     7    2   98     0     1     4  374      0
10    3     0    0     4   57    0     6    10    58    0  12658
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6856503, 'precision': 0.6356169, 'recall': 0.5744059, 'specificity': 0.9684123, 'f1': 0.5319167, 'auroc': 0.87588453}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   919     0   0   19    4   29    82    53    40    1    23
1     5  1008   0   22    0    0     4   390    36    0    34
2     7     1  21   23  163   52    23    64   467   20   174
3     0     0   0    0    0    0     0     0     0    0     0
4     2     0   0    0  261    0     5     1    59    0  1305
5     7     0   0   81    3  407     2     3    31   50     8
6     1     0   0    3    0    0  3016     3     3    0    41
7     0     0   0   32    0    0     2  1121     5    0     4
8     0     0   0   51    0    5     6    12  1295    1     0
9    23     1  11  103   16  265    13    86   434  134    51
10    0     0   0    0   27    0     1     0     0    0  1618
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_30.png
early stop counter: 5
val acc:0.9838170409202576, best validation acc: 0.9851277470588684, corresponding to test acc:                         0.694325864315033 / 0.7441405057907104
after epoch: 30,now: 2024-07-09 07:47:34.341439,epoch time: 0:35:22.368393,used: 18:30:35.594739,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 18:30:35.594739 at 2024-07-09 07:47:34.341439
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69432586, 'precision': 0.63692254, 'recall': 0.58598185, 'specificity': 0.9689472, 'f1': 0.56765425, 'auroc': 0.8719781}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   904     1   1    5    8    5   153   21     3   33    36
1     2  1185   0   32    0    2    23  217     5    4    29
2     7     2  90    6  243   24    28   68   182   53   312
3     0     0   0    0    0    0     0    0     0    0     0
4     1     0   1    0  117    0     9    0     9    0  1496
5     8     0   2   48    3  371    15    1    12  113    19
6     3     0   0    1    0    0  2951    1     0    0   111
7     0     1   0  129    0    1    38  993     0    0     2
8     1     0   0   36    5    9    25   28  1253    1    12
9    12     6  39   63   23  198    36   90   179  420    71
10    0     0   0    0    3    0     3    0     0    0  1640
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7441405, 'precision': 0.67738503, 'recall': 0.63573, 'specificity': 0.9742162, 'f1': 0.63114893, 'auroc': 0.88430214}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1020     0    0    9    7    3    54    25     6    4    42
1      1  1354    1   14    1    0     2   102     5    0    19
2      8     1  183   19  315   16     5    67   208   46   147
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    2    0  494    0     1     1    21    0  1114
5      6     0   10   71    2  368     0     0    14  118     3
6      3     0    0    1    1    0  2876     2     3    0   181
7      1     0    1   33    1    1    13  1108     2    0     4
8      3     0    0   58    5    2    21    11  1258    4     8
9     18     3  149  109   16  114    10    68   227  389    34
10     0     0    0    0   60    0     0     0     0    0  1586
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_13_16_58_seed_1_21716734_instance_wise_predictions.txt
accuracy from prediction file 0.694325893794165
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457095 KiB |   2004 MiB |   1962 TiB |   1962 TiB |
|       from large pool | 412478 KiB |   1971 MiB |   1934 TiB |   1934 TiB |
|       from small pool |  44617 KiB |     62 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457095 KiB |   2004 MiB |   1962 TiB |   1962 TiB |
|       from large pool | 412478 KiB |   1971 MiB |   1934 TiB |   1934 TiB |
|       from small pool |  44617 KiB |     62 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 449784 KiB |   1999 MiB |   1959 TiB |   1959 TiB |
|       from large pool | 407075 KiB |   1966 MiB |   1931 TiB |   1931 TiB |
|       from small pool |  42709 KiB |     60 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2278 MiB |   2278 MiB |   3788 MiB |   1510 MiB |
|       from large pool |   2214 MiB |   2214 MiB |   3706 MiB |   1492 MiB |
|       from small pool |     64 MiB |     64 MiB |     82 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 368248 KiB | 432633 KiB |   1598 TiB |   1598 TiB |
|       from large pool | 357569 KiB | 408037 KiB |   1569 TiB |   1569 TiB |
|       from small pool |  10679 KiB |  29150 KiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    6392    |    8370    |  357022 K  |  357015 K  |
|       from large pool |     187    |     311    |  186315 K  |  186315 K  |
|       from small pool |    6205    |    8141    |  170706 K  |  170700 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    6392    |    8370    |  357022 K  |  357015 K  |
|       from large pool |     187    |     311    |  186315 K  |  186315 K  |
|       from small pool |    6205    |    8141    |  170706 K  |  170700 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     125    |     193    |      68    |
|       from large pool |      93    |      93    |     152    |      59    |
|       from small pool |      32    |      32    |      41    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      68    |    1619    |  191048 K  |  191048 K  |
|       from large pool |      40    |      93    |  127027 K  |  127027 K  |
|       from small pool |      28    |    1579    |   64021 K  |   64021 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |   1962 TiB |   1962 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1934 TiB |   1934 TiB |
|       from small pool |      0 KiB |     62 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |   1962 TiB |   1962 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1934 TiB |   1934 TiB |
|       from small pool |      0 KiB |     62 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1999 MiB |   1959 TiB |   1959 TiB |
|       from large pool |  16640 KiB |   1966 MiB |   1931 TiB |   1931 TiB |
|       from small pool |      0 KiB |     60 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    806 MiB |   2278 MiB |   3788 MiB |   2982 MiB |
|       from large pool |    752 MiB |   2214 MiB |   3706 MiB |   2954 MiB |
|       from small pool |     54 MiB |     64 MiB |     82 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 472922 KiB |   1598 TiB |   1598 TiB |
|       from large pool |  24320 KiB | 444488 KiB |   1569 TiB |   1569 TiB |
|       from small pool |      0 KiB |  40073 KiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8370    |  357022 K  |  357022 K  |
|       from large pool |       2    |     311    |  186315 K  |  186315 K  |
|       from small pool |       0    |    8141    |  170706 K  |  170706 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8370    |  357022 K  |  357022 K  |
|       from large pool |       2    |     311    |  186315 K  |  186315 K  |
|       from small pool |       0    |    8141    |  170706 K  |  170706 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     125    |     193    |     132    |
|       from large pool |      34    |      93    |     152    |     118    |
|       from small pool |      27    |      32    |      41    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1619    |  191050 K  |  191050 K  |
|       from large pool |       3    |      93    |  127027 K  |  127027 K  |
|       from small pool |       0    |    1579    |   64023 K  |   64023 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB |   1962 TiB |   1962 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1934 TiB |   1934 TiB |
|       from small pool |      0 KiB |     62 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB |   1962 TiB |   1962 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1934 TiB |   1934 TiB |
|       from small pool |      0 KiB |     62 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1999 MiB |   1959 TiB |   1959 TiB |
|       from large pool |  16640 KiB |   1966 MiB |   1931 TiB |   1931 TiB |
|       from small pool |      0 KiB |     60 MiB |     28 TiB |     28 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    806 MiB |   2278 MiB |   3788 MiB |   2982 MiB |
|       from large pool |    752 MiB |   2214 MiB |   3706 MiB |   2954 MiB |
|       from small pool |     54 MiB |     64 MiB |     82 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 472922 KiB |   1598 TiB |   1598 TiB |
|       from large pool |  24320 KiB | 444488 KiB |   1569 TiB |   1569 TiB |
|       from small pool |      0 KiB |  40073 KiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8370    |  357022 K  |  357022 K  |
|       from large pool |       2    |     311    |  186315 K  |  186315 K  |
|       from small pool |       0    |    8141    |  170706 K  |  170706 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8370    |  357022 K  |  357022 K  |
|       from large pool |       2    |     311    |  186315 K  |  186315 K  |
|       from small pool |       0    |    8141    |  170706 K  |  170706 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     125    |     193    |     132    |
|       from large pool |      34    |      93    |     152    |     118    |
|       from small pool |      27    |      32    |      41    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1619    |  191050 K  |  191050 K  |
|       from large pool |       3    |      93    |  127027 K  |  127027 K  |
|       from small pool |       0    |    1579    |   64023 K  |   64023 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_04_05_seed_2_21716734

 Experiment start at: 2024-07-09 08:04:05.166865
before training, model accuracy: 0.08185825496912003
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9266642, 'precision': 0.8577198, 'recall': 0.7833341, 'specificity': 0.99164844, 'f1': 0.802457, 'auroc': 0.99436986}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   392     0    2    11    0    0     8     7     1    5     57
1     0  1241    0    13    0    0     0    67     2    0      9
2     0     0  241     4   17    0     1    10     2   29      8
3     0     0    1  7949    0    3     1   426    57    1      2
4     2     0   66     5  203    1     1     5    14    9    233
5     3     0    5   121    0  217     0     0     4  168      3
6    19     0    2     5    2    0  1841     7     3    1     27
7     4    17    9   197    2    0     2  6970    30    2     30
8     7     2    9   426   17    0     2   147  2545    2    138
9     6     0   89    33    0   20     2     7     2  333      1
10   15     0   12     9   12    0    12    18     9    1  12703
---- Validation: 
scalar performance:
{'acc': 0.9273505, 'precision': 0.86002207, 'recall': 0.7886665, 'specificity': 0.99171513, 'f1': 0.8075692, 'auroc': 0.9946996}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   385     0    2     9    0    0     8     9     1    5     64
1     0  1240    1    12    0    0     0    68     4    0      7
2     1     0  250     3   14    0     1     9     1   25      8
3     2     2    1  7951    0    2     1   430    49    0      2
4     3     0   77     3  209    1     1     6    13    5    221
5     1     0    9   107    0  236     0     0     2  163      3
6    26     0    1     4    2    0  1836     5     2    1     31
7     1    16    2   206    0    0     1  6980    31    0     28
8     4     1    8   420   14    0     1   148  2544    2    154
9     2     0   93    19    0   28     2     6     7  333      3
10   16     0    6     7   15    0    11    21    13    2  12705
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.648989, 'precision': 0.6671401, 'recall': 0.5550057, 'specificity': 0.964885, 'f1': 0.54410344, 'auroc': 0.88211626}
confusion matrix:
      0    1    2    3   4   5     6     7     8    9     10
0   1033    0    4   29   0   0    19    20     1   47    17
1      0  991    0   35   0   0     0   418     1    0    54
2      5    0  412   26  61   1     0   141    72   52   245
3      0    0    0    0   0   0     0     0     0    0     0
4      0    0    6    0  75   0     0     3     9    1  1539
5      2    0    2  144   0  79     0     0     6  358     1
6     27    0    2    8  11   0  2296    12     3    0   708
7      0    0    0    3   0   0     0  1158     0    0     3
8      0    0    1  218   3   0     1    52  1087    1     7
9      8    0  268  133   0   8     0   162    31  499    28
10     0    0    0    0   0   0     0     0     0    0  1646
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-09 08:40:58.013915,epoch time: 0:36:52.847050,used: 0:36:52.847050,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_04_05_seed_2_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93760705, 'precision': 0.83553106, 'recall': 0.83257115, 'specificity': 0.9931456, 'f1': 0.8274313, 'auroc': 0.9956185}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   353     0    5     6    6    0     8     4     1    4     96
1     0  1263    0    11    0    0     0    45     2    0     11
2     0     0  257     1   22    1     1     4     1   23      2
3     0     2    4  7976    2   21     2   294   122   10      4
4     1     0   73     0  316    2     0     3     4    2    138
5     0     0    4    19    0  419     0     0     2   74      2
6     9     2    2     9    6    3  1789     2     4    2     80
7     2    19   28   138   16    0     2  6980    36   10     33
8     0     8   63   117   97   16     0   108  2751   25    111
9     1     0  108     7    3   73     0     1     1  294      5
10    1     0   11     7   99    1     6     9    12    0  12646
---- Validation: 
scalar performance:
{'acc': 0.9376488, 'precision': 0.8311713, 'recall': 0.82871324, 'specificity': 0.9931965, 'f1': 0.82380325, 'auroc': 0.995635}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   348     0    3     7    7    1     7     5     0    5    100
1     0  1264    1     9    0    0     0    48     2    0      8
2     1     0  253     0   20    1     1     2     0   27      7
3     1     2    4  7963    5   22     2   311   113   13      4
4     1     0   71     0  318    2     0     3     7    5    132
5     1     0    5    26    1  405     0     0     3   80      0
6    13     4    3     7    5    2  1804     2     3    1     64
7     0    20   25   125   14    0     2  6983    54    4     38
8     0     7   55   110  104   16     1   113  2780   24     86
9     1     0  114     2    5   78     0     1     1  289      2
10    0     0    8     6   96    1     4    13    20    1  12647
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.684251, 'precision': 0.6838245, 'recall': 0.57757765, 'specificity': 0.9684738, 'f1': 0.59069383, 'auroc': 0.88180995}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   722     0   14   71    9    4    21    54     3  139   133
1     0  1107    0   29    0    0     0   283     2    0    78
2     0     0  335   29  177    5     0   120    38   99   212
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    3    0  303    0     1     1     5    2  1318
5     2     0    3  163    1  225     0     0     3  193     2
6     0     0    0    5    3    0  2719     3     1    0   336
7     1     0    0   40    0    0     0  1117     0    0     6
8     0     0   12  136   26    4     2    68  1092   10    20
9     3     3  195  153    3   27     1   163    10  539    40
10    0     0    0    0   25    0     0     0     0    0  1621
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-09 09:16:47.710175,epoch time: 0:35:49.696260,used: 1:12:42.543310,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_04_05_seed_2_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9393461, 'precision': 0.86994183, 'recall': 0.8195046, 'specificity': 0.9933435, 'f1': 0.83949965, 'auroc': 0.99614}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   405     0    0     6    1    1    22    13     1    6     28
1     0  1267    0    13    0    0     0    49     3    0      0
2     1     0  189     3   35    3     1    32     5   43      0
3     0     2    1  8048    0    5     1   320    57    2      0
4     3     1   26     3  277    1     5    11    48   11    153
5     0     0    0    78    0  319     0     0     7  116      1
6    11     4    1     7    0    0  1855    12     4    3     11
7     0    13    2   134    1    0     1  7086    23    0      5
8     0     1    3   249    3    0     1   186  2830    3     20
9     0     0   51    17    0   35     1    12     2  374      1
10   16    33   10     8   44    1    72    68    78    2  12459
---- Validation: 
scalar performance:
{'acc': 0.94048417, 'precision': 0.8693882, 'recall': 0.82007897, 'specificity': 0.9934857, 'f1': 0.839682, 'auroc': 0.9959665}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   399     0    5     9    1    0    21     9     3    8     28
1     0  1265    0    13    0    0     0    51     3    0      0
2     1     0  183     1   44    1     1    20    10   50      1
3     1     1    1  8054    0    4     2   316    59    2      0
4     4     1   32     2  283    1     5    19    40    6    146
5     0     0    3    75    0  323     1     0     5  113      1
6     6     1    1     6    0    0  1866     7     7    2     12
7     0    20    0   108    1    0     1  7112    20    0      3
8     0     2    4   238    3    0     0   184  2842    1     22
9     2     0   46    13    1   34     1     9     8  378      1
10   19    33    5     8   38    2    74    86    74    2  12455
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71699435, 'precision': 0.64853096, 'recall': 0.5964142, 'specificity': 0.97145617, 'f1': 0.5884653, 'auroc': 0.88053566}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   791     0    2  22    0    0   123    91     9   77    55
1     0  1313    0  22    1    0     0   157     4    0     2
2     0     4  239  14  219    3     5    80   134   85   232
3     0     0    0   0    0    0     0     0     0    0     0
4     0     1    2   0  109    0     3     2    17    0  1499
5     1     0    0  94    0  222     1     1     6  266     1
6     0     0    0   2    0    0  3031     3     1    0    30
7     0     0    0   6    0    0     0  1157     0    0     1
8     0     3    0  86    0    2     5    44  1228    0     2
9     1     8  256  77    7   38    10   134    50  521    35
10    0     0    0   0    3    0     6     0     0    0  1637
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-09 09:53:09.758607,epoch time: 0:36:22.048432,used: 1:49:04.591742,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_04_05_seed_2_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.936189, 'precision': 0.870064, 'recall': 0.78630537, 'specificity': 0.99310666, 'f1': 0.7992238, 'auroc': 0.9962455}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   401     0   0     3    2    0     6    11     3   11     46
1     0  1080   5     5    0    0     1   205    20    5     11
2     0     0  56     0   49    1     0     9     8  180      9
3     0     0   0  7869    1   11     7   250   283   11      7
4     3     0  10     0  317    0     3     7    40   19    140
5     0     0   0    32    0  283     0     0    11  194      1
6    13     0   0     2    1    0  1846     7     7    4     28
7     2     3   0   130    3    0     2  7002    85    9     26
8     0     2   0    53   10    1     0   108  3064    9     48
9     1     0   1     5    1   14     5     1    11  452      2
10    3     0   0     8   46    0    12    33    65    4  12621
---- Validation: 
scalar performance:
{'acc': 0.93558913, 'precision': 0.86808074, 'recall': 0.7874547, 'specificity': 0.99304533, 'f1': 0.7991302, 'auroc': 0.99645746}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   399     0   0     2    0    0    15     6     5   13     43
1     0  1088   2     7    0    0     1   206    19    2      7
2     0     0  53     1   42    1     1     9     7  188     10
3     1     0   1  7854    1   10     3   270   280    9     11
4     2     0  10     0  318    0     1     4    35   24    145
5     0     0   0    28    0  293     1     0    11  187      1
6    11     0   0     5    0    1  1836    12     7    4     32
7     1     2   0   130    1    0     1  7009    96    4     21
8     1     0   1    51   11    1     1   106  3079    5     40
9     2     0   0     5    0   13     3     2    11  454      3
10    6     0   2     9   68    1     6    35    73    2  12594
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6584342, 'precision': 0.68287814, 'recall': 0.5369804, 'specificity': 0.9657449, 'f1': 0.5052868, 'auroc': 0.884221}
confusion matrix:
     0    1   2   3    4    5     6     7     8    9     10
0   686    0   0  34    0    1    61    27    11  301    49
1     4  421   1  22    1    0     2   942    35    1    70
2     0    0  57   9  100    2     3   105   240  258   241
3     0    0   0   0    0    0     0     0     0    0     0
4     0    0   2   0  198    0     5     5    23    1  1399
5     0    0   0  82    0  157     0     1    26  326     0
6     0    0   0   3    0    0  3049     2     1    1    11
7     2    0   0  21    0    0     1  1137     1    1     1
8     0    0   0  66    1    1     2    32  1258    6     4
9     1    0   8  59    1   16     0   135    84  811    22
10    0    0   0   0    7    0     1     1     0    0  1637
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_4.png
early stop counter: 1
val acc:0.9355891346931458, best validation acc: 0.9404841661453247, corresponding to test acc:                         0.7169943451881409 / 0.7169943451881409
after epoch: 4,now: 2024-07-09 10:29:56.308453,epoch time: 0:36:46.549846,used: 2:25:51.141588,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_04_05_seed_2_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9438945, 'precision': 0.87894636, 'recall': 0.86507565, 'specificity': 0.9939066, 'f1': 0.8662684, 'auroc': 0.99746734}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   434     0    1     5    3    2     0     0     7    2     29
1     0  1260    0    15    0    0     0    39    14    0      4
2     2     0  260     1   12    2     0     1     4   29      1
3     1     0    2  8213    0   31     0    38   151    0      0
4     4     0   55     1  270    3     0     2    41    5    158
5     0     0    2    14    0  449     0     0     6   48      2
6    25     0    2     4    3    0  1850     1     7    2     14
7     2     8   13   517    4    0     1  6452   245    7     14
8     0     0    5   100    7    4     0    17  3148    1     13
9     1     0   40     5    1   93     0     0     5  347      1
10   19     0    5     8   22    1     3     5   130    5  12596
---- Validation: 
scalar performance:
{'acc': 0.94241005, 'precision': 0.8734689, 'recall': 0.8606635, 'specificity': 0.9937686, 'f1': 0.8619058, 'auroc': 0.99750745}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0     6    0    3     2     1     5    6     29
1     0  1254    1    25    0    0     0    35    15    0      2
2     0     0  247     0   13    2     0     0     6   42      2
3     1     0    2  8205    0   33     0    34   164    1      0
4     3     0   48     0  279    2     0     1    40    9    157
5     0     0    1     9    0  451     0     0     5   54      1
6    21     0    0     9    4    0  1851     0     8    1     14
7     1     8   11   528    2    0     1  6439   250    6     19
8     1     0    6    89    7    7     1    20  3155    4      6
9     0     0   49     4    0   95     0     1     4  340      0
10   17     0    8    10   27    2     4     4   140    4  12580
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7267194, 'precision': 0.6704302, 'recall': 0.62280303, 'specificity': 0.9726328, 'f1': 0.61055076, 'auroc': 0.88069355}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1093     0    0   21    1   12     8     5     8   17     5
1      5  1167    0   57    0    1     0   164    41    1    63
2     15     0  161   11  190   10     2    16   236  101   273
3      0     0    0    0    0    0     0     0     0    0     0
4      0     0    0    0  113    0     2     1    16    1  1500
5      7     0    0   68    2  396     0     0     7  110     2
6      1     0    0    1    1    0  2997     0     0    0    67
7      4     0    0  144    0    0     0  1002    10    0     4
8      0     0    1   69    0    8     3     1  1283    2     3
9     16     0   88  113    5  116     2    21   200  535    41
10     0     0    0    0    6    0     0     0     0    0  1640
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-09 11:06:43.778498,epoch time: 0:36:47.470045,used: 3:02:38.611633,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_04_05_seed_2_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9559075, 'precision': 0.8815421, 'recall': 0.875538, 'specificity': 0.99532807, 'f1': 0.8753487, 'auroc': 0.99788713}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     2    0    0     3     2     0    1     11
1     0  1303    0     7    0    0     0    20     2    0      0
2     2     0  222     0   14    2     0     4     8   58      2
3     5    11    2  8105    0    8     6   205    96    2      0
4    10     2   38     0  312    1     0     4    41    8    123
5     3     1    0    31    0  449     0     0     5   31      1
6    21     1    0     1    0    0  1872     0     4    2      6
7     2    52    4    92    1    0     5  7036    66    0      3
8     1     5    1    96    3    2     3    76  3100    3      5
9     8     0   26     5    1   96     1     3     3  350      0
10   62    15    4     7   39    0    22    20   107    2  12517
---- Validation: 
scalar performance:
{'acc': 0.95522267, 'precision': 0.88036823, 'recall': 0.87403387, 'specificity': 0.99526423, 'f1': 0.8732736, 'auroc': 0.99779445}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     1    0    0     2     3     1    0      9
1     0  1303    0     5    0    0     0    21     3    0      0
2     4     0  224     1   15    2     1     2     9   53      1
3     8     4    2  8117    0    9     7   188   105    0      0
4     9     1   41     1  311    1     1     3    38    6    127
5     8     1    0    28    0  452     0     0     4   27      1
6    11     0    0     1    0    0  1881     1     4    2      8
7     6    62    2    88    1    0     3  7022    73    2      6
8     1    10    2    92    4    0     4    85  3090    4      4
9    15     0   28     8    0  102     0     2     4  334      0
10   59    15    9     6   29    1    20    18   128    1  12510
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7370741, 'precision': 0.68768394, 'recall': 0.62604356, 'specificity': 0.97390133, 'f1': 0.6129238, 'auroc': 0.8878517}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1092     1    1    9    0    2    36    25     2    0     2
1      0  1375    0   24    0    0     1    97     1    0     1
2     33    10  223   55  132   44    42   114   228   64    70
3      0     0    0    0    0    0     0     0     0    0     0
4      5    10    9    0  306    0    36     2    27    2  1236
5      9     0    1  158    0  397     1     1     5   19     1
6      2     0    0    1    0    0  3062     1     0    0     1
7      0     1    0   41    0    0     0  1121     0    0     1
8      0     7    0  217    1    3     6    23  1113    0     0
9     40    20   92  273    3  209     7   151   104  231     7
10     0     4    0    0   17    0     9     1     0    0  1615
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-09 11:42:41.829647,epoch time: 0:35:58.051149,used: 3:38:36.662782,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_04_05_seed_2_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9496736, 'precision': 0.88367, 'recall': 0.81819403, 'specificity': 0.9945085, 'f1': 0.83419675, 'auroc': 0.997812}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   431     0    0     1    0    3     3     2     1    2     40
1     0  1301    0     5    0    0     0    19     6    0      1
2     0     0  136     0   47   14     0     4    25   76     10
3     1     3    0  8243    0   11     1    87    91    0      0
4     2     0    3     1  301    6     0     1    24    2    198
5     0     0    0    26    0  483     0     0     9    2      1
6     5     0    0     3    1    3  1873     0     5    0     18
7     0    46    1   217    1    0     3  6737   237    2     19
8     0     0    1   145    7    1     0    20  3081    0     40
9     0     0   10     4    1  272     0     0     9  194      3
10    9     0    0     8   11    4     7     5    35    0  12715
---- Validation: 
scalar performance:
{'acc': 0.95008695, 'precision': 0.88957614, 'recall': 0.8183932, 'specificity': 0.9945663, 'f1': 0.83540446, 'auroc': 0.997884}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   432     0    0     2    0    2     3     0     1    1     42
1     0  1299    0     7    0    0     0    21     5    0      0
2     0     0  130     0   48   19     0     4    20   80     11
3     1     5    0  8230    0    6     2    86   110    0      0
4     1     0    3     1  289    5     0     0    30    3    207
5     1     0    0    28    0  484     0     0     4    3      1
6     5     0    0     1    0    3  1881     0     4    0     14
7     1    68    0   217    1    0     3  6720   242    2     11
8     0     0    0   137    4    0     2    16  3111    1     25
9     0     0    2    10    2  256     0     0    11  210      2
10    7     0    0     7   11    3     4     8    23    0  12733
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67669487, 'precision': 0.6101223, 'recall': 0.568378, 'specificity': 0.96785146, 'f1': 0.5150168, 'auroc': 0.87821347}
confusion matrix:
     0     1   2    3   4    5     6     7     8    9     10
0   686     0   1   27   0  245    48    32    36   35    60
1     0  1329   0   28   0    0     0   106    10    0    26
2     0     2  16   37  78   90     1    40   393   54   304
3     0     0   0    0   0    0     0     0     0    0     0
4     0     0   0    0  32    1     2     1    21    0  1576
5     0     0   0  116   0  464     0     1     9    2     0
6     1     0   0    3   0    0  3013     1     1    0    48
7     0     0   0   27   0    0     0  1132     2    0     3
8     0     0   0  117   0    2     1     4  1243    0     3
9     0     5   9  263   3  378     0    58   268  112    41
10    0     0   0    0   1    0     0     0     0    0  1645
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_7.png
early stop counter: 1
val acc:0.9500869512557983, best validation acc: 0.9552226662635803, corresponding to test acc:                         0.737074077129364 / 0.737074077129364
after epoch: 7,now: 2024-07-09 12:18:36.184922,epoch time: 0:35:54.355275,used: 4:14:31.018057,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_04_05_seed_2_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95852953, 'precision': 0.90244234, 'recall': 0.87005174, 'specificity': 0.99550503, 'f1': 0.88174236, 'auroc': 0.997878}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   435     0    0     4    1    0     8     3     2    1     28
1     0  1270    0     3    0    0     0    51     4    0      3
2     2     0  163     2   33    0     1     7    12   91      1
3     0     2    0  8112    0    5     0   131   188    0      1
4     3     1   14     1  376    1     0     2    17    8    116
5     0     0    0    24    0  420     0     0     4   72      1
6     6     0    0     3    2    0  1852     4     7    1     33
7     0    10    0   140    1    0     2  7002    88    1     19
8     1     1    1    57    6    3     0    52  3144    3     26
9     1     0   15     8    0   41     0     4     5  419      0
10    6     0    1     8   87    0     4    12    40    3  12633
---- Validation: 
scalar performance:
{'acc': 0.95800453, 'precision': 0.90648925, 'recall': 0.8708018, 'specificity': 0.9954427, 'f1': 0.88427114, 'auroc': 0.99796265}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     0    0     8    3    0     6     1     3    4     28
1     0  1266    0     6    0    0     0    50     4    0      6
2     0     0  174     2   36    1     1    10    11   72      5
3     0     1    0  8092    0    8     0   135   204    0      0
4     4     0   11     1  375    1     0     5    25    7    110
5     1     0    0    23    0  417     0     0     9   70      1
6     8     0    0     5    3    0  1857     2     8    1     24
7     0     8    2   159    2    0     2  7001    78    1     12
8     0     0    2    61    8    0     0    44  3148    3     30
9     2     0    6     9    2   43     0     3    10  417      1
10   11     0    1     8   76    0     2    20    37    3  12638
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72245157, 'precision': 0.6832577, 'recall': 0.6036324, 'specificity': 0.9720449, 'f1': 0.5941247, 'auroc': 0.8829919}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1012     0   0  39    4    0    48    18     5   17    27
1      0  1156   0  20    0    0     0   262     5    0    56
2      2     1  88  15  206    2     1    74   192   99   335
3      0     0   0   0    0    0     0     0     0    0     0
4      0     0   0   0  355    0     2     2    12    1  1261
5      2     0   0  85    3  204     1     0    27  267     3
6      0     0   0   2    0    0  2890     3     1    0   171
7      0     0   0  12    0    0     0  1148     2    0     2
8      0     0   0  48    0    0     2    23  1287    2     8
9      5     1  50  91   14   38     1   151   156  585    45
10     0     0   0   0   44    0     1     0     0    0  1601
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_8.png
better model found
persisted
after epoch: 8,now: 2024-07-09 12:54:11.421244,epoch time: 0:35:35.236322,used: 4:50:06.254379,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_04_05_seed_2_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9560146, 'precision': 0.8942261, 'recall': 0.8678242, 'specificity': 0.9950846, 'f1': 0.8772717, 'auroc': 0.9983343}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     0    1     4    2    1     3     5     4    3     39
1     0  1276    0     6    0    0     0    48     1    0      1
2     0     1  243     2    5    4     0     5     2   48      2
3     0     0    0  8366    0   12     0    54     6    0      0
4     2     0   82     0  314    1     0     6     8    4    122
5     0     0    1    18    1  480     0     0     2   18      1
6     8     0    1     3    3    0  1855     3     5    1     29
7     2    10    0   259    1    0     1  6970    15    2      3
8     0     3    2   344   14    7     0    89  2809    1     25
9     1     0   21    11    0  126     0     5     0  329      0
10    3     0    7     9   60    2     2    26    14    1  12669
---- Validation: 
scalar performance:
{'acc': 0.95637286, 'precision': 0.8947317, 'recall': 0.87043107, 'specificity': 0.99512815, 'f1': 0.879608, 'auroc': 0.9983327}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   414     1    1     7    2    1     1     5     1    4     46
1     0  1284    0     6    0    0     0    40     2    0      0
2     0     0  234     1    4    1     0     6     3   63      0
3     0     1    0  8366    0   10     0    49    13    1      0
4     3     0   69     0  330    3     0     6    11    7    110
5     0     0    2    13    0  490     0     0     0   15      1
6     9     0    2     3    1    0  1851     4     4    1     33
7     0    12    1   241    1    0     1  6986    16    2      5
8     1     4    3   346   18   10     1    94  2789    0     30
9     0     0   20    12    0  113     0     7     0  341      0
10    1     0   10     9   61    2     1    22    19    2  12669
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66829914, 'precision': 0.6588521, 'recall': 0.56569004, 'specificity': 0.96711457, 'f1': 0.5543606, 'auroc': 0.87639934}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   788     4    1   50    4   23    28   109    11   70    82
1     0  1116    0   27    0    0     0   332     2    0    22
2     1     3  160   49  143   26     1   211   154   81   186
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    4    0  132    0     1     7    21    0  1468
5     0     0    0  148    1  378     0     3     4   55     3
6     3     0    0    7    0    0  2859     8     2    0   188
7     0     0    0   32    0    0     0  1130     0    0     2
8     0     1    0  249    1    6     2    58  1052    0     1
9     1     3   29  302    5  207     0   237    38  294    21
10    0     0    0    0    2    0     0     1     0    0  1643
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_9.png
early stop counter: 1
val acc:0.956372857093811, best validation acc: 0.9580045342445374, corresponding to test acc:                         0.7224515676498413 / 0.737074077129364
after epoch: 9,now: 2024-07-09 13:30:31.424893,epoch time: 0:36:20.003649,used: 5:26:26.258028,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_04_05_seed_2_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96305114, 'precision': 0.9142728, 'recall': 0.90362114, 'specificity': 0.99592733, 'f1': 0.90752006, 'auroc': 0.9985671}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    0     2    5    0     4     1     1    2     17
1     0  1283    0     8    0    0     0    37     3    0      1
2     0     0  269     1    6    1     0     3     4   27      1
3     0     0    0  8311    0    8     1    77    41    1      0
4     4     0   57     3  367    0     0     1    14    5     88
5     0     0    0    29    0  437     0     0     3   50      1
6     9     0    1     3    0    0  1874     0     4    3     14
7     0     5    5   229    1    0     3  6977    39    0      5
8     1     0    4   240   10    0     0    69  2954    4     12
9     1     0   26     2    0   41     0     1     5  417      0
10   15     0    6     8   52    1     6    10    39    0  12655
---- Validation: 
scalar performance:
{'acc': 0.9626053, 'precision': 0.9150855, 'recall': 0.90503424, 'specificity': 0.995889, 'f1': 0.90856564, 'auroc': 0.9986493}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    1     3    5    0     4     2     1    2     15
1     0  1284    0     8    0    0     0    35     4    0      1
2     0     0  272     1    8    0     0     2     3   26      0
3     0     0    0  8307    0    6     0    87    39    1      0
4     6     0   55     0  372    2     0     6    14    5     79
5     0     0    0    22    0  437     0     0     3   58      1
6     8     1    0     2    2    0  1874     1     4    2     14
7     0     7    2   239    1    0     2  6953    55    0      6
8     1     0    4   228    5    1     2    82  2961    1     11
9     0     0   32     3    0   38     0     0     2  418      0
10    7     0    7     7   51    2     8    17    37    1  12659
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6847408, 'precision': 0.6247239, 'recall': 0.57402354, 'specificity': 0.9682815, 'f1': 0.5693578, 'auroc': 0.87425774}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   801     0   12   29    9   29   171    8    25   39    47
1     4  1013    1   21    1    0     0  363    47    1    48
2     1     0  180    8  294   15    12   29   263   39   174
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    0    0  157    0     3    0    20    0  1453
5     1     0    8   59    2  383     2    0    18  119     0
6     1     0    0    1    0    0  3055    2     0    0     8
7     0     0    2  256    0    0     2  890    12    0     2
8     0     0    0   76    1    2     5    3  1280    0     3
9     2     0  239   70   29   89    18   28   243  391    28
10    0     0    0    0    9    0     0    0     0    0  1637
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_10.png
better model found
persisted
after epoch: 10,now: 2024-07-09 14:07:10.564934,epoch time: 0:36:39.140041,used: 6:03:05.398069,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_04_05_seed_2_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9636665, 'precision': 0.9152894, 'recall': 0.8991016, 'specificity': 0.99613225, 'f1': 0.90477073, 'auroc': 0.9987136}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     3    1    0     3     2     4    3     10
1     0  1249    0    16    1    0     0    54    10    0      2
2     1     0  207     0   17    0     0     2     8   76      1
3     0     0    0  8283    0    9     0    82    65    0      0
4     4     0   16     1  408    0     0     2    39    5     64
5     0     0    0    27    0  424     0     1     6   61      1
6     9     0    0     2    1    1  1872     1     9    3      9
7     0     4    0   195    1    0     1  6954   105    0      3
8     0     0    1    76    3    1     0    28  3181    1      5
9     0     0    9     2    0   30     0     2     4  446      0
10    8     0    4    10  104    0     5    15   109    0  12537
---- Validation: 
scalar performance:
{'acc': 0.96415675, 'precision': 0.9154978, 'recall': 0.8984663, 'specificity': 0.99617714, 'f1': 0.90435195, 'auroc': 0.99876595}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     4    1    1     0     4     4    1     15
1     0  1253    0    10    0    0     0    56    12    0      1
2     0     0  200     2   24    0     1     4    10   71      0
3     0     1    0  8273    0    8     0    87    68    3      0
4     5     0   16     0  416    0     1     0    31    5     65
5     0     0    0    23    0  434     0     1     4   58      1
6     8     0    0     1    1    1  1876     3     7    2      9
7     0     5    1   199    1    0     1  6962    90    2      4
8     1     0    0    77    3    0     0    27  3181    2      5
9     0     0    8     4    0   36     0     2     4  439      0
10    7     0    1     7  107    1     5    13    95    2  12558
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71573496, 'precision': 0.67080545, 'recall': 0.5963559, 'specificity': 0.9715139, 'f1': 0.5900947, 'auroc': 0.8818779}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   953     0    0   29    1    1    22    72    29   46    17
1     5  1148    2   39    0    0     3   246    25    0    31
2    13     0  159   17  279    3     2    34   240  124   144
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    1    0  248    0     2     1    24    1  1355
5     3     0    1   80    1  173     0     2     2  328     2
6     3     0    0    6    1    0  2911     1     3    0   142
7     1     0    1   71    0    0     0  1086     2    0     3
8     0     0    0  105    1    5     4     4  1243    6     2
9     4     0   74  102   20   32     2    51   149  686    17
10    0     0    0    0   21    0     2     0     0    0  1623
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_11.png
better model found
persisted
after epoch: 11,now: 2024-07-09 14:45:33.697873,epoch time: 0:38:23.132939,used: 6:41:28.531008,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_04_05_seed_2_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9645762, 'precision': 0.92099136, 'recall': 0.8827678, 'specificity': 0.99596775, 'f1': 0.89718544, 'auroc': 0.9988506}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   445     1    1     1    0    1    11     2     0    3     18
1     0  1289    0     5    0    0     0    36     2    0      0
2     0     0  199     0   24    1     0     2     0   81      5
3     0     0    0  8324    0   11     0    75    25    3      1
4     2     0   20     1  324    3     4     1     2   15    167
5     0     0    0     6    1  483     0     0     1   30      0
6     4     0    0     2    0    1  1887     2     1    4      6
7     0     4    1   162    2    0     1  7062    14    2     14
8     1     0    2   126   12    4     4   121  2891   14    118
9     0     0    7     2    0   72     0     1     0  411      0
10    6     0    1     8    9    1    17     8     4    4  12737
---- Validation: 
scalar performance:
{'acc': 0.9636485, 'precision': 0.9159897, 'recall': 0.88160914, 'specificity': 0.9958816, 'f1': 0.8943366, 'auroc': 0.9987604}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    0     0    1    0     9     0     0    8     18
1     0  1279    0     7    1    0     0    40     2    0      3
2     0     0  198     0   23    2     0     1     0   81      7
3     1     0    0  8306    0   17     1    87    24    3      1
4     6     0   21     0  334    2     3     1     3   11    158
5     0     0    0     7    0  481     0     0     1   31      1
6     4     0    0     4    1    0  1889     3     0    1      6
7     0     6    0   177    1    0     3  7058     8    3      9
8     0     0    1   124    9    8     4   105  2911   13    121
9     0     0    8     0    0   84     0     1     0  400      0
10   15     1    2     8   11    0    22     8     2    4  12723
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70300144, 'precision': 0.67440903, 'recall': 0.59756726, 'specificity': 0.970324, 'f1': 0.5866723, 'auroc': 0.8814458}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   770     0    0   79    0   27    91    68     5   71    59
1     0  1151    0   49    1    0     1   246     7    0    44
2     2     0  152   28  121   30     8   106    92  159   317
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    1  115    0    11     3     6    1  1495
5     0     0    0   89    0  414     0     0     1   88     0
6     3     0    0    6    0    0  3043     3     1    0    11
7     0     0    0   81    0    1     0  1077     2    0     3
8     0     0    2  150    6   11     5    25  1138    8    25
9     1     0   38  152    6  189     1   110    54  553    33
10    0     0    0    0    5    0     6     0     0    0  1635
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_12.png
early stop counter: 1
val acc:0.9636484980583191, best validation acc: 0.9641567468643188, corresponding to test acc:                         0.7157349586486816 / 0.737074077129364
after epoch: 12,now: 2024-07-09 15:28:52.337566,epoch time: 0:43:18.639693,used: 7:24:47.170701,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_04_05_seed_2_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9579142, 'precision': 0.9231456, 'recall': 0.9053429, 'specificity': 0.99532986, 'f1': 0.9115134, 'auroc': 0.9990169}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    0    0     0     2     0    2      3
1     0  1241    0     2    0    0     1    83     3    0      2
2     0     0  235     1   10    0     0     7     1   55      3
3     6     0    3  7785    0   19     0   552    65    6      1
4     9     0   16     0  379    1     1     2     6    2    123
5     0     0    0     4    0  479     0     0     2   34      1
6    14     0    0     1    0    1  1863    12     4    0     12
7     0     2    0    19    1    0     1  7228     7    2      3
8     3     0    2    32    5    1     1   201  2996    7     48
9     0     0    9     1    0   53     0     1     1  428      0
10   36     0    1     4   23    1    12    20     4    0  12693
---- Validation: 
scalar performance:
{'acc': 0.9581115, 'precision': 0.92197645, 'recall': 0.90038985, 'specificity': 0.9953315, 'f1': 0.90865165, 'auroc': 0.9990247}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     1    0    0     2     0     0    0      4
1     0  1242    0     2    0    0     0    86     2    0      0
2     0     0  225     0   17    0     2     3     0   57      8
3     2     0    1  7836    0   16     1   538    39    4      3
4     7     0   15     0  374    1     0     2     3    6    131
5     0     0    2     8    0  481     0     0     5   24      1
6    17     0    0     1    0    0  1875     6     2    0      7
7     1     1    1    25    1    0     1  7223     6    3      3
8     3     0    3    50    4    1     2   203  2976    3     51
9     0     0   11     0    0   62     0     1     1  418      0
10   27     0    1     2   30    0    12    23     8    0  12693
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7197929, 'precision': 0.6728046, 'recall': 0.61280274, 'specificity': 0.9717515, 'f1': 0.6005437, 'auroc': 0.88186353}
confusion matrix:
     0    1    2   3    4    5     6     7     8    9     10
0   905    0    2   8    1   18     7   107    12   70    40
1     8  965    0  16    1    0     3   476     5    3    22
2    11    0  202   5  117    9     6    76    50  102   437
3     0    0    0   0    0    0     0     0     0    0     0
4     0    0    0   0  166    0     5     2     2    0  1458
5     1    0    5  40    4  335     0     6    11  186     4
6     6    0    0   1    0    0  3036     3     0    0    21
7     1    0    0   1    0    0     0  1155     1    2     4
8     3    0    5  40    4    3    13    47  1206    9    40
9     8    0  137  25    2   75     2   110    47  685    46
10    0    0    0   0   12    0     1     0     0    0  1633
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_13.png
early stop counter: 2
val acc:0.9581115245819092, best validation acc: 0.9641567468643188, corresponding to test acc:                         0.7157349586486816 / 0.737074077129364
after epoch: 13,now: 2024-07-09 16:09:42.314026,epoch time: 0:40:49.976460,used: 8:05:37.147161,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_04_05_seed_2_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9686697, 'precision': 0.9275063, 'recall': 0.87814283, 'specificity': 0.9965892, 'f1': 0.88885087, 'auroc': 0.99923533}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     0    2    0     6     0     0    3      9
1     0  1300    0     3    0    0     0    28     1    0      0
2     0     0  147     0   20    0     0     6     2  136      1
3     1     3    0  8243    0    7     2   140    36    5      0
4     6     0    9     0  378    0     1     1     3   10    130
5     0     0    0     7    0  359     0     0     2  152      1
6     3     1    0     0    1    0  1888     1     1    2     11
7     1    13    0    78    1    0     6  7145    12    3      4
8     1     1    1    88    7    4     5    71  3070   10     38
9     0     0    0     2    0    4     0     0     1  486      0
10   10     0    2     7   16    2     5    10    12    3  12727
---- Validation: 
scalar performance:
{'acc': 0.9700147, 'precision': 0.930815, 'recall': 0.8817931, 'specificity': 0.9967437, 'f1': 0.89144766, 'auroc': 0.9992031}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    1    0     2     0     0    3      8
1     0  1300    0     3    0    0     0    27     2    0      0
2     0     0  141     1   21    0     0     2     2  143      2
3     0     3    0  8259    0    5     1   127    38    7      0
4     5     1    8     0  388    0     2     1     5   10    119
5     1     0    0     9    0  373     0     0     1  136      1
6    10     0    0     0    1    0  1885     0     0    1     11
7     0    10    0    63    1    0     4  7165    17    0      5
8     1     1    1    85    6    3     3    74  3063   19     40
9     0     0    0     1    0    4     0     0     1  487      0
10   13     0    0     6   12    0     4     9    11    7  12734
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7057301, 'precision': 0.6827836, 'recall': 0.5859009, 'specificity': 0.97035724, 'f1': 0.57661587, 'auroc': 0.87897813}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   833     0    0   15    3    1   130    57     2  110    19
1     2  1251    1   23    1    0     2   195     4    0    20
2     8     0  131   15  280    0    16    79    85  211   190
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  144    0     1     2     5    1  1480
5     1     0    0   90    0  156     1     2     0  340     2
6     8     0    0    1    1    0  2897     3     0    0   157
7     0     0    0   82    0    1     6  1063     1    7     4
8     0     1    0  127    5    7     9    43  1139   26    13
9     2     0   21   91    8   25     2   101    37  831    19
10    0     0    0    0    4    0     0     0     0    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_14.png
better model found
persisted
after epoch: 14,now: 2024-07-09 16:46:58.200697,epoch time: 0:37:15.886671,used: 8:42:53.033832,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_04_05_seed_2_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9676263, 'precision': 0.93164045, 'recall': 0.891586, 'specificity': 0.9962418, 'f1': 0.907951, 'auroc': 0.999009}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   427     0    0     1    1    0     2     1     0    2     49
1     0  1293    0     6    0    0     0    30     0    0      1
2     1     0  269     0   21    0     0     1     0   10      9
3     1     0    0  8355    0    0     1    51    27    2      1
4     1     0   16     2  321    0     1     1     9    1    187
5     0     0    1    16    0  421     0     0     0   82      1
6     8     0    0     3    3    0  1856     0     2    0     36
7     1     5    2   146    2    0     2  6993    78    0     34
8     0     2    7   141    5    0     0    21  3048    8     63
9     2     0   50     3    2   22     0     2     0  411      1
10    0     0    2     7    7    0     1     1     5    0  12772
---- Validation: 
scalar performance:
{'acc': 0.9673398, 'precision': 0.9330837, 'recall': 0.8928987, 'specificity': 0.9962053, 'f1': 0.90910137, 'auroc': 0.9990358}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   421     0    0     1    2    0     4     0     0    2     53
1     0  1292    0     6    0    0     0    31     1    0      2
2     0     0  273     0   21    0     0     0     1   14      3
3     0     1    1  8347    0    2     0    52    30    7      0
4     2     0   16     1  321    0     0     0     7    1    191
5     0     0    0    15    1  426     0     0     0   78      1
6     8     1    1     7    1    0  1853     0     1    0     36
7     0     6    4   146    1    0     3  6991    74    0     40
8     0     0    6   143    4    0     0    30  3051    6     56
9     0     0   44     7    1   22     0     0     0  417      2
10    2     0    3     7    5    0     1     0     5    1  12772
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.55677605, 'precision': 0.61438835, 'recall': 0.46471357, 'specificity': 0.9558699, 'f1': 0.47680944, 'auroc': 0.8623016}
confusion matrix:
     0     1    2    3    4   5     6    7     8    9     10
0   737     0   13   92    3   0    66   28     4   26   201
1     2  1003    3   45    0   0     2  369     8    0    67
2     0     0  223   64  159   1     1   48    83   39   397
3     0     0    0    0    0   0     0    0     0    0     0
4     0     0    0    1   70   0     0    1     6    0  1555
5     1     0   18  238    1  71     0    0     2  256     5
6     4     0    0   24    3   0  1974    2     1    0  1059
7     0     0    1  276    0   0     9  860     3    0    15
8     0     0    3  258    0   0     3   11  1079    1    15
9     0     0  303  329   12  14     0   86    30  298    65
10    0     0    0    0    3   0     0    0     0    0  1643
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_15.png
early stop counter: 1
val acc:0.967339813709259, best validation acc: 0.9700146913528442, corresponding to test acc:                         0.7057300806045532 / 0.737074077129364
after epoch: 15,now: 2024-07-09 17:25:05.183809,epoch time: 0:38:06.983112,used: 9:21:00.016944,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_04_05_seed_2_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97062284, 'precision': 0.9344152, 'recall': 0.9222848, 'specificity': 0.9968066, 'f1': 0.9250411, 'auroc': 0.99933994}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    1     2    3    0     4     2     1    2     17
1     0  1305    0     5    0    0     0    17     2    0      1
2     0     0  275     0   11    0     0     5     0   14      7
3     0     0    0  8081    0    1     0   162   191    0      1
4     3     0    7     0  470    0     0     0     2    0     57
5     0     0    2    24    0  354     0     0    16  124      1
6     6     0    1     5    0    0  1886     3     1    1      5
7     1    13    3    43    1    0     1  7136    39    0     28
8     0     0    1    12   19    1     0    26  3158    1     77
9     0     0   24     6    2    4     0     3     1  452      1
10    2     0    1     7   54    0    10     0    10    0  12710
---- Validation: 
scalar performance:
{'acc': 0.97175336, 'precision': 0.9357951, 'recall': 0.9221315, 'specificity': 0.9969231, 'f1': 0.9255833, 'auroc': 0.9993617}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     2    4    0     3     2     0    1     19
1     0  1306    0     5    0    0     0    17     3    0      1
2     0     0  270     0   19    0     0     5     0   14      4
3     0     0    0  8119    0    1     0   144   174    1      1
4     2     0    8     0  462    0     0     2     2    0     63
5     0     0    1    25    1  358     0     0    10  125      1
6     4     0    2     3    1    0  1882     3     1    2     10
7     0    16    3    47    2    0     1  7133    33    3     27
8     0     0    1    15   16    0     0    33  3164    1     66
9     0     0   23     4    1    4     0     1     0  460      0
10    0     0    1     5   51    0     4     7     5    0  12723
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7182537, 'precision': 0.6653502, 'recall': 0.5811213, 'specificity': 0.9716031, 'f1': 0.5751583, 'auroc': 0.88314223}
confusion matrix:
     0     1    2    3    4   5     6     7     8    9     10
0   886     0    0   26   12   0   134    32     8   32    40
1     1  1192    0   18    1   0     0   234    16    0    37
2     0     1  144   10  349   1     8    58   202   66   176
3     0     0    0    0    0   0     0     0     0    0     0
4     0     0    1    0  428   0     5     1     9    0  1189
5     2     0   12  148   11  96     0     2    34  285     2
6     0     0    0    1    0   0  3051     4     4    0     7
7     0     0    0   54    0   0     6  1095     3    0     6
8     0     0    0   42    6   0     3    12  1301    2     4
9     5     2  119  108   28  12     6   102   250  475    30
10    0     0    0    0   45   0     3     0     0    0  1598
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716734_16.png
better model found
persisted
after epoch: 16,now: 2024-07-09 18:02:43.277699,epoch time: 0:37:38.093890,used: 9:58:38.110834,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_08_04_05_seed_2_21716734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9734054, 'precision': 0.9308479, 'recall': 0.92503184, 'specificity': 0.9970665, 'f1': 0.9247325, 'auroc': 0.99940413}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    0     2    4    0     1     1     0    2     12
1     0  1318    0     3    0    0     0     9     1    0      1
2     0     0  296     2    4    0     0     3     1    5      1
3     1     2    0  8332    0    5     0    68    28    0      0
4     4     0   17     0  439    0     0     1     2    0     76
5     2     0    0    11    0  371     0     0     1  135      1
6    16     0    0     1    1    0  1871     1     1    1     16
7     0    23    5   168    2    0     1  7023    28    0     13
8     1     0    1    89   13    1     0    25  3110    5     50
9     1     0   50     2    0    2     0     2     1  435      0
10    7     0    1     7   32    0     6     8     7    0  12726
---- Validation: 
slurmstepd: error: *** JOB 21716734 ON supergpu02 CANCELLED AT 2024-07-09T18:51:06 DUE TO TIME LIMIT ***
