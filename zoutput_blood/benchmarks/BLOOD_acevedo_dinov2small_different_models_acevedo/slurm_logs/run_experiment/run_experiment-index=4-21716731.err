Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul  7 10:45:10 2024]
rule run_experiment:
    input: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/hyperparameters.csv
    output: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731

 Experiment start at: 2024-07-07 10:54:36.360643
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.08150843530893326
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92931294, 'precision': 0.83180964, 'recall': 0.76257586, 'specificity': 0.992104, 'f1': 0.7792707, 'auroc': 0.99417526}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   402     0    0     4    0    0     3     1     1    1     71
1     0  1233    0    14    0    0     1    61     6    0     17
2     6     0  126     2   85    0     2    13    13   56      9
3     9     0    1  8063    0    2     9   206   142    1      7
4     7     0    9     1  283    0     2     4    22    7    204
5    16     0    3   116    1  164     0     0    22  197      2
6    46     0    1     1    0    0  1773     3     3    1     80
7     9    15    1   251   13    0     5  6817   105    1     44
8     6     1    3   205   40    0     7    59  2857    2    115
9    22     0   61    16   10    6     2     1    17  348     10
10   21     0    0     5   51    0    11    20    14    2  12668
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9317373, 'precision': 0.8335116, 'recall': 0.7677691, 'specificity': 0.99240804, 'f1': 0.78285885, 'auroc': 0.9943895}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   406     0    0     6    0    0     4     0     4    1     62
1     0  1241    0    13    3    0     1    57     5    0     12
2     6     0  136     1   89    0     2     8    14   47      9
3    11     0    1  8068    1    1     9   205   139    2      3
4    10     0   10     3  276    0     3     5    26    7    199
5    12     0    1   134    4  155     2     0    20  191      2
6    47     0    0     3    2    0  1780     3     4    2     67
7    12    11    4   248    6    0     3  6839   107    3     32
8     8     0    4   182   25    0     7    66  2896    1    107
9    21     0   61    11    6   11     1     0    15  359      8
10   22     0    1     6   52    0     4    18    15    1  12677
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6499685, 'precision': 0.6220807, 'recall': 0.5350948, 'specificity': 0.96476316, 'f1': 0.5088785, 'auroc': 0.87992465}
confusion matrix:
      0     1    2    3    4   5     6     7     8    9     10
0   1082     0    0   25    1   0     5    22     4    4    27
1      5  1022    0   24    1   0     6   350     4    0    87
2     34     1   74    7  356   0     3   148    77   56   259
3      0     0    0    0    0   0     0     0     0    0     0
4      1     0    0    0  175   0     1     2     1    0  1453
5     26     0    1  131    1  34     2     2    31  358     6
6      1     1    0    1    3   0  2502     2     8    0   549
7      6     0    0   14    0   0     1  1133     0    1     9
8      6     0    0   92   18   0    19    44  1167    3    21
9     55     0  134   81   24   1     3   248    94  458    39
10     0     0    0    0    3   0     0     0     0    0  1643
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-07 11:36:23.864005,epoch time: 0:41:47.503362,used: 0:41:47.503362,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9432256, 'precision': 0.8716382, 'recall': 0.82589936, 'specificity': 0.99378335, 'f1': 0.84152496, 'auroc': 0.9963554}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   416     0    0     3    1    1    13     4     4    4     37
1     0  1258    1    13    0    0     2    50     3    0      5
2     3     0  146     1   65    1     1    14     8   70      3
3     0     0    1  7950    0   13     3   311   156    5      0
4     6     1    8     0  306    2     2     8    29   11    166
5     2     0    1    51    0  334     2     0     8  122      1
6    27     0    1     7    0    0  1846     7     3    1     15
7     0    15    0   208    1    0     1  6912   111    3     12
8     1     1    2   120   10    0     8    55  3033   10     54
9     3     0   26    12    2   28     0     7     4  410      1
10   31     0    3     8   34    0    31    11    28    4  12643
---- Validation: 
scalar performance:
{'acc': 0.9416611, 'precision': 0.8716779, 'recall': 0.8288336, 'specificity': 0.9936069, 'f1': 0.8440039, 'auroc': 0.996374}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   413     0    0     2    1    0    16     6     3    6     36
1     0  1251    0    13    0    0     0    53     9    0      6
2     2     0  147     2   63    1     2    19     6   66      4
3     1     1    0  7931    0   14     1   330   157    5      0
4     4     0    8     1  312    0     4     5    23    9    173
5     2     0    0    45    1  358     0     0     3  111      1
6    30     0    1     5    1    1  1845    12     5    0      8
7     1    14    0   231    2    0     1  6886   116    3     11
8     4     0    2   139   12    4     7    62  3012    9     45
9     5     0   28     8    5   27     1     4     5  409      1
10   27     0    2     7   39    0    34    18    26    3  12640
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7141258, 'precision': 0.6467921, 'recall': 0.5936745, 'specificity': 0.9710301, 'f1': 0.59145886, 'auroc': 0.8835909}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   972     0    0  27    1    0   110    27     3   24     6
1     1  1124    0  38    0    0    12   264     4    1    55
2    11     1  199   7  332    5    50    50   101   45   214
3     0     0    0   0    0    0     0     0     0    0     0
4     1     0    0   0  184    0    10     1     7    1  1429
5     2     0   12  68    2  222    16     1     6  259     4
6     0     0    0   2    0    0  3056     1     0    0     8
7     0     0    0  30    0    0     4  1120     2    1     7
8     0     0    3  87    5    2    60    17  1188    4     4
9     2     1  282  87   13   44    23   105    43  511    26
10    0     0    0   0   10    0     5     0     0    0  1631
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-07 12:17:15.598593,epoch time: 0:40:51.734588,used: 1:22:39.237950,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9375535, 'precision': 0.85719955, 'recall': 0.8184695, 'specificity': 0.9933008, 'f1': 0.82348406, 'auroc': 0.99625653}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   415     0    0    10    2    0     4    10     3    5     34
1     0  1251    0    13    0    0     0    57     5    0      6
2     1     0  150     4   73    1     1    35     4   42      1
3     0     1    0  7956    0    2     0   391    84    3      0
4     4     0   15     1  400    0     0     6    23   10     80
5     1     0    1    87    1  219     0     0    10  201      1
6    21     0    1    11    1    1  1822     5    20    0     26
7     0     8    1   123    1    0     0  7093    27    0      9
8     1     0    2   154   21    0     0   151  2951    0     14
9     2     0   45    16    2    8     1    10     3  406      0
10   13     0    2     9  250    0     5    36    96    5  12379
---- Validation: 
scalar performance:
{'acc': 0.93783605, 'precision': 0.86393565, 'recall': 0.82369334, 'specificity': 0.9933261, 'f1': 0.82882303, 'auroc': 0.9960121}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   411     0    0     7    1    0     6     9     4    6     39
1     0  1244    0    13    0    0     0    67     5    0      3
2     0     0  169     3   61    0     1    28     3   47      0
3     0     0    0  7965    1    2     0   373    95    4      0
4     3     0   13     2  397    1     1     8    25   10     79
5     2     0    2    80    1  218     0     1    10  206      1
6    23     0    2    18    4    0  1811     5    14    1     30
7     0    12    0   127    1    0     1  7081    33    1      9
8     0     0    0   143   23    0     0   151  2958    1     20
9     1     0   34    21    3    5     0     9     3  417      0
10   17     0    3     6  241    0     5    32    99    3  12390
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7029315, 'precision': 0.66396856, 'recall': 0.58105564, 'specificity': 0.97015476, 'f1': 0.5672742, 'auroc': 0.88378}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   990     0   0   50    2    0    33    65     2   20     8
1     1  1143   0   24    0    0     1   249    11    0    70
2     7     0  85   17  326    2     6   103   206   94   169
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  353    0     1     1    14    0  1264
5     2     0   0  107    1  117     0     1    20  343     1
6     7     0   0    1    2    0  2776     3    33    0   245
7     0     0   0    7    0    0     1  1151     0    1     4
8     0     0   0   70    1    0     4    32  1259    3     1
9     6     0  66  107   14   12     1   167   172  560    32
10    0     0   0    0   33    0     0     0     0    0  1613
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_3.png
early stop counter: 1
val acc:0.9378360509872437, best validation acc: 0.9416611194610596, corresponding to test acc:                         0.7141258120536804 / 0.7141258120536804
after epoch: 3,now: 2024-07-07 12:57:38.544821,epoch time: 0:40:22.946228,used: 2:03:02.184178,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9533658, 'precision': 0.8968709, 'recall': 0.8414599, 'specificity': 0.99486816, 'f1': 0.8549004, 'auroc': 0.9976819}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   413     0    0     2    3    0     4     5     0    7     49
1     0  1281    0    13    0    0     0    33     2    0      3
2     0     0  139     1   65    0     0     1     1  101      3
3     0     2    0  8313    1    6     2    55    51    7      0
4     3     0    6     1  365    0     0     1    10   12    141
5     0     0    0    29    0  301     0     0     4  186      1
6     5     0    0     2    2    0  1849     2     2    5     41
7     1    17    1   283    3    0     2  6858    86    2     10
8     0     2    3   178   17    3     1    48  3003    4     37
9     0     0   11     6    4    7     0     0     2  462      0
10   10     0    1     8   59    0     6    10    47    4  12649
---- Validation: 
scalar performance:
{'acc': 0.9523606, 'precision': 0.8920807, 'recall': 0.8391517, 'specificity': 0.99479, 'f1': 0.8512927, 'auroc': 0.9975864}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   416     0    0     5    2    0    11     1     1    5     42
1     0  1270    0    16    0    0     0    38     3    0      5
2     1     0  136     1   72    0     1     2     2   97      0
3     0     2    0  8317    1    8     0    46    57    9      0
4     4     0    6     1  371    1     0     2    12   13    129
5     0     0    0    30    0  294     0     0     3  193      1
6     4     0    0     3    4    0  1860     1     5    5     26
7     3    15    2   323    4    0     2  6812    87    1     16
8     0     1    1   186   15    1     0    42  3018    4     28
9     0     0   14     8    4   10     0     1     0  456      0
10   11     0    0     8   66    0     6     8    39    4  12654
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69859374, 'precision': 0.64941174, 'recall': 0.570064, 'specificity': 0.96966004, 'f1': 0.55806667, 'auroc': 0.8810502}
confusion matrix:
     0     1   2    3    4   5     6     7     8    9     10
0   871     0   0   12    4   0   122    12     4  125    20
1     1  1188   0   29    0   0     1   249     6    1    24
2     4     0  59   20  472   4    10    33   185  105   123
3     0     0   0    0    0   0     0     0     0    0     0
4     0     0   0    0  262   0     2     1    20    0  1348
5     1     0   0   82    3  88     1     0     3  413     1
6     0     0   0    4    3   1  2888     1     2    1   167
7     0     0   0  122    0   0     3  1035     0    1     3
8     0     0   0  121    2   0    11    14  1209    8     5
9     1     1  58   94   38  15     3    72    79  751    25
10    0     0   0    0   12   0     0     0     0    0  1634
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_4.png
better model found
persisted
after epoch: 4,now: 2024-07-07 13:37:42.773906,epoch time: 0:40:04.229085,used: 2:43:06.413263,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9403628, 'precision': 0.8509362, 'recall': 0.8407931, 'specificity': 0.9936843, 'f1': 0.8339533, 'auroc': 0.99700373}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   400     0    3     3    0    0    14     3     3    8     49
1     0  1275    0     7    0    0     0    43     5    0      2
2     0     0  256     0    7    3     2    15    11   17      1
3     0     2    0  7577    0   12     4   588   254    0      0
4     1     0   90     1  306    1     0     7    42    8     83
5     0     0    2    10    0  479     0     0    13   16      1
6     5     0    3     2    0    0  1863     7     8    0     20
7     0     6    2    29    1    0     1  7135    77    0     12
8     0     0    3    33    9    0     0    88  3144    0     18
9     0     0   87     4    0  196     0     7    19  180      0
10    4     0   13     7  162    1     5    13    55    1  12532
---- Validation: 
scalar performance:
{'acc': 0.9403772, 'precision': 0.8502304, 'recall': 0.8410195, 'specificity': 0.9936947, 'f1': 0.8343913, 'auroc': 0.99692285}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   401     0    5     3    3    3    13     3     3    5     44
1     0  1272    0     5    0    0     0    42     8    0      5
2     1     0  254     0    6    8     1    16     7   19      0
3     0     2    1  7605    0   14     1   564   253    0      0
4     3     0   85     1  313    0     1     7    41    7     81
5     0     0    3    17    1  469     1     1    13   15      1
6     3     0    1     1    3    1  1855     9    11    1     23
7     0    12    2    32    0    0     1  7128    81    0      9
8     1     0    3    36    5    1     0    85  3146    0     19
9     0     0   87     6    0  185     0     6    20  189      0
10    7     0   18     6  165    0     7    16    52    1  12524
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67809415, 'precision': 0.64937437, 'recall': 0.5917449, 'specificity': 0.9677667, 'f1': 0.5789987, 'auroc': 0.88077885}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   652     0   39   50    5    7   157   102    72   63    23
1     0  1206    0   21    2    0     0   235    15    0    20
2     0     0  299   15  111   26     0    71   428   10    55
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0   10    0  694    0     0     3    63    0   863
5     0     0    4  114    0  415     1     2    20   35     1
6     1     2    2    7    8    0  2338     3   362    0   344
7     0     0    0   11    0    0     1  1150     1    0     1
8     0     0    0  106    0    2     1    20  1241    0     0
9     0     1  184  143    3  226     1   119   307  146     7
10    0     0    0    0   94    0     0     0     1    0  1551
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_5.png
early stop counter: 1
val acc:0.9403771758079529, best validation acc: 0.9523605704307556, corresponding to test acc:                         0.6985937356948853 / 0.7141258120536804
after epoch: 5,now: 2024-07-07 14:18:17.063577,epoch time: 0:40:34.289671,used: 3:23:40.702934,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9582352, 'precision': 0.89469254, 'recall': 0.87672865, 'specificity': 0.9954407, 'f1': 0.8838897, 'auroc': 0.9980516}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   390     0    0     6    1    0    21     4     2    4     55
1     0  1285    0     4    0    0     0    37     1    0      4
2     2     0  217     1   21    2     1     7     4   54      3
3     0     2    0  8046    0   36     0   240   115    0      0
4     4     0   30     0  374    2     0     1     8   19    101
5     0     0    0     6    0  478     0     0     2   34      1
6     2     0    0     5    1    0  1876     2     8    2     12
7     0    17    2   127    1    0     1  7063    30    0     23
8     1     1    4    61   30    9     0    96  3044    2     47
9     0     0   19     3    0  102     0     2     2  365      0
10    1     0    3     7   70    1    10     2    18    2  12677
---- Validation: 
scalar performance:
{'acc': 0.9587803, 'precision': 0.8947043, 'recall': 0.87697226, 'specificity': 0.995492, 'f1': 0.8840952, 'auroc': 0.9980171}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   386     0    0     7    2    0    22     1     2    6     57
1     0  1288    0     6    0    0     0    34     2    0      2
2     0     0  224     1   18    3     1     6     2   55      2
3     0     1    1  8067    0   35     0   219   116    1      0
4     2     0   29     1  379    2     0     1     7    9    109
5     0     0    0     8    0  475     0     0     4   32      2
6     1     0    1     1    1    1  1886     2     3    0     12
7     0    13    2   116    3    0     1  7071    33    0     26
8     1     0    3    69   28    6     0   100  3037    8     44
9     0     0   25     3    2  100     0     6     2  354      1
10    1     0    4     6   82    1     8     7    10    0  12677
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73028755, 'precision': 0.67109644, 'recall': 0.62167215, 'specificity': 0.9727734, 'f1': 0.6131437, 'auroc': 0.88521475}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   759     0    2   21    4    5   254    43     5   65    12
1     0  1146    0   17    2    0     0   290    11    0    33
2     0     1  140   11  377   26     5    61   217   77   100
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    0    0  600    0     3     1    15    0  1014
5     0     0    0   59    1  457     1     1    11   61     1
6     0     0    0    4    1    0  2992     3    31    0    36
7     0     0    0  116    0    0     1  1046     0    0     1
8     0     0    0   42    2    6     3    21  1293    0     3
9     0     0   84   80   12  203     5   144   177  411    21
10    0     0    0    0   51    0     1     0     0    0  1594
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-07 14:59:06.404732,epoch time: 0:40:49.341155,used: 4:04:30.044089,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9601081, 'precision': 0.9131527, 'recall': 0.8660791, 'specificity': 0.9955367, 'f1': 0.882213, 'auroc': 0.9983649}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    0     5    1    0     6     4     4    3     30
1     1  1285    0     9    0    0     0    26     3    0      8
2     0     0  153     0   27    3     2     5     2  119      1
3     0     2    1  8273    0   12     0    83    65    2      1
4     2     0   13     0  338    1     3     1     7   11    163
5     0     0    0    15    0  462     1     0     3   39      1
6     7     0    0     4    0    1  1884     0     1    1     10
7     0    28    0   258    1    0     1  6928    34    3     10
8     1     3    1   179   12    4     0    70  2980    5     38
9     1     0    4     2    1   61     2     2     3  417      0
10    9     0    3     8   16    0     5     7    10    0  12736
---- Validation: 
scalar performance:
{'acc': 0.9600107, 'precision': 0.9092691, 'recall': 0.86210364, 'specificity': 0.9955261, 'f1': 0.8783234, 'auroc': 0.9983505}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     0    0     3    0    0     8     2     0    2     38
1     0  1284    0     9    0    0     0    28     2    0      9
2     0     0  148     0   26    4     0     8     1  121      4
3     0     3    0  8239    0   18     2    96    80    1      1
4     4     0   18     1  328    2     0     2    12   10    162
5     0     0    0    15    0  459     0     0     3   43      1
6     7     0    0     7    0    0  1877     1     0    2     14
7     0    21    1   251    3    0     1  6949    28    0     11
8     0     2    2   157   13    5     1    54  3023    3     36
9     0     0    6     2    1   65     1     2     4  412      0
10    4     0    1     9   15    0     8     7     9    2  12741
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.713706, 'precision': 0.65263546, 'recall': 0.6053388, 'specificity': 0.97120535, 'f1': 0.5873642, 'auroc': 0.8804254}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1040     0   0   62    0    2    24    30     4    4     4
1      2  1110   0   32    0    0     4   242     5    0   104
2     17     0  73    8  170   13    17    66    88  114   449
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   0    0   33    0     4     2     4    0  1590
5      4     0   0   80    1  332     0     0     7  166     2
6      0     0   0    2    0    0  3009     1     2    0    53
7      0     0   0  118    0    1     0  1043     0    0     2
8      0     0   0   71    2    5     9    27  1244    2    10
9      6     0  39   60    3   89     5   115    90  675    55
10     0     0   0    0    0    0     3     1     0    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_7.png
better model found
persisted
after epoch: 7,now: 2024-07-07 15:39:58.723781,epoch time: 0:40:52.319049,used: 4:45:22.363138,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9568172, 'precision': 0.8993983, 'recall': 0.8935365, 'specificity': 0.99555004, 'f1': 0.8923513, 'auroc': 0.9985294}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     3    3    0    10     2     3    1      4
1     0  1298    0     6    0    0     0    25     3    0      0
2     1     0  199     1   27    1     2     3    14   64      0
3     0     0    0  8145    0    3     3    59   225    2      0
4     6     1    7     1  410    0     1     2    49    3     59
5     0     0    0    23    0  403     0     0     9   85      1
6     5     0    1     2    0    0  1892     1     4    0      3
7     0    17    0   194    1    0     2  6900   148    0      3
8     1     0    1    24    0    0     0    18  3248    2      2
9     0     0   13     3    4   27     1     0    13  432      0
10   33     1    0     7  154    0    29    14   171    3  12378
---- Validation: 
scalar performance:
{'acc': 0.9570416, 'precision': 0.8960218, 'recall': 0.8953824, 'specificity': 0.99559, 'f1': 0.8922247, 'auroc': 0.9983794}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    0     5    3    0    12     0     5    2      6
1     0  1303    0     8    0    0     0    19     2    0      0
2     0     0  204     0   27    1     1     2    19   58      0
3     1     2    0  8134    0    9     1    61   231    1      0
4     5     0   14     0  421    1     0     1    41    1     55
5     1     0    1    18    1  398     0     0    12   89      1
6     6     0    0     3    1    0  1891     1     3    0      3
7     0    16    0   177    1    0     1  6923   144    0      3
8     0     0    2    23    3    0     1    19  3248    0      0
9     1     0   14     4    1   24     1     2    12  434      0
10   30     3    1     7  163    0    30    16   172    1  12373
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7325264, 'precision': 0.6849009, 'recall': 0.6089775, 'specificity': 0.9732116, 'f1': 0.60222816, 'auroc': 0.8853421}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1068     0   0   35    1    3    28   12    18    5     0
1      3  1203   1   30    0    0     7  214    27    1    13
2      4     0  60   16  190    8    26   25   544   72    70
3      0     0   0    0    0    0     0    0     0    0     0
4      2     0   0    0  432    0    18    1    88    0  1092
5      0     0   0   97    1  268     1    0    41  184     0
6      0     0   0    5    0    0  3042    0    18    0     2
7      1     0   0  184    0    1     1  955    20    1     1
8      0     0   0   29    0    2     5    0  1334    0     0
9      6     2  37   99   13   60     9   30   351  516    14
10     0     0   0    0   43    0    10    0     1    0  1592
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_8.png
new oracle model saved
early stop counter: 1
val acc:0.9570416212081909, best validation acc: 0.9600107073783875, corresponding to test acc:                         0.7137060165405273 / 0.732526421546936
after epoch: 8,now: 2024-07-07 16:20:29.216439,epoch time: 0:40:30.492658,used: 5:25:52.855796,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9678403, 'precision': 0.9196247, 'recall': 0.8832713, 'specificity': 0.9965031, 'f1': 0.8935524, 'auroc': 0.9988863}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   432     0    1     2    0    0     3     0     0    5     40
1     0  1288    0    10    0    0     0    30     2    0      2
2     0     0  198     0    6    0     0     1     1  103      3
3     1     1    0  8237    0    6     0   128    62    2      0
4     4     0   40     1  370    1     1     3     7   10    102
5     0     0    0    13    0  351     0     0     4  152      1
6     3     0    1     4    1    0  1877     2     3    1     15
7     0    13    0    91    1    0     1  7099    53    3      4
8     0     0    1    57    4    0     0    53  3135    9     37
9     0     0    1     1    0    9     0     0     0  482      0
10    2     1    4     7   38    0     3     7    23    1  12705
---- Validation: 
scalar performance:
{'acc': 0.9670456, 'precision': 0.91613746, 'recall': 0.8784367, 'specificity': 0.996421, 'f1': 0.889392, 'auroc': 0.99888337}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   429     0    0     3    0    0     2     5     2    6     36
1     0  1287    0    12    0    0     0    32     1    0      0
2     0     0  197     0    7    1     0     1     2  104      0
3     0     0    0  8212    0    4     0   150    69    5      0
4     4     0   43     2  357    0     0     1    13   13    106
5     0     0    1    21    0  350     0     0     3  145      1
6     5     0    0    10    2    0  1871     2     1    3     14
7     0     8    0    70    1    0     1  7130    47    3      5
8     0     0    1    72    8    1     0    47  3126    8     33
9     0     0    3     5    0    7     0     0     2  476      0
10    4     0    7     7   37    0     3     4    15    1  12718
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7290282, 'precision': 0.7146594, 'recall': 0.60088295, 'specificity': 0.97300375, 'f1': 0.604278, 'auroc': 0.8853768}
confusion matrix:
     0     1    2    3    4   5     6     7     8    9     10
0   853     0    6   69    1   2    35    53     9  108    34
1     0  1183    1   33    1   0     0   241     6    5    29
2     2     0  290   24  165   2     0    47   154  148   183
3     0     0    0    0    0   0     0     0     0    0     0
4     0     0    3    0  343   0     2     2     7    2  1274
5     2     0   10  136    1  97     0     0     9  336     1
6     0     0    0    4    0   0  2983     2     1    0    77
7     0     0    0  120    0   0     0  1040     2    1     1
8     0     0    0  110    2   0     5     7  1231    7     8
9     1     0   76  139    4  10     2    58    56  769    22
10    0     0    0    0   14   0     0     1     0    0  1631
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_9.png
better model found
persisted
after epoch: 9,now: 2024-07-07 17:00:48.346440,epoch time: 0:40:19.130001,used: 6:06:11.985797,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9632652, 'precision': 0.90502095, 'recall': 0.89873415, 'specificity': 0.99594915, 'f1': 0.89670825, 'auroc': 0.9987049}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   442     0    0     0    3    2     7     0     0    1     27
1     0  1315    0     2    0    0     0    11     2    0      2
2     0     0  278     0    7    1     1     0     2   17      6
3     0    13    4  8197    1   12     6   105    91    7      4
4     4     0   50     1  313    0     3     0     1    1    166
5     0     0    1    10    0  470     0     0     1   37      2
6     3     0    0     1    0    0  1890     0     0    1     11
7     4   105   29    94    4    0     3  6913    84    1     28
8     1     2   15    59   21    5     8    35  3050    9     90
9     1     0   64     3    0   42     2     0     0  380      1
10    3     0    4     7    9    1     5     3     4    0  12755
---- Validation: 
scalar performance:
{'acc': 0.96217734, 'precision': 0.90142876, 'recall': 0.89472306, 'specificity': 0.99583304, 'f1': 0.893715, 'auroc': 0.99869746}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   430     1    2     3    1    0    11     0     0    1     34
1     0  1315    0     2    0    0     0    13     1    0      1
2     0     0  273     1    8    1     3     1     0   18      7
3     0    20    6  8182    2   15     3   111    90    8      3
4     2     0   50     1  309    0     0     1     3    3    170
5     0     0    3     8    0  457     1     0     0   50      2
6     4     0    1     0    0    1  1893     0     1    0      8
7     1   102   23    99    3    0     3  6925    83    3     23
8     0     4   10    69   31    5     6    36  3041    7     87
9     0     0   58     1    2   33     0     0     0  397      2
10    3     0    6     7   14    1     8     4     4    0  12749
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7484783, 'precision': 0.69210696, 'recall': 0.64404726, 'specificity': 0.9745069, 'f1': 0.6382219, 'auroc': 0.884538}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   949     1    3  30    0    4   116    13     1   39    14
1     3  1282    2  14    0    0     2   167     5    0    24
2     3     0  353   9  132   21    36    26    72   80   283
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    4   0  133    0     3     1     4    0  1488
5     1     0    5  74    2  374    15     0     2  118     1
6     0     0    0   5    0    0  3042     0     0    0    20
7     1     1    2  21    0    1     4  1129     3    0     2
8     0     2    1  68    3   13    51     6  1207    3    16
9     3     3  162  77    0  135    12    46    76  589    34
10    0     0    0   0    3    0     3     0     0    0  1640
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_10.png
new oracle model saved
early stop counter: 1
val acc:0.9621773362159729, best validation acc: 0.9670456051826477, corresponding to test acc:                         0.7290282249450684 / 0.7484782934188843
after epoch: 10,now: 2024-07-07 17:41:15.104058,epoch time: 0:40:26.757618,used: 6:46:38.743415,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.972683, 'precision': 0.9331316, 'recall': 0.90289676, 'specificity': 0.99695706, 'f1': 0.9150101, 'auroc': 0.99910504}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     0    0    0     2     3     0    0     10
1     0  1295    0     3    0    0     0    30     2    0      2
2     5     0  207     0   10    1     1     3     2   79      4
3     1     3    0  8309    0    4     0    79    42    1      0
4     7     1   25     1  369    0     1     1    10    4    120
5     2     0    0    17    0  467     0     0     2   31      1
6     7     0    0     3    0    0  1879     4     2    0     12
7     0     8    0   140    1    0     1  7074    27    1     11
8     1     1    2    82    5    0     0    45  3125    1     31
9     4     0    4     4    0   55     1     0     1  422      2
10   10     2    0     6   18    0     4     4    10    1  12740
---- Validation: 
scalar performance:
{'acc': 0.9715929, 'precision': 0.92799646, 'recall': 0.8964796, 'specificity': 0.99684966, 'f1': 0.9084483, 'auroc': 0.99904555}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     1    0    0     2     1     1    0     12
1     0  1308    0     2    0    0     0    19     3    0      0
2     3     0  205     1    8    2     1     6     1   82      3
3     4     1    0  8302    0    8     0    76    47    2      0
4     8     1   21     0  356    1     3     2     8    7    132
5     4     0    0    13    0  462     2     0     2   37      1
6     9     0    0     2    0    0  1878     5     1    0     13
7     4    11    0   141    1    0     0  7073    24    0     11
8     1     3    3    74    6    1     2    50  3122    3     31
9     5     0    3     9    0   63     1     3     2  407      0
10   13     0    0     7   14    0     3     3    12    0  12744
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7260897, 'precision': 0.68959266, 'recall': 0.6095098, 'specificity': 0.9724963, 'f1': 0.5945505, 'auroc': 0.88803554}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1105     0    0   17    0    0     8    27     9    2     2
1      0  1207    0   13    0    0     0   269     1    0     9
2     60     2  131   15  121    1    23    75   233   76   278
3      0     0    0    0    0    0     0     0     0    0     0
4      2     0    2    0  175    0     3     2    16    0  1433
5     29     0    0  114    1  225     9     1    14  197     2
6      1     0    1    4    0    0  2954     5     2    0   100
7      2     0    0   28    0    0     0  1129     2    0     3
8      1     1    0   91    0    0     6    22  1244    1     4
9     38     1   45  129    4   41    10   131   123  574    41
10     0     0    0    0    9    0     3     0     0    0  1634
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_11.png
better model found
persisted
after epoch: 11,now: 2024-07-07 18:21:51.182769,epoch time: 0:40:36.078711,used: 7:27:14.822126,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96575344, 'precision': 0.9114529, 'recall': 0.893808, 'specificity': 0.9963054, 'f1': 0.89752114, 'auroc': 0.9987507}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   422     0    3     7    1    2     4    13     3   11     17
1     0  1282    0     4    0    1     0    42     3    0      0
2     0     0  269     1    1    6     0     2     3   30      0
3     0     1    0  8125    0   15     0   216    81    0      0
4     3     0   65     0  330    4     0     2    20    9    105
5     0     0    0     8    0  501     0     0     2    9      1
6     1     0    3     6    0    1  1865     7     9    0     16
7     0     3    4    74    0    0     1  7137    39    1      3
8     0     0    4    64    1   13     0    41  3164    1      8
9     0     0   24     7    0  119     0     4     1  338      0
10    2     0    8     7   42    1     4    20    45    1  12663
---- Validation: 
scalar performance:
{'acc': 0.96594894, 'precision': 0.9126593, 'recall': 0.89769053, 'specificity': 0.9963343, 'f1': 0.9009871, 'auroc': 0.9987779}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   428     0    0     8    3    3     5    11     3    6     16
1     0  1275    1     6    0    0     0    44     6    0      0
2     0     0  269     2    3    2     1     3     2   30      0
3     0     0    0  8149    0   11     0   206    73    1      0
4     3     1   63     0  346    2     0     2    21    5     96
5     0     0    1     5    0  501     0     0     1   12      1
6     6     1    3     7    0    3  1848    13    11    3     13
7     0     4    3    79    2    0     1  7123    48    0      5
8     0     0    4    63    1    9     0    41  3171    2      5
9     0     0   24     7    0  113     0     2     2  345      0
10    2     0   10     8   39    2     1    23    53    1  12657
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.660813, 'precision': 0.6472231, 'recall': 0.5572418, 'specificity': 0.9662707, 'f1': 0.5343574, 'auroc': 0.8759555}
confusion matrix:
     0    1    2    3   4    5     6     7     8    9     10
0   698    0    6   69   1   20     7   241    42   58    28
1     0  978    1   30   0    0     0   445    14    0    31
2     5    0  173   37  23   29     3    81   376   65   223
3     0    0    0    0   0    0     0     0     0    0     0
4     0    0    3    0  24    0     1     1    36    0  1568
5     0    0    0  176   0  344     0     2    17   53     0
6     2    0    0   32   0    0  2861     8     8    0   156
7     0    0    0   14   0    0     0  1146     1    0     3
8     0    0    0   90   0    2     0    17  1258    0     3
9     2    0   57  263   0  159     0   146   168  317    25
10    0    0    0    0   0    0     0     0     0    0  1646
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_12.png
early stop counter: 1
val acc:0.9659489393234253, best validation acc: 0.971592903137207, corresponding to test acc:                         0.7260897159576416 / 0.7484782934188843
after epoch: 12,now: 2024-07-07 19:02:20.946033,epoch time: 0:40:29.763264,used: 8:07:44.585390,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.965031, 'precision': 0.8978496, 'recall': 0.89844894, 'specificity': 0.9963597, 'f1': 0.8903118, 'auroc': 0.9989784}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   428     0    0     2    5    0    19     2     1    2     24
1     0  1309    0     1    0    0     0    20     1    0      1
2     0     0  182     0   21    7     1     4     1   96      0
3     0     1    0  8312    0   16     0    83    22    2      0
4     2     0    7     1  490    3     1     2     7    3     23
5     0     0    0     4    0  505     0     0     1   10      1
6     2     1    0     2    2    1  1889     4     1    0      6
7     1     5    2    95    2    1     1  7141     9    2      5
8     0     6    0   147   21   13     0    86  2991    4     27
9     0     0    6     1    1  134     0     0     0  350      0
10    3     0    1     8  260    1    15    10    19    5  12472
---- Validation: 
scalar performance:
{'acc': 0.96661764, 'precision': 0.9003049, 'recall': 0.90315723, 'specificity': 0.9965286, 'f1': 0.8950137, 'auroc': 0.99903846}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    0     0    3    0    18     1     3    3     18
1     0  1311    0     3    0    0     0    17     1    0      0
2     0     0  190     0   24    5     0     1     3   89      0
3     0     1    0  8321    0   24     0    77    17    0      0
4     1     0   12     0  487    3     1     1     7    4     23
5     0     0    0     4    0  511     0     0     0    5      1
6     2     0    0     4    1    1  1883     3     3    2      9
7     0    10    0   100    3    0     2  7133    11    1      5
8     0     2    0   150   22    9     1    72  3016    5     19
9     0     0    8     1    2  133     0     1     0  348      0
10    2     0    1     8  237    2     8    12    23    3  12500
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72909814, 'precision': 0.70022845, 'recall': 0.6160232, 'specificity': 0.9730184, 'f1': 0.61431146, 'auroc': 0.8876283}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   713     0   1   70    6   22   243    48     5   47    15
1     0  1170   0   22    2    0     0   300     2    0     3
2     0     1  80   57  276   48    12   137   206  132    66
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   0    0  823    0     5     6    13    2   784
5     0     0   0   99    0  433     1     0     2   57     0
6     0     3   1   23    0    0  3016     7     4    0    13
7     0     0   0   30    0    1     0  1132     0    0     1
8     0     1   0  225    1    4     6    51  1080    1     1
9     1     2  14  243    5  230     1   108    53  473     7
10    0     0   0    0  140    0     4     1     0    0  1501
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_13.png
early stop counter: 2
val acc:0.9666176438331604, best validation acc: 0.971592903137207, corresponding to test acc:                         0.7260897159576416 / 0.7484782934188843
after epoch: 13,now: 2024-07-07 19:43:02.421037,epoch time: 0:40:41.475004,used: 8:48:26.060394,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9729506, 'precision': 0.92199576, 'recall': 0.9266554, 'specificity': 0.9971357, 'f1': 0.9234647, 'auroc': 0.9992217}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    0     5    3    0     5     0     2    0     20
1     0  1314    0     4    0    0     0    13     1    0      0
2     1     0  264     1    3    2     0     2     1   35      3
3     0     2    0  8340    0    0     5    42    47    0      0
4     2     0   38     0  462    0     0     5     7    4     21
5     0     0    1    39    0  465     0     0     2   13      1
6     1     0    0     0    2    0  1889     0     2    1     13
7     0    25    1   149    1    0     3  7057    24    0      3
8     0     0    1    73    9    0     0    45  3161    0      7
9     0     0   22     7    4   61     1     4     4  390      0
10    4     1    3     7  153    1     4    11    33    1  12575
---- Validation: 
scalar performance:
{'acc': 0.97183365, 'precision': 0.92138714, 'recall': 0.92315584, 'specificity': 0.9969852, 'f1': 0.9212376, 'auroc': 0.9992093}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   438     0    0     1    4    0     3     1     0    1     35
1     0  1317    0     2    0    0     0    12     1    0      0
2     2     0  266     1    5    3     0     1     2   31      1
3     1     3    0  8333    0    3     2    46    52    0      0
4     2     0   32     0  454    0     2     6     3    5     35
5     0     0    0    34    0  472     0     0     1   13      1
6     1     0    0     1    1    0  1890     0     2    0     13
7     1    22    0   153    1    0     2  7062    21    0      3
8     0     0    3    84    4    0     1    48  3148    0      8
9     0     0   31    10    3   62     0     6     1  380      0
10    1     0    2     9  156    1     2    16    37    0  12572
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74099207, 'precision': 0.6875129, 'recall': 0.6233785, 'specificity': 0.97407055, 'f1': 0.6267881, 'auroc': 0.8863817}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   925     0    0   31    3   10   156   13     2    5    25
1     2  1263    0   16    1    0     0  191     9    0    17
2     6     1  153   13  298   20    10  112   199   87   116
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    6    0  689    0     1    6    14    0   917
5     4     0    3   99    6  365    10    0    10   94     1
6     1     0    0    2    1    0  3001    1     1    0    60
7     1     0    0  208    0    0     1  953     0    0     1
8     0     0    0   83    1    3     8   16  1256    1     2
9    12     0   66  126   10  151     9  152   169  420    22
10    0     0    0    0   78    0     1    1     0    0  1566
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_14.png
better model found
persisted
after epoch: 14,now: 2024-07-07 20:23:03.893721,epoch time: 0:40:01.472684,used: 9:28:27.533078,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97134525, 'precision': 0.9231326, 'recall': 0.906945, 'specificity': 0.99694294, 'f1': 0.9089577, 'auroc': 0.999318}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     0    3    2     4     1     1    0     14
1     0  1270    0     6    0    0     0    45    10    0      1
2     0     0  260     0   26    3     0     3     5   15      0
3     3     0    0  8166    0    5     0   161   102    1      0
4     3     0    6     0  465    0     0     0     9    1     55
5     0     0    1    18    0  492     0     0     5    3      2
6    10     0    0     2    0    1  1877     2     2    0     13
7     0     5    0    71    2    0     1  7127    43    0     13
8     0     0    1    26    3    0     0    43  3208    0     15
9     1     1   55     4    5  159     0     1     1  263      3
10    7     0    2     7   38    1     2     4    13    0  12720
---- Validation: 
scalar performance:
{'acc': 0.97129864, 'precision': 0.9248847, 'recall': 0.90442026, 'specificity': 0.99692, 'f1': 0.9068315, 'auroc': 0.9993127}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   458     0    0     0    3    0     3     0     0    0     19
1     0  1275    0     5    0    0     1    44     7    0      0
2     1     0  266     0   32    1     0     1     2    8      1
3     0     0    0  8168    0    3     0   160   105    0      4
4     4     0    4     1  444    0     0     2    12    0     72
5     0     0    0    14    1  499     0     0     5    1      1
6    11     0    0     0    0    0  1877     1     3    0     16
7     1     4    0    73    2    0     1  7136    36    0     12
8     0     0    1    21    9    0     1    38  3208    0     18
9     1     0   65     2    3  169     0     1     2  250      0
10    3     0    0     4   31    0     4     4    18    1  12731
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6880991, 'precision': 0.61917555, 'recall': 0.5829906, 'specificity': 0.9686706, 'f1': 0.5539099, 'auroc': 0.87491256}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   897    0    3   28    4   16    63    99    14   35    11
1     1  960    0   33    1    0     0   444    20    0    40
2     9    0   96    7  189   29     8    71   276   49   281
3     0    0    0    0    0    0     0     0     0    0     0
4     2    0    1    0  180    0     2     2    24    0  1422
5     2    0    6   83    2  390     4     0    18   73    14
6     6    0    0    4    1    0  2940     2     8    0   106
7     0    0    0    4    0    0     0  1152     4    0     4
8     0    0    0   37    0    3     6    25  1293    2     4
9    10    0  111  109   10  253     8   126   167  292    51
10    0    0    0    0   11    0     0     0     0    0  1635
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_15.png
early stop counter: 1
val acc:0.9712986350059509, best validation acc: 0.9718336462974548, corresponding to test acc:                         0.7409920692443848 / 0.7484782934188843
after epoch: 15,now: 2024-07-07 21:02:55.476381,epoch time: 0:39:51.582660,used: 10:08:19.115738,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9758133, 'precision': 0.9304143, 'recall': 0.936731, 'specificity': 0.9974456, 'f1': 0.9315146, 'auroc': 0.99953175}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   454     0    0     1    9    0     1     0     1    1     16
1     0  1271    1     5    0    0     1    46     4    1      3
2     0     0  241     0   37    0     0     3     1   29      1
3     1     0    0  8346    1   10     0    36    41    2      2
4     0     0    2     0  511    0     0     0     2    1     23
5     0     0    0     6    0  473     0     0     3   38      1
6     6     0    1     0    2    0  1881     0     2    0     15
7     0     1    6   136    2    0     1  7064    43    2      9
8     1     0    3    57   12    0     0    13  3198    0     12
9     0     0   25     1    8   25     0     1     0  433      0
10    5     0    0     5  149    0     1     3    27    0  12600
---- Validation: 
scalar performance:
{'acc': 0.97667515, 'precision': 0.93347913, 'recall': 0.94082856, 'specificity': 0.9975381, 'f1': 0.934962, 'auroc': 0.999529}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    1     0   10    0     2     2     0    1     16
1     0  1271    0     7    0    0     2    48     1    0      3
2     0     0  248     0   33    0     0     0     1   29      1
3     1     0    1  8363    3    8     1    21    40    2      0
4     0     0    3     0  507    0     0     0     3    0     26
5     0     0    1     3    1  482     0     0     3   30      1
6     9     0    0     1    2    0  1875     0     4    0     17
7     0     2    7   131    1    0     0  7084    33    0      7
8     1     0    2    65   22    1     0    11  3185    0      9
9     0     0   20     3    7   18     0     0     1  444      0
10    4     0    0     4  159    0     1     2    23    0  12603
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65150774, 'precision': 0.6324431, 'recall': 0.55443144, 'specificity': 0.965147, 'f1': 0.5566296, 'auroc': 0.87188804}
confusion matrix:
     0    1    2    3    4    5     6     7     8    9     10
0   824    0   16   58   48    3    14    57    10  122    18
1     4  752    1   50    0    0     1   599    17   12    63
2     2    0  167   12  397    4     0    47   191  102    93
3     0    0    0    0    0    0     0     0     0    0     0
4     1    0    2    0  507    0     1     2    34    0  1086
5     2    0   14   65   23  199     0     0     2  282     5
6     7    0    3    9    7    0  2387     3    77    0   574
7     3    0    4  114    1    0     0  1033     1    5     3
8     1    0    4  116   11    4     6     9  1202   13     4
9     4    0  138  110   28   71     0    51    55  651    29
10    0    0    0    0   55    0     0     0     1    0  1590
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_16.png
better model found
persisted
after epoch: 16,now: 2024-07-07 21:43:05.352522,epoch time: 0:40:09.876141,used: 10:48:28.991879,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9762414, 'precision': 0.93204784, 'recall': 0.9423818, 'specificity': 0.99746126, 'f1': 0.9337175, 'auroc': 0.9995029}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    1     1    2    0     2     1     2    0      2
1     0  1323    0     0    0    0     0     9     0    0      0
2     1     0  307     0    1    0     0     0     0    2      0
3     0     3    0  8386    0    1     0    35     9    0      1
4     6     0   76     0  404    0     0     0     9    2     42
5     0     0    2    13    0  474     0     0     0   31      1
6     7     0    0     1    0    0  1890     1     2    2      5
7     0    53    4   195    0    0     2  6990    15    0      6
8     0     1    7    94    4    1     1    21  3159    1      6
9     0     0   50     7    0   15     0     0     0  421      0
10   11     1   12     7   50    1     4     2    44    0  12662
---- Validation: 
scalar performance:
{'acc': 0.9759529, 'precision': 0.9348475, 'recall': 0.9419455, 'specificity': 0.9974108, 'f1': 0.9353383, 'auroc': 0.99954104}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    1    0     1     0     0    0      3
1     0  1326    0     1    0    0     0     5     0    0      0
2     0     0  308     0    0    0     0     0     0    4      0
3     0     3    0  8389    0    4     0    35     9    0      0
4     5     0   64     1  416    0     0     0     7    4     42
5     0     0    1    25    0  460     0     0     1   33      1
6     3     0    1     2    0    0  1897     0     2    0      3
7     1    59    2   197    1    0     1  6974    24    0      6
8     1     1    5   121    3    0     0    25  3134    0      6
9     0     0   50     6    0   20     0     1     0  416      0
10   14     0   10     5   41    1     4     5    28    0  12688
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7090184, 'precision': 0.68939817, 'recall': 0.58565235, 'specificity': 0.9711689, 'f1': 0.5858536, 'auroc': 0.88068306}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   994     0    6   57    0    1    41    37    13   16     5
1     0  1154    0   18    0    0     1   297    11    0    18
2     9     0  339   45   37   10    11    72   304   67   121
3     0     0    0    0    0    0     0     0     0    0     0
4     2     0    9    0  181    0     4     2    73    0  1362
5     0     0    5  202    1  158     1     1     7  217     0
6     1     0    0   10    0    0  3022     3     8    0    23
7     0     0    0  108    0    0     0  1055     0    0     1
8     0     0    0  142    0    1     3    28  1195    1     0
9     2     0  127  291    2   55     0    97   138  405    20
10    0     0    0    0    9    0     5     0     1    0  1631
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_17.png
early stop counter: 1
val acc:0.9759529232978821, best validation acc: 0.9766751527786255, corresponding to test acc:                         0.6515077352523804 / 0.7484782934188843
after epoch: 17,now: 2024-07-07 22:22:40.611030,epoch time: 0:39:35.258508,used: 11:28:04.250387,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97289705, 'precision': 0.9415064, 'recall': 0.92701864, 'specificity': 0.99697304, 'f1': 0.9325854, 'auroc': 0.9994396}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     0    0    0     0     1     0    0      8
1     0  1306    0     1    0    0     0    23     0    0      2
2     1     0  285     0   17    0     0     2     4    3      0
3     2     0    0  8045    1    6     1   260   115    2      3
4     5     0    5     0  400    0     0     0     5    0    124
5     1     0    3     9    0  449     0     0     4   54      1
6    34     0    0     2    0    0  1853     0     2    0     16
7     3     2    1    29    1    0     1  7206    14    0      8
8     2     0    1    25    6    0     0    54  3158    2     46
9     4     0   50     2    4   11     0     4     1  416      1
10    5     0    1     3    4    0     1     7     3    0  12771
---- Validation: 
scalar performance:
{'acc': 0.9723686, 'precision': 0.9375749, 'recall': 0.92378926, 'specificity': 0.99691564, 'f1': 0.92810094, 'auroc': 0.9994639}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     0    0     0    1    0     0     1     0    0      5
1     1  1308    0     1    0    0     0    19     1    0      2
2     1     0  284     0   11    0     0     3     2   11      0
3     4     2    0  8071    0    8     1   252    99    1      2
4     6     0   11     0  379    0     0     1     2    2    138
5     0     0    0     6    0  453     0     0     2   59      1
6    28     0    0     2    1    0  1857     4     0    0     16
7     4     4    1    28    1    0     0  7200    18    0      9
8     1     0    2    24    4    0     1    66  3150    0     48
9     5     0   59     1    0    8     0     3     3  413      1
10   16     0    1     2    4    0     1     2     9    0  12761
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6953754, 'precision': 0.6259905, 'recall': 0.5765615, 'specificity': 0.9693774, 'f1': 0.5536566, 'auroc': 0.8742468}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1113     0    0  24    0    0     1    24     3    0     5
1      5  1051    0  10    0    0     1   378     5    1    48
2     86     0  148  11  122    6     9    89    97   45   402
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    0   0   62    0     2     2     5    0  1560
5     36     0   10  96    1  141     9     0     3  292     4
6     26     0    0   2    1    0  2907     2     0    0   129
7      1     0    1  13    0    0     1  1142     2    1     3
8      3     0    2  66    6    1     6    36  1219   10    21
9     70     0  195  87    5   25     5   137    61  512    40
10     0     0    0   0    2    0     0     0     0    0  1644
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_18.png
early stop counter: 2
val acc:0.972368597984314, best validation acc: 0.9766751527786255, corresponding to test acc:                         0.6515077352523804 / 0.7484782934188843
after epoch: 18,now: 2024-07-07 23:01:50.862198,epoch time: 0:39:10.251168,used: 12:07:14.501555,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9808433, 'precision': 0.9562227, 'recall': 0.93359274, 'specificity': 0.9978721, 'f1': 0.9425312, 'auroc': 0.9996883}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     1    2    0     0     0     0    0      1
1     0  1295    0     3    0    0     0    32     1    0      1
2     1     0  268     0   16    1     0     4     2   19      1
3     1     0    0  8306    0   13     0    81    35    0      0
4     5     0    2     1  417    0     0     0     5    1    108
5     0     0    0     5    0  513     0     0     1    1      0
6     4     0    0     2    0    1  1890     2     1    0      7
7     0     2    0    52    1    0     2  7183    19    0      6
8     1     0    0    55    2    1     0    38  3186    0     12
9     0     0   19     6    0   88     1     3     1  374      1
10    7     0    0     4   10    1     4     1    18    0  12749
---- Validation: 
scalar performance:
{'acc': 0.98151666, 'precision': 0.95855, 'recall': 0.9385925, 'specificity': 0.9979433, 'f1': 0.946532, 'auroc': 0.9996942}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   479     0    0     0    2    0     0     0     0    1      1
1     0  1293    0     0    0    0     0    38     1    0      0
2     0     0  272     0   15    2     1     2     2   16      2
3     0     0    0  8319    0   13     0    78    29    0      1
4     4     0    3     0  427    2     0     1     4    3     95
5     0     0    0     4    0  513     0     0     1    2      1
6     5     0    0     0    0    1  1894     2     0    0      6
7     1     4    0    59    0    0     1  7175    17    0      8
8     0     1    1    48    4    1     0    37  3184    0     20
9     1     0   10     5    0   88     0     0     0  387      2
10    7     0    0     6   10    2     1     2    17    0  12751
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6762751, 'precision': 0.6449041, 'recall': 0.5784348, 'specificity': 0.9677842, 'f1': 0.5572378, 'auroc': 0.8747225}
confusion matrix:
     0    1   2    3    4    5     6     7     8    9     10
0   958    0   0   31    1   23    19   118     8    9     3
1     0  946   0   30    1    0     2   486     4    0    30
2    14    0  80   23  195   37    15   127   314   49   161
3     0    0   0    0    0    0     0     0     0    0     0
4     2    0   0    0  290    0     2     3    39    0  1297
5     4    0   2   98    1  416     1     2     8   60     0
6    14    0   0   58    2    0  2790     3    43    0   157
7     2    0   1   54    0    0     0  1104     0    0     3
8     0    0   0  161    1    2     9    38  1155    3     1
9     9    0  54  187    6  216     5   188   147  301    24
10    0    0   0    0   18    0     1     1     0    0  1626
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_19.png
better model found
persisted
after epoch: 19,now: 2024-07-07 23:45:39.035750,epoch time: 0:43:48.173552,used: 12:51:02.675107,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9791845, 'precision': 0.9366531, 'recall': 0.95323956, 'specificity': 0.9977975, 'f1': 0.9446486, 'auroc': 0.99960315}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     1    2    0     1     0     0    1      4
1     0  1315    0     0    0    0     0    16     0    0      1
2     0     0  264     0    3    0     0     0     0   44      1
3     1     1    5  8132    0   19     5   208    64    2      0
4     6     0   26     0  474    0     1     1     2    3     26
5     0     0    0     2    1  499     0     0     1   18      0
6     4     0    0     0    0    0  1899     1     0    0      4
7     0     5    2    24    0    0     1  7196    24    4      7
8     1     0   18    15   11    8     1    23  3183    5     31
9     0     0    7     0    1   27     2     0     0  455      0
10   11     0    5     6   52    0     4     5     3    0  12707
---- Validation: 
scalar performance:
{'acc': 0.97969776, 'precision': 0.9369973, 'recall': 0.9547452, 'specificity': 0.9978605, 'f1': 0.9455528, 'auroc': 0.99967915}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     0    2    0     3     0     0    3      3
1     0  1321    0     0    0    0     0    10     0    0      1
2     0     0  265     0    3    0     1     0     1   41      1
3     1     4    3  8132    0   28     6   214    50    2      0
4     3     0   26     0  478    0     2     1     2    3     24
5     0     0    2     2    1  495     1     0     1   19      0
6     5     2    0     0    0    0  1896     2     1    0      2
7     0     1    4    18    0    0     1  7221    13    1      6
8     1     1   12    14   20    6     2    32  3176    4     28
9     0     0    8     0    1   21     0     0     0  463      0
10   14     0    3     4   54    0     5     6     3    0  12707
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7584832, 'precision': 0.6850852, 'recall': 0.6425115, 'specificity': 0.975649, 'f1': 0.64802563, 'auroc': 0.88405246}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   919     0    6  35    7    1    68    84     2   33    15
1     0  1054    2  11    1    2     4   338    22   21    44
2     5     0  360   1  355    8     6    28    41   81   130
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    6   0  614    0     1     3     2    0  1007
5     2     0   18  25   17  277     4     3     2  244     0
6     0     0    1   1    2    0  3046     1     1    1    14
7     0     0    2  26    0    0     4  1119     6    4     3
8     1     0   21  21   41   16    15    20  1206   19    10
9     5     0  258  20   19   87     1    43    19  666    19
10    0     0    0   0   65    0     1     0     0    0  1580
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_20.png
new oracle model saved
early stop counter: 1
val acc:0.9796977639198303, best validation acc: 0.9815166592597961, corresponding to test acc:                         0.6762750744819641 / 0.7584831714630127
after epoch: 20,now: 2024-07-08 00:30:28.811177,epoch time: 0:44:49.775427,used: 13:35:52.450534,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98194027, 'precision': 0.95933175, 'recall': 0.94978213, 'specificity': 0.99798596, 'f1': 0.9528943, 'auroc': 0.99972534}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     2    1    0     2     0     0    1      8
1     0  1328    0     0    0    0     0     4     0    0      0
2     1     0  304     0    1    0     0     2     0    2      2
3     0     5    0  8338    0    0     0    82    10    1      1
4     5     0   12     1  457    0     0     5     1    1     57
5     0     0    1    10    0  491     0     0     1   18      0
6     0     0    0     0    0    0  1901     1     1    0      5
7     0    17    0    51    0    0     1  7189     4    0      3
8     0     2    2    99    7    0     4    94  3067    1     20
9     1     0   62     5    0   20     2     1     0  400      1
10    0     1    1     4   13    0     5     6     4    0  12758
---- Validation: 
scalar performance:
{'acc': 0.9820784, 'precision': 0.9580501, 'recall': 0.9501123, 'specificity': 0.99800825, 'f1': 0.95280886, 'auroc': 0.9997171}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   471     0    0     1    2    0     3     0     1    0      5
1     0  1326    0     0    0    0     0     5     0    0      1
2     0     0  299     1    2    2     1     1     1    3      2
3     0     2    2  8358    0    0     0    69     9    0      0
4     4     0    9     0  457    1     0     3     3    0     62
5     0     0    0    17    0  486     0     0     1   16      1
6     1     0    0     1    0    1  1901     1     1    0      2
7     0    22    1    58    0    0     1  7174     4    1      4
8     0     4    3   107    8    1     2    82  3075    1     13
9     0     0   60     2    0   15     2     0     0  413      1
10    3     1    0     4   21    0     3     7     1    1  12755
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7258798, 'precision': 0.6591071, 'recall': 0.6104965, 'specificity': 0.97224295, 'f1': 0.6127974, 'auroc': 0.8787521}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   906     2    0  21    0    1   126    73     7    8    26
1     0  1213    2  12    1    0     4   231     5    9    22
2     3     0  314   3  267   12    19    75    44   41   237
3     0     0    0   0    0    0     0     0     0    0     0
4     1     0    2   0  334    0     4     2     4    0  1286
5     7     0    9  43    7  277    33     2     2  210     2
6     0     0    2   2    0    0  3001     4     0    0    58
7     1     2    3  79    0    1     5  1068     0    3     2
8     0     0   22  48   31   11    59    32  1145    9    13
9     8     1  285  49   10  135    11    81    39  486    32
10    0     0    0   0   13    0     2     0     0    0  1631
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_21.png
better model found
persisted
after epoch: 21,now: 2024-07-08 01:13:12.033270,epoch time: 0:42:43.222093,used: 14:18:35.672627,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9855255, 'precision': 0.9616546, 'recall': 0.960392, 'specificity': 0.9984379, 'f1': 0.960482, 'auroc': 0.9997957}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    2    1     0     1     0    0      2
1     0  1319    0     1    0    0     0    12     0    0      0
2     0     1  262     0    5    1     0     2     0   40      1
3     2     0    0  8366    0    2     0    56     9    3      0
4     7     0    8     0  493    1     0     1     8    1     20
5     0     0    1     6    0  495     0     0     1   17      0
6     6     0    0     1    0    1  1881     2     1    2     12
7     0     5    0    60    0    0     0  7195     0    1      3
8     1     1    2    65    6    1     0    55  3157    2      6
9     1     0    1     0    0   18     0     0     0  473      0
10   10     3    2     3   36    0     1     6    15    0  12717
---- Validation: 
scalar performance:
{'acc': 0.9858232, 'precision': 0.9630142, 'recall': 0.95927864, 'specificity': 0.9984726, 'f1': 0.96035606, 'auroc': 0.99981415}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     1    1    1     0     1     0    1      1
1     0  1320    0     0    0    0     0    12     0    0      0
2     0     1  254     0    8    0     0     0     0   49      0
3     0     0    0  8374    0    0     0    53    12    1      0
4     6     0    8     0  489    0     0     1     7    1     27
5     0     0    0     4    0  500     0     0     1   16      0
6     7     0    0     1    0    1  1886     4     1    0      8
7     1     6    0    52    0    0     1  7197     5    0      3
8     0     0    2    64    6    1     0    41  3172    3      7
9     0     0    2     0    1   14     0     0     0  476      0
10   10     2    0     3   33    0     2    14    21    1  12710
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.71013784, 'precision': 0.6666862, 'recall': 0.6052742, 'specificity': 0.9710454, 'f1': 0.5887079, 'auroc': 0.87606347}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   927     2   0   65    1   11    32    91    10   28     3
1     0  1281   0   24    1    0     0   174     8    1    10
2    20     4  94   24  179   38     8    79   294   81   194
3     0     0   0    0    0    0     0     0     0    0     0
4     2     3   3    0  239    0     2     3    32    0  1349
5     3     0   1  117    0  349     1     2    13  106     0
6     5     1   1   18    1    0  2802     4    29    0   206
7     1     3   0   53    0    1     0  1104     0    0     2
8     1     0   0   78    0    1     2    33  1245    5     5
9    12     4  32  154    7  191     3    92   135  480    27
10    0     1   0    0   16    0     0     0     0    0  1629
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_22.png
better model found
persisted
after epoch: 22,now: 2024-07-08 01:52:01.248895,epoch time: 0:38:49.215625,used: 14:57:24.888252,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98274297, 'precision': 0.957813, 'recall': 0.93249, 'specificity': 0.9981178, 'f1': 0.9422972, 'auroc': 0.9997562}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   462     0    0     2    5    2     3     1     1    0      7
1     0  1316    0     0    0    0     0    14     2    0      0
2     0     0  259     0   24    2     0    12     6    8      1
3     0     4    0  8314    0    2     1    88    29    0      0
4     3     0    1     0  449    1     1     1     7    0     76
5     0     0    0     1    0  516     0     1     1    2      0
6     1     0    0     1    0    2  1895     0     1    0      8
7     0     6    0    46    0    0     0  7197    13    0      2
8     0     0    0    31    3    0     0    35  3220    0      6
9     0     0   23     3    2  102     0     7     3  353      0
10    0     1    1     3    8    0     2     8    18    0  12750
---- Validation: 
scalar performance:
{'acc': 0.9832553, 'precision': 0.95899856, 'recall': 0.93923295, 'specificity': 0.9981786, 'f1': 0.94628423, 'auroc': 0.99974793}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    0     1    4    0     1     1     0    0      8
1     0  1321    0     1    0    0     0    10     0    0      0
2     0     0  270     1   19    2     0     9     2    8      1
3     0     3    0  8311    0    1     0   102    23    0      0
4     0     0    2     0  463    0     0     2     6    0     66
5     0     0    0     1    0  517     0     0     2    1      0
6     2     0    0     0    0    0  1902     0     0    0      4
7     0     5    0    40    0    0     0  7203    13    0      4
8     0     0    0    28    3    2     0    41  3216    0      6
9     0     0   23     3    0  109     0     4     4  350      0
10    3     0    2     3   10    0     3    12    25    0  12738
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67802423, 'precision': 0.6244999, 'recall': 0.5759362, 'specificity': 0.9677804, 'f1': 0.5367499, 'auroc': 0.86855006}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   700     1    2   44    9   87   169    60     9   58    31
1     0  1128    0   37    1    0     0   284    16    0    33
2     1     0  110   21  176   66    12    86   353   32   158
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    1    0   89    0     5     3    33    0  1502
5     0     0    1   61    0  498     0     2     7   23     0
6     0     0    0    7    0    0  3012     2     3    0    43
7     0     0    0   98    0    1     1  1062     1    0     1
8     0     0    0   89    0    9     2    16  1253    0     1
9     4     0   40  161    7  417     3   111   164  199    31
10    0     0    0    0    2    0     3     1     0    0  1640
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_23.png
early stop counter: 1
val acc:0.9832553267478943, best validation acc: 0.9858232140541077, corresponding to test acc:                         0.7101378440856934 / 0.7584831714630127
after epoch: 23,now: 2024-07-08 02:31:05.522229,epoch time: 0:39:04.273334,used: 15:36:29.161586,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9839469, 'precision': 0.96817875, 'recall': 0.95254886, 'specificity': 0.99819386, 'f1': 0.9590624, 'auroc': 0.9998104}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    1    0     0     1     0    0      3
1     0  1318    0     4    0    0     0    10     0    0      0
2     2     0  287     0    5    0     0     0     0   14      3
3     0     0    0  8302    0    2     1   101    30    1      0
4     8     0    9     0  438    0     0     0     7    1     76
5     1     0    0    15    0  449     0     0     3   52      1
6     8     0    0     0    0    0  1881     0     1    0     18
7     1     6    1    41    1    0     0  7193    12    0      8
8     2     3    0    59    0    1     0    34  3184    2     11
9     0     0    2     3    0    5     0     0     0  482      1
10    7     0    0     1   10    0     2     2     7    0  12764
---- Validation: 
scalar performance:
{'acc': 0.9847265, 'precision': 0.96848947, 'recall': 0.9513358, 'specificity': 0.9982826, 'f1': 0.9587964, 'auroc': 0.99982107}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     0    0     0    1    0     2     2     1    1      7
1     0  1322    0     2    0    0     0     8     0    0      0
2     1     0  291     0    4    0     0     1     1   13      1
3     2     0    0  8313    0    0     0    96    28    0      1
4     7     0    8     0  435    0     0     0     7    2     80
5     1     0    1    24    0  453     0     0     1   40      1
6     8     1    1     2    0    0  1885     0     2    3      6
7     0     4    1    33    2    0     0  7203    15    1      6
8     1     2    1    51    1    2     0    28  3197    1     12
9     1     0    7     1    0    8     1     0     1  473      1
10    4     0    0     4    6    0     1     3     5    0  12773
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.62520117, 'precision': 0.64315486, 'recall': 0.52304214, 'specificity': 0.9628936, 'f1': 0.52420866, 'auroc': 0.86357975}
confusion matrix:
     0     1    2    3   4    5     6     7     8    9     10
0   885     0    0   84   1    0    71    72     7   13    37
1     0  1109    0   46   1    0     2   290     8    0    43
2     9     0  116   79  68   17     3    49   301   62   311
3     0     0    0    0   0    0     0     0     0    0     0
4     1     0    1    0  68    0     1     2    23    0  1537
5     5     0    3  248   1  203     0     0     3  124     5
6     3     0    1   66   0    0  2495     3     8    0   491
7     1     0    0  133   0    0     1  1024     3    0     2
8     0     0    0  280   0    1     3    20  1061    1     4
9     9     0   60  422   3   98     1    63   107  334    40
10    0     0    0    0   4    0     1     0     0    0  1641
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_24.png
early stop counter: 2
val acc:0.9847264885902405, best validation acc: 0.9858232140541077, corresponding to test acc:                         0.7101378440856934 / 0.7584831714630127
after epoch: 24,now: 2024-07-08 03:09:53.767614,epoch time: 0:38:48.245385,used: 16:15:17.406971,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98713076, 'precision': 0.96274775, 'recall': 0.9710786, 'specificity': 0.99864936, 'f1': 0.966587, 'auroc': 0.99986076}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    4    0     4     1     0    0      4
1     0  1317    0     0    0    0     0    14     0    0      0
2     0     0  286     0   11    0     2     0     1    9      3
3     2     2    1  8323    0   16     0    59    34    1      1
4     2     0    1     0  514    0     0     0     2    1     19
5     0     0    1     2    0  509     1     0     0    8      0
6     2     0    0     1    0    0  1903     0     0    0      2
7     1     3    1    32    1    0     1  7197    21    2      6
8     0     0    1    25    1    0     1    16  3240    1      9
9     0     0   15     1    0   20     1     0     1  454      0
10    4     0    0     1   70    0    20     2    13    0  12682
---- Validation: 
scalar performance:
{'acc': 0.9880701, 'precision': 0.9671396, 'recall': 0.97654676, 'specificity': 0.9987508, 'f1': 0.97148764, 'auroc': 0.9998622}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    5    0     2     0     0    0      6
1     0  1317    0     0    0    0     0    14     0    0      1
2     0     0  292     0    8    1     1     0     0    8      2
3     2     0    0  8319    0   15     1    71    32    0      0
4     1     0    3     0  523    0     0     0     2    0     10
5     0     0    1     0    1  508     0     0     0   10      1
6     2     0    0     0    0    0  1905     0     1    0      0
7     1     2    0    35    1    0     1  7197    25    0      3
8     1     0    1    21    5    0     2    12  3246    2      6
9     0     0   10     2    0   13     0     0     0  467      1
10    1     1    0     2   67    0    13     3    14    0  12695
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7460995, 'precision': 0.66658676, 'recall': 0.6313671, 'specificity': 0.9745563, 'f1': 0.6298273, 'auroc': 0.88226026}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1009     0    1   35    2   14    56    12     3   31     7
1      1  1123    0   42    9    3     5   277    17    5    17
2      4     0  212   12  284   16    17    47   166   85   172
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    1    0  548    0    24     1    21    0  1037
5      4     0    3   43    0  348     2     0     4  188     0
6      2     0    0    5    1    0  3049     1     1    0     8
7      0     1    1  118    0    1     2  1030     7    0     4
8      1     0    2   48    3   16     8    10  1276    3     3
9      5     0  179   61   15  198     3    48   108  492    28
10     0     0    0    0   66    0     3     0     0    0  1577
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_25.png
better model found
persisted
after epoch: 25,now: 2024-07-08 03:48:20.799240,epoch time: 0:38:27.031626,used: 16:53:44.438597,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9854452, 'precision': 0.9622306, 'recall': 0.9568418, 'specificity': 0.9984082, 'f1': 0.9588719, 'auroc': 0.99978}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     0    4    0     1     0     0    0      3
1     0  1321    0     1    0    0     0     9     0    0      1
2     1     0  290     0   14    0     0     1     3    0      3
3     0     1    0  8345    0    0     2    46    41    0      2
4     3     0    2     0  495    0     0     0     3    0     36
5     0     0    0    15    0  481     0     0     6   18      1
6     5     0    0     1    0    0  1899     1     0    0      2
7     0    10    1    63    0    0     1  7154    29    1      5
8     1     5    1    30    2    0     1    24  3198    0     33
9     0     0   54     4    8   10     0     1     1  415      0
10    5     0    1     2   13    0     2     3     7    0  12759
---- Validation: 
scalar performance:
{'acc': 0.9867594, 'precision': 0.96568024, 'recall': 0.960454, 'specificity': 0.99854875, 'f1': 0.9624218, 'auroc': 0.9998267}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   476     1    0     1    4    0     0     0     0    0      1
1     0  1321    0     3    0    0     0     8     0    0      0
2     0     0  297     0   10    0     0     1     1    1      2
3     1     2    0  8343    0    0     0    46    47    0      1
4     3     0    4     0  494    0     0     0     6    0     32
5     0     0    0    18    0  478     0     0     4   20      1
6     8     0    0     2    0    0  1894     1     0    0      3
7     0     8    2    59    1    0     1  7166    15    0     13
8     1     1    1    22    2    0     0    18  3232    0     19
9     1     0   46     6    5    9     0     0     1  422      3
10    4     0    1     3    8    0     1     9     3    0  12767
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69341636, 'precision': 0.636998, 'recall': 0.5634976, 'specificity': 0.9695345, 'f1': 0.55783963, 'auroc': 0.8716472}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   982     0    2   85    2    2    23   55     3    4    12
1     1  1212    0   34    2    0     0  203    13    0    34
2    10     0   96   36  277    9     8   52   318   32   177
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    0    0  198    0     6    2    33    0  1394
5     5     0    5  219   10  158     0    0    17  173     5
6     0     0    0   31    0    0  3011    3     6    0    16
7     0     0    1  159    0    0     0  999     1    0     4
8     0     0    0   84    0    0     4   10  1268    2     2
9     7     1  105  237   33   53     4   81   226  350    40
10    0     0    0    0    6    0     2    1     0    0  1637
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_26.png
early stop counter: 1
val acc:0.9867594242095947, best validation acc: 0.9880700707435608, corresponding to test acc:                         0.7460994720458984 / 0.7584831714630127
after epoch: 26,now: 2024-07-08 04:26:46.866928,epoch time: 0:38:26.067688,used: 17:32:10.506285,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9783819, 'precision': 0.9663601, 'recall': 0.94459355, 'specificity': 0.997575, 'f1': 0.95405126, 'auroc': 0.99977005}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   437     0    0     3    3    0     2     2     1    1     34
1     0  1320    0     2    0    0     0     8     1    0      0
2     1     0  278     0    4    0     0     1     0   27      1
3     0     0    0  8028    0   11     0   272   123    4      1
4     3     0    6     1  438    0     1     1     4    5     80
5     0     0    1     6    0  475     0     0     1   36      2
6     3     0    0     3    0    0  1877     1     1    1     22
7     0    13    0     8    0    0     0  7224    14    1      3
8     0     0    1     2    1    1     2    26  3239    1     23
9     0     0    1     2    0    9     0     0     2  477      2
10    1     0    1     2    1    0     0     4     6    1  12775
---- Validation: 
scalar performance:
{'acc': 0.97868127, 'precision': 0.9673787, 'recall': 0.9431072, 'specificity': 0.99760115, 'f1': 0.9538003, 'auroc': 0.9997512}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   433     0    0     3    1    0     3     7     1    0     35
1     0  1324    0     3    0    0     0     4     1    0      0
2     1     0  270     0    6    0     0     1     1   32      1
3     0     1    0  8059    0    4     0   284    92    0      0
4     2     0   10     0  442    0     0     1     7    1     76
5     0     0    0     4    0  477     0     0     3   36      1
6     3     0    0     3    0    0  1873     4     4    2     19
7     0    11    1    13    0    0     0  7221    14    1      4
8     0     2    0     7    2    0     0    28  3230    2     25
9     0     0    1     2    0    9     0     0     1  480      0
10    0     0    1     3    3    0     1     1     8    0  12779
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7108375, 'precision': 0.6571264, 'recall': 0.59207654, 'specificity': 0.9708344, 'f1': 0.57012045, 'auroc': 0.8650537}
confusion matrix:
     0     1    2   3   4    5     6     7     8    9     10
0   847     0    0  39   0    2    21   160    32   19    50
1     0  1262    0  15   0    0     9   160    19    3    31
2    12     0  114   1  67    5     3    48   290   79   396
3     0     0    0   0   0    0     0     0     0    0     0
4     0     0    0   0  50    0     2     2    23    0  1556
5    12     0    1  78   1  223     1     1    28  236    11
6     0     0    0   1   0    0  2976     2     5    0    83
7     0     0    0  44   0    0     0  1111     4    1     4
8     0     0    0  20   0    0     3    22  1314    4     7
9    15     0   63  44   4   55     0    75   206  620    55
10    0     0    0   0   2    0     1     0     0    0  1643
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_27.png
early stop counter: 2
val acc:0.9786812663078308, best validation acc: 0.9880700707435608, corresponding to test acc:                         0.7460994720458984 / 0.7584831714630127
after epoch: 27,now: 2024-07-08 05:04:36.960324,epoch time: 0:37:50.093396,used: 18:10:00.599681,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98547196, 'precision': 0.97680044, 'recall': 0.95025414, 'specificity': 0.99837273, 'f1': 0.9625182, 'auroc': 0.9997991}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     0    3    0     1     4     2    0     17
1     0  1252    0     0    0    0     0    79     1    0      0
2     2     0  281     0    5    0     1     6     4   12      1
3     0     2    0  8341    0    0     0    69    26    0      0
4     2     0    4     0  481    0     1     4     9    1     37
5     0     0    0    27    1  445     0     1     5   41      1
6     1     0    0     1    1    0  1877     7     3    1     17
7     0     0    0    22    0    0     0  7234     5    0      1
8     0     0    0    21    2    0     0    34  3232    0      7
9     0     0    2     0    0    4     0     4     2  481      0
10    0     0    1     3    8    0     0    18     9    0  12753
---- Validation: 
scalar performance:
{'acc': 0.98392403, 'precision': 0.97195303, 'recall': 0.94448787, 'specificity': 0.99820393, 'f1': 0.9569715, 'auroc': 0.99983513}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     2    4    0     1     3     1    0     16
1     0  1247    0     0    0    0     0    84     1    0      0
2     1     0  280     1    7    0     1     8     0   13      1
3     0     1    0  8330    0    0     0    80    29    0      0
4     3     0    9     0  472    0     0     4    11    1     39
5     0     0    1    27    0  433     0     0     6   54      0
6     1     0    1     0    0    0  1883     6     2    0     15
7     0     1    0    23    0    0     0  7235     4    0      2
8     0     0    0    19    1    0     0    43  3220    0     13
9     0     0    4     1    0    3     0     8     3  474      0
10    1     0    1     4    6    0     0    24     6    0  12754
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65878403, 'precision': 0.6404207, 'recall': 0.53444386, 'specificity': 0.9656664, 'f1': 0.51256526, 'auroc': 0.8698442}
confusion matrix:
     0    1   2    3    4    5     6     7     8    9     10
0   778    0   2   29    0    1   135   143    22   25    35
1     0  926   0   21    2    0     1   526     6    0    17
2     6    0  98   17   72    3    14   165   368   43   229
3     0    0   0    0    0    0     0     0     0    0     0
4     0    0   0    0  136    0     6     8    33    0  1450
5     3    0   9  128    2  142     4     2    53  244     5
6     2    0   0    6    0    0  2923    10     8    0   118
7     0    0   0   36    0    0     0  1126     1    0     1
8     0    0   0   52    0    0     3    45  1266    1     3
9     7    1  54  116    5   37    12   206   291  383    25
10    0    0   0    0    6    0     2     0     0    0  1638
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_28.png
early stop counter: 3
val acc:0.9839240312576294, best validation acc: 0.9880700707435608, corresponding to test acc:                         0.7460994720458984 / 0.7584831714630127
after epoch: 28,now: 2024-07-08 05:42:51.215292,epoch time: 0:38:14.254968,used: 18:48:14.854649,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98547196, 'precision': 0.97054446, 'recall': 0.9686042, 'specificity': 0.9984487, 'f1': 0.9692666, 'auroc': 0.9998821}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     1    0     0    0    1     0     0     1    1      7
1     0  1331    0     0    0    0     0     0     0    0      0
2     0     0  290     0   16    0     0     1     1    4      0
3     2     8    0  8213    0   23     0   103    89    2      0
4     5     0    1     0  477    0     0     0    10    1     45
5     0     0    0     1    0  511     0     0     0    9      0
6     2     0    0     0    0    0  1897     0     0    0      9
7     1    18    0    28    0    0     1  7138    72    0      5
8     0     0    0     4    0    0     2     6  3280    0      4
9     0     0   16     0    0   13     0     1     0  463      0
10    1     0    1     1    2    0     3     2    19    0  12761
---- Validation: 
scalar performance:
{'acc': 0.9850742, 'precision': 0.9679515, 'recall': 0.965726, 'specificity': 0.99841404, 'f1': 0.9665133, 'auroc': 0.999862}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    1    0     1     0     0    2      6
1     0  1331    0     0    0    0     0     1     0    0      0
2     1     0  281     0   22    0     0     0     2    4      2
3     0    11    0  8207    0   28     0   102    90    2      0
4     4     0    0     0  477    0     0     1    12    0     45
5     0     0    0     0    0  511     0     0     3    7      0
6     2     0    0     1    0    0  1899     0     0    0      6
7     0    29    0    28    1    0     0  7143    59    1      4
8     0     0    0     2    0    0     0     1  3286    0      7
9     1     0   14     0    1   13     0     2     1  460      1
10    4     0    1     2    5    0     5     3    17    0  12759
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6757154, 'precision': 0.5961902, 'recall': 0.55965376, 'specificity': 0.9672363, 'f1': 0.5305361, 'auroc': 0.8606638}
confusion matrix:
     0     1    2   3   4    5     6     7     8    9     10
0   869     0    4  32   1    4    69    78    26   34    53
1     2  1178    0   9   0    0     2   256    27    0    25
2     6     0   99   3  60   10     4    53   427   26   327
3     0     0    0   0   0    0     0     0     0    0     0
4     0     0    0   0  26    0     1     1    41    0  1564
5     1     0   14  71   2  214     5     5    37  234     9
6     3     0    1   1   0    0  2850     2     3    0   207
7     2     0    0  13   0    0     2  1138     5    0     4
8     1     0    0  25   0    0     4    26  1312    1     1
9     6     1  129  50   5   64     4   132   362  331    53
10    0     0    0   0   2    0     3     0     0    0  1641
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_29.png
early stop counter: 4
val acc:0.9850742220878601, best validation acc: 0.9880700707435608, corresponding to test acc:                         0.7460994720458984 / 0.7584831714630127
after epoch: 29,now: 2024-07-08 06:21:08.010788,epoch time: 0:38:16.795496,used: 19:26:31.650145,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98852205, 'precision': 0.9678382, 'recall': 0.96868765, 'specificity': 0.9987726, 'f1': 0.9675213, 'auroc': 0.99989367}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    1     0    5    0     5     0     1    0     15
1     0  1315    0     3    0    0     0    10     2    0      2
2     0     0  271     0    9    1     0     0     0   31      0
3     0     0    0  8389    1   10     1    20    12    2      0
4     1     0    1     0  531    0     0     0     1    1      4
5     0     0    0     1    0  512     0     0     1    7      0
6     0     0    0     1    3    0  1891     1     4    0      8
7     0     0    2    80    1    0     0  7153    20    3      5
8     0     0    0    31    7    2     1     8  3233    1     12
9     0     0    2     1    0   26     0     0     0  464      0
10    0     0    1     1   50    0     1     2     7    0  12733
---- Validation: 
scalar performance:
{'acc': 0.98734784, 'precision': 0.964623, 'recall': 0.9659272, 'specificity': 0.99864256, 'f1': 0.9645581, 'auroc': 0.999876}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     0    7    0     7     0     0    1     15
1     0  1313    0     1    0    0     0    14     1    0      3
2     0     0  277     0    8    0     1     0     0   26      0
3     0     0    0  8391    0    9     0    18    20    2      0
4     1     0    2     0  524    0     0     1     0    0     11
5     0     0    0     0    0  510     0     0     0   11      0
6     2     0    0     0    3    1  1884     0     3    0     15
7     0     0    1    77    0    0     1  7154    25    1      6
8     1     0    0    25   11    3     1    13  3227    0     15
9     0     0    2     0    1   34     1     0     0  455      0
10    0     0    1     4   59    0     1     3     4    0  12724
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69047785, 'precision': 0.64237106, 'recall': 0.591343, 'specificity': 0.96879804, 'f1': 0.5802303, 'auroc': 0.87378305}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   794     0    2  24   20    8   187    52    19   39    25
1     2  1025    1  32    1    1     3   310    55    7    62
2     0     0  193   7  280   32     6    34   255   50   158
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    2   0  350    0     1     2    15    0  1263
5     0     0    4  57   10  402     2     0    15  100     2
6     7     0    2   3    2    0  2774     2    21    0   256
7     0     0    0  92    0    2     4  1049    12    1     4
8     0     0    1  49    3    6     3     6  1298    0     4
9     3     0  115  86   19  294     4    45   176  369    26
10    0     0    0   0   31    0     0     0     0    0  1615
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_30.png
early stop counter: 5
val acc:0.9873478412628174, best validation acc: 0.9880700707435608, corresponding to test acc:                         0.7460994720458984 / 0.7584831714630127
after epoch: 30,now: 2024-07-08 07:01:37.891367,epoch time: 0:40:29.880579,used: 20:07:01.530724,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 20:07:01.530724 at 2024-07-08 07:01:37.891367
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7460995, 'precision': 0.66658676, 'recall': 0.6313671, 'specificity': 0.9745563, 'f1': 0.6298273, 'auroc': 0.88226026}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1009     0    1   35    2   14    56    12     3   31     7
1      1  1123    0   42    9    3     5   277    17    5    17
2      4     0  212   12  284   16    17    47   166   85   172
3      0     0    0    0    0    0     0     0     0    0     0
4      1     0    1    0  548    0    24     1    21    0  1037
5      4     0    3   43    0  348     2     0     4  188     0
6      2     0    0    5    1    0  3049     1     1    0     8
7      0     1    1  118    0    1     2  1030     7    0     4
8      1     0    2   48    3   16     8    10  1276    3     3
9      5     0  179   61   15  198     3    48   108  492    28
10     0     0    0    0   66    0     3     0     0    0  1577
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7584832, 'precision': 0.6850852, 'recall': 0.6425115, 'specificity': 0.975649, 'f1': 0.64802563, 'auroc': 0.88405246}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   919     0    6  35    7    1    68    84     2   33    15
1     0  1054    2  11    1    2     4   338    22   21    44
2     5     0  360   1  355    8     6    28    41   81   130
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    6   0  614    0     1     3     2    0  1007
5     2     0   18  25   17  277     4     3     2  244     0
6     0     0    1   1    2    0  3046     1     1    1    14
7     0     0    2  26    0    0     4  1119     6    4     3
8     1     0   21  21   41   16    15    20  1206   19    10
9     5     0  258  20   19   87     1    43    19  666    19
10    0     0    0   0   65    0     1     0     0    0  1580
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_07_10_54_36_seed_0_21716731_instance_wise_predictions.txt
accuracy from prediction file 0.7460994892604772
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/4.csv
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 458977 KiB |   6809 MiB |   1465 TiB |   1465 TiB |
|       from large pool | 415725 KiB |   6773 MiB |   1447 TiB |   1447 TiB |
|       from small pool |  43251 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 458977 KiB |   6809 MiB |   1465 TiB |   1465 TiB |
|       from large pool | 415725 KiB |   6773 MiB |   1447 TiB |   1447 TiB |
|       from small pool |  43251 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 449054 KiB |   6803 MiB |   1464 TiB |   1464 TiB |
|       from large pool | 407075 KiB |   6767 MiB |   1446 TiB |   1446 TiB |
|       from small pool |  41979 KiB |     60 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7500 MiB |   7500 MiB |   7500 MiB |      0 B   |
|       from large pool |   7436 MiB |   7436 MiB |   7436 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 433951 KiB | 703689 KiB |   1098 TiB |   1098 TiB |
|       from large pool | 428050 KiB | 694392 KiB |   1080 TiB |   1080 TiB |
|       from small pool |   5900 KiB |  14742 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4556    |    6799    |  244114 K  |  244109 K  |
|       from large pool |     187    |     783    |  135415 K  |  135414 K  |
|       from small pool |    4369    |    6537    |  108699 K  |  108694 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4556    |    6799    |  244114 K  |  244109 K  |
|       from large pool |     187    |     783    |  135415 K  |  135414 K  |
|       from small pool |    4369    |    6537    |  108699 K  |  108694 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     342    |     342    |     342    |       0    |
|       from large pool |     310    |     310    |     310    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      61    |    1476    |  147457 K  |  147457 K  |
|       from large pool |      37    |     309    |   91243 K  |   91243 K  |
|       from small pool |      24    |    1439    |   56213 K  |   56213 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6809 MiB |   1465 TiB |   1465 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   1447 TiB |   1447 TiB |
|       from small pool |      0 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6809 MiB |   1465 TiB |   1465 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   1447 TiB |   1447 TiB |
|       from small pool |      0 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6803 MiB |   1464 TiB |   1464 TiB |
|       from large pool |  16640 KiB |   6767 MiB |   1446 TiB |   1446 TiB |
|       from small pool |      0 KiB |     60 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    872 MiB |   7500 MiB |   7500 MiB |   6628 MiB |
|       from large pool |    824 MiB |   7436 MiB |   7436 MiB |   6612 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 703689 KiB |   1098 TiB |   1098 TiB |
|       from large pool |  24320 KiB | 694392 KiB |   1080 TiB |   1080 TiB |
|       from small pool |      0 KiB |  40275 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6799    |  244114 K  |  244114 K  |
|       from large pool |       2    |     783    |  135415 K  |  135415 K  |
|       from small pool |       0    |    6537    |  108699 K  |  108699 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6799    |  244114 K  |  244114 K  |
|       from large pool |       2    |     783    |  135415 K  |  135415 K  |
|       from small pool |       0    |    6537    |  108699 K  |  108699 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     342    |     342    |     281    |
|       from large pool |      37    |     310    |     310    |     273    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1476    |  147458 K  |  147458 K  |
|       from large pool |       3    |     309    |   91243 K  |   91243 K  |
|       from small pool |       0    |    1439    |   56214 K  |   56214 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6809 MiB |   1465 TiB |   1465 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   1447 TiB |   1447 TiB |
|       from small pool |      0 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6809 MiB |   1465 TiB |   1465 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   1447 TiB |   1447 TiB |
|       from small pool |      0 KiB |     62 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6803 MiB |   1464 TiB |   1464 TiB |
|       from large pool |  16640 KiB |   6767 MiB |   1446 TiB |   1446 TiB |
|       from small pool |      0 KiB |     60 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    872 MiB |   7500 MiB |   7500 MiB |   6628 MiB |
|       from large pool |    824 MiB |   7436 MiB |   7436 MiB |   6612 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 703689 KiB |   1098 TiB |   1098 TiB |
|       from large pool |  24320 KiB | 694392 KiB |   1080 TiB |   1080 TiB |
|       from small pool |      0 KiB |  40275 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6799    |  244114 K  |  244114 K  |
|       from large pool |       2    |     783    |  135415 K  |  135415 K  |
|       from small pool |       0    |    6537    |  108699 K  |  108699 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6799    |  244114 K  |  244114 K  |
|       from large pool |       2    |     783    |  135415 K  |  135415 K  |
|       from small pool |       0    |    6537    |  108699 K  |  108699 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     342    |     342    |     281    |
|       from large pool |      37    |     310    |     310    |     273    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1476    |  147458 K  |  147458 K  |
|       from large pool |       3    |     309    |   91243 K  |   91243 K  |
|       from small pool |       0    |    1439    |   56214 K  |   56214 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731

 Experiment start at: 2024-07-08 07:19:56.268503
before training, model accuracy: 0.10312740504741669
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92315924, 'precision': 0.8093548, 'recall': 0.74856734, 'specificity': 0.9919057, 'f1': 0.7306982, 'auroc': 0.9933612}
confusion matrix:
     0     1   2     3    4   5     6     7     8    9      10
0   416     0   0     4    0   0     5     4     4   16     34
1     0  1281   0    10    0   0     1    31     6    0      3
2     2     1  84     1   12   0     3     9     9  189      2
3    14     5   0  7830    0   4     7   332   211   33      3
4     7     0  77     0  192   0     2     4    49   44    164
5     1     0   0    69    0  64     0     0     9  377      1
6    65     0   0     5    0   0  1767     2     8   14     46
7    10    74   4   149    2   0     6  6809   162   20     26
8     2     5   0   109    5   0     0    82  3041   20     31
9     1     0   1     4    0   0     0     4     5  477      1
10   39     4  21     7   48   0    11    20    89   11  12543
---- Validation: 
scalar performance:
{'acc': 0.922616, 'precision': 0.8074659, 'recall': 0.7458608, 'specificity': 0.9918929, 'f1': 0.7251236, 'auroc': 0.9933734}
confusion matrix:
     0     1   2     3    4   5     6     7     8    9      10
0   419     0   0     1    0   0     3     3     7   20     30
1     0  1280   0     8    0   0     1    35     5    2      1
2     1     1  83     1   10   0     1    11     6  195      3
3    17     4   0  7843    0   1     8   326   212   28      1
4     8     1  79     0  181   0     4     3    51   47    165
5     0     0   0    71    0  62     0     0     7  380      1
6    75     1   0     2    1   0  1760     1     7   22     39
7    12    82   2   145    1   0     6  6815   155   25     22
8     3     3   2   112    8   0     0    77  3049   14     28
9     2     1   3     7    0   1     0     2     3  474      0
10   54     7  20     6   39   0    12    15    99   18  12526
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6889386, 'precision': 0.6932374, 'recall': 0.5710726, 'specificity': 0.96859777, 'f1': 0.5199429, 'auroc': 0.8862914}
confusion matrix:
      0     1   2   3    4   5     6     7     8    9     10
0   1131     0   0   1    0   0     1     3     2   25     7
1      4  1299   0  21    0   0     1   143     2    1    28
2     57     2  25   1   78   0     0    76   316  197   263
3      0     0   0   0    0   0     0     0     0    0     0
4      2     0   0   0  122   0     1     2    13    1  1492
5     23     0   0  37    0   9     0     1    24  495     3
6     11     2   0   1    2   0  2512     4    27    0   508
7     43     0   0  25    0   0     0  1087     0    1     8
8     12     0   0  41    1   0     1    14  1287    9     5
9     57    13   5  22    1   0     0    88   192  731    28
10     0     0   0   0    2   0     0     0     0    0  1644
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-08 08:02:57.720999,epoch time: 0:43:01.452496,used: 0:43:01.452496,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9456336, 'precision': 0.8706644, 'recall': 0.8122277, 'specificity': 0.9939022, 'f1': 0.8305023, 'auroc': 0.99571717}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   411     0    0     5    1    0     7     4     0    3     52
1     0  1272    0    15    0    0     0    33     3    0      8
2     0     1  159     1   77    1     1     9     3   53      7
3     6     2    1  8090    1    7     2   193   122    5     10
4     2     0   11     1  273    0     1     0    11    8    232
5     0     0    1    41    3  254     0     0     9  211      1
6    14     0    1     6    2    0  1836     1     5    3     39
7     5    20    5   183    3    0     3  6943    60    3     37
8     1     0    1   104   18    0     1   100  2973    4     93
9     1     0   32     8    8   14     0     5     4  419      2
10   12     0    7     8   27    1     4     6    14    2  12714
---- Validation: 
scalar performance:
{'acc': 0.94535244, 'precision': 0.87541807, 'recall': 0.80953497, 'specificity': 0.9938495, 'f1': 0.8302379, 'auroc': 0.9958571}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   410     0    0     5    3    0     2     2     0    9     52
1     0  1266    0    15    0    0     0    38     3    0     10
2     2     0  161     1   70    1     1     8     6   58      4
3     3     1    1  8111    2    4     4   182   122    3      7
4     3     0    9     1  268    0     0     4    13    5    236
5     0     0    1    40    2  250     0     0     8  218      2
6    18     0    1     6    1    0  1832     1     4    3     42
7     1    19    6   201    2    0     2  6921    65    1     47
8     2     0    2   109   14    0     1    93  2980    4     91
9     3     1   28    11    9   15     0     6     5  414      1
10    6     0    1     8   28    0     4    11     8    1  12729
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.66815925, 'precision': 0.62693465, 'recall': 0.5542219, 'specificity': 0.9667534, 'f1': 0.5374607, 'auroc': 0.8693334}
confusion matrix:
      0     1   2    3    4    5     6     7     8    9     10
0   1037     0   0   43    4    0    26    11     4   29    16
1      1  1129   0   27    0    0     0   279     4    0    59
2      8     0  38   27  366    2     0    96   187   71   220
3      0     0   0    0    0    0     0     0     0    0     0
4      0     0   0    0   55    0     1     2    14    1  1560
5      5     0   0  161    6  167     0     0    27  224     2
6      0     0   0    2    2    0  2726     4    12    0   321
7      3     0   0   66    0    0     0  1088     0    0     7
8      1     0   0  110    1    0     0    20  1229    2     7
9     12     3  34  204   60   16     1   179   159  437    32
10     0     0   0    0    0    0     0     1     1    0  1644
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_2.png
better model found
persisted
after epoch: 2,now: 2024-07-08 08:44:13.730536,epoch time: 0:41:16.009537,used: 1:24:17.462033,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9484696, 'precision': 0.8703731, 'recall': 0.85469407, 'specificity': 0.99448353, 'f1': 0.85350275, 'auroc': 0.99718904}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   403     0    0     4    2    0    26     1     6    2     39
1     0  1299    0     6    0    0     0    23     3    0      1
2     0     1  271     0    5    1     3     4     3   24      0
3     2     2    0  7881    0   14     0   316   222    1      1
4     2     0  104     1  245    1     2     3    34    5    142
5     1     0    6    23    0  417     1     0    13   59      1
6    10     0    2     4    1    0  1873     5     3    0      9
7     1    43    9    95    1    0     1  7030    70    0     13
8     1     5    8    42    6    0     0    79  3114    0     41
9     0     0   89     7    2   60     1     1     9  323      1
10    7     1   33     6   49    0    44    13    40    4  12594
---- Validation: 
scalar performance:
{'acc': 0.94821453, 'precision': 0.8733133, 'recall': 0.85466933, 'specificity': 0.99446297, 'f1': 0.8535992, 'auroc': 0.9971182}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   399     0    0     3    2    0    26     1     3    3     46
1     0  1297    0     7    0    0     0    23     4    0      1
2     1     0  272     2    2    1     1     3     8   22      0
3     0     3    3  7880    0   11     0   320   222    1      0
4     2     0  112     1  254    1     3     1    33    3    129
5     1     0    7    21    0  421     0     0    15   55      1
6     4     0    1     2    0    0  1879     5     8    0      9
7     1    45   23    91    1    0     1  7009    73    0     21
8     1     2    6    40    7    1     0    76  3123    0     40
9     1     0   97    10    2   57     3     2     8  313      0
10    4     1   34     7   45    0    43    11    46    3  12602
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7343455, 'precision': 0.6797914, 'recall': 0.61987376, 'specificity': 0.973027, 'f1': 0.60008514, 'auroc': 0.88865405}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   938     1    0  22    2    1   161    14     7   19     5
1     0  1321    0  12    0    0     1   147     7    0    11
2     7     8  133   4  125    6    58    53   435   71   115
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    4   0  208    0     5     1    38    1  1376
5     1     0    0  77    0  355     7     0    45  106     1
6     0     1    0   0    0    0  3050     2    12    0     2
7     0     0    0   5    0    0     0  1157     1    0     1
8     0     0    0  22    0    2     2    18  1325    0     1
9     3    20   65  70    4   83     9    99   393  373    18
10    0     0    0   0    7    0     2     1     0    0  1636
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-08 09:25:33.528829,epoch time: 0:41:19.798293,used: 2:05:37.260326,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95119864, 'precision': 0.8806343, 'recall': 0.83917844, 'specificity': 0.9947437, 'f1': 0.85552377, 'auroc': 0.99715304}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   352     0    0     9    2    2    53     3     8   11     43
1     0  1242    0    11    0    0     2    62    10    0      5
2     0     0  216     2   10    0     1    11    14   57      1
3     0     0    1  8172    0    4     7   136   117    1      0
4     1     0   72     0  284    2     2    10    38   14    116
5     0     0    1    65    0  391     0     0    10   53      1
6     3     0    1     2    1    0  1885     1     4    1     10
7     0     6    3   200    0    0     2  6958    85    0      9
8     0     0    4    90    5    0     2    47  3138    1      7
9     0     0   31     9    1   67     0     6     8  371      0
10    2     0    4     7   65    0    51    27    88    6  12543
---- Validation: 
scalar performance:
{'acc': 0.9535375, 'precision': 0.8846094, 'recall': 0.84597886, 'specificity': 0.99498606, 'f1': 0.86044085, 'auroc': 0.9973228}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   363     0    0     2    2    1    46     6     2   12     49
1     0  1260    0     9    0    0     2    52     6    0      3
2     0     0  228     0    5    0     3     9    11   56      0
3     0     0    1  8182    0    6     3   132   114    2      0
4     1     0   81     0  281    2     3     6    36   10    119
5     0     0    1    57    0  398     1     0     8   55      1
6     2     0    1     5    1    0  1882     2     4    1     10
7     1     5    1   191    1    0     1  6970    88    0      7
8     0     0    4    83    7    0     3    60  3127    1     11
9     0     0   36    11    1   65     2     2     9  367      0
10    3     0    8     7   50    1    40    18    77    2  12590
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6932065, 'precision': 0.6733755, 'recall': 0.56552726, 'specificity': 0.9688751, 'f1': 0.5537487, 'auroc': 0.88400495}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   679     3   0   23    0    1   273    40     8  121    22
1     2  1084   0   17    0    0     5   334    11    0    46
2     1     1  80   13  144    1    57    83   381   90   164
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    0  279    0    15     2    31    1  1304
5     1     0   0  122    2  205     6     0    30  225     1
6     0     0   0    1    0    0  3051     2     5    0     8
7     0     0   0   13    0    0     1  1145     1    0     4
8     0     0   0   74    0    0     5    10  1280    1     0
9     1     3  35  121    4   21    14   119   311  477    31
10    0     0   0    0   12    0     6     0     0    0  1628
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_4.png
better model found
persisted
after epoch: 4,now: 2024-07-08 10:07:11.488263,epoch time: 0:41:37.959434,used: 2:47:15.219760,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95422196, 'precision': 0.90347207, 'recall': 0.85100037, 'specificity': 0.994977, 'f1': 0.87203556, 'auroc': 0.9978586}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   418     0    0     7    0    0    22     1     2    2     31
1     0  1234    0    17    0    0     3    64    10    0      3
2     0     0  203     4   11    3     2     8     8   70      3
3     0     0    0  8285    0    4     2    51    94    0      1
4     3     0   34     2  290    1     7     6    41    7    148
5     0     0    0    54    0  437     0     0     5   24      1
6     4     0    0     3    0    0  1892     1     3    2      3
7     0     5    1   303    1    0     4  6795   150    0      6
8     0     0    1   118    0    1     3    24  3126    4     18
9     0     0   15    19    0  104     1     3     8  342      0
10    9     1    1    10   26    2    35    14    51    1  12643
---- Validation: 
scalar performance:
{'acc': 0.95415276, 'precision': 0.9029952, 'recall': 0.8475176, 'specificity': 0.994975, 'f1': 0.86955756, 'auroc': 0.99781275}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   413     0    0     9    1    1    28     0     4    2     25
1     0  1243    0    21    0    0     1    55    10    0      2
2     0     0  195     2   18    5     3     8    13   66      2
3     0     0    0  8286    0    7     3    53    90    0      1
4     3     0   34     1  284    1     7     6    43   12    148
5     0     0    0    53    0  435     1     0     8   23      1
6     0     0    1     3    0    1  1892     0     2    0      9
7     0     4    0   310    1    0     5  6800   139    0      6
8     0     0    1   119    2    1     2    31  3123    1     16
9     0     0   13    14    0  106     1     3    10  346      0
10    7     1    3     9   18    1    41    11    51    0  12654
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.64073324, 'precision': 0.64922076, 'recall': 0.520518, 'specificity': 0.96420133, 'f1': 0.50179195, 'auroc': 0.88003683}
confusion matrix:
     0     1   2    3   4    5     6    7     8    9     10
0   649     0   0  165   0    7   230   16    27   71     5
1     5  1022   0   51   0    0    19  380    15    0     7
2     2     0  41   81  38   46   137   40   453   57   120
3     0     0   0    0   0    0     0    0     0    0     0
4     0     0   1    1  98    0    25    1    33    2  1472
5     1     0   0  244   0  322     2    0    10   13     0
6     0     0   0    3   0    0  3061    0     2    0     1
7     2     0   0  149   0    0     6  997     9    0     1
8     0     0   0  186   0    0     5    0  1178    0     1
9     1     1  12  411   1  227    18   79   206  158    23
10    0     0   0    1   3    0    10    0     0    0  1632
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_5.png
better model found
persisted
after epoch: 5,now: 2024-07-08 10:49:14.853556,epoch time: 0:42:03.365293,used: 3:29:18.585053,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9554259, 'precision': 0.8726543, 'recall': 0.8671863, 'specificity': 0.9952223, 'f1': 0.8660698, 'auroc': 0.9980268}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   456     0    0     2    2    0     6     2     0    0     15
1     0  1258    0     9    0    0     0    50     4    0     10
2     2     0  214     0   81    0     1     2     0    9      3
3     6     0    1  8027    2   11     2   267   119    2      1
4     4     0    5     1  423    0     0     0     3    1    102
5     4     0    3    15    3  342     1     0     5  145      3
6    10     0    0     2    2    0  1874     2     2    0     16
7     2     9    4    75    5    0     1  7126    31    0     11
8     4     0    4    54   50    0     1    97  3015    1     68
9     5     0   99     7   19    8     4     1     1  348      1
10   18     0    2     7  124    0     7     2     6    0  12627
---- Validation: 
scalar performance:
{'acc': 0.9554902, 'precision': 0.8676875, 'recall': 0.86308867, 'specificity': 0.9952407, 'f1': 0.8614745, 'auroc': 0.99782914}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   440     0    0     3    5    0     9     2     0    1     23
1     0  1267    0     9    0    0     1    45     3    0      7
2     2     0  208     0   82    0     1     4     0   12      3
3     2     2    1  8052    1   10     2   256   110    3      1
4     4     0    6     1  435    0     2     1     2    1     87
5     6     0    8    11    4  336     0     0     9  144      3
6    11     0    0     2    3    0  1869     5     0    0     18
7     2    10    4    78    3    0     2  7121    32    1     12
8     7     1    6    51   56    0     1    81  3013    3     77
9     7     0  102     1   16   14     2     2     1  344      4
10   20     0    2     7  111    0     8     7     5    0  12636
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70202196, 'precision': 0.6107736, 'recall': 0.5654881, 'specificity': 0.9698552, 'f1': 0.54556763, 'auroc': 0.8749881}
confusion matrix:
      0     1    2   3    4   5     6     7     8    9     10
0   1128     0    1   7    2   0    11    10     1    0    10
1      3  1222    0  12    0   0     1   193     3    0    65
2     15     0   60   1  640   0     2    35    53    2   207
3      0     0    0   0    0   0     0     0     0    0     0
4      1     0    0   0  421   0     2     2     0    0  1207
5     44     0   77  48   58  94     2     0    28  236     5
6      2     0    0   0    0   0  2957     0     0    0   108
7      0     0    0   3    0   0     0  1157     1    0     3
8      0     0    1  20   23   0     9    34  1260    1    22
9     53     1  442  19  225   3    10   109    96  123    56
10     0     0    0   0   33   0     1     0     0    0  1612
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_6.png
better model found
persisted
after epoch: 6,now: 2024-07-08 11:31:38.519688,epoch time: 0:42:23.666132,used: 4:11:42.251185,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95850277, 'precision': 0.9047896, 'recall': 0.8707334, 'specificity': 0.995397, 'f1': 0.88440835, 'auroc': 0.9984254}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   378     0    0     2    4    1    28     1     2    6     61
1     0  1291    0    14    0    0     0    22     3    0      2
2     0     0  204     2   32    0     0     0     1   73      0
3     0     0    0  8363    2    7     1    48    14    1      1
4     0     0   12     1  400    0     0     0     8    8    110
5     0     0    0    27    1  400     0     0     2   90      1
6     1     0    0     1    0    0  1889     1     4    2      9
7     0    13    7   258    9    0     3  6852   103    3     16
8     0     0    2   250   24    2     1    14  2947    3     51
9     0     0   25     4    4   36     0     0     4  419      0
10    0     0    2     9   64    0    20     2    15    1  12682
---- Validation: 
scalar performance:
{'acc': 0.95843256, 'precision': 0.902103, 'recall': 0.87562245, 'specificity': 0.995412, 'f1': 0.88667, 'auroc': 0.9984981}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   383     0    1     3    3    0    31     0     1    3     58
1     0  1286    0    17    0    0     0    21     3    1      4
2     0     0  219     1   34    0     0     0     4   54      0
3     0     1    0  8350    2    8     1    51    23    4      0
4     3     0   12     0  404    0     2     0     8    4    106
5     0     0    1    23    1  401     0     0     4   90      1
6     4     0    0     4    1    1  1888     0     2    2      6
7     1    14   13   248   10    0     7  6839   119    2     12
8     0     0    2   240   24    1     1    22  2955    4     47
9     0     0   29     6    1   34     0     1     5  416      1
10    0     1    5     8   65    0    11     3    12    1  12690
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.67340654, 'precision': 0.6158441, 'recall': 0.54633164, 'specificity': 0.9669601, 'f1': 0.53339356, 'auroc': 0.872255}
confusion matrix:
     0     1   2    3    4    5     6     7     8    9     10
0   736     0   1   20    3    1   261     7     1   87    53
1     2  1298   0   29    1    0     3   131     7    1    27
2     1     2  70   16  278    2     7    17   327   60   235
3     0     0   0    0    0    0     0     0     0    0     0
4     0     0   1    0  109    0     3     1    16    0  1503
5     1     0   1  104   11  113     5     0     7  348     2
6     0     0   0    2    0    0  2861     3     0    0   201
7     1     0   0   47    0    0     2  1104     9    0     1
8     0     0   0  153    1    1     6     4  1196    4     5
9     1    11  96  154   21   30     2    31   270  496    25
10    0     0   0    0    1    0     3     0     0    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_7.png
better model found
persisted
after epoch: 7,now: 2024-07-08 12:13:50.299524,epoch time: 0:42:11.779836,used: 4:53:54.031021,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9628906, 'precision': 0.9094029, 'recall': 0.89686245, 'specificity': 0.99589217, 'f1': 0.9011162, 'auroc': 0.9986078}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   443     0    0     1    1    0     4     1     0    2     31
1     0  1299    0     6    0    0     0    21     5    0      1
2     1     0  223     0   27    3     0     1     1   54      2
3     1     2    1  8208    0   47     2    44   129    2      2
4     3     0   12     0  383    1     0     0     4    7    129
5     2     0    0     1    0  496     0     0     3   18      1
6     8     0    0     1    1    1  1876     2     0    2     17
7     1    21    5   245    1    0     1  6884    84    0     21
8     3     0    1    48   17    7     6    22  3089    1    101
9     0     0   15     2    1   98     1     0     1  375      0
10   10     0    2     7   44    1     6     4     3    2  12713
---- Validation: 
scalar performance:
{'acc': 0.9624983, 'precision': 0.9032617, 'recall': 0.8953998, 'specificity': 0.99585986, 'f1': 0.8978953, 'auroc': 0.998586}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   447     0    0     1    2    1     8     0     0    1     23
1     0  1302    0     7    0    0     0    17     3    0      3
2     0     0  216     0   33    2     1     1     0   56      3
3     2     1    0  8238    0   37     1    37   124    0      0
4     2     0   15     0  391    1     1     0     5    3    121
5     1     0    0     3    0  491     0     0     5   20      1
6    10     0    0     1    0    0  1880     1     0    1     15
7     0    33   12   252    3    0     2  6849    80    4     30
8     3     0    8    44   17   10     4    22  3077    3    108
9     1     0   17     5    2   94     1     0     1  372      0
10   11     0    4     7   37    1    10     3     2    1  12720
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.74826837, 'precision': 0.6650294, 'recall': 0.64438, 'specificity': 0.9743919, 'f1': 0.6275433, 'auroc': 0.88458776}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1041     0    0  12    0    4   105     0     0    2     6
1      2  1272    1   7    0    0     2   180     7    0    28
2     20     1  139   1  333   26    40    23   149   49   234
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    0   0  347    0     5     2    10    1  1268
5     12     0    1  15    3  466     6     1     4   83     1
6      0     0    0   2    0    0  3017     0     0    0    48
7      1     0    0  45    0    1     9  1101     4    1     2
8      0     0    1  21    4    4    41     5  1272    3    19
9     27     2  164  35   25  190    31    56   152  426    29
10     0     0    0   0   30    0     2     0     0    0  1614
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-08 12:57:40.540543,epoch time: 0:43:50.241019,used: 5:37:44.272040,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9679741, 'precision': 0.90711963, 'recall': 0.906536, 'specificity': 0.9965575, 'f1': 0.9039554, 'auroc': 0.99885404}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    2     4    1    0     2     2     0    0     11
1     0  1290    0     3    0    0     0    32     5    0      0
2     0     0  280     0   14    2     1     0     1   13      1
3     0     0    2  8206    0   10     2   137    78    3      0
4     4     0   32     2  369    2     0     1    10    5    114
5     1     0    1     9    0  394     0     0     4  110      1
6    25     0    0     1    0    0  1864     4     2    1     11
7     0     7   18    79    1    1     1  7050    97    1      9
8     0     0    5    68   12    3     0    23  3147    8     29
9     4     0   52     3    1   16     2     1     0  414      0
10   17     0    4     8   39    0     5     3    12    2  12704
---- Validation: 
scalar performance:
{'acc': 0.9685703, 'precision': 0.9101419, 'recall': 0.9084969, 'specificity': 0.99660563, 'f1': 0.9069174, 'auroc': 0.9989156}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    0     3    1    0     1     3     1    1     13
1     0  1290    1     4    0    0     0    32     3    0      2
2     0     0  274     0   13    1     0     0     0   23      1
3     0     0    3  8226    0   15     0   123    67    5      1
4     5     0   29     0  376    0     0     0     8    4    117
5     1     0    0     7    0  405     0     0     2  105      1
6    26     0    0     2    0    0  1863     3     1    1     12
7     0     7   15    97    1    0     1  7041    95    0      8
8     2     0    4    68    8    3     2    26  3153    4     26
9     1     0   49     2    1   19     1     0     1  419      0
10   23     0    0     7   33    1     4     7    17    1  12703
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7545652, 'precision': 0.66643393, 'recall': 0.6431112, 'specificity': 0.9752357, 'f1': 0.6281444, 'auroc': 0.88577133}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1139     0    0   5    0    1     1    18     1    2     3
1      2  1200    0   5    0    0     1   258     9    0    24
2     27     0  243   0  206   13    18    23   156   69   260
3      0     0    0   0    0    0     0     0     0    0     0
4      2     0    3   0  247    0     9     1    10    0  1361
5     15     0    5  32    2  324     1     2     2  207     2
6      5     0    0   1    0    0  3052     2     0    0     7
7      0     0    0   2    0    0     1  1156     3    0     2
8      0     0    1  29    2    3     2     8  1316    4     5
9     35     5  230  29    7  110     0    52   139  488    42
10     0     0    0   0   21    0     4     0     1    0  1620
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_9.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-08 13:42:35.114477,epoch time: 0:44:54.573934,used: 6:22:38.845974,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96556616, 'precision': 0.9092765, 'recall': 0.8980986, 'specificity': 0.9962735, 'f1': 0.89703935, 'auroc': 0.9989156}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   461     0    1     0    0    1     6     0     1    2     11
1     0  1258    0     9    0    0     1    47    16    0      1
2     0     0  289     1    5    0     1     0     0   14      2
3     1     0    2  8240    0   19     1    69   101    6      0
4     8     0   58     0  287    0     2     0    11    1    172
5     1     0    2     4    2  424     0     0     5   82      1
6     5     0    0     3    2    0  1887     0     2    1      8
7     0     3   21   124    2    0     1  6912   183    4     14
8     2     0    5    28   11    4     1    17  3196    4     27
9     0     0   59     1    3   21     1     0     1  407      0
10   14     0    2     7   10    0     9     1    18    1  12728
---- Validation: 
scalar performance:
{'acc': 0.96463823, 'precision': 0.90869564, 'recall': 0.8939254, 'specificity': 0.996153, 'f1': 0.89497715, 'auroc': 0.9988756}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   459     0    0     0    0    0     3     0     2    3     16
1     0  1256    1    10    0    0     0    47    16    0      2
2     1     0  284     0    5    0     1     1     2   14      4
3     1     0    2  8248    0   22     0    77    86    4      0
4     4     0   50     0  297    1     1     1    11    3    171
5     1     0    4     3    2  410     0     0     6   94      1
6     6     0    0     0    2    1  1887     0     3    0      9
7     0     2   17   155    1    1     2  6900   173    1     13
8     2     0    4    39   10    5     1    16  3188    5     26
9     0     0   66     1    2   22     0     0     0  401      1
10   11     0    3     7    8    0    13     1    19    1  12733
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6997132, 'precision': 0.6084014, 'recall': 0.59212637, 'specificity': 0.96983117, 'f1': 0.5767224, 'auroc': 0.8741296}
confusion matrix:
      0     1    2    3    4    5     6    7     8    9     10
0   1087     0    2   10    0    5    30    1    12   19     4
1     15  1064    3   29    0    6    31  243    47    2    59
2      9     0  247    2  122   17    15    3   273   34   293
3      0     0    0    0    0    0     0    0     0    0     0
4      1     0    1    0   21    0     9    0    26    1  1574
5      2     0   15   37    4  355     1    0     5  170     3
6      3     0    0    2    0    0  3039    0     0    0    23
7      6     0   12  250    0    1    19  831    27   17     1
8      0     0    0   58    0   11    11    0  1284    4     2
9      4     0  281   31    9  154     6   10   173  431    38
10     0     0    0    1    0    0     3    0     0    0  1642
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_10.png
early stop counter: 1
val acc:0.9646382331848145, best validation acc: 0.9685702919960022, corresponding to test acc:                         0.7545651793479919 / 0.7545651793479919
after epoch: 10,now: 2024-07-08 14:27:51.316029,epoch time: 0:45:16.201552,used: 7:07:55.047526,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9681614, 'precision': 0.9092233, 'recall': 0.8948607, 'specificity': 0.9966656, 'f1': 0.89210933, 'auroc': 0.9991185}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   475     0    0     1    2    0     2     0     0    1      2
1     0  1307    0     4    0    0     1    15     1    0      4
2     3     0  157     0   57    0     1     1     0   91      2
3     0     0    1  8253    1    4     1    81    92    5      0
4     4     0    2     0  452    1     0     1     6    3     70
5     0     0    0     7    0  367     0     0     6  140      0
6     4     0    0     1    0    0  1894     0     1    2      6
7     6    17    1   120    2    0     5  7009    79    3     22
8     1     1    1    43   12    0     4    26  3178    4     22
9     0     0   12     3    0   10     0     1     0  465      2
10   45     0    0     8   82    0    13     2    13    3  12629
---- Validation: 
scalar performance:
{'acc': 0.9682493, 'precision': 0.9118712, 'recall': 0.8945056, 'specificity': 0.99666893, 'f1': 0.8917049, 'auroc': 0.9991496}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    3    0     7     0     0    2      1
1     0  1303    0     4    0    0     1    20     1    0      3
2     1     0  152     0   53    0     0     2     3   95      6
3     3     0    2  8264    0    7     1    77    79    6      1
4     4     0    0     0  455    0     2     1     5    7     65
5     0     0    0    10    0  368     0     0     4  138      1
6     9     0    0     0    0    0  1889     1     0    2      7
7     4    17    0   136    1    0     3  7003    78    2     21
8     3     1    0    45    3    1     1    20  3195    3     24
9     0     0    8     2    0    9     0     0     0  474      0
10   58     0    0     8   75    0    17     0    12    1  12625
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.73147696, 'precision': 0.67104805, 'recall': 0.59861577, 'specificity': 0.9728698, 'f1': 0.58655167, 'auroc': 0.8806588}
confusion matrix:
     0     1   2    3    4    5     6    7     8    9     10
0   931     1   0   18    3    1    74    5    25   91    21
1     6  1241   0   15    2    0     8  166     7    3    51
2     4     0  48    6  345    3     7    8   171  134   289
3     0     0   0    0    0    0     0    0     0    0     0
4     0     0   0    0  334    0     6    0    12    1  1280
5     3     0   0   34    2  131     2    0     7  410     3
6     1     0   0    0    0    0  3055    0     0    0    11
7     0     0   0  147    0    0     3  990     9   13     2
8     0     0   0   33    1    3    10    1  1305   11     6
9     3     5  50   34   27   17     6    7   133  804    51
10    0     0   0    0   28    0     2    0     0    0  1616
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_11.png
early stop counter: 2
val acc:0.9682493209838867, best validation acc: 0.9685702919960022, corresponding to test acc:                         0.7545651793479919 / 0.7545651793479919
after epoch: 11,now: 2024-07-08 15:12:20.428413,epoch time: 0:44:29.112384,used: 7:52:24.159910,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9729238, 'precision': 0.9446513, 'recall': 0.9065004, 'specificity': 0.99692684, 'f1': 0.9216709, 'auroc': 0.99924886}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     1    1    0     1     1     0    0      9
1     0  1270    0     6    0    0     0    55     0    0      1
2     5     0  235     1   15    2     0     2     1   44      7
3     0     1    0  8356    0    7     0    33    40    1      0
4     6     0    8     1  331    1     0     2    17    3    170
5     1     0    0     9    1  488     0     0     1   20      1
6     7     1    0     2    0    1  1889     2     0    0      6
7     0     9    0   185    1    0     1  7035    23    1      7
8     0     1    0    94    1    5     1    35  3139    3     16
9     0     0   15     5    0   53     0     2     1  416      1
10   13     0    1     8    3    0     8     6    19    0  12735
---- Validation: 
scalar performance:
{'acc': 0.9720744, 'precision': 0.93776995, 'recall': 0.90305597, 'specificity': 0.9968693, 'f1': 0.9166975, 'auroc': 0.99927247}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     2    1    0     1     1     0    1      5
1     0  1283    0     4    0    0     0    44     0    0      1
2     3     0  229     0   23    0     0     4     1   48      4
3     0     4    0  8358    0   12     0    33    32    1      0
4     6     0    5     0  339    2     1     3    18    3    162
5     1     0    0     6    0  479     0     0     2   32      1
6    10     1    0     4    0    0  1886     2     2    0      3
7     0    18    0   191    1    0     1  7026    23    0      5
8     0     4    0    95    0    3     0    41  3133    1     19
9     0     0   14     3    1   67     0     3     1  404      0
10   18     0    1     8    2    0     7     9    18    1  12732
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69649476, 'precision': 0.6655315, 'recall': 0.5806496, 'specificity': 0.96969426, 'f1': 0.5624946, 'auroc': 0.8744411}
confusion matrix:
      0     1   2    3    4    5     6    7     8    9     10
0   1137     1   0    9    0    1     0   11     7    1     3
1      2  1125   0   19    0    0     0  319     5    0    29
2     28     1  67   29   76    9     4   34   350   96   321
3      0     0   0    0    0    0     0    0     0    0     0
4      1     0   0    0  102    0     2    1    25    0  1502
5     20     0   1   65    0  217     1    0    14  273     1
6      6     0   0    4    0    0  2900    4     4    0   149
7      1     0   0  208    0    0     0  952     2    0     1
8      0     0   0  109    0    1     3    5  1247    2     3
9     36    14  28  174    4   64     5   55   157  569    31
10     0     0   0    0    4    0     2    1     0    0  1639
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_12.png
better model found
persisted
after epoch: 12,now: 2024-07-08 15:54:44.207161,epoch time: 0:42:23.778748,used: 8:34:47.938658,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.972469, 'precision': 0.9356721, 'recall': 0.9113182, 'specificity': 0.9969217, 'f1': 0.9206821, 'auroc': 0.9993537}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   450     0    0     0    1    0     2     2     1    0     27
1     0  1288    0     3    0    0     0    39     1    0      1
2     0     0  286     0    6    0     0     6     2    9      3
3     0     0    1  8167    0    3     0   150   117    0      0
4     2     0   24     1  393    0     0     1     3    0    115
5     1     0    0    19    1  450     1     0     4   44      1
6     7     0    0     1    0    0  1879     5     1    0     14
7     0     4    0    48    1    0     1  7182    13    0     14
8     0     0    2    28   10    0     0    72  3133    1     50
9     3     0   78     5    1   41     0     2     3  358      2
10    0     0    0     7    8    1     5     4     6    0  12761
---- Validation: 
scalar performance:
{'acc': 0.97186035, 'precision': 0.9340135, 'recall': 0.90940875, 'specificity': 0.9968657, 'f1': 0.9188104, 'auroc': 0.9992546}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   444     0    0     5    2    0     2     3     0    0     27
1     0  1289    0     6    0    0     0    35     1    0      1
2     0     0  286     1    4    1     1     3     0   10      6
3     0     0    0  8157    0    3     0   155   123    1      1
4     6     0   23     1  380    1     1     2     6    0    119
5     0     0    1    18    0  451     0     0     7   43      1
6     5     3    0     0    0    0  1879     4     3    0     14
7     0     5    1    53    1    0     1  7170    20    1     13
8     0     0    3    24    8    1     0    71  3148    2     39
9     1     0   73     3    4   41     1     2     3  364      1
10    3     0    1     7    9    1     4     4     2    0  12765
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7104177, 'precision': 0.64011735, 'recall': 0.60260206, 'specificity': 0.97075176, 'f1': 0.5749328, 'auroc': 0.8792228}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   889     4    0  21    1    2    55    76    77    4    41
1     0  1270    0  16    0    0     0   182     6    0    25
2     5     4   93  12  180   25    20    43   292   29   312
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  145    0     2     1    12    1  1472
5     3     0    2  81    1  391     9     1    27   75     2
6     2     0    0   1    0    0  2947     3     3    0   111
7     0     0    0   2    0    0     0  1157     4    0     1
8     0     0    0  26    0    2     4    10  1325    0     3
9     5    23  103  85   20  170    17    81   294  301    38
10    0     0    0   0    9    0     0     1     0    0  1636
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_13.png
early stop counter: 1
val acc:0.9718603491783142, best validation acc: 0.9720743894577026, corresponding to test acc:                         0.6964947581291199 / 0.7545651793479919
after epoch: 13,now: 2024-07-08 16:34:43.422513,epoch time: 0:39:59.215352,used: 9:14:47.154010,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9619542, 'precision': 0.89720666, 'recall': 0.90752304, 'specificity': 0.99620205, 'f1': 0.89186317, 'auroc': 0.99891806}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   412     1    0     0    3    0    38     2     2    0     24
1     0  1317    0     2    0    0     0    13     0    0      0
2     0     0  201     0   38    1     1     2     7   61      1
3     0     7    1  8225    0   14     3    97    91    0      1
4     3     0    3     0  502    2     1     1    11    2     13
5     0     0    0     3    1  507     2     0     2    6      0
6     0     0    0     1    0    0  1899     0     3    0      4
7     0    33    0    76    2    0     1  7087    61    0      3
8     0     2    0    35    5    2     1    20  3225    0      5
9     0     0    6     1    1  126     1     1     7  349      1
10    1     6    1     5  441    2    22    12    74    0  12230
---- Validation: 
scalar performance:
{'acc': 0.9622041, 'precision': 0.8966874, 'recall': 0.9093279, 'specificity': 0.99623466, 'f1': 0.89322484, 'auroc': 0.9991357}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   408     0    0     2    3    0    42     2     2    1     23
1     0  1319    0     2    0    0     0    10     1    0      0
2     0     0  211     0   33    1     3     4     2   58      0
3     1     6    0  8225    0   10     1    87   110    0      0
4     1     0    3     0  510    1     1     0    14    0      9
5     0     0    0     4    1  501     1     0     6    8      0
6     1     2    0     0    2    0  1893     1     2    0      7
7     0    31    2    86    1    0     1  7080    61    0      3
8     0     3    1    31    5    0     1    17  3236    0      2
9     0     0   10     1    2  127     0     1     5  347      0
10    2     7    0     8  443    0    16     9    69    0  12242
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72643954, 'precision': 0.6646595, 'recall': 0.6054976, 'specificity': 0.9718473, 'f1': 0.5746998, 'auroc': 0.8856878}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   529     7   0  17   14    2   461    67    42    5    26
1     0  1399   0  18    1    0     0    77     3    0     1
2    10    17  29   3  321   47   115    42   332   17    82
3     0     0   0   0    0    0     0     0     0    0     0
4     0     1   0   0  983    0     8     2    29    0   610
5     5     0   0  58    1  463    37     1    13   14     0
6     0     0   0   2    2    0  3037     2     2    0    22
7     0     1   0  30    0    1     2  1127     2    0     1
8     0     1   0  42    0    4    29     5  1285    0     4
9    12    40  22  69   31  345    94    61   320  132    11
10    0     3   0   0  238    0     4     0     2    0  1399
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_14.png
early stop counter: 2
val acc:0.962204098701477, best validation acc: 0.9720743894577026, corresponding to test acc:                         0.6964947581291199 / 0.7545651793479919
after epoch: 14,now: 2024-07-08 17:14:25.205733,epoch time: 0:39:41.783220,used: 9:54:28.937230,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9764822, 'precision': 0.93709445, 'recall': 0.92509747, 'specificity': 0.99745417, 'f1': 0.9281622, 'auroc': 0.9994917}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   464     0    0     0   10    0     0     1     0    0      8
1     0  1306    0     2    0    0     0    20     0    0      3
2     0     0  270     1   30    0     0     0     2    8      1
3     0     1    0  8177    0   18     0   129   109    2      2
4     0     0    7     1  419    0     0     1     7    0    104
5     1     0    0     2    1  513     0     0     2    2      0
6     3     0    0     0    5    0  1882     0     1    1     15
7     0     8    2    44    2    0     1  7150    48    1      7
8     0     0    0    20    8    2     0    16  3230    0     18
9     0     0   54     0    7   91     1     0     0  340      0
10    4     0    0     5   17    0     3     6    14    0  12746
---- Validation: 
scalar performance:
{'acc': 0.9754447, 'precision': 0.92965174, 'recall': 0.920253, 'specificity': 0.99735284, 'f1': 0.9225687, 'auroc': 0.9994235}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    0     0   10    0     2     0     1    1     12
1     0  1312    0     1    0    0     0    17     1    0      1
2     0     0  264     0   31    1     0     0     1   13      2
3     1     1    0  8171    0   23     0   138   104    2      0
4     2     0    6     0  408    0     0     2     6    0    115
5     1     0    1     2    1  507     0     0     1    8      0
6     8     0    0     1    4    0  1880     1     1    1     12
7     1     6    8    47    2    0     1  7148    46    0      6
8     0     1    2    14    4    4     0    17  3240    0     14
9     1     0   50     1   12   84     0     0     0  345      0
10    3     0    2     5   22    0     3     5    21    0  12735
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7145456, 'precision': 0.6181664, 'recall': 0.607021, 'specificity': 0.9712792, 'f1': 0.58768797, 'auroc': 0.87217456}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1003     1    2  14   37    0    16    27    60    1     9
1      5  1265    2  12    1    3     4   173     9    1    24
2      3     1  186   3  443   18     2    13   199   18   129
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    1   0  154    0     1     0    17    1  1459
5     15     0   21  37   32  382     0     0     4  100     1
6      4     0    0   4    4    0  2954     0     1    0   100
7      4     0    7  98    0    1     2  1039     5    4     4
8      0     0    0  18    1   16     7     5  1319    2     2
9     15     3  287  31   77  263     2    18   147  271    23
10     0     0    0   0    4    0     0     0     2    0  1640
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_15.png
better model found
persisted
after epoch: 15,now: 2024-07-08 18:02:00.129268,epoch time: 0:47:34.923535,used: 10:42:03.860765,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9760809, 'precision': 0.93469787, 'recall': 0.9421505, 'specificity': 0.99743223, 'f1': 0.93821675, 'auroc': 0.9994775}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    1    0     2     2     1    0      3
1     0  1281    0     4    0    0     0    45     1    0      1
2     0     0  262     0    1    4     0     4     1   40      0
3     0     0    1  8356    0    9     0    50    22    0      0
4     5     0   29     0  465    1     0     2     7    3     27
5     0     0    1     6    0  485     0     0     2   26      1
6     6     0    0     1    0    0  1885     3     0    2      9
7     0     2    1   165    1    0     0  7073    19    0      4
8     0     0    3    87    3    4     0    52  3134    2     11
9     0     0    7     1    0   40     0     0     3  442      0
10   13     0    4     8   95    0     3    10    31    2  12626
---- Validation: 
scalar performance:
{'acc': 0.97707635, 'precision': 0.93512005, 'recall': 0.94005835, 'specificity': 0.99754465, 'f1': 0.9373936, 'auroc': 0.9994831}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     3    0    0     2     0     0    0      5
1     0  1274    0     4    0    0     1    48     4    0      1
2     2     0  258     0    5    2     0     5     1   38      1
3     0     1    0  8358    0   15     0    50    16    0      0
4     6     0   30     0  463    0     0     2     7    4     27
5     0     0    0     2    0  492     0     0     2   24      1
6     8     0    0     2    0    1  1876     4     2    2     13
7     0     0    0   154    1    0     1  7093    13    0      3
8     1     0    4    78    3    1     1    47  3157    1      3
9     0     0   14     0    0   45     0     0     1  433      0
10    9     0    2     6   77    1     3     8    38    1  12651
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7145456, 'precision': 0.66900253, 'recall': 0.6087184, 'specificity': 0.9715106, 'f1': 0.5975306, 'auroc': 0.8822889}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   976     0    0   15    1    4    41    63    47   17     6
1     2  1073    0   26    1    0     2   358     9    0    28
2     9     0  145   22  189   24     3    69   354   92   108
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    4    0  431    0     2     3    33    1  1158
5     7     0    2   74    1  375     1     0     7  124     1
6     9     0    1   11    1    0  2876     6    14    0   149
7     0     0    0   83    0    0     0  1076     3    0     2
8     0     0    0   93    0    4     4    19  1246    2     2
9    12     0   51  155    8  211     3    86   191  404    16
10    0     0    0    0   33    0     0     1     1    0  1611
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_16.png
better model found
persisted
after epoch: 16,now: 2024-07-08 19:00:17.210427,epoch time: 0:58:17.081159,used: 11:40:20.941924,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97629493, 'precision': 0.9524158, 'recall': 0.92274344, 'specificity': 0.9972702, 'f1': 0.9349908, 'auroc': 0.9995856}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   402     0    0     1    1    1     5     0     2    1     70
1     0  1293    0     8    0    0     0    24     5    0      2
2     0     0  274     0    2    3     0     0     1   28      4
3     0     0    1  8340    0   10     0    40    42    5      1
4     0     0   26     0  385    2     0     0     6    5    115
5     0     0    0     1    0  501     0     0     1   16      1
6     1     1    0     1    0    1  1879     2     0    1     22
7     0     4    8   117    1    0     1  7027    80    6     19
8     0     0    0    44    4    4     0     7  3184    1     52
9     0     0    9     0    0   45     0     0     1  437      1
10    0     0    0     6    6    0     2     2     7    0  12768
---- Validation: 
scalar performance:
{'acc': 0.9764344, 'precision': 0.95261055, 'recall': 0.91989064, 'specificity': 0.99727607, 'f1': 0.9338411, 'auroc': 0.9995319}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   401     0    0     2    1    0     3     0     0    1     75
1     0  1293    0     5    0    0     0    25     8    0      1
2     0     0  265     0    1    3     0     0     3   32      8
3     1     1    0  8337    0   14     0    45    41    1      0
4     0     0   27     0  382    0     0     0     8    0    122
5     0     0    0     3    0  502     0     0     4   11      1
6     1     0    0     1    1    1  1878     3     1    1     21
7     1     4    7   123    2    1     0  7052    58    4     13
8     0     0    1    43    6    2     0     4  3188    5     47
9     0     0    7     1    0   42     0     0     3  438      2
10    0     0    0     6   10    0     2     1     9    0  12768
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6957951, 'precision': 0.65403664, 'recall': 0.58744764, 'specificity': 0.9692921, 'f1': 0.5689714, 'auroc': 0.874812}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   805     1    3  33    0   12    90    15    28   46   137
1     0  1003    1  20    0    0     2   336    49    0    88
2     1     0  130  11   83   22     2     6   268   45   447
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  162    0     2     1    12    0  1456
5     1     0    3  50    1  388     1     0     7  131    10
6     0     0    0   2    0    0  3026     0     2    0    37
7     0     0    1  42    0    0     0  1086    28    4     3
8     0     0    0  38    1    2     4     2  1306    2    15
9     3     0  102  48    5  209     3     8   283  406    70
10    0     0    0   0   11    0     1     1     0    0  1633
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_17.png
early stop counter: 1
val acc:0.9764344096183777, best validation acc: 0.9770763516426086, corresponding to test acc:                         0.7145456075668335 / 0.7545651793479919
after epoch: 17,now: 2024-07-08 20:12:52.585474,epoch time: 1:12:35.375047,used: 12:52:56.316971,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97782, 'precision': 0.95744354, 'recall': 0.9429115, 'specificity': 0.99752575, 'f1': 0.94968045, 'auroc': 0.99959743}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    0    0     0     2     0    0      4
1     0  1310    0     1    0    0     0    20     0    0      1
2     0     0  260     1   24    0     0     2     3   18      4
3     1     3    0  8106    0    5     1   274    44    1      0
4     5     0    4     0  439    0     0     2     8    2     78
5     0     0    0     2    0  498     0     0     3   18      0
6     5     0    0     1    0    1  1890     4     2    0      5
7     0     3    2    39    0    0     0  7203    11    0      6
8     0     1    2    25    5    3     0    63  3167    0     29
9     0     0   21     0    0   26     0     2     2  441      1
10    6     0    1     5    9    1     4     1    12    0  12756
---- Validation: 
scalar performance:
{'acc': 0.9775846, 'precision': 0.95811534, 'recall': 0.9442977, 'specificity': 0.9974843, 'f1': 0.9507141, 'auroc': 0.99962384}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    1     0    0    0     0     3     0    0      9
1     0  1308    0     1    0    0     0    20     1    0      2
2     0     0  266     0   21    0     0     2     1   18      4
3     0     1    0  8100    0   15     0   271    47    4      2
4     5     0    6     0  440    1     0     1     4    1     81
5     0     0    1     3    0  502     0     0     2   13      0
6     6     0    0     2    0    0  1886     3     1    0     10
7     1     0    0    43    1    0     1  7200     9    0     10
8     1     0    0    31    6    0     0    62  3174    0     22
9     1     0   23     1    0   22     0     1     0  444      1
10    6     0    0     4    6    0     6     3    14    0  12757
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70286155, 'precision': 0.6346731, 'recall': 0.58967996, 'specificity': 0.97009385, 'f1': 0.55795324, 'auroc': 0.8774785}
confusion matrix:
      0     1   2   3    4    5     6     7     8    9     10
0   1006     1   0  24    0    5    13    87    12    7    15
1      2  1092   0  10    0    0     1   334     4    0    56
2     27     0  42   3   90   11     7    93   298   59   385
3      0     0   0   0    0    0     0     0     0    0     0
4      1     0   0   0  167    0     4     4    28    0  1429
5     13     0   1  84    0  322     1     2    28  137     4
6      3     0   0   4    0    0  2987     3     9    0    61
7      2     0   0   3    0    1     0  1156     0    0     2
8      2     0   0  36    0    1     6    34  1286    2     3
9     36     1  54  44    6  141     6   234   201  357    57
10     0     0   0   0   12    0     1     1     1    0  1631
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_18.png
better model found
persisted
after epoch: 18,now: 2024-07-08 21:19:35.768680,epoch time: 1:06:43.183206,used: 13:59:39.500177,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9829837, 'precision': 0.9540827, 'recall': 0.9565843, 'specificity': 0.99817073, 'f1': 0.95469815, 'auroc': 0.99974966}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   470     0    0     0    2    0     2     1     1    1      6
1     0  1322    0     0    0    0     0     9     1    0      0
2     0     0  296     0    4    0     0     0     1    8      2
3     2     1    1  8290    0    2     1   113    28    1      0
4     4     0   15     0  469    0     0     0     1    2     48
5     0     0    0     7    0  480     0     0     1   33      0
6     4     0    0     1    0    0  1892     0     2    1      7
7     0    28    6    51    0    0     1  7115    53    2      7
8     0     0    1    30    2    0     0     9  3244    2      8
9     0     0   39     1    0   19     0     0     0  434      0
10    3     5    3     7   20    0     2     6    18    0  12728
---- Validation: 
scalar performance:
{'acc': 0.9832553, 'precision': 0.9533726, 'recall': 0.9574106, 'specificity': 0.9982047, 'f1': 0.9544493, 'auroc': 0.9997363}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   468     0    1     1    1    0     1     0     0    2      9
1     0  1324    0     1    0    0     0     6     1    0      0
2     0     0  304     0    3    0     0     0     0    4      1
3     0     3    1  8308    0    4     0    92    30    2      0
4     4     0   20     0  452    0     0     0     8    4     51
5     0     0    1     6    0  484     0     0     0   30      0
6     9     1    0     0    1    0  1888     2     1    0      6
7     0    19    6    52    0    0     1  7131    49    3      4
8     1     1    2    37    3    2     0    12  3230    2      6
9     0     0   37     0    2   12     0     0     0  442      0
10    6     7    1     6   20    0     3     4    21    0  12728
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7519065, 'precision': 0.67331016, 'recall': 0.6322946, 'specificity': 0.97498405, 'f1': 0.62914526, 'auroc': 0.88243455}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   992     8    1  17    3    1    66    29    31   16     6
1     1  1418    0  11    0    0     1    61     3    1     3
2     7    17  219  11  280    9    24    40   184   93   131
3     0     0    0   0    0    0     0     0     0    0     0
4     0     8    7   0  326    0    17     2    14    1  1258
5     4     0    3  66    1  278     4     2     6  226     2
6     0     0    0   5    1    0  3041     0     0    0    20
7     3     3    2  90    0    1     8  1053     2    0     2
8     0     1    1  58    2    6    21    17  1256    7     1
9     8    16  139  67   21  113     9    42   158  547    17
10    0     6    0   0   17    0     5     1     0    0  1617
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_19.png
better model found
persisted
after epoch: 19,now: 2024-07-08 22:26:44.996095,epoch time: 1:07:09.227415,used: 15:06:48.727592,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9789437, 'precision': 0.9486024, 'recall': 0.9534291, 'specificity': 0.99773467, 'f1': 0.9498614, 'auroc': 0.99969804}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   469     1    0     0    1    0     8     1     0    0      3
1     0  1323    0     0    0    0     0     8     1    0      0
2     2     0  281     0   11    3     0     3     0   11      1
3     0     0    0  8357    0   16     3    29    34    1      0
4     6     0    3     0  488    2     2     1     3    0     34
5     0     0    0     1    0  516     0     0     0    4      0
6     0     0    0     0    0    0  1905     0     1    1      1
7     1    11    1   223    2    0    15  6983    14    0     12
8     3     1    0    42    5    4     5    25  3190    2     16
9     1     0   20     1    1   65     0     0     2  403      0
10   36     1    0     5   24    1    42     1     9    0  12674
---- Validation: 
scalar performance:
{'acc': 0.979778, 'precision': 0.9531393, 'recall': 0.95468706, 'specificity': 0.9978203, 'f1': 0.95274794, 'auroc': 0.99972457}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     0    2    0    13     0     0    1      1
1     0  1314    0     4    0    0     0    14     0    0      0
2     1     0  291     0   11    2     0     2     0    4      1
3     0     0    0  8366    0   12     9    19    33    1      0
4     5     0    4     0  485    0     3     1     5    1     35
5     0     0    0     0    0  515     0     0     0    6      0
6     0     0    0     0    0    0  1907     0     0    0      1
7     1    11    0   213    0    0    13  6996    19    0     12
8     0     1    1    42    2    1     5    28  3199    3     14
9     2     0   17     0    0   71     0     1     1  401      0
10   33     0    1     4   16    1    41     3     8    0  12689
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7319667, 'precision': 0.6624945, 'recall': 0.62318265, 'specificity': 0.9727147, 'f1': 0.6084058, 'auroc': 0.88146085}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1007     2    0   5    2    6   139     5     2    0     2
1      1  1188    0  17    0    2     7   226    12    0    46
2     26     0  163   3  139   22    72    54   146   88   302
3      0     0    0   0    0    0     0     0     0    0     0
4      3     0    1   0  278    0    17     1     7    1  1325
5     25     0    0  20    2  415     9     0     4  116     1
6      0     0    0   0    0    0  3065     0     1    0     1
7      0     0    0  90    0    1    49  1019     2    0     3
8      0     0    1  38    0   12    23    14  1278    1     3
9     44     0  146  36    9  190    36    65   142  432    37
10     0     0    0   0   18    0    10     1     0    0  1617
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_20.png
early stop counter: 1
val acc:0.979777991771698, best validation acc: 0.9832553267478943, corresponding to test acc:                         0.7519065141677856 / 0.7545651793479919
after epoch: 20,now: 2024-07-08 23:32:50.231999,epoch time: 1:06:05.235904,used: 16:12:53.963496,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9794521, 'precision': 0.95610774, 'recall': 0.9409386, 'specificity': 0.9977076, 'f1': 0.9477513, 'auroc': 0.99966466}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    0     1    2    0     1     2     2    1      7
1     0  1276    0    16    0    0     0    36     3    0      1
2     1     0  260     0    4    2     0     3     0   40      2
3     0     0    0  8376    0    5     0    29    28    0      0
4     5     0   25     0  435    1     0     5     6    2     60
5     0     0    0     5    0  514     0     0     0    2      0
6     4     0    0     2    0    1  1891     2     1    0      7
7     0     1    0   179    0    0     1  7062    15    0      1
8     1     0    1    65    2    1     0    57  3151    1     17
9     0     0    8     1    0   43     0     1     0  439      1
10    5     0    1     8   18    0     5     9    11    1  12737
---- Validation: 
scalar performance:
{'acc': 0.9785208, 'precision': 0.9513916, 'recall': 0.93305814, 'specificity': 0.9976119, 'f1': 0.9410558, 'auroc': 0.9996137}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   472     0    0     2    0    0     1     1     0    0      7
1     0  1261    0    16    0    0     0    52     2    0      1
2     1     0  249     0    2    3     0     8     1   45      3
3     0     0    0  8374    0    7     0    22    36    1      0
4     5     0   31     0  427    1     0     2     8    0     65
5     0     0    0     6    0  508     0     0     1    6      0
6     3     0    0     2    0    0  1895     1     0    0      7
7     0     2    0   170    1    0     1  7078     9    1      3
8     0     0    0    72    4    6     0    40  3155    2     17
9     0     0    8     1    0   57     0     1     0  425      1
10    3     0    0     7   13    0     3    17    14    1  12738
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.68362135, 'precision': 0.656317, 'recall': 0.57278645, 'specificity': 0.9684833, 'f1': 0.5619645, 'auroc': 0.8761829}
confusion matrix:
     0    1    2    3    4    5     6    7     8    9     10
0   986    0    2   45    1   12    45   37     9   10    23
1     1  891    0   32    0    0     1  514     9    1    50
2    18    0  151   39   37   27    12  111   264   92   264
3     0    0    0    0    0    0     0    0     0    0     0
4     1    0    4    0  193    0    13    5    33    1  1383
5     5    0   19   62    1  324     0    1    15  163     2
6     0    0    0   24    0    0  2994    5     6    0    38
7     0    0    0  232    0    0     0  930     1    0     1
8     0    0    0   69    0    7     3   30  1261    0     0
9    17    0   92  138    1  162     8  155   115  418    31
10    0    0    0    0   16    0     5    1     1    0  1623
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_21.png
early stop counter: 2
val acc:0.9785208106040955, best validation acc: 0.9832553267478943, corresponding to test acc:                         0.7519065141677856 / 0.7545651793479919
after epoch: 21,now: 2024-07-09 00:39:30.603138,epoch time: 1:06:40.371139,used: 17:19:34.334635,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98070955, 'precision': 0.9637706, 'recall': 0.9430982, 'specificity': 0.9978434, 'f1': 0.95242316, 'auroc': 0.9997474}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   466     0    0     0    0    0    11     0     0    0      6
1     0  1309    0     4    0    0     1    17     1    0      0
2     0     0  259     0   14    0     1     0     2   34      2
3     0     1    0  8381    0    2     1    24    27    0      0
4     4     0    3     0  434    0     0     0     5    2     90
5     0     0    0     6    0  495     0     0     1   19      0
6     2     0    0     1    1    0  1900     0     0    0      3
7     1     5    1   157    2    0     6  6985    93    3     10
8     0     0    0    49    4    1     2     2  3209    1     28
9     0     0    6     3    0   30     0     1     1  452      0
10    3     0    2     2    2    0     7     3    11    0  12765
---- Validation: 
scalar performance:
{'acc': 0.9807944, 'precision': 0.9644042, 'recall': 0.9442485, 'specificity': 0.9978491, 'f1': 0.95322824, 'auroc': 0.99972945}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     1    0     1    0    0    14     1     0    1      5
1     0  1315    0     2    0    0     0    13     2    0      0
2     1     0  259     0   14    0     0     0     3   34      1
3     0     2    0  8374    0    2     1    29    29    1      2
4     5     0    8     0  429    0     1     1     3    2     90
5     0     0    0     5    0  503     2     0     0   11      0
6     7     1    0     1    0    0  1893     0     1    0      5
7     1     7    1   161    1    0     5  6990    84    2     13
8     0     0    0    49    2    2     2     6  3210    2     23
9     0     0    4     2    0   24     1     0     0  462      0
10    1     0    0     3    5    0     6     2     7    0  12772
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6860701, 'precision': 0.64890337, 'recall': 0.57056075, 'specificity': 0.9679861, 'f1': 0.55667627, 'auroc': 0.8725288}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   826     2    2    5    0    1   271    7    15    1    40
1     1  1148    0   20    0    0     2  268    22    0    38
2     5     0  114   12   65   10    34   17   269   74   415
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    0    0  114    0     2    1    17    0  1499
5     3     0    7   52    1  307    42    0     7  154    19
6     0     0    0    0    0    0  2996    2     4    0    65
7     1     0    1  116    0    1    35  997     9    0     4
8     0     0    0   61    0    7    19    4  1273    1     5
9    10     0   76   81    5  156    58   31   256  394    70
10    0     0    0    0    6    0     2    1     0    0  1637
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_22.png
early stop counter: 3
val acc:0.9807944297790527, best validation acc: 0.9832553267478943, corresponding to test acc:                         0.7519065141677856 / 0.7545651793479919
after epoch: 22,now: 2024-07-09 01:43:37.688716,epoch time: 1:04:07.085578,used: 18:23:41.420213,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98081654, 'precision': 0.944672, 'recall': 0.9499662, 'specificity': 0.9979038, 'f1': 0.9453609, 'auroc': 0.9996872}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    0     0    0    0     2     0     0    0      3
1     0  1314    0     0    0    0     1    15     0    0      1
2     0     0  306     0    1    1     0     0     0    2      2
3     1     0    1  8204    1   20     0   158    44    7      0
4     5     0   40     0  415    1     2     1     1    1     73
5     1     0    0     0    0  466     0     0     1   53      0
6    13     0    1     0    0    0  1890     0     0    0      4
7     1     4    4    22    0    0     1  7217    10    1      4
8     5     0    3    15    7    5     3    51  3159    0     46
9     3     0   34     0    1    4     0     0     0  451      0
10    5     0    2     2   18    0     4     3     1    1  12759
---- Validation: 
scalar performance:
{'acc': 0.98047346, 'precision': 0.94803023, 'recall': 0.9482453, 'specificity': 0.99783766, 'f1': 0.94587034, 'auroc': 0.9996664}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   477     0    0     0    0    0     0     0     0    0      6
1     0  1316    0     0    0    0     0    14     0    0      2
2     0     0  303     0    1    2     0     0     0    5      1
3     1     0    2  8200    0   17     2   157    55    6      0
4     5     0   42     0  408    0     2     4     5    0     73
5     0     0    0     0    0  471     0     0     0   50      0
6     4     0    1     0    0    1  1895     0     0    0      7
7     0     2    4    31    0    0     3  7209     8    1      7
8     4     0    2    19    3    2     5    34  3163    1     63
9     1     0   41     0    0    3     0     0     0  448      0
10    6     0    0     3   15    0     4     2     1    0  12765
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7443504, 'precision': 0.6707327, 'recall': 0.63822967, 'specificity': 0.9741334, 'f1': 0.6191725, 'auroc': 0.8767127}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1074     0    1   2    0    4    41    24     6    7    11
1      1  1260    0   9    0    0     2   181    10    0    36
2     27     0  303   1   83   22    11    37   115   54   362
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    4   0  127    0     2     0     6    0  1494
5     14     0    5  27    0  346     1     0     6  190     3
6      3     0    0   0    0    0  3000     2     1    0    61
7      0     0    0   9    0    0     3  1147     2    0     3
8      0     0    5  17    0   12    15    31  1277    2    11
9     31     1  226   9    3  162     6    52   126  466    55
10     0     0    0   0    4    0     1     1     1    0  1639
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_23.png
early stop counter: 4
val acc:0.9804734587669373, best validation acc: 0.9832553267478943, corresponding to test acc:                         0.7519065141677856 / 0.7545651793479919
after epoch: 23,now: 2024-07-09 02:23:58.409066,epoch time: 0:40:20.720350,used: 19:04:02.140563,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9792915, 'precision': 0.9430819, 'recall': 0.9411781, 'specificity': 0.9978113, 'f1': 0.93799186, 'auroc': 0.99970883}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   460     0    1     0    2    0     4     2     0    0     14
1     0  1320    0     0    0    0     0    12     0    0      0
2     0     0  296     0    1    0     1     2     1   11      0
3     0     3    1  8205    0    2     4   200    20    1      1
4     2     0   32     0  484    0     1     2     2    4     12
5     0     1    1    33    0  351     0     1     1  133      0
6     3     0    0     0    0    0  1898     0     1    0      5
7     0     5    0    22    0    0     2  7221    10    1      2
8     0     3    1    35    3    2     3    55  3185    0      8
9     0     0   10     4    1    0     1     0     0  477      0
10    1     0    2     2   71    0     7     4     2    0  12705
---- Validation: 
scalar performance:
{'acc': 0.98095495, 'precision': 0.9478784, 'recall': 0.9455984, 'specificity': 0.9979826, 'f1': 0.9429381, 'auroc': 0.9997318}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   467     0    1     1    1    0     3     0     0    1      9
1     0  1313    0     0    0    0     0    19     0    0      0
2     0     0  303     0    0    0     0     2     1    6      0
3     1     1    0  8230    0    1     1   186    18    1      1
4     5     0   26     0  483    0     0     1     3    5     16
5     0     0    1    30    0  360     0     1     3  126      0
6     2     0    0     1    0    0  1900     0     0    1      4
7     0     3    0    13    1    0     0  7236     9    1      2
8     0     2    0    31    7    0     0    54  3193    2      7
9     0     0   16     2    0    1     0     0     0  474      0
10    0     0    3     3   52    0     4     8    11    1  12714
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.75218636, 'precision': 0.6967762, 'recall': 0.6248119, 'specificity': 0.9751282, 'f1': 0.6198163, 'auroc': 0.8838948}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1018     1    1    7    1    1    46    57     6   18    14
1      1  1315    0    8    2    0     0   159     7    0     7
2     12     3  272   18  136    2     9    51   245  135   132
3      0     0    0    0    0    0     0     0     0    0     0
4      0     1    5    0  429    0     5     2    33    1  1157
5      9     0    2  103    0  118     4     1    10  344     1
6      2     0    0    6    2    0  2970     4     3    0    80
7      0     0    1    7    0    0     2  1148     3    1     2
8      0     0    0   81    0    2     9    31  1238    7     2
9     10     5   95  111    5   38     4    89   115  642    23
10     0     0    0    0   42    0     2     1     0    0  1601
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_24.png
early stop counter: 5
val acc:0.9809549450874329, best validation acc: 0.9832553267478943, corresponding to test acc:                         0.7519065141677856 / 0.7545651793479919
after epoch: 24,now: 2024-07-09 03:03:45.229316,epoch time: 0:39:46.820250,used: 19:43:48.960813,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9805223, 'precision': 0.9616417, 'recall': 0.94983846, 'specificity': 0.99791634, 'f1': 0.9533517, 'auroc': 0.9998398}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   451     0    0     0    2    0    11     1     1    0     17
1     0  1293    0     0    0    0     0    36     1    0      2
2     0     0  236     0   53    0     2     2     0   18      1
3     0     0    0  8085    1    3     0   263    81    5      0
4     2     0    1     0  519    0     0     1     3    0     12
5     0     0    0     5    0  476     0     0     3   37      0
6     2     0    0     1    0    0  1902     2     0    0      1
7     1     0    0    13    0    0     0  7241     5    0      4
8     0     0    0     1    4    0     1    31  3247    1     10
9     1     0    2     1    3    4     0     0     0  482      0
10    0     0    0     2   48    0     6    12     8    0  12716
---- Validation: 
scalar performance:
{'acc': 0.98028624, 'precision': 0.96275103, 'recall': 0.94810283, 'specificity': 0.9978875, 'f1': 0.953422, 'auroc': 0.99978817}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   448     0    0     2    2    0    10     1     1    1     18
1     0  1299    0     0    0    0     0    32     1    0      0
2     0     0  236     0   47    0     0     4     2   19      4
3     0     0    0  8091    1    0     0   246   100    2      0
4     3     0    0     0  512    0     1     0     6    1     16
5     0     0    0     4    0  486     0     0     1   30      0
6     1     0    0     3    0    0  1897     1     2    0      4
7     0     0    0    16    0    0     2  7231    14    0      2
8     1     0    0     5    5    0     0    30  3246    0      9
9     0     0    3     1    0   12     1     3     0  473      0
10    0     0    0     0   41    0    10     8     8    0  12729
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72266144, 'precision': 0.65394145, 'recall': 0.6014432, 'specificity': 0.9719478, 'f1': 0.5991142, 'auroc': 0.8809514}
confusion matrix:
     0     1    2   3    4    5     6     7     8    9     10
0   771     0    1  65    4    7   162    95    30   12    23
1     0  1165    0  24    0    0     2   273    14    0    21
2    11     1  108   3  380    9    35    67   167   86   148
3     0     0    0   0    0    0     0     0     0    0     0
4     0     0    0   0  578    0    12     1    16    1  1025
5     7     0    2  85    3  249     5     0    18  223     0
6     2     0    0  10    3    0  2928     4    11    0   109
7     0     0    0  37    0    1     1  1121     2    0     2
8     0     0    0  32    1    5    18    23  1279    5     7
9    13     2  118  58   38   80     6    82   152  564    24
10    0     0    0   0   70    0     8     1     1    0  1566
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_25.png
early stop counter: 6
val acc:0.9802862405776978, best validation acc: 0.9832553267478943, corresponding to test acc:                         0.7519065141677856 / 0.7545651793479919
after epoch: 25,now: 2024-07-09 03:42:47.707717,epoch time: 0:39:02.478401,used: 20:22:51.439214,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9864084, 'precision': 0.9732475, 'recall': 0.95745444, 'specificity': 0.99844867, 'f1': 0.96501344, 'auroc': 0.99984217}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   457     0    1     2    1    0     2     1     0    0     19
1     0  1324    0     0    0    0     0     5     0    0      2
2     0     0  282     0   10    0     0     0     2   11      7
3     0     3    0  8370    0   13     2    28    20    1      0
4     2     0    3     1  466    0     0     0     5    0     62
5     0     0    0    11    0  490     0     0     1   18      1
6     3     0    1     0    0    1  1895     0     1    0      6
7     1    18    1    72    1    0     0  7136    27    0      8
8     0     0    1    37    2    1     0     8  3210    1     34
9     0     0    5     4    0   18     0     1     1  464      0
10    0     0    0     4    7    1     0     1     8    0  12774
---- Validation: 
scalar performance:
{'acc': 0.98657215, 'precision': 0.97375566, 'recall': 0.9574492, 'specificity': 0.99846375, 'f1': 0.96521044, 'auroc': 0.9998563}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   455     0    1     2    0    0    10     0     0    0     15
1     0  1328    0     0    1    0     0     1     2    0      0
2     0     0  280     2   11    1     0     1     0   14      3
3     2     2    0  8364    0   14     2    34    20    2      0
4     3     0    2     0  466    0     0     1     2    1     64
5     0     0    0    10    0  495     0     0     0   16      0
6     0     0    0     0    0    0  1899     0     1    0      8
7     0     9    1    68    0    0     2  7154    16    0     15
8     0     1    1    46    1    0     0    11  3205    0     31
9     0     0    6     3    1   18     1     0     1  463      0
10    2     0    0     5    5    1     2     2     5    0  12774
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.69908345, 'precision': 0.65875524, 'recall': 0.5935622, 'specificity': 0.96963656, 'f1': 0.585605, 'auroc': 0.87416255}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   684     4    6   24    0   32   221    50    31   80    38
1     0  1279    0   13    0    0     1   167     9    0    30
2    10     0  185   18  195   22    20    56   241   74   194
3     0     0    0    0    0    0     0     0     0    0     0
4     0     0    4    0  296    0     5     1    13    1  1313
5     0     0    0  106    0  364     2     1    10  108     1
6     0     0    1    6    2    0  2809     3     3    0   243
7     0     0    0   38    0    1     1  1119     4    0     1
8     0     1    0   94    0    8     5    17  1238    1     6
9     3     3   86  150    4  165     8    86   220  390    22
10    0     0    0    0   17    0     0     1     0    0  1628
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_26.png
better model found
persisted
after epoch: 26,now: 2024-07-09 04:21:29.161668,epoch time: 0:38:41.453951,used: 21:01:32.893165,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9868365, 'precision': 0.95874083, 'recall': 0.96925914, 'specificity': 0.9986101, 'f1': 0.96328133, 'auroc': 0.9998471}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   481     0    1     1    0    0     0     0     0    0      0
1     0  1329    0     1    0    0     0     2     0    0      0
2     0     0  300     2    3    2     0     0     0    5      0
3     0     1    0  8398    0    2     0    26     9    1      0
4     7     0    9     1  499    1     0     0     3    0     19
5     1     0    0    11    0  507     0     0     0    2      0
6     6     0    0     2    1    0  1895     0     2    1      1
7     1    16    2    70    0    0     2  7166     5    0      0
8     0     4    3    37    5    4     2    59  3175    0      7
9     0     0   20     0    0   40     0     1     0  432      0
10   37     1    2     4   33    1     6     2     5    0  12702
---- Validation: 
scalar performance:
{'acc': 0.9856627, 'precision': 0.9552772, 'recall': 0.9644584, 'specificity': 0.9984878, 'f1': 0.95841026, 'auroc': 0.99984795}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   478     0    1     1    0    0     1     2     0    0      0
1     0  1325    0     2    0    0     0     5     0    0      0
2     0     0  304     2    2    2     0     1     0    1      0
3     0     0    0  8402    0    2     1    25    10    0      0
4     7     0    8     0  509    0     0     0     2    1     12
5     0     0    0    12    0  506     0     0     0    3      0
6     6     0    1     3    0    0  1895     0     0    0      3
7     2    17    0    77    0    0     1  7166     2    0      0
8     1     7    4    37    2    3     1    67  3163    0     11
9     0     0   27     1    1   64     0     2     0  398      0
10   34     0    0     4   38    1     3     5     7    1  12703
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.72650945, 'precision': 0.65841025, 'recall': 0.62409157, 'specificity': 0.97268057, 'f1': 0.60669285, 'auroc': 0.87681425}
confusion matrix:
      0     1    2    3    4    5     6     7     8    9     10
0   1081     0    2   14    0    6    20    29     8    4     6
1      3  1330    0   15    0    0     1   120     7    0    23
2     59     3  137   22  240   56     7    69   158   68   196
3      0     0    0    0    0    0     0     0     0    0     0
4      5     0    4    0  412    0     4     3    15    1  1189
5     14     0    1   97    1  381     0     2     6   90     0
6     20     0    0   47    1    0  2760     1     2    0   236
7      3     2    0   52    0    1     2  1098     1    1     4
8      1     1    0   84    0    9    10    29  1231    2     3
9     46    10   96  100   13  299     4   113    80  346    30
10     0     0    0    0   33    0     3     1     1    0  1608
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_27.png
early stop counter: 1
val acc:0.9856626987457275, best validation acc: 0.9865721464157104, corresponding to test acc:                         0.6990834474563599 / 0.7545651793479919
after epoch: 27,now: 2024-07-09 05:01:02.068504,epoch time: 0:39:32.906836,used: 21:41:05.800001,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9845623, 'precision': 0.9670878, 'recall': 0.95444155, 'specificity': 0.9982829, 'f1': 0.95989037, 'auroc': 0.9997924}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   474     0    0     1    4    0     0     1     0    1      2
1     0  1323    0     0    0    0     0     9     0    0      0
2     0     0  256     0    8    0     0     2     0   44      1
3     3     3    0  8355    1    2     4    64     6    1      0
4     4     0    6     1  483    0     0     2     4    2     37
5     0     0    0    14    0  489     0     0     0   18      0
6     4     0    0     0    0    1  1896     0     1    0      5
7     1     2    0    57    0    0     1  7192     5    0      6
8     1     0    0    93    4    2     2    53  3110    3     27
9     0     0    0     2    0   20     0     1     1  469      0
10    4     1    0     5   16    0     4     5     4    1  12752
---- Validation: 
scalar performance:
{'acc': 0.9859569, 'precision': 0.96822613, 'recall': 0.95706826, 'specificity': 0.998448, 'f1': 0.9616842, 'auroc': 0.9998258}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   473     0    0     0    4    0     1     0     0    1      4
1     0  1320    0     0    0    0     1    11     0    0      0
2     0     0  254     0    7    0     0     4     0   45      2
3     6     3    0  8359    0    0     2    68     2    0      0
4     4     0    4     0  493    0     0     1     4    1     32
5     1     0    0     6    0  503     0     0     0   11      0
6    11     1    0     0    0    0  1889     1     1    0      5
7     1     4    0    53    0    0     1  7198     3    2      3
8     0     0    0    73    1    0     0    51  3142    7     22
9     0     0    0     2    0   26     0     1     0  464      0
10    4     0    0     2   13    0     1     4     6    1  12765
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.754845, 'precision': 0.6885094, 'recall': 0.648233, 'specificity': 0.97529703, 'f1': 0.64298666, 'auroc': 0.8836816}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1012     0    7   4    6    9    31    12     5   71    13
1      1  1200    0  13    1    4     0   241     7    3    29
2      5     0  239   3  220   11     1    48   180  144   164
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    3   0  525    0     3     1    15    2  1084
5      0     0   16  34    4  294     2     0     7  234     1
6      3     0    0   0    3    0  2813     4     4    0   240
7      3     0    2   7    0    1     2  1140     3    5     1
8      1     0    2  39    1   20     4    14  1276   10     3
9      3     0   73  27   12  135     1    48   107  707    24
10     0     0    0   0   62    0     0     1     0    0  1583
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_28.png
new oracle model saved
early stop counter: 2
val acc:0.9859569072723389, best validation acc: 0.9865721464157104, corresponding to test acc:                         0.6990834474563599 / 0.7548450231552124
after epoch: 28,now: 2024-07-09 05:40:32.671350,epoch time: 0:39:30.602846,used: 22:20:36.402847,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98729134, 'precision': 0.970962, 'recall': 0.9739016, 'specificity': 0.9986227, 'f1': 0.97221226, 'auroc': 0.99989295}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     1    1    1     7     0     0    1      7
1     0  1328    0     3    0    0     0     1     0    0      0
2     0     0  303     1    2    0     0     1     1    4      0
3     0     2    0  8392    0    2     0    11    30    0      0
4     6     0   17     0  496    0     0     0     9    1     10
5     0     0    0     3    0  513     0     0     0    5      0
6     0     0    0     2    0    0  1895     2     0    0      9
7     0    25    1   164    0    0     0  7051    18    1      2
8     0     0    0     8    0    0     0     6  3271    0     11
9     0     0   14     1    0   15     0     0     4  459      0
10    1     1    1     3   34    0     1     4    20    0  12728
---- Validation: 
scalar performance:
{'acc': 0.9876689, 'precision': 0.9681817, 'recall': 0.9746808, 'specificity': 0.99868345, 'f1': 0.97110975, 'auroc': 0.99989307}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   465     0    0     0    2    0     8     0     0    1      7
1     0  1331    0     1    0    0     0     0     0    0      0
2     0     0  306     0    1    1     0     1     0    2      1
3     0     0    0  8397    0    3     0    16    24    0      0
4     4     0   27     0  491    0     0     0     9    2      6
5     0     0    0     3    0  512     0     0     1    5      0
6     1     1    0     0    1    0  1894     1     3    0      7
7     2    30    0   136    0    0     0  7081    15    0      1
8     0     0    0    20    1    0     0     7  3261    0      7
9     0     0    9     1    0   19     0     0     1  463      0
10    3     0    4     2   33    0     6     6    19    0  12723
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6829917, 'precision': 0.6712999, 'recall': 0.5648451, 'specificity': 0.9681845, 'f1': 0.5658863, 'auroc': 0.8783311}
confusion matrix:
     0     1    2    3    4    5     6    7     8    9     10
0   734     1    3   56    3   10   126   21    87   98    31
1     1  1276    0   30    0    0     0  159    16    1    16
2     5     0  143    7   92    8    14   49   443   86   168
3     0     0    0    0    0    0     0    0     0    0     0
4     0     0    6    0  365    0     3    2    32    1  1224
5     1     0    2   94    0  215     5    0    70  205     0
6     2     0    1    4    1    0  2744    1    16    0   298
7     2     1    0  256    0    0     0  890    13    0     2
8     0     0    0   27    0    0     1    3  1333    5     1
9     3     3   50   96    3   72     7   50   384  449    20
10    0     0    0    0   33    0     0    0     0    0  1613
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_29.png
better model found
persisted
after epoch: 29,now: 2024-07-09 06:19:57.183536,epoch time: 0:39:24.512186,used: 23:00:00.915033,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9890571, 'precision': 0.97051024, 'recall': 0.9708694, 'specificity': 0.99880815, 'f1': 0.97044104, 'auroc': 0.9998794}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     1    0    0     0     1     0    0      0
1     0  1321    0     0    0    0     0     9     1    0      1
2     0     0  291     0    7    3     0     1     0    7      3
3     0     0    0  8393    0    1     0    28    12    1      3
4     5     0    1     0  504    0     0     0     2    1     26
5     0     0    0     5    0  511     0     0     0    5      0
6    19     0    0     4    0    0  1877     2     0    2      4
7     0     3    0    68    0    0     0  7186     6    0      1
8     0     0    1    29    1    2     1    26  3219    2     13
9     1     0   10     2    1   34     0     0     0  445      0
10    5     0    1     0   30    0     0     6    11    0  12740
---- Validation: 
scalar performance:
{'acc': 0.98865855, 'precision': 0.9712987, 'recall': 0.9693942, 'specificity': 0.99877274, 'f1': 0.9699235, 'auroc': 0.9998797}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   480     0    0     1    0    0     0     0     0    0      2
1     0  1324    0     0    0    0     0     8     0    0      0
2     0     0  291     1    9    0     0     0     0    8      3
3     0     0    0  8394    0    1     0    33     9    0      3
4     6     0    3     1  499    1     0     0     9    0     20
5     0     0    0     4    0  514     0     0     0    3      0
6    12     0    0     1    0    0  1887     2     1    2      3
7     0     3    0    77    0    0     0  7170    13    0      2
8     0     0    0    29    3    1     1    29  3223    1      9
9     0     0    2     2    0   51     0     0     0  437      1
10    3     0    0     1   33    1     2     2    11    1  12742
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6906178, 'precision': 0.6466277, 'recall': 0.58265966, 'specificity': 0.9690466, 'f1': 0.57262313, 'auroc': 0.871815}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   882     2    2   32    1    8    10    56    14  129    34
1     4  1112    0   18    0    0     1   268    18    0    78
2    27     0  130   15  136   14     1    58   250  119   265
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    2    0  303    0     2     1    24    1  1299
5     4     0    3  126    1  242     0     2     8  204     2
6    40     0    0   34    1    1  2683     2    35    0   271
7     1     0    1   46    0    0     0  1110     3    1     2
8     0     0    0   48    0    3     1    11  1301    2     4
9    15     0   84  130    6  130     0    70   176  487    39
10    0     0    0    0   24    0     0     1     0    0  1621
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_30.png
better model found
persisted
after epoch: 30,now: 2024-07-09 06:59:27.956615,epoch time: 0:39:30.773079,used: 23:39:31.688112,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 23:39:31.688112 at 2024-07-09 06:59:27.956615
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6906178, 'precision': 0.6466277, 'recall': 0.58265966, 'specificity': 0.9690466, 'f1': 0.57262313, 'auroc': 0.871815}
confusion matrix:
     0     1    2    3    4    5     6     7     8    9     10
0   882     2    2   32    1    8    10    56    14  129    34
1     4  1112    0   18    0    0     1   268    18    0    78
2    27     0  130   15  136   14     1    58   250  119   265
3     0     0    0    0    0    0     0     0     0    0     0
4     1     0    2    0  303    0     2     1    24    1  1299
5     4     0    3  126    1  242     0     2     8  204     2
6    40     0    0   34    1    1  2683     2    35    0   271
7     1     0    1   46    0    0     0  1110     3    1     2
8     0     0    0   48    0    3     1    11  1301    2     4
9    15     0   84  130    6  130     0    70   176  487    39
10    0     0    0    0   24    0     0     1     0    0  1621
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.754845, 'precision': 0.6885094, 'recall': 0.648233, 'specificity': 0.97529703, 'f1': 0.64298666, 'auroc': 0.8836816}
confusion matrix:
      0     1    2   3    4    5     6     7     8    9     10
0   1012     0    7   4    6    9    31    12     5   71    13
1      1  1200    0  13    1    4     0   241     7    3    29
2      5     0  239   3  220   11     1    48   180  144   164
3      0     0    0   0    0    0     0     0     0    0     0
4      0     0    3   0  525    0     3     1    15    2  1084
5      0     0   16  34    4  294     2     0     7  234     1
6      3     0    0   0    3    0  2813     4     4    0   240
7      3     0    2   7    0    1     2  1140     3    5     1
8      1     0    2  39    1   20     4    14  1276   10     3
9      3     0   73  27   12  135     1    48   107  707    24
10     0     0    0   0   62    0     0     1     0    0  1583
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_08_07_19_56_seed_1_21716731_instance_wise_predictions.txt
accuracy from prediction file 0.6906177849296858
results aggregation path: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/BLOOD_acevedo_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456463 KiB |   6809 MiB |   2936 TiB |   2936 TiB |
|       from large pool | 413211 KiB |   6773 MiB |   2900 TiB |   2900 TiB |
|       from small pool |  43251 KiB |     62 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456463 KiB |   6809 MiB |   2936 TiB |   2936 TiB |
|       from large pool | 413211 KiB |   6773 MiB |   2900 TiB |   2900 TiB |
|       from small pool |  43251 KiB |     62 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 449054 KiB |   6803 MiB |   2928 TiB |   2928 TiB |
|       from large pool | 407075 KiB |   6767 MiB |   2892 TiB |   2892 TiB |
|       from small pool |  41979 KiB |     60 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7496 MiB |   7500 MiB |  14124 MiB |   6628 MiB |
|       from large pool |   7432 MiB |   7436 MiB |  14044 MiB |   6612 MiB |
|       from small pool |     64 MiB |     64 MiB |     80 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 485617 KiB | 703689 KiB |   2187 TiB |   2187 TiB |
|       from large pool | 479716 KiB | 694392 KiB |   2151 TiB |   2151 TiB |
|       from small pool |   5900 KiB |  40275 KiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    4556    |    6799    |  488229 K  |  488224 K  |
|       from large pool |     187    |     783    |  270830 K  |  270830 K  |
|       from small pool |    4369    |    6537    |  217399 K  |  217394 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4556    |    6799    |  488229 K  |  488224 K  |
|       from large pool |     187    |     783    |  270830 K  |  270830 K  |
|       from small pool |    4369    |    6537    |  217399 K  |  217394 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     343    |     343    |     624    |     281    |
|       from large pool |     311    |     311    |     584    |     273    |
|       from small pool |      32    |      32    |      40    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      68    |    1531    |  316096 K  |  316096 K  |
|       from large pool |      43    |     310    |  204627 K  |  204627 K  |
|       from small pool |      25    |    1488    |  111469 K  |  111469 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6809 MiB |   2936 TiB |   2936 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   2900 TiB |   2900 TiB |
|       from small pool |      0 KiB |     62 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6809 MiB |   2936 TiB |   2936 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   2900 TiB |   2900 TiB |
|       from small pool |      0 KiB |     62 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6803 MiB |   2928 TiB |   2928 TiB |
|       from large pool |  16640 KiB |   6767 MiB |   2892 TiB |   2892 TiB |
|       from small pool |      0 KiB |     60 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    920 MiB |   7500 MiB |  14124 MiB |  13204 MiB |
|       from large pool |    872 MiB |   7436 MiB |  14044 MiB |  13172 MiB |
|       from small pool |     48 MiB |     64 MiB |     80 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 703689 KiB |   2187 TiB |   2187 TiB |
|       from large pool |  24320 KiB | 694392 KiB |   2151 TiB |   2151 TiB |
|       from small pool |      0 KiB |  40275 KiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6799    |  488229 K  |  488229 K  |
|       from large pool |       2    |     783    |  270830 K  |  270830 K  |
|       from small pool |       0    |    6537    |  217399 K  |  217399 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6799    |  488229 K  |  488229 K  |
|       from large pool |       2    |     783    |  270830 K  |  270830 K  |
|       from small pool |       0    |    6537    |  217399 K  |  217399 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     343    |     624    |     560    |
|       from large pool |      40    |     311    |     584    |     544    |
|       from small pool |      24    |      32    |      40    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1531    |  316097 K  |  316097 K  |
|       from large pool |       3    |     310    |  204627 K  |  204627 K  |
|       from small pool |       0    |    1488    |  111470 K  |  111470 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6809 MiB |   2936 TiB |   2936 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   2900 TiB |   2900 TiB |
|       from small pool |      0 KiB |     62 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6809 MiB |   2936 TiB |   2936 TiB |
|       from large pool |  16640 KiB |   6773 MiB |   2900 TiB |   2900 TiB |
|       from small pool |      0 KiB |     62 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6803 MiB |   2928 TiB |   2928 TiB |
|       from large pool |  16640 KiB |   6767 MiB |   2892 TiB |   2892 TiB |
|       from small pool |      0 KiB |     60 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    920 MiB |   7500 MiB |  14124 MiB |  13204 MiB |
|       from large pool |    872 MiB |   7436 MiB |  14044 MiB |  13172 MiB |
|       from small pool |     48 MiB |     64 MiB |     80 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 703689 KiB |   2187 TiB |   2187 TiB |
|       from large pool |  24320 KiB | 694392 KiB |   2151 TiB |   2151 TiB |
|       from small pool |      0 KiB |  40275 KiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6799    |  488229 K  |  488229 K  |
|       from large pool |       2    |     783    |  270830 K  |  270830 K  |
|       from small pool |       0    |    6537    |  217399 K  |  217399 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6799    |  488229 K  |  488229 K  |
|       from large pool |       2    |     783    |  270830 K  |  270830 K  |
|       from small pool |       0    |    6537    |  217399 K  |  217399 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     343    |     624    |     560    |
|       from large pool |      40    |     311    |     584    |     544    |
|       from small pool |      24    |      32    |      40    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1531    |  316097 K  |  316097 K  |
|       from large pool |       3    |     310    |  204627 K  |  204627 K  |
|       from small pool |       0    |    1488    |  111470 K  |  111470 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to blood_mon_eos_bas


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_16_19_seed_2_21716731

 Experiment start at: 2024-07-09 07:16:19.902942
before training, model accuracy: 0.08185825496912003
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91936004, 'precision': 0.836112, 'recall': 0.7380725, 'specificity': 0.99095714, 'f1': 0.767984, 'auroc': 0.9933063}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   304     0   0     7    4    1     5    26    11    7    118
1     0  1209   0    11    0    0     0    99     5    0      8
2     0     1  47     2  147    2     1    40    18   52      2
3     0     0   0  7637    0    9     0   690    99    0      3
4     1     0   1     1  306    1     0     8    57    3    161
5     1     0   1    84    1  323     0     1    12   97      1
6    31     0   0    15   30    1  1662    17    20    6    125
7     0     7   0    98    3    0     1  7101    40    1     14
8     0     0   0   208    6    0     0   199  2824    0     59
9     0     0  21    22   20   70     0    20    19  318      3
10    2     1   0     9   60    0     2    28    56    1  12631
---- Validation: 
scalar performance:
{'acc': 0.91916543, 'precision': 0.8368513, 'recall': 0.735648, 'specificity': 0.9909143, 'f1': 0.76527524, 'auroc': 0.99308157}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   296     0   0    12    2    1     6    24     9   12    121
1     0  1218   0    12    0    0     0    90     6    0      6
2     0     0  44     3  151    3     0    40    23   48      0
3     1     1   0  7659    0   10     0   678    88    0      3
4     1     0   0     2  309    2     0    12    48    6    159
5     0     0   0    74    1  325     0     0    10  110      1
6    25     0   0    19   28    0  1626    24    24    4    158
7     0     6   0   100    3    0     0  7104    37    0     15
8     0     0   0   203    8    1     0   194  2831    0     59
9     1     1  20    23   17   73     0    22    19  317      0
10    1     0   0     8   59    0     4    37    50    3  12634
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5651018, 'precision': 0.6208702, 'recall': 0.51867014, 'specificity': 0.95605797, 'f1': 0.4891854, 'auroc': 0.86184174}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   814     2   0  34    2    0    11   129    20   93    65
1     0  1164   0  22    0    0     0   291     2    0    20
2     0     5   5   9  231    5     0   221   214   80   245
3     0     0   0   0    0    0     0     0     0    0     0
4     0     0   0   0   61    0     0     3    12    1  1556
5     1     0   0  94    0  287     0     3    19  186     2
6     0     1   0   1   20    0  1250    16    57    0  1722
7     0     0   0   3    0    0     0  1158     0    0     3
8     0     0   0  65    0    2     0    63  1237    1     2
9     1    10   2  78   20   47     0   387   115  457    20
10    0     0   0   0    0    0     0     1     1    0  1644
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-09 07:57:15.364058,epoch time: 0:40:55.461116,used: 0:40:55.461116,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_16_19_seed_2_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93918556, 'precision': 0.8557369, 'recall': 0.8169247, 'specificity': 0.9935901, 'f1': 0.82800734, 'auroc': 0.9962751}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   336     0    0     9    2    0    87     7     7    5     30
1     0  1260    0    13    0    0     0    52     7    0      0
2     0     0  138     1   48    3     2    17    17   86      0
3     1     1    0  7856    1   13     7   375   183    0      0
4     1     2   19     0  359    2     3     4    43    9     97
5     0     0    1    32    0  447     0     0    11   29      1
6     4     1    0     6    2    0  1877     4     6    1      7
7     0    15    0   104    2    0     2  7076    59    1      4
8     0     2    1    70    8    2     0   117  3083    1     10
9     0     1   11     5    5  152     2     3    24  288      1
10    6    20    0     8  172    2    65    40    97    2  12383
---- Validation: 
scalar performance:
{'acc': 0.93917346, 'precision': 0.8614714, 'recall': 0.8181196, 'specificity': 0.99355507, 'f1': 0.8320468, 'auroc': 0.99626344}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   337     0    0     5    1    2    89     7    10    3     29
1     0  1264    0    10    0    0     0    49     9    0      0
2     0     1  146     2   38    6     3    24    15   77      0
3     0     0    0  7845    0   11     9   394   180    0      1
4     2     2   14     0  348    3     1     9    45   11    104
5     0     0    0    29    0  444     2     0    14   31      1
6     4     0    0     4    3    0  1879     4     5    1      8
7     0    19    0   108    3    0     1  7068    60    0      6
8     0     2    1    69   13    2     2   119  3077    1     10
9     1     0   13    11    2  138     7    10    17  294      0
10    7    22    1     8  153    1    56    50    89    0  12409
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.711747, 'precision': 0.68017983, 'recall': 0.6008751, 'specificity': 0.970794, 'f1': 0.5715896, 'auroc': 0.8843244}
confusion matrix:
     0     1   2   3    4    5     6     7     8    9     10
0   731     5   0  23    1   13   319    23    32   17     6
1     0  1286   0  25    0    0     0   179     5    0     4
2     1     7  52   6  102   23     0   211   460   75    78
3     0     0   0   0    0    0     0     0     0    0     0
4     0     6   2   0  290    0     2     6    65    1  1261
5     0     0   0  64    0  441     3     0    38   46     0
6     0     0   0   1    0    0  3025     3     8    0    30
7     0     0   0  35    0    0     0  1128     0    0     1
8     0     0   0  41    0    1     1    29  1298    0     0
9     1    14  13  97    2  156     5   172   367  304     6
10    0     2   0   0   20    0     2     2     2    0  1618
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-09 08:36:24.347714,epoch time: 0:39:08.983656,used: 1:20:04.444772,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_16_19_seed_2_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9411922, 'precision': 0.86774814, 'recall': 0.8074317, 'specificity': 0.99342847, 'f1': 0.82954025, 'auroc': 0.99663895}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   453     0    0     2    1    0     7     2     0    0     18
1     0  1272    0     7    0    0     0    46     4    0      3
2    11     1  125     0   77    1     5    54     3   21     14
3    12     1    0  7796    0   11    13   532    71    1      1
4    15     0    8     1  277    1     3    10    10    1    213
5     5     0    1    62    1  378     0     4     5   63      1
6    14     0    1     1    0    0  1876     2     1    0     13
7     3     7    0    72    1    0     5  7143    21    0     10
8     6     1    1   132   11    0     2   189  2891    2     59
9    31     0   40    17    6   53     2    45     3  290      6
10   41     0    0     6   17    1    15    21    16    1  12677
---- Validation: 
scalar performance:
{'acc': 0.9421961, 'precision': 0.8726162, 'recall': 0.81295854, 'specificity': 0.9935228, 'f1': 0.8345164, 'auroc': 0.99671316}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   452     0    0     2    0    0     5     3     0    0     21
1     0  1263    0     7    0    0     0    56     2    0      4
2    12     0  133     0   78    0     1    47     2   22     17
3    15     1    0  7815    0    8    12   519    69    1      0
4    11     0    2     1  273    1     2    11    12    4    222
5     6     0    0    50    2  398     0     2     5   57      1
6    13     0    0     0    0    0  1874     1     1    0     19
7     4     8    0    64    1    0     2  7158    18    0     10
8     3     0    1   140   14    0     1   183  2894    0     60
9    30     0   39    12    6   60     2    43     1  296      4
10   54     0    0     6   17    0    16    20    14    1  12668
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.70146227, 'precision': 0.6347515, 'recall': 0.5967529, 'specificity': 0.96984017, 'f1': 0.55515075, 'auroc': 0.8768155}
confusion matrix:
      0     1   2   3   4    5     6     7     8    9     10
0   1141     0   0   4   0    0    10     8     1    1     5
1      4  1236   0  10   0    0     0   229     0    0    20
2     42     0   9   1  38   10    10   236    79   41   549
3      0     0   0   0   0    0     0     0     0    0     0
4      3     0   0   0  19    0     1     2     4    0  1604
5     24     0   0  57   1  368     3     7    17  110     5
6      2     0   0   0   0    0  2899     4     0    0   162
7      1     0   0   2   0    0     0  1160     0    0     1
8      0     0   0  44   2    1     9    76  1211    1    26
9     72     0  10  25   1   64     5   483    68  338    71
10     0     0   0   0   0    0     0     1     0    0  1645
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_3.png
better model found
persisted
after epoch: 3,now: 2024-07-09 09:15:53.159137,epoch time: 0:39:28.811423,used: 1:59:33.256195,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_16_19_seed_2_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93819565, 'precision': 0.8935953, 'recall': 0.84016776, 'specificity': 0.9930868, 'f1': 0.8626895, 'auroc': 0.9973045}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   436     0    0     2    0    0    10    11     0    3     21
1     0  1250    0     8    0    0     0    73     0    0      1
2     2     0  208     2   30    0     2    27     1   38      2
3     0     0    0  7721    0    1     1   644    66    3      0
4     4     0   16     1  308    1     6    10     9    9    175
5     2     0    1    60    0  367     0     1     3   85      2
6     7     0    0     2    0    0  1877     7     0    1     14
7     0     8    0    44    1    0     2  7201     4    0      4
8     2     5    5    94   18    0     4   454  2671    3     40
9     0     0   43    10    0   38     1    19     2  379      1
10   15     1    1     5   37    0    16    53    15    1  12648
---- Validation: 
scalar performance:
{'acc': 0.9380768, 'precision': 0.89303946, 'recall': 0.8381403, 'specificity': 0.99308306, 'f1': 0.8609946, 'auroc': 0.9971891}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   425     0    0     4    1    0    21     7     0    3     22
1     0  1254    0     8    0    0     0    70     0    0      0
2     3     0  201     1   29    0     3    28     2   41      4
3     0     2    1  7739    0    2     1   637    58    0      0
4     7     0   23     1  308    1     7    13    11    6    162
5     1     0    1    58    0  365     0     2     6   87      1
6     8     1    0     2    0    0  1881     4     3    1      8
7     0     4    0    55    1    0     1  7196     4    0      4
8     3     2    2   110   14    1     1   464  2651    1     47
9     1     1   38     7    1   33     3    16     1  392      0
10   17     2    1     9   36    0    18    37    16    2  12658
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.65269715, 'precision': 0.6911793, 'recall': 0.5167835, 'specificity': 0.9651322, 'f1': 0.49766806, 'auroc': 0.8786229}
confusion matrix:
     0     1   2    3   4   5     6     7    8    9     10
0   813     0   0   44   0   0   237    67    1    6     2
1     0  1127   0   21   0   0     0   341    0    0    10
2     8     0  54   36  27   0    37   408   40   77   328
3     0     0   0    0   0   0     0     0    0    0     0
4     1     0   0    0  98   0     3     7    3    0  1521
5     2     0   0  275   0  81    11     5    4  213     1
6     0     0   0    1   0   0  3050     5    1    0    10
7     0     0   0    8   0   0     0  1154    0    0     2
8     0     0   0  133   0   0    19   213  993    0    12
9     8     2  21  213   1   7    30   493   21  320    21
10    0     0   0    0   6   0     0     1    0    0  1639
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_4.png
early stop counter: 1
val acc:0.9380767941474915, best validation acc: 0.9421960711479187, corresponding to test acc:                         0.7014622688293457 / 0.7117469906806946
after epoch: 4,now: 2024-07-09 09:57:38.338369,epoch time: 0:41:45.179232,used: 2:41:18.435427,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_16_19_seed_2_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95529217, 'precision': 0.8917851, 'recall': 0.87546766, 'specificity': 0.9951478, 'f1': 0.88198364, 'auroc': 0.9978756}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   424     1    1     2    5    0     8     0     2    4     36
1     0  1275    0     6    0    0     0    46     3    0      1
2     0     0  243     0   32    0     2     5     2   28      0
3     0     0    1  7868    0   21     3   354   186    2      1
4     4     0   27     0  335    1     0     2    21    1    148
5     0     0    3    10    0  416     0     0     9   82      1
6     6     0    1     1    1    1  1881     3     2    1     10
7     0    16    5    79    1    0     2  7061    86    0     15
8     0     1    7    45   12    7     0    55  3138    4     27
9     0     0   59     3    2   48     0     4     2  375      0
10    9     0    6     8   31    0    18     5    25    2  12689
---- Validation: 
scalar performance:
{'acc': 0.95388526, 'precision': 0.8899549, 'recall': 0.869801, 'specificity': 0.9949886, 'f1': 0.8785117, 'auroc': 0.9977001}
confusion matrix:
     0     1    2     3    4    5     6     7     8    9      10
0   419     0    1     2    4    1    13     2     2    5     34
1     0  1276    0     4    1    0     0    43     6    0      2
2     0     0  234     1   33    2     1     5     3   29      4
3     0     2    0  7860    0   18     2   370   187    1      0
4     3     0   25     0  328    1     0     3    18    2    159
5     0     0    0    16    0  404     0     0     8   92      1
6     7     0    2     1    4    1  1875     4     2    0     12
7     1    12    2    61    1    0     1  7072   100    2     13
8     0     0    6    35   14    4     0    67  3137    1     32
9     2     0   52     4    1   40     0     2     8  384      0
10   10     0    4     6   47    0    14    12    30    1  12672
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.7155251, 'precision': 0.6422939, 'recall': 0.60104656, 'specificity': 0.9712533, 'f1': 0.5801867, 'auroc': 0.8686105}
confusion matrix:
     0     1    2   3   4    5     6     7     8    9     10
0   943     1   10  21   3    1    47    19    44   26    55
1     0  1265    0  15   0    0     0   195     9    0    15
2     1     0  152   3  95    2     2    32   383   67   278
3     0     0    0   0   0    0     0     0     0    0     0
4     0     0    2   0  36    0     1     1    16    0  1577
5     1     0    1  68   4  274     1     0    39  202     2
6     0     0    0   1   0    0  2981     1     0    0    84
7     0     0    0  14   0    0     0  1141     6    0     3
8     0     0    0  27   1    0     2     8  1328    1     3
9     1     1  130  48   4   36     4    55   367  461    30
10    0     0    0   0   0    0     0     0     0    0  1646
t-SNE plot saved as zoutput/tsne/t-SNE_Test_acevedo_21716731_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-09 10:39:43.933016,epoch time: 0:42:05.594647,used: 3:23:24.030074,model: blood_mon_eos_bas_te_acevedo_erm_b44271c83_not_commited_2024md_07md_09_07_16_19_seed_2_21716731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
slurmstepd: error: *** JOB 21716731 ON supergpu03 CANCELLED AT 2024-07-09T10:45:05 DUE TO TIME LIMIT ***
